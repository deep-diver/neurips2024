[{"type": "text", "text": "Nonlocal Attention Operator: Materializing Hidden Knowledge Towards Interpretable Physics Discovery ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Yue Yu\u2217 Ning Liu Fei Lu   \nDepartment of Mathematics, Global Engineering and Department of Mathematics, Lehigh University, Materials, Inc., Johns Hopkins University,   \nBethlehem, PA 18015, USA Princeton, NJ 08540, USA Baltimore, MD 21218, USA yuy214@lehigh.edu ", "page_idx": 0}, {"type": "text", "text": "", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Tian Gao IBM Research, Yorktown Heights, NY 10598, USA ", "page_idx": 0}, {"type": "text", "text": "Siavash Jafarzadeh   \nDepartment of Mathematics, Lehigh University,   \nBethlehem, PA 18015, USA ", "page_idx": 0}, {"type": "text", "text": "Stewart Silling Center for Computing Research, Sandia National Laboratories, Albuquerque, NM 87123, USA ", "page_idx": 0}, {"type": "text", "text": "Abstract ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Despite the recent popularity of attention-based neural architectures in core AI fields like natural language processing (NLP) and computer vision (CV), their potential in modeling complex physical systems remains under-explored. Learning problems in physical systems are often characterized as discovering operators that map between function spaces based on a few instances of function pairs. This task frequently presents a severely ill-posed PDE inverse problem. In this work, we propose a novel neural operator architecture based on the attention mechanism, which we coin Nonlocal Attention Operator (NAO), and explore its capability towards developing a foundation physical model. In particular, we show that the attention mechanism is equivalent to a double integral operator that enables nonlocal interactions among spatial tokens, with a data-dependent kernel characterizing the inverse mapping from data to the hidden parameter field of the underlying operator. As such, the attention mechanism extracts global prior information from training data generated by multiple systems, and suggests the exploratory space in the form of a nonlinear kernel map. Consequently, NAO can address ill-posedness and rank deficiency in inverse PDE problems by encoding regularization and achieving generalizability. We empirically demonstrate the advantages of NAO over baseline neural models in terms of generalizability to unseen data resolutions and system states. Our work not only suggests a novel neural operator architecture for learning interpretable foundation models of physical systems, but also offers a new perspective towards understanding the attention mechanism. Our code and data accompanying this paper are available at https://github.com/fishmoon1234/NAO. ", "page_idx": 0}, {"type": "text", "text": "1 Introduction ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "The interpretability of machine learning (ML) models has become increasingly important from the security and robustness standpoints [Rudin et al., 2022, Molnar, 2020]. This is particularly true in physics modeling problems that can affect human lives, where not only the accuracy but also the transparency of data-driven models are essential in making decisions [Coorey et al., 2022, Ferrari and Willcox, 2024]. Nevertheless, it remains challenging to discover the underlying physical system and the governing mechanism from data. Taking the material modeling task for instance, given that only the deformation field is observable, the goal of discovering the underlying material parameter field and mechanism presents an ill-posed unsupervised learning task. That means, even if an ML model can serve as a good surrogate to predict the corresponding loading field from a given deformation field, its inference of the material parameters can still drastically deteriorate. ", "page_idx": 0}, {"type": "text", "text": "", "page_idx": 1}, {"type": "text", "text": "To discover an interpretable mechanism for physical systems, a major challenge is to infer the governing laws of these systems that are often high- or infinite-dimensional, from data that are comprised of discrete measurements of continuous functions. Therefore, a data-driven surrogate model needs to learn not only the mapping between input and output function pairs, but also the mapping from given function pairs to the hidden state. From the PDE-based modeling standpoint, learning a surrogate model corresponds to a forward problem, whereas inferring the underlying mechanism is an inverse problem. The latter is generally an enduring ill-posed problem, especially when the measurements are scarce. Unfortunately, such an ill-posedness issue may become even more severe in neural network models, due to the inherent bias of neural network approximations [Xu et al., 2019]. To tackle this challenge, many deep learning methods have recently been proposed as inverse PDE solvers [Fan and Ying, 2023, Molinaro et al., 2023, Jiang et al., 2022, Chen et al., 2023]. The central idea is to incorporate prior information into the learning scheme, in the form of governing PDEs [Yang et al., 2021, Li et al., 2021], regularizers [Dittmer et al., 2020, Obmann et al., 2020, Ding et al., 2022, Chen et al., 2023], or additional operator structures [Uhlmann, 2009, Lai et al., 2019, Yilmaz, 2001]. However, such prior information is often either unavailable or problemspecific in complex systems. As a result, these methods can only solve the inverse problem for a particular system, and one has to start from scratch when the system varies (e.g., when the material of the specimen undergoes degradation in a material modeling task). ", "page_idx": 1}, {"type": "image", "img_path": "uSKzEaj9zJ/tmp/774985bb2848900f84df9948f5ba50d91e2562c4c77fbaae3a40552d448f8c27.jpg", "img_caption": ["Figure 1: Illustration of NAO\u2019s architecture. "], "img_footnote": [], "page_idx": 1}, {"type": "text", "text": "", "page_idx": 1}, {"type": "text", "text": "In this work, we propose Nonlocal Attention Operator (NAO), a novel attention-based neural operator architecture to simultaneously solve both forward and inverse modeling problems. Neural operators (NOs) [Li et al., 2020a,c] learn mappings between infinite-dimensional function spaces in the form of integral operators, hence they provide promising tools for the discovery of continuum physical laws by manifesting the mapping between spatial and/or spatiotemporal data; see You et al. [2022], Liu et al. [2024a,b, 2023], Ong et al. [2022], Cao [2021], Lu et al. [2019, 2021], Goswami et al. [2022], Gupta et al. [2021] and references therein. However, most NOs focus on providing an efficient surrogate for the underlying physical system as a forward solver. They are often employed as black-box universal approximators but lack interpretability of the underlying physical laws. In contrast, the key innovation of NAO is that it introduces a kernel map based on the attention mechanism for simultaneous learning of the operator and the kernel map. As such, the kernel map automatically infers the context of the underlying physical system in an unsupervised manner. Intuitively, the attention mechanism extracts hidden knowledge from multiple systems by providing a function space of identifiability for the kernels, which acts as an automatic data-driven regularizer and endows the learned model\u2019s generalizability to new and unseen system states. ", "page_idx": 1}, {"type": "text", "text": "In this context, NAO learns a kernel map using the attention mechanism and simultaneously solves both the forward and inverse problems. The kernel map, whose parameters extract the global information about the kernel from multiple systems, efficiently infers resolution-invariant kernels from new datasets. As a consequence, NAO can achieve interpretability of the nonlocal operator and enable the discovery of hidden physical laws. Our key contributions include: ", "page_idx": 1}, {"type": "text", "text": "\u2022 We bridge the divide between inverse PDE modeling and physics discovery tasks, and present a method to simultaneously perform physics modeling (forward PDE) and mechanism discovery (inverse PDE).   \n\u2022 We propose a novel neural operator architecture NAO, based on the principle of contextual discovery from input/output function pairs through a kernel map constructed from multiple physical systems. As such, NAO is generalizable to new and unseen physical systems, and offers meaningful physical interpretation through the discovered kernel.   \n\u2022 We provide theoretical analysis to show that the attention mechanism in NAO acts to provide the space of identifiability for the kernels from the training data, which reveals its ability to resolve ill-posed inverse PDE problems. ", "page_idx": 1}, {"type": "text", "text": "\u2022 We conduct experiments on zero-shot learning to new and unseen physical systems, demonstrating the generalizability of NAO in both forward and inverse PDE problems. ", "page_idx": 2}, {"type": "text", "text": "2 Background and related work ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "Our work resides at the intersection of operator learning, attention-based models, and forward and inverse problems of PDEs. The ultimate goal is to model multiple physical systems from data while simultaneously discovering the hidden mechanism. ", "page_idx": 2}, {"type": "text", "text": "Neural operator for hidden physics. Learning complex physical systems directly from data is ubiquitous in scientific and engineering applications [Ghaboussi et al., 1998, Liu et al., $2024c$ , Ghaboussi et al., 1991, Carleo et al., 2019, Karniadakis et al., 2021, Zhang et al., 2018, Cai et al., 2022, Pfau et al., 2020, He et al., 2021, Besnard et al., 2006]. In many applications, the underlying governing laws are unknown, hidden in data to be revealed by physical models. Ideally, these models should be interpretable for domain experts, who can then use these models to make further predictions and expand the understanding of the target physical system. Also, these models should be resolution-invariant. Neural operators are designed to learn mappings between infinite-dimensional function spaces [Li et al., 2020a,b,c, You et al., 2022, Ong et al., 2022, Cao, 2021, Lu et al., 2019, 2021, Goswami et al., 2022, Gupta et al., 2021]. As a result, NOs provide a promising tool for the discovery of physical laws by manifesting the mapping between spatial and/or spatio-temporal data. ", "page_idx": 2}, {"type": "text", "text": "Forward and inverse PDE problems. Most current NOs focus on providing an efficient surrogate for the underlying physical system as a forward PDE solver. They are often employed as blackbox universal approximators without interpretability of the underlying physical laws. Conversely, several deep learning methods have been proposed as inverse PDE solvers [Fan and Ying, 2023, Molinaro et al., 2023, Jiang et al., 2022, Chen et al., 2023], aiming to reconstruct the parameters in the PDE from solution data. Compared to the forward problem, the inverse problem is typically more challenging due to its ill-posed nature. To tackle the ill-posedness, many NOs incorporate prior information, in the form of governing PDEs [Yang et al., 2021, Li et al., 2021], regularizers [Dittmer et al., 2020, Obmann et al., 2020, Ding et al., 2022, Chen et al., 2023], or additional operator structures [Uhlmann, 2009, Lai et al., 2019, Yilmaz, 2001]. To our knowledge, our NO architecture is the first that solves both the forward (prediction) and inverse (discovery) problems simultaneously. ", "page_idx": 2}, {"type": "text", "text": "Attention mechanism. Since 2017, the attention mechanism has become the backbone of state-ofthe-art deep learning models on many core AI tasks like NLP and CV. By calculating the similarity among tokens, the attention mechanism captures long-range dependencies between tokens [Vaswani et al., 2017]. Then, the tokens are spatially mixed to obtain the layer output. Based on the choice of mixers, attention-based models can be divided into three main categories: discrete graph-based attentions [Child et al., 2019, Ho et al., 2019, Wang et al., 2020, Katharopoulos et al., 2020], MLP-based attentions [Tolstikhin et al., 2021, Touvron et al., 2022, Liu et al., 2021], and convolution-based attentions [Lee-Thorp et al., 2021, Rao et al., 2021, Guibas et al., 2021, Nekoozadeh et al., 2023]. While most attention models focus on discrete mixers, it is proposed in Guibas et al. [2021], Nekoozadeh et al. [2023], Tsai et al. [2019], Cao [2021], Wei and Zhang [2023] to frame token mixing as a kernel integration, with the goal of obtaining predictions independent of the input resolution. ", "page_idx": 2}, {"type": "text", "text": "Along the line of PDE-solving tasks, various attention mechanisms have been used to enlarge model capacity. To improve the accuracy of forward PDE solvers, Cao [2021] removes the softmax normalization in the attention mechanism and employs linear attention as a learnable kernel in NOs. Further developments include the Galerkin-type linear attention in an encoder-decoder architecture in OFormer [Li et al., 2022], a hierarchical transformer for learning multiscale problems [Liu et al., 2022], and a heterogeneous normalized attention with a geometric gating mechanism [Hao et al., 2023] to handle multiple input features. In particular, going beyond solving a single PDE, the foundation model feature of attention mechanisms has been applied towards solving multiple types of PDEs within a specified context in Yang and Osher [2024], Ye et al. [2024], Sun et al. [2024], Zhang [2024]. However, none of the existing work discovers hidden physics from data, nor do they discuss the connections between the attention mechanism and the inverse PDE problem. ", "page_idx": 2}, {"type": "text", "text": "3 Nonlocal Attention Operator ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "Consider multiple physical systems that are described by a class of operators mapping from input functions $u\\in\\mathbb{X}$ to output functions $f\\,\\in\\,\\mathbb{Y}$ . Our goal is to learn the common physical law, in the form of operators $\\mathcal{L}_{K}:\\mathbb{X}\\rightarrow\\mathbb{Y}$ with system-dependent kernels $K$ : ", "page_idx": 2}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\mathcal{L}_{K}[u]+\\epsilon=f.}\\end{array}\n$$", "text_format": "latex", "page_idx": 2}, {"type": "text", "text": "Here $\\mathbb{X}$ and $\\mathbb{Y}$ are Banach spaces, $\\epsilon$ denotes an additive noise describing the discrepancy between the ground-truth operator and the optimal surrogate operator, and $K$ is a kernel function representing the nonlocal spatial interaction. As such, the kernel provides the knowledge of its corresponding system, while (1) offers a zero-shot prediction model for new and unseen systems. ", "page_idx": 3}, {"type": "text", "text": "To formulate the learning, we consider $n_{t r a i n}$ training datasets from different systems, with each dataset containing $d_{u}$ function pairs $(u,f)$ : ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\mathcal{D}_{\\mathrm{tr}}=\\{\\{(u_{i}^{\\eta}({\\boldsymbol{x}}),f_{i}^{\\eta}({\\boldsymbol{x}}))\\}_{i=1}^{d_{u}}\\}_{\\eta=1}^{n_{t r a i n}}.\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "In practice, the data of the input and output functions are on a spatial mesh $\\{x_{k}\\}_{k=1}^{n_{x}}\\subset\\Omega\\subset\\mathbb{R}^{d_{x}}$ The $n_{t r a i n}$ models with kernels $\\{K^{\\eta}\\}_{\\eta=1}^{n_{t r a i n}}$ correspond to different material micro-structures or different parametric settings. As a demonstration, we consider models for heterogeneous materials with operators in the form ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\mathcal{L}_{K}[u](x)=\\int_{\\Omega}K(x,y)g[u](y)d y,\\;x\\in\\Omega,\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "where $g[u](y)$ is a functional of $u$ determined by the operator; for example $g[u](y)~=~u(y)$ in Section 5.3. Our approach extends naturally to other forms of operators, such as those with radial interaction kernels in Section 5.1 and heterogeneous interaction in the form of $\\mathcal{L}_{K}[u](x)~=$ $\\begin{array}{r}{\\int_{\\Omega}K(x,y)g[u](x,y)d y}\\end{array}$ . Additionally, for simplicity, we consider scalar-valued functions $u$ and $f$ and note that the extension to vector-valued functions is trivial. ", "page_idx": 3}, {"type": "text", "text": "Remark: Such an operator learning problem arises in many applications in forward and inverse PDE-solving problems. The inference of the kernel $K$ is an inverse problem, and the learning of the nonlocal operator is a forward problem. When considering a single physical system and taking $K$ in (3) as an input-independent kernel, classical NOs can be obtained for forward PDE-solving tasks [Li et al., $2020\\mathrm{c}$ , Guibas et al., 2021] and governing law learning tasks [You et al., 2021, Jafarzadeh et al., 2024]. Different from existing work, we consider the operator learning across multiple systems. ", "page_idx": 3}, {"type": "text", "text": "3.1 Kernel map with attention mechanism ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "The key ingredient in NAO is a kernel map constructed using the attention mechanism. It maps from data pairs to an estimation of the underlying kernel. The kernel map ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\{(u_{i},f_{i})\\}_{i=1}^{d_{u}}\\,\\rightarrow\\,K[{\\mathbf u}_{1:d},{\\mathbf f}_{1:d};\\theta]\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "has parameters $\\theta$ estimated from the training dataset (2). As such, it maps from the token $(\\mathbf{u}_{1:d},\\mathbf{f}_{1:d})$ of the dataset $\\{(u_{i},f_{i})\\}_{i=1}^{d_{u}}$ to a kernel estimator, acting as an inverse PDE solver. ", "page_idx": 3}, {"type": "text", "text": "A major innovation of this kernel map is its dependence on both $u$ and $f$ through their tokens. Thus, our approach distinguishes itself from the forward problem-solving NOs in the related work section, where the attention depends only on $u$ . ", "page_idx": 3}, {"type": "text", "text": "We first transfer the data $\\{(u_{i},f_{i})\\}_{i=1}^{d_{u}}$ to tokens $(\\mathbf{u}_{1:d},\\mathbf{f}_{1:d})$ according to the operator in (3) by ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbf{u}_{1:d}=(\\mathbf{u}_{1},\\dots,\\mathbf{u}_{d})=\\left(g[u_{j}](y_{k})\\right)_{1\\leq j\\leq d,1\\leq k\\leq N}\\in\\mathbb{R}^{N\\times d},}\\\\ &{\\mathbf{f}_{1:d}=(f_{j}(x_{k}))_{1\\leq j\\leq d,1\\leq k\\leq N}\\in\\mathbb{R}^{N\\times d},}\\end{array}\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "where $d=d_{u}$ and $N=n_{x}$ , assuming that $g[u]$ has a spatial mesh $\\{y_{k}=x_{k}\\}_{k=1}^{N}$ . ", "page_idx": 3}, {"type": "text", "text": "Then, our discrete $(L+1)$ -layer attention model for the inverse PDE problem writes: ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{X_{\\mathrm{in}}=X^{(0)}=(U^{(0)},F^{(0)}):=(\\mathbf{u}_{1:d};\\mathbf{f}_{1:d})\\in\\mathbb{R}^{2N\\times d},}\\\\ &{X^{(l)}=\\mathrm{Att}[X^{(l-1)};\\theta_{l}]X^{(l-1)}+X^{(l-1)}=:(U^{(l)},F^{(l)})\\in\\mathbb{R}^{2N\\times d},\\quad1\\le l<L,}\\\\ &{X_{\\mathrm{out}}=X^{L}=K[\\mathbf{u}_{1:d},\\mathbf{f}_{1:d};\\theta]\\mathbf{u}_{1:d}\\approx\\mathbf{f}_{1:d}\\in\\mathbb{R}^{N\\times d}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "Here, $\\theta_{l}=(W_{l}^{Q}\\in\\mathbb{R}^{d\\times d_{k}}$ , $W_{l}^{K}\\in\\mathbb{R}^{d\\times d_{k}})$ and the attention function is ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\mathrm{Attn}[X;\\theta_{l}]=\\sigma\\left(\\frac{1}{\\sqrt{d_{k}}}X W_{l}^{Q}{W_{l}^{K}}^{\\top}X^{\\top}\\right)\\in\\mathbb{R}^{2N\\times2N}.\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "The kernel map is defined as ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\begin{array}{r}{K[\\mathbf{u}_{1:d},\\mathbf{f}_{1:d};\\boldsymbol{\\theta}]=W^{P,u}\\boldsymbol{\\sigma}\\left(\\frac{1}{\\sqrt{d_{k}}}(U^{(L-1)})^{\\top}W_{L}^{Q}(W_{L}^{K})^{\\top}U^{(L-1)}\\right)}\\\\ {+\\;W^{P,f}\\boldsymbol{\\sigma}\\left(\\frac{1}{\\sqrt{d_{k}}}(F^{(L-1)})^{\\top}W_{L}^{Q}(W_{L}^{K})^{\\top}U^{(L-1)}\\right),}\\end{array}\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "where $\\theta:=\\{W^{P,u}\\in\\mathbb{R}^{N\\times N},W^{P,f}\\in\\mathbb{R}^{N\\times N},\\{W_{l}^{Q},W_{l}^{K}\\}_{l=1}^{L}\\}$ are learnable parameters. Here, we note that $d_{k}$ only controls the rank bound when lifting each point-wise feature via $W_{l}^{Q}(W_{l}^{K})^{\\top}$ . In the following, we denote W lQK : $\\begin{array}{r}{W_{l}^{Q K}:=\\frac{1}{\\sqrt{d_{k}}}W_{l}^{Q}(W_{l}^{K})^{\\top}}\\end{array}$ , which characterizes the (trainable) interaction of $d$ input function pair instances. ", "page_idx": 4}, {"type": "text", "text": "3.2 Nonlocal Attention Operator in continuum limit ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "As suggested by Cao [2021], we take the activation function $\\sigma$ as a linear operator. Then, noting that the matrix multiplication in (6) is a Riemann sum approximation of an integral (with a full derivation in Appendix A), we propose the nonlocal attention operator as the continuum limit of (6): ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{g_{j}^{(0)}(x):=g[u_{j}](x),\\ f_{j}^{(0)}(x):=f_{j}(x),}\\\\ &{\\left(\\begin{array}{l}{g_{j}^{(l)}(x)}\\\\ {f_{j}^{(l)}(x)}\\end{array}\\right)=\\displaystyle\\int_{\\Omega}K^{(l)}(x,y)\\left(\\begin{array}{l}{g_{j}^{(l-1)}(y)}\\\\ {f_{j}^{(l-1)}(y)}\\end{array}\\right)d y+\\left(\\begin{array}{l}{g_{j}^{(l-1)}(x)}\\\\ {f_{j}^{(l-1)}(x)}\\end{array}\\right),\\quad1\\le l<L,}\\\\ &{\\mathcal{L}_{K[\\mathbf{u}_{1:d},\\mathbf{f}_{1:d};\\theta]}[u](x)=\\displaystyle\\int_{\\Omega}K[\\mathbf{u}_{1:d},\\mathbf{f}_{1:d};\\theta](x,y)g[u](y)d y,}\\end{array}\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "in which the integration is approximated by the Riemann sum in our implementation. Here, ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\zeta^{(l)}(x,y):=\\left[\\begin{array}{l}{\\sum_{\\omega,\\nu=1}^{d}\\left(g_{\\omega}^{(l-1)}(x)W_{l}^{Q K}[\\omega,\\nu]g_{\\nu}^{(l-1)}(y)\\right)}&{\\sum_{\\omega,\\nu=1}^{d}\\left(g_{\\omega}^{(l-1)}(x)W_{l}^{Q K}[\\omega,\\nu]f_{\\nu}^{(l-1)}(y)\\right)}\\\\ {\\sum_{\\omega,\\nu=1}^{d}\\left(f_{\\omega}^{(l-1)}(x)W_{l}^{Q K}[\\omega,\\nu]g_{\\nu}^{(l-1)}(y)\\right)}&{\\sum_{\\omega,\\nu=1}^{d}\\left(f_{\\omega}^{(l-1)}(x)W_{l}^{Q K}[\\omega,\\nu]f_{\\nu}^{(l-1)}(y)\\right)}\\end{array}\\right]}\\\\ &{\\overset{\\mathrm{\\tiny{C}}}{\\underset{=}{\\nabla}}[\\mathbf{u}_{1:d},\\mathbf{f}_{1:d};\\theta](x,y):=\\displaystyle\\sum_{\\omega,\\nu=1}^{d}\\int_{\\Omega}W^{P,u}(x,z)\\left(g_{\\omega}^{(L-1)}(z)W_{L}^{Q K}[\\omega,\\nu]g_{\\nu}^{(L-1)}(y)\\right)d z}\\\\ &{\\qquad\\qquad\\qquad+\\displaystyle\\sum_{\\omega,\\nu=1}^{d}\\int_{\\Omega}W^{P,f}(x,z)\\left(f_{\\omega}^{(L-1)}(z)W_{L}^{Q K}[\\omega,\\nu]g_{\\nu}^{(L-1)}(y)\\right)d z.}\\end{array}\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "We learn the parameters $\\theta$ by minimizing the following mean squared error loss function: ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\mathcal{E}(\\theta):=\\frac{1}{n_{t r a i n}}\\sum_{\\eta=1}^{n_{t r a i n}}\\sum_{i=1}^{d}\\int_{\\Omega}\\bigg|\\mathcal{L}_{K[\\mathbf{u}_{1:d}^{\\eta},\\mathbf{f}_{1:d}^{\\eta};\\theta]}[u_{i}^{\\eta}](x)-f_{i}^{\\eta}(x)\\bigg|^{2}d x.\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "The performance of the model is evaluated on test tasks with new and unseen kernels $\\mathcal{D}_{t e s t}\\;=\\;$ $\\{(u_{i}^{t e\\bar{s}t}(x),f_{i}^{t e s t}(x))\\}_{i=1}^{d}$ based on the following two criteria: ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\begin{array}{l}{{\\displaystyle E_{f}:=\\frac{1}{d}\\sum_{i=1}^{d}\\frac{\\Big|\\Big|\\mathcal{L}_{K[\\mathbf{u}_{1:d}^{t e s t},\\mathbf{f}_{1:d}^{t e s t};\\theta]}[u_{i}^{t e s t}](x)-f_{i}^{t e s t}(x)\\Big|\\Big|_{L^{2}(\\Omega)}}{\\vert\\vert f_{i}^{t e s t}(x))\\vert\\vert_{L^{2}(\\Omega)}},}}\\\\ {{\\displaystyle E_{K}:=\\big|K[\\mathbf{u}_{1:d}^{t e s t},\\mathbf{f}_{1:d}^{t e s t};\\theta]-K_{t e s t}\\big|_{L^{2}(\\rho)}/\\vert K_{t e s t}\\vert_{L^{2}(\\rho)}.}}\\end{array}\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "Here, $L^{2}(\\rho)$ is the empirical measure in the kernel space as defined in Lu et al. [2023]. Note that $\\theta$ are trained using multiple datasets. Intuitively speaking, the attention mechanism helps encode the prior information from other tasks for learning the nonlocal kernel, and leads to estimators significantly better than those using a single dataset. To formally understand this mechanism, we analyze a shallow 2-layer NAO in the next section. ", "page_idx": 4}, {"type": "text", "text": "4 Understanding the attention mechanism ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "To facilitate further understanding of the attention mechanism, we analyze the limit of the twolayer attention-parameterized kernel in (7) and the range of the kernel map, which falls in the space of identifiability for the kernels from the training data. We also connect the kernel map with the regularized estimators. For simplicity, we consider operators of the form ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\mathcal{L}_{K}[u](x)=\\int_{0}^{\\delta}K(r)g[u](r,x)d r,\\;x\\in\\Omega,\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "which is the radial nonlocal kernel in Sec.5.1. ", "page_idx": 4}, {"type": "text", "text": "4.1 Limit of the two-layer attention-parameterized kernel ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "We show that, as the number $N$ and the spatial mesh $n_{x}$ approach infinity, the limit of the two-layer attention-parameterized kernel is a double integral. Its proof is in Appendix B.1. ", "page_idx": 4}, {"type": "text", "text": "For simplicity, we assume that the dataset in (2) has $d_{u}\\,=\\,1$ and $n_{t r a i n}=1$ with a uniform mesh $\\{x_{j}\\}_{j=1}^{n_{x}}$ . We define the tokens by ", "page_idx": 5}, {"type": "equation", "text": "$$\n\\mathbf{u}_{1:d}=(\\mathbf{u}_{1},\\dots,\\mathbf{u}_{d})=(g[u](r_{k},x_{j}))_{1\\leq j\\leq d,1\\leq k\\leq N}\\in\\mathbb{R}^{N\\times d},\\ \\mathbf{f}_{1:d}=(f(x_{j}))_{1\\leq j\\leq d}\\in\\mathbb{R}^{1\\times d},\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "where $d=n_{x}$ and $\\{r_{k}\\}_{k=1}^{N}$ is the spatial mesh for $K$ \u2019s independent variable $r\\in[0,\\delta]$ . ", "page_idx": 5}, {"type": "text", "text": "Lemma 4.1. Consider the two-layer attention model in (6)\u2013(7) with bounded parameters. For each d and $N$ , let $\\{x_{j}\\}_{j=1}^{d}$ and $\\{r_{k}\\}_{k=1}^{N}$ be uniform meshes of the compact sets $\\Omega$ and $[0,\\delta]$ , and let $\\{A_{j}\\}_{j=1}^{d}$ be the resulting uniform partition of $\\Omega$ . Assume that $g[u]$ in (12) is continuous on $[0,\\delta]\\times\\Omega$ . Then, ", "page_idx": 5}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\displaystyle\\operatorname*{lim}_{N\\to\\infty}\\operatorname*{lim}_{d\\to\\infty}\\sum_{k=1}^{N}K[\\mathbf{u}_{1:d},\\mathbf{f}_{1:d};\\theta](r_{k})\\mathbf{1}_{[r_{k-1},r_{k})}(r)(r_{k}-r_{k-1})}\\\\ &{=\\!\\!\\!K[u,f](r):=\\displaystyle\\int_{0}^{\\delta}W^{P,u}(|r^{\\prime}|)\\sigma\\left(\\int\\int\\left[g[u](r^{\\prime},x)W^{Q K}(x,y)g[u](r,y)d x d y\\right]\\right)d r^{\\prime}}\\\\ &{\\quad+\\displaystyle W^{P,f}\\sigma\\left(\\int\\int\\left[f(x)W^{Q K}(x,y)g[u](r,y)\\right]d x d y\\right),}\\end{array}\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "where $\\begin{array}{r l r}{W^{Q K}(x,y)}&{{}\\!\\!=}&{\\!\\!\\operatorname*{lim}_{d\\to\\infty}\\sum_{j,j^{\\prime}=1}^{d}W^{Q K}[j,j^{\\prime}]\\mathbf{1}_{A_{j}\\times A_{j^{\\prime}}}(x,y)}\\end{array}$ is the scaled $L^{2}(\\Omega\\,\\times\\,\\Omega)$ limit of the parameter matrix $\\begin{array}{r l r}{W^{Q K}[j^{\\prime},j]}&{=}&{\\sum_{l=1}^{d_{k}}W^{Q}[j,l]\\;\\cdot\\;W^{K}[j^{\\prime},l]}\\end{array}$ and $\\begin{array}{r l}{W^{P,u}(r)}&{{}=}\\end{array}$ $\\begin{array}{r}{\\operatorname*{lim}_{N\\to\\infty}\\sum_{k=1}^{N}W^{P,u}[k]\\mathbf{1}_{[r_{k-1},r_{k})}(r).}\\end{array}$ . ", "page_idx": 5}, {"type": "text", "text": "4.2 Space of identifiability for the kernels ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "For a given training dataset, we show that the function space in which the kernels can be identified is the closure of a data-adaptive reproducing kernel Hilbert space (RKHS). This space contains the range of the kernel map and hence provides the ground for analyzing the inverse problem. ", "page_idx": 5}, {"type": "text", "text": "Lemma 4.2 (Space of Identifiability). Assume that the training data pairs in (2) are sampled from continuous functions {ui\u03b7 }id,u\u03b7,=nt1r with a compact support. Then, the function space the loss function in (9) has a unique minimizer $K(s)\\;=\\;K[\\mathbf{u}_{1:d}^{\\eta},\\mathbf{f}_{1:d}^{\\eta};\\theta](s)$ is the closure of a data-adaptive RKHS $H_{G}$ with a reproducing kernel $\\bar{G}$ determined by the training data: ", "page_idx": 5}, {"type": "equation", "text": "$$\n\\bar{G}(r,s)=[\\rho^{\\prime}(r)\\rho^{\\prime}(s)]^{-1}G(r,s),\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "where $\\rho^{\\prime}$ is the density of the empirical measure $\\rho$ defined by ", "page_idx": 5}, {"type": "equation", "text": "$$\n\\rho^{\\prime}(r):=\\frac{1}{Z}\\sum_{\\eta=1}^{n_{t r a i n}}\\sum_{i=1}^{d_{u}}\\int_{\\Omega}|g[u_{i}^{\\eta}](r,x)|d x,\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "and the function $G$ is defined by $G(r,s):=\\frac{1}{n_{t r a i n}d}\\sum_{\\eta=1}^{n_{t r a i n}}\\sum_{i=1}^{d_{u}}\\int_{\\Omega}g[u_{i}^{\\eta}](r,x)g[u_{i}^{\\eta}](s,x)d x.$ ", "page_idx": 5}, {"type": "text", "text": "The above space is data-adaptive since the integral kernel $\\bar{G}$ depends on data. It characterizes the information in the training data for estimating the nonlocal kernel $K(s)\\,=\\,K[\\mathbf{u}_{1:d}^{\\eta},\\mathbf{f}_{1:d}^{\\eta};\\theta](s)$ . In general, the more data, the larger the space is. On the other hand, note that the loss function\u2019s minimizer with respect to $K(s)$ is not the kernel map. The minimizer is a fixed estimator for the training dataset and does not provide any information for estimating the kernel from another dataset. ", "page_idx": 5}, {"type": "text", "text": "Comparison with regularized estimators. The kernel map solves the ill-posed inverse problem using prior information from the training dataset of multiple systems, which is not used in classical inverse problem solvers. To illustrate this mechanism, consider the extreme case of estimating the kernel in the nonlocal operator from a dataset consisting of only a single function pair $(u,f)$ . This inverse problem is severely ill-posed because of the small dataset and the need for deconvolution to estimate the kernel. Thus, regularization is necessary, where two main challenges present: (i) the selection of a proper regularization with limited prior information, and (ii) the prohibitive computational cost of solving the resulting large linear systems many times. ", "page_idx": 5}, {"type": "text", "text": "In contrast, our kernel map $K[\\mathbf{u}_{1:d},\\mathbf{f}_{1:d};\\theta](s)$ , with the parameter $\\theta$ estimated from the training datasets, acts on the token $(\\mathbf{u}_{1:d},\\mathbf{f}_{1:d})$ of $(u,f)$ to provide an estimator. It passes the prior information about the kernel from the training dataset to the estimation for new datasets. Importantly, it captures the nonlinear dependence of the estimator on the data $(u,f)$ . Computationally, it can be applied directly to multiple new datasets without solving the linear systems. In Section B.2, we further show that a regularized estimator depends nonlinearly on the data pair $(u,f)$ . In particular, similar to Lemma 4.1, there is an RKHS determined by the data pair $(u,f)$ . The regularized estimator suggests that the kernel map can involve a component quadratic in the feature $\\bar{g[u]}$ , similar to the limit form of the attention model in Lemma 4.1. ", "page_idx": 5}, {"type": "text", "text": "", "page_idx": 6}, {"type": "text", "text": "5 Experiments ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "We assess the performance of NAO on a wide range of physics modeling and discovery datasets. Our evaluation focuses on several key aspects: 1) we demonstrate the merits of the continuous and linear attention mechanism, compare the performance with the baseline discrete attention model (denoted as Discrete-NAO), the softmax attention mechanism (denoted as Softmax-NAO), NAO with input on $u$ only (denoted as NAO-u), the convolution-based attention mechanism (denoted as AFNO [Guibas et al., 2021]), and an MLP-based encoder architecture that maps the datum $[{\\pmb u}_{1:d},{\\pmb f}_{1:d}]$ directly to a latent kernel (denoted as Autoencoder); 2) we measure the generalizability, in particular, the zero-shot prediction performance in modeling a new physical system with unseen governing equations, and across different resolutions; 3) we evaluate the data efficiency-accuracy trade-off in ill-posed inverse PDE learning tasks, as well as the interpretability of the learned kernels. In all experiments, the optimization is performed with the Adam optimizer. To conduct fair comparison across different methods, we tune the hyperparameters, including the learning rates, the decay rates, and the regularization parameters, to minimize the training loss. In all examples, we use 3-layer models, and parameterize the kernel network $W^{P,u}$ and $\\breve{W}^{P,f}$ with a 3-layer MLP with hidden dimensions (32, 64) and LeakyReLU activation. Experiments are conducted on a single NVIDIA GeForce RTX 3090 GPU with $24\\:\\mathrm{GB}$ memory. Additional results and details on data generation and training strategies are provided in Appendix C. ", "page_idx": 6}, {"type": "text", "text": "5.1 Radial kernel learning ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "Table 1: Test errors and the number of trainable parameters for the radial kernel problem, where bold numbers highlight the best methods. The small operator errors and large kernel errors of discreteNAO highlight the ill-posedness of the inverse problem. NAO overcomes the ill-posedness and yields resolution-invariant estimators. ", "page_idx": 6}, {"type": "table", "img_path": "uSKzEaj9zJ/tmp/1b7f94014b3f6856628fdc0ff20a2a10e68a6509fdf7ebf0d680d5fc8355bc62.jpg", "table_caption": [], "table_footnote": [], "page_idx": 6}, {"type": "text", "text": "In this example, we consider the learning of nonlocal diffusion operators, in the form: ", "page_idx": 6}, {"type": "equation", "text": "$$\n\\mathcal{L}_{\\gamma_{\\eta}}[u](x)=\\int_{\\Omega}\\gamma_{\\eta}(|y-x|)[u(y)-u(x)]d y=f(x),\\forall x\\in\\Omega.\n$$", "text_format": "latex", "page_idx": 6}, {"type": "text", "text": "Unlike a (local) differential operator, this operator depends on the function $u$ nonlocally through the convolution of $u(y)\\mathrm{~-~}u(\\bar{x})$ , and the operator is characterized by a radial kernel $\\gamma_{\\eta}$ . It finds broad physical applications in describing fracture mechanics [Silling, 2000], anomalous diffusion behaviors [Bucur et al., 2016], and the homogenization of multiscale systems [Du et al., 2020]. ", "page_idx": 6}, {"type": "image", "img_path": "uSKzEaj9zJ/tmp/f55cbe76be2aacbe51a0a3d9cd2b4e617b85304bff8721e0400a1ffda2c7ae97.jpg", "img_caption": ["Figure 2: Results on radial kernel learning, when learning the test kernel from a small $\\underline{{{d}}}\\:=\\:30\\$ ) number of data pairs: test on an $\\mathrm{ID}$ task (left), and test on an OOD task (right). "], "img_footnote": [], "page_idx": 7}, {"type": "text", "text": "In this context, our goal is to learn the operator $\\mathcal{L}$ as well as to discover the hidden mechanism, namely the kernel $K[{\\pmb u}_{1:d},{\\pmb f}_{1:d};\\theta](x,y)=\\bar{\\b\\gamma}_{\\eta}(|y-x|)$ . In the form of the operator in (12), we have $K(r)=\\gamma_{\\eta}(r)$ and $g[u](r,x)=u(x+r)+u(x-r)-2u(x)\\mathrm{for}\\;r\\in[0,\\delta]$ . ", "page_idx": 7}, {"type": "text", "text": "To generate the training data, we consider 7 sine-type kernels ", "page_idx": 7}, {"type": "equation", "text": "$$\n\\gamma_{\\eta}(|y-x|):=\\exp(-\\eta(|y-x|))\\sin(6|y-x|)\\mathbf{1}_{[0,11]}(|y-x|),\\ \\eta=1,2,3,4,6,7,8.\n$$", "text_format": "latex", "page_idx": 7}, {"type": "text", "text": "Here, $\\eta$ denotes task index. We generate 4530 data pairs $(g^{\\eta}[u],f^{\\eta})$ with a fixed resolution $\\Delta x=$ 0.0125 for each task, where the loading function $\\mathcal{L}_{\\gamma_{\\eta}}[u^{\\eta}]=f^{\\eta}$ is computed by the adaptive GaussKronrod quadrature method. Then, we form a training sample of each task by taking $d$ pairs from this task. When taking the token size $d=302$ , each task contains $\\textstyle{\\frac{4530}{302}}=15$ samples. We consider two test kernels: one following the same rule of (17) with $\\eta\\,=\\,5$ (denoted as the \u201cin-distribution (ID) test\u201d system), and the other following a different rule (denoted as the \u201cout-of-distribution (OOD) test1\u201d system): ", "page_idx": 7}, {"type": "equation", "text": "$$\n\\gamma_{o o d1}(|y-x|):=|y-x|(11-|y-x|)\\exp(-5(|y-x|))\\sin(6|y-x|)\\mathbf{1}_{[0,11]}(|y-x|).\n$$", "text_format": "latex", "page_idx": 7}, {"type": "text", "text": "Both the operator error (10) and the kernel error (11) are provided in Table 1. While the former measures the error of the learned forward PDE solver (i.e., learning a physical model), the latter demonstrates the capability of serving as an inverse PDE solver (i.e., physics discovery). ", "page_idx": 7}, {"type": "text", "text": "Ablation study. We first perform an ablation study on NAO, by comparing its performance with its variants (Discrete-NAO, Softmax-NAO, and NAO-u), AFNO, and Autoencoder, with a fixed token dimension $d\\,=\\,302$ , query-key feature size $d_{k}\\,=\\,10$ , and data resolution $\\Delta x\\,=\\,0.0125$ . When comparing the operator errors, both Discrete-NAO and NAO serve as good surrogate models for the ID task with relative errors of $1.33\\%$ and $1.48\\%$ , respectively, while the other three baselines show $>10\\%$ errors. Therefore, we focus more on the comparison between Discrete-NAO and NAO. This gap becomes more pronounced in the OOD task: only NAO is able to provide a surrogate of $\\mathcal{L}_{\\gamma_{o o d}}$ with $<10\\%$ error, who outperforms its discrete mixer counterpart by $68.62\\%$ , indicating that NAO learns a more generalizable mechanism. This argument is further affirmed when comparing the kernel errors, where NAO substantially outperforms all baselines by at least $81.39\\%$ in the ID test and $65.21\\%$ in the OOD test. This study verifies our analysis in Section 4: NAO learns the kernel map in the space of identifiability, and hence possesses advantages in solving the challenging ill-posed inverse problem. Additionally, we vary the query-key feature size from $d_{k}=10$ to $d_{k}=5$ and $d_{k}\\,=\\,20$ . Note that $d_{k}$ determines the rank bound of $W^{Q K}$ , the matrix that characterizes the interaction between different data pairs. Discrete-NAO again performs well only in approximating the operator for the ID test, while NAO achieves consistent results in both tests and criteria, showing that it has successfully discovered the intrinsic low-dimension in the kernel space. ", "page_idx": 7}, {"type": "text", "text": "Alleviating ill-posedness. To further understand NAO\u2019s capability as an inverse PDE solver, we reduce the number of data pairs for each sample from $d\\,=\\,302$ to $d\\,=\\,30$ , making it more illposed as an inverse PDE problem. NAO again outperforms its discrete mixer counterpart in all aspects. Interestingly, the errors in NAO increase almost monotonically, showing its robustness. For Discrete-NAO, the error also increases monotonically in the ID operator test, but there exists no consistent pattern in other test criteria. Figure 2 shows the learned test kernels in both the ID and OOD tasks. It shows that Discrete-NAO learns highly oscillatory kernels, while our continuous NAO only has a discrepancy near $\\vert x-y\\vert=0$ . Note that when $\\vert x-y\\vert=0$ , we have $u(y)-u(x)=0$ in the ground-truth operator (16), and hence the kernel value at this point does not change the operator value. That means, our data provides almost no information at this point. This again verifies our analysis: continuous NAO learns the kernel map structure from small data based on prior knowledge from other task datasets. ", "page_idx": 7}, {"type": "image", "img_path": "uSKzEaj9zJ/tmp/1d6945159796bef5e2cc098bf064a2b7b471fe41736e7e1eed8eb104cb84f123.jpg", "img_caption": ["Figure 3: Kernel visualization in experiment 2, where the kernels correspond to the inverse of stiffness matrix: ground truth (left), test kernel from Discrete-NAO (middle), kernel from NAO (right). "], "img_footnote": [], "page_idx": 8}, {"type": "text", "text": "", "page_idx": 8}, {"type": "text", "text": "Cross-resolution. We test the NAO model trained with $\\Delta x=0.0125$ on a dataset corresponding to $\\Delta x=0.025$ , and plot the results in Figure 2 Left. The predicted kernel is very similar to the one learned from the same resolution, and the error is also on-par $(22.65\\%$ versus $20.79\\%$ ). ", "page_idx": 8}, {"type": "text", "text": "5.2 Solution operator learning ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "We consider the modeling of 2D sub-surface flows through a porous medium with a heterogeneous permeability field. Following the settings in Li et al. [2020a], the high-fidelity synthetic simulation data for this example are described by the Darcy flow. Here, the physical domain is $\\Omega\\,=\\,[0,1]^{2}$ , $b(x)$ is the permeability field, and the Darcy\u2019s equation has the form: ", "page_idx": 8}, {"type": "equation", "text": "$$\n-\\nabla\\cdot(b(x)\\nabla p(x))=g(x),~~~~x\\in\\Omega;\\qquad p(x)=0,~~~\\pmb{x}\\in\\partial\\Omega.\n$$", "text_format": "latex", "page_idx": 8}, {"type": "text", "text": "In this context, we aim to learn the solution operator of Darcy\u2019s equation and compute the pressure field $p(x)$ . We consider two study scenarios. 1) $g\\rightarrow p$ : each task has a fixed microstructure $b(x)$ , and our goal is to learn the (linear) solution operator mapping from each loading field $g$ to the corresponding solution field $p$ . In this case, the kernel $K$ acts as the Green\u2019s function of (19), and can be approximated by the inverse of the stiffness matrix. 2) $b\\rightarrow p$ : each task has a fixed loading field $g(x)$ , and our goal is to learn the (nonlinear) solution operator mapping from the permeability field $b$ to the corresponding solution field $p$ . ", "page_idx": 8}, {"type": "table", "img_path": "uSKzEaj9zJ/tmp/6358c50c642a2f32bc0ad5230c99a869649c41fd70533d85560895c4f0fa1016.jpg", "table_caption": ["Table 2: Test errors and the number of trainable parameters in solution operator learning. "], "table_footnote": [], "page_idx": 8}, {"type": "text", "text": "We report the operator learning results in Table 2, where NAO slightly outperforms Discrete-NAO in most cases, using only 1/2 or 1/3 the number of trainable parameters. On the other hand, we also verify the kernel learning results by comparing the learned kernels in a test case with the groundtruth inverse of stiffness matrix in Figure 3. Although both Discrete-NAO and NAO capture the major pattern, the kernel from Discrete-NAO again shows a spurious oscillation in regions where the ground-truth kernel has zero value. On the other hand, by exploring the kernel map in the integrated knowledge space, the learned kernel from NAO does not exhibit such spurious modes. ", "page_idx": 8}, {"type": "text", "text": "To demonstrate the physical interpretability of the learned kernel, in the first row of Figure 4 we show the ground-truth microstructure $b(x)$ , a test loading field instance $g(x)$ , and the corresponding solution $p(x)$ . By taking the summation of the kernel strength on each row, one can discover the interaction strength of each material point $x$ with its neighbors. As this strength is related to the permeability field $b(x)$ , the underlying microstructure can be recovered accordingly. In the bottom row of Figure 4, we demonstrate the discovered microstructure of this test task. We note that the discovered microstructure is smoothed out due to the continuous setting of our learned kernel (as shown in the bottom left plot), and a thresholding step is performed to discover the two-phase microstructure. The discovered microstructure (bottom right plot) matches well with the hidden ground-truth microstructure (left plot), except for regions near the domain boundary. This mismatch is due to the applied Dirichlet-type boundary condition $\\textstyle(p(x)=0$ on $\\partial\\Omega$ ) in all samples, which leads to the measurement pairs $(p(x),g(x))$ containing no information near the domain boundary $\\partial\\Omega$ and makes it impossible to identify the kernel on boundaries. ", "page_idx": 8}, {"type": "image", "img_path": "uSKzEaj9zJ/tmp/7cbeb6f7df04e2b9a0e883867efa445e8631d24d66f47e352b522eade911119c.jpg", "img_caption": ["Figure 4: Demonstration of the generated data and the recovered microstructure from the learned kernel in Example 2. Top row: the ground-truth two-phase material microstructure from a test task (left), an exemplar loading field instance (middle), and the corresponding solution field instance (right). Bottom row: summation of the learned kernel for each line, corresponding to the total interaction of all material points (left), and the discovered two-phase material microstructure after thresholding (right). "], "img_footnote": [], "page_idx": 9}, {"type": "text", "text": "", "page_idx": 9}, {"type": "text", "text": "5.3 Heterogeneous material learning ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "In this example, we investigate the learning of heterogeneous and nonlinear material responses using the Mechanical MNIST benchmark [Lejeune, 2020]. For training and testing, we take 500 heterogeneous material specimens, where each specimen is governed by a Neo-Hookean material with a varying modulus converted from the MNIST bitmap images. On each specimen, 200 loading/response data pairs are provided. Two generalization scenarios are considered. 1) We mix the data from all numbers and randomly take $1\\bar{0}\\%$ of specimens for testing. This scenario corresponds to an ID test. 2) We leave all specimens corresponding to the number $\\cdot_{9},$ for testing, and use the rest for training. This scenario corresponds to an OOD test. The corresponding results are listed in Table 3, where NAO again outperforms its discrete counterpart. ", "page_idx": 9}, {"type": "table", "img_path": "uSKzEaj9zJ/tmp/f9570bcb598ff5002febaaca90efa2a0a127f1dd65225e72f46c7cc5a0d6b680.jpg", "table_caption": ["Table 3: Test errors and the number of trainable parameters in heterogeneous material learning. "], "table_footnote": [], "page_idx": 9}, {"type": "text", "text": "6 Conclusion ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "We propose Nonlocal Attention Operator (NAO), a novel NO architecture to simultaneously learn both the forward (modeling) and inverse (discovery) solvers in physical systems from data. In particular, NAO learns the function-to-function mapping based on an integral NO architecture and provides a surrogate forward solution predictor. In the meantime, the attention mechanism is crafted in building a kernel map from input-output function pairs to the system\u2019s function parameters, offering zero-shot generalizability to new and unseen physical systems. As such, the kernel map explores in the function space of identifiability, resolving the enduring ill-posedness in inverse PDE problems. In our empirical demonstrations, NAO outperforms all selected baselines on multiple datasets of inverse PDE problems and out-of-distribution generalizability tasks. ", "page_idx": 9}, {"type": "text", "text": "Broader Impacts: Beyond its merits in forward/inverse PDE modeling, our work represents an initial exploration in understanding the attention mechanism in physics modeling, and paves a theoretical path towards building a foundation model in scientific ML. ", "page_idx": 9}, {"type": "text", "text": "Limitations: Due to limited computational resource, our experiments focus on learning from a small to medium number $(<500)$ of similar physical systems. It would be beneficial to expand the coverage and enable learning across different types of physical systems. ", "page_idx": 9}, {"type": "text", "text": "Acknowledgments and Disclosure of Funding ", "text_level": 1, "page_idx": 10}, {"type": "text", "text": "S. Jafarzadeh would like to acknowledge support by the AFOSR grant FA9550-22-1-0197, and Y. Yu would like to acknowledge support by the National Science Foundation (NSF) under award DMS1753031 and the National Institute of Health under award 1R01GM157589-01. Portions of this research were conducted on Lehigh University\u2019s Research Computing infrastructure partially supported by NSF Award 2019035. F. Lu would like to acknowledge support by NSF DMS-2238486. ", "page_idx": 10}, {"type": "text", "text": "This article has been authored by an employee of National Technology and Engineering Solutions of Sandia, LLC under Contract No. DE-NA0003525 with the U.S. Department of Energy (DOE). The employee owns all right, title and interest in and to the article and is solely responsible for its contents. The United States Government retains and the publisher, by accepting the article for publication, acknowledges that the United States Government retains a non-exclusive, paid-up, irrevocable, worldwide license to publish or reproduce the published form of this article or allow others to do so, for United States Government purposes. The DOE will provide public access to these results of federally sponsored research in accordance with the DOE Public Access Plan https://www.energy.gov/downloads/doe-public-access-plan. ", "page_idx": 10}, {"type": "text", "text": "References ", "text_level": 1, "page_idx": 10}, {"type": "text", "text": "Gilles Besnard, Fran\u00e7ois Hild, and St\u00e9phane Roux. finite-element displacement fields analysis from digital images: application to portevin\u2013le ch\u00e2telier bands. Experimental mechanics, 46(6):789\u2013 803, 2006.   \nClaudia Bucur, Enrico Valdinoci, et al. Nonlocal diffusion and applications, volume 20. Springer, 2016.   \nShengze Cai, Zhiping Mao, Zhicheng Wang, Minglang Yin, and George Em Karniadakis. Physicsinformed neural networks (PINNs) for fluid mechanics: A review. Acta Mechanica Sinica, pages 1\u201312, 2022.   \nShuhao Cao. Choose a transformer: Fourier or galerkin. Advances in neural information processing systems, 34:24924\u201324940, 2021.   \nGiuseppe Carleo, Ignacio Cirac, Kyle Cranmer, Laurent Daudet, Maria Schuld, Naftali Tishby, Leslie Vogt-Maranto, and Lenka Zdeborov\u00e1. Machine learning and the physical sciences. Reviews of Modern Physics, 91(4):045002, 2019.   \nKe Chen, Chunmei Wang, and Haizhao Yang. let data talk: data-regularized operator learning theory for inverse problems. arXiv preprint arXiv:2310.09854, 2023.   \nRewon Child, Scott Gray, Alec Radford, and Ilya Sutskever. Generating long sequences with sparse transformers. arXiv preprint arXiv:1904.10509, 2019.   \nGenevieve Coorey, Gemma A Figtree, David F Fletcher, Victoria J Snelson, Stephen Thomas Vernon, David Winlaw, Stuart M Grieve, Alistair McEwan, Jean Yee Hwa Yang, Pierre Qian, Kieran O\u2019Brien, Jessica Orchard, Jinman Kim, Sanjay Patel, and Julie Redfern. The health digital twin to tackle cardiovascular diseaseA review of an emerging interdisciplinary field. NPJ Digital Medicine, 5:126, 2022.   \nWen Ding, Kui Ren, and Lu Zhang. Coupling deep learning with full waveform inversion. arXiv preprint arXiv:2203.01799, 2022.   \nS\u00f6ren Dittmer, Tobias Kluth, Peter Maass, and Daniel Otero Baguer. Regularization by architecture: A deep prior approach for inverse problems. Journal of Mathematical Imaging and Vision, 62: 456\u2013470, 2020.   \nQiang Du, Bjorn Engquist, and Xiaochuan Tian. Multiscale modeling, homogenization and nonlocal effects: Mathematical and computational issues. Contemporary mathematics, 754:115\u2013140, 2020.   \nYuwei Fan and Lexing Ying. Solving traveltime tomography with deep learning. Communications in Mathematics and Statistics, 11(1):3\u201319, 2023.   \nAlberto Ferrari and Karen Willcox. Digital twins in mechanical and aerospace engineering. Nature Computational Science, 4(3):178\u2013183, 2024.   \nJ Ghaboussi, JH Garrett Jr, and Xiping Wu. Knowledge-based modeling of material behavior with neural networks. Journal of engineering mechanics, 117(1):132\u2013153, 1991.   \nJamshid Ghaboussi, David A Pecknold, Mingfu Zhang, and Rami M Haj-Ali. Autoprogressive training of neural network constitutive models. International Journal for Numerical Methods in Engineering, 42(1):105\u2013126, 1998.   \nSomdatta Goswami, Aniruddha Bora, Yue Yu, and George Em Karniadakis. Physics-informed neural operators. 2022 arXiv preprint arXiv:2207.05748, 2022.   \nJohn Guibas, Morteza Mardani, Zongyi Li, Andrew Tao, Anima Anandkumar, and Bryan Catanzaro. Adaptive fourier neural operators: Efficient token mixers for transformers. arXiv preprint arXiv:2111.13587, 2021.   \nGaurav Gupta, Xiongye Xiao, and Paul Bogdan. Multiwavelet-based operator learning for differential equations. Advances in neural information processing systems, 34:24048\u201324062, 2021.   \nZhongkai Hao, Zhengyi Wang, Hang Su, Chengyang Ying, Yinpeng Dong, Songming Liu, Ze Cheng, Jian Song, and Jun Zhu. Gnot: A general neural operator transformer for operator learning. In International Conference on Machine Learning, pages 12556\u201312569. PMLR, 2023.   \nQizhi He, Devin W Laurence, Chung-Hao Lee, and Jiun-Shyan Chen. Manifold learning based data-driven modeling for soft biological tissues. Journal of Biomechanics, 117:110124, 2021.   \nJonathan Ho, Nal Kalchbrenner, Dirk Weissenborn, and Tim Salimans. Axial attention in multidimensional transformers. arXiv preprint arXiv:1912.12180, 2019.   \nSiavash Jafarzadeh, Stewart Silling, Ning Liu, Zhongqiang Zhang, and Yue Yu. Peridynamic neural operators: A data-driven nonlocal constitutive model for complex material responses. Computer Methods in Applied Mechanics and Engineering, 425:116914, 2024.   \nHanyang Jiang, Yuehaw Khoo, and Haizhao Yang. Reinforced inverse scattering. arXiv preprint arXiv:2206.04186, 2022.   \nGeorge Em Karniadakis, Ioannis G Kevrekidis, Lu Lu, Paris Perdikaris, Sifan Wang, and Liu Yang. Physics-informed machine learning. Nature Reviews Physics, 3(6):422\u2013440, 2021.   \nAngelos Katharopoulos, Apoorv Vyas, Nikolaos Pappas, and Fran\u00e7ois Fleuret. Transformers are rnns: Fast autoregressive transformers with linear attention. In International conference on machine learning, pages 5156\u20135165. PMLR, 2020.   \nRu-Yu Lai, Qin Li, and Gunther Uhlmann. Inverse problems for the stationary transport equation in the diffusion scaling. SIAM Journal on Applied Mathematics, 79(6):2340\u20132358, 2019.   \nJames Lee-Thorp, Joshua Ainslie, Ilya Eckstein, and Santiago Ontanon. Fnet: Mixing tokens with fourier transforms. arXiv preprint arXiv:2105.03824, 2021.   \nEmma Lejeune. Mechanical mnist: A benchmark dataset for mechanical metamodels. Extreme Mechanics Letters, 36:100659, 2020.   \nZijie Li, Kazem Meidani, and Amir Barati Farimani. Transformer for partial differential equations\u2019 operator learning. arXiv preprint arXiv:2205.13671, 2022.   \nZongyi Li, Nikola Kovachki, Kamyar Azizzadenesheli, Burigede Liu, Kaushik Bhattacharya, Andrew Stuart, and Anima Anandkumar. Neural operator: Graph kernel network for partial differential equations. arXiv preprint arXiv:2003.03485, 2020a.   \nZongyi Li, Nikola Kovachki, Kamyar Azizzadenesheli, Burigede Liu, Andrew Stuart, Kaushik Bhattacharya, and Anima Anandkumar. Multipole graph neural operator for parametric partial differential equations. Advances in Neural Information Processing Systems, 33:NeurIPS 2020, 2020b.   \nZongyi Li, Nikola Borislavov Kovachki, Kamyar Azizzadenesheli, Kaushik Bhattacharya, Andrew Stuart, and Anima Anandkumar. Fourier NeuralOperator for Parametric Partial Differential Equations. In International Conference on Learning Representations, 2020c.   \nZongyi Li, Hongkai Zheng, Nikola Kovachki, David Jin, Haoxuan Chen, Burigede Liu, Kamyar Azizzadenesheli, and Anima Anandkumar. Physics-informed neural operator for learning partial differential equations. 2021 arXiv preprint arXiv:2111.03794, 2021.   \nHanxiao Liu, Zihang Dai, David So, and Quoc V Le. Pay attention to mlps. Advances in neural information processing systems, 34:9204\u20139215, 2021.   \nNing Liu, Yue Yu, Huaiqian You, and Neeraj Tatikola. Ino: Invariant neural operators for learning complex physical systems with momentum conservation. In International Conference on Artificial Intelligence and Statistics, pages 6822\u20136838. PMLR, 2023.   \nNing Liu, Yiming Fan, Xianyi Zeng, Milan Kl\u00f6wer, LU ZHANG, and Yue Yu. Harnessing the power of neural operators with automatically encoded conservation laws. In Forty-first International Conference on Machine Learning, 2024a.   \nNing Liu, Siavash Jafarzadeh, and Yue Yu. Domain agnostic fourier neural operators. Advances in Neural Information Processing Systems, 36, 2024b.   \nNing Liu, Xuxiao Li, Manoj R Rajanna, Edward W Reutzel, Brady Sawyer, Prahalada Rao, Jim Lua, Nam Phan, and Yue Yu. Deep neural operator enabled digital twin modeling for additive manufacturing. arXiv preprint arXiv:2405.09572, 2024c.   \nXinliang Liu, Bo Xu, and Lei Zhang. Ht-net: Hierarchical transformer based operator learning model for multiscale pdes. 2022.   \nFei Lu, Quanjun Lang, and Qingci An. Data adaptive rkhs tikhonov regularization for learning kernels in operators. In Mathematical and Scientific Machine Learning, pages 158\u2013172. PMLR, 2022.   \nFei Lu, Qingci An, and Yue Yu. Nonparametric learning of kernels in nonlocal operators. Journal of Peridynamics and Nonlocal Modeling, pages 1\u201324, 2023.   \nLu Lu, Pengzhan Jin, and George Em Karniadakis. Deeponet: Learning nonlinear operators for identifying differential equations based on the universal approximation theorem of operators. arXiv preprint arXiv:1910.03193, 2019.   \nLu Lu, Pengzhan Jin, Guofei Pang, Zhongqiang Zhang, and George Em Karniadakis. Learning nonlinear operators via DeepONet based on the universal approximation theorem of operators. Nature Machine Intelligence, 3(3):218\u2013229, 2021.   \nRoberto Molinaro, Yunan Yang, Bj\u00f6rn Engquist, and Siddhartha Mishra. Neural inverse operators for solving pde inverse problems. arXiv preprint arXiv:2301.11167, 2023.   \nChristoph Molnar. Interpretable machine learning. 2020.   \nAnahita Nekoozadeh, Mohammad Reza Ahmadzadeh, and Zahra Mardani. Multiscale attention via wavelet neural operators for vision transformers. arXiv preprint arXiv:2303.12398, 2023.   \nDaniel Obmann, Johannes Schwab, and Markus Haltmeier. Deep synthesis regularization of inverse problems. arXiv preprint arXiv:2002.00155, 2020.   \nYong Zheng Ong, Zuowei Shen, and Haizhao Yang. IAE-Net: integral autoencoders for discretization-invariant learning. arXiv preprint arXiv:2203.05142, 2022.   \nDavid Pfau, James S Spencer, Alexander GDG Matthews, and W Matthew C Foulkes. Ab initio solution of the many-electron schr\u00f6dinger equation with deep neural networks. Physical Review Research, 2(3):033429, 2020.   \nYongming Rao, Wenliang Zhao, Zheng Zhu, Jiwen Lu, and Jie Zhou. Global filter networks for image classification. Advances in neural information processing systems, 34:980\u2013993, 2021.   \nCynthia Rudin, Chaofan Chen, Zhi Chen, Haiyang Huang, Lesia Semenova, and Chudi Zhong. Interpretable machine learning: Fundamental principles and 10 grand challenges. Statistic Surveys, 16:1\u201385, 2022.   \nStewart A Silling. Reformulation of elasticity theory for discontinuities and long-range forces. Journal of the Mechanics and Physics of Solids, 48(1):175\u2013209, 2000.   \nJingmin Sun, Yuxuan Liu, Zecheng Zhang, and Hayden Schaeffer. Towards a foundation model for partial differential equation: Multi-operator learning and extrapolation. arXiv preprint arXiv:2404.12355, 2024.   \nIlya O Tolstikhin, Neil Houlsby, Alexander Kolesnikov, Lucas Beyer, Xiaohua Zhai, Thomas Unterthiner, Jessica Yung, Andreas Steiner, Daniel Keysers, Jakob Uszkoreit, et al. Mlp-mixer: An all-mlp architecture for vision. Advances in neural information processing systems, 34:24261\u2013 24272, 2021.   \nHugo Touvron, Piotr Bojanowski, Mathilde Caron, Matthieu Cord, Alaaeldin El-Nouby, Edouard Grave, Gautier Izacard, Armand Joulin, Gabriel Synnaeve, Jakob Verbeek, et al. Resmlp: Feedforward networks for image classification with data-efficient training. IEEE Transactions on Pattern Analysis and Machine Intelligence, 45(4):5314\u20135321, 2022.   \nYao-Hung Hubert Tsai, Shaojie Bai, Makoto Yamada, Louis-Philippe Morency, and Ruslan Salakhutdinov. Transformer dissection: a unified understanding of transformer\u2019s attention via the lens of kernel. arXiv preprint arXiv:1908.11775, 2019.   \nGunther Uhlmann. Electrical impedance tomography and calder\u00f3n\u2019s problem. Inverse problems, 25 (12):123011, 2009.   \nAshish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N Gomez, \u0141ukasz Kaiser, and Illia Polosukhin. Attention is all you need. Advances in neural information processing systems, 30, 2017.   \nSinong Wang, Belinda Z Li, Madian Khabsa, Han Fang, and Hao Ma. Linformer: Self-attention with linear complexity. arXiv preprint arXiv:2006.04768, 2020.   \nMin Wei and Xuesong Zhang. Super-resolution neural operator. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 18247\u201318256, 2023.   \nZhi-Qin John Xu, Yaoyu Zhang, Tao Luo, Yanyang Xiao, and Zheng Ma. Frequency principle: Fourier analysis sheds light on deep neural networks. arXiv preprint arXiv:1901.06523, 2019.   \nLiu Yang and Stanley J Osher. Pde generalization of in-context operator networks: A study on 1d scalar nonlinear conservation laws. arXiv preprint arXiv:2401.07364, 2024.   \nLiu Yang, Xuhui Meng, and George Em Karniadakis. B-pinns: Bayesian physics-informed neural networks for forward and inverse pde problems with noisy data. Journal of Computational Physics, 425:109913, 2021.   \nZhanhong Ye, Xiang Huang, Leheng Chen, Hongsheng Liu, Zidong Wang, and Bin Dong. Pdeformer: Towards a foundation model for one-dimensional partial differential equations. arXiv preprint arXiv:2402.12652, 2024.   \n\u00d6zdog\u02d8an Yilmaz. Seismic data analysis, volume 1. Society of exploration geophysicists Tulsa, 2001.   \nHuaiqian You, Yue Yu, Nathaniel Trask, Mamikon Gulian, and Marta DElia. Data-driven learning of nonlocal physics from high-fidelity synthetic data. Computer Methods in Applied Mechanics and Engineering, 374:113553, 2021.   \nHuaiqian You, Yue Yu, Marta D\u2019Elia, Tian Gao, and Stewart Silling. Nonlocal kernel network (NKN): A stable and resolution-independent deep neural network. Journal of Computational Physics, page arXiv preprint arXiv:2201.02217, 2022. ", "page_idx": 10}, {"type": "text", "text": "", "page_idx": 11}, {"type": "text", "text": "", "page_idx": 12}, {"type": "text", "text": "", "page_idx": 13}, {"type": "text", "text": "Linfeng Zhang, Jiequn Han, Han Wang, Roberto Car, and E Weinan. Deep potential molecular dynamics: a scalable model with the accuracy of quantum mechanics. Physical Review Letters, 120(14):143001, 2018. ", "page_idx": 14}, {"type": "text", "text": "Zecheng Zhang. Modno: Multi operator learning with distributed neural operators. arXiv preprint arXiv:2404.02892, 2024. ", "page_idx": 14}, {"type": "text", "text": "A Riemann sum approximation derivations ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "In this section, we show that the discrete attention operator (6) can be seen as the Riemann sum approximation of the nonlocal attention operator in (8), in the continuous limit. Without loss of generality, we consider a uniform discretization with grid size $\\Delta x$ . Denoting the $l-$ th layer output as $\\mathbf{\\calU}^{(l)}\\,=\\,\\Big(g_{j}^{(l)}(x_{k})\\Big)_{1\\le j\\le d,1\\le k\\le N},\\,F^{(l)}\\,=\\,\\Big(f_{j}^{(l)}(x_{k})\\Big)_{1\\le j\\le d,1\\le k\\le N};$ and , $\\frac{1}{\\sqrt{d_{k}}}W_{l}^{Q}W_{l}^{K}$ as W lQK\u2208Rd\u00d7d, for the l\u2212th (l < L) layer update in (6) writes: ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\begin{array}{l}{{{\\bf{V}}^{(l)}[\\alpha,\\beta]=\\displaystyle\\sum_{\\gamma=1}^{2N}\\sum_{\\omega,\\nu=1}^{d}\\sum_{\\lambda=1}^{d_{k}}\\left(\\frac{1}{\\sqrt{d_{k}}}X^{(l-1)}[\\alpha,\\omega]W_{l}^{Q}[\\omega,\\lambda]W_{l}^{K}[\\nu,\\lambda]X^{(l-1)}[\\gamma,\\nu]\\right)X^{(l-1)}[\\gamma,\\beta]+X^{(l-1)}[\\alpha,\\nu]~~}}\\\\ {{\\mathrm{}}}\\\\ {{{=}\\displaystyle\\sum_{\\gamma=1}^{2N}\\sum_{\\omega,\\nu=1}^{d}\\left(X^{(l-1)}[\\alpha,\\omega]W_{l}^{Q K}[\\omega,\\nu]X^{(l-1)}[\\gamma,\\nu]\\right)X^{(l-1)}[\\gamma,\\beta]+X^{(l-1)}[\\alpha,\\beta]}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "That means, $d_{k}$ only controls the rank bound when lifting each point-wise feature via $W_{l}^{Q K}$ , while $W_{l}^{Q K}$ characterizes the (trainable) interaction of $d$ input function pair instances. Moreover, when $\\alpha\\leq N,X^{(l)}[\\alpha,\\beta]=g_{\\beta}^{(l)}(x_{\\alpha})$ . When $\\alpha>N$ $>N,X^{(l)}[\\alpha,\\beta]=f_{\\beta}^{(l)}(x_{\\alpha-N})$ . Then, ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\begin{array}{l l}{\\displaystyle g_{\\beta}^{(l)}(x_{\\alpha})=\\sum_{\\gamma=1}^{N}\\sum_{w,\\nu=1}^{d}\\left(X^{(l-1)}[\\alpha,\\omega]W_{l}^{Q K}[\\omega,\\nu]X^{(l-1)}[\\gamma,\\nu]\\right)X^{(l-1)}[\\gamma,\\beta]}\\\\ {\\displaystyle\\quad\\quad+\\sum_{\\gamma=N+1}^{2N}\\sum_{w,\\nu=1}^{d}\\left(X^{(l-1)}[\\alpha,\\omega]W_{l}^{Q K}[\\omega,\\nu]X^{(l-1)}[\\gamma,\\nu]\\right)X^{(l-1)}[\\gamma,\\beta]+g_{\\beta}^{(l-1)}(x_{\\alpha})}\\\\ {\\displaystyle\\quad\\quad=\\sum_{\\gamma=1}^{N}\\sum_{w,\\nu=1}^{d}\\left(g_{\\omega}^{(l-1)}(x_{\\alpha})W_{l}^{Q K}[\\omega,\\nu]g_{\\nu}^{(l-1)}(x_{\\gamma})\\right)g_{\\beta}^{(l-1)}(x_{\\gamma})}\\\\ {\\displaystyle\\quad\\quad\\quad+\\sum_{\\gamma=1}^{N}\\sum_{w,\\nu=1}^{d}\\left(g_{\\omega}^{(l-1)}(x_{\\alpha})W_{l}^{Q K}[\\omega,\\nu]f_{\\nu}^{(l-1)}(x_{\\gamma})\\right)f_{\\beta}^{(l-1)}(x_{\\widetilde{\\gamma}})+g_{\\beta}^{(l-1)}(x_{\\alpha}).}\\end{array}\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "Similarly, ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\begin{array}{l l}{\\displaystyle f_{\\beta}^{(l)}(x_{\\alpha})=\\sum_{\\gamma=1}^{N}\\sum_{w,\\nu=1}^{d}\\left(X^{(l-1)}[\\alpha,\\omega]W_{l}^{Q K}[\\omega,\\nu]X^{(l-1)}[\\gamma,\\nu]\\right)X^{(l-1)}[\\gamma,\\beta]}\\\\ {\\displaystyle\\quad\\quad\\quad+\\sum_{\\gamma=N+1}^{2N}\\sum_{w,\\nu=1}^{d}\\left(X^{(l-1)}[\\alpha,\\omega]W_{l}^{Q K}[\\omega,\\nu]X^{(l-1)}[\\gamma,\\nu]\\right)X^{(l-1)}[\\gamma,\\beta]+f_{\\beta}^{(l-1)}(x_{\\alpha})}\\\\ {\\displaystyle\\quad\\quad\\quad=\\sum_{\\gamma=1}^{N}\\sum_{w,\\nu=1}^{d}\\left(f_{\\omega}^{(l-1)}(x_{\\alpha})W_{l}^{Q K}[\\omega,\\nu]g_{\\nu}^{(l-1)}(x_{\\gamma})\\right)g_{\\beta}^{(l-1)}(x_{\\gamma})}\\\\ {\\displaystyle\\quad\\quad\\quad\\quad+\\sum_{\\gamma=1}^{N}\\sum_{w,\\nu=1}^{d}\\left(f_{\\omega}^{(l-1)}(x_{\\alpha})W_{l}^{Q K}[\\omega,\\nu]f_{\\nu}^{(l-1)}(x_{\\gamma})\\right)f_{\\beta}^{(l-1)}(x_{\\gamma})+f_{\\beta}^{(l-1)}(x_{\\alpha}).}\\end{array}\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "With the Riemann sum approximation: $\\begin{array}{r}{\\int_{\\Omega}p(x)d x\\approx\\Delta x^{D}\\sum_{k=1}^{N_{x}}p(x_{k})}\\end{array}$ , one can further reformulate above derivations as: ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\begin{array}{r l r}{\\lefteqn{g_{\\beta}^{(l)}(x)\\approx\\frac{1}{\\Delta x^{D}}\\int_{\\Omega}\\sum_{\\omega,\\nu=1}^{d}\\left(g_{\\omega}^{(l-1)}(x)W_{l}^{Q K}[\\omega,\\nu]g_{\\nu}^{(l-1)}(y)\\right)g_{\\beta}^{(l-1)}(y)d y}}\\\\ &{}&{+\\,\\frac{1}{\\Delta x^{D}}\\int_{\\Omega}\\sum_{\\omega,\\nu=1}^{d}\\left(g_{\\omega}^{(l-1)}(x)W_{l}^{Q K}[\\omega,\\nu]f_{\\nu}^{(l-1)}(y)\\right)f_{\\beta}^{(l-1)}(y)d y+g_{\\beta}^{(l-1)}(x),}\\end{array}\n$$", "text_format": "latex", "page_idx": 15}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{f_{\\beta}^{(l)}(x)\\approx\\!\\frac{1}{\\Delta x^{D}}\\int_{\\Omega}\\!\\sum_{\\omega,\\nu=1}^{d}\\left(f_{\\omega}^{(l-1)}(x)W_{l}^{Q K}[\\omega,\\nu]g_{\\nu}^{(l-1)}(y)\\right)g_{\\beta}^{(l-1)}(y)d y}\\\\ &{\\qquad\\quad+\\,\\frac{1}{\\Delta x^{D}}\\int_{\\Omega}\\sum_{\\omega,\\nu=1}^{d}\\left(f_{\\omega}^{(l-1)}(x)W_{l}^{Q K}[\\omega,\\nu]f_{\\nu}^{(l-1)}(y)\\right)f_{\\beta}^{(l-1)}(y)d y+f_{\\beta}^{(l-1)}(x).}\\end{array}\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "Therefore, the attention mechanism of each layer is in fact an integral operator after a rescaling: ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\left(\\begin{array}{c c}{g^{(l)}(x)}\\\\ {f^{(l)}(x)}\\end{array}\\right)=\\int_{\\Omega}K^{(l)}(x,y)\\left(\\begin{array}{c c}{g^{(l-1)}(y)}\\\\ {f^{(l-1)}(y)}\\end{array}\\right)d y+\\left(\\begin{array}{c c}{g^{(l-1)}(x)}\\\\ {f^{(l-1)}(x)}\\end{array}\\right),\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "with the kernel $K^{(l)}({x},{y})$ defined as: ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\left[\\begin{array}{l l}{\\sum_{\\omega,\\nu=1}^{d}\\Big(g_{\\omega}^{(l-1)}(x)W_{l}^{Q K}[\\omega,\\nu]g_{\\nu}^{(l-1)}(y)\\Big)}&{\\sum_{\\omega,\\nu=1}^{d}\\Big(g_{\\omega}^{(l-1)}(x)W_{l}^{Q K}[\\omega,\\nu]f_{\\nu}^{(l-1)}(y)\\Big)}\\\\ {\\sum_{\\omega,\\nu=1}^{d}\\Big(f_{\\omega}^{(l-1)}(x)W_{l}^{Q K}[\\omega,\\nu]g_{\\nu}^{(l-1)}(y)\\Big)}&{\\sum_{\\omega,\\nu=1}^{d}\\Big(f_{\\omega}^{(l-1)}(x)W_{l}^{Q K}[\\omega,\\nu]f_{\\nu}^{(l-1)}(y)\\Big)}\\end{array}\\right].}\\end{array}\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "For the $L-$ th layer update, we denote the approximated value of $f_{\\beta}(x_{\\alpha})$ as $\\tilde{f}_{\\beta}(x_{\\alpha}):=X_{\\mathrm{out}}[\\alpha,\\beta]$ , then ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{\\lefteqn{\\int_{\\hat{\\mathcal{H}}(x)=1}^{\\infty}\\sum_{\\tau=1}^{K}W(\\mathbf{n}_{1},\\ t_{*},\\phi(\\mu)[\\alpha_{*}](x))}\\,}\\\\ &{=\\displaystyle\\sum_{k=1}^{\\infty}\\sum_{u=1}^{K}W^{T,u}[\\alpha_{*}]\\cdot\\mathbf{\\hat{p}}(\\mu^{T,(k-1)}[\\lambda_{*}]W_{\\tau}^{2K}[\\omega_{*}]\\cdot\\mathbf{p}(\\mu^{T,(k-1)}[\\gamma_{*}]\\cdot\\rho)]\\,g(\\mu)[\\alpha_{*}]}\\\\ &{\\quad+\\displaystyle\\sum_{k=1}^{N}\\sum_{u=1}^{i}W^{T,u}[\\alpha_{*}]\\cdot\\mathbf{\\hat{p}}(\\mu^{T,(k-1)}[\\lambda_{*}]W_{\\tau}^{2K}[\\omega_{*}]\\cdot\\mathbf{p}(\\mu^{T-1-\\nu_{1}}[\\gamma_{*}]\\cdot\\rho)]\\,g(\\mu)[\\alpha_{*}]}\\\\ &{\\quad+\\displaystyle\\sum_{k=1}^{N}\\sum_{u=1}^{i}W^{T,u}[\\alpha_{*}]\\cdot\\mathbf{\\hat{p}}(\\mu^{T-1-\\nu_{1}}[\\lambda_{*}]W_{\\tau}^{2K}[\\omega_{*}]\\cdot\\mathbf{p}(\\mu)[\\delta_{*}])\\,g(\\mu)[\\alpha_{*}]}\\\\ &{=\\displaystyle\\sum_{k=1}^{N}\\sum_{u=1}^{i}W^{T,u}[\\alpha_{*}]\\cdot\\mathbf{\\hat{p}}(\\mu)\\cdot\\mathbf{\\hat{p}}(\\mu)\\frac{W_{\\tau}^{2K}[\\alpha_{*}]}{\\gamma_{*}}[\\gamma_{*}]\\cdot\\rho(\\mu)[\\delta_{*}]\\cdot\\mathbf{\\hat{p}}(\\mu)[\\alpha_{*}]}\\\\ &{\\quad+\\displaystyle\\sum_{k=1}^{N}\\sum_{u=1}^{i}W^{T,u}[\\alpha_{*}]\\cdot\\left(\\int_{0}^{L-1}(\\gamma_{*})W_{\\tau}^{2K}[\\phi_{*}]\\cdot\\mathbf{\\hat{p}}(\\mu)_{*}^{L-1}(\\nu_{*})\\right)g(\\mu)[\\alpha_{*}]}\\\\ &{\\quad\\times\\frac{1}{\\Delta\\alpha^{2H}}\\int_{0}^{L}\\displaystyle\\sum_{u=1}^{i}W^{T,u}\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "Hence, a (rescaled) continuous limit of the kernel writes: ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{K[\\mathbf{u}_{1:d},\\mathbf{f}_{1:d};\\boldsymbol{\\theta}](x,y)=\\displaystyle\\int_{\\Omega}\\sum_{\\omega,\\nu=1}^{d}W^{P,u}(x,z)\\left(g_{\\omega}^{(L-1)}(z)W_{L}^{Q K}[\\omega,\\nu]g_{\\nu}^{(L-1)}(y)\\right)d z}\\\\ &{\\qquad\\qquad\\qquad\\qquad+\\displaystyle\\int_{\\Omega}\\sum_{\\omega,\\nu=1}^{d}W^{P,f}(x,z)\\left(f_{\\omega}^{(L-1)}(z)W_{L}^{Q K}[\\omega,\\nu]g_{\\nu}^{(L-1)}(y)\\right)d z.}\\end{array}\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "B Proofs and connection with regularized estimator ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "B.1 Proofs ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "Proof of Lemma 4.1. With $\\{r_{k}\\}_{k=1}^{N}$ , we can write the attention-based kernel in (7) as ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\begin{array}{r l r}{\\lefteqn{K[\\mathbf{u}_{1:d},\\mathbf{f}_{1:d};\\boldsymbol{\\theta}](r_{k})=\\sum_{k^{\\prime}=1}^{N}W^{P,u}(r_{k^{\\prime}})\\sigma\\left(\\sum_{l=1}^{d_{k}}\\sum_{j=1}^{d}\\mathbf{u}_{j}(r_{k^{\\prime}})W^{Q}[j,l]\\cdot W^{K}[j^{\\prime},l]\\mathbf{u}_{j^{\\prime}}(r_{k})\\right)}}\\\\ &{}&{\\mathrm+\\,W^{P,f}\\sigma\\left(\\sum_{l=1}^{d}\\sum_{j=1}^{d}\\sum_{j^{\\prime}=1}^{d}\\left[\\mathbf{f}_{j}W^{Q}[j,l]\\cdot W^{K}[j^{\\prime},l]\\mathbf{u}_{j^{\\prime}}(r_{k})\\right]\\right).}\\end{array}\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "Denoting $\\begin{array}{r}{W^{Q K}[j^{\\prime},j]=\\sum_{l=1}^{d_{k}}W^{Q}[j,l]\\cdot W^{K}[j^{\\prime},l]}\\end{array}$ , we write the kernel in (22) as ", "page_idx": 17}, {"type": "equation", "text": "$$\n\\begin{array}{l}{{\\displaystyle K[{\\bf u}_{1:d},{\\bf f}_{1:d};\\theta](r)=\\sum_{r^{\\prime}=1}^{N}W^{P,u}(|r^{\\prime}|)\\sigma\\left(\\sum_{j=1}^{d}\\sum_{j^{\\prime}=1}^{d}\\Big[g[u](r^{\\prime},x_{i_{j}})W^{Q K}[j,j^{\\prime}]g[u](r,x_{i_{j}},)\\Big]\\right)}\\ ~}}\\\\ {{\\displaystyle~~~~~~~~~~~~~~~~~+W^{P,f}\\sigma\\left(\\sum_{i=1}^{d}\\sum_{j=1}^{d}\\Big[f(x_{i_{j^{\\prime}}})W^{Q K}[j,j^{\\prime}]g[u](r,x_{i_{j}})\\Big]\\right).}}\\end{array}\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "Then, as $d\\to\\infty$ is achieved by refining the spatial mesh, viewing the summation in $j$ as Riemann sum, ", "page_idx": 17}, {"type": "equation", "text": "$$\n\\operatorname*{lim}_{d\\to\\infty}\\sum_{j=1}^{d}\\sum_{j^{\\prime}=1}^{d}g[u](r^{\\prime},x_{i j})W^{Q K}[j,j^{\\prime}]g[u](r,x_{i_{j^{\\prime}}})=\\int\\int g[u](r,x)W^{Q K}(x,y)g[u](s,y)d x d y,\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "where the integral exists since $g[u](r,x)W^{Q K}(x,y)$ is bounded. Sending also the number of tokens, $N$ , to infinity, we obtain the limit attention model in (14). \u53e3 ", "page_idx": 17}, {"type": "text", "text": "Proof of Lemma 4.2. The proof is adapted from Lu et al. [2023, 2022]. Write $\\begin{array}{r l}{K(r)}&{{}=}\\end{array}$ $K[\\bar{\\mathbf u_{1:d}^{\\eta}},\\mathbf f_{1:d}^{\\eta}](r)$ . Notice that the loss function in (9) can be expanded as ", "page_idx": 17}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathcal{E}(K)\\!=\\!\\frac{1}{n_{t r a i n}}\\displaystyle\\sum_{\\eta=1}^{n_{t r a i n}}\\sum_{i=1}^{d_{u}}\\int_{\\Omega}\\left[\\int_{0}^{\\delta}K(r)g[u_{i}^{\\eta}](r,x))d r-f_{i}^{\\eta}(x)\\right]^{2}d x}\\\\ &{\\quad\\quad\\!=\\!\\frac{1}{n_{t r a i n}}\\displaystyle\\sum_{\\eta=1}^{n_{t r a i n}}\\sum_{i=1}^{d_{u}}\\int_{0}^{\\delta}\\int_{0}^{\\delta}K(s)K(r)\\int_{\\Omega}g[u_{i}^{\\eta}](s,x))g[u_{i}^{\\eta}](r,x))d x d r d s}\\\\ &{\\quad\\quad\\!-\\frac{2}{n_{t r a i n}}\\displaystyle\\sum_{\\eta=1}^{n_{t r a i n}}\\sum_{i=1}^{d_{u}}\\int_{0}^{\\delta}K(r)\\int_{\\Omega}g[u_{i}^{\\eta}](r,x)f_{i}^{\\eta}(x)d x d r+C o n s t.}\\\\ &{\\quad\\quad\\!=\\!\\langle\\mathcal{L}_{\\bar{G}}K,K\\rangle_{L_{2}^{\\rho}}-2\\langle K,K^{D}\\rangle_{L_{2}^{\\rho}}+C o n s t.,}\\end{array}\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "where $\\mathcal{L}_{\\bar{G}}:L_{\\rho}^{2}\\to L_{\\rho}^{2}$ is the integral operator ", "page_idx": 17}, {"type": "equation", "text": "$$\n\\mathcal{L}_{\\bar{G}}K(s):=\\int_{0}^{\\delta}K(r)\\bar{G}(r,s)d r\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "and $K^{D}$ is the Riesz representation of the bounded linear functional ", "page_idx": 17}, {"type": "equation", "text": "$$\n\\langle K,K^{D}\\rangle_{L_{\\rho}^{2}}=\\frac{1}{n_{t r a i n}}\\sum_{\\eta=1}^{n_{t r a i n}}\\sum_{i=1}^{d_{u}}\\int_{0}^{\\delta}K(r)\\int_{\\Omega}g[u_{i}^{\\eta}](r,x)f_{i}^{\\eta}(x)d x d r.\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "Thus, the quadratic loss function has a unique minimizer in $\\mathrm{Null}({\\cal L}_{\\bar{G}})^{\\perp}$ ", "page_idx": 17}, {"type": "text", "text": "Meanwhile, since the data pairs are continuous with compact support, the function $\\bar{G}$ is a squareintegrable reproducing kernel. Thus, the operator ${\\mathcal{L}}_{\\bar{G}}$ is compact and $H_{G}\\ =\\ \\mathcal{L}_{\\bar{G}}^{1/2}L_{\\rho}^{2}$ . Then, $\\mathrm{Null}({\\mathcal{L}}_{\\bar{G}})^{\\perp}=\\overline{{H_{G}}}$ , where the closure is with respect to $L_{\\rho}^{2}$ . \u53e3 ", "page_idx": 17}, {"type": "text", "text": "B.2 Connection with regularized estimator ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "Consider the inverse problem of estimating the nonlocal kernel $K$ given a data pair $(u,f)$ . In the classical variational approach, one seeks the minimizer of the following loss function ", "page_idx": 17}, {"type": "equation", "text": "$$\n\\mathcal{E}(K)=\\int_{\\Omega}\\left[\\int_{0}^{\\delta}K(r)g[u](r,x)d r-f(x)\\right]^{2}d x\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "The inverse problem is ill-posed in the sense that the minimizer can often be non-unique or sensitive to the noise or measurement error in data $(u,f)$ . Thus, regularization is crucial to produce a stable solution. ", "page_idx": 17}, {"type": "text", "text": "To connect with the attention-based model, we consider regularizing using an RKHS $H_{W}$ with a square-integrable reproducing kernel $W$ . One seeks an estimator in $H_{W}$ by regularizing the loss with the $\\|\\bar{K}\\|_{H_{W}}^{2}$ , and minimizes the regularized loss function ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\mathcal{E}_{\\lambda,W}(K)=\\!\\mathcal{E}(K)+\\lambda\\int_{0}^{\\infty}\\int_{0}^{\\infty}K(s)K(r)W(r,s)d r d s.\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "The next lemma shows that the regularized estimator is a nonlinear function of the data pair $(u,f)$ , where the nonlinearity comes from the kernel $G_{u}$ and the parameter $\\lambda_{*}$ . ", "page_idx": 18}, {"type": "text", "text": "Lemma B.1. The regularized loss function in $\\mathcal{E}_{\\lambda,W}(K)$ in (24) is ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\mathcal{E}_{\\lambda,W}(K)=\\int_{0}^{\\infty}\\int_{0}^{\\infty}K(r)K(s)[G_{u}(r,s)+\\lambda W(r,s)]d r d s-2\\int_{0}^{\\infty}K(r)K^{u,f}(r)d r+C o n s t.,\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "where $G_{u}$ is defined in (27). Its minimizer is ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\widehat{K}=({\\mathcal{L}}_{G_{u}}+\\lambda_{*}{\\mathcal{L}}_{W})^{-1}K^{u,f},\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "where $\\mathcal{L}_{G_{u}}$ and ${\\mathcal{L}}_{W}$ are integral operators with integral kernels $G_{u}$ defined in (27) and $W$ , ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\mathcal{L}_{G_{u}}K(s):=\\int_{0}^{\\infty}K(r)G_{u}(r,s)d r,\\quad\\mathcal{L}_{W}K(s):=\\int_{0}^{\\infty}K(r)W(r,s)d r,\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "$\\lambda_{*}$ is the optimal hyper-parameter controlling the strength of regularization, and $K^{u,f}(r)\\;=\\;$ $\\textstyle\\int_{\\Omega}g[u](r,x{\\bar{)}}f(x)d x$ is $a$ function determined by the data $(u,f)$ . ", "page_idx": 18}, {"type": "text", "text": "When there is no prior information on the regularization, which happens often for the learning of the kernel, one can use the data-adaptive RKHS $H_{G_{u}}$ with the reproducing kernel $G_{u}$ determined by data: ", "page_idx": 18}, {"type": "equation", "text": "$$\nG_{u}(r,s)=\\int_{\\Omega}g[u](r,x)g[u](s,x)d x.\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "Lu et al. [2023] shows that this regularizer can lead to consistent convergent estimators. ", "page_idx": 18}, {"type": "text", "text": "Remark B.2 (Discrete data and discrete inverse problem). In practice, the datasets are discrete. One can view the discrete inverse problem as a discretization of the continuous inverse problem. Assume that the integrands are compactly supported and when the integrals are approximated by Riemann sums, we can write loss function for discrete $\\mathbf{K}=(K(r_{1}),\\ldots,\\stackrel{\\smile}{K}(r_{N}))^{\\top}\\stackrel{\\star}{\\in}\\mathbb{R}^{N\\times1}$ as ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\begin{array}{r l r}&{\\dot{\\boldsymbol{\\lambda}}_{\\lambda,W}(K)\\approx\\displaystyle\\sum_{k,k^{\\prime}=1}^{N,N}K(r_{k})K(r_{k^{\\prime}})[G_{u}(r_{k},r_{k^{\\prime}})+\\lambda W(r_{k},r_{k^{\\prime}})](\\Delta r)^{2}-2\\displaystyle\\sum_{k=1}^{N}K(r_{k})K^{u,f}(r_{k})\\Delta r+C\\delta(r_{k},r_{k^{\\prime}})}&\\\\ &{\\quad\\quad\\quad\\quad=\\mathbf{K}^{\\top}[\\mathbf{G}_{u}+\\lambda\\mathbf{W}]\\mathbf{K}-2\\mathbf{K}^{\\top}\\mathbf{K}^{u,f}+C o n s t.,}&{(28)}\\end{array}\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "where, recalling the definition of the token $\\mathbf{u}_{1:d}$ in (5), ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\mathbf{G}_{u}=(G_{u}(r_{k},r_{k^{\\prime}}))_{1\\leq k,k^{\\prime}\\leq K}=(\\int_{\\Omega}g[u](x,r_{k})g[u](x,r_{k^{\\prime}})d x)_{1\\leq k,k^{\\prime}\\leq K}\\approx\\mathbf{u}_{1:d}\\mathbf{u}_{1:d}^{\\top},\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "$\\mathbf{W}=(W(r_{k},r_{k^{\\prime}}))_{1\\leq k,k^{\\prime}\\leq K}$ and $\\begin{array}{r}{\\mathbf{K}^{u,f}=\\left(\\int_{\\Omega}g[u](r_{k},x)f(x)d x\\right)_{1\\leq k\\leq N}\\!.}\\end{array}$ ", "page_idx": 18}, {"type": "text", "text": "The minimizer of this discrete loss function with the optimal hyper-parameter $\\lambda_{*}$ is ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\widehat{\\mathbf{K}}=(\\mathbf{G}_{u}+\\lambda_{*}\\mathbf{W})^{-1}\\mathbf{K}^{u,f}.\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "In particular, when taking $\\textbf{W}=\\textbf{G}_{u}$ and using the Neumann series $(\\lambda_{*}^{-1}{\\bf G}_{u}^{2}\\;+\\;I)^{-1}\\;\\;=\\;\\;$ $\\textstyle\\sum_{k=0}^{\\bar{\\infty}}(-1)^{k}\\lambda_{*}^{-k}\\mathbf{G}_{u}^{2k}$ , we have ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\hat{\\mathsf{X}}=(\\lambda_{*}^{-1}\\mathbf{G}_{u}^{2}+I)^{-1}\\lambda_{*}^{-1}\\mathbf{G}_{u}\\mathbf{K}^{u,f}=\\lambda_{*}^{-1}\\mathbf{G}_{u}\\mathbf{K}^{u,f}-\\lambda_{*}^{-2}\\mathbf{G}_{u}^{3}\\mathbf{K}^{u,f}+\\sum_{k=2}^{\\infty}(-1)^{k}\\lambda_{*}^{-k}\\mathbf{G}_{u}^{2k}\\mathbf{G}_{u}\\mathbf{K}^{u,f}.\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "In particular, $\\lambda_{*}$ depends on both $\\mathbf{G}_{u}$ and $\\mathbf{K}^{u,f}$ . Hence, the estimator $\\widehat{\\bf K}$ is nonlinear in $\\mathbf{G}_{u}$ and $\\mathbf{K}^{\\bar{u},f}$ , and it is important to make the attention depend nonlinearly on the   token $\\mathbf{u}_{1:d}$ , as in (7). ", "page_idx": 18}, {"type": "text", "text": "Proof of Lemma B.1. Since $K$ is radial and noticing that ", "page_idx": 19}, {"type": "equation", "text": "$$\n\\int_{|\\xi|=1}(u(x+r\\xi)-u(x))d\\xi=u(x+r)+u(x-r)-2u(x)=g[u](r,x)\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "since $\\xi\\in\\mathbb{R}^{1}$ , we can write ", "page_idx": 19}, {"type": "equation", "text": "$$\n\\begin{array}{l}{\\displaystyle{\\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty}K(|s|)K(|r|)\\int_{\\Omega}(u(x+s)-u(x))(u(x+r)-u(x))d x d r d s}}\\\\ {\\displaystyle{=\\int_{0}^{\\infty}\\int_{0}^{\\infty}K(r)K(s)\\int_{|\\xi^{\\prime}|=1}\\int_{|\\xi|=1}\\int_{\\Omega}(u(x+s\\xi^{\\prime})-u(x))(u(x+r\\xi)-u(x))d x d\\xi d\\xi^{\\prime}}}\\\\ {\\displaystyle{=\\int_{0}^{\\infty}\\int_{0}^{\\infty}K(r)K(s)\\int_{\\Omega}g[u](r,x)g[u](s,x)d x d r d s}}\\\\ {\\displaystyle{=\\int_{0}^{\\infty}\\int_{0}^{\\infty}K(r)K(s)G_{u}(r,s)d r d s.}}\\end{array}\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "Meanwhile, by the Riesz representation theorem, there exists a function $K^{u,f}\\in L^{2}(0,\\infty)$ such that ", "page_idx": 19}, {"type": "equation", "text": "$$\n\\begin{array}{l}{{\\displaystyle{\\int_{-\\infty}^{\\infty}K(|r|)\\int_{\\Omega}(u(x+r)-u(x))f(x)d x d r}}}\\\\ {{\\displaystyle{=\\int_{0}^{\\infty}K(r)\\int_{|\\xi|=1}\\int_{\\Omega}(u(x+r)-u(x))f(x)d x d\\xi d r}}}\\\\ {{\\displaystyle{=\\int_{0}^{\\infty}K(r)\\int_{\\Omega}g[u](r,x)f(x)d x d r=\\int_{0}^{\\infty}K(r)K^{u,f}(r)d r.}}}\\end{array}\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "Combining these two equations, we can write the loss function as ", "page_idx": 19}, {"type": "equation", "text": "$$\n\\begin{array}{l}{\\displaystyle\\mathcal{E}(K)=\\int_{\\Omega}\\left[\\int_{-\\infty}^{\\infty}K(|s|)(u(x+s)-u(x))d s-f(x)\\right]^{2}d x}\\\\ {\\displaystyle~~~~~~=\\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty}K(|s|)K(|r|)\\int_{\\Omega}(u(x+s)-u(x))(u(x+r)-u(x))d x d r d s}\\\\ {\\displaystyle~~~~~~~~-\\int_{-\\infty}^{\\infty}K(|s|)\\int_{\\Omega}(u(x+s)-u(x))f(x)d x d s+C o n s t.}\\\\ {\\displaystyle~~~~~~=\\int_{0}^{\\infty}\\int_{0}^{\\infty}K(r)K(s)G_{u}(r,s)d r d s-2\\int_{0}^{\\infty}K(r)K^{u,f}(r)d r+C o n s t.}\\end{array}\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "Then, we can write the regularized loss function $\\mathcal{E}_{\\lambda,W}(K)$ as ", "page_idx": 19}, {"type": "equation", "text": "$$\n\\begin{array}{l}{{\\displaystyle\\mathcal E_{\\lambda,W}(K)=\\int_{0}^{\\infty}\\int_{0}^{\\infty}K(r)K(s)[G_{u}(r,s)+\\lambda W(r,s)]d r d s-2\\int_{0}^{\\infty}K(r)K^{u,f}(r)d r+C o n s t.}}\\\\ {{\\displaystyle\\qquad\\qquad=\\langle(\\mathcal L_{G_{u}}+\\lambda\\mathcal L_{W})K,K\\rangle_{L^{2}(0,\\infty)}-2\\langle K,K^{u,f}\\rangle_{L^{2}(0,\\infty)}+C o n s t.}}\\end{array}\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "Selecting the optimal hyper-parameter $\\lambda_{*}$ , which depends on both $(u,f)$ and $W$ , and setting the Fr\u00e9chet derivative of $\\mathcal{E}_{\\lambda,W}$ over $L^{2}(0,\\infty)$ to be zero, we obtain the regularized estimator in (26). ", "page_idx": 19}, {"type": "text", "text": "C Data generation and additional discussion ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "C.1 Example 1: radial kernel learning ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "In all settings except the \u201csingle task\u201d one, all kernels act on the same set of functions $\\{u_{i}\\}_{i=1,2}$ with $u_{1}=\\bar{\\cos(x)}\\bar{\\mathbf{1}_{[-\\pi,\\pi]}}(x)$ and $u_{2}(x)=\\sin(2x)\\mathbf{1}_{[-\\pi,\\pi]}(x)$ . In the \u201csingle task\u201d setting, to create more diverse samples, the single kernel acts on a set of 14 functions: $u_{k}\\,=\\,\\cos(k x)\\mathbf{1}_{[-\\pi,\\pi]}(x)$ , $k\\,=\\,1,\\cdot\\cdot\\cdot\\,,7$ and $u_{k}(x)\\;=\\;\\sin(k x)\\mathbf{1}_{[-\\pi,\\pi]}(x)$ , $k\\,=\\,8,\\cdots\\,,14$ . In the ground-truth model, the integral $\\mathcal{L}_{\\gamma_{\\eta}}[u_{i}]$ is computed by the adaptive Gauss-Kronrod quadrature method, which is much more accurate than the Riemann sum integrator that we use in the learning stage. To create discrete datasets with different resolutions, for each $\\Delta x\\in0.0125\\times\\{1,2\\}$ , we take values $\\{u_{i},f_{i}\\}_{i=1}^{N}=$ $\\{u_{i}(x_{j}),f_{i}(x_{j}):x_{j}\\in[-40,40],j=1,\\ldots,J\\}_{i=1}^{N}$ , where $x_{j}$ is the grid point on the uniform mesh of size $\\Delta x$ . We form a training sample of each task by taking $d$ pairs from this task. When taking the token size $d$ and $k$ function pairs, each task contains $\\lfloor{\\frac{2265}{d}}\\rfloor\\times k$ samples. ", "page_idx": 19}, {"type": "image", "img_path": "uSKzEaj9zJ/tmp/a699f8b3fcd0e1a4a488ba24513910c34233e1e7edb8edbf9cc4d1a800ee6caa.jpg", "img_caption": ["Figure 5: OOD test results on radial kernel learning, with diverse training tasks and $d\\,=\\,302$ . OOD1 (left): true kernel $\\gamma(r)=r(11-r)\\exp(-5r)\\sin(6r){\\bf1}_{[0,11]}(r)$ ; OOD2 (right): true kernel $\\begin{array}{r}{\\gamma(r)=\\frac{\\exp(-0.5r^{2})}{\\sqrt{2\\pi}}}\\end{array}$ , a Gaussian kernel which is very different from all training tasks. "], "img_footnote": [], "page_idx": 20}, {"type": "text", "text": "", "page_idx": 20}, {"type": "text", "text": "More diverse tasks. To further evaluate the generalization capability of NAO as a foundation model, we add another two types of kernels into the training dataset. The training dataset is now constructed based on 21 kernels of three groups, with 15 samples on each kernel: ", "page_idx": 20}, {"type": "equation", "text": "$\\gamma_{\\eta}^{\\sin}(r)=\\exp(-\\eta r)\\sin(6r)\\mathbf{1}_{[0,11]}(r),\\eta=1,2,3,4,6,7,8.$ ", "text_format": "latex", "page_idx": 20}, {"type": "equation", "text": "$\\begin{array}{r}{\\gamma_{\\eta}^{\\mathrm{cos}}(r)=\\frac{10-r}{20}\\cos(\\eta r)(10-r)\\mathbf{1}_{[0,10]}(r),\\eta=0,1,2,3,4,5,6,7,9,9,10,11\\ldots,9.}\\end{array}$ ", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "Based on this enriched dataset, besides the original \u201csine only\u201d setting, three additional settings are considered to compare the generalizability across different settings. The results are reported in Table 4 and Figure 5. In addition to the original setting corresponding to all \u201csine\u201d kernels, in part II of Table 4 (denoted as \u201csine+cosine+polyn\u201d), we consider a \u201cdiverse task\u201d setting, where all 315 samples are employed in training. In part III, we consider a \u201csingle task\u201d setting, where only the first sine-type kernel, $\\gamma(r)=\\exp(-r)\\sin(6r)\\mathbf{1}_{[0,11]}(r)$ , is considered as the training task, with 105 samples on this task. Lastly, in part IV we demonstrate a \u201cfewer samples\u201d setting, where the training dataset still consists of all 21 tasks but with only 5 samples on each task. For testing, besides the ID and OOD tasks in the ablation study, we add an additional OOD task with a Gaussian-type kernel $\\begin{array}{r}{\\gamma_{o o d2}(r)=\\frac{\\exp(-0.5r^{2})}{\\sqrt{2\\pi}}}\\end{array}$ , which is substantially different from all training tasks. ", "page_idx": 20}, {"type": "text", "text": "As shown in Table 4, considering diverse datasets helps in both OOD tests (the kernel error is reduced from $9.14\\%$ to $6.92\\%$ in OOD test 1, and from $329.66\\%$ to $10.48\\%$ in OOD test 2), but not for the ID test (the kernel error is slightly increased from $4.03\\%$ to $5.04\\%$ ). We also note that since the \u201csine only\u201d setting only sees systems with the same kernel frequency in training, it does not generalize to OOD test 2, where it becomes necessary to include more diverse training tasks. As the training tasks become more diverse, the intrinsic dimension of kernel space increases, requiring a larger rank size $d_{k}$ of the weight matrices. When comparing the \u201cfewer samples\u201d setting with the \u201csine only\u201d setting, the former exhibits better task diversity but fewer samples per task. One can see that the performance deteriorates on the ID test but improves on OOD test 2. This observation emphasizes the balance between the diversity of tasks and the number of training samples per task. ", "page_idx": 20}, {"type": "text", "text": "C.2 Example 2: solution operator learning ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "For one example, we generate the synthetic data based on the Darcy flow in a square domain of size $1\\times1$ subjected to Dirichlet boundary conditions. The problem setting is: $-\\nabla(\\bar{b}(x)\\nabla p(x))=g(x)$ subjected to $p(x)\\,=\\,0$ on all boundaries. This equation describes the diffusion in heterogeneous fields, such as the subsurface flow of underground water in porous media. The heterogeneity is represented by the location-dependent conductivity $b(x).\\ p(x)$ is the source term, and the hydraulic ", "page_idx": 20}, {"type": "text", "text": "Table 4: Training and test for the radial kernel problem with more diverse tasks with fixed $d\\,=$ 302, where bold numbers highlight the best methods across different data settings. These results emphasize the balance between task diversity and the number of samples per task. ", "page_idx": 21}, {"type": "table", "img_path": "uSKzEaj9zJ/tmp/c8ee046e2bb03faa0fd8cdc50a546f56f72fa41dc938acd49caa0ed42875a8df.jpg", "table_caption": [], "table_footnote": [], "page_idx": 21}, {"type": "text", "text": "height $g(x)$ is the solution. For each data instance, we solve the equation on a $21\\times21$ grid using an in-house finite difference code. We consider 500 random microstructures consisting of two distinct phases. For each microstructure, the square domain is randomly divided into two subdomains with different conductivity of either 12 or 3. Additionally, we consider 100 different $g(x)$ functions obtained via a Gaussian random field generator. For each microstructure, we solve the Darcy problem considering all 100 source terms, resulting in a dataset of $N=10,000$ function pairs in the form of $\\{p_{i}(x_{j}),\\stackrel{\\bullet}{,}g_{i}(x_{j})\\}_{i=1}^{N}$ , and $j=1,2,\\cdots\\,,441$ where $x_{j}$ \u2019s are the discretization points on the square domain. ", "page_idx": 21}, {"type": "text", "text": "In operator learning settings, we note that the permutation of function pairs in each sample should not change the learned kernel, i.e., one should have $K[\\mathbf{u}_{1:d},\\mathbf{f}_{1:d}]=K[\\mathbf{u}_{\\sigma(1:d)},\\mathbf{f}_{\\sigma(1:d)}]$ , where $\\sigma$ is the permutation operator. Hence, we augment the training dataset by permuting the function pairs in each task. Specifically, with 100 microstructures (tasks) and 100 function pairs per task, we randomly permut the function pairs and take 100 function pairs for 100 times per task. As a result, we can generate a total of 10000 samples (9000 for training and 1000 for testing) in the form of $\\{\\boldsymbol{u}_{1:100}^{\\eta},\\}_{1:100}^{\\eta}\\}_{\\eta=1}^{10000}$ ", "page_idx": 21}, {"type": "text", "text": "C.3 Example 3: heterogeneous material learning ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "In the Mechanical MNIST dataset, we generate a large set of heterogeneous material responses subjected to mechanical forces. This is similar to the approach in Lejeune [2020]. The material property (stiffness) of the heterogeneous medium is constructed assuming a linear scaling between 1 and 100, according to the gray-scale bitmap of the MNIST images, which results in a set of 2D square domains with properties that vary according to MNIST digit patterns. The problem setting for this data set is the equilibrium equation: $-\\nabla\\cdot{\\dot{P}}(x)\\,=\\,f(x)$ subjected to Dirichlet boundary condition of zero displacement and nonzero variable external forces: $f(x)$ . $P(x)=\\hat{P}(I+\\nabla u(x))$ is the stress tensor and is a nonlinear function of displacement $u(x)$ . The choice of material models determines the stress function, and here we employ the Neo-Hookean material model as in Lejeune [2020]. From MNIST, we took 50 samples of each digit resulting in a total of 500 microstructures. We consider 200 different external forces $f(x)$ obtained via a Gaussian random field, and solve the problem for each pair of microstructure and external force, resulting in $N=100,000$ samples. To solve each sample, we use FEniCS finite element package considering a $140\\,\\times\\,140$ uniform mesh. We then downsample from the finite element nodes to get values for the solution $u(x)$ and external force $f(x)$ on a the coarser $29\\times29$ equi-spaced grid. The resulting dataset is of the form: $\\{u_{i}(x_{j}),f_{i}(x_{j})\\}_{i=1}^{N}$ , and $j=1,2,...,841$ where $x_{j}$ \u2019s are the equi-spaced sampled spatial points. ", "page_idx": 21}, {"type": "text", "text": "", "page_idx": 22}, {"type": "text", "text": "Similar to Example 2, we perform the permutation trick to augment the training data. In particular, with 500 microstructures (tasks) and 200 function pairs per task, we randomly permute the function pairs and take 100 function pairs for 100 times per task. As a result, we can generate a total of 50000 samples, where 45000 are used for training and 5000 for testing. ", "page_idx": 22}, {"type": "text", "text": "D Computational complexity ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Denote $(N,d,d_{k},L,n_{t r a i n})$ as the size of the spatial mesh, the number of data pairs in each training model, the column width of the query/key weight matrices $W^{Q}$ and $W^{K}$ , the number of layers, and the number of training models. The number of trainable parameters in a discrete NAO is of size $O(L\\times d\\times d_{k}+N^{2})$ . For continuous-kernel NAO, taking a three-layer MLP as a dense net of size $(d,h_{1},h_{2},1)$ for the trainable kernels $W^{P,u}$ and $W^{P,f}$ for example, its the corresponding number of trainable parameters is $O(d\\times h_{1}+h_{1}\\times h_{2})$ . Thus, the total number of trainable parameters for a continuous-kernel NAO is $O(L\\times d\\times d_{k}+d\\times h_{1}+h_{1}\\times h_{2})$ . ", "page_idx": 22}, {"type": "text", "text": "The computational complexity of NAO is quadratic in the length of the input and linear in the data size, with $O([d^{2}(3\\dot{N}+\\dot{d}_{k})+6N^{2}d]L\\dot{n}_{t r a i n})$ flops in each epoch in the optimization. It is computed as follows for each layer and the data of each training model: the attention function takes $O(d^{\\dot{2}}d_{k}+2{\\cal N}d^{2}+4{\\cal N}^{2}d)$ flops, and the kernel map takes $O(\\check{d}^{2}d_{k}+N d^{2}+2N^{2}d)$ flops; thus, the total is $O(d^{2}(3N+d_{k})+6\\bar{N}^{2}d)$ flops. In inverse PDE problems, we generally have $d\\ll N$ , and hence the complexity of NAO is ${\\cal O}(N^{2}d)$ per layer per sample. ", "page_idx": 22}, {"type": "text", "text": "Compared with other methods, it is important to note that NAO solves both forward and ill-posed inverse problems using multi-model data. Thus, we don\u2019t compare it with methods that solve the problems for a single model data, for instance, the regularized estimator in Appendix B. Methods solving similar problems are the original attention model [Vaswani et al., 2017], convolution neural network (CNN), and graph neural network (GNN). As discussed in Vaswani et al. [2017], these models have a similar computational complexity, if not any higher. In particular, the complexity of the original attention model is $O(N^{2}d)$ , and the complexity of CNN is $O(k N d^{2})$ with $k$ being the kernel size, and a full GNN is of complexity $O(N^{2}d^{2})$ . ", "page_idx": 22}, {"type": "text", "text": "NeurIPS Paper Checklist ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "1. Claims ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: Do the main claims made in the abstract and introduction accurately reflect the paper\u2019s contributions and scope? ", "page_idx": 23}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 23}, {"type": "text", "text": "Justification: We have clearly stated our claims in the abstract and introduction, including the key contributions that our proposed model NAO provides a novel input-dependent kernel for context extraction, integrates forward and inverse PDE predictions in one framework, and offers the capability in solving ill-posed inverse PDE problems. ", "page_idx": 23}, {"type": "text", "text": "2. Limitations ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: Does the paper discuss the limitations of the work performed by the authors? Answer: [Yes] ", "page_idx": 23}, {"type": "text", "text": "Justification: The limitations of the work is discussed in the Conclusion section. ", "page_idx": 23}, {"type": "text", "text": "3. Theory Assumptions and Proofs ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: For each theoretical result, does the paper provide the full set of assumptions and a complete (and correct) proof? ", "page_idx": 23}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 23}, {"type": "text", "text": "Justification: We have provided the full set of assumptions and corresponding complete proofs under each proposed Lemma with detailed derivations included in the Appendix A and B. ", "page_idx": 23}, {"type": "text", "text": "4. Experimental Result Reproducibility ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: Does the paper fully disclose all the information needed to reproduce the main experimental results of the paper to the extent that it affects the main claims and/or conclusions of the paper (regardless of whether the code and data are provided or not)? ", "page_idx": 23}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 23}, {"type": "text", "text": "Justification: We have elaborated the detailed architectures of the proposed model in the main body of the paper as well as data generation details in Appendix C. The code and accompanying data have been released at https://github.com/fishmoon1234/NAO. ", "page_idx": 23}, {"type": "text", "text": "5. Open access to data and code ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: Does the paper provide open access to the data and code, with sufficient instructions to faithfully reproduce the main experimental results, as described in supplemental material? ", "page_idx": 23}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 23}, {"type": "text", "text": "Justification: The code and accompanying data have been released at https://github.   \ncom/fishmoon1234/NAO. ", "page_idx": 23}, {"type": "text", "text": "6. Experimental Setting/Details ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: Does the paper specify all the training and test details (e.g., data splits, hyperparameters, how they were chosen, type of optimizer, etc.) necessary to understand the results? ", "page_idx": 23}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 23}, {"type": "text", "text": "Justification: We briefly state the training and test strategies at the beginning of the Experiments section, with the full details provided in Appendix C. ", "page_idx": 23}, {"type": "text", "text": "7. Experiment Statistical Significance ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: Does the paper report error bars suitably and correctly defined or other appropriate information about the statistical significance of the experiments? ", "page_idx": 23}, {"type": "text", "text": "Answer: [No] ", "page_idx": 23}, {"type": "text", "text": "Justification: Error bars are not reported due to the limited computational resource. Nevertheless, we have tuned the hyperparameters of all the considered models and reported extensive results in a large variety of settings, and they all support our claim. ", "page_idx": 23}, {"type": "text", "text": "8. Experiments Compute Resources ", "page_idx": 24}, {"type": "text", "text": "Question: For each experiment, does the paper provide sufficient information on the computer resources (type of compute workers, memory, time of execution) needed to reproduce the experiments? ", "page_idx": 24}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 24}, {"type": "text", "text": "Justification: The computing resources are reported in the first paragraph of the Experiments section. In particular, all the experiments are conducted on a single NVIDIA GeForce RTX 3090 GPU with 24 GB memory. ", "page_idx": 24}, {"type": "text", "text": "9. Code Of Ethics ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Question: Does the research conducted in the paper conform, in every respect, with the NeurIPS Code of Ethics https://neurips.cc/public/EthicsGuidelines? ", "page_idx": 24}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 24}, {"type": "text", "text": "Justification: The research conducted in the paper conform with the NeurIPS Code of Ethics. ", "page_idx": 24}, {"type": "text", "text": "10. Broader Impacts ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Question: Does the paper discuss both potential positive societal impacts and negative societal impacts of the work performed? ", "page_idx": 24}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 24}, {"type": "text", "text": "Justification: The discussion on the societal impacts can be found in the Conclusion section. ", "page_idx": 24}, {"type": "text", "text": "11. Safeguards ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Question: Does the paper describe safeguards that have been put in place for responsible release of data or models that have a high risk for misuse (e.g., pretrained language models, image generators, or scraped datasets)? ", "page_idx": 24}, {"type": "text", "text": "Answer: [NA] Justification: The paper poses no such risks. ", "page_idx": 24}, {"type": "text", "text": "12. Licenses for existing assets ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Question: Are the creators or original owners of assets (e.g., code, data, models), used in the paper, properly credited and are the license and terms of use explicitly mentioned and properly respected? ", "page_idx": 24}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 24}, {"type": "text", "text": "Justification: We have cited the original papers that produced the code package or dataset where appropriate. ", "page_idx": 24}, {"type": "text", "text": "13. New Assets ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Question: Are new assets introduced in the paper well documented and is the documentation provided alongside the assets? ", "page_idx": 24}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Justification: The code and accompanying data have been released at https://github.   \ncom/fishmoon1234/NAO, with instructions and pretrained models provided. ", "page_idx": 24}, {"type": "text", "text": "14. Crowdsourcing and Research with Human Subjects ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Question: For crowdsourcing experiments and research with human subjects, does the paper include the full text of instructions given to participants and screenshots, if applicable, as well as details about compensation (if any)? ", "page_idx": 24}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 24}, {"type": "text", "text": "Justification: The paper does not involve crowdsourcing nor research with human subjects. ", "page_idx": 24}, {"type": "text", "text": "15. Institutional Review Board (IRB) Approvals or Equivalent for Research with Human Subjects ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Question: Does the paper describe potential risks incurred by study participants, whether such risks were disclosed to the subjects, and whether Institutional Review Board (IRB) approvals (or an equivalent approval/review based on the requirements of your country or institution) were obtained? ", "page_idx": 24}, {"type": "text", "text": "Answer: [NA] ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "Justification: The paper does not involve crowdsourcing nor research with human subjects. ", "page_idx": 25}]