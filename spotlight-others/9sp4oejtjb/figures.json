[{"figure_path": "9sP4oejtjB/figures/figures_2_1.jpg", "caption": "Figure 1: A. Graphical model of a Cell-Type latent Dynamical System (CTDS). Red and blue circles represent the observed activity, yt, of excitatory and inhibitory neurons respectively at time t. The color of the latents xt reflects the cell-type they govern. ut is any input to the system at the time t. B. Latent dynamics, A, obeys Dale's law, such that the columns of A are either non-negative or non-positive corresponding to E and I latents. C. Distinct sets of latents govern the activity of E and I neurons. The emission matrix, C, is also constrained to be non-negative such that the Dale's law constraint in the latent space is reflected to the neural activity space.", "description": "This figure is a graphical model showing the structure of the Cell-Type Dynamical System (CTDS) model.  Panel A shows the overall model structure with inputs (stimulus), latent variables for excitatory and inhibitory neurons, and outputs (observed activity). Panel B details the latent dynamics matrix (A) which is constrained to obey Dale's Law (excitatory neurons have positive weights, inhibitory neurons have negative weights).  Panel C shows how the cell-specific latent variables are mapped to the observed neuronal activity via an emission matrix (C) which also has non-negativity constraints.", "section": "2 Cell-type latent linear dynamical systems (CTDS)"}, {"figure_path": "9sP4oejtjB/figures/figures_6_1.jpg", "caption": "Figure 2: CTDS applied to decision-making task in rodents. A. \u201cPoisson clicks", "description": "This figure demonstrates the application of the Cell-Type Dynamical Systems (CTDS) model to neural data from a rodent auditory decision-making task. Panel A illustrates the experimental task design.  Panel B displays test log-likelihood for different model types (LDS, CTDS, multi-region CTDS) as a function of the number of latent dimensions.  Panel C shows choice accuracy using classifiers trained on inferred latent states. Panel D shows the recovered dynamics matrix A from the multi-region CTDS model, highlighting within-region and between-region interactions. Panel E visualizes the trajectories of inferred latent states for different cell types (excitatory and inhibitory) in the FOF and ADS brain regions, demonstrating that both cell types encode information relevant to the animal's choice.", "section": "4 Application to rodent decision-making data"}, {"figure_path": "9sP4oejtjB/figures/figures_7_1.jpg", "caption": "Figure 3: In-silico perturbations using fitted multi-region CTDS and LDS models. A. The right y-axis displays the experimentally observed ipsilateral bias from in-vivo perturbations performed by [14]. The left y-axis shows the behavioral bias predicted by the CTDS and LDS models when silencing FOF E neurons during the early and late halves of a trial, relative to the correct choice for that trial. For the LDS model, 50% of FOF latents were randomly silenced, as this model does not distinguish cell types. B. Similar to A, but with ADS I neurons silenced during the early and late halves of trials. Separate y-axes are used because the magnitude of model inactivation was not tuned to match the experimental bias, though the relative bias changes are well captured by the CTDS model. Error bars on the left y-axes represent one standard error across 10 different sampled latents from the fitted models, while those on the right y-axis show one standard error across all animals.", "description": "This figure displays the results of in-silico optogenetic perturbation experiments using both CTDS and LDS models.  It compares the model-predicted behavioral biases with experimentally observed biases when silencing excitatory neurons in the frontal orienting fields (FOF) and inhibitory neurons in the anterior dorsal striatum (ADS) during early and late stages of a decision-making task.  The CTDS model, which incorporates distinct cell types, more accurately replicates the experimental findings than the standard LDS model.", "section": "4.3 In-silico optogenetic perturbation experiments"}, {"figure_path": "9sP4oejtjB/figures/figures_7_2.jpg", "caption": "Figure 2: CTDS applied to decision-making task in rodents. A. \u201cPoisson clicks", "description": "Figure 2 shows the results of applying the Cell-Type Dynamical System (CTDS) model to neural data from a rodent decision-making task. Panel A describes the experimental setup of the auditory decision-making task. Panels B and C show the performance of the CTDS model compared to other models in terms of log-likelihood and choice prediction accuracy. Panel D displays the recovered dynamics matrix, illustrating the interactions between different brain regions and cell types. Finally, Panel E presents the trajectories of latent states for different cell types, color-coded by the animal's choice.", "section": "4 Application to rodent decision-making data"}, {"figure_path": "9sP4oejtjB/figures/figures_8_1.jpg", "caption": "Figure 2: CTDS applied to decision-making task in rodents. A. \u201cPoisson clicks", "description": "This figure shows the results of applying the Cell-Type Dynamical Systems (CTDS) model to neural data from a rodent decision-making task. Panel A illustrates the experimental setup of the task. Panel B shows the test log-likelihood of different models (LDS, CTDS, multi-region CTDS) as a function of the number of latent dimensions. Panel C displays the choice accuracy of classifiers trained on the inferred latent states of the different models. Panel D presents the recovered dynamics matrix from a multi-region CTDS model. Finally, Panel E visualizes the latent state trajectories of the FOF and ADS regions, colored by the animal's choice.", "section": "4 Application to rodent decision-making data"}, {"figure_path": "9sP4oejtjB/figures/figures_9_1.jpg", "caption": "Figure 6: Cell-type identification. (A) Schematic of unknown cell type problem. (B) Accuracy of cell-type inference as a function of the number of masked neurons. Error bars show one standard error over 10 initialization seeds. Dotted line represents random performance.", "description": "This figure demonstrates the accuracy of a novel method for inferring cell types from neural activity using the Cell-Type Dynamical System (CTDS) model. Panel A shows a schematic illustrating the problem of identifying cell types for neurons whose type is unknown. Panel B presents the results of an experiment where a CTDS model was trained on data from a subset of neurons with known cell types, and then used to predict the cell types of other neurons whose types were masked. The accuracy of the cell type predictions is shown as a function of the number of masked neurons. The error bars show the standard error over 10 random initializations. The dotted line represents the chance level of accuracy.", "section": "5 Inferring cell-type information of unknown neurons"}, {"figure_path": "9sP4oejtjB/figures/figures_14_1.jpg", "caption": "Figure A1: Simulations with an E-I network. A Schematic of an E-I RNN, with red units representing excitatory cells and blue units representing inhibitory cells. Example generated activity from 10 randomly selected neurons. B. Top shows the true connectivity matrix J, while the bottom plot shows the J recovered using a CTDS. C. Root mean squared error between true and recovered J using a standard LDS and a CTDS model, each of latent state dimensionality 4. We fitted them to data from two E-I networks with 100 and 200 units each. The shaded region represents 95% confidence interval.", "description": "This figure shows the results of simulations performed to compare the performance of the CTDS model against a standard LDS model in recovering the connectivity matrix (J) of an E-I RNN (Excitatory-Inhibitory Recurrent Neural Network).  Panel A illustrates the structure of the E-I RNN used for the simulation. Panel B compares the true connectivity matrix J with the J recovered by CTDS.  Panel C shows the root mean squared error (RMSE) of J recovered by CTDS and LDS for networks with 100 and 200 units. The results demonstrate that CTDS recovers the true connectivity more accurately than LDS.", "section": "A2 Simulations with an E-I RNN"}, {"figure_path": "9sP4oejtjB/figures/figures_15_1.jpg", "caption": "Figure 2: CTDS applied to decision-making task in rodents. A. \u201cPoisson clicks", "description": "Figure 2 presents the results of applying the Cell-Type Dynamical Systems (CTDS) model to decision-making data from rodents. Panel A illustrates the experimental task design, Panel B shows the test log-likelihood as a function of the number of latents per cell type for three different models, Panel C displays choice accuracy results, and Panel D shows the recovered dynamics matrix A from a multi-region CTDS analysis. Panel E visualizes latent state trajectories for excitatory and inhibitory neurons in the frontal orienting fields (FOF) and inhibitory neurons in the anterior dorsal striatum (ADS), color-coded by the animal's choice.", "section": "4 Application to rodent decision-making data"}, {"figure_path": "9sP4oejtjB/figures/figures_15_2.jpg", "caption": "Figure 2: CTDS applied to decision-making task in rodents. A. \u201cPoisson clicks", "description": "Figure 2 presents the results of applying the CTDS model to neural data from a rodent decision-making task. It shows the test log-likelihood for different models (LDS, CTDS, multi-region CTDS), choice accuracy of classifiers trained on the inferred latents, and recovered dynamics matrices. The latent state trajectories are also visualized, showing clear separation for left and right choices, indicating that both excitatory and inhibitory neurons in the FOF encode choice information and that the ADS latents encode choice information.", "section": "4 Application to rodent decision-making data"}]