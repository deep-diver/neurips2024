[{"type": "text", "text": "Exploring Context Window of Large Language Models via Decomposed Positional Vectors ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Zican Dong1,\u2217 Junyi $\\mathbf{Li}^{3*}$ , Xin Men4, Wayne Xin Zhao1,\u2020 Bingning Wang4 Zhen Tian1, Weipeng Chen4, Ji-Rong Wen1,2 ", "page_idx": 0}, {"type": "text", "text": "Gaoling School of Artificial Intelligence, Renmin University of China 2 School of Information, Renmin University of China   \n3 Department of Computer Science, National University of Singapore 4 Baichuan Inc. dongzican@ruc.edu.cn, junyi_cs@nus.edu.sg batmanfly@gmail.com, daniel@baichuan-inc.com ", "page_idx": 0}, {"type": "text", "text": "Abstract ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Transformer-based large language models (LLMs) typically have a limited context window, resulting in significant performance degradation when processing text beyond the length of the context window. Extensive studies have been proposed to extend the context window and achieve length extrapolation of LLMs, but there is still a lack of in-depth interpretation of these approaches. In this study, we explore the positional information within and beyond the context window for deciphering the underlying mechanism of LLMs. By using a mean-based decomposition method, we disentangle positional vectors from hidden states of LLMs and analyze their formation and effect on attention. Furthermore, when texts exceed the context window, we analyze the change of positional vectors in two settings, i.e., direct extrapolation and context window extension. Based on our findings, we design two training-free context window extension methods, positional vector replacement and attention window extension. Experimental results show that our methods can effectively extend the context window length. ", "page_idx": 0}, {"type": "text", "text": "1 Introduction ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Recently, Transformer-based large language models (LLMs) have demonstrated excellent capabilities on downstream tasks [1\u20133], in which positional encodings (e.g., absolute or relative) are widely used in Transformers to better capture positional information within input sequences [4, 5]. However, LLMs typically suffer from a limited input length (called context window), which is constrained by the maximum length of training data. Beyond the context window, the positional encodings at larger position indices are out-of-distribution (OOD), not encountered during the training phase. Therefore, when the input sequence exceeds the context window length, there would often be a significant degradation in model performances, as evidenced by a surge in perplexity (PPL) score [6]. ", "page_idx": 0}, {"type": "text", "text": "Prior work has primarily focused on extending the context window of existing LLMs by manipulating positional encodings. Owing to its excellent performance and long-term decay nature, RoPE [7] has been widely used to learn positional encodings for existing LLMs [8, 9]. To circumvent the OOD positional encodings in RoPE, various methods have been proposed to modify the base [10\u201312] or positional indices [13\u201316]. In addition, special relative positional encodings that apply larger negative biases to attention based on the relative distance have achieved promising length extrapolation, which can effectively stabilize the model performance beyond the context window [6, 17, 18]. Furthermore, decoder-only Transformers without positional encodings (NoPE) have been found to be capable of learning implicit positional information [19], and their context window size can be extended via the adjustment of temperature hyper-parameters [20]. However, the above extension methods solely focus on adapting positional encodings or attention scores, lacking a detailed analysis of the underlying mechanisms of hidden states in LLMs. ", "page_idx": 0}, {"type": "text", "text": "", "page_idx": 1}, {"type": "text", "text": "In this work, we aim to investigate the inner working mechanism of LLMs within and beyond the context window to interpret these context window extension approaches. As the basis, our work is developed by analyzing the positional information implicitly encoded in the hidden states of LLMs across various layers and positions, both within and outside the context window. Inspired by previous work [21], we use a mean-based decomposition approach to disentangle positional vectors from the hidden states, which captures the information independent of semantics but related to positions. ", "page_idx": 1}, {"type": "text", "text": "Specifically, we first investigate how positional information is formed and examine its impact on the attention mechanism within the context window. Second, for inputs beyond the context window, we analyze the change of positional vectors in two settings, i.e., direct extrapolation and context window extension. Our key findings include: (1) After the first layer, initial tokens can form distinct positional vectors, serving as anchors for shaping positional vectors in subsequent tokens; (2) Positional vectors play a critical role in modulating the long-term decay and establishing attention sinks; (3) When exceeding the context window, OOD positional vector is the major factor contributing to performance degradation, while length extrapolation can effectively keep the consistency of positional vectors both within and beyond the context window; (4) Context window extension methods enable interpolation of positional vectors by adjusting the information flow from initial tokens to subsequent tokens. ", "page_idx": 1}, {"type": "text", "text": "Based on the empirical findings, we further propose two training-free context window extension methods from the perspective of interpolating positional vectors: positional vector replacement and attention window extension. For LLMs with NoPE, the former method replaces the positional vectors in critical layers with interpolated ones; while for LLMs with window attention and NoPE, the latter method directly scales the window size and adjusts the temperature hyper-parameter. We evaluate the length generalization capacities of the proposed methods on PG-19 [22]. Experimental results demonstrate that our methods can effectively generalize to longer texts without fine-tuning, achieving comparable performance to previous methods. ", "page_idx": 1}, {"type": "text", "text": "Our main contributions are summarized as follows: ", "page_idx": 1}, {"type": "text", "text": "\u2022 We explicitly delineate the formation process and the effect of positional vectors, highlighting the anchoring role of initial tokens in shaping different positional vectors across tokens and their importance in achieving long-term decay and attention sinks.   \n\u2022 We are the first to unify length extrapolation and context window extension from the perspective of positional vectors, identifying that preventing OOD positional vectors is crucial for avoiding performance degradation.   \n\u2022 We propose two training-free context window extension methods via the lens of adjusting positional vectors, i.e.,positional vector replacement and attention window extension. Experimental results show that our methods can effectively generalize to longer texts without fine-tuning. ", "page_idx": 1}, {"type": "text", "text": "2 Background ", "text_level": 1, "page_idx": 1}, {"type": "text", "text": "Transformer Decoder-only Transformer [4] has become the foundational architecture for LLMs [4, 8, 1]. For a Transformer with $L$ layers and a context window size $C$ , given an input sequence s of $T$ tokens, i.e., $\\{x_{1},\\dots,x_{T}\\}$ , we denote the output of the $l_{\\cdot}$ -th layer $l$ as $\\mathbf{H}_{l}^{s}=\\{\\mathbf{h}_{l,1}^{s},\\dots,\\mathbf{h}_{l,T}^{s}\\}$ . At each layer, the output $\\mathbf{H}_{l}^{s}$ is obtained through multi-head attention (MHA) and feed-forward network (FFN) with residual connections applied to both components as follows: ", "page_idx": 1}, {"type": "equation", "text": "$$\n\\mathbf{\\widetilde{H}}_{l}^{s}=\\mathrm{MHA}(\\mathbf{H}_{l-1}^{s})+\\mathbf{H}_{l-1}^{s},\\quad\\mathbf{H}_{l}^{s}=\\mathrm{FFN}(\\mathbf{\\widetilde{H}}_{l}^{s})+\\mathbf{\\widetilde{H}}_{l}^{s}.\n$$", "text_format": "latex", "page_idx": 1}, {"type": "text", "text": "Finally, the output of the last layer $\\mathbf{H}_{L}^{s}$ is then projected into the logits, which will be used to generate the prediction probability for each token in the vocabulary. ", "page_idx": 1}, {"type": "text", "text": "Positional Vector Previous work has found that positional information can be learned and encoded in the hidden states of Transformers [19]. Drawing inspiration from prior work [21], we hypothesize that each hidden state (e.g., query, key, value, output of each layer) within Transformer can be decomposed into two parts, i.e., a positional vector that captures positional information and a semantic vector that captures the contextual information. Taking the output $\\mathbf{h}_{l,t}^{s}$ of the $l_{\\cdot}$ -th layer at $t$ -th position as an example, it can be decomposed into a positional vector $\\mathbf{p}_{l,t}$ and a semantic vector $\\mathbf{c}_{l,t}^{s}$ : ", "page_idx": 1}, {"type": "text", "text": "", "page_idx": 2}, {"type": "equation", "text": "$$\n\\mathbf{h}_{l,t}^{s}=\\mathbf{p}_{l,t}+\\mathbf{c}_{l,t}^{s}.\n$$", "text_format": "latex", "page_idx": 2}, {"type": "text", "text": "Such a decomposition can disentangle two primary factors, namely positional and semantic vectors, for interpreting the internal mechanism of LLMs. Notably, since positional vectors are globally shared across different inputs, there is no superscript $s$ for $\\mathbf{p}_{l,t}$ . Further, the positional vector $\\mathbf{p}_{l,t}$ can be decomposed into a mean vector $\\mathbf{u}_{l}$ and a positional basis ${\\bf{m}}_{l,t}$ : ", "page_idx": 2}, {"type": "equation", "text": "$$\n\\mathbf{p}_{l,t}=\\mathbf{u}_{l}+\\mathbf{m}_{l,t},\n$$", "text_format": "latex", "page_idx": 2}, {"type": "text", "text": "where the mean vector $\\mathbf{u}_{l}$ denotes the mean of the distribution of positional vectors and the positional basis ${\\bf{m}}_{l,t}$ denotes the offset of $t$ -th position from the mean vector within the context window size $C$ . Following previous work [21], we adopt a mean-based decomposition method to obtain the above three vectors based on $N$ samples from the training corpus as follows: ", "page_idx": 2}, {"type": "equation", "text": "$$\n\\mathbf{p}_{l,t}=\\frac{1}{N}\\sum_{s=1}^{N}\\mathbf{h}_{l,t}^{s},\\;\\;\\;\\mathbf{m}_{l,t}=\\mathbf{p}_{l,t}-\\frac{1}{C}\\sum_{t^{\\prime}=1}^{C}\\mathbf{p}_{l,t^{\\prime}},\\;\\;\\;\\mathbf{c}_{l,t}^{s}=\\mathbf{h}_{l,t}^{s}-\\mathbf{p}_{l,t}.\n$$", "text_format": "latex", "page_idx": 2}, {"type": "text", "text": "With this decomposition, it offers an explicit way to analyze and explore the positional information encoded in the hidden states of Transformer models. For example, we can use similarity measurements to compare the positional vectors of different positions and also can visualize them in low-dimensional embedding space. In the following sections, we will mainly focus on studying the formation and impact of the positional vector $\\mathbf{p}_{l,t}$ , and conduct the analysis experiments. ", "page_idx": 2}, {"type": "text", "text": "3 Empirical Analysis ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "3.1 Experimental Settings ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "To better analyze positional information, we consider model variants with different positional encodings (PE) and attention mechanisms: variants without positional encodings (NoPE) [19] as well as variants with two different positional encodings: RoPE [7] and ALiBi [6]. We continually pre-train the TinyLlama-1.1B checkpoint [23] on 50B tokens from RedPajama [24] with a context window $C=2048$ , resulting in a set of comparison models with different positional encodings and attention mechanisms, as shown in the Table 1. Full attention means that each token can attend to all previous tokens, while window attention restricts each token to attend only to previous tokens within a window size $W$ . The training details are described in Appendix A. We also evaluate common LLMs (e.g., Llama-3-8B) and LLMs without positional encodings trained from scratch, and the evaluated results are listed in Appendix F. ", "page_idx": 2}, {"type": "text", "text": "Specifically, we subsample 32K samples with the same number of tokens from RedPajama. We perform the inference on these data to obtain hidden states of LLMs. By using the mean-based decomposition method (Eq. 4), we can obtain the positional vectors $\\mathbf{p}_{l,t}$ of tokens in these sample texts. ", "page_idx": 2}, {"type": "table", "img_path": "zeYyq0GpXO/tmp/d64c1382df26961ff23023f3aebb665960588a3dcc3ffb1347e94c5a76cd6589.jpg", "table_caption": ["Table 1: The compared model variants. Full attention is denoted as Full and window attention with a window size of $W$ tokens is denoted as Window $(W)$ . We abbreviate TinyLLaMA as $T L$ . "], "table_footnote": [], "page_idx": 2}, {"type": "text", "text": "3.2 Formation and Effect of Positional Vectors within Context Window ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "In existing LLMs, the bottom (first) layer typically takes as input token embeddings that lack inherent positional information; while interestingly, the hidden states from top layers can implicitly capture positional information, even without explicit positional encodings [19, 21, 14]. In order to have a deep understanding of implicit positional information, we next investigate the formation and effect of positional vectors in Transformers, with both full attention and window attention. ", "page_idx": 2}, {"type": "image", "img_path": "zeYyq0GpXO/tmp/8d02ce434f964cbc0dc5d37908885fccef5646817d07508e40dff9217e8ec6e0.jpg", "img_caption": ["Figure 1: PCA visualization of positional vectors from the 1-st and 7-th layers. "], "img_footnote": [], "page_idx": 3}, {"type": "image", "img_path": "zeYyq0GpXO/tmp/afbaf14c420d79397f1fc14a684055c1c76acb6137e01a063e859f76a781a81b.jpg", "img_caption": ["Figure 2: Comparison of distinct positional vectors and theoretical receptive field. "], "img_footnote": [], "page_idx": 3}, {"type": "text", "text": "3.2.1 Formation of Positional Vectors with Full Attention ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "Positional Vector After the First Layer To study how positional information is distributed over different positions, we first visualize the positional vectors $\\mathbf{p}_{1,t}$ (Eq. 4) decomposed from the outputs of the first layer using principal component analysis (PCA). As shown in Figure 1 (left column), initial tokens $(e.g.,\\leq4$ tokens) exhibit significantly distinct positional vectors, while the positional vectors of subsequent tokens are similar to each other. As a comparison, we also present the PCA results of all positional vectors at the 7-th layer. Interestingly, position vectors are evenly distributed across all the positions in Figure 1 (right column). Such a finding indicates that position vectors have captured the corresponding positional information since these vectors are distinct from each other across positions. In other words, being distinct can be considered as a kind of positional evidence. By comparing the left and right columns of Figure 1, it seems that only initial tokens are different from the rest tokens after the first layer, which might suggest that after the first layer, initial tokens have already formed distinct positional information but subsequent tokens have not yet established such information. To investigate the reasons behind this phenomenon, we select the first attention head in the first layer (similar to other heads) to analyze attention scores, as detailed in Appendix B. We can prove that the positional vector $\\mathbf{p}_{1,1}$ for the first token is different from the following tokens and the attention scores affect the formation of positional information. Thus, through several layers, the tokens after the first token will gradually form distinct positional vectors (Figure 1 right column). ", "page_idx": 3}, {"type": "text", "text": "Positional Information Flow From Initial Tokens By applying positional vectors at top layers (PCA visualized in Appendix G), we find that after forwarding several layers, tokens at all positions can also exhibit distinct positional vectors, and similar findings are also found in previous work [19]. To trace back to the source of positional information, a reasonable speculation is that initial tokens play a key role in the formation of positional information for the rest tokens since only initial tokens capture positional information after the first layer. To validate this, we select two groups of reference tokens: initial tokens $(1{\\sim}4)$ and secondary tokens $(4{\\sim}256)$ , and further analyze what information of these tokens is critical for the formation of positional information in subsequent tokens $(>\\!256)$ . Thus, based on a top-down strategy, we conduct an ablation study for each group by respectively deleting the value $\\mathbf{v}_{l,t}^{s}$ of attention module (w/o value), the semantic vector $\\mathbf{c}_{l,t}^{s}$ (w/o semantic vector), positional vector $\\mathbf{p}_{l,t}$ (w/o positional vector), and positional basis ${\\bf{m}}_{l,t}$ (w/o positional basis). Then, for each variant, we average the outputs of all layers and decompose new positional vectors based on Eq. 4. Finally, we compute the average cosine similarity between the original and new positional vectors for those subsequent tokens $(>\\!256)$ and also report PPL on samples in RedPajama. From Table 2, we can see that removing the positional vector and basis of $1{\\sim}4$ tokens largely affect the positional vectors at later positions (low similarity). Conversely, removing the semantic vector or altering secondary tokens has slight effects on both similarity and PPL. From these findings, we conclude that the positional vectors of initial tokens seem to serve as the role of anchors, largely contributing to the formation of positional information in subsequent tokens. ", "page_idx": 3}, {"type": "table", "img_path": "zeYyq0GpXO/tmp/e8b90af8cdc438e3c69665b5d85f094edf2282b497938df3d8316b22501cd0c9.jpg", "table_caption": ["Table 2: Results of removing different components in attention. Sim denotes the cosine similarity between original and new positional vectors, and PPL denotes perplexity on RedPajama. "], "table_footnote": [], "page_idx": 4}, {"type": "image", "img_path": "zeYyq0GpXO/tmp/e4592953a12d51bbcafcce2328fb5fe92e9bad6fd9254a1f99bbcc7f3dd0e973.jpg", "img_caption": ["Figure 3: Logarithmic attention maps of TL-RoPE, and TL-NoPE. "], "img_footnote": [], "page_idx": 4}, {"type": "text", "text": "3.2.2 Formation of Positional Vectors with Window Attention ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "Unlike full attention, LLMs employing window attention restrict each token to attend only to tokens within a window size. Previous work has shown that the maximum theoretical receptive field (TRF) in window attention is equal to the product of the window size $W$ and the layer index $l$ [18]. ", "page_idx": 4}, {"type": "text", "text": "To analyze how positional vectors change across layers, we compute the number of distinct positional vectors within the maximum TRF. Notably, those tokens beyond the maximum TRF share the same positional vectors due to translation invariance [18]. Specifically, we first randomly select a positional vector outside the maximum TRF and then compute the cosine similarity between positional vectors within the maximum TRF and the selected vector. We consider the positional vector with a similarity score lower than a threshold (i.e., 0.99) as distinct. Figure 2 presents the number of distinct positional vectors and TRF at each layer. We can see that after the first layer, only initial tokens show distinct positional vectors, further verifying the findings in Section 3.2.1. As the layer increases, more tokens display different positional information and the number of distinct positional vectors increases by 512 (a window size $W$ ) with each additional layer. The reason is that due to the constraint of window attention, each token at the preceding layer can only influence tokens within the window size at the next layer. As being distinct indicates the formation of position information, similar positional information flow from initial tokens to subsequent tokens also occurs for window attention, but gradually propagating across both windows and layers. ", "page_idx": 4}, {"type": "text", "text": "3.2.3 Effect of Positional Vectors on Attention ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "After discussing the formation of positional vectors, we explore their impact on the attention module, mainly focusing on the attention scores. We first extract queries and keys from each head in all layers, and then compute the average attention scores in the following four settings, including (1) original: the original model, (2) w/o semantic vector: removing the semantic vectors of keys and queries, (3) w/o positional vector: removing the positional vectors of keys and queries, (4) w/o positional basis: removing the positional basis of keys and queries. Figure 3 presents the logarithmic attention scores for the first 100 tokens in the first head and fifth layer (similar results in many other heads and layers). ", "page_idx": 4}, {"type": "image", "img_path": "zeYyq0GpXO/tmp/05bc3ad25e99ba89c4250c1eefeca44bad28eb2790a9c9f42d00a99d2275a0aa.jpg", "img_caption": ["Figure 4: Left: The average PPL across positions during direct extrapolation. Right: The maximum cosine similarity between positional vectors within and beyond context window during extrapolation. "], "img_footnote": [], "page_idx": 5}, {"type": "text", "text": "Effect of Positional Vectors on Attention Sinks Previous work has found that the initial tokens will be assigned high attention scores, called \u201cattention sinks\u201d [15], which can be clearly observed in Figure 3. However, once the positional vector or positional basis is removed from the keys and queries, the attention scores between initial tokens and other tokens drop significantly for TL-NoPE and TL-RoPE. This finding suggests that the presence of attention sinks is likely attributed to the inherent positional information in the positional vectors of initial tokens. ", "page_idx": 5}, {"type": "text", "text": "Effect of Positional Vectors on Long-term Decay For long texts, the attention scores of LLMs often exhibit a long-term decay pattern, which means that the score decreases as the relative distance between tokens increases [7, 6]. However, as shown in Figure 3, when removing the positional vector or positional basis, TL-NoPE fails to exhibit long-term decay. Even with explicit relative positional encoding, the distribution of attention scores in TL-RoPE tends to be smooth after removing decomposed positional vectors. Therefore, positional vectors also play a crucial role in the longterm decay property of attention scores. ", "page_idx": 5}, {"type": "text", "text": "3.3 Effect of Positional Vectors beyond Context Window ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "Typically, when dealing with texts that exceed the context window, there are two lines of research, i.e., direct extrapolation and context window extension. In this section, we aim to investigate the change of positional vectors in these two methods for revealing their effectiveness. ", "page_idx": 5}, {"type": "text", "text": "3.3.1 Direct Extrapolation ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "Relationship Between Positional Vectors and Length Extrapolation Ability To examine the impact of positional vectors in direct extrapolation, we reuse the trained model variants in Table 1 to perform inference on samples consisting of 8192 tokens. Further, we analyze the change in PPL score and the maximum cosine similarity between positional vectors within and beyond the context window. As shown in Figure 4 Left, only TL-Window-RoPE and TL-Window-80 demonstrate the length extrapolation ability, maintaining stable PPL across longer texts. These models can preserve the consistency of positional vectors both within and beyond the context window (high similarity in Figure 4 Right). Conversely, the rest models, including those with extrapolated positional encodings or window attention (e.g., TL-ALiBi), struggle to generalize to longer contexts. Notably, these models exhibit rapid changes in positional vectors (beyond 2048), diverging from the distributions observed within the context window. Thus, our findings underscore the critical role of the stability of positional vectors in enhancing the capability for length extrapolation. ", "page_idx": 5}, {"type": "text", "text": "Effect of OOD Positional Vectors Beyond the context window, position vectors are not encountered during training and are out-of-distribution from those vectors within the context window. To explore whether OOD positional vector is a key factor in performance degradation, we select TL-NoPE for evaluation, which does not use explicit positional encodings. First, we compare the attention distribution within and beyond the context window. Figure 5 shows the attention map and scores between initial and rest tokens by averaging all heads of the 5-th layer (similar results in other layers). Once exceeding the context window ( $T=2048)$ ), the attention distribution in these positions changes sharply, losing the characteristics of attention sinks and long-term decay. Since these properties highly depend on the positional vectors within the context window, we speculate that OOD positional vectors disrupt the original attention distribution. Besides, we feed the positional vectors of the last layer into the linear projection of the softmax layer to get the logits at different positions. Figure 5 (Right) presents that the logits within the context window are tightly similar while others show different distributions. Thus, the OOD positional vectors can damage the token prediction probability distribution, thereby leading to performance degradation. ", "page_idx": 5}, {"type": "text", "text": "", "page_idx": 6}, {"type": "image", "img_path": "zeYyq0GpXO/tmp/e089aa974aa190709b5b50ee7b79d370f42b0f77d6752b88b74cf71b6c8d2b52.jpg", "img_caption": ["Figure 5: Left: Attention map of TL-NoPE. Middle: Attention Scores between initial token and others in TL-NoPE. Right: Similarity of logits of positional vectors across positions in TL-NoPE. "], "img_footnote": [], "page_idx": 6}, {"type": "table", "img_path": "zeYyq0GpXO/tmp/7ff47f41d0d50650f1906f36b2b35ef85168959b6567597ed46fce0b07f5e42a.jpg", "table_caption": ["Table 3: The interpolation results of positional vectors, where Factor $\\leftrightharpoons$ Target Length/ $^{C}$ ) is the expansion factor of the context window, Ratio is the effective interpolation ratio of positional vectors (detailed in Appendix C), and Similarity is the average cosine similarity between the scaled positional vector and the original most similar positional vector by averaging all layers. "], "table_footnote": [], "page_idx": 6}, {"type": "text", "text": "3.3.2 Context Window Extension ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "Change of Positional Vectors When Extending Context Windows To investigate why context window extension can prevent performance degradation, we analyze the change of positional vectors in two training-free context window extension methods, including dynamic-NTK [11] for TL-RoPE and attention scaling $(\\mathbf{q}_{i}\\mathbf{k}_{j}$ multiplied by a scaling factor $\\lambda$ ) [20] for TL-NoPE. From Figure 6, we can see that after context window extension, positional vectors have undergone interpolation compared to the original ones. Comparing the Factor and Ratio metrics in Table 3, we conclude that the effective interpolation ratio is close to the expansion factor (e.g., 2 vs 2.56). Besides, as the expansion factor increases, there is a decrease in Similarity and an increase in PPL. Therefore, we suspect that imperfect interpolation may be a major reason for the decline in model performance. ", "page_idx": 6}, {"type": "image", "img_path": "zeYyq0GpXO/tmp/be0853ca83c933e3ce95b4b5e07f48feb0081de7be5f465ded2ae267901c2ecf.jpg", "img_caption": ["Figure 6: The average cosine similarity between the scaled and original positional vectors. "], "img_footnote": [], "page_idx": 6}, {"type": "text", "text": "Effect of Initial Tokens on Context Window Extension Since the initial tokens serve as the anchor for the formation of subsequent positional vectors, we evaluate whether changing the information flow from the initial tokens to the rest tokens can achieve the interpolation effect. To avoid the effect of OOD positional encodings, we follow the attention scaling method on TL-NoPE but only scale the attention logits between the initial tokens and others, denoted as Initial Scaling. As shown in Table 3, it can achieve comparable performance and interpolation ratios closer than scaling all attention logits in Attention Scaling (e.g., 2.38 vs 2.56), further underscoring that the interpolation of positional vectors is mainly achieved by adjusting the information flow of anchor tokens. ", "page_idx": 7}, {"type": "text", "text": "4 Extending Context Window via Positional Vectors ", "text_level": 1, "page_idx": 7}, {"type": "text", "text": "Inspired by our analysis of the formation of positional vectors and the interpolation of positional vectors when extending the context window, we propose two training-free context window extension methods, i.e., positional vector replacement and attention window extension. The pseudocode of these methods can presented in Appendix E. ", "page_idx": 7}, {"type": "text", "text": "4.1 Positional Vector Replacement ", "text_level": 1, "page_idx": 7}, {"type": "text", "text": "In Section 3.2.3, we show that when exceeding the context window, the OOD positional vectors tend to cause the collapse of attention distribution. Further, we observe that context window extension methods can achieve length interpolation of positional vectors and the effective interpolation ratio is close to the expansion factor of the context window. Thus, we propose to replace all the implicitly learned positional vectors with the interpolated ones, called positional vector replacement, to avoid the OOD issue in LLMs without positional encodings (NoPE). ", "page_idx": 7}, {"type": "text", "text": "Specifically, we linearly interpolate the positional vectors within the context window with an interpolation ratio $r$ and multiply the interpolated ones with a times $\\alpha\\ (\\ge1)$ . In practice, we find that properly increasing the interpolation ratio $r$ and times $\\alpha$ can achieve better effectiveness of interpolation (details are discussed in Appendix D). Owing to the critical role of initial tokes, the positional vectors of the first four tokens remain unchanged, while those of subsequent tokens are replaced with the interpolated vectors. The replaced output $\\hat{\\mathbf{h}}_{l,t}$ for each layer can be formulated as: ", "page_idx": 7}, {"type": "equation", "text": "$$\n\\begin{array}{r c l}{\\hat{\\mathbf{h}}_{l,t}}&{=}&{\\mathbf{h}_{l,t}-\\mathbf{p}_{l,t}+\\alpha\\hat{\\mathbf{p}}_{l,t},}\\\\ {\\{\\hat{\\mathbf{p}}_{l,5},\\hdots,\\hat{\\mathbf{p}}_{l,r(C-4)+5}\\}}&{=}&{\\mathrm{Interpolation}(\\{\\mathbf{p}_{l,5},\\hdots,\\mathbf{p}_{l,C}\\}),}\\end{array}\n$$", "text_format": "latex", "page_idx": 7}, {"type": "text", "text": "where $C,l.$ , and $s$ represent the original context window size, replaced layer, and interpolation ratio. Since replacing positional vectors for all layers requires heavy recalculation efforts and the positional information is passed across layers, we only apply the replacement strategy to a single early layer. We find that the 4-th layer is the optimal layer for replacement in TL-NoPE, as shown in Figure 8. ", "page_idx": 7}, {"type": "text", "text": "4.2 Attention Window Extension ", "text_level": 1, "page_idx": 7}, {"type": "text", "text": "As discussed in Section 3.2.2, the positional vectors are shaped across layers and windows by the distinct positional information of initial tokens. Inspired by these observations, we propose attention window extension, the first training-free length interpolation method for window attention-based LLMs without positional encodings. The core idea is to extend the attention window size to control the formation of positional vectors. When scaling the context window by a ratio, the window size also needs to be extended by the same interpolation ratio $r$ . However, for positions in the extended first window $\\{W+1,\\ldots,r W\\}$ , their position vectors are OOD. To avoid this, we follow the attention scaling method [20] and scale the attention logits with a scaling factor $\\lambda$ , achieving better interpolation of positional vectors. We define the attention score $a_{i j}$ between query $\\mathbf{q}_{i}\\in\\mathbb{R}^{D_{H}}$ and key $\\mathbf{k}_{j}\\overset{\\cdot}{\\in}\\mathbb{R}^{D_{H}}$ for any heads and layers as: ", "page_idx": 7}, {"type": "equation", "text": "$$\na_{i j}=\\frac{\\exp(\\lambda\\mathbf{q}_{i}\\mathbf{k}_{j}/\\sqrt{D_{H}})}{\\sum_{z=i-r W}^{i}\\exp(\\lambda\\mathbf{q}_{i}\\mathbf{k}_{z}/\\sqrt{D_{H}})}.\n$$", "text_format": "latex", "page_idx": 7}, {"type": "text", "text": "4.3 Results on Language Modeling ", "text_level": 1, "page_idx": 7}, {"type": "text", "text": "To assess the effectiveness of our proposed methods, we evaluate language modeling performance on the test set of PG-19 [22]. In line with previous work [6], we measure PPL across various input ", "page_idx": 7}, {"type": "table", "img_path": "", "table_caption": ["Table 4: Results of language modeling in PG-19. The context window size $C$ is 2048. "], "table_footnote": [], "page_idx": 8}, {"type": "equation", "text": "$$\n\\begin{array}{r l r}&{\\frac{\\mathrm{Model~1~\\;}}{\\mathrm{To5stopE}}\\!\\!}&{\\frac{\\mathrm{\\;\\;\\|~\\;}}{\\mathrm{\\;\\|~\\frac{\\partial~\\mathrm{Itterpolaion~Method}~\\;}{\\mathrm{\\partial~\\varphi~\\mathrm{~I~}~}}~}}\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\! \n$$", "text_format": "latex", "page_idx": 8}, {"type": "text", "text": "lengths (from 2K to 8K) using a sliding window approach. We apply positional vector replacement to TL-NoPE and attention window extension to TL-Window. All the hyper-parameters are selected according to the PPL and the change of positional vectors across layers. For compared baselines, we select Dynamic-NTK [11] for TL-RoPE and Attention Scaling [20] for TL-NoPE. ", "page_idx": 8}, {"type": "text", "text": "The results are shown in Table 4. First, without interpolation, the PPL increases extremely after beyond the context window $(e.g.,>10^{3})$ ). When using the positional vector replacement or attention window extension methods, we observe that PPL decreases substantially, showing the effectiveness of our proposed methods. Compared to attention scaling, our attention window extension method successfully extends the context window to 8K tokens with lower PPL. Moreover, our positional vector replacement method achieves similar performance to attention scaling within 6K tokens but shows increased PPL at 8K. We attribute this phenomenon to the decreasing effective interpolation ratio across layers, as shown in Figure 9. Additionally, an increase in PPL with the rising interpolation ratio $r$ is also observed in both our methods, likely due to imperfect interpolation of positional vectors. ", "page_idx": 8}, {"type": "text", "text": "5 Related Work ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "Position Information in Transformers Positional information was crucial in Transformer-based LLMs, to enhance the sequence modeling abilities. The vanilla Transformer introduced absolute positional encodings, using a unique embedding to each position and adding it to the corresponding input embedding [4]. In contrast, relative positional encodings introduced biases based on the relative distance between tokens within attention modules [25\u201327, 6, 7]. Besides explicit positional encodings, some work investigated the implicit positional information within hidden states of Transformers. Even without positional encodings, positional information was found in hidden states of Transformer decoders [19, 28, 29]. Besides, prior work decoupled positional basis from hidden states in Transformers and analyzed geometric properties [21]. Our work mainly explores positional information embedded in the hidden states of LLMs, examining the formation and impact of positional vectors, and using it to analyze the mechanism of context window for LLMs. ", "page_idx": 8}, {"type": "text", "text": "Extending Context Window LLMs were often constrained by pre-defined context windows. When processing inputs that exceed these windows, models typically encountered OOD issues, leading to significant performance degradation. To meet the growing demands of long context tasks [30, 31], various methods were proposed to address this limitation and model longer texts, which can be roughly categorized into length extrapolation and context window extension [32]. Length extrapolation techniques aimed to maintain stable PPL regardless of text length by designing specialized positional encodings or window attention mechanisms [6, 17, 18, 15, 14]. Conversely, context window extension methods focused on extending the context window of existing models by adapting positional encodings or temperature hyper-parameters, thereby enlarging the context window with minimal performance loss [13, 12, 16, 20, 11, 10]. This paper bridges the concepts of length extrapolation and context window extension through the lens of positional vectors, enhancing the interpretability of context windows in LLMs. ", "page_idx": 8}, {"type": "text", "text": "6 Conclusion ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "In this work, we explored the inner working mechanism of LLMs within and beyond the context window via decomposed positional vectors. We found that the initial tokens initially present different positional information and serve as anchors for shaping the positional vectors of subsequent tokens. Besides, after exceeding the context window, length extrapolation methods maintain the stability of positional vectors, while context window extension methods achieve the interpolation of positional vectors. Based on our observations, we proposed two methods: positional vector replacement and attention window extension, which achieve training-free context window extension for specific LLMs. We believe that positional vectors will serve as an effective tool for analyzing the context window of LLMs and promote the design of better algorithms for extending the context windows of LLMs. ", "page_idx": 9}, {"type": "text", "text": "7 Limitation ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "Our work provides an extensive discussion and analysis of the context window through the lens of positional vectors. However, our study is mainly constrained by the use of small-scale LLMs that we trained ourselves, due to the unavailability of existing LLMs with the specific positional encodings and attention patterns required for our experiments. Though some mainstream LLMs are evaluated, these models are all based on RoPE. Furthermore, we have demonstrated the effectiveness of our proposed methods solely on our own models, again limited by the absence of suitable external models. In future work, we aim to seek a broader range of models to validate our findings more comprehensively. ", "page_idx": 9}, {"type": "text", "text": "Acknowledgement ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "This work was partially supported by National Natural Science Foundation of China under Grant No. 62222215, Beijing Municipal Science and Technology Project under Grant No. Z231100010323009, and Beijing Natural Science Foundation under Grant No. L233008. Xin Zhao is the corresponding author. ", "page_idx": 9}, {"type": "text", "text": "References ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "[1] Tom B. Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared Kaplan, Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell, Sandhini Agarwal, Ariel Herbert-Voss, Gretchen Krueger, Tom Henighan, Rewon Child, Aditya Ramesh, Daniel M. Ziegler, Jeffrey Wu, Clemens Winter, Christopher Hesse, Mark Chen, Eric Sigler, Mateusz Litwin, Scott Gray, Benjamin Chess, Jack Clark, Christopher Berner, Sam McCandlish, Alec Radford, Ilya Sutskever, and Dario Amodei. Language models are few-shot learners. In Advances in Neural Information Processing Systems 33: Annual Conference on Neural Information Processing Systems 2020, NeurIPS 2020, December 6-12, 2020, virtual, 2020. ", "page_idx": 9}, {"type": "text", "text": "[2] OpenAI. GPT-4 technical report. CoRR, abs/2303.08774, 2023. ", "page_idx": 9}, {"type": "text", "text": "[3] Wayne Xin Zhao, Kun Zhou, Junyi Li, Tianyi Tang, Xiaolei Wang, Yupeng Hou, Yingqian Min, Beichen Zhang, Junjie Zhang, Zican Dong, Yifan Du, Chen Yang, Yushuo Chen, Zhipeng Chen, Jinhao Jiang, Ruiyang Ren, Yifan Li, Xinyu Tang, Zikang Liu, Peiyu Liu, Jian-Yun Nie, and Ji-Rong Wen. A survey of large language models. CoRR, abs/2303.18223, 2023.   \n[4] Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N Gomez, \u0141ukasz Kaiser, and Illia Polosukhin. Attention is all you need. Advances in neural information processing systems, 30, 2017.   \n[5] Zihang Dai, Zhilin Yang, Yiming Yang, Jaime G. Carbonell, Quoc Viet Le, and Ruslan Salakhutdinov. Transformer-xl: Attentive language models beyond a fixed-length context. In ACL, 2019.   \n[6] Ofir Press, Noah A. Smith, and Mike Lewis. Train short, test long: Attention with linear biases enables input length extrapolation. In The Tenth International Conference on Learning Representations, ICLR 2022, Virtual Event, April 25-29, 2022. OpenReview.net, 2022.   \n[7] Jianlin Su, Murtadha H. M. Ahmed, Yu Lu, Shengfeng Pan, Wen Bo, and Yunfeng Liu. Roformer: Enhanced transformer with rotary position embedding. Neurocomputing, 568:127063, 2024.   \n[8] Hugo Touvron, Thibaut Lavril, Gautier Izacard, Xavier Martinet, Marie-Anne Lachaux, Timoth\u00e9e Lacroix, Baptiste Rozi\u00e8re, Naman Goyal, Eric Hambro, Faisal Azhar, Aur\u00e9lien Rodriguez, Armand Joulin, Edouard Grave, and Guillaume Lample. Llama: Open and efficient foundation language models. CoRR, abs/2302.13971, 2023.   \n[9] Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale, Dan Bikel, Lukas Blecher, Cristian Canton-Ferrer, Moya Chen, Guillem Cucurull, David Esiobu, Jude Fernandes, Jeremy Fu, Wenyin Fu, Brian Fuller, Cynthia Gao, Vedanuj Goswami, Naman Goyal, Anthony Hartshorn, Saghar Hosseini, Rui Hou, Hakan Inan, Marcin Kardas, Viktor Kerkez, Madian Khabsa, Isabel Kloumann, Artem Korenev, Punit Singh Koura, Marie-Anne Lachaux, Thibaut Lavril, Jenya Lee, Diana Liskovich, Yinghai Lu, Yuning Mao, Xavier Martinet, Todor Mihaylov, Pushkar Mishra, Igor Molybog, Yixin Nie, Andrew Poulton, Jeremy Reizenstein, Rashi Rungta, Kalyan Saladi, Alan Schelten, Ruan Silva, Eric Michael Smith, Ranjan Subramanian, Xiaoqing Ellen Tan, Binh Tang, Ross Taylor, Adina Williams, Jian Xiang Kuan, Puxin Xu, Zheng Yan, Iliyan Zarov, Yuchen Zhang, Angela Fan, Melanie Kambadur, Sharan Narang, Aur\u00e9lien Rodriguez, Robert Stojnic, Sergey Edunov, and Thomas Scialom. Llama 2: Open foundation and fine-tuned chat models. CoRR, abs/2307.09288, 2023.   \n[10] bloc97. NTK-Aware Scaled RoPE allows LLaMA models to have extended $(8\\mathrm{k}+)$ context size without any fine-tuning and minimal perplexity degradation., 2023.   \n[11] emozilla. Dynamically Scaled RoPE further increases performance of long context LLaMA with zero fine-tuning, 2023.   \n[12] Bowen Peng, Jeffrey Quesnelle, Honglu Fan, and Enrico Shippole. Yarn: Efficient context window extension of large language models. CoRR, abs/2309.00071, 2023.   \n[13] Shouyuan Chen, Sherman Wong, Liangjian Chen, and Yuandong Tian. Extending context window of large language models via positional interpolation. CoRR, abs/2306.15595, 2023.   \n[14] Chi Han, Qifan Wang, Wenhan Xiong, Yu Chen, Heng Ji, and Sinong Wang. Lm-infinite: Simple on-the-fly length generalization for large language models. CoRR, abs/2308.16137, 2023.   \n[15] Guangxuan Xiao, Yuandong Tian, Beidi Chen, Song Han, and Mike Lewis. Efficient streaming language models with attention sinks. CoRR, abs/2309.17453, 2023.   \n[16] Hongye Jin, Xiaotian Han, Jingfeng Yang, Zhimeng Jiang, Zirui Liu, Chia-Yuan Chang, Huiyuan Chen, and Xia Hu. LLM maybe longlm: Self-extend LLM context window without tuning. CoRR, abs/2401.01325, 2024.   \n[17] Ta-Chung Chi, Ting-Han Fan, Peter J. Ramadge, and Alexander Rudnicky. KERPLE: kernelized relative positional embedding for length extrapolation. In Advances in Neural Information Processing Systems 35: Annual Conference on Neural Information Processing Systems 2022, NeurIPS 2022, New Orleans, LA, USA, November 28 - December 9, 2022, 2022.   \n[18] Ta-Chung Chi, Ting-Han Fan, Alexander Rudnicky, and Peter J. Ramadge. Dissecting transformer length extrapolation via the lens of receptive field analysis. In Proceedings of the 61st Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers), ACL 2023, Toronto, Canada, July 9-14, 2023, pages 13522\u201313537. Association for Computational Linguistics, 2023.   \n[19] Adi Haviv, Ori Ram, Ofir Press, Peter Izsak, and Omer Levy. Transformer language models without positional encodings still learn positional information. In Findings of the Association for Computational Linguistics: EMNLP 2022, Abu Dhabi, United Arab Emirates, December 7-11, 2022, pages 1382\u20131390. Association for Computational Linguistics, 2022.   \n[20] Jie Wang, Tao Ji, Yuanbin Wu, Hang Yan, Tao Gui, Qi Zhang, Xuanjing Huang, and Xiaoling Wang. Length generalization of causal transformers without position encoding. CoRR, abs/2404.12224, 2024.   \n[21] Jiajun Song and Yiqiao Zhong. Uncovering hidden geometry in transformers via disentangling position and context. CoRR, abs/2310.04861, 2023.   \n[22] Jack W. Rae, Anna Potapenko, Siddhant M. Jayakumar, Chloe Hillier, and Timothy P. Lillicrap. Compressive transformers for long-range sequence modelling. In 8th International Conference on Learning Representations, ICLR 2020, Addis Ababa, Ethiopia, April 26-30, 2020. OpenReview.net, 2020.   \n[23] Peiyuan Zhang, Guangtao Zeng, Tianduo Wang, and Wei Lu. Tinyllama: An open-source small language model, 2024.   \n[24] Together Computer. Redpajama: An open source recipe to reproduce llama training dataset, 2023.   \n[25] Peter Shaw, Jakob Uszkoreit, and Ashish Vaswani. Self-attention with relative position representations. In Proceedings of the 2018 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies, NAACL-HLT, New Orleans, Louisiana, USA, June 1-6, 2018, Volume 2 (Short Papers), pages 464\u2013468. Association for Computational Linguistics, 2018.   \n[26] Zihang Dai, Zhilin Yang, Yiming Yang, Jaime G. Carbonell, Quoc Viet Le, and Ruslan Salakhutdinov. Transformer-xl: Attentive language models beyond a fixed-length context. In Proceedings of the 57th Conference of the Association for Computational Linguistics, ACL 2019, Florence, Italy, July 28- August 2, 2019, Volume 1: Long Papers, pages 2978\u20132988. Association for Computational Linguistics, 2019.   \n[27] Colin Raffel, Noam Shazeer, Adam Roberts, Katherine Lee, Sharan Narang, Michael Matena, Yanqi Zhou, Wei Li, and Peter J. Liu. Exploring the limits of transfer learning with a unified text-to-text transformer. J. Mach. Learn. Res., 21:140:1\u2013140:67, 2020.   \n[28] Amirhossein Kazemnejad, Inkit Padhi, Karthikeyan Natesan Ramamurthy, Payel Das, and Siva Reddy. The impact of positional encoding on length generalization in transformers. In Advances in Neural Information Processing Systems 36: Annual Conference on Neural Information Processing Systems 2023, NeurIPS 2023, New Orleans, LA, USA, December 10 - 16, 2023, 2023.   \n[29] Ta-Chung Chi, Ting-Han Fan, Li-Wei Chen, Alexander Rudnicky, and Peter J. Ramadge. Latent positional information is in the self-attention variance of transformer language models without positional embeddings. In Proceedings of the 61st Annual Meeting of the Association for Computational Linguistics (Volume 2: Short Papers), ACL 2023, Toronto, Canada, July 9-14, 2023, pages 1183\u20131193. Association for Computational Linguistics, 2023.   \n[30] Zican Dong, Tianyi Tang, Junyi Li, Wayne Xin Zhao, and Ji-Rong Wen. BAMBOO: A comprehensive benchmark for evaluating long text modeling capacities of large language models. In Proceedings of the 2024 Joint International Conference on Computational Linguistics, Language Resources and Evaluation, LREC/COLING 2024, 20-25 May, 2024, Torino, Italy, pages 2086\u20132099. ELRA and ICCL, 2024.   \n[31] Yuhao Wang, Ruiyang Ren, Junyi Li, Wayne Xin Zhao, Jing Liu, and Ji-Rong Wen. Rear: A relevance-aware retrieval-augmented framework for open-domain question answering. CoRR, abs/2402.17497, 2024.   \n[32] Saurav Pawar, S. M. Towhidul Islam Tonmoy, S. M. Mehedi Zaman, Vinija Jain, Aman Chadha, and Amitava Das. The what, why, and how of context length extension techniques in large language models - A detailed survey. CoRR, abs/2401.07872, 2024.   \n[33] Tri Dao. Flashattention-2: Faster attention with better parallelism and work partitioning. CoRR, abs/2307.08691, 2023. ", "page_idx": 9}, {"type": "text", "text": "", "page_idx": 10}, {"type": "text", "text": "", "page_idx": 11}, {"type": "text", "text": "[34] Abhimanyu Dubey, Abhinav Jauhri, Abhinav Pandey, Abhishek Kadian, Ahmad Al-Dahle, Aiesha Letman, Akhil Mathur, Alan Schelten, Amy Yang, Angela Fan, Anirudh Goyal, Anthony Hartshorn, Aobo Yang, Archi Mitra, Archie Sravankumar, Artem Korenev, Arthur Hinsvark, Arun Rao, Aston Zhang, Aur\u00e9lien Rodriguez, Austen Gregerson, Ava Spataru, Baptiste Rozi\u00e8re, Bethany Biron, Binh Tang, Bobbie Chern, Charlotte Caucheteux, Chaya Nayak, Chloe Bi, Chris Marra, Chris McConnell, Christian Keller, Christophe Touret, Chunyang Wu, Corinne Wong, Cristian Canton Ferrer, Cyrus Nikolaidis, Damien Allonsius, Daniel Song, Danielle Pintz, Danny Livshits, David Esiobu, Dhruv Choudhary, Dhruv Mahajan, Diego Garcia-Olano, Diego Perino, Dieuwke Hupkes, Egor Lakomkin, Ehab AlBadawy, Elina Lobanova, Emily Dinan, Eric Michael Smith, Filip Radenovic, Frank Zhang, Gabriel Synnaeve, Gabrielle Lee, Georgia Lewis Anderson, Graeme Nail, Gr\u00e9goire Mialon, Guan Pang, Guillem Cucurell, Hailey Nguyen, Hannah Korevaar, Hu Xu, Hugo Touvron, Iliyan Zarov, Imanol Arrieta Ibarra, Isabel M. Kloumann, Ishan Misra, Ivan Evtimov, Jade Copet, Jaewon Lee, Jan Geffert, Jana Vranes, Jason Park, Jay Mahadeokar, Jeet Shah, Jelmer van der Linde, Jennifer Billock, Jenny Hong, Jenya Lee, Jeremy Fu, Jianfeng Chi, Jianyu Huang, Jiawen Liu, Jie Wang, Jiecao Yu, Joanna Bitton, Joe Spisak, Jongsoo Park, Joseph Rocca, Joshua Johnstun, Joshua Saxe, Junteng Jia, Kalyan Vasuden Alwala, Kartikeya Upasani, Kate Plawiak, Ke Li, Kenneth Heafield, Kevin Stone, and et al. The llama 3 herd of models. CoRR, abs/2407.21783, 2024. ", "page_idx": 12}, {"type": "text", "text": "[35] Alex Young, Bei Chen, Chao Li, Chengen Huang, Ge Zhang, Guanwei Zhang, Heng Li, Jiangcheng Zhu, Jianqun Chen, Jing Chang, et al. Yi: Open foundation models by 01. ai. CoRR, abs/2403.04652, 2024. ", "page_idx": 12}, {"type": "text", "text": "[36] Jinze Bai, Shuai Bai, Yunfei Chu, Zeyu Cui, Kai Dang, Xiaodong Deng, Yang Fan, Wenbin Ge, Yu Han, Fei Huang, Binyuan Hui, Luo Ji, Mei Li, Junyang Lin, Runji Lin, Dayiheng Liu, Gao Liu, Chengqiang Lu, Keming Lu, Jianxin Ma, Rui Men, Xingzhang Ren, Xuancheng Ren, Chuanqi Tan, Sinan Tan, Jianhong Tu, Peng Wang, Shijie Wang, Wei Wang, Shengguang Wu, Benfeng Xu, Jin Xu, An Yang, Hao Yang, Jian Yang, Shusheng Yang, Yang Yao, Bowen Yu, Hongyi Yuan, Zheng Yuan, Jianwei Zhang, Xingxuan Zhang, Yichang Zhang, Zhenru Zhang, Chang Zhou, Jingren Zhou, Xiaohuan Zhou, and Tianhang Zhu. Qwen technical report. CoRR, abs/2309.16609, 2023. ", "page_idx": 12}, {"type": "text", "text": "A Training and Experimental Details ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "We continue pre-training all our models from the TinyLlama3 [23] checkpoint on the RedPajama [24] dataset. All models undergo the same training process, with differences only in their positional encoding and attention patterns. Each model is trained on 16 A800 GPUs over two days. Detailed training parameters are provided in Table 5. ", "page_idx": 13}, {"type": "table", "img_path": "zeYyq0GpXO/tmp/ca47871ad5c808103cc88ce696836af930210c493767285c1e32549e61b560c4.jpg", "table_caption": ["Table 5: Training Details of Models. "], "table_footnote": [], "page_idx": 13}, {"type": "text", "text": "In addition, all the subsequent experiments are computed in 8 A800 GPUs. ", "page_idx": 13}, {"type": "text", "text": "B The Positional Vectors After the First Layer ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "Though previous work [29, 28] have proven that implicit positional information can be encoded in hidden states after one attention module, they only set the attention logits are equal regardless of queries and keys, which does not hold in actual Transformers. In this section, we demonstrate the preference in attention scores promotes the formation of different positional information in the initial tokens. ", "page_idx": 13}, {"type": "text", "text": "B.1 Details ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "For the $s$ -th sample in the corpus, we denote $\\mathbf{v}_{1,i}^{s},\\hat{\\mathbf{h}}_{1,i}^{s}$ as the value and output of the first attention head and the first layer at position $i$ , and $a_{i,j}^{s}$ as the attention score between position $i$ and position $j$ . We also denote $\\hat{\\mathbf{p}}_{1,i}$ as the positional vector of the attention output, and $\\mathbf{u}_{v}$ as the mean vector of values. The positional vector can be represented as the formula: ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\begin{array}{l}{{\\displaystyle{\\hat{\\bf p}}_{1,1}=\\frac{1}{N}\\sum_{s=1}^{N}{\\hat{\\bf h}}_{1,1}^{s}=\\frac{1}{N}\\sum_{s=1}^{N}{\\bf v}_{1,1}^{s}={\\bf u}_{v}}}\\\\ {{\\displaystyle{\\hat{\\bf p}}_{1,i}=\\frac{1}{N}\\sum_{s=1}^{N}{\\hat{\\bf h}}_{1,i}^{s}=\\frac{1}{N}\\sum_{s=1}^{N}\\sum_{j=1}^{i}a_{i,j}^{s}{\\bf v}_{1,j}^{s}}}\\end{array}\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "For the first token, the output is equal to the value of itself, so the positional vector is equal to the mean of values. In addition, When $a_{i,j}^{s}=1/i$ , positional information of all positions is equal as follows: ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\hat{\\mathbf{p}}_{1,i}=\\frac{1}{N}\\sum_{s=1}^{N}\\sum_{j=1}^{i}\\frac{1}{i}\\mathbf{v}_{1,j}^{s}=\\frac{1}{i}\\sum_{j=1}^{i}\\frac{1}{N}\\sum_{s=1}^{N}\\mathbf{v}_{1,j}^{s}=\\frac{1}{i}\\sum_{j=1}^{i}\\mathbf{u}_{v}=\\mathbf{u}_{v}.\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "However, due to the preferences in attention scores, values that can be decomposed into more vector $\\hat{\\bf p}_{1,i}-{\\bf u}_{v}$ will be assigned larger weights, making the positional information of the following tokens differ from the beginning token. In summary, the preferences of attention scores force the formation of different positional vectors of the following tokens with the initial ones. ", "page_idx": 13}, {"type": "text", "text": "B.2 Proof of Preference in Attention Scores ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "Following previous work [28], we only focus on a single attention head in the first layer with specific weights. In our parameterization, we only consider the first two dimensions. We demonstrate the capacity of causal Transformers to learn this capacity with either NoPE or RoPE. ", "page_idx": 14}, {"type": "text", "text": "In our settings, the Transformer has $H$ attention heads in each layer and the word embedding matrix is $\\mathbf{W}_{E}\\in\\mathbb{R}^{\\tilde{D}\\times V}$ , where $D$ is the dimension of the hidden states and $V$ is the number of vocabulary. We set that the first dimension in word embedding conforms to normal distribution $\\mathcal{N}(0,1)$ , (i.e., $e_{1,t}\\sim\\mathcal{N}(0,1),\\forall t\\in\\{1,\\dots,V\\})$ , while the second dimension is 1. Other dimensions are arbitrary values. Thus, the word embedding matrix $\\mathbf{W}_{E}$ is: ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\mathbf{W}_{\\mathbf{E}}={\\left[\\begin{array}{l l c c l l}{e_{1,1}}&{e_{1,2}}&{e_{1,3}}&{..\\cdot}&{e_{1,V}}\\\\ {1}&{1}&{1}&{..\\cdot}&{1}\\\\ {e_{3,1}}&{e_{3,2}}&{e_{3,3}}&{..\\cdot}&{e_{3,V}}\\\\ {\\vdots}&{\\vdots}&{\\vdots}&{\\ddots}&{\\vdots}\\\\ {e_{D,1}}&{e_{D,2}}&{e_{D,3}}&{..\\cdot}&{e_{D,V}}\\end{array}\\right]}_{D\\times V}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "Next, we set the projection matrix of query, key, and value as $\\mathbf{W}_{Q},\\mathbf{W}_{K},\\mathbf{W}_{V}$ of the first layer and first head of Transformers. ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\mathbf{W}_{Q}=\\left[\\begin{array}{l l l l}{0}&{1}&{\\ldots}&{0}\\\\ {0}&{1}&{\\ldots}&{0}\\\\ {\\vdots}&{\\vdots}&{\\ddots}&{\\vdots}\\\\ {0}&{1}&{\\ldots}&{0}\\end{array}\\right]_{\\frac{D}{H}\\times D},\\mathbf{W}_{K}=\\left[\\begin{array}{l l l l}{1}&{0}&{\\ldots}&{0}\\\\ {1}&{0}&{\\ldots}&{0}\\\\ {\\vdots}&{\\vdots}&{\\ddots}&{\\vdots}\\\\ {1}&{0}&{\\ldots}&{0}\\end{array}\\right]_{\\frac{D}{H}\\times D},\\mathbf{W}_{V}=\\left[\\begin{array}{l l l l}{1}&{0}&{\\ldots}&{0}\\\\ {1}&{0}&{\\ldots}&{0}\\\\ {\\vdots}&{\\vdots}&{\\ddots}&{\\vdots}\\\\ {1}&{0}&{\\ldots}&{0}\\end{array}\\right]_{\\frac{D}{H}\\times D}.\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "$\\mathbf{W}_{K}$ make sure that only the first dimension will be considered in attention scores. $\\mathbf{W}_{Q}$ transfers the second dimension in the input to the first dimension. For Transformers without positional vectors (NoPE), the attention logits for each key at position $i$ is $a_{i,j}^{s}=e_{1,s_{i}}$ . Thus, the vectors with large first dimensions will be assigned with large attention logits, which proves that the model without positional vectors can learn to preference some values regardless of the query. ", "page_idx": 14}, {"type": "text", "text": "For Transformer with RoPE, we assume that the first two dimensions correspond to the basis of the rope with a value of $1/10000$ and the maximum context window size is 2048. Thus, for the largest relative distance $i-j$ , the rotation angle is smaller than $\\scriptstyle{\\frac{\\pi}{2}}$ . Thus, the attention score can be represent as $a_{i,j}^{s}=e_{1,s_{i}}\\cos{((i-j)/10000)}$ . Thus, the attention logits will be larger than zero only if the first dimension of the key is larger than zero. In addition, for the same relative distance, keys with larger first dimensions have large attention logits. Thus, keys with positive values in the first dimension will be assigned greater attention weights. ", "page_idx": 14}, {"type": "image", "img_path": "zeYyq0GpXO/tmp/4b054146349ac8d1f15bde0d2bc99895ca631304185550f634779195eaf39fe7.jpg", "img_caption": ["Figure 7: The values of first elements of the output of single head attention due to attention preferences in Transformers with NoPE and RoPE. "], "img_footnote": [], "page_idx": 14}, {"type": "text", "text": "We also experimentally examine the first element of the output at different positions. With the above settings, we generate 10000 sequences with a length of 2048 from this distribution. Then, we compute the averaged first element of each hidden state after attention in the first layer and head, which represents the positional vectors at that position for both NoPE and RoPE. As shown in Figure 7, the first element of the output increases fast at initial positions. Here, we can observe that the attention preferences make the first element of the output increase fast at the initial positions and tend to stabilize at a later position, further proving the different positional vectors of following tokens from the initial ones. ", "page_idx": 14}, {"type": "image", "img_path": "zeYyq0GpXO/tmp/841bbaf5fa843c84e9e0eb1bc6f992634922f545f9a95fed16b1c1b96f1d5723.jpg", "img_caption": ["", "Figure 8: Changes of PPL with replacement at different layers. "], "img_footnote": [], "page_idx": 15}, {"type": "image", "img_path": "zeYyq0GpXO/tmp/bccb5b4eca99f00f0c7e8128e6789008f022535c928b5a5c9fe1ff13ff0fab62.jpg", "img_caption": ["", "Figure 9: Effective scaling factors of positional vectors at each layer. "], "img_footnote": [], "page_idx": 15}, {"type": "text", "text": "", "page_idx": 15}, {"type": "text", "text": "In summary, Transformers with either NoPE or RoPE can learn preference in attention score. In addition, the preference in attention scores forces the different positional vectors of the subsequent tokens with the initial tokens. ", "page_idx": 15}, {"type": "text", "text": "C Defination of Effective Interpolation Ratio ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "Given a Transformer with a context window size $C$ . For samples with length $C^{\\prime}(C^{\\prime}>C)$ , we disentangle positional vectors $\\{\\mathbf{p}_{l,1},\\ldots,\\mathbf{p}_{l,C^{\\prime}}\\}$ . Subsequently, we employ a context window extension method and re-compute the position vectors $\\{\\mathbf{p}^{\\prime}_{l,1},\\ldots,\\mathbf{p}^{\\prime}_{l,C^{\\prime}}\\}$ . We first define the corresponding position indices $f(\\mathbf{p^{\\prime}}_{l,t})$ for positional vector after extension $\\mathbf{p^{\\prime}}_{l,t}$ ) as the indices of the most similar positional vectors before extension: ", "page_idx": 15}, {"type": "equation", "text": "$$\nf(\\mathbf{p^{\\prime}}_{l,t})=\\arg\\operatorname*{max}_{1\\leq i\\leq C^{\\prime}}\\frac{\\mathbf{p}_{l,i}^{T}\\mathbf{p}_{l,t}^{\\prime}}{\\|\\mathbf{p}_{l,i}\\|\\|\\mathbf{p}_{l,t}^{\\prime}\\|}.\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "Then, the effective interpolation ratio $r^{\\prime}$ can be represented as the ratio between the maximum indices of position vectors after extension whose corresponding position indices are the context window size $C$ , as shown in Equation 14. ", "page_idx": 15}, {"type": "equation", "text": "$$\nr=\\frac{\\arg\\operatorname*{max}_{1\\leq t\\leq C^{\\prime}}(f(\\mathbf{p^{\\prime}}_{l,t})=C)}{C}.\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "D Analysis of Positional Vector Replacement ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "D.1 Optimal Replacement Layer ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "Replacing positional vectors for all layers requires heavy recalculation efforts, so we only select one critical layer to apply the replacement strategy. We evaluate the performance (logarithmic PPL score) of our replacement strategy at each layer in TL-NoPE, using different interpolation ratios and expansion factors, i.e. $(r=4,\\alpha=1)$ and $(r=5,\\alpha=1.2)$ ), on samples with 8K tokens from RedPajama. As shown in Figure 8, the PPL is the lowest when replacing the 4-th layer of TL-NoPE. Thus, we choose the 4-th layer for replacement in TL-NoPE in other experiments. ", "page_idx": 15}, {"type": "text", "text": "D.2 Effective Interpolation Ratio ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "We further examine the effective interpolation ratio of positional vectors with different settings. In our setting, we only replace the positional vectors in the 4-th layer of TL-NoPE with interpolated positional vectors in four settings on samples with 8K tokens from RedPajama: (1) $r=4,\\alpha=1$ , (2) $r=5,\\alpha=1$ , (3) $r=4,\\alpha=1.3$ , (4), $r=5,\\alpha=1.3$ . ", "page_idx": 15}, {"type": "text", "text": "", "page_idx": 16}, {"type": "text", "text": "Figure 9 presents the effective interpolation ratio in each layer. As the layer increases, the effective interpolation ratio decreases as the layer increases. When the interpolation ratio is equal to the expansion factor of the context window, i.e., $r=4$ , the effective interpolation ratio is unavoidably smaller than the expansion factor, leading to degraded performance. In addition, multiplying the interpolated positional vectors with a larger times e.g., $\\alpha=1.3$ , alleviates the decrease of effective interpolation ratio across layers. Thus, we suggest to properly increase the interpolation ratio $r$ and times $\\alpha$ . ", "page_idx": 16}, {"type": "text", "text": "E Pseudo Code ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "E.1 Positional Vector Replacement ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "For Positional Vector Replacement, we give the implementation with Pytorch code in Algorithm 1, which can be inserted after the output of the selected layer. ", "page_idx": 16}, {"type": "text", "text": "Algorithm 1 PyTorch-style Pseudocode of Positional Vector Replacement ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "h, p # hidden states, positional vectors ", "page_idx": 16}, {"type": "text", "text": "T, layer, s, alpha # context window size, interpolation ratio, selected layer, scaling factor of positional vectors. ", "page_idx": 16}, {"type": "text", "text": "h[:,4:] $-=$ p[layer, 4:h.shape[1]].unsqueeze(0) # removing original positional vectors. ", "page_idx": 16}, {"type": "text", "text": "interpolated $=$ torch.nn.functional.interpolate(p[layer, 4:T].transpose(0,1).unsqueeze(0), size $\\mathbf{\\mu}=\\operatorname*{int}(\\mathbf{T}^{*}\\mathbf{s})$ , mode $=$ \u2019linear\u2019, align_corners $\\risingdotseq$ True).transpose(1,2)   \n# Linear interpolation of positional vectors. ", "page_idx": 16}, {"type": "text", "text": "h[:,4:] $+=$ alpha\\*interpolated[:,:h.shape[1]-4] # Replacing with new positional vectors. ", "page_idx": 16}, {"type": "text", "text": "E.2 Attention Window Extension ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "For attention window extension, we give the implementation with Flash-Attention-2 [33] in Algorithm 2. ", "page_idx": 16}, {"type": "text", "text": "Algorithm 2 PyTorch-style Pseudocode of Attention Window Extension ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "query, key, value, attn_output # queries, keys, values, and output in the attention model W, lambda, s # original window size, scaling factor of attention logits, window extension factor flash_attn_varlen_func # attention function in flash attention 2. ", "page_idx": 16}, {"type": "text", "text": "new_window $\\mathbf{\\Phi}=\\mathbf{W}^{*}\\mathbf{s}$ # extended window size ", "page_idx": 16}, {"type": "text", "text": "attn_output $=$ flash_attn_varlen_func( query, key\\*lambda, value, ..., window_size $=$ (new_window, new_window) ) ", "page_idx": 16}, {"type": "text", "text": "F Results of Additional LLMs ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "To ensure a fair comparison of positional vectors across various attention mechanisms and positional encodings, we conducted continual pre-training using TinyLlama under consistent settings. However, TinyLlama is a relatively small language model with suboptimal performance and continual pretraining may result in positional vectors exhibiting properties distinct from those obtained through training from scratch. Therefore, we selected three mainstream LLMs: Llama-3-8B [34], Yi-9B [35], and Qwen1.5-7B [36], for comparison. Additionally, we trained a new LLM, TL-NoPE-new, from scratch under the same conditions as TL-NoPE. In a similar vein, we extracted positional vectors using 32K samples from the RedPajama dataset. ", "page_idx": 16}, {"type": "image", "img_path": "zeYyq0GpXO/tmp/3b22c4220998dfc8187438c72302103099b48ecd1bed10dc3bc3b8ff11f3e71c.jpg", "img_caption": ["Figure 10: PCA visualization of positional vectors from the 1-st layer of Llama-3-8B, Qwen1.5-7B, Yi-9B, and TL-NoPE-new. "], "img_footnote": [], "page_idx": 17}, {"type": "text", "text": "", "page_idx": 17}, {"type": "text", "text": "F.1 Formation of Positional Vectors within Context Window ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "Through principal component analysis (PCA), we first visualize the positional vectors from the initial layer of these LLMs, as illustrated in Figure 10. Consistent with our expectations, the initial tokens exhibit distinct positional information, while the subsequent tokens display a high degree of similarity. This observation supports the conclusion that the first-layer attention mechanism makes the initial tokens form unique positional information, as discussed in Section 3.2.1. ", "page_idx": 17}, {"type": "text", "text": "Furthermore, we remove different components of the value vectors at different positions across all attention heads after the first layer. We then evaluate the impact of these modifications on both the positional vectors and the perplexity (PPL). As shown in Table 6, removing the positional basis of the initial tokens significantly degrades the model\u2019s performance. Conversely, removing the components from subsequent tokens has a relatively smaller effect, highlighting the pivotal role of initial token positioning in influencing later tokens. However, we observe that larger LLMs are more attuned to semantic information and less affected by the removal of positional vectors compared to smaller LLMs. ", "page_idx": 17}, {"type": "table", "img_path": "zeYyq0GpXO/tmp/5891ed9ae0635bd46f02a1e88f975393e48ae03fcbf2c83d3d608206ce05df62.jpg", "table_caption": ["Table 6: Results of removing different components in attention. "], "table_footnote": [], "page_idx": 17}, {"type": "text", "text": "F.2 Effect of Positional Vectors on Attention ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "In line with the experiments conducted in Section 3.2.3, we extract various components from the keys and queries to assess their impact on attention scores. The attention maps for the first 50 tokens are illustrated in Figure 11. When both the positional vectors and positional basis are removed, attention ", "page_idx": 17}, {"type": "image", "img_path": "zeYyq0GpXO/tmp/56f8645e3e21fb3226aeee2d74b8194e2537c3c24bff2e95a39e62c9f4cf826d.jpg", "img_caption": ["Figure 11: Logarithmic attention maps of Llama-3-8B, Qwen1.5-7B, Yi-9B, and new TL-NoPE. "], "img_footnote": [], "page_idx": 18}, {"type": "text", "text": "sinks disappear, and long-term decay is observed, which is consistent with the behavior seen in TinyLlama. ", "page_idx": 18}, {"type": "text", "text": "F.3 Effect of Positional Vectors Beyond Context Window ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Table 7: Resuls of PPL and change of positional vectors during direct extrapolation. ", "page_idx": 18}, {"type": "table", "img_path": "zeYyq0GpXO/tmp/8cf489ed10dce42a85af86070e88bcf3c76bc5d7186162242558c4fc4b3f8a9d.jpg", "table_caption": [], "table_footnote": [], "page_idx": 18}, {"type": "table", "img_path": "zeYyq0GpXO/tmp/7afc9023d5017a96f1f9986445e6461ccc0ed63e2e6090af97c4f8b78f532a71.jpg", "table_caption": ["Table 8: Change of attention sinks and output logits beyond context window. "], "table_footnote": [], "page_idx": 18}, {"type": "text", "text": "We investigate the behavior of positional vectors under direct extrapolation scenarios. Specifically, we evaluate LLMs on sequences twice the length of their maximum context window, comparing the variations in PPL and positional vectors. The results, as shown in Table 7, indicate a sharp increase in PPL once the context window is exceeded. Additionally, the similarity between positional vectors within and beyond the context window decreases, highlighting the relationship between length extrapolation and the stability of positional representations. ", "page_idx": 18}, {"type": "text", "text": "", "page_idx": 19}, {"type": "text", "text": "Furthermore, we assess the impact of OOD positional vectors. We analyze the attention scores of initial tokens and the positional vectors of output logits within and beyond the context window. As demonstrated in Table 8, exceeding the context window results in the loss of the attention sinking property, and the positional vectors of the logits exhibit a different distribution compared to those within the context window. This suggests that OOD positional vectors influence the model\u2019s distribution. Moreover, OOD positional encodings play a crucial role in large language models (LLMs) that leverage RoPE [15]. ", "page_idx": 19}, {"type": "text", "text": "F.4 Experiments of Positional Vector Replacement ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "To assess whether our positional vector replacement method is specific to TL-NoPE, we applied it to TL-NoPE-new, which was trained from scratch. We evaluated its language modeling performance on the PG-19 dataset, using the same experimental setup as TL-NoPE. As shown in Table 9, our approach effectively extends the context window to 8K tokens and achieves performance comparable to attention scaling. ", "page_idx": 19}, {"type": "table", "img_path": "zeYyq0GpXO/tmp/22f346de161890c970d7ede115ddb4384c9a9076817c6cf7d51e32594869bde4.jpg", "table_caption": ["Table 9: Results of language modeling in PG-19 with TL-NoPE-new "], "table_footnote": [], "page_idx": 19}, {"type": "text", "text": "G Visualization of Positional Vectors ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "We visualize all models listed in Table 1 with PCA. The subsequent figures present the visualization of TL-NoPE, TL-RoPE, TL-ALiBi, TL-Window, TL-Window-RoPE, and TL-Window-80. ", "page_idx": 19}, {"type": "image", "img_path": "zeYyq0GpXO/tmp/9e9f157d558098d298afc78022cb3933cf76696ab66af11e10d1257c0a4e5291.jpg", "img_caption": ["Figure 12: PCA visualization of positional vectors at different layers of TL-NoPE. "], "img_footnote": [], "page_idx": 19}, {"type": "image", "img_path": "zeYyq0GpXO/tmp/d9357ec4003079363ded0a5633376f9605ade9a98cdd5084c572a00a44ead3c3.jpg", "img_caption": ["Figure 13: PCA visualization of positional vectors at different layers of TL-RoPE. "], "img_footnote": [], "page_idx": 20}, {"type": "image", "img_path": "zeYyq0GpXO/tmp/493fba4dd338cace345f45b67bfedba1e4ac61cd4a158ebc8889bd7e03fdbb5a.jpg", "img_caption": ["Figure 14: PCA visualization of positional vectors at different layers of TL-ALiBi. "], "img_footnote": [], "page_idx": 20}, {"type": "image", "img_path": "zeYyq0GpXO/tmp/663cd452d02541974e14a0986812e45266feedd388ed8964a9aa43c57068e158.jpg", "img_caption": ["Figure 15: PCA visualization of positional vectors at different layers of TL-Window. "], "img_footnote": [], "page_idx": 20}, {"type": "image", "img_path": "zeYyq0GpXO/tmp/6e701b719e0cbad38b2338648af66ff54a53c8fa2e1d3056bd48c70894d12378.jpg", "img_caption": ["Figure 16: PCA visualization of positional vectors at different layers of TL-Widow-RoPE. "], "img_footnote": [], "page_idx": 21}, {"type": "image", "img_path": "zeYyq0GpXO/tmp/ee25dc3a2086d459431e006e13085c7cc6c20fe911d79a0ab71d835d0025e0e5.jpg", "img_caption": ["Figure 17: PCA visualization of positional vectors at different layers of TL-Window-80. "], "img_footnote": [], "page_idx": 21}, {"type": "text", "text": "NeurIPS Paper Checklist ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": ". Claims ", "page_idx": 21}, {"type": "text", "text": "Question: Do the main claims made in the abstract and introduction accurately reflect the paper\u2019s contributions and scope? ", "page_idx": 21}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 21}, {"type": "text", "text": "Justification: We provide the main claims in abstract and introduction. ", "page_idx": 21}, {"type": "text", "text": "Guidelines: ", "page_idx": 21}, {"type": "text", "text": "\u2022 The answer NA means that the abstract and introduction do not include the claims made in the paper.   \n\u2022 The abstract and/or introduction should clearly state the claims made, including the contributions made in the paper and important assumptions and limitations. A No or NA answer to this question will not be perceived well by the reviewers.   \n\u2022 The claims made should match theoretical and experimental results, and reflect how much the results can be expected to generalize to other settings.   \n\u2022 It is fine to include aspirational goals as motivation as long as it is clear that these goals are not attained by the paper. ", "page_idx": 21}, {"type": "text", "text": "2. Limitations ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "Question: Does the paper discuss the limitations of the work performed by the authors? Answer: [Yes] ", "page_idx": 21}, {"type": "text", "text": "Justification: We discuss the limitation in Appendix. ", "page_idx": 22}, {"type": "text", "text": "Guidelines: ", "page_idx": 22}, {"type": "text", "text": "\u2022 The answer NA means that the paper has no limitation while the answer No means that the paper has limitations, but those are not discussed in the paper.   \n\u2022 The authors are encouraged to create a separate \"Limitations\" section in their paper.   \n\u2022 The paper should point out any strong assumptions and how robust the results are to violations of these assumptions (e.g., independence assumptions, noiseless settings, model well-specification, asymptotic approximations only holding locally). The authors should reflect on how these assumptions might be violated in practice and what the implications would be.   \n\u2022 The authors should reflect on the scope of the claims made, e.g., if the approach was only tested on a few datasets or with a few runs. In general, empirical results often depend on implicit assumptions, which should be articulated.   \n\u2022 The authors should reflect on the factors that influence the performance of the approach. For example, a facial recognition algorithm may perform poorly when image resolution is low or images are taken in low lighting. Or a speech-to-text system might not be used reliably to provide closed captions for online lectures because it fails to handle technical jargon.   \n\u2022 The authors should discuss the computational efficiency of the proposed algorithms and how they scale with dataset size.   \n\u2022 If applicable, the authors should discuss possible limitations of their approach to address problems of privacy and fairness.   \n\u2022 While the authors might fear that complete honesty about limitations might be used by reviewers as grounds for rejection, a worse outcome might be that reviewers discover limitations that aren\u2019t acknowledged in the paper. The authors should use their best judgment and recognize that individual actions in favor of transparency play an important role in developing norms that preserve the integrity of the community. Reviewers will be specifically instructed to not penalize honesty concerning limitations. ", "page_idx": 22}, {"type": "text", "text": "3. Theory Assumptions and Proofs ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Question: For each theoretical result, does the paper provide the full set of assumptions and a complete (and correct) proof? ", "page_idx": 22}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Justification: We have provided proof in the Appendix Guidelines: ", "page_idx": 22}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include theoretical results.   \n\u2022 All the theorems, formulas, and proofs in the paper should be numbered and crossreferenced.   \n\u2022 All assumptions should be clearly stated or referenced in the statement of any theorems.   \n\u2022 The proofs can either appear in the main paper or the supplemental material, but if they appear in the supplemental material, the authors are encouraged to provide a short proof sketch to provide intuition.   \n\u2022 Inversely, any informal proof provided in the core of the paper should be complemented by formal proofs provided in appendix or supplemental material.   \n\u2022 Theorems and Lemmas that the proof relies upon should be properly referenced. ", "page_idx": 22}, {"type": "text", "text": "4. Experimental Result Reproducibility ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Question: Does the paper fully disclose all the information needed to reproduce the main experimental results of the paper to the extent that it affects the main claims and/or conclusions of the paper (regardless of whether the code and data are provided or not)? ", "page_idx": 22}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 22}, {"type": "text", "text": "Justification: We have provide the information for reproduce the results. Guidelines: ", "page_idx": 22}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments. ", "page_idx": 22}, {"type": "text", "text": "\u2022 If the paper includes experiments, a No answer to this question will not be perceived well by the reviewers: Making the paper reproducible is important, regardless of whether the code and data are provided or not.   \n\u2022 If the contribution is a dataset and/or model, the authors should describe the steps taken to make their results reproducible or verifiable.   \n\u2022 Depending on the contribution, reproducibility can be accomplished in various ways. For example, if the contribution is a novel architecture, describing the architecture fully might suffice, or if the contribution is a specific model and empirical evaluation, it may be necessary to either make it possible for others to replicate the model with the same dataset, or provide access to the model. In general. releasing code and data is often one good way to accomplish this, but reproducibility can also be provided via detailed instructions for how to replicate the results, access to a hosted model (e.g., in the case of a large language model), releasing of a model checkpoint, or other means that are appropriate to the research performed.   \n\u2022 While NeurIPS does not require releasing code, the conference does require all submissions to provide some reasonable avenue for reproducibility, which may depend on the nature of the contribution. For example (a) If the contribution is primarily a new algorithm, the paper should make it clear how to reproduce that algorithm. (b) If the contribution is primarily a new model architecture, the paper should describe the architecture clearly and fully. (c) If the contribution is a new model (e.g., a large language model), then there should either be a way to access this model for reproducing the results or a way to reproduce the model (e.g., with an open-source dataset or instructions for how to construct the dataset). (d) We recognize that reproducibility may be tricky in some cases, in which case authors are welcome to describe the particular way they provide for reproducibility. In the case of closed-source models, it may be that access to the model is limited in some way (e.g., to registered users), but it should be possible for other researchers to have some path to reproducing or verifying the results. ", "page_idx": 23}, {"type": "text", "text": "5. Open access to data and code ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: Does the paper provide open access to the data and code, with sufficient instructions to faithfully reproduce the main experimental results, as described in supplemental material? ", "page_idx": 23}, {"type": "text", "text": "Answer: [No] ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Justification: We only provide the Pytorch implementation of our methods in the Appendix. Guidelines: ", "page_idx": 23}, {"type": "text", "text": "\u2022 The answer NA means that paper does not include experiments requiring code.   \n\u2022 Please see the NeurIPS code and data submission guidelines (https://nips.cc/ public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 While we encourage the release of code and data, we understand that this might not be possible, so \u201cNo\u201d is an acceptable answer. Papers cannot be rejected simply for not including code, unless this is central to the contribution (e.g., for a new open-source benchmark).   \n\u2022 The instructions should contain the exact command and environment needed to run to reproduce the results. See the NeurIPS code and data submission guidelines (https: //nips.cc/public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 The authors should provide instructions on data access and preparation, including how to access the raw data, preprocessed data, intermediate data, and generated data, etc.   \n\u2022 The authors should provide scripts to reproduce all experimental results for the new proposed method and baselines. If only a subset of experiments are reproducible, they should state which ones are omitted from the script and why.   \n\u2022 At submission time, to preserve anonymity, the authors should release anonymized versions (if applicable). ", "page_idx": 23}, {"type": "text", "text": "\u2022 Providing as much information as possible in supplemental material (appended to the paper) is recommended, but including URLs to data and code is permitted. ", "page_idx": 24}, {"type": "text", "text": "6. Experimental Setting/Details ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Question: Does the paper specify all the training and test details (e.g., data splits, hyperparameters, how they were chosen, type of optimizer, etc.) necessary to understand the results? ", "page_idx": 24}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 24}, {"type": "text", "text": "Justification: We have provided the training details in the paper. Guidelines: ", "page_idx": 24}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments. \u2022 The experimental setting should be presented in the core of the paper to a level of detail that is necessary to appreciate the results and make sense of them. \u2022 The full details can be provided either with the code, in appendix, or as supplemental material. ", "page_idx": 24}, {"type": "text", "text": "7. Experiment Statistical Significance ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Question: Does the paper report error bars suitably and correctly defined or other appropriate information about the statistical significance of the experiments? ", "page_idx": 24}, {"type": "text", "text": "Answer: [No] ", "page_idx": 24}, {"type": "text", "text": "Justification: The paper does not provide this. ", "page_idx": 24}, {"type": "text", "text": "Guidelines: ", "page_idx": 24}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The authors should answer \"Yes\" if the results are accompanied by error bars, confidence intervals, or statistical significance tests, at least for the experiments that support the main claims of the paper.   \n\u2022 The factors of variability that the error bars are capturing should be clearly stated (for example, train/test split, initialization, random drawing of some parameter, or overall run with given experimental conditions).   \n\u2022 The method for calculating the error bars should be explained (closed form formula, call to a library function, bootstrap, etc.)   \n\u2022 The assumptions made should be given (e.g., Normally distributed errors).   \n\u2022 It should be clear whether the error bar is the standard deviation or the standard error of the mean.   \n\u2022 It is OK to report 1-sigma error bars, but one should state it. The authors should preferably report a 2-sigma error bar than state that they have a $96\\%$ CI, if the hypothesis of Normality of errors is not verified.   \n\u2022 For asymmetric distributions, the authors should be careful not to show in tables or figures symmetric error bars that would yield results that are out of range (e.g. negative error rates).   \n\u2022 If error bars are reported in tables or plots, The authors should explain in the text how they were calculated and reference the corresponding figures or tables in the text. ", "page_idx": 24}, {"type": "text", "text": "8. Experiments Compute Resources ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Question: For each experiment, does the paper provide sufficient information on the computer resources (type of compute workers, memory, time of execution) needed to reproduce the experiments? ", "page_idx": 24}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 24}, {"type": "text", "text": "Justification: We provide the computer resources. ", "page_idx": 24}, {"type": "text", "text": "Guidelines: ", "page_idx": 24}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments. \u2022 The paper should indicate the type of compute workers CPU or GPU, internal cluster, or cloud provider, including relevant memory and storage. ", "page_idx": 24}, {"type": "text", "text": "\u2022 The paper should provide the amount of compute required for each of the individual experimental runs as well as estimate the total compute.   \n\u2022 The paper should disclose whether the full research project required more compute than the experiments reported in the paper (e.g., preliminary or failed experiments that didn\u2019t make it into the paper). ", "page_idx": 25}, {"type": "text", "text": "9. Code Of Ethics ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "Question: Does the research conducted in the paper conform, in every respect, with the NeurIPS Code of Ethics https://neurips.cc/public/EthicsGuidelines? ", "page_idx": 25}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "Justification: The paper respect with the NeurIPS Code of Ethics. Guidelines: ", "page_idx": 25}, {"type": "text", "text": "\u2022 The answer NA means that the authors have not reviewed the NeurIPS Code of Ethics.   \n\u2022 If the authors answer No, they should explain the special circumstances that require a deviation from the Code of Ethics.   \n\u2022 The authors should make sure to preserve anonymity (e.g., if there is a special consideration due to laws or regulations in their jurisdiction). ", "page_idx": 25}, {"type": "text", "text": "10. Broader Impacts ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "Question: Does the paper discuss both potential positive societal impacts and negative societal impacts of the work performed? ", "page_idx": 25}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 25}, {"type": "text", "text": "Justification: There is no societal impact of the work performed. ", "page_idx": 25}, {"type": "text", "text": "Guidelines: ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "\u2022 The answer NA means that there is no societal impact of the work performed.   \n\u2022 If the authors answer NA or No, they should explain why their work has no societal impact or why the paper does not address societal impact.   \n\u2022 Examples of negative societal impacts include potential malicious or unintended uses (e.g., disinformation, generating fake profiles, surveillance), fairness considerations (e.g., deployment of technologies that could make decisions that unfairly impact specific groups), privacy considerations, and security considerations.   \n\u2022 The conference expects that many papers will be foundational research and not tied to particular applications, let alone deployments. However, if there is a direct path to any negative applications, the authors should point it out. For example, it is legitimate to point out that an improvement in the quality of generative models could be used to generate deepfakes for disinformation. On the other hand, it is not needed to point out that a generic algorithm for optimizing neural networks could enable people to train models that generate Deepfakes faster.   \n\u2022 The authors should consider possible harms that could arise when the technology is being used as intended and functioning correctly, harms that could arise when the technology is being used as intended but gives incorrect results, and harms following from (intentional or unintentional) misuse of the technology.   \n\u2022 If there are negative societal impacts, the authors could also discuss possible mitigation strategies (e.g., gated release of models, providing defenses in addition to attacks, mechanisms for monitoring misuse, mechanisms to monitor how a system learns from feedback over time, improving the efficiency and accessibility of ML). ", "page_idx": 25}, {"type": "text", "text": "11. Safeguards ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "Question: Does the paper describe safeguards that have been put in place for responsible release of data or models that have a high risk for misuse (e.g., pretrained language models, image generators, or scraped datasets)? ", "page_idx": 25}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 25}, {"type": "text", "text": "Justification: The paper poses no such risks. ", "page_idx": 25}, {"type": "text", "text": "Guidelines: \u2022 The answer NA means that the paper poses no such risks. ", "page_idx": 25}, {"type": "text", "text": "\u2022 Released models that have a high risk for misuse or dual-use should be released with necessary safeguards to allow for controlled use of the model, for example by requiring that users adhere to usage guidelines or restrictions to access the model or implementing safety filters.   \n\u2022 Datasets that have been scraped from the Internet could pose safety risks. The authors should describe how they avoided releasing unsafe images.   \n\u2022 We recognize that providing effective safeguards is challenging, and many papers do not require this, but we encourage authors to take this into account and make a best faith effort. ", "page_idx": 26}, {"type": "text", "text": "12. Licenses for existing assets ", "text_level": 1, "page_idx": 26}, {"type": "text", "text": "Question: Are the creators or original owners of assets (e.g., code, data, models), used in the paper, properly credited and are the license and terms of use explicitly mentioned and properly respected? ", "page_idx": 26}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 26}, {"type": "text", "text": "Justification: We cite existing papers and url. ", "page_idx": 26}, {"type": "text", "text": "Guidelines: ", "page_idx": 26}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not use existing assets.   \n\u2022 The authors should cite the original paper that produced the code package or dataset.   \n\u2022 The authors should state which version of the asset is used and, if possible, include a URL.   \n\u2022 The name of the license (e.g., CC-BY 4.0) should be included for each asset.   \n\u2022 For scraped data from a particular source (e.g., website), the copyright and terms of service of that source should be provided.   \n\u2022 If assets are released, the license, copyright information, and terms of use in the package should be provided. For popular datasets, paperswithcode.com/datasets has curated licenses for some datasets. Their licensing guide can help determine the license of a dataset.   \n\u2022 For existing datasets that are re-packaged, both the original license and the license of the derived asset (if it has changed) should be provided.   \n\u2022 If this information is not available online, the authors are encouraged to reach out to the asset\u2019s creators. ", "page_idx": 26}, {"type": "text", "text": "13. New Assets ", "text_level": 1, "page_idx": 26}, {"type": "text", "text": "Question: Are new assets introduced in the paper well documented and is the documentation provided alongside the assets? ", "page_idx": 26}, {"type": "text", "text": "Answer: [No] ", "page_idx": 26}, {"type": "text", "text": "Justification: The models trained by us can not be launched. However, we give the details of training these models. ", "page_idx": 26}, {"type": "text", "text": "Guidelines: ", "page_idx": 26}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not release new assets.   \n\u2022 Researchers should communicate the details of the dataset/code/model as part of their submissions via structured templates. This includes details about training, license, limitations, etc.   \n\u2022 The paper should discuss whether and how consent was obtained from people whose asset is used.   \n\u2022 At submission time, remember to anonymize your assets (if applicable). You can either create an anonymized URL or include an anonymized zip file. ", "page_idx": 26}, {"type": "text", "text": "14. Crowdsourcing and Research with Human Subjects ", "text_level": 1, "page_idx": 26}, {"type": "text", "text": "Question: For crowdsourcing experiments and research with human subjects, does the paper include the full text of instructions given to participants and screenshots, if applicable, as well as details about compensation (if any)? ", "page_idx": 26}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 26}, {"type": "text", "text": "Justification: The paper does not involve crowdsourcing nor research with human subjects. ", "page_idx": 26}, {"type": "text", "text": "Guidelines: ", "page_idx": 27}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Including this information in the supplemental material is fine, but if the main contribution of the paper involves human subjects, then as much detail as possible should be included in the main paper.   \n\u2022 According to the NeurIPS Code of Ethics, workers involved in data collection, curation, or other labor should be paid at least the minimum wage in the country of the data collector. ", "page_idx": 27}, {"type": "text", "text": "15. Institutional Review Board (IRB) Approvals or Equivalent for Research with Human Subjects ", "text_level": 1, "page_idx": 27}, {"type": "text", "text": "Question: Does the paper describe potential risks incurred by study participants, whether such risks were disclosed to the subjects, and whether Institutional Review Board (IRB) approvals (or an equivalent approval/review based on the requirements of your country or institution) were obtained? ", "page_idx": 27}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 27}, {"type": "text", "text": "Justification: The paper does not involve crowdsourcing nor research with human subjects. Guidelines: ", "page_idx": 27}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Depending on the country in which research is conducted, IRB approval (or equivalent) may be required for any human subjects research. If you obtained IRB approval, you should clearly state this in the paper.   \n\u2022 We recognize that the procedures for this may vary significantly between institutions and locations, and we expect authors to adhere to the NeurIPS Code of Ethics and the guidelines for their institution.   \n\u2022 For initial submissions, do not include any information that would break anonymity (if applicable), such as the institution conducting the review. ", "page_idx": 27}]