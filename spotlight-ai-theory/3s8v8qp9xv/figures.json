[{"figure_path": "3s8V8QP9XV/figures/figures_2_1.jpg", "caption": "Figure 1: Lanczos-FA error ||f(A)b - lank(f; A, b)||2 at each iteration for several functions/spectra. \"Instance Optimal\" is the right hand side of Definition 2 with C = c = 1, which is a lower bound for all KSMs, including Lanczos-FA. Lanczos-FA performs nearly instance optimally on a wide range of problems, far better than Fact 3 predicts. This is easily seen in the bottom plots, which show the ratio of the error of the Lanczos-FA iterate and the Krylov optimal iterate, optk(f; A, b).", "description": "This figure compares the error of the Lanczos-FA algorithm to the instance optimal error for three different matrix functions: A\u207b\u00b2b, exp(-A/10)b, and log(A)b.  The top row shows the error of each method, while the bottom row shows the ratio of the Lanczos-FA error to the instance optimal error. The figure demonstrates that Lanczos-FA performs nearly optimally, achieving error very close to the best possible Krylov subspace method, significantly outperforming the theoretical bounds predicted by Fact 3.", "section": "Existing near-optimality analyses of Lanczos-FA"}, {"figure_path": "3s8V8QP9XV/figures/figures_4_1.jpg", "caption": "Figure 2: Despite its large prefactor, the bound of Theorem 4 qualitatively captures the convergence behavior of Lanczos-FA for rational functions. It can be tighter than the standard bound of Fact 3, even for a moderate number of iterations k. We use rational approximations to exp(-x/10) and log(x) for comparison with Figure 1; see Section 4 for more details.", "description": "This figure compares the error bounds of Theorem 4 and Fact 3 with the actual error of Lanczos-FA and the instance optimal error for three different functions: A\u207b\u00b2, a rational approximation of exp(-A/10), and a rational approximation of log(A).  It demonstrates that while Theorem 4 has a large prefactor, it more accurately reflects the convergence behavior of Lanczos-FA than the simpler Fact 3, especially for a larger number of iterations.", "section": "Experiments"}, {"figure_path": "3s8V8QP9XV/figures/figures_7_1.jpg", "caption": "Figure 3: The maximum observed ratio between the error of Lanczos-FA and the optimal error over choices of b when approximating A-\u00ba for matrices with varying condition number \u03ba. Each point corresponds to a pair (k, q). Points with the same color have the same value of \u03ba. On the left, the dotted line plots \u221aqk for the maximum \u03ba considered (106). On the right, the dotted line plots \u221aqk for the maximum q considered (26 = 64). Overall, the optimality ratio appears to scale at least as \u03a9(\u221aq\u03ba).", "description": "This figure shows the maximum observed ratio between the error of Lanczos-FA and the optimal error when approximating the inverse of A raised to the power of q (A\u207bq).  The experiment is run for matrices with various condition numbers (\u03ba). Each point represents a pair of (k, q) values, where k is the number of iterations and q is the degree of the rational function. Points of the same color share the same condition number. The dotted lines show the scaling of \u221aq\u03ba, suggesting the optimality ratio scales at least as \u03a9(\u221aq\u03ba). The left plot fixes the maximum \u03ba, and the right plot fixes the maximum q.", "section": "Experiments"}, {"figure_path": "3s8V8QP9XV/figures/figures_8_1.jpg", "caption": "Figure 4: Applying Lanczos-FA to the function A-0.4 and rational approximations of various degrees found using the BRASIL algorithm [40]. In this experiment, the spectrum of A contains two clusters: 10 eigenvalues uniformly spaced near 1, and 90 eigenvalues uniformly spaced near 100. As predicted by the bound in Section 2.2, convergence of Lanczos-FA for this function appears to closely track that of a high degree rational approximant.", "description": "The figure compares the convergence behavior of Lanczos-FA algorithm for approximating A<sup>-0.4</sup>b with the convergence of rational approximations of various degrees. The spectrum of matrix A consists of two clusters of eigenvalues: one close to 1 and the other close to 100.  The results show that the convergence of Lanczos-FA closely matches that of the high degree rational approximant, consistent with theoretical prediction of Section 2.2 of the paper.", "section": "Implications for non-rational functions"}, {"figure_path": "3s8V8QP9XV/figures/figures_8_2.jpg", "caption": "Figure 5: A comparison of Lanczos-FA with two methods from [44] (\"rational\" and \"slanczos\") for computing the matrix sign function, which work by using a stochastic iterative method to approximate rational approximations to the step function of various degrees. The \"rational\" method is the main one studied in [44], while \u201cslanczos\u201d is included because it is the best performing in their experiments. Each panel corresponds to one of the test problems from [44]. Iterations of these methods are counted in number of inner products with rows of A rather than number of matrix-vector products with A as a whole. To compare these with Lanczos-FA, we consider d such inner products to be equivalent to one matrix-vector product.", "description": "This figure compares the performance of Lanczos-FA to two other methods from a previous paper [44] for computing the matrix sign function.  The other methods use a stochastic iterative approach to approximate rational approximations of the step function. The plot shows that Lanczos-FA significantly outperforms these other methods.", "section": "Experiments"}, {"figure_path": "3s8V8QP9XV/figures/figures_9_1.jpg", "caption": "Figure 6: Convergence of Lanczos-FA for rational functions with poles in A's eigenvalue range or that are imaginary. The optimality ratio can be very large for some iterations. Similar behavior is seen for functions like sign(A) that have a discontinuity in the interval of A's eigenvalues. However, the \"overall\" convergence of Lanczos-FA still appears to closely track the instance-optimal solution.", "description": "This figure displays the convergence behavior of the Lanczos-FA algorithm for three different rational functions.  Each function has poles (discontinuities) within the range of the eigenvalues of the matrix A.  The top row shows plots of the relative error, comparing the Lanczos-FA approximation to the instance-optimal Krylov subspace approximation, while the bottom row shows the ratio of these errors.  Despite the fact that the optimality ratio is high at certain iterations (meaning that the algorithm's error significantly exceeds the optimal error), the overall error convergence of Lanczos-FA remains close to the instance optimum.", "section": "Additional Experiments"}, {"figure_path": "3s8V8QP9XV/figures/figures_22_1.jpg", "caption": "Figure 7: The bounds of Theorems 6 and 7 capture the convergence behavior of Lanczos-FA for A\u00b11/2b. In particular, they can be tighter than the FOV optimality bound of Fact 3. The predicted rate of convergence is about half that observed for Lanczos-FA in this example; this is due to the parameter c = 1/2 in both bounds.", "description": "This figure compares the error bounds from Theorems 6 and 7 with the actual error of the Lanczos-FA algorithm and the optimal error when applied to compute A<sup>1/2</sup>b and A<sup>-1/2</sup>b.  It shows that the bounds from Theorems 6 and 7 are tighter than Fact 3, a previously known bound, although they predict a slower convergence rate than what's actually observed.", "section": "Near Spectrum Optimality for A\u00b11/2b"}, {"figure_path": "3s8V8QP9XV/figures/figures_23_1.jpg", "caption": "Figure 3: The maximum observed ratio between the error of Lanczos-FA and the optimal error over choices of b when approximating A\u2212q for matrices with varying condition number \u03ba. Each point corresponds to a pair (k, q). Points with the same color have the same value of \u03ba. On the left, the dotted line plots \u221aqk for the maximum \u03ba considered (106). On the right, the dotted line plots \u221aqk for the maximum q considered (26 = 64). Overall, the optimality ratio appears to scale at least as \u03a9(\u221aq\u03ba).", "description": "This figure shows the maximum observed ratio between the error of the Lanczos-FA algorithm and the optimal error for different values of condition number (\u03ba) and rational function degree (q).  The x-axis represents either k (iterations) or \u03ba, while the y-axis is the maximum optimality ratio observed.  Points of the same color represent the same \u03ba or q value.  The dotted lines show the theoretical lower bound of the optimality ratio.", "section": "Experiments"}]