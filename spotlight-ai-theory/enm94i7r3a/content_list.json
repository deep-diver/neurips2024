[{"type": "text", "text": "Get rich quick: exact solutions reveal how unbalanced initializations promote rapid feature learning ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Daniel Kunin\u22171 Allan Ravent\u00f3s\u22171 Cl\u00e9mentine Domin\u00e92 Feng Chen1 David Klindt3 Andrew Saxe2 Surya Ganguli1 ", "page_idx": 0}, {"type": "text", "text": "1Stanford University 2University College London 3Cold Spring Harbor Laboratory ", "page_idx": 0}, {"type": "text", "text": "Abstract ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "While the impressive performance of modern neural networks is often attributed to their capacity to efficiently extract task-relevant features from data, the mechanisms underlying this rich feature learning regime remain elusive, with much of our theoretical understanding stemming from the opposing lazy regime. In this work, we derive exact solutions to a minimal model that transitions between lazy and rich learning, precisely elucidating how unbalanced layer-specific initialization variances and learning rates determine the degree of feature learning. Our analysis reveals that they conspire to influence the learning regime through a set of conserved quantities that constrain and modify the geometry of learning trajectories in parameter and function space. We extend our analysis to more complex linear models with multiple neurons, outputs, and layers and to shallow nonlinear networks with piecewise linear activation functions. In linear networks, rapid feature learning only occurs from balanced initializations, where all layers learn at similar speeds. While in nonlinear networks, unbalanced initializations that promote faster learning in earlier layers can accelerate rich learning. Through a series of experiments, we provide evidence that this unbalanced rich regime drives feature learning in deep finite-width networks, promotes interpretability of early layers in CNNs, reduces the sample complexity of learning hierarchical data, and decreases the time to grokking in modular arithmetic. Our theory motivates further exploration of unbalanced initializations to enhance efficient feature learning. ", "page_idx": 0}, {"type": "text", "text": "1 Introduction ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Deep learning has transformed machine learning, demonstrating remarkable capabilities in a myriad of tasks ranging from image recognition to natural language processing. It\u2019s widely believed that the impressive performance of these models lies in their capacity to efficiently extract task-relevant features from data. However, understanding this feature acquisition requires unraveling a complex interplay between datasets, network architectures, and optimization algorithms. Within this framework, two distinct regimes, determined at initialization, have emerged: the lazy and the rich. ", "page_idx": 0}, {"type": "text", "text": "Lazy regime. Various investigations have revealed a notable phenomenon in overparameterized neural networks, where throughout training the networks remain close to their linearization [1, 2, 3, 4, 5]. Seminal work by Jacot et al. [6], demonstrated that in the infinite-width limit, the Neural Tangent Kernel (NTK), which describes the evolution of the neural network through training, converges to a deterministic limit. Consequently, the network learns a solution akin to kernel regression with the NTK matrix. Termed the lazy or kernel regime, this domain has been characterized by a deterministic NTK [6, 7], minimal movement in parameter space [8], static hidden representations, exponential learning curves, and implicit biases aligned with a reproducing kernel Hilbert space (RKHS) norm [9]. However, Chizat et al. [8] challenged this understanding, asserting that the lazy regime isn\u2019t a ", "page_idx": 0}, {"type": "image", "img_path": "eNM94i7R3A/tmp/f34478719bbbe25021fefe61c8a8fdd5ec020572ed5367d5a17ce3a505749c3d.jpg", "img_caption": ["(a) Overall and relative scale impact feature learning "], "img_footnote": [], "page_idx": 1}, {"type": "image", "img_path": "eNM94i7R3A/tmp/7cfe183f802c947a12da24459d182dc91065995d162ade16f82e5103c8b42b19.jpg", "img_caption": ["(b) A complex phase portrait of feature learning "], "img_footnote": [], "page_idx": 1}, {"type": "text", "text": "Figure 1: Unbalanced initializations lead to rapid rich learning and generalization. We follow the experimental setup used in Fig. 1 of Chizat et al. [8] \u2013 a wide two-layer student ReLU network $\\begin{array}{r}{f(x;\\bar{\\theta)}=\\sum_{i=1}^{h}a_{i}\\operatorname*{max}(0,w_{i}^{\\top}x)}\\end{array}$ trained on a dataset generated from a narrow two-layer teacher ReLU network. The student parameters are initialized as $w_{i}\\sim\\mathrm{Unif}\\big(\\mathbb{S}^{d-1}\\big(\\frac{\\tau}{\\alpha}\\big)\\big)$ and $a_{i}=\\pm\\alpha\\tau$ , such that $\\tau>0$ controls the overall scale of the function, while $\\alpha>0$ controls the relative scale of the first and second layers through the conserved quantity $\\delta=\\tau^{2}(\\alpha^{2}-\\alpha^{-2})$ . (a) Shows the training trajectories of $|a_{i}|w_{i}$ (color denotes $\\mathrm{sgn}(a_{i}))$ when $d=2$ for four different settings of $\\tau,\\delta$ . The left plot confirms that small overall scale leads to rich and large overall scale to lazy. The right plot shows that even at small overall scale, the relative scale can move the network between rich and lazy as well. Here an upstream initialization $\\delta>0$ shows striking alignment to the teacher (dotted lines), while a downstream initialization $\\delta<0$ shows no alignment. (b) Shows the test loss and kernel distance from initialization computed through training over a sweep of $\\tau$ and $\\delta$ when $d=100$ . Lazy learning happens when $\\tau$ is large, rich learning happens when $\\tau$ is small, and rapid rich learning happens when both $\\tau$ is small and $\\delta$ is large \u2013 an upstream initialization. This initialization also leads to the smallest test loss. See Fig. 10 in Appendix D.1 for supporting figures. ", "page_idx": 1}, {"type": "text", "text": "product of the infinite-width architecture, but is contingent on the overall scale of the network at initialization. They demonstrated that given any finite-width model $f(x;{\\boldsymbol{\\theta}})$ whose output is zero at initialization, a scaled version of the model $\\tau f(x;\\theta)$ will enter the lazy regime as the scale $\\tau$ diverges. However, they also noted that these scaled models often perform worse in test error. While the lazy regime offers insights into the network\u2019s convergence to a global minimum, it does not fully capture the generalization capabilities of neural networks trained with standard initializations. It is thus widely believed that a different regime, driven by small or vanishing initializations, underlies the many successes of neural networks. ", "page_idx": 1}, {"type": "text", "text": "Rich regime. In contrast to the lazy regime, the rich or feature-learning or active regime is distinguished by a learned NTK that evolves through training, non-convex dynamics traversing between saddle points [10, 11, 12], sigmoidal learning curves, and simplicity biases such as low-rankness [13] or sparsity [14]. Yet, the exact characterization of rich learning and the features it learns frequently depends on the specific problem at hand, with its definition commonly simplified as what it is not: lazy. Recent analyses have shown that beyond overall scale, other aspects of the initialization can substantially impact the extent of feature learning, such as the effective rank [15], layer-specific initialization variances [16, 17, 18], and large learning rates [19, 20, 21, 22]. Azulay et al. [9] demonstrated that in two-layer linear networks, the relative difference in weight magnitudes between the first and second layer, termed the relative scale in our work, can impact feature learning, with balanced initializations yielding rich learning dynamics, while unbalanced ones tend to induce lazy dynamics. However, as shown in Fig. 1, for nonlinear networks unbalanced initializations can induce both rich and lazy dynamics, creating a complex phase portrait of learning regimes influenced by both overall and relative scale. Building on these observations, our study aims to precisely understand how layer-specific initialization variances and learning rates determine the transition between lazy and rich learning in finite-width networks. Moreover, we endeavor to gain insights into the inductive biases of both regimes, and the transition between them, during training and at interpolation, with the ultimate goal of elucidating how the rich regime acquires features that facilitate generalization. ", "page_idx": 1}, {"type": "text", "text": "Our contributions. Our work begins with an exploration of the two-layer single-neuron linear network proposed by Azulay et al. [9] as a minimal model displaying both lazy and rich learning. In Section 3, we derive exact solutions for the gradient flow dynamics with layer-specific learning rates of this model by employing a combination of hyperbolic and spherical coordinate transformations. ", "page_idx": 1}, {"type": "text", "text": "Alongside recent work by $\\mathrm{Xu}$ and Ziyin $[23]^{1}$ , our analysis stands out as one of the few analytically tractable models for the transition between lazy and rich learning in a finite-width network, marking a notable contribution to the field. Our analysis reveals that the layer-specific initialization variances and learning rates conspire to influence the learning regime through a simple set of conserved quantities that constrain the geometry of learning trajectories. Additionally, it reveals that a crucial aspect of the relative scale overlooked in prior analysis is its directionality. While a balanced initialization results in all layers learning at similar rates, an unbalanced initialization can cause faster learning in either earlier layers, referred to as an upstream initialization, or later layers, referred to as a downstream initialization. Due to the depth-dependent expressivity of layers in a network, upstream and downstream initializations often exhibit fundamentally distinct learning trajectories. In Section 4 we extend our analysis of the relative scale developed in the single-neuron model to more complex linear models with multiple neurons, outputs, and layers and in Section 5 to two-layer nonlinear networks with piecewise linear activation functions. We find that in linear networks, rapid rich learning can only occur from balanced initializations, while in nonlinear networks, upstream initializations can actually accelerate rich learning. Finally, through a series of experiments, we provide evidence that upstream initializations drive feature learning in deep finite-width networks, promote interpretability of early layers in CNNs, reduce the sample complexity of learning hierarchical data, and decrease the time to grokking in modular arithmetic. ", "page_idx": 2}, {"type": "text", "text": "Notation. In this work, we consider a feedforward network $f(x;\\theta):\\,\\mathbb{R}^{d}\\,\\to\\,\\mathbb{R}^{c}$ parameterized by $\\theta\\:\\in\\:\\mathbb{R}^{m}$ . Unless otherwise specified, $c\\,=\\,1$ . The network is trained by gradient flow $\\Dot{\\theta}=$ $-\\eta_{\\theta}\\cdot\\nabla_{\\theta}\\mathcal{L}(\\theta)$ , with an initialization $\\theta_{0}$ and layer-specific learning rate $\\eta_{\\theta}\\in\\mathbb{R}_{+}^{m}$ , to minimize the mean squared error $\\begin{array}{r}{\\mathcal{L}(\\theta)=\\frac{1}{2}\\sum_{i=1}^{n}(f(x_{i};\\theta)\\!-\\!y_{i})^{2}}\\end{array}$ computed over a dataset $\\left\\{(x_{1},y_{1}),\\ldots,(x_{n},y_{n})\\right\\}$ of size $n$ . We denote the input matrix as $X\\,\\in\\,\\mathbb{R}^{n\\times d}$ with rows $x_{i}\\,\\in\\,\\mathbb{R}^{d}$ and the label vector as $y\\in\\mathbb{R}^{n}$ . The network\u2019s output $f(x;{\\boldsymbol{\\theta}})$ evolves according to the differential equation, $\\partial_{t}f(x;\\theta)=$ $\\begin{array}{r}{\\sum_{i=1}^{n}\\Theta(x,x_{i};\\theta)(y_{i}-f(x_{i};\\theta))}\\end{array}$ , where $\\Theta(x,x^{\\prime};\\theta):\\mathbb{R}^{d}\\times\\mathbb{R}^{d}\\to\\mathbb{R}$ is the Neural Tangent Kernel $(N T K)$ , defined as $\\begin{array}{r}{\\Theta(x,x^{\\prime};\\theta)\\,=\\,\\sum_{p=1}^{m}\\eta_{\\theta_{p}}\\partial_{\\theta_{p}}f(x;\\theta)\\partial_{\\theta_{p}}f(x^{\\prime};\\theta)}\\end{array}$ . The NTK quantifies how one gradient step with data point $x^{\\prime}$ affects the evolution of the networks\u2019s output evaluated at another data point $x$ . When $\\eta_{\\theta_{p}}$ is shared by all parameters, the NTK is the kernel associated with the feature map $\\nabla_{\\theta}f(x;\\theta)\\in\\mathbb{R}^{m}$ . We also define the NTK matrix $K\\in\\mathbb{R}^{n\\times n}$ , which is computed across the training data such that $K_{i j}=\\Theta(x_{i},x_{j};\\theta)$ . The NTK matrix evolves from its initialization $K_{0}$ to convergence $K_{\\infty}$ through training. Lazy and rich learning exist on a spectrum, with the extent of this evolution serving as the distinguishing factor. Various studies have proposed different metrics to track the evolution of the NTK matrix [24, 25, 26]. We use kernel distance [27], defined as $S(t_{1},t_{2})=$ $1-\\langle K_{t_{1}},K_{t_{2}}\\rangle/\\left(\\|K_{t_{1}}\\|_{F}\\|K_{t_{2}}\\|_{F}\\right)$ , which is a scale invariant measure of similarity between the NTK at two times. In the lazy regime $S(0,t)\\approx0$ , while in the rich regime $0\\ll S(0,\\dot{t})\\leq1$ . ", "page_idx": 2}, {"type": "text", "text": "2 Related Work ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "Linear networks. Significant progress in studying the rich regime has been achieved in the context of linear networks. In this setting, $f(x;\\theta)=\\beta(\\theta)^{\\top}x$ is linear in its input $x$ , but can exhibit highly nonlinear dynamics in parameter $\\theta$ and function $\\beta(\\theta)$ space. Foundational work by Saxe et al. [10] provided exact solutions to gradient flow dynamics in linear networks with task-aligned initializations. They achieved this by solving a system of Bernoulli differential equations that prioritize learning the most salient features first, which can be beneficial for generalization [28]. This analysis has been extended to wide [29, 30] and deep [31, 32, 33] linear networks with more flexible initialization schemes [34, 35, 36]. It has also been applied to study the evolution of the NTK [37] and the influence of the scale on the transition between lazy and rich learning [12, 23]. In this work, we present novel exact solutions for a minimal model utilizing a mix of Bernoulli and Riccati equations to showcase a complex phase portrait of lazy and rich learning with separate alignment and fitting phases. ", "page_idx": 2}, {"type": "text", "text": "Implicit bias. An effective analysis approach to understanding the rich regime studies how the initialization influences the inductive bias at interpolation. The aim is to identify a function $Q(\\theta)$ such that the network converges to a first-order KKT point minimizing $Q(\\theta)$ among all possible interpolating solutions. Foundational work by Soudry et al. [38] pioneered this approach for a linear classifier trained with gradient descent, revealing a max margin bias. These findings have been extended to deep linear networks [39, 40, 41], homogeneous networks [42, 43, 44], and quasihomogeneous networks [45]. A similar line of research expresses the learning dynamics of networks trained with mean squared error as a mirror flow for some potential $\\Phi(\\beta)$ , such that the inductive bias can be expressed as a Bregman divergence [46]. This approach has been applied to diagonal linear networks, revealing an inductive bias that interpolates between $\\ell^{1}$ and $\\ell^{2}$ norms in the rich and lazy regimes respectively [14]. However, finding the potential $\\Phi(\\beta)$ is problem-specific and requires solving a second-order differential equation, which may not be solvable even in simple settings [47, 48]. Azulay et al. [9] extended this analysis to a time-warped mirror flow, enabling the study of a broader class of architectures. In this work we derive exact expressions for the inductive bias of our minimal model and extend the results in Azulay et al. [9] to wide and deep linear networks. ", "page_idx": 2}, {"type": "text", "text": "", "page_idx": 3}, {"type": "text", "text": "Two-layer networks. Two-layer, or single-hidden layer, piecewise linear networks have emerged as a key setting for advancing our understanding of the rich regime. Maennel et al. [49] observed that in training two-layer ReLU networks from small initializations, the first-layer weights concentrate along fixed directions determined by the training data, irrespective of network width. This phenomenon, termed quantization, has been proposed as a simplicity bias inherent to the rich regime, driving the network towards low-rank solutions when feasible. Subsequent studies have aimed to precisely elucidate this effect by introducing structural constraints on the training data [50, 51, 52, 53, 54, 55]. Across these analyses, a consistent observation is that the learning dynamics involve distinct phases: an initial alignment phase characterized by quantization, followed by ftiting phases where the task is learned. All of these studies assumed a balanced (or nearly balanced) initialization between the first and second layer. In this study, we explore how unbalanced initializations influence the phases of learning, demonstrating that it can eliminate or augment the quantization effect. ", "page_idx": 3}, {"type": "text", "text": "Infinite-width networks. Many recent advancements in understanding the rich regime have come from studying how the initialization variance and layer-wise learning rates should scale in the infinitewidth limit to ensure constant movement in the activations, gradients, and outputs. In this limit, analyzing dynamics becomes simpler in several respects: random variables concentrate and quantities will either vanish to zero, remain constant, or diverge to infinity [17]. A set of works used tools from statistical mechanics to provide analytic solutions for the rich population dynamics of two-layer nonlinear neural networks initialized according to the mean field parameterization [56, 57, 58, 59]. These ideas were extended to deeper networks through a tensor program framework, leading to the derivation of maximal update parametrization $(\\mu{\\mathrm{P}})$ [16, 18]. The $\\mu\\mathrm{P}$ parameterization has also been derived through a self-consistent dynamical mean field theory [60] and a spectral scaling analysis [61]. In this study, we focus on finite-width neural networks, but discuss the connection between our work and these width-dependent parameterizations in Section 5. ", "page_idx": 3}, {"type": "text", "text": "3 A Minimal Model of Lazy and Rich Learning with Exact Solutions ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "Here we explore an illustrative setting simple enough to admit exact gradient flow dynamics, yet complex enough to showcase lazy and rich learning regimes. We study a two-layer linear network with a single hidden neuron defined by the map $\\bar{f}(x;\\theta)=a w^{\\top}x$ where $a\\in\\mathbb{R}$ , $w\\in\\mathbb{R}^{d}$ are the parameters. We examine how the parameter initializations $a_{0},w_{0}$ and the layer-wise learning rates \u03b7a, \u03b7w influence the training trajectory in parameter space, function space (defined by the product $\\beta=a w,$ ), and the evolution of the the NTK matrix, ", "page_idx": 3}, {"type": "image", "img_path": "eNM94i7R3A/tmp/6b3621d8c6956c5fec3cb8cf5e0bc4ded86e6255b371276f50e307d135a19a34.jpg", "img_caption": [], "img_footnote": [], "page_idx": 3}, {"type": "equation", "text": "$$\nK=X\\left(\\eta_{w}a^{2}\\mathbf{I}_{d}+\\eta_{a}w w^{\\mathsf{T}}\\right)X^{\\mathsf{T}}.\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "Figure 2: Balance determines geometry of trajectory. The quantity $\\delta\\,=\\,\\eta_{w}a^{2}-\\eta_{a}\\|w\\|^{2}$ is conserved through gradient flow, which constrains the trajectory to: (a) a onesheeted hyperboloid for downstream initializations, (b) a double cone for balanced initializations, and (c) a twosheeted hyperboloid for upstream initializations. Gradient flow dynamics for three different initializations $a_{0},w_{0}$ with the same product $\\beta_{0}~=~a_{0}w_{0}$ are shown. The minima manifold is shown in red and the manifold of equivalent $\\beta_{0}$ initializations in gray. The surface is colored according to training loss, with blue representing higher loss and red representing lower loss. ", "page_idx": 3}, {"type": "text", "text": "Except for a measure zero set of initializations which converge to saddle points2, all gradient flow trajectories will converge to a global minimum, de", "page_idx": 3}, {"type": "text", "text": "termined by the normal equations $X\\intercal X a w=X\\intercal y$ . However, even when $X^{\\intercal}X$ is invertible such that the global minimum $\\beta_{*}$ is unique, the rescaling symmetry between $a$ and $w$ results in a manifold of minima in parameter space. The minima manifold is a one-dimensional hyperbola where $w\\propto\\beta_{*}$ and has two distinct branches for positive and negative $a$ . The symmetry also imposes a constraint on the network\u2019s trajectory, maintaining the difference $\\delta=\\eta_{w}a^{\\tilde{2}}-\\eta_{a}\\lVert\\dot{\\boldsymbol{w}}\\rVert^{2}\\in\\mathbb{R}$ throughout training (see Appendix A.1 for details). This confines the parameter dynamics to the surface of a hyperboloid where the magnitude and sign of the conserved quantity determines the geometry, as shown in Fig. 2. An upstream initialization occurs when $\\delta>0$ , a balanced initialization when $\\delta=0$ , and a downstream initialization when $\\delta<0$ . ", "page_idx": 3}, {"type": "text", "text": "", "page_idx": 4}, {"type": "text", "text": "Deriving exact solutions in parameter space. We initially assume3 whitened input $X^{\\mathsf{T}}X=\\mathbf{I}_{d}$ such that the ordinary least squares solution is $\\beta_{*}=X^{\\intercal}y$ , and the gradient flow dynamics simplify to $\\dot{a}=\\eta_{a}\\left(w^{\\mathsf{T}}\\beta_{*}\\stackrel{\\cdot}{-}a\\|w\\|^{2}\\right)$ , $\\dot{w}=\\eta_{w}\\left(a\\beta_{*}-a^{2}w\\right)$ . Notice that $w(t)\\in\\mathrm{span}(\\{w_{0},\\beta_{*}\\})$ , and through training, $w$ aligns in direction to $\\pm\\beta_{*}$ depending on the basin of attraction4 the parameters are initialized in. Therefore, we can monitor the dynamics by tracking the hyperbolic geometry between $a$ and $\\|w(t)\\|$ and the spherical angle between $w(t)$ and $\\beta_{*}$ . We study the variables $\\mu=a\\|w\\|$ , an invariant under the rescale symmetry, and $\\begin{array}{r}{\\phi=\\frac{w^{\\boldsymbol{\\mathsf{T}}}\\beta_{*}}{\\|\\boldsymbol{w}\\|\\|\\beta_{*}\\|}}\\end{array}$ , the cosine of the spherical angle. From these two scalar quantities $\\mu(t),\\phi(t)$ and the initialization $a_{0},w_{0}$ , we can determine the trajectory $a(t)$ and $w(t)$ in parameter space. The dynamics for $\\mu,\\phi$ are given by the coupled nonlinear ODEs, ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\dot{\\mu}=\\sqrt{\\delta^{2}+4\\eta_{a}\\eta_{w}\\mu^{2}}\\left(\\phi\\|\\beta_{*}\\|-\\mu\\right),\\qquad\\dot{\\phi}=\\frac{\\eta_{a}\\eta_{w}2\\mu\\|\\beta_{*}\\|}{\\sqrt{\\delta^{2}+4\\eta_{a}\\eta_{w}\\mu^{2}}-\\delta}\\left(1-\\phi^{2}\\right).\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "Amazingly, this system can be solved exactly, as discussed in Appendix A.2, and shown in Fig. 3. Without delving into the specifics, we can develop an intuitive understanding of the solutions by examining the influence of the relative scale $\\delta$ . ", "page_idx": 4}, {"type": "text", "text": "Upstream. When $\\delta\\gg0$ , the updates for both $\\mu$ and $\\phi$ diverge, but $\\phi$ updates much more rapidly. We can decouple the dynamics of $\\mu$ and $\\phi$ by separation of their time scales and assume $\\phi$ has reached its steady-state of $\\pm1$ before $\\mu$ has updated. Then, the dynamics of $\\mu$ is linear and proceeds exponentially to $\\pm\\lVert\\beta_{*}\\rVert$ . This regime exhibits minimal kernel movement (see Fig. 3 (c)) because the kernel is dominated by the $\\eta_{w}a^{2}\\mathbf{I}_{d}$ term, whereas it is mainly $w$ that updates. ", "page_idx": 4}, {"type": "text", "text": "Balanced. When $\\delta\\ =\\ 0$ , $\\mu$ follows a Bernoulli differential equation driven by a time-dependent signal $\\phi\\Vert\\beta_{*}\\Vert$ , and $\\phi$ follows a Riccati equation evolving from an initial value to $\\pm1$ depending on the basin of attraction. For vanishing initialization $\\|\\beta_{0}\\|\\rightarrow0$ , the temporal dynamics of $\\mu$ and $\\phi$ decouple such that there are two phases of ", "page_idx": 4}, {"type": "image", "img_path": "eNM94i7R3A/tmp/ed75a28ce9a28944124f9f32981a8184358976920c51acc0b237c734af87ac13.jpg", "img_caption": [], "img_footnote": [], "page_idx": 4}, {"type": "text", "text": "Figure 3: Exact solutions for the single hidden neuron model. Our theoretical predictions (black dashed lines) agree with gradient flow simulations (solid lines, color-coded based on $\\delta$ values), shown here for three key metrics: $\\mu$ (left), $\\phi$ (middle), and $S(0,t)$ (right). Each metric starts at the same value for all $\\delta$ , but varying $\\delta$ has a pronounced effect on the metric\u2019s dynamics. For upstream initializations $(\\delta\\gg0)$ ), $\\mu$ changes only slightly, $\\phi$ exponentially aligns, and $S$ remains near zero, indicative of the lazy regime. For balanced initializations $\\mathbf{\\boldsymbol{\\delta}}=\\mathbf{\\boldsymbol{0}},$ ), both $\\mu$ and $\\phi$ change significantly and $S$ quickly moves away from zero, indicative of the rich regime. For downstream initializations $\\left(\\delta\\ll0\\right)$ ), $\\mu$ quickly drops to zero, then $\\mu$ and $\\phi$ slowly climb back to one. Similarly, $S$ remains small before a sudden transition towards one, indicative of a delayed rich regime. See Appendix A.2 for further details. ", "page_idx": 4}, {"type": "text", "text": "learning: an initial alignment phase where $\\phi\\rightarrow\\pm1$ , followed by a fitting phase where $\\mu\\rightarrow\\pm\\|\\beta_{*}\\|$ . In the first phase, $w$ aligns to $\\beta_{*}$ resulting in a rank-one update to the NTK, identical to the silent alignment effect described in Atanasov et al. [37]. In the second phase, the dynamics of $\\mu$ simplify to the Bernoulli equation studied in Saxe et al. [10] and the kernel evolves solely in overall scale. ", "page_idx": 4}, {"type": "text", "text": "Downstream. When $\\delta\\ll0$ , the updates for $\\mu$ diverge, while the updates for $\\phi$ vanishes. In this regime the dynamics proceed by an initial fast phase where $\\mu$ converges exponentially to its steady state of $\\phi\\Vert\\beta_{*}\\Vert$ . Plugging this steady state into the dynamics of $\\phi$ gives a Bernoulli differential equation $\\begin{array}{r}{\\dot{\\phi}=\\eta_{a}\\eta_{w}\\|\\beta_{*}\\|^{2}|\\delta|^{-1}\\phi(1-\\phi^{2})}\\end{array}$ . Due to the coefficient $|\\delta|^{-1}$ , the second alignment phase proceeds very slowly as $\\phi$ approaches $\\pm1$ , assuming $\\phi,\\mu\\neq0$ , which is a saddle point. In this regime, the dynamics proceed by an initial lazy ftiting phase, followed by a rich alignment phase, where the delay is determined by the magnitude of $\\delta$ . ", "page_idx": 4}, {"type": "text", "text": "", "page_idx": 5}, {"type": "text", "text": "Identifying regimes of learning in function space. Here we take an alternative route towards understanding the influence of the relative scale by directly examining the dynamics in function space, an analysis strategy we will generalize to broader setups in Sections 4 and 5. The network\u2019s function is determined by the product $\\beta=$ $a w$ and governed by the ODE, ", "page_idx": 5}, {"type": "image", "img_path": "eNM94i7R3A/tmp/e79100e0e3dd315b1b5742c0507d91aeb71c7b219c4dfacd22bfbbc5108fdfcc.jpg", "img_caption": [], "img_footnote": [], "page_idx": 5}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\dot{\\boldsymbol{\\beta}}=-\\underbrace{\\left(\\eta_{w}a^{2}\\mathbf{I}_{d}+\\eta_{a}w w^{\\top}\\right)}_{M}X^{\\top}\\boldsymbol{\\rho},}\\end{array}\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "where $\\rho=X\\beta-y$ is the residual. These Figure 4: Balance modulates $\\beta$ dynamics and implicit dynamics can be interpreted as precondi- bias. Here we show the dynamics of \u03b2 = aw with diftioned gradient flow on the loss in function ferent values of , but the same initial $\\beta_{0}$ . When space where the preconditioning matrix $M$ is whitened (left), we can solve for the dynamics exdepends on time through its dependence on actly using our expressions for $\\mu,\\phi$ (black dashed lines). $a^{2}$ and $w w^{\\boldsymbol{\\mathsf{T}}}$ . Whenever $\\|\\beta\\|\\neq0$ , we can Upstream initializations follow the trajectory of gradiexpress $M$ directly in terms of $\\beta$ and $\\delta$ as ent flow on $\\beta$ , downstream initializations first move $M=\\frac{\\kappa+\\delta}{2}\\mathbf{I}_{d}+\\frac{\\kappa-\\delta}{2}\\frac{\\beta\\beta\\mathsf{r}}{\\|\\beta\\|^{2}},$ (4) in the direction of $\\beta_{*}$ , and balanced initializations take an intermediate $\\beta_{0}$ before sweeping around towards trajectory between these two. When $X^{\\intercal}X$ is low-rank where $\\kappa\\;=\\;\\sqrt{\\delta^{2}+4\\eta_{a}\\eta_{w}\\|\\beta\\|^{2}}$ (see Ap- (right), then we can only predict the trajectories in the pendix A.3 for a derivaatiown). This estab- limit of \u03b4 = \u00b1\u221e. If the interpolating manifold is onelishes a self-consistent equation for the dy- dimensional, then we can solve for the solution in terms namics of $\\beta$ regulated by $\\delta$ . Additionally, of $\\delta$ exactly (black dots). See Appendix A.4 for details. notice that $M$ characterizes the NTK matrix Eq. (1). Thus, understanding the evolution of $M$ along the trajectory $\\beta_{0}$ to $\\beta_{*}$ offers a method to discern between lazy and rich learning. Upstream. When $\\delta\\gg0$ , $M\\approx\\delta\\mathbf{I}_{d}$ , and the dynamics of $\\beta$ converge to the trajectory of linear regression trained by gradient flow. Along this trajectory the NTK matrix remains constant, confirming the dynamics are lazy. Balanced. When $\\delta=0$ , $\\begin{array}{r}{M=\\sqrt{\\eta_{a}\\eta_{w}}\\|\\beta\\|({\\bf I}_{d}+\\frac{\\beta\\beta^{\\sf r}}{\\|\\beta\\|^{2}})}\\end{array}$ + \u2225\u03b2\u03b2\u03b2\u2225\u22ba2 ). Here the dynamics balance between following the lazy trajectory and attempting to fti the task by only changing in norm. As a result the NTK changes in both magnitude and direction through training, confirming the dynamics are rich. Downstream. When $\\delta\\ll0$ , $\\begin{array}{r}{M\\approx|\\delta|\\frac{\\beta\\beta^{\\pm}}{\\|\\beta\\|^{2}}}\\end{array}$ , and $\\beta$ follows a projected gradient descent trajectory, attempting to reach $\\beta_{*}$ in the direction of $\\lvert\\beta_{0}$ . Along this trajectory the NTK matrix doesn\u2019t evolve. However, if $\\beta_{0}$ is not aligned to $\\beta_{*}$ , then at some point the dynamics of $\\beta$ will slowly align. In this second alignment phase the NTK matrix will change, confirming the dynamics are initially lazy followed by a delayed rich phase. See Appendix A.3.1 for a derivation of the NTK dynamics $\\dot{K}$ . ", "page_idx": 5}, {"type": "text", "text": "Determining the implicit bias via mirror flow. So far we have considered whitened or full rank $X^{\\intercal}X$ , ensuring the existence of a unique least squares solution $\\beta_{*}$ . In this setting, $\\delta$ influences the trajectory the model takes from $\\beta_{0}$ to $\\beta_{*}$ , as shown in Fig. 4 (a). Now we consider low-rank $X^{\\intercal}X$ , such that there exist infinitely many interpolating solutions in function space. By studying the structure of $M$ , we can characterize how $\\delta$ determines the interpolating solution the dynamics converge to. Extending a time-warped mirror flow analysis strategy pioneered by Azulay et al. [9] to allow $\\delta<0$ (see Appendix A.4 for details), we prove the following theorem, which shows a tradeoff between reaching the minimum norm solution and preserving the direction of the initialization $\\beta_{0}$ . ", "page_idx": 5}, {"type": "text", "text": "Theorem 3.1 (Extending Theorem 2 in Azulay et al. [9]). For a single hidden neuron linear network, for any $\\delta\\in\\mathbb{R},$ and initialization $\\beta_{0}$ such that $\\beta(t)\\neq0$ for all $t\\geq0$ , if the gradient flow solution $\\beta(\\infty)$ satisfies $X\\beta(\\infty)=y,$ , then, ", "page_idx": 5}, {"type": "equation", "text": "$$\n\\beta(\\infty)=\\underset{\\beta\\in\\mathbb{R}^{d}}{\\arg\\operatorname*{min}}\\,\\Psi_{\\delta}(\\beta)-\\psi_{\\delta}\\frac{\\beta_{0}}{\\|\\beta_{0}\\|}^{\\mathsf{\\mathsf{T}}}\\beta\\quad\\mathrm{s.t.}\\quad X\\beta=y\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "We observe that for vanishing initializations there is functionally no difference between the inductive bias of the upstream $\\left.\\right\\vert\\delta\\gg0$ ) and balanced $\\mathit{\\check{\\theta}}=0$ ) settings. However, in the downstream setting $\\leftrightharpoons0\\right.$ ), it is the second term preserving the direction of the initialization that dominates the inductive bias. This tradeoff in inductive bias as a function of $\\delta$ is presented in Fig. 4 (b), where if the null space of $X^{\\intercal}X$ is one-dimensional, we can solve for $\\beta(\\infty)$ in closed form (see Appendix A.4). ", "page_idx": 6}, {"type": "text", "text": "4 Wide and Deep Linear Networks ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "We now show how the analysis techniques used to study the influence of relative scale in the single-neuron setting can be applied to linear networks with multiple neurons, outputs, and layers. ", "page_idx": 6}, {"type": "text", "text": "Wide linear networks. We consider the dynamics of a two-layer linear network with $h$ hidden neurons and $c$ outputs, $f(x;\\theta)=A^{\\top}W x$ , where $\\dot{W}\\in\\mathbb{R}^{h\\times d}$ and $A\\in\\mathbb{R}^{h\\times c}$ . We assume $h\\geq\\operatorname*{min}(d,c)$ , such that this parameterization can represent all linear maps from $\\mathbb{R}^{d}\\rightarrow\\mathbb{R}^{c}$ . The rescaling symmetry between $A$ and $W$ implies the $h\\times h$ matrix $\\Delta=\\eta_{w}\\^{\\ \\ \\subset}A_{0}A_{0}^{\\intercal}-\\eta_{a}W_{0}W_{0}^{\\intercal}$ is conserved throughout gradient flow [62]. Drawing insights from our analysis of the single-neuron scenario $h=c=1)$ ), we consider the dynamics of $\\bar{\\beta}=\\bar{W}^{\\intercal}A\\in\\mathbb{R}^{d\\times c}$ , ", "page_idx": 6}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\mathrm{vec}\\left(\\dot{\\beta}\\right)=-\\underbrace{\\left(\\eta_{w}A^{\\top}A\\oplus\\eta_{a}W^{\\top}W\\right)}_{M}\\mathrm{vec}(X^{\\top}X\\beta-X^{\\top}Y),}\\end{array}\n$$", "text_format": "latex", "page_idx": 6}, {"type": "text", "text": "where $\\operatorname{vec}({\\cdot})$ denotes the vectorization operator and $\\bigoplus$ denotes the Kronecker $\\mathrm{sum}^{5}$ . As in the single-neuron setting, we find that the dynamics of $\\beta$ are preconditioned by a matrix $M$ that depends on quadratics of $A$ and $W$ and characterizes the NTK matrix $K=\\left(\\mathbf{I}_{c}\\otimes{\\dot{X}}\\right)M\\left(\\mathbf{I}_{c}\\otimes X\\mathsf{T}\\right)$ . We now show how $M$ can be expressed6 in terms of the rank-1 matrices $\\beta_{k}=w_{k}a_{k}^{\\mathsf{T}}\\in\\mathbb{R}^{d\\times c}$ , which represent the contribution to $\\beta$ of a single neuron with parameters $w_{k},\\,a_{k}$ and conserved quantity $\\delta_{k}=\\Delta_{k k}$ . ", "page_idx": 6}, {"type": "text", "text": "Theorem 4.1. Whenever $\\|\\beta_{k}\\|_{F}\\neq0$ for all $k\\,\\in\\,[h]$ , the matrix $M$ can be expressed as the sum $\\begin{array}{r}{M=\\sum_{k=1}^{h}M_{k}}\\end{array}$ over hidden neurons where $M_{k}$ is defined as, ", "page_idx": 6}, {"type": "equation", "text": "$$\nM_{k}=\\left(\\frac{\\sqrt{\\delta_{k}^{2}+4\\eta_{a}\\eta_{w}\\|\\beta_{k}\\|_{F}^{2}}+\\delta_{k}}{2}\\right)\\frac{\\beta_{k}^{\\top}\\beta_{k}}{\\|\\beta_{k}\\|_{F}^{2}}\\oplus\\left(\\frac{\\sqrt{\\delta_{k}^{2}+4\\eta_{a}\\eta_{w}\\|\\beta_{k}\\|_{F}^{2}}-\\delta_{k}}{2}\\right)\\frac{\\beta_{k}\\beta_{k}^{\\top}}{\\|\\beta_{k}\\|_{F}^{2}}.\n$$", "text_format": "latex", "page_idx": 6}, {"type": "text", "text": "By studying the dependence of $M$ on the conserved quantities $\\delta_{k}$ and the dimensions $d,h$ and $c$ , we can determine the influence of the relative scale on the learning regime. When $\\operatorname*{min}(d,c)\\leq h<$ $\\operatorname*{max}(d,c)$ , and assuming independent initializations for all $\\beta_{k}$ , then networks which narrow from input to output $(d>c)$ enter the lazy regime when all $\\delta_{k}\\gg0$ , whereas networks which expand from input to output $[d<c)$ do so when all $\\delta_{k}\\ll0$ . However, with opposite signs for $\\delta_{k}$ , and assuming all $\\beta_{k}(0)\\propto\\bar{\\beta}_{*}$ , these networks enter a delayed rich regime. As elaborated in Appendix B.1.5, this occurs because in these regimes a solution $\\beta_{*}$ does not exist within the space spanned by $M$ at initialization. When $h\\geq\\operatorname*{max}(d,c)$ all networks enter the lazy regime when all $\\delta_{k}\\gg0$ or all $\\delta_{k}\\ll0$ Conversely, as all $\\delta_{k}\\to0$ , all networks transition into the rich regime regardless of dimensions. While Theorem 4.1 offers valuable insight into the learning regimes in the limits of $\\delta_{k}$ , understanding the transition between regimes remains challenging. To achieve this, we aim to express $M$ in terms of $\\beta$ , rather than $\\beta_{k}$ , by introducing structure on the conserved quantities $\\Delta$ . ", "page_idx": 6}, {"type": "text", "text": "Theorem 4.2. When $\\Delta=\\delta\\mathbf{I}_{h}$ and $h=d$ if $\\delta<0$ or $h=c$ if $\\delta>0,$ , then the matrix $M$ can be expressed as $\\begin{array}{r}{M=\\sqrt{\\eta_{a}\\eta_{w}\\beta^{\\dagger}\\beta+\\frac{\\delta^{2}}{4}\\mathbf{I}_{c}}\\otimes\\mathbf{I}_{d}+\\mathbf{I}_{c}\\otimes\\sqrt{\\eta_{a}\\eta_{w}\\beta\\beta^{\\dagger}+\\frac{\\delta^{2}}{4}\\mathbf{I}_{d}}.}\\end{array}$ ", "page_idx": 6}, {"type": "text", "text": "From Theorem 4.2 the resulting dynamics of $\\beta$ simplify to a self-consistent equation regulated by $\\delta$ , ", "page_idx": 6}, {"type": "equation", "text": "$$\n\\dot{\\beta}=-X^{\\intercal}P\\sqrt{\\eta_{a}\\eta_{w}\\beta^{\\intercal}\\beta+\\frac{\\delta^{2}}{4}\\mathbf{I}_{c}}-\\sqrt{\\eta_{a}\\eta_{w}\\beta\\beta^{\\intercal}+\\frac{\\delta^{2}}{4}\\mathbf{I}_{d}}X^{\\intercal}P,\n$$", "text_format": "latex", "page_idx": 6}, {"type": "text", "text": "where $P=X\\beta-Y$ is the residual. Under our isotropic assumption on the conserved quanitities $\\Delta\\,=\\,\\delta\\mathbf{I}_{h}$ , these dynamics are exact. Concurrent to our work, Tu et al. [63] finds that $\\beta$ approximately follows these dynamics in the overparameterized setting $h\\gg\\operatorname*{max}(d,c)$ under a Gaussian initialization ${\\mathcal{N}}(0,\\sigma^{2})$ of the parameters where $\\sigma^{2}h$ is analogous to $\\delta$ . ", "page_idx": 6}, {"type": "text", "text": "Equipped with a self-consistent equation for the dynamics of $\\beta$ we now aim to interpret these dynamics as a mirror flow with a $\\delta$ -dependent potential. As presented in Theorem B.6, the dynamics of the singular values of $\\beta$ can be described as a mirror flow with a hyperbolic entropy potential, which smoothly interpolates between an $\\ell^{1}$ and $\\ell^{2}$ penalty on the singular values for the rich $(\\delta\\rightarrow0)$ ) and lazy $\\\"\\delta\\rightarrow\\pm\\infty\\rangle$ ) regimes respectively. This potential was first identified as the inductive bias for diagonal linear networks by Woodworth et al. [14] and the same mirror flow on the singular values is derived from a different initialization choice in prior work by Varre et al. [64]. ", "page_idx": 7}, {"type": "text", "text": "Deep linear networks. As presented in Theorem B.10, we generalize the inductive bias derived for rich two-layer linear networks by Azulay et al. [9] to deep linear networks. For a depth- $(L+1)$ linear network, $\\begin{array}{r}{f(x;\\theta)=A^{\\top}\\prod_{l=1}^{L}W_{l}x}\\end{array}$ , where $\\begin{array}{r}{\\beta=\\prod_{l=1}^{L}W_{l}^{\\top}A}\\end{array}$ , we find that the inductive bias of the rich regime is $\\begin{array}{r}{Q(\\beta)=(\\frac{L+1}{L+2})\\|\\beta\\|^{\\frac{L+2}{L+1}}-\\|\\beta_{0}\\|^{-\\frac{L}{L+1}}\\beta_{0}^{\\top}\\beta}\\end{array}$ . This inductive bias strikes a depth-dependent balance between attaining the minimum norm solution and preserving the initialization direction. ", "page_idx": 7}, {"type": "text", "text": "5 Piecewise Linear Networks ", "text_level": 1, "page_idx": 7}, {"type": "text", "text": "We now take a first step towards extending our analysis from linear networks to piecewise linear networks with activation functions of the form $\\sigma(z)\\,=\\,\\operatorname*{max}(z,\\gamma z)$ . The input-output map of a piecewise linear network with $L$ hidden layers and $h$ hidden neurons per layer is comprised of potentially $O(h^{d L})$ convex activation regions [65]. Each region is defined by a unique activation pattern of the hidden neurons. The input-output map is linear within each region and continuous at the boundary between regions. Collectively, the activation regions form a 2-colorable7 convex partition of input space, as shown in Fig. 5. We investigate how the relative scale influences the evolution of this partition and the linear maps within each region. ", "page_idx": 7}, {"type": "text", "text": "Two-layer network. We consider the dynamics of a two-layer piecewise linear network without biases, $\\bar{f}(x;\\theta)=a^{\\mathsf{T}}\\sigma(W x)$ , where $W\\overset{\\cdot}{\\in}\\mathbb{R}^{h\\times d}$ and $a\\in\\mathbb{R}^{h}$ . Following the approach in Section 4, we consider the contribution to the input-output map from a single hidden neuron $k\\,\\in\\,[h]$ with parameters $w_{k}\\in\\mathbb{R}^{d}$ , $a_{k}\\in\\mathbb{R}$ and conserved quantity $\\delta_{k}=\\eta_{w}a_{k}^{2}-\\eta_{a}\\|w_{k}\\|^{2}$ [62]. However, unlike the linear setting, the neuron\u2019s contribution to $f(x_{i};\\theta)$ is regulated by whether the input $x_{i}$ is in the neuron\u2019s active halfspace. Let $C\\in\\mathbb{R}^{h\\times n}$ be the matrix with elements $c_{k i}=\\sigma^{\\prime}(w_{k}^{\\mathsf{T}}x_{i})$ , which determines the activation of the $k^{\\mathrm{th}}$ neuron for the $i^{\\mathrm{th}}$ data point. The dynamics of $\\beta_{k}=a_{k}w_{k}$ are, ", "page_idx": 7}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\dot{\\beta}_{k}=-\\underbrace{\\left(\\eta_{w}a_{k}^{2}\\mathbf{I}_{d}+\\eta_{a}w_{k}w_{k}^{\\mathsf{T}}\\right)}_{M_{k}}\\underbrace{\\sum_{i=1}^{n}c_{k i}x_{i}(f(x_{i};\\theta)-y_{i})}_{\\xi_{k}}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 7}, {"type": "text", "text": "The matrix $M_{k}\\in\\mathbb{R}^{d\\times d}$ is a preconditioning matrix on the dynamics, and when $\\beta_{k}\\neq0$ , it can be expressed in terms of $\\beta_{k}$ and $\\delta_{k}$ . Unlike the linear setting, $\\dot{\\boldsymbol{\\xi}}_{k}\\,\\in\\,\\mathbb{R}^{d}$ driving the dynamics is not shared for all neurons because of its dependence on $c_{k i}$ . Additionally, the NTK matrix in this setting depends on $M_{k}$ and $C$ , with elements $\\begin{array}{r}{K_{i j}=\\sum_{k=1}^{h}c_{k i}x_{i}^{\\sf T}M_{k}x_{j}c_{k j}}\\end{array}$ . To examine the evolution of $K$ , we consider a signed spherical coordinate  transformation separating the dynamics of $\\beta_{k}$ into its directional $\\begin{array}{r}{\\hat{\\beta}_{k}=\\mathrm{sgn}(a_{k})\\frac{\\beta_{k}}{\\|\\beta_{k}\\|}}\\end{array}$ and radial $\\mu_{k}=\\mathrm{sgn}(a_{k})\\|\\beta_{k}\\|$ components, such that $\\beta_{k}=\\mu_{k}\\hat{\\beta}_{k}$ . $\\hat{\\beta}_{k}$ determines the direction and orientation of the halfspace where the $k^{\\mathrm{th}}$ neuron is active, while $\\mu_{k}$ determines the slope of the contribution in this halfspace. These coordinates evolve according to, ", "page_idx": 7}, {"type": "equation", "text": "$$\n\\dot{\\mu}_{k}=-\\sqrt{\\delta_{k}^{2}+4\\eta_{a}\\eta_{w}\\mu_{k}^{2}}\\hat{\\beta}_{k}^{\\top}\\xi_{k},\\qquad\\dot{\\hat{\\beta}}_{k}=-\\frac{\\sqrt{\\delta_{k}^{2}+4\\eta_{a}\\eta_{w}\\mu_{k}^{2}}+\\delta_{k}}{2\\mu_{k}}\\left(\\mathbf{I}_{d}-\\hat{\\beta}_{k}\\hat{\\beta}_{k}^{\\top}\\right)\\xi_{k}.\n$$", "text_format": "latex", "page_idx": 7}, {"type": "text", "text": "Downstream. When $\\delta_{k}\\ll0$ , $M_{k}\\approx|\\delta_{k}|\\hat{\\beta}_{k}\\hat{\\beta}_{k}^{\\sf T}$ , and the dynamics are approximately $\\partial_{t}\\hat{\\beta}_{k}=0$ and $\\partial_{t}\\mu_{k}\\,=\\,-|\\delta_{k}|\\hat{\\beta}_{k}^{\\sf T}\\xi_{k}$ . Irrespective of $\\xi_{k}$ , $\\hat{\\beta}_{k}(\\hat{t})\\,=\\,\\hat{\\beta}_{k}(0)$ , which implies the overall partition map doesn\u2019t change (Fig. 5, bottom), nor the activation patterns $C$ , nor $M_{k}$ . Only $\\mu_{k}$ changes to fit the data, while the NTK remains constant. If the number of hidden neurons is insufficient to fti the data, there is a delayed rich alignment phase where the kernel will change, with $|\\delta_{k}|$ determining the delay. ", "page_idx": 7}, {"type": "text", "text": "Balanced. When $\\delta_{k}=0$ , $M_{k}=\\sqrt{\\eta_{a}\\eta_{w}}|\\mu_{k}|(\\mathbf{I}_{d}+\\hat{\\beta}_{k}\\hat{\\beta}_{k}^{\\top})$ , and the dynamics simplify to, $\\partial_{t}\\hat{\\beta}_{k}=$ $-\\sqrt{\\eta_{a}\\eta_{w}}\\mathrm{sgn}(\\mu_{k})(\\mathbf{I}_{d}-\\hat{\\beta}_{k}\\hat{\\beta}_{k}^{\\intercal})\\xi_{k}$ and $\\partial_{t}\\mu_{k}\\;=\\;-2\\sqrt{\\eta_{a}\\eta_{w}}|\\mu_{k}|\\hat{\\beta}_{k}^{\\top}\\xi_{k}$ . Here both the direction and magnitude of $\\beta_{k}$ evolve, resulting in changes to the activation regions, patterns $C$ , and NTK $K$ . For vanishing initializations where $\\|\\beta_{k}(0)\\|\\rightarrow0$ for all $k\\in[h]$ , we can decouple the dynamics into two ", "page_idx": 7}, {"type": "image", "img_path": "eNM94i7R3A/tmp/29239546a87f9d9881849289bed8e81a6db5d3ca8c600a4be317714dc96a82fa.jpg", "img_caption": ["(a) Evolution of a ReLU network\u2019s input-output map (b) Hamming and parameter distance over $\\tau{-}\\delta$ sweep "], "img_footnote": [], "page_idx": 8}, {"type": "text", "text": "Figure 5: Rapid feature learning is caused by large activation changes with minimal parameter movement. (a) We show the surface of a two-layer ReLU network trained on an XOR-like task, starting with a near-zero input-output map, $f(x;\\theta_{0})\\approx0$ . The surface consists of convex conic regions, each with a distinct activation pattern, colored by the parity of active neurons. A lazy initialization (bottom) maintains a fixed activation partition throughout training, reweighting the hidden neurons to fti the data. In contrast, a rich balanced or upstream initialization $(t o p)$ features an initial alignment phase where the partition map changes rapidly while the input-output map remains close to zero, followed by a data-fitting phase. (b) We show the evolution of Hamming distance in activation patterns and parameter distance, relative to $t=0$ , as a function of overall and relative scales (same experiments as in Fig. 1(b)). Rapid feature learning occurs from a small- $\\tau$ upstream initialization that promotes faster learning in early layers, driving a large change in Hamming distance, but a small change in parameter space. In contrast, small- $\\tau$ downstream initializations require large parameter movement to fit the data in the delayed rich regime. ", "page_idx": 8}, {"type": "text", "text": "distinct phases of training (Fig. 5, top), analogous to the rich regime discussed in Section 3. Phase I: Partition alignment. At vanishing scale, the output $f(x;\\theta_{0})\\approx0$ for all input $x$ , such that the vector driving the dynamics $\\begin{array}{r}{\\xi_{k}\\approx-\\sum_{i=1}^{\\breve{n}}c_{k i}x_{i}y_{i}}\\end{array}$ in=1 ckixiyi is independent of the other hidden neurons. At the same time, the radial dynamics slow down relative to the directional dynamics, and the function\u2019s output will remain small as each neuron aligns to certain data-dependent fixed points, decoupled from the rest. Prior works have introduced structural constraints on the training data, such as orthogonally separable [50, 53, 54], pair-wise orthonormal [52], linearly separable and symmetric [51] or small angle [55], to analytically determine the fixed points of this alignment phase. Phase II: Data fitting. After enough time, the magnitudes of $\\beta_{k}$ have grown such that we can no longer assume $f(x;\\theta)\\approx0$ and thus the residual will depend on all $\\beta_{k}$ . In this phase, the radial dynamics dominate the learning driving the network to fit the data. However, it is possible for the directions to continue to change, and therefore some prior works have further decomposed this phase into multiple stages. ", "page_idx": 8}, {"type": "text", "text": "Upstream. When $\\delta_{k}\\gg0$ , $M_{k}\\approx\\delta_{k}\\mathbf{I}_{d}$ , and the dynamics are approximately $\\partial_{t}\\hat{\\beta}_{k}=-\\delta_{k}\\mu_{k}^{-1}({\\bf I}_{d}-$ $\\hat{\\beta}_{k}\\hat{\\beta}_{k}^{\\sf T})\\xi_{k}$ and $\\partial_{t}\\mu_{k}=-\\delta_{k}\\hat{\\beta}_{k}^{\\sf T}\\xi_{k}$ . Again, both the direction and magnitude of $\\beta_{k}$ change. However, unlike the balanced setting, in this setting $M_{k}$ is independent of $\\beta_{k}$ and stays constant through training. Yet, as $\\beta_{k}$ change in direction, so can $C$ , and thus the NTK. This setting is unique, because it is rich due to a changing activation pattern, but the dynamics do not move far in parameter space. Furthermore, unlike in the balanced scenario where scale adjusts the speed of radial dynamics, here it regulates the speed of directional dynamics, with vanishing initializations prompting an extremely fast alignment phase, as observed in Fig. 1 and in Fig. 5. ", "page_idx": 8}, {"type": "text", "text": "Connections to infinite-width. Our study of learning regimes in finite-width two-layer ReLU networks as a function of the overall and relative scale is consistent with existing infinite-width analysis of feature learning. For example, in Luo et al. [17] they consider a network $f(x)\\;=$ $\\begin{array}{r}{\\frac{1}{\\alpha}\\sum_{k=1}^{h}a_{k}\\sigma\\big(w_{k}^{\\sf T}x\\big)}\\end{array}$ with weights initialized as $a_{k}\\,\\sim\\mathcal{N}(0,\\beta_{a}^{2})$ and $w_{k}\\,\\sim\\mathcal{N}(0,\\beta_{W}^{2}\\mathbf{I}_{d})$ as width $h\\to\\infty$ . They obtain a phase diagram at infinite width capturing the dependence of learning regime on the overall function scale $\\beta_{a}\\beta_{W}/\\alpha$ and the relative initialization scale $\\beta_{a}/\\beta_{W}$ , each suitably normalized as a function of width. The resulting phase portrait is analogous to ours in Fig. 1 (b), where we use the conserved quantity $\\delta$ rather than the relative scale $\\beta_{a}/\\beta_{W}$ . Specifically, there is a lazy regime that includes the NTK parameterization, which is always achieved at large scale (as in the large- $\\tau$ regions of Fig. 1 (b)), but is also achieved at small scale if the first layer variance is sufficiently larger than the second (as in the downstream initializations at small $\\tau$ in Fig. 1 (b)). On the other side of the phase boundary is the infinite-width analog of rapid rich learning, where all neurons condense to a few directions. This is induced either at small function scale, or at larger scales if $\\beta_{a}/\\beta_{W}$ is sufficiently large, such that $W$ learns fast enough relative to $a$ . The phase boundary, in turn, which exists only at infinite width, contains a range of parametrizations, including the mean-field parametrization. More broadly, across width-dependent parametrizations, the random initialization of weights induces a distribution over per-neuron conserved quantities. While the distinction between the NTK and the mean-field parametrizations has been extensively studied, both lead to the same distribution of per-neuron conserved quantities, which is zero in expectation with a non-vanishing variance. A more thorough study of what role the distribution of per-neuron conserved quantities plays in feature learning at finite-widths is left to future work. ", "page_idx": 8}, {"type": "image", "img_path": "eNM94i7R3A/tmp/28dabc0cd62874af529c0ffa84997977361c4e3ec831a8187c9d0bbcb61b45c6.jpg", "img_caption": ["Figure 6: Impact of upstream initializations in practice. Here we provide evidence that an upstream initialization (a) drives feature learning through changing activation patterns, (b) promotes interpretability of early layers in CNNs, (c) reduces the sample complexity of learning hierarchical data, and (d) decreases the time to grokking in modular arithmetic. In these experiments, we regulate the first layer\u2019s learning speed relative to the rest of the network by dividing its initialization by $\\alpha$ . For models without normalization layers, we also scale the last layer\u2019s initialization by $\\alpha$ to preserve the input-output map. $\\alpha=1$ represents standard parameterization, while $\\alpha\\gg1$ and $\\alpha\\ll1$ correspond to upstream and downstream initializations, respectively. See Appendix D.3 for details. "], "img_footnote": [], "page_idx": 9}, {"type": "text", "text": "", "page_idx": 9}, {"type": "text", "text": "Unbalanced initializations in practice. Our analysis shows that upstream initializations can drive rapid rich learning in nonlinear networks. Further experiments in Fig. 6 show that upstream initializations are relevant across various domains of deep learning: (a) Standard initializations see significant NTK evolution early in training [27]. We show the movement is linked to changes in activation patterns rather than large parameter shifts. Adjusting the initialization variance of the first and last layers can amplify or diminish this movement. (b) Filters in CNNs trained on image classification tasks often align with edge detectors [66]. We show that adjusting the learning speed of the first layer can enhance or degrade this alignment. (c) Deep learning models are believed to avoid the curse of dimensionality and learn with limited data by exploiting hierarchical structures in real-world tasks. Using the Random Hierarchy Model, introduced by Petrini et al. [67] as a framework for synthetic hierarchical tasks, we show that modifying the relative scale can decrease or increase the sample complexity of learning. (d) Networks trained on simple modular arithmetic tasks will suddenly generalize long after memorizing their training data [68]. This behavior, termed grokking, is thought to result from a transition from lazy to rich learning [69, 70, 71] and believed to be important towards understanding emergent phenomena [72]. We show that decreasing the variance of the embedding in a single-layer transformer $\\zeta<6\\%$ of all parameters) significantly reduces the time to grokking. ", "page_idx": 9}, {"type": "text", "text": "6 Conclusion ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "In this work, we derived exact solutions to a minimal model that can transition between lazy and rich learning to precisely elucidate how unbalanced layer-specific initialization variances and learning rates determine the degree of feature learning. We further extended our analysis to wide and deep linear networks and shallow piecewise linear networks. We find through theory and empirics that unbalanced initializations, which promote faster learning at earlier layers, can actually accelerate rich learning. Limitations. The primary limitation lies in the difficulty to extend our theory to deeper nonlinear networks. In contrast to linear networks, where additional symmetries simplify dynamics, nonlinear networks require consideration of the activation pattern\u2019s impact on subsequent layers. One potential solution involves leveraging the path framework used in Saxe et al. [73]. Another limitation is our omission of discretization and stochastic effects of SGD, which disrupt the conservation laws central to our study and introduce additional simplicity biases [74, 75, 76, 77]. Future work. Our theory encourages further investigation into unbalanced initializations to optimize efficient feature learning. Understanding how the learning speed proflie across layers impacts feature learning, inductive biases, and generalization is an important direction for future work. ", "page_idx": 9}, {"type": "text", "text": "", "page_idx": 9}, {"type": "text", "text": "Acknowledgments and Disclosure of Funding ", "text_level": 1, "page_idx": 10}, {"type": "text", "text": "We thank Francisco Acosta, Alex Atanasov, Yasaman Bahri, Abby Bertics, Blake Bordelon, Nan Cheng, Alex Infanger, Mason Kamb, Guillaume Lajoie, Nina Miolane, Cengiz Pehlevan, Ben Sorscher, Javan Tahir, Atsushi Yamamura for helpful discussions. D.K. thanks the Open Philanthropy AI Fellowship for support. S.G. thanks the James S. McDonnell and Simons Foundations, NTT Research, and an NSF CAREER Award for support. This research was supported in part by grant NSF PHY-1748958 to the Kavli Institute for Theoretical Physics (KITP). ", "page_idx": 10}, {"type": "text", "text": "Author Contributions ", "text_level": 1, "page_idx": 10}, {"type": "text", "text": "This project originated from conversations between Daniel and Allan at the Kavli Institute for Theoretical Physics. Daniel, Allan, and Feng are primarily responsible for the single neuron analysis in Section 3. Daniel, Clem, Allan, and Feng are primarily responsible for the wide and deep linear analysis in Section 4. Daniel is primarily responsible for the nonlinear analysis in Section 5. Allan, Feng, and David are primarily responsible for the empirics in Fig. 1 and Fig. 6. Daniel is primarily responsible for writing the main sections. All authors contributed to the writing of the appendix and the polishing of the manuscript. ", "page_idx": 10}, {"type": "text", "text": "References ", "text_level": 1, "page_idx": 10}, {"type": "text", "text": "[1] Simon S Du, Xiyu Zhai, Barnabas Poczos, and Aarti Singh. Gradient descent provably optimizes over-parameterized neural networks. arXiv preprint arXiv:1810.02054, 2018.   \n[2] Simon Du, Jason Lee, Haochuan Li, Liwei Wang, and Xiyu Zhai. Gradient descent finds global minima of deep neural networks. In International conference on machine learning, pages 1675\u20131685. PMLR, 2019.   \n[3] Zeyuan Allen-Zhu, Yuanzhi Li, and Yingyu Liang. Learning and generalization in overparameterized neural networks, going beyond two layers. Advances in neural information processing systems, 32, 2019.   \n[4] Zeyuan Allen-Zhu, Yuanzhi Li, and Zhao Song. A convergence theory for deep learning via over-parameterization. In International conference on machine learning, pages 242\u2013252. PMLR, 2019.   \n[5] Difan Zou, Yuan Cao, Dongruo Zhou, and Quanquan Gu. Gradient descent optimizes overparameterized deep relu networks. Machine learning, 109:467\u2013492, 2020.   \n[6] Arthur Jacot, Franck Gabriel, and Cl\u00e9ment Hongler. Neural tangent kernel: Convergence and generalization in neural networks. Advances in neural information processing systems, 31, 2018.   \n[7] Greg Yang. Tensor programs ii: Neural tangent kernel for any architecture. arXiv preprint arXiv:2006.14548, 2020.   \n[8] Lenaic Chizat, Edouard Oyallon, and Francis Bach. On lazy training in differentiable programming. Advances in neural information processing systems, 32, 2019.   \n[9] Shahar Azulay, Edward Moroshko, Mor Shpigel Nacson, Blake E Woodworth, Nathan Srebro, Amir Globerson, and Daniel Soudry. On the implicit bias of initialization shape: Beyond infinitesimal mirror descent. In International Conference on Machine Learning, pages 468\u2013477. PMLR, 2021.   \n[10] Andrew M Saxe, James L McClelland, and Surya Ganguli. Exact solutions to the nonlinear dynamics of learning in deep linear neural networks. arXiv preprint arXiv:1312.6120, 2013.   \n[11] Andrew M Saxe, James L McClelland, and Surya Ganguli. A mathematical theory of semantic development in deep neural networks. Proceedings of the National Academy of Sciences, 116 (23):11537\u201311546, 2019.   \n[12] Arthur Jacot, Fran\u00e7ois Ged, Berfin \u00b8Sims\u00b8ek, Cl\u00e9ment Hongler, and Franck Gabriel. Saddle-tosaddle dynamics in deep linear networks: Small initialization training, symmetry, and sparsity. arXiv preprint arXiv:2106.15933, 2021.   \n[13] Zhiyuan Li, Yuping Luo, and Kaifeng Lyu. Towards resolving the implicit bias of gradient descent for matrix factorization: Greedy low-rank learning. arXiv preprint arXiv:2012.09839, 2020.   \n[14] Blake Woodworth, Suriya Gunasekar, Jason D Lee, Edward Moroshko, Pedro Savarese, Itay Golan, Daniel Soudry, and Nathan Srebro. Kernel and rich regimes in overparametrized models. In Conference on Learning Theory, pages 3635\u20133673. PMLR, 2020.   \n[15] Yuhan Helena Liu, Aristide Baratin, Jonathan Cornford, Stefan Mihalas, Eric Shea-Brown, and Guillaume Lajoie. How connectivity structure shapes rich and lazy learning in neural circuits. ArXiv, 2023.   \n[16] Greg Yang and Edward J Hu. Feature learning in infinite-width neural networks. arXiv preprint arXiv:2011.14522, 2020.   \n[17] Tao Luo, Zhi-Qin John Xu, Zheng Ma, and Yaoyu Zhang. Phase diagram for two-layer relu neural networks at infinite-width limit. Journal of Machine Learning Research, 22(71):1\u201347, 2021.   \n[18] Greg Yang, Edward J Hu, Igor Babuschkin, Szymon Sidor, Xiaodong Liu, David Farhi, Nick Ryder, Jakub Pachocki, Weizhu Chen, and Jianfeng Gao. Tensor programs v: Tuning large neural networks via zero-shot hyperparameter transfer. arXiv preprint arXiv:2203.03466, 2022.   \n[19] Aitor Lewkowycz, Yasaman Bahri, Ethan Dyer, Jascha Sohl-Dickstein, and Guy Gur-Ari. The large learning rate phase of deep learning: the catapult mechanism. arXiv preprint arXiv:2003.02218, 2020.   \n[20] Jimmy Ba, Murat A Erdogdu, Taiji Suzuki, Zhichao Wang, Denny Wu, and Greg Yang. Highdimensional asymptotics of feature learning: How one gradient step improves the representation. Advances in Neural Information Processing Systems, 35:37932\u201337946, 2022.   \n[21] Libin Zhu, Chaoyue Liu, Adityanarayanan Radhakrishnan, and Mikhail Belkin. Catapults in sgd: spikes in the training loss and their impact on generalization through feature learning. arXiv preprint arXiv:2306.04815, 2023.   \n[22] Hugo Cui, Luca Pesce, Yatin Dandi, Florent Krzakala, Yue M Lu, Lenka Zdeborov\u00e1, and Bruno Loureiro. Asymptotics of feature learning in two-layer networks after one gradient-step. arXiv preprint arXiv:2402.04980, 2024.   \n[23] Yizhou Xu and Liu Ziyin. When does feature learning happen? perspective from an analytically solvable model. arXiv preprint arXiv:2401.07085, 2024.   \n[24] Corinna Cortes, Mehryar Mohri, and Afshin Rostamizadeh. Algorithms for learning kernels based on centered alignment. The Journal of Machine Learning Research, 13(1):795\u2013828, 2012.   \n[25] Mario Geiger, Stefano Spigler, Arthur Jacot, and Matthieu Wyart. Disentangling feature and lazy training in deep neural networks. Journal of Statistical Mechanics: Theory and Experiment, 2020(11):113301, 2020.   \n[26] Aristide Baratin, Thomas George, C\u00e9sar Laurent, R Devon Hjelm, Guillaume Lajoie, Pascal Vincent, and Simon Lacoste-Julien. Implicit regularization via neural feature alignment. In International Conference on Artificial Intelligence and Statistics, pages 2269\u20132277. PMLR, 2021.   \n[27] Stanislav Fort, Gintare Karolina Dziugaite, Mansheej Paul, Sepideh Kharaghani, Daniel M Roy, and Surya Ganguli. Deep learning versus kernel learning: an empirical study of loss landscape geometry and the time evolution of the neural tangent kernel. Advances in Neural Information Processing Systems, 33:5850\u20135861, 2020.   \n[28] Andrew K Lampinen and Surya Ganguli. An analytic theory of generalization dynamics and transfer learning in deep linear networks. arXiv preprint arXiv:1809.10374, 2018.   \n[29] Kenji Fukumizu. Effect of batch learning in multilayer neural networks. Gen, 1(04):1E\u201303, 1998.   \n[30] Lukas Braun, Cl\u00e9mentine Carla Juliette Domin\u00e9, James E Fitzgerald, and Andrew M Saxe. Exact learning dynamics of deep linear networks with prior knowledge. In Advances in Neural Information Processing Systems, 2022.   \n[31] Sanjeev Arora, Nadav Cohen, and Elad Hazan. On the optimization of deep networks: Implicit acceleration by overparameterization. In International conference on machine learning, pages 244\u2013253. PMLR, 2018.   \n[32] Sanjeev Arora, Nadav Cohen, Wei Hu, and Yuping Luo. Implicit regularization in deep matrix factorization. Advances in Neural Information Processing Systems, 32, 2019.   \n[33] Liu Ziyin, Botao Li, and Xiangming Meng. Exact solutions of a deep linear network. Advances in Neural Information Processing Systems, 35:24446\u201324458, 2022.   \n[34] Gauthier Gidel, Francis Bach, and Simon Lacoste-Julien. Implicit regularization of discrete gradient dynamics in linear neural networks. Advances in Neural Information Processing Systems, 32, 2019.   \n[35] Salma Tarmoun, Guilherme Franca, Benjamin D Haeffele, and Rene Vidal. Understanding the dynamics of gradient flow in overparameterized linear models. In International Conference on Machine Learning, pages 10153\u201310161. PMLR, 2021.   \n[36] Daniel Gissin, Shai Shalev-Shwartz, and Amit Daniely. The implicit bias of depth: How incremental learning drives generalization. arXiv preprint arXiv:1909.12051, 2019.   \n[37] Alexander Atanasov, Blake Bordelon, and Cengiz Pehlevan. Neural networks as kernel learners: The silent alignment effect. In International Conference on Learning Representations, 2021.   \n[38] Daniel Soudry, Elad Hoffer, Mor Shpigel Nacson, Suriya Gunasekar, and Nathan Srebro. The implicit bias of gradient descent on separable data. The Journal of Machine Learning Research, 19(1):2822\u20132878, 2018.   \n[39] Ziwei Ji and Matus Telgarsky. Gradient descent aligns the layers of deep linear networks. arXiv preprint arXiv:1810.02032, 2018.   \n[40] Suriya Gunasekar, Jason D Lee, Daniel Soudry, and Nati Srebro. Implicit bias of gradient descent on linear convolutional networks. Advances in neural information processing systems, 31, 2018.   \n[41] Edward Moroshko, Blake E Woodworth, Suriya Gunasekar, Jason D Lee, Nati Srebro, and Daniel Soudry. Implicit bias in deep linear classification: Initialization scale vs training accuracy. Advances in neural information processing systems, 33:22182\u201322193, 2020.   \n[42] Kaifeng Lyu and Jian Li. Gradient descent maximizes the margin of homogeneous neural networks. arXiv preprint arXiv:1906.05890, 2019.   \n[43] Mor Shpigel Nacson, Suriya Gunasekar, Jason Lee, Nathan Srebro, and Daniel Soudry. Lexicographic and depth-sensitive margins in homogeneous and non-homogeneous deep models. In International Conference on Machine Learning, pages 4683\u20134692. PMLR, 2019.   \n[44] Lenaic Chizat and Francis Bach. Implicit bias of gradient descent for wide two-layer neural networks trained with the logistic loss. In Conference on learning theory, pages 1305\u20131338. PMLR, 2020.   \n[45] Daniel Kunin, Atsushi Yamamura, Chao Ma, and Surya Ganguli. The asymmetric maximum margin bias of quasi-homogeneous neural networks. arXiv preprint arXiv:2210.03820, 2022.   \n[46] Suriya Gunasekar, Jason Lee, Daniel Soudry, and Nathan Srebro. Characterizing implicit bias in terms of optimization geometry. In International Conference on Machine Learning, pages 1832\u20131841. PMLR, 2018.   \n[47] Suriya Gunasekar, Blake Woodworth, and Nathan Srebro. Mirrorless mirror descent: A natural derivation of mirror descent. In International Conference on Artificial Intelligence and Statistics, pages 2305\u20132313. PMLR, 2021.   \n[48] Zhiyuan Li, Tianhao Wang, Jason D Lee, and Sanjeev Arora. Implicit bias of gradient descent on reparametrized models: On equivalence to mirror descent. Advances in Neural Information Processing Systems, 35:34626\u201334640, 2022.   \n[49] Hartmut Maennel, Olivier Bousquet, and Sylvain Gelly. Gradient descent quantizes relu network features. arXiv preprint arXiv:1803.08367, 2018.   \n[50] Mary Phuong and Christoph H Lampert. The inductive bias of relu networks on orthogonally separable data. In International Conference on Learning Representations, 2020.   \n[51] Kaifeng Lyu, Zhiyuan Li, Runzhe Wang, and Sanjeev Arora. Gradient descent on two-layer nets: Margin maximization and simplicity bias. Advances in Neural Information Processing Systems, 34, 2021.   \n[52] Etienne Boursier, Loucas Pillaud-Vivien, and Nicolas Flammarion. Gradient flow dynamics of shallow relu networks for square loss and orthogonal inputs. Advances in Neural Information Processing Systems, 35:20105\u201320118, 2022.   \n[53] Mingze Wang and Chao Ma. Early stage convergence and global convergence of training mildly parameterized neural networks. Advances in Neural Information Processing Systems, 35: 743\u2013756, 2022.   \n[54] Hancheng Min, Ren\u00e9 Vidal, and Enrique Mallada. Early neuron alignment in two-layer relu networks with small initialization. arXiv preprint arXiv:2307.12851, 2023.   \n[55] Mingze Wang and Chao Ma. Understanding multi-phase optimization dynamics and rich nonlinear behaviors of relu networks. Advances in Neural Information Processing Systems, 36, 2024.   \n[56] Song Mei, Andrea Montanari, and Phan-Minh Nguyen. A mean field view of the landscape of two-layer neural networks. Proceedings of the National Academy of Sciences, 115(33): E7665\u2013E7671, 2018.   \n[57] Lenaic Chizat and Francis Bach. On the global convergence of gradient descent for overparameterized models using optimal transport. Advances in neural information processing systems, 31, 2018.   \n[58] Justin Sirignano and Konstantinos Spiliopoulos. Mean field analysis of neural networks: A law of large numbers. SIAM Journal on Applied Mathematics, 80(2):725\u2013752, 2020.   \n[59] Grant Rotskoff and Eric Vanden-Eijnden. Trainability and accuracy of artificial neural networks: An interacting particle system approach. Communications on Pure and Applied Mathematics, 75(9):1889\u20131935, 2022.   \n[60] Blake Bordelon and Cengiz Pehlevan. Self-consistent dynamical field theory of kernel evolution in wide neural networks. Advances in Neural Information Processing Systems, 35:32240\u201332256, 2022.   \n[61] Greg Yang, James B Simon, and Jeremy Bernstein. A spectral condition for feature learning. arXiv preprint arXiv:2310.17813, 2023.   \n[62] Simon S Du, Wei Hu, and Jason D Lee. Algorithmic regularization in learning deep homogeneous models: Layers are automatically balanced. Advances in Neural Information Processing Systems, 31, 2018.   \n[63] Zhenfeng Tu, Santiago Aranguri, and Arthur Jacot. Mixed dynamics in linear networks: Unifying the lazy and active regimes. arXiv preprint arXiv:2405.17580, 2024.   \n[64] Aditya Vardhan Varre, Maria-Luiza Vladarean, Loucas Pillaud-Vivien, and Nicolas Flammarion. On the spectral bias of two-layer linear networks. Advances in Neural Information Processing Systems, 36, 2024.   \n[65] Maithra Raghu, Ben Poole, Jon Kleinberg, Surya Ganguli, and Jascha Sohl-Dickstein. On the expressive power of deep neural networks. In international conference on machine learning, pages 2847\u20132854. PMLR, 2017.   \n[66] Alex Krizhevsky, Ilya Sutskever, and Geoffrey E Hinton. Imagenet classification with deep convolutional neural networks. Communications of the ACM, 60(6):84\u201390, 2017.   \n[67] Leonardo Petrini, Francesco Cagnetta, Umberto M Tomasini, Alessandro Favero, and Matthieu Wyart. How deep neural networks learn compositional data: The random hierarchy model. arXiv preprint arXiv:2307.02129, 2023.   \n[68] Alethea Power, Yuri Burda, Harri Edwards, Igor Babuschkin, and Vedant Misra. Grokking: Generalization beyond overftiting on small algorithmic datasets. arXiv preprint arXiv:2201.02177, 2022.   \n[69] Tanishq Kumar, Blake Bordelon, Samuel J Gershman, and Cengiz Pehlevan. Grokking as the transition from lazy to rich training dynamics. arXiv preprint arXiv:2310.06110, 2023.   \n[70] Kaifeng Lyu, Jikai Jin, Zhiyuan Li, Simon Shaolei Du, Jason D Lee, and Wei Hu. Dichotomy of early and late phase implicit biases can provably induce grokking. In The Twelfth International Conference on Learning Representations, 2023.   \n[71] Noa Rubin, Inbar Seroussi, and Zohar Ringel. Grokking as a first order phase transition in two layer networks. In The Twelfth International Conference on Learning Representations, 2024. URL https://openreview.net/forum?id $\\cdot$ 3ROGsTX3IR.   \n[72] Neel Nanda, Lawrence Chan, Tom Lieberum, Jess Smith, and Jacob Steinhardt. Progress measures for grokking via mechanistic interpretability. arXiv preprint arXiv:2301.05217, 2023.   \n[73] Andrew Saxe, Shagun Sodhani, and Sam Jay Lewallen. The neural race reduction: Dynamics of abstraction in gated networks. In International Conference on Machine Learning, pages 19287\u201319309. PMLR, 2022.   \n[74] Daniel Kunin, Javier Sagastuy-Brena, Surya Ganguli, Daniel LK Yamins, and Hidenori Tanaka. Neural mechanics: Symmetry and broken conservation laws in deep learning dynamics. arXiv preprint arXiv:2012.04728, 2020.   \n[75] Hidenori Tanaka and Daniel Kunin. Noether\u2019s learning dynamics: Role of symmetry breaking in neural networks. Advances in Neural Information Processing Systems, 34:25646\u201325660, 2021.   \n[76] Feng Chen, Daniel Kunin, Atsushi Yamamura, and Surya Ganguli. Stochastic collapse: How gradient noise attracts sgd dynamics towards simpler subnetworks. Advances in Neural Information Processing Systems, 36, 2024.   \n[77] Liu Ziyin, Mingze Wang, and Lei Wu. The implicit bias of gradient noise: A symmetry perspective. arXiv preprint arXiv:2402.07193, 2024.   \n[78] David Saad and Sara A Solla. Exact solution for on-line learning in multilayer neural networks. Physical Review Letters, 74(21):4337, 1995.   \n[79] Sebastian Goldt, Madhu S Advani, Andrew M Saxe, Florent Krzakala, and Lenka Zdeborov\u00e1. Generalisation dynamics of online learning in over-parameterised neural networks. arXiv preprint arXiv:1901.09085, 2019.   \n[80] Gal Vardi and Ohad Shamir. Implicit regularization in relu networks with the square loss. In Conference on Learning Theory, pages 4224\u20134258. PMLR, 2021.   \n[81] Razvan Pascanu, Guido Montufar, and Yoshua Bengio. On the number of response regions of deep feed forward networks with piece-wise linear activations. arXiv preprint arXiv:1312.6098, 2013.   \n[82] Guido F Montufar, Razvan Pascanu, Kyunghyun Cho, and Yoshua Bengio. On the number of linear regions of deep neural networks. Advances in neural information processing systems, 27, 2014.   \n[83] Matus Telgarsky. Representation benefits of deep feedforward networks. arXiv preprint arXiv:1509.08101, 2015.   \n[84] Raman Arora, Amitabh Basu, Poorya Mianjy, and Anirbit Mukherjee. Understanding deep neural networks with rectified linear units. arXiv preprint arXiv:1611.01491, 2016.   \n[85] Thiago Serra, Christian Tjandraatmadja, and Srikumar Ramalingam. Bounding and counting linear regions of deep neural networks. In International Conference on Machine Learning, pages 4558\u20134566. PMLR, 2018.   \n[86] Boris Hanin and David Rolnick. Complexity of linear regions in deep networks. In International Conference on Machine Learning, pages 2596\u20132604. PMLR, 2019.   \n[87] Boris Hanin and David Rolnick. Deep relu networks have surprisingly few activation patterns. Advances in neural information processing systems, 32, 2019.   \n[88] Yann LeCun, L\u00e9on Bottou, Yoshua Bengio, and Patrick Haffner. Gradient-based learning applied to document recognition. Proceedings of the IEEE, 86(11):2278\u20132324, 1998.   \n[89] Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun. Delving deep into rectifiers: Surpassing human-level performance on imagenet classification. In Proceedings of the IEEE international conference on computer vision, pages 1026\u20131034, 2015. ", "page_idx": 10}, {"type": "text", "text": "", "page_idx": 11}, {"type": "text", "text": "", "page_idx": 12}, {"type": "text", "text": "", "page_idx": 13}, {"type": "text", "text": "", "page_idx": 14}, {"type": "text", "text": "", "page_idx": 15}, {"type": "text", "text": "A Single-Neuron Linear Network ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "In this section, we provide a detailed analysis of the two-layer linear network with a single hidden neuron discussed in Section 3. The network is defined by the function $f(x;\\theta)=a w^{\\top}x$ , where $a\\in\\mathbb R$ and $w\\in\\mathbb{R}^{d}$ are the parameters. We aim to understand the impact of the initializations $a_{0},w_{0}$ and the layer-wise learning rates $\\eta_{a},\\eta_{w}$ on the training trajectory in parameter space, function space (defined by the product $\\beta=a w,$ ), and the evolution of the Neural Tangent Kernel (NTK) matrix $K$ : ", "page_idx": 16}, {"type": "equation", "text": "$$\nK=X\\left(\\eta_{w}a^{2}\\mathbf{I}_{d}+\\eta_{a}w w^{\\mathsf{T}}\\right)X^{\\mathsf{T}}.\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "The gradient flow dynamics are governed by the following coupled ODEs: ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\begin{array}{r l r l}&{\\dot{a}=-\\eta_{a}w^{\\top}\\left(X^{\\top}X a w-X^{\\top}y\\right),\\qquad\\qquad\\qquad}&&{a(0)=a_{0},}\\\\ &{\\dot{w}=-\\eta_{w}a\\left(X^{\\top}X a w-X^{\\top}y\\right),\\qquad\\qquad\\qquad}&&{w(0)=w_{0}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "The global minima of this problem are determined by the normal equations $X^{\\intercal}X a w=X^{\\intercal}y$ . Even when $X^{\\intercal}X$ is invertible, yielding a unique global minimum in function space $\\beta_{*}=(X^{\\intercal}X)^{-1}X^{\\intercal}y$ , the symmetry between $a$ and $w$ , permitting scaling transformations, $a\\rightarrow a\\alpha$ and $w\\to w/\\alpha$ for any $\\alpha\\neq0$ without changing the product $a w$ , results in a manifold of minima in parameter space. This minima manifold is a one-dimensional hyperbola where $a w=\\beta_{*}$ , with two distinct branches for positive and negative $a$ . The set of saddle points $\\{(a,w)\\}$ forms a $(d-1)$ -dimensional subspace satisfying $a=0$ and $w^{\\boldsymbol{\\top}}X^{\\boldsymbol{\\top}}y=0$ . Except for a measure zero set of initializations that converge to the saddle points, all gradient flow trajectories will converge to a global minimum. In Appendix A.2.5, we detail the basin of attraction for each branch of the minima manifold and the $d$ -dimensional surface of initializations that converge to saddle points, separating the two basins. ", "page_idx": 16}, {"type": "text", "text": "A.1 Conserved quantity ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "The scaling symmetry between $a$ and $w$ results in a conserved quantity $\\delta\\in\\mathbb{R}$ throughout training, as noted in many prior works [10, 62, 74], where ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\delta=\\eta_{w}a^{2}-\\eta_{a}\\|w\\|^{2}.\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "This can be easily verified by explicitly writing out the dynamics of $\\delta$ . Define $\\rho=(X\\mathsf{T}X a w-X\\mathsf{T}y)$ for succinct notation, such that ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\dot{\\delta}=2\\eta_{w}a\\dot{a}-2\\eta_{a}w^{\\mathsf{T}}\\dot{w}}\\\\ &{\\quad=2\\eta_{w}a\\left(-\\eta_{a}w^{\\mathsf{T}}\\rho\\right)-2\\eta_{a}w^{\\mathsf{T}}\\left(-\\eta_{w}a\\rho\\right)}\\\\ &{\\quad=0.}\\end{array}\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "The conserved quantity confines the parameter dynamics to the surface of a hyperboloid where the magnitude and sign of the conserved quantity determines the geometry, as shown in Fig. 2. A hyperboloid of the form $\\begin{array}{r}{\\sum_{i=1}^{k}x_{i}^{2}-\\sum_{i=k+1}^{n}x_{i}^{2}=\\alpha,}\\end{array}$ , with $\\alpha\\geq0$ , exhibits varied topology and geometry based on and $\\alpha$ . It has two sheets when $k=1$ and one sheet otherwise. Its geometry is primarily dictated by $\\alpha$ : as $\\alpha$ tends to infinity, curvature decreases, while at $\\alpha=0$ , a singularity occurs at the origin. ", "page_idx": 16}, {"type": "text", "text": "A.2 Exact solutions ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "To derive exact dynamics we assume the input data is whitened such that $X^{\\top}X=\\mathbf{I}_{d}$ and $\\beta_{*}=X^{\\intercal}y$ such that $\\beta_{*}\\neq0$ . The dynamics of $a$ and $w$ can then be simplified as ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\begin{array}{l l}{{\\dot{a}=\\eta_{a}\\left(w^{\\mathsf{T}}\\beta_{*}-a\\|w\\|^{2}\\right),\\qquad\\qquad\\qquad}}&{{a(0)=a_{0}}}\\\\ {{\\dot{w}=\\eta_{w}\\left(a\\beta_{*}-a^{2}w\\right),\\qquad\\qquad\\qquad}}&{{w(0)=w_{0}.}}\\end{array}\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "A.2.1 Deriving the dynamics for $\\mu$ and $\\phi$ ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "As discussion in Section 3 we study the variables $\\mu=a\\|w\\|$ , an invariant under the rescale symmetry, and \u2225ww\u2225\u22ba\u2225\u03b2\u03b2\u2217\u2217\u2225, the cosine of the angle between w and \u03b2\u2217. This change of variables can also be understood as a signed spherical decomposition of $\\beta$ : $\\mu$ is the signed magnitude of $\\beta$ and $\\phi$ is the ", "page_idx": 16}, {"type": "text", "text": "cosine angle between $\\beta$ and $\\beta_{*}$ . Through chain rule, we obtain the dynamics for $\\mu$ and $\\phi$ , which can be expressed as ", "page_idx": 17}, {"type": "equation", "text": "$$\n\\begin{array}{l l}{{\\dot{\\mu}=\\sqrt{\\delta^{2}+4\\eta_{a}\\eta_{w}\\mu^{2}}\\left(\\phi\\|\\beta_{*}\\|-\\mu\\right),}}&{{\\qquad\\qquad\\mu(0)=a_{0}\\|w_{0}\\|,}}\\\\ {{\\dot{\\phi}=\\displaystyle\\frac{\\eta_{a}\\eta_{w}2\\mu\\|\\beta_{*}\\|}{\\sqrt{\\delta^{2}+4\\eta_{a}\\eta_{w}\\mu^{2}}-\\delta}\\left(1-\\phi^{2}\\right),}}&{{\\qquad\\qquad\\phi(0)=\\displaystyle\\frac{w_{0}^{\\mathsf{T}}\\beta_{*}}{\\|w_{0}\\|\\|\\beta_{*}\\|}.}}\\end{array}\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "We leave the derivation to the reader, but emphasize that a key simplification used is to express the sum $\\eta_{w}a^{2}+\\eta_{a}\\lVert w\\rVert^{2}$ in terms of $\\delta$ , ", "page_idx": 17}, {"type": "equation", "text": "$$\n\\eta_{w}a^{2}+\\eta_{a}\\|w\\|^{2}=\\sqrt{\\delta^{2}+4\\eta_{a}\\eta_{w}\\mu^{2}}.\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "Additionally, notice that $\\eta_{a}$ and $\\eta_{w}$ only appear in\u221a the dynamics for $\\mu$ and $\\phi$ as the product $\\eta_{a}\\eta_{w}$ or in the expression for $\\delta$ . If we were to define $\\mu^{\\prime}=\\sqrt{\\eta_{a}\\eta_{w}}\\mu$ and $\\beta_{*}^{\\prime}=\\sqrt{\\eta_{a}\\eta_{w}}\\beta_{*}$ , then it is not hard to show that the product $\\eta_{a}\\eta_{w}$ is absorbed into the dynamics. Thus, without loss of generality we can assume the product $\\eta_{a}\\eta_{w}=1$ , resulting in the following coupled system of nonlinear ODEs, ", "page_idx": 17}, {"type": "equation", "text": "$$\n\\begin{array}{l l}{{\\dot{\\mu}=\\sqrt{\\delta^{2}+4\\mu^{2}}\\left(\\phi\\|\\beta_{*}\\|-\\mu\\right),}}&{{\\qquad\\qquad\\qquad\\mu(0)=a_{0}\\|w_{0}\\|}}\\\\ {{\\dot{\\phi}=\\displaystyle\\frac{2\\mu\\|\\beta_{*}\\|}{\\sqrt{\\delta^{2}+4\\mu^{2}}-\\delta}\\left(1-\\phi^{2}\\right),}}&{{\\qquad\\qquad\\phi(0)=\\displaystyle\\frac{w_{0}^{\\top}\\beta_{*}}{\\|w_{0}\\|\\|\\beta_{*}\\|}}}\\end{array}\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "We will now show how to solve this system of equations for $\\mu$ and $\\phi$ . We will solve this system when $\\delta=0,\\,\\delta>0$ , and $\\delta<0$ separately. We will then in Appendix A.2.6 show a general treatment on how to obtain the individual coordinates of $a$ and $w$ from the solutions for $\\mu$ and $\\phi$ . ", "page_idx": 17}, {"type": "text", "text": "A.2.2 Balanced $\\delta=0$ ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "When $\\delta=0$ , the dynamics for $\\mu,\\phi$ are, ", "page_idx": 17}, {"type": "equation", "text": "$$\n\\begin{array}{r l r l}&{\\dot{\\mu}=\\mathrm{sgn}(\\mu)2\\mu(\\phi\\|\\beta_{*}\\|-\\mu),\\qquad\\qquad}&&{\\mu(0)=a_{0}\\|w_{0}\\|,}\\\\ &{\\dot{\\phi}=\\mathrm{sgn}(\\mu)\\|\\beta_{*}\\|(1-\\phi^{2}),\\qquad\\qquad}&&{\\phi(0)=\\frac{w_{0}^{\\mathsf{T}}\\beta_{*}}{\\|w_{0}\\|\\|\\beta_{*}\\|}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "First, we show that the sign of $\\mu$ cannot change through training and $\\operatorname{sgn}(\\mu)=\\operatorname{sgn}(a)$ . Because $\\delta=0$ , the dynamics of $a$ and $w$ are constrained to a double cone with a singularity at the origin $(a=0,w=0)$ ). This point is a saddle point of the dynamics, so the trajectory cannot pass through this point to move from one cone to the other. In other words, the cone where the dynamics are initialized on is the cone they remain on. Without loss of generality, we assume $a_{0}>0$ , and solve the dynamics. The dynamics of $\\mu$ is a Bernoulli differential equation driven by a time-dependent signal $\\bar{\\phi||}\\beta_{*}\\|$ . The dynamics of $\\phi$ is decoupled from $\\mu$ and is in the form of a Riccati equation evolving from an initial value $\\phi_{0}$ to 1, as we have assumed an initialization with positive $a_{0}$ . This ODE is separable with the solution, ", "page_idx": 17}, {"type": "equation", "text": "$$\n\\phi(t)=\\operatorname{tanh}\\left(c_{\\phi}+\\|\\beta_{*}\\|t\\right),\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "where $c_{\\phi}=\\operatorname{tanh}^{-1}(\\phi_{0})$ . Plugging this solution into the dynamics for $\\mu$ gives a Bernoulli differential equation, ", "page_idx": 17}, {"type": "equation", "text": "$$\n\\dot{\\mu}=2\\|\\beta_{*}\\|\\operatorname{tanh}\\left(c_{\\phi}+\\|\\beta_{*}\\|t\\right)\\mu-2\\mu^{2},\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "with the solution, ", "page_idx": 17}, {"type": "equation", "text": "$$\n\\mu(t)=\\frac{2\\cosh^{2}\\left(c_{\\phi}+\\|\\beta_{*}\\|t\\right)}{2\\left(c_{\\phi}+\\|\\beta_{*}\\|t\\right)+\\sinh\\left(2(c_{\\phi}+\\|\\beta_{*}\\|t)\\right)+c_{\\mu}},\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "where $c_{\\mu}=2\\mu_{0}^{-1}\\cosh^{2}(c_{\\phi})-(2c_{\\phi}+\\sinh(2c_{\\phi}))$ . Note, if $\\phi_{0}=-1$ , then $\\dot{\\phi}=0$ , and the dynamics of $\\mu$ will be driven to 0, which is a saddle point. ", "page_idx": 17}, {"type": "text", "text": "A.2.3 Upstream $\\delta>0$ ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "When $\\delta\\,>\\,0$ , the dynamics are constrained to a hyperboloid composed of two identical sheets determined by the sign of $a_{0}$ (as shown in Fig. 2 (c)). Without loss of generality we assume $a_{0}>0$ , which ensures $a(t)\\bar{>}\\,0$ for all $t\\geq0$ . However, unlike in the balanced setting, the dynamics of $\\mu$ ", "page_idx": 17}, {"type": "text", "text": "and $\\phi$ do not decouple, making it difficult to solve. Instead, we consider $\\begin{array}{r}{\\nu=\\frac{w^{\\top}\\beta_{*}}{a}}\\end{array}$ , which evolves according to the Riccati equation, ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\dot{\\nu}=\\|\\beta_{*}\\|^{2}-\\delta\\nu-\\nu^{2},\\qquad\\qquad\\qquad\\qquad\\nu(0)=\\frac{w_{0}^{\\mathsf{T}}\\beta_{*}}{a_{0}}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "The solution is given by, ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\nu(t)=\\frac{2R\\nu_{0}\\cosh\\left(R t\\right)+\\left(2\\|\\beta_{*}\\|^{2}-\\delta\\nu_{0}\\right)\\sinh\\left(R t\\right)}{2R\\cosh\\left(R t\\right)+\\left(2\\nu_{0}+\\delta\\right)\\sinh\\left(R t\\right)},\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "where $\\begin{array}{r}{R=\\frac{1}{2}\\sqrt{\\delta^{2}+4\\|\\beta_{*}\\|^{2}}}\\end{array}$ . The trajectory of $a(t)$ is given by the Bernoulli equation, ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\dot{a}=a(\\nu(t)+\\delta-a^{2}),\\qquad\\qquad\\qquad\\qquad a(0)=a_{0},\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "which can be solved analytically using $\\nu(t)$ . For $a_{0}>0$ , we have that ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\begin{array}{r l r}&{}&{a(t)=2e^{t\\delta/2}\\|\\beta_{*}\\|\\sqrt{\\delta}\\Bigg(\\mathrm{sech}^{2}\\left(Y(t)\\right)\\bigg[4e^{t\\delta}\\|\\beta_{*}\\|^{2}-\\frac{\\big(\\delta^{2}+4\\|\\beta_{*}\\|^{2}\\big)\\big(\\|\\beta_{*}\\|^{2}\\left(\\delta-a_{0}^{2}\\right)+b_{0}^{2}\\big)}{b_{0}^{2}-a_{0}^{2}\\|\\beta_{*}\\|^{2}+a_{0}b_{0}\\delta}}\\\\ &{}&{-\\,\\delta e^{\\delta t}\\left(\\delta\\cosh\\left(2Y(t)\\right)-\\sqrt{\\delta^{2}+4\\|\\beta_{*}\\|^{2}}\\sinh\\left(2Y(t)\\right)\\right)\\bigg]\\Bigg)^{-1/2}}\\end{array}\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "where $b_{0}=w_{0}^{\\mathsf{T}}\\beta_{*}$ , and $\\begin{array}{r}{Y(t)=\\frac{1}{2}\\sqrt{\\delta^{2}+4\\|\\beta_{*}\\|^{2}}t+\\mathrm{atanh}\\left(\\frac{\\frac{2b_{0}}{a_{0}}+\\delta}{\\sqrt{\\delta^{2}+4\\|\\beta_{*}\\|^{2}}}\\right)}\\end{array}$ . From the solutions for $\\nu,a$ , we can easily obtain dynamics for $\\mu,\\phi$ . ", "page_idx": 18}, {"type": "text", "text": "A.2.4 Downstream $\\delta<0$ ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "When $\\delta<0$ , the dynamics are constrained to a hyperboloid composed of a single sheet (as shown in Fig. 2 (a)). However, unlike in the upstream setting, $a$ may change sign. A zero-crossing in $a$ leads to a finite time blowup in $\\nu$ . Consequently, applying the approach used to solve for the dynamics in the upstream setting becomes more intricate. First we show the following lemma: ", "page_idx": 18}, {"type": "text", "text": "Lemma A.1. If $a_{0}\\neq0$ or $w_{0}^{\\mathsf{T}}\\beta_{*}\\neq0$ , then $a(t)w(t)\\sf^{\\sf T}\\beta_{*}=0$ has at most one solution for $t\\geq0$ . ", "page_idx": 18}, {"type": "text", "text": "Proof. Let $\\omega(t)=w(t)\\mathsf{r}\\,\\beta_{*}$ . The two-dimensional dynamics of $a(t)$ and $\\omega(t)$ are given by, ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\dot{a}=\\omega-a(a^{2}-\\delta),}\\\\ {\\dot{\\omega}=a\\|\\beta_{*}\\|^{2}-a^{2}\\omega.}\\end{array}\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "Consider the orthant $O^{+}=\\{(a,\\omega)|a>0,\\omega>0\\}$ . The boundary $\\partial O^{+}$ is formed by two orthogonal subspaces. On $\\{(a,\\omega)|a=0,\\omega\\geq0\\}$ , $\\dot{a}\\geq0$ . On $\\{(a,\\omega)|a\\geq0,\\omega=0\\}$ , $\\dot{\\omega}\\geq0$ . Therefore, $O^{+}$ is a positively invariant set. Similarly, $O^{-}=\\{(a,\\omega)|a<0,\\omega<0\\}$ is a positively invariant set. On the boundary $\\partial O^{+}\\cup\\partial O^{-}{}~={\\mathfrak{f}}(a,{\\dot{\\omega}})|a\\omega={\\mathfrak{d}}\\}$ , the flow is contained only at the origin $a=0,\\omega=0$ , which represents all saddle points of the dynamics of $(a,w)$ . By assumption, $(a,w)$ is not initialized at a saddle point, and thus the origin is not reachable for $t\\geq0$ . As a result, the trajectory $(a(t),\\omega(t))$ will at most intersect the boundary $\\partial O_{+}\\cup\\partial O_{-}$ once. ", "page_idx": 18}, {"type": "text", "text": "From Lemma A.1, we conclude that either $a$ crosses zero, $w^{\\mathsf{T}}{\\boldsymbol{\\beta}}_{*}$ crosses zero, or neither crosses zero. When $a$ doesn\u2019t cross zero, then $\\nu$ is well-defined for $t\\geq0$ , and our argument from Appendix A.2.3 still holds, leading to solutions for $\\mu,\\phi$ . When $a$ does cross zero, instead of $\\nu$ , we consider $\\begin{array}{r}{v=\\frac{a}{w^{\\top}\\beta_{*}}}\\end{array}$ the inverse of $\\nu$ . In this case, we know from Lemma A.1 that $w^{\\boldsymbol{\\mathsf{T}}}{\\boldsymbol{\\beta}}_{*}$ does not cross zero and thus $\\upsilon$ is well-defined for $t\\geq0$ and evolves according to the Riccatti equation, ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\dot{v}=1+\\delta v-\\|\\beta_{*}\\|^{2}v^{2},\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ v(0)=\\frac{a_{0}}{w_{0}^{\\top}\\beta_{*}}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "These dynamics have a solution similar to Eq. (28), which we leave to the reader. With $\\upsilon(t)$ , we can then solve for the dynamics of $w^{\\mathsf{T}}{\\boldsymbol{\\beta}}_{*}$ . Let $\\omega=w^{\\boldsymbol{\\mathsf{T}}}\\beta_{*}$ , then $\\omega$ evolves according to the Bernoulli equation, ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\dot{\\omega}=\\omega\\left(v\\|\\beta\\|^{2}-v^{2}\\omega^{2}\\right),\\qquad\\qquad\\qquad\\ \\omega(0)=w(0)^{\\top}\\beta_{*},}\\end{array}\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "which can be solved analytically using $\\upsilon(t)$ , analogous to the solution for $a(t)$ in Appendix A.2.3.   \nFrom the solutions for $v,\\omega$ , we can easily obtain dynamics for $\\mu,\\phi$ . ", "page_idx": 18}, {"type": "text", "text": "A.2.5 Basins of attraction ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "From Lemma A.1 we know that $a$ can cross zero no more than once during its trajectory. Consequently, we can identify the basin of attraction by determining the conditions under which $a$ changes sign. This analysis is crucial because initial conditions leading to a sign change in $a$ correspond to scenarios where initial positive and negative values of $a_{0}$ are drawn towards the negative and positive branches of the minima manifold, respectively. From Eq. (28) we can immediately see that $a$ will change sign when the denominator vanishes. This can happen if $\\sqrt{\\delta^{2}+4\\|\\beta_{*}\\|^{2}}<$ $-2\\nu_{0}-\\delta$ . For $\\delta<0$ , this is satisfied if $\\begin{array}{r}{\\nu_{0}<\\frac{1}{2}\\left(-\\delta-\\sqrt{\\delta^{2}+4\\|\\beta_{*}\\|^{2}}\\right)}\\end{array}$ , which gives the hyperplane $\\begin{array}{r}{w_{0}^{\\mathsf{T}}\\beta_{*}\\!+\\!\\frac{a_{0}}{2}\\left(\\delta+\\sqrt{\\delta^{2}+4\\|\\beta_{*}\\|^{2}}\\right)=0}\\end{array}$ that separates between initializations for which $a$ changes sign and initializations for which it does not (Fig. 7). Consequently, letting $S^{+}$ be the set of initializations attracted to the minimum manifold with $a>0$ , we have that: ", "page_idx": 19}, {"type": "equation", "text": "$$\nS^{+}=\\left\\{(w_{0},a_{0})\\left|\\begin{array}{l l}{a_{0}>0}&{\\mathrm{if~}\\delta\\geq0}\\\\ {w_{0}^{\\mathsf{T}}\\beta_{*}>-\\frac{a_{0}}{2}\\left(\\delta+\\sqrt{\\delta^{2}+4\\|\\beta_{*}\\|^{2}}\\right)}&{\\mathrm{if~}\\delta<0}\\end{array}\\right.\\right\\}\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "where the bottom inequality means that $\\beta_{0}$ is sufficiently aligned to $\\beta_{*}$ in the case of $a_{0}\\geq0$ or sufficiently misaligned in the case of $a_{0}~\\leq~0$ . We can similarly define the analogous $S^{-}$ . An initialization on the separating hyperplane will converge to a saddle point where $w^{\\boldsymbol{\\mathsf{T}}}\\beta_{*}=a=0$ . ", "page_idx": 19}, {"type": "image", "img_path": "eNM94i7R3A/tmp/593d6399e64f986efe5c422a7597396ec30aeb9553e7625e3bc13eaf5d3eb5a0.jpg", "img_caption": ["Figure 7: Two basins of attraction. For this model, parameter space is partitioned into two basins of attraction, one for the positive and negative branch of the minima manifold. The surface separating the basins of attraction is determined by the equation $\\begin{array}{r}{w_{0}^{\\mathsf{T}}\\beta_{*}+\\frac{a_{0}}{2}\\left(\\delta+\\sqrt{\\delta^{2}+4\\|\\beta_{*}\\|^{2}}\\right)=0}\\end{array}$ . For a given $\\delta$ , this equation describes a hyperplane through the origin. However, a given $\\delta$ can only be achieved on the surface of some hyperboloid. Thus, the separating surface is the union of the intersections of a hyperplane and a hyperboloid, both parameterized by $\\delta$ . This intersection is empty if $\\delta>0$ . Initializations exactly on the separating surface will travel along the surface to a saddle point where $w^{\\boldsymbol{\\mathsf{T}}}\\beta_{*}=a=0$ . "], "img_footnote": [], "page_idx": 19}, {"type": "text", "text": "A.2.6 Recovering parameters $(a,w)$ from $(\\mu,\\phi)$ ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "We now discuss how to recover the dynamics of the parameters $(a,w)$ from our solutions for $(\\mu,\\phi)$ . We can recover $a$ and $\\lVert w\\rVert$ from $\\mu$ . Using Eq. (19) discussed previously, we can show ", "page_idx": 19}, {"type": "equation", "text": "$$\na=\\operatorname{sgn}(\\mu){\\sqrt{\\frac{{\\sqrt{\\delta^{2}+4\\mu^{2}}}+\\delta}{2}}},\\qquad\\|w\\|={\\sqrt{\\frac{{\\sqrt{\\delta^{2}+4\\mu^{2}}}-\\delta}{2}}}.\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "We now discuss how to obtain the vector $w$ from $\\phi$ . The key observation, as discussed in Section 3, is that $w$ only moves in the span of $w_{0}$ and $\\beta_{*}$ . This means we can express $w(t)$ as ", "page_idx": 20}, {"type": "equation", "text": "$$\nw(t)=c_{1}(t)\\left(\\frac{\\beta_{*}}{\\|\\beta_{*}\\|}\\right)+c_{2}(t)\\left(\\frac{\\left(\\mathbf{I}_{d}-\\frac{\\beta_{*}\\beta_{*}^{\\mathsf{T}}}{\\|\\beta_{*}\\|^{2}}\\right)w_{0}}{\\sqrt{\\|w_{0}\\|^{2}-\\left(\\frac{\\beta_{*}^{\\mathsf{T}}w_{0}}{\\|\\beta_{*}\\|}\\right)^{2}}}\\right)\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "where $c_{1}(t)$ is the coefficient in the direction of $\\beta_{*}$ and $c_{2}(t)$ is the coefficient in the direction orthogonal to $\\beta_{*}$ on the two-dimensional plane defined by $w_{0}$ . From the definition of $\\phi$ we can easily obtain the coefficients $c_{1}=\\|w\\|\\phi$ and $c_{2}=\\sqrt{\\|w\\|^{2}-c_{1}^{2}}$ . We always choose the positive square root for $c_{2}$ , as $c_{2}(t)\\geq0$ for all $t$ . See Appendix D.2 for experimental details of how we ran our simulations and a notebook generating these exact solutions. ", "page_idx": 20}, {"type": "image", "img_path": "eNM94i7R3A/tmp/86e7a2ad1599920241f689fe383a1101b6cd5f374ef56dbdd94c8c25d781e137.jpg", "img_caption": ["Figure 8: Exact temporal dynamics of relevant variables in single-hidden neuron model. Our theory recovers the time evolution under gradient flow of the quantities considered in this section, specifically $\\nu$ , $\\varphi$ , and $\\zeta$ , as well as the resulting dynamics of the model parameters $\\{a,w_{1},w_{2}\\}$ . The true $\\beta*$ is a unit vector pointing in $\\pi/4$ direction; $\\mathbf{\\bar{\\rho}}\\beta(0)$ is a unit vector pointing towards $3\\pi/2,-\\pi/4$ , and $\\pi/4$ directions, respectively, for each of the three rows. $\\delta$ then defines how $a(0)$ and $\\lVert w(0)\\rVert$ are chosen for a particular $\\beta(0)$ where by convention we choose $a(0)>0$ . "], "img_footnote": [], "page_idx": 20}, {"type": "text", "text": "A.3 Function space dynamics of $\\beta$ ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "The network\u2019s function is determined by the product $\\beta=a w$ and governed by the ODE, ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\dot{\\beta}=a\\dot{w}+\\dot{a}w=-\\underbrace{\\left(\\eta_{w}a^{2}\\mathbf{I}_{d}+\\eta_{a}w w^{\\mathsf{T}}\\right)}_{M}\\underbrace{\\left(X^{\\mathsf{T}}X\\beta-X^{\\mathsf{T}}y\\right)}_{X^{\\mathsf{T}}\\rho}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "Notice, that the vector $X^{\\intercal}\\rho$ driving the dynamics of $\\beta$ is the gradient of the loss with respect to $\\beta$ , $X^{\\intercal}\\rho=\\nabla_{\\beta}\\mathcal{L}$ . Thus, these dynamics can be interpreted as preconditioned gradient flow on the loss in $\\beta$ space where the preconditioning matrix $M$ depends on time through its dependence on $a^{2}$ and $w w^{\\boldsymbol{\\mathsf{T}}}$ . The matrix $M$ also characterizes the NTK matrix, $K=X M X\\tau$ . As discussed in Section 3, our goal is to understand the evolution of $M$ along a trajectory $\\{\\beta(t)\\in\\mathbb{R}^{d}~:~t\\geq0\\}$ solving Eq. (37). ", "page_idx": 21}, {"type": "text", "text": "First, notice that by expanding $\\|\\beta\\|^{2}=a^{2}\\|w\\|^{2}$ in terms of the conservation law, we can show ", "page_idx": 21}, {"type": "equation", "text": "$$\na^{2}=\\frac{\\sqrt{\\delta^{2}+4\\eta_{a}\\eta_{w}\\|\\beta\\|^{2}}+\\delta}{2\\eta_{w}},\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "which is the unique positive solution of the quadratic expression $\\eta_{w}a^{4}-\\delta a^{2}-\\eta_{a}\\|\\beta\\|^{2}=0$ . When $a^{2}>0$ we can use this solution and the outer product $\\beta{\\bar{\\beta}}\\bar{\\sf7}=a^{2}w{\\dot{w}}^{\\sf7}$ to solve for $w w^{\\boldsymbol{\\mathsf{T}}}$ in terms of $\\beta$ , ", "page_idx": 21}, {"type": "equation", "text": "$$\nw w^{\\boldsymbol{\\mathsf{T}}}=\\frac{\\sqrt{\\delta^{2}+4\\eta_{a}\\eta_{w}\\|\\beta\\|^{2}}-\\delta}{2\\eta_{a}}\\frac{\\beta\\beta^{\\boldsymbol{\\mathsf{T}}}}{\\|\\beta\\|^{2}}.\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "Plugging these expressions into $M$ gives ", "page_idx": 21}, {"type": "equation", "text": "$$\nM=\\frac{\\sqrt{\\delta^{2}+4\\eta_{a}\\eta_{w}\\|\\beta\\|^{2}}+\\delta}{2}\\mathbf{I}_{d}+\\frac{\\sqrt{\\delta^{2}+4\\eta_{a}\\eta_{w}\\|\\beta\\|^{2}}-\\delta}{2}\\frac{\\beta\\beta^{\\mathsf{T}}}{\\|\\beta\\|^{2}}.\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "Thus, given any initialization $a_{0},w_{0}$ such that $a(t)^{2}\\neq0$ for all $t\\geq0$ , we can express the dynamics of $\\beta$ entirely in terms of $\\beta$ . This is true for all initializations with $\\delta\\geq0$ , except if initialized on the saddle point at the origin. It is also true for all initializations with $\\delta<0$ where the sign of $a$ does not switch signs. In the next section we will show how to interpret these trajectories as time-warped mirror flows for a potential that depends on $\\delta$ . As a means of keeping the analysis entirely in $\\beta$ space, we will make the slightly more restrictive assumption to only study trajectories given any initialization $\\beta_{0}$ such that $\\|\\bar{\\beta}(t)\\|>0$ for all $t\\geq0$ . ", "page_idx": 21}, {"type": "text", "text": "Notice, that $\\eta_{a}$ and $\\eta_{w}$ \u221aonly appear in the d\u221aynamics for $\\beta$ as the product $\\eta_{a}\\eta_{w}$ or in the expression for $\\delta$ . By defining $\\beta^{\\prime}=\\sqrt{\\eta_{a}\\eta_{w}}\\beta$ and $y^{\\prime}=\\sqrt{\\eta_{a}\\eta_{w}}y$ and stu\u221adying the dynamics of $\\beta^{\\prime}$ , we can absorb $\\eta_{a}\\eta_{w}$ into the $\\beta$ terms in $M$ and the additional factor $\\sqrt{\\eta_{a}\\eta_{w}}$ into the $\\beta$ and $y$ terms in $\\rho$ . This transformation of $\\beta$ and $y$ merely rescales $\\beta$ space without changing the loss landscape or location of critical points. As a result, from here on we will, without loss of generality, study the dynamics of $\\beta$ assuming $\\eta_{a}\\eta_{w}=1$ . ", "page_idx": 21}, {"type": "text", "text": "A.3.1 Kernel dynamics ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "The dynamics of the NTK matrix $K=X M X\\tau$ is determined by $\\dot{M}$ . From Eq. (4), which is derived in this section, we can write $\\begin{array}{r}{\\dot{M}=\\frac{2\\|\\beta\\|}{\\kappa}(\\mathbf{I}_{d}+\\hat{\\beta}\\hat{\\beta}^{\\intercal})\\partial_{t}\\|\\beta\\|+\\frac{\\kappa-\\delta}{2}\\partial_{t}(\\hat{\\beta}\\hat{\\beta}^{\\intercal})}\\end{array}$ where $\\begin{array}{r}{\\hat{\\beta}=\\frac{\\beta}{\\|\\beta\\|}}\\end{array}$ = \u03b2 . From this expression we see that the change in $M$ is driven by two terms, one that depends on the change in the magnitude of $\\beta$ and another that depends on the change in the direction of $\\beta$ . As done in the main text, we consider $\\delta\\gg0$ , $\\delta\\ll0$ , and $\\delta=0$ to identify different regimes of learning. For $\\delta\\gg0$ , the coefficients in front of both terms vanish, and thus, irrespective of the trajectory taken from $\\beta(0)$ to $\\beta_{*}$ , the change in the NTK is vanishing, indicative of a lazy regime. For $\\delta\\ll0$ , the coefficient for the first term vanishes, while the coefficient on the second term diverges. Here, the change in the NTK is driven solely by the change in the direction of $\\beta$ . This is why for large negative delta we observe a delayed rich regime, where the eventual alignment of $\\beta$ to $\\beta_{*}$ leads to a dramatic change in the kernel. When $\\delta=0$ , the coefficients for both terms are roughly of the same order, and thus changes in both the magnitude and direction of $\\beta$ contribute to a change in the kernel, indicative of a rich regime. ", "page_idx": 21}, {"type": "text", "text": "A.4 Deriving the inductive bias ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "Until now, we have primarily considered that $X\\tau X$ is either whitened or full rank, ensuring the existence of a unique least squares solution $\\beta_{*}$ . In this setting, $\\delta$ influences the trajectory the model takes from initialization to convergence, but all models eventually converge to the same point, as shown in Fig. 4. Now we consider the over-parameterized setting where we have more features $d$ than observations $n$ such that $X\\tau X$ is low-rank and there exists infinitely many interpolating solutions in function space. By studying the structure of $M$ we can characterize or even predict how $\\delta$ determines which interpolating solution the dynamics converge to among all possible interpolating solutions. To do this we will extend a time-warped mirror flow analysis strategy pioneered by Azulay et al. [9]. ", "page_idx": 21}, {"type": "text", "text": "A.4.1 Overview of time-warped mirror flow analysis ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Here we recap the standard analysis for determining the implicit bias of a linear network through mirror flow. As first introduced in Gunasekar et al. [46], if the learning dynamics of the predictor $\\beta$ can be expressed as a mirror flow for some strictly convex potential $\\Phi_{\\alpha}(\\beta)$ , ", "page_idx": 22}, {"type": "equation", "text": "$$\n\\dot{\\beta}=-\\left(\\nabla^{2}\\Phi_{\\alpha}(\\beta)\\right)^{-1}X^{\\intercal}\\rho,\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "where $\\rho=(X\\beta-y)$ is the residual, then the limiting solution of the dynamics is determined by the constrained optimization problem, ", "page_idx": 22}, {"type": "equation", "text": "$$\n\\beta(\\infty)=\\underset{\\beta\\in\\mathbb{R}^{d}}{\\arg\\operatorname*{min}}\\,D_{\\Phi_{\\alpha}}(\\beta,\\beta(0))\\quad\\mathrm{s.t.}\\quad X\\beta=y,\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "where $D_{\\Phi_{\\alpha}}(p,q)=\\Phi_{\\alpha}(p)-\\Phi_{\\alpha}(q)-\\langle\\nabla\\Phi_{\\alpha}(q),p-q\\rangle$ is the Bregman divergence defined with $\\Phi_{\\alpha}$ . To understand the relationship between mirror flow Eq. (41) and the optimization problem Eq. (42), we consider an equivalent constrained optimization problem ", "page_idx": 22}, {"type": "equation", "text": "$$\n\\beta(\\infty)=\\underset{\\beta\\in\\mathbb{R}^{d}}{\\arg\\operatorname*{min}}\\,Q(\\beta)\\quad\\mathrm{s.t.}\\quad X\\beta=y,\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "where $Q(\\beta)\\,=\\,\\Phi_{\\alpha}(\\beta)-\\nabla\\Phi_{\\alpha}(\\beta(0))^{\\intercal}\\beta$ , which is often referred to as the implicit bias. $Q(\\beta)$ is strictly convex, and thus it is sufficient to show that $\\beta(\\infty)$ is a first order KKT point of the constrained optimization (43). This is true iff there exists $\\nu\\in\\mathbb{R}^{n}$ such that $\\nabla Q(\\beta(\\infty))=X^{\\intercal}\\nu$ . The goal is to derive $\\nu$ from the mirror flow Eq. (41). Notice, we can rewrite Eq. (41) as, $(\\nabla\\Phi_{\\alpha}^{\\dot{\\alpha}}(\\beta))=-X^{\\intercal}\\rho$ , which integrated over time gives ", "page_idx": 22}, {"type": "equation", "text": "$$\n\\nabla\\Phi_{\\alpha}(\\beta(\\infty))-\\nabla\\Phi_{\\alpha}(\\beta(0))=-X^{\\mathsf{T}}\\int_{0}^{\\infty}\\rho(t)d t.\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "The LHS is $\\nabla Q(\\beta(\\infty))$ . Thus, by defining $\\begin{array}{r}{\\nu=\\int_{0}^{\\infty}\\rho(t)d t}\\end{array}$ , which assumes the residual decays fast enough such that this is well defined, then we have shown the desired KKT condition. Crucial to this analysis is that there exists a solution to the second-order differential equation ", "page_idx": 22}, {"type": "equation", "text": "$$\n\\nabla^{2}\\Phi_{\\alpha}(\\beta)=\\left(\\nabla_{\\theta}\\beta\\nabla_{\\theta}\\beta^{\\mathsf{T}}\\right)^{-1},\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "which even for extremely simple Jacobian maps may not be true [47]. Azulay et al. [9] showed that if there exists a smooth positive function $g(\\beta):\\bar{\\mathbb{R}}^{d}\\,\\dot{\\rightarrow}\\,(0,\\infty)$ such that the ODE, ", "page_idx": 22}, {"type": "equation", "text": "$$\n\\nabla^{2}\\Phi_{\\alpha}(\\beta)=g(\\beta)\\left(\\nabla_{\\theta}\\beta\\nabla_{\\theta}\\beta^{\\mathsf{T}}\\right)^{-1},\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "has a solution, then the previous interpretation holds for $\\Phi_{\\alpha}(\\beta)$ with $\\begin{array}{r}{\\nu=\\int_{0}^{\\infty}g(\\beta(t^{\\prime}))\\rho(t^{\\prime})d t}\\end{array}$ . As before, it is crucial that this integral exists and is finite. Azulay et al. [9] further explained that this scalar function $g(\\beta)$ can be considered as warping time $\\begin{array}{r}{\\tau(t)=\\dot{\\int_{0}^{t}g(\\beta(t^{\\prime}))d t^{\\prime}}}\\end{array}$ on the trajectory taken in predictor space $\\beta(\\tau(t))$ . So long as this warped time doesn\u2019t \u201cstall out\u201d, that is we require that $\\tau(\\infty)=\\infty$ , then this will not change the interpolating solution. ", "page_idx": 22}, {"type": "text", "text": "A.4.2 Applying time-warped mirror flow analysis ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Here show how to apply the time-warped mirror flow analysis to the dynamics of $\\beta$ derived in Appendix A.3 where $\\nabla_{\\theta}\\beta\\nabla_{\\theta}\\beta\\boldsymbol{\\mathsf{T}}=M$ . We will only consider initializations $\\beta_{0}$ such that $\\|\\beta(t)\\|>0$ for all $t\\geq0$ , such that $M$ can be expressed as ", "page_idx": 22}, {"type": "equation", "text": "$$\nM=\\frac{\\sqrt{\\delta^{2}+4\\|\\beta\\|^{2}}+\\delta}{2}I_{d}+\\frac{\\sqrt{\\delta^{2}+4\\|\\beta\\|^{2}}-\\delta}{2}\\frac{\\beta\\beta^{\\top}}{\\|\\beta\\|^{2}}.\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "Computing $M^{-1}$ . Whenever $\\|\\beta\\|>0$ , then $M$ is a positive definite matrix with a unique inverse that can be derived using the Sherman\u2013Morrison formula, $\\begin{array}{r}{(A+u v^{\\boldsymbol{\\mathsf{T}}})^{-1}=A^{-1}-\\frac{A^{-1}u v^{\\boldsymbol{\\mathsf{T}}}A^{-1}}{1+u^{\\boldsymbol{\\mathsf{T}}}A^{-1}v}}\\end{array}$ 1+u\u22baA\u22121v . Here we can define $A,u$ , and $v$ as ", "page_idx": 22}, {"type": "equation", "text": "$$\nA=\\left(\\frac{\\sqrt{\\delta^{2}+4\\|\\beta\\|^{2}}+\\delta}{2}\\right)I_{d},\\ u=\\left(\\frac{\\sqrt{\\delta^{2}+4\\|\\beta\\|^{2}}-\\delta}{2\\|\\beta\\|^{2}}\\right)\\beta,\\ v=\\beta\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "First notice the following simplification, $\\begin{array}{r}{u^{\\mathsf{T}}A^{-1}v=\\frac{\\sqrt{\\delta^{2}+4\\|\\beta\\|^{2}}-\\delta}{\\sqrt{\\delta^{2}+4\\|\\beta\\|^{2}}+\\delta}}\\end{array}$ . After some algebra, $M^{-1}$ is ", "page_idx": 23}, {"type": "equation", "text": "$$\nM^{-1}=\\left({\\frac{2}{\\sqrt{\\delta^{2}+4\\|\\beta\\|^{2}}+\\delta}}\\right)I_{d}-\\left({\\frac{{\\frac{\\sqrt{\\delta^{2}+4\\|\\beta\\|^{2}}-\\delta}{\\sqrt{\\delta^{2}+4\\|\\beta\\|^{2}}+\\delta}}}{\\|\\beta\\|^{2}{\\sqrt{\\delta^{2}+4\\|\\beta\\|^{2}}}}}\\right)\\beta\\beta^{\\gamma}\n$$", "text_format": "latex", "page_idx": 23}, {"type": "text", "text": "To make notation simpler we will define the following two scalar functions, ", "page_idx": 23}, {"type": "equation", "text": "$$\nf_{\\delta}(x)={\\frac{2}{\\sqrt{\\delta^{2}+4x}+\\delta}},\\qquad h_{\\delta}(x)={\\frac{\\sqrt{\\delta^{2}+4x}-\\delta}{x{\\sqrt{\\delta^{2}+4x}}\\left(\\sqrt{\\delta^{2}+4x}+\\delta\\right)}},\n$$", "text_format": "latex", "page_idx": 23}, {"type": "text", "text": "such that we can express $M^{-1}=f_{\\delta}\\left(\\|\\beta\\|^{2}\\right)I_{d}-h_{\\delta}\\left(\\|\\beta\\|^{2}\\right)\\beta\\beta^{\\mathsf{T}}.$ ", "page_idx": 23}, {"type": "text", "text": "Proving $M^{-1}$ is not a Hessian map. If $M^{-1}$ is the Hessian of some potential, then we can show that the dynamics of $\\beta$ are a mirror flow. However, from our expression for $M^{-1}$ we can actually prove that it is not a Hessian map. As discussed in Gunasekar et al. [47], a symmetric matrix $H(\\beta)$ is the Hessian of some potential $\\Phi(\\beta)$ if and only if it satisfies the condition, ", "page_idx": 23}, {"type": "equation", "text": "$$\n\\forall\\beta\\in\\mathbb{R}^{m},\\quad\\forall i,j,k\\in[m]\\quad\\frac{\\partial H_{i j}(\\beta)}{\\partial\\beta_{k}}=\\frac{\\partial H_{i k}(\\beta)}{\\partial\\beta_{j}}.\n$$", "text_format": "latex", "page_idx": 23}, {"type": "text", "text": "We will use this property to show $M^{-1}$ is not a Hessian map. First, notice this condition is trivially true when $i=j=k$ . Second, notice that for all $i\\neq j\\neq k$ , ", "page_idx": 23}, {"type": "equation", "text": "$$\n\\frac{\\partial M_{i j}^{-1}}{\\partial\\beta_{k}}=\\frac{\\partial M_{i k}^{-1}}{\\partial\\beta_{j}}=-2\\nabla h_{\\delta}\\left(\\left\\|\\beta\\right\\|^{2}\\right)\\beta_{i}\\beta_{j}\\beta_{k}\n$$", "text_format": "latex", "page_idx": 23}, {"type": "text", "text": "Thus, $M^{-1}$ is a Hessian map if and only if for all $i\\neq j$ , $\\begin{array}{r}{\\frac{\\partial M_{i i}^{-1}}{\\partial\\beta_{j}}=\\frac{\\partial M_{i j}^{-1}}{\\partial\\beta_{i}}}\\end{array}$ . Using our expression for $M^{-1}$ , the LHS is ", "page_idx": 23}, {"type": "equation", "text": "$$\n\\frac{\\partial M_{i i}^{-1}}{\\partial\\beta_{j}}=2\\nabla f_{\\delta}\\left(\\|\\beta\\|^{2}\\right)\\beta_{j}-2\\nabla h_{\\delta}\\left(\\|\\beta\\|^{2}\\right)\\beta_{j}\\beta_{i}^{2}\n$$", "text_format": "latex", "page_idx": 23}, {"type": "text", "text": "while the RHS is ", "page_idx": 23}, {"type": "equation", "text": "$$\n\\frac{\\partial M_{i j}^{-1}}{\\partial\\beta_{i}}=-h_{\\delta}\\left(\\left\\|\\beta\\right\\|^{2}\\right)\\beta_{j}-2\\nabla h_{\\delta}\\left(\\left\\|\\beta\\right\\|^{2}\\right)\\beta_{j}\\beta_{i}^{2}\n$$", "text_format": "latex", "page_idx": 23}, {"type": "text", "text": "Thus, $M^{-1}$ is a Hessian map if and only if $2\\nabla f_{\\delta}(x)+h_{\\delta}(x)=0$ . Plugging in our definitions of $f_{\\delta}(x)$ and $h_{\\delta}(x)$ we find ", "page_idx": 23}, {"type": "equation", "text": "$$\n2\\nabla f_{\\delta}(x)+h_{\\delta}(x)=\\frac{-4}{\\sqrt{\\delta^{2}+4x}(\\sqrt{\\delta^{2}+4x}+\\delta)^{2}},\n$$", "text_format": "latex", "page_idx": 23}, {"type": "text", "text": "which does not equal zero and thus $M^{-1}$ is not a Hessian map. ", "page_idx": 23}, {"type": "text", "text": "Finding a scalar function $g_{\\delta}(x)$ such that $g_{\\delta}\\big(\\|\\beta\\|^{2}\\big)M^{-1}$ is a Hessian map. While we have shown that $M^{-1}$ is not a Hessian map, it is very close to a Hessian map. Here we will show that there exists a scalar function $g_{\\delta}(x)$ such that $g_{\\delta}\\dot{\\left(\\left\\|\\beta\\right\\|^{2}\\right)M^{-1}}$ is a Hessian map. For any $g_{\\delta}(x)$ can define $g_{\\delta}\\left(\\|\\beta\\|^{2}\\right)M^{-1}$ in terms of two new functions $\\tilde{f}_{\\delta}(x)$ and $\\tilde{h}_{\\delta}(x)$ evaluated at $x=\\|\\beta\\|^{2}$ , ", "page_idx": 23}, {"type": "equation", "text": "$$\ng_{\\delta}\\left(\\|\\beta\\|^{2}\\right)M^{-1}=\\underbrace{g_{\\delta}\\left(\\|\\beta\\|^{2}\\right)f_{\\delta}\\left(\\|\\beta\\|^{2}\\right)}_{\\tilde{f}_{\\delta}\\left(\\|\\beta\\|^{2}\\right)}I_{d}-\\underbrace{g_{\\delta}\\left(\\|\\beta\\|^{2}\\right)h_{\\delta}\\left(\\|\\beta\\|^{2}\\right)}_{\\tilde{h}_{\\delta}\\left(\\|\\beta\\|^{2}\\right)}\\beta\\beta^{\\mathsf{T}}.\n$$", "text_format": "latex", "page_idx": 23}, {"type": "text", "text": "Thus, as derived in the previous section, we get the analogous condition on $\\tilde{f}_{\\delta}(x)$ and $\\tilde{h}_{\\delta}(x)$ for $g_{\\delta}\\left(\\|\\beta\\|^{2}\\right)M^{-1}$ to be a Hessian map, ", "page_idx": 23}, {"type": "equation", "text": "$$\n2\\underbrace{(\\nabla g_{\\delta}(x)f_{\\delta}(x)+g(x)\\nabla f_{\\delta}(x))}_{\\nabla\\tilde{f}_{\\delta}(x)}+\\underbrace{g_{\\delta}(x)h_{\\delta}(x)}_{\\tilde{h}_{\\delta}(x)}=0\n$$", "text_format": "latex", "page_idx": 23}, {"type": "text", "text": "Rearranging terms we find that $g_{\\delta}(x)$ must solve the ODE ", "page_idx": 23}, {"type": "equation", "text": "$$\n\\nabla g_{\\delta}(x)=-\\left(2f_{\\delta}(x)\\right)^{-1}(2\\nabla f_{\\delta}(x)+h_{\\delta}(x))\\,g_{\\delta}(x).\n$$", "text_format": "latex", "page_idx": 23}, {"type": "text", "text": "Using our previous expressions (Eq. (50) and Eq. (55)) we find ", "page_idx": 24}, {"type": "equation", "text": "$$\n-\\left(2f_{\\delta}(x)\\right)^{-1}\\left(2\\nabla f_{\\delta}(x)+h_{\\delta}(x)\\right)=\\frac{1}{\\sqrt{\\delta^{2}+4x}(\\sqrt{\\delta^{2}+4x}+\\delta)},\n$$", "text_format": "latex", "page_idx": 24}, {"type": "text", "text": "which implies g\u03b4(x) solves the differential equation, \u2207g\u03b4(x) =\u221a\u03b42+4xg(\u03b4\u221a(\u03b4x2)+4x+\u03b4). The solution is $g_{\\delta}(x)=c\\sqrt{\\sqrt{\\delta^{2}+4x}+\\delta}$ , where $c\\in\\mathbb{R}$ is a constant. Let $c=1$ . Plugging in our expressions for $g_{\\delta}\\left(\\|\\beta\\|^{2}\\right)\\!,\\,f_{\\delta}\\left(\\|\\beta\\|^{2}\\right)\\!,h_{\\delta}\\left(\\|\\beta\\|^{2}\\right)$ , we get that ", "page_idx": 24}, {"type": "equation", "text": "$$\ng_{\\delta}\\left(\\|\\beta\\|^{2}\\right)M^{-1}=\\left(\\frac{2}{\\sqrt{\\sqrt{\\delta^{2}+4\\|\\beta\\|^{2}}+\\delta}}\\right)I_{d}-\\left(\\frac{\\frac{\\sqrt{\\delta^{2}+4\\|\\beta\\|^{2}}-\\delta}{\\sqrt{\\sqrt{\\delta^{2}+4\\|\\beta\\|^{2}}+\\delta}}}{\\|\\beta\\|^{2}\\sqrt{\\delta^{2}+4\\|\\beta\\|^{2}}}\\right)\\beta\\beta^{\\top}\n$$", "text_format": "latex", "page_idx": 24}, {"type": "text", "text": "is a Hessian map for some unknown potential $\\Phi_{\\delta}(\\beta)$ . ", "page_idx": 24}, {"type": "text", "text": "Solving for the potential $\\Phi_{\\delta}(\\beta)$ . Take the ansatz that there exists some function scalar $q(x)$ such that $\\Phi_{\\delta}(\\beta)=q_{\\delta}(\\|\\beta\\|)+c_{\\delta}$ where $c_{\\delta}$ is a constant such that $\\Phi_{\\delta}(\\beta)>0$ for all $\\beta\\neq0$ and $\\Phi_{\\delta}(0)=0$ The Hessian of this ansatz takes the form, ", "page_idx": 24}, {"type": "equation", "text": "$$\n\\nabla^{2}\\Phi_{\\delta}(\\beta)=\\left(\\frac{\\nabla q(\\|\\beta\\|)}{\\|\\beta\\|}\\right)I_{d}-\\left(\\frac{\\nabla q(\\|\\beta\\|)}{\\|\\beta\\|^{3}}-\\frac{\\nabla^{2}q(\\|\\beta\\|)}{\\|\\beta\\|^{2}}\\right)\\beta\\beta^{\\intercal}.\n$$", "text_format": "latex", "page_idx": 24}, {"type": "text", "text": "Equating terms from our expression for $g_{\\delta}\\left(\\|\\beta\\|^{2}\\right)M^{-1}$ (equation 60) we get the expression for $\\nabla q(\\|\\beta\\|)$ ", "page_idx": 24}, {"type": "equation", "text": "$$\n\\nabla q(\\|\\beta\\|)=\\frac{2\\|\\beta\\|}{\\sqrt{\\delta^{2}+4\\|\\beta\\|^{2}}+\\delta},\n$$", "text_format": "latex", "page_idx": 24}, {"type": "text", "text": "which plugged into the second term gives the expression for $\\nabla^{2}q(\\|\\beta\\|)$ , ", "page_idx": 24}, {"type": "equation", "text": "$$\n\\nabla^{2}q(\\|\\beta\\|)={\\frac{2}{\\sqrt{{\\sqrt{\\delta^{2}+4\\|\\beta\\|^{2}}}+\\delta}}}-\\left({\\frac{{\\sqrt{{\\sqrt{\\delta^{2}+4\\|\\beta\\|^{2}}}-\\delta}}}{{\\sqrt{{\\sqrt{\\delta^{2}+4\\|\\beta\\|^{2}}}+\\delta}}}}\\right)={\\frac{\\sqrt{{\\sqrt{\\delta^{2}+4\\|\\beta\\|^{2}}}+\\delta}}{\\sqrt{\\delta^{2}+4\\|\\beta\\|^{2}}}}.\n$$", "text_format": "latex", "page_idx": 24}, {"type": "text", "text": "We now look for a function $q(x)$ such that both these conditions (Eq. (62) and Eq. (63)) are true. Consider the following function and its derivatives, ", "page_idx": 24}, {"type": "equation", "text": "$$\n\\begin{array}{c}{{q(x)=\\displaystyle\\frac{1}{3}\\left(\\sqrt{\\delta^{2}+4x^{2}}-2\\delta\\right)\\sqrt{\\sqrt{\\delta^{2}+4x^{2}}+\\delta}}}\\\\ {{\\nabla q(x)=\\displaystyle\\frac{2x}{\\sqrt{\\sqrt{\\delta^{2}+4x^{2}}+\\delta}}}}\\\\ {{\\nabla^{2}q(x)=\\displaystyle\\frac{\\sqrt{\\sqrt{\\delta^{2}+4x^{2}}+\\delta}}{\\sqrt{\\delta^{2}+4x^{2}}}}}\\end{array}\n$$", "text_format": "latex", "page_idx": 24}, {"type": "text", "text": "Letting $x=\\|\\beta\\|$ notice $\\nabla q(\\|\\beta\\|)$ and $\\nabla^{2}q(\\|\\beta\\|)$ satisfies the previous conditions. Furthermore, $\\nabla^{2}q(\\bar{x})\\,>\\,0$ for all $\\delta$ as long as $x\\,\\ne\\,0$ and thus $q(x)$ is a convex function which achieves its minimum at $x=0$ . Thus, the constant $c_{\\delta}=-q(0)$ is ", "page_idx": 24}, {"type": "equation", "text": "$$\nc_{\\delta}=\\left\\{\\!\\!\\begin{array}{l l}{0}&{\\mathrm{if~}\\delta\\leq0}\\\\ {\\frac{\\sqrt{2}\\left|\\delta\\right|^{\\frac{3}{2}}}{3}}&{\\mathrm{if~}\\delta>0}\\end{array}\\!\\!\\right.=\\operatorname*{max}\\left(0,\\mathrm{sgn}(\\delta)\\frac{\\sqrt{2}\\left|\\delta\\right|^{\\frac{3}{2}}}{3}\\right),\n$$", "text_format": "latex", "page_idx": 24}, {"type": "text", "text": "and the potential $\\Phi_{\\delta}(\\beta)$ is ", "page_idx": 24}, {"type": "equation", "text": "$$\n\\Phi_{\\delta}(\\beta)=\\frac{1}{3}\\left(\\sqrt{\\delta^{2}+4\\|\\beta\\|^{2}}-2\\delta\\right)\\sqrt{\\sqrt{\\delta^{2}+4\\|\\beta\\|^{2}}+\\delta}+\\operatorname*{max}\\left(0,\\mathrm{sgn}(\\delta)\\frac{\\sqrt{2}|\\delta|^{\\frac{3}{2}}}{3}\\right).\n$$", "text_format": "latex", "page_idx": 24}, {"type": "text", "text": "Finally, putting it all together, we can express the inductive bias as in Theorem 3.1. ", "page_idx": 24}, {"type": "text", "text": "A.4.3 Connection to Theorem 2 in Azulay et al. [9] ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "We discuss how Theorem 3.1 connects to Theorem 2 in Azulay et al. [9], which we rewrite: ", "page_idx": 25}, {"type": "text", "text": "Theorem A.2 (Theorem 2 from Azulay et al. [9]). For a depth 2 fully connected network with $a$ single hidden neuron $^{\\prime}h=1,$ ), any $\\delta\\geq0$ , and initialization $\\beta_{0}$ such that $\\beta_{0}\\neq0$ , if the gradient flow solution $\\beta(\\infty)$ satisfies $X\\beta(\\infty)=y$ , then, ", "page_idx": 25}, {"type": "equation", "text": "$$\n\\beta(\\infty)=\\underset{\\beta\\in\\mathbb{R}^{d}}{\\arg\\operatorname*{min}}\\,q_{\\delta}(\\|\\beta\\|)+z^{\\mathsf{T}}\\beta\\quad\\mathrm{s.t.}\\quad X\\beta=y\n$$", "text_format": "latex", "page_idx": 25}, {"type": "equation", "text": "$$\n\\begin{array}{r}{q_{\\delta}(x)=\\frac{\\left(x^{2}-\\frac{\\delta}{2}\\left(\\frac{\\delta}{2}+\\sqrt{x^{2}+\\frac{\\delta^{2}}{4}}\\right)\\right)\\sqrt{\\sqrt{x^{2}+\\frac{\\delta^{2}}{4}-\\frac{\\delta}{2}}}}{x}\\,a n d\\,z=-\\frac{3}{2}\\sqrt{\\sqrt{\\|\\beta_{0}\\|^{2}+\\frac{\\delta^{2}}{4}}-\\frac{\\delta}{2}\\frac{\\beta_{0}}{\\|\\beta_{0}\\|}}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 25}, {"type": "text", "text": "The most striking difference is in the expressions for the inductive bias. Azulay et al. [9] take an alternative route towards deriving the inductive bias by inverting $M$ in terms of the original parameters $a$ and $w$ and then simplifying $\\bar{M}^{-1}$ in terms of $\\beta$ , which results in quite a different expression for their inductive bias. However, they are actually functionally equivalent. It requires a bit of algebra, but one can show that ", "page_idx": 25}, {"type": "equation", "text": "$$\n\\Phi_{\\delta}(\\beta)=\\frac{2\\sqrt{2}}{3}q_{\\delta}(\\|\\beta\\|)+c_{\\delta}.\n$$", "text_format": "latex", "page_idx": 25}, {"type": "text", "text": "Another important distinction between our two theorems lies in the assumptions we make. Azulay et al. [9] consider only initializations such that $\\delta\\;\\geq\\;0$ and $\\beta_{0}~\\neq~0$ . We make a less restrictive assumption by considering initializations $\\beta_{0}$ such that $\\|\\beta(t)\\|>0$ for all $t\\geq0$ , which allows for both positive and negative $\\delta$ . Except for a measure zero set of initializations, all initializations considered by Azulay et al. [9] also satisfy our assumptions. In both cases, our assumptions ensure that $M$ is invertible for the entire trajectory from initialization to interpolating solution. However, it is worth considering whether the theorems would hold even when there exists a point on the trajectory where $M$ is low-rank. As discussed in Appendix A.3, this can only happen for an initialization with $\\delta<0$ and where the sign of $a$ changes. Only at the point where $a(t)\\stackrel{}{=}0$ does $M$ become low-rank. A similar challenge arose in this setting when deriving the exact solutions presented in Appendix A.2.4. We were able to circumvent the issue in part by introducing Lemma A.1 proving that this sign change could only happen at most once given any initialization. This lemma was based on the setting with whitened input, but a similar statement likely holds for the general setting. If this were the case, we could define $M$ at this unique point on the trajectory in terms of the limit of $M$ as it approached this point. This could potentially allow us to extend the time-warped mirror flow analysis to all initializations such that $\\|\\beta_{0}\\|>0$ . ", "page_idx": 25}, {"type": "text", "text": "A.4.4 Exact solution when interpolating manifold is one-dimensional ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "When the null space of $X^{\\intercal}X$ is one-dimensional, the constrained optimization problems in Theorem 3.1 and Theorem A.2 have an exact analytic solution. In this case we can parameterize all interpolating solutions $\\beta$ with a single scalar $\\alpha\\in\\mathbb{R}$ such that $\\beta=\\beta_{*}+\\alpha v$ where $X^{\\intercal}X v=0$ and $\\|v\\|=1$ . Using this description of $\\beta$ , we can then differentiate the inductive bias with respect to $\\alpha$ , set to zero, and solve for $\\alpha$ . We will use the following expressions, ", "page_idx": 25}, {"type": "equation", "text": "$$\n\\nabla_{\\boldsymbol{x}}\\boldsymbol{q}(\\boldsymbol{x})=\\frac{3}{2}\\mathrm{sign}(\\boldsymbol{x})\\sqrt{\\sqrt{x^{2}+\\frac{\\delta^{2}}{4}}-\\frac{\\delta}{2}},\\quad\\nabla_{\\alpha}\\|\\beta\\|=\\frac{\\alpha}{\\|\\beta\\|},\\quad\\nabla_{\\alpha}z^{\\mathsf{T}}\\beta=z^{\\mathsf{T}}\\boldsymbol{v}.\n$$", "text_format": "latex", "page_idx": 25}, {"type": "text", "text": "We will also use the expression, $\\|\\beta\\|^{2}=\\|\\beta_{*}\\|^{2}+\\alpha^{2}$ . Pulling these expressions together we get the following equation for $\\alpha$ , ", "page_idx": 25}, {"type": "equation", "text": "$$\n\\sqrt{\\sqrt{\\|\\beta_{*}\\|^{2}+\\alpha^{2}+\\frac{\\delta^{2}}{4}-\\frac{\\delta}{2}}}\\frac{\\alpha}{\\sqrt{\\|\\beta_{*}\\|^{2}+\\alpha^{2}}}=-\\frac{2z^{\\mathsf{T}}v}{3}.\n$$", "text_format": "latex", "page_idx": 25}, {"type": "text", "text": "If we let $\\begin{array}{r}{k=-\\frac{2z^{\\mathsf{T}}v}{3}}\\end{array}$ , the solution for $\\alpha$ is ", "page_idx": 25}, {"type": "equation", "text": "$$\n\\alpha=k\\sqrt{\\frac{k^{2}+\\delta}{2}+\\sqrt{\\left(\\frac{k^{2}+\\delta}{2}\\right)^{2}+\\|\\beta_{*}\\|^{2}}}.\n$$", "text_format": "latex", "page_idx": 25}, {"type": "text", "text": "This solution always works for the initializations we considered in Theorem 3.1. Interestingly, it appears that $\\beta=\\beta_{*}-\\alpha v$ also works for initializations not previously considered. This includes trajectories that pass through the origin, resulting in a change in the sign of $a$ . ", "page_idx": 25}, {"type": "text", "text": "B Wide and Deep Linear Networks ", "text_level": 1, "page_idx": 26}, {"type": "text", "text": "Here we discuss how our analysis techniques, developed in the previous section for a single-neuron linear network, can be extended to linear networks with multiple neurons, outputs, and layers. ", "page_idx": 26}, {"type": "text", "text": "B.1 Wide linear networks ", "text_level": 1, "page_idx": 26}, {"type": "text", "text": "We consider the dynamics of a two-layer linear network with $h$ hidden neurons and $c$ outputs, $f(x;\\theta)\\,=\\,A^{\\top}W x$ , where $W\\,\\in\\,\\mathbb{R}^{h\\times d}$ and $A\\in\\mathbb{R}^{h\\times c}$ . We assume that $h\\geq\\operatorname*{min}(d,c)$ , such that this parameterization can represent all linear maps from $\\mathbb{R}^{d}\\rightarrow\\mathbb{R}^{c}$ . As in the single-neuron setting, the rescaling symmetry in this model between the first and second layer implies the $h\\times h$ matrix $\\Delta=A_{0}A_{0}^{\\sf T}-\\dot{W}_{0}W_{0}^{\\sf T}$ determined at initialization remains conserved throughout gradient flow [62]. This can be easily shown from the temporal dynamics of $A$ and $W$ , ", "page_idx": 26}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\dot{A}=-\\eta_{a}W X^{\\intercal}(X\\beta-Y),}\\\\ {\\dot{W}^{\\intercal}=-\\eta_{w}X^{\\intercal}(X\\beta-Y)A^{\\intercal}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 26}, {"type": "text", "text": "Extending derivations in [30], the NTK matrix can be expressed as ", "page_idx": 26}, {"type": "equation", "text": "$$\nK=\\left(\\mathbf{I}_{c}\\otimes X\\right)\\left(\\eta_{w}A^{\\mathsf{T}}A\\oplus\\eta_{a}W^{\\mathsf{T}}W\\right)\\left(\\mathbf{I}_{c}\\otimes X^{\\mathsf{T}}\\right),\n$$", "text_format": "latex", "page_idx": 26}, {"type": "text", "text": "where $\\otimes$ and $\\oplus$ denote the Kronecker product and sum respectively. The Kronecker sum is defined for square matrices $C\\in\\mathbb{R}^{c\\times c}$ and $D\\in\\mathbb{R}^{d\\times d}$ as $C\\oplus D=C\\otimes\\mathbf{I}_{d}+\\mathbf{I}_{c}\\otimes D$ . ", "page_idx": 26}, {"type": "text", "text": "B.1.1 Parameter space dynamics ", "text_level": 1, "page_idx": 26}, {"type": "text", "text": "Inspired by our analysis of the single-neuron setting, we introduce two coordinate transformations to study the parameter space dynamics of a wide two-layer linear network. In both analyses we assume whitened input $X^{\\top}X=\\mathbf{I}_{d}$ and let $\\eta_{a}\\,=\\,\\eta_{w}\\,=\\,1$ . However, we will find that the analysis of the dynamics in function space, for general unwhitened data, is more tractable. ", "page_idx": 26}, {"type": "text", "text": "Parameter dynamics when $c=1$ . Drawing insights from our analysis of the single-neuron scenario $h=c=1$ ), we might consider a combination of hyperbolic and spherical coordinate transformations to study the parameter space dynamics of a wide two-layer linear network. We consider the following two quantities for each hidden neuron $k\\in[h]$ : ", "page_idx": 26}, {"type": "equation", "text": "$$\n\\mu_{k}=a_{k}\\|w_{k}\\|,\\qquad\\phi_{k}=\\frac{w_{k}^{\\mathsf{T}}\\beta_{*}}{\\|w_{k}\\|\\|\\beta_{*}\\|}.\n$$", "text_format": "latex", "page_idx": 26}, {"type": "text", "text": "We will also consider a new matrix quantity $Q\\,\\in\\,\\mathbb{R}^{h\\times h}$ with elements $\\begin{array}{r}{Q_{k k^{\\prime}}\\,=\\,\\frac{w_{k}^{\\sf T}w_{k^{\\prime}}}{\\|w_{k}\\|\\|w_{k^{\\prime}}\\|}}\\end{array}$ \u2225wkk\u2225\u2225wkk\u2032\u2225. The resulting dynamics for $\\mu$ and $\\phi$ can be entirely written in terms $\\mu,\\phi,\\Delta$ : ", "page_idx": 26}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\dot{\\mu}=\\sqrt{\\mathrm{Diag}(\\Delta)^{2}+4\\mathrm{Diag}(\\mu)^{2}}\\left(\\phi-Q\\mu\\right),}\\\\ &{\\dot{\\phi}=M\\mathrm{Diag}(\\mu)\\left((\\|\\beta_{*}\\|^{2}-\\phi^{\\top}\\mu)I_{h}+\\mathrm{Diag}(\\phi)Q\\mu-\\phi^{2}\\right),}\\end{array}\n$$", "text_format": "latex", "page_idx": 26}, {"type": "text", "text": "where $M=2\\left(\\sqrt{\\mathrm{Diag}(\\Delta)^{2}+4\\mathrm{Diag}(\\mu)^{2}}-\\mathrm{Diag}(\\Delta)\\right)^{-1}$ . Using the conserved structure of $\\Delta$ we can express $Q$ as a function of $\\mu$ and $M$ , ", "page_idx": 26}, {"type": "equation", "text": "$$\nQ=M\\mu\\mu^{\\top}M-M^{1/2}\\Delta M^{1/2}.\n$$", "text_format": "latex", "page_idx": 26}, {"type": "text", "text": "This approach yields a coupled nonlinear dynamical system with $2h$ variables. Imposing additional assumptions on the initialization, such as permutation invariance between hidden neurons, can simplify the system of differential equations. A similar approach was used by Saad and Solla [78] to derive a set of differential equations for a soft committee machine model, capturing its online learning dynamics in a teacher-student setup, which Goldt et al. [79] extended to its generalization error dynamics. ", "page_idx": 26}, {"type": "text", "text": "Parameter dynamics when $c\\,=\\,h$ . In this analysis we assume an initialization such that the conserved quantities $\\Delta=\\delta\\mathbf{I}_{h}$ , an assumption we will discuss further in Appendix B.1.6, and that $A$ is invertible throughout training. Let $\\beta_{*}=X^{\\intercal}Y$ , which for whitened input, is the unique minimum of the dynamics in function space. We consider the variable $\\nu=A^{-1}W\\dot{\\beta}_{\\ast}\\in\\mathbb{R}^{c\\times c}$ . Using the identity that $A^{\\dot{-}1}=-A^{-1}\\dot{A}A^{-1}$ and our assumption on $\\Delta$ , we find that the matrix $\\nu$ evolves according to the matrix Riccati ODE, ", "page_idx": 26}, {"type": "text", "text": "", "page_idx": 27}, {"type": "equation", "text": "$$\n\\dot{\\nu}=\\beta_{*}^{\\mathsf{T}}\\beta_{*}-\\delta\\nu-\\nu^{2}.\n$$", "text_format": "latex", "page_idx": 27}, {"type": "text", "text": "Additionally, consider the variable $C=A^{\\mathsf{T}}A$ , which evolves according to the matrix Bernoulli ODE ", "page_idx": 27}, {"type": "equation", "text": "$$\n\\dot{C}=C(\\nu+\\delta\\mathbf{I}_{h})+(\\nu+\\delta\\mathbf{I}_{h})^{\\top}C-2C^{2}.\n$$", "text_format": "latex", "page_idx": 27}, {"type": "text", "text": "Taken together we have found a change of variables, analogous to the one introduced in Appendix A.2.3 for the single-neuron setting, that evolves according to a matrix Riccati and Bernoulli equation, ", "page_idx": 27}, {"type": "equation", "text": "$$\n\\begin{array}{r l r l}&{\\dot{\\boldsymbol{\\nu}}=\\beta_{*}^{\\intercal}\\beta_{*}-\\delta\\boldsymbol{\\nu}-\\boldsymbol{\\nu}^{2},}&&{\\qquad\\qquad\\nu(0)=A_{0}^{-1}W_{0}\\beta_{*},}\\\\ &{\\dot{\\boldsymbol{C}}=\\boldsymbol{C}(\\boldsymbol{\\nu}+\\delta\\mathbf{I}_{h})+(\\boldsymbol{\\nu}+\\delta\\mathbf{I}_{h})^{\\intercal}\\boldsymbol{C}-2\\boldsymbol{C}^{2},}&&{\\qquad\\qquad C(0)=A_{0}^{\\intercal}A_{0}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 27}, {"type": "text", "text": "However, solving this system exactly as we did in the single-neuron setting is challenging. Unless we assume that $\\nu$ and $\\beta_{*}^{\\mathsf{T}}\\,\\beta_{*}^{\\mathsf{\\bar{\\alpha}}}$ share the same eigenspace \u2013 allowing us to decouple the dynamics of $\\nu$ into a set of scalar Riccati equations \u2013 the system cannot be easily solved. Instead, we will find that the dynamics of the product $W^{\\intercal}A$ in function space is more tractable and requires fewer assumptions. ", "page_idx": 27}, {"type": "text", "text": "B.1.2 Function space dynamics ", "text_level": 1, "page_idx": 27}, {"type": "text", "text": "We consider the dynamics of $\\beta=W^{\\intercal}A\\in\\mathbb{R}^{d\\times c}$ in function space, which is governed by the ODE, ", "page_idx": 27}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\dot{\\beta}=W^{\\intercal}\\dot{A}+\\dot{W}^{\\intercal}A=-\\left(\\eta_{w}X^{\\intercal}(X\\beta-Y)A^{\\intercal}A+\\eta_{a}W^{\\intercal}W X^{\\intercal}(X\\beta-Y)\\right).}\\end{array}\n$$", "text_format": "latex", "page_idx": 27}, {"type": "text", "text": "Vectorizing using the identity $\\operatorname{vec}(A B C)=(C\\mathsf{\\mathsf{T}}\\otimes A)\\mathrm{vec}(B)$ equation 85 becomes ", "page_idx": 27}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathrm{vec}\\left(\\dot{\\beta}\\right)=-\\mathrm{vec}\\left(\\eta_{w}{\\bf I}_{d}X^{\\top}(X\\beta-Y)A^{\\top}A+\\eta_{a}W^{\\top}W X^{\\top}(X\\beta-Y){\\bf I}_{c}\\right),}\\\\ &{\\qquad\\qquad=-(\\eta_{w}A^{\\top}A\\otimes{\\bf I}_{d}+\\eta_{a}{\\bf I}_{c}\\otimes W^{\\top}W)\\mathrm{vec}(X^{\\top}X\\beta-X^{\\top}Y),}\\\\ &{\\qquad\\qquad=-\\underbrace{\\left(\\eta_{w}A^{\\top}A\\oplus\\eta_{a}W^{\\top}W\\right)}_{M}\\mathrm{vec}(X^{\\top}X\\beta-X^{\\top}Y).}\\end{array}\n$$", "text_format": "latex", "page_idx": 27}, {"type": "text", "text": "As in the single-neuron setting, we find that the dynamics of $\\beta$ can be expressed as gradient flow preconditioned by a matrix $M$ that depends on quadratics of $A$ and $W$ . ", "page_idx": 27}, {"type": "text", "text": "B.1.3 Proving Theorem 4.1 ", "text_level": 1, "page_idx": 27}, {"type": "text", "text": "We first prove Theorem 4.1. Consider a single hidden neuron $k\\,\\in\\,[h]$ of the multi-output model defined by the parameters $w_{k}\\in\\mathbb{R}^{d}$ and $a_{k}\\in\\mathbb{R}^{c}$ . Let $\\beta_{k}=w_{k}a_{k}^{\\top}$ be the $\\mathbb{R}^{d\\times c}$ matrix representing the contribution of this hidden neuron to the input-output map of the network $\\begin{array}{r}{\\beta=\\sum_{k=1}^{h}\\beta_{k}}\\end{array}$ . Consider the two gram matrices $\\beta_{k}^{\\mathsf{T}}\\beta_{k}\\in\\mathbb{R}^{c\\times c}$ and $\\beta_{k}\\beta_{k}^{\\mathsf{T}}\\in\\mathbb{R}^{d\\times d}$ , ", "page_idx": 27}, {"type": "equation", "text": "$$\n\\beta_{k}^{\\mathsf{T}}\\beta_{k}=\\|w_{k}\\|^{2}a_{k}a_{k}^{\\mathsf{T}},\\qquad\\beta_{k}\\beta_{k}^{\\mathsf{T}}=\\|a_{k}\\|^{2}w_{k}w_{k}^{\\mathsf{T}}.\n$$", "text_format": "latex", "page_idx": 27}, {"type": "text", "text": "Notice that we can express $\\|\\beta_{k}\\|_{F}^{2}$ as ", "page_idx": 27}, {"type": "equation", "text": "$$\n\\|\\beta_{k}\\|_{F}^{2}=\\mathrm{{Tr}}(\\beta_{k}^{\\sf T}\\beta_{k})=\\mathrm{{Tr}}(\\beta_{k}\\beta_{k}^{\\sf T})=\\|a_{k}\\|^{2}\\|w_{k}\\|^{2}\n$$", "text_format": "latex", "page_idx": 27}, {"type": "text", "text": "At each hidden neuron we have the conserved quantity8 $\\eta_{w}\\|a_{k}\\|^{2}-\\eta_{a}\\|w_{k}\\|^{2}=\\delta_{k}$ where $\\delta_{k}\\in\\mathbb{R}$ Using this quantity we can invert the expression for $\\|\\beta_{k}\\|_{F}^{2}$ to get ", "page_idx": 27}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\|a_{k}\\|^{2}=\\frac{\\sqrt{\\delta_{k}^{2}+4\\eta_{a}\\eta_{w}\\|\\beta_{k}\\|_{F}^{2}}+\\delta_{k}}{2\\eta_{w}},}\\\\ &{\\|w_{k}\\|^{2}=\\frac{\\sqrt{\\delta_{k}^{2}+4\\eta_{a}\\eta_{w}\\|\\beta_{k}\\|_{F}^{2}}-\\delta_{k}}{2\\eta_{a}}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 27}, {"type": "text", "text": "When $\\|\\beta_{k}\\|_{F}^{2}>0$ , we can use these expressions to solve for the outer products $a_{k}a_{k}^{\\mathsf{T}}$ and $w_{k}w_{k}^{\\mathsf{T}}$ in terms of $\\beta_{k}$ and $\\delta_{k}$ , ", "page_idx": 28}, {"type": "equation", "text": "$$\n\\begin{array}{r}{a_{k}a_{k}^{\\sf T}=\\frac{\\sqrt{\\delta_{k}^{2}+4\\eta_{a}\\eta_{w}\\|\\beta_{k}\\|_{F}^{2}}+\\delta_{k}}{2\\eta_{w}}\\frac{\\beta_{k}^{\\sf T}\\beta_{k}}{\\|\\beta_{k}\\|_{F}^{2}},}\\\\ {w_{k}w_{k}^{\\sf T}=\\frac{\\sqrt{\\delta_{k}^{2}+4\\eta_{a}\\eta_{w}\\|\\beta_{k}\\|_{F}^{2}}-\\delta_{k}}{2\\eta_{a}}\\frac{\\beta_{k}\\beta_{k}^{\\sf T}}{\\|\\beta_{k}\\|_{F}^{2}}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 28}, {"type": "text", "text": "By substituting these expressions into the decompositions $\\begin{array}{r}{A^{\\boldsymbol{\\mathsf{T}}}A\\;=\\;\\sum_{k=1}^{h}a_{k}a_{k}^{\\boldsymbol{\\mathsf{T}}}}\\end{array}$ and $W^{\\top}W\\ =$ $\\scriptstyle\\sum_{k=1}^{h}w_{k}w_{k}^{\\mathsf{T}}$ , we derive the representation for $M$ presented in Theorem 4.1: $\\begin{array}{r}{M=\\sum_{k=1}^{h}M_{k}}\\end{array}$ where ", "page_idx": 28}, {"type": "equation", "text": "$$\nM_{k}=\\left(\\frac{\\sqrt{\\delta_{k}^{2}+4\\eta_{a}\\eta_{w}\\|\\beta_{k}\\|_{F}^{2}}+\\delta_{k}}{2}\\right)\\frac{\\beta_{k}^{\\top}\\beta_{k}}{\\|\\beta_{k}\\|_{F}^{2}}\\oplus\\left(\\frac{\\sqrt{\\delta_{k}^{2}+4\\eta_{a}\\eta_{w}\\|\\beta_{k}\\|_{F}^{2}}-\\delta_{k}}{2}\\right)\\frac{\\beta_{k}\\beta_{k}^{\\top}}{\\|\\beta_{k}\\|_{F}^{2}}.\n$$", "text_format": "latex", "page_idx": 28}, {"type": "text", "text": "B.1.4 Understanding $M$ when there is a single-neuron $h=1$ ", "text_level": 1, "page_idx": 28}, {"type": "text", "text": "When there is a single-hidden neuron $h\\,=\\,\\operatorname*{min}(d,c)\\,=\\,1$ , the expression for $M$ presented in Theorem 4.1 simplifies allowing us to precisely understand the influence of $\\delta$ on the learning regime. When $h=c=1$ , then $\\begin{array}{r}{\\frac{\\beta^{\\boldsymbol{\\mathsf{T}}}\\beta}{\\|\\beta\\|_{F}^{2}}=1}\\end{array}$ . Therefore, Eq. (7) simplifies to ", "page_idx": 28}, {"type": "equation", "text": "$$\nM=\\frac{\\sqrt{\\delta^{2}+\\eta_{a}\\eta_{w}4\\|\\beta\\|^{2}}+\\delta}{2}\\mathbf{I}_{d}+\\frac{\\sqrt{\\delta^{2}+\\eta_{a}\\eta_{w}4\\|\\beta\\|^{2}}-\\delta}{2}\\frac{\\beta\\beta^{\\mathsf{T}}}{\\|\\beta\\|^{2}},\n$$", "text_format": "latex", "page_idx": 28}, {"type": "text", "text": "and we recover Eq. (4) presented in Section 3. When $h=d=1$ , then $\\begin{array}{r}{\\frac{\\beta\\beta^{\\mathsf{T}}}{\\|\\beta\\|_{F}^{2}}=1}\\end{array}$ and thus Eq. (7) simplifies to, ", "page_idx": 28}, {"type": "equation", "text": "$$\nM=\\frac{\\sqrt{\\delta^{2}+\\eta_{a}\\eta_{w}4\\|\\beta\\|^{2}}+\\delta}{2}\\frac{\\beta^{\\mathsf{T}}\\beta}{\\|\\beta\\|^{2}}+\\frac{\\sqrt{\\delta^{2}+\\eta_{a}\\eta_{w}4\\|\\beta\\|^{2}}-\\delta}{2}\\mathbf{I}_{c}.\n$$", "text_format": "latex", "page_idx": 28}, {"type": "text", "text": "In both settings, $M$ is the weighted sum of the identity matrix and a rank-one projection matrix. While these equations are strikingly similar there is an interesting distinction that arises in the limits of $\\delta$ . As $\\delta\\rightarrow\\infty$ , then the first expression for $M$ becomes proportional to $\\mathbf{I}_{d}$ , while the second expression for $M$ becomes proportional to the rank-1 projection $\\frac{\\beta^{\\boldsymbol{\\mathsf{T}}}{\\boldsymbol{\\beta}}}{\\|\\beta\\|^{2}}$ . Conversely, as $\\delta\\rightarrow-\\infty$ then the first expression for $M$ becomes proportional to the rank-1 projection \u2225\u03b2\u03b2\u03b2\u2225\u22ba2 , while the second expression for $M$ becomes proportional to ${{\\mathbf{I}}_{c}}$ . When $h=d=c=1$ , then $M=\\sqrt{\\delta^{2}+\\eta_{a}\\eta_{w}4\\|\\beta\\|^{2}}$ and thus in both limits of $\\delta\\rightarrow\\pm\\infty$ , $M$ becomes a constant independent of $\\beta$ . In all settings, when $\\delta=0$ , $M$ depends on $\\beta$ . In other words, the influence of $\\delta$ on whether the dynamics are lazy, rich, or delayed rich, crucially depends on the relative sizes of dimensions $d,h$ , and $c$ . ", "page_idx": 28}, {"type": "text", "text": "B.1.5 Interpreting $M$ in different limits and architectures ", "text_level": 1, "page_idx": 28}, {"type": "text", "text": "We now seek to more generally understand the influence of the conserved quantities $\\delta_{i}$ and the relative sizes of dimensions $d,h$ and $c$ on the learning regime. For a matrix $\\boldsymbol{A}\\in\\mathbb{R}^{d\\times c}$ , let $\\operatorname{Row}(A)\\subseteq\\mathbb{R}^{c}$ and $\\mathrm{Col}(A)\\subseteq\\mathbb{R}^{d}$ denote the row and column space of $A$ respectively. ", "page_idx": 28}, {"type": "text", "text": "Theorem B.1. The dynamics are in the lazy regime, for all $t\\geq0$ , i $f\\delta_{k}\\rightarrow\\infty$ for all $k\\in[h]$ and there exists a least squares solution $\\beta_{\\ast}\\in\\mathbb{R}^{d\\times c}$ such that ", "page_idx": 28}, {"type": "equation", "text": "$$\n\\operatorname{Row}(\\beta_{*})\\subseteq\\operatorname{Span}\\left(\\bigcup_{k=1}^{h}\\operatorname{Row}\\left(\\beta_{k}(0)\\right)\\right),\n$$", "text_format": "latex", "page_idx": 28}, {"type": "text", "text": "or $\\delta_{k}\\to-\\infty$ for all $k\\in[h]$ and there exists a solution such that ", "page_idx": 28}, {"type": "equation", "text": "$$\n\\operatorname{Col}(\\beta_{*})\\subseteq\\operatorname{Span}\\left(\\bigcup_{k=1}^{h}\\operatorname{Col}\\left(\\beta_{k}(0)\\right)\\right).\n$$", "text_format": "latex", "page_idx": 28}, {"type": "text", "text": "Proof. As $\\delta_{k}\\to\\infty$ $\\begin{array}{r}{M_{k}\\rightarrow|\\delta_{k}|\\frac{\\beta_{k}^{\\dagger}\\beta_{k}}{\\|\\beta_{k}\\|_{F}^{2}}\\!\\otimes\\!\\mathbf{I}_{d}}\\end{array}$ , implying $\\begin{array}{r}{\\dot{\\beta_{k}}=-|\\delta_{k}|\\frac{\\partial\\mathcal{L}}{\\partial\\beta}\\left(\\frac{\\beta_{k}^{\\mathsf{T}}\\beta_{k}}{\\|\\beta_{k}\\|_{F}^{2}}\\right)}\\end{array}$ . Notice that \u03b2k\u22ba \u03b2k2 is the unique orthogonal projection matrix onto the one-dimensional row space of $\\beta_{k}$ . Thus, the dynamics of each $\\beta_{k}$ follow a projected gradient descent in their row space. As a result, $M_{k}$ will not change and thus the NTK will be static. By assumption there exists a least squares solution $\\beta_{*}$ such that the rows of $\\beta_{*}$ are in the span of the rows of $\\beta_{k}$ . Thus, a solution will be reached as $t\\to\\infty$ , while the $M_{k}$ remain static. ", "page_idx": 29}, {"type": "text", "text": "Note that the assumptions in Theorem B.1 can be more intuitively expressed in terms of the parameter space $(W,A)$ . Except in highly degenerate cases, the assumption $\\begin{array}{r l}{\\mathrm{Row}(\\beta_{*})}&{{}\\subseteq}\\end{array}$ $\\operatorname{Span}\\left(\\bigcup_{k=1}^{h}\\operatorname{Row}\\left(\\beta_{k}(0)\\right)\\right)$ is equivalent to the existence of a $\\beta_{*}$ whose rows lie in the span of $\\{a_{k}(0)\\}_{k=1}^{h}$ , or, equivalently, to the existence of a matrix $W$ such that $\\beta_{*}\\,={W}^{\\intercal}A(0)$ . Similarly, the condition $\\begin{array}{r}{\\operatorname{Col}(\\beta_{*})\\subseteq\\operatorname{Span}\\left(\\bigcup_{k=1}^{h}\\operatorname{Col}\\left(\\beta_{k}(0)\\right)\\right)}\\end{array}$ is in most cases equivalent to the existence of a matrix $A$ such that $\\beta_{*}=W(0)^{\\top}A$ . ", "page_idx": 29}, {"type": "text", "text": "A direct consequence of Theorem B.1 is that networks which narrow from input to output $[d>c)$ must enter the lazy regime with probability 1 as all $\\delta_{k}\\to\\infty$ whenever $h\\geq c$ and assuming independent initializations for all $\\beta_{k}$ . In this case, the rows of $\\{\\beta_{1},\\ldots,\\beta_{h}\\}$ span all of $\\mathbb{R}^{c}$ and thus the condition on the least squares solution is trivially true. By the same logic, networks which expand from input to output $(d<c)$ do so as all $\\delta_{k}\\to-\\infty$ whenever $h\\geq d$ and assuming independent initializations for all $\\beta_{k}$ . Additionally, when $h\\geq\\operatorname*{max}(d,c)$ and assuming independent initializations for all $\\beta_{k}$ , then all networks enter the lazy regime as either all $\\delta_{k}\\to\\infty$ or all $\\delta_{k}\\to-\\infty$ . ", "page_idx": 29}, {"type": "text", "text": "Another interesting implication of Theorem B.1, is that if there does not exist a least squares solution $\\beta_{*}$ with rows in the span of the rows of $\\{\\beta_{1},\\ldots,\\beta_{h}\\}$ , then the network will enter a delayed rich regime as all $\\delta_{k}\\to\\infty$ , where the magnitude of the $\\delta_{k}$ will determine the delay. In this setting, the network is initially lazy, attempting to fit the solution within the row space of the $\\beta_{k}$ , but eventually the direction of the rows must change in order to fit the problem, leading to a rich phase. A similar statement involving the columns of $\\beta_{*}$ is true as all $\\delta_{k}\\to-\\infty$ . ", "page_idx": 29}, {"type": "text", "text": "B.1.6 Simplifying $M$ through assumptions on $\\Delta$ ", "text_level": 1, "page_idx": 29}, {"type": "text", "text": "We now consider how introducing structures on $\\Delta$ can lead to simpler expressions for $M$ . A natural assumption to consider is the following: ", "page_idx": 29}, {"type": "text", "text": "Assumption B.2 (Isotropic initialization). Let $A\\in\\mathbb{R}^{h\\times c}$ and $W\\in\\mathbb{R}^{h\\times d}$ be initialized such that $\\Delta=\\eta_{w}\\bar{A}(0)A(0)^{\\sf T}-\\eta_{a}\\bar{W}(0)W(0)^{\\sf T}=\\delta{\\bf I}_{h}$ . ", "page_idx": 29}, {"type": "text", "text": "In square networks, where the dimensions of the input, hidden, and output layers coincide ${\\vec{d}}=h=c)$ ), and the weights are initialized as $A\\sim\\mathcal{N}(0,\\sigma_{a}^{2}/c)$ and $W\\sim\\mathcal{N}(0,\\sigma_{w}^{2}\\big/d)$ , this assumption is naturally satisfied with $\\delta=\\sigma_{a}^{2}-\\sigma_{w}^{2}$ as the dimension $h\\to\\infty$ . However, a limitation of this assumption is that for general $\\delta$ it requires $h\\leq\\operatorname*{min}(d,c)$ . Specifically, when $\\delta>0$ , the isotropic initialization requires that $A(0)A(0)^{\\top}\\succ0$ , which implies $h\\leq c$ . Similarly, when $\\delta<0$ , the isotropic initialization requires that $W(0)W(0)\\Upsilon\\succ0$ , which implies $h\\leq d$ . Now we prove two important implications of the isotropic initialization assumption. ", "page_idx": 29}, {"type": "text", "text": "Lemma B.3. Let $\\Delta=\\delta\\mathbf{I}_{h}$ . If either $\\delta\\geq0$ or $\\delta<0$ and $h\\geq d$ , we have that ", "page_idx": 29}, {"type": "equation", "text": "$$\nW^{\\top}W=\\frac{1}{\\eta_{a}}\\left(-\\frac{\\delta}{2}\\mathbf{I}_{d}+\\sqrt{\\eta_{a}\\eta_{w}\\beta\\beta^{\\top}+\\frac{\\delta^{2}}{4}\\mathbf{I}_{d}}\\right).\n$$", "text_format": "latex", "page_idx": 29}, {"type": "text", "text": "Proof. The quantity $\\eta_{w}A A^{\\intercal}-\\eta_{a}W W^{\\intercal}=\\delta\\mathbf{I}_{h}$ is conserved in gradient flow. Multiplying on the left by $W^{\\boldsymbol{\\mathsf{T}}}$ and on the right by $W$ we have that ", "page_idx": 29}, {"type": "equation", "text": "$$\n\\eta_{a}(W^{\\boldsymbol{\\mathsf{T}}}W)^{2}+\\delta W^{\\boldsymbol{\\mathsf{T}}}W=\\eta_{w}\\beta\\beta^{\\boldsymbol{\\mathsf{T}}}.\n$$", "text_format": "latex", "page_idx": 29}, {"type": "text", "text": "Completing the square by adding4\u03b4\u03b7a I to both sides and dividing by $\\eta_{a}$ we get the equality, ", "page_idx": 29}, {"type": "equation", "text": "$$\n\\left(W^{\\top}W+\\frac{\\delta}{2\\eta_{a}}\\mathbf{I}_{d}\\right)^{2}=\\frac{\\delta^{2}}{4\\eta_{a}^{2}}\\mathbf{I}_{d}+\\frac{\\eta_{w}}{\\eta_{a}}\\beta\\beta^{\\top}\n$$", "text_format": "latex", "page_idx": 29}, {"type": "text", "text": "For $\\delta~\\geq~0$ , $\\begin{array}{r}{W\\Upsilon W+\\frac{\\delta}{2\\eta_{a}}\\mathbf{I}_{d}\\;\\succeq\\;0}\\end{array}$ . For $\\delta\\mathrm{~<~0~}$ , then we know from the conserved quantity that $\\begin{array}{r}{W W^{\\intercal}+\\frac{\\delta}{2\\eta_{a}}\\mathbf{I}_{h}=\\frac{\\eta_{w}}{\\eta_{a}}A\\dot{A}^{\\intercal}-\\frac{\\delta}{2\\eta_{a}}\\mathbf{I}_{h}\\succ0}\\end{array}$ , which implies when $h\\geq d$ that $\\begin{array}{r}{W^{\\top}W+\\frac{\\delta}{2\\eta_{a}}\\mathbf{I}_{d}\\succ0}\\end{array}$ . As a result, we can take the principal square root of each side, ", "page_idx": 30}, {"type": "equation", "text": "$$\nW^{\\boldsymbol{\\mathsf{T}}}W+\\frac{\\delta}{2\\eta_{a}}\\mathbf{I}_{d}=\\sqrt{\\frac{\\delta^{2}}{4\\eta_{a}^{2}}\\mathbf{I}_{d}+\\frac{\\eta_{w}}{\\eta_{a}}\\beta\\beta^{\\mathsf{T}}},\n$$", "text_format": "latex", "page_idx": 30}, {"type": "text", "text": "which rearranged gives the final result. ", "page_idx": 30}, {"type": "text", "text": "Lemma B.4. Let $\\Delta=\\delta\\mathbf{I}_{h}$ . If either $\\delta\\leq0$ or $\\delta>0$ and $h\\geq c,$ , we have that ", "page_idx": 30}, {"type": "equation", "text": "$$\nA^{\\top}A=\\frac{1}{\\eta_{w}}\\left(\\frac{\\delta}{2}\\mathbf{I}_{c}+\\sqrt{\\eta_{a}\\eta_{w}\\beta^{\\top}\\beta+\\frac{\\delta^{2}}{4}\\mathbf{I}_{c}}\\right).\n$$", "text_format": "latex", "page_idx": 30}, {"type": "text", "text": "Proof. The proof is analogous to the proof of Lemma B.3. ", "page_idx": 30}, {"type": "text", "text": "From Lemma B.3 and Lemma B.4 we can prove Theorem 4.2, as shown below. ", "page_idx": 30}, {"type": "text", "text": "Proof. We start from ", "page_idx": 30}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\mathrm{vec}\\left(\\dot{\\beta}\\right)=-\\underbrace{\\left(\\eta_{w}A^{\\top}A\\oplus\\eta_{a}W^{\\top}W\\right)}_{M}\\mathrm{vec}(X^{\\top}X\\beta-X^{\\top}Y),}\\end{array}\n$$", "text_format": "latex", "page_idx": 30}, {"type": "text", "text": "Plugging in expressions for $W\\boldsymbol{\\top}W$ from Lemma B.3 and $A^{\\intercal}A$ from Lemma B.4 we can directly write, ", "page_idx": 30}, {"type": "equation", "text": "$$\n\\begin{array}{l}{{\\displaystyle M=\\left(\\frac{\\delta}{2}{\\bf I}_{c}+\\sqrt{\\eta_{a}\\eta_{w}\\beta{\\sf I}\\times\\frac{\\delta^{2}}{4}{\\bf I}_{c}}\\right)\\oplus\\left(-\\frac{\\delta}{2}{\\bf I}_{d}+\\sqrt{\\eta_{a}\\eta_{w}\\beta\\beta{\\sf I}+\\frac{\\delta^{2}}{4}{\\bf I}_{d}}\\right)}\\ ~}\\\\ {{\\displaystyle~~=\\left(\\sqrt{\\eta_{a}\\eta_{w}\\beta{\\sf I}\\times\\frac{\\delta^{2}}{4}{\\bf I}_{c}}\\otimes{\\bf I}_{d}\\right)+\\left({\\bf I}_{c}\\otimes\\sqrt{\\eta_{a}\\eta_{w}\\beta\\beta{\\sf I}\\times\\frac{\\delta^{2}}{4}{\\bf I}_{d}}\\right)}\\ ~}\\end{array}\n$$", "text_format": "latex", "page_idx": 30}, {"type": "text", "text": "From this expression for $M(\\beta)$ we can easily consider how it simplifies in limiting settings of $\\delta$ : ", "page_idx": 30}, {"type": "equation", "text": "$$\nM\\rightarrow\\left\\{\\!\\!\\begin{array}{l l}{\\delta\\mathbf{I}_{d c}}&{\\delta\\rightarrow-\\infty}\\\\ {\\sqrt{\\eta_{a}\\eta_{w}\\beta\\bar{\\mathbf{\\Delta}}\\beta}\\otimes\\mathbf{I}_{d}+\\mathbf{I}_{c}\\otimes\\sqrt{\\eta_{a}\\eta_{w}\\beta\\beta^{\\mathsf{T}}}}&{\\delta=0}\\\\ {\\delta\\mathbf{I}_{d c}}&{\\delta\\rightarrow\\infty.}\\end{array}\\right.\n$$", "text_format": "latex", "page_idx": 30}, {"type": "text", "text": "As $\\delta\\rightarrow\\pm\\infty$ , $M\\to\\delta\\mathbf{I}_{d c}$ , and the dynamics are lazy. In this limit, the dynamics of $\\beta$ converge to the trajectory of linear regression traine\u221ad by gradient flow and alo\u221ang this trajectory the NTK matrix remains constant. When $\\delta=0$ , $M=\\sqrt{\\eta_{a}\\eta_{w}\\beta\\bar{\\mathbf{r}}\\beta}\\otimes\\mathbf{I}_{d}+\\mathbf{I}_{c}\\otimes\\sqrt{\\bar{\\eta}_{a}\\eta_{w}\\beta\\beta\\bar{\\mathbf{r}}}$ , and the dynamics are rich. Here the NTK changes in both magnitude and direction through training. In the next section we will attempt to better understand these dynamics for intermediate values of $\\delta$ through the lens of a mirror flow. ", "page_idx": 30}, {"type": "text", "text": "B.1.7 Deriving a mirror flow for the singular values of $\\beta$ ", "text_level": 1, "page_idx": 30}, {"type": "text", "text": "For a matrix $\\beta$ , the dynamics of one of its singular values are given by $\\dot{\\boldsymbol{\\sigma}}={\\boldsymbol{u}}^{\\intercal}\\dot{\\boldsymbol{\\beta}}{\\boldsymbol{v}}$ , where $u$ and $v$ are the corresponding left and right singular vectors. This equality can be derived from chain rule and the fact that $\\|u\\|=\\|v\\|=1$ : ", "page_idx": 30}, {"type": "equation", "text": "$$\n\\dot{\\boldsymbol{\\sigma}}=\\dot{\\boldsymbol{u}}^{\\intercal}\\boldsymbol{\\beta}\\boldsymbol{v}+\\boldsymbol{u}^{\\intercal}\\dot{\\boldsymbol{\\beta}}\\boldsymbol{v}+\\boldsymbol{u}^{\\intercal}\\boldsymbol{\\beta}\\dot{\\boldsymbol{v}}=\\dot{\\boldsymbol{u}}^{\\intercal}\\boldsymbol{u}\\boldsymbol{\\sigma}+\\boldsymbol{u}^{\\intercal}\\dot{\\boldsymbol{\\beta}}\\boldsymbol{v}+\\boldsymbol{\\sigma}\\boldsymbol{v}^{\\intercal}\\dot{\\boldsymbol{v}}=\\boldsymbol{u}^{\\intercal}\\dot{\\boldsymbol{\\beta}}\\boldsymbol{v}.\n$$", "text_format": "latex", "page_idx": 30}, {"type": "text", "text": "In the last equality we used that fact that for any vector $z$ with a fixed norm, $\\|\\dot{z}\\|^{2}\\,=\\,2\\dot{z}^{\\mathsf{T}}z\\,=\\,0$ . Letting $\\mathrm{diag}:\\mathbb{R}^{d\\times c}\\rightarrow\\mathbb{R}^{\\mathrm{min}(d,c)}$ be the operator that, given a rectangular matrix, returns a vector of the elements on the main diagonal, we can then write, ", "page_idx": 30}, {"type": "equation", "text": "$$\n\\dot{\\lambda}=\\mathrm{diag}(U^{\\intercal}\\dot{\\beta}V)\n$$", "text_format": "latex", "page_idx": 30}, {"type": "text", "text": "where $\\lambda\\in\\mathbb{R}^{\\operatorname*{min}(d,c)}$ is the vector of singular values of $\\beta$ . In the following lemma, we use the shared singular vector structure between $\\beta$ and $A$ and $W$ to rewrite these dynamics as ", "page_idx": 31}, {"type": "equation", "text": "$$\n\\dot{\\lambda}=-M\\nabla_{\\lambda}\\mathcal{L}\n$$", "text_format": "latex", "page_idx": 31}, {"type": "text", "text": "where $M$ is a diagonal matrix and $\\nabla_{\\lambda}\\mathcal{L}$ is the gradient of the loss with respect to the singular values of $\\beta$ . Without loss of generality we consider $\\eta_{a}=\\eta_{w}=1$ . ", "page_idx": 31}, {"type": "text", "text": "Lemma B.5. Let $\\Delta=\\delta\\mathbf{I}_{h}$ . We then have that $\\dot{\\lambda}=-M\\nabla_{\\lambda}{\\mathcal{L}}_{\\lambda}$ , where $M\\in\\mathbb{R}^{\\operatorname*{min}(d,c)\\times\\operatorname*{min}(d,c)}$ is $a$ diagonal matrix with ", "page_idx": 31}, {"type": "equation", "text": "$$\nM_{i i}=\\left\\{\\!\\!\\begin{array}{l l}{\\sqrt{\\delta^{2}+4\\lambda_{i}^{2}}}&{i\\leq\\operatorname*{min}(d,h,c)}\\\\ {0}&{\\mathrm{otherwise}}\\end{array}\\!\\!\\right.\n$$", "text_format": "latex", "page_idx": 31}, {"type": "text", "text": "Proof. First note that ", "page_idx": 31}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\dot{\\lambda}=\\mathrm{diag}(U^{\\top}\\dot{\\beta}V)}\\\\ &{\\quad=-\\mathrm{diag}\\left(U^{\\top}\\left[X^{\\top}(X\\beta-Y)A^{\\top}A+W^{\\top}W X^{\\top}(X\\beta-Y)\\right]V\\right)}\\\\ &{\\quad=-\\mathrm{diag}\\left(U^{\\top}X^{\\top}(X\\beta-Y)V\\Sigma_{A}^{2}+\\Sigma_{W}^{2}U^{\\top}X^{\\top}(X\\beta-Y)V\\right)}\\end{array}\n$$", "text_format": "latex", "page_idx": 31}, {"type": "text", "text": "where we let $W\\bar{\\sf}{W}\\,=\\,U\\Sigma_{W}^{2}U\\bar{\\sf}{\\sf\\sf}{T}$ and $A\\mathsf{T}A\\,=\\,V\\Sigma_{A}^{2}V\\mathsf{T}$ , using the fact that, under $\\Delta{}=\\mathbf{I}_{h}$ , the eigenvectors of $A\\intercal A$ are the right singular vectors of $\\beta$ and the eigenvectors of $W\\boldsymbol{\\top}W$ are the left singular vectors of $\\beta$ . This expression rewrites as ", "page_idx": 31}, {"type": "equation", "text": "$$\n\\dot{\\lambda}=-M\\mathrm{diag}\\left(U^{\\intercal}X^{\\intercal}(X\\beta-Y)V\\right)\n$$", "text_format": "latex", "page_idx": 31}, {"type": "text", "text": "where $M\\;\\;\\in\\;\\;\\mathbb{R}^{\\operatorname*{min}\\left(d,c\\right)\\times\\operatorname*{min}\\left(d,c\\right)}$ is a diagonal matrix with $M_{i i}\\ \\ =\\ (\\Sigma_{A}^{2})_{i i}\\,+\\,(\\Sigma_{W}^{2})_{i i}$ . For $i\\,\\le\\,\\operatorname*{min}(d,h,c)$ , one can show that $M_{i i}\\;=\\;\\sqrt{\\delta^{2}+4\\lambda_{i}^{2}}$ . This is because for $i\\,\\leq\\,\\operatorname*{min}(d,h,c)$ , $(\\Sigma_{A}^{2})_{i i}\\,=\\,(\\Sigma_{W}^{2})_{i i}+\\delta$ from the conservation law and $(\\dot{\\Sigma_{W}^{2}})_{i i}(\\Sigma_{A}^{2})_{i i}\\,=\\,\\lambda_{i}^{2}$ from the definition of $\\lambda$ . Together this implies $(\\Sigma_{W}^{2})_{i i}\\left(\\delta+(\\Sigma_{W}^{2})_{i i}\\right)=\\lambda_{i}^{2}$ , which is a quadratic equation in $(\\Sigma_{W}^{2})_{i i}$ . If $h<\\operatorname*{min}(d,c)$ then $M_{i i}=0$ for $i>\\operatorname*{min}(d,c)$ accounting for rank deficiency of both $A$ and $W$ in this case. Additionally, in our setting of MSE loss, it is straightforward to show that ", "page_idx": 31}, {"type": "equation", "text": "$$\n{\\frac{\\partial{\\mathcal{L}}}{\\partial\\lambda_{i}}}=\\left(U^{\\mathsf{T}}X^{\\mathsf{T}}(X{\\boldsymbol{\\beta}}-Y)V\\right)_{i i}\n$$", "text_format": "latex", "page_idx": 31}, {"type": "text", "text": "We then have that $\\nabla_{\\lambda}{\\mathcal{L}}=\\operatorname{diag}\\left(U^{\\top}X^{\\top}(X\\beta-Y)V\\right)$ , which, combined with our expression for $M$ , completes the proof. \u53e3 ", "page_idx": 31}, {"type": "text", "text": "Leveraging Lemma B.5, we can show that the singular values of $\\beta$ evolve under a mirror flow in the following theorem. ", "page_idx": 31}, {"type": "text", "text": "Theorem B.6. Let $\\Delta=\\delta\\mathbf{I}_{h}$ and assume $h\\geq\\operatorname*{min}(d,c)$ and $\\delta\\neq0$ . We then have that the dynamics of $\\lambda,$ , the singular values of $\\beta$ , are given by the mirror flow ", "page_idx": 31}, {"type": "equation", "text": "$$\n\\dot{\\lambda}=-\\left(\\nabla^{2}\\Phi_{\\delta}(\\lambda)\\right)^{-1}\\nabla_{\\lambda}\\mathcal{L},\n$$", "text_format": "latex", "page_idx": 31}, {"type": "text", "text": "where \u03a6\u03b4(\u03bb) = im=i1n $\\begin{array}{r}{\\Phi_{\\delta}(\\lambda)=\\sum_{i=1}^{\\operatorname*{min}(d,c)}q_{\\delta}(\\lambda_{i})}\\end{array}$ and $q_{\\delta}$ is the hyperbolic entropy potential ", "page_idx": 31}, {"type": "equation", "text": "$$\nq_{\\delta}(x)=\\frac14\\left(2x\\sinh^{-1}\\left(\\frac{2x}{|\\delta|}\\right)-\\sqrt{4x^{2}+\\delta^{2}}+|\\delta|\\right).\n$$", "text_format": "latex", "page_idx": 31}, {"type": "text", "text": "Proof. When $\\Delta\\mathbf{\\Pi}=\\delta\\mathbf{I}_{h}$ , then by Lemma B.5 the dynamics of the singular values of $\\beta$ can be e\u221axpressed as $\\dot{\\lambda}=-M\\nabla_{\\lambda}{\\mathcal{L}}$ . Furthermore, when $h\\geq\\operatorname*{min}(d,c)$ and $\\delta\\ne0$ , we have that $M\\,=$ $\\sqrt{\\delta^{2}+4\\lambda^{2}}\\mathbf{I}_{\\operatorname*{min}(d,c)}$ , where $\\lambda^{2}$ is element-wise, which is always invertible. Observe, this expression for $M$ is the inverse Hessian of the potential $\\begin{array}{r}{\\Phi_{\\delta}(\\lambda)=\\sum_{i}q_{\\delta}(\\lambda_{i})}\\end{array}$ for $q_{\\delta}$ specified in the theorem statement. Thus, the dynamics for the singular values are the mirror flow $\\dot{\\lambda}=-\\left(\\nabla^{2}\\Phi_{\\delta}(\\lambda)\\right)^{-1}\\nabla_{\\lambda}\\mathcal{L}$ ", "page_idx": 31}, {"type": "text", "text": "Theorem B.6 implies that the dynamics for the singular values of $\\beta$ can be described as a mirror flow with a $\\delta$ -dependent potential. This potential was first identified as the inductive bias for diagonal linear networks by Woodworth et al. [14]. Termed hyperbolic entropy, this potential smoothly interpolates between an $\\ell^{1}$ and $\\ell^{2}$ penalty on the singular values for the rich $\\left[\\delta\\rightarrow0\\right]$ ) and lazy ( $\\\"\\delta\\rightarrow\\pm\\infty\\rangle$ ) regimes respectively. Unfortunately, in our setting we cannot adapt our mirror flow interpretation into a statement on the inductive bias at interpolation because the singular vectors evolve through training. If we introduce additional assumptions \u2014 specifically, whitened input data $\\left\\langle X^{\\intercal}X\\right.=\\left.\\mathbf{I}_{d}\\right\\rangle$ ) and a task-aligned initialization such that the singular vectors of $\\beta_{0}$ are aligned with those of $\\beta_{*}$ \u2014 we can ensure that the singular vectors remain constant and thus derive an inductive bias on the singular values. However, in this setting the dynamics decouple completely, implying there is no difference between applying an $\\ell^{1}$ or $\\ell^{2}$ penalty on the singular values. Consequently, even though the dynamics will depend on $\\delta$ , the final interpolating solution will be independent of $\\delta$ , making a statement on the inductive bias insignificant. ", "page_idx": 32}, {"type": "text", "text": "B.2 Deep linear networks ", "text_level": 1, "page_idx": 32}, {"type": "text", "text": "We now consider the influence of depth by studying a depth- $\\left(L+1\\right)$ linear network, $f(x;\\theta)\\;=$ $a^{\\mathsf{T}}\\prod_{l=1}^{L}W_{l}x$ , where $W_{1}\\,\\in\\,\\mathbb{R}^{h\\times d}$ , $W_{l}\\,\\in\\,\\mathbb{R}^{h\\times h}$ for $1<l\\leq L$ , and $a\\in\\mathbb{R}^{h}$ . We assume that the dimensions $d=h$ and that all parameters share the same learning rate $\\eta=1$ . For this model the predictor coefficients are computed by the product $\\begin{array}{r}{\\beta=\\prod_{l=1}^{L}W_{l}^{\\textsf{T}}a\\in\\mathbb{R}^{d}}\\end{array}$ . Similar to our analysis of a two-layer setting, we assume an isotropic initializations of the parameters. ", "page_idx": 32}, {"type": "text", "text": "Definition B.7. There exists a $\\delta\\ \\in\\ \\mathbb{R}$ such that $a a^{\\boldsymbol{\\mathsf{T}}}\\,-\\,W_{L}W_{L}^{\\boldsymbol{\\mathsf{T}}}\\,=\\,\\delta\\mathbf{I}_{h}$ and for all $l~\\in~[L-1]$ $W_{l+1}^{\\boldsymbol{\\mathsf{T}}}W_{l+1}=W_{l}W_{l}^{\\boldsymbol{\\mathsf{T}}}$ . ", "page_idx": 32}, {"type": "text", "text": "This assumption can easily be achieved by setting $a\\,=\\,0$ and $W_{l}\\,=\\,\\alpha O_{l}$ for all $l\\,\\in\\,[L]$ , where $O_{l}\\in\\mathbb{R}^{d\\times d}$ is an random orthogonal matrix and $\\alpha\\geq0$ . In this case $\\delta=-\\alpha^{2}$ . Further, notice this parameterization is naturally achieved in the high-dimensional limit as $d\\rightarrow\\infty$ under a standard Gaussian initialization with a variance inversely proportional with width. As in the two-layer setting, this structure of the initialization will remain conserved throughout gradient flow. We now show how two natural quantities of $\\beta$ , its squared norm $\\|\\beta\\|^{2}$ and its outer product $\\beta\\beta^{\\boldsymbol{\\mathsf{T}}}$ , can always be expressed as polynomials of $\\lVert a\\rVert^{2}$ and $\\bar{W}_{1}^{\\top}W_{1}$ respectively. ", "page_idx": 32}, {"type": "text", "text": "Lemma B.8. For a depth- $(L{+}1)$ linear network with square width ${}^{\\prime}d=h,$ ) and isotropic initialization, then for all $t\\geq0$ , ", "page_idx": 32}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\|\\beta\\|^{2}=\\|a\\|^{2}\\left(\\|a\\|^{2}-\\delta\\right)^{L},}\\\\ &{\\beta\\beta^{\\sf T}=\\left(W_{1}^{\\sf T}W_{1}\\right)^{L+1}+\\delta\\left(W_{1}^{\\sf T}W_{1}\\right)^{L}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 32}, {"type": "text", "text": "Proof. The norm of the regression coefficients is the product $\\begin{array}{r}{\\|\\beta\\|^{2}=a^{\\mathsf{T}}\\left(\\prod_{l=1}^{L}W_{l}\\right)\\left(\\prod_{l=1}^{L}W_{l}\\right)^{\\mathsf{T}}a.}\\end{array}$ . Using the conservation of the initial conditions between consecutive weight matrices, $W_{l+1}^{\\mathsf{T}}W_{l+1}=$ $W_{l}W_{l}^{\\top}$ , we can express this telescoped product as $\\|\\beta\\|^{2}=a^{\\boldsymbol{\\mathsf{T}}}\\left(W_{L}W_{L}^{\\boldsymbol{\\mathsf{T}}}\\right)^{d}a.$ . When plugging in the conservation between last two layers, this implies $\\|{\\boldsymbol{\\beta}}\\|^{2}=a^{\\mathsf{T}}\\left(a a^{\\mathsf{T}}-\\delta\\mathbf{I}_{h}\\right)^{d}a$ , which expanded gives the desired result. ", "page_idx": 32}, {"type": "text", "text": "The outer product of the regression coefficients is $\\beta\\beta^{\\sf T}\\,=\\,\\left(\\prod_{l=1}^{L}W_{l}\\right)^{\\sf T}\\,a a^{\\sf T}\\,\\left(\\prod_{l=1}^{L}W_{l}\\right)$ . Using the conserved initial conditions of the last weights we can factor the outer product as the sum, $\\begin{array}{r}{\\beta\\beta^{\\sf r}\\,=\\,\\left(\\prod_{l=1}^{L}W_{l}\\right)^{\\sf T}W_{L}W_{L}^{\\sf T}\\left(\\prod_{l=1}^{L}W_{l}\\right)\\,+\\,\\delta\\left(\\prod_{l=1}^{L}W_{l}\\right)^{\\sf T}\\left(\\prod_{l=1}^{L}W_{l}\\right)}\\end{array}$ . Both these telescoping products factor using the conservation of the initial conditions between consecutive weight matrices giving the desired result. ", "page_idx": 32}, {"type": "text", "text": "We now demonstrate how the quadratic terms $|a|^{2}$ and $W_{1}^{\\top}W_{1}$ significantly influence the dynamics of $\\beta$ , similar to our analysis in the two-layer setting. ", "page_idx": 32}, {"type": "text", "text": "Lemma B.9. The dynamics of $\\beta$ are given by a differential equation $\\dot{\\beta}=-M X^{\\intercal}\\rho$ where $M$ is $a$ positive semi-definite matrix that solely depends on $\\lVert a\\rVert^{2}$ , $W_{1}^{\\top}W_{1}$ , and $\\delta$ , ", "page_idx": 32}, {"type": "equation", "text": "$$\nM=\\left(W_{1}^{\\mathsf{T}}W_{1}\\right)^{L}+\\|a\\|^{2}\\left(\\sum_{l=0}^{L-1}(\\|a\\|^{2}-\\delta)^{l}\\left(W_{1}^{\\mathsf{T}}W_{1}\\right)^{L-1-l}\\right).\n$$", "text_format": "latex", "page_idx": 32}, {"type": "text", "text": "Finally, we consider how the expression for $M$ simplifies in the limit as $\\delta\\rightarrow0$ allowing us to be precise about the inductive bias in this setting. ", "page_idx": 33}, {"type": "text", "text": "Theorem B.10. For a depth- $(L+1)$ linear network with square width $'d\\,=\\,h_{,}$ ) and isotropic initialization $\\beta_{0}$ such that $\\|\\beta(t)\\|>0$ for all $t\\geq0$ , then in the limit as $\\delta\\rightarrow0$ , if the gradient flow solution $\\beta(\\infty)$ satisfies $X\\beta(\\infty)=y$ , then, ", "page_idx": 33}, {"type": "equation", "text": "$$\n\\beta(\\infty)=\\underset{\\beta\\in\\mathbb{R}^{d}}{\\arg\\operatorname*{min}}\\left(\\frac{L+1}{L+2}\\right)\\|\\beta\\|^{\\frac{L+2}{L+1}}-\\left(\\frac{\\beta(0)}{\\|\\beta(0)\\|^{\\frac{L}{L+1}}}\\right)^{\\top}\\beta\\quad\\mathrm{s.t.}\\quad X\\beta=y.\n$$", "text_format": "latex", "page_idx": 33}, {"type": "text", "text": "Proof. Whenever $\\|\\beta\\|>0$ and in the limit as $\\delta\\rightarrow0$ , then we can find a unique expression for $\\lVert a\\rVert^{2}$ and $\\dot{W}_{1}^{\\mathsf{T}}W_{1}$ in terms of $\\|\\beta\\|^{2}$ and $\\beta\\beta^{\\boldsymbol{\\mathsf{T}}}$ , ", "page_idx": 33}, {"type": "equation", "text": "$$\n\\begin{array}{r l r}{\\|\\boldsymbol{a}\\|^{2}=\\|\\beta\\|^{\\frac{2}{L+1}},}&{{}}&{W_{1}^{\\top}W_{1}=\\|\\beta\\|^{-\\frac{2L}{L+1}}\\beta\\beta^{\\top}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 33}, {"type": "text", "text": "Plugged into the previous expression for $M$ results in a positive definite rank-one perturbation to the identity, ", "page_idx": 33}, {"type": "equation", "text": "$$\nM=\\|\\beta\\|^{\\frac{2L}{L+1}}\\mathbf{I}_{d}+L\\|\\beta\\|^{-\\frac{2}{L+1}}\\beta\\beta^{\\mathsf{T}}.\n$$", "text_format": "latex", "page_idx": 33}, {"type": "text", "text": "Using the Sherman-Morrison formula we find that $M^{-1}$ is ", "page_idx": 33}, {"type": "equation", "text": "$$\nM^{-1}=\\|\\beta\\|^{-\\frac{2L}{L+1}}\\mathbf{I}_{d}+\\left(\\frac{L}{L+1}\\right)\\|\\beta\\|^{-\\frac{4L+2}{L+1}}\\beta\\beta^{\\dagger}\n$$", "text_format": "latex", "page_idx": 33}, {"type": "text", "text": "We can now apply a time-warped mirror flow analysis similar to the analysis presented in Appendix A.4. Consider the time-warping function $g_{\\delta}(\\|\\beta\\|)=\\|\\beta\\|^{-\\frac{L}{L+1}}$ and the potential $\\Phi(\\beta)=$ $\\begin{array}{r}{\\left(\\frac{L+1}{L+2}\\right)\\left\\lVert\\beta\\right\\rVert^{\\frac{L+2}{L+1}}}\\end{array}$ , then its not hard to show $M^{-1}\\,=\\,g_{\\delta}(\\|\\beta\\|)\\nabla^{2}\\Phi(\\beta)$ . This gives the desired result. \u53e3 ", "page_idx": 33}, {"type": "text", "text": "This theorem is a generalization of Proposition 1 derived in [9] for two-layer linear networks in the rich limit to deep linear networks in the rich limit. We find that the inductive bias, $Q(\\beta)\\,=$ $\\begin{array}{r}{(\\frac{L+1}{L+2})\\|\\beta\\|^{\\frac{L+2}{L+1}}-\\|\\bar{\\beta_{0}_{}}\\|^{-\\frac{L}{L+1}}\\beta_{0}^{\\mathsf{T}}\\beta_{}}\\end{array}$ , strikes a depth-dependent balance between attaining the minimum norm solution and preserving the initialization direction. ", "page_idx": 33}, {"type": "text", "text": "C Piecewise Linear Networks ", "text_level": 1, "page_idx": 34}, {"type": "text", "text": "Here, we elaborate on the theoretical results presented in Section 5. Our goal is to extend the tools developed in our analysis of linear networks to piecewise linear networks and understand their limitations. We focus on the dynamics of the input-output map, rather than on the inductive bias of the interpolating solutions. As discussed in Azulay et al. [9], Vardi and Shamir [80], extending a mirror flow style analysis directly to non-trivial piecewise linear networks is very difficult or provably impossible. In this section, we first describe the properties of the input-output map of a piecewise linear function, then describe the dynamics of a two-layer network, and finally discuss the challenges in extending this analysis to deeper networks and potential directions for future work. ", "page_idx": 34}, {"type": "text", "text": "C.1 Surface of a piecewise linear network ", "text_level": 1, "page_idx": 34}, {"type": "text", "text": "The input-output map of a piecewise linear network $f(x;\\theta){\\bar{\\,}}$ , with $l$ hidden layers and $h$ hidden neurons per layer, is comprised of potentially $O(h^{d l})$ connected linear regions, each with their own vector of predictor coefficients [65]. The exploration of this complex surface has been the focus of numerous prior works, the vast majority of them focused on counting and bounding the number of linear regions as a function of the width and depth [81, 82, 83, 84, 65, 85, 86, 87]. The central object in all of these studies is the activation region, ", "page_idx": 34}, {"type": "text", "text": "Definition C.1. For a piecewise linear network $f(x;{\\boldsymbol{\\theta}})$ , comprising $N$ hidden neurons with preactivation $z_{i}(x;\\theta)$ for $i\\in[N]$ , let the activation pattern $\\boldsymbol{\\mathcal{A}}$ represent an assignment of signs $a_{i}\\in\\{-1,1\\}$ to each hidden neuron. The activation region $\\dot{\\mathcal{R}}(\\mathcal{A};\\dot{\\theta})$ is the subset of input space that generates $\\boldsymbol{\\mathcal{A}}$ , ", "page_idx": 34}, {"type": "equation", "text": "$$\n\\mathcal{R}(\\mathcal{A};\\theta)=\\{x\\in\\mathbb{R}^{d}\\;\\vert\\;\\forall i\\;a_{i}z_{i}(x;\\theta)>0\\}.\n$$", "text_format": "latex", "page_idx": 34}, {"type": "image", "img_path": "eNM94i7R3A/tmp/528508580f14c47c6d1ac213d81953c7a63d7b65ceea05f2fee1c9135ec8bf4e.jpg", "img_caption": ["(a) With Biases (b) Without Biases "], "img_footnote": [], "page_idx": 34}, {"type": "text", "text": "Figure 9: Surface of a ReLU network. Here we depict the surface of a three-layer ReLU network $f(x;\\theta):\\mathbb{R}^{2}\\to\\mathbb{R}$ with twenty hidden units per layer at initialization, comparing configurations with biases (left) and without biases (right). The network with biases partitions input space into convex polytopes that tile input space. The network without biases partitions input space into convex conic sections emanating from the origin. Each region exhibits a distinct activation pattern, allowing the partition to be colored with two colors based on the parity of active neurons. The network operates linearly within each region ", "page_idx": 34}, {"type": "text", "text": "The input-output map is linear n-empty activation region and continuous at the boundary be- and maintains continuity across boundaries. tween regions. Linearity implies that every non-empty9 activation region is associated with a linear predictor vector $\\beta_{\\mathcal{R}}\\in\\dot{\\mathbb{R}}^{d}$ such that for all $x\\in R(A;\\theta)$ , $\\beta_{\\mathcal{R}}=\\nabla_{x}f(x;\\theta)$ . Continuity implies that the boundary between regions is formed by a hyperplane determined by where the pre-activation for a neuron is exactly zero, $\\{x:z_{i}(x;\\theta)=0\\}$ . When the neighboring regions have different linear predictors10, then this hyperplane is orthogonal to their difference, which is a vector in the span of the first-layer weights. Taken together, this implies that the union of all activation regions forms a convex partition of input space, as shown in Fig. 9. We now present a surprisingly simple, yet to the best of our knowledge not previously understood property of this partition: ", "page_idx": 34}, {"type": "text", "text": "Proposition C.2 (2-colorable). If $f(x;{\\boldsymbol{\\theta}})$ lacks redundant neurons, implying that every neuron influences an activation region, then the partition of input space can be colored with two distinct colors such that neighboring regions do not share the same color. ", "page_idx": 34}, {"type": "text", "text": "The justification for this proposition is straightforward. There is one color for regions with an even number of active neurons and another for regions with an odd number of active neurons. Because $f(x;{\\boldsymbol{\\theta}})$ lacks redundant neurons, there does not exist a boundary between activation regions where two neurons activations change simultaneously. In this work, we solely utilize this proposition for visualization purposes, as shown in Fig. 9. Nonetheless, we believe it may be of independent interest as it strengthens the connection between the surface of piecewise linear networks and the mathematics of paper folding, a connection previously alluded to in the literature [82]. ", "page_idx": 34}, {"type": "text", "text": "C.2 Dynamics of a two-layer piecewise linear network ", "text_level": 1, "page_idx": 35}, {"type": "text", "text": "We consider the dynamics of a two-layer piecewise linear network without biases, $f(x;\\theta)\\;=$ $a^{\\mathsf{T}}\\sigma(W x)$ , where $\\dot{W}\\,\\in\\,\\mathbb{R}^{h\\times d}$ and $a\\,\\in\\,\\mathbb{R}^{h}$ . The activation function is $\\sigma(z)\\,=\\,\\operatorname*{max}(z,\\gamma z)$ for $\\gamma\\in\\left[0,1\\right)$ , which includes ReLU $\\gamma=0$ and Leaky ReLU $\\gamma\\,\\in\\,(0,1)$ . We permit $h>d$ , which in the limit as $h\\to\\infty$ , ensures the network possesses the functional expressivity to represent any continuous nonlinear function from $\\mathbb{R}^{d}$ to $\\mathbb{R}$ passing through the origin. Following a similar strategy used in Section 4, we consider the contribution to the input-output map from a single hidden neuron $k\\,\\in\\,[h]$ with parameters $w_{k}\\,\\in\\,\\mathbb{R}^{d}$ and $a_{k}\\ \\in\\ \\mathbb{R}.$ . As in the linear setting, each hidden neuron is associated with a conserved quantity, $\\delta_{k}\\,=\\,\\eta_{w}a_{k}^{2}\\,-\\,\\eta_{a}\\|w_{k}\\|^{2}$ . Unlike in the linear setting, this neuron\u2019s contribution to the output $f(x_{i};\\theta)$ is regulated by whether the input $x_{i}$ is in the neuron\u2019s active halfspace, $\\{\\boldsymbol{x}\\in\\mathbb{R}^{d}:w_{\\boldsymbol{k}}^{\\mathsf{T}}\\boldsymbol{x}>0\\}$ . Let $C\\in\\mathbb{R}^{h\\times n}$ be the matrix with elements $c_{k i}=\\sigma^{\\prime}(w_{k}^{\\mathsf{T}}x_{i})$ , which determines the activation of the $k^{\\mathrm{th}}$ neuron for the $i^{\\mathrm{th}}$ training data point. The subgradient $\\sigma^{\\prime}(z)=1$ if $z\\,>\\,0$ , $\\sigma^{\\prime}(z)\\in\\lbrack\\gamma,1\\rbrack$ if $z=0$ , and $\\sigma^{\\prime}(z)=\\gamma$ if $z<0$ . These activation functions exhibit positive homogeneity, implying $\\sigma(z)=\\sigma^{\\prime}(z)z$ . Thus, we can express $\\sigma(w_{k}^{\\mathsf{T}}x_{i})=c_{k i}w_{k}^{\\mathsf{T}}x_{i}$ , allowing us to express the gradient flow dynamics for $w_{k}$ and $a_{k}$ as ", "page_idx": 35}, {"type": "equation", "text": "$$\n\\dot{a}_{k}=-\\eta_{a}w_{k}^{\\top}\\left(\\sum_{i=1}^{n}c_{k i}x_{i}\\rho_{i}\\right),\\qquad\\dot{w}_{k}=-\\eta_{w}a_{k}\\left(\\sum_{i=1}^{n}c_{k i}x_{i}\\rho_{i}\\right),\n$$", "text_format": "latex", "page_idx": 35}, {"type": "text", "text": "where $\\rho_{i}~=~f(x_{i};\\theta)-\\,y_{i}$ is the residual associated with the $i^{\\mathrm{th}}$ training data point. If we let $\\beta_{k}=a_{k}w_{k}$ , which determines the contribution of each hidden neuron to the output $f(x_{i};\\theta)$ , then its not hard to see that the gradient flow dynamics of $\\beta_{k}$ are ", "page_idx": 35}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\dot{\\beta}_{k}=-\\underbrace{\\left(\\eta_{w}a_{k}^{2}\\mathbf{I}_{d}+\\eta_{a}w_{k}w_{k}^{\\mathsf{T}}\\right)}_{M_{k}}\\underbrace{\\left(\\sum_{i=1}^{n}c_{k i}x_{i}\\rho_{i}\\right)}_{\\xi_{k}}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 35}, {"type": "text", "text": "As in the linear setting, the matrix $M_{k}\\in\\mathbb{R}^{d\\times d}$ appears as a preconditioning matrix on the dynamics Using the exact same derivation presented in Appendix A.3, whenever $a_{k}^{2}\\ \\bar{\\neq}\\ 0$ , we can express $M_{k}$ entirely in terms of $\\beta_{k}$ and $\\delta_{k}$ , ", "page_idx": 35}, {"type": "equation", "text": "$$\nM_{k}=\\frac{\\sqrt{\\delta_{k}^{2}+4\\eta_{a}\\eta_{w}\\|\\beta_{k}\\|^{2}}+\\delta_{k}}{2}\\mathbf{I}_{d}+\\frac{\\sqrt{\\delta_{k}^{2}+4\\eta_{a}\\eta_{w}\\|\\beta_{k}\\|^{2}}-\\delta_{k}}{2}\\frac{\\beta_{k}\\beta_{k}^{\\mathsf{T}}}{\\|\\beta_{k}\\|^{2}}.\n$$", "text_format": "latex", "page_idx": 35}, {"type": "text", "text": "However, unlike in the linear setting, the vector $\\xi_{k}\\in\\mathbb{R}^{d}$ driving the dynamics is not shared for all neurons because of its dependence on $c_{k i}$ . Additionally, the NTK matrix in this setting depends on $M_{k}$ and $C$ , with elements $\\begin{array}{r}{K_{i j}\\,=\\,\\sum_{k=1}^{h}c_{k i}x_{i}^{\\top}\\left(\\eta_{w}a_{k}^{2}\\mathbf{I}_{d}+\\eta_{a}w_{k}w_{k}^{\\top}\\right)x_{j}c_{k j}}\\end{array}$ . Thus, in order to assess the temporal dynamics of the N TK matrix, we must understand the dynamics of $M_{k}$ and $C$ We consider a signed spherical coordinate transformation separating the dynamics of $\\beta_{k}$ into its directional $\\begin{array}{r}{\\hat{\\beta}_{k}\\,=\\,\\mathrm{sgn}(a_{k})\\frac{\\beta_{k}}{\\|\\beta_{k}\\|}}\\end{array}$ and radial $\\mu_{k}\\,=\\,\\mathrm{sgn}(a_{k})\\|\\beta_{k}\\|$ components, such that $\\beta_{k}\\,=\\,\\mu_{k}\\hat{\\beta}_{k}$ ", "page_idx": 35}, {"type": "text", "text": "Here, $\\hat{\\beta}_{k}$ determines the orientation and direction of the halfspace where the $k^{\\mathrm{th}}$ neuron is active, while $\\mu_{k}$ determines the slope of the linear region in this halfspace. These coordinates evolve according to, ", "page_idx": 35}, {"type": "equation", "text": "$$\n\\dot{\\mu}_{k}=-\\sqrt{\\delta_{k}^{2}+4\\eta_{a}\\eta_{w}\\mu_{k}^{2}}\\hat{\\beta}_{k}^{\\top}\\xi_{k},\\qquad\\dot{\\hat{\\beta}}_{k}=-\\frac{\\sqrt{\\delta_{k}^{2}+4\\eta_{a}\\eta_{w}\\mu_{k}^{2}}+\\delta_{k}}{2\\mu_{k}}\\left(\\mathbf{I}_{d}-\\hat{\\beta}_{k}\\hat{\\beta}_{k}^{\\top}\\right)\\xi_{k}.\n$$", "text_format": "latex", "page_idx": 35}, {"type": "text", "text": "These equations can be derived directly from Eq. (128) through chain rule similar to Appendix A.2.1. In fact its worth noting that the this change of coordinates is similar to the change of coordinates used in the single-neuron analysis. Expressed in terms of the parameters, $\\begin{array}{r}{\\hat{\\beta}_{k}=\\frac{w_{k}}{\\parallel w_{k}\\parallel}}\\end{array}$ and $\\mu_{k}=a_{k}\\|w_{k}\\|$ . ", "page_idx": 35}, {"type": "text", "text": "D Experimental Details ", "text_level": 1, "page_idx": 36}, {"type": "text", "text": "We used Google Cloud Platform (GCP) nodes to run all experiments. Figure 1 experiments were run on a node with 360 AMD Genoa CPU cores with runtime totaling approximately 90 minutes including averaging over seeds as described below. Neural network training and NTK calculation for Figure 5 was performed on single A100 GPU nodes. Runtime was approximately 20 hours for Figure 5(a), four hours for 5(b), 12 hours for 5(c) (with individual runs ranging from five to 30 minutes depending on the number of datapoints), and 12 hours for 5(d). Figures 2, 3, and 4 are not compute-heavy, and these experiments were run on a personal computer. Overall, we estimate approximately 200 hours of single A100 runtime as well as 100 hours of the 360-core node accounting for failed runs and exploratory experiments. ", "page_idx": 36}, {"type": "text", "text": "D.1 Figure 1: Teacher-Student with Two-layer ReLU Networks ", "text_level": 1, "page_idx": 36}, {"type": "text", "text": "For Fig. 1 we consider a student-teacher setup similar to that in [8], with one-hidden layer ReLU networks of the form $\\begin{array}{r}{f(x;\\theta)=\\sum_{i=1}^{m}a_{i}\\sigma(w_{i}^{\\dag}x)}\\end{array}$ , where $f:\\mathbb{R}^{d}\\stackrel{}{\\rightarrow}\\mathbb{R}$ and $\\sigma$ is the ReLU activation function. The teacher model,  f teacher, has m = k hidden neurons initialized as witeacher i.i\u223c.d. $\\mathrm{Unif}(S^{d-1})$ and $a_{i}\\overset{\\mathrm{i.i.d.}}{\\sim}\\mathrm{Unif}(\\{\\pm1\\})$ for $i\\leq k$ . The student, $f^{\\mathrm{student}}$ , in turn, has $h$ hidden neurons. We use a symmetrized initialization, as considered in [8], where for $i\\leq h/2$ , we sample $w_{i}\\stackrel{\\mathrm{i.i.d.}}{\\sim}S^{d-1}$ $a_{i}\\stackrel{\\mathrm{i.i.d.}}{\\sim}\\mathrm{Unif}(\\{\\pm1\\})$ , and then for $\\textstyle i\\,\\geq\\,{\\frac{h}{2}}+1$ we symmetrize by setting $w_{i}~=~w_{i-h/2}$ and $a_{i}=-a_{i-h/2}$ . This ensures that $f^{\\mathrm{student}}$ predicts 0 on any input at initialization. ", "page_idx": 36}, {"type": "text", "text": "Note that the base student initialization described thus far is perfectly balanced at each neuron, that is $\\delta_{i}\\,=\\,0$ for $i\\,\\in\\,[m]$ ; we also define this to be our setting where the scale $\\tau$ is 1. In order to transform the base initialization into a particular setting of $\\tau$ and $\\delta$ , we first solve for the relative layer scaling $\\alpha$ in $\\delta^{2}\\,=\\,\\tau^{2}(\\alpha^{2}\\,-\\,\\alpha^{-2})^{2}$ and then scale each $w_{i}$ by $\\tau/\\alpha$ and each $a_{i}$ by $\\tau\\alpha$ . We obtain a training dataset $\\{\\boldsymbol{x}^{(i)},\\boldsymbol{y}^{(i)}\\}_{i=1}^{n}$ by sampling $\\boldsymbol{x}^{(i)}$ i.i\u223c.d. $S^{d-1}$ and computing noiseless labels as $y^{(i)}=f^{\\mathrm{teacher}}(x^{(i)};\\theta^{\\mathrm{teacher}})$ . The student is then trained with full-batch gradient descent on a mean square loss objective. ", "page_idx": 36}, {"type": "text", "text": "Figure 1 (a). ", "text_level": 1, "page_idx": 36}, {"type": "text", "text": "Here the setting is: $d=2$ , $h=50$ , $k=3$ , and $n=20$ . We sample a single teacher and then train four students with the same base initialization but different configurations of $\\tau$ and $\\delta$ : $\\mathit{\\check{\\Psi}}^{\\tau}=0.1,\\delta=0\\mathit{\\Theta}$ ) and $\\left(\\tau=2,\\delta=0\\right)$ ) for the left subfigure, and $(\\tau=0.1,\\delta=1)$ ) and $^{\\prime}(\\tau=0.1,\\delta=-1)$ ) for the right subfigure. Training is for 1 million steps at a learning rate of 1e-4. ", "page_idx": 36}, {"type": "text", "text": "Figure 1 (b). ", "text_level": 1, "page_idx": 36}, {"type": "text", "text": "Here the setting is: $d=100$ , $m\\,=\\,50$ , $k\\,=\\,3$ , and $n\\,=\\,1000$ , as in Fig. 1c of [8]. Training is performed with learning rate of $5\\mathrm{e}{-}3/\\tau^{2}$ . Test error is computed as mean square error over a held-out set of 10,000 datapoints. We sweep over $\\tau$ over a logarithmic scale in the range [0.1, 2] and $\\delta$ over a linear scale in the range $[-1,1]$ . We average over 16 random seeds, where the seed controls the sampling of: the teacher weights $\\theta^{\\mathrm{teacher}}$ , the base initialization of $\\theta^{\\mathrm{student}}$ , and the training data $\\{x^{(i)}\\}_{i=1}^{n}$ . In this way, each random seed is used for a sweep over all combinations of $\\tau$ and $\\delta$ in the sweep; we simply apply the scaling described above to get to each point on the $(\\tau,\\delta)$ grid. The kernel distance computed is as defined in [27], where here we compute it at time $t$ relative to the kernel at initialization, i.e. $S(t)=1-\\langle K_{0},K_{t}\\rangle/\\left(\\|K_{0}\\|_{F}\\|K_{t}\\|_{F}\\right)$ . In Fig. 10, we additionally plot Hamming and parameter distances relative to initialization, as well as training loss, while training for ten times longer than in Fig. 1 (b). ", "page_idx": 36}, {"type": "text", "text": "Notebooks generating all two-layer experiment figures are provided here. ", "page_idx": 36}, {"type": "image", "img_path": "eNM94i7R3A/tmp/47f729f8861ff73bb837d74bcb8b7701124fc0a24321a4283e1ea3f2b3eb6f06.jpg", "img_caption": ["Figure 10: Supporting figures for Fig. 1 (b). We plot Hamming distance, parameter distance, and training loss, on top of the test loss and kernel distance considered in Fig. 1 (b), and train for ten times longer than in Fig. 1 (b). We observe that although training loss still drops between $10^{5}$ and $10^{6}$ steps, the test loss and other distances considered remain largely unchanged. Training loss is saturated at 1e-10. "], "img_footnote": [], "page_idx": 37}, {"type": "text", "text": "D.2 Figures 2, 3, 4: Single-Neuron Linear Network ", "text_level": 1, "page_idx": 37}, {"type": "text", "text": "Figures 2, 3, and 4 were generated by simulating gradient flow using scipy.integrate.solve_ivp function with the RK45 method for solving the ODEs, with a relative tolerance of $1\\times10^{-6}$ and time span of $(0,20)$ . In the experiments with full-rank data, we used $X^{\\top}X=\\mathbf{I}_{2}$ , $\\beta_{*}=[\\,_{1}^{0}]$ , and $\\beta_{0}=\\left[\\begin{array}{l}{-1}\\\\ {0}\\end{array}\\right]$ ..  SFeore  tthhee  edixspceursismioenn ti nw iAthp ploenwd-irxa nAk. 2d aftoar,  dweet auilsse do $X\\mathsf{T}X=[\\mathsf{\\Gamma}_{0.5}^{0.25}\\mathsf{\\Gamma}_{1}^{0.5}]$ , $\\beta_{*}=\\left[\\stackrel{0.44}{0.88}\\right]$ e,t iacnadl \u03b20 = [ 0.05 ]   \npredictions. A notebook generating all the figures is provided here. ", "page_idx": 37}, {"type": "text", "text": "D.3 Figure 5: ", "text_level": 1, "page_idx": 37}, {"type": "text", "text": "Kernel Distance ", "text_level": 1, "page_idx": 37}, {"type": "text", "text": "We trained LeNet-5 [88] (with ReLU nonlinearity and Max Pooling) on MNIST [88]. We use He initialization [89] and divide the first layer weights by $\\alpha$ and multiply the last layer weights by $\\alpha$ at initialization, which keeps the network functionally the same at initialization. We trained the model for 500 epochs with a learning rate of 1e-4 and a batch size of 512. The parameter distance is defined as the $L_{2}$ distance between all the parameters. To quantify the distance between the activations, we binarize the hidden activation with 1 representing an active neuron. We evaluate Hamming distance over all the binarized hidden activations normalized by the the total number of the activations. We use kernel distance [27], defined as $S(t_{1},t_{2})=1-\\langle\\dot{K_{t_{1}}},K_{t_{2}}\\rangle/\\left(\\lVert K_{t_{1}}\\rVert_{F}\\lVert K_{t_{2}}\\rVert_{F}\\right)$ , which is a scale invariant measure of similarity between the NTK at two points in time. We subsample $10\\%$ of MNIST to evaluate the Hamming distance and kernel distance. All curves in the figure are averaged over 8 runs. ", "page_idx": 37}, {"type": "text", "text": "", "page_idx": 38}, {"type": "text", "text": "Gabor Filters ", "text_level": 1, "page_idx": 38}, {"type": "text", "text": "We are training a small ResNet based on the CIFAR10 script provided in the DAWN benchmark (code available here). The only modifications to the provided code base are we increase the convolution kernel size from $3\\times3$ to $15\\times15$ , to better observe the learned spatial patterns, and we set the weight decay parameter to 0 to avoid confounding variables. Moreover, we are dividing the convolutional fliters weights by a parameter $\\alpha$ (after standard initialization) which controls the balancedness of the network. To quantify the smoothness of the filters, we compute the normalized Laplacian of each filter $w_{i j}\\in\\mathbb{R}^{\\bar{1}5\\times15}$ , over input $i=(1,2,3)$ and output $j=(1,...,64)$ channels ", "page_idx": 38}, {"type": "equation", "text": "$$\n{\\mathrm{smoothness}}(w_{i j}):=\\left\\|{\\frac{w_{i j}}{\\|w_{i j}\\|_{2}}}*\\Delta\\right\\|_{2}^{2}\n$$", "text_format": "latex", "page_idx": 38}, {"type": "text", "text": "where the Laplacian kernel is defined as ", "page_idx": 38}, {"type": "equation", "text": "$$\n\\Delta:=\\left(\\begin{array}{c c c}{{-0.25}}&{{-0.5}}&{{-0.25}}\\\\ {{-0.5}}&{{2}}&{{-0.5}}\\\\ {{-0.25}}&{{-0.5}}&{{-0.25}}\\end{array}\\right).\n$$", "text_format": "latex", "page_idx": 38}, {"type": "image", "img_path": "eNM94i7R3A/tmp/3c99e99204e33d4dbb01f7e6a0fa86c298f4a611e67b7ba0b5d344ddcee34001.jpg", "img_caption": ["Figure 11: Interpreting convolutional fliters. CNN experiments on CIFAR10. We can see in A) that all networks achieve comparable training and test accuracy, despite the modification in initialization. However, in B) we see that networks with a small initialization $(\\alpha<1)$ ) learn much smoother fliters, giving quantiative support to results in Fig. 6. The smoothness is defined as the normalized Laplacian of the filters (see text, eq. 132). "], "img_footnote": [], "page_idx": 38}, {"type": "text", "text": "Random Hierarchy Model ", "text_level": 1, "page_idx": 38}, {"type": "text", "text": "We refer to [67], who originally proposed the random hierarchy model (RHM) as a tool for studying how deep networks learn compositional data, for a more in-depth treatment. Here we briefly recap the setup following the notation used in [67]. ", "page_idx": 38}, {"type": "text", "text": "An RHM essentially lets us build a random classification task with a clear hierarchical structure. The top level of the RHM specifies $m$ equivalent high-level features for each class label in $\\{1,\\dotsc,n_{c}\\}$ , where each feature has length $s$ and $n_{c}$ is the number of classes. For example, suppose the vocabulary at the top level is $\\mathcal{V}_{L}=\\{a,b,c\\}$ , $n_{c}=2$ , $m=3$ , and $s=2$ . Then in a particular instantiation of this RHM, we might have that Class 1 has $a b$ , aa, and $c a$ as equivalent high-level features (this is precisely the example used in Fig.1 of [67]). Class 2 will then have three random high-level features, with the constraint that they are not features for Class 1, for example, $b b,b c,a c$ . ", "page_idx": 38}, {"type": "text", "text": "Each successive level specifies $m$ equivalent lower-level features for each \u201ctoken\" in the vocabulary at the previous level. For example, if $\\mathcal{V}_{L-1}=\\{d,e,f\\}$ , we might have that $a$ can be equivalently represented as $d e,d f$ , or $f f;b$ and $c$ will each have $m$ equivalent representations of their own. We assume that the vocabulary size, $v$ , is the same at all levels. Therefore, sampling an RHM with hyperparameters $n_{c},m,s,v$ requires sampling $m n_{c}+(L-1)m v$ rules. ", "page_idx": 38}, {"type": "text", "text": "", "page_idx": 39}, {"type": "text", "text": "In order to sample a datapoint from an RHM, we first sample a class label (e.g. Class 1), then uniformly sample one of the highest level features, (e.g. $a b$ ), then for each \u201ctoken\" in this feature we sample lower level features (e.g. $a\\rightarrow d e,b\\rightarrow e e)$ , and so on recursively. The generated sample will therefore have length $s^{L}$ and a class label. For training a neural network to perform this classification task, each input is converted into a one-hot representation, which will be of shape $(s^{L},v)$ , and is then flattened. ", "page_idx": 39}, {"type": "text", "text": "We use the code released by [67] to train an MLP of width 64 with three hidden layers to learn an RHM with $L=3$ , $n_{c}=8,m=4,s=2,v=8$ . The main change we make is allowing for scaling the initialization of the first layer by $1/\\alpha$ and the initialization the readout layer by $\\alpha$ . We then sweep over $\\alpha\\in\\{0.03,0.1,0.3,1,3,10\\}$ and over the number of datapoints in the training set, which is specified as a fraction of the total number of datapoints the RHM can generate. We average test accuracy, which is by default computed on a held-out set of 20,000 samples, over six random seed configurations, where each configuration seeds the RHM, the neural network, and the data generation. ", "page_idx": 39}, {"type": "text", "text": "We train with the default settings used in [67], that is stochastic gradient descent with momentum of 0.9, run for 250 epochs with a learning rate initialized at 6.4 (0.1 times width) and decayed with a cosine schedule down to $80\\%$ of epochs. The batch size of 128; we do not use biases or weight decay. ", "page_idx": 39}, {"type": "text", "text": "Grokking ", "text_level": 1, "page_idx": 39}, {"type": "text", "text": "We are training a one layer transformer model on the modular arithmetic task in Power et al. [68]. Our experimental code is based on an existing Pytorch implementation (code available here). The only modifications to the provided code base is that we use a single transformer layer (instead of the default 2-layer model). Prior analysis in Nanda et al. [72] has shown that this model can learn a minimal (attention-based) circuit that solves the task. ", "page_idx": 39}, {"type": "text", "text": "We study the effects on grokking time (defined as $\\geq0.99$ accuracy on the validation data) of two manipulations. Firstly, we divide the embedding weights of the positional and token embeddings by the same balancedness parameter $\\alpha$ as in the CNN gabor experiments. Secondly, like in Kumar et al. [69], we multiply the output of the model (i.e., the logits) by a factor $\\tau$ and divide the learning rate by $\\tau^{2}$ . ", "page_idx": 39}, {"type": "image", "img_path": "eNM94i7R3A/tmp/fec87ce0ed96aade0cebe177f8e305d8c680737f595ec44f862ab80dffa065f9.jpg", "img_caption": ["Figure 12: Transformer Grokking in Modular Arithmetic Task. A) Shows the number of training steps required until the training accuracy passes a predefined threshold of $99\\%$ ; we sample scaling $\\tau\\bar{\\in}\\ \\{0.5,0.75,1.0,1.25,1.5\\}$ [69] and balance $\\bar{\\alpha^{*}}\\in\\{0.1,0.3,1.0,3.0,10\\}$ on a regular grid over $n=5$ random initializations with a maximal computational budget of $m=30$ , 000 training steps. B) Same as A), but reporting the number of training steps required until the test performance passes the predefined threshold of $\\bar{9}9\\%$ . We clearly see the fastest grokking in an unbalanced rich setting. "], "img_footnote": [], "page_idx": 39}, {"type": "text", "text": "NeurIPS Paper Checklist ", "text_level": 1, "page_idx": 40}, {"type": "text", "text": "1. Claims ", "text_level": 1, "page_idx": 40}, {"type": "text", "text": "Question: Do the main claims made in the abstract and introduction accurately reflect the paper\u2019s contributions and scope? ", "page_idx": 40}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 40}, {"type": "text", "text": "Justification: The abstract clearly lays out the four main contributions sections of our paper (1) a novel minimal model of the transition between rich and lazy learning with exact solutions, (2) extension of this model to more complex linear networks, (3) application of this analysis to shallow nonlinear networks, (4) demonstration of the relevance of the unbalanced rich regime identified in practical deep learning settings. The claims made accurately match the theoretical and experimental results in the paper. These four main contributions (also discussed in our contributions section in Section 1) reflect Section 3, Section 4, and Section 5. ", "page_idx": 40}, {"type": "text", "text": "Guidelines: ", "page_idx": 40}, {"type": "text", "text": "\u2022 The answer NA means that the abstract and introduction do not include the claims made in the paper.   \n\u2022 The abstract and/or introduction should clearly state the claims made, including the contributions made in the paper and important assumptions and limitations. A No or NA answer to this question will not be perceived well by the reviewers.   \n\u2022 The claims made should match theoretical and experimental results, and reflect how much the results can be expected to generalize to other settings.   \n\u2022 It is fine to include aspirational goals as motivation as long as it is clear that these goals are not attained by the paper. ", "page_idx": 40}, {"type": "text", "text": "2. Limitations ", "text_level": 1, "page_idx": 40}, {"type": "text", "text": "Question: Does the paper discuss the limitations of the work performed by the authors? ", "page_idx": 40}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 40}, {"type": "text", "text": "Justification: In the conclusion we address some of our primary limitations, which include the difficulty in extending our theory to deeper nonlinear network settings, as well as discretization and stochastic effects of SGD. On top of that, our theoretical and empirical assumptions are documented and stated throughout the paper and appendix. ", "page_idx": 40}, {"type": "text", "text": "Guidelines: ", "text_level": 1, "page_idx": 40}, {"type": "text", "text": "\u2022 The answer NA means that the paper has no limitation while the answer No means that the paper has limitations, but those are not discussed in the paper.   \n\u2022 The authors are encouraged to create a separate \"Limitations\" section in their paper.   \n\u2022 The paper should point out any strong assumptions and how robust the results are to violations of these assumptions (e.g., independence assumptions, noiseless settings, model well-specification, asymptotic approximations only holding locally). The authors should reflect on how these assumptions might be violated in practice and what the implications would be.   \n\u2022 The authors should reflect on the scope of the claims made, e.g., if the approach was only tested on a few datasets or with a few runs. In general, empirical results often depend on implicit assumptions, which should be articulated.   \n\u2022 The authors should reflect on the factors that influence the performance of the approach. For example, a facial recognition algorithm may perform poorly when image resolution is low or images are taken in low lighting. Or a speech-to-text system might not be used reliably to provide closed captions for online lectures because it fails to handle technical jargon.   \n\u2022 The authors should discuss the computational efficiency of the proposed algorithms and how they scale with dataset size.   \n\u2022 If applicable, the authors should discuss possible limitations of their approach to address problems of privacy and fairness. ", "page_idx": 40}, {"type": "text", "text": "\u2022 While the authors might fear that complete honesty about limitations might be used by reviewers as grounds for rejection, a worse outcome might be that reviewers discover limitations that aren\u2019t acknowledged in the paper. The authors should use their best judgment and recognize that individual actions in favor of transparency play an important role in developing norms that preserve the integrity of the community. Reviewers will be specifically instructed to not penalize honesty concerning limitations. ", "page_idx": 41}, {"type": "text", "text": "3. Theory Assumptions and Proofs ", "text_level": 1, "page_idx": 41}, {"type": "text", "text": "Question: For each theoretical result, does the paper provide the full set of assumptions and a complete (and correct) proof? ", "page_idx": 41}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 41}, {"type": "text", "text": "Justification: For all main theoretical lemmas and theorems we either clearly state assumptions in the theorem statement or we introduce the assumptions earlier in the paper. We focus on high-level intuition in the main body of the text and include complete proofs in the appendix; where each section of the document has a corresponding appendix section. ", "page_idx": 41}, {"type": "text", "text": "Guidelines: ", "page_idx": 41}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include theoretical results.   \n\u2022 All the theorems, formulas, and proofs in the paper should be numbered and crossreferenced.   \n\u2022 All assumptions should be clearly stated or referenced in the statement of any theorems.   \n\u2022 The proofs can either appear in the main paper or the supplemental material, but if they appear in the supplemental material, the authors are encouraged to provide a short proof sketch to provide intuition.   \n\u2022 Inversely, any informal proof provided in the core of the paper should be complemented by formal proofs provided in appendix or supplemental material.   \n\u2022 Theorems and Lemmas that the proof relies upon should be properly referenced. ", "page_idx": 41}, {"type": "text", "text": "4. Experimental Result Reproducibility ", "text_level": 1, "page_idx": 41}, {"type": "text", "text": "Question: Does the paper fully disclose all the information needed to reproduce the main experimental results of the paper to the extent that it affects the main claims and/or conclusions of the paper (regardless of whether the code and data are provided or not)? ", "page_idx": 41}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 41}, {"type": "text", "text": "Justification: We disclose all details needed to reproduce experiments in the paper, particularly in the appendix. We plan to release all code used for reproducing empirical results. Guidelines: ", "page_idx": 41}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 If the paper includes experiments, a No answer to this question will not be perceived well by the reviewers: Making the paper reproducible is important, regardless of whether the code and data are provided or not.   \n\u2022 If the contribution is a dataset and/or model, the authors should describe the steps taken to make their results reproducible or verifiable.   \n\u2022 Depending on the contribution, reproducibility can be accomplished in various ways. For example, if the contribution is a novel architecture, describing the architecture fully might suffice, or if the contribution is a specific model and empirical evaluation, it may be necessary to either make it possible for others to replicate the model with the same dataset, or provide access to the model. In general. releasing code and data is often one good way to accomplish this, but reproducibility can also be provided via detailed instructions for how to replicate the results, access to a hosted model (e.g., in the case of a large language model), releasing of a model checkpoint, or other means that are appropriate to the research performed.   \n\u2022 While NeurIPS does not require releasing code, the conference does require all submissions to provide some reasonable avenue for reproducibility, which may depend on the nature of the contribution. For example (a) If the contribution is primarily a new algorithm, the paper should make it clear how to reproduce that algorithm.   \n(b) If the contribution is primarily a new model architecture, the paper should describe the architecture clearly and fully.   \n(c) If the contribution is a new model (e.g., a large language model), then there should either be a way to access this model for reproducing the results or a way to reproduce the model (e.g., with an open-source dataset or instructions for how to construct the dataset).   \n(d) We recognize that reproducibility may be tricky in some cases, in which case authors are welcome to describe the particular way they provide for reproducibility. In the case of closed-source models, it may be that access to the model is limited in some way (e.g., to registered users), but it should be possible for other researchers to have some path to reproducing or verifying the results. ", "page_idx": 41}, {"type": "text", "text": "", "page_idx": 42}, {"type": "text", "text": "5. Open access to data and code ", "text_level": 1, "page_idx": 42}, {"type": "text", "text": "Question: Does the paper provide open access to the data and code, with sufficient instructions to faithfully reproduce the main experimental results, as described in supplemental material? ", "page_idx": 42}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 42}, {"type": "text", "text": "Justification: Some of our experimental results use existing open-source codebases; for those we provide specific instructions on how to reproduce results. For the rest of our experiments we plan to release code with instructions for faithful reproduction outlined in the appendix. ", "page_idx": 42}, {"type": "text", "text": "Guidelines: ", "page_idx": 42}, {"type": "text", "text": "\u2022 The answer NA means that paper does not include experiments requiring code.   \n\u2022 Please see the NeurIPS code and data submission guidelines (https://nips.cc/ public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 While we encourage the release of code and data, we understand that this might not be possible, so \u201cNo\u201d is an acceptable answer. Papers cannot be rejected simply for not including code, unless this is central to the contribution (e.g., for a new open-source benchmark).   \n\u2022 The instructions should contain the exact command and environment needed to run to reproduce the results. See the NeurIPS code and data submission guidelines (https: //nips.cc/public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 The authors should provide instructions on data access and preparation, including how to access the raw data, preprocessed data, intermediate data, and generated data, etc.   \n\u2022 The authors should provide scripts to reproduce all experimental results for the new proposed method and baselines. If only a subset of experiments are reproducible, they should state which ones are omitted from the script and why.   \n\u2022 At submission time, to preserve anonymity, the authors should release anonymized versions (if applicable).   \n\u2022 Providing as much information as possible in supplemental material (appended to the paper) is recommended, but including URLs to data and code is permitted. ", "page_idx": 42}, {"type": "text", "text": "6. Experimental Setting/Details ", "text_level": 1, "page_idx": 42}, {"type": "text", "text": "Question: Does the paper specify all the training and test details (e.g., data splits, hyperparameters, how they were chosen, type of optimizer, etc.) necessary to understand the results? ", "page_idx": 42}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 42}, {"type": "text", "text": "Justification: We make sure to outline all necessary details for faithful reproduction of our deep learning experiments in the appendix. Sufficient detail to appreciate and make sense of the empirical results is presented in the main paper with specific details placed in the appendix. ", "page_idx": 42}, {"type": "text", "text": "Guidelines: ", "page_idx": 42}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments. \u2022 The experimental setting should be presented in the core of the paper to a level of detail that is necessary to appreciate the results and make sense of them. \u2022 The full details can be provided either with the code, in appendix, or as supplemental material. ", "page_idx": 42}, {"type": "text", "text": "7. Experiment Statistical Significance ", "text_level": 1, "page_idx": 43}, {"type": "text", "text": "Question: Does the paper report error bars suitably and correctly defined or other appropriate information about the statistical significance of the experiments? ", "page_idx": 43}, {"type": "text", "text": "Answer: [Yes] . ", "page_idx": 43}, {"type": "text", "text": "Justification: For our main empirical results, shown in Figure 5, we make sure to run each experiment with multiple seeds and we provide standard deviations on all plots. Details on how we average over seeds are outlined carefully in the appendix. ", "page_idx": 43}, {"type": "text", "text": "Guidelines: ", "page_idx": 43}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The authors should answer \"Yes\" if the results are accompanied by error bars, confidence intervals, or statistical significance tests, at least for the experiments that support the main claims of the paper.   \n\u2022 The factors of variability that the error bars are capturing should be clearly stated (for example, train/test split, initialization, random drawing of some parameter, or overall run with given experimental conditions).   \n\u2022 The method for calculating the error bars should be explained (closed form formula, call to a library function, bootstrap, etc.)   \n\u2022 The assumptions made should be given (e.g., Normally distributed errors).   \n\u2022 It should be clear whether the error bar is the standard deviation or the standard error of the mean.   \n\u2022 It is OK to report 1-sigma error bars, but one should state it. The authors should preferably report a 2-sigma error bar than state that they have a $96\\%$ CI, if the hypothesis of Normality of errors is not verified.   \n\u2022 For asymmetric distributions, the authors should be careful not to show in tables or figures symmetric error bars that would yield results that are out of range (e.g. negative error rates).   \n\u2022 If error bars are reported in tables or plots, The authors should explain in the text how they were calculated and reference the corresponding figures or tables in the text. ", "page_idx": 43}, {"type": "text", "text": "8. Experiments Compute Resources ", "text_level": 1, "page_idx": 43}, {"type": "text", "text": "Question: For each experiment, does the paper provide sufficient information on the computer resources (type of compute workers, memory, time of execution) needed to reproduce the experiments? ", "page_idx": 43}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 43}, {"type": "text", "text": "Justification: We provide estimates of the total runtime and compute type required to reproduce our results. We also provide estimates of our total runtime including failed experiments. ", "page_idx": 43}, {"type": "text", "text": "Guidelines: ", "page_idx": 43}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The paper should indicate the type of compute workers CPU or GPU, internal cluster, or cloud provider, including relevant memory and storage.   \n\u2022 The paper should provide the amount of compute required for each of the individual experimental runs as well as estimate the total compute.   \n\u2022 The paper should disclose whether the full research project required more compute than the experiments reported in the paper (e.g., preliminary or failed experiments that didn\u2019t make it into the paper). ", "page_idx": 43}, {"type": "text", "text": "9. Code Of Ethics ", "text_level": 1, "page_idx": 43}, {"type": "text", "text": "Question: Does the research conducted in the paper conform, in every respect, with the NeurIPS Code of Ethics https://neurips.cc/public/EthicsGuidelines? ", "page_idx": 43}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 43}, {"type": "text", "text": "Justification: We make sure to conform with the NeurIPS Code of Ethics. Items in the code particularly relevant to our work pertain to disclosing details necessary for reproducibility. Guidelines: ", "page_idx": 43}, {"type": "text", "text": "\u2022 The answer NA means that the authors have not reviewed the NeurIPS Code of Ethics.   \n\u2022 If the authors answer No, they should explain the special circumstances that require a deviation from the Code of Ethics.   \n\u2022 The authors should make sure to preserve anonymity (e.g., if there is a special consideration due to laws or regulations in their jurisdiction). ", "page_idx": 44}, {"type": "text", "text": "10. Broader Impacts ", "text_level": 1, "page_idx": 44}, {"type": "text", "text": "Question: Does the paper discuss both potential positive societal impacts and negative societal impacts of the work performed? ", "page_idx": 44}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 44}, {"type": "text", "text": "Justification: This paper is primarily a theoretical paper attempting to better understand one of the great mysteries of deep learning, how neural networks acquire task-relevant features. We do not see a direct path to negative applications of our work. ", "page_idx": 44}, {"type": "text", "text": "Guidelines: ", "page_idx": 44}, {"type": "text", "text": "\u2022 The answer NA means that there is no societal impact of the work performed.   \n\u2022 If the authors answer NA or No, they should explain why their work has no societal impact or why the paper does not address societal impact.   \n\u2022 Examples of negative societal impacts include potential malicious or unintended uses (e.g., disinformation, generating fake profiles, surveillance), fairness considerations (e.g., deployment of technologies that could make decisions that unfairly impact specific groups), privacy considerations, and security considerations.   \n\u2022 The conference expects that many papers will be foundational research and not tied to particular applications, let alone deployments. However, if there is a direct path to any negative applications, the authors should point it out. For example, it is legitimate to point out that an improvement in the quality of generative models could be used to generate deepfakes for disinformation. On the other hand, it is not needed to point out that a generic algorithm for optimizing neural networks could enable people to train models that generate Deepfakes faster.   \n\u2022 The authors should consider possible harms that could arise when the technology is being used as intended and functioning correctly, harms that could arise when the technology is being used as intended but gives incorrect results, and harms following from (intentional or unintentional) misuse of the technology.   \n\u2022 If there are negative societal impacts, the authors could also discuss possible mitigation strategies (e.g., gated release of models, providing defenses in addition to attacks, mechanisms for monitoring misuse, mechanisms to monitor how a system learns from feedback over time, improving the efficiency and accessibility of ML). ", "page_idx": 44}, {"type": "text", "text": "11. Safeguards ", "text_level": 1, "page_idx": 44}, {"type": "text", "text": "Question: Does the paper describe safeguards that have been put in place for responsible release of data or models that have a high risk for misuse (e.g., pretrained language models, image generators, or scraped datasets)? ", "page_idx": 44}, {"type": "text", "text": "Answer: [NA] ", "text_level": 1, "page_idx": 44}, {"type": "text", "text": "Justification: Our paper does not introduce new models or datasets that are not already open sourced or published. ", "page_idx": 44}, {"type": "text", "text": "Guidelines: ", "page_idx": 44}, {"type": "text", "text": "\u2022 The answer NA means that the paper poses no such risks.   \n\u2022 Released models that have a high risk for misuse or dual-use should be released with necessary safeguards to allow for controlled use of the model, for example by requiring that users adhere to usage guidelines or restrictions to access the model or implementing safety filters.   \n\u2022 Datasets that have been scraped from the Internet could pose safety risks. The authors should describe how they avoided releasing unsafe images.   \n\u2022 We recognize that providing effective safeguards is challenging, and many papers do not require this, but we encourage authors to take this into account and make a best faith effort. ", "page_idx": 44}, {"type": "text", "text": "12. Licenses for existing assets ", "text_level": 1, "page_idx": 45}, {"type": "text", "text": "Question: Are the creators or original owners of assets (e.g., code, data, models), used in the paper, properly credited and are the license and terms of use explicitly mentioned and properly respected? ", "page_idx": 45}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 45}, {"type": "text", "text": "Justification: We make sure to cite the papers whose open-source code or datasets we used for our experiments. ", "page_idx": 45}, {"type": "text", "text": "Guidelines: ", "page_idx": 45}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not use existing assets.   \n\u2022 The authors should cite the original paper that produced the code package or dataset.   \n\u2022 The authors should state which version of the asset is used and, if possible, include a URL.   \n\u2022 The name of the license (e.g., CC-BY 4.0) should be included for each asset.   \n\u2022 For scraped data from a particular source (e.g., website), the copyright and terms of service of that source should be provided.   \n\u2022 If assets are released, the license, copyright information, and terms of use in the package should be provided. For popular datasets, paperswithcode.com/datasets has curated licenses for some datasets. Their licensing guide can help determine the license of a dataset.   \n\u2022 For existing datasets that are re-packaged, both the original license and the license of the derived asset (if it has changed) should be provided.   \n\u2022 If this information is not available online, the authors are encouraged to reach out to the asset\u2019s creators. ", "page_idx": 45}, {"type": "text", "text": "13. New Assets ", "text_level": 1, "page_idx": 45}, {"type": "text", "text": "Question: Are new assets introduced in the paper well documented and is the documentation provided alongside the assets? ", "page_idx": 45}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 45}, {"type": "text", "text": "Justification: We do not release any new assets. ", "page_idx": 45}, {"type": "text", "text": "Guidelines: ", "page_idx": 45}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not release new assets.   \n\u2022 Researchers should communicate the details of the dataset/code/model as part of their submissions via structured templates. This includes details about training, license, limitations, etc.   \n\u2022 The paper should discuss whether and how consent was obtained from people whose asset is used.   \n\u2022 At submission time, remember to anonymize your assets (if applicable). You can either create an anonymized URL or include an anonymized zip file. ", "page_idx": 45}, {"type": "text", "text": "14. Crowdsourcing and Research with Human Subjects ", "text_level": 1, "page_idx": 45}, {"type": "text", "text": "Question: For crowdsourcing experiments and research with human subjects, does the paper include the full text of instructions given to participants and screenshots, if applicable, as well as details about compensation (if any)? ", "page_idx": 45}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 45}, {"type": "text", "text": "Justification: This paper does not involve crowdsourcing nor research with human subjects. Guidelines: ", "page_idx": 45}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Including this information in the supplemental material is fine, but if the main contribution of the paper involves human subjects, then as much detail as possible should be included in the main paper.   \n\u2022 According to the NeurIPS Code of Ethics, workers involved in data collection, curation, or other labor should be paid at least the minimum wage in the country of the data collector. ", "page_idx": 45}, {"type": "text", "text": "15. Institutional Review Board (IRB) Approvals or Equivalent for Research with Human Subjects ", "text_level": 1, "page_idx": 46}, {"type": "text", "text": "Question: Does the paper describe potential risks incurred by study participants, whether such risks were disclosed to the subjects, and whether Institutional Review Board (IRB) approvals (or an equivalent approval/review based on the requirements of your country or institution) were obtained? ", "page_idx": 46}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 46}, {"type": "text", "text": "Justification: This paper does not involve human study experiments and as such IRB approvals are not relevant to our work. ", "page_idx": 46}, {"type": "text", "text": "Guidelines: ", "text_level": 1, "page_idx": 46}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Depending on the country in which research is conducted, IRB approval (or equivalent) may be required for any human subjects research. If you obtained IRB approval, you should clearly state this in the paper.   \n\u2022 We recognize that the procedures for this may vary significantly between institutions and locations, and we expect authors to adhere to the NeurIPS Code of Ethics and the guidelines for their institution.   \n\u2022 For initial submissions, do not include any information that would break anonymity (if applicable), such as the institution conducting the review. ", "page_idx": 46}]