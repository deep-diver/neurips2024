[{"type": "text", "text": "S-SOS: Stochastic Sum-Of-Squares for Parametric Polynomial Optimization ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Richard L. Zhu Department of Computational and Applied Mathematics University of Chicago Chicago, IL 60637 richardzhu@uchicago.edu ", "page_idx": 0}, {"type": "text", "text": "Mathias Oster \u2217 Institute of Geometry and Practical Mathematics RWTH Aachen Aachen, Germany oster@igpm.rwth-aachen.de ", "page_idx": 0}, {"type": "text", "text": "Yuehaw Khoo   \nDepartment of Statistics   \nUniversity of Chicago   \nChicago, IL 60637   \nyuehaw.khoo@uchicago.edu ", "page_idx": 0}, {"type": "text", "text": "Abstract ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Global polynomial optimization is an important tool across applied mathematics, with many applications in operations research, engineering, and the physical sciences. In various settings, the polynomials depend on external parameters that may be random. We discuss a stochastic sum-of-squares (S-SOS) algorithm based on the sum-of-squares hierarchy that constructs a series of semidefinite programs to jointly find strict lower bounds on the global minimum and extract candidates for parameterized global minimizers. We prove quantitative convergence of the hierarchy as the degree increases and use it to solve unconstrained and constrained polynomial optimization problems parameterized by random variables. By employing $n$ -body priors from condensed matter physics to induce sparsity, we can use S-SOS to produce solutions and uncertainty intervals for sensor network localization problems containing up to 40 variables and semidefinite matrix sizes surpassing $800\\times800$ . ", "page_idx": 0}, {"type": "text", "text": "1 Introduction ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Many effective nonlinear and nonconvex optimization techniques use local information to identify local minima. But it is often the case that we want to find global optima. Sum-of-squares (SOS) optimization is a powerful and general technique in this setting. ", "page_idx": 0}, {"type": "text", "text": "The core idea is as follows: suppose we are given polynomials $g_{1},\\ldots,g_{m},f$ where each function is on $\\mathbb{R}^{n}\\to\\mathbb{R}$ and we seek to determine the minimum value of $f$ on the closed set $\\boldsymbol{S}$ : $S=\\{x\\in$ $\\mathbb{R}^{n}\\mid g_{i}(x)\\geq0\\;\\forall\\;i=1,\\ldots,m\\}$ . Our optimization problem is then to find $\\operatorname*{inf}_{x\\in\\mathbb{R}^{n}}\\{f(x)|x\\in S\\}$ ", "page_idx": 0}, {"type": "text", "text": "An equivalent formulation is to find the largest constant $c\\in\\mathbb R$ (i.e. the tightest lower bound) that can be subtracted from $f$ such that $f-c\\geq0$ over the set $\\boldsymbol{S}$ . This reduction converts a polynomial optimization problem over a semialgebraic set to the problem of checking polynomial non-negativity. This problem is NP-hard in general [1], therefore one instead resorts to checking if $f-c$ is a sum-of-squares (SOS) function, e.g. in the unconstrained setting where $S=\\mathbb{R}^{n}$ one seeks to find some polynomials $h_{k}:\\mathbb{R}^{n}\\rightarrow\\mathbb{R}$ such that $\\begin{array}{r}{f-c=\\sum_{k}h_{k}^{2}}\\end{array}$ . If such a decomposition can be found, then we have an easily-checkable certification that $f-c\\geq0$ , as all sum-of-squares are non-negative. Since the converse is not true (not all non-negative functions are sum-of-squares), this is a relaxation of the original non-negativity problem. ", "page_idx": 1}, {"type": "text", "text": "Notably, if we restrict the $h_{k}$ to have maximum degree $d$ , the search for a degree- $2d$ SOS decomposition of a function can be automated as a semidefinite program (SDP) [2, 3, 4]. Solving this SDP for varying degrees $d$ generates the well-known Lasserre (SOS) hierarchy. A given degree $d$ corresponds to a particular level of the hierarchy. Solving this SDP produces a lower bound $c_{d}$ which has been proven to converge to the true global minimum $c^{*}=\\operatorname*{inf}_{x}f(x)$ as $d$ increases, with finite convergence $c_{d}=c^{*}$ at finite $d$ ) for functions with second-order local optimality conditions [5, 6] and asymptotic convergence with milder assumptions thanks to representation theorems for positive polynomials from real algebraic geometry [7, 8, 9]. Further work has elucidated both theoretical implications [7, 3, 10, 11, 12, 13] and useful applications of SOS to disparate fields [14, 15, 16, 5, 6, 17, 18] (see further discussion in Appendix A.2). ", "page_idx": 1}, {"type": "text", "text": "Motivated by the sum-of-squares certification for a lower bound $c$ on a function $f(x)$ , we generalize to the case where the function to be minimized has additional parameters, i.e. $f(x,\\omega)$ where $x$ are variables and $\\omega$ are parameters drawn from some probability distribution $\\omega\\sim\\nu(\\omega)$ . We seek a function $c(\\omega)$ that is the tightest lower bound to $f(x,\\omega)$ everywhere: $f(x,\\omega)\\ge c(\\omega)$ with $c(\\omega)\\to\\operatorname*{inf}_{x}f(x,\\stackrel{\\cdot}{\\omega})$ . This setting was originally presented in [19] as a \u201cJoint and Marginal\u201d approach to parametric polynomial optimization. With the view that $\\omega\\sim\\nu(\\omega)$ and seeking to parameterize the minimizers $x^{*}(\\omega)=\\mathrm{argmin}_{x}f(x,\\omega)$ , we are reminded of some of the prior work in polynomial chaos, where a system of stochastic variables is expanded into a deterministic function of those stochastic variables [20, 21]. ", "page_idx": 1}, {"type": "text", "text": "Contributions and outline. Our primary contributions are a quantitative convergence proof for the Stochastic Sum-of-Squares (S-SOS) hierarchy of semidefinite programs (SDPs), a formulation of a new hierarchy (the cluster basis hierarchy) that uses the structure of a problem to sparsify the SDP, and numerical results on its application to the sensor network localization problem. ", "page_idx": 1}, {"type": "text", "text": "In Section 2, we review the S-SOS hierarchy of SDPs [19] and its primal and dual formulations (Section 2.1). We then detail how different hierarchies can be constructed (Section 2.2.1). Finally, in Section 2.3 (complete proof in Appendix A.5.2) we specialize to compact $X\\times\\Omega$ and outline the proof for a theorem on quantitative convergence (the gap between the optimal values of the degree- $2s$ S-SOS SDP and the \u201ctightest lower-bounding\u201d optimization problem goes $\\rightarrow0$ as $s\\to\\infty$ ) of the S-SOS hierarchy for trigonometric polynomials on $[0,1]^{n}\\times[0,^{\\bullet}]^{d}$ following the kernel formalism of [22, 6, 23]. ", "page_idx": 1}, {"type": "text", "text": "In Section 3 we review the hierarchy\u2019s applications in parametric polynomial minimization and uncertainty quantification, focusing on several variants of sensor network localization on $X\\times\\Omega=$ $[-1,1]^{n}\\times[-1,1]^{d}$ . We present numerical results for the accuracy of the extracted solutions that result from S-SOS, comparing to other approaches to parametric polynomial optimization, including a simple Monte Carlo-based method. ", "page_idx": 1}, {"type": "text", "text": "2 Stochastic Sum-of-squares (S-SOS) ", "text_level": 1, "page_idx": 1}, {"type": "text", "text": "2.0.1 Notation ", "text_level": 1, "page_idx": 1}, {"type": "text", "text": "Let ${\\mathcal{P}}(S)$ be the space of polynomials on $S$ , where $S\\in\\{X,\\Omega\\}$ . $X\\subseteq\\mathbb{R}^{n}$ and $\\Omega\\subseteq\\mathbb{R}^{d}$ , respectively, where $X$ and $\\Omega$ are (not-necessarily compact) subsets of their respective ambient spaces $\\mathbb{R}^{n}$ and $\\mathbb{R}^{d}$ . A polynomial in ${\\mathcal{P}}(X)$ can be written as $\\begin{array}{r}{p(x)\\,=\\,\\sum_{\\alpha\\in\\mathbb{Z}_{\\geq0}^{n}}{c_{\\alpha}\\overset{\\cdot}{x}^{\\alpha}}\\in\\mathcal{P}(X)}\\end{array}$ (substituting $n\\rightarrow$ $d,x\\to\\omega,X\\to\\Omega$ for a polynomial in $\\mathcal{P}(\\Omega))$ . Let $x:=({\\overline{{x_{1}}}},\\ldots,x_{n}),\\omega:=(\\omega_{1},\\ldots,\\omega_{d})$ , $\\alpha$ be a multi-index (size given by context), and $c_{\\alpha}$ be the polynomial coefficients. Let $\\mathcal{P}^{s}(S)$ for some $s\\in\\mathbb{Z}_{\\geq0},S\\in\\{X,\\Omega\\}$ denote the subspace of ${\\mathcal{P}}(S)$ consisting of polynomials of degree $\\le s$ , i.e. polynomials where the multi-indices of the monomial terms satisfy $\\bar{||\\alpha||_{1}}\\leq s.\\;\\mathcal{P}_{\\mathrm{SOS}}(\\bar{X}\\times\\Omega)$ refers to the space of polynomials on $X\\times\\Omega$ that can be expressible as a sum-of-squares in $x$ and $\\omega$ jointly, and $\\bar{\\mathcal{P}_{\\mathrm{SOS}}^{s}}(X\\times\\bar{\\Omega})$ be the same space restricted to polynomials of degree $\\le s$ . Additionally, $W\\succcurlyeq0$ for a matrix $W$ denotes that $W$ is symmetric positive semidefinite (PSD). Finally, $\\mathbb{P}(\\Omega)$ denotes the set of Lebesgue probability measures on $\\Omega$ . For more details, see Appendix A.1. ", "page_idx": 1}, {"type": "text", "text": "", "page_idx": 2}, {"type": "text", "text": "2.1 Formulation of S-SOS hierarchy ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "We present two formulations of the S-SOS hierarchy that are dual to each other in the sense of Fenchel duality [24, 25]. The primal problem seeks to find the tightest lower-bounding function and the dual problem seeks to find a minimizing probability distribution. Note that the \u201ctightest lower bound\u201d approach is dual to the \u201cminimizing distribution\u201d approach, otherwise known as a \u201cjoint and marginal\u201d moment-based approach originally detailed in [19]. ", "page_idx": 2}, {"type": "text", "text": "2.1.1 Primal S-SOS: The tightest lower-bounding function ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "Consider a polynomial $f(\\boldsymbol{x},\\omega):\\mathbb{R}^{n+d}\\rightarrow\\mathbb{R}$ with $x\\,\\in\\,X\\,\\subseteq\\,\\mathbb{R}^{n},\\omega\\,\\in\\,\\Omega\\,\\subseteq\\,\\mathbb{R}^{d}$ equipped with a probability measure $\\nu(\\omega)$ . We interpret $x$ as our optimization variables and $\\omega$ as noise parameters, and seek a lower-bounding function $c^{*}(\\omega)$ such that $f(x,\\omega)\\geq c^{*}(\\omega)$ for all $x,\\omega$ . In particular, we want the tightest lower bound $c^{*}(\\omega)=\\operatorname*{inf}_{x\\in X}f(x,\\omega)$ . Note that even when $f(x,\\omega)$ is polynomial, the tightest lower bound $c^{*}(\\omega)$ can be non-polynomial. A simple example is the function $f(x,\\omega)=$ $(x-{\\bar{\\omega}})^{2}+(\\omega x)^{2}$ , which has $c^{*}(\\omega)=\\operatorname*{inf}_{x}^{*}f(x,\\omega)=\\omega^{4}/(1^{*}\\omega^{2})$ (Appendix A.6.1). ", "page_idx": 2}, {"type": "text", "text": "For us to select the \u201cbest\u201d lower-bounding function, we want to maximize the expectation of the lower-bounding function $c(\\omega)$ under $\\omega_{.}\\sim\\nu(\\omega)$ while requiring $f(x,\\omega)-c(\\omega)\\geq\\bar{0}$ , giving us the following optimization problem over $L^{1}$ -integrable lower-bounding functions: ", "page_idx": 2}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{p^{*}=\\underset{c\\in L^{1}(\\Omega)}{\\operatorname*{sup}}}&{\\displaystyle\\int c(\\omega)\\mathrm{d}\\nu(\\omega)}\\\\ {\\mathrm{s.t.}}&{f(x,\\omega)-c(\\omega)\\ge0}\\end{array}\n$$", "text_format": "latex", "page_idx": 2}, {"type": "text", "text": "Even if we restricted $c(\\omega)$ to be polynomial so that the residual $f(x,\\omega)-c(\\omega)$ is also polynomial, we would still have a challenging nonconvex optimization problem over non-negative polynomials. In SOS optimization, we take a relaxation and require the residual to be SOS: $f(x,\\omega)-c(\\omega)\\in$ $\\mathcal{P}_{\\mathrm{SOS}}(X\\times\\Omega)$ . Doing the SOS relaxation of the non-negative Equation (1) and restricting $c(\\omega)$ , i.e. $f(x,\\omega)-c(\\omega)$ to polynomials of degree $\\leq2s$ gives us Equation (2), which we call the primal S-SOS degree- $2s$ SDP: ", "page_idx": 2}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{p_{2s}^{*}=\\underset{c\\in\\mathcal{P}^{2s}(\\Omega),W\\succeq0}{\\operatorname*{sup}}}&{{}\\int c(\\omega)\\mathrm{d}\\nu(\\omega)}\\\\ {\\mathrm{s.t.}}&{{}f(x,\\omega)-c(\\omega)=m_{s}(x,\\omega)^{T}W m_{s}(x,\\omega)}\\end{array}\n$$", "text_format": "latex", "page_idx": 2}, {"type": "text", "text": "where $m_{s}(x,\\omega)$ is a basis function $X\\times\\Omega\\,\\rightarrow\\,\\mathbb{R}^{a(n,d,s)}$ containing monomial terms of degree $\\le\\ s$ written as a column vector, and $W\\ \\in\\ \\mathbb{R}^{a(n,d,s)\\times a(n,d,s)}$ a symmetric PSD matrix. Here, $a(n,d,s)$ represents the dimension of the basis function, which depends on the degree $s$ and on the dimensions $n,d$ . For this formulation to find the best degree- $.2s$ approximation to the lowerbounding function, we require $g(x,\\omega)=m_{s}(x,\\omega)^{T}W m_{s}(x,\\bar{\\omega})$ to span $\\bar{\\mathcal{P}}^{2s}(X\\times\\Omega)$ . Selecting all combinations of standard monomial terms of degree $\\le s$ suffices and results in a basis function with size $a(n,d,s)={\\binom{n+d+s}{s}}$ . ", "page_idx": 2}, {"type": "text", "text": "2.1.2 Dual S-SOS: A minimizing distribution ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "The formal dual to Equation (1) (proof of duality in Appendix A.5.1) seeks to find a \u201cminimizing distribution\u201d $\\mu(x,\\omega)$ , i.e. a probability distribution that places weight on the minimizers of $f(x,\\omega)$ subject to the constraint that the marginal $\\mu_{X}(\\omega)$ matches $\\nu(\\omega)$ : ", "page_idx": 2}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{d^{*}=\\underset{\\mu\\in\\mathbb{P}(X\\times\\Omega)}{\\operatorname*{inf}}}&{{}\\displaystyle\\int f(x,\\omega)\\mathrm{d}\\mu(x,\\omega)}\\\\ {\\mathrm{s.t.}}&{{}\\displaystyle\\int_{X}\\mathrm{d}\\mu(x,\\omega)=\\mu_{X}(\\omega)=\\nu(\\omega)}\\end{array}\n$$", "text_format": "latex", "page_idx": 2}, {"type": "text", "text": "where we have written $\\mathbb{P}(X\\times\\Omega)$ as the space of joint probability distributions on $X\\times\\Omega$ and $\\mu_{X}(\\omega)$ is the marginal of $\\mu(x,\\omega)$ with respect to $\\omega$ , obtained via disintegration. ", "page_idx": 3}, {"type": "text", "text": "For the primal, we considered polynomials of degree $\\le~2s$ . We do the same here. The formal dual becomes a tractable SDP, where the objective turns into moment-minimization and the constraints become moment-matching. Following [3, 15], let $M\\in\\mathbb{R}^{a(n,d,s)\\times a(n,d,s)}$ be the symmetric PSD moment matrix with entries defined as $\\begin{array}{r}{M_{i,j}\\,=\\,\\int_{X\\times\\Omega}m_{s}^{(i)}(x,\\omega)m_{s}^{(j)}(x,\\omega)d\\mu(x,\\omega)}\\end{array}$ where $m_{s}^{(i)}(x,\\omega)$ is the $i$ -th element of the basis function $m_{s}$ . Let $\\boldsymbol{y}\\,\\in\\,\\mathbb{R}^{b(n,d,s)}$ be the moment vector of independent moments that completely specifies $M$ , e.g. in the case that we use all standard monomials of degree $\\le\\,s$ and have $a(n,d,s)\\,=\\,{\\binom{n+d+s}{s}}$ n+sd+s , then b(n, d, s) = n+d+2s . We write $M(y)$ as the moment matrix that is formed from these independent moments. We have $\\begin{array}{r}{y_{\\alpha(i,j)}=\\int_{X\\times\\Omega}m_{s}^{(i)}(x,\\omega)m_{s}^{(j)}(x,\\omega)d\\mu(x,\\omega)}\\end{array}$ where the multi-index $\\alpha(i,j)\\in\\mathbb{Z}_{\\geq0}^{n+d}$ corresponds to the sum of the multi-indices corresponding to the $i$ -th entry and the $j$ -th entry of $m_{s}(x,\\omega)$ . ", "page_idx": 3}, {"type": "text", "text": "We write $f(x,\\omega)$ in terms of the monomials $\\begin{array}{r}{f(x,\\omega)=\\sum_{||\\alpha||_{1}\\leq2s}f_{\\alpha}[x,\\omega]^{\\alpha}}\\end{array}$ , where $[x,\\omega]$ is the concatenation of the $n+d$ variables from $x,\\omega$ and $\\alpha\\in\\mathbb{Z}_{\\geq0}^{n+d}$ is a multi-index. Note that every monomial $[x,\\omega]^{\\alpha}$ has a corresponding moment $y_{\\alpha}$ $:\\textstyle\\int[x,\\omega]^{\\alpha}\\mathrm{\\bar{d}}\\mu(x,\\omega)=y_{\\alpha}$ . We then observe that the integral in the objective reduces to a dot product between the coefficients of $f$ and the moment vector: ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\int f(x,\\omega)\\mathrm{d}\\mu(x,\\omega)=\\int\\sum_{\\alpha}f_{\\alpha}[x,\\omega]^{\\alpha}\\mathrm{d}\\mu(x,\\omega)=\\sum_{\\alpha}f_{\\alpha}y_{\\alpha}\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "After converting the distribution-matching constraint $\\mu_{X}(\\omega)=\\nu(\\omega)$ in (3) into equality constraints on the moments of $\\omega$ up to degree $2s$ , we obtain the following dual S-SOS degree- $.2s$ SDP: ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{d_{2s}^{*}=\\displaystyle\\operatorname*{inf}_{y\\in\\mathbb{R}^{b(n,d,s)}}}&{\\displaystyle\\sum_{||\\alpha||_{1}\\leq2s}f_{\\alpha}y_{\\alpha}}\\\\ {\\mathrm{s.t.}}&{M(y)\\succcurlyeq0}\\\\ &{y_{\\alpha}=m_{\\alpha}\\rtimes(\\alpha,m_{\\alpha})\\in\\mathcal{M}_{\\nu}}\\end{array}\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "We write $\\mathcal{M}_{\\nu}$ as the set of $(\\alpha,m_{\\alpha})$ representing the moment-matching constraints on $\\omega^{\\alpha}$ up to degree- $.2s$ , i.e. we want to set $\\begin{array}{r}{\\int_{X\\times\\Omega}\\dot{\\omega}^{\\alpha}\\mathrm{d}\\mu(x,\\bar{\\omega})\\;=\\;\\int_{\\Omega}\\omega^{\\alpha}\\mathrm{d}\\nu(\\omega)\\;=\\;\\bar{\\;}m_{\\alpha}}\\end{array}$ for all multi-indices $\\alpha\\in\\mathbb{Z}_{\\geq0}^{d}$ with $||\\alpha||_{1}\\leq2s$ . There are $\\binom{d+2s}{2s}$ multi-indices $\\alpha\\in\\mathbb{Z}_{\\geq0}^{n+d},||\\alpha||_{1}\\leq2s$ where only the $d$ entries associated with $\\omega$ are non-zero, and therefore the number of moment-matching constraints is $|\\mathcal{M}_{\\nu}|=\\binom{d+2s}{2s}$ . Note that the moment matrix $M(y)\\in\\mathbb{R}^{a(n,d,s)\\times a(n,d,s)}$ is a symmetric PSD matrix and is the dual variable to the primal $W$ . Observe also that we require the moments of $\\nu(\\omega)$ of degree up to $2s$ to be bounded. (4) is often a more convenient form than (2), especially when working with additional equality or inequality constraints, as we will see in Section 3. For concrete examples of the primal and dual SDPs with explicit constraints, see Appendix A.3. ", "page_idx": 3}, {"type": "text", "text": "2.2 Variations ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "In this section, we detail two ways of building a hierarchy, one based on the maximum degree of monomial terms in the basis function (Lasserre) and a novel one based on the maximum number of interactions occurring in the terms of the basis function (cluster basis). To define any SOS hierarchy, we first select a monomial basis. Some examples include the standard monomial basis $x_{1},\\ldots,x_{n}$ , trigonometric/Fourier 1-periodic monomial basis $\\sin x_{1},\\cos x_{1},\\ldots,\\sin x_{n},\\cos x_{n})$ , or others. Using this basis, we write down a basis function $m(x)$ which comprises some combinations of monomials. Squared linear combinations of the basis functions then span a SOS space of functions: $\\mathcal{H}:\\{(\\sum_{i}h_{i}m_{i}(\\dot{x}))^{2}\\}$ . ", "page_idx": 3}, {"type": "text", "text": "2.2.1 Standard Lasserre hierarchy ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "In the Lasserre hierarchy, the basis function $m_{s}(x)$ is composed of all combinations of monomials up to degree $s\\in\\mathbb{Z}_{>0}$ and a given level of the hierarchy is set by the maximum degree $s$ . The basis function consists of terms $x^{\\alpha}$ with $\\alpha$ a multi-index and $||\\alpha||_{1}\\leq\\,s$ . The degree- $.2s$ SOS function space parameterized by this basis function is that spanned by $m_{s}(x)^{T}W m_{s}(\\bar{x})$ for PSD $W$ , i.e. the functions that can result from squaring any linear combination of degree-s polynomials that can be generated from our basis $m_{s}(x)$ . As we increase the degree $s$ , our basis function gets larger and our S-SOS SDP objective values converge to the optimal value of the \u201ctightest lower-bounding\u201d problem Equation (1) [19]. ", "page_idx": 3}, {"type": "text", "text": "", "page_idx": 4}, {"type": "text", "text": "2.2.2 Cluster basis hierarchy ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "In this section, we propose a cluster basis hierarchy, wherein we utilize possible spatial organization of the problem to sparsify the problem and reduce the size of the SDP that must be solved [26, 27]. The cluster basis is a physically motivated prior often used in statistical and condensed matter physics, where we assume that our degrees of freedom can be arrayed in space, with locally close variables interacting strongly (kept in the model) and globally separated variables interacting weakly (ignored). Moreover, one may also keep only the terms with interactions between a small number of degrees of freedom, such as considering only pairwise or triplet interactions between particles. ", "page_idx": 4}, {"type": "text", "text": "In the cluster basis hierarchy, a given level of the hierarchy is specified by a 2-tuple $(b,t)$ , the desired body order $b$ and the maximum degree of a single variable $t$ . Body order denotes the maximum number of interacting variables in a given monomial term, e.g. $x_{i}^{a}x_{j}^{b}x_{k}^{c}$ would have body order 3 and total degree $a+b+c$ . The basis function $m_{b,t}$ consists of terms $x^{\\alpha}$ with $\\alpha$ a multi-index, $||\\alpha||_{0}\\leq b$ (at most $b$ interacting variables can occur in a single term), and $||\\alpha||_{\\infty}\\leq t$ (each variable can have up to degree $t$ . The maximum degree of the basis function $m_{b,t}$ is then $s=b t$ . If we are to compare $m_{b,t}$ from the cluster basis hierarchy with $m_{s}$ from the Lasserre hierarchy, we find that even when $b t=s$ we still have strictly fewer terms, e.g. in the case where $b=2,t=2,s=4$ we have $m_{s}$ containing terms of the form xi4 but mb,t only has degree-4 terms of the xi2 xj2. ", "page_idx": 4}, {"type": "text", "text": "To expand on this, consider that in the standard Lasserre hierarchy we have $m_{s}(x)$ containing all monomials of degree $\\le\\,s$ in $n$ variables, or $\\binom{n+s}{s}$ terms in total. In the proposed cluster basis hierarchy, ${m}_{b,t}(\\boldsymbol{x})$ has ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\sum_{k=0}^{b}{\\binom{n}{k}}t^{k}\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "terms. This expression results from the need to sum over body orders $k$ , considering that there are $\\binom{n}{k}$ ways to choose $k$ variables and that each selected variable has $k$ possible degrees so there are $t^{k}$ ways to assign degrees $\\leq t$ to these $k$ variables. For fixed $b,t$ , $s=b t$ , and $n\\gg b,t$ we note that $m_{s}(x)$ has $O(\\bar{n^{b t}})$ terms while $m_{b,t}(x)$ has $O(n^{b})$ terms so the size reduction factor in using the cluster basis asymptotically goes like $n^{b(t-1)}$ . As the number of variables $n$ in the problem grow, we have asymptotic dominance in using the cluster basis to reduce the size of the SDP that must be solved. As $b t\\rightarrow\\infty$ we might expect asymptotic convergence of the SDP hierarchy just like the standard Lasserre hierarchy, however, a full proof of convergence is out of scope for this paper. For further details, see discussion in Appendix A.7.4. ", "page_idx": 4}, {"type": "text", "text": "2.3 Convergence of S-SOS ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "As we increase the degree $s$ (either $s$ in the Lasserre hierarchy or $b,t$ in the cluster basis hierarchy) we would expect the SDP objective values $p_{2s}^{*}$ (Equation (2)) to converge to the optimal value $p^{*}$ and the lower bounding function $c_{2s}^{*}(\\omega)$ to converge to the tightest lower bound $c^{*}(\\omega)=\\operatorname*{inf}_{x}f(x,\\omega)$ . In this paper we refer to $p_{2s}^{*}\\to p^{*}$ and $d_{2s}^{\\ast}\\rightarrow d^{\\ast}$ interchangeably as strong duality occurs in practice despite being difficult to formally verify (Appendix A.4). This convergence is a common feature of SOS hierarchies. ", "page_idx": 4}, {"type": "text", "text": "In this section we show that using polynomial $c_{2s}^{*}(\\omega)$ to approximate $c^{*}(\\omega)$ still allows for asymptotic convergence in $L^{1}$ as $s\\to\\infty$ . ", "page_idx": 4}, {"type": "text", "text": "2.3.1 Overview of result ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "We specialize to the particular case of 1-periodic trigonometric polynomials $f(x,\\omega),c(\\omega)$ on compact $X\\,=\\,[0,1]^{n}$ and compact $\\Omega\\,\\subset\\,\\mathbb{R}^{d}$ and prove asymptotic convergence of the degree- $2s$ S-SOS hierarchy as $s~\\rightarrow~\\infty$ . Though seemingly restrictive, this choice allows us to leverage Fourier convergence results on a compact domain. For generic $f(x,\\omega)$ where we are only interested in its behavior in some compact set (nearly all practical problems involve a restriction of domain), we may rescale the compact set to this 1-periodic compact domain and apply the results found here. To use other families of polynomials, we note that a substitution argument justifies the focus on trigonometric polynomials as any convergence result achieved for the trigonometric polynomial hierarchy lead directly to a matching result on regular polynomials (2.2 in [28]). Previously, rates of $1/s^{\\bar{2}}$ were attained for the standard Lasserre hierarchy (i.e. without external parameters $\\omega$ ) on compact domains with mild assumptions [29, 28, 9]. In our work, a slower convergence rate of $\\ln{s/s}$ is achieved due to the introduction of external parameters, requiring us to approximate the lower-bounding function $c^{*}(\\omega)$ and thereby limiting the obtained convergence rate. ", "page_idx": 4}, {"type": "text", "text": "", "page_idx": 5}, {"type": "text", "text": "2.3.2 $\\ln s/s$ convergence using a polynomial approximation to $c^{*}(\\omega)$ ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "We would like to bound the gap between the optimal lower bound $c^{*}(\\omega)=\\operatorname*{inf}_{x\\in X}f(x,\\omega)$ and the lower bound $c_{2s}^{*}(\\omega)$ resulting from solving the degree- $.2s$ primal S-SOS SDP, i.e. ", "page_idx": 5}, {"type": "equation", "text": "$$\n0\\leq c^{*}(\\omega)-c_{2s}^{*}(\\omega)\\leq\\varepsilon(f,s)\\ \\forall\\ \\omega\\in\\Omega.\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "To that end, we need to understand the regularity of $c^{*}$ . Without further assumptions, we may assume $c^{*}$ to be Lipschitz continuous, per Proposition 2.1. ", "page_idx": 5}, {"type": "text", "text": "With Equation (5) we may then integrate ", "page_idx": 5}, {"type": "equation", "text": "$$\n0\\leq\\int_{\\Omega}\\operatorname*{inf}_{x}f(x,\\omega)-c_{2s}^{*}(\\omega)\\mathrm{d}\\nu(\\omega)\\leq|\\Omega|\\varepsilon(f,s)\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "where we control $\\varepsilon$ in terms of the degree $s$ . If we can drive $\\epsilon\\rightarrow0$ as $s\\to\\infty$ then we are done. ", "page_idx": 5}, {"type": "text", "text": "Proposition 2.1 (Theorem 2.1 in [30]). Let $g:X\\times Y\\rightarrow\\mathbb{R}$ be polynomial. Then $y\\mapsto\\operatorname*{inf}_{x\\in X}g(x,y)$ is Lipschitz continuous. ", "page_idx": 5}, {"type": "text", "text": "Theorem 2.1 (Asymptotic convergence of S-SOS). Let $f:[0,1]^{n}\\times\\Omega\\to\\mathbb{R}$ be a trigonometric polynomial of degree $2r$ , $c^{*}(\\omega)=\\operatorname*{inf}_{x}f(x,\\omega)$ the optimal lower bound as a function of $\\omega$ , and $\\nu$ any probability measure on compact $\\Omega\\subset\\mathbb{R}^{d}$ . Let s refer to the degree of the basis in both $x,\\omega$ terms and the degree of the lower-bounding polynomial $c(\\omega)$ , i.e. $m_{s}\\check{(}[x,\\omega]):\\mathbb{R}^{n+d}\\rightarrow\\mathbb{R}^{a(n,d,s)}$ is the full basis function of terms $[x,\\omega]^{\\alpha}$ with $||\\alpha||_{1}\\leq s$ and $c(\\omega)$ only has terms $\\omega^{\\alpha}$ with $||\\alpha||_{1}\\leq s$ . ", "page_idx": 5}, {"type": "text", "text": "Let $p_{2s}^{*}$ be the solution to the following S-SOS SDP $(c.f.$ Equation (2)) with $m_{s}(x,\\omega)$ a spanning basis of trigonometric monomials with degree $\\le s$ : ", "page_idx": 5}, {"type": "equation", "text": "$$\n\\begin{array}{r}{p_{2s}^{*}=\\underset{c\\in\\mathcal{P}^{2s}(\\Omega),W\\succcurlyeq0}{\\operatorname*{sup}}\\int c(\\omega)\\mathrm{d}\\nu(\\omega)}\\\\ {s.t.\\quad f(x,\\omega)-c(\\omega)=m_{s}(x,\\omega)^{T}W m_{s}(x,\\omega)}\\end{array}\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "Then there is a constant $C>0$ depending only on $||f-\\bar{f}||_{F},||c^{*}-\\bar{c}^{*}||,r,\\Omega,n,d$ such that the following holds: ", "page_idx": 5}, {"type": "equation", "text": "$$\n\\int_{\\Omega}\\left[c^{*}(\\omega)-c_{2s}^{*}(\\omega)\\right]\\mathrm{d}\\nu(\\omega)\\leq C\\frac{\\ln s}{s}\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "where $\\bar{f}$ denotes the average value of the function $f$ over $[0,1]^{n}$ , i.e. $\\textstyle{\\bar{f}}\\;=\\;\\int_{[0,1]^{n}}f(x)d x$ and $\\begin{array}{r}{||f(x)||_{F}\\,=\\,\\sum_{\\hat{x}}|\\hat{f}(\\hat{x})|}\\end{array}$ denotes the norm of the Fourier coefficients. Thus we have asymptotic convergence  of the S-SOS SDP hierarchy to the optimal value $p^{*}$ of Equation (1) as we send $s\\to\\infty$ . ", "page_idx": 5}, {"type": "text", "text": "Proof. The following is an outline of the proof. For complete details, including the full theorem and proof, please see Appendix A.5.2. ", "page_idx": 5}, {"type": "text", "text": "The key argument used follows that of [22, 28, 23, 31, 32]. Take the lower-bounding minimizer of Equation (1) $c^{*}(\\omega)$ (not necessarily polynomial) and approximate it with a trigonometric polynomial $c_{a}^{*}(\\omega)$ of degree $s$ . We then pass the non-negative component $f-c_{a}^{*}$ through an integral operator $T$ that is built out of sums of squares of trigonometric polynomials (related to the Christoffel-Darboux and Jackson kernels) to obtain a strictly-positive SOS component: ", "page_idx": 5}, {"type": "equation", "text": "$$\nT h(x,\\omega)=\\int_{X\\times\\Omega}|q_{x}(x-\\bar{x})|^{2}|q_{\\omega}(\\omega-\\bar{\\omega})|^{2}h(\\bar{x},\\bar{\\omega})\\mathrm{d}\\bar{x}\\mathrm{d}\\bar{\\omega}.\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "$q_{x}(x),q_{\\omega}(\\omega)$ can be chosen to be \u201ckernel functions\u201d of bounded degree $\\le s$ so that the output SOS function is of degree 2s. We can show the approximation error $||c^{*}-c_{a}^{*}||$ is small, that the operator $T$ exists and is close to the identity, and the deformation resulting from the SOS projection is small for sufficiently large degree $s$ (degree of the approximating $c_{a}^{*}(\\omega)$ and in the SOS kernel). We may conclude that the true strictly-positive part may be well-approximated by the SOS hierarchy and find asymptotic convergence along with a convergence rate in the degree $s$ of the hierarchy. ", "page_idx": 6}, {"type": "text", "text": "3 Numerical experiments ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "We present two numerical studies of S-SOS demonstrating its use in applications. The first study (Section 3.1) numerically tests how the optimal values of the SDP Equation (2) $p_{2s}^{*}$ converge to $p^{*}$ of the original primal Equation (1) as we increase the degree. The second study (Section 3.2) evaluates the performance of S-SOS for solution extraction and uncertainty quantification in various sensor network localization problems. ", "page_idx": 6}, {"type": "text", "text": "3.1 Simple quadratic SOS function ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "As a simple illustration of S-SOS, we test it on the SOS function ", "page_idx": 6}, {"type": "equation", "text": "$$\nf(x,\\omega)=(x-\\omega)^{2}+(\\omega x)^{2}\n$$", "text_format": "latex", "page_idx": 6}, {"type": "text", "text": "with $x\\,\\in\\,\\mathbb{R},\\omega\\,\\in\\,\\mathbb{R}.$ . The lower bound $c^{*}(\\omega)\\,=\\,\\operatorname*{inf}_{x}\\,f(x,\\omega)$ can be computed analytically as $c^{*}(\\omega)\\,=\\,\\omega^{4}/(1+\\omega^{2})$ . Assuming $\\omega\\,\\sim\\,\\mathrm{Uniform}(-1,1).$ , we get that the objective value for the \u201ctightest lower-bounding\u201d primal problem Equation (1) is $\\begin{array}{r}{p^{*}=\\int_{-1}^{1}\\frac{\\omega^{4}}{2(1+\\omega^{2})}d\\omega=\\frac{\\pi}{4}-\\frac{2}{3}\\approx0.1187.}\\end{array}$ For further details, see Appendix A.6. ", "page_idx": 6}, {"type": "text", "text": "We are interested in studying the quantitative convergence of the S-SOS hierarchy numerically. The idea is to solve the primal (dual) degree- $2s$ SDP to find the tightest polynomial lower bound (the minimizing probability distribution) for varying degrees $s$ . As $s$ gets larger, the basis function $m_{s}(x)$ gets larger and the objective value of the SDP Equation (2) $p_{2s}^{*}$ should converge to the theoretical optimal value $p^{*}$ . ", "page_idx": 6}, {"type": "text", "text": "In Figure 1 we see very good agreement between $p^{*}$ and $p_{2s}^{*}$ with exponential convergence as $s$ increases. This is much faster than the rate we found in Section 2.3.2, but agrees with the exponential convergence results from [6] achieved with local optimality assumptions. Due to the simplicity of (6), it is not surprising that we see much faster convergence. In fact, for most typical functions, we might expect convergence much faster than the worst-case rate. The tapering-off of the convergence rate is likely attributed to the numerical tolerance used in our solver (CVXPY/MOSEK), as we observed that increasing the tolerance shifts the best-achieved gap higher. ", "page_idx": 6}, {"type": "text", "text": "3.2 Sensor network localization ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "Sensor network localization (SNL) is a common testbed for global optimization and SDP solvers due to the high sensitivity and ill-conditioning of the problem. In SNL, one seeks to recover the positions of N sensors X \u2208RN\u00d7\u2113 positioned in $\\mathbb{R}^{\\ell}$ given a set of noisy observations of pairwise distances $d_{i j}=||\\boldsymbol{x_{i}}-\\boldsymbol{x_{j}}||$ between the sensors [15, 33]. To have a unique global minimum and remove symmetries, sensor-anchor distance observations are often added, where several sensors are anchored at known locations in the space. This can improve the conditioning of the problem, making it \u201ceasier\u201d in some sense. ", "page_idx": 6}, {"type": "text", "text": "3.2.1 Definitions ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "We define a SNL problem instance with $X\\,\\in\\,[-1,1]^{N\\times\\ell}$ as the ground-truth positions for ${\\boldsymbol{S}}=$ $\\{1,2,\\ldots,N\\}$ sensors, $A\\in[-1,1]^{K\\times\\ell}$ as the ground-truth positions for $\\mathcal{A}=\\{1,2,\\ldots,K\\}$ anchors, $\\mathcal{D}_{s s}(\\boldsymbol{r})=\\{d_{i j}=||x_{i}-x_{j}||:i,j\\in\\mathcal{S}$ and $d_{i j}\\leq r\\}$ as the set of observed sensor-sensor distances and $\\mathcal{D}_{s a}(r)=\\{d_{i k}=||x_{i}-a_{k}||:i\\in S,k\\in\\mathcal{A}$ and $d_{i k}\\leq r\\}$ as the set of observed sensor-anchor distances, both of which depend on some sensing radius $r$ . ", "page_idx": 6}, {"type": "image", "img_path": "iChQIJtjHB/tmp/95c37d4f862e99cfa76ac7c0b642cd6db2555875b07f32c8dc9a59be16148b9d.jpg", "img_caption": ["Figure 1: Comparison between the objective value $p_{2s}^{*}$ from solving the degree- $.2s$ S-SOS SDP and the objective value $p^{*}$ resulting from the best-possible lower bound $c^{*}(\\omega)$ for noise drawn as $\\omega\\sim\\mathrm{Uniform}(-1,1)$ . $\\begin{array}{r}{p^{\\dot{*}}=\\int c^{*}(\\omega)d\\nu(\\omega)=\\frac{\\pi}{4}-\\frac{\\dot{2}}{3}\\approx0.1187}\\end{array}$ is plotted as the line in black and the $p_{2s}^{*}$ values are shown as blue dots (left) with the gap between the values $p^{*}-p_{2s}^{*}$ (right). "], "img_footnote": [], "page_idx": 7}, {"type": "text", "text": "Writing $x_{i},a_{k}\\in[-1,1]^{\\ell}$ as the unknown positions of the $i$ -th sensor and the $k$ -th anchor, we can write the potential function to be minimized as a polynomial: ", "page_idx": 7}, {"type": "equation", "text": "$$\nf(x,\\omega;X,A,r)=\\sum_{\\stackrel{d_{i j}\\in\\mathcal{D}_{s s}(r)}{d_{i j}\\in\\mathcal{D}_{s s}(r)}}(||x_{i}-x_{j}||_{2}^{2}-d_{i j}(\\omega)^{2})^{2}+\\sum_{\\stackrel{d_{i k}\\in\\mathcal{D}_{s a}(r)}{d_{i k}\\in\\mathcal{D}_{s a}(r)}}(||x_{i}-a_{k}||_{2}^{2}-d_{i k}(\\omega)^{2})^{2}\n$$", "text_format": "latex", "page_idx": 7}, {"type": "text", "text": "The observed sensor-sensor and sensor-anchor distances $d_{i j}(\\omega),d_{i k}(\\omega)$ can be perturbed arbitrarily, but in this paper we focus on linear uniform noise, i.e. for a subset of observed distances we have $d_{i j,k}(\\omega)=\\bar{d}_{i j}^{*}+\\epsilon\\omega_{k}$ with $\\omega_{k}\\sim\\mathrm{Uniform}(-1,1)$ . Other noise types may be explored, including those including outliers, which may be a better fit for robust methods (Appendix A.7.2). ", "page_idx": 7}, {"type": "text", "text": "Equation (7) contains soft penalty terms for sensor-sensor terms and sensor-anchor terms. We can see that this is a degree-4 polynomial in the standard monomial basis elements, and a global minimum of this function is achieved at $f(X,\\mathbf{0}^{d};X,A,r)=0$ (where the distances have not been perturbed by any noise). In general for non-zero $\\omega$ (measuring distances under noise perturbations) we expect the function minimum to be $>0$ , as there may not exist a configuration of sensors $\\hat{X}$ that is consistent with the observed noisy distances. ", "page_idx": 7}, {"type": "text", "text": "We can also support equality constraints in our solution, in particular hard equality constraints on the positions of certain sensors relative to known anchors. This corresponds to removing all sensor-anchor soft penalty terms from the function and instead selecting $N_{H}<N$ sensors at random to exactly fix in known positions via equality constraints in the SDP. The SDP is still large but the effective number of variable sensors has been reduced to $N^{\\prime}=N-N_{H}$ . ", "page_idx": 7}, {"type": "text", "text": "A given SNL pr\u221aoblem type is specified by a spatial dimension $\\ell$ , $N$ sensors, $K$ anchors, a sensing radius $r\\in(0,2\\sqrt{\\ell})$ , a noise type (linear), and anchor type (soft penalty or hard equality). Once these are specified, we generate a random problem instance by sampling $X\\sim\\operatorname{Uniform}(-1,1)^{n},A\\sim$ Uniform $(-1,1)^{d}$ . The potential $f(x,\\omega)$ for a given instance is formed (either with sensor-anchor terms or not, with terms kept based on some sensing radius $r$ , and noise variables appropriately added). ", "page_idx": 7}, {"type": "text", "text": "The number of anchors is chosen to be as few as possible so as to still enable exact localization, i.e. $K=\\ell+1$ anchors for a SNL problem in $\\ell$ spatial dimensions. The SDPs are formulated with the help of SymPy [34] and solved using CVXPY [35, 36] and Mosek [37] on a server with two Intel Xeon 6130 Gold processors (32 physical cores total) and 256GB of RAM. For an expanded discussion and further details, see Appendix A.7. ", "page_idx": 7}, {"type": "text", "text": "3.2.2 Evaluation metrics ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "The accuracy of the recovered solution is of primary interest, i.e. our primary evaluation metric should be the distance between our extracted sensor positions $x$ and the ground-truth sensor positions $X$ , i.e. dist $(x,X)$ . Because the S-SOS hierarchy recovers estimates of the sensor positions $\\mathbb{E}[x_{i}]$ along with uncertainty estimates $\\mathrm{Var}[x_{i}]$ , we would like to measure the distance between our ground-truth positions $X$ to our estimated distribution $p(x)=\\mathcal{N}(\\mathbb{E}[x],\\mathrm{Var}[x])$ . The Mahalanobis distance $\\delta_{M}$ (Equation (8)) is a modified distance metric that accounts for the uncertainty [38]. We use this as our primary metric for sensor recovery accuracy. ", "page_idx": 8}, {"type": "equation", "text": "$$\n\\delta_{M}(X,{\\mathcal{N}}(\\mu,\\Sigma)):={\\sqrt{(X-\\mu)^{T}\\Sigma^{-1}(X-\\mu)}}\n$$", "text_format": "latex", "page_idx": 8}, {"type": "text", "text": "As our baseline method, for each problem instance we apply a basic Monte Carlo method detailed in Algorithm 1 (Appendix A.7.3) where we sample $\\omega\\sim\\nu(\\omega)$ , use a local optimization solver to find $x^{*}\\bar{(\\omega)}=\\operatorname*{inf}_{x}f\\bar{(x,\\omega)}$ , and use this to estimate $\\mathbb{E}_{\\omega\\sim\\nu}[x],\\mathrm{{Var}}_{\\omega\\sim\\nu}[x]$ . Note that though this non-SOS method achieves some estimate of the dual SDP objective $\\textstyle\\int f(x,{\\bar{\\omega}})d\\mu(x,\\omega)$ , it is not guaranteed to be a lower bound. ", "page_idx": 8}, {"type": "text", "text": "3.2.3 Results ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "Recovery accuracy. In Table 1 we see a comparison of the S-SOS method and the MCPO baseline. Each row corresponds to one SNL problem type, i.e. we fix the physical dimension $\\ell$ , the number of anchors $K=\\ell+1$ , and select the sensing radius $r$ and the noise scale $\\epsilon$ . We then generate $L=20$ random instances of each problem type, corresponding to a random realization of the ground-truth sensor and anchor configurations $\\dot{X}^{'}\\!\\in[-1,1]^{\\dot{N}\\times\\ell}$ , $\\breve{A}\\in[-1,1]^{K\\times\\ell}$ , producing a $f(x,\\omega)$ that we then solve the SDP for (in the case of S-SOS) or do pointwise optimizations for (in the case of MCPO). Each method outputs estimates for the sensor positions and uncertainty around it as a $\\mathcal{N}(\\mathbb{E}[x],\\mathrm{Cov}[x])$ , which we then compute $\\delta_{M}$ for (see Equation (8)), treating each dimension as independent of each other (i.e. $X$ as a flat vector). Each instance solve gives us one observation of $\\delta_{M}$ or each method, and we report the median and the $\\pm1\\sigma_{34\\%}$ values over the $L=20$ instances we generate. ", "page_idx": 8}, {"type": "text", "text": "4 Discussion ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "In this paper, we discuss the stochastic sum-of-squares (S-SOS) method to solve global polynomial optimization in the presence of noise, prove two asymptotic convergence results for polynomial $f$ and compact $\\Omega$ , and demonstrate its application to parametric polynomial minimization and uncertainty quantification along with a new cluster basis hierarchy that enables S-SOS to scale to larger problems. In our experiments, we specialized to sensor network localization and low-dimensional uniform random noise with small $n,d$ . However, it is relatively straightforward to extend this method to support other noise types (such as Gaussian random variates without compact support, which we do in Appendix A.6.4) and support higher-dimensional noise with $d\\gg1$ . ", "page_idx": 8}, {"type": "text", "text": "Scaling this method to larger problems $n\\gg1$ is an open problem for all SOS-type methods. In this paper, we take the approach of sparsification, by making the cluster basis assumption to build up a block-sparse $W$ . We anticipate that methods that leverage sparsity or other structure in $f$ will be promising avenues of research, as well as approximate solving methods that avoid the explicit materialization of the matrices $W,M$ . For example, we assume that the ground-truth polynomial possesses the block-sparse structure because our SDP explicitly requires the polynomial $f(x,\\omega)$ to exactly decompose into some lower-bounding $c(\\omega)$ and SOS $f_{\\mathrm{SOS}}(x,\\omega)$ . Relaxing this exactdecomposition assumption and generalizing beyond polynomial $f(x,\\omega),c(\\omega)$ may require novel approaches and would be an exciting area for future work. ", "page_idx": 8}, {"type": "text", "text": "Table 1: Comparison of S-SOS and MCPO solution extraction accuracy. We present the Mahalanobis distance $\\delta_{M}$ (Equation (8)) of the the true sensor positions $X^{*}$ to the extracted distribution ${\\mathcal{N}}(\\mathbb{E}[x],\\mathrm{Var}[x])$ over solutions recovered from S-SOS for varying SNL problem types. $\\ell$ is the spatial dimension, $r$ is the sensing radius used to cutoff terms in the potential $f(x,\\omega)$ , $\\epsilon$ is the noise scale, $N_{H}$ is the number of hard equality constraints used (sensors fixed at known locations), $N_{C}$ is the number of clusters used (see Appendix A.7.4), and $N$ is the number of sensors used. Each SNL problem instance has $K=\\ell+1$ anchors used in the potential (if $N_{H}\\,=\\,0)$ . The MCPO values are estimated with $T=50$ Monte Carlo iterates. Each entry is $\\hat{\\mu}\\pm\\hat{\\sigma}$ where $\\hat{\\mu}$ is the median and robust standard-deviation $(\\sigma_{34\\%})$ estimated over 20 runs of the same problem type with varying random initializations of the sensor positions. The entries with the lowest median $\\delta_{M}$ are bolded. We also compare the number of elements in the full basis $a_{f}$ , the cluster basis $a_{c}$ , and the reduction multiple when using the cluster basis $a_{f}/a_{c}$ . When passing to the cluster basis, $a_{f}/a_{c}$ is how much the semidefinite matrix shrinks by. ", "page_idx": 9}, {"type": "table", "img_path": "iChQIJtjHB/tmp/b6d3fe7f588d8ea4ccdbd4d1529cf52071770890f7c330690d3824e6b5a113dc.jpg", "table_caption": [], "table_footnote": [], "page_idx": 9}, {"type": "text", "text": "References ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "[1] Michael R. Garey and David S. Johnson. Computers and intractability: a guide to the theory of NP-completeness. A series of books in the mathematical sciences. Freeman, New York [u.a], 27. print edition, 2009. ", "page_idx": 9}, {"type": "text", "text": "[2] Yurii Nesterov. Squared Functional Systems and Optimization Problems. In Hans Frenk, Kees Roos, Tam\u00e1s Terlaky, and Shuzhong Zhang, editors, High Performance Optimization, Applied Optimization, pages 405\u2013440. Springer US, Boston, MA, 2000.   \n[3] Jean B. Lasserre. Global Optimization with Polynomials and the Problem of Moments. SIAM Journal on Optimization, 11(3):796\u2013817, January 2001. Publisher: Society for Industrial and Applied Mathematics.   \n[4] Monique Laurent. Sums of Squares, Moment Matrices and Optimization Over Polynomials. In Mihai Putinar and Seth Sullivant, editors, Emerging Applications of Algebraic Geometry, The IMA Volumes in Mathematics and its Applications, pages 157\u2013270. Springer, New York, NY, 2009.   \n[5] Jiawang Nie. Optimality conditions and finite convergence of Lasserre\u2019s hierarchy. Mathematical Programming, 146(1-2):97\u2013121, August 2014.   \n[6] Francis Bach and Alessandro Rudi. Exponential convergence of sum-of-squares hierarchies for trigonometric polynomials, April 2023. arXiv:2211.04889 [math].   \n[7] Mihai Putinar. Positive Polynomials on Compact Semi-algebraic Sets. Indiana University Mathematics Journal, 42(3):969\u2013984, 1993. Publisher: Indiana University Mathematics Department.   \n[8] Konrad Schm\u00fcdgen. The Moment Problem, volume 277 of Graduate Texts in Mathematics. Springer International Publishing, Cham, 2017.   \n[9] Lucas Slot and Monique Laurent. Sum-of-squares hierarchies for binary polynomial optimization. Mathematical Programming, 197(2):621\u2013660, January 2023. Publisher: Springer Verlag.   \n[10] Jean Lasserre. The Moment-SOS hierarchy, August 2018. arXiv:1808.03446 [math].   \n[11] Jean-Bernard Lasserre. The Moment-SOS hierarchy: Applications and related topics. To appear in Acta Numerica (2024), September 2023.   \n[12] Lorenzo Baldi and Bernard Mourrain. On the effective Putinar\u2019s Positivstellensatz and moment approximation. Mathematical Programming, 200(1):71\u2013103, June 2023.   \n[13] Lorenzo Baldi and Lucas Slot. Degree Bounds for Putinar\u2019s Positivstellensatz on the Hypercube. SIAM Journal on Applied Algebra and Geometry, 8(1):1\u201325, March 2024.   \n[14] P.A. Parrilo. Structured Semidefinite Programs and Semialgebraic Geometry Methods in Robustness and Optimization. PhD thesis, California Institute of Technology, Pasadena, CA, 2000.   \n[15] Jiawang Nie. Sum of squares method for sensor network localization. Computational Optimization and Applications, 43(2):151\u2013179, June 2009.   \n[16] Etienne de Klerk. The complexity of optimizing over a simplex, hypercube or sphere: a short survey. Central European Journal of Operations Research, 16(2):111\u2013125, June 2008.   \n[17] Amir Ali Ahmadi and Anirudha Majumdar. DSOS and SDSOS Optimization: More Tractable Alternatives to Sum of Squares and Semidefinite Optimization. SIAM Journal on Applied Algebra and Geometry, 3(2):193\u2013230, January 2019.   \n[18] D\u00e1vid Papp and Sercan Yildiz. Sum-of-Squares Optimization without Semidefinite Programming. SIAM Journal on Optimization, 29(1):822\u2013851, January 2019.   \n[19] Jean B. Lasserre. A \u201cJoint+Marginal\u201d Approach to Parametric Polynomial Optimization. SIAM Journal on Optimization, 20(4):1995\u20132022, January 2010. Publisher: Society for Industrial and Applied Mathematics.   \n[20] Bruno Sudret. Global sensitivity analysis using polynomial chaos expansion. Reliability Engineering & System Safety, 93:964\u2013979, July 2008.   \n[21] Habib N. Najm. Uncertainty Quantification and Polynomial Chaos Techniques in Computational Fluid Dynamics. Annual Review of Fluid Mechanics, 41(1):35\u201352, 2009. _eprint: https://doi.org/10.1146/annurev.fluid.010908.165248.   \n[22] Kun Fang and Hamza Fawzi. The sum-of-squares hierarchy on the sphere, and applications in quantum information theory. Mathematical Programming, 190(1-2):331\u2013360, November 2021. arXiv:1908.05155 [quant-ph].   \n[23] Lucas Slot. Sum-of-Squares Hierarchies for Polynomial Optimization and the Christoffel\u2013 Darboux Kernel. SIAM Journal on Optimization, 32(4):2612\u20132635, December 2022.   \n[24] Ralph Tyrell Rockafellar. Convex Analysis. Princeton Landmarks in Mathematics and Physics. Princeton University Press, Princeton, NJ, 2015.   \n[25] Stephen Boyd and Lieven Vandenberghe. Convex Optimization. Cambridge University Press, 1 edition, March 2004.   \n[26] Lieven Vandenberghe. Chordal Graphs and Sparse Semidefinite Optimization, 2017.   \n[27] Yian Chen, Yuehaw Khoo, and Lek-Heng Lim. Convex Relaxation for Fokker-Planck, June 2023. arXiv:2306.03292 [cs, math].   \n[28] Francis Bach. Sums-of-squares for dummies: a view from the Fourier domain \u2013 Machine Learning Research Blog, November 2022.   \n[29] Markus Schweighofer. On the complexity of Schm\u00fcdgen\u2019s Positivstellensatz. Journal of Complexity, 20(4):529\u2013543, August 2004.   \n[30] Frank H. Clarke. Generalized gradients and applications. Transactions of the American Mathematical Society, 205:247\u2013262, 1975.   \n[31] Corbinian Schlosser, Matteo Tacchi, and Alexey Lazarev. Convergence rates for the momentSoS hierarchy, February 2024. arXiv:2402.00436 [math].   \n[32] Milan Korda, Victor Magron, and Rodolfo R\u00edos-Zertuche. Convergence rates for sums-ofsquares hierarchies with correlative sparsity. Mathematical Programming, March 2024.   \n[33] Anthony Man-Cho So and Yinyu Ye. Theory of semidefinite programming for Sensor Network Localization. Mathematical Programming, 109(2-3):367\u2013384, January 2007.   \n[34] Aaron Meurer, Christopher P. Smith, Mateusz Paprocki, Ond\u02c7rej \u02c7Cert\u00edk, Sergey B. Kirpichev, Matthew Rocklin, AMiT Kumar, Sergiu Ivanov, Jason K. Moore, Sartaj Singh, Thilina Rathnayake, Sean Vig, Brian E. Granger, Richard P. Muller, Francesco Bonazzi, Harsh Gupta, Shivam Vats, Fredrik Johansson, Fabian Pedregosa, Matthew J. Curry, Andy R. Terrel, \u0160te\u02c7p\u00e1n Rouc\u02c7ka, Ashutosh Saboo, Isuru Fernando, Sumith Kulal, Robert Cimrman, and Anthony Scopatz. Sympy: symbolic computing in python. PeerJ Computer Science, 3:e103, January 2017.   \n[35] Steven Diamond and Stephen Boyd. CVXPY: A Python-embedded modeling language for convex optimization. Journal of Machine Learning Research, 17(83):1\u20135, 2016.   \n[36] Akshay Agrawal, Robin Verschueren, Steven Diamond, and Stephen Boyd. A rewriting system for convex optimization problems. Journal of Control and Decision, 5(1):42\u201360, 2018.   \n[37] MOSEK ApS. The MOSEK optimization toolbox for Python manual. Version 10.0., 2023.   \n[38] PC Mahalanobis. On the generalized distance in statistics. In Proceedings National Institute of Science of India, volume 49, pages 234\u2013256, 1936. Issue: 2.   \n[39] Ryan O\u2019Donnell. SOS is not obviously automatizable, even approximately. R. O, 2016.   \n[40] Matthew B. Hastings. Perturbation Theory and the Sum of Squares, June 2022. arXiv:2205.12325 [cond-mat, physics:hep-th, physics:quant-ph].   \n[41] M. B. Hastings. Field Theory and The Sum-of-Squares for Quantum Systems, February 2023. arXiv:2302.14006 [quant-ph].   \n[42] Samuel B. Hopkins. Statistical Inference and the Sum of Squares Method. PhD Thesis, Cornell University, August 2018.   \n[43] Samuel B. Hopkins and Jerry Li. Mixture models, robustness, and sum of squares proofs. In Proceedings of the 50th Annual ACM SIGACT Symposium on Theory of Computing, pages 1021\u20131034, Los Angeles CA USA, June 2018. ACM.   \n[44] Saeid Sedighi, Kumar Vijay Mishra, M. R. Bhavani Shankar, and Bjorn Ottersten. Localization With One-Bit Passive Radars in Narrowband Internet-of-Things Using Multivariate Polynomial Optimization. IEEE Transactions on Signal Processing, 69:2525\u20132540, January 2021. ADS Bibcode: 2021ITSP...69.2525S.   \n[45] Dimitris Bertsimas, Dan Andrei Iancu, and Pablo A. Parrilo. A Hierarchy of Near-Optimal Policies for Multistage Adaptive Optimization. IEEE Transactions on Automatic Control, 56(12):2809\u20132824, December 2011.   \n[46] Luigi Ambrosio, Nicola Gigli, and Savare. Gradient Flows in Metric Spaces and in the Space of Probability Measures. Birkh\u00e4user, second edition, 2005.   \n[47] Ivar Ekeland and Roger Temam. Convex analysis and variational problems, 1976.   \n[48] D. Jackson. The Theory of Approximation. Colloquium Publications. American Mathematical Society, 1930.   \n[49] Nathan Krislock and Henry Wolkowicz. Explicit Sensor Network Localization using Semidefinite Representations and Facial Reductions, January 2010. arXiv:1002.0013 [math].   \n[50] Brian D. O. Anderson, Peter N. Belhumeur, Tolga Eren, David K. Goldenberg, A. Stephen Morse, Walter Whiteley, and Y. Richard Yang. Graphical properties of easily localizable sensor networks. Wireless Networks, 15(2):177\u2013191, February 2009.   \n[51] Brian D. O. Anderson, Iman Shames, Guoqiang Mao, and Baris\u00b8 Fidan. Formal Theory of Noisy Sensor Network Localization. SIAM Journal on Discrete Mathematics, 24(2):684\u2013698, January 2010. ", "page_idx": 9}, {"type": "text", "text": "", "page_idx": 10}, {"type": "text", "text": "", "page_idx": 11}, {"type": "text", "text": "", "page_idx": 12}, {"type": "text", "text": "A Appendix / supplemental material ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "A.1 Notation ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "Let ${\\mathcal{P}}(X)$ and ${\\mathcal{P}}(\\Omega)$ denote the spaces of polynomials on $X\\subseteq\\mathbb{R}^{n}$ and $\\Omega\\subseteq\\mathbb{R}^{d}$ , respectively, where $X$ and $\\Omega$ are (not-necessarily compact) subsets of their respective ambient spaces $\\mathbb{R}^{n}$ and $\\mathbb{R}^{d}$ . Specifically, all polynomials of the forms below belong to their respective spaces: ", "page_idx": 13}, {"type": "equation", "text": "$$\np(x)=\\sum_{\\alpha\\in\\mathbb{Z}_{\\geq0}}c_{\\alpha}x^{\\alpha}\\in\\mathcal{P}(X),\\quad p(\\omega)=\\sum_{\\alpha\\in\\mathbb{Z}_{\\geq0}}c_{\\alpha}\\omega^{\\alpha}\\in\\mathcal{P}(\\Omega)\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "where $x=(x_{1},\\ldots,x_{n}),\\omega=(\\omega_{1},\\ldots,\\omega_{d})$ , $\\alpha$ is a multi-index for the respective spaces, and $c_{\\alpha}$ are the polynomial coefficients. ", "page_idx": 13}, {"type": "text", "text": "Let ${\\mathcal{P}}^{d}(S)$ for some $S\\in\\{X,\\Omega\\}$ denote the subspace of ${\\mathcal{P}}(S)$ consisting of polynomials of degree $\\leq d$ , i.e. polynomials where the multi-indices of the monomial terms satisfy $||\\bar{\\alpha}||_{1}\\stackrel{\\cdot}{\\leq}d.\\ \\mathcal{P}_{\\mathrm{SOS}}(X\\stackrel{\\cdot}{\\times}\\Omega)$ refers to the space of polynomials on $X\\times\\Omega$ that can be expressible as a sum-of-squares in $x$ and $\\omega$ jointly. Additionally, $W\\succcurlyeq0$ for a matrix $W$ denotes that $W$ is symmetric positive semidefinite (PSD). Finally, $\\mathbb{P}(\\Omega)$ denotes the set of Lebesgue probability measures on $\\Omega$ . ", "page_idx": 13}, {"type": "text", "text": "A.2 Related work ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "A.2.1 Sum-of-squares theory and practice ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "The theoretical justification underlying the SDP relaxations in global optimization we use here derive from the Positivstellens\u00e4tz (positivity certificate) of [7], a representation theorem guaranteeing that strictly positive polynomials on certain sets admit sum-of-squares representations. Following this, [3, 10, 11] developed the Moment-SOS hierarchy, describing a hierarchy of primal-dual SDPs (each having fixed degree) of increasing size that provides a monotonic non-decreasing sequence of lower bounds. ", "page_idx": 13}, {"type": "text", "text": "There is rich theory underlying the SOS hierarchy combining disparate results from algebraic geometry [14, 10, 11], semidefinite programming [15, 18], and complexity theory [16, 39]. The hierarchy exhibits finite convergence in particular cases where convexity and a strict local minimum are guaranteed [5], otherwise converging asymptotically [6]. In practice, the hierarchy often does even better than these guarantees, converging exactly at $c_{s}^{*}$ for some small $s$ . ", "page_idx": 13}, {"type": "text", "text": "The SOS hierarchy has found numerous applications in wide-ranging fields, including: reproducing certain results of perturbation theory and providing useful lower-bound certifications in quantum field theory and quantum chemistry [40, 41], providing better provable guarantees in high-dimensional statistical problems [42, 43], useful applications in the theory and practice of sensor network localization [15, 44] and in robust and stochastic optimization [45]. ", "page_idx": 13}, {"type": "text", "text": "Due to the SDP relaxation, the SOS hierarchy is quite powerful. This flexibility comes at a cost, primarily in the form of computational complexity. The SDP prominently features a PSD matrix $\\stackrel{\\triangledown}{\\boldsymbol{W}}\\in\\mathbb{R}^{\\dot{a}(n,d,s)\\times a(n,d,s)}$ with $a(n,d,s)$ scaling as $\\binom{n+d+s}{s}$ for $n$ dimensions and maximum degree $s$ . Without exploiting the structure of the polynomial, such as locality (coupled terms) or sparsity, solving the SDP using a standard interior point method becomes prohibitively expensive for moderate values of $s$ or $n$ . Work attempting to improve the scalability of the core ideas underlying the SOS hierarchy and the SDP method include [17, 18]. ", "page_idx": 13}, {"type": "text", "text": "A.2.2 Stochastic sum-of-squares and parametric polynomial optimization ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "The S-SOS hierarchy we present in this paper as a solution to parametric polynomial optimization was presented originally by [19] as a \u201cJoint $^+$ Marginal\u201d approach. That work provides the same hierarchy of semidefinite relaxations where the sequence of optimal solutions converges to the moment vector of a probability measure encoding all information about the globally-optimal solutions $x^{*}(\\omega)=$ $\\textstyle\\operatorname{argmin}_{x}f(x,\\omega)$ and provides a proof that the dual problem (our primal) obtains a polynomial approximation to the optimal value function that converges almost-uniformly to $c^{*}(\\omega)$ . ", "page_idx": 13}, {"type": "text", "text": "A.2.3 Uncertainty quantification and polynomial chaos ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "Once a physical system or optimization problem is characterized, sensitivity analysis and uncertainty quantification seek to quantify how randomness or uncertainty in the inputs can affect the response. In our work, we have the parametric problem of minimizing a function $f(x,\\omega)$ over $x$ where $\\omega$ parameterizes the function and is drawn from some noise distribution $\\nu(\\omega)$ . ", "page_idx": 14}, {"type": "text", "text": "If only function evaluations $f(x,\\omega)$ are allowed and no other information is known, Monte Carlo is often applied, where one draws $\\omega_{k}\\sim\\nu(\\omega)$ and solves many realizations of $\\operatorname*{inf}_{x}f_{k}(x)=f(x,\\omega_{k})$ to approximately solve the following stochastic program: ", "page_idx": 14}, {"type": "equation", "text": "$$\nf^{*}=\\operatorname*{inf}_{x}\\mathbb{E}_{\\omega\\sim\\nu}[f(x,\\omega)]\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "Standard Monte Carlo methods are ill-suited for integrating high-dimensional functions, so this method is computationally challenging in its own right. In addition, we have no guarantees on our result except that as we take the number of Monte Carlo iterates $T\\rightarrow\\infty$ we converge to some unbiased estimate of $\\mathbb{E}_{\\omega\\sim\\nu}[f(x,\\omega)]$ . ", "page_idx": 14}, {"type": "text", "text": "Our approach to quantifying the uncertainty in optimal function value resulting from uncertainty in parameters $\\omega$ is to find a deterministic lower-bounding $c^{*}(\\omega)$ which guarantees $f(x,\\omega)\\geq c^{*}(\\omega)$ no matter the realization of noise. This is reminiscent of the polynomial chaos expansion literature, wherein a system of some stochastic variables is expanded into a deterministic function of those stochastic variables, usually in some orthogonal polynomial basis [20, 21]. ", "page_idx": 14}, {"type": "text", "text": "A.3 An example ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "Example A.1. Let $f(x,\\omega)$ be some polynomial of degree $\\leq2s$ written in the standard monomial basis, i.e. ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\begin{array}{r l r}{\\lefteqn{f(\\boldsymbol{x},\\boldsymbol{\\omega})=\\sum_{||\\alpha||_{1}\\le2s}f_{\\alpha}x^{\\alpha}}}\\\\ &{}&{=\\displaystyle\\sum_{||\\alpha||_{1}\\le2s}f_{(\\alpha_{1},\\dots,\\alpha_{n+d})}\\prod_{i=1}^{n}x_{i}^{\\alpha_{i}}\\prod_{i=1}^{d}\\omega_{i}^{\\alpha_{n+i}}}\\end{array}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "Let $m_{s}(x,\\omega)\\in\\mathbb{R}^{a(n,d,s)}$ be the basis vector representing the full set of monomials in $x,\\omega$ of degree $\\le s$ with $a(n,d,s)={\\binom{n+d+s}{s}}$ . ", "page_idx": 14}, {"type": "text", "text": "For all $\\alpha\\,\\in\\,\\mathbb{Z}_{\\geq0}^{n+d}$ with $||\\alpha||_{1}\\,\\leq\\,2s$ and $\\alpha_{k}~=~0$ for all $k\\,\\in\\,\\{1,\\ldots,n\\}$ (i.e. monomial terms containing only $\\omega_{1},\\ldots,\\omega_{d})$ we must have: ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\int_{X\\times\\Omega}\\omega^{\\alpha}\\mathrm{d}\\mu(x,\\omega)-\\int_{\\Omega}\\omega^{\\alpha}\\mathrm{d}\\nu(\\omega)=0\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "Explicitly, for $\\mu$ to be a valid probability distribution we must have: ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\int_{X\\times\\Omega}\\mathrm{d}\\mu(x,\\omega)-1=M_{0,0}-1=y_{(1,0,\\dots)}-1=0\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "Suppose $\\Omega=[-1,1],\\omega\\sim\\mathrm{Uniform}(-1,1)$ so that $d=1$ , $\\nu(\\omega)=1/2$ . We require: ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\int_{X\\times\\Omega}\\omega^{\\alpha}\\mathrm{d}\\mu(x,\\omega)=\\int_{[-1,1]}\\omega^{\\alpha}\\mathrm{d}\\nu(\\omega)=\\left\\{\\frac{1}{3}\\right.\\ \\ \\alpha=1}\\\\ {\\left.\\ \\ \\alpha=3\\right.}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "A.4 Strong duality ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "To guarantee strong duality theoretically, we need a strictly feasible point in the interior (Slater\u2019s condition). For us, this is a consequence of Putinar\u2019s Positivstellensatz, if $f(x,\\omega)$ admits a decomposition as $f(x,\\omega)=c(\\omega)+g(\\bar{x,\\omega})$ where $g(x,\\omega)>0$ (i.e. is strictly positive), we have strong duality, i.e. $p^{*}=d^{*}$ and $p_{2s}^{*}=d_{2s}^{*}$ [3, 8]. However, it is difficult to verify the conditions analytically. In practice, strong duality is observed in most cases, so in this paper we refer to solving the primal and dual interchangeably, as $p_{2s}^{*}=d_{2s}^{*}$ in all cases we encounter where a SDP solver returns a feasible point. ", "page_idx": 15}, {"type": "text", "text": "A.5 Proofs ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "A.5.1 Primal-dual relationship of S-SOS ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "Regular SOS Global polynomial optimization can be framed as the following lower-bound maximization problem where we need to check global non-negativity: ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{\\operatorname*{sup}}&{{}c}\\\\ {c{\\in}\\mathbb{R}}&{{}}\\\\ {\\mathrm{s.t.}}&{{}f(x)-c\\geq0\\quad\\forall x}\\end{array}\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "When we take the SOS relaxation of the non-negativity constraint in the primal, we now arrive at the SOS primal problem, where we require $f(x)-c$ to be SOS which guarantees non-negativity but is a stronger condition than necessary: ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{\\underset{c\\in\\mathbb{R}}{\\operatorname*{sup}}}&{c}\\\\ {\\mathrm{s.t.}}&{f(x)-c\\in\\mathcal{P}_{\\mathrm{SOS}}(X).}\\end{array}\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "The dual to Equation (9) is the following moment-minimization problem: ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{\\operatorname*{inf}_{\\mu\\in\\mathbb{P}(X)}}&{{}\\displaystyle\\int f(x)\\mathrm{d}\\mu(x)}\\\\ {\\mathrm{with}}&{{}\\displaystyle\\int\\mathrm{d}\\mu(x)=1.}\\end{array}\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "Taking some spanning basis $m_{s}(x)\\,:\\,\\mathbb{R}^{n}\\,\\rightarrow\\,\\mathbb{R}^{a(n,s)}$ of monomials up to degree $s$ , we have the moment matrix M \u2208Ra(n,s)\u00d7a(n,s): ", "page_idx": 15}, {"type": "equation", "text": "$$\nM_{i,j}=\\int m_{i}(x)m_{j}(x)d\\mu(x)=y_{\\alpha}\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "where we introduce a moment vector $y$ whose elements correspond to the unique moments of the matrix $M$ . Then we may write the degree- $.2s$ moment-minimization problem, which is now in a solvable numerical form: ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{\\displaystyle{\\operatorname*{inf}_{y}}}&{\\displaystyle{\\sum_{\\alpha}f_{\\alpha}y_{\\alpha}}}\\\\ {\\mathrm{with}}&{M(y)_{1,1}=1}\\\\ &{M(y)\\succcurlyeq0}\\end{array}\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "where we write $M(y)$ as the matrix formed by placing the moments from $y$ into their appropriate places and we set the first element of $m_{s}(x)$ to be 1, hence $\\begin{array}{r}{M_{1,1}\\,=\\,\\int d\\bar{\\nu}(x)\\,=\\,1}\\end{array}$ is simply the normalization constraint. For further reading, see [15, 3]. ", "page_idx": 15}, {"type": "text", "text": "Stochastic SOS Now let us lift this problem into the stochastic setting with parameters $\\omega$ sampled from a given distribution $\\nu$ , i.e. replacing $x\\rightarrow(x,\\omega)$ . We need to make some choice for the objective. The expectation of the lower bound under $\\nu(\\omega)$ is a reasonable choice, i.e. ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\int_{\\Omega}c(\\omega)d\\nu(\\omega)\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "but we could also make other choices, such as ones that encourage more robust lower bounds. In this paper however, we formulate the primal S-SOS as below (same as Equation (1)): ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{p^{*}=\\underset{c\\in L^{1}(\\Omega)}{\\operatorname*{sup}}}&{\\displaystyle\\int c(\\omega)\\mathrm{d}\\nu(\\omega)}\\\\ {\\mathrm{s.t.}}&{f(x,\\omega)-c(\\omega)\\geq0}\\end{array}\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "Note that if the ansatz space for the function $c(\\omega)$ is general enough, the maximization of the curve $c$ is equivalent to a pointwise maximization, i.e. we recover the best approximation for almost all $\\omega$ . Then the dual problem has a very similar form to the non-stochastic case. ", "page_idx": 16}, {"type": "text", "text": "Theorem A.2. The dual to Equation (13) is the following moment minimization where $\\mu(x,\\omega)$ is $a$ probability measure on $X\\times\\Omega$ : ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{\\displaystyle\\operatorname*{inf}_{\\mu\\in\\mathbb{P}(X\\times\\Omega)}}&{\\displaystyle\\int f(x,\\omega)\\mathrm{d}\\mu(x,\\omega)}\\\\ {w i t h}&{\\displaystyle\\int_{X\\times\\Omega}\\omega^{\\alpha}\\mathrm{d}\\mu(x,\\omega)=\\int_{\\Omega}\\omega^{\\alpha}\\mathrm{d}\\nu(\\omega)\\quad f o r\\,a l l\\,\\alpha\\in\\mathbb{N}^{d}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "Remark A.3. Notice, that the condition $\\begin{array}{r}{\\int_{X\\times\\Omega}\\omega^{\\alpha}\\mathrm{d}\\mu(x,\\omega)\\,=\\,\\int_{\\Omega}\\omega^{\\alpha}\\mathrm{d}\\nu(\\omega)}\\end{array}$ implies that the first marginal of $\\mu$ is the noise distribution $\\nu$ . Let $\\mu_{\\omega}$ denote the disintegration of $\\mu$ with respect to $\\nu$ , [46]. Then the moment matching condition is equivalent to $\\mu_{\\omega}(X)=1$ for almost all $\\omega$ and $\\mu$ being a Young measure w.r.t. $\\nu$ . The idea is that $\\mu_{\\omega}(x)$ is a minimizing density for every single configuration of $\\omega$ . ", "page_idx": 16}, {"type": "text", "text": "Proof. We use $\\mathcal{P}_{\\geq0}(X\\times\\Omega)$ to denote the space of non-negative polynomials on $X\\times\\Omega$ . Given measure $\\nu$ on $\\Omega$ and polynomial function $p:X\\times\\Omega\\to\\mathbb{R}$ consider ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\underset{\\gamma\\in L^{1}(\\Omega,\\nu)}{\\operatorname*{sup}}\\ \\int_{\\Omega}\\gamma(\\omega)\\mathrm{d}\\nu(\\omega)}\\\\ {\\underset{q\\in\\mathcal{P}_{\\geq0}(X\\times\\Omega).}{q\\in\\mathcal{P}_{\\geq0}(X\\times\\Omega).}}\\\\ {\\mathrm{s.t}\\ \\ \\ p(x,\\omega)-\\gamma(\\omega)=q(x,\\omega)}\\end{array}\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "This is equivalent to ", "page_idx": 16}, {"type": "equation", "text": "$$\n-\\operatorname*{inf}_{\\gamma\\in L^{1}(\\Omega,\\mu)}f(\\gamma,q)+g(\\gamma,q)\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "with ", "page_idx": 16}, {"type": "equation", "text": "$$\nf(\\gamma,q)=-\\int_{\\Omega}\\gamma(\\omega)\\mathrm{d}\\nu(\\omega)\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "and ", "page_idx": 16}, {"type": "equation", "text": "$$\ng(\\gamma,q)=-\\chi_{\\{f-\\gamma-q=0\\}}=\\left\\{\\!\\!\\begin{array}{l}{{{\\mathrm{0\\,if}\\;f-\\gamma-q=0}}}\\\\ {{{-\\infty\\;{\\mathrm{else}}}}}\\end{array}\\right.\\;,\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "i.e. $g$ is the characteristic function enforcing non-negativity. ", "page_idx": 16}, {"type": "text", "text": "Denote by $h^{*}$ the Legendre dual, i.e. ", "page_idx": 16}, {"type": "equation", "text": "$$\nh^{*}(y)=\\operatorname*{sup}_{x}\\langle x,y\\rangle-h(x).\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "Then by Rockafellar duality, [47, 24], and noting that signed Borel measures $\\boldsymbol{\\mathrm{\\Delta}}\\boldsymbol{\\mathrm{\\Omega}}^{\\beta}$ are the dual to continuous functions, the dual problem reads ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\operatorname*{sup}_{\\Gamma\\in L^{\\infty}(\\Omega,\\mu),\\mu\\in\\mathcal{B}}-f^{*}(\\Gamma,\\mu)-g^{*}(-(\\Gamma,\\nu))\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "and we would have ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\operatorname*{sup}_{\\Gamma\\in L^{\\infty}(\\Omega,\\mu),\\mu\\in B}-f^{*}(\\Gamma,\\mu)-g^{*}(-(\\Gamma,\\mu))=-\\operatorname*{inf}_{\\stackrel{\\gamma\\in L^{1}(\\Omega,\\mu)}{q\\in\\mathcal{P}_{\\geq0}(X\\times\\Omega)}}f(\\gamma,q)+g(\\gamma,q).\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "The Legendre duals of $f$ and $g$ can be explicitly calculated as ", "page_idx": 17}, {"type": "equation", "text": "$$\nf^{*}(\\Gamma,\\mu)={\\underset{\\mathrm{\\tiny~\\left\\{\\infty~else\\right.}}}{\\left\\{\\right.\\mathrm{\\tiny~\\{if\\}~}\\Gamma=-1\\mathrm{\\and\\}\\mu\\leq0\\mathrm{\\}}\\right.}}\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "and ", "page_idx": 17}, {"type": "equation", "text": "$$\ng^{*}(\\Gamma,\\mu)=\\left\\{\\int_{\\Omega\\times X}f(x,\\omega)\\mathrm{d}\\mu(\\omega,x)\\right.\\quad\\mathrm{if}\\ f-\\gamma\\in\\mathcal{P}_{\\geq0}(X\\times\\Omega)\\ \\mathrm{and}\\ \\Gamma(\\omega)=\\mu_{\\omega}(X)\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "since ", "page_idx": 17}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{f^{*}(\\Gamma,\\mu)=\\underset{\\gamma,q}{\\operatorname*{sup}}\\left(\\displaystyle\\int_{\\Omega}\\gamma(\\omega)\\Gamma(\\omega)\\mathrm{d}\\nu(\\omega)+\\int_{\\Omega\\times X}q(x,\\omega)\\mathrm{d}\\mu(x,\\omega)-f(\\gamma,q)\\right)}\\\\ &{\\qquad\\qquad=\\underset{\\gamma,q}{\\operatorname*{sup}}\\displaystyle\\int_{\\Omega}\\gamma(\\omega)(\\Gamma(\\omega)+1)\\mathrm{d}\\nu(\\omega)+\\int_{\\Omega\\times X}q(x,\\omega)\\mathrm{d}\\mu(x,\\omega)}\\\\ &{\\qquad=\\left\\{\\begin{array}{l l}{0}&{\\mathrm{if~}\\Gamma=-1\\mathrm{~and~}\\mu\\leq0}\\\\ {\\infty}&{\\mathrm{else}}\\end{array}\\right.}\\end{array}\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "and ", "page_idx": 17}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{\\Gamma}^{*}(\\Gamma,\\mu)=\\underset{\\gamma,\\eta}{\\operatorname*{sup}}\\int_{\\Omega}\\gamma(\\omega)\\Gamma(\\omega)\\mathrm{d}\\nu(\\omega)+\\int_{\\Omega\\times X}q(x,\\omega)\\mathrm{d}\\mu(\\omega,x)+\\chi_{\\{f-\\gamma-q=0\\}}}\\\\ &{\\qquad=\\left\\{\\begin{array}{l l}{\\underset{\\gamma}{\\operatorname*{sup}}\\int_{\\Omega}\\gamma(\\omega)\\Gamma(\\omega)\\mathrm{d}\\nu(\\omega)+\\int_{\\Omega\\times X}(f(x,\\omega)-\\gamma(\\omega))\\mathrm{d}\\mu(\\omega,x)}&{\\mathrm{~if~}f-\\gamma=\\in\\mathcal{P}_{\\geq0}(X\\times\\Omega)}\\\\ {\\infty}&{\\mathrm{~else}}\\end{array}\\right.}\\\\ &{\\qquad=\\left\\{\\begin{array}{l l}{\\underset{\\gamma}{\\operatorname*{sup}}\\int_{\\Omega}\\gamma(\\omega)(\\Gamma(\\omega)-\\mu_{\\omega}(X))\\mathrm{d}\\nu(\\omega)+\\int_{\\Omega\\times X}(f(x,\\omega)\\mathrm{d}\\mu(\\omega,x)}&{\\mathrm{~if~}f-\\gamma\\in\\mathcal{P}_{\\geq0}(X\\times\\Omega)}\\\\ {\\infty}&{\\mathrm{~else}}\\end{array}\\right.}\\\\ &{\\qquad=\\left\\{\\begin{array}{l l}{\\int_{\\Omega\\times X}(f(x,\\omega)\\mathrm{d}\\mu(\\omega,x)}&{\\mathrm{~if~}f-\\gamma\\in\\mathcal{P}_{\\geq0}(X\\times\\Omega)\\mathrm{~and~}\\Gamma(\\omega)=\\mu_{\\omega}(X)}\\\\ {\\infty}&{\\mathrm{~else}}\\end{array}\\right.}\\end{array}\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "Altogether, we get ", "page_idx": 17}, {"type": "equation", "text": "$$\n-f^{*}(\\Gamma,\\mu)-g^{*}(-\\Gamma,-\\mu)=\\left\\{\\int_{\\Omega\\times X}f(x,\\omega)\\mathrm{d}\\mu(\\omega,x)\\ \\ \\ \\ \\ \\mathrm{if}\\ \\mu_{\\omega}(X)=1\\right.\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "A.5.2 Convergence of S-SOS hierarchy ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "$c^{*}(\\omega)$ is at best Lipschitz continuous By Proposition 2.1, we argue that $c^{*}(\\omega)=\\operatorname*{inf}_{x}f(x,\\omega)$ is Lipschitz continuous. One cannot expect much more as the following example shows: ", "page_idx": 17}, {"type": "text", "text": "Example A.4. Consider $g:\\mathbb{R}\\times\\mathbb{R}^{2}\\rightarrow\\mathbb{R}$ defined by ", "page_idx": 17}, {"type": "equation", "text": "$$\ng(x,p,q)=(x^{2}+p x+q)^{2}.\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "Then we have for every $(p,q)\\in\\mathbb{R}^{2}$ that ", "page_idx": 17}, {"type": "equation", "text": "$$\n\\operatorname*{inf}_{x\\in\\mathbb{R}}g(x,p,q)={\\left\\{\\!\\!\\!\\begin{array}{l l}{0}&{{\\mathrm{if~}}{\\frac{p^{2}}{4}}\\geq q}\\\\ {({\\frac{p^{2}}{4}}-q)^{2}}&{{\\mathrm{else}}.}\\end{array}\\!\\!\\right.}\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "Therefore, $(p,q)\\mapsto\\operatorname*{inf}_{x\\in\\mathbb{R}}g(x,p,q)$ is once differentiable but not twice. ", "page_idx": 17}, {"type": "text", "text": "Lemma on approximating polynomials ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Lemma A.5. Let $\\Omega$ be a compact subset of $\\mathbb{R}^{n}$ and $g:\\Omega\\to\\mathbb{R}$ be Lipschitz continuous. Then there exists a trigonometric polynomial $g_{s}$ of degree s and a constant $C>0$ depending only on $\\Omega$ and n such that ", "page_idx": 18}, {"type": "equation", "text": "$$\ng\\geq g_{s}\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "and ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\|g-g_{s}\\|_{L^{1}(\\Omega)}\\leq\\frac{1+\\ln(s)}{s}C\\|g\\|_{H^{1}(\\Omega)}.\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "Proof. By Jackson\u2019s inequality for Lipschitz functions [48] we have the existence of a trigonometric polynomial $g^{\\prime}$ of degree $s$ with ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\lVert g-g^{\\prime}\\rVert_{L^{1}(\\Omega)}\\leq\\frac{C^{\\prime}}{s}\\lVert g\\rVert_{H^{1}(\\Omega)}\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "as well as ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\lVert g-g^{\\prime}\\rVert_{L^{\\infty}(\\Omega)}\\leq L_{g}\\frac{\\ln(s)}{s}.\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "Then we define $g_{s}=g^{\\prime}-\\left\\lVert g-g^{\\prime}\\right\\rVert_{L^{\\infty}(\\Omega)}$ and hence $g\\geq g_{s}$ . Furthermore, ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\left\\lVert g-g_{s}\\right\\rVert_{L^{1}(\\Omega)}\\le\\frac{(C^{\\prime}+|\\Omega|\\ln s)}{s}L_{g}.\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "Writing $C(\\Omega)=\\operatorname*{max}\\{C^{\\prime},|\\Omega|\\}$ we have the desired form where $|\\Omega|$ is the volume of $\\Omega$ . ", "page_idx": 18}, {"type": "text", "text": "Convergence at $\\ln s/s$ rate using integral operator methodology ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Theorem A.1 (Asymptotic convergence of S-SOS). Let $f:[0,1]^{n}\\times\\Omega\\to\\mathbb{R}$ be a trigonometric polynomial of degree $2r$ , $c^{*}(\\omega)=\\operatorname*{inf}_{x}f(x,\\omega)$ the optimal lower bound as a function of $\\omega$ , and $\\nu$ any probability measure on compact $\\Omega\\subset\\mathbb{R}^{d}$ . Let $\\boldsymbol{s}=\\left(s_{x},s_{\\omega},s_{c}\\right)$ , referring separately to the degree of the basis in $x$ terms, the degree of the basis in $\\omega$ terms, and the degree of the lower-bounding polynomial $c(\\omega)$ . ", "page_idx": 18}, {"type": "text", "text": "Let $c_{2s}^{*}(\\omega)$ be the lower bounding function obtained from the primal S-SOS SDP with $m_{s}(x,\\omega)$ a spanning basis of trigonometric monomials with degree $\\le s_{x}$ in $x$ terms and of degree $\\le s_{\\omega}$ in $\\omega$ terms: ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\begin{array}{r}{p_{2s}^{*}=\\underset{c\\in\\mathcal{P}^{2s_{c}}(\\Omega),W\\succcurlyeq0}{\\operatorname*{sup}}\\int c(\\omega)\\mathrm{d}\\nu(\\omega)}\\\\ {s.t.\\quad f(x,\\omega)-c(\\omega)=m_{s}(x,\\omega)^{T}W m_{s}(x,\\omega)}\\end{array}\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "Then there is a constant $C>0$ depending only on $\\Omega,d$ , and n such that for all $s_{\\omega},s_{x}\\ge\\mathrm{max}\\{3r,3s_{c}\\}$ the following holds: ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\int_{\\Omega}\\left[c^{*}(\\omega)-c_{2s}^{*}(\\omega)\\right]\\mathrm{d}\\nu(\\omega)\\leq|\\Omega|\\epsilon(f,s)\n$$", "text_format": "latex", "page_idx": 18}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\varepsilon(f,s)\\leq\\Vert f-\\bar{f}\\Vert_{F}\\left[1-\\left(1-\\frac{6r^{2}}{s_{\\omega}^{2}}\\right)^{-d}\\left(1-\\frac{6r^{2}}{s_{x}^{2}}\\right)^{-n}\\right]}\\\\ &{\\qquad\\qquad+\\left\\Vert c^{*}-\\bar{c}^{*}\\right\\Vert_{F}\\left[1-\\left(1-\\frac{6r^{2}}{s_{\\omega}^{2}}\\right)^{-d}\\right]+C\\frac{\\left(1+\\ln(2s_{c})\\right)}{2s_{c}}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "where $\\bar{f}$ denotes the average value of the function $f$ over $[0,1]^{n}$ , i.e. $\\textstyle{\\bar{f}}\\;=\\;\\int_{[0,1]^{n}}f(x)d x$ and $\\begin{array}{r}{||f(x)||_{F}=\\sum_{\\hat{x}}|\\hat{f}(\\hat{x})|}\\end{array}$ denotes the norm of the Fourier coefficients. ", "page_idx": 18}, {"type": "text", "text": "$\\epsilon(f,s)$ bounds the expected error, giving us asymptotic convergence as $s=\\mathrm{min}(s_{x},s_{\\omega},s_{c})\\rightarrow\\infty$ . Note the first two terms give a $\\textstyle O\\big(\\frac{1}{s^{2}}\\big)$ convergence rate. However, the overall error will be dominated by the degree of $c(\\omega)$ (from the third term) hence our convergence rate is $O(\\frac{\\ln s}{s})$ . ", "page_idx": 18}, {"type": "text", "text": "Proof of Theorem A.1. Let $\\Omega\\subset\\mathbb{R}^{d}$ be compact and $f:R^{n}\\times\\Omega\\to\\mathbb{R}$ be a 1-periodic trigonometric polynomial (t.p.) of degree $\\le~2r$ . We then make $\\Omega$ isomorphic to $[0,1]^{d}$ and hereafter consider $\\Omega=[0,1]^{d}$ and $f:[0,1]^{n}\\times[0,1]^{d}\\to\\mathbb{R}$ . Let $\\varepsilon>0$ and $\\begin{array}{r}{b=\\frac{\\varepsilon}{2}}\\end{array}$ . Let the best lower bound be ", "page_idx": 19}, {"type": "equation", "text": "$$\nc^{*}(\\omega)=\\operatorname*{inf}_{x\\in X}f(x,\\omega).\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "Proof outline. We split the error into two parts. First, we use the fact that there is a lower-bounding t.p. $c_{a}^{*}$ of degree $s_{c}$ such that ", "page_idx": 19}, {"type": "equation", "text": "$$\n\\|c^{*}-c_{a}^{*}\\|\\leq C\\frac{1+\\ln{s_{c}}}{s_{c}}\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "and ", "page_idx": 19}, {"type": "equation", "text": "$$\nc^{*}\\geq c_{a}^{*}.\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "This will provide us with a degree- $s_{c}$ t.p. approximation to the lower bounding function, which in general is only known to be Lipschitz continuous. ", "page_idx": 19}, {"type": "text", "text": "Next, we show, that for any $b>0$ there is a degree- $.2s$ SOS t.p. $f_{\\mathrm{SOS}}(x,\\omega)$ such that ", "page_idx": 19}, {"type": "equation", "text": "$$\nf_{\\mathrm{SOS}}=f-(c_{a}^{*}-b).\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "We write $\\boldsymbol{s}=(s_{x},s_{\\omega})$ where $s_{x},s_{\\omega}$ denotes the respective max degrees in the variables $x,\\omega$ . Once we have constructed this, we can compute $f-f_{\\mathrm{SOS}}=c_{a}^{*}\\!-\\!\\varepsilon$ and since we know that $f_{\\mathrm{SOS}}\\ge0$ everywhere and $c_{a}^{*}-\\varepsilon$ is some degree- $s_{c}$ t.p. we have found a degree- $s_{c}$ lower-bounding t.p. The construction of this SOS t.p. adds another error term. If we can drive $\\varepsilon\\rightarrow0$ as $\\bar{s}=\\operatorname*{min}(s_{x},s_{\\omega},s_{c})\\rightarrow\\infty$ then we are done. ", "page_idx": 19}, {"type": "text", "text": "Proof continued. To that end, let $c_{a}^{*}:\\Omega\\to\\mathbb{R}$ be the best degree- $s_{c}$ trigonometric approximation of $c^{*}$ with respect to $L^{1}$ such that ", "page_idx": 19}, {"type": "equation", "text": "$$\nc^{*}\\geq c_{a}^{*}.\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "By [30], we know that $c^{*}$ is locally Lipschitz continuous with Lipschitz constant $L_{c^{*}}$ and hence, by Lemma A.5 we get that there is $C(\\Omega)>0$ such that ", "page_idx": 19}, {"type": "equation", "text": "$$\n\\|c^{*}-c_{a}^{*}\\|_{L^{1}\\Omega})\\leq C(\\Omega)\\frac{1+\\ln s_{c}}{s_{c}}L_{c^{*}}.\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "Next we introduce $c_{2s}^{*}(\\omega)$ which is some degree- $2s$ t.p. After an application of the triangle inequality and Cauchy-Schwarz on the integrated error term $\\begin{array}{r}{\\int_{\\Omega}\\bar{|}c^{*}-c_{2s}^{*}\\bar{|}d\\bar{\\omega}}\\end{array}$ we have ", "page_idx": 19}, {"type": "equation", "text": "$$\n\\int_{\\Omega}\\left|\\operatorname*{inf}_{x\\in X}f(x,\\omega)-c_{2s}^{*}(\\omega)\\right|\\mathrm{d}\\omega\\leq\\int_{\\Omega}|c_{a}^{*}(\\omega)-c_{2s}^{*}(\\omega)|\\mathrm{d}\\omega+|\\Omega|\\|c^{*}-c_{a}^{*}\\|_{L^{2}(\\Omega)}\n$$", "text_format": "latex", "page_idx": 19}, {"type": "equation", "text": "$$\n\\int_{\\Omega}\\left|\\operatorname*{inf}_{x\\in X}f(x,\\omega)-c_{2s}^{*}(\\omega)\\right|\\mathrm{d}\\omega\\leq\\qquad\\int_{\\Omega}|c_{a}^{*}(\\omega)-c_{2s}^{*}(\\omega)|\\mathrm{d}\\omega\\qquad+\\underbrace{C(\\Omega)\\frac{1+\\ln s_{c}}{s_{c}}L_{c^{*}}}_{=\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\! \n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "Now we want to show that for any $\\varepsilon>0$ we can construct a degree- $2s$ SOS trigonometric polynomial $f_{\\mathrm{SOS}}(x,\\omega)$ such that ", "page_idx": 19}, {"type": "equation", "text": "$$\nf_{\\mathrm{SOS}}=f-c_{a}^{*}+b.\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "with $b=\\varepsilon/2$ and $s=(s_{x},s_{\\omega})>r$ . We can then set $f-f_{\\mathrm{SOS}}=c_{a}^{*}-b=c_{2s}^{*}$ as the degree- $.2s$ lower-bounding function. If we can drive $b=\\varepsilon/2\\to0$ as $s,s_{c}\\to\\infty$ we are done, as by construction $|c_{a}^{*}-c_{2s}^{*}|=b$ . ", "page_idx": 19}, {"type": "text", "text": "Observe that by assumption $f-c_{a}^{*}+b$ is a t.p. in $(x,\\omega)$ where $f$ is degree- $2r$ and $c_{a}^{*}$ is degree $s_{c}\\geq2r$ . Denote by $(f-f_{*}^{a}+b)_{\\omega}$ its coefficients w.r.t the $\\omega$ basis. Note that the coefficients are functions in $x$ . Following the integral operator proof methodology in [6], define the integral operator $T$ to be ", "page_idx": 19}, {"type": "equation", "text": "$$\nT h(x,\\omega)=\\int_{X\\times\\Omega}|q_{\\omega}(\\omega-\\bar{\\omega})|^{2}|q_{x}(x-\\bar{x})|^{2}h(\\bar{x},\\bar{\\omega})\\mathrm{d}\\bar{x}\\mathrm{d}\\bar{\\omega},\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "where $q_{\\omega}$ is a trigonometric polynomial in $\\omega$ of degree $\\le s_{\\omega}$ and $q_{x}$ is a trigonometric polynomial in $x$ of degree $\\leq s_{x}$ . The intuition is that this integral operator explicitly builds a SOS function of degrees $\\left(s_{x},s_{\\omega}\\right)$ out of any non-negative function $h$ by hitting it against the kernels $q_{x},q_{\\omega}$ . ", "page_idx": 19}, {"type": "text", "text": "We want to find a positive function $h:X\\times\\Omega\\to\\mathbb{R}$ such that ", "page_idx": 20}, {"type": "equation", "text": "$$\nT h=f-c_{a}^{*}+b.\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "In frequency space, the Fourier transform turns a convolution into pointwise multiplication so we have: ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\widehat{T h}(\\hat{x},\\hat{\\omega})=\\hat{q}_{\\omega}*\\hat{q}_{\\omega}(\\hat{\\omega})\\cdot\\hat{q}_{x}*\\hat{q}_{x}(\\hat{x})\\cdot\\hat{h}(\\hat{x},\\hat{\\omega}).\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "In the Fourier domain it is easy to write down the coefficients of $\\hat{h}$ : ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\hat{h}(\\hat{x},\\hat{\\omega})=\\left\\{\\begin{array}{l l}{0}&{\\mathrm{if}\\;\\|\\hat{x},\\hat{\\omega}\\|_{\\infty}>\\operatorname*{max}\\{2r,2s_{c}\\}}\\\\ {\\displaystyle\\frac{\\hat{f}(\\hat{x},\\hat{\\omega})-\\hat{c}_{a}^{*}(\\hat{\\omega})1_{\\hat{x}=0}+b1_{\\hat{x}=0}1_{\\hat{\\omega}=0}}{\\hat{q}_{\\omega}*\\hat{q}_{\\omega}(\\hat{\\omega})\\cdot\\hat{q}_{x}*\\hat{q}_{x}(\\hat{x})}}&{\\mathrm{otherwise}.}\\end{array}\\right.\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "Computing $T h-h$ gives: ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\quad f(x,\\omega)-c_{a}^{*}(\\omega)+b-h(x,\\omega)}\\\\ &{=\\displaystyle\\sum_{\\hat{\\omega},\\hat{x}}\\hat{f}(\\hat{x},\\hat{\\omega})\\left(1-\\frac{1}{\\hat{q}_{\\omega}*\\hat{q}_{\\omega}(\\hat{\\omega})\\cdot\\hat{q}_{x}*\\hat{q}_{x}(\\hat{x})}\\right)\\exp(2i\\pi\\hat{\\omega}^{T}\\omega)\\exp(2i\\pi\\hat{x}^{T}x)}\\\\ &{\\quad+\\displaystyle\\sum_{\\hat{\\omega}}(b1_{\\hat{\\omega}=0}-c_{a}^{*})\\left(1-\\frac{1}{\\hat{q}_{\\omega}*\\hat{q}_{\\omega}(\\hat{\\omega})}\\right)\\exp(2i\\pi\\hat{\\omega}^{T}\\omega)}\\end{array}\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "and thus after requiring $\\hat{q}_{\\omega}*\\hat{q}_{\\omega}(0)=\\hat{q}_{x}*\\hat{q}_{x}(0)=1$ we have: ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\underset{x,\\omega}{\\mathrm{max}}\\,|f(x,\\omega)-c_{a}^{*}(\\omega)+b-h(x,\\omega)|}\\\\ &{\\leq\\!||f-\\bar{f}||_{F}\\underset{\\hat{\\omega}\\not=0}{\\operatorname*{max}}\\,\\underset{\\hat{x}\\not=0}{\\operatorname*{max}}\\,\\bigg|1-\\frac{1}{\\hat{q}_{\\omega}\\ast\\hat{q}_{\\omega}(\\hat{\\omega})\\cdot\\hat{q}_{x}\\ast\\hat{q}_{x}(\\hat{x})}\\bigg|}\\\\ &{\\quad+\\underset{\\hat{\\omega}\\not=0}{\\operatorname*{max}}\\,\\big\\|c_{a}^{*}-\\bar{c}_{a}^{*}\\big\\|_{F}\\bigg\\vert1-\\frac{1}{\\hat{q}_{\\omega}\\ast\\hat{q}_{\\omega}(\\hat{\\omega})}\\bigg\\vert.}\\end{array}\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "As a reminder, because $c^{*}\\geq c_{a}^{*}$ everywhere we have $f-c_{a}\\geq f-c^{*}\\geq0$ or $f-c_{a}^{*}+b>0$ , since $b=\\varepsilon/2>0$ . Since $T h=f-c_{a}^{*}+b>0$ and it is a SOS, we need to guarantee $h>0$ . ", "page_idx": 20}, {"type": "text", "text": "If $\\begin{array}{r}{\\operatorname*{max}_{x,\\omega}|f(x,\\omega)-f_{*}^{a}(\\omega)+b-h(x,\\omega)|\\leq b}\\end{array}$ then ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\operatorname*{max}_{x,\\omega}|T h-h|<b.\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "Since $T h\\geq b$ and $b>0$ we have ", "page_idx": 20}, {"type": "equation", "text": "$$\nh=T h+h-T h\\geq T h-\\|h-T h\\|_{\\infty}\\geq b-b\\geq0\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "and hence $h>0$ if we ensure $\\operatorname*{max}_{x,\\omega}\\left|T h-h\\right|\\leq b$ . ", "page_idx": 20}, {"type": "text", "text": "Now let us show that ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\operatorname*{max}_{x,\\omega}|f(x,\\omega)-c_{a}^{*}(\\omega)+b-h(x,\\omega)|\\leq b\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "can be ensured if $\\boldsymbol{s}=(s_{x},s_{\\omega})$ is large enough. ", "page_idx": 20}, {"type": "text", "text": "Using the same kernel and bounds as in [6], we choose for $z\\in\\{x,\\omega\\}$ the triangular kernel such that ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\hat{q}_{z}(\\hat{z})=\\left(1-\\frac{6r^{2}}{z^{2}}\\right)_{+}^{d}\\prod_{i=1}^{d}\\left(1-\\frac{|\\hat{z}_{i}|}{s_{x,\\omega}}\\right)_{+}.\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "Note that $(x)_{+}=\\operatorname*{max}(x,0)$ . Then we have ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\underset{x}{\\mathrm{max}}\\,|\\,f(x,\\omega)-c_{a}^{*}(\\omega)+b-h(x,\\omega)|}\\\\ &{\\leq\\!||\\boldsymbol{f}-\\bar{\\boldsymbol{f}}||_{F}\\underset{\\bar{\\omega},\\hat{x}}{\\mathrm{max}}\\,\\bigg|1-\\frac{1}{\\hat{q}_{\\omega}\\ast\\hat{q}_{\\omega}(\\hat{\\omega})\\cdot\\hat{q}_{x}\\ast\\hat{q}_{x}(\\hat{x})}\\bigg|+\\|c_{a}^{*}-\\bar{c}_{a}^{*}\\|_{F}\\underset{\\hat{\\omega}}{\\mathrm{max}}\\,\\bigg|1-\\frac{1}{\\hat{q}_{\\omega}\\ast\\hat{q}_{\\omega}(\\hat{\\omega})}\\bigg|}\\\\ &{\\leq\\!||\\boldsymbol{f}-\\bar{\\boldsymbol{f}}||_{F}\\bigg|1-\\left(1-\\frac{6r^{2}}{s_{\\omega}^{2}}\\right)^{-d}\\left(1-\\frac{6r^{2}}{s_{x}^{2}}\\right)^{-n}\\bigg|+\\|c_{a}^{*}-\\bar{c}_{a}^{*}\\|_{F}\\bigg|1-\\left(1-\\frac{6^{2}}{s_{\\omega}^{2}}\\right)^{-d}\\bigg|}\\end{array}\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "Therefore, by choosing $s_{\\omega}$ and $s_{x}$ large enough such that ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\|f-\\bar{f}\\|_{F}\\bigg|1-\\left(1-\\frac{6r^{2}}{s_{\\omega}^{2}}\\right)^{-d}\\left(1-\\frac{6r^{2}}{s_{x}^{2}}\\right)^{-n}\\bigg|+\\|c_{a}^{*}-\\bar{c}_{a}^{*}\\|_{F}\\bigg|1-\\left(1-\\frac{6^{2}}{s_{\\omega}^{2}}\\right)^{-d}\\bigg|\\leq b=\\frac{\\varepsilon}{2}\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "we have ", "page_idx": 21}, {"type": "equation", "text": "$$\nh\\geq0\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "and thus $T h$ is SOS. By design we have ", "page_idx": 21}, {"type": "equation", "text": "$$\nc_{a}^{*}-c_{2s}^{*}\\leq b\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "and thus ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\int_{\\Omega}|c_{a}^{*}-c_{2s}^{*}|\\mathrm{d}\\omega\\leq\\frac{\\varepsilon}{2}.\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "Recalling ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\int_{\\Omega}\\left|\\operatorname*{inf}_{x\\in X}f(x,\\omega)-c_{2s}^{*}(\\omega)\\right|\\mathrm{d}\\omega\\leq\\qquad\\int_{\\Omega}|c_{a}^{*}(\\omega)-c_{2s}^{*}(\\omega)|\\mathrm{d}\\omega\\qquad+\\underbrace{C(\\Omega)\\frac{1+\\ln s_{c}}{s_{c}}L_{c^{*}}}_{=\\!\\!\\!\\!\\!\\!\\sum_{k=1}^{K}\\!\\!\\!\\!\\!\\!\\sum_{k=1}^{K}\\!\\!\\!\\!\\!\\!\\!\\int_{\\Omega}\\!\\!\\!\\!\\!\\!\\!\\int_{\\Omega}\\!\\!\\!\\!\\!\\!\\!\\int_{\\Omega}\\!\\!\\!\\!\\!\\!\\!\\!|c_{\\omega}^{\\prime}(\\omega)\\cdot d\\overline{{\\Omega}}|\\mathrm{d}\\omega,\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "we can additionally choose $s_{c}$ large enough to guarantee ", "page_idx": 21}, {"type": "equation", "text": "$$\nC(\\Omega)\\frac{1+\\ln s_{c}}{s_{c}}L_{c^{*}}\\leq\\frac{\\varepsilon}{2}\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "and then we are done. ", "page_idx": 21}, {"type": "text", "text": "Setting $s_{x},s_{\\omega},s_{c}=s$ and sending $s\\to\\infty$ we have asymptotic behavior of the final error expression: ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\boxed{\\int_{\\Omega}\\bigg|\\operatorname*{inf}_{x\\in X}f(x,\\omega)-c_{2s}^{*}(\\omega)\\bigg|\\mathrm{d}\\omega\\leq C_{1}\\frac{1}{s^{2}}+C_{2}\\frac{1}{s}+C_{3}\\frac{\\ln s}{s}=\\mathcal{O}\\left(\\frac{\\ln s}{s}\\right)}\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "with the constants $C_{1},C_{2},C_{3}$ depending on $r,n,d,\\|f-\\bar{f}\\|_{F},\\|c_{a}-\\bar{c}_{a}^{*}\\|_{F},\\Omega$ and $L_{c^{*}}$ ", "page_idx": 21}, {"type": "text", "text": "Convergence at $1/s$ rate using piecewise-constant approximation to $c^{*}(\\omega)$ Prior work [6] achieves $1/s^{2}$ convergence for the regular SOS hierarchy without further assumptions. In our work, we could only achieve $\\ln s/s$ for S-SOS due to the need to first approximate the tightest lower-bounding function $c^{*}(\\omega)$ with a polynomial approximation, which converges at a slower rate. ", "page_idx": 21}, {"type": "text", "text": "To accelerate the convergence rate, we want to control the regularity of $c^{*}(\\omega)$ . We can achieve $1/s$ by approximating the $c^{*}(\\omega)$ pointwise instead of using a smooth parameterized polynomial. By constructing a domain decomposition of $\\Omega$ and finding a SOS approximation in $x$ for each domain, we can stitch these together to build a piecewise-constant approximation to the lower-bounding function $c^{*}$ . This lets us leverage the $1/s^{2}$ rate for the standard SOS hierarchy, however note that we lose the guarantee that the lower-bounding function $c_{s}^{*}(\\omega)$ is a true lower bound everywhere. Another disadvantage of this approach is that the computational complexity scales exponentially in $d$ as we are required to solve for the SOS lower bound with degree $s$ pointwise at $O(\\dot{s_{p}^{d}})$ points. ", "page_idx": 21}, {"type": "text", "text": "For $\\Omega=[0,1]^{d}\\subset\\mathbb{R}^{d}$ we achieve the following: ", "page_idx": 21}, {"type": "text", "text": "Proposition A.6. Let $\\Omega=[0,1]^{d}$ and $f:[0,1]^{n}\\rightarrow\\mathbb{R}$ be a trigonometric polynomial of degree $2r$ . Let $\\{\\omega_{i}\\}$ be grid points where $s_{p}$ is the number of equally-spaced points along each dimension for $a$ total of $(s_{p})^{d}$ points in $\\Omega$ . Denote by $c_{s}^{*}(\\omega_{i})$ the best SOS approximation of degree s of $x\\mapsto f(x,\\omega_{i})$ at each grid point $\\omega_{i}$ and define ", "page_idx": 21}, {"type": "equation", "text": "$$\nc_{s}^{*}(\\omega)=\\sum_{i=1}^{s_{p}^{d}}c_{s}^{*}(\\omega_{i})1_{\\omega\\in\\mathcal{B}_{\\infty}(\\omega_{i},\\epsilon)}\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "where $B_{\\infty}(\\omega_{i},\\epsilon)$ denotes the $L_{\\infty}$ ball of radius \u03f5 centered at $\\omega_{i}$ with $\\epsilon=(2s_{p})^{-1}$ so that the balls are non-overlapping. Then we have for some constant $C^{\\prime}$ depending only on $\\operatorname*{max}_{\\omega_{i}}||f(\\omega_{i},\\cdot)-$ $\\bar{f}(\\omega_{i},\\cdot)||_{F},r,\\bar{n_{}}\\bar{d},s_{p}$ : ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\int_{\\Omega}[c^{*}(\\omega)-c_{s}^{*}(\\omega)]\\mathrm{d}\\omega\\leq\\operatorname*{max}_{\\omega_{i}}\\|f(\\omega_{i},\\cdot)-\\bar{f}(\\omega_{i},\\cdot)\\|_{F}\\left[1-\\left(1-\\frac{6r^{2}}{s^{2}}\\right)^{-n}\\right]+\\frac{C\\sqrt{d}}{s_{p}}\\leq\\frac{C^{\\prime}}{s}.\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "Proof of Proposition A.6. Let $c_{a}^{*}(\\omega):[0,1]^{d}\\rightarrow\\mathbb{R}$ be the best piecewise-constant approximation of the true lower-bounding function $c^{*}(\\omega)=\\operatorname*{inf}_{x}f(x,\\omega)$ on equidistant grid-points, i.e. $s_{p}$ evenlyspaced points in each dimension for a total of $s_{p}^{d}$ points. ", "page_idx": 22}, {"type": "text", "text": "Now also define a piecewise-constant approximation using the best pointwise SOS lower bounds: ", "page_idx": 22}, {"type": "equation", "text": "$$\nc_{s}^{*}(\\omega)=\\sum_{i=1}^{s_{p}^{d}}c_{s}^{*}(\\omega_{i})1_{\\omega\\in\\mathcal{B}_{\\infty}(\\omega_{i},\\epsilon)}\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "where $c_{s}^{*}(\\omega_{i})$ is the best lower bound (resulting from regular SOS) of degree $s$ of $x\\mapsto f(x,\\omega_{i})$ and $B_{\\infty}(\\omega_{i},\\epsilon)$ denotes the $L_{\\infty}$ ball of radius $\\epsilon$ centered at $\\omega_{i}$ with $\\epsilon\\,=\\,(2\\bar{s}_{p})^{-1}$ so that the balls are non-overlapping. ", "page_idx": 22}, {"type": "text", "text": "By [6] we have that $c_{a}^{*}(\\omega_{i})-c_{s}^{*}(\\omega_{i})$ can be bounded by ", "page_idx": 22}, {"type": "equation", "text": "$$\n\\operatorname*{max}_{\\omega_{i}}\\|f(\\omega_{i},\\cdot)-\\bar{f}(\\omega_{i},\\cdot)\\|_{F}\\left(1-\\left(1-\\frac{6r^{2}}{s^{2}}\\right)^{-n}\\right).\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "Then we have: ", "page_idx": 22}, {"type": "equation", "text": "$$\n\\int_{\\Omega}[c^{*}(\\omega)-c_{s}^{*}(\\omega)]\\mathrm{d}\\omega\\leq\\sum_{i=1}^{s_{p}^{d}}|c_{a}^{*}(\\omega_{i})-c_{s}^{*}(\\omega_{i})|(2\\epsilon)^{d}+\\|c^{*}-c_{a}^{*}\\|_{L^{1}(\\Omega)}.\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "Using the same bound we get for the first term from the proof of Theorem A.1, we can reduce the first term to a ${\\cal O}(1/s^{2})$ dependence and we use the theorem on the $L^{1}$ convergence of piecewise-constant approximation to 1-periodic trigonometric polynomials from [48] for the second: ", "page_idx": 22}, {"type": "equation", "text": "$$\n\\int_{\\Omega}[c^{*}(\\omega)s-c_{s}^{*}(\\omega)]\\mathrm{d}\\omega\\leq\\operatorname*{max}_{\\omega_{i}}\\|f(\\cdot,\\omega_{i})-\\bar{f}(\\cdot,\\omega_{i})\\|_{F}\\left(1-\\left(1-\\frac{6r^{2}}{s^{2}}\\right)^{-n}\\right)|\\Omega|+\\frac{C\\sqrt{d}}{s_{p}}\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "It is straightforward to extend this to arbitrary compact $\\Omega\\subset\\mathbb{R}^{d}$ , as one can construct a smooth homeomorphism between $\\Omega$ and $[0,1]^{d}$ and therefore we can achieve the same convergence rates on general compact $\\Omega$ as we can for $[0,1]^{d}$ . \u53e3 ", "page_idx": 22}, {"type": "text", "text": "A.6 S-SOS for a simple quadratic potential ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "We provide a simple application of S-SOS to a simple quadratic potential that admits a closed-form solution so as to demonstrate its usage and limitations. ", "page_idx": 22}, {"type": "text", "text": "A.6.1 Analytic solution for the lower bounding function $c^{*}(\\omega)$ with $\\omega\\sim\\mathbf{Uniform}(-1,1)$ ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Let $x\\in\\mathbb R$ and $\\omega\\sim\\mathrm{Uniform}(-1,1)$ . Suppose that we have ", "page_idx": 22}, {"type": "equation", "text": "$$\nf(x,\\omega)=(x-\\omega)^{2}+(\\omega x)^{2}\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "In this case we may explicitly evaluate the exact minimum function $c^{*}(\\omega)=\\operatorname*{inf}_{x}f(x;\\omega)$ . Note that ", "page_idx": 22}, {"type": "equation", "text": "$$\nf(x;\\omega)=x^{2}-2\\omega x+\\omega^{2}+\\omega^{2}x^{2}\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "Explicitly evaluating the zeros of the first derivative we have ", "page_idx": 22}, {"type": "equation", "text": "$$\n\\begin{array}{c}{\\partial_{x}f(x;\\omega)=2x^{*}-2\\omega+2\\omega^{2}x^{*}=0}\\\\ {x^{*}(1+\\omega^{2})=\\omega}\\\\ {x^{*}=\\displaystyle\\frac{\\omega}{1+\\omega^{2}}}\\end{array}\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "and, thus, ", "page_idx": 22}, {"type": "equation", "text": "$$\nc^{*}(\\omega)=\\operatorname*{inf}_{x}f(x;\\omega)=\\frac{\\omega^{4}}{1+\\omega^{2}}.\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "Note that despite $f(x,\\omega)$ being a simple degree-2 SOS polynomial, the tightest lower-bound $c^{*}(\\omega)=$ $\\operatorname{inf}_{x}f(x,\\omega)$ is explicitly not polynomial. However, it is algebraic, as it is defined implicitly as the root of the polynomial equation ", "page_idx": 22}, {"type": "equation", "text": "$$\nc^{*}(\\omega)(1+\\omega^{2})-\\omega^{4}=0\n$$", "text_format": "latex", "page_idx": 22}, {"type": "image", "img_path": "iChQIJtjHB/tmp/fab1a1eb78e9e223176a2443a5f17c1ba03c26aad785b1f3ad9143995b44004f.jpg", "img_caption": ["Figure 2: Lower bound functions for basis function degree $d=2,4$ (left) and the optimality gap to the true lower bound $c^{*}(\\omega)-c_{2s}^{*}(\\omega)$ (right) "], "img_footnote": [], "page_idx": 23}, {"type": "text", "text": "A.6.2 Degree- $2s$ S-SOS to find a polynomial lower-bounding function $c_{2s}^{*}(\\omega)$ ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Observe that the tightest lower-bounding function $c^{*}(\\omega)$ is not polynomial even in this simple setting. However, we can relax the problem to trying to find $c_{2s}\\in\\mathcal{P}^{\\dot{2}s}(\\dot{\\Omega})$ to obtain a weaker bound with $\\operatorname*{inf}_{x}f(x,\\omega)=c^{*}(\\omega)\\geq c_{2s}{\\bar{(}}\\omega)$ . ", "page_idx": 23}, {"type": "text", "text": "We now proceed with formulating and solving the degree- $.2s$ primal S-SOS SDP (Equation (2)). We assume that $c_{2s}(\\omega)$ is parameterized by a polynomial of degree $\\leq2s$ in $\\omega$ . Observe that this class of functions is not large enough to contain the true function $c^{*}(\\omega)$ . ", "page_idx": 23}, {"type": "text", "text": "We choose $s\\;\\in\\;\\{2,4\\}$ and use the standard monomial basis in $x,\\omega$ , we have the feature maps $m_{2}(x,\\omega):\\mathbb{R}^{2}\\rightarrow\\mathbb{R}^{6}$ and $m_{4}(x,\\omega):\\mathbb{R}^{2}\\rightarrow\\mathbb{R}^{15}$ , since there are $\\binom{n+s}{s}$ unique monomials of up to degree- ${\\bf\\nabla}\\cdot{\\bf\\nabla}s$ in $n$ variables. These assumptions together enable us to explicitly write a SOS SDP in terms of coefficient matching. Note that we must assume some noise distribution $\\nu(\\omega)$ . For this section, we present results assuming $\\omega\\sim\\mathrm{Uniform}(-1,1)$ . We solve the resulting SDP in CVXPY using Legendre quadrature with $k=5$ zeroes on $[-1,1]$ to evaluate the objective $\\int c(\\omega)d\\nu(\\omega)$ . In fact, $k$ sample points suffice to exactly integrate polynomials of degree $\\leq2k-1$ . ", "page_idx": 23}, {"type": "text", "text": "We solve the SDP for two different levels of the hierarchy, $s=2$ and $s=4$ (producing lower-bound polynomials of degree 4 and 8 respectively), and plot the lower bound functions $c_{2s}(\\omega)$ vs the true lower bound $c^{*}(\\omega)=\\omega^{4}/(1+\\omega^{2})$ as well as the optimality gap to the true lower bound in Fig.2. ", "page_idx": 23}, {"type": "text", "text": "A.6.3 Convergence of lower bound as degree $s$ increases ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "To solve the S-SOS SDP in practice, we must choose a maximum degree $2s$ for the SOS function $m_{2}(x,\\omega)^{T}W m_{2}(x,\\omega)$ and the lower-bounding function $c(\\omega)$ , which are both restricted to be polynomials. Indeed, a larger $s$ not only increases the dimension of our basis function $m_{s}(x,\\omega)$ but also the complexity of the resulting SDP. We would expect that $d_{2s}^{*}\\to d^{*}$ as $s\\to\\infty$ , i.e. the optimal value of the degree- $.2s$ S-SOS SDP (Equation (4)) converges to that of the \u201cminimizing distribution\u201d optimization problem (Equation (3)). ", "page_idx": 23}, {"type": "text", "text": "In particular, note that in the standard SOS hierarchy we typically find finite convergence (exact agreement at some degree $2s^{*}<\\infty)$ ). However, in S-SOS, we thus far have only a guarantee of asymptotic convergence, as each finite-degree S-SOS SDP solves for a polynomial approximation to the optimal lower bound $c^{*}(\\omega)=\\operatorname*{inf}_{x\\in X}f(x,\\omega)$ . In Figure 1, we illustrate the primal S-SOS SDP objective values ", "page_idx": 23}, {"type": "equation", "text": "$$\np_{2s}^{*}=\\operatorname*{sup}_{c\\in\\mathscr{P}^{2s}(\\Omega)}\\int c(\\omega)d\\nu(\\omega)\\quad\\mathrm{with}\\quad f(x,\\omega)-c(\\omega)\\in\\mathcal{P}_{\\mathrm{SOS}}^{2s}(X\\times\\Omega)\n$$", "text_format": "latex", "page_idx": 23}, {"type": "image", "img_path": "iChQIJtjHB/tmp/86877a496546d5c38ff817008818d6ad9eb9ed23dce888a696680f0c355a395e.jpg", "img_caption": [], "img_footnote": [], "page_idx": 24}, {"type": "text", "text": "Figure 3: Different lower-bounding functions for degree-4 S-SOS done on the simple quadratic potential $f(x,\\omega)=(x-\\omega)^{2}+(\\omega\\bar{x)^{2}}$ . The true lower-bounding function $c^{*}(\\omega)$ is plotted in black. ", "page_idx": 24}, {"type": "text", "text": "for a given level of the hierarchy (a chosen degree $s$ for the basis $m_{s}(x,\\omega))$ ) and their convergence towards the optimal objective value ", "page_idx": 24}, {"type": "equation", "text": "$$\n\\int c^{*}(\\omega)d\\nu(\\omega)=\\frac{\\pi}{4}-\\frac{2}{3}\\approx0.1187\n$$", "text_format": "latex", "page_idx": 24}, {"type": "text", "text": "for the simple quadratic potential, assuming $\\begin{array}{r}{\\nu(\\omega)=\\frac{1}{2}}\\end{array}$ with $\\omega\\sim\\mathrm{Uniform}(-1,1)$ . We note that in the log-linear plot (right) we have a \u201chinge\u201d-type curve, with a linear decay (in logspace) and then flattening completely. This suggests perhaps that in realistic scenarios the degree needed to achieve a close approximation is very low, lower than suggested by our bounds. The flattening that occurs here is likely due to the numerical tolerance used in our solver (CVXPY/MOSEK), as increasing the tolerance also increases the asymptotic gap and decreases the degree at which the gap flattens out. ", "page_idx": 24}, {"type": "text", "text": "A.6.4 Effect of different noise distributions ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "In the previous two sections, we assumed that $\\omega\\sim\\mathrm{Uniform}(-1,1)$ . This enabled us to solve the primal exactly using Legendre quadrature of polynomials. Note that in Figure 1 we see that the lower-bounding $c_{2}^{*}(\\omega),c_{4}^{*}(\\omega)$ for $\\omega\\sim\\mathrm{Uniform}(-1,1)$ is a smooth polynomial that has curvature (i.e. sign matching that of the true minimum). This is actually not guaranteed, as we will see shortly. ", "page_idx": 24}, {"type": "text", "text": "In Figure 3, we present the lower-bounding functions $c_{4}^{*}(\\omega)$ achieved by degree-4 S-SOS by solving the dual for $\\omega\\ \\sim\\,\\mathrm{Normal}(0,\\sigma^{2})$ for varying widths $\\sigma$ . We can see that for small $\\sigma\\ll\\,1$ , the primal solution only cares about the lower-bound accuracy within a small region of $\\omega=0$ , and the lower-bounding curve fails to \u201cgeneralize\u201d effectively outside the region of consideration. ", "page_idx": 24}, {"type": "text", "text": "A.7 S-SOS for sensor network localization ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "A.7.1 SDP formulation ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Recall the form of $f(x,\\omega)$ : ", "page_idx": 24}, {"type": "equation", "text": "$$\nf(x,\\omega;X,A,r)=\\sum_{d_{i j}\\in\\mathcal{D}_{s s}(r)}(||x_{i}-x_{j}||_{2}^{2}-d_{i j}(\\omega)^{2})^{2}+\\sum_{d_{i k}\\in\\mathcal{D}_{s a}(r)}(||x_{i}-a_{k}||_{2}^{2}-d_{i k}(\\omega)^{2})^{2}\n$$", "text_format": "latex", "page_idx": 24}, {"type": "text", "text": "Note that the function $f(x,\\omega)$ is exactly a degree-4 SOS polynomial, so it suffices to choose the degree-2 monomial basis containing $\\boldsymbol{a}=\\binom{N\\ell+d+2}{2}$ elements as $m_{2}(x,\\omega):\\mathbb{R}^{N\\ell+d}\\rightarrow\\mathbb{R}^{a}$ . That is, we have $N$ sensor positions in $\\ell$ spatial dimensions and $d$ parameters for a total of $N\\ell+d$ variables. Let the moment matrix be $M\\in\\mathbb{R}^{a\\times a}$ with elements defined as ", "page_idx": 25}, {"type": "text", "text": "", "page_idx": 25}, {"type": "equation", "text": "$$\nM_{i,j}:=\\int m_{2}^{(i)}(x,\\omega)m_{2}^{(j)}(x,\\omega)d\\mu(x,\\omega)\n$$", "text_format": "latex", "page_idx": 25}, {"type": "text", "text": "for $i,j\\in\\{1,\\ldots,a\\}$ , which fully specifies the minimizing distribution $\\mu(x,\\omega)$ as in Equation (4). Our SDP is then of the form ", "page_idx": 25}, {"type": "equation", "text": "$$\n\\begin{array}{l}{d_{4}^{*}=\\displaystyle\\operatorname*{inf}_{y}\\sum_{\\alpha}f_{\\alpha}y_{\\alpha}}\\\\ {\\mathrm{~s.t.~}\\,M(y)\\succcurlyeq0}\\\\ {y_{\\alpha}=m_{\\alpha}\\vee(\\alpha,m_{\\alpha})\\in\\mathcal{M}_{\\nu}}\\\\ {y_{\\alpha}=y_{\\alpha}^{*}\\vee(\\alpha,y_{\\alpha}^{*})\\in\\mathcal{H}}\\end{array}\n$$", "text_format": "latex", "page_idx": 25}, {"type": "text", "text": "where $y_{\\alpha}=m_{\\alpha}$ corresponds to the moment-matching constraints of Equation (4) and $y_{\\alpha}\\,=\\,y_{\\alpha}^{*}$ correspond to any possible hard equality constraints required to set the exact position (and uncertainty) of a sensor $\\mathbb{E}[x_{i}]=x_{i}^{*},\\mathbb{E}[x_{i}^{2}]-\\mathbb{E}[x_{i}]^{2}=0$ for all $\\omega$ . $\\mathcal{M}_{\\nu}$ represents the $\\bar{(}_{2s}^{d+2s})$ moment-matching constraints necessary for all moments w.r.t. $\\omega$ and $\\mathcal{H}$ represents the $2\\ell n$ constraints needed to set the exact positions of $n$ known sensor positions in $\\mathbb{R}^{\\ell}$ (i.e. 1 constraint per sensor and dimension, 2 each for mean and variance). ", "page_idx": 25}, {"type": "text", "text": "A.7.2 Noise types ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "In this paper we focus on the linear uniform noise case, as it is a more accurate reflection of measurement noise in true SNL problems. Special robust estimation approaches may be needed to properly handle the outlier noise case. ", "page_idx": 25}, {"type": "text", "text": "\u2022 Linear uniform noise: for a subset of edges we write $d_{i j,k}(\\omega)\\,=\\,d_{i j}^{*}+\\epsilon\\omega_{k}$ , $\\omega_{k}\\textrm{\\,\\sim}$ Uniform $(-1,1)$ , and $\\epsilon\\geq0$ some noise scale we set. The same random variate $\\omega_{k}$ may perturb any number of edges. Otherwise the observed distances are the true distances. \u2022 Outlier uniform noise: for a subset of edge\u221as we ignore any information in the actual measurement $d_{i j,k}=\\omega_{k}$ , $\\omega_{k}\\sim\\mathrm{Uniform}(0,2\\sqrt{\\ell})$ where $\\ell$ is the physical dimension of the problem, i.e. $x_{i}\\in\\mathbb{R}^{\\ell}$ . ", "page_idx": 25}, {"type": "text", "text": "A.7.3 Algorithms: S-SOS and MCPO ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "Here we explicitly formulate MCPO and S-SOS as algorithms. Let $X=\\mathbb{R}^{n},\\Omega=\\mathbb{R}^{d}$ and use the standard monomial basis. We write $z=[x_{1},\\ldots,x_{n},\\omega_{1},\\ldots,\\omega_{d}]$ . Our objective is to approximate $c^{*}(\\omega)=\\operatorname*{inf}_{x}f(x,\\omega)$ for all $\\omega$ , with a view towards maximizing $\\int c^{*}(\\omega)d\\bar{\\nu}(\\omega)$ for $\\omega$ sampled from some probability density $\\nu(\\omega)$ . ", "page_idx": 25}, {"type": "text", "text": "MCPO (Algorithm 1) simply samples $\\omega_{t}$ and finds a set of tuples $(x^{*}(\\omega_{t}),\\omega_{t})$ where the optimal minimizer $\\left(x^{*}(\\omega_{t},\\omega_{t})\\right.$ is computed using a local optimization scheme (we use BFGS). ", "page_idx": 25}, {"type": "text", "text": "S-SOS (Algorithm 2) via solving the dual (Equation (4)) is also detailed below. ", "page_idx": 25}, {"type": "text", "text": "A.7.4 Cluster basis hierarchy ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "Recall from Section 2.2.2 that we defined the cluster basis hierarchy using body order $b$ and maximum degree per variable $t$ . In this section, we review the additional modifications needed to scale S-SOS for SNL. ", "page_idx": 25}, {"type": "text", "text": "In SNL, $f(x,\\omega)$ is by design a degree $s=4$ polynomial in $z=[x,\\omega]$ , with interactions of body order $b=2$ (due to the $(x_{i},x_{j})$ interactions) and maximum individual variable degree $t=4$ . Written this way, we want to only consider monomial terms $[x,\\omega]^{\\alpha}$ with $||\\alpha||_{1}\\leq s,||\\alpha||_{\\infty}\\leq4$ , and $||\\alpha||_{0}\\leq2$ . ", "page_idx": 25}, {"type": "text", "text": "To sparsify our problem, we start with some $k$ -clustering ( $k$ clusters, mutually-exclusive) of the sensor set $\\mathcal{C}=\\{\\dot{C}_{1},\\dots,C_{k}\\}$ . This clustering can be considered as leveraging some kind of \u201ccoarse\u201c ", "page_idx": 25}, {"type": "text", "text": "Algorithm 1 Monte Carlo Point Optimization (MCPO) ", "page_idx": 26}, {"type": "text", "text": "1: Input: Function $f(x;\\omega)$ , sampler for distribution $\\nu(\\omega)$ , number of samples $T$   \n2: Output: Approximate integral $\\hat{I}$ , empirical distribution $p_{\\mathscr D}(x)$ , empirical mean $\\mu$ , empirical   \ncovariance $\\Sigma$   \n3: for $t=1$ to $T$ do   \n4: Sample $\\omega_{t}\\sim\\nu(\\omega)$   \n5: Find minimizer $x_{t}=\\operatorname*{min}_{x}f(x;\\omega_{t})$ using BFGS ", "page_idx": 26}, {"type": "text", "text": "6: end for ", "text_level": 1, "page_idx": 26}, {"type": "text", "text": "7: Estimate integral $\\begin{array}{r}{\\hat{I}\\approx\\frac{1}{T}\\sum_{t=1}^{T}f(x_{t};\\omega_{t})}\\end{array}$ ", "page_idx": 26}, {"type": "text", "text": "8: Construct empirical distribution ", "page_idx": 26}, {"type": "equation", "text": "$$\np_{\\mathcal{D}}(x)=\\frac{1}{T}\\sum_{t=1}^{T}\\delta(x-x_{t})\n$$", "text_format": "latex", "page_idx": 26}, {"type": "text", "text": "9: Calculate empirical mean $\\begin{array}{r}{\\hat{\\mu}=\\frac{1}{T}\\sum_{t=1}^{T}x_{t}}\\end{array}$ and covariance $\\begin{array}{r}{\\hat{\\boldsymbol{\\Sigma}}=\\frac{1}{T-1}\\sum_{t=1}^{T}(\\boldsymbol{x}_{t}-\\hat{\\boldsymbol{\\mu}})(\\boldsymbol{x}_{t}-\\hat{\\boldsymbol{\\mu}})^{T},}\\end{array}$ . ", "page_idx": 26}, {"type": "text", "text": "Algorithm 2 Stochastic Sum-of-squares (S-SOS), Dual formulation ", "text_level": 1, "page_idx": 26}, {"type": "text", "text": "1: Input: Maximum basis function degree $s\\in\\mathbb{Z}_{>0}$ , complete basis function $m_{s}(x,\\omega):\\mathbb{R}^{n+d}\\rightarrow$ R(n+sd+s), function f(x; \u03c9) : Rn+d \u2192 R represented as a dictionary mapping multi-index $\\alpha\\;\\in\\;\\mathbb{Z}_{\\geq0}^{n+d}\\;\\rightarrow$ coefficient $f_{\\alpha}$ , probability density function for $\\nu(\\omega)$ with known moments $\\begin{array}{r}{\\int\\omega^{\\alpha}d\\nu\\bar{(}\\omega)<\\infty\\,\\forall\\,||\\alpha||_{1}\\leq2s}\\end{array}$ , any hard equality constraints where we want to set $x_{k}=x_{k}^{*}$ for some $k\\in\\mathcal{K}$ .   \n2: Let $i1,i2,i4$ be the lexicographically-ordered arrays ", "page_idx": 26}, {"type": "equation", "text": "$$\n\\mathbb{Z}_{\\ge0}^{(n+d+1)\\times(n+d)},\\mathbb{Z}_{\\ge0}^{\\binom{n+d+s}{s}\\times(n+d)},\\mathbb{Z}_{\\ge0}^{\\binom{n+d+2s}{2s}\\times(n+d)}\n$$", "text_format": "latex", "page_idx": 26}, {"type": "text", "text": "which correspond to the arrays of multi-indices for all degree-1, degree- $s$ , and degree- $.2s$ monomials in the variables $z$ . ", "page_idx": 26}, {"type": "text", "text": "4: Create $y\\in\\mathbb{R}^{\\binom{n+d+2s}{2s}}$ as a vector of variables to be estimated, corresponding to the vector of independent moments that fully specifies $M$ . ", "page_idx": 26}, {"type": "text", "text": "5: Add $M\\succcurlyeq0$ constraint. ", "page_idx": 26}, {"type": "text", "text": "6: for $i$ in length $(i2)$ do ", "page_idx": 26}, {"type": "text", "text": "7: for $j$ in length $(i2)$ do $\\triangleright$ Require $M$ to be formed from the elements of $y$ .   \n8: Compute $\\alpha_{i j}=i2[i]+i2[j]$ as the multi-index corresponding to the sum of the multiindices $i2[i],i2[j]$ .   \n9: Add constraint Mi,j = y\u03b1ij. ", "page_idx": 26}, {"type": "text", "text": "10: end for ", "page_idx": 26}, {"type": "text", "text": "11: end for ", "text_level": 1, "page_idx": 26}, {"type": "text", "text": "12: for each row $\\alpha$ in $i4$ do \u25b7Require $y_{\\alpha}$ moments to equal the known moments of $\\omega^{\\alpha}$ .   \n13: if $\\textstyle\\sum_{i=1}^{n}\\alpha_{i}=0$ then   \n14: Add constraint $\\begin{array}{r}{y_{\\alpha}=\\int z^{\\alpha}d\\nu(\\omega)=\\int\\omega^{\\alpha[-d:]}d\\nu(\\omega).}\\end{array}$   \n15: end if ", "page_idx": 26}, {"type": "text", "text": "", "page_idx": 26}, {"type": "text", "text": "16: end for ", "page_idx": 26}, {"type": "text", "text": "17: for $k$ in $\\kappa$ do $\\triangleright$ Handle any hard equality constraints in our variables $x$ .   \n18: Form multi-index $\\alpha_{1}\\in\\mathbb{Z}_{\\geq0}^{n+d}$ where the entry for $x_{k}$ is set to 1 and everything else is zero.   \n19: Form multi-index $\\alpha_{2}\\in\\mathbb{Z}_{\\geq0}^{n+d}$ where the entry for $\\v x_{k}^{2}$ is set to 1 and everything else is zero.   \n20: Add constraint $y_{\\alpha_{1}}=x_{k}^{*}$ . \u25b7E[xk] = x\u2217k.   \n21: Add constraint $y_{\\alpha_{2}}=(x_{k}^{*})^{2}$ . $\\mathsf{\\nabla}\\mathsf{V a r}[x_{k}]=\\mathbb{E}[x_{k}^{2}]-\\mathbb{E}[x_{k}]^{2}=0$ . ", "page_idx": 26}, {"type": "text", "text": "22: end for ", "text_level": 1, "page_idx": 26}, {"type": "text", "text": "23: Form the objective to be minimized: $\\begin{array}{r}{F=\\int f(x,\\omega)d\\mu(x,\\omega)_{-}=\\sum_{\\alpha\\in i4}f_{\\alpha}y_{\\alpha}}\\end{array}$ . ", "page_idx": 26}, {"type": "text", "text": "24: Solve SDP where we compute inf $F$ subject to above constraint s. ", "page_idx": 26}, {"type": "text", "text": "25: Output: If the problem is feasible (i.e. there exists a degree- $.2s$ decomposition of $f$ into $f_{\\mathrm{SOS}}$ and $c_{2s}^{*}(\\omega))$ , return moment matrix $M\\in\\mathbb{R}^{\\left(^{n+d+s}\\right)\\times\\binom{n+d+\\overline{{s}}}{s}}$ , dual objective value $d_{2s}^{*}$ . Otherwise, terminate and return failed/infeasible SDP solve. ", "page_idx": 26}, {"type": "text", "text": "information about which sensors are close to each other. For example, just looking at the polynomial $f(x,\\omega)$ enables us to see which sensors $(i,j)$ must be interacting. ", "page_idx": 27}, {"type": "text", "text": "Assume that there is some a priori clustering given to us. We denote $\\boldsymbol{x}^{(i)}$ as the subset of the variables restricted to the cluster $C_{i}$ , i.e. $x^{(i)}=\\{x_{j}:j\\in C_{i}\\}$ . Moreover, let $G=(V,E)$ be a graph where the vertices $V\\,=\\,\\{1,\\ldots,k\\}$ correspond to the $k$ clusters and the edges $E=\\,\\mathrm{\\{}(i,j):i,j\\,\\in\\,{\\cal V}\\}$ correspond to known cluster-cluster interactions. ", "page_idx": 27}, {"type": "text", "text": "The SOS part of the function $f(x)$ may then be approximated as the sum of dense intra-cluster interactions and sparse inter-cluster interactions, where the cluster-cluster interactions are given exactly by edges in the graph $G$ : ", "page_idx": 27}, {"type": "equation", "text": "$$\nm_{s}(x)^{T}W m_{s}(x)\\approx\\sum_{i\\in V}m_{s}(x^{(i)})^{T}W^{(i)}m_{s}(x^{(i)})+\\sum_{(i,j)\\in E}m_{s}(x^{(i)})^{T}W^{(i,j)}m_{s}(x^{(j)})\n$$", "text_format": "latex", "page_idx": 27}, {"type": "text", "text": "where $W^{(k)}$ are symmetric PSD matrices and $W^{(i,j)}$ are rectangular matrices where we require $W^{(i,j)}\\,=\\,(W^{(j,i)})^{T}$ . $m_{s}(x)$ for $x\\,\\in\\,\\mathbb{R}^{n}$ here behaves as before and denotes the basis function generated by all $\\binom{n+s}{s}$ combinations of monomials with degree $\\le\\,s$ . Notice that this is a strict reduction from the standard Lasserre hierarchy at the same degree $s$ , since in general the standard basis $m_{s}(x)$ on the full variable set will contain terms that mix variables from two different clusters that may not have an edge connecting them. ", "page_idx": 27}, {"type": "text", "text": "Efficiency gains in the SDP solve occur when we constrain certain of the off-diagonal $W^{(i,j)}$ blocks to be zero, i.e. the graph $G$ is sparse in cluster-cluster interactions. As we can see from the block decomposition written above, this resembles block sparsity on the matrix $W$ . We may interpret the above scheme as having a hierarchical structure out to depth 2, where we have dense interactions at the lowest level and sparse interactions aggregating them. In full generality, the resulting hierarchical sparsity in $W$ may be interpreted as generating a chordal $W$ , which is known to admit certain speed-ups in SDP solvers [26]. ", "page_idx": 27}, {"type": "text", "text": "When attempting to solve an SNL problem in the cluster basis instead of the full basis, we need to throw away terms in the potential $f(x,\\omega)$ that correspond to cross-terms that are \u201cignored\u201d by the particular cluster basis we chose. The resulting polynomial $\\bar{f}(x,\\omega)$ has fewer terms and produces a cluster basis SDP that is easier to solve, but generally less accurate due to the sparser connectivity. ", "page_idx": 27}, {"type": "text", "text": "In particular, for the rows in Table 1 that have $N_{C}\\,>\\,1$ , we do a $N_{C}$ -means clustering of the ground-truth sensor positions and use those sensor labels to create our partitioning of the sensors. We connect every cluster using plus-one $c_{i},c_{i+1}$ (including the wrap-around one) connections, so that the cluster-cluster connectivity graph has $N_{C}$ edges. We then use this information to throw out observed distances from the set $\\mathcal{D}_{s s}$ and from the full basis function $m_{2}(x,\\omega)$ . See our code for complete details. ", "page_idx": 27}, {"type": "text", "text": "A.7.5 Hard equality constraints ", "text_level": 1, "page_idx": 27}, {"type": "text", "text": "The sensor-anchor terms in Equation (7) are added to make the problem easier, because by adding them now each sensor no longer needs to rely only on a local neighborhood of sensors to localize itself, but can also use its position relative to some known anchor. When we remove them entirely, we need to incorporate hard equality constraints between certain sensors and known \u201canchor\u201d positions. This fixes certain known sensors but lets every other sensor be unrooted, defined only relative to other sensors (and potentially an anchor if it is within the sensing radius). ", "page_idx": 27}, {"type": "text", "text": "To deal with the equality constraints where we set the exact position of a sensor $x_{i}=x_{i}^{*}$ , we solve the dual Equation (4) and implement them as equality constraints on the moment matrix, i.e. for the basis element $m_{2}(x,\\omega)_{i}=x_{i}$ we may set $\\mathbb{E}[x_{i}]-x_{i}^{*}=M_{0,i}-x_{i}^{*}=0$ . Note that we also need to set $\\operatorname{Var}(x_{i})=0$ so for $m_{2}(x,\\omega)_{j}=x_{i}^{2}$ we add the equality constraint $\\operatorname{Var}(x_{i})=\\mathbb{E}[x_{i}^{2}]-\\mathbb{E}[x_{i}]^{2}=$ $M_{0,j}-M_{0,i}^{2}=0$ . ", "page_idx": 27}, {"type": "text", "text": "A.7.6 Solution extraction ", "text_level": 1, "page_idx": 27}, {"type": "text", "text": "Once the dual SDP has been solved, we extract the moment matrix $M$ and can easily recover the point and uncertainty estimates for the sensor positions $\\mathbb{E}[x],\\mathrm{Var}[x]$ by inspecting the appropriate entries $M_{0,i}$ corresponding to $m_{2}(x,\\omega)_{i}=x_{i}$ and $M_{0,j}$ corresponding to $\\bar{m_{2}}(x,\\bar{\\omega)_{j}}=\\bar{x_{i}^{2}}$ . ", "page_idx": 27}, {"type": "image", "img_path": "iChQIJtjHB/tmp/3e459282df58b4ad5d7ce9f4fe6a1eceaded69a497ff4b02a485a902ae8e2008.jpg", "img_caption": ["Figure 4: Comparison of the performance of MCPO and S-SOS (degree-4) for sensor recovery accuracy in 1D SNL with varying number of samples $T$ used in the estimate of empirical $\\hat{\\mu},\\dot{\\hat{\\Sigma}}$ . M-distance is $\\delta_{M}$ , our metric for sensor recovery accuracy per Equation (8). The problem type here is a $N=5$ sensor, $\\ell=1$ spatial dimension, $|\\Omega|=2$ noise variables, $\\epsilon=0.1$ noise scale, $r=3$ sensing radius problem. The full basis is used here for the S-SOS SDP. "], "img_footnote": [], "page_idx": 28}, {"type": "text", "text": "A.7.7 Impact of using MCPO with varying numbers of samples $T$ ", "text_level": 1, "page_idx": 28}, {"type": "text", "text": "In Figure 4 we can see how $\\delta_{M}$ varies as we scale the number of samples $T$ used in the MCPO estimate of the empirical mean/covariance of the recovered solutions. In this particular example, the runtime of the S-SOS estimate was 0.3 seconds, comparing to 30 seconds for the $T=300$ MCPO point. Despite taking $100\\mathrm{x}$ longer, the MCPO solution recovery still dramatically underperforms S-SOS in $\\delta_{M}$ . This reflects the poor performance of local optimization methods vs. a global optimization method (when it is available). ", "page_idx": 28}, {"type": "text", "text": "A.7.8 Scalability ", "text_level": 1, "page_idx": 28}, {"type": "text", "text": "The largest 2D SNL experiment we could run had $N=15$ sensors, $N_{C}=9$ clusters, and $d=9$ noise parameters. This generated $N\\ell+d\\,=\\,39$ variables and 820 basis elements in the naive $m_{2}(x,\\bar{\\omega})$ construction, which was reduced to 317 after our application of the cluster basis, giving us W $\\!\\!\\dot{,}M\\in\\mathbb{R}^{317\\times317}$ . A single solve in CVXPY (MOSEK) took 30 minutes on our workstation $\\mathbf{\\Psi}^{2\\mathbf{x}}$ Intel Xeon 6130 Gold and 256GB of RAM). We attempted a run with $N=20$ sensors and $N_{C}=9$ clusters and $d=9$ noise parameters, but the process failed due to OOM constraints. Thus, we report the largest experiment that succeeded. ", "page_idx": 28}, {"type": "text", "text": "A.8 Limitations ", "text_level": 1, "page_idx": 28}, {"type": "text", "text": "As discussed in the main text, our work provides both a theoretical convergence rate as well as numerical understanding of the stochastic sum-of-squares (S-SOS). Notably, our convergence rate is bottlenecked on the approximation quality of $c^{*}(\\omega)$ , only achieving $\\ln{s/s}$ where regular SOS results achieve $1/s^{2}$ . In practice, we see much faster convergence, which may be a clue that other more restrictive assumptions or more powerful methods may enable one to find better convergence results. ", "page_idx": 28}, {"type": "text", "text": "In addition, our numerical work focuses on the sensor network localization problem. Due to the time complexity of SDPs, the maximum number of sensors we could solve in any one instance is limited to $N=15$ . This seems much smaller than the state-of-the-art, i.e. [49] where the authors propose an algebraic reduction of the noiseless SNL problem so that they can analytically obtain the range of the PSD matrix. This simplifies the SDP dramatically, however in the noisy setting (where observed sensor-sensor distances are perturbed with observation noise) this approach is unusable, requiring significant modification. his reduction is used to solve SNL problems of 10k-100k sensors, but they develop a highly specialized algorithm that does not use any SDP solvers. ", "page_idx": 28}, {"type": "text", "text": "Note that noiseless SNL simplifies the problem. In the noiseless setting, localizing even a small number of sensors near an anchor will propagate the correctly localized positions to sensors nearby. As such, if one can find small groups of sensors that can be well-oriented with respect to each other, one can pursue localization of these groups in parallel and then orient them globally at the very end. In the noisy setting, any error in localization can easily propagate to the whole instance, dramatically reducing the size of problems that can be effectively solved [50, 51]. ", "page_idx": 29}, {"type": "text", "text": "Thus, we observe that uncertainty makes the SNL problem considerably more difficult than the noiseless setting. S-SOS handles this naturally while also solving the problem for its global optimum. We get a solution for the sensor positions for every possible configuration of noise via the probability distribution $\\mu(x,\\omega)$ . This additional complexity places further limits on the size of the problems that can be solved with S-SOS. ", "page_idx": 29}, {"type": "text", "text": "NeurIPS Paper Checklist ", "text_level": 1, "page_idx": 30}, {"type": "text", "text": "1. Claims ", "text_level": 1, "page_idx": 30}, {"type": "text", "text": "Question: Do the main claims made in the abstract and introduction accurately reflect the paper\u2019s contributions and scope? ", "page_idx": 30}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 30}, {"type": "text", "text": "Justification: The abstract and introduction (Section 1) summarize the contributions which are principally an elucidation of a stochastic SOS hierarchy (an optimization procedure), a proof (with listed assumptions) giving a quantitative rate of convergence, and numerical experiments. The full proof, numerical plots and tables, as well as code necessary to replicate our results are all provided. ", "page_idx": 30}, {"type": "text", "text": "Guidelines: ", "page_idx": 30}, {"type": "text", "text": "\u2022 The answer NA means that the abstract and introduction do not include the claims made in the paper.   \n\u2022 The abstract and/or introduction should clearly state the claims made, including the contributions made in the paper and important assumptions and limitations. A No or NA answer to this question will not be perceived well by the reviewers.   \n\u2022 The claims made should match theoretical and experimental results, and reflect how much the results can be expected to generalize to other settings.   \n\u2022 It is fine to include aspirational goals as motivation as long as it is clear that these goals are not attained by the paper. ", "page_idx": 30}, {"type": "text", "text": "2. Limitations ", "text_level": 1, "page_idx": 30}, {"type": "text", "text": "Question: Does the paper discuss the limitations of the work performed by the authors? ", "page_idx": 30}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 30}, {"type": "text", "text": "Justification: See the Discussion section (Section 4), where we highlight the non-scalability of all algorithms (including ours) that require optimization over the SDP cone, and discuss potential solutions, some of which we rectify in this paper by using sparsification assumptions such as a \u201ccluster basis\u201d. Despite a quantitative convergence proof with a clear rate, we also highlight the assumptions made, including the fact that we restrict to 1-periodic trigonometric polynomials over $[0,1]^{n}\\times\\Omega$ with $\\Omega$ compact (Section 2.3.2 and Appendix A.5.2). ", "page_idx": 30}, {"type": "text", "text": "Guidelines: ", "text_level": 1, "page_idx": 30}, {"type": "text", "text": "\u2022 The answer NA means that the paper has no limitation while the answer No means that the paper has limitations, but those are not discussed in the paper.   \n\u2022 The authors are encouraged to create a separate \"Limitations\" section in their paper.   \n\u2022 The paper should point out any strong assumptions and how robust the results are to violations of these assumptions (e.g., independence assumptions, noiseless settings, model well-specification, asymptotic approximations only holding locally). The authors should reflect on how these assumptions might be violated in practice and what the implications would be.   \n\u2022 The authors should reflect on the scope of the claims made, e.g., if the approach was only tested on a few datasets or with a few runs. In general, empirical results often depend on implicit assumptions, which should be articulated.   \n\u2022 The authors should reflect on the factors that influence the performance of the approach. For example, a facial recognition algorithm may perform poorly when image resolution is low or images are taken in low lighting. Or a speech-to-text system might not be used reliably to provide closed captions for online lectures because it fails to handle technical jargon.   \n\u2022 The authors should discuss the computational efficiency of the proposed algorithms and how they scale with dataset size.   \n\u2022 If applicable, the authors should discuss possible limitations of their approach to address problems of privacy and fairness. ", "page_idx": 30}, {"type": "text", "text": "\u2022 While the authors might fear that complete honesty about limitations might be used by reviewers as grounds for rejection, a worse outcome might be that reviewers discover limitations that aren\u2019t acknowledged in the paper. The authors should use their best judgment and recognize that individual actions in favor of transparency play an important role in developing norms that preserve the integrity of the community. Reviewers will be specifically instructed to not penalize honesty concerning limitations. ", "page_idx": 31}, {"type": "text", "text": "3. Theory Assumptions and Proofs ", "text_level": 1, "page_idx": 31}, {"type": "text", "text": "Question: For each theoretical result, does the paper provide the full set of assumptions and a complete (and correct) proof? ", "page_idx": 31}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 31}, {"type": "text", "text": "Justification: A full proof of our core result is provided in the supplementary material (Appendix A.5.2), along with an outline of the core ideas in the main body (Section 2.3.2). Guidelines: ", "page_idx": 31}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include theoretical results.   \n\u2022 All the theorems, formulas, and proofs in the paper should be numbered and crossreferenced.   \n\u2022 All assumptions should be clearly stated or referenced in the statement of any theorems.   \n\u2022 The proofs can either appear in the main paper or the supplemental material, but if they appear in the supplemental material, the authors are encouraged to provide a short proof sketch to provide intuition.   \n\u2022 Inversely, any informal proof provided in the core of the paper should be complemented by formal proofs provided in appendix or supplemental material.   \n\u2022 Theorems and Lemmas that the proof relies upon should be properly referenced. ", "page_idx": 31}, {"type": "text", "text": "4. Experimental Result Reproducibility ", "text_level": 1, "page_idx": 31}, {"type": "text", "text": "Question: Does the paper fully disclose all the information needed to reproduce the main experimental results of the paper to the extent that it affects the main claims and/or conclusions of the paper (regardless of whether the code and data are provided or not)? ", "page_idx": 31}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 31}, {"type": "text", "text": "Justification: All information regarding experiments is disclosed, with core details in the main draft and full experimental details in the appendix. In addition, we provide code in our submission (and will publicly release it upon paper decision) to reproduce all of the figures, tables, and other results we report. ", "page_idx": 31}, {"type": "text", "text": "Guidelines: ", "page_idx": 31}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 If the paper includes experiments, a No answer to this question will not be perceived well by the reviewers: Making the paper reproducible is important, regardless of whether the code and data are provided or not.   \n\u2022 If the contribution is a dataset and/or model, the authors should describe the steps taken to make their results reproducible or verifiable.   \n\u2022 Depending on the contribution, reproducibility can be accomplished in various ways. For example, if the contribution is a novel architecture, describing the architecture fully might suffice, or if the contribution is a specific model and empirical evaluation, it may be necessary to either make it possible for others to replicate the model with the same dataset, or provide access to the model. In general. releasing code and data is often one good way to accomplish this, but reproducibility can also be provided via detailed instructions for how to replicate the results, access to a hosted model (e.g., in the case of a large language model), releasing of a model checkpoint, or other means that are appropriate to the research performed.   \n\u2022 While NeurIPS does not require releasing code, the conference does require all submissions to provide some reasonable avenue for reproducibility, which may depend on the nature of the contribution. For example (a) If the contribution is primarily a new algorithm, the paper should make it clear how to reproduce that algorithm.   \n(b) If the contribution is primarily a new model architecture, the paper should describe the architecture clearly and fully.   \n(c) If the contribution is a new model (e.g., a large language model), then there should either be a way to access this model for reproducing the results or a way to reproduce the model (e.g., with an open-source dataset or instructions for how to construct the dataset).   \n(d) We recognize that reproducibility may be tricky in some cases, in which case authors are welcome to describe the particular way they provide for reproducibility. In the case of closed-source models, it may be that access to the model is limited in some way (e.g., to registered users), but it should be possible for other researchers to have some path to reproducing or verifying the results. ", "page_idx": 31}, {"type": "text", "text": "", "page_idx": 32}, {"type": "text", "text": "5. Open access to data and code ", "text_level": 1, "page_idx": 32}, {"type": "text", "text": "Question: Does the paper provide open access to the data and code, with sufficient instructions to faithfully reproduce the main experimental results, as described in supplemental material? ", "page_idx": 32}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 32}, {"type": "text", "text": "Justification: Our code has been provided with our submission and a cleaned-up version will be released publicly once the preprint is public. ", "page_idx": 32}, {"type": "text", "text": "Guidelines: ", "page_idx": 32}, {"type": "text", "text": "\u2022 The answer NA means that paper does not include experiments requiring code.   \n\u2022 Please see the NeurIPS code and data submission guidelines (https://nips.cc/ public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 While we encourage the release of code and data, we understand that this might not be possible, so \u201cNo\u201d is an acceptable answer. Papers cannot be rejected simply for not including code, unless this is central to the contribution (e.g., for a new open-source benchmark).   \n\u2022 The instructions should contain the exact command and environment needed to run to reproduce the results. See the NeurIPS code and data submission guidelines (https: //nips.cc/public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 The authors should provide instructions on data access and preparation, including how to access the raw data, preprocessed data, intermediate data, and generated data, etc.   \n\u2022 The authors should provide scripts to reproduce all experimental results for the new proposed method and baselines. If only a subset of experiments are reproducible, they should state which ones are omitted from the script and why.   \n\u2022 At submission time, to preserve anonymity, the authors should release anonymized versions (if applicable).   \n\u2022 Providing as much information as possible in supplemental material (appended to the paper) is recommended, but including URLs to data and code is permitted. ", "page_idx": 32}, {"type": "text", "text": "6. Experimental Setting/Details ", "text_level": 1, "page_idx": 32}, {"type": "text", "text": "Question: Does the paper specify all the training and test details (e.g., data splits, hyperparameters, how they were chosen, type of optimizer, etc.) necessary to understand the results? ", "page_idx": 32}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 32}, {"type": "text", "text": "Justification: All necessary details to replicate results are summarized in the core body and explicated in full in supplementary material (Appendix A.7). ", "page_idx": 32}, {"type": "text", "text": "Guidelines: ", "page_idx": 32}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments. \u2022 The experimental setting should be presented in the core of the paper to a level of detail that is necessary to appreciate the results and make sense of them. \u2022 The full details can be provided either with the code, in appendix, or as supplemental material. ", "page_idx": 32}, {"type": "text", "text": "7. Experiment Statistical Significance ", "text_level": 1, "page_idx": 32}, {"type": "text", "text": "Question: Does the paper report error bars suitably and correctly defined or other appropriate information about the statistical significance of the experiments? ", "page_idx": 33}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 33}, {"type": "text", "text": "Justification: Where necessary, we report confidence intervals on our solution recovery metrics for SNL which are computed over multiple runs. In particular, we report robust mean and 1-sigma robust std estimates and details can be found at Section 3.2. ", "page_idx": 33}, {"type": "text", "text": "Guidelines: ", "page_idx": 33}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The authors should answer \"Yes\" if the results are accompanied by error bars, confidence intervals, or statistical significance tests, at least for the experiments that support the main claims of the paper.   \n\u2022 The factors of variability that the error bars are capturing should be clearly stated (for example, train/test split, initialization, random drawing of some parameter, or overall run with given experimental conditions).   \n\u2022 The method for calculating the error bars should be explained (closed form formula, call to a library function, bootstrap, etc.)   \n\u2022 The assumptions made should be given (e.g., Normally distributed errors).   \n\u2022 It should be clear whether the error bar is the standard deviation or the standard error of the mean.   \n\u2022 It is OK to report 1-sigma error bars, but one should state it. The authors should preferably report a 2-sigma error bar than state that they have a $96\\%$ CI, if the hypothesis of Normality of errors is not verified.   \n\u2022 For asymmetric distributions, the authors should be careful not to show in tables or figures symmetric error bars that would yield results that are out of range (e.g. negative error rates).   \n\u2022 If error bars are reported in tables or plots, The authors should explain in the text how they were calculated and reference the corresponding figures or tables in the text. ", "page_idx": 33}, {"type": "text", "text": "8. Experiments Compute Resources ", "text_level": 1, "page_idx": 33}, {"type": "text", "text": "Question: For each experiment, does the paper provide sufficient information on the computer resources (type of compute workers, memory, time of execution) needed to reproduce the experiments? ", "page_idx": 33}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 33}, {"type": "text", "text": "Justification: Specific details regarding the compute resources used are detailed in Section 3, as well a section on scalability in Appendix A.7.8. ", "page_idx": 33}, {"type": "text", "text": "Guidelines: ", "page_idx": 33}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The paper should indicate the type of compute workers CPU or GPU, internal cluster, or cloud provider, including relevant memory and storage.   \n\u2022 The paper should provide the amount of compute required for each of the individual experimental runs as well as estimate the total compute.   \n\u2022 The paper should disclose whether the full research project required more compute than the experiments reported in the paper (e.g., preliminary or failed experiments that didn\u2019t make it into the paper). ", "page_idx": 33}, {"type": "text", "text": "9. Code Of Ethics ", "text_level": 1, "page_idx": 33}, {"type": "text", "text": "Question: Does the research conducted in the paper conform, in every respect, with the NeurIPS Code of Ethics https://neurips.cc/public/EthicsGuidelines? ", "page_idx": 33}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 33}, {"type": "text", "text": "Justification: All authors have reviewed the NeurIPS Code of Ethics and certify that the research presented conforms with all aspects of it. ", "page_idx": 33}, {"type": "text", "text": "Guidelines: ", "page_idx": 33}, {"type": "text", "text": "\u2022 The answer NA means that the authors have not reviewed the NeurIPS Code of Ethics. ", "page_idx": 33}, {"type": "text", "text": "\u2022 If the authors answer No, they should explain the special circumstances that require a deviation from the Code of Ethics.   \n\u2022 The authors should make sure to preserve anonymity (e.g., if there is a special consideration due to laws or regulations in their jurisdiction). ", "page_idx": 34}, {"type": "text", "text": "10. Broader Impacts ", "text_level": 1, "page_idx": 34}, {"type": "text", "text": "Question: Does the paper discuss both potential positive societal impacts and negative societal impacts of the work performed? ", "page_idx": 34}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 34}, {"type": "text", "text": "Justification: As foundational research on algorithms and optimization, we do not see substantial societal impact positive or negative tied to possible applications of this research. Guidelines: ", "page_idx": 34}, {"type": "text", "text": "\u2022 The answer NA means that there is no societal impact of the work performed.   \n\u2022 If the authors answer NA or No, they should explain why their work has no societal impact or why the paper does not address societal impact.   \n\u2022 Examples of negative societal impacts include potential malicious or unintended uses (e.g., disinformation, generating fake profiles, surveillance), fairness considerations (e.g., deployment of technologies that could make decisions that unfairly impact specific groups), privacy considerations, and security considerations.   \n\u2022 The conference expects that many papers will be foundational research and not tied to particular applications, let alone deployments. However, if there is a direct path to any negative applications, the authors should point it out. For example, it is legitimate to point out that an improvement in the quality of generative models could be used to generate deepfakes for disinformation. On the other hand, it is not needed to point out that a generic algorithm for optimizing neural networks could enable people to train models that generate Deepfakes faster.   \n\u2022 The authors should consider possible harms that could arise when the technology is being used as intended and functioning correctly, harms that could arise when the technology is being used as intended but gives incorrect results, and harms following from (intentional or unintentional) misuse of the technology.   \n\u2022 If there are negative societal impacts, the authors could also discuss possible mitigation strategies (e.g., gated release of models, providing defenses in addition to attacks, mechanisms for monitoring misuse, mechanisms to monitor how a system learns from feedback over time, improving the efficiency and accessibility of ML). ", "page_idx": 34}, {"type": "text", "text": "11. Safeguards ", "text_level": 1, "page_idx": 34}, {"type": "text", "text": "Question: Does the paper describe safeguards that have been put in place for responsible release of data or models that have a high risk for misuse (e.g., pretrained language models, image generators, or scraped datasets)? ", "page_idx": 34}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 34}, {"type": "text", "text": "Justification: Our contributions are primarily algorithmic and do not have a high risk for misuse. ", "page_idx": 34}, {"type": "text", "text": "Guidelines: ", "page_idx": 34}, {"type": "text", "text": "\u2022 The answer NA means that the paper poses no such risks.   \n\u2022 Released models that have a high risk for misuse or dual-use should be released with necessary safeguards to allow for controlled use of the model, for example by requiring that users adhere to usage guidelines or restrictions to access the model or implementing safety filters.   \n\u2022 Datasets that have been scraped from the Internet could pose safety risks. The authors should describe how they avoided releasing unsafe images.   \n\u2022 We recognize that providing effective safeguards is challenging, and many papers do not require this, but we encourage authors to take this into account and make a best faith effort. ", "page_idx": 34}, {"type": "text", "text": "12. Licenses for existing assets ", "text_level": 1, "page_idx": 34}, {"type": "text", "text": "Question: Are the creators or original owners of assets (e.g., code, data, models), used in the paper, properly credited and are the license and terms of use explicitly mentioned and properly respected? ", "page_idx": 35}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 35}, {"type": "text", "text": "Justification: All open-source software packages such as scientific computing libraries and optimization libraries were cited. ", "page_idx": 35}, {"type": "text", "text": "Guidelines: ", "page_idx": 35}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not use existing assets.   \n\u2022 The authors should cite the original paper that produced the code package or dataset.   \n\u2022 The authors should state which version of the asset is used and, if possible, include a URL.   \n\u2022 The name of the license (e.g., CC-BY 4.0) should be included for each asset.   \n\u2022 For scraped data from a particular source (e.g., website), the copyright and terms of service of that source should be provided.   \n\u2022 If assets are released, the license, copyright information, and terms of use in the package should be provided. For popular datasets, paperswithcode.com/datasets has curated licenses for some datasets. Their licensing guide can help determine the license of a dataset.   \n\u2022 For existing datasets that are re-packaged, both the original license and the license of the derived asset (if it has changed) should be provided.   \n\u2022 If this information is not available online, the authors are encouraged to reach out to the asset\u2019s creators. ", "page_idx": 35}, {"type": "text", "text": "13. New Assets ", "text_level": 1, "page_idx": 35}, {"type": "text", "text": "Question: Are new assets introduced in the paper well documented and is the documentation provided alongside the assets? ", "page_idx": 35}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 35}, {"type": "text", "text": "Justification: No new assets were used, all data necessary for experiments was generated from scratch. ", "page_idx": 35}, {"type": "text", "text": "Guidelines: ", "page_idx": 35}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not release new assets.   \n\u2022 Researchers should communicate the details of the dataset/code/model as part of their submissions via structured templates. This includes details about training, license, limitations, etc.   \n\u2022 The paper should discuss whether and how consent was obtained from people whose asset is used.   \n\u2022 At submission time, remember to anonymize your assets (if applicable). You can either create an anonymized URL or include an anonymized zip file. ", "page_idx": 35}, {"type": "text", "text": "14. Crowdsourcing and Research with Human Subjects ", "text_level": 1, "page_idx": 35}, {"type": "text", "text": "Question: For crowdsourcing experiments and research with human subjects, does the paper include the full text of instructions given to participants and screenshots, if applicable, as well as details about compensation (if any)? ", "page_idx": 35}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 35}, {"type": "text", "text": "Justification: Human subjects were not involved. ", "page_idx": 35}, {"type": "text", "text": "Guidelines: ", "page_idx": 35}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Including this information in the supplemental material is fine, but if the main contribution of the paper involves human subjects, then as much detail as possible should be included in the main paper.   \n\u2022 According to the NeurIPS Code of Ethics, workers involved in data collection, curation, or other labor should be paid at least the minimum wage in the country of the data collector. ", "page_idx": 35}, {"type": "text", "text": "15. Institutional Review Board (IRB) Approvals or Equivalent for Research with Human Subjects ", "page_idx": 36}, {"type": "text", "text": "Question: Does the paper describe potential risks incurred by study participants, whether such risks were disclosed to the subjects, and whether Institutional Review Board (IRB) approvals (or an equivalent approval/review based on the requirements of your country or institution) were obtained? ", "page_idx": 36}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 36}, {"type": "text", "text": "Justification: Human subjects were not involved. ", "page_idx": 36}, {"type": "text", "text": "Guidelines: ", "page_idx": 36}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Depending on the country in which research is conducted, IRB approval (or equivalent) may be required for any human subjects research. If you obtained IRB approval, you should clearly state this in the paper.   \n\u2022 We recognize that the procedures for this may vary significantly between institutions and locations, and we expect authors to adhere to the NeurIPS Code of Ethics and the guidelines for their institution.   \n\u2022 For initial submissions, do not include any information that would break anonymity (if applicable), such as the institution conducting the review. ", "page_idx": 36}]