[{"type": "text", "text": "Testing Semantic Importance via Betting ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Jacopo Teneggi Johns Hopkins University jtenegg1@jhu.edu ", "page_idx": 0}, {"type": "text", "text": "Jeremias Sulam Johns Hopkins University jsulam1@jhu.edu ", "page_idx": 0}, {"type": "text", "text": "Abstract ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Recent works have extended notions of feature importance to semantic concepts that are inherently interpretable to the users interacting with a black-box predictive model. Yet, precise statistical guarantees such as false positive rate and false discovery rate control are needed to communicate findings transparently, and to avoid unintended consequences in real-world scenarios. In this paper, we formalize the global (i.e., over a population) and local (i.e., for a sample) statistical importance of semantic concepts for the predictions of opaque models by means of conditional independence, which allows for rigorous testing. We use recent ideas of sequential kernelized independence testing to induce a rank of importance across concepts, and we showcase the effectiveness and flexibility of our framework on synthetic datasets as well as on image classification using several vision-language models. ", "page_idx": 0}, {"type": "text", "text": "1 Introduction ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Providing guarantees on the decision-making processes of autonomous systems, often based on complex black-box machine learning models, is paramount for their safe deployment. This need motivates efforts towards responsible artificial intelligence, which broadly entails questions of reliability, robustness, fairness, and interpretability. One popular approach to the latter is to use post-hoc explanation methods to identify the features that contribute the most towards the predictions of a model. Several alternatives have been proposed over the past few years, drawing from various definitions of features (e.g., pixels\u2014or groups thereof\u2014for vision tasks [41], words for language tasks [21], or nodes and edges for graphs [82]) and of importance (e.g, gradients for Grad-CAM [55], Shapley values for SHAP [7, 15, 42, 68], or information-theoretic quantities [43]). While most explanation methods highlight important features in the input space of the predictor, users may care more about their meaning. For example, a radiologist may want to know whether a model considered the size and spiculation of a lung nodule to quantify its malignancy, and not just its raw pixel values. ", "page_idx": 0}, {"type": "text", "text": "To decouple importance from input features, Kim et al. [34] showed how to learn the vector representation of semantic concepts that are inherently interpretable to users (e.g., \u201cstripes\u201d, \u201csky\u201d, or \u201csand\u201d) and how to study their gradient importance for model predictions. Recent vision-language (VL) models that jointly learn an image and text encoder, such as CLIP [16, 50], have made these representations\u2014commonly referred to as concept activation vectors (CAVs)\u2014more easily accessible. With these models, obtaining the representation of a concept boils down to a forward pass of the pretrained text encoder, which alleviates the need of a dataset comprising images annotated with their concepts. Several recent works have defined semantic importance\u2014both with CAVs and VL models\u2014by means of concept bottleneck models (e.g., CBM [36], PCBM [83], LaBo [81]), information-theoretic quantities (e.g., V-IP [37]), sparse coding (e.g., CLIP-IP-OMP [13], SpLiCe [6]), network dissection [2] (e.g., CLIP-DISSECT [46], TextSpan [26], INViTE [14]), or causal inference (e.g., DiConStruct [44], Sani et al. [53]). ", "page_idx": 0}, {"type": "text", "text": "On the other hand, it is important to communicate findings of important features precisely and transparently in order to avoid unintended consequences in downstream decision tasks. Going back to the example of a radiologist diagnosing lung cancer, how should they interpret two concepts with different importance scores? Does their difference in importance carry any statistical meaning? To start addressing similar questions [10, 69] introduced statistical tests for the local (i.e., on a sample) conditional independence structure of a model\u2019s predictions. Framing importance by means of conditional independence allows for rigorous testing with false positive rate control. That is, for a user-defined significance level $\\alpha\\in(0,1)$ , the probability of wrongly deeming a feature important is no greater than $\\alpha$ , which directly conveys the uncertainty in an explanation. Yet these methods consider features as coordinates in the input space, and it is unclear how to extend these ideas to abstract, semantic concepts. ", "page_idx": 0}, {"type": "text", "text": "", "page_idx": 1}, {"type": "text", "text": "In this work, we formalize semantic importance at three distinct levels of statistical independence with null hypotheses of increasing granularity: $(i)$ marginally over a population (i.e., global importance), $(i i)$ conditionally over a population (i.e., global conditional importance), and $(i i i)$ for a sample (i.e., local conditional importance).1 Each of these notions will allow us to inquire the extent to which the output of a model depends on specific concepts\u2014both over a population and on specific samples\u2014and thus deem them important. To test for these notions of semantic importance, instead of classical (or offline [56]) independence testing techniques [5, 10, 11, 28, 29, 67, 84], which are based on $p$ -values and informally follow the rule \u201creject if $p\\leq\\alpha^{\\,,\\ast}$ , we propose to use principles of testing by betting (or sequential testing) [57], which are based on $e$ -values [74] and follow the \u201creject when $e\\geq1/\\alpha$ \u201d rule. As we will expand on, this choice is motivated by the fact that sequential tests are data-efficient and adaptive to the hardness of the problem\u2014which naturally induces a rank of importance. We will couple principles of conditional randomization testing (CRT) [11] with recent advances in sequential kernelized independence testing (SKIT) [49, 60], and introduce two novel procedures to test for our definitions of semantic importance: the conditional randomization SKIT (C-SKIT) to study global conditional importance, and\u2014following the explanation randomization test (XRT) framework [69]\u2014the explanation randomization SKIT (X-SKIT) to study local conditional importance. We will illustrate the validity of our proposed tests on synthetic datasets, and showcase their flexibility on zero-shot image classification on real-world datasets across several and diverse VL models. ", "page_idx": 1}, {"type": "text", "text": "1.1 Summary of Contributions and Related Works ", "text_level": 1, "page_idx": 1}, {"type": "text", "text": "In this paper, we will rigorously define notions of statistical importance of semantic concepts for the predictions of black-box models via conditional independence\u2014both globally over a population and locally for individual samples. For any set of concepts, and for each level of independence, we introduce novel sequential testing procedures that induce a rank of importance. Before presenting the details of our methodology, we briefly expand on a few distinctive features of our work. ", "page_idx": 1}, {"type": "text", "text": "Explaining nonlinear predictors. Compared to recent methods based on concept bottleneck models [36, 81, 82], our framework does not require training a surrogate linear classifier because we study the semantic importance structure of any given, potentially nonlinear and randomized model. This distinction is not minor\u2014training concept bottleneck models results on explanations that pertain to the surrogate (linear) model instead of the original (complex, nonlinear) predictor, and these simpler surrogate models typically reduce performance [47, 83]. In contrast, we provide statistical guarantees directly on the original predictor that would be deployed in the wild. ", "page_idx": 1}, {"type": "text", "text": "Flexible choice of concepts. Furthermore, our framework does not rely on the presence of a large concept bank (but it can use one if it is available). Instead, we allow users to directly specify which concepts they want to test. This feature is important in settings that involve diverse stakeholders. In medicine, for example, there are physicians, patients, model developers, and members of the regulatory agency tasked with auditing the model\u2014each of whom might prefer different semantics for their explanations. Current explanation methods cannot account for these differences off-the-self. ", "page_idx": 1}, {"type": "text", "text": "Local semantic explanations. Our framework entails explanations for specific (fixed) inputs, whereas prior approaches that rely on the weights of a linear model only inform on global notions of importance. Recently, Shukla et al. [62] set forth ideas of local semantic importance by combining LIME [52] with T-CAV [34]. Our work differs in that it does not apply to images only, it considers formal notions of statistical importance rather than heuristics of gradient importance, and it provides guarantees such as Type I error and false discovery rate (FDR) control. ", "page_idx": 1}, {"type": "text", "text": "Sequential kernelized testing. Motivated by the statistical properties of kernelized independence tests [60], we will employ the maximum mean discrepancy (MMD) [29] as the test statistic in our proposed procedures. The recent related work in Shaer et al. [56] introduces the sequential version of the conditional randomization test (CRT) [11], dubbed e-CRT because of the use of $e$ -values. Unlike our work, Shaer et al. [56] employ residuals of a predictor as test statistic, they do so in the context of global tests only, and unrelated to questions of semantic interpretability. ", "page_idx": 2}, {"type": "text", "text": "2 Background ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "In this section, we briefly introduce the necessary notation and general background. Throughout this work, we will denote random variables with capital letters, and their realizations with lowercase. For example, $X\\sim P_{X}$ is a random variable sampled from $P_{X}$ , and $x$ indicates an observation of $X$ . ", "page_idx": 2}, {"type": "text", "text": "Problem setup. We consider $k$ -fold classification problems such that $(X,Y)\\sim P_{X Y}$ is a random sample $X\\in\\mathcal{X}$ with its one-hot label $Y\\in\\{0,1\\}^{k}$ , and $(x,y)$ denotes a particular observation. We assume we are given a fixed predictive model, consisting of an encoder $f:\\mathcal{X}\\to\\mathbb{R}^{d}$ and a classifier $g:\\mathbb R^{d}\\,\\rightarrow\\,\\mathbb R^{k}$ such that $h\\,=\\,f(x)$ is a $d\\!.$ -dimensional representation of $x$ , and $\\hat{y}_{k^{\\prime}}\\,=\\,g(h)_{k^{\\prime}}\\,=$ $g(f(x))_{k^{\\prime}}$ is the prediction of the model for a particular class $k^{\\prime}$ (e.g., $\\hat{y}_{k^{\\prime}}$ is the output, or score, for class \u201cdog\u201d). Naturally, $H,{\\hat{Y}}$ denote the random counterparts of $h$ and $\\hat{y}$ . Although our contributions do not make any assumptions on the performance of the model, $f$ and $g$ can be thought of as good predictors, e.g. those that approximate the conditional expectation of $Y$ given $X$ . ", "page_idx": 2}, {"type": "text", "text": "Concept bottleneck models (CBMs). Let $c=[c_{1},\\ldots,c_{m}]\\in\\mathbb{R}^{d\\times m}$ be a dictionary of $m$ concepts such that $\\forall j\\in[m]:=\\{1,\\ldots,m\\}$ , $c_{j}\\in\\mathbb{R}^{d}$ is the representation of the $j^{\\mathrm{th}}$ concept\u2014either obtained via CAVs [34] or a VL model\u2019s text encoder. Then, $z=\\langle c,h\\rangle$ is the projection of the embedding $h$ onto the concepts $c$ , and, with appropriate normalization, $z_{j}\\in[-1,1]$ is the amount of concept $c_{j}$ in $h$ . Intuitively, CBMs project dense representations onto the subspace of interpretable semantic concepts [36], and their performance strongly depends on the size of the dictionary [47]. For example, it is common for $m$ to be as large as the embedding size (e.g., $d=768$ for CLIP:ViT-L/14). In this work, instead, we let concepts be user-defined, allowing for cases where $m\\ll d$ (e.g., $m=20$ ). This is by design as $(i)$ the contributions of this paper apply to any set of concepts, and $(i i)$ it has been shown that humans can only gain valuable information if semantic explanations are succinct [51]. However, we remark that the construction of informative concept banks\u2014especially for domainspecific applications\u2014is subject of ongoing complementary research [20, 47, 76, 78, 79]. ", "page_idx": 2}, {"type": "text", "text": "Conditional randomization tests. Recall that two random variables $A,B$ are conditionally independent if, and only if, given a third random variable $C$ , it holds that $P_{A|B,C}=P_{A|C}$ (i.e., $A\\bot\\bot B\\mid C)$ . That is, $B$ does not provide any more information about $A$ with $C$ present. Candes et al. [11] introduced the conditional randomization test (CRT), based on the observation that if $A\\bot\\bot B\\mid C$ , then the triplets $(A,B,C)$ and $(A,{\\widetilde{B}},C)$ with $\\widetilde{B}\\sim P_{B|C}$ , are exchangeable. That is, $P_{A B C}=P_{A\\widetilde{B}C}$ and one can essentially mask $B$ w ithout chan ging the joint distribution. Opposite to classical m  ethods, the CRT assumes the conditional distribution of the covariates is known (i.e., $P_{B|C})$ , which lends itself to settings with ample unlabeled data. ", "page_idx": 2}, {"type": "text", "text": "With this general background, we now present the main technical contributions of this paper. ", "page_idx": 2}, {"type": "text", "text": "3 Testing Semantic Importance via Betting ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "Our objective is to test the statistical importance of semantic concepts for the predictions of a fixed, potentially nonlinear model, while inducing a rank of importance. Fig. 1 depicts the problem setup\u2014a fixed model, composed of the encoder $f$ and classifier $g$ , is probed via a set of concepts $c$ . This figure also illustrates the key difference with post-hoc concept bottleneck models (PCBMs) [83], in that we do not train a sparse linear layer to approximate $\\mathbb{E}[\\bar{Y}\\mid Z]$ . Instead, we focus on characterizing the dependence structure between $\\hat{Y}$ and $Z$ . Herein, we will drop the $\\hat{y}_{k^{\\prime}}$ notation and simply write $\\hat{y},\\hat{Y}$ because we always consider the output of the model for a particular class individually. ", "page_idx": 2}, {"type": "text", "text": "3.1 Formalizing Statistical Importance of Semantic Concepts ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "We start by defining global semantic importance as marginal dependence between $\\hat{Y}$ and $Z_{j},j\\in[m]$ . ", "page_idx": 2}, {"type": "image", "img_path": "A0HSmrwtLH/tmp/ed57b889aec26d2407c1e7904dcc7a4f07fb47a79d106ac91d51882a8cb4e8aa.jpg", "img_caption": ["Figure 1: Overview of the problem setup and our contribution. "], "img_footnote": [], "page_idx": 3}, {"type": "text", "text": "Definition 1 (Global semantic importance). For a concept $j\\in[m]$ , ", "page_idx": 3}, {"type": "equation", "text": "$$\nH_{0,j}^{\\mathrm{G}}:\\,\\hat{Y}\\bot\\!\\!\\perp Z_{j}\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "is the global semantic independence null hypothesis. ", "page_idx": 3}, {"type": "text", "text": "Rejecting $H_{0,j}^{\\mathrm{G}}$ means that we have observed enough evidence to believe the response of the model depends on concept $j$ , i.e. concept $j$ is globally important over the population. Note that both $\\hat{Y}$ and $Z_{j}$ are fixed functions of the same random variable $H$ , i.e. $\\hat{Y}=g\\bar{(H)}$ and $Z_{j}=\\langle c_{j},H\\rangle$ . Then, it is reasonable to wonder whether there is any point in testing $H_{0,j}^{\\mathrm{G}}$ at all\u2014can we obtain two independent random variables from the same one? For example, let $g$ be a linear classifier such that $\\hat{Y}=\\langle w,H\\rangle$ , $w\\in\\mathbb{R}^{d}$ . Intuition might suggest that if $\\langle w,c_{j}\\rangle=0$ then $\\hat{Y}\\bot\\bot Z_{j}$ , i.e. if the classifier is orthogonal to a concept, then the concept cannot be important. We show in the short lemma below (whose proof is in Appendix C.1) that this is false, and that, arguably unsurprisingly, statistical independence is different from orthogonality between vectors, which motivates the need for our testing procedures. ", "page_idx": 3}, {"type": "text", "text": "The null hypothesis $H_{0,j}^{\\mathrm{G}}$ above precisely defines the global importance of a concept, but it ignores the information contained in the rest of them, and concepts may be correlated. For example, predictions for class \u201cdog\u201d may be independent of \u201cstick\u201d given \u201ctail\u201d and \u201cpaws\u201d, although \u201cstick\u201d is marginally important. To address this, and inspired by [11], we define global conditional semantic importance. Definition 2 (Global conditional semantic importance). For a concept $j\\in[m]$ , let $-j:=[m]\\setminus\\{j\\}$ denote all but the $j^{\\mathrm{th}}$ concept. Then, ", "page_idx": 3}, {"type": "equation", "text": "$$\nH_{0,j}^{\\mathrm{GC}}:\\;\\hat{Y}\\bot\\bot Z_{j}\\mid Z_{-j}\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "is the global conditional semantic independence null hypothesis. ", "page_idx": 3}, {"type": "text", "text": "Analogous to Definition 1, rejecting $H_{0,j}^{\\mathrm{GC}}$ means that we have accumulated enough evidence to believe the response of the model depends on concept $j$ even in the presence of the remaining concepts, i.e. there is information about $\\hat{Y}$ in concept $j$ that is missing from the rest. ", "page_idx": 3}, {"type": "text", "text": "We stress an important distinction between Definition 2 and PCBMs: the latter approximate $\\mathbb{E}[Y\\mid Z]$ with a sparse linear layer, which is inherently interpretable because the regression coefficients directly inform on the global conditional independence structure of the predictions, i.e. if $\\hat{Y}\\,=\\,\\langle\\beta,Z\\rangle$ , $\\beta\\ \\in\\ \\mathbb{R}^{m}$ then $\\hat{Y}\\bot\\!\\!\\!\\perp Z_{j}\\;\\mid\\;Z_{-j}\\;\\;\\Longleftrightarrow\\;\\;\\beta_{j}\\;=\\;0$ . In this work, however, we do not assume any parametrization between the concepts and the labels because we want to provide guarantees on the original, fixed classifier $g$ that acts directly on an embedding $h$ . From this conditional independence perspective, PCBMs can be interpreted as a (parametric) test of true linear independence (i.e., $\\mathbf{\\dot{}}{H_{0,j}^{\\mathrm{PCBM}}}:Y\\bot\\bot Z_{j}\\mid Z_{-j})$ between the concepts and the labels (note that $H_{0,j}^{\\mathrm{PCBM}}$ has the true label $Y$ and not the prediction $\\hat{Y}$ ), whereas we study the semantic structure of the predictions of a complex model, which may have learned spurious, non-linear correlations of these concepts from data. ", "page_idx": 3}, {"type": "text", "text": "Akin to the CRT [11], we assume we can sample from the conditional distribution of the concepts, i.e. $P_{Z_{j}\\mid Z_{-j}}$ . Within the scope of this work, $m$ is small $(m\\,\\approx\\,20)$ and we will show how to effectively approximate this distribution with nonparametric methods that do not require prohibitive computational resources. This is an advantage of testing $a$ few semantic concepts compared to input features, especially for imaging tasks where the number of pixels is large $(\\gtrsim10^{5})$ and learning a conditional generative model (e.g., a diffusion model [65]) may be expensive. ", "page_idx": 3}, {"type": "text", "text": "", "page_idx": 4}, {"type": "text", "text": "Finally, we define the notion of local conditional semantic importance. That is, we are interested in finding the most important concepts for the prediction of the model locally on a particular input $x$ , i.e. $\\bar{y}=g(f(x))$ . Recently, [10, 69] showed how to deploy ideas of conditional randomization testing for local explanations of machine learning models. Briefly, let $B,C$ be random variables and $\\eta(B,C)$ a fixed, possibly randomized, real-valued predictor. For an observation $(b,c)$ , the explanation randomization test (XRT) [69] null hypothesis is $\\eta(b,c)\\overset{d}{=}\\eta(\\widetilde{B},c)$ , $\\widetilde{B}\\sim P_{B|C=c}$ . That is, the observed value of $B$ does not affect the distribution of the response  given  the observed value of $C$ . We now generalize these ideas. ", "page_idx": 4}, {"type": "text", "text": "Definition 3 (Local conditional semantic importance). For a fixed $z\\in[-1,1]^{m}$ and any $C\\subseteq[m]$ , denote $\\hat{Y}_{C}=g(\\widetilde{H}_{C})$ with $\\widetilde{H}_{C}\\sim P_{H|Z_{C}=z_{C}}$ . Then, for a concept $j\\in[m]$ and a subset $S\\subseteq[m]\\backslash\\{j\\}$ , ", "page_idx": 4}, {"type": "equation", "text": "$$\nH_{0,j,S}^{\\mathrm{LC}}:\\,\\hat{Y}_{S\\cup\\{j\\}}\\overset{d}{=}\\hat{Y}_{S}\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "is the local conditional semantic independence null hypothesis. ", "page_idx": 4}, {"type": "text", "text": "In words, rejecting $H_{0,j,S}^{\\mathrm{LC}}$ means that, given the observed concepts in $S$ , concept $j\\not\\in S$ affects the distribution of the response of the model, hence it is important. For this test, we assume we can sample from the conditional distribution of the embeddings given a subset of concepts (i.e., $P_{H|Z_{C}=z_{C}})$ . This is equivalent to solving an inverse problem stochastically, since $z=\\langle c,h\\rangle$ and $c$ is not invertible ( $\\stackrel{\\triangledown}{c}\\in\\mathbb{R}^{d\\times m}$ , $m\\ll d)$ ). Hence, there are several embeddings $h$ that could have generated the observed $z_{C}$ . We will use nonparametric sampling ideas to achieve this, stressing that it suffices to sample the embeddings $H$ and not an entire input image $X$ since the classifier $g$ directly acts on $h$ and the encoder $f$ is deterministic. Finally, we remark that $H_{0,j,S}^{\\mathrm{LC}}$ differs from the XRT null hypothesis in that conditioning is performed in the space of semantic concepts instead of the input\u2019s. ", "page_idx": 4}, {"type": "text", "text": "With these precise notions of semantic importance, we now show how to test for each one of them with principles of sequential kernelized independence testing (SKIT) [49]. ", "page_idx": 4}, {"type": "text", "text": "3.2 Testing by Betting ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "A classical approach to hypothesis testing consists of formulating a null hypothesis $H_{0}$ , collecting data, and then summarizing evidence by means of a $p$ -value. Under the null, the probability of observing a small $p$ -value is small. Thus, for a significance level $\\alpha\\in(0,1)$ , we can reject $H_{0}$ if $p\\leq\\alpha$ . In this setting, all data is collected first, and then processed later (i.e., offline). ", "page_idx": 4}, {"type": "text", "text": "Alternatively, one can instantiate a game between a bettor and nature [57, 58]. At each turn of the game, the bettor places a wager against $H_{0}$ , and then nature reveals the truth. If the bettor wins, they will increase their wealth, otherwise lose some. More formally, and as is commonly done [49, 56, 60], we define a wealth process $\\{K_{t}\\}_{t\\in\\ensuremath{\\mathbb{N}}_{0}}$ with $K_{0}=1$ and $K_{t}=K_{t-1}\\cdot(1+v_{t}\\kappa_{t})$ where $v_{t},\\kappa_{t}\\in[-1,1]$ are a betting fraction and the payoff of the bet, respectively. It is now easy to see that when $v_{t}\\kappa_{t}\\geq0$ (i.e., the bettor wins) the wealth increases, and the opposite otherwise. If the payoff $\\kappa_{t}$ guarantees the game is fair, i.e. the bettor cannot accumulate wealth under the null, then we can use the wealth process to reject $H_{0}$ with Type I error control (details in Appendix A). In particular, for a significance level $\\alpha\\in(0,1)$ , we denote $\\tau:=\\operatorname*{min}\\{t\\geq1:K_{t}\\geq1/\\alpha\\}$ the rejection time of $H_{0}$ . ", "page_idx": 4}, {"type": "text", "text": "The choice of using sequential testing is motivated by two fundamental properties. First, sequential tests are adaptive to the hardness of the problem, sometimes provably [60, Proposition 3]. That is, the harder it is to reject the null, the longer the test will take, and vice versa. This naturally induces a rank of importance across concepts\u2014if concept $c_{j}$ rejects faster than $c_{j^{\\prime}}$ , then $c_{j}$ is more important (i.e., it is easier to reject the null hypothesis that the predictions do not depend on $c_{j}$ ). We stress that this is not always possible by means of $p$ -values because they do not measure effect sizes: consider two concepts that reject their respective nulls at the same significance level; one cannot distinguish which\u2014if any\u2014is more important. As we will show in our experiments, all tests used in this work are adaptive in practice, but statistical guarantees on their rejection times are currently open questions, and we consider them as future work. Second, sequential tests are sample-efficient because they only analyze the data is needed to reject, which is especially important for conditional randomization tests. In the offline scenario, we would have to resample the entire dataset several times (which is expensive), but the sequential test would terminate in at most the size of the dataset [24]. ", "page_idx": 4}, {"type": "table", "img_path": "A0HSmrwtLH/tmp/38a8ce39dea5a3e49f18efd9be79b9c33ee43e9bc3ce3990e3554c41c7d1c512.jpg", "table_caption": [], "table_footnote": [], "page_idx": 5}, {"type": "text", "text": "3.3 Testing Global Semantic Importance with SKIT ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "Podkopaev et al. [49] show how to design sequential kernelized tests of independence (i.e., $H_{0}:$ $A\\bot\\bot B)$ by framing them as particular two-sample tests of the form $H_{0}:P=\\widetilde{P}$ , with $P=P_{A B}$ and $\\widetilde{P}=P_{A}\\times P_{B}$ . Similarly to [56, 60], they propose to leverage a simple yet powerful observation about the symmetry of the data under $H_{0}$ [49, Section 4]. We state here the main result we will use in this paper (the proof is included in Appendix A.2). ", "page_idx": 5}, {"type": "text", "text": "Lemma 2 (See [49, 56, 60]). $\\forall t\\geq1$ , let $X\\sim P$ and $\\widetilde{X}\\sim\\widetilde{P}$ , and let $\\rho_{t}:\\mathcal{X}\\to\\mathbb{R}$ be any fixed real-valued function on $\\mathcal{X}$ . Then, $\\kappa_{t}=\\operatorname{tanh}(\\rho_{t}(X)-\\rho_{t}(\\widetilde{X}))$ provides a fair game for $H_{0}:P=\\widetilde{P}$ . ", "page_idx": 5}, {"type": "text", "text": "That is, Lemma 2 prescribes how to construct valid payoffs for two-samples tests and, consequently, tests of independence. We note that the choice of tanh provides $\\kappa_{t}\\,\\in\\,[-1,1]$ , but any arbitrary anti-symmetric function can be used (e.g., sign). Furthermore, any fixed function $\\rho_{t}$ is valid but, in general, this function should have a positive value under the alternative in order for the bettor to increase their wealth and the testing procedure to have good power. ", "page_idx": 5}, {"type": "text", "text": "Going back to the problem studied in this work, note that the global semantic importance null hypothesis $H_{0,j}^{\\mathrm{G}}$ in Definition 1 can be directly rewritten as a two-sample test, i.e. $\\bar{H_{0,j}^{\\bar{\\mathrm{G}}}}:\\,\\hat{Y}\\bot\\!\\!\\bot Z_{j}$ is equivalent to $H_{0,j}^{\\mathrm{G}}:\\;P_{\\hat{Y}Z_{j}}=P_{\\hat{Y}}\\times P_{Z_{j}}$ . We follow [49] and use the maximum mean discrepancy (MMD) [29] to measure the distance between the joint and the product of marginals. In particular, let $\\mathcal{R}_{\\hat{Y}},\\mathcal{R}_{Z_{j}}$ be two reproducing kernel Hilbert spaces (RKHSs) on the domains of $\\bar{\\hat{Y}}$ and $Z_{j}$ , respectively (recall that $\\hat{Y}$ and $Z_{j}$ are univariate). Then, $\\rho_{t}^{\\mathrm{SKIT}}$ is the plug-in estimate of the witness function of $\\mathrm{MMD}(P_{\\hat{Y}Z_{j}},P_{\\hat{Y}}\\times P_{Z_{j}})$ at time $t$ .2 We include the SKIT algorithm and technical details on computing \u03c1tSK $\\rho_{t}^{\\mathrm{SKIT}}$ and $k_{t}^{\\mathrm{{SKIT}}}$ in Appendix B.1. ", "page_idx": 5}, {"type": "text", "text": "Computational complexity of SKIT. Analogous to the original presentation in Shekhar and Ramdas [60], the computational complexity of Algorithm B.1 is $\\bar{\\mathcal{O}}(\\bar{\\tau}^{2})$ , where $\\tau$ is the random rejection time. ", "page_idx": 5}, {"type": "text", "text": "(WCe- SnKoIwT )m foovr $H_{0,j}^{\\mathrm{GC}}$ , oa pnrde tsheen teixnpgl tawnaot inoonv real ntdesotimnigz aptiroonc eSdKurIeTs :( Xth-eS KcoITn)d iftoiro $H_{0,j,S}^{\\mathrm{LC}}$ .domization SKIT ", "page_idx": 5}, {"type": "text", "text": "3.4 Testing Global Conditional Semantic Importance with C-SKIT ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "Analogous to the discussion in the previous section, we rephrase the global conditional null hypothesis $H_{0,j}^{\\mathrm{GC}}$ in Definition 2 as a two sample test $H_{0,j}^{\\mathrm{GC}}:\\;P_{\\hat{Y}Z_{j}Z_{-j}}=P_{\\hat{Y}\\tilde{Z}_{j}Z_{-j}}$ , $\\widetilde{Z}_{j}\\sim P_{Z_{j}|Z_{-j}}$ . In contrast with other kernel-based notions of distance between conditional distributions [48, 61, 64]\u2014and akin to the CRT [11]\u2014we assume we can sample from $P_{Z_{j}\\mid Z_{-j}}$ , which allows us to directly estimate $\\mathrm{MMD}(P_{\\hat{Y}Z_{j}Z_{-j}},P_{\\hat{Y}\\widetilde{Z}_{j}Z_{-j}})$ in our testing procedure (we will expand on how to sample from this distribution shortly). Let $\\mathcal{R}_{\\hat{Y}},\\mathcal{R}_{Z_{j}},\\mathcal{R}_{Z_{-j}}$ be three RKHSs on the domains of $\\hat{Y},Z_{j}$ , and $Z_{-j}$ (i.e., $\\mathbb{R},\\mathbb{R},\\mathbb{R}^{m-1}$ , where $m$ is the number of concepts). Then, at time $t$ , the C-SKIT payoff function is ", "page_idx": 5}, {"type": "text", "text": "", "page_idx": 6}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\rho_{t}^{\\mathrm{C-SKIT}}:=\\hat{\\mu}_{\\hat{Y}Z_{j}Z_{-j}}^{(t-1)}-\\hat{\\mu}_{\\hat{Y}\\tilde{Z}_{j}Z_{-j}}^{(t-1)},}\\end{array}\n$$", "text_format": "latex", "page_idx": 6}, {"type": "text", "text": "where \u00b5\u02c6Y\u02c6 ZjZ\u2212j, $\\hat{\\mu}_{\\hat{Y}Z_{j}Z_{-j}}^{(t-1)},\\hat{\\mu}_{\\hat{Y}\\tilde{Z}_{j}Z_{-j}}^{(t-1)}$ are the mean embeddings of their respective distributions in $\\mathcal{R}_{\\hat{Y}}\\otimes\\mathcal{R}_{Z_{j}}\\otimes$ $\\mathcal{R}_{Z_{-j}}$ , and $\\otimes$ is the tensor product (see Appendix B.2 for technical details). Algorithm 1 summarizes the C-SKIT procedure, which provides Type I error control for H0G,jC, as we briefly state in the following proposition (see Appendix C.2 for the proof). ", "page_idx": 6}, {"type": "text", "text": "Proposition 1. $\\forall t\\geq1$ , let $(\\hat{Y},Z_{j},Z_{-j})\\sim P_{\\hat{Y}Z_{j}Z_{-j}}$ and ( Y\u02c6 , Z j, Z\u2212j) \u223cP Y\u02c6Z jZ\u2212j, $\\widetilde{Z}_{j}\\sim P_{Z_{j}|Z_{-j}}$ .   \nThen, $\\kappa_{t}:=\\operatorname{tanh}(\\rho_{t}^{\\scriptscriptstyle\\mathrm{C}\\scriptscriptstyle{S K I T}}(\\hat{Y},Z_{j},Z_{-j})-\\rho_{t}^{\\scriptscriptstyle\\mathrm{C}\\scriptscriptstyle{S K I T}}(\\hat{Y},\\widetilde{Z}_{j},Z_{-j}))$ provides a fair  game for $H_{0,j}^{G C}$ . ", "page_idx": 6}, {"type": "text", "text": "Computational complexity of C-SKIT. First note that $Z_{-j}$ is an $(m-1)$ -dimensional vector (where $m$ is the number of concepts). So, at each step of the test, the evaluation of the kernel associated with $\\mathcal{R}_{Z_{-j}}$ requires an additional sum over ${\\mathcal{O}}(m)$ terms. Furthermore, C-SKIT needs access to samples from $P_{Z|Z_{-j}}$ , and we conclude that the computational complexity of Algorithm 1 is $O(T_{n}m\\tau^{2})$ , where $T_{n}$ represents the cost of the sampler on $n$ samples, and it depends on implementation. For example, in the following, we will use non-parametric samplers with $\\dot{T}_{n}=\\mathcal{O}(n^{2})$ . Other choices of samplers, such as variational-autoencoders, may have constant cost (e.g., they are trained once and only used for inference). ", "page_idx": 6}, {"type": "text", "text": "3.5 Testing Local Conditional Semantic Importance with X-SKIT ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "Attentive readers will have noticed that the local conditional semantic null hypothesis $H_{0,j,S}^{\\mathrm{LC}}$ in Definition 3 is already a two-sample test where the test statistic $P$ is the distribution of the response of the model with the observed amount of concept $j$ (i.e., $\\hat{Y}_{S\\cup\\{j\\}}=g(\\widetilde{H}_{S\\cup\\{j\\}}))$ , and the null distribution $\\widetilde{P}$ without (i.e., $\\hat{Y}_{S}=g(\\widetilde{H}_{S}))$ . Herein, we assume we can sample from $\\widetilde{H}_{C}\\sim P_{H|Z_{C}=z_{C}}$ for any subset $C\\subseteq[m]$ , i.e. the conditional distribution of dense embeddings with specific concepts, which we will address via nonparametric methods. Then, for an RKHS $\\mathcal{R}_{\\hat{Y}}$ , the $\\mathrm{X}$ -SKIT payoff function is ", "page_idx": 6}, {"type": "equation", "text": "$$\n\\rho_{t}^{\\mathrm{x-SKIT}}:=\\hat{\\mu}_{\\hat{Y}_{S\\cup\\{j\\}}}^{(t-1)}-\\hat{\\mu}_{\\hat{Y}_{S}}^{(t-1)}\n$$", "text_format": "latex", "page_idx": 6}, {"type": "text", "text": "with \u00b5\u02c6Y\u02c6S\u222a{j}, \u00b5\u02c6 $\\hat{\\mu}_{\\hat{Y}_{S\\cup\\{j\\}}}^{(t-1)},\\hat{\\mu}_{\\hat{Y}_{S}}^{(t-1)}$ mean embeddings of the distributions in $\\mathcal{R}_{\\hat{Y}}$ . That is, $\\rho_{t}^{\\mathrm{X-SKIT}}$ is the plug-in estimate of the witness function of $\\mathbf{MMD}(\\hat{Y}_{S\\cup\\{j\\}},\\hat{Y}_{S}).$ \u2014technical details are in Appendix B.3. Then, the $\\mathrm{X}$ -SKIT testing procedure, which is summarized in Algorithm 2, provides Type I error control for $H_{0,j,S}^{\\mathrm{LC}}$ , as the following proposition summarizes (the proof is included in Appendix C.3). ", "page_idx": 6}, {"type": "text", "text": "Proposition 2. $\\forall t\\geq1$ $,\\,\\kappa_{t}:=\\operatorname{tanh}(\\rho_{t}^{\\scriptscriptstyle X-S K I T}(\\hat{Y}_{S\\cup\\{j\\}})-\\rho_{t}^{\\scriptscriptstyle X-S K I T}(\\hat{Y}_{S}))\\,.$ provides a fair game for $H_{0,j,S}^{L C}$ ", "page_idx": 6}, {"type": "text", "text": "Computational complexity of $\\mathbf{X}$ -SKIT. Note that Algorithm 2 assumes access to a sampler $P_{H|Z_{C}=z_{C}}$ , so its computational complexity is ${\\mathcal{O}}(T_{n}\\tau^{2})$ , where, similarly to above, $T_{n}$ is the cost of the sampler. We briefly remark that, for the nonparametric samplers used in this work, $T_{n}=n^{2}$ (compared to $\\tau n^{2}$ for C-SKIT) because we only need to estimate one conditional distribution. ", "page_idx": 6}, {"type": "text", "text": "So far, we have presented our tests for one concept at a time, but we are interested in testing $m\\geq1$ concepts. In this setting, it is well-known that multiple hypothesis testing requires appropriate corrections to avoid inflated significance levels. We use a result of Wang and Ramdas [77] and devise a greedy post-processor that guarantees false discovery rate control [3] (see Appendix A.4). ", "page_idx": 6}, {"type": "text", "text": "4 Results ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "First, we verify that our tests are valid and that they are adaptive to the hardness of their null hypotheses on two synthetic experiments in Appendix D. Here, we showcase the flexibility and effectiveness of our framework on zero-short image classification across several VL models on three real-world datasets: Animal with Attributes 2 (AwA2) [80], CUB-200-2011 (CUB) [75], and the Imagenette subset of ImageNet [22].3. We compare performance and transferability of the ranks of importance provided by each method across $8\\ \\mathrm{VL}$ models (see Appendix E for details) and, for all experiments, $f$ is the image encoder of the model and $g$ is the (linear) zero-shot classifier constructed by encoding $^{\\epsilon}A$ photo of $\\dot{a}\\,\\,{<}C L A S S_{-}\\,N A M E{>}^{\\prime\\prime}$ with the text encoder. Herein, we will always use RBF kernels to compute payoffs, and we repeat each test 100 times on independent draws of $\\tau^{\\mathrm{max}}$ samples to estimate each concept\u2019s expected rejection time and expected rejection rate at a significance level of $\\alpha=0.05$ with the FDR post-processor described in Appendix A.4. That is, a (normalized) rejection time of 1 means failing to reject in $\\tau^{\\mathrm{max}}$ steps. Finally, recall that C-SKIT and $\\mathrm{X}$ -SKIT need access to $P_{Z_{j}\\mid Z_{-j}}$ and $P_{H|Z_{C}=z_{C}}$ , and that these distributions are not known in general. Since $m$ is small, we use nonparametric methods to estimate them (see Appendix E.1). ", "page_idx": 6}, {"type": "table", "img_path": "A0HSmrwtLH/tmp/775683184ed8dac771f19e16b0d7e420afe8dd31e321b7703f120e2baf3da69a.jpg", "table_caption": ["Table 1: Summary of results for each dataset. Metrics are reported as average across all VL models used in the experiments. See main text for details about the models and the metrics used. "], "table_footnote": [], "page_idx": 7}, {"type": "image", "img_path": "A0HSmrwtLH/tmp/625c8343aa7b543cef2599defbc8b9ccd3dfcb11236f22e7f7bb70a72804ee73.jpg", "img_caption": ["Figure 2: Importance results with CLIP:ViT-L/14 on 2 classes in the AwA2 dataset. Concepts are annotated with $(p)$ if they are present in the class, or with (a) otherwise. ", "(a) Global importance with SKIT. "], "img_footnote": [], "page_idx": 7}, {"type": "image", "img_path": "A0HSmrwtLH/tmp/fc5bc5c4e2d9d40ef3eee5308f2cd60e4b31c273a62bb0134d31500c4d145e93.jpg", "img_caption": ["(b) Global conditional importance with C-SKIT. "], "img_footnote": [], "page_idx": 7}, {"type": "text", "text": "", "page_idx": 7}, {"type": "text", "text": "Table 1 summarizes the results of all experiments, which we now present and discuss individually. ", "page_idx": 7}, {"type": "text", "text": "4.1 AwA2 Dataset ", "text_level": 1, "page_idx": 7}, {"type": "text", "text": "Given the presence of global (i.e., class-level) annotations, we use SKIT and C-SKIT to test the global (and global conditional) semantic importance structure of the predictions for the top-10 best classified animal categories across all models (we describe the dataset, the concepts used, and the hyperparameters of the tests in Appendix E.2). We classify the top-10 concepts reported by each method as important, and we compute the $f_{1}$ score with the ground-truth annotations. We briefly remark that this choice is informed by the fact that most concepts have rejection rates larger than the significance level of $\\alpha$ . When comparing with PCBM\u2014since we use different concepts for each class\u2014we train 100 independent linear models for each class, and we rank concepts based on their average absolute weights (instead of signed ones) because the null hypotheses presented in this work are two-sided, i.e. a concept is important both if it increases the prediction for a class or if it decreases it. Table 1 shows that both SKIT and C-SKIT outperform PCBM across all three metrics, with SKIT providing the best average rank agreement across different models and importance $f_{1}$ score (0.50 and 0.65, respectively). The fact that ranks provided by our tests have higher average agreement compared to PCBM suggests that VL models may share a similar semantic independence structure notwithstanding their embedding size or training strategy, i.e. semantic importance may be transferable across models (all individual pairwise agreements are included in Fig. E.4). ", "page_idx": 7}, {"type": "text", "text": "Finally, Fig. 2 shows ranks of importance with CLIP:ViT-L/14 on 2 animal categories (see Figs. E.5 and E.6 for all classes). In general, concepts are globally important (rejection rates are greater than $\\alpha$ ), and it is harder to reject the global conditional null hypothesis (rejection rates are lower and rejection times larger), naturally reflecting the fact that conditional independence is a stronger condition. ", "page_idx": 7}, {"type": "image", "img_path": "A0HSmrwtLH/tmp/b3f0087c0a74df96674185e82ed9a6ffbf0501dc2f8d0eadbf83d159925569f8.jpg", "img_caption": ["Figure 3: Importance results with X-SKIT and CLIP:ViT-L/14 on 4 images in the CUB dataset. Concepts with $(p)$ are present in the image according to human annotations, and (a) otherwise. "], "img_footnote": [], "page_idx": 8}, {"type": "text", "text": "", "page_idx": 8}, {"type": "text", "text": "4.2 CUB Dataset ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "This dataset (differently from AwA2) provides per-image annotations of semantic attributes. So, we use X-SKIT to test the semantic importance structure of VL models locally on particular images and validate its performance against such annotations (we include details about this experiment and extended results in Appendix E.3). The purpose of this experiment is to validate the performance of X-SKIT, hence we use the ground-truth binary semantic annotations as an oracle instead of predicting the presence of concepts. In practical scenarios where ground-truth is not available, one could\u2014as done by previous works [12]\u2014use LLMs to answer binary questions (e.g., \u201cDoes this bird have an tmo acnoy mtepsuttse .w Tithhu ns,u lwl eh yreppoothrte saivse $H_{0,j,S}^{\\mathrm{LC}}$ es\u2014ulotns eo fvoerr  e1a0c0h  tseustbss ewt $S\\subseteq[m]\\setminus\\{j\\}$ $j\\,\\in\\,[m]$ s\u2014etsw hwiicthh  afrixee idn tsriazcet .ble $s$ ", "page_idx": 8}, {"type": "text", "text": "Fig. 3 depicts prototypical results with CLIP:ViT-L/14 (Fig. E.9 includes results for all models on the same images). After running $\\mathrm{X}$ -SKIT, we classify concepts as important by thresholding their rejection rates at level $\\alpha$ \u2014which is a statistically-valid way of selecting important concepts. Results are included in Table 1, and we conclude that X-SKIT provides ranks of importance that are well-aligned both across models (0.82 rank agreement) and with ground-truth annotations ( $f_{1}$ score of 0.93). We remark that X-SKIT is the first method to provide local semantic explanations, hence why we cannot compare with alternatives. ", "page_idx": 8}, {"type": "text", "text": "4.3 Imagenette Dataset ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "Lastly, we use both SKIT, C-SKIT, and X-SKIT on the Imagenette subset of ImageNet [22]\u2014which does not provide ground-truth semantic annotations to evaluate performance with. So, we use SpLiCe [6] to select which concepts to test (see Appendix E.4 for details), but we stress that any user-defined set of concepts would be valid\u2014a unique feature of our proposed framework. ", "page_idx": 8}, {"type": "text", "text": "Figs. 4a and 4b show SKIT and C-SKIT results with CLIP:ViT-L/14 on 2 classes in the dataset (Fig. E.11 includes all classes). We use SpLiCe to encode the entire dataset and test the top-20 concepts. Analogous to the experiment on AwA2, we can see that rejection rates are lower for C-SKIT (i.e., conditional dependence) compared to SKIT (i.e., marginal dependence). We evaluate rank agreement across all models and compare with PCBM in Table 1. These results confirm that not only are the ranks produced by our tests more transferable across models (rank agreement of 0.51 for SKIT, 0.54 or C-SKIT, 0.59 for X-SKIT, and 0.45 for PCBM), but also they retain the performance of the original classifier $(98.99\\%$ for our methods vs $95.55\\%$ for PCBM). We refer interested readers to Fig. E.12 for all pairwise comparisons. Furthermore, we qualitatively study the stability of our tests as a function of $\\tau^{\\mathrm{max}}$ in Fig. E.13. This is important because $\\tau^{\\mathrm{max}}$ represents the sample complexity of the tests. Our findings indicate that important concepts tend to exhibit greater stability in their ranks compared to less important ones, with SKIT showing overall more stability than C-SKIT. ", "page_idx": 8}, {"type": "text", "text": "To conclude, Fig. 4c shows X-SKIT results with CLIP:ViT-L/14 on three random images from the dataset (see Figs. E.15 and E.16 for all models and more images). We use SpLiCe to encode each image and obtain its top-10 concepts, and then add the bottom-4 according to PCBM, for a total of 14 attributes per image. The choice of combining concepts both from SpLiCe and PCBM will highlight the differences between these methods and our notion of local statistical importance, as we will shortly expand on. Recall that we use nonparametric samplers to approximate $P_{H|Z_{C}=z_{C}}$ , so the cost of using image-specific concepts boils down to projecting the feature embeddings with a different matrix $c$ , which is negligible compared to running the tests. We note that parametric generative models\u2014such as variational autoencoders or diffusion models\u2014would have required retraining for each set of concepts, which is expensive. Overall, we find that ranks are well-aligned across models (0.71 rank agreement, see Table 1). We can appreciate how the bottom-4 concepts from PCBM, which are annotated with an asterisk, are not always last, i.e. a concept may be locally important even if it is not globally important. For example, concept \u201cfishing\u201d may not be globally important for class \u201cEnglish springer\u201d, but it is locally important for an image of a dog in water. Conversely, a concept having a high weight according to SpLiCe does not imply it will be statistically important for the predictions of the model, and these distinctions are important in order to communicate findings transparently. ", "page_idx": 8}, {"type": "image", "img_path": "A0HSmrwtLH/tmp/41aa5313f819bba74eadcf648a1533007e0ffa3c24ce366dbd94eb8d11204654.jpg", "img_caption": ["(c) Local importance with X-SKIT. The bottom-4 concepts according to PCBM are annotated with $(^{*})$ . ", "Figure 4: Results with CLIP:ViT-L/14 on Imagenette. "], "img_footnote": [], "page_idx": 9}, {"type": "text", "text": "", "page_idx": 9}, {"type": "text", "text": "5 Conclusions ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "There exist an increasing interest in explaining modern, unintelligible predictors and, in particular, doing so with inherently interpretable concepts that convey specific meaning to users. This work is the first to formalize precise statistical notions of semantic importance in terms of global (i.e., over a population) and local (i.e., on a sample) conditional hypothesis testing. We propose novel, valid tests for each notion of importance while providing a rank of importance by deploying ideas of sequential testing. Importantly, by approaching importance via conditional independence (and by developing appropriate valid tests), we are able to provide Type I error and FDR control, a feature that is unique to our framework compared to existing alternatives. Furthermore, our tests allow to explain the original\u2014potentially nonlinear\u2014classifier that would be used in the wild, as opposed to training surrogate linear models as has been the standard so far. ", "page_idx": 9}, {"type": "text", "text": "Naturally, our work has limitations. First and foremost, the procedures introduced in this work require access to samplers, and there might be settings were learning these models is hard; we used nonparametric estimators in our experiments, but modern generative models could be employed, too. Second, kernel-based tests rely on the assumption that the kernels used are characteristic for the space of distributions considered. Although these assumptions are usually satisfied in $\\mathbb{R}^{d}$ for RBF kernels, there may exist data modalities where this is not true (e.g., discrete data, graphs), which would compromise the power of the test. Finally, although we grant full flexibility to users to specify the concepts they care about, there is no guarantee that these are well-represented in the feature space of the model, nor that they are the most informative ones for a specific task. All these points are a matter of ongoing and future work. ", "page_idx": 9}, {"type": "text", "text": "Acknowledgments ", "text_level": 1, "page_idx": 10}, {"type": "text", "text": "We sincerely thank Zhenzhen Wang and the anonymous NeurIPS reviewers for useful conversations that strengthened the presentation of our experimental results. This research was supported by NSF CAREER Award CCF 2239787. ", "page_idx": 10}, {"type": "text", "text": "References ", "text_level": 1, "page_idx": 10}, {"type": "text", "text": "[1] Nachman Aronszajn. Theory of reproducing kernels. Transactions of the American mathematical society, 68(3):337\u2013404, 1950.   \n[2] David Bau, Bolei Zhou, Aditya Khosla, Aude Oliva, and Antonio Torralba. Network dissection: Quantifying interpretability of deep visual representations. In Proceedings of the IEEE conference on computer vision and pattern recognition, pages 6541\u20136549, 2017.   \n[3] Yoav Benjamini and Yosef Hochberg. Controlling the false discovery rate: a practical and powerful approach to multiple testing. Journal of the Royal statistical society: series B (Methodological), 57(1):289\u2013300, 1995.   \n[4] Alain Berlinet and Christine Thomas-Agnan. Reproducing kernel Hilbert spaces in probability and statistics. Springer Science & Business Media, 2011.   \n[5] Thomas B Berrett, Yi Wang, Rina Foygel Barber, and Richard J Samworth. The conditional permutation test for independence while controlling for confounders. Journal of the Royal Statistical Society Series B: Statistical Methodology, 82(1):175\u2013197, 2020.   \n[6] Usha Bhalla, Alex Oesterling, Suraj Srinivas, Flavio P Calmon, and Himabindu Lakkaraju. Interpreting clip with sparse linear concept embeddings (splice). arXiv preprint arXiv:2402.10376, 2024.   \n[7] Beepul Bharti, Paul Yi, and Jeremias Sulam. Sufficient and necessary explanations (and what lies in between). arXiv preprint arXiv:2409.20427, 2024.   \n[8] Gilles Blanchard and Etienne Roquain. Two simple sufficient conditions for fdr control. Electronic Journal of Statistics, 2:963\u2013992, 2008.   \n[9] Carlo Bonferroni. Teoria statistica delle classi e calcolo delle probabilita. Pubblicazioni del R istituto superiore di scienze economiche e commericiali di firenze, 8:3\u201362, 1936.   \n[10] Collin Burns, Jesse Thomason, and Wesley Tansey. Interpreting black box models via hypothesis testing. In Proceedings of the 2020 ACM-IMS on foundations of data science conference, pages 47\u201357, 2020.   \n[11] Emmanuel Candes, Yingying Fan, Lucas Janson, and Jinchi Lv. Panning for gold:\u2018modelx\u2019knockoffs for high dimensional controlled variable selection. Journal of the Royal Statistical Society Series B: Statistical Methodology, 80(3):551\u2013577, 2018.   \n[12] Aditya Chattopadhyay, Kwan Ho Ryan Chan, and Rene Vidal. Bootstrapping variational information pursuit with large language and vision models for interpretable image classification. In The Twelfth International Conference on Learning Representations, 2024.   \n[13] Aditya Chattopadhyay, Ryan Pilgrim, and Rene Vidal. Information maximization perspective of orthogonal matching pursuit with applications to explainable ai. Advances in Neural Information Processing Systems, 36, 2024.   \n[14] Haozhe Chen, Junfeng Yang, Carl Vondrick, and Chengzhi Mao. Invite: Interpret and control vision-language models with text explanations. In The Twelfth International Conference on Learning Representations, 2024.   \n[15] Jianbo Chen, Le Song, Martin J Wainwright, and Michael I Jordan. L-shapley and c-shapley: Efficient model interpretation for structured data. arXiv preprint arXiv:1808.02610, 2018. ", "page_idx": 10}, {"type": "text", "text": "[16] Mehdi Cherti, Romain Beaumont, Ross Wightman, Mitchell Wortsman, Gabriel Ilharco, Cade Gordon, Christoph Schuhmann, Ludwig Schmidt, and Jenia Jitsev. Reproducible scaling laws for contrastive language-image learning. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 2818\u20132829, 2023. ", "page_idx": 11}, {"type": "text", "text": "[17] Thomas M Cover. Universal portfolios. Mathematical finance, 1(1):1\u201329, 1991.   \n[18] Ian Covert, Scott M Lundberg, and Su-In Lee. Understanding global feature contributions with additive importance measures. Advances in Neural Information Processing Systems, 33: 17212\u201317223, 2020.   \n[19] Ashok Cutkosky and Francesco Orabona. Black-box reductions for parameter-free online learning in banach spaces. In Conference On Learning Theory, pages 1493\u20131529. PMLR, 2018.   \n[20] Roxana Daneshjou, Mert Yuksekgonul, Zhuo Ran Cai, Roberto Novoa, and James Y Zou. Skincon: A skin disease dataset densely annotated by domain experts for fine-grained debugging and analysis. Advances in Neural Information Processing Systems, 35:18157\u201318167, 2022.   \n[21] Marina Danilevsky, Kun Qian, Ranit Aharonov, Yannis Katsis, Ban Kawas, and Prithviraj Sen. A survey of the state of explainable ai for natural language processing. arXiv preprint arXiv:2010.00711, 2020.   \n[22] Jia Deng, Wei Dong, Richard Socher, Li-Jia Li, Kai Li, and Li Fei-Fei. Imagenet: A largescale hierarchical image database. In 2009 IEEE conference on computer vision and pattern recognition, pages 248\u2013255. Ieee, 2009.   \n[23] Christiane Fellbaum. WordNet: An electronic lexical database. MIT press, 1998.   \n[24] Lasse Fischer and Aaditya Ramdas. Sequential permutation testing by betting. arXiv preprint arXiv:2401.07365, 2024.   \n[25] Kenji Fukumizu, Arthur Gretton, Xiaohai Sun, and Bernhard Sch\u00f6lkopf. Kernel measures of conditional dependence. Advances in neural information processing systems, 20, 2007.   \n[26] Yossi Gandelsman, Alexei A Efros, and Jacob Steinhardt. Interpreting clip\u2019s image representation via text-based decomposition. arXiv preprint arXiv:2310.05916, 2023.   \n[27] Damien Garreau, Wittawat Jitkrittum, and Motonobu Kanagawa. Large sample analysis of the median heuristic. arXiv preprint arXiv:1707.07269, 2017.   \n[28] Arthur Gretton, Kenji Fukumizu, Choon Teo, Le Song, Bernhard Sch\u00f6lkopf, and Alex Smola. A kernel statistical test of independence. Advances in neural information processing systems, 20, 2007.   \n[29] Arthur Gretton, Karsten M Borgwardt, Malte J Rasch, Bernhard Sch\u00f6lkopf, and Alexander Smola. A kernel two-sample test. The Journal of Machine Learning Research, 13(1):723\u2013773, 2012.   \n[30] Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun. Deep residual learning for image recognition. In Proceedings of the IEEE conference on computer vision and pattern recognition, pages 770\u2013778, 2016.   \n[31] Gabriel Ilharco, Mitchell Wortsman, Ross Wightman, Cade Gordon, Nicholas Carlini, Rohan Taori, Achal Dave, Vaishaal Shankar, Hongseok Namkoong, John Miller, Hannaneh Hajishirzi, Ali Farhadi, and Ludwig Schmidt. Openclip, July 2021. URL https://doi.org/10.5281/ zenodo.5143773. If you use this software, please cite it as below.   \n[32] Chao Jia, Yinfei Yang, Ye Xia, Yi-Ting Chen, Zarana Parekh, Hieu Pham, Quoc Le, Yun-Hsuan Sung, Zhen Li, and Tom Duerig. Scaling up visual and vision-language representation learning with noisy text supervision. In International conference on machine learning, pages 4904\u20134916. PMLR, 2021.   \n[33] Maurice G Kendall. A new measure of rank correlation. Biometrika, 30(1-2):81\u201393, 1938.   \n[34] Been Kim, Martin Wattenberg, Justin Gilmer, Carrie Cai, James Wexler, Fernanda Viegas, et al. Interpretability beyond feature attribution: Quantitative testing with concept activation vectors (tcav). In International conference on machine learning, pages 2668\u20132677. PMLR, 2018.   \n[35] Diederik P Kingma and Jimmy Ba. Adam: A method for stochastic optimization. arXiv preprint arXiv:1412.6980, 2014.   \n[36] Pang Wei Koh, Thao Nguyen, Yew Siang Tang, Stephen Mussmann, Emma Pierson, Been Kim, and Percy Liang. Concept bottleneck models. In International conference on machine learning, pages 5338\u20135348. PMLR, 2020.   \n[37] Stefan Kolek, Aditya Chattopadhyay, Kwan Ho Ryan Chan, Hector Andrade-Loarca, Gitta Kutyniok, and Ren\u00e9 Vidal. Learning interpretable queries for explainable image classification with information pursuit. arXiv preprint arXiv:2312.11548, 2023.   \n[38] Yann LeCun, L\u00e9on Bottou, Yoshua Bengio, and Patrick Haffner. Gradient-based learning applied to document recognition. Proceedings of the IEEE, 86(11):2278\u20132324, 1998.   \n[39] Junnan Li, Dongxu Li, Caiming Xiong, and Steven Hoi. Blip: Bootstrapping languageimage pre-training for unified vision-language understanding and generation. In International conference on machine learning, pages 12888\u201312900. PMLR, 2022.   \n[40] Tsung-Yi Lin, Michael Maire, Serge Belongie, James Hays, Pietro Perona, Deva Ramanan, Piotr Doll\u00e1r, and C Lawrence Zitnick. Microsoft coco: Common objects in context. In Computer Vision\u2013ECCV 2014: 13th European Conference, Zurich, Switzerland, September 6-12, 2014, Proceedings, Part V 13, pages 740\u2013755. Springer, 2014.   \n[41] Pantelis Linardatos, Vasilis Papastefanopoulos, and Sotiris Kotsiantis. Explainable ai: A review of machine learning interpretability methods. Entropy, 23(1):18, 2020.   \n[42] Scott M Lundberg and Su-In Lee. A unified approach to interpreting model predictions. Advances in neural information processing systems, 30, 2017.   \n[43] Jan Macdonald, Stephan W\u00e4ldchen, Sascha Hauch, and Gitta Kutyniok. A rate-distortion framework for explaining neural network decisions. arXiv preprint arXiv:1905.11092, 2019.   \n[44] Ricardo Moreira, Jacopo Bono, M\u00e1rio Cardoso, Pedro Saleiro, M\u00e1rio AT Figueiredo, and Pedro Bizarro. Diconstruct: Causal concept-based explanations through black-box distillation. arXiv preprint arXiv:2401.08534, 2024.   \n[45] Alfred M\u00fcller. Integral probability metrics and their generating classes of functions. Advances in applied probability, 29(2):429\u2013443, 1997.   \n[46] Tuomas Oikarinen and Tsui-Wei Weng. Clip-dissect: Automatic description of neuron representations in deep vision networks. arXiv preprint arXiv:2204.10965, 2022.   \n[47] Tuomas Oikarinen, Subhro Das, Lam M Nguyen, and Tsui-Wei Weng. Label-free concept bottleneck models. arXiv preprint arXiv:2304.06129, 2023.   \n[48] Junhyung Park and Krikamol Muandet. A measure-theoretic approach to kernel conditional mean embeddings. Advances in neural information processing systems, 33:21247\u201321259, 2020.   \n[49] Aleksandr Podkopaev, Patrick Bl\u00f6baum, Shiva Kasiviswanathan, and Aaditya Ramdas. Sequential kernelized independence testing. In International Conference on Machine Learning, pages 27957\u201327993. PMLR, 2023.   \n[50] Alec Radford, Jong Wook Kim, Chris Hallacy, Aditya Ramesh, Gabriel Goh, Sandhini Agarwal, Girish Sastry, Amanda Askell, Pamela Mishkin, Jack Clark, et al. Learning transferable visual models from natural language supervision. In International conference on machine learning, pages 8748\u20138763. PMLR, 2021.   \n[51] Vikram V Ramaswamy, Sunnie SY Kim, Ruth Fong, and Olga Russakovsky. Overlooked factors in concept-based explanations: Dataset choice, concept learnability, and human capability. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 10932\u201310941, 2023.   \n[52] Marco Tulio Ribeiro, Sameer Singh, and Carlos Guestrin. \" why should i trust you?\" explaining the predictions of any classifier. In Proceedings of the 22nd ACM SIGKDD international conference on knowledge discovery and data mining, pages 1135\u20131144, 2016.   \n[53] Numair Sani, Daniel Malinsky, and Ilya Shpitser. Explaining the behavior of black-box prediction algorithms with causal learning. arXiv preprint arXiv:2006.02482, 2020.   \n[54] David W Scott. Multivariate density estimation: theory, practice, and visualization. John Wiley & Sons, 2015.   \n[55] Ramprasaath R Selvaraju, Michael Cogswell, Abhishek Das, Ramakrishna Vedantam, Devi Parikh, and Dhruv Batra. Grad-cam: Visual explanations from deep networks via gradient-based localization. In Proceedings of the IEEE international conference on computer vision, pages 618\u2013626, 2017.   \n[56] Shalev Shaer, Gal Maman, and Yaniv Romano. Model-x sequential testing for conditional independence via testing by betting. In International Conference on Artificial Intelligence and Statistics, pages 2054\u20132086. PMLR, 2023.   \n[57] Glenn Shafer. Testing by betting: A strategy for statistical and scientific communication. Journal of the Royal Statistical Society Series A: Statistics in Society, 184(2):407\u2013431, 2021.   \n[58] Glenn Shafer and Vladimir Vovk. Game-theoretic foundations for probability and finance, volume 455. John Wiley & Sons, 2019.   \n[59] John Shawe-Taylor and Nello Cristianini. Kernel methods for pattern analysis. Cambridge university press, 2004.   \n[60] Shubhanshu Shekhar and Aaditya Ramdas. Nonparametric two-sample testing by betting. IEEE Transactions on Information Theory, 2023.   \n[61] Tianhong Sheng and Bharath K Sriperumbudur. On distance and kernel measures of conditional dependence. Journal of Machine Learning Research, 24(7):1\u201316, 2023.   \n[62] Pushkar Shukla, Sushil Bharati, and Matthew Turk. Cavli-using image associations to produce local concept-based explanations. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 3749\u20133754, 2023.   \n[63] Amanpreet Singh, Ronghang Hu, Vedanuj Goswami, Guillaume Couairon, Wojciech Galuba, Marcus Rohrbach, and Douwe Kiela. Flava: A foundational language and vision alignment model. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 15638\u201315650, 2022.   \n[64] Le Song, Jonathan Huang, Alex Smola, and Kenji Fukumizu. Hilbert space embeddings of conditional distributions with applications to dynamical systems. In Proceedings of the 26th Annual International Conference on Machine Learning, pages 961\u2013968, 2009.   \n[65] Yang Song, Jascha Sohl-Dickstein, Diederik P Kingma, Abhishek Kumar, Stefano Ermon, and Ben Poole. Score-based generative modeling through stochastic differential equations. arXiv preprint arXiv:2011.13456, 2020.   \n[66] Bharath K Sriperumbudur, Arthur Gretton, Kenji Fukumizu, Bernhard Sch\u00f6lkopf, and Gert RG Lanckriet. Hilbert space embeddings and metrics on probability measures. The Journal of Machine Learning Research, 11:1517\u20131561, 2010.   \n[67] Wesley Tansey, Victor Veitch, Haoran Zhang, Raul Rabadan, and David M Blei. The holdout randomization test for feature selection in black box models. Journal of Computational and Graphical Statistics, 31(1):151\u2013162, 2022.   \n[68] Jacopo Teneggi, Alexandre Luster, and Jeremias Sulam. Fast hierarchical games for image explanations. IEEE Transactions on Pattern Analysis and Machine Intelligence, 45(4):4494\u2013 4503, 2022.   \n[69] Jacopo Teneggi, Beepul Bharti, Yaniv Romano, and Jeremias Sulam. Shap-xrt: The shapley value meets conditional independence testing. Transactions on Machine Learning Research, 2023.   \n[70] Isabella Verdinelli and Larry Wasserman. Feature importance: A closer look at shapley values and loco. arXiv preprint arXiv:2303.05981, 2023.   \n[71] Isabella Verdinelli and Larry Wasserman. Decorrelated variable importance. Journal of Machine Learning Research, 25(7):1\u201327, 2024.   \n[72] Sebastiano Vigna. A weighted correlation index for rankings with ties. In Proceedings of the 24th international conference on World Wide Web, pages 1166\u20131176, 2015.   \n[73] Jean Ville. Etude critique de la notion de collectif. Gauthier-Villars Paris, 1939.   \n[74] Vladimir Vovk and Ruodu Wang. E-values: Calibration, combination and applications. The Annals of Statistics, 49(3):1736\u20131754, 2021.   \n[75] Catherine Wah, Steve Branson, Peter Welinder, Pietro Perona, and Serge Belongie. The caltech-ucsd birds-200-2011 dataset. 2011.   \n[76] Benyou Wang, Qianqian Xie, Jiahuan Pei, Zhihong Chen, Prayag Tiwari, Zhao Li, and Jie Fu. Pre-trained language models in biomedical domain: A systematic survey. ACM Computing Surveys, 56(3):1\u201352, 2023.   \n[77] Ruodu Wang and Aaditya Ramdas. False discovery rate control with e-values. Journal of the Royal Statistical Society Series B: Statistical Methodology, 84(3):822\u2013852, 2022.   \n[78] Zifeng Wang, Zhenbang Wu, Dinesh Agarwal, and Jimeng Sun. Medclip: Contrastive learning from unpaired medical images and text. arXiv preprint arXiv:2210.10163, 2022.   \n[79] Shirley Wu, Mert Yuksekgonul, Linjun Zhang, and James Zou. Discover and cure: Conceptaware mitigation of spurious correlation. In International Conference on Machine Learning, pages 37765\u201337786. PMLR, 2023.   \n[80] Yongqin Xian, Christoph H Lampert, Bernt Schiele, and Zeynep Akata. Zero-shot learning\u2014a comprehensive evaluation of the good, the bad and the ugly. IEEE transactions on pattern analysis and machine intelligence, 41(9):2251\u20132265, 2018.   \n[81] Yue Yang, Artemis Panagopoulou, Shenghao Zhou, Daniel Jin, Chris Callison-Burch, and Mark Yatskar. Language in a bottle: Language model guided concept bottlenecks for interpretable image classification. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 19187\u201319197, 2023.   \n[82] Hao Yuan, Haiyang Yu, Shurui Gui, and Shuiwang Ji. Explainability in graph neural networks: A taxonomic survey. IEEE transactions on pattern analysis and machine intelligence, 45(5): 5782\u20135799, 2022.   \n[83] Mert Yuksekgonul, Maggie Wang, and James Zou. Post-hoc concept bottleneck models. arXiv preprint arXiv:2205.15480, 2022.   \n[84] Kun Zhang, Jonas Peters, Dominik Janzing, and Bernhard Sch\u00f6lkopf. Kernel-based conditional independence test and application in causal discovery. arXiv preprint arXiv:1202.3775, 2012. ", "page_idx": 11}, {"type": "text", "text": "", "page_idx": 12}, {"type": "text", "text": "", "page_idx": 13}, {"type": "text", "text": "", "page_idx": 14}, {"type": "text", "text": "A Testing by Betting ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "In this appendix, we include additional background information on testing by betting that was omitted from the main text for the sake of conciseness of presentation. Recall that the wealth process $\\{K_{t}\\}_{t\\in\\ensuremath{\\mathbb{N}}_{0}}$ with $\\ensuremath{\\mathbb{N}}_{0}:=\\ensuremath{\\mathbb{N}}\\cup\\{0\\}$ is defined as ", "page_idx": 15}, {"type": "equation", "text": "$$\nK_{0}=1\\quad\\mathrm{and}\\quad K_{t}=K_{t-1}\\cdot(1+v_{t}\\kappa_{t})\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "where $v_{t}\\in[-1,1]$ is the betting fraction and $\\kappa_{t}\\in[-1,1]$ the payoff of the bet. ", "page_idx": 15}, {"type": "text", "text": "A.1 Test Martingales ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "We start by introducing the definition of a test martingale (see, for example, Shaer et al. [56]). ", "page_idx": 15}, {"type": "text", "text": "Definition A.1 (Test martingale). A nonnegative stochastic process $\\{S_{t}\\}_{t\\in\\ensuremath{\\mathbb{N}}_{0}}$ is a test martingale if $S_{0}=1$ and, under a null hypothesis $H_{0}$ , it is a supermartingale, i.e. ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\mathbb{E}_{H_{0}}[S_{t}\\ |\\ \\mathcal{F}_{t-1}]\\leq S_{t-1},\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "where $\\mathcal{F}_{t-1}$ is the filtration (i.e., the smallest $\\sigma$ -algebra) of all previous observations. ", "page_idx": 15}, {"type": "text", "text": "In the following, we will use Ville\u2019s inequality, which we include for the sake of completeness. ", "page_idx": 15}, {"type": "text", "text": "Lemma A.1 (Ville\u2019s inequality [73]). If the stochastic process $\\{S_{t}\\}_{t\\in\\ensuremath{\\mathbb{N}}_{0}}$ is a nonnegative supermartingale, ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\mathbb{P}[\\exists t\\geq0:\\,S_{t}\\geq\\eta]\\leq\\mathbb{E}[S_{0}]/\\eta,\\,\\forall\\eta>0.\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "With this, we state a condition under which we can use the wealth process to reject a null hypothesis $H_{0}$ with Type I error control. ", "page_idx": 15}, {"type": "text", "text": "Lemma A.2 (See Shaer et al. [56], Shekhar and Ramdas [60]). If ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\mathbb{E}_{H_{0}}[\\kappa_{t}\\ |\\ \\mathcal{F}_{t-1}]=0,\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "where $\\mathcal{F}_{t-1}$ denotes the flitration (i.e., the smallest $\\sigma$ -algebra) of all previous observations, then the wealth process $\\{K_{t}\\}_{t\\in\\ensuremath{\\mathbb{N}}_{0}}$ describes a fair game and ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\mathbb{P}_{H_{0}}[\\exists t\\ge1:\\,K_{t}\\ge1/\\alpha]\\le\\alpha.\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "Proof. It suffices to show that if $\\mathbb{E}_{H_{0}}[\\kappa_{t}~|~\\mathcal{F}_{t-1}]=0$ , then the wealth process $\\{K_{t}\\}_{t\\in\\ensuremath{\\mathbb{N}}_{0}}$ is a test martingale: ", "page_idx": 15}, {"type": "text", "text": "1. $K_{0}=1$ by definition, and ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "2. It is immediate to see that the wealth process is nonnegative because $v_{t}\\kappa_{t}\\in[-1,1]$ and the bettor never risks more than their current wealth, i.e. they will never go into debt. Finally, ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\begin{array}{r l r l}&{\\mathbb{E}_{H_{0}}[K_{t}\\ |\\ \\mathcal{F}_{t-1}]=\\mathbb{E}_{H_{0}}[K_{t-1}\\cdot(1+v_{t}\\kappa_{t})\\ |\\ \\mathcal{F}_{t-1}]}\\\\ &{\\quad\\quad\\quad\\quad\\quad=K_{t-1}\\cdot\\mathbb{E}_{H_{0}}[1+v_{t}\\kappa_{t}\\ |\\ \\mathcal{F}_{t-1}]}&&{(K_{t-1}\\ |\\ \\mathcal{F}_{t-1}\\ \\mathrm{is\\constant})}\\\\ &{\\quad\\quad\\quad\\quad\\quad\\leq K_{t-1}\\cdot(1+\\mathbb{E}_{H_{0}}[\\kappa_{t}\\ |\\ \\mathcal{F}_{t-1}])}&&{(v_{t}\\leq1)}\\\\ &{\\quad\\quad\\quad\\quad=K_{t-1},}\\end{array}\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "and the wealth process is a supermartingale under the null. ", "page_idx": 15}, {"type": "text", "text": "Then, by Ville\u2019s inequality, we conclude that for any significance level $\\alpha\\in(0,1)$ ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\mathbb{P}_{H_{0}}[\\exists t\\ge1:\\ K_{t}\\ge1/\\alpha]\\le\\alpha\\mathbb{E}[K_{0}]=\\alpha\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "which is the statement of the lemma. ", "page_idx": 15}, {"type": "text", "text": "A.2 Symmetry-based Two-sample Sequential Testing ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "In this section, we show how to leverage symmetry to construct valid sequential tests for a two-sample null hypothesis of the form ", "page_idx": 16}, {"type": "equation", "text": "$$\nH_{0}:\\;P={\\widetilde{P}}.\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "Lemma A.3 (See [49, 56, 60]). $\\forall t\\geq1$ , let $X\\sim P$ and $\\widetilde X\\sim\\widetilde P$ be two random variables sampled from $P$ and $\\widetilde{P}$ , respectively. If $P=\\widetilde{P}$ , it holds that for any fixed function $\\rho_{t}:\\mathcal{X}\\rightarrow\\mathbb{R}$ ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\rho_{t}(X)-\\rho_{t}(\\widetilde X)\\overset{d}{=}\\rho_{t}(\\widetilde X)-\\rho_{t}(X),\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "that is ", "page_idx": 16}, {"type": "equation", "text": "$$\np_{0}(\\rho_{t}(X)-\\rho_{t}(\\widetilde X))=p_{0}(\\rho_{t}(\\widetilde X)-\\rho_{t}(X)),\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "where $p_{0}$ is the probability density function induced by $H_{0}$ . ", "page_idx": 16}, {"type": "text", "text": "Proof. The proof is straightforward. If $P=\\widetilde{P}$ , then $X$ and $\\widetilde{X}$ are exchangeable by assumption. ", "page_idx": 16}, {"type": "text", "text": "Proof of Lemma 2 ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "Recall the lemma states that for any fixed function $\\rho_{t}:\\,\\mathcal{X}\\to\\mathbb{R}$ , the payoff ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\kappa_{t}=\\operatorname{tanh}(\\rho_{t}(X)-\\rho_{t}(\\widetilde{X}))\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "provides a fair game (i.e., it satisfies Lemma A.2) for a two-sample test with null hypothesis $\\overline{{H_{0}}}:\\;P=\\widetilde{P}$ . We use Lemma A.3 above to prove a stronger result that implies the desired claim. ", "page_idx": 16}, {"type": "text", "text": "Lemma A.4 (See [49, 56, 60]). For any $t\\geq1$ , and any fixed anti-symmetric function $\\xi:\\mathbb{R}\\rightarrow\\mathbb{R}_{}$ , it holds that ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\mathbb{E}_{H_{0}}[\\xi(\\rho_{t}(X)-\\rho_{t}(\\widetilde X))\\mid\\mathcal{F}_{t-1}]=0.\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "Proof. We can see that ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\begin{array}{r l r l}&{\\mathbb{E}_{H_{0}}\\big[\\xi(\\rho_{t}(X)-\\rho_{t}(\\tilde{X}))\\mid\\mathcal{F}_{t-1}\\big]=\\mathbb{E}_{H_{0}}\\big[\\xi(\\rho_{t}(X)-\\rho_{t}(\\tilde{X}))\\big]}&&{{\\mathrm{(}}\\rho_{t},\\xi\\mathrm{~are~fixed)}}\\\\ &{\\quad}&{=\\int_{\\mathbb{R}}\\xi(u)p_{0}(u)\\;\\mathrm{d}u}&&{{\\mathrm{(change~of~variables)}}}\\\\ &{\\quad}&{=\\int_{\\mathbb{R}_{+}}(\\xi(u)+\\xi(-u))p_{0}(u)\\;\\mathrm{d}u}&&{{\\mathrm{(by~Lemma~A.3)}}}\\\\ &{\\quad}&{=\\int_{\\mathbb{R}_{+}}(\\xi(u)-\\xi(u))p_{0}(u)\\;\\mathrm{d}u}&&{{\\mathrm{(}}\\xi\\mathrm{~is~anti.}\\mathrm{symmetric})}\\\\ &{\\quad}&{=0,}\\end{array}\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "which concludes the proof. ", "page_idx": 16}, {"type": "text", "text": "Proof of Lemma 2. Note that tanh is an anti-symmetric function, so Lemma A.4 holds. Then, Lemma A.2 implies that $\\kappa_{t}=\\operatorname{tanh}(\\rho_{t}(X)-\\rho_{t}(\\overleftarrow{X}))$ provides a test martingale for $H_{0}:P=\\widetilde{P}$ . ", "page_idx": 16}, {"type": "text", "text": "A.3 Betting Strategies ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "So far, we have discussed how to construct valid test martingales in terms of the payoff $\\kappa_{t}$ . Then, it remains to define a strategy to choose the betting fraction $v_{t}$ . In general, any method that picks $v_{t}$ before data is revealed maintains validity of the test, and we briefly summarize a few alternatives. ", "page_idx": 16}, {"type": "text", "text": "Constant betting fraction. Naturally, a fixed betting fraction $v_{t}=v$ is valid. However, this strategy may be prone to overshooting, i.e. the wealth may go to zero almost surely under the alternative, and severely impact the power of the test [49, Example 2]. ", "page_idx": 16}, {"type": "text", "text": "Mixture method [17, 56]. A possible way to overcome the limitations of setting a fixed betting fraction is to average across a distribution, i.e. ", "page_idx": 16}, {"type": "equation", "text": "$$\nK_{t}=\\int_{\\mathcal{V}}K_{t}^{(v)}p(v)\\;\\mathrm{d}v,\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "where $K_{t}^{(v)}$ is the wealth with constant betting fraction $v_{t}=v$ , and $p(v)$ is a prior over the choice of fractions (e.g., uniform over $[-1,1],$ ). This choice is valid, and motivated by the intuition that the mixture martingale will be driven by the term that achieves the optimal betting fraction [56, Theorem 1]. ", "page_idx": 17}, {"type": "text", "text": "Online Newton step (ONS) [19]. Alternatively, one can frame choosing the betting fraction as an online optimization problem that finds the optimal $v_{t}$ in terms of the regret of the strategy. We refer interested readers to [19, 56, 60] for a theoretical analysis of this strategy and simply state here the wealth\u2019s growth rate. Algorithm A.1 summarizes this strategy. ", "page_idx": 17}, {"type": "text", "text": "Lemma A.5 (See Shekhar and Ramdas [60]). For any sequence $\\{v_{t}\\in[-1,1]:\\ t\\geq1\\}$ , it holds that ", "page_idx": 17}, {"type": "equation", "text": "$$\n\\log K_{t}\\geq\\frac{1}{8t}\\left(\\sum_{t^{\\prime}=1}^{t}v_{t^{\\prime}}\\right)^{2}-\\log t.\n$$", "text_format": "latex", "page_idx": 17}, {"type": "table", "img_path": "A0HSmrwtLH/tmp/b8277f60d881dcb139b1ae61864133377e87e070c035abd2afa33e8db7cd69e8.jpg", "table_caption": [], "table_footnote": [], "page_idx": 17}, {"type": "text", "text": "A.4 Controlling False Discovery Rate ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "Finally, we briefly present one way to provide false discovery rate (FDR) control when testing multiple hypotheses with sequential tests. Given m null hypotheses H0(1 ), $H_{0}^{(1)},\\dots,H_{0}^{(m)}$ , denote $e^{(1)},\\ldots,e^{(m)}$ their respective $e$ -values [58, 74] and let $\\mathcal{E}:\\;[0,\\infty]^{m}\\rightarrow2^{[m]}$ be an $e$ -testing procedure such that $\\widetilde{S}=\\mathcal{E}(e^{(1)},\\cdot\\,.\\,.\\,,e^{(m)})$ is the set of rejected null hypotheses. Then, FDR is the expected proportion of false discoveries to the number of total findings, i.e. ", "page_idx": 17}, {"type": "equation", "text": "$$\n\\mathrm{FDR}:=\\mathbb{E}\\left[\\frac{|\\widetilde{S}\\cap S_{0}|}{|\\widetilde{S}|}\\right],\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "where $S_{0}:=\\{j\\in[m]:\\,H_{0}^{(j)}$ is true $\\}$ is the set of true null hypotheses (i.e., the ones that should not be rejected). Following [8, 77], we say that $\\mathcal{E}$ is self-consistent at level $\\alpha$ if every rejected $e$ -value satisfies $e^{(j)}\\geq m/\\alpha|\\widetilde{S}|$ , and we now state the lemma we use to construct our FDR post-processor in Algorithm A.2. ", "page_idx": 17}, {"type": "text", "text": "Lemma A.6 (See Wang and Ramdas [77]). Any self-consistent e-testing procedure at level \u03b1 controls FDR at level $\\alpha$ for arbitrary configurations of $e$ -values. ", "page_idx": 17}, {"type": "text", "text": "Algorithm A.2 Level- $\\alpha$ greedy FDR post-processor. ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "Input: Wealth processes $\\{K_{t}^{(1)}\\},\\dots,\\{K_{t}^{(m)}\\},t\\in\\mathbb{N}_{0}.$ .   \n1: $\\widetilde S\\gets\\emptyset$   \n2:  for $s=1,\\ldots,m$ do   \n3: $j^{\\prime},\\tau^{\\prime}\\gets$ arg min $\\tau$ s.t. $K_{\\tau}^{(j)}\\geq m/\\alpha s$   \n$j\\!\\in\\![m]\\backslash\\widetilde{S},\\;\\tau\\!\\in\\![0,\\infty]$   \n4: if $\\tau^{\\prime}=\\infty$ then   \n5: return $\\bar{S}$   \n6: end if   \n7: $\\widetilde{S}\\leftarrow\\widetilde{S}\\cup\\{j^{\\prime}\\}$   \n8: end for   \n9: return S ", "page_idx": 17}, {"type": "text", "text": "Recall that the optional stopping theorem implies that for a test martingale $\\{K_{t}\\}_{t\\in\\ensuremath{\\mathbb{N}}_{0}}$ , the wealth $K_{t}$ is an $e$ -value for any $t\\geq1$ . Then, intuitively, Algorithm A.2 transforms an $e$ -testing procedure $\\mathcal{E}$ into a self-consistent one by greedily rejecting concepts as soon as they cross the adjusted threshold $m/\\alpha|\\widetilde{S}|$ . Note that we do not know the number of rejections $a$ priori, and that $m/\\alpha|\\tilde{\\tilde{S}}|$ is a decreasing function of $|\\widetilde{S}|$ . Hence, the adjusted threshold for the first concept will be $m/\\alpha$ (which matches the common Bonferroni correction [9]), $m/2\\alpha$ for the second one, then $m/3\\alpha$ , and so on and so forth. The procedure stops when no more concepts reach the threshold, and concepts are sorted by their adjusted rejection times. We remark that Algorithm A.2 runs in $\\mathcal{O}(m)$ time, and that it does not change the individual testing procedures\u2014which is important because concepts are tested concurrently in practice. ", "page_idx": 18}, {"type": "text", "text": "B Technical Details on Payoff Functions ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "In this appendix, we include technical details on how to compute the payoff functions of all tests presented in this paper. We start with a brief overview of the maximum mean discrepancy (MMD) [29], and we refer interested readers to [1, 4, 59, 66] for rigorous introductions to the theory of reproducing kernel Hilbert spaces (RKHSs) and their applications to probability and statistics. ", "page_idx": 18}, {"type": "text", "text": "Definition B.1 (Mean embedding (see Gretton et al. [29])). Let $P$ be a probability distribution on $\\mathcal{X}$ and $\\mathcal{R}$ an RKHS on the same domain. The mean embedding of $P$ in $\\mathcal{R}$ is the element $\\mu_{P}\\in\\mathcal{R}$ with ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\forall\\rho\\in\\mathcal{R},\\;\\mathbb{E}_{P}[\\rho(X)]=\\langle\\mu_{P},\\rho\\rangle_{\\mathcal{R}}.\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "Furthermore, given $X^{(1)},\\ldots,X^{(n)}$ sampled i.i.d. from $P$ , the plug-in estimate $\\hat{\\mu}_{P}^{(n)}$ is ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\hat{\\mu}_{P}^{(n)}:=\\frac{1}{n}\\sum_{i=1}^{n}\\varphi(X^{(i)}),\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "where $\\varphi$ is the canonical feature map, i.e. $\\varphi(X)=k(X,\\cdot)$ , and $k$ is the kernel associated with $\\mathcal{R}$ . ", "page_idx": 18}, {"type": "text", "text": "We now define the MMD between two probability distributions $P,Q$ and show that it can be rewritten in terms of their mean embeddings. ", "page_idx": 18}, {"type": "text", "text": "Definition B.2 (Integral probability metric (see M\u00fcller [45])). Let $P,Q$ be two probability distributions over $\\mathcal{X}$ . Furthermore, denote ${\\mathcal{G}}=\\{g:\\mathcal{X}\\to\\mathbb{R}\\}$ a hypothesis class of real-valued functions over $\\mathcal{X}$ . Then, ", "page_idx": 18}, {"type": "equation", "text": "$$\nD_{\\mathcal{G}}(P,Q):=\\operatorname*{sup}_{g\\in\\mathcal{G}}\\;|\\mathbb{E}_{P}[g(X)]-\\mathbb{E}_{Q}[g(X)]|\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "is the distance between $P$ and $Q$ induced by $\\mathcal{G}$ , and the function $g^{\\ast}$ that achieves the supremum is called witness function. ", "page_idx": 18}, {"type": "text", "text": "The MMD is defined as $D_{\\mathcal{B}(\\mathcal{R})}(P,Q)$ , where $B({\\mathcal{R}})$ is the unit ball of $\\mathcal{R}$ , i.e. ", "page_idx": 18}, {"type": "equation", "text": "$$\nB({\\mathcal{R}}):=\\{\\rho\\in{\\mathcal{R}}:\\|\\rho\\|_{\\mathcal{R}}\\leq1\\}.\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "Definition B.3 (Maximum mean discrepancy (see Gretton et al. [29])). For $P,Q$ defined as above, let $\\mathcal{R}$ be an RKHS on their domain. Then, ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\mathrm{MMD}(P,Q):=\\operatorname*{sup}_{\\rho\\in{\\mathcal{B}}(\\mathcal{R})}\\;\\mathbb{E}_{P}[\\rho(X)]-\\mathbb{E}_{Q}[\\rho(X)].\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "We note that we drop the absolute value because if $\\rho\\,\\in\\,{\\mathcal{B}}({\\mathcal{R}})$ , then $-\\rho\\in B(\\mathcal{R})$ also. From the definition of mean embedding, it follows that ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbf{M}\\mathbf{M}\\mathbf{D}(P,Q)=\\underset{\\rho\\in\\mathcal{B}(\\mathcal{R})}{\\operatorname*{sup}}\\;\\;\\langle\\mu_{P},\\rho\\rangle_{\\mathcal{R}}-\\langle\\mu_{Q},\\rho\\rangle_{\\mathcal{R}}}\\\\ &{\\quad\\quad\\quad\\quad=\\underset{\\rho\\in\\mathcal{B}(\\mathcal{R})}{\\operatorname*{sup}}\\;\\;\\langle\\mu_{P}-\\mu_{Q},\\rho\\rangle}\\\\ &{\\quad\\quad\\quad\\quad=\\lVert\\mu_{P}-\\mu_{Q}\\rVert_{\\mathcal{R}},}\\end{array}\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "and its witness function satisfies ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\rho^{*}\\propto\\mu_{P}-\\mu_{Q}.\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "Input: Stream $(\\hat{Y}^{(t)},Z_{j}^{(t)})\\sim P_{\\hat{Y}Z_{j}}$   \n1: $K_{0}\\gets1$   \n2: Initialize ONS strategy as in Algorithm A.1.   \n3: for $t=1,\\ldots$ do   \n4: Compute $\\rho_{t}$ as in Eq. (47)   \n5: Observe $\\begin{array}{r l}&{\\dot{D}^{(2t-1)}=\\ \\stackrel{*}{(\\dot{Y}^{(2t-1)},Z_{j}^{(2t-1)})}\\quad\\mathrm{and}\\quad D^{(2t)}=(\\hat{Y}^{(2t)},Z_{j}^{(2t)})}\\\\ &{\\leftarrow(\\hat{Y}_{\\mathrm{~\\tiny~{~r~}~}}^{(2t-1)},Z_{j}^{(2t)})\\quad\\mathrm{~and~}\\quad\\widetilde{D}^{(2t)}\\leftarrow(\\hat{Y}^{(2t)},Z_{j}^{(2t-1)})}\\end{array}$   \n6:   \n7: Compute $\\kappa_{t}$ as in Eq. (48)   \n8: $K_{t}\\gets K_{t-1}\\cdot(1+v_{t}\\kappa_{t})$   \n9: if $K_{t}\\ge1/\\alpha$ then   \n10: return $t$   \n11: end if   \n12: $v_{t+1}\\leftarrow\\mathrm{ONS}$ step   \n13: end for ", "page_idx": 19}, {"type": "text", "text": "B.1 Computing $\\rho_{t}^{\\bf S K I T}$ and $\\kappa_{t}^{\\mathbf{SKIT}}$ ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "Recall that $\\rho_{t}^{\\mathrm{SKIT}}$ is the estimate of the witness function of $\\mathrm{MMD}(P_{\\hat{Y}Z_{j}},P_{\\hat{Y}}\\times P_{Z_{j}})$ at time $t$ , i.e. ", "page_idx": 19}, {"type": "equation", "text": "$$\n\\rho_{t}^{\\mathrm{SKIT}}=\\hat{\\mu}_{\\hat{Y}Z_{j}}^{(2(t-1))}-\\hat{\\mu}_{\\hat{Y}}^{(2(t-1))}\\otimes\\hat{\\mu}_{Z_{j}}^{(2(t-1))},\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "where ", "page_idx": 19}, {"type": "equation", "text": "$$\n\\hat{\\mu}_{\\hat{Y}Z_{j}}^{(2(t-1))}=\\frac{1}{2(t-1)}\\sum_{t^{\\prime}=0}^{2(t-1)}(\\varphi_{\\hat{Y}}(\\hat{Y}^{(t^{\\prime})})\\otimes\\varphi_{Z_{j}}(Z_{j}^{(t^{\\prime})})),\n$$", "text_format": "latex", "page_idx": 19}, {"type": "equation", "text": "$$\n\\hat{\\mu}_{\\hat{Y}}^{(2(t-1))}=\\frac{1}{t-1}\\sum_{t^{\\prime}=0}^{2(t-1)}\\varphi_{\\hat{Y}}(\\hat{Y}^{(t^{\\prime})}),\\qquad\\qquad\\hat{\\mu}_{Z_{j}}^{(2(t-1))}=\\frac{1}{t-1}\\sum_{t^{\\prime}=0}^{2(t-1)}\\varphi_{Z_{j}}(Z_{j}^{(t^{\\prime})}),\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "and $\\varphi_{\\hat{Y}},\\varphi_{Z j}$ are the canonical feature maps associated with $\\mathcal{R}_{\\hat{Y}}$ and $\\mathcal{R}_{Z_{j}}$ , respectively. We remark that \u03c1tS $\\rho_{t}^{\\mathrm{SKIT}}$ is an operator, and, for a sample $(\\hat{y},z_{j})$ , its value $\\rho_{t}^{\\mathrm{SKIT}}(\\hat{y},z_{j})$ can be computed as ", "page_idx": 19}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\rho_{t}^{\\mathrm{SKIT}}(\\hat{y},z_{j})=(\\hat{\\mu}_{\\hat{Y}Z_{j}}^{(2(t-1))}-\\hat{\\mu}_{\\hat{Y}}^{(2(t-1))}\\otimes\\hat{\\mu}_{Z_{j}}^{(2(t-1))})(\\hat{y},z_{j})}\\\\ &{\\qquad\\qquad\\qquad=\\hat{\\mu}_{\\hat{Y}Z_{j}}^{(2(t-1))}(\\hat{y},z_{j})-(\\hat{\\mu}_{\\hat{Y}}^{(2(t-1))}\\otimes\\hat{\\mu}_{Z_{j}}^{(2(t-1))})(\\hat{y},z_{j})}\\end{array}\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "with ", "page_idx": 19}, {"type": "equation", "text": "$$\n\\begin{array}{c}{{\\displaystyle\\hat{\\mu}_{\\hat{Y}Z_{j}}^{(2(t-1))}(\\hat{y},z_{j})=\\frac{1}{2(t-1)}\\sum_{t^{\\prime}=0}^{2(t-1)}k_{\\hat{Y}}(\\hat{Y}^{(t^{\\prime})},\\hat{y})k_{Z_{j}}(Z_{j}^{(t^{\\prime})},z_{j})}}\\\\ {{(\\hat{\\mu}_{\\hat{Y}}^{(2(t-1))}\\otimes\\hat{\\mu}_{Z_{j}}^{(2(t-1))})(\\hat{y},z_{j})=\\frac{1}{2(t-1)}\\left[\\displaystyle\\sum_{t^{\\prime}=0}^{2(t-1)}k_{\\hat{Y}}(\\hat{Y}^{(t^{\\prime})},\\hat{y})\\cdot\\displaystyle\\sum_{t^{\\prime}=0}^{2(t-1)}k_{Z_{j}}(Z_{j}^{(t^{\\prime})},z_{j})\\right],}}\\end{array}\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "where $k_{\\hat{Y}},k_{Z_{j}}$ are the kernels associated with $\\mathcal{R}_{\\hat{Y}}$ and $\\mathcal{R}_{Z_{j}}$ , respectively. ", "page_idx": 19}, {"type": "text", "text": "Furthermore, note that, in practice, we only have access to samples from the test distribution $P_{\\hat{Y}Z_{j}}$ (i.e., the joint) and we swap elements of two consecutive samples to simulate data from the null distribution $P_{\\hat{Y}}\\times P_{Z_{j}}$ . More formally, let ", "page_idx": 19}, {"type": "equation", "text": "$$\nD^{(2t)}=(\\hat{Y}^{(2t)},Z_{j}^{(2t)})\\sim P_{\\hat{Y}Z_{j}},\\quad\\quad\\quad\\quad D^{(2t-1)}=(\\hat{Y}^{(2t-1)},Z_{j}^{(2t-1)})\\sim P_{\\hat{Y}Z_{j}}\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "such that ", "page_idx": 19}, {"type": "equation", "text": "$$\n\\widetilde{D}^{(2t)}=(\\hat{Y}^{(2t)},Z_{j}^{(2t-1)}),\\qquad\\qquad\\qquad\\widetilde{D}^{(2t-1)}=(\\hat{Y}^{(2t-1)},Z_{j}^{(2t)}).\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "Then, ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\rho_{t}^{\\mathrm{SKIT}}:=\\hat{\\mu}_{\\hat{Y}Z_{j}}^{(2(t-1))}-\\hat{\\mu}_{\\hat{Y}}^{(2(t-1))}\\otimes\\hat{\\mu}_{Z_{j}}^{(2(t-1))}\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "where $\\hat{\\mu}_{\\hat{Y}Z_{j}},\\hat{\\mu}_{\\hat{Y}},\\hat{\\mu}_{Z j}$ are the mean embeddings of $P_{\\hat{Y}Z_{j}},P_{\\hat{Y}},P_{Z_{j}}$ in $\\mathcal{R}_{\\hat{Y}}\\otimes\\mathcal{R}_{Z_{j}}$ , $\\mathcal{R}_{\\hat{Y}}$ , and $\\mathcal{R}_{Z_{j}}$ , respectively, and $\\otimes$ is the tensor product as in Gretton et al. [29]. We remark that $\\rho_{t}^{\\mathrm{SKIT}}$ is a real-valued operator, i.e. $\\rho_{t}^{\\mathrm{SKIT}}:\\;\\mathbb{R}\\times\\mathbb{R}\\to\\bar{\\mathbb{R}},$ , and that we use data up to $t-1$ to compute $\\rho_{t}$ in order to maintain validity of the test, i.e. $\\rho_{t}$ is fixed conditionally on previous observations. ", "page_idx": 20}, {"type": "text", "text": "Following Lemma 2, we conclude ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\kappa_{t}^{\\mathrm{SKIT}}:=\\operatorname{tanh}\\left(\\rho_{t}^{\\mathrm{SKIT}}(D^{(2t-1)})+\\rho_{t}^{\\mathrm{SKIT}}(D^{(2t)})-\\rho_{t}^{\\mathrm{SKIT}}(\\widetilde{D}^{(2t-1)})-\\rho_{t}^{\\mathrm{SKIT}}(\\widetilde{D}^{(2t)})\\right)\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "and Algorithm B.1 summarizes the SKIT procedure for the global semantic importance null hypothesis $H_{0,j}^{\\mathrm{G}}$ in Definition 1. ", "page_idx": 20}, {"type": "text", "text": "B.2 Computing $\\rho_{t}^{\\mathbf{C}-\\mathbf{SKIT}}$ and $\\kappa_{t}^{\\mathbf{c}}$ -SKIT ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Recall that $\\rho_{t}^{\\mathrm{{C-SKIT}}}$ is the estimate of the witness function of $\\mathrm{MMD}(P_{\\hat{Y}Z_{j}Z_{-j}},P_{\\hat{Y}\\widetilde{Z}_{j}Z_{-j}})$ with $\\widetilde{Z}_{j}\\sim$ $P_{Z_{j}\\mid Z_{-j}}$ at time $t$ , i.e. ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\rho_{t}^{\\mathrm{C-SKIT}}=\\hat{\\mu}_{\\hat{Y}Z_{j}Z_{-j}}^{(t-1)}-\\hat{\\mu}_{\\hat{Y}\\tilde{Z}_{j}Z_{-j}}^{(t-1)},\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "where ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\begin{array}{l}{{\\displaystyle\\hat{\\mu}_{\\hat{Y}Z_{j}Z_{-j}}^{(t-1)}=\\frac{1}{t-1}\\sum_{t^{\\prime}=0}^{t-1}\\left(\\varphi_{\\hat{Y}}(\\hat{Y}^{(t^{\\prime})})\\otimes\\varphi_{Z_{j}}(Z_{j}^{(t^{\\prime})})\\otimes\\varphi_{Z_{-j}}(Z_{-j}^{(t^{\\prime})})\\right)}}\\\\ {{\\displaystyle\\hat{\\mu}_{\\hat{Y}\\tilde{Z}_{j}Z_{-j}}^{(t-1)}=\\frac{1}{t-1}\\sum_{t^{\\prime}=0}^{t-1}\\left(\\varphi_{\\hat{Y}}(\\hat{Y}^{(t^{\\prime})})\\otimes\\varphi_{Z_{j}}(\\tilde{Z}_{j}^{(t^{\\prime})})\\otimes\\varphi_{Z_{-j}}(Z_{-j}^{(t^{\\prime})})\\right)}}\\end{array}\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "and $\\varphi_{\\hat{Y}},\\varphi_{Z_{j}},\\varphi_{Z_{-j}}$ are the canonical feature maps associated with their respective RKHSs. We remark that $\\rho_{t}^{\\mathrm{C-SKIT}}$ is defined as an operator, and, for a triplet $(\\hat{y},z_{j},z_{-j})$ its value can be computed as ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\rho_{t}^{\\mathrm{c-SKIT}}(\\hat{y},z_{j},z_{-j})=(\\hat{\\mu}_{\\hat{Y}Z_{j}Z_{-j}}^{(t-1)}-\\hat{\\mu}_{\\hat{Y}\\tilde{Z}_{j}Z_{-j}}^{(t-1)})(\\hat{y},z_{j},z_{-j})}\\\\ &{\\qquad\\qquad\\qquad\\qquad=\\hat{\\mu}_{\\hat{Y}Z_{j}Z_{-j}}^{(t-1)}(\\hat{y},z_{j},z_{-j})-\\hat{\\mu}_{\\hat{Y}\\tilde{Z}_{j}Z_{-j}}^{(t-1)}(\\hat{y},z_{j},z_{-j})}\\end{array}\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "with ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\begin{array}{l}{{\\displaystyle\\hat{\\mu}_{\\hat{Y}Z_{j}Z_{-j}}^{(t-1)}(\\hat{y},z_{j},z_{-j})=\\frac{1}{t-1}\\sum_{t^{\\prime}=0}^{t-1}k_{\\hat{Y}}(\\hat{Y}^{(t^{\\prime})},y)k_{Z_{j}}(Z_{j}^{(t^{\\prime})},z_{j})k_{Z_{-j}}(Z_{-j}^{(t^{\\prime})},z_{-j})}}\\\\ {{\\displaystyle\\hat{\\mu}_{\\hat{Y}\\tilde{Z}_{j}Z_{-j}}^{(t-1)}(\\hat{y},z_{j},z_{-j})=\\frac{1}{t-1}\\sum_{t^{\\prime}=0}^{t-1}k_{\\hat{Y}}(\\hat{Y}^{(t^{\\prime})},y)k_{Z_{j}}(\\tilde{Z}_{j}^{(t^{\\prime})},z_{j})k_{Z_{-j}}(Z_{-j}^{(t^{\\prime})},z_{-j})}}\\end{array}\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "where $k_{\\hat{Y}},k_{Z_{j}},k_{Z_{-j}}$ are the kernels associated with $\\mathcal{R}_{\\hat{Y}},\\mathcal{R}_{Z_{j}}$ , and $\\mathcal{R}_{Z_{-j}}$ , respectively. Following Lemma 2, we conclude ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\kappa_{t}^{\\mathrm{c-SKIT}}:=\\operatorname{tanh}(\\rho_{t}^{\\mathrm{c-SKIT}}(\\hat{Y},Z_{j},Z_{-j})-\\rho_{t}^{\\mathrm{c-SKIT}}(\\hat{Y},\\widetilde{Z}_{j},Z_{-j})).\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "B.3 Computing $\\rho_{t}^{\\mathbf{X-SKIT}}$ Tand \u03batX-SKIT ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Recall that, for a particular sample $z$ , a concept $j\\in[m]$ , and a subset $S\\subseteq[m]\\setminus\\{j\\}$ that does not contain j, $\\rho_{t}^{\\mathrm{X-SKIT}}$ is the estimate\u2014at time $t$ \u2014of the witness function of $\\mathbf{MMD}(\\hat{Y}_{S\\cup\\{j\\}},\\hat{Y}_{S})$ with $\\hat{Y}_{C}=g(\\widetilde{H}_{C})$ , $\\widetilde{H}_{C}\\sim P_{H|Z_{C}=z_{C}}$ , i.e. ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\rho_{t}^{\\mathrm{x-SKIT}}=\\hat{\\mu}_{\\hat{Y}_{S\\cup\\{j\\}}}^{(t-1)}-\\hat{\\mu}_{\\hat{Y}_{S}}^{(t-1)},\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "where ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\hat{\\mu}_{\\hat{Y}_{S\\cup\\{j\\}}}^{(t-1)}=\\frac{1}{t-1}\\sum_{t^{\\prime}=0}^{t-1}\\varphi_{\\hat{Y}}(\\hat{Y}_{S\\cup\\{j\\}}^{(t^{\\prime})}),\\qquad\\qquad\\hat{\\mu}_{\\hat{Y}_{S}}^{(t-1)}=\\frac{1}{t-1}\\sum_{t^{\\prime}=0}^{t-1}\\varphi_{\\hat{Y}}(\\hat{Y}_{S}^{(t^{\\prime})}),\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "and $\\varphi_{\\hat{Y}}$ is the canonical feature map of $\\mathcal{R}_{\\hat{Y}}$ . Then, for a prediction $\\hat{y}$ , the value of $\\rho_{t}^{\\mathrm{X-SKIT}}$ is ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\rho_{t}^{\\mathrm{X-SKIT}}(\\hat{y})=\\big(\\hat{\\mu}_{\\hat{Y}_{S\\cup\\{j\\}}}^{(t-1)}-\\hat{\\mu}_{\\hat{Y}_{S}}^{(t-1)}\\big)(\\hat{y})}\\\\ &{\\qquad\\qquad=\\hat{\\mu}_{\\hat{Y}_{S\\cup\\{j\\}}}^{(t-1)}(\\hat{y})-\\hat{\\mu}_{\\hat{Y}_{S}}^{(t-1)}(\\hat{y})}\\\\ &{\\qquad\\qquad=\\displaystyle\\frac{1}{t-1}\\left[\\sum_{t^{\\prime}=0}^{t-1}k_{\\hat{Y}}({\\hat{Y}_{S\\cup\\{j\\}}^{(t^{\\prime})}},\\hat{y})-\\sum_{t^{\\prime}=0}^{t-1}k_{\\hat{Y}}(\\hat{Y}_{S}^{(t^{\\prime})},\\hat{y})\\right],}\\end{array}\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "where $k_{\\hat{Y}}$ is the kernel associated with $\\mathcal{R}_{\\hat{Y}}$ ", "page_idx": 21}, {"type": "text", "text": "To conclude, applying Lemma 2 implies ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\kappa_{t}^{\\mathrm{x-SKIT}}:=\\operatorname{tanh}(\\rho_{t}^{\\scriptscriptstyle\\mathrm{X-SKIT}}(\\hat{Y}_{S\\cup\\{j\\}})-\\rho_{t}^{\\scriptscriptstyle\\mathrm{X-SKIT}}(\\hat{Y}_{S})).\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "C Proofs ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "In this appendix, we include the proofs of the results presented in this paper. ", "page_idx": 21}, {"type": "text", "text": "C.1 Proof of Lemma 1 ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "Recall that $c\\in\\mathbb{R}^{d\\times m}$ is a dictionary of $m$ concepts such that $c_{j}$ , $j\\in[m]$ is the vector representation of the $j^{\\mathrm{th}}$ concept. Then, $Z=\\langle c,H\\rangle$ is the vector where\u2014after appropriate normalization\u2014 $Z_{j}\\in$ $[-1,1]$ represents the amount of concept $j$ in $h$ . ", "page_idx": 21}, {"type": "text", "text": "We want to show that if $\\hat{Y}=\\langle w,H\\rangle$ , $w\\in\\mathbb{R}^{d}$ , and $d\\geq3$ , then ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\hat{Y}\\bot\\!\\!\\!\\perp Z_{j}\\Longleftrightarrow\\langle w,c_{j}\\rangle=0.\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "That is, $w$ being orthogonal to $c_{j}$ does not provide any information about the statistical dependence between $\\hat{Y}$ and $Z_{j}$ , and vice versa. ", "page_idx": 21}, {"type": "text", "text": "Proof. Herein, for the sake of simplicity, we will drop the $c_{j}$ notation and consider a single concept $c$ . Furthermore, we will assume that all vectors are normalized, i.e. $\\left\\|w\\right\\|=\\left\\|h\\right\\|=\\left\\|c\\right\\|^{2}=1$ . Note that the Eq. (63) above can directly be rewritten as ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\langle w,H\\rangle\\bot\\langle c,H\\rangle\\nleftrightarrow\\langle w,c\\rangle=0.\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "( $\\nLeftarrow$ ) We show there exist random vectors $H$ such that $\\langle w,c\\rangle=0$ but $\\langle w,H\\rangle$ \u0338\u22a5\u22a5 $\\langle c,H\\rangle$ . ", "page_idx": 21}, {"type": "text", "text": "Let $H\\,\\sim\\,\\mathcal{U}(\\mathbb{S}^{d})$ , i.e. $H\\;=\\;[H_{1},...,H_{d}]$ is sampled uniformly over the sphere in $d$ dimensions. It is easy to see that $\\forall j\\in[d]$ , $\\dot{H_{j}}=\\langle\\bar{e}_{j},H\\rangle$ , where $e_{j}$ is the $j^{\\mathrm{th}}$ element of the standard basis. Furthermore, it holds that $\\begin{array}{r}{H_{j}=\\sqrt{1-\\sum_{j^{\\prime}\\neq j}H_{j^{\\prime}}^{2}}}\\end{array}$ by definition. We conclude that $\\forall(j,j^{\\prime})$ , let $w=e_{j}$ and $c=e_{j^{\\prime}}$ , then $\\langle w,c\\rangle=0$ but $\\langle w,H\\rangle$ \u0338\u22a5\u22a5 $\\langle c,H\\rangle$ . That is, the fact that $e_{j}$ and $e_{j^{\\prime}}$ are orthogonal does not mean that their respective projections of $H$ are statistically independent. ", "page_idx": 21}, {"type": "text", "text": "$(\\nRightarrow$ ) We show how to construct a random vector $H$ such that $\\langle w,H\\rangle$ \u22a5\u22a5 $\\langle c,H\\rangle$ but $\\langle w,c\\rangle\\neq0$ . ", "page_idx": 21}, {"type": "text", "text": "Denote $\\mathcal{H}_{\\eta}:=\\{h\\in\\mathbb{S}^{d}:\\ \\langle c,h\\rangle=\\eta,\\ \\eta\\neq0\\}$ the linear subspace of unit vectors in $\\mathbb{R}^{d}$ with the same nonzero inner product with $c$ . Each vector $h\\in\\mathcal{H}_{\\eta}$ can be decomposed into a parallel and an orthogonal component to $c$ , i.e. $\\forall h\\in\\mathcal{H}_{\\eta}$ , $h=\\dot{h_{c}}+h_{\\perp}=\\eta c+h_{\\perp}$ , where the last equality follows by definition of $\\mathcal{H}_{\\eta}$ . ", "page_idx": 21}, {"type": "text", "text": "Consider $\\mathcal{H}_{\\eta}$ and $\\mathcal{H}_{-\\eta}$ , it follows that for $w,h^{+}\\in\\mathcal{H}_{\\eta}$ and $h^{-}\\in\\mathcal{H}_{-\\eta}$ ", "page_idx": 22}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\langle w,h^{+}\\rangle=\\langle w,h^{-}\\rangle\\iff\\langle\\eta c+w_{\\perp},\\eta c+h_{\\perp}^{+}\\rangle=\\langle\\eta c+w_{\\perp},-\\eta c+h_{\\perp}^{-}\\rangle}\\\\ &{\\iff\\eta^{2}+\\langle w_{\\perp},h_{\\perp}^{+}\\rangle=-\\eta^{2}+\\langle w_{\\perp},h_{\\perp}^{-}\\rangle}\\\\ &{\\iff\\langle w_{\\perp},h_{\\perp}^{+}-h_{\\perp}^{-}\\rangle=-2\\eta^{2}}\\\\ &{\\iff\\langle w_{\\perp},\\Delta\\rangle=-2\\eta^{2}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "Denote $\\begin{array}{r}{S=\\{(h^{+},h^{-}):\\:\\langle w_{\\perp},\\Delta\\rangle=-2\\eta^{2}\\}}\\end{array}$ the set of pairs of vector that satisfy Eq. (68), and note that for each pair $(h^{+},h^{-})$ there exists a value $\\beta$ such that $\\left\\langle w,h^{+}\\right\\rangle=\\left\\langle w\\bar{,}h^{-}\\right\\rangle=\\beta$ . Then, sampling from $\\boldsymbol{S}$ is equivalent to sampling from the set of pairs of vectors in $\\mathcal{H}_{\\eta}$ and $\\mathcal{H}_{-\\eta}$ that attain the same correlation with $w$ . ", "page_idx": 22}, {"type": "text", "text": "Note that when $d\\,=\\,2$ , $h_{\\perp}^{+},h_{\\perp}^{-}\\,\\in\\,\\{\\pm w_{\\perp}\\}$ by construction, hence $\\Delta\\,\\in\\,\\{0,\\pm2w_{\\perp}\\}$ and $\\langle w_{\\perp},\\Delta\\rangle\\in\\{0,\\pm2(1-\\eta^{2})\\}$ . Then, ${\\mathcal{S}}=\\emptyset$ because there are no pairs of vectors such that $\\langle w_{\\perp},\\Delta\\rangle=-2\\eta^{2}$ . For $d\\geq3$ , $\\boldsymbol{S}$ is nonempty as long as $\\eta\\le\\sqrt{1/2}$ . ", "page_idx": 22}, {"type": "text", "text": "Then, we can construct $H$ as follows: ", "page_idx": 22}, {"type": "text", "text": "\u2013 Sample the component parallel to $c$ , i.e. $H_{c}\\sim\\mathcal{U}(\\pm\\eta c)$ , \u2013 Sample the component orthogonal to $c$ , i.e. $(H_{\\bot}^{+},H_{\\bot}^{-})\\sim\\mathcal{U}(S),$ , and note that by doing so, we have sampled $\\langle c,H\\rangle$ and $\\langle w,H\\rangle$ independently. Finally ", "page_idx": 22}, {"type": "text", "text": "", "page_idx": 22}, {"type": "equation", "text": "$$\nH=\\left\\{H_{c}+H_{\\perp}^{+}\\quad\\mathrm{if~}H_{c}=\\eta c\\right.}\\\\ {H_{c}+H_{\\perp}^{-}\\quad\\mathrm{if~}H_{c}=-\\eta c}\\end{array}\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "has $\\langle w,H\\rangle$ \u22a5\u22a5 $\\langle c,H\\rangle$ by construction, but, since $w\\in\\mathcal{H}_{\\eta}$ , $\\langle w,c\\rangle=\\eta\\neq0$ . ", "page_idx": 22}, {"type": "text", "text": "This concludes the proof of the lemma. ", "page_idx": 22}, {"type": "text", "text": "C.2 Proof of Proposition 1 ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Recall that Proposition 1 states that the payoff function ", "page_idx": 22}, {"type": "equation", "text": "$$\n\\kappa_{t}^{\\mathrm{c-SKIT}}=\\operatorname{tanh}(\\rho_{t}^{\\mathrm{c-SKIT}}(\\hat{Y},Z_{j},Z_{-j})-\\rho_{t}^{\\mathrm{c-SKIT}}(\\hat{Y},\\widetilde{Z}_{j},Z_{-j}))\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "provides a fair game for the global conditional semantic importance null hypothesis $H_{0,j}^{\\mathrm{GC}}$ in Definition 2. That is, the wealth process provides Type I error control. ", "page_idx": 22}, {"type": "text", "text": "Proof. Note that $H_{0,j}^{\\mathrm{GC}}$ can be directly rewritten as ", "page_idx": 22}, {"type": "equation", "text": "$$\nH_{0,j}^{\\mathrm{GC}}:\\;P_{\\hat{Y}Z_{j}Z_{-j}}=P_{\\hat{Y}\\tilde{Z}_{j}Z_{-j}}\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "where $\\widetilde{Z}_{j}\\sim P_{Z_{j}|Z_{-j}}$ . Then, under the null, the triplets $(\\hat{Y},Z_{j},Z_{-j})$ and $(\\hat{Y},\\tilde{Z}_{j},Z_{-j})$ are exchangeable by assumption, and the result follows from Lemma 2. ", "page_idx": 22}, {"type": "text", "text": "C.3 Proof of Proposition 2 ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Recall that Proposition 2 claims that a wealth process with ", "page_idx": 22}, {"type": "equation", "text": "$$\n\\kappa_{t}^{\\mathrm{x-SKIT}}=\\operatorname{tanh}(\\rho_{t}^{\\scriptscriptstyle\\mathrm{X-SKIT}}(\\hat{Y}_{S\\cup\\{j\\}})-\\rho_{t}^{\\scriptscriptstyle\\mathrm{X-SKIT}}(\\hat{Y}_{S}))\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "can be used to reject the local conditional semantic importance $H_{0,j,S}^{\\mathrm{LC}}$ in Definition 3 with Type I error control, i.e. the game is fair. ", "page_idx": 22}, {"type": "text", "text": "Proof. It is easy to see that $H_{0,j,S}^{\\mathrm{LC}}$ is already written as a two-sample test. Then, under this null, $\\hat{Y}_{S\\cup\\{j\\}}$ and ${\\hat{Y}}_{S}$ are exchangeable by assumption, and Lemma 2 implies the statement of the proposition. \u53e3 ", "page_idx": 22}, {"type": "image", "img_path": "A0HSmrwtLH/tmp/c7c9b294e14bb67b3ac78f59c02be1de7a3cf145beca08ec4bc397aeb46045e7.jpg", "img_caption": ["Figure D.1: Pictorial representation of the data-generating process for the synthetic dataset. "], "img_footnote": [], "page_idx": 23}, {"type": "text", "text": "D Synthetic Experiments ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "In this section, we showcase the main properties of our tests on two synthetic datasets. ", "page_idx": 23}, {"type": "text", "text": "D.1 Gaussian Data ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "We start by illustrating all sequential tests presented in this work are valid, and that they adapt to the hardness of the problem, i.e. the weaker the dependence structure, the longer their rejection times. We devise a synthetic dataset with a nonlinear response such that all distributions are known and we can sample from the exact conditional distribution. ", "page_idx": 23}, {"type": "text", "text": "The data-generating process we consider is defined as ", "page_idx": 23}, {"type": "equation", "text": "$$\n\\begin{array}{r l r}{Z_{1}\\sim{\\mathcal N}(\\mu_{1},\\sigma_{1}^{2})}&{{}\\quad\\quad\\quad}&{\\mu_{1}=1,\\sigma_{1}=1}\\\\ {Z_{2}\\sim{\\mathcal N}(\\mu_{2},\\sigma_{2}^{2})}&{{}\\quad\\quad\\quad}&{\\mu_{2}=-1,\\sigma_{2}=1}\\\\ {Z_{3}\\mid Z_{1}\\sim{\\mathcal N}(Z_{1},\\sigma_{3}^{2})}&{{}\\quad\\quad\\quad}&{\\sigma_{3}=1}\\end{array}\n$$", "text_format": "latex", "page_idx": 23}, {"type": "text", "text": "and ", "page_idx": 23}, {"type": "equation", "text": "$$\nY\\mid Z\\sim S(\\beta_{1}Z_{1}+\\beta_{2}Z_{2}Z_{3}+\\beta_{3}Z_{3})+\\epsilon,\n$$", "text_format": "latex", "page_idx": 23}, {"type": "text", "text": "where $S$ is the sigmoid function, $\\epsilon\\sim\\mathcal{N}(0,\\sigma_{0}^{2})$ , $\\sigma_{0}=0.01$ is independent Gaussian noise, and $\\beta_{i}$ , $i={1,2,3}$ are coefficients that will allow us to test different conditions. Then, it follows that ", "page_idx": 23}, {"type": "equation", "text": "$$\ng(z)=\\mathbb{E}[Y\\mid Z=z]=S(\\beta_{1}z_{1}+\\beta_{2}z_{2}z_{3}+\\beta_{3}z_{3})\n$$", "text_format": "latex", "page_idx": 23}, {"type": "text", "text": "and ", "page_idx": 23}, {"type": "equation", "text": "$$\nZ_{1}\\mid Z_{3}\\sim{\\mathcal{N}}\\left({\\frac{\\sigma_{1}^{2}}{\\sigma_{1}^{2}+\\sigma_{3}^{2}}}Z_{3}+{\\frac{\\sigma_{3}^{2}}{\\sigma_{1}^{2}+\\sigma_{3}^{2}}}\\mu_{1},\\left({\\frac{1}{\\sigma_{1}^{2}}}+{\\frac{1}{\\sigma_{3}^{2}}}\\right)^{-1}\\right).\n$$", "text_format": "latex", "page_idx": 23}, {"type": "text", "text": "Fig. D.1 depicts the data-generating process. We remark that, for this experiment, we assume there exists a known parametric relation between the response $Y$ and the concepts $Z$ . This is only to verify our tests retrieve the ground-truth structure, and our contributions do not rely on this assumption. With this data-generating process, it holds that: ", "page_idx": 23}, {"type": "text", "text": "1. If $\\beta_{2}=0$ then $Y\\bot Z_{2}$ ,   \n2. If $\\beta_{1}=0$ then $Y\\bot\\bot Z_{1}\\mid Z_{-1}$ , and   \n3. For an observation $Z=z$ , if $z_{3}=0$ then $g(\\widetilde{Z}_{\\{2,3\\}})\\stackrel{d}{=}g(\\widetilde{Z}_{3})$ with $\\widetilde{Z}_{C}\\sim P_{Z|Z_{C}=z_{C}}.$ . ", "page_idx": 23}, {"type": "text", "text": "We test each condition with SKIT, C-SKIT, and $\\mathrm{X}$ -SKIT, respectively. We use both a linear and RBF kernel with bandwidth set to the median pairwise distance between all previous observations (commonly referred to as the median heuristic [27]). For each test, we estimate the rejection rate (i.e., how often a test rejects), and the expected rejection time (i.e., how many steps of the test it takes to reject) over 100 draws of $\\tau^{\\mathrm{max}}=1000$ samples, and with a significance level $\\alpha=0.05$ . We remark that a normalized rejection time of 1 means failing to reject in $\\tau^{\\mathrm{max}}$ steps. ", "page_idx": 23}, {"type": "text", "text": "D.1.1 Global Importance with SKIT ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "First, we test that ", "page_idx": 23}, {"type": "equation", "text": "$$\n\\beta_{2}=0\\implies Y\\bot\\bot Z_{2}\n$$", "text_format": "latex", "page_idx": 23}, {"type": "image", "img_path": "A0HSmrwtLH/tmp/525b779d5c4e4db0ca7b26164d7e02db80f805457dcfb2a942642612b1389db0.jpg", "img_caption": ["Figure D.2: Global importance results for $H_{0}:Y$ \u22a5\u22a5 $Z_{2}$ with SKIT. (a) Marginal distributions of $Y$ and $Z_{2}$ for $\\beta_{2}=1$ and 0, respectively. The red dashed line is the linear regression between the two variables, and, as expected, the slope is $\\approx0$ for $\\beta_{2}=0$ . (b) Mean rejection rate and mean rejection time for SKIT with a linear and RBF kernel, as a function of $\\beta_{2}$ . "], "img_footnote": [], "page_idx": 24}, {"type": "image", "img_path": "A0HSmrwtLH/tmp/946e60a37f2b52633aa2332cfe6e1d8fafe431d2eaad44f5acf3f84782e43a6e.jpg", "img_caption": ["Figure D.3: Global conditional importance results for $H_{0}\\ :\\ Y\\bot\\bot Z_{1}\\ |\\ Z$ $Z_{-1}$ with C-SKIT. (a) $\\widetilde{Z}_{1}\\sim P_{Z_{1}|Z_{-1}}$ is independent of $Y$ for $Z_{-1}=[-1,3]$ . As expected, the slope of the linear regression between $Y$ and ${\\widetilde{Z}}_{1}$ is $\\approx0$ . (b) Mean rejection rate and mean rejection time for C-SKIT with a linear and RBF kernel , as a function of $\\beta_{1}$ . "], "img_footnote": [], "page_idx": 24}, {"type": "text", "text": "with the symmetry-based SKIT in Algorithm B.1. Fig. D.2a shows samples from the joint distribution $P_{Y Z_{2}}$ for $\\beta_{2}=1$ and $\\beta_{2}=0$ . As expected, when $\\beta_{2}=0$ , the slope of the linear regression (red dashed line) is $\\approx0$ because $Y$ and $Z_{2}$ are independent. Fig. D.2b reports average rejection rate and average rejection time as a function of $\\beta_{2}$ . As $\\beta_{2}$ increases, the strength of the dependency between $Y$ and $Z_{2}$ increases, and the rejection time decreases\u2014this adaptive behavior is characteristic of sequential tests. ", "page_idx": 24}, {"type": "text", "text": "We can verify that the rejection rate is below the significance level $\\alpha=0.05$ when $\\beta_{2}\\,=\\,0$ , and that the SKIT procedure provides Type I error control. Finally, we note that both kernels perform similarly for this test, with the linear kernel generally rejecting less than the RBF one, and with longer rejection times. ", "page_idx": 24}, {"type": "text", "text": "D.1.2 Global Conditional Importance with C-SKIT ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Then, we test that ", "page_idx": 24}, {"type": "equation", "text": "$$\n\\beta_{1}=0\\implies Y\\bot\\bot Z_{1}\\mid Z_{-1}\n$$", "text_format": "latex", "page_idx": 24}, {"type": "text", "text": "with C-SKIT (Algorithm 1). We remark that we can sample from the exact conditional distribution $P_{Z_{1}|Z_{-1}}=P_{Z_{1}|Z_{\\{2,3\\}}}$ because $Z_{2}$ is independent of $Z_{1}$ by construction, and the conditional $P_{Z_{1}|Z_{3}}$ can be computed analytically as shown in Eq. (78). We verify the conditional distribution behaves as expected in Fig. D.3a. By construction, ${\\widetilde{Z}}_{1}$ is sampled without looking at $Y$ , hence it is independent, and the slope of the linear regression (r ed dashed line) is $\\approx0$ . Fig. $_{\\textrm{D.3b}}$ shows mean rejection rate and time as a function of $\\beta_{1}$ . First and foremost, we can see that in this case the linear kernel always fails to reject\u2014independently of the value of $\\beta_{1}$ . This behavior highlights an important aspect of all kernel-based tests, that is the kernel needs to be characteristic in order for the mean embedding to be an injective function [25, 66]. If this condition is not satisfied, different probability distributions could share the same mean embedding in the RKHS, and it may not be possible to disambiguate them at all. Consequently, the test will not be consistent, and increasing $\\tau^{\\mathrm{max}}$ will not increase power. For the RBF kernel\u2014which satisfies the characteristic property for probability distributions on $\\mathbb{R}^{d}$ \u2014the test is valid (i.e., it provides Type I error control for $\\beta_{1}=0$ ), and it is adaptive to the strength of the conditional dependence structure\u2014as $\\beta_{1}$ increases, the rejection time decreases. ", "page_idx": 24}, {"type": "image", "img_path": "A0HSmrwtLH/tmp/5aec8262b313f0712979d5b561afbc7a479eb68ada5359181c5256e37a04de5a.jpg", "img_caption": ["Figure D.4: Local conditional importance results for $H_{0}:g(\\widetilde{Z}_{\\{2,3\\}})\\overset{d}{=}g(\\widetilde{Z}_{3})$ with X-SKIT. (a) Shows that, as expected, the test and null distributions overlap  when $\\ z_{3}=0$ . "], "img_footnote": [], "page_idx": 25}, {"type": "text", "text": "", "page_idx": 25}, {"type": "text", "text": "D.1.3 Local Conditional Importance with $\\mathbf{X}$ -SKIT ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "Finally, we test that for a fixed $z$ , ", "page_idx": 25}, {"type": "equation", "text": "$$\nz_{3}=0\\implies g(\\widetilde{Z}_{\\{2,3\\}})\\overset{d}{=}g(\\widetilde{Z}_{3}),~\\widetilde{Z}_{C}\\sim P_{Z|Z_{C}=z_{C}},~\\forall C\\subseteq[m].\n$$", "text_format": "latex", "page_idx": 25}, {"type": "text", "text": "with X-SKIT (Algorithm 2). That is\u2014because of the multiplicative term $z_{2}z_{3}$ in $g$ \u2014the observed value of $z_{2}$ does not change the distribution of the response of the model when $z_{3}=0$ . Fig. D.4a shows the test (i.e., $g(\\widetilde{Z}_{\\{2,3\\}}^{\\scriptscriptstyle-}))$ and null (i.e., $g(\\widetilde{Z}_{3}))$ distributions for different values of $z_{3}$ when $z_{2}=1$ . As expected, we can see that when $z_{3}=0$ , the two distributions overlap, whereas when $z_{3}=0.5$ , the test distribution is slightly shifted to the right. Fig. D.4b shows results of X-SKIT with both a linear and RBF kernel as a function of $z_{3}$ . We use both positive and negative values of $z_{3}$ to show that X-SKIT has a two-sided alternative, i.e. it rejects both when the test distribution is to the right and to the left of the null. We can see that both the linear and RBF kernel provide Type I error control when $z_{3}=0$ , and that their rejection times adapt to the hardness of the problem. ", "page_idx": 25}, {"type": "text", "text": "Now that we have illustrated all tests in arguably the simplest setting, we move onto a synthetic dataset where the response is learned by means of a neural network. ", "page_idx": 25}, {"type": "text", "text": "D.2 Counting MNIST Digits ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "In this section, we test the semantic importance structure of a neural network trained to count numbers in synthetic images assembled by placing digits from the MNIST dataset [38] in a $4\\times4$ grid. Fig. D.5 depicts the data-generating process, which satisfies: ", "page_idx": 25}, {"type": "text", "text": "\u2022 Blue zeros, orange threes, blue twos, and purple sevens are sampled independently with ", "page_idx": 25}, {"type": "equation", "text": "$$\n\\begin{array}{r l r}{Z_{\\mathrm{blue\\;zeros}}\\sim\\mathcal{U}(\\{0,1,2\\})+\\epsilon}&{{}\\quad}&{Z_{\\mathrm{orange\\;threes}}\\sim\\mathcal{U}(\\{0,1,2\\})+\\epsilon}\\\\ {Z_{\\mathrm{blue\\;twos}}\\sim\\mathcal{U}(\\{1,2\\})+\\epsilon}&{{}\\quad}&{Z_{\\mathrm{purple\\;sevens}}\\sim\\mathcal{U}(\\{1,2\\})+\\epsilon}\\end{array}\n$$", "text_format": "latex", "page_idx": 25}, {"type": "text", "text": "\u2022 Green fives are sampled conditionally on blue zeros with ", "page_idx": 25}, {"type": "equation", "text": "$$\nZ_{\\mathrm{green\\;fives}}\\;|\\;Z_{\\mathrm{blue\\;zeros}}\\sim\\mathrm{Cat}\\left(\\{1,2,3\\},\\left\\{\\!\\!\\left[1/8,3/4,1/8\\right]\\!\\!\\right.\\}\\right.\\left.{\\mathrm{if}}\\ N_{\\mathrm{blue\\;zeros}}=0\\right)+\\epsilon.\n$$", "text_format": "latex", "page_idx": 25}, {"type": "text", "text": "That is, the number of blue zeros changes the probability distribution of green fives over 1,2,3. ", "page_idx": 25}, {"type": "image", "img_path": "A0HSmrwtLH/tmp/2fd96f1309551f75a10a086a0a267cda31f9297124eadfef812d0218254c6008.jpg", "img_caption": ["Figure D.5: Pictorial representation of the data-generating process for the counting dataset. ", "That is, the product of the number of orange threes and green fives changes the distribution of red threes over 1,2. "], "img_footnote": [], "page_idx": 26}, {"type": "text", "text": "\u2022 Red threes are sampled conditionally on both orange threes and green fives with ", "page_idx": 26}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{Z_{\\mathrm{red\\,threes}}\\mid Z_{\\mathrm{orange\\,threes}},Z_{\\mathrm{green\\,fives}}\\sim2+\\mathrm{Bernoulli}(p)+\\epsilon,}\\\\ &{\\,\\,\\,\\,p=\\left\\{\\alpha\\qquad\\quad\\mathrm{if}\\ N_{\\mathrm{orange\\,threes}}N_{\\mathrm{green\\,fives}}\\ge3\\;,\\;\\alpha=0.9.}\\\\ &{\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,}\\end{array}\n$$", "text_format": "latex", "page_idx": 26}, {"type": "text", "text": "Finally, we remark that $N$ denotes the nearest integer to $Z$ , and $\\epsilon$ is independent uniform noise (i.e., $\\epsilon\\sim\\mathcal{U}(-0.5,0.5))$ to make the distribution of the concepts continuous. To summarize, in order to generate images, we first sample the concepts $Z$ according to the distribution above, round their values to their respective nearest integers $N$ , and finally randomly place digits from the MNIST dataset in a $4\\times4$ grid according to their number. Note that this data-generating process adds color to the original black and white MNIST digits, and that color matters for the counting task since orange threes and red threes have different distributions. ", "page_idx": 26}, {"type": "text", "text": "We remark that, with the data generating process above, we can sample from the true conditional distribution of the digits, and, consequently, of images. We omit details on the conditional distribution for the sake of presentation.4 We stress that this setting differs slightly from the general one presented in this paper, where we consider both an encoder $f$ and a classifier $g$ such that $\\bar{\\boldsymbol{y}}=\\boldsymbol{g}(\\boldsymbol{f}(\\boldsymbol{x})\\bar{\\boldsymbol{)}}$ , and we sample from the conditional distribution of the dense embeddings $H$ given any subset of concepts (i.e., $P_{H|Z_{C}})$ . The scope of this experiment is to showcase the effectiveness of our tests when the response is parametrized by a complex, nonlinear, learned predictor, hence we train a neural network such that ${\\hat{y}}=f(x)$ and directly sample from the conditional distribution of images given any subset of digits (i.e., $P_{X|Z_{C}})$ . ", "page_idx": 26}, {"type": "text", "text": "We sample a training dataset of 50,000 images and train a ResNet18 [30] to predict the number of all digits for 6 epochs with batch size of 64 and Adam optimizer [35] with learning rate equal to $10^{-4}$ , weight decay of $10^{-5}$ , and a scheduler that halves the learning rate every other epoch (recall that the model needs to learn to disambiguate red and orange threes, so color matters). To evaluate the model, we round predictions to the nearest integer and compute accuracy on a held-out set of 10,000 images from the same distribution (we use the original train and test splits of the MNIST dataset to guarantee no digits showed during training are included in test images), and the model achieves an accuracy greater than $99\\%$ . ", "page_idx": 26}, {"type": "text", "text": "Herein, we study the semantic importance structure of the predicted number of red threes with respect to the predicted number of other digits. Note that the ground-truth distribution satisfies the following conditions: ", "page_idx": 26}, {"type": "equation", "text": "$$\nZ_{\\mathrm{red\\,threes}}\\bot\\bot Z_{\\mathrm{blue\\,twos}}\n$$", "text_format": "latex", "page_idx": 26}, {"type": "text", "text": "2. Red threes are independent of blue zeros conditionally on green fives, i.e. ", "page_idx": 27}, {"type": "equation", "text": "$$\nZ_{\\mathrm{red\\,threes}}\\bot Z_{\\mathrm{blue\\,zeros}}\\mid Z_{\\mathrm{green\\,fives}}.\n$$", "text_format": "latex", "page_idx": 27}, {"type": "text", "text": "3. If\u2014in a specific image\u2014there are no orange threes, then red threes are independent of green fives, i.e. ", "page_idx": 27}, {"type": "equation", "text": "$$\nZ_{\\mathrm{red\\;threes}}|(N_{\\mathrm{green\\;fives}}=n_{\\mathrm{green\\;fives}},N_{\\mathrm{orange\\;threes}}=0)\\overset{d}{=}Z_{\\mathrm{red\\;threes}}|N_{\\mathrm{orange\\;threes}}=0.\n$$", "text_format": "latex", "page_idx": 27}, {"type": "text", "text": "D.2.1 Global Importance with SKIT ", "text_level": 1, "page_idx": 27}, {"type": "text", "text": "We start by testing whether the predictions of the model satisfy the ground-truth condition ", "page_idx": 27}, {"type": "equation", "text": "$$\nZ_{\\mathrm{red\\;threes}}\\bot Z_{\\mathrm{blue\\;twos}}\\;\\;\\;\\;\\;\\;\\;\\;\\;\\;\\;\\;\\;\\;\\;\\;\\;\\;\\;\\mathrm{and}\\;\\;\\;\\;\\;\\;\\;\\;\\;\\;\\;\\;\\;\\;\\;Z_{\\mathrm{red\\;threes}}\\bot Z_{\\mathrm{purple\\;sevens}}\n$$", "text_format": "latex", "page_idx": 27}, {"type": "text", "text": "with SKIT (Algorithm B.1). We remark that at inference, we round predictions to the nearest integer and add independent uniform noise $\\epsilon\\sim\\mathcal{U}(-0.5,0.5)$ to make the distribution of the response of the model continuous. Fig. D.6 shows the ground-truth distribution of red threes as a function of other digits in the held-out set, and the kernel density estimation of the predictions of the model. As expected, we can see that the ground-truth distribution is marginally dependent on blue zeros, orange threes, and green fives, but it is independent of blue twos and purple sevens. ", "page_idx": 27}, {"type": "text", "text": "We repeat all tests 100 times with both linear and RBF kernels with bandwidth set to the median of the pairwise distances of previous observations. We perform tests on independent draws of data of size $\\tau^{\\mathrm{max}}\\in\\{100,200,400,800,1600\\}$ from the validation set, and study the rank of importance as a function of $\\tau^{\\mathrm{max}}$ , i.e. the amount of data available to test. Fig. D.7 includes mean rejection rate and mean rejection time for each digit, and the rank of importance of digits as a function of $\\tau^{\\mathrm{max}}$ . We can see that\u2014as expected\u2014both linear and RBF kernels successfully control Type I error for \u201cblue twos\u201d and \u201cpurple sevens\u201d, and this confirms that the distribution of the predictions of the model agrees with the underlying ground-truth data-generating process. Furthermore, we can see that the rank of importance is stable across different values of $\\tau^{\\mathrm{max}}$ , with purple sevens and blue twos consistently ranked last. ", "page_idx": 27}, {"type": "text", "text": "D.2.2 Global Conditional Importance with C-SKIT ", "text_level": 1, "page_idx": 27}, {"type": "text", "text": "Then, we test whether the predictions of the model satisfy the ground-truth conditional independence condition ", "page_idx": 27}, {"type": "equation", "text": "$$\nZ_{\\mathrm{red\\,threes}}\\bot Z_{\\mathrm{blue\\,zeros}}\\mid Z_{\\mathrm{green\\,fives}}\n$$", "text_format": "latex", "page_idx": 27}, {"type": "text", "text": "with C-SKIT. Analogous to above, we repeat all tests 100 times with linear and RBF kernels, and Fig. D.8 includes results for $\\tau^{\\mathrm{max}}\\in\\{10\\bar{0},200,400,800,1600\\}$ . Here\u2014similarly to the synthetic experiment presented in Appendix D.1\u2014we can see that the linear kernel almost always fails to reject, i.e. the mean rejection rates for all digits are close to 0. As discussed earlier, this behavior is due to the fact that the linear kernel is not characteristic for the distributions. On the other hand, the RBF is, and, as expected, it is consistent and it provides Type I error control for the null hypothesis that red threes are independent of blue zeros conditionally on all other digits, which is true. Furthermore, we can see that the rank of importance is less stable compared to the one in Fig. D.2, and in particular, $\\tau^{\\mathrm{max}}=100$ seems not to be sufficient to retrieve the correct ground-truth structure (i.e., blue twos are ranked before green fives). This highlights how the amount of data available for testing may affect results and findings. ", "page_idx": 27}, {"type": "image", "img_path": "A0HSmrwtLH/tmp/01e0d120743153801711036af9bff108995d53d9b15e63097705820755f26c43.jpg", "img_caption": ["Figure D.7: Global semantic importance results for the predicted number of red threes with linear and RBF kernels. In each subfigure, the leftmost panel shows mean rejection rate and mean rejection time over 100 tests with $\\alpha=0.05$ and $\\tau^{\\mathrm{max}}=800$ . The rightmost panel shows the rank of importance of digits for the prediction of red threes as a function of $\\tau^{\\mathrm{max}}$ . "], "img_footnote": [], "page_idx": 28}, {"type": "image", "img_path": "A0HSmrwtLH/tmp/5039289c437dedebbb006beac11658990aa498a6d92b55e1a70bd4eb2d7014c0.jpg", "img_caption": [], "img_footnote": [], "page_idx": 28}, {"type": "text", "text": "Figure D.8: Global conditional semantic importance results for the predicted number of red threes with linear and RBF kernels. In each subfigure, the leftmost panel shows mean rejection rate and mean rejection time over 100 tests with $\\alpha=0.05$ and $\\tau^{\\mathrm{max}}=800$ . The rightmost panel shows the rank of importance of digits for the prediction of red threes as a function of $\\tau^{\\mathrm{max}}$ . ", "page_idx": 28}, {"type": "text", "text": "D.2.3 Local Conditional Importance with X-SKIT ", "text_level": 1, "page_idx": 28}, {"type": "text", "text": "Finally, we test whether the predictions of the model satisfy the ground-truth condition that, for a particular image, if there are no orange threes (i.e., $n_{\\mathrm{orange\\;threes}}=0_{\\mathrm{.}}$ ) then red threes are independent of the observed green fives (i.e., ngreen fives), i.e. ", "page_idx": 28}, {"type": "equation", "text": "$$\nZ_{\\mathrm{red\\;threes}}|(N_{\\mathrm{green\\;fives}}=n_{\\mathrm{green\\;fives}},N_{\\mathrm{orange\\;threes}}=0)\\overset{d}{=}Z_{\\mathrm{red\\;threes}}|N_{\\mathrm{orange\\;threes}}=0.\n$$", "text_format": "latex", "page_idx": 28}, {"type": "text", "text": "We remark that, in the equation above, conditioning is written in terms of the integer norange threes $=$ 0 because of its intuitive meaning, and that this is equivalent to conditioning on $z_{e}$ orange threes $\\in$ $(-0.5,0.5)$ . Similarly, we could replace ngreen fives with zgreen fives, and, in practice, we run tests conditioning on the observed concepts $z$ , and not their integer values $n$ . ", "page_idx": 28}, {"type": "text", "text": "We use $\\mathrm{X}$ -SKIT (Algorithm 2) with a linear and RBF kernel with bandwidth set to the median of the pairwise distances of previous observations. We repeat all tests 100 times on individual images with 0, 1, and 2 orange threes, significance level $\\alpha=0.05$ , and $\\tau^{\\mathrm{max}}=400$ . Fig. D.9 shows results grouped by number of orange threes. As expected, we see that when norange threes is grater than 0, the number of green fives is important for the predictions of the model (i.e., rejection rate is close to 1, with short rejection rate), whereas when there are no orange threes in the image, both the linear and RBF kernel control Type I error. We qualitatively compared our findings with pixel-level explanations with Grad-CAM [55], and we can see that they only highlight red threes because that is the digit we are explaining the prediction of. That is, pixel-level explanations cannot convey the full spectrum of semantic importance for the predictions of a model\u2014which can be misleading to users. For example, in this case, a user may not understand when the predictions of a model depend on the number of green fives, because they are never highlighted by pixel-level saliency maps. In real-world scenarios, digits may be replaced by sensitive attributes that cannot be inferred by the raw value of pixels. For example, a saliency map highlighting a face does not convey which attributes were used by the model, such as skin color, biological sex, or gender. It is immediate to see how being able to investigate the dependencies of the predictions of a model with respects to these attributes (which our definitions provide) is paramount for their safe deployment. ", "page_idx": 28}, {"type": "image", "img_path": "A0HSmrwtLH/tmp/8d6ed6ff6e1abc64f8724d38c5a6e1abb551acca63e95aad846c7a6b29cf9870.jpg", "img_caption": ["(c) Results for $n_{\\mathrm{orange\\;threes}}=0$ . "], "img_footnote": [], "page_idx": 29}, {"type": "text", "text": "Figure D.9: Local conditional importance of $N_{\\mathrm{green\\,fives}}$ conditionally on $N_{\\mathrm{orange\\;threes}}$ . Each row contains the input image, the Grad-CAM explanation for the prediction of the model, and X-SKIT results for 100 repetitions of the test with $\\tau^{\\mathrm{max}}\\,=\\,400$ , with a linear and RBF kernel. Note that X-SKIT finds the observed number of green fives important whenever the number of orange threes is greater than zero, whereas Grad-CAM does not. ", "page_idx": 29}, {"type": "text", "text": "With these results on synthetic datasets, we now showcase the flexibility of our proposed tests on zero-shot image classification with several and diverse vision-language (VL) models. ", "page_idx": 29}, {"type": "text", "text": "E Experimental Details ", "text_level": 1, "page_idx": 29}, {"type": "text", "text": "In this appendix, we include further details about the real-world experiments that were omitted from the main text for the sake of presentation. All experiments were run on a private server with one 24 GB NVIDIA RTX A5000 GPU and 96 CPU cores with 500 GB of RAM memory. ", "page_idx": 29}, {"type": "text", "text": "List of VL models used in the experiments. We use 8 different VL models, both CLIP- and non-CLIP-based: CLIP:RN50,ViT-B/32,ViT-L/14 [50], OpenClip:ViT-B-32,ViT-L-14 [31], FLAVA [63], ALIGN [32], and BLIP [39]. ", "page_idx": 29}, {"type": "text", "text": "Evaluating rank agreement. We use a weighted version of Kendall\u2019s tau [33] introduced by Vigna [72] which assigns higher penalties to swaps between elements with higher ranks. This choice reflects the fact that concepts with higher importance should be more stable across different models. We briefly remark that this notion of rank agreement is bounded in $[-1,1]$ ( $\\left[-1\\right.$ indicates reverse order, and 1 perfect alignment) but not symmetric. ", "page_idx": 29}, {"type": "text", "text": "Evaluating importance agreement. We threshold rejection rates at level $\\alpha$ to classify concepts into important and not important ones. Then, importance agreement is the accuracy between pairs of binarized vectors. ", "page_idx": 29}, {"type": "text", "text": "E.1 Estimating Conditional Distributions from Data ", "text_level": 1, "page_idx": 29}, {"type": "text", "text": "Here, we introduce nonparametric methods to estimate the conditional distributions necessary to run our C-SKIT and $\\mathrm{X}$ -SKIT tests. Throughout this section, we will assume access to a training set $\\{(h^{(i)},z^{(i)})\\}_{i=1}^{n}$ of $n$ tuples of dense embeddings $h\\in\\mathbb{R}^{d}$ with their semantics $z\\in[-1,1]^{m}$ . ", "page_idx": 29}, {"type": "text", "text": "E.1.1 Estimating $P_{Z_{j}\\mid Z_{-j}}$ for C-SKIT ", "text_level": 1, "page_idx": 29}, {"type": "text", "text": "Here, we describe how to sample from the conditional distribution of a concept $Z_{j}$ given the rest, $Z_{-j}$ , i.e. $\\widetilde{Z}_{j}\\sim P_{Z_{j}|Z_{-j}}$ , which is necessary to run our C-SKIT test. In particular, for a concept ", "page_idx": 29}, {"type": "image", "img_path": "A0HSmrwtLH/tmp/8abbe8c628e343c67919636c402ea61433633439bf721e4a1f31ca96848a48b6.jpg", "img_caption": ["Figure E.1: Example marginal and estimated conditional distributions $p(z_{j})$ and $\\tilde{p}(z_{j}|\\boldsymbol{z}_{-j})$ for two class-specific concepts on three images from the Imagenette dataset. Distributions are shown as a function of the effective number of points in the weighted KDE (i.e., $n_{\\mathrm{eff}})$ . "], "img_footnote": [], "page_idx": 30}, {"type": "text", "text": "$j\\in[m]$ , and an observation $z\\in[-1,1]^{m}$ , we define the unnormalized conditional distribution ", "page_idx": 30}, {"type": "equation", "text": "$$\n\\tilde{p}(z_{j}\\mid z_{-j})=\\sum_{i=1}^{n}w_{i}\\phi\\left(\\frac{z_{j}^{(i)}-z_{j}}{\\nu_{\\mathrm{scott}}}\\right)\n$$", "text_format": "latex", "page_idx": 30}, {"type": "text", "text": "by means of weighted kernel density estimation (KDE), where $\\phi$ is the standard normal probability density function, $\\nu_{\\mathrm{scott}}$ is Scott\u2019s factor [54], and ", "page_idx": 30}, {"type": "equation", "text": "$$\nw_{i}=\\phi\\left(\\frac{z_{-j}^{(i)}-z_{-j}}{\\nu}\\right),\\;\\nu>0\n$$", "text_format": "latex", "page_idx": 30}, {"type": "text", "text": "are the weights. That is, the further $z_{-j}^{(i)}$ is from $z_{-j}$ , the lower its weight in the KDE. As for all kernel-based methods, the bandwidth $\\nu$ is important for the practical performance of the model. For our experiments, we choose $\\nu$ adaptively such that the effective number of points in the KDE (i.e. $\\begin{array}{r}{n_{\\mathrm{eff}}=\\overline{{(\\sum_{i=1}^{n}w_{i})^{2}/\\sum_{i=1}^{n}w_{i}^{2}}})}\\end{array}$ is the same across concepts. This choice is motivated by the fact that different concepts have different distributions, and we want to guarantee the same number of points are used to estimate their conditional distributions. Furthermore, we note that $n_{\\mathrm{eff}}$ controls the strength of the conditioning\u2014the larger $n_{\\mathrm{eff}}$ , the slower the decay of the weights, and the weaker the conditioning. That is, in the limit, the weights become uniform, the conditional distribution tends to the marginal $\\tilde{p}(z_{j})$ , and all tests presented become of decorrelated semantic importance [70, 71]. With this, samplingZ j \u223cPZj|Z\u2212j=z\u2212j boils down to first sampling $i^{\\prime}$ according to the weights $\\boldsymbol{w}=[w_{i},\\ldots,w_{n}]$ , and then sampling ${\\widetilde{Z}}_{j}$ from the Gaussian distribution centered at $z_{j}^{(i^{\\prime})}$ . ", "page_idx": 30}, {"type": "text", "text": "Fig. E.1 shows the marginal (i.e., $p(z_{j})\\colon$ ) and estimated conditional distributions (i.e., $\\tilde{p}(z_{j}|z_{-j}))$ of two class-specific concepts as a function of effective number of points $n_{\\mathrm{eff}}$ for three images in the Imagenette dataset. We can see how as $n_{\\mathrm{eff}}$ increases, the estimated conditional distribution becomes closer to the marginal, and that the conditional distributions of class-specific concepts tend to be skewed to higher values compared to their marginals. This behavior suggests that images from a specific class have higher values of concepts that are related to the class. We use $n_{\\mathrm{eff}}=2000$ for all tests across all real-world experiments. ", "page_idx": 30}, {"type": "text", "text": "E.1.2 Estimating $P_{H|Z_{C}=z_{C}}$ for $\\mathbf{X}$ -SKIT ", "text_level": 1, "page_idx": 30}, {"type": "text", "text": "Here, we describe how to sample from the conditional distribution of dense embeddings $H$ conditionally on any subset of concepts $C\\subseteq[m]$ of a particular semantic vector $z\\,\\in\\,[-1,1]^{m}$ , i.e. $\\widetilde{H}_{C}\\sim P_{H|Z_{C}=z_{C}}$ , which is necessary to run our X-SKIT test. We show how to achieve this by coupling the nonparametric sampler introduced above with ideas of nearest neighbors. This choice is motivated by the need to keep samples in-distribution with respects to the downstream classifier $g$ . Intuitively, we propose to: ", "page_idx": 30}, {"type": "image", "img_path": "A0HSmrwtLH/tmp/fbbdf35a3ba39b100e6be25684ba6ad3ed6696fbb7dac8270774aa1812f4534e.jpg", "img_caption": ["Figure E.2: Example test (i.e., $g(\\widetilde{H}_{S\\cup\\{j\\}}))$ ) and null (i.e., $g(\\widetilde{H}_{S}))$ ) distributions for a class-specific concept and a non-class specific one on three images from the Imagenette dataset as a function of the cardinality of $S$ . "], "img_footnote": [], "page_idx": 31}, {"type": "text", "text": "", "page_idx": 31}, {"type": "text", "text": "2. Retrieve the embedding $H^{(i^{\\prime})}$ such that its concept representation $Z^{(i^{\\prime})}$ is the nearest neighbor of $\\widetilde{Z}$ . ", "page_idx": 31}, {"type": "text", "text": "Step 2 makes sure that samples are coming from real images, and it overcomes some of the hurdles of sampling a high-dimensional vector $(\\check{H_{\\mathrm{~\\in~\\mathbb{R}}^{d}}},d\\sim10^{\\tilde{2}})$ conditionally on a low-dimensional one $(z_{C}\\in[-1,1]^{|C|}$ , $C\\subseteq[m]$ , $m\\approx20,$ ). More precisely, recall that $\\{(h^{(i)},z^{(i)})\\}_{i=1}^{n}$ is a set of $n$ pairs of dense embeddings and their semantics, then ", "page_idx": 31}, {"type": "equation", "text": "$$\n\\widetilde{H}_{C}=h^{(i^{\\prime})}\\quad\\mathrm{~s.t.~}\\quad i^{\\prime}=\\underset{i\\in[n]}{\\mathrm{arg}\\,\\operatorname*{min}}\\,\\:\\Vert z^{(i)}-\\widetilde{Z}\\Vert,\\:\\widetilde{Z}\\sim P_{Z|Z_{C}=z_{C}},\n$$", "text_format": "latex", "page_idx": 31}, {"type": "text", "text": "where $P_{Z|Z_{C}=z_{C}}$ is approximated with $\\tilde{p}(z_{-C}\\mid z_{C}),-C:=[m]\\mid C$ as in Eq. (93). ", "page_idx": 31}, {"type": "text", "text": "Fig. E.2 shows some example test (i.e., $g(\\widetilde{H}_{S\\cup\\{j\\}}))$ and null distributions (i.e., $g(\\widetilde{H}_{S}))$ for a classspecific concept and a non-class specific one on the same three images from the Imagenette dataset as in Fig. E.1. We remark that $S$ can be any subset of the remaining concepts, so we show results for random subsets of increasing size. We can see that the test distributions of class-specific concepts are skewed to the right, i.e. including the observed class-specific concept increases the output of the predictor. Furthermore, we see the shift decreases the more concepts are included in $S$ , i.e. if $S$ is larger and it contains more information, then the marginal contribution of one additional concept will be smaller. On the other hand, including a non-class-specific concept does not change the distribution of the response of the model, no matter the size of $S$ \u2014precisely as our local definition of importance $(H_{0,j,S}^{\\mathrm{LC}})$ demands. ", "page_idx": 31}, {"type": "text", "text": "E.2 AwA2 Dataset ", "text_level": 1, "page_idx": 31}, {"type": "text", "text": "Here, we include additional information, tables, and figures for the AwA2 dataset experiment. This dataset comprises 37,322 images (29,841 for training and 7,481 for testing) from 50 animal species along with class-level annotations of 85 attributes (some example figures are included in Fig. E.3). Concept annotations are reported both as frequencies (i.e., how often an attribute appears in images coming from a class) and as binary labels (i.e., 1 means that an attribute is present in a class, and 0 otherwise). Table E.2 shows the zero-shot classification performance of all VL models used in this experiment for the top-10 classes, and, for each class, we test 20 attributes: the 10 most frequent, and a random subset of 10 absent ones (concepts are included in Table E.3). Finally we remark that, for each model, we obtain the dictionary $c$ by encoding concepts with its text encoder. ", "page_idx": 31}, {"type": "image", "img_path": "A0HSmrwtLH/tmp/72f2345f5a30eecb840e9037bf2eaa7c11e9a4d343e18c09ddf2c0b7d4246973.jpg", "img_caption": ["Figure E.3: Example images from the top-10 best classified classes in the AwA2 dataset. "], "img_footnote": [], "page_idx": 32}, {"type": "table", "img_path": "A0HSmrwtLH/tmp/aa6975322feb0475d1f63aaa0cabee7c74e6d3c281eecf380b06bb85e7ba3d07.jpg", "table_caption": ["Table E.2: Zero-shot classification accuracy on the AwA2 dataset. "], "table_footnote": [], "page_idx": 32}, {"type": "image", "img_path": "A0HSmrwtLH/tmp/aa3c96e2cc2b99ce996bdd7f4da4c2660c6bc7200babdde54e0c25eda37dd103.jpg", "img_caption": ["Figure E.4: Rank agreement comparison between SKIT, C-SKIT, and PCBM on the AwA2 dataset. Results are reported as mean and standard deviation over the 10 classes considered in this experiment. "], "img_footnote": [], "page_idx": 32}, {"type": "table", "img_path": "A0HSmrwtLH/tmp/72dd019792a740d2a9b78b41ead8c5586dcd532a6f2a1ea0f95dab65af14969b.jpg", "table_caption": ["Table E.3: Class-level attributes tested on the AwA2 dataset. "], "table_footnote": [], "page_idx": 33}, {"type": "image", "img_path": "A0HSmrwtLH/tmp/6552b1b635a3535bf4f2394426a4580efa97cacdab7ffc707fc60a58560c5113.jpg", "img_caption": ["Figure E.5: SKIT importance results with CLIP:ViT-L/14 on the AwA2 dataset. "], "img_footnote": [], "page_idx": 33}, {"type": "image", "img_path": "A0HSmrwtLH/tmp/db0c1577e1a7a42d5064ed3a1fbd4000d701243102cc8e098a402df6825c2a50.jpg", "img_caption": ["Figure E.6: C-SKIT importance results with CLIP:ViT-L/14 on the AwA2 dataset. "], "img_footnote": [], "page_idx": 34}, {"type": "image", "img_path": "A0HSmrwtLH/tmp/64dc6582afc0956ce38d3d077fa64ccbf39cbe5da8d1016ebb8bb57069e5ac55.jpg", "img_caption": ["Figure E.7: Example test images from the CUB dataset with their respective classes. "], "img_footnote": [], "page_idx": 35}, {"type": "table", "img_path": "A0HSmrwtLH/tmp/339606a7f615f59c4c9deb3d781cf23d4c35f857ca673ba31045f7e52bd0de12.jpg", "table_caption": ["Table E.4: Zero-shot classification accuracy on the CUB dataset. "], "table_footnote": [], "page_idx": 35}, {"type": "text", "text": "E.3 CUB Dataset ", "text_level": 1, "page_idx": 35}, {"type": "text", "text": "Here, we include additional information and results for the experiment of the CUB dataset [75], which contains 11,788 images of 200 different bird classes, and each image is annotated with the presence of 312 fine-grained concepts that describe the appearance of the bird (e.g., \u201chas orange bill\u201d, \u201chas hook-shaped bill\u201d, \u201cis small\u201d) with the labelers\u2019 confidence. Formally, the dataset is a collection $\\{(\\boldsymbol{x}^{(i)},\\boldsymbol{y}^{(i)},\\boldsymbol{z}^{(\\bar{i})},\\boldsymbol{u}^{(i)})\\}_{i=1}^{n}$ of images $x$ with class label $y$ , binary semantic vector $z^{(i)}\\,\\in\\,\\{0,1\\}^{m}$ , and uncertainty values $u^{(i)}\\,\\in\\,\\{1,2,3,4\\}$ : \u201cnot visible\u201d (1), \u201cguessing\u201d (2), \u201cprobably\u201d (3), and \u201cdefinitely\u201d (4). ", "page_idx": 35}, {"type": "text", "text": "We randomly sample 10 images from the 10 classes with highest average accuracy across models: Table E.4 includes accuracies of all VL models used, and Fig. E.7 shows some example test images for each class. For each image, we select 14 concepts to test: we first restrict ourselves to annotations with good confidence (i.e., \u201cprobably\u201d or \u201cdefinitely\u201d), and then, for each concept $j$ , we estimate its marginal (i.e., $p_{j}:=\\mathbb{P}[Z_{j}=1]$ ) and class-conditional (i.e., $p_{j\\mid y}:=P[Z_{j}=1\\mid Y=y])$ rates over the dataset. Finally, for each test image $x$ with label $y$ , we score concepts by the difference between their class-conditional and marginal rates, i.e. $s_{j}(y)=p_{j\\mid y}-p_{j}$ . Intuitively, a large value of $s_{j}(y)$ indicates that concept $j$ has a higher occurrence in class $y$ compared to the population, and we say that it is discriminative for class $y$ . We test the 7 most discriminative concepts that are present in the observed image $x$ , and a random subset of 7 concepts that are absent according to the ground-truth annotations. We remark that, since concepts are binary, we do not use the KDE-based methods presented in Appendix E.1, and instead we approximate $P_{H|Z_{C}=z_{C}}$ by sampling uniformly from the entries in the dataset that match the conditioning vector $z_{C}$ . Finally, we use RBF kernels with bandwidths set to the median of the pairwise distances of observations, and $\\tau^{\\mathrm{max}}=200$ . ", "page_idx": 35}, {"type": "table", "img_path": "A0HSmrwtLH/tmp/c224a3d35dc58df6314396f714ec9110816dde964ffe1f170ea59688c11dfb4d.jpg", "table_caption": ["Table E.5: X-SKIT results on the CUB dataset as a function of conditioning set size $s$ . "], "table_footnote": [], "page_idx": 35}, {"type": "image", "img_path": "A0HSmrwtLH/tmp/53e8758ca9befe0dc25cda723b880fddeca9cdec08b0081cb9fa1572e2abe4fb.jpg", "img_caption": ["Figure E.8: X-SKIT agreement results on the CUB dataset as a function of conditioning set size, $s$ . Results are reported as means and standard deviations over the random 100 images used in the experiment. "], "img_footnote": [], "page_idx": 36}, {"type": "text", "text": "", "page_idx": 36}, {"type": "text", "text": "After running X-SKIT, we classify concepts as important by thresholding their rejection rates at level $\\alpha$ \u2014which is a statistically-valid way of selecting important concepts. Table E.5 summarizes agreement and detection results as a function of conditioning set size $s$ (i.e., the number of concepts in $S\\subseteq[m]\\setminus\\{j\\})$ , and Fig. E.8 includes all pairwise agreement values. We note that the $f_{1}$ score for $s=4$ (i.e., when conditioning on 4 concepts) is lower compared to $s=1,2$ . This is expected, as the more concepts one conditions on, the smaller the effect of including one additional concept. ", "page_idx": 36}, {"type": "text", "text": "Finally, Fig. E.9 shows ranks of importance for all models on the 4 example images used in the main body of the paper. ", "page_idx": 36}, {"type": "image", "img_path": "A0HSmrwtLH/tmp/3b25cd9d023aa606436aa60566c0b5fac1b01a0f6d15255befe9d5db713ad43e.jpg", "img_caption": ["Figure E.9: X-SKIT importance results $\\mathit{\\Pi}_{s}=1$ ) across all models for four example images in the CUB dataset. "], "img_footnote": [], "page_idx": 37}, {"type": "image", "img_path": "A0HSmrwtLH/tmp/7bf1df31999cef2968a59016a654820401a135e3ffda1f9db7029a1a35e61ce6.jpg", "img_caption": ["Figure E.10: Example images from the Imagenette dataset with their respective labels. "], "img_footnote": [], "page_idx": 38}, {"type": "table", "img_path": "A0HSmrwtLH/tmp/d6258441ff2e1fb783264d72dfbfcf74f969ec0bf986ea38671e9b4aff7630c8.jpg", "table_caption": ["Table E.6: Zero-shot classification accuracy on the Imagenette dataset. "], "table_footnote": [], "page_idx": 38}, {"type": "text", "text": "E.4 Imagenette Dataset ", "text_level": 1, "page_idx": 38}, {"type": "text", "text": "Here, we present additional information and results on the Imagenette dataset presented in the main body of this manuscript.5 This dataset contains 13,394 images (9,469 for training and 3,925 for testing) from ten easily separable classes in ImageNet [22]. Fig. E.10 includes example images from the classes in the dataset, and Table E.6 reports the classification accuracy across all vision-language models $(98.99\\%\\pm0.01\\%$ average accuracy). ", "page_idx": 38}, {"type": "text", "text": "Recall that the ImageNet dataset does not provide ground-truth semantic annotations, hence we use SpLiCe [6] to find which concepts to test. In particular, we use the 10,000 most frequent words in the vocabulary from the MSCOCO dataset [40], and we set the $\\ell_{1}$ regularization term in SpLiCe to 0.20. Following previous work [83], we fliter the selected concepts such that they are different from the classes in the dataset. We use WordNet [23] to lemmatize both concepts and class names (e.g., \u201cchurches\u201d becomes \u201cchurch\u201d), and we check that concepts are not contained in class names and vice versa. For example, the concept \u201cchurches\u201d would be skipped because \u201cchurch\u201d is already the name of a class, and \u201cgasoline\u201d would be skipped because it contains part of the class \u201cgas pump\u201d. ", "page_idx": 38}, {"type": "image", "img_path": "A0HSmrwtLH/tmp/224ca75aee088b03a170d2f1d935dc10cae8c215806dacd4446549439bf4a57d.jpg", "img_caption": ["Figure E.11: Global importance results with CLIP:ViT-L/14 on the Imagenette dataset. ", "(b) Global conditional importance with C-SKIT. "], "img_footnote": [], "page_idx": 39}, {"type": "image", "img_path": "A0HSmrwtLH/tmp/93e0e67766f25f312ca13eca0393fb706f49a322b3edd7a65f46c60c45483b2d.jpg", "img_caption": ["Figure E.12: Rank agreement comparison between SKIT, C-SKIT, and PCBM on Imagenette. Result are reported as mean and standard deviation over the 10 classes considered in the experiment. "], "img_footnote": [], "page_idx": 39}, {"type": "image", "img_path": "A0HSmrwtLH/tmp/0a64c3069fe090f7e123445c147785c1a0b82c9d2b55f39502725485c2265c63.jpg", "img_caption": ["Figure E.13: Importance results with CLIP:ViT-L/14 on Imagenette as a function of $\\tau^{\\mathrm{max}}$ . ", "(b) Global conditional importance with C-SKIT. "], "img_footnote": [], "page_idx": 40}, {"type": "text", "text": "We run SKIT and C-SKIT with RBF kernels with bandwidths equal to the $90^{\\mathrm{th}}$ percentile of the pairwise distances of previous observations and $\\tau^{\\mathrm{max}}\\,=\\,400,800$ , respectively. We encode the entire dataset using SpLiCe and keep the top-20 concepts to test. Fig. E.11 shows global and global conditional importance results with CLIP:ViT-L/14 for all classes in the dataset. Furthermore, Fig. E.12 shows all pairwise rank agreement comparisons for SKIT, C-SKIT, and PCBM across all 8 VL models used in the experiment. Lastly, Fig. E.13 qualitatively shows ranks of importance as a function of $\\tau^{\\mathrm{max}}$ with CLIP:ViT-L/14. ", "page_idx": 40}, {"type": "text", "text": "We use X-SKIT on 2 random images from all classes in the dataset (20 images total). Recall that we use SpLiCe to encode each image and keep the top-10 concepts, and finally add the bottom-4 concepts according to PCBM, for a total of 14 concepts per image. We set the bandwidth of the RBF kernel used in the test to the median of the distance of the observations, and $\\tau^{\\mathrm{max}}=200$ . As in the CUB dataset experiment, we classify concepts as important by thresholding their rejection rates at ", "page_idx": 40}, {"type": "text", "text": "Table E.7: X-SKIT results on the Imagenette dataset as a function of conditioning set size $s$ . ", "page_idx": 41}, {"type": "image", "img_path": "A0HSmrwtLH/tmp/8fbc0d093f065014e1bbffcd1d794d3fc9aa1b1c040b29998a611c21f504ce9d.jpg", "img_caption": ["Figure E.14: X-SKIT agreement results on the Imagenette dataset across 8 different vision-language models as a function of conditioning set size, s. Results are reported as means and standard deviations over the random 20 images used in the experiment. "], "img_footnote": [], "page_idx": 41}, {"type": "text", "text": "level $\\alpha$ . Table E.7 summarizes rank and importance agreement as a function of conditioning set size $s$ (i.e., the number of concepts in $S$ ), and Fig. E.14 includes all pairwise agreement values. We can see that ranks are generally well-aligned across models, and that agreement slightly decreases as the number of conditioning concepts increases. Finally, Figs. E.15 and E.16 include results with X-SKIT for 2 images from three classes in the dataset across all models used in the experiment, and Fig. E.17 summarizes ranks across models on the same images. ", "page_idx": 41}, {"type": "image", "img_path": "A0HSmrwtLH/tmp/d4a9e689a9654309fd8431404411f8d8a1f9f23efb2af23d6aad68e5302c2740.jpg", "img_caption": ["Figure E.15: Local importance results with SKIT and CLIP:ViT-L/14 for 2 images from three classes in the Imagenette dataset (part I of II. "], "img_footnote": [], "page_idx": 42}, {"type": "image", "img_path": "A0HSmrwtLH/tmp/8a7c71720c568f022e665d059eeed7798c7e439e6c9320cf01c156dbd22f6c06.jpg", "img_caption": ["Figure E.16: Local importance results with SKIT and CLIP:ViT-L/14 for 2 images from three classes in the Imagenette dataset (part II of II). "], "img_footnote": [], "page_idx": 43}, {"type": "image", "img_path": "A0HSmrwtLH/tmp/3628dddcb8f2b139eeba9122cab1976441edf9dc8f32c75cd27dcb16001370ba.jpg", "img_caption": ["Figure E.17: Summary of X-SKIT ranks of importance across all models for 2 examples images from 3 classes in the Imagenette dataset. "], "img_footnote": [], "page_idx": 43}, {"type": "text", "text": "NeurIPS Paper Checklist ", "text_level": 1, "page_idx": 44}, {"type": "text", "text": "1. Claims ", "text_level": 1, "page_idx": 44}, {"type": "text", "text": "Question: Do the main claims made in the abstract and introduction accurately reflect the paper\u2019s contributions and scope? ", "page_idx": 44}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 44}, {"type": "text", "text": "Justification: In the abstract, we state that we introduce precise definitions of semantic importance for the predictions of black-box models, and novel procedures to test for each of them. These are the contributions of the paper. ", "page_idx": 44}, {"type": "text", "text": "Guidelines: ", "page_idx": 44}, {"type": "text", "text": "\u2022 The answer NA means that the abstract and introduction do not include the claims made in the paper.   \n\u2022 The abstract and/or introduction should clearly state the claims made, including the contributions made in the paper and important assumptions and limitations. A No or NA answer to this question will not be perceived well by the reviewers.   \n\u2022 The claims made should match theoretical and experimental results, and reflect how much the results can be expected to generalize to other settings.   \n\u2022 It is fine to include aspirational goals as motivation as long as it is clear that these goals are not attained by the paper. ", "page_idx": 44}, {"type": "text", "text": "2. Limitations ", "text_level": 1, "page_idx": 44}, {"type": "text", "text": "Question: Does the paper discuss the limitations of the work performed by the authors? Answer: [Yes] ", "page_idx": 44}, {"type": "text", "text": "Justification: Throughout the paper, we clearly state what guarantees our proposed methods provide, and what they do not. We comment on possible future directions. ", "page_idx": 44}, {"type": "text", "text": "Guidelines: ", "text_level": 1, "page_idx": 44}, {"type": "text", "text": "\u2022 The answer NA means that the paper has no limitation while the answer No means that the paper has limitations, but those are not discussed in the paper.   \n\u2022 The authors are encouraged to create a separate \"Limitations\" section in their paper.   \n\u2022 The paper should point out any strong assumptions and how robust the results are to violations of these assumptions (e.g., independence assumptions, noiseless settings, model well-specification, asymptotic approximations only holding locally). The authors should reflect on how these assumptions might be violated in practice and what the implications would be.   \n\u2022 The authors should reflect on the scope of the claims made, e.g., if the approach was only tested on a few datasets or with a few runs. In general, empirical results often depend on implicit assumptions, which should be articulated.   \n\u2022 The authors should reflect on the factors that influence the performance of the approach. For example, a facial recognition algorithm may perform poorly when image resolution is low or images are taken in low lighting. Or a speech-to-text system might not be used reliably to provide closed captions for online lectures because it fails to handle technical jargon.   \n\u2022 The authors should discuss the computational efficiency of the proposed algorithms and how they scale with dataset size.   \n\u2022 If applicable, the authors should discuss possible limitations of their approach to address problems of privacy and fairness.   \n\u2022 While the authors might fear that complete honesty about limitations might be used by reviewers as grounds for rejection, a worse outcome might be that reviewers discover limitations that aren\u2019t acknowledged in the paper. The authors should use their best judgment and recognize that individual actions in favor of transparency play an important role in developing norms that preserve the integrity of the community. Reviewers will be specifically instructed to not penalize honesty concerning limitations. ", "page_idx": 44}, {"type": "text", "text": "3. Theory Assumptions and Proofs ", "text_level": 1, "page_idx": 44}, {"type": "text", "text": "Question: For each theoretical result, does the paper provide the full set of assumptions and a complete (and correct) proof? ", "page_idx": 44}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 45}, {"type": "text", "text": "Justification: We provide complete proofs and background information for each claim. Guidelines: ", "page_idx": 45}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include theoretical results.   \n\u2022 All the theorems, formulas, and proofs in the paper should be numbered and crossreferenced.   \n\u2022 All assumptions should be clearly stated or referenced in the statement of any theorems.   \n\u2022 The proofs can either appear in the main paper or the supplemental material, but if they appear in the supplemental material, the authors are encouraged to provide a short proof sketch to provide intuition.   \n\u2022 Inversely, any informal proof provided in the core of the paper should be complemented by formal proofs provided in appendix or supplemental material.   \n\u2022 Theorems and Lemmas that the proof relies upon should be properly referenced. ", "page_idx": 45}, {"type": "text", "text": "4. Experimental Result Reproducibility ", "text_level": 1, "page_idx": 45}, {"type": "text", "text": "Question: Does the paper fully disclose all the information needed to reproduce the main experimental results of the paper to the extent that it affects the main claims and/or conclusions of the paper (regardless of whether the code and data are provided or not)? ", "page_idx": 45}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 45}, {"type": "text", "text": "Justification: We provide pseudocode for all algorithms used in the paper, detailed descriptions of the data generating processes for synthetic datasets, links to the publicly available datasets that were used, description of hyperparameters used for training and testing models, and link to a GitHub repository to reproduce all experiments presented in the paper. ", "page_idx": 45}, {"type": "text", "text": "Guidelines: ", "page_idx": 45}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 If the paper includes experiments, a No answer to this question will not be perceived well by the reviewers: Making the paper reproducible is important, regardless of whether the code and data are provided or not.   \n\u2022 If the contribution is a dataset and/or model, the authors should describe the steps taken to make their results reproducible or verifiable.   \n\u2022 Depending on the contribution, reproducibility can be accomplished in various ways. For example, if the contribution is a novel architecture, describing the architecture fully might suffice, or if the contribution is a specific model and empirical evaluation, it may be necessary to either make it possible for others to replicate the model with the same dataset, or provide access to the model. In general. releasing code and data is often one good way to accomplish this, but reproducibility can also be provided via detailed instructions for how to replicate the results, access to a hosted model (e.g., in the case of a large language model), releasing of a model checkpoint, or other means that are appropriate to the research performed.   \n\u2022 While NeurIPS does not require releasing code, the conference does require all submissions to provide some reasonable avenue for reproducibility, which may depend on the nature of the contribution. For example (a) If the contribution is primarily a new algorithm, the paper should make it clear how to reproduce that algorithm. (b) If the contribution is primarily a new model architecture, the paper should describe the architecture clearly and fully. (c) If the contribution is a new model (e.g., a large language model), then there should either be a way to access this model for reproducing the results or a way to reproduce the model (e.g., with an open-source dataset or instructions for how to construct the dataset). (d) We recognize that reproducibility may be tricky in some cases, in which case authors are welcome to describe the particular way they provide for reproducibility. In the case of closed-source models, it may be that access to the model is limited in some way (e.g., to registered users), but it should be possible for other researchers to have some path to reproducing or verifying the results. ", "page_idx": 45}, {"type": "text", "text": "5. Open access to data and code ", "text_level": 1, "page_idx": 46}, {"type": "text", "text": "Question: Does the paper provide open access to the data and code, with sufficient instructions to faithfully reproduce the main experimental results, as described in supplemental material? ", "page_idx": 46}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 46}, {"type": "text", "text": "Justification: We provide all code necessary to reproduce the experiments presented in this paper. ", "page_idx": 46}, {"type": "text", "text": "Guidelines: ", "page_idx": 46}, {"type": "text", "text": "\u2022 The answer NA means that paper does not include experiments requiring code.   \n\u2022 Please see the NeurIPS code and data submission guidelines (https://nips.cc/ public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 While we encourage the release of code and data, we understand that this might not be possible, so \u201cNo\u201d is an acceptable answer. Papers cannot be rejected simply for not including code, unless this is central to the contribution (e.g., for a new open-source benchmark).   \n\u2022 The instructions should contain the exact command and environment needed to run to reproduce the results. See the NeurIPS code and data submission guidelines (https: //nips.cc/public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 The authors should provide instructions on data access and preparation, including how to access the raw data, preprocessed data, intermediate data, and generated data, etc.   \n\u2022 The authors should provide scripts to reproduce all experimental results for the new proposed method and baselines. If only a subset of experiments are reproducible, they should state which ones are omitted from the script and why.   \n\u2022 At submission time, to preserve anonymity, the authors should release anonymized versions (if applicable).   \n\u2022 Providing as much information as possible in supplemental material (appended to the paper) is recommended, but including URLs to data and code is permitted. ", "page_idx": 46}, {"type": "text", "text": "6. Experimental Setting/Details ", "text_level": 1, "page_idx": 46}, {"type": "text", "text": "Question: Does the paper specify all the training and test details (e.g., data splits, hyperparameters, how they were chosen, type of optimizer, etc.) necessary to understand the results? ", "page_idx": 46}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 46}, {"type": "text", "text": "Justification: We dedicate an appendix to the full experimental details. ", "page_idx": 46}, {"type": "text", "text": "Guidelines: ", "page_idx": 46}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments. \u2022 The experimental setting should be presented in the core of the paper to a level of detail that is necessary to appreciate the results and make sense of them. \u2022 The full details can be provided either with the code, in appendix, or as supplemental material. ", "page_idx": 46}, {"type": "text", "text": "7. Experiment Statistical Significance ", "text_level": 1, "page_idx": 46}, {"type": "text", "text": "Question: Does the paper report error bars suitably and correctly defined or other appropriate information about the statistical significance of the experiments? ", "page_idx": 46}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 46}, {"type": "text", "text": "Justification: We report p-values and uncertainty estimates wherever they are appropriate. Guidelines: ", "page_idx": 46}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The authors should answer \"Yes\" if the results are accompanied by error bars, confidence intervals, or statistical significance tests, at least for the experiments that support the main claims of the paper.   \n\u2022 The factors of variability that the error bars are capturing should be clearly stated (for example, train/test split, initialization, random drawing of some parameter, or overall run with given experimental conditions).   \n\u2022 The method for calculating the error bars should be explained (closed form formula, call to a library function, bootstrap, etc.)   \n\u2022 The assumptions made should be given (e.g., Normally distributed errors).   \n\u2022 It should be clear whether the error bar is the standard deviation or the standard error of the mean.   \n\u2022 It is OK to report 1-sigma error bars, but one should state it. The authors should preferably report a 2-sigma error bar than state that they have a $96\\%$ CI, if the hypothesis of Normality of errors is not verified.   \n\u2022 For asymmetric distributions, the authors should be careful not to show in tables or figures symmetric error bars that would yield results that are out of range (e.g. negative error rates).   \n\u2022 If error bars are reported in tables or plots, The authors should explain in the text how they were calculated and reference the corresponding figures or tables in the text. ", "page_idx": 46}, {"type": "text", "text": "", "page_idx": 47}, {"type": "text", "text": "8. Experiments Compute Resources ", "text_level": 1, "page_idx": 47}, {"type": "text", "text": "Question: For each experiment, does the paper provide sufficient information on the computer resources (type of compute workers, memory, time of execution) needed to reproduce the experiments? ", "page_idx": 47}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 47}, {"type": "text", "text": "Justification: We specify all computational resources used in this work. ", "page_idx": 47}, {"type": "text", "text": "Guidelines: ", "page_idx": 47}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The paper should indicate the type of compute workers CPU or GPU, internal cluster, or cloud provider, including relevant memory and storage.   \n\u2022 The paper should provide the amount of compute required for each of the individual experimental runs as well as estimate the total compute.   \n\u2022 The paper should disclose whether the full research project required more compute than the experiments reported in the paper (e.g., preliminary or failed experiments that didn\u2019t make it into the paper). ", "page_idx": 47}, {"type": "text", "text": "9. Code Of Ethics ", "text_level": 1, "page_idx": 47}, {"type": "text", "text": "Question: Does the research conducted in the paper conform, in every respect, with the NeurIPS Code of Ethics https://neurips.cc/public/EthicsGuidelines? ", "page_idx": 47}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 47}, {"type": "text", "text": "Justification: The work presented in this paper did not involve human subjects, and all data used was from current publicly available datasets. ", "page_idx": 47}, {"type": "text", "text": "Guidelines: ", "page_idx": 47}, {"type": "text", "text": "\u2022 The answer NA means that the authors have not reviewed the NeurIPS Code of Ethics.   \n\u2022 If the authors answer No, they should explain the special circumstances that require a deviation from the Code of Ethics.   \n\u2022 The authors should make sure to preserve anonymity (e.g., if there is a special consideration due to laws or regulations in their jurisdiction). ", "page_idx": 47}, {"type": "text", "text": "10. Broader Impacts ", "text_level": 1, "page_idx": 47}, {"type": "text", "text": "Question: Does the paper discuss both potential positive societal impacts and negative societal impacts of the work performed? ", "page_idx": 47}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 47}, {"type": "text", "text": "Justification: The objective of this paper is to develop statistically-valid methods to study the semantic importance of human-interpretable concepts for the predictions of black-box models. We envision this research will support better practices towards a responsible use of artificial intelligence in society. ", "page_idx": 47}, {"type": "text", "text": "Guidelines: ", "page_idx": 47}, {"type": "text", "text": "\u2022 The answer NA means that there is no societal impact of the work performed. ", "page_idx": 47}, {"type": "text", "text": "\u2022 If the authors answer NA or No, they should explain why their work has no societal impact or why the paper does not address societal impact.   \n\u2022 Examples of negative societal impacts include potential malicious or unintended uses (e.g., disinformation, generating fake profiles, surveillance), fairness considerations (e.g., deployment of technologies that could make decisions that unfairly impact specific groups), privacy considerations, and security considerations.   \n\u2022 The conference expects that many papers will be foundational research and not tied to particular applications, let alone deployments. However, if there is a direct path to any negative applications, the authors should point it out. For example, it is legitimate to point out that an improvement in the quality of generative models could be used to generate deepfakes for disinformation. On the other hand, it is not needed to point out that a generic algorithm for optimizing neural networks could enable people to train models that generate Deepfakes faster.   \n\u2022 The authors should consider possible harms that could arise when the technology is being used as intended and functioning correctly, harms that could arise when the technology is being used as intended but gives incorrect results, and harms following from (intentional or unintentional) misuse of the technology.   \n\u2022 If there are negative societal impacts, the authors could also discuss possible mitigation strategies (e.g., gated release of models, providing defenses in addition to attacks, mechanisms for monitoring misuse, mechanisms to monitor how a system learns from feedback over time, improving the efficiency and accessibility of ML). ", "page_idx": 48}, {"type": "text", "text": "11. Safeguards ", "text_level": 1, "page_idx": 48}, {"type": "text", "text": "Question: Does the paper describe safeguards that have been put in place for responsible release of data or models that have a high risk for misuse (e.g., pretrained language models, image generators, or scraped datasets)? ", "page_idx": 48}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 48}, {"type": "text", "text": "Justification: The presented paper does not pose such risks. Guidelines: ", "page_idx": 48}, {"type": "text", "text": "\u2022 The answer NA means that the paper poses no such risks.   \n\u2022 Released models that have a high risk for misuse or dual-use should be released with necessary safeguards to allow for controlled use of the model, for example by requiring that users adhere to usage guidelines or restrictions to access the model or implementing safety filters.   \n\u2022 Datasets that have been scraped from the Internet could pose safety risks. The authors should describe how they avoided releasing unsafe images.   \n\u2022 We recognize that providing effective safeguards is challenging, and many papers do not require this, but we encourage authors to take this into account and make a best faith effort. ", "page_idx": 48}, {"type": "text", "text": "12. Licenses for existing assets ", "text_level": 1, "page_idx": 48}, {"type": "text", "text": "Question: Are the creators or original owners of assets (e.g., code, data, models), used in the paper, properly credited and are the license and terms of use explicitly mentioned and properly respected? ", "page_idx": 48}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 48}, {"type": "text", "text": "Justification: We stated all original references of papers and code repositories used for this paper, inclusive of their respective licenses. ", "page_idx": 48}, {"type": "text", "text": "Guidelines: ", "page_idx": 48}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not use existing assets.   \n\u2022 The authors should cite the original paper that produced the code package or dataset.   \n\u2022 The authors should state which version of the asset is used and, if possible, include a URL.   \n\u2022 The name of the license (e.g., CC-BY 4.0) should be included for each asset.   \n\u2022 For scraped data from a particular source (e.g., website), the copyright and terms of service of that source should be provided.   \n\u2022 If assets are released, the license, copyright information, and terms of use in the package should be provided. For popular datasets, paperswithcode.com/datasets has curated licenses for some datasets. Their licensing guide can help determine the license of a dataset.   \n\u2022 For existing datasets that are re-packaged, both the original license and the license of the derived asset (if it has changed) should be provided.   \n\u2022 If this information is not available online, the authors are encouraged to reach out to the asset\u2019s creators. ", "page_idx": 48}, {"type": "text", "text": "", "page_idx": 49}, {"type": "text", "text": "13. New Assets ", "text_level": 1, "page_idx": 49}, {"type": "text", "text": "Question: Are new assets introduced in the paper well documented and is the documentation provided alongside the assets? ", "page_idx": 49}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 49}, {"type": "text", "text": "Justification: The submitted paper does not release new assets. ", "page_idx": 49}, {"type": "text", "text": "Guidelines: ", "page_idx": 49}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not release new assets.   \n\u2022 Researchers should communicate the details of the dataset/code/model as part of their submissions via structured templates. This includes details about training, license, limitations, etc.   \n\u2022 The paper should discuss whether and how consent was obtained from people whose asset is used.   \n\u2022 At submission time, remember to anonymize your assets (if applicable). You can either create an anonymized URL or include an anonymized zip file. ", "page_idx": 49}, {"type": "text", "text": "14. Crowdsourcing and Research with Human Subjects ", "text_level": 1, "page_idx": 49}, {"type": "text", "text": "Question: For crowdsourcing experiments and research with human subjects, does the paper include the full text of instructions given to participants and screenshots, if applicable, as well as details about compensation (if any)? ", "page_idx": 49}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 49}, {"type": "text", "text": "Justification: The submitted paper does not involve crowdsourcing nor research with human subjects. ", "page_idx": 49}, {"type": "text", "text": "Guidelines: ", "page_idx": 49}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Including this information in the supplemental material is fine, but if the main contribution of the paper involves human subjects, then as much detail as possible should be included in the main paper.   \n\u2022 According to the NeurIPS Code of Ethics, workers involved in data collection, curation, or other labor should be paid at least the minimum wage in the country of the data collector. ", "page_idx": 49}, {"type": "text", "text": "15. Institutional Review Board (IRB) Approvals or Equivalent for Research with Human Subjects ", "text_level": 1, "page_idx": 49}, {"type": "text", "text": "Question: Does the paper describe potential risks incurred by study participants, whether such risks were disclosed to the subjects, and whether Institutional Review Board (IRB) approvals (or an equivalent approval/review based on the requirements of your country or institution) were obtained? ", "page_idx": 49}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 49}, {"type": "text", "text": "Justification: The submitted paper does not involve crowdsourcing nor research with human subjects. ", "page_idx": 49}, {"type": "text", "text": "Guidelines: ", "page_idx": 49}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects. ", "page_idx": 49}, {"type": "text", "text": "\u2022 Depending on the country in which research is conducted, IRB approval (or equivalent) may be required for any human subjects research. If you obtained IRB approval, you should clearly state this in the paper.   \n\u2022 We recognize that the procedures for this may vary significantly between institutions and locations, and we expect authors to adhere to the NeurIPS Code of Ethics and the guidelines for their institution.   \n\u2022 For initial submissions, do not include any information that would break anonymity (if applicable), such as the institution conducting the review. ", "page_idx": 50}]