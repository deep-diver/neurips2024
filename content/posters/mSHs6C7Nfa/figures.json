[{"figure_path": "mSHs6C7Nfa/figures/figures_2_1.jpg", "caption": "Figure 1: Rectified flow process (figure modified from Liu et al. [2022]). Rectified flow rewires trajectories so there are no intersecting trajectories (a) \u2192 (b). Then, we take noise samples from pz and their generated samples from px, and linearly interpolate them (c). In Reflow, rectified flow is applied again (c) \u2192 (d) to straighten flows. This procedure is repeated recursively.", "description": "This figure illustrates the rectified flow process, showing how it iteratively learns smooth ODE paths to reduce truncation error.  Panel (a) shows linear interpolation between two distributions (px and pz). Panel (b) shows how rectified flow transforms these paths to eliminate intersections. Panels (c) and (d) demonstrate the iterative refinement of these trajectories through the Reflow algorithm, resulting in straighter, less error-prone paths.", "section": "2.1 Rectified Flow"}, {"figure_path": "mSHs6C7Nfa/figures/figures_3_1.jpg", "caption": "Figure 2: An illustration of the intuition in Sec. 3. (a) If two linear interpolation trajectories intersect, z\" - z' is parallel to x' \u2013 x\". This generally maps z\" to an atypical (e.g., one with high autocorrelation or a norm that is too large to be on a Gaussian annulus) realization of Gaussian noise, so the 1-rectified flow cannot reliably map z\" to x\" on Mx. (b) Generated samples from the pre-trained 1-rectified flow starting from z ~ N(0, I) (right), which is the standard setting, and z\" = z + (x' \u2013 x\"), where x', x\" are sampled from 1-rectified flow trained on CIFAR-10 (left). Qualitatively, we see that the left samples have very low quality. (c) Empirically, we show the l2 norm of z\" = z + (x' \u2013 x\") compared to z', which is sampled from the standard Gaussian. z\" generally lands outside the annulus of typical Gaussian noise. (d) z + (x' \u2013 x') has high autocorrelation while the autocorrelation of Gaussian noise is nearly zero in high-dimensional space.", "description": "This figure illustrates the intuition behind applying Reflow only once.  It shows that if linear interpolation trajectories intersect (meaning the generated noise z is not typical), the 1-rectified flow struggles to map it back to the data space. This suggests that under realistic data distributions, multiple Reflow iterations are unnecessary because the trajectories are already approximately straight after one iteration. The figure supports this by showing that (a) intersecting trajectories lead to atypical noise samples, (b) directly using atypical noise in generating samples produces poor results, (c) atypical noise samples have unusually high norms, and (d) atypical noise samples exhibit high autocorrelation, unlike typical Gaussian noise.", "section": "3 Applying Reflow Once is Sufficient"}, {"figure_path": "mSHs6C7Nfa/figures/figures_4_1.jpg", "caption": "Figure 3: Training loss of the vanilla 2-rectified flow on CIFAR-10 measured on 5,000 samples after 200,000 iterations. The shaded area represents the 1 standard deviation of the loss. The dashed curve is our U-shaped timestep distribution, scaled by a constant factor for visualization.", "description": "This figure shows the training loss curve for a vanilla 2-rectified flow model on the CIFAR-10 dataset.  The x-axis represents the timestep, and the y-axis represents the training loss. The shaded region shows the standard deviation of the loss across multiple runs. A U-shaped curve is overlaid on the plot, which represents the proposed timestep distribution for training the model; it is scaled for better visualization. The plot demonstrates that the loss is higher at the beginning and end of the timestep range and lower in the middle, supporting the U-shaped timestep distribution used in the improved training method.", "section": "4 Improved Training Techniques for Reflow"}, {"figure_path": "mSHs6C7Nfa/figures/figures_8_1.jpg", "caption": "Figure 4: Effects of ODE Solver and new update rule.", "description": "This figure shows the effects of different ODE solvers (Euler and Heun) and a new update rule on the FID (Frechet Inception Distance) for three different datasets: CIFAR-10, AFHQ 64x64, and FFHQ 64x64.  The x-axis represents the number of function evaluations (NFEs), and the y-axis represents the FID. Lower FID values indicate better image quality. The figure demonstrates that the new update rule significantly improves sampling efficiency across all datasets and solvers, achieving the best FID with fewer NFEs.  The plots highlight the trade-off between FID and NFE. Generally, Heun's method outperforms the Euler method.", "section": "5.3 Effects of samplers"}, {"figure_path": "mSHs6C7Nfa/figures/figures_9_1.jpg", "caption": "Figure 5: Inversion results on CIFAR-10. (a) Reconstruction error between real and reconstructed data is measured by the mean squared error (MSE), where the x-axis represents NFEs used for inversion and reconstruction (e.g., 2 means 2 for inversion and 2 for reconstruction). (b) Distribution of ||z||2 of the inverted noises as a proxy for Gaussianity (NFE = 8). The green histogram represents the distribution of true noise, which is Chi-squared with 3 \u00d7 32 \u00d7 32 = 3072 degrees of freedom. (c) Inversion and reconstruction results using (8 + 8) NFEs. With only 8 NFEs, EDM fails to produce realistic noise, and also the reconstructed samples are blurry.", "description": "This figure demonstrates the inversion capabilities of the proposed 2-rectified flow++ model on CIFAR-10 dataset. It compares the reconstruction error with EDM, shows the distribution of the norm of inverted noise, and visually presents inversion and reconstruction results. The results highlight that 2-rectified flow++ achieves lower reconstruction error and more realistic noise compared to EDM, especially with fewer function evaluations.", "section": "5.4 Inversion"}, {"figure_path": "mSHs6C7Nfa/figures/figures_9_2.jpg", "caption": "Figure 6: Applications of few-step inversion. (a) Interpolation between two real images. (b) Image-to-image translation. The total NFEs used are 6 (4 for inversion and 2 for generation).", "description": "This figure demonstrates two applications of few-step inversion using rectified flow. The first row shows the interpolation between two real images (dog and lion). The second row shows the image-to-image translation between two real images (tiger and lion). The total number of function evaluations (NFEs) used in each application is 6, where 4 NFEs are used for inversion and 2 NFEs are used for generation.", "section": "5.4 Inversion"}, {"figure_path": "mSHs6C7Nfa/figures/figures_14_1.jpg", "caption": "Figure 2: An illustration of the intuition in Sec. 3. (a) If two linear interpolation trajectories intersect, z\" - z' is parallel to x' \u2013 x\". This generally maps z\" to an atypical (e.g., one with high autocorrelation or a norm that is too large to be on a Gaussian annulus) realization of Gaussian noise, so the 1-rectified flow cannot reliably map z\" to x\" on Mx. (b) Generated samples from the pre-trained 1-rectified flow starting from z ~ N(0, I) (right), which is the standard setting, and z\" = z + (x' \u2013 x\"), where x', x\" are sampled from 1-rectified flow trained on CIFAR-10 (left). Qualitatively, we see that the left samples have very low quality. (c) Empirically, we show the l2 norm of z\" = z + (x' \u2013 x\") compared to z', which is sampled from the standard Gaussian. z\" generally lands outside the annulus of typical Gaussian noise. (d) z + (x' \u2013 x') has high autocorrelation while the autocorrelation of Gaussian noise is nearly zero in high-dimensional space.", "description": "This figure illustrates the intuition behind applying Reflow only once.  Panel (a) shows that if trajectories intersect, the resulting noise z'' is atypical (high autocorrelation, large norm). Panel (b) shows that generating samples from this atypical noise leads to poor quality samples. Panel (c) shows that the norm of z'' is larger than the norm of z, and panel (d) shows that z'' has high autocorrelation, unlike typical Gaussian noise. These observations suggest that a single Reflow iteration is sufficient.", "section": "3 Applying Reflow Once is Sufficient"}, {"figure_path": "mSHs6C7Nfa/figures/figures_17_1.jpg", "caption": "Figure 2: An illustration of the intuition in Sec. 3. (a) If two linear interpolation trajectories intersect, z\" - z' is parallel to x' - x\". This generally maps z\" to an atypical (e.g., one with high autocorrelation or a norm that is too large to be on a Gaussian annulus) realization of Gaussian noise, so the 1-rectified flow cannot reliably map z\" to x\" on Mx. (b) Generated samples from the pre-trained 1-rectified flow starting from z ~ N(0, I) (right), which is the standard setting, and z\" = z + (x' \u2013 x\"), where x', x\" are sampled from 1-rectified flow trained on CIFAR-10 (left). Qualitatively, we see that the left samples have very low quality. (c) Empirically, we show the l2 norm of z\" = z + (x' \u2013 x\") compared to z', which is sampled from the standard Gaussian. z\" generally lands outside the annulus of typical Gaussian noise. (d) z + (x' \u2013 x') has high autocorrelation while the autocorrelation of Gaussian noise is nearly zero in high-dimensional space.", "description": "This figure illustrates the intuition behind applying Reflow only once. It shows that if linear interpolation trajectories intersect, it leads to atypical Gaussian noise realizations, resulting in low-quality generated samples.  The figure provides empirical evidence supporting the claim that under realistic settings, a single Reflow iteration is sufficient to learn nearly straight trajectories.", "section": "3 Applying Reflow Once is Sufficient"}, {"figure_path": "mSHs6C7Nfa/figures/figures_19_1.jpg", "caption": "Figure 1: Rectified flow process (figure modified from Liu et al. [2022]). Rectified flow rewires trajectories so there are no intersecting trajectories (a) \u2192 (b). Then, we take noise samples from pz and their generated samples from p, and linearly interpolate them (c). In Reflow, rectified flow is applied again (c) \u2192 (d) to straighten flows. This procedure is repeated recursively.", "description": "This figure illustrates the rectified flow process, showing how it iteratively refines the ODE paths to avoid intersections. It begins with linear interpolation between data and noise distributions, then applies the rectified flow algorithm to straighten the paths. This process, called Reflow, is repeated to further refine the paths and improve sample quality. The figure shows four stages of the process, highlighting the transition from intersecting trajectories to more straight trajectories.", "section": "2.1 Rectified Flow"}, {"figure_path": "mSHs6C7Nfa/figures/figures_19_2.jpg", "caption": "Figure 1: Rectified flow process (figure modified from Liu et al. [2022]). Rectified flow rewires trajectories so there are no intersecting trajectories (a) \u2192 (b). Then, we take noise samples from pz and their generated samples from p, and linearly interpolate them (c). In Reflow, rectified flow is applied again (c) \u2192 (d) to straighten flows. This procedure is repeated recursively.", "description": "This figure illustrates the process of rectified flow, showing how it iteratively learns smooth ODE paths to improve sample quality. Panel (a) depicts linear interpolation between data and noise distributions, while (b) shows how rectified flow rewires trajectories to avoid intersections.  Panel (c) demonstrates linear interpolation of rectified flow generated samples, while (d) shows how reflow further straightens the paths by recursively applying the process. The reflow algorithm aims to reduce the number of function evaluations by learning straighter paths in the ODE space.", "section": "2.1 Rectified Flow"}, {"figure_path": "mSHs6C7Nfa/figures/figures_20_1.jpg", "caption": "Figure 1: Rectified flow process (figure modified from Liu et al. [2022]). Rectified flow rewires trajectories so there are no intersecting trajectories (a) \u2192 (b). Then, we take noise samples from pz and their generated samples from px, and linearly interpolate them (c). In Reflow, rectified flow is applied again (c) \u2192 (d) to straighten flows. This procedure is repeated recursively.", "description": "This figure illustrates the rectified flow process.  Panel (a) shows linear interpolation between two distributions, px and pz. Panel (b) shows how rectified flow modifies these trajectories to eliminate intersections, making them less susceptible to truncation error. Panel (c) shows linear interpolation using samples from the modified trajectories. Finally, panel (d) depicts the recursive application of rectified flow (Reflow) to further straighten trajectories, improving sample quality with fewer function evaluations.", "section": "2.1 Rectified Flow"}, {"figure_path": "mSHs6C7Nfa/figures/figures_20_2.jpg", "caption": "Figure 8: Synthetic samples from 2-rectified flow++ on CIFAR-10 with NFE = 1 (FID=3.38).", "description": "This figure shows a grid of 2500 synthetic images generated by the 2-rectified flow++ model trained on the CIFAR-10 dataset.  The images were generated using only one function evaluation (NFE), and the model achieved a Fr\u00e9chet Inception Distance (FID) score of 3.38.  A lower FID score indicates that the generated images are more realistic and closer in distribution to real CIFAR-10 images.", "section": "G Uncurated Synthetic Samples"}, {"figure_path": "mSHs6C7Nfa/figures/figures_21_1.jpg", "caption": "Figure 1: Rectified flow process (figure modified from Liu et al. [2022]). Rectified flow rewires trajectories so there are no intersecting trajectories (a) \u2192 (b). Then, we take noise samples from pz and their generated samples from px, and linearly interpolate them (c). In Reflow, rectified flow is applied again (c) \u2192 (d) to straighten flows. This procedure is repeated recursively.", "description": "This figure illustrates the rectified flow process. Panel (a) shows linear interpolation between two distributions. Panel (b) shows how rectified flow modifies the trajectories to avoid intersections. Panel (c) shows linear interpolation using samples from the modified distribution, and Panel (d) demonstrates the iterative application of rectified flow (Reflow) to further straighten the trajectories.", "section": "2.1 Rectified Flow"}, {"figure_path": "mSHs6C7Nfa/figures/figures_21_2.jpg", "caption": "Figure 8: Synthetic samples from 2-rectified flow++ on CIFAR-10 with NFE = 1 (FID=3.38).", "description": "This figure displays a grid of 100 images generated from the 2-rectified flow++ model trained on the CIFAR-10 dataset.  Each image is a synthetic sample produced using only one function evaluation (NFE). The FID (Frechet Inception Distance) score of 3.38 indicates good image quality for such a low computational cost.", "section": "G Uncurated Synthetic Samples"}, {"figure_path": "mSHs6C7Nfa/figures/figures_22_1.jpg", "caption": "Figure 8: Synthetic samples from 2-rectified flow++ on CIFAR-10 with NFE = 1 (FID=3.38).", "description": "This figure displays a grid of 256 synthetic images generated using the improved 2-rectified flow++ method.  The images are generated from a single forward pass (NFE = 1) and achieve a Fr\u00e9chet Inception Distance (FID) score of 3.38, demonstrating the model's ability to generate high-quality images with minimal computational cost.", "section": "G Uncurated Synthetic Samples"}, {"figure_path": "mSHs6C7Nfa/figures/figures_22_2.jpg", "caption": "Figure 8: Synthetic samples from 2-rectified flow++ on CIFAR-10 with NFE = 1 (FID=3.38).", "description": "This figure displays a grid of 2500 synthetic images generated using the 2-rectified flow++ method on the CIFAR-10 dataset.  The images were generated using only one function evaluation (NFE).  The FID (Fr\u00e9chet Inception Distance) score, a measure of image quality, is 3.38, indicating reasonable image generation quality considering the limited computational resources (1 NFE).", "section": "G Uncurated Synthetic Samples"}, {"figure_path": "mSHs6C7Nfa/figures/figures_23_1.jpg", "caption": "Figure 8: Synthetic samples from 2-rectified flow++ on CIFAR-10 with NFE = 1 (FID=3.38).", "description": "This figure displays a grid of 2500 synthetic images generated using the proposed 2-rectified flow++ method on the CIFAR-10 dataset.  The images were generated using only a single function evaluation (NFE=1). The FID (Fr\u00e9chet Inception Distance) score of 3.38 indicates the quality of the generated images relative to the real CIFAR-10 images; lower scores suggest better image quality.", "section": "G Uncurated Synthetic Samples"}, {"figure_path": "mSHs6C7Nfa/figures/figures_23_2.jpg", "caption": "Figure 16: Synthetic samples from 2-rectified flow++ on AFHQ 64\u00d764 with NFE = 1 (FID=4.11).", "description": "This figure shows a grid of 256 synthetic images of animals generated by the 2-rectified flow++ model.  These images are from the AFHQ 64\u00d764 dataset, and the model was run with only one function evaluation (NFE). The FID score of 4.11 indicates a relatively high quality of image generation compared to other methods at similar NFEs.", "section": "G Uncurated Synthetic Samples"}, {"figure_path": "mSHs6C7Nfa/figures/figures_24_1.jpg", "caption": "Figure 1: Rectified flow process (figure modified from Liu et al. [2022]). Rectified flow rewires trajectories so there are no intersecting trajectories (a) \u2192 (b). Then, we take noise samples from pz and their generated samples from px, and linearly interpolate them (c). In Reflow, rectified flow is applied again (c) \u2192 (d) to straighten flows. This procedure is repeated recursively.", "description": "This figure illustrates the rectified flow process, showing how it iteratively refines ODE trajectories to be less susceptible to truncation errors. Panel (a) shows linear interpolation trajectories between two distributions. Panel (b) shows the generative process of a 1-rectified flow that removes trajectory intersections. Panel (c) shows linear interpolation using the generated samples from the 1-rectified flow. Panel (d) shows the generative process of a 2-rectified flow where the process is repeated recursively.", "section": "2.1 Rectified Flow"}, {"figure_path": "mSHs6C7Nfa/figures/figures_24_2.jpg", "caption": "Figure 1: Rectified flow process (figure modified from Liu et al. [2022]). Rectified flow rewires trajectories so there are no intersecting trajectories (a) \u2192 (b). Then, we take noise samples from pz and their generated samples from px, and linearly interpolate them (c). In Reflow, rectified flow is applied again (c) \u2192 (d) to straighten flows. This procedure is repeated recursively.", "description": "This figure illustrates the rectified flow process, showing how it iteratively refines trajectories to make them straighter. Panel (a) shows linear interpolation between two distributions (px and pz), (b) shows the effect of applying rectified flow once to remove intersecting trajectories. (c) illustrates the linear interpolation performed after applying rectified flow. (d) shows the result after recursively applying rectified flow multiple times. The process iteratively straightens the trajectories which makes sampling from the model more efficient.", "section": "2.1 Rectified Flow"}, {"figure_path": "mSHs6C7Nfa/figures/figures_25_1.jpg", "caption": "Figure 1: Rectified flow process (figure modified from Liu et al. [2022]). Rectified flow rewires trajectories so there are no intersecting trajectories (a) \u2192 (b). Then, we take noise samples from pz and their generated samples from px, and linearly interpolate them (c). In Reflow, rectified flow is applied again (c) \u2192 (d) to straighten flows. This procedure is repeated recursively.", "description": "This figure illustrates the rectified flow process, showing how it iteratively learns smooth ODE paths to reduce truncation error.  Panel (a) shows linear interpolation between two distributions, (b) shows how rectified flow modifies trajectories to remove intersections, (c) shows linear interpolation of noise samples and their corresponding generated samples, and (d) depicts the iterative refinement process (Reflow) for straightening the flow.", "section": "2.1 Rectified Flow"}, {"figure_path": "mSHs6C7Nfa/figures/figures_25_2.jpg", "caption": "Figure 5: Inversion results on CIFAR-10. (a) Reconstruction error between real and reconstructed data is measured by the mean squared error (MSE), where the x-axis represents NFEs used for inversion and reconstruction (e.g. 2 means 2 for inversion and 2 for reconstruction). (b) Distribution of ||z||2 of the inverted noises as a proxy for Gaussianity (NFE = 8). The green histogram represents the distribution of true noise, which is Chi-squared with 3 \u00d7 32 \u00d7 32 = 3072 degrees of freedom. (c) Inversion and reconstruction results using (8 + 8) NFEs. With only 8 NFES, EDM fails to produce realistic noise, and also the reconstructed samples are blurry.", "description": "This figure shows the inversion results of the proposed method on CIFAR-10 dataset. The reconstruction error is measured using MSE. The distribution of the norm of the inverted noise is shown to evaluate the quality of the inversion process. Finally, the inversion and reconstruction results are shown visually, demonstrating the quality of the inversion. The method outperforms EDM, which fails to produce realistic noise with only 8 NFEs.", "section": "5.4 Inversion"}]