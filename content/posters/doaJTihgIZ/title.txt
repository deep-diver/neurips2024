Dynamics of Supervised and Reinforcement Learning in the Non-Linear Perceptron