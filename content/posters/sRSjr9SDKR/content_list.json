[{"type": "text", "text": "Preferential Normalizing Flows ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Petrus Mikkola, Luigi Acerbi,\u2217 Arto Klami\u2217 Department of Computer Science, University of Helsinki first.last@helsinki.fi ", "page_idx": 0}, {"type": "text", "text": "Abstract ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Eliciting a high-dimensional probability distribution from an expert via noisy judgments is notoriously challenging, yet useful for many applications, such as prior elicitation and reward modeling. We introduce a method for eliciting the expert\u2019s belief density as a normalizing flow based solely on preferential questions such as comparing or ranking alternatives. This allows eliciting in principle arbitrarily flexible densities, but flow estimation is susceptible to the challenge of collapsing or diverging probability mass that makes it difficult in practice. We tackle this problem by introducing a novel functional prior for the flow, motivated by a decision-theoretic argument, and show empirically that the belief density can be inferred as the function-space maximum a posteriori estimate. We demonstrate our method by eliciting multivariate belief densities of simulated experts, including the prior belief of a general-purpose large language model over a real-world dataset. ", "page_idx": 0}, {"type": "text", "text": "1 Introduction ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Representing beliefs as probability distributions can be useful, particularly as prior probability distributions in Bayesian inference \u2013 especially in high-dimensional, non-asymptotic settings where the prior strongly influences the posterior [Gelman et al., 2017] \u2013 or as probabilistic alternatives to reward models [Leike et al., 2018, Ouyang et al., 2022]. Our goal is to elicit a complex multivariate probability density from an expert, as a representation of their beliefs. By expert, we mean an information source with a belief over a problem of interest, termed belief density, which does not permit direct evaluation or sampling. The problem is an instance of expert knowledge elicitation, where the belief is elicited by asking elicitation queries such as quantiles of the distribution [O\u2019Hagan, 2019]. The current elicitation literature (see Mikkola et al. 2023 for a recent overview) focuses almost exclusively on extremely simple distributions, mostly products of univariate distributions of known parametric form. Some isolated works have considered more flexible distributions, for instance quantile-parameterized distributions [Perepolkin et al., 2024] for univariate cases, or Gaussian processes [Oakley and O\u2019Hagan, 2007] and copulas for modelling low-dimensional dependencies [Clemen et al., 2000], but we want to move considerably beyond that and elicit flexible beliefs using modern neural network representations [Bishop and Bishop, 2023]. The main challenges are identifying elicitation queries that are sufficiently informative to infer the belief density while being feasible for the expert to answer reliably, and selecting a model class for the belief density that can represent flexible beliefs without simplifying assumptions but that can still be efficiently estimated. ", "page_idx": 0}, {"type": "text", "text": "Normalizing flows are a natural family for representing flexible distributions [Papamakarios et al., 2021]. When using flows for modelling a density $p(\\mathbf x)$ , learning is usually based on either a set of samples $\\mathbf{x}\\sim p(\\mathbf{x})$ drawn from the distribution (density estimation; Dinh et al., 2014) or on the log density $\\log p(\\mathbf{x})$ evaluated at flow samples, $\\mathbf{x}\\sim q(\\mathbf{x})$ , in the variational inference formulation [Rezende and Mohamed, 2015]. Neither strategy applies to our setup, since we do not have the luxury of sampling from the belief density and obviously cannot evaluate it either. In addition to the well-known challenges of training normalizing flows, the setup introduces new difficulties; in particular, a flexible flow easily collapses or finds a way of allocating probability mass in undesirable ways. Significant literature on resolving these issues exists [Behrmann et al., 2021, Salmona et al., 2022, Cornish et al., 2020], but conclusive solutions that guarantee stable learning are still missing. Our solution offers new tools for controlling the flow in low-density areas, and hence we contribute for the general flow literature despite focusing on the specific new task. ", "page_idx": 0}, {"type": "image", "img_path": "sRSjr9SDKR/tmp/3dc92e05874abf1d4264566c2ea38bf95384cbcff252084b26e17c8b27f44ac0.jpg", "img_caption": ["Figure 1: Illustration of belief densities elicited from preferential ranking data by a normalizing flow (contour: true density; heatmap: estimated flow; red: preferred points; blue: non-preferred points). (a)-(b): Typical failure modes of collapsing and diverging mass, when training a flow with just $n=10$ rankings. (c)-(d): The proposed functional prior resolves the issues, and already with 10 rankings we can learn the correct belief density, matching the result of the flow trained on larger data. "], "img_footnote": [], "page_idx": 1}, {"type": "text", "text": "", "page_idx": 1}, {"type": "text", "text": "We build on established literature on knowledge elicitation for the interaction with the expert. Distributions are primarily characterized by their location and covariance structure, yet humans are notoriously bad at assessing covariances between variables [Jennings et al., 1982, Wilson, 1994]. However, human preferences, with potentially strong interconnections between variables, can be recovered by asking individuals to compare or rank alternatives, a topic studied under discrete choice theory [Train, 2009]. The most studied random utility models (RUMs) interpret human choice as utility maximization with an additive noise component [Marschak, 1959]. To infer the correlation structure in human beliefs indirectly from elicitation data, we study a setup where the expert compares or ranks alternatives (events) based on their probability so that their decisions can be modeled by a RUM. In practice, this means that the data for learning the flow will take the form of choice sets $\\mathcal{C}_{k}=\\{\\mathbf{x}_{1},...,\\mathbf{x}_{k}\\}$ of candidates presented to the expert, combined with their choices indicating the preference over the alternatives based on their probability. We stress that candidates $\\mathbf{x}$ are here not samples from the belief density but are instead provided by some other unknown process, such as an active learning method [Houlsby et al., 2011]. The only information about the belief density comes from the choice. ", "page_idx": 1}, {"type": "text", "text": "We are not aware of any previous works that learn flows from preferential comparisons. We first discuss some additional challenges caused by preferential data, and then show how we can leverage preferential structure to improve learning. Specifically, our learning objective corresponds to a function-space maximum a posteriori (FS-MAP), where Bayesian inference is conducted on the function (flow) itself, not its parameters [Wolpert, 1993, Qiu et al., 2024]. The learning objective is exact, in contrast to flow-based algorithms that model phenomena involving discontinuities [Nielsen et al., 2020, Hoogeboom et al., 2021], such as the argmax operator in the RUM model. By construction, the choice sets explicitly include candidates x that were not preferred by the expert, carrying information about relative densities of preferred vs. not preferred points. This allows us to introduce a functional prior that encourages allocating more mass to regions with high probability under a RUM with exponential noise, solving the collapsing and diverging probability mass problem that poses a challenge for flow inference in small data scenarios. ", "page_idx": 1}, {"type": "text", "text": "In summary, we introduce the novel problem of inferring probability density from preferential data using normalizing flows and provide a practical solution. We model the expert\u2019s choice as a RUM with exponentially distributed noise, and query the expert for comparison or ranking of $k$ alternatives. We derive the likelihoods for $k$ -wise comparisons and rankings and study the distribution of the most preferred point among $k$ alternatives, which we term the $k$ -wise winner. Based on the interpretation of the $k$ -wise winner distribution as a tempered and tilted belief density, we introduce an empirical function prior and the FS-MAP objective for learning the flow. Finally, we validate our method using both synthetic and real data sets. ", "page_idx": 1}, {"type": "text", "text": "", "page_idx": 2}, {"type": "text", "text": "2 Why learning the density from preferential data is challenging? ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "Learning flows from small samples is challenging, especially in higher dimensions even when learning from direct data, such as samples from the density. Figure 1 illustrates two common challenges of collapsing and diverging probability mass; the illustration is based on our setup to showcase the proposed solution, but the same problems occur in the classical setup. The \u201ccollapsing mass\u201d scenario is a form of overftiting, similar to mode collapse in mixture models [Li et al., 2007], but more extreme for flexible models. ", "page_idx": 2}, {"type": "text", "text": "In the \u201cdiverging mass\u201d problem, the model places probability mass in the regions of low probability. The problem has connections to difficulties in training [Behrmann et al., 2021, Dhaka et al., 2021, Vaitl et al., 2022, Liang et al., 2022] and issues with coupling flows with increasing depth, which tend to produce exponentially large sample values [Behrmann et al., 2021, Andrade, 2024]. One intuitive explanation is that we simply have no information on how the flow should behave far from the training samples, and an arbitrarily flexible model will at least in some cases behave unexpectedly. ", "page_idx": 2}, {"type": "text", "text": "If already learning a flow from samples drawn from the density itself is difficult, is it even possible to infer the belief density from preferential data? For instance, for the most popular RUM model (Plackett-Luce; Luce, 1959, Plackett, 1975) we cannot in the noiseless case differentiate between the true density and any normalised positive monotonic transformation of it: ", "page_idx": 2}, {"type": "text", "text": "Proposition 2.1 (Unidentifiability of a noiseless RUM). Let $p_{\\star}$ be the expert\u2019s belief density. For $k\\ge$ 2, let $\\mathcal{D}_{r a n k}:=\\left\\{\\mathbf{x}_{1}\\succ\\mathbf{x}_{2}\\succ\\ldots\\succ\\mathbf{x}_{k}\\right\\}$ be a $k$ -wise ranking (see Definition 3.3). If $W\\sim G u m b e l(0,\\beta),$ , then for any positive monotonic transformation $g$ holds $\\begin{array}{r}{\\operatorname*{lim}_{\\beta\\to0}p(\\mathcal{D}_{r a n k}|g\\circ p_{\\star},\\beta)=1}\\end{array}$ . Proof in $B$ . ", "page_idx": 2}, {"type": "text", "text": "In other words, the noiseless solution is not even unique and resolving this requires a way of quantifying the relative utility. Noisy RUM induces such a metric due to the noise magnitude providing a natural scale but even then the belief is identifiable only up to a noise scale; see A for a concrete example for the Thurstone-Mosteller model [Thurstone, 1927, Mosteller, 1951]. ", "page_idx": 2}, {"type": "text", "text": "Another new challenge is that the candidates $\\mathbf{x}$ presented to the expert are given by some external process. In the simplest case, they are drawn independently from some unknown distribution $\\lambda(\\mathbf{x})$ , which does not need to relate to the belief density $p_{\\star}$ . We need a formulation that affords estimating $p_{\\star}$ directly, ideally under minimal assumptions on the distribution besides $\\lambda(\\mathbf{x})>0$ for $p_{\\star}(\\mathbf{x})>0$ . ", "page_idx": 2}, {"type": "text", "text": "Despite these challenges, we can indeed learn flows as estimates of belief densities as will be explained next, in part by leveraging standard machinery in discrete choice theory to model the expert\u2019s choices and in part by introducing a new functional prior for the normalizing flow. The choice process separates the candidate samples $\\mathbf{x}$ into preferred and non-preferred ones, and we can use this split to construct a prior that helps learning the flow. That is, the preferential setup also opens new opportunities to address problems in learning flows. ", "page_idx": 2}, {"type": "text", "text": "3 Random utility model with exponentially distributed noises ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "The random utility model represents the decision maker\u2019s stochastic utility $U$ as the sum of a deterministic utility and a stochastic perturbation [Train, 2009], ", "page_idx": 2}, {"type": "equation", "text": "$$\nU(\\mathbf{x})=f(\\mathbf{x})+W(\\mathbf{x}),\n$$", "text_format": "latex", "page_idx": 2}, {"type": "text", "text": "where $f:\\mathcal{X}\\to\\mathbb{R}$ is a deterministic function called representative utility, and $W$ is a stochastic noise process, often independent across $\\mathbf{x}$ . The relationship between these concepts and the task will be made specific in Assumptions 1 to 3. We assume that the domain $\\mathcal{X}$ is a compact subset of $\\mathbb{R}^{d}$ . Given a set ${\\mathcal{C}}\\subset{\\mathcal{X}}$ of possible alternatives, the expert selects a specific opinion $\\mathbf{x}\\in{\\mathcal{C}}$ through the noisy utility maximization, ", "page_idx": 2}, {"type": "equation", "text": "$$\n\\mathbf{x}\\sim\\arg\\operatorname*{max}_{\\mathbf{x}^{\\prime}\\in\\mathcal{C}}U(\\mathbf{x}^{\\prime}).\n$$", "text_format": "latex", "page_idx": 2}, {"type": "text", "text": "Definition 3.1 (choice set). Let $k\\ \\geq\\ 2$ . The choice set is a set of $k$ alternatives, denoted by $\\mathcal{C}_{k}=\\{\\mathbf{x}_{1},...,\\mathbf{x}_{k}\\}$ . We assume that $\\mathcal{C}_{k}$ is a set of i.i.d. samples from a probability density $\\lambda$ over $\\mathcal{X}$ , but note that the formulation can be generalized to other processes. ", "page_idx": 2}, {"type": "text", "text": "For example, if we ask for a pairwise comparison $\\mathcal{C}_{2}=(\\mathbf{x},\\mathbf{x}^{\\prime})$ , the expert\u2019s answer would be $\\mathbf{x}\\succ\\mathbf{x}^{\\prime}$ if $f(\\mathbf{x})+\\stackrel{\\cdot}{w}(\\mathbf{x})>f(\\mathbf{x}^{\\prime})+\\bar{w^{\\prime}}(\\mathbf{x}^{\\prime})$ for given a realization $w$ of $W$ . We denote the random utility model with a representative utility $f$ , a stochastic noise process $W$ , and a choice set $\\mathcal{C}_{k}$ , by $\\mathrm{RUM}(\\mathcal{C}_{k},f,W)$ . ", "page_idx": 3}, {"type": "text", "text": "We make the common assumption of representing the probabilistic beliefs of a (human) expert in logarithmic form [Dehaene, 2003]. ", "page_idx": 3}, {"type": "text", "text": "Assumption 1. $f(\\mathbf{x})=\\log p_{\\star}(\\mathbf{x})$ ; noise is additive for log-density. ", "page_idx": 3}, {"type": "text", "text": "Assumption 2. $f$ is bounded and continuous. ", "page_idx": 3}, {"type": "text", "text": "Inspired by Malmberg and H\u00f6ssjer [2012, 2014], we assume that the noise is exponentially distributed and thus belongs to the exponential family [Azari et al., 2012]. ", "page_idx": 3}, {"type": "text", "text": "Assumption 3. $W(\\mathbf{x})\\sim\\mathrm{Exp}(s)$ independently for any $\\mathbf{x}\\in\\mathcal{X}$ ", "page_idx": 3}, {"type": "text", "text": "With Assumption 1, this corresponds to a model where in the limit of infinitely many alternatives, the expert chooses a point by sampling their belief density (Corollary A.2). The parameter $s$ is here a precision parameter, the reciprocal of the standard deviation of $\\operatorname{Exp}(s)$ . There are two popular types of preferential queries [F\u00fcrnkranz and H\u00fcllermeier, 2011]. ", "page_idx": 3}, {"type": "text", "text": "Definition 3.2 ( $k$ -wise comparison). A preferential query that asks the expert to choose the most preferred alternative from $\\mathcal{C}_{k}$ is called a $k$ -wise comparison. The choice is denoted by $\\mathbf{x}\\succ\\mathcal{C}_{k}$ . ", "page_idx": 3}, {"type": "text", "text": "Definition 3.3 $k$ -wise ranking). A preferential query that asks the expert to rank the alternatives in $\\mathcal{C}_{k}$ from the most preferred to the least preferred is a called $k$ -wise ranking. The expert\u2019s feedback is the ordering $\\mathbf{x}_{\\pi(\\mathcal{C}_{k})_{1}}\\succ...\\succ\\mathbf{x}_{\\pi(\\mathcal{C}_{k})_{k}}$ for some permutation $\\pi$ . ", "page_idx": 3}, {"type": "text", "text": "Note that the top-ranked sample of $\\mathbf{k}$ -wise ranking is the same as the $\\boldsymbol{\\mathrm{k}}$ -wise comparison choice, and the $\\boldsymbol{\\mathrm{k}}$ -wise ranking can be formed as a sequence of $\\boldsymbol{\\mathrm{k}}$ -wise comparisons by repeatedly removing the selected candidate from the choice set, as assumed in the Plackett-Luce model [Plackett, 1975]. Hence, common theoretical tools cover both cases. ", "page_idx": 3}, {"type": "text", "text": "3.1 The $k$ -wise winner ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "The chosen point of a $k$ -wise comparison is central to us for two reasons. First, its distribution provides the likelihood for inference when data come in the format of $k$ -wise rankings or comparisons. Second, its distribution in the limit as $k\\rightarrow\\infty$ offers insights for designing a prior that mitigates the challenge of collapsing and diverging probability mass. ", "page_idx": 3}, {"type": "text", "text": "Definition 3.4 ( $k$ -wise winner). A random vector $X_{k}^{\\star}$ given by the following generative process is called as $k$ -wise winner. ", "page_idx": 3}, {"type": "text", "text": "1. Sample $k$ -samples from $\\lambda(\\mathbf{x})$ , and denote $\\mathcal{C}_{k}=\\{\\mathbf{x}_{1},...,\\mathbf{x}_{k}\\}$ .   \n2. Sample $\\mathbf{x}$ from a Categorical distribution with support $\\mathcal{C}_{k}$ and with probabilities given by $\\mathrm{RUM}(\\mathcal{C}_{k};\\log p_{\\star}(\\mathbf{x}),\\mathrm{Exp}(s))$ . ", "page_idx": 3}, {"type": "text", "text": "The density of the $k$ -wise winner is proportional to the $k$ -wise comparison likelihood $p(\\mathbf{x}\\succ\\mathcal{C}_{k}\\mid\\mathcal{C}_{k})$ , namely to $p(\\mathbf{x}\\succ C_{k}\\mid\\mathcal{C}_{k})\\lambda(\\mathcal{C}_{k})$ . The likelihood of the $k$ -wise comparisons takes the following form. ", "page_idx": 3}, {"type": "text", "text": "Proposition 3.5. Let $\\mathcal{C}_{k}$ be a choice set of $k\\geq2$ alternatives. Denote $C={\\mathcal{C}}_{k}\\setminus\\{\\mathbf{x}\\}$ and $f_{C}^{\\star}=$ $\\mathrm{max}_{\\mathbf{x}_{j}\\in C}\\,f(\\mathbf{x}_{j})$ . The winning probability of a point $\\mathbf{x}\\in{\\mathcal{C}}_{k}$ equals to ", "page_idx": 3}, {"type": "equation", "text": "$$\n^3(\\mathbf x\\,\\sim\\mathcal C_{k}\\ |\\ {\\mathcal C}_{k})=\\sum_{l=0}^{k-1}\\frac{\\exp\\big(-s(l+1)\\operatorname*{max}\\{f_{C}^{\\star}-f(\\mathbf x),0\\}\\big)}{l+1}\\sum_{s y m\\cdot\\mathbf x_{j}\\in C}^{l}-\\exp(-s(f(\\mathbf x)-f(\\mathbf x_{j}))),\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "where $\\sum_{s y m:\\mathbf{x}_{j}\\in C}^{l}$ denotes the $l^{t h}$ elementary symmetric sum of the set $C$ ", "page_idx": 3}, {"type": "text", "text": "Proof. See B. ", "page_idx": 3}, {"type": "text", "text": "The $k$ -wise ranking likelihood is a product of the $k$ -wise comparison likelihoods where the winners are sequentially removed from the choice set and provided in Appendix A as Equation (A.4). ", "page_idx": 3}, {"type": "text", "text": "In the limit of infinitely many comparisons, the $k$ -wise distribution reduces to a tempered belief density tilted by the sampling distribution $\\lambda$ [Malmberg and H\u00f6ssjer, 2012, 2014]. ", "page_idx": 3}, {"type": "image", "img_path": "sRSjr9SDKR/tmp/9d90f11fd69f9d3863b2fe9e1a9c8ff8706e26a7e76517a0f98cc5b7f00769a0.jpg", "img_caption": ["Figure 2: (a) The $k$ -wise winner distribution converges to the belief density as $k\\rightarrow\\infty$ . (b) The $k$ -wise winner distribution can be approximated by a tempered belief density. For example, the tempered belief density with an exponent $1/5$ approximates well the pairwise winner distribution. "], "img_footnote": [], "page_idx": 4}, {"type": "text", "text": "Theorem 3.6. If $f$ is bounded and continuous, then the limit distribution of $X_{k}^{\\star}$ as $k\\rightarrow\\infty$ exists and its density is given by, ", "page_idx": 4}, {"type": "equation", "text": "$$\np(\\mathbf{x})=\\frac{\\exp\\left(s f(\\mathbf{x})\\right)\\lambda(\\mathbf{x})}{\\int\\exp\\left(s f(\\mathbf{x}^{\\prime})\\right)\\lambda(\\mathbf{x}^{\\prime})d\\mathbf{x}^{\\prime}}.\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "Proof. Apply Theorem 18.4 in [Malmberg and H\u00f6ssjer, 2014] to our setting and note that the first sentence in the proof of Theorem 18.4 is incorrect. For a random variable $Y=X/s$ with $X\\sim\\operatorname{Exp}(s)$ it holds that $\\boldsymbol{Y}\\stackrel{*}{\\sim}\\mathrm{Exp}(s^{2})$ . However, for a random variable $Y=s X$ with $X\\sim\\operatorname{Exp}(s)$ it holds that $Y\\sim\\mathrm{Exp}(1)$ . Thus, the correct standardization is $Y\\leftarrow s Y$ . \u53e3 ", "page_idx": 4}, {"type": "text", "text": "3.2 The $k$ -wise winner distribution as a tilted and tempered belief density ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "Building on the definitions and theorems above, we now introduce the central idea of how to model the belief density based on the $k$ -wise winner distribution. The RUM precision parameter $s$ acts as a temperature parameter for the belief density, as $p(\\mathbf{x})\\,\\propto\\,\\lambda(\\mathbf{x})p_{\\star}(\\bar{\\mathbf{x}_{\\star}})^{s}$ , by Eq. (4). In general, there is no connection between $\\lambda(\\mathbf{x})$ and $p_{\\star}(\\mathbf{x})$ , but intuition can be gained by considering some extreme cases. For $\\lambda=p_{\\star}$ we have $p(\\mathbf{x})\\propto p_{\\star}(\\mathbf{x})^{s+1}$ , whereas for uniform $\\lambda(\\mathbf{x})$ and $s=1$ the limit distribution is the belief. This is also apparent from Corollary A.2. However, our interest is in cases where $k$ is finite. ", "page_idx": 4}, {"type": "text", "text": "For $k<\\infty$ , forming the $k$ -wise winner distribution requires marginalising over the choice set (Proposition 3.5). The formulas can be found in the Appendix (Corollary A.3), and do not have elegant analytic simplifications. However, they empirically resemble tempered versions of the actual belief as illustrated in Figure 2. In other words, finite $k$ plays a similar role as the RUM noise precision $s$ . When resorting to $k<\\infty$ , the choice distribution (Eq. (A.2)) does not match the belief density for the true noise precision $s$ , but we can improve the fit by selecting some alternative noise precision such that the choice distribution better approximates the belief. We will later use this connection to build a prior over the flow, and note that for this purpose we do not need an exact theoretical characterization: It is sufficient to know that for some choice of $k$ and $s$ the choice distribution can resemble the target density, at least to the degree that it can be used as a basis for prior information. Given that $k$ is typically fixed, $s$ can be varied in the prior, implying that the further $s$ is from the \u2018optimal\u2019 value, the greater the prior misspecification. ", "page_idx": 4}, {"type": "text", "text": "The idea is empirically illustrated in Figure 2. The $k$ -wise winner distribution for varying $k$ is shown in Figure 2(a), where the belief density is a truncated standard normal on the interval $[-5,5]$ , comparisons are sampled uniformly over the interval, and $s=1$ . As $k$ increases, the $k$ -wise winner distribution approaches the belief density (here $k=10$ is already very close), but we can equivalently approach the same density by changing the noise level (Figure 2(b)). ", "page_idx": 4}, {"type": "text", "text": "4 Belief density as normalizing flow ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "We model the belief density $p_{\\star}$ with a normalizing flow [Rezende and Mohamed, 2015, Papamakarios et al., 2021]. We introduce a new learning principle and objective for the flow which is compatible with any standard flow architecture, as long as it affords easy computation of the flow density. A normalizing flow is an invertible mapping $T$ from a latent space $\\mathcal{Z}\\subset\\overline{{\\mathbb{R}}}^{d}$ into a target space $\\boldsymbol{\\chi}\\subset\\mathbb{R}^{d}$ . $T$ consists of a sequence of invertible transformations, so that the forward (generative) direction $\\mathbf{z}\\mapsto T(\\mathbf{z})$ is fast to compute and the backward (normalizing) direction $\\mathbf{x}\\mapsto T^{-1}(\\mathbf{x})$ is either known in closed form or can be approximated efficiently. ", "page_idx": 5}, {"type": "text", "text": "The base distribution on $\\mathcal{Z}$ is a simple distribution such as a multivariate normal, whose density is denoted by $p_{z}$ . If we denote the parametrized $T$ by $T_{\\phi}$ given the flow network parameters $\\phi$ , the parameterized model of the log belief density, denoted by $f_{\\phi}$ , can be written as, ", "page_idx": 5}, {"type": "equation", "text": "$$\nf_{\\phi}(\\mathbf{x})=\\log p_{z}\\left(T_{\\phi}^{-1}(\\mathbf{x})\\right)+\\log|\\operatorname*{det}J_{T_{\\phi}^{-1}}(\\mathbf{x})|,\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "where $J_{T_{\\phi}^{-1}}$ is the Jacobian of $T_{\\phi}^{-1}$ . What complicates the learning of $f_{\\phi}$ in our case is the absence of a direct method to sample from $p_{\\star}(\\mathbf{x})$ , ruling out the conventional algorithms [e.g., Papamakarios et al., 2021]. Instead, we devise a new learning objective explained next. ", "page_idx": 5}, {"type": "text", "text": "4.1 Function-space Bayesian inference ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "Our starting point is to perform Bayesian inference for the flow network parameters given preferential dataset $\\mathcal{D}=\\{(\\mathbf{x}^{(i)},\\mathcal{C}_{k}^{(i)})~|~\\mathbf{x}^{(i)}\\succ\\mathcal{C}_{k}^{(i)}\\}_{i=1}^{n}$ ( $k$ -wise comparisons) or $\\mathcal{D}\\,=\\,\\{(\\sigma^{(i)},\\mathcal{C}_{k}^{(i)})\\ \\vert\\$ $\\sigma^{(i)}$ is a permutation on $\\mathcal{C}_{k}^{(i)}\\}_{i=1}^{n}$ $k$ -wise rankings), ", "page_idx": 5}, {"type": "equation", "text": "$$\np(\\phi\\mid{\\mathcal D})\\propto p({\\mathcal D}\\mid\\phi)p(\\phi),\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "where $p({\\mathcal{D}}\\mid\\phi)$ is the likelihood and $p(\\phi)$ is the prior for the flow network parameters. It is difficult to devise a good prior $p(\\phi)$ , and we instead perform inference over the function [Wolpert, 1993], ", "page_idx": 5}, {"type": "equation", "text": "$$\np(f_{\\phi}\\mid\\mathcal{D})\\propto p(\\mathcal{D}\\mid f_{\\phi})p(f_{\\phi})\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "where $p(\\mathcal{D}\\mid f_{\\phi})$ is the preferential likelihood for comparisons, Eq. (3), or rankings, Eq. (A.4). The function-space prior is easier to specify as we can focus on the characteristics of the log belief density itself, not its parametrization. The function-space prior is often evaluated at a finite set of representer points $\\tilde{X}=(\\tilde{\\mathbf{x}}_{1},...,\\tilde{\\mathbf{x}}_{m})$ , where $m$ should be chosen to be large to capture the behavior of the function at high resolution $p\\big(f_{\\phi}(\\tilde{X})\\big)$ [Wolpert, 1993, Qiu et al., 2024]. For example, when $f$ is a Gaussian process, the prior representer points in the posterior corresponds to the datapoints (e.g., Equation 3.12 in Rasmussen and Williams, 2006). Following the considerations above, we construct our prior knowledge of $f_{\\phi}$ on a subset of datapoints. ", "page_idx": 5}, {"type": "text", "text": "4.2 Empirical functional prior ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "To address the issue of collapsing or diverging probability mass, we introduce an empirical functional prior whose finite marginals at winner points $\\{\\mathbf{x}_{1},...,\\mathbf{x}_{n}\\}$ are independently distributed as ", "page_idx": 5}, {"type": "equation", "text": "$$\np(\\mathbf{f})\\propto p_{\\mathrm{unif}}(\\mathbf{f})\\prod_{i}\\exp(\\mathbf{f}_{i}),\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "where $\\mathbf{f}:=(f_{\\phi}(\\ensuremath{\\mathbf{x}}_{1}),...,f_{\\phi}(\\ensuremath{\\mathbf{x}}_{n}))$ and $p_{\\mathrm{unif}}$ is an uninformative bounded (hyper) prior that guarantees that the functional prior is proper. ", "page_idx": 5}, {"type": "text", "text": "The functional prior Eq. (6) is a special case of a class of priors, $\\begin{array}{r}{p(\\mathbf{f})\\propto\\prod_{i}\\lambda_{i}\\exp(s\\mathbf{f}_{i})}\\end{array}$ , derived from the following decision-theoretic argument under the exponential RUM model. Let us decompose the preference dataset into winners and losers $\\mathcal{D}_{k}=\\mathcal{D}_{k}^{\\succ}\\cup\\mathcal{D}_{k}^{\\forall}$ by defining $\\mathcal{D}_{k}^{\\succ}:=\\{\\mathbf{x}\\mid\\exists\\mathcal{C}_{k}\\;s.t.\\;\\mathbf{x}\\succ\\mathcal{C}_{k}\\}$ and $\\mathcal{D}_{k}^{\\ast}:=\\mathcal{D}_{k}\\setminus\\mathcal{D}_{k}^{\\succ}$ . The functional prior is the probability of observing only the $k$ -wise winners, ", "page_idx": 5}, {"type": "equation", "text": "$$\np({\\bf f})\\propto p(\\mathcal{D}_{k}^{\\succ}\\mid{\\bf f},s,\\lambda)p_{\\mathrm{unif}}({\\bf f}),\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "where $p_{\\mathrm{unif}}(\\mathbf{f})\\propto1$ (when $f$ is bounded, Assumption 2). The idea is to consider higher $k$ or $s$ (less noise) than the true ones, as both choices make the density more peaked around the modes of $p_{\\star}$ (see ", "page_idx": 5}, {"type": "text", "text": "Figures 2(a) and 2(b)). This choice encourages the flow to place more mass on the winner points in a way that is consistent with the underlying decision model. We consider $k=\\infty$ and $s\\in(0,\\infty)$ , where $s$ should be an increasing function of the true $k$ . While setting $k=\\infty$ reduces the functional prior to a closed form Eq. (4) by Theorem 3.6, the normalizing constant remains difficult. However, for the special case of $\\lambda\\propto1$ and $s=1$ , the normalizing constant equals one. We make this choice to retain computational tractability, reminding that the construct is only used as a prior intended for regularizing the solution and does not need to match the true density as such. This comes at the cost of increased prior misspecification, which can, in turn, degrade the quality of the fti, especially when the true value of $k$ is small (compare Figure 4(a) $(\\mathtt{k}{=}2)$ ) versus Figure 1(d) $(\\mathtt{k}{=}5)$ ). ", "page_idx": 6}, {"type": "text", "text": "4.2.1 Function-space maximum a posteriori ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "We train the flow $T_{\\phi}$ by maximizing the unnormalized function-space posterior density of $f_{\\phi}$ conditioned on the preferential data $\\ensuremath{\\mathcal{D}}=\\ensuremath{\\mathcal{D}}^{\\succ}\\cup\\ensuremath{\\mathcal{D}}^{\\neq}$ , using stochastic gradient ascent [Kingma and Ba, 2014]. Denoting all points in $\\mathcal{D}$ by $\\mathbf{X}$ and all winner points in $\\mathcal{D}^{\\succ}$ by $\\mathbf{X}_{\\succ}$ , the training objective is ", "page_idx": 6}, {"type": "equation", "text": "$$\n\\sum\\log\\mathcal{L}(\\mathcal{D}\\mid f_{\\phi}(\\mathbf{X}),s)+\\sum f_{\\phi}(\\mathbf{X}_{\\succ}),\n$$", "text_format": "latex", "page_idx": 6}, {"type": "text", "text": "where $\\mathcal{L}$ is the $k$ -wise comparison or ranking likelihood as per Eqs. (3) and (A.4). In the case of ranking data, the winner point $\\mathbf{x}\\in\\mathbf{X}_{\\succ}$ is the first-ranked alternative in each individual $k$ -wise ranking, meaning that $\\mathbf{x}$ is a $k$ -wise winner. A global optimum of Eq. (7) is the function-space maximum a posteriori estimate of the belief density. Pseudo-codes for the overall algorithm (Algorithms 1) and the forward pass for the unnormalized log-posterior (Algorithms 2) are provided in the Appendix. The computational cost of training is similar to standard flow learning from equally many samples. ", "page_idx": 6}, {"type": "text", "text": "5 Experiments ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "We first evaluate our method on synthetic data with choices made by simulating the RUM model, to validate the algorithm in cases where the ground truth is known while covering both cases where the responses follow the assumed RUM model and where they do not. We then demonstrate how the method could be used in a realistic elicitation scenario, using a large language model (LLM) as a proxy for a human expert [Choi et al., 2022]. As with a real human, an LLM is unlikely to follow the exact RUM model, but compared to a real user, the LLM expert can tirelessly answer unlimited questions and possible ethical issues and risks relating to human subjects are avoided. LLMs carry their own biases and risks [Tjuatja et al., 2024], but the focus here is on evaluating our algorithm. Code for reproducing all experiments is available at https://github.com/petrus-mikkola/prefflow. ", "page_idx": 6}, {"type": "text", "text": "Setup In the main experiments we use $k$ -wise ranking with $k=5$ , using relatively few queries to remain relevant for the intended use-cases where the expert\u2019s capacity in providing the information is clearly limited. Since learning a preference of higher dimensions is more difficult, we scale the number of queries $n$ linearly with $d$ but still stay substantially below the large-sample scenarios typically considered in flow learning. The details, together with the choice of the flow and the candidate distribution $\\lambda$ , are provided below for each experiment. As a flow model, we use RealNVP [Dinh et al., 2017] when $d=2$ and Neural Spline Flow [Durkan et al., 2019] when $d>2$ , implemented on top of [Stimper et al., 2023]. For more details, see Appendix C.4. ", "page_idx": 6}, {"type": "text", "text": "Evaluation We assess performance qualiatively via visual comparison of $2d$ and $1d$ marginal distributions between the target belief density and the flow estimate of the belief density, and quantitatively by numerically computing three metrics: the log-likelihood of the preferential data, the Wasserstein distance, and the mean marginal total variation distance (MMTV; Acerbi, 2020) between the target and the estimate. The numerical results are reported as the means and standard deviations of the metrics over replicate runs. As a baseline, we report the results of a method that uses the same preferential comparisons and optimizes the same training objective, but instead of using a flow to represent $\\exp(f)$ we directly assume the density is a factorized normal distribution parameterized by means and (log-transformed) standard deviations of all dimensions. This exact method has not been presented in the previous literature, but was designed to validate the merit of the flow representation. ", "page_idx": 6}, {"type": "table", "img_path": "sRSjr9SDKR/tmp/e2de518953f6863af2a49256fd4d07f468a648c994d85c8b17d1b9db8ab50e45.jpg", "table_caption": ["Table 1: Accuracy of the density represented as a flow (flow) compared to a factorized normal distribution (normal), both learned from preferential data, in three metrics: log-likelihood, Wasserstein distance, and the mean marginal total variation (MMTV). Averages over 20 repetitions (but excluding a few crashed runs), with standard deviations. "], "table_footnote": [], "page_idx": 7}, {"type": "image", "img_path": "sRSjr9SDKR/tmp/45cdc64a3ce3bb3ce36d4f23c80c8a55652b170c951025d52bda6dea2d17a087.jpg", "img_caption": ["Figure 3: Cross-plot of selected variables of the estimated flow in the Abalone (left) and LLM knowledge elicitation experiment (middle), and the marginal density of the same variables for the ground truth density in the LLM experiment (right). See Figures C.6 and C.7 for other variables. "], "img_footnote": [], "page_idx": 7}, {"type": "text", "text": "5.1 Synthetic tasks ", "text_level": 1, "page_idx": 7}, {"type": "text", "text": "First, we study the method on synthetic scenarios. For the first set of experiments, we assume a known density $p_{\\star}$ and simulate the preferential responses from the assumed $\\mathrm{RUM}(\\mathcal{C}_{k},\\log p_{\\star},\\mathrm{Exp}(1))$ . We consider five different target distributions: Onemoon2D, Gaussian6D, Twogaussians10D, Twogaussians20D, and Funnel10D. The densities of the target distributions can be found in Appendix C.1. For all cases we used $100d$ queries and $\\lambda$ as a mixture of uniform and Gaussian distribution centered on the mean of the target, with the mixture probability $1/3$ for the Gaussian; this technical simplification ensures a sufficient ratio of the samples to align with the target density even when $d$ is high. Table 1 shows that for all scenarios we can learn a useful flow; all metrics are substantially improved compared to the method based on the normal model and visual inspection (Appendix C.5) confirms the solutions match the true densities well. ", "page_idx": 7}, {"type": "text", "text": "Abalone regression data. Having validated the method when the queries follow the assumed RUM model with a synthetic belief density, we consider a more realistic target density. We first fit a flow model to the continuous covariates of the regression data abalone [Nash et al., 1995], and then use the fitted flow as a ground-truth belief density in the elicitation experiment. The elicitation queries correspond to all $k$ -combinations of the dataset size $n=4177$ . The numerical results are again provided in Table 1. Figure 3 shows that the learned flow captures the correlations between variables almost perfectly, which can be hard to see as the flow (heatmap) overlaps the true density (contour). There is some mismatch in the marginals, which is also indicated by the MMTV metric. In terms of the Wasserstein distance and visual comparison (Figure C.8), the flow based method clearly outperforms the baseline. ", "page_idx": 7}, {"type": "image", "img_path": "sRSjr9SDKR/tmp/7f0a6dd75d27d27c2501043af53ac1c4d64b9012e43394b427f9b0b583fdafbc.jpg", "img_caption": ["Figure 4: Illustration of belief densities elicited from pairwise comparisons by a normalizing flow. "], "img_footnote": [], "page_idx": 8}, {"type": "text", "text": "5.2 Expert elicitation with LLM as the expert ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "In this experiment, we prompt a LLM to provide its belief on how the features of the California housing dataset [Pace and Barry, 1997] are distributed. This resembles a hypothetical expert elicitation scenario, but the human expert is replaced with a LLM (Claude 3 Haiku by Anthropic in March 2024, see Appendix C.2 for the prompt and detailed setup) for easier experimentation. From the perspective of the flow learning algorithm the setup is similar to the intended use-cases. ", "page_idx": 8}, {"type": "text", "text": "We query in total $220\\;k$ -wise rankings through prompting, where the alternatives $\\mathcal{C}_{k}$ are uniformly sampled over the domain specified by 1st and 99th percentiles of each variable in the California housing dataset. The range was chosen to ensure $\\lambda(x)$ covers approximately the support of the density, but avoiding outliers. While we lack access to the ground-truth belief density, we can compare the learned LLM\u2019s belief density to the empirical data distribution of the California housing dataset, not known for the LLM. Figure 3 shows that there is a remarkable similarity between the distributions such as the marginals of the variables AveRooms, AveBedrms, Population, and AveOccup are all correctly distributed on the lower ends of their ranges (which are very broad due to the uniform $\\lambda(x))$ . Figure D.1 shows that the flow trained without the functional prior of (6) is considerably worse, confirming the FS-MAP estimate is superior to maximum likelihood. While there might be multiple mechanisms for how the LLM forms its knowledge about this specific dataset [Brown et al., 2020], many of the features have clear intuitive meaning. For instance, houses are all but guaranteed to have only a few bedrooms, instead of tens. ", "page_idx": 8}, {"type": "text", "text": "5.3 Ablation study ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "We validate the sensitivity of the results with respect to the cardinality of the choice set $k$ , the number of comparisons/rankings $n$ , the noise level $1/s$ , and the choice of distribution $\\lambda$ from which the candidates are sampled. In this section, we report a subset of the analysis for varying $k$ , while the rest can be found in Appendix D. Table 2 presents the results of experiments on synthetic scenarios (Section 5.1) by varying $k\\,\\in\\,\\{2,3,5,10\\}$ while keeping $n$ fixed. We observe that the accuracy naturally improves as a function of $k$ . The common special case in which the expert is queried through pairwise comparisons $[k=2]$ ) is shown in Figure 4 for the Onemoon2D experiment with $n=100$ and the Gaussian6D experiment with $n=1000$ . The results indicate that we can already roughly learn the target with $k=2$ that is most convenient for a user, but naturally with somewhat lower accuracy. For further analysis and more details, see Appendix D. The main takeaway is that low values of $s$ or $k$ , especially when $n$ is large, can cause the flow estimate to become overly dispersed due to higher prior misspecification. ", "page_idx": 8}, {"type": "text", "text": "6 Discussion ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "Theoretical and empirical analysis validate our main claim: It is possible to learn flexible distributions from preferential data, and the proposed algorithm solves the problem for some non-trivial but synthetic scenarios, with otherwise arbitrary but largely unimodal true beliefs. However, open questions worthy of further investigation remain on the path towards practical elicitation tools. ", "page_idx": 8}, {"type": "table", "img_path": "sRSjr9SDKR/tmp/9664c4118b5470c1b399a7e5fff2828a3b82ced2f6e501f1e9b25a5dc2f4198d.jpg", "table_caption": ["Table 2: Wasserstein distances for varying $k$ across different experiments "], "table_footnote": [], "page_idx": 9}, {"type": "text", "text": "", "page_idx": 9}, {"type": "text", "text": "The method is efficient only for exponential noise with $s\\,=\\,1$ that gives an analytic prior. Other choices would require explicit normalization or energy-based modeling techniques [Chao et al., 2024]. For a given RUM precision we can, in principle, solve for $k$ such that $s=1$ becomes approximately correct due to the tempering interpretation (Figure 2), but there are no guarantees that $s=1$ is good enough for any $k$ sufficiently small for practical use, and this requires an explicit estimate of the noise precision. The ablation studies show that for fixed $k$ , increasing $n$ generally improves the accuracy and already fairly small $n$ is sufficient for learning a good estimate (Table D.2). For very large $n$ , the accuracy can slightly deteriorate. We believe that this is due to prior misspecification that encourages overestimation of the variation due to the fact that $k$ is finite but in the prior it is assumed to be infinite. Figure D.4 confirms that for a large $n$ the shape of the estimate is extremely close to the target density and the slightly worse Wasserstein distance is due to overestimating the width. ", "page_idx": 9}, {"type": "text", "text": "We primarily experimented with $\\mathbf{k}$ -wise ranging with $k=5$ and relatively few comparisons. However, we demonstrated that we can learn the beliefs with somewhat limited accuracy already from the most convenient case of pairwise comparisons ( $k=2$ ), which is important for practical applications. Finally, we focused on the special case of sampling the candidates independently from $\\lambda(\\mathbf{x})$ . In many elicitation scenarios they could be result of some active choice instead, for example an acquisition function maximizing information gain [MacKay, 1992]. The basic learning principle generalizes for this setup, but additional work would be needed for theoretical and empirical analysis. ", "page_idx": 9}, {"type": "text", "text": "7 Conclusions ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "The current tools for representing and eliciting multivariate human beliefs are fundamentally limited. This limits the value of knowledge elicitation in general and introduces biases that are difficult to analyze and communicate when the true beliefs do not match the simplified assumed families. Modern flexible distribution models offer a natural solution for representing also complex human beliefs, but until now we have lacked the means of inferring them from ecologically valid human judgements. We provided the first such method by showing how normalizing flows can be estimated from preferential data using a functional prior induced by the setup. Our focus was in specifying the problem setup and validating the computational algorithm, paving way for future applications involving real human judgements. Despite focusing on the scenario where the elicitation judgements are made by a human expert, the algorithm can be used for learning flows from all kinds of comparison and ranking data. ", "page_idx": 9}, {"type": "text", "text": "Broader Impact Our goal is to eventually provide methods for accurately characterising human expert beliefs, complementing the existing toolbox with techniques that make less restrictive assumptions and hence support adaptation of better computational tools in a broad range of applications. Knowledge elicitation tools are frequently used e.g. in decision-making and policy recommendations as assistive tools. For such applications, it is critically important to ensure that the mathematical tools are reliable and transparent, and further validation of the methodology is needed before the specific method proposed here could be used in critical applications. ", "page_idx": 9}, {"type": "text", "text": "Acknowledgments and Disclosure of Funding ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "The work was supported by the Research Council of Finland Flagship programme: Finnish Center for Artificial Intelligence FCAI, and by the grants 345811, 358980, 356498, and 363317. The authors acknowledge support from CSC \u2013 IT Center for Science, Finland, for computational resources. ", "page_idx": 9}, {"type": "text", "text": "References ", "text_level": 1, "page_idx": 10}, {"type": "text", "text": "Luigi Acerbi. Variational Bayesian Monte Carlo with noisy likelihoods. Advances in Neural Information Processing Systems, 33:8211\u20138222, 2020.   \nDaniel Andrade. Stable training of normalizing flows for high-dimensional variational inference. arXiv preprint arXiv:2402.16408, 2024.   \nHossein Azari, David Parks, and Lirong Xia. Random utility theory for social choice. In Advances in Neural Information Processing Systems, volume 25, 2012.   \nJens Behrmann, Paul Vicol, Kuan-Chieh Wang, Roger Grosse, and Joern-Henrik Jacobsen. Understanding and mitigating exploding inverses in invertible neural networks. In International Conference on Artificial Intelligence and Statistics, volume 130 of Proceedings of Machine Learning Research, pages 1792\u20131800. PMLR, 2021.   \nChristopher M Bishop and Hugh Bishop. Deep learning: Foundations and concepts. Springer Nature, 2023.   \nTom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared D Kaplan, Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell, Sandhini Agarwal, Ariel Herbert-Voss, Gretchen Krueger, Tom Henighan, Rewon Child, Aditya Ramesh, Daniel Ziegler, Jeffrey Wu, Clemens Winter, Chris Hesse, Mark Chen, Eric Sigler, Mateusz Litwin, Scott Gray, Benjamin Chess, Jack Clark, Christopher Berner, Sam McCandlish, Alec Radford, Ilya Sutskever, and Dario Amodei. Language models are few-shot learners. Advances in Neural Information Processing Systems, 33:1877\u20131901, 2020.   \nChen-Hao Chao, Wei-Fang Sun, Yen-Chang Hsu, Zsolt Kira, and Chun-Yi Lee. Training energy-based normalizing flow with score-matching objectives. Advances in Neural Information Processing Systems, 36, 2024.   \nKristy Choi, Chris Cundy, Sanjari Srivastava, and Stefano Ermon. LMPriors: Pre-trained language models as task-specific priors. arXiv preprint arXiv:2210.12530, 2022.   \nRobert T. Clemen, Gregory W. Fischer, and Robert L. Winkler. Assessing dependence: Some experimental results. Management Science, 46(8):1100\u20131115, 2000. ISSN 00251909, 15265501.   \nRob Cornish, Anthony Caterini, George Deligiannidis, and Arnaud Doucet. Relaxing bijectivity constraints with continuously indexed normalising flows. International Conference on Machine Learning, pages 2133\u20132143, 2020.   \nStanislas Dehaene. The neural basis of the Weber\u2013Fechner law: a logarithmic mental number line. Trends in cognitive sciences, 7(4):145\u2013147, 2003.   \nAkash Kumar Dhaka, Alejandro Catalina, Manushi Welandawe, Michael R Andersen, Jonathan Huggins, and Aki Vehtari. Challenges and opportunities in high dimensional variational inference. Advances in Neural Information Processing Systems, 34:7787\u20137798, 2021.   \nLaurent Dinh, David Krueger, and Yoshua Bengio. NICE: Non-linear independent components estimation. arXiv preprint arXiv:1410.8516, 2014.   \nLaurent Dinh, Jascha Sohl-Dickstein, and Samy Bengio. Density estimation using real NVP. In International Conference on Learning Representations, 2017.   \nConor Durkan, Artur Bekasov, Iain Murray, and George Papamakarios. Neural spline flows. In Advances in Neural Information Processing Systems, volume 32, 2019.   \nJohannes F\u00fcrnkranz and Eyke H\u00fcllermeier. Preference Learning. Springer-Verlag New York, Inc., 2011.   \nAndrew Gelman, Daniel Simpson, and Michael Betancourt. The prior can often only be understood in the context of the likelihood. Entropy, 19(10):555, 2017.   \nEmiel Hoogeboom, Didrik Nielsen, Priyank Jaini, Patrick Forr\u00e9, and Max Welling. Argmax flows and multinomial diffusion: Learning categorical distributions. Advances in Neural Information Processing Systems, 34:12454\u201312465, 2021.   \nNeil Houlsby, Ferenc Husz\u00e1r, Zoubin Ghahramani, and M\u00e1t\u00e9 Lengyel. Bayesian active learning for classification and preference learning. arXiv preprint arXiv:1112.5745, 2011.   \nD. Jennings, T. M. Amabile, and L. Ross. Informal covariation assessment: Data-based vs. theorybased judgments. In Daniel Kahneman, Paul Slovic, and Amos Tversky, editors, Judgment Under Uncertainty: Heuristics and Biases, pages 211\u2013230. Cambridge University Press, 1982.   \nDiederik P Kingma and Jimmy Ba. Adam: A method for stochastic optimization. arXiv preprint arXiv:1412.6980, 2014.   \nJan Leike, David Krueger, Tom Everitt, Miljan Martic, Vishal Maini, and Shane Legg. Scalable agent alignment via reward modeling: a research direction. arXiv preprint arXiv:1811.07871, 2018.   \nJia Li, Surajit Ray, and Bruce G Lindsay. A nonparametric statistical approach to clustering via mode identification. Journal of Machine Learning Research, 8(8), 2007.   \nFeynman Liang, Michael Mahoney, and Liam Hodgkinson. Fat\u2013tailed variational inference with anisotropic tail adaptive flows. In International Conference on Machine Learning, pages 13257\u2013 13270. PMLR, 2022.   \nR Duncan Luce. Individual choice behavior, volume 4. Wiley New York, 1959.   \nDavid JC MacKay. Information-based objective functions for active data selection. Neural computation, 4(4):590\u2013604, 1992.   \nHannes Malmberg and Ola H\u00f6ssjer. Argmax over continuous indices of random variables\u2013an approach using random fields. Technical report, Technical report, Division of Mathematical Statistics, Department of Mathematics, Stockholm University, 2012.   \nHannes Malmberg and Ola H\u00f6ssjer. Probabilistic choice with an infinite set of options: an approach based on random sup measures. Modern Problems in Insurance Mathematics, pages 291\u2013312, 2014.   \nJacob Marschak. Binary choice constraints on random utility indicators. Technical report, Cowles Foundation for Research in Economics, Yale University, 1959.   \nPetrus Mikkola, Osvaldo A. Martin, Suyog Chandramouli, Marcelo Hartmann, Oriol Abril Pla, Owen Thomas, Henri Pesonen, Jukka Corander, Aki Vehtari, Samuel Kaski, Paul-Christian B\u00fcrkner, and Arto Klami. Prior Knowledge Elicitation: The Past, Present, and Future. Bayesian Analysis, pages 1 \u2013 33, 2023.   \nFrederick Mosteller. Remarks on the method of paired comparisons: The least squares solution assuming equal standard deviations and equal correlations. Psychometrika, 16(1):3\u20139, 1951.   \nWarwick Nash, Tracy Sellers, Simon Talbot, Andrew Cawthorn, and Wes Ford. Abalone. UCI Machine Learning Repository, 1995.   \nDidrik Nielsen, Priyank Jaini, Emiel Hoogeboom, Ole Winther, and Max Welling. SurVAE flows: Surjections to bridge the gap between VAEs and flows. Advances in Neural Information Processing Systems, 33:12685\u201312696, 2020.   \nJeremy E. Oakley and Anthony O\u2019Hagan. Uncertainty in prior elicitations: A nonparametric approach. Biometrika, 94, 2007.   \nAnthony O\u2019Hagan. Expert knowledge elicitation: Subjective but scientific. The American Statistician, 73(sup1):69\u201381, 2019.   \nLong Ouyang, Jeffrey Wu, Xu Jiang, Diogo Almeida, Carroll Wainwright, Pamela Mishkin, Chong Zhang, Sandhini Agarwal, Katarina Slama, Alex Ray, et al. Training language models to follow instructions with human feedback. Advances in Neural Information Processing Systems, 35: 27730\u201327744, 2022.   \nR Kelley Pace and Ronald Barry. Sparse spatial autoregressions. Statistics & Probability Letters, 33 (3):291\u2013297, 1997.   \nGeorge Papamakarios, Eric Nalisnick, Danilo Jimenez Rezende, Shakir Mohamed, and Balaji Lakshminarayanan. Normalizing flows for probabilistic modeling and inference. The Journal of Machine Learning Research, 22(1):2617\u20132680, 2021.   \nDmytro Perepolkin, Benjamin Goodrich, and Ullrika Sahlin. Hybrid elicitation and quantileparametrized likelihood. Statistics and Computing, 34(1):11, 2024.   \nRobin L Plackett. The analysis of permutations. Journal of the Royal Statistical Society Series C: Applied Statistics, 24(2):193\u2013202, 1975.   \nShikai Qiu, Tim GJ Rudner, Sanyam Kapoor, and Andrew G Wilson. Should we learn most likely functions or parameters? Advances in Neural Information Processing Systems, 36, 2024.   \nCarl Edward Rasmussen and Christopher K. I. Williams. Gaussian processes for machine learning, volume 2. MIT press, 2006.   \nDanilo Rezende and Shakir Mohamed. Variational inference with normalizing flows. In International conference on machine learning, pages 1530\u20131538. PMLR, 2015.   \nAntoine Salmona, Valentin De Bortoli, Julie Delon, and Agnes Desolneux. Can push-forward generative models fit multimodal distributions? Advances in Neural Information Processing Systems, 35:10766\u201310779, 2022.   \nVincent Stimper, David Liu, Andrew Campbell, Vincent Berenz, Lukas Ryll, Bernhard Sch\u00f6lkopf, and Jos\u00e9 Miguel Hern\u00e1ndez-Lobato. normflows: A PyTorch package for normalizing flows. Journal of Open Source Software, 8(86):5361, 2023.   \nL. L. Thurstone. A law of comparative judgment. Psychological Review, 34(4):273\u2013286, 1927.   \nLindia Tjuatja, Valerie Chen, Tongshuang Wu, Ameet Talwalkwar, and Graham Neubig. Do LLMs exhibit human-like response biases? A case study in survey design. Transactions of the Association for Computational Linguistics, 12:1011\u20131026, 2024.   \nKenneth E Train. Discrete choice methods with simulation. Cambridge university press, 2009.   \nLorenz Vaitl, Kim A Nicoli, Shinichi Nakajima, and Pan Kessel. Gradients should stay on path: better estimators of the reverse-and forward KL divergence for normalizing flows. Machine Learning: Science and Technology, 3(4):045006, 2022.   \nAlyson G Wilson. Cognitive factors affecting subjective probability assessment, volume 4. Citeseer, 1994.   \nDavid H Wolpert. Bayesian backpropagation over io functions rather than weights. Advances in Neural Information Processing Systems, 6, 1993.   \nJohn I Yellott Jr. The relationship between Luce\u2019s choice axiom, Thurstone\u2019s theory of comparative judgment, and the double exponential distribution. Journal of Mathematical Psychology, 15(2): 109\u2013144, 1977. ", "page_idx": 10}, {"type": "text", "text": "", "page_idx": 11}, {"type": "text", "text": "", "page_idx": 12}, {"type": "text", "text": "A Theoretical results ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "In Section 2 we mentioned that noisy RUM models can be identified for known noise levels. This can be illustrated by the following example: ", "page_idx": 13}, {"type": "text", "text": "Example A.1. Consider a probit model (Thurstone-Mosteller) model [Thurstone, 1927, Mosteller, 1951]. Denote the probability mass function by $p$ , its values at two points $p(\\mathbf{x})$ and $p(\\mathbf{x}^{\\prime})$ , and their difference by $\\Delta p=p(\\mathbf{x})-p(\\mathbf{x}^{\\prime})$ . For a sufficiently large data set of pairwise comparisons, we can estimate the winning probability of $\\mathbf{x}$ : $\\mathbf{P}(\\mathbf{x}\\succ\\mathbf{x}^{\\prime})=q$ . Since noise follows $N(0,\\sigma^{2})$ , we can deduce that $\\mathrm{P}(\\mathbf{x}\\succ\\mathbf{x}^{\\prime})=\\bar{\\Phi_{\\sigma^{2}}}(\\Delta p)$ , where $\\Phi_{\\sigma^{2}}$ is the cumulative distribution function of $N(0,\\sigma^{2})$ . So, $\\mathrm{P}(\\mathbf{x}\\succ\\mathbf{x}^{\\prime})=\\Phi_{\\sigma^{2}}(\\Delta p)$ and $\\Delta p=\\Phi_{\\sigma^{2}}^{-1}(q)$ . Since $p$ is the probability mass function, from a pair of equations we obtain $p(\\mathbf{x})=(1-\\Phi_{\\sigma^{2}}^{-1}(q))/2$ and $p(\\mathbf{x}^{\\prime})=(1+\\Phi_{\\sigma^{2}}^{-1}(q))/2$ . For the known noise level $\\sigma^{2}$ , $p$ is identified. ", "page_idx": 13}, {"type": "text", "text": "Section 3 refers to the following corollary that relates the RUM model with sampling. ", "page_idx": 13}, {"type": "text", "text": "Corollary A.2. Consider that presenting an $\\infty$ -wise comparison with the choice set ${\\mathcal{C}}={\\mathcal{X}}$ to the expert is equivalent to presenting a $k$ -wise comparison with large $k$ and points sampled uniformly over $\\mathcal{X}$ . If the expert choice model follows $R U M(\\mathcal{X};\\log p_{\\star}({\\bf x}),E x p(1))$ , then asking the expert to pick the most likely alternative out of all possible alternatives is equivalent to sampling from their belief density. ", "page_idx": 13}, {"type": "text", "text": "Proof. Since $\\lambda(\\mathbf{x})=1/v o l(\\boldsymbol{\\mathcal{X}})$ , the terms $\\lambda(\\mathbf{x})$ and $\\lambda(\\mathbf{x}^{\\prime})$ in Eq. (4) cancel out. The denominator equals $\\begin{array}{r}{\\int p_{\\star}(\\mathbf{x})d\\mathbf{x}=1}\\end{array}$ , because $f(\\mathbf{x})=\\log{p_{\\star}(\\mathbf{x})}$ and $s=1$ . Thus, $p(\\mathbf{x}\\succ\\mathcal{X})=\\exp\\left(s f(\\mathbf{x})\\right)=$ $p_{\\star}(\\mathbf{x})$ . \u53e3 ", "page_idx": 13}, {"type": "text", "text": "Corollary A.3. For $k=2,$ , the probability density of $X_{k}^{\\star}$ equals to ", "page_idx": 13}, {"type": "equation", "text": "$$\np_{X_{k}^{\\star}}(\\mathbf{x})=2\\lambda(\\mathbf{x})\\int_{X}F_{L a p l a c e(0,l/s)}\\left(p_{\\star}(\\mathbf{x})-p_{\\star}(\\mathbf{x}^{\\prime})\\right)\\lambda(\\mathbf{x}^{\\prime})d\\mathbf{x}^{\\prime}\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "For $2<k<\\infty,$ , the probability density of $X_{k}^{\\star}$ is proportional to ", "page_idx": 13}, {"type": "equation", "text": "$$\np_{X_{k}^{\\star}}({\\bf x})\\propto\\lambda({\\bf x})\\int_{\\mathcal{X}^{k-1}}P\\,({\\bf x}\\,\\succ\\!\\mathcal{C}_{k}\\mid\\mathcal{C}_{k})\\,d\\lambda(\\mathcal{C}_{k}\\mid\\{{\\bf x}\\}),\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "where $P\\left(\\mathbf{x}\\mid\\mathcal{C}_{k}\\mid\\mathcal{C}_{k}\\right)$ is given by Proposition 3.5. ", "page_idx": 13}, {"type": "text", "text": "For $k=\\infty$ , the probability density of $X_{k}^{\\star}$ equals to ", "page_idx": 13}, {"type": "equation", "text": "$$\np_{X_{k}^{\\star}}({\\bf x})=C\\lambda({\\bf x})p_{\\star}^{s}({\\bf x}),\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "where $C>0$ . If $\\lambda(\\mathbf{x})=1/v o l(\\boldsymbol{\\mathcal{X}})$ and $s=1$ , then $C\\lambda(\\mathbf{x})=1$ . ", "page_idx": 13}, {"type": "text", "text": "Proof. Case $k=2$ . ", "page_idx": 13}, {"type": "equation", "text": "$$\np_{X_{k}^{\\star}}(\\mathbf{x})\\propto\\int_{\\mathcal{X}}\\mathrm{P}(\\mathbf{x}\\succ\\mathbf{x}^{\\prime}\\mid p_{\\star},s)\\lambda(\\mathbf{x}^{\\prime})\\lambda(\\mathbf{x})d\\mathbf{x}^{\\prime}\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "The normalizing constant can be computed by using Fubini\u2019s theorem. Since $\\mathbf{P}(\\mathbf{x}\\ \\succ\\ \\mathbf{x}^{\\prime}\\ \\ |$ $p_{\\star})\\lambda({\\bf x}^{\\prime})\\lambda({\\bf x})$ is $\\mathcal X\\times\\mathcal X$ integrable, it holds that ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\int_{\\mathcal{X}}\\int_{\\mathcal{X}}\\mathbf{P}(\\mathbf{x}\\succ\\mathbf{x}^{\\prime}\\mid p_{\\star},s)\\lambda(\\mathbf{x}^{\\prime})\\lambda(\\mathbf{x})d\\mathbf{x}^{\\prime}d\\mathbf{x}=\\int_{\\mathcal{X}\\times\\mathcal{X}}\\mathbf{P}(\\mathbf{x}\\succ\\mathbf{x}^{\\prime}\\mid p_{\\star},s)\\lambda(\\mathbf{x}^{\\prime})\\lambda(\\mathbf{x})d(\\mathbf{x}^{\\prime},\\mathbf{x})=0.5,\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "by the symmetry and the fact that $\\mathrm{P}(\\mathbf{x}\\succ\\mathbf{x}^{\\prime}\\mid p_{\\star},s)+\\mathrm{P}(\\mathbf{x}^{\\prime}\\succ\\mathbf{x}\\mid p_{\\star},s)=1$ . So, the normalizing constant is 2. ", "page_idx": 13}, {"type": "text", "text": "Case $k=\\infty$ . It follows from Theorem 3.6. ", "page_idx": 13}, {"type": "text", "text": "$k$ -wise ranking likelihood ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "The $k$ -wise ranking likelihood $\\operatorname{P}_{\\mathbf{\\pi}}\\left(\\mathbf{x}_{\\pi\\left({\\mathcal{C}}_{k}\\right)_{1}}\\succ\\ldots\\succ\\mathbf{x}_{\\pi\\left({\\mathcal{C}}_{k}\\right)_{k}}\\mid{\\mathcal{C}}_{k}\\right)$ can be computed as a product of $k$ -wise comparison likelihoods, ", "page_idx": 13}, {"type": "text", "text": "where $\\mathcal{C}^{(1)}=\\mathcal{C}_{k}$ ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\displaystyle\\prod_{j=1}^{k-1}\\mathbf{P}\\left(\\mathbf{x}_{\\pi(\\mathcal{C}_{k})_{j}}\\succ\\mathcal{C}^{(j)}\\mid\\mathcal{C}^{(j)}\\right),}\\\\ {\\displaystyle\\mathscr{I}_{k},\\;...\\,,\\;\\mathcal{C}^{(k-1)}=\\mathcal{C}_{k}\\setminus\\{\\mathbf{x}_{\\pi(\\mathcal{C}_{k})_{1}},...,\\mathbf{x}_{\\pi(\\mathcal{C}_{k})_{k-2}}\\}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "B Proofs ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "This section provides the proofs for the propositions made in the main paper. ", "page_idx": 14}, {"type": "text", "text": "Proposition. Let $p^{*}$ be the expert\u2019s belief density. Denote $N=k-1$ , so that $\\mathcal{D}_{N}=\\{{\\bf x}_{1}\\succ{\\bf x}_{2}\\succ$ $\\ldots\\succ\\mathbf{x}_{N}\\succ\\mathbf{x}_{N+1}\\Bigr\\}$ . If $W\\sim G u m b e l(0,\\beta)$ , then for any positive monotonic transformation $g$ , and for $f\\equiv g\\circ p^{*}$ it holds, ", "page_idx": 14}, {"type": "equation", "text": "$$\np(\\mathcal{D}_{N}|f)\\xrightarrow{\\beta\\to0}1.\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "Proof. Let $f(\\mathbf{x})=g(p^{*}(\\mathbf{x}))$ . Then, by Yellott Jr [1977], ", "page_idx": 14}, {"type": "equation", "text": "$$\np(\\mathcal{D}_{N}|f,\\beta)=\\prod_{n=1}^{N+1}\\frac{e^{\\frac{1}{\\beta}f(\\mathbf{x}_{n})}}{\\sum_{i=n}^{N+1}e^{\\frac{1}{\\beta}f(\\mathbf{x}_{i})}}=\\prod_{n=1}^{N+1}\\frac{e^{\\frac{1}{\\beta}g(p^{*}(\\mathbf{x}_{n}))}}{\\sum_{i=n}^{N+1}e^{\\frac{1}{\\beta}g(p^{*}(\\mathbf{x}_{i}))}}.\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "By the product law for limits, ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{\\underset{\\partial\\rightarrow0+}{\\operatorname*{lim}}_{p\\rightarrow0+}p(\\mathcal{D}_{N}|f,\\beta)=\\underset{n=1}{\\overset{N+1}{\\prod}}\\frac{\\underset{\\beta\\rightarrow0+}{\\operatorname*{lim}}}{\\beta\\rightarrow0+}\\frac{e^{\\frac{\\beta}{\\beta}g(p^{*}(\\mathbf{x}_{n}))}}{\\sum_{i=-n}^{N+1}e^{\\frac{\\beta g(p^{*}(\\mathbf{x}_{i}))}{\\beta}g(\\mathbf{x}_{i})}}}\\\\ {=}&{\\underset{n=1}{\\overset{N+1}{\\prod}}\\left(g(p^{*}(\\mathbf{x}_{n}))=\\underset{n\\leq i\\leq N+1}{\\operatorname*{max}}g(p^{*}(\\mathbf{x}_{i}))\\right)}\\\\ &{=\\underset{n=1}{\\overset{N+1}{\\prod}}\\mathbb{I}\\left(p^{*}(\\mathbf{x}_{n})=\\underset{n\\leq i\\leq N+1}{\\operatorname*{max}}p^{*}(\\mathbf{x}_{i})\\right)}\\\\ &{=\\underset{n=1}{\\overset{N+1}{\\prod}}\\mathbb{I}\\left(p^{*}(\\mathbf{x}_{n})=p^{*}(\\mathbf{x}_{n})\\right)}\\\\ &{=1,}\\end{array}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "The second equation holds because the softmax converges pointwise to the argmax in the limit of the temperature approaches zero. The third equation holds because $g$ preserves the order. The fourth equation holds because $p^{*}(\\mathbf{x}_{1})>p^{*}(\\mathbf{x}_{2})\\bar{>}\\dots>p^{*}(\\mathbf{x}_{N+1})$ . \u53e3 ", "page_idx": 14}, {"type": "text", "text": "Proposition. Let $\\mathcal{C}_{k}$ be a choice set of $k\\ \\geq\\ 2$ alternatives. Denote $C\\,=\\,{\\mathcal{C}}_{k}\\,\\backslash\\,\\{{\\bf x}\\}$ and $f_{C}^{\\star}\\,=$ $\\mathrm{max}_{\\mathbf{x}_{j}\\in C}\\,f(\\mathbf{x}_{j})$ . The winning probability of a point $\\mathbf{x}\\in{\\mathcal{C}}_{k}$ equals to ", "page_idx": 14}, {"type": "equation", "text": "$$\n^3(\\mathbf x\\,\\sim\\mathcal C_{k}\\ |\\ {\\mathcal C}_{k})=\\sum_{l=0}^{k-1}\\frac{\\exp\\big(-s(l+1)\\operatorname*{max}\\{f_{C}^{\\star}-f(\\mathbf x),0\\}\\big)}{l+1}\\sum_{s y m\\cdot\\mathbf x_{j}\\in C}^{l}-\\exp(-s(f(\\mathbf x)-f(\\mathbf x_{j}))),\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "where $\\sum_{s y m:\\mathbf{x}_{j}\\in\\mathcal{C}_{k}\\setminus\\{\\mathbf{x}\\}}^{l}$ denotes the $l^{t h}$ elementary symmetric sum of the set $C$ . ", "page_idx": 14}, {"type": "text", "text": "Proof. Fix $\\mathbf{x}\\in{\\mathcal{C}}_{k}$ , and for any $w\\geq0$ denote $\\mathbf{1}_{w}=\\mathbb{I}_{\\{f(\\mathbf{x})+w\\geq f_{C}^{\\star}\\}}$ . ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{\\psi(\\mathbf x\\cdot\\mathbf c_{1}|\\mathbf c_{3})=\\displaystyle\\nabla\\left(\\prod_{i:\\alpha=1}^{n}\\left\\{(f(\\mathbf x)+W(\\mathbf x)>f(\\mathbf x))+W(\\mathbf x)\\right\\}\\right)}\\\\ &{\\qquad\\qquad=\\displaystyle\\int\\mathrm{Pe}\\left(\\prod_{i:\\alpha=1}^{n}\\left\\{f(\\mathbf x)+W(\\mathbf x)>f(\\mathbf x)\\right\\}\\mid W(\\mathbf x)\\right)\\mathrm{Pe}(W(\\mathbf x))}\\\\ &{\\qquad=\\displaystyle\\int_{0}^{\\infty}\\mathrm{Pe}\\left(\\prod_{i:\\alpha=1}^{n}\\left\\{W(\\mathbf x)<f(\\mathbf x)+w-f(\\mathbf x)\\right\\}\\mid w\\right)\\mathrm{e}^{-\\infty-\\alpha\\alpha}\\mathrm{d}w}\\\\ &{\\qquad=\\displaystyle\\int_{0}^{\\infty}\\mathrm{e}^{-\\alpha\\mathbf c_{1}\\cdot\\mathbf c_{2}}\\prod_{i:\\alpha=1}^{n}\\left\\{(W(\\mathbf x)<f(\\mathbf x)<\\mu)+w-f(\\mathbf x)\\right\\}\\mid w\\right\\}\\mathrm{d}w}\\\\ &{\\qquad=\\displaystyle\\int_{0}^{\\infty}\\mathrm{e}^{-\\alpha\\mathbf c_{1}\\cdot\\mathbf c_{2}}\\prod_{i:\\alpha=1}^{n}\\left(1-e^{-\\alpha(f(\\mathbf x)+\\mu)}\\right)\\prod_{i:\\alpha=1}^{n}\\left\\{\\alpha_{1}<\\tau\\right\\}\\mathrm{d}w}\\\\ &{\\qquad=\\displaystyle\\int_{0}^{\\infty}\\mathrm{e}^{-\\alpha\\mathbf c_{1}\\cdot\\mathbf c_{2}}\\prod_{i:\\alpha=1}^{n}\\left(e^{-\\alpha\\mathbf c_{1}\\cdot\\mathbf c_{2}}\\prod_{i:\\alpha=1}^{n}\\right)\\mathrm{d}\\mathbf x\\mathrm{d}\\mathbf e}\\\\ &{\\qquad=\\displaystyle\\int_{0}^{\\infty}\\mathrm{e}^{-\\alpha\\mathbf c_{1}\\cdot\\mathbf c_{1}}\\prod_{i:\\alpha=1}^{n}\\left(e^{-\\alpha\\mathbf c_{1}\\cdot\\mathbf c_{2}}\\right)\\prod_{i:\\alpha=1}^{n}\\mathrm{d}\\mathbf e}\\\\ &{\\qquad=\\displaystyle\\int_{0}^{\\infty}\\mathrm{e}^{-\\alpha\\mathbf c_{1}\\cdot\\mathbf c_{1}}\\prod_{i:\\alpha=1}^{n}\\left(e^{\\psi\\cdot\\mathbf c_{2}}-e^{-(\\psi(\\mathbf x)-\\rho(\\mathbf x))}\\right)\\mathrm{d}\\mathbf e}\\end{array}\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "Denote $c_{j}:=-\\exp(-s({f(\\mathbf{x})}-{f(\\mathbf{x}_{j})}))$ . Let $b_{l}$ be the $l^{t h}$ elementary symmetric sum of the $c_{j}$ over $j\\mathrm{s}$ . The $l^{t h}$ elementary symmetric sum is the sum of all products of $l$ distinct $c_{j}$ over $j\\,\\mathbf{s}$ . We can write, ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\displaystyle\\int_{0}^{\\infty}{e^{-k\\pi r}\\mathrm{Le}\\left(e^{-r}-e^{-r/(\\frac{\\pi}{2})-f(\\frac{\\pi}{2})}\\right)d\\alpha}}\\\\ &{=\\displaystyle\\int_{0}^{\\infty}{e^{-k\\pi r}\\mathrm{Le}\\left(\\frac{1}{r}\\right)e^{\\left(k-\\frac{r}{2}\\right)}b e^{\\left(k-\\frac{r}{2}\\right)}e^{\\mathrm{i}f\\alpha}}}\\\\ &{\\displaystyle=\\int_{0}^{\\infty}{\\sum_{k=0}^{n-1}{\\beta_{k}e^{\\left(k-\\frac{r}{2}\\right)}e^{-\\mathrm{i}f\\alpha}}}}\\\\ &{\\displaystyle=e\\int_{0}^{\\frac{\\pi}{2}}{\\sum_{k=0}^{n-1}{\\beta_{k}e^{\\left(k-\\frac{r}{2}\\right)}e^{-\\mathrm{i}f\\alpha}}}\\mathrm{Le}^{\\mathrm{i}f\\alpha}}\\\\ &{\\displaystyle=\\frac{e^{\\frac{\\pi}{2}}}{\\sum_{k=0}^{n-1}{\\beta_{k}e^{\\left(k-\\frac{r}{2}\\right)}e^{\\mathrm{i}f\\alpha}}}\\left(e^{-\\mathrm{i}f\\alpha}\\right)e^{-\\mathrm{i}f\\alpha+1}\\right)\\mathrm{w}_{k}d\\alpha}\\\\ &{\\displaystyle=\\frac{e^{-\\frac{\\pi}{2}}}{\\sum_{k=0}^{n-1}{\\beta_{k}e^{\\left(k-\\frac{r}{2}\\right)}e^{-\\mathrm{i}f\\alpha}}}}\\\\ &{\\displaystyle=\\frac{e^{-\\frac{\\pi}{2}}}{\\sum_{k=0}^{n-1}{\\beta_{k}e^{\\left(k-\\frac{r}{2}\\right)}e^{-\\mathrm{i}f\\alpha}}}{\\left(1-\\sum_{k=0}^{n-1}{\\beta_{k}e^{\\left(k-\\frac{r}{2}\\right)}e^{-\\mathrm{i}f\\alpha}}\\right)^{\\alpha}},}\\\\ &{\\displaystyle=\\frac{e^{-\\frac{\\pi}{2}}}{\\sum_{k=0}^{n-1}{\\beta_{k}e^{\\left(k-\\frac{r}{2}\\right)}e^{-\\mathrm{i}f\\alpha}}}{\\left(1-\\sum_{k=0}^{n-1}{\\beta_{k}e^{\\left(\\frac{r}{2}-f\\left(\\frac{\\pi}{2}\\right)\\right)}e^{-\\mathrm{i}f\\alpha}}\\right)^{\\alpha}},}\\\\ &{\\displaystyle=\\sum_{k=0 \n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "with convention that $b_{0}=1$ and $G_{\\eta}$ denotes the cumulative distribution function of ${\\mathrm{Exp}}(\\eta)$ . \u53e3 ", "page_idx": 15}, {"type": "table", "img_path": "sRSjr9SDKR/tmp/a79bb6b27fc687c5e6ebaa03a8648fd5799703346e2e9222d89e169b26060d25.jpg", "table_caption": [], "table_footnote": [], "page_idx": 16}, {"type": "text", "text": "C Experimental details ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "C.1 Target distributions ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "The logarithmic unnormalized densities of the target distributions used in the synthetic experiments are listed below. ", "page_idx": 16}, {"type": "equation", "text": "$$\n{\\begin{array}{r l}{{\\mathbf{1}}{\\mathbf{2}}{\\mathbf{D}}:\\quad}&{-{\\frac{1}{2}}\\left({\\frac{\\|\\mathbf{x}\\|-{\\boldsymbol{2}}}{0.2}}\\right)^{2}-{\\frac{1}{2}}\\left({\\frac{x_{0}+2}{0.3}}\\right)^{2}}\\\\ {{\\mathrm{()}}\\quad}&{-{\\frac{1}{2}}(\\mathbf{x}-{\\boldsymbol{\\mu}})^{T}{\\boldsymbol{\\Sigma}}^{-1}(\\mathbf{x}-{\\boldsymbol{\\mu}}),\\;\\;{\\boldsymbol{\\mu}}=2\\left({\\begin{array}{c}{(-1)^{1}}\\\\ {\\vdots}\\\\ {(-1)^{6}}\\end{array}}\\right),\\;{\\boldsymbol{\\Sigma}}=\\left({\\begin{array}{c c c c c}{{\\frac{6}{10}}}&{0.4}&{\\cdots}&{0.4}\\\\ {0.4}&{{\\frac{6}{10}}}&{\\cdots}&{0.4}\\\\ {\\vdots}&{\\vdots}&{\\ddots}&{\\vdots}\\\\ {0.4}&{0.4}&{\\cdots}&{{\\frac{6}{10}}}\\end{array}}\\right)}\\end{array}}\n$$", "text_format": "latex", "page_idx": 16}, {"type": "equation", "text": "$$\n\\mathrm{{Iwogaussians:}}\\qquad\\log\\left({\\frac{1}{2}}\\exp\\left(\\log N({\\textbf{\\em{\\mu}}}|{\\textbf{\\em{\\mu}}},{\\boldsymbol{\\Sigma}}_{1})\\right)+{\\frac{1}{2}}\\exp\\left(\\log N({\\textbf{\\em{\\mu}}}|{\\textbf{\\em{\\mu}}},{\\boldsymbol{\\Sigma}}_{2})\\right)\\right),\n$$", "text_format": "latex", "page_idx": 16}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\Sigma_{2}=\\left[\\begin{array}{c c c c c}{\\sigma^{2}}&{-\\rho\\sigma^{2}}&{\\rho\\sigma^{2}}&{\\cdots}&{(-1)^{d-1}\\rho\\sigma^{2}}\\\\ {-\\rho\\sigma^{2}}&{\\sigma^{2}}&{-\\rho\\sigma^{2}}&{\\cdots}&{(-1)^{d-2}\\rho\\sigma^{2}}\\\\ {\\rho\\sigma^{2}}&{-\\rho\\sigma^{2}}&{\\sigma^{2}}&{\\cdots}&{(-1)^{d-3}\\rho\\sigma^{2}}\\\\ {\\vdots}&{\\vdots}&{\\vdots}&{\\ddots}&{\\vdots}\\\\ {(-1)^{d-1}\\rho\\sigma^{2}}&{(-1)^{d-2}\\rho\\sigma^{2}}&{(-1)^{d-3}\\rho\\sigma^{2}}&{\\cdots}&{\\sigma^{2}}\\end{array}\\right]}\\\\ &{\\mathbf{funnell0D:~}\\quad-\\left(\\frac{(x_{0}-1)^{2}}{a^{2}}\\right)-\\displaystyle\\sum_{i=1}^{10-1}\\left(\\log(2\\pi\\exp(2b x_{0}))+\\frac{(x_{i}-1)^{2}}{\\exp(2b x_{0})}\\right),~a=3,b=0.25}\\end{array}\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "C.2 LLM expert elicitation experiment ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "The version of the Claude 3 model used in the LLM expert elicitation experiment was claude-3- haiku-20240307. In the experiment, we used the following prompt template to query the LLM. The configurations specified within the XML tags <configuration> were sampled from $\\lambda$ , a uniform distribution. The prompt template is as follows: ", "page_idx": 16}, {"type": "text", "text": "We collected information on the variables using all the block groups in California from the 1990 Census. In this sample a block group on average includes 1425.5 individuals living in a geographically compact area. Naturally, the geographical area included varies inversely with the population density. We computed distances among the centroids of each block group as measured in latitude and longitude. This dataset was derived from the 1990 U.S. census, using one row per census block group. A block group is the smallest geographical unit for which the U.S. Census Bureau publishes sample data (a block group typically has a population of 600 to 3,000 people). A household is a group of people residing within a home. ", "page_idx": 17}, {"type": "text", "text": "Number of Variables: 8 continuous   \nVariable Information:   \n- MedInc median income (expressed in hundreds of thousands of dollars)   \nin block group   \n- HouseAge median house age in block group   \n- AveRooms average number of rooms per household   \n- AveBedrms average number of bedrooms per household   \n- Population block group population   \n- AveOccup average number of household members   \n- Latitude block group latitude   \n- Longitude block group longitude   \n</data> The variables are:   \n<variables>   \n{MedInc, HouseAge, AveRooms, AveBedrms, Population, AveOccup, Latitude, Longitude}   \n</variables>   \nalways reported in this order. ", "page_idx": 17}, {"type": "text", "text": "", "page_idx": 17}, {"type": "text", "text": "Given these combinations of variables below, please list them from most likely to least likely in your opinion. Consider what each variable represents and its realistic value in light of the properties of the dataset. ", "page_idx": 17}, {"type": "text", "text": "<configurations>   \nA=0.79,0.81,0.40,0.60,0.74,0.49,0.59,0.75,0.00,0.04 $\\mathtt{B=}0.09$ ,0.10,0.22,0.92,0.16,0.95,0.02,0.91,0.25,0.02 $\\mathtt{C}{=}0.72$ ,0.50,0.17,0.70,0.37,0.78,0.15,0.14,0.05,0.05 D=0.39,0.69,0.27,0.63,0.25,0.13,0.81,0.89,0.31,0.02 $\\mathtt{E}{=}0.34$ ,0.52,0.01,0.34,0.90,0.42,0.49,0.02,0.26,0.04 </configurations> ", "page_idx": 17}, {"type": "text", "text": "<task> ", "page_idx": 17}, {"type": "text", "text": "1. First, think your answer step by step, considering the model and data definition in detail.   \n2. Then discuss each combination separately in light of your thoughts about data. Do not assign an ordering yet.   \n3. Finally, summarize all your considerations.   \n4. At the end, write your final ordering as a comma-separated list of letters within an XML tag <order></order>.   \n</task> ", "page_idx": 17}, {"type": "text", "text": "Table C.1: Accuracy of the density represented as a flow (flow) compared to a factorized normal distribution (normal), both learned from preferential data, in three metrics: log-likelihood, Wasserstein distance, and the mean marginal total variation (MMTV). Averages over 20 repetitions (but excluding a few crashed runs), with standard deviations. ", "page_idx": 18}, {"type": "table", "img_path": "sRSjr9SDKR/tmp/78f04030c0cdfbf842d5b443a56bffc925385ef5f62a90450a4139571d2a3776.jpg", "table_caption": [], "table_footnote": [], "page_idx": 18}, {"type": "text", "text": "C.3 Modified Abalone7D experiment ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "By modifying Abalone7D experiment, we can consider a synthetic technical validation constructed so that the data distribution is more realistic. We do this by mis-using a regression data set so that the response variable is interpreted as indication of preference and the queries are formed by presenting the expert a choice between different samples. If we denote by $g\\mathbf{(x}_{i})$ the regression function for the ith covariate set, then $\\mathbf{x}_{i}$ is chosen over $\\mathbf{x}_{j}$ if $g(\\mathbf{x}_{i})>g(\\mathbf{x}_{j})$ . We remark that the task itself is not particularly interesting as the response variable does not correspond to any real belief (instead, we learn a distribution over the covariates for which the response variable is high), but it is still useful for validating the algorithm as we now need to cope with choice sets that do not match any simple distribution $\\lambda(\\mathbf{x})$ . Instead, the choice sets are now formed by uniform sampling over the sample indices, which means they are drawn from the marginal distribution of the covariates. Note that this is different from the target density, which is the density of covariates for samples with high response variables. ", "page_idx": 18}, {"type": "text", "text": "In the experiment, we do not assume any noise on the expert response. Hence, the expert follows a noiseless RUM with the representative utility $g\\mathbf{(x}_{i})$ equals to the response variable of ith covariate $\\mathbf{x}_{i}$ . This means that the choice distribution resembles Dirac delta function at the points with the highest response variables. For this reason, we cannot compute the MMTV metric as it involves integrating over the absolute differences of the marginals, which leads to numerical issues. The numerical results are provided in Table C.1 and the visual results in Figure C.1. ", "page_idx": 18}, {"type": "text", "text": "C.4 Other experimental details ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Hyperparameters. In all the experiments, we use the value $s=1$ in the preferential likelihood regardless of how misspecified it is with respect to the ground-truth model. Neural Spline Models have 2 hidden layers and 128 hidden units. The number of flows is 6, 8, or 10 depending on the problem complexity. RealNVP models have 4 hidden layers and 2 hidden units. The number of flows is 36 when the number of rankings is more than 50, and 8 otherwise. Other architecture-specific details correspond to the default values implemented in the normflows package, a PyTorch-based implementation of normalizing flows [Stimper et al., 2023]. ", "page_idx": 18}, {"type": "text", "text": "Optimization details. Models are trained for a varying number of iterations from $10^{5}$ to $5\\times10^{5}$ with the Adamax optimizer [Kingma and Ba, 2014] and varying batch size from 2 to 8. The learning rate varies from $10^{-5}$ to $5\\times10^{-5}$ depending on the problem dimensionality, with higher learning rates for higher-dimensional problems. A small weight decay of $10^{-6}$ was applied. ", "page_idx": 18}, {"type": "text", "text": "Computational environment. Models are trained and evaluated on a server with nodes of two Intel Xeon processors, code name Cascade Lake, with 20 cores each running at $2.1\\:\\mathrm{GHz}$ . Double precision numbers were used to improve the stability of the training process. We did not explicitly record the training times or memory consumption, but note that the considered data sets and flow architectures are all relatively small. ", "page_idx": 18}, {"type": "text", "text": "Experiment replications. Every experiment was replicated with 20 different seeds, ranging from 1 to 20, but a few replications failed due to not well-known reasons, sometimes due to memory issues and sometimes due to numerical instabilities that led the replication to crash. The results are reported over the completed runs. In the main experiment table (Table 1), there was one failed replication in the Twogaussians20D experiment and two in the Onemoon2D experiment. ", "page_idx": 18}, {"type": "text", "text": "Dataset licence: Abalones: (CC BY 4.0) license, original source [Nash et al., 1995] ", "page_idx": 18}, {"type": "image", "img_path": "sRSjr9SDKR/tmp/44944496188e761caf79b8c98175e0724a1741bb07c7c6fb91b47b5c61623a43.jpg", "img_caption": ["Figure C.1: Full result plot for the modified Abalone7D experiment, where the target (unnormalized) belief density corresponds to the abalone age. "], "img_footnote": [], "page_idx": 19}, {"type": "text", "text": "C.5 Plots of learned belief densities ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "Figure 3 presented a subset of the cross-plots for the multivariate densities for the Abalone regression data and the LLM experiment. Here, we provide the complete visual illustrations over the full density for both, as well as corresponding visualisations for all of the other experiments in Figures C.2 to C.8. ", "page_idx": 19}, {"type": "image", "img_path": "sRSjr9SDKR/tmp/8baf232fc7b22a92d8e0537c2e2a0b48c9b2eeb369a1c330d437aed0f833cec0.jpg", "img_caption": ["Figure C.2: Gaussian6D experiment. The target distribution is depicted by light blue contour points and its marginal by a pink curve. The learned flow is depicted by dark blue contour sample points and its marginal by a black curve. "], "img_footnote": [], "page_idx": 20}, {"type": "image", "img_path": "sRSjr9SDKR/tmp/69dae90040f93532cbcdc692a82296f91cb551068c04f0e620e1ea4a368da0b8.jpg", "img_caption": ["Figure C.3: Estimated belief density for the Onemoon2D data. See Figure 1 for other visualisations on the same density. "], "img_footnote": [], "page_idx": 20}, {"type": "image", "img_path": "sRSjr9SDKR/tmp/31d0dedd2b0d7430c6650b5f59e2c676aafb41bbb3c9c6513163afe46c2afaba.jpg", "img_caption": ["Figure C.4: Twogaussians10D experiment. The target distribution is depicted by light blue contour points and its marginal by a pink curve. The learned flow is depicted by dark blue contour sample points and its marginal by a black curve. "], "img_footnote": [], "page_idx": 21}, {"type": "image", "img_path": "sRSjr9SDKR/tmp/ddcff0d3cee6171771f5f540818b079bbe0a829251d548c09d7eb7bd2c8ce199.jpg", "img_caption": ["Figure C.5: Estimated belief density for the Funnel10D data. The narrow funnel dimension $(x1)$ is extremely difficult to capture accurately, but the flow still extends more in that dimension, seen as clear skew in all marginal histograms. "], "img_footnote": [], "page_idx": 22}, {"type": "image", "img_path": "sRSjr9SDKR/tmp/b1fc1a6f04bd6197c45fbf4b9e423b1969832e92530f5741d29e2bfb5ac6f15f.jpg", "img_caption": ["Figure C.6: Full result plot for the LLM expert elicitation experiment, complementing the partial plot presented in Figure 3. "], "img_footnote": [], "page_idx": 23}, {"type": "image", "img_path": "sRSjr9SDKR/tmp/e0bf2d7d05cef12eeecb9fdca40b98083fd099e1dcd93dc2ac6430064bf20a14.jpg", "img_caption": ["Figure C.7: Full result plot for the Abalone7D experiment, complementing the partial plot presented in Figure 3. The target distribution is depicted by light blue contour points and its marginal by a pink curve. The learned flow is depicted by dark blue contour sample points and its marginal by a black curve. "], "img_footnote": [], "page_idx": 23}, {"type": "image", "img_path": "sRSjr9SDKR/tmp/ec88659670c1f60c91a5de1e13722bfa87a1c6c5e6d98f06aca59ed17a7eaef5.jpg", "img_caption": ["Figure C.8: Full result plot for the Abalone7D experiment for the baseline method. "], "img_footnote": [], "page_idx": 24}, {"type": "image", "img_path": "sRSjr9SDKR/tmp/e2f9f1df49d788ba0c770347e6002f69746a3a47321fdb4e0ebe17e195ed513b.jpg", "img_caption": ["Figure D.1: The effect of the functional prior on the learned belief density in Experiment 5.2. The left plot corresponds to learning the LLM\u2019s belief density using maximum likelihood in the training, and the right plot to using function-space maximum a posteriori with the proposed functional prior. We hypothesize that the extreme marginals (e.g. median income) obtained from maximum likelihood estimation are due to problems with collapsing or diverging probability mass. "], "img_footnote": [], "page_idx": 25}, {"type": "text", "text": "Table D.1: The means of the variables based on (first row) the distribution of California housing dataset and the sample from the preferential flow fitted to the LLM\u2019s feedback trained (second row) with the likelihood only and (third row) with the both likelihood and prior. ", "page_idx": 25}, {"type": "table", "img_path": "sRSjr9SDKR/tmp/8778706931fb77012b57100859a8dc130ec5934662310ec33527649c2e231e27.jpg", "table_caption": [], "table_footnote": [], "page_idx": 25}, {"type": "text", "text": "D Ablation studies ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "This section reports additional experimentation to complement the results presented in the main paper. Unless otherwise stated, the rest of the details in the experiments are as discussed in Sections 5 and C.4. The only exception is the number of flows, which are scaled by the number of rankings $n$ to increase flexibility in line with the available data. However, when $n$ is as in the main paper, the number of flows remains unchanged. ", "page_idx": 25}, {"type": "text", "text": "D.1 Effect of the functional prior ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "Figure D.1 shows the effect of the functional prior for the LLM experiment, showcasing how the maximum likelihood estimate learning the flow without the functional prior exhibits the diverging mass property. Table D.1 summarizes the densities in a quantitative manner by reporting the means for all variables. The table shows how the solution without the prior can be massively off already in terms of the mean estimate, for instance having the mean number of rooms at 125. ", "page_idx": 25}, {"type": "text", "text": "D.2 Effect of the noise level $1/s$ ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "Figure D.2 investigates the interplay of the true RUM noise and the assumed noise in the preferential likelihood on the Onemoon2D data. ", "page_idx": 25}, {"type": "image", "img_path": "sRSjr9SDKR/tmp/02a0fd42b7d3d80ff164f1ba720f260e3f560437eee68ec120fb55a11e586ad4.jpg", "img_caption": ["Figure D.2: Preferential flow ftited via FS-MAP with varying precision levels in the data generation process (in RUM) $s_{t r u e}$ , and precision levels in the preferential likelihood $s_{l i k}$ . The first column shows that a lower precision level in RUM leads to a more spread ftited flow, as expected. The middle plot is the only scenario where both the likelihood and the functional prior are correctly specified, resulting in the best result. Since the prior is misspecified in the bottom-right plot, the best results are not achieved, contrary to expectations. However, this misspecification does not lead to catastrophic performance deterioration but rather to a more spread-out fitted flow. "], "img_footnote": [], "page_idx": 26}, {"type": "text", "text": "D.3 Effect of the candidate sampling distribution $\\lambda$ ", "text_level": 1, "page_idx": 26}, {"type": "text", "text": "We validate the sensitivity of the results in terms the choice of the distribution $\\lambda$ that the candidates are sampled from. Figure D.3 studies the effect of $\\lambda$ , the unknown distribution from which the candidates to be compared are sampled from, complementing the experiment reported in Section 5.1 and confirming the method is robust for the choice. In the original experiment the candidates were sampled from a mixture distribution of uniform and Gaussian distribution centered on the mean of the target, with the mixture probability $w=1/3$ for the Gaussian. Figure D.3 reports the accuracy as a function of the choice of $w$ for one of the data sets (Onemoon2D), so that $\\lambda$ goes from uniform to a Gaussian, and includes also an additional reference point where $\\lambda$ equals the target. For all $w>0.5$ we reach effectively the same accuracy as when sampling from the target itself, and even for the hardest case of uniform $\\lambda$ (with $w=0$ the distance is significantly smaller than the reference scale comparing the base distribution with the target. ", "page_idx": 26}, {"type": "text", "text": "D.4 Effect of the number of rankings $n$ ", "text_level": 1, "page_idx": 26}, {"type": "text", "text": "We validate the sensitivity of the results in terms of the number of comparisons/rankings $n$ . Table D.2, as well as Figures D.4 and D.5, report the results of an experiment that studies the effect of $n$ . ", "page_idx": 26}, {"type": "text", "text": "Increasing $n$ generally improves the accuracy and already fairly small $n$ is sufficient for learning a good estimate (Table D.2). For very large $n$ , the accuracy can slightly deteriorate. We believe that this is due to prior misspecification that encourages overestimation of the variation due to the fact that $k$ is finite but in the prior it is assumed to be infinite. In the Onemoon2D experiment, Figure D.4 confirms that for $n=1000$ the shape of the estimate is extremely close and the slightly worse Wasserstein distance is due to overestimating the width. The same holds for other experiments such as Twogaussians10D illustrated in Figure D.5. ", "page_idx": 26}, {"type": "text", "text": "Figure D.3: The Onemoon2D experiment replicated for varying sampling distributions $\\lambda$ from where the candidates are sampled. In original Onemoon2D, $\\lambda$ is a mixture of uniform and Gaussian distribution centered on the mean of the target, with the mixture probability $w=1/3$ for the Gaussian. Here, $\\lambda\\,\\in\\,\\{\\mathrm{Uniform}$ , Gaussian-Uniform Mixture, Target} with letting the mixture probability $w$ to vary in $\\{0.1,1/4,1/3,1/2,2/3,3/4,1.0\\}$ . The rest of the details can be found in Section 5, specifically $n=200$ and $k=5$ . The distance between the base density and the target density (1.85) provides a scale reference. The method is robust for the sampling distribution and for broad range of $w$ we reach essentially the same accuracy as when sampling from the target itself. ", "page_idx": 27}, {"type": "image", "img_path": "sRSjr9SDKR/tmp/37a48c4e660b7e542847e93ec874071c95f7f7306bdd184f0691e90f5a1d0014.jpg", "img_caption": [], "img_footnote": [], "page_idx": 27}, {"type": "table", "img_path": "sRSjr9SDKR/tmp/532d2b68984dae0facd64061895211fc70aaca3682d4c1dae2cb652b2d11eb0c.jpg", "table_caption": ["Table D.2: Wasserstein distances for varying $n$ (fixed $k=5$ ) across different experiments "], "table_footnote": [], "page_idx": 27}, {"type": "equation", "text": "", "text_format": "latex", "page_idx": 27}, {"type": "image", "img_path": "sRSjr9SDKR/tmp/961bc0489159b92227d3117632fd08f37e1db6dcfaf427b0e0fa182a8c971657.jpg", "img_caption": ["Figure D.4: The estimated belief densities in the Onemoon2D experiment of Table D.2 (contour: true density; heatmap: estimated flow). While the coverage of the estimated density with $n=1000$ is better than with $n=100$ , there is more spread with $n=1000$ than with $n=100$ , which explains the slight performance deterioration in Table D.2. "], "img_footnote": [], "page_idx": 27}, {"type": "image", "img_path": "sRSjr9SDKR/tmp/13a7a898bdd2f249b31e66fc072286408bedda3ded275d5f480262e9f5b3aa0f.jpg", "img_caption": [], "img_footnote": [], "page_idx": 28}, {"type": "text", "text": "Figure D.5: Cross-plots of selected variables of the estimated flow in the Twogaussians10D experiment of Table D.2 (contour: true density; heatmap: estimated flow). While the coverage of the estimated density with $n=10000$ is better than with $n=500$ , there is more spread with $n=10000$ than with $n=500$ , which explains the slight performance deterioration in Table D.2. ", "page_idx": 28}, {"type": "text", "text": "D.5 Effect of the cardinality of the choice set $k$ ", "text_level": 1, "page_idx": 28}, {"type": "text", "text": "Finally, to complement the ablation studies for $k$ on synthetic settings in Section 5.3, we rerun the LLM expert elicitation experiment with $k=2$ . Figure D.6 shows that the LLM expert also works with $k=2$ . We replicated the original experiment conducted with $k=5$ and report the estimates side-by-side, visually confirming we learn the essential characteristics of the distribution in both cases. The results are not identical and the case of $k\\,=\\,5$ is likely more accurate (see e.g. the marginal distribution of the last feature), but there are no major qualitative differences between the two estimates. ", "page_idx": 28}, {"type": "image", "img_path": "sRSjr9SDKR/tmp/db2e907ee045f18e8f23f475984cc569e1f2f7347ed31c0341fec39b11bc085c.jpg", "img_caption": ["Figure D.6: The LLM expert elicitation experiment replicated for the setting of pairwise comparisons (left) and compared to the original setting of 5-wise rankings (right). The estimated flow remains qualitatively the same for the variables shown here (other variables omitted due to lack of space), and this holds true for the rest of the variables as well. "], "img_footnote": [], "page_idx": 28}, {"type": "text", "text": "NeurIPS Paper Checklist ", "text_level": 1, "page_idx": 29}, {"type": "text", "text": "1. Claims ", "text_level": 1, "page_idx": 29}, {"type": "text", "text": "Question: Do the main claims made in the abstract and introduction accurately reflect the paper\u2019s contributions and scope? ", "page_idx": 29}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 29}, {"type": "text", "text": "Justification: The abstract lists the main claims and they are summarized at the end of the Introduction, and the paper includes both theoretical analysis and empirical experiments verifying the claims. ", "page_idx": 29}, {"type": "text", "text": "Guidelines: ", "page_idx": 29}, {"type": "text", "text": "\u2022 The answer NA means that the abstract and introduction do not include the claims made in the paper.   \n\u2022 The abstract and/or introduction should clearly state the claims made, including the contributions made in the paper and important assumptions and limitations. A No or NA answer to this question will not be perceived well by the reviewers.   \n\u2022 The claims made should match theoretical and experimental results, and reflect how much the results can be expected to generalize to other settings.   \n\u2022 It is fine to include aspirational goals as motivation as long as it is clear that these goals are not attained by the paper. ", "page_idx": 29}, {"type": "text", "text": "2. Limitations ", "text_level": 1, "page_idx": 29}, {"type": "text", "text": "Question: Does the paper discuss the limitations of the work performed by the authors? ", "page_idx": 29}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 29}, {"type": "text", "text": "Justification: The limitations are discussed in Section 6, titled Discussion. We explain technical limitations and limitations of the empirical validation, and explain in detail what kind of additional validation would be useful in addressing the limitations. ", "page_idx": 29}, {"type": "text", "text": "Guidelines: ", "text_level": 1, "page_idx": 29}, {"type": "text", "text": "\u2022 The answer NA means that the paper has no limitation while the answer No means that the paper has limitations, but those are not discussed in the paper.   \n\u2022 The authors are encouraged to create a separate \"Limitations\" section in their paper.   \n\u2022 The paper should point out any strong assumptions and how robust the results are to violations of these assumptions (e.g., independence assumptions, noiseless settings, model well-specification, asymptotic approximations only holding locally). The authors should reflect on how these assumptions might be violated in practice and what the implications would be.   \n\u2022 The authors should reflect on the scope of the claims made, e.g., if the approach was only tested on a few datasets or with a few runs. In general, empirical results often depend on implicit assumptions, which should be articulated.   \n\u2022 The authors should reflect on the factors that influence the performance of the approach. For example, a facial recognition algorithm may perform poorly when image resolution is low or images are taken in low lighting. Or a speech-to-text system might not be used reliably to provide closed captions for online lectures because it fails to handle technical jargon.   \n\u2022 The authors should discuss the computational efficiency of the proposed algorithms and how they scale with dataset size.   \n\u2022 If applicable, the authors should discuss possible limitations of their approach to address problems of privacy and fairness.   \n\u2022 While the authors might fear that complete honesty about limitations might be used by reviewers as grounds for rejection, a worse outcome might be that reviewers discover limitations that aren\u2019t acknowledged in the paper. The authors should use their best judgment and recognize that individual actions in favor of transparency play an important role in developing norms that preserve the integrity of the community. Reviewers will be specifically instructed to not penalize honesty concerning limitations. ", "page_idx": 29}, {"type": "text", "text": "3. Theory Assumptions and Proofs ", "text_level": 1, "page_idx": 29}, {"type": "text", "text": "Question: For each theoretical result, does the paper provide the full set of assumptions and a complete (and correct) proof? ", "page_idx": 30}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 30}, {"type": "text", "text": "Justification: We clearly and explicitly state the full set of assumptions, the formal definitions of the key concepts, and provide three propositions and theorems that characterize the method\u2019s properties. The full proofs are provided in Appendix, with key intuitions explained in the main paper. ", "page_idx": 30}, {"type": "text", "text": "Guidelines: ", "page_idx": 30}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include theoretical results.   \n\u2022 All the theorems, formulas, and proofs in the paper should be numbered and crossreferenced.   \n\u2022 All assumptions should be clearly stated or referenced in the statement of any theorems.   \n\u2022 The proofs can either appear in the main paper or the supplemental material, but if they appear in the supplemental material, the authors are encouraged to provide a short proof sketch to provide intuition.   \n\u2022 Inversely, any informal proof provided in the core of the paper should be complemented by formal proofs provided in appendix or supplemental material.   \n\u2022 Theorems and Lemmas that the proof relies upon should be properly referenced. ", "page_idx": 30}, {"type": "text", "text": "4. Experimental Result Reproducibility ", "text_level": 1, "page_idx": 30}, {"type": "text", "text": "Question: Does the paper fully disclose all the information needed to reproduce the main experimental results of the paper to the extent that it affects the main claims and/or conclusions of the paper (regardless of whether the code and data are provided or not)? ", "page_idx": 30}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 30}, {"type": "text", "text": "Justification: We provide sufficient details for reproducing the experiments. The newly proposed algorithm is described via concrete mathematical expressions and pseudocode. Majority of the empirical experiments are conducted on either simulated or publicly available data, and we provide description of the simulation process (in Appendix) and reference for the public data sets, and the code release allows replicating the experiments in whole. For the LLM experiment we provide the exact prompts and make available the LLM responses in the code release, but we note that from the perspective of these experiments the specific LLM or data is not particularly critical; the data is used for verification of the algorithm. ", "page_idx": 30}, {"type": "text", "text": "Guidelines: ", "page_idx": 30}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 If the paper includes experiments, a No answer to this question will not be perceived well by the reviewers: Making the paper reproducible is important, regardless of whether the code and data are provided or not.   \n\u2022 If the contribution is a dataset and/or model, the authors should describe the steps taken to make their results reproducible or verifiable.   \n\u2022 Depending on the contribution, reproducibility can be accomplished in various ways. For example, if the contribution is a novel architecture, describing the architecture fully might suffice, or if the contribution is a specific model and empirical evaluation, it may be necessary to either make it possible for others to replicate the model with the same dataset, or provide access to the model. In general. releasing code and data is often one good way to accomplish this, but reproducibility can also be provided via detailed instructions for how to replicate the results, access to a hosted model (e.g., in the case of a large language model), releasing of a model checkpoint, or other means that are appropriate to the research performed.   \n\u2022 While NeurIPS does not require releasing code, the conference does require all submissions to provide some reasonable avenue for reproducibility, which may depend on the nature of the contribution. For example (a) If the contribution is primarily a new algorithm, the paper should make it clear how to reproduce that algorithm. (b) If the contribution is primarily a new model architecture, the paper should describe the architecture clearly and fully.   \n(c) If the contribution is a new model (e.g., a large language model), then there should either be a way to access this model for reproducing the results or a way to reproduce the model (e.g., with an open-source dataset or instructions for how to construct the dataset).   \n(d) We recognize that reproducibility may be tricky in some cases, in which case authors are welcome to describe the particular way they provide for reproducibility. In the case of closed-source models, it may be that access to the model is limited in some way (e.g., to registered users), but it should be possible for other researchers to have some path to reproducing or verifying the results. ", "page_idx": 30}, {"type": "text", "text": "", "page_idx": 31}, {"type": "text", "text": "5. Open access to data and code ", "text_level": 1, "page_idx": 31}, {"type": "text", "text": "Question: Does the paper provide open access to the data and code, with sufficient instructions to faithfully reproduce the main experimental results, as described in supplemental material? ", "page_idx": 31}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 31}, {"type": "text", "text": "Justification: We provide code that includes both implementation of the algorithm and scripts for re-running the experiments. Code is available at https://github.com/petrusmikkola/prefflow. ", "page_idx": 31}, {"type": "text", "text": "Guidelines: ", "page_idx": 31}, {"type": "text", "text": "\u2022 The answer NA means that paper does not include experiments requiring code.   \n\u2022 Please see the NeurIPS code and data submission guidelines (https://nips.cc/ public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 While we encourage the release of code and data, we understand that this might not be possible, so \u201cNo\u201d is an acceptable answer. Papers cannot be rejected simply for not including code, unless this is central to the contribution (e.g., for a new open-source benchmark).   \n\u2022 The instructions should contain the exact command and environment needed to run to reproduce the results. See the NeurIPS code and data submission guidelines (https: //nips.cc/public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 The authors should provide instructions on data access and preparation, including how to access the raw data, preprocessed data, intermediate data, and generated data, etc.   \n\u2022 The authors should provide scripts to reproduce all experimental results for the new proposed method and baselines. If only a subset of experiments are reproducible, they should state which ones are omitted from the script and why.   \n\u2022 At submission time, to preserve anonymity, the authors should release anonymized versions (if applicable).   \n\u2022 Providing as much information as possible in supplemental material (appended to the paper) is recommended, but including URLs to data and code is permitted. ", "page_idx": 31}, {"type": "text", "text": "6. Experimental Setting/Details ", "text_level": 1, "page_idx": 31}, {"type": "text", "text": "Question: Does the paper specify all the training and test details (e.g., data splits, hyperparameters, how they were chosen, type of optimizer, etc.) necessary to understand the results? ", "page_idx": 31}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 31}, {"type": "text", "text": "Justification: We provide the information in writing and the same information can additionally be found in the code. ", "page_idx": 31}, {"type": "text", "text": "Guidelines: ", "page_idx": 31}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments. \u2022 The experimental setting should be presented in the core of the paper to a level of detail that is necessary to appreciate the results and make sense of them. \u2022 The full details can be provided either with the code, in appendix, or as supplemental material. ", "page_idx": 31}, {"type": "text", "text": "7. Experiment Statistical Significance ", "text_level": 1, "page_idx": 31}, {"type": "text", "text": "Question: Does the paper report error bars suitably and correctly defined or other appropriate information about the statistical significance of the experiments? ", "page_idx": 31}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 32}, {"type": "text", "text": "Justification: We do not make direct comparisons for which testing statistical significance would be applicable, but we do report all numerical values with uncertainty intervals over multiple runs and disclose the details on how this was done. ", "page_idx": 32}, {"type": "text", "text": "Guidelines: ", "page_idx": 32}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The authors should answer \"Yes\" if the results are accompanied by error bars, confidence intervals, or statistical significance tests, at least for the experiments that support the main claims of the paper.   \n\u2022 The factors of variability that the error bars are capturing should be clearly stated (for example, train/test split, initialization, random drawing of some parameter, or overall run with given experimental conditions).   \n\u2022 The method for calculating the error bars should be explained (closed form formula, call to a library function, bootstrap, etc.)   \n\u2022 The assumptions made should be given (e.g., Normally distributed errors).   \n\u2022 It should be clear whether the error bar is the standard deviation or the standard error of the mean.   \n\u2022 It is OK to report 1-sigma error bars, but one should state it. The authors should preferably report a 2-sigma error bar than state that they have a $96\\%$ CI, if the hypothesis of Normality of errors is not verified.   \n\u2022 For asymmetric distributions, the authors should be careful not to show in tables or figures symmetric error bars that would yield results that are out of range (e.g. negative error rates).   \n\u2022 If error bars are reported in tables or plots, The authors should explain in the text how they were calculated and reference the corresponding figures or tables in the text. ", "page_idx": 32}, {"type": "text", "text": "8. Experiments Compute Resources ", "text_level": 1, "page_idx": 32}, {"type": "text", "text": "Question: For each experiment, does the paper provide sufficient information on the computer resources (type of compute workers, memory, time of execution) needed to reproduce the experiments? ", "page_idx": 32}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 32}, {"type": "text", "text": "Justification: We explain the used computational environment used to run the experiments in Section C \"Experimental details\". We state that the computational cost of the new algorithm is similar to broad range of related work, but we did not store exact execution times or memory requirements during experimentation and hence do not report them. The core research questions in the paper are about learning models from very limited data and the question of computational resources is not particularly important for the work. ", "page_idx": 32}, {"type": "text", "text": "Guidelines: ", "page_idx": 32}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The paper should indicate the type of compute workers CPU or GPU, internal cluster, or cloud provider, including relevant memory and storage.   \n\u2022 The paper should provide the amount of compute required for each of the individual experimental runs as well as estimate the total compute.   \n\u2022 The paper should disclose whether the full research project required more compute than the experiments reported in the paper (e.g., preliminary or failed experiments that didn\u2019t make it into the paper). ", "page_idx": 32}, {"type": "text", "text": "9. Code Of Ethics ", "text_level": 1, "page_idx": 32}, {"type": "text", "text": "Question: Does the research conducted in the paper conform, in every respect, with the NeurIPS Code of Ethics https://neurips.cc/public/EthicsGuidelines? ", "page_idx": 32}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 32}, {"type": "text", "text": "Justification: We follow the Code of Ethics as instructed and have not identified any risk of violations. ", "page_idx": 32}, {"type": "text", "text": "Guidelines: ", "page_idx": 32}, {"type": "text", "text": "\u2022 The answer NA means that the authors have not reviewed the NeurIPS Code of Ethics.   \n\u2022 If the authors answer No, they should explain the special circumstances that require a deviation from the Code of Ethics.   \n\u2022 The authors should make sure to preserve anonymity (e.g., if there is a special consideration due to laws or regulations in their jurisdiction). ", "page_idx": 33}, {"type": "text", "text": "10. Broader Impacts ", "text_level": 1, "page_idx": 33}, {"type": "text", "text": "Question: Does the paper discuss both potential positive societal impacts and negative societal impacts of the work performed? ", "page_idx": 33}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 33}, {"type": "text", "text": "Justification: These aspects are briefly discussed at the end of Conclusions, in a clearly marked paragraph. As methodological contribution our work does not raise new concerns of negative societal impacts. ", "page_idx": 33}, {"type": "text", "text": "Guidelines: ", "text_level": 1, "page_idx": 33}, {"type": "text", "text": "\u2022 The answer NA means that there is no societal impact of the work performed.   \n\u2022 If the authors answer NA or No, they should explain why their work has no societal impact or why the paper does not address societal impact.   \n\u2022 Examples of negative societal impacts include potential malicious or unintended uses (e.g., disinformation, generating fake profiles, surveillance), fairness considerations (e.g., deployment of technologies that could make decisions that unfairly impact specific groups), privacy considerations, and security considerations.   \n\u2022 The conference expects that many papers will be foundational research and not tied to particular applications, let alone deployments. However, if there is a direct path to any negative applications, the authors should point it out. For example, it is legitimate to point out that an improvement in the quality of generative models could be used to generate deepfakes for disinformation. On the other hand, it is not needed to point out that a generic algorithm for optimizing neural networks could enable people to train models that generate Deepfakes faster.   \n\u2022 The authors should consider possible harms that could arise when the technology is being used as intended and functioning correctly, harms that could arise when the technology is being used as intended but gives incorrect results, and harms following from (intentional or unintentional) misuse of the technology.   \n\u2022 If there are negative societal impacts, the authors could also discuss possible mitigation strategies (e.g., gated release of models, providing defenses in addition to attacks, mechanisms for monitoring misuse, mechanisms to monitor how a system learns from feedback over time, improving the efficiency and accessibility of ML). ", "page_idx": 33}, {"type": "text", "text": "11. Safeguards ", "text_level": 1, "page_idx": 33}, {"type": "text", "text": "Question: Does the paper describe safeguards that have been put in place for responsible release of data or models that have a high risk for misuse (e.g., pretrained language models, image generators, or scraped datasets)? ", "page_idx": 33}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 33}, {"type": "text", "text": "Justification: Our experimentation and data sets are technical in nature and bear no risk of misuse. They are only used for technical validation of the algorithms and we do not release data or pretrained models relating to real-world scenarios. ", "page_idx": 33}, {"type": "text", "text": "Guidelines: ", "page_idx": 33}, {"type": "text", "text": "\u2022 The answer NA means that the paper poses no such risks.   \n\u2022 Released models that have a high risk for misuse or dual-use should be released with necessary safeguards to allow for controlled use of the model, for example by requiring that users adhere to usage guidelines or restrictions to access the model or implementing safety filters.   \n\u2022 Datasets that have been scraped from the Internet could pose safety risks. The authors should describe how they avoided releasing unsafe images.   \n\u2022 We recognize that providing effective safeguards is challenging, and many papers do not require this, but we encourage authors to take this into account and make a best faith effort. ", "page_idx": 33}, {"type": "text", "text": "12. Licenses for existing assets ", "text_level": 1, "page_idx": 34}, {"type": "text", "text": "Question: Are the creators or original owners of assets (e.g., code, data, models), used in the paper, properly credited and are the license and terms of use explicitly mentioned and properly respected? ", "page_idx": 34}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 34}, {"type": "text", "text": "Justification: We adequately cite all sources and follow the licenses. ", "page_idx": 34}, {"type": "text", "text": "Guidelines: ", "page_idx": 34}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not use existing assets.   \n\u2022 The authors should cite the original paper that produced the code package or dataset.   \n\u2022 The authors should state which version of the asset is used and, if possible, include a URL.   \n\u2022 The name of the license (e.g., CC-BY 4.0) should be included for each asset.   \n\u2022 For scraped data from a particular source (e.g., website), the copyright and terms of service of that source should be provided.   \n\u2022 If assets are released, the license, copyright information, and terms of use in the package should be provided. For popular datasets, paperswithcode.com/datasets has curated licenses for some datasets. Their licensing guide can help determine the license of a dataset.   \n\u2022 For existing datasets that are re-packaged, both the original license and the license of the derived asset (if it has changed) should be provided.   \n\u2022 If this information is not available online, the authors are encouraged to reach out to the asset\u2019s creators. ", "page_idx": 34}, {"type": "text", "text": "13. New Assets ", "text_level": 1, "page_idx": 34}, {"type": "text", "text": "Question: Are new assets introduced in the paper well documented and is the documentation provided alongside the assets? ", "page_idx": 34}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 34}, {"type": "text", "text": "Justification: We do not provide new assets, other than releasing technical data for reproducibility purposes. ", "page_idx": 34}, {"type": "text", "text": "Guidelines: ", "page_idx": 34}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not release new assets.   \n\u2022 Researchers should communicate the details of the dataset/code/model as part of their submissions via structured templates. This includes details about training, license, limitations, etc.   \n\u2022 The paper should discuss whether and how consent was obtained from people whose asset is used.   \n\u2022 At submission time, remember to anonymize your assets (if applicable). You can either create an anonymized URL or include an anonymized zip file. ", "page_idx": 34}, {"type": "text", "text": "14. Crowdsourcing and Research with Human Subjects ", "text_level": 1, "page_idx": 34}, {"type": "text", "text": "Question: For crowdsourcing experiments and research with human subjects, does the paper include the full text of instructions given to participants and screenshots, if applicable, as well as details about compensation (if any)? ", "page_idx": 34}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 34}, {"type": "text", "text": "Justification: Even though our method is designed to eventually be used also in applications that involve human subjects (expert knowledge elicitation), we do not use any data relating to humans in this paper but instead evaluate the method in simulated scenarios and by using a large language model as a proxy for a human expert. ", "page_idx": 34}, {"type": "text", "text": "Guidelines: ", "page_idx": 34}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Including this information in the supplemental material is fine, but if the main contribution of the paper involves human subjects, then as much detail as possible should be included in the main paper. ", "page_idx": 34}, {"type": "text", "text": "\u2022 According to the NeurIPS Code of Ethics, workers involved in data collection, curation, or other labor should be paid at least the minimum wage in the country of the data collector. ", "page_idx": 35}, {"type": "text", "text": "15. Institutional Review Board (IRB) Approvals or Equivalent for Research with Human Subjects ", "text_level": 1, "page_idx": 35}, {"type": "text", "text": "Question: Does the paper describe potential risks incurred by study participants, whether such risks were disclosed to the subjects, and whether Institutional Review Board (IRB) approvals (or an equivalent approval/review based on the requirements of your country or institution) were obtained? ", "page_idx": 35}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 35}, {"type": "text", "text": "Justification: Not required due to not using any data related to human subjects. ", "page_idx": 35}, {"type": "text", "text": "Guidelines: ", "page_idx": 35}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Depending on the country in which research is conducted, IRB approval (or equivalent) may be required for any human subjects research. If you obtained IRB approval, you should clearly state this in the paper.   \n\u2022 We recognize that the procedures for this may vary significantly between institutions and locations, and we expect authors to adhere to the NeurIPS Code of Ethics and the guidelines for their institution.   \n\u2022 For initial submissions, do not include any information that would break anonymity (if applicable), such as the institution conducting the review. ", "page_idx": 35}]