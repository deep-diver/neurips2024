[{"figure_path": "yS9xU6ANiA/figures/figures_0_1.jpg", "caption": "Figure 1: A brief illustration of SCM, PCH and counterfactual concepts.", "description": "This figure illustrates the relationship between Structural Causal Models (SCMs), the Pearl Causal Hierarchy (PCH), and counterfactual reasoning.  It shows how SCMs represent causal relationships between variables. The PCH organizes three levels of causal reasoning: observational (what is), interventional (what would happen if we intervened), and counterfactual (what would have happened if something different had occurred). The figure uses icons to represent human behavior (observation, intervention, and counterfactual reasoning) and formal language representations (probabilities of observational, interventional, and counterfactual events).", "section": "1 Introduction"}, {"figure_path": "yS9xU6ANiA/figures/figures_7_1.jpg", "caption": "Figure 3: LL (negative Eq. 8) and ESP, FR on SIMPSON-NLIN. As LL increases, ESP increases while FR decreases, until convergence.", "description": "This figure shows the relationship between the negative log-likelihood (LL, which is the optimization objective), effective sample proportion (ESP), and failure rate (FR) during the training process of the Exogenous Matching (EXOM) method on the SIMPSON-NLIN structural causal model (SCM).  As the LL increases (meaning the model is learning better), the ESP also increases (indicating higher sampling efficiency), and the FR decreases (meaning fewer samples are wasted because the method is better at concentrating on the important regions of the sample space).  The figure demonstrates the convergence of the EXOM method.", "section": "Experiments"}, {"figure_path": "yS9xU6ANiA/figures/figures_8_1.jpg", "caption": "Figure 4: Ablation study for Markov boundaries on 4 different settings of SCMs: (a) SIMPSON-NLIN, (b) LARGEBD-NLIN, (c) M, (d) NAPKIN. A higher ESP signifies greater sampling efficiency. In most cases, EXOM with Markov boundaries masked (orange bar) exhibits superior performance compared to when the Markov boundaries are not masked (blue bar).", "description": "This ablation study compares the performance of EXOM with and without Markov boundary masking on four different types of SCMs.  The results, measured by Effective Sample Proportion (ESP), demonstrate that injecting Markov boundary knowledge generally improves sampling efficiency and leads to better performance. The figure shows ESP values for four different scenarios (SIMPSON-NLIN, LARGEBD-NLIN, M, NAPKIN) across various density estimation models (GMM, MAF, NICE, SOSPF).", "section": "Experiments"}, {"figure_path": "yS9xU6ANiA/figures/figures_28_1.jpg", "caption": "Figure 2: Overview of the conditioning and masking process. y* serves as the input to the entire process, m represents the inferred mask, and the vectorized parameters by of the proposal distribution QUly are the output. Different colors represent information from different submodels. Both h and g represent neural networks.", "description": "This figure illustrates the process of how the counterfactual information is used to generate parameters for the proposal distribution in the Exogenous Matching method. The input is the counterfactual event y*, which is processed by functions h and g (neural networks) to produce the masked parameters \u03b8y*.  The mask m helps to incorporate the counterfactual Markov boundaries, effectively focusing the proposal distribution on the relevant parts of the exogenous distribution.  Different colors highlight the information from different submodels used in the process.", "section": "3.2 Learning and Inference"}, {"figure_path": "yS9xU6ANiA/figures/figures_36_1.jpg", "caption": "Figure 8: The relationship between ESP and LL on 4 SCMs with distinct types and 4 different density estimation models. Within these combinations, ESP always increases with the improvement of LL.", "description": "This figure shows the relationship between the Effective Sample Proportion (ESP) and the negative log-likelihood (LL) during the training process of the Exogenous Matching (EXOM) method.  Four different types of Structural Causal Models (SCMs) are used, along with four different density estimation models. The results indicate that as the LL (which is being minimized during training) improves, the ESP consistently improves across all combinations of SCMs and density estimation models.  This suggests that the proposed optimization method effectively reduces the variance of the counterfactual estimator.", "section": "C.5 Convergence"}, {"figure_path": "yS9xU6ANiA/figures/figures_37_1.jpg", "caption": "Figure 3: LL (negative Eq. 8) and ESP, FR on SIMPSON-NLIN. As LL increases, ESP increases while FR decreases, until convergence.", "description": "This figure shows the relationship between the negative log-likelihood (LL, which is the optimization objective), the effective sample proportion (ESP), and the failure rate (FR) during the training process of the Exogenous Matching (EXOM) method on the SIMPSON-NLIN dataset.  The plot demonstrates that as the model learns (indicated by increasing LL), the sampling efficiency (ESP) improves while the failure rate (FR) decreases, eventually converging to a stable point. This supports the paper's claim that EXOM is effective in learning good proposal distributions for counterfactual estimation.", "section": "Experiments"}, {"figure_path": "yS9xU6ANiA/figures/figures_38_1.jpg", "caption": "Figure 3: LL (negative Eq. 8) and ESP, FR on SIMPSON-NLIN. As LL increases, ESP increases while FR decreases, until convergence.", "description": "This figure shows the relationship between the negative log-likelihood of the objective function (LL), effective sample proportion (ESP), and failure rate (FR) during the training process of the Exogenous Matching (EXOM) method on the SIMPSON-NLIN dataset.  The x-axis represents the training iterations or epochs. The y-axis shows the values of LL, ESP, and FR.  The plot demonstrates that as the model trains and the LL increases (the model fits better), the ESP increases (meaning more samples are effectively used in the estimation), while the FR decreases (meaning the method is performing well on a larger proportion of the test cases). This trend continues until the model converges, indicating a point where further training does not yield significant improvements.", "section": "Experiments"}, {"figure_path": "yS9xU6ANiA/figures/figures_38_2.jpg", "caption": "Figure 4: Ablation study for Markov boundaries on 4 different settings of SCMs: (a) SIMPSON-NLIN, (b) LARGEBD-NLIN, (c) M, (d) NAPKIN. A higher ESP signifies greater sampling efficiency. In most cases, EXOM with Markov boundaries masked (orange bar) exhibits superior performance compared to when the Markov boundaries are not masked (blue bar).", "description": "This figure shows the results of an ablation study that investigated the impact of using Markov boundaries on the performance of the proposed method (EXOM). The study was conducted on four different types of structural causal models (SCMs), and the results indicate that using Markov boundaries generally improves sampling efficiency, especially when the boundaries are masked.", "section": "Experiments"}, {"figure_path": "yS9xU6ANiA/figures/figures_40_1.jpg", "caption": "Figure 4: Ablation study for Markov boundaries on 4 different settings of SCMs: (a) SIMPSON-NLIN, (b) LARGEBD-NLIN, (c) M, (d) NAPKIN. A higher ESP signifies greater sampling efficiency. In most cases, EXOM with Markov boundaries masked (orange bar) exhibits superior performance compared to when the Markov boundaries are not masked (blue bar).", "description": "This figure presents the results of an ablation study to evaluate the impact of injecting counterfactual Markov boundaries on the performance of the proposed EXOM method.  Four different structural causal models (SCMs) are tested: SIMPSON-NLIN, LARGEBD-NLIN, M, and NAPKIN.  The figure shows the Effective Sample Proportion (ESP), a metric of sampling efficiency, for each SCM, comparing the EXOM performance with Markov boundaries masked to the performance without masking. The results demonstrate that in most cases, the performance with masked Markov boundaries is better.", "section": "Experiments"}, {"figure_path": "yS9xU6ANiA/figures/figures_40_2.jpg", "caption": "Figure 4: Ablation study for Markov boundaries on 4 different settings of SCMs: (a) SIMPSON-NLIN, (b) LARGEBD-NLIN, (c) M, (d) NAPKIN. A higher ESP signifies greater sampling efficiency. In most cases, EXOM with Markov boundaries masked (orange bar) exhibits superior performance compared to when the Markov boundaries are not masked (blue bar).", "description": "This ablation study investigates the impact of using Markov boundaries on the efficiency of the proposed Exogenous Matching (EXOM) method.  Four different structural causal models (SCMs) are used, representing varying complexities: SIMPSON-NLIN, LARGEBD-NLIN, M, and NAPKIN.  The results are shown for each SCM, comparing the effective sample proportion (ESP) when the Markov boundaries are masked (orange bars) versus when they are not (blue bars).  Higher ESP indicates better sampling efficiency. The figure demonstrates that in most cases, masking the Markov boundaries improves the performance of EXOM.", "section": "Experiments"}, {"figure_path": "yS9xU6ANiA/figures/figures_41_1.jpg", "caption": "Figure 4: Ablation study for Markov boundaries on 4 different settings of SCMs: (a) SIMPSON-NLIN, (b) LARGEBD-NLIN, (c) M, (d) NAPKIN. A higher ESP signifies greater sampling efficiency. In most cases, EXOM with Markov boundaries masked (orange bar) exhibits superior performance compared to when the Markov boundaries are not masked (blue bar).", "description": "This figure presents the results of an ablation study on the impact of injecting Markov boundaries on the performance of the proposed Exogenous Matching (EXOM) method. Four different structural causal models (SCMs) are used: SIMPSON-NLIN, LARGEBD-NLIN, M, and NAPKIN, each representing a different setting. The performance metric used is Effective Sample Proportion (ESP), which measures sampling efficiency.  The experiment compares the performance of EXOM with and without Markov boundaries masked. In most cases, masking the Markov boundaries leads to significantly better ESP values. This suggests that incorporating structural prior knowledge enhances the effectiveness of the EXOM method.", "section": "Experiments"}, {"figure_path": "yS9xU6ANiA/figures/figures_41_2.jpg", "caption": "Figure 13: Ablation study for Markov boundaries on 4 different settings of SCMs: (a) SIMPSON-NLIN, (b) LARGEBD-NLIN, (c) M, (d) NAPKIN. Lower FR indicates broader coverage.", "description": "This figure shows the ablation study for Markov boundaries on four different settings of structural causal models (SCMs).  The four SCMs are SIMPSON-NLIN, LARGEBD-NLIN, M, and NAPKIN. The ablation study focuses on the impact of Markov boundaries on the failure rate (FR), which measures how well the proposal distribution covers the state space of the counterfactual variables. Lower FR indicates that the method performs well across a broader range of counterfactual events.", "section": "C.8 Ablation"}]