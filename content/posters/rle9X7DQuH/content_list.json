[{"type": "text", "text": "OwMatch: Conditional Self-Labeling with Consistency for Open-World Semi-Supervised Learning ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Shengjie $\\mathbf{Niu^{1*}}$ , Lifan $\\mathbf{Lin^{2}}$ ,\u2217 Jian Huang1, Chao Wang2\u2020 ", "page_idx": 0}, {"type": "text", "text": "1Hong Kong Polytechnic University, 2Southern University of Science and Technology shengjie.niu@connect.polyu.hk, 12012816@mail.sustech.edu.cn, j.huang@polyu.edu.hk, wangc6@sustech.edu.cn ", "page_idx": 0}, {"type": "text", "text": "Abstract ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Semi-supervised learning (SSL) offers a robust framework for harnessing the potential of unannotated data. Traditionally, SSL mandates that all classes possess labeled instances. However, the emergence of open-world SSL (OwSSL) introduces a more practical challenge, wherein unlabeled data may encompass samples from unseen classes. This scenario leads to the misclassification of unseen classes as known ones, consequently undermining classification accuracy. To overcome this challenge, this study revisits two methodologies from self-supervised and semisupervised learning, self-labeling and consistency, tailoring them to address the OwSSL problem. Specifically, we propose an effective framework called OwMatch, combining conditional self-labeling and open-world hierarchical thresholding. Theoretically, we analyze the estimation of class distribution on unlabeled data through rigorous statistical analysis, thus demonstrating that OwMatch can ensure the unbiasedness of the self-label assignment estimator with reliability. Comprehensive empirical analyses demonstrate that our method yields substantial performance enhancements across both known and unknown classes in comparison to previous studies. Code is available at https://github.com/niusj03/OwMatch. ", "page_idx": 0}, {"type": "text", "text": "1 Introduction ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Deep learning has made remarkable success in various tasks by leveraging substantial labeled training data [22, 21, 13]. However, the costly and time-consuming labeling process limits their application in practical scenarios. Semi-supervised learning (SSL) significantly reduces the dependency on labeled data by exploring the inherent structure of unlabeled data [16]. Despite promising results, SSL methods assume a closed-world scenario where, though limited, all classes possess labeled instances. This assumption may be violated due to difficulties in data collection, such as in medical diagnostics, where it is common to encounter new symptoms or fail to annotate due to technical constraints. As a result, only a subset of the categories can be precisely labeled during the annotation process. Recently, numerous studies have sought to identify such novel classes effectively. Open-world SSL (OwSSL) is innovative in promoting dual objectives: classifying instances of seen classes and discovering instances of novel classes [5]. ", "page_idx": 0}, {"type": "text", "text": "A notable challenge in OwSSL is the confirmation bias of model: model tends to predict instances as seen classes owing to the lack of ground-truth supervision of novel-class instances. To eliminate this bias, existing works utilize unsupervised clustering methods, including contrastive loss and binary cross-entropy (BCE) loss, to group pairs identified by similarity metrics [5, 15]. Among these unsupervised techniques, self-labeling [1, 6] has shown remarkable success, which involves assigning self-labels to unlabeled data, with the generation of high-quality self-labels being the key factor. Previous studies utilize optimal transport to align the self-labels for unlabeled data with a given distribution. However, this self-label generation fully relies on the accurate prior distribution and lack of consideration of the supervision of labeled data. In TRSSL [34], the unlabeled data are assigned with a soft self-label based on the inaccurate class distribution, which raises a biased estimation. Moreover, the confirmation bias still exists even if we use the ground-truth distribution to align the unlabeled data in the same process. In addition to confirmation bias, a new issue called clustering misalignment arises when self-labeling depends solely on unlabeled data: without proper guidance, the self-labeling process may adopt varying criteria for clustering. For example, it might cluster data based on superficial features like color rather than high-level semantic information. This misalignment can lead to results that deviate from expected outcomes and even contradict the classification criteria established by labeled data. ", "page_idx": 0}, {"type": "image", "img_path": "rle9X7DQuH/tmp/300a6d417973c141645227d921387e0de5901ca83086887e8e539fac7b644c12.jpg", "img_caption": ["Figure 1: Experimental results on the OwSSL problem. (a) Self-label assignment of seen classes (1-5) and novel classes (6-10) with or without conditional component in self-labeling. (b) Predictive confidence and hierarchical threshold for each class. "], "img_footnote": [], "page_idx": 1}, {"type": "text", "text": "", "page_idx": 1}, {"type": "text", "text": "Consequently, we propose a new self-labeling scheme, conditional self-labeling, designed to address the challenges of OwSSL, particularly targeting issues related to confirmation bias and misalignment. This scheme limits self-labels for each class and incorporates labeled data to generate debiased and informative self-label assignments for all training data, further mitigating the confirmation bias as shown in Figure 1a. Additionally, as illustrated in Figure 1b, seen classes typically exhibit higher predictive confidence, while novel clusters demonstrate variability in their internal learning progresses. The disparities in learning paces between seen and novel classes, coupled with their distinct behaviors, necessitate the selection of appropriate thresholds to facilitate cluster learning. To address these challenges and ensure a balanced learning process across classes, we propose a hierarchical thresholding scheme. ", "page_idx": 1}, {"type": "text", "text": "We demonstrate our contributions as follows: 1) We introduce a novel conditional self-labeling method to incorporate labeled data into the clustering process, reducing confirmation bias and misalignment. 2) We design a hierarchical thresholding strategy that balances learning difficulties across different classes, helping unstable clusters gradually form. 3) Our theoretical analysis rigorously discusses the unbiasedness and reliability of conditional self-labeling estimator from population-level statistics. To the best of our knowledge, this is the first work proposing the expectation of chi-square statistics (ECS) to evaluate the reliability of self-label assignment estimation. 4) We conduct extensive experiments on various datasets, demonstrating the effectiveness of our approach, OwMatch, through detailed comparisons. On CIFAR-10, OwMatch significantly outperforms FixMatch [36] by up to $47.3\\%$ in all-class accuracy, while on CIFAR-100, it enhances TRSSL [34], the state-of-the-art model in OwSSL, by up to $14.6\\%$ in novel-class and $7.2\\%$ in all-class accuracy. ", "page_idx": 1}, {"type": "text", "text": "2 Related work ", "text_level": 1, "page_idx": 1}, {"type": "text", "text": "Traditional semi-supervised learning (SSL). Traditional SSL assumes that labeled and unlabeled data share an identical distribution. Extensive researches on SSL have spanned a considerable duration. The commonly employed strategies in SSL consist of entropy minimization [29, 14], consistency regularization [44, 30] and holistic methods [4, 3, 36]. The latest progresses in SSL include adaptive thresholding strategies [42, 45, 47], which enhance model performance by accounting for varying difficulties and learning conditions across classes, alongside other innovative techniques [19, 41, 2] that employ self-SL approaches to facilitate extracting the semantic information from unlabeled data. However, traditional SSL algorithms typically struggle to tackle the open-world problem in the presence of novel-class instances within unlabeled data. ", "page_idx": 1}, {"type": "image", "img_path": "rle9X7DQuH/tmp/9addc4955695ecba0d99c723be6f8d1d1dbeebafab334358e4b9298794187e86.jpg", "img_caption": ["Figure 2: Overview of the OwMatch framework. "], "img_footnote": [], "page_idx": 2}, {"type": "text", "text": "", "page_idx": 2}, {"type": "text", "text": "Open-set semi-supervised learning (OSSL). OSSL expands the traditional SSL boundaries by allowing novel-class instances or outliers within unlabeled data. A variety of OSSL approaches have emerged in recent years [46, 16, 35, 8, 23]. A common solution among these methods is the optimization of the SSL objective exclusively for unlabeled samples deemed inliers. For instance, MTC [46] optimizes the network and estimates the anomaly score of unlabeled data alternately. OpenMatch [35] and T2T [23] train one-vs-all (OVA) classifiers for each known class to detect outliers. Subsequently, standard SSL objective [36] are applied to the remaining training data, excluding detected outliers. Furthermore, DS3L [16] leverages a bi-level optimization technique to train a weighting function, which mitigates the passive impact of out-of-distribution (OOD) samples. Nonetheless, these approaches are designed for classifying seen classes, thereby failing to learn from the novel class instances. ", "page_idx": 2}, {"type": "text", "text": "Open-world semi-supervised learning (OwSSL). OwSSL [5] has been proposed to address a practical challenge: enabling the model to effectively cluster novel-class instances while maintaining classification robustness on seen classes. One predominant research direction in this under-explored domain is BCE-based methods, including ORCA [5] and NACH [15]. Additionally, there exist methods to discover novel classes by employing various other clustering techniques: OpenLDN [33] employs bi-level optimization to train a pairwise similarity prediction network, which provides a supervisory signal to the similarity of all pairs; TRSSL [34] converts clustering into the self-labeling problem and applies Sinkhorn-Knopp algorithm to optimize self-label assignments. One subsequently proposed Generalized Category Discovery (GCD) setting is similar to the OwSSL [40, 49], with detailed discussion is provided in Section 5.3. ", "page_idx": 2}, {"type": "text", "text": "3 Methodology ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "Problem setup. Given training data consisting of labeled data $\\mathcal{D}_{l}=\\{(\\mathbf{x}^{(i)},\\mathbf{y}_{\\mathrm{gt}}^{(i)})\\}_{i=1}^{N^{l}}$ and unlabeled data Du = {x(i)}Nl+lNu, where $N=N^{l}+N^{u}$ and $N^{u}\\gg N^{l}$ . Here $\\mathbf{x}^{(i)}\\in\\mathbb{R}^{d}$ is the $i$ -th instance wWiet hd oenneo-the otth ev escetto ro $\\mathbf{y}_{\\mathrm{gt}}^{(i)}\\in\\{0,1\\}^{K}$ aas hae ncdo rtrhees pseotn odfi ncgl alsasbeesl  i, n rea $K$ .s  tPhree vniuomusb terra odfi tailol ncalla sSsSesL. $\\mathcal{D}_{l}$ $\\mathcal{C}_{l}$ $\\mathcal{D}_{u}$ $\\mathcal{C}_{u}$   \nstudies assume $\\mathcal{C}_{l}=\\mathcal{C}_{u}$ . Here for OwSSL, we assume $\\mathcal{C}_{l}\\neq\\mathcal{C}_{u}$ and $\\mathcal{C}_{u}\\setminus\\mathcal{C}_{l}\\ne\\emptyset$ . Denote $\\mathcal{C}_{s}=\\mathcal{C}_{l}\\cap\\mathcal{C}_{u}$ as a set of seen classes, $\\mathcal{C}_{n}\\,=\\,\\mathcal{C}_{u}\\,\\backslash\\,\\mathcal{C}_{l}$ as a set of novel classes, and ${\\mathcal{C}}\\,=\\,{\\mathcal{C}}_{l}\\cup{\\mathcal{C}}_{u}$ as a set of all considered classes. The desired OwSSL model is required to assign instances to either a previously seen class $c\\in\\mathcal{C}_{s}$ , or a novel class $c\\in{\\mathcal{C}}_{n}$ . ", "page_idx": 2}, {"type": "text", "text": "For labeled dataset $\\mathcal{D}_{l}$ , standard supervised objective is employed as shown in Equation 9. Additionally, OwMatch primarily incorporates two objectives: a) clustering objective, which leverages conditional self-labeling to refine the self-label assignment with the assistance of supervision; b) confidence objective, which applies consistency loss with open-world hierarchical thresholding strategy to enhance predictive confidence and balance the different learning difficulties across all classes. We will elaborate on them respectively in Section 3.1 and 3.2. ", "page_idx": 2}, {"type": "text", "text": "3.1 Conditional self-labeling ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "To effectively cluster the novel class instances, the self-labeling scheme [1] has been considered in OwSSL. Formally, consider a deep neural network (encoder) $f_{\\theta}$ mapping input data $\\mathbf{x}$ to representation $\\mathbf{z}\\in\\mathbb{R}^{D}$ , the representation is followed by a classification head $h:\\overline{{\\mathbb{R}}}^{D}\\stackrel{=}{\\rightarrow}\\overline{{\\mathbb{R}}}^{K}$ , usually consisting of a single linear layer, converting the feature vectors into a vector of class scores. Denote $g_{\\theta}=\\sigma\\circ h\\circ f_{\\theta}$ as a probability function, where $\\sigma$ refers to the SoftMax function. Moreover, denote $\\mathbf{q}^{(i)}\\in\\mathbb{R}^{K}$ as the soft self-label for $\\mathbf{x}^{(i)}$ , and set $\\mathbf{Q}=[\\mathbf{q}^{(1)},\\mathbf{q}^{(2)},\\ldots,\\mathbf{q}^{(N)}]\\in\\mathbb{R}^{K\\times N}$ as the self-label assignment for $\\{\\mathbf{x}^{(i)}\\}_{i=1}^{N}$ . Asano et al. [1] utilize a constraint of desired partition of $\\mathbf{Q}$ to construct the transportation polytope: ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\mathcal{Q}_{1}:=\\{\\mathbf{Q}\\in\\mathbb{R}_{+}^{K\\times N}|\\mathbf{Q1}_{N}=N\\mathbf{\\mathcal{P}},\\mathbf{Q}^{T}\\mathbf{1}_{K}=\\mathbf{1}_{N}\\},\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "where ${\\bf1}_{v}$ is the $v$ -dimensional vector of all ones, $\\mathcal{P}$ denotes the desired class distribution. On the other hand, we can obtain a probability output through $\\mathbf{p}^{(i)}\\,=\\,g_{\\theta}\\bigl(\\alpha\\bigl(\\mathbf{x}^{(i)}\\bigr)\\bigr)$ , where $\\alpha(\\cdot)$ refers to a specific weak augmentation, and denote $\\mathbf{P}=[\\mathbf{p}^{(1)},\\mathbf{p}^{(2)},\\ldots,\\mathbf{p}^{(N)}]$ as the matrix of probability outputs. This self-label assignment generation can be understood as solving an optimal transport problem [1]. It minimizes the cross-entropy loss and aligns the training data with the desired class distribution: ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\operatorname*{min}_{\\mathbf{Q}\\in\\mathcal{Q}_{1}}\\mathrm{Tr}(\\mathbf{Q}\\log(\\mathbf{P}^{T})),\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "where $\\operatorname{Tr}(\\cdot)$ is the trace of a given matrix. Obviously, clustering through self-labeling primarily relies on the quality of generated self-label assignments. However, optimizing self-label assignments through unsupervised self-labeling is unreliable owing to the lack of supervision. TRSSL [34] utilizes the above-unsupervised technique to optimize self-label assignment merely on unlabeled data with the uniform class distribution. Despite prominent results, this unconditional self-labeling process [34] has a notable flaw: it constructs transportation polytope based on an inaccurate class distribution. ", "page_idx": 3}, {"type": "text", "text": "Moreover, we consider conducting self-labeling across all training data and constructing a transportation polytope with a precise class distribution. To mitigate the confirmation bias, we propose a conditional self-labeling method to refine the self-label assignment under partial supervision. Specifically, we exploit the ground-truth labels from the labeled dataset and introduce another constraint $\\mathcal{Q}_{2}$ : ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\mathcal{Q}_{2}:=\\{\\mathbf{Q}\\in\\mathbb{R}_{+}^{K\\times N}|\\mathbf{q}^{(i)}=\\mathbf{y}_{\\mathrm{gt}}^{(i)},i=1,\\dots,N^{l}\\}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "Now, the conditional self-label assignment generation with the above two constraints can be formulated as: ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\operatorname*{min}_{\\mathbf{Q}\\in\\mathcal{Q}_{1}\\cap\\mathcal{Q}_{2}}\\mathrm{Tr}(\\mathbf{Q}\\log(\\mathbf{P}^{T}))+\\epsilon E(\\mathbf{Q}),\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "where $E(\\cdot)$ is the entropy function, $\\epsilon$ is a hyper-parameter controlling the smoothness of $\\mathbf{Q}$ . We adopt fast version [10] of Sinkhorn-Knopp algorithm to optimize Equation 4 efficiently and denote the optimal solution as $\\tilde{\\mathbf{Q}}=[\\tilde{\\mathbf{q}}^{(1)},\\tilde{\\mathbf{q}}^{(2)},\\tilde{\\mathbf{\\Omega}}...\\mathbf{\\Omega},\\tilde{\\mathbf{q}}^{(N)}]$ . Empirically, conditional self-labeling significantly alleviates the confirmation bias, resulting in self-label assignments that are much closer to the expected distribution, as shown in Figure 1a. Further theoretical analysis regarding estimators from unconditional and conditional self-labeling is provided in Section 4. Then, the clustering objective has the form of: $\\begin{array}{r}{\\mathcal{L}_{c l s}=\\frac{1}{N}\\sum_{i=1}^{N}H(\\tilde{\\mathbf{q}}^{(i)},\\bar{\\mathbf{p}}^{(i)})}\\end{array}$ . ", "page_idx": 3}, {"type": "text", "text": "3.2 Open-world hierarchical thresholding ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "Beyond the clustering objective, prompting the predictive confidence has proven effective for classification. A similar goal arises in traditional SSL, wherein entropy minimization is employed to encourage low entropy (i.e., high confidence) in the prediction. FixMatch [36] leverages both consistency and pseudo-labeling to achieve exceptional performance with the following regularization: $\\begin{array}{r}{\\sum_{i=1}^{N}\\mathbb{I}(\\operatorname*{max}(\\mathbf{p}^{(i)})\\ge\\tau)H(\\hat{\\mathbf{p}}^{(i)},g_{\\boldsymbol{\\theta}}(\\mathcal{A}(\\mathbf{x}^{(i)})))}\\end{array}$ , where $\\hat{\\mathbf{p}}^{(i)}:=\\arg\\operatorname*{max}(\\mathbf{p}^{(i)})$ is predictive one-hot pseudo-label, with the $\\hat{p}^{(i)}$ -th element set to 1. $\\alpha$ and $\\boldsymbol{\\mathcal{A}}$ represent weak and strong augmentation respectively. Here, $\\tau$ is a scalar hyperparameter denoting the threshold above which we retain a pseudo-label. The effectiveness of the aforementioned regularization depends on accurate and sufficient pseudo-labels, which are directly influenced by the thresholding scheme. Under the close-word assumption, extensive efforts [47, 45, 42] have been devoted to devising thresholding techniques based on the idea of balancing learning pace across classes with varying learning difficulties. However, these techniques do not fti with the open-world scenario due to a critical challenge: the learning pace of novel classes tends to be much slower [5]. The predictive confidence of these two groups does not share the same behavior, as shown in Figure 1b. ", "page_idx": 3}, {"type": "text", "text": "", "page_idx": 4}, {"type": "text", "text": "We introduce an open-world hierarchical thresholding scheme to balance this inconsistent learning pace at the group level, leveraging these well-defined thresholds to retain high-quality and adequate pseudo-labels for learning. As shown in Figure 3, this scheme first estimates the learning conditions of the two groups and then hierarchically modulates the thresholds in a class-specific fashion within each group. ", "page_idx": 4}, {"type": "text", "text": "First, we split the dataset into seen $(\\mathcal{C}_{s})$ and novel $\\left(\\mathcal{C}_{n}\\right)$ groups based on the pseudo-label and estimate their overall learning condition by predictive confidence. Motivated by FreeMatch [42], we define the group-wise learning status for a set of classes $\\mathcal{C}_{i}=\\mathcal{C}_{s}$ or $\\mathcal{C}_{n}$ as ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\eta(\\mathcal{C}_{i})=\\frac{1}{N_{\\mathscr{C}_{i}}}\\sum_{i=1}^{N}\\mathrm{max}(\\mathbf{p}^{(i)})\\mathbb{I}(\\hat{p}^{(i)}\\in\\mathscr{C}_{i}),\\;\\mathscr{C}_{i}=\\mathscr{C}_{s}\\;\\mathrm{or}\\,\\mathscr{C}_{n},\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "where $\\begin{array}{r}{N_{\\mathcal{C}_{i}}\\,=\\,\\sum_{i=1}^{N}\\mathbb{I}(\\hat{p}^{(i)}\\in\\mathcal{C}_{i})}\\end{array}$ denotes the number of samples whose predictive pseudo-labels belong to the g roup $\\mathcal{C}_{i}$ . Similarly, the class-wise learning conditions can be defined as ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\zeta_{c}=\\frac{1}{N_{c}}\\sum_{i=1}^{N}\\operatorname*{max}(\\mathbf{p}^{(i)})\\mathbb{I}(\\hat{p}^{(i)}=c),\\:c=1,\\ldots,K,\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "where $\\begin{array}{r}{N_{c}=\\sum_{i=1}^{N}\\mathbb{I}(\\hat{p}^{(i)}=c)}\\end{array}$ denotes the number of samples whose predicted labels belong to the $c$ -th class. In  practice, we utilize the exponential moving average (EMA) to update at each iteration. Then, we merge these two learning statuses and obtain the open-world hierarchical threshold as ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\tau(c)=\\frac{\\zeta_{c}}{\\operatorname*{max}_{c\\in{\\mathcal{C}}_{i}}\\zeta_{c}}\\cdot\\eta(\\mathcal{C}_{i}),\\,c=1,\\ldots,K,\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "where the $c$ -th class belongs to the set $\\mathcal{C}_{i}$ (i.e., $c\\in\\mathcal{C}_{s}$ or $\\mathcal{C}_{u}$ ). The learning condition $\\eta$ distinguishes between seen and novel classes, while the class-wise condition $\\zeta$ adjusts for class-wise differences. Ultimately, the confidence objective is: ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\mathcal{L}_{c o n f}=\\frac{1}{N}\\sum_{i=1}^{N}[(\\operatorname*{max}(\\mathbf{p}^{(i)})>\\tau(\\hat{p}^{(i)}))\\cdot H(\\hat{\\mathbf{p}}^{(i)},g_{\\theta}(\\mathcal{A}(\\mathbf{x}^{(i)}))).\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "Together with the supervised objective $\\begin{array}{r}{\\mathcal{L}_{s u p}\\,=\\,\\frac{1}{N^{l}}\\sum_{i=1}^{N^{l}}H(\\mathbf{y}_{g t}^{(i)},\\mathbf{p}^{(i)})}\\end{array}$ , the overall objective for OwMatch is ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\mathcal{L}=\\mathcal{L}_{s u p}+\\mathcal{L}_{c l s}+\\mathcal{L}_{c o n f}.\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "4 Theoretical analysis of conditional self-labeling ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "To illustrate the superiority of conditional self-labeling over unconditional, we evaluate their estimators of the class distribution on unlabeled data through rigorous statistical analysis. This transformation is justified as both self-labeling methods produce corresponding self-label assignments, each representing their estimation of the class distribution on unlabeled data. ", "page_idx": 4}, {"type": "text", "text": "Formulation. Assuming that the class distribution of real-world data conforms to prior information $\\pmb{\\mathcal{P}}=[p_{1},p_{2},\\cdot\\cdot\\cdot\\,,p_{K}]$ . Suppose real-world data is composed of recognized labeled data and unrecognized unlabeled data, conforming to unknown class distribution $\\pmb{\\mathcal{P}}^{l}=[p_{1}^{l},p_{2}^{l},\\cdot\\cdot\\cdot\\;,p_{K}^{l}]$ and $\\mathbfcal{P}^{u}\\,=\\,[p_{1}^{u},p_{2}^{u},\\cdot\\cdot\\cdot\\,,p_{K}^{u}]$ respectively. We independently sample $N\\,=\\,N^{l}\\,+\\,N^{u}$ instances from recognized and unrecognized data, respectively. Suppose $N_{i}=N_{i}^{l}+N_{i}^{u}$ is composed of two random variables that denote the number of recognized and unrecognized samples belonging to the $i$ -th class. Obviously, we have $\\begin{array}{r}{N^{l}=\\sum_{i=1}^{K}N_{i}^{l}}\\end{array}$ and $\\begin{array}{r}{N^{u}=\\sum_{i=1}^{K}N_{i}^{u}}\\end{array}$ . ", "page_idx": 4}, {"type": "text", "text": "Objective. We hope to estimate the unknown class distribution $\\mathcal{P}^{u}$ with $\\hat{\\pmb{\\mu}}$ based on prior information $\\mathcal{P}$ and observations of $N_{1}^{l},N_{2}^{l},\\cdots\\,,N_{K}^{l}$ , then evaluate $\\hat{\\pmb{\\mu}}$ from unbiasness and ECS. Evaluation on both metrics requires estimating the number of samples in each class, denoted by $\\mathbf{A}=\\left(A_{1},A_{2},\\ldots,A_{K}\\right)$ . Two self-labeling approaches (unconditional and conditional) can optimize self-label assignment, therefore obtaining two approximations of $\\mathbf{A}$ , denoted by $\\mathbf{A}_{\\mathrm{uncon}}$ and $\\mathbf{A}_{\\mathrm{con}}$ . Denote the corresponding estimators as $\\hat{\\pmb{\\mu}}_{\\mathrm{uncon}}$ and $\\hat{\\pmb{\\mu}}_{\\mathrm{con}}$ . ", "page_idx": 4}, {"type": "text", "text": "", "page_idx": 5}, {"type": "text", "text": "Assumption 4.1. Assume that all drawn samples with a static number of samples and class distribution follow the multinomial distribution as follows, ", "page_idx": 5}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{N_{1},N_{2},\\cdot\\cdot\\cdot\\,,N_{K}\\ \\sim\\mathrm{Multinomial}(N,\\mathcal{P})}\\\\ &{N_{1}^{l},N_{2}^{l},\\cdot\\cdot\\cdot\\,,N_{K}^{l}\\ \\sim\\mathrm{Multinomial}(N^{l},\\mathcal{P}^{l})}\\\\ &{N_{1}^{u},N_{2}^{u},\\cdot\\cdot\\cdot\\,,N_{K}^{u}\\sim\\mathrm{Multinomial}(N^{u},\\mathcal{P}^{u}).}\\end{array}\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "Given the independency between $N_{i}^{l}$ and $N_{j}^{u}$ . We basically have: ", "page_idx": 5}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{E}[N_{i}]=\\mathbb{E}[N_{i}^{l}]+\\mathbb{E}[N_{i}^{u}]\\quad\\forall i,j}\\\\ &{N p_{i}=N^{l}p_{i}^{l}+N^{u}p_{i}^{u}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "Lemma 4.2. Suppose we want to test the null hypothesis $(H_{0})$ that categorical data $N_{1},N_{2},\\cdots\\,,N_{\\cal C}$ come from a multinomial distribution with $K$ classes and class probability of $\\mathcal{P}$ . A chi-square statistic can be constructed to test the deviation between the observations $n_{1},\\cdot\\cdot\\cdot,n_{K}$ and expected outcomes for each class. ", "page_idx": 5}, {"type": "equation", "text": "$$\n\\chi^{2}=\\sum_{i=1}^{K}\\frac{(n_{i}-\\mathbb{E}_{\\mathcal{P}}[N_{i}]^{2})}{\\mathbb{E}_{\\mathcal{P}}[N_{i}]}\\sim\\chi_{K-1}^{2},\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "where $\\mathbb{E}_{\\mathcal{P}}[\\cdot]$ denotes the population expectation of random variable. A lower chi-square value suggests that the observed data are consistent with $H_{0}$ . Conversely, an exceedingly high chi-square value implies that either $H_{0}$ is incorrect or an event of low probability has happened. ", "page_idx": 5}, {"type": "text", "text": "Details of the above lemma are presented in Appendix E. Then, we define the following metric to evaluate the goodness of fit of estimation based on chi-square statistics. ", "page_idx": 5}, {"type": "text", "text": "Definition 4.3 (Expectation of chi-square statistics (ECS)). The expectation of chi-square statistics (ECS) for $\\hat{\\pmb{\\mu}}$ are defined as the population deviation between the estimator of unlabeled class distribution $\\hat{\\pmb{\\mu}}$ and its true distribution $\\mathcal{P}^{u}$ : ", "page_idx": 5}, {"type": "equation", "text": "$$\n\\mathrm{ECS}(\\hat{\\pmb{\\mu}}):=\\mathbb{E}[\\chi^{2}(\\mathbf{A})]=\\mathbb{E}\\left[\\sum_{i=1}^{K}\\frac{(A_{i}-\\mathbb{E}_{\\mathcal{P}}[N_{i}^{u}])^{2}}{\\mathbb{E}_{\\mathcal{P}}[N_{i}^{u}]}\\right],\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "where $\\mathbf{A}$ are estimators based on $N_{1}^{l},N_{2}^{l},\\cdots\\,,N_{K}^{l}$ , thus are still random variables. ", "page_idx": 5}, {"type": "text", "text": "Now, we introduce two main theorems and demonstrate the superiority of our conditional selflabeling. ", "page_idx": 5}, {"type": "text", "text": "Theorem 4.4. Consider two estimators for class distribution on unlabeled data, $\\mu_{\\mathrm{uncon}}\\:a n d\\:\\mu_{\\mathrm{con}}.$ , we have $\\pmb{\\mu}_{\\mathrm{uncon}}$ is a biased estimator and $\\pmb{\\mu}_{\\mathrm{con}}$ is an unbiased estimator. ", "page_idx": 5}, {"type": "text", "text": "Theorem 4.5. Suppose ri := NN\u00b7pi denote the ratio of label samples of the $i$ -th class to the whole samples, $\\boldsymbol{r}:=\\sum_{i}\\boldsymbol{r}_{i}$ denotes the ratio of labeled samples to the whole samples. For unlabeled sample size $N^{u}$ , $\\begin{array}{r}{i f\\sqrt{N^{u}}>\\frac{1}{\\operatorname*{max}(|r_{i}-r\\cdot p_{i}^{u}|,r\\cdot p_{j})}}\\end{array}$ for $\\forall i\\in\\mathcal{C}_{l},\\forall j\\in\\mathcal{C}_{u},$ then $\\mathrm{ECS}(\\hat{\\pmb{\\mu}}_{\\mathrm{con}})\\leq\\mathrm{ECS}(\\hat{\\pmb{\\mu}}_{\\mathrm{uncon}})$ . ", "page_idx": 5}, {"type": "text", "text": "Following rigorous statistical analysis, the generated self-label assignments from the conditional labeling method are closer to the true class distribution in the following scenarios: ", "page_idx": 5}, {"type": "text", "text": "\u2022 Estimation based on large unlabeled sample size $(N^{u})$ ;   \n\u2022 The difference between prior distribution $\\mathcal{P}$ and class distribution of unlabeled data $\\mathcal{P}^{u}$ is not negligible. ", "page_idx": 5}, {"type": "text", "text": "5 Experiments ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "This section presents a comprehensive evaluation of our approach. It includes experimental results and in-depth analysis, demonstrating the effectiveness of our approach. ", "page_idx": 5}, {"type": "table", "img_path": "rle9X7DQuH/tmp/f36589262828ad2d6f835b738f92d7f2c36fef3dbbcc594918b54a6e5d917b34.jpg", "table_caption": ["Table 1: Average accuracy on the CIFAR-10/100 and ImageNet-100 with both novel class ratio and label ratio of $50\\%$ . We compare OwMatch with existing literature on OwSSL. Also compared with other related approaches of traditional SSL, OSSL, and NCD approaches following [5]. Proper modifications are made to make these approaches compatible with OwSSL; the details are in Appendix C. The results are averaged over three independent runs. The baseline figures are sourced from the respective papers. "], "table_footnote": [], "page_idx": 6}, {"type": "text", "text": "5.1 Experimental setup ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "Datasets. We evaluate our approach on CIFAR-10/100 [25], ImageNet-100 [11] and Tiny ImageNet [28]. A detailed description of these datasets is provided in Appendix A. Specifically, ImageNet-100 dataset contains 100 classes sub-sampled from ImageNet-1k following [39]. On all datasets, we first split all classes into seen and novel classes with a novel class ratio. Subsequent experiments will adopt a novel class ratio of $50\\%$ unless otherwise specified. Then, we will randomly assign labels to a portion of the data from the seen classes according to the specified label ratio, while the remaining data, along with all samples from the novel classes, are assigned to the unlabeled set. ", "page_idx": 6}, {"type": "text", "text": "Implementation details. For a fair comparison, we apply ResNet-50 [22] as the backbone model for ImageNet-100 and RseNet-18 for other benchmarks. We train the model with a batch size of 256 for Tiny ImageNet and 512 for other benchmarks. Following [15], experiments across all benchmarks are implemented based on the pre-trained model from SimCLR [7]. We jointly optimize backbone and prototype parameters using the standard Stochastic Gradient Descent (SGD) with momentum. We apply the cosine annealing learning rate schedule for all experiments. Techniques including multi-crop and queue structure [6] are employed to enhance the clustering objective. Additionally, RandAugment [9] serves as the strong augmentation for confidence objective. Additional implementation details are available in the Appendix B. ", "page_idx": 6}, {"type": "text", "text": "Evaluation metric. In assessing the efficacy of OwMatch, we adopt a multifaceted approach to evaluate accuracy following [5]. Evaluation metrics include the standard accuracy for seen classes and the clustering accuracy for novel classes and all classes. Here, we leverage the Hungarian algorithm [26] to align the predicted class assignment for novel-class instances with their ground-truth labels to obtain clustering accuracy. We also report the joint clustering accuracy across all classes using the Hungarian algorithm. ", "page_idx": 6}, {"type": "text", "text": "5.2 Main results ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "We consider and evaluate two versions of our method, called OwMatch and OwMatch+. OwMatch represents the standard version as illustrated in Figure 2, while OwMatch $^+$ incorporates the multicrop technique for additional augmentation. Detailed distinctions between the two versions are provided in the Appendix B. We evaluate our method on all benchmarks using a label ratio of $10\\%$ and $50\\%$ with the comprehensive experiment results provided in Table 1, 12, and 13. Results in Table 1 show that OwSSL approaches significantly outperform current state-of-the-art methods in traditional SSL, OSSL, and NCD by a considerable margin. On the other hand, OwMatch achieves state-of-the-art across all benchmarks and evaluation metrics. It can not only classify novel classes accurately but also maintain robust performance on seen classes. On CIFAR-10, we observed OwMatch outperforms OpenLDN on novel and all classes by $2.0\\%$ and $1.4\\%$ , respectively. It is noteworthy that the enhancement brought about by OwMatch is more pronounced on the CIFAR-100 dataset, which presents a greater challenge due to the increasing number of classes. Regarding CIFAR-100, our method surpasses TRSSL by approximately $14.6\\%$ on novel classes and $7.2\\%$ on all classes. Subsequently, we extend to evaluate ImageNet-100 and observe a similar trend, with OwMatch $^+$ showing significant improvement of $1.7\\%$ on all-class accuracy compared to previous state-of-the-art approaches. ", "page_idx": 6}, {"type": "text", "text": "", "page_idx": 7}, {"type": "text", "text": "Principle analysis of conditional self-labeling. OwMatch primarily relies on high-quality selflabel assignment to alleviate the model\u2019s confirmation bias. To clearly illuminate this progress during training, we employ the Manhattan distance $\\textstyle\\sum_{i\\in K}|c_{i}-c_{i}^{g t}|$ as a metric to evaluate the bias between the considered class distribution $\\{c_{i}\\}_{i=1}^{K}$ a nd the ground truth $\\{c_{i}^{g t}\\}_{i=1}^{K}$ . Table 2 demonstrates the debiasing process: the model\u2019s confirmation bias is pronounced in the early epochs, whereas the bias of optimized self-label assignment is relatively minor. As training advances, the self-label assignment continues to guide the model, effectively mitigating the confirmation bias, as reflected in the decreasing $B_{m}$ and the absolute difference between $B_{m}$ and $B_{s}$ . ", "page_idx": 7}, {"type": "text", "text": "Table 2: The Manhattan distance (MD) is used to evaluate the confirmation bias. The first row presents the bias between the model\u2019s predictive class distribution and the ground truth, denoted as $B_{m}$ . The second row reflects the bias between the self-label assignment and the ground truth, denoted as $B_{s}$ . The third row computes the absolute difference between $B_{m}$ and $B_{s}$ , highlighting the debiasing effect of high-quality self-label assignments. ", "page_idx": 7}, {"type": "table", "img_path": "rle9X7DQuH/tmp/4ece1d47671e9621d0e3cbb1d46c8abb2c8733a701fdfdc70b149093b0725804.jpg", "table_caption": [], "table_footnote": [], "page_idx": 7}, {"type": "text", "text": "5.3 Ablations, analysis, and real-scenario applications ", "text_level": 1, "page_idx": 7}, {"type": "text", "text": "To investigate the impact of each component, we embark on comprehensive ablation studies with both novel class ratio and label ratio of $50\\%$ . The first row in Table 3 showcases the foundational model performance, whose objective consists of only unconditional clustering objective and supervised objective, already achieving impressive performance. We then analyze the effect of integrating a conditional self-labeling framework on CIFAR-100, which boosts novel-class accuracy by $1.0\\%$ on average. Additionally, the positive impact of consistency regularization is observed: roughly $0.9\\%$ enhancement across all evaluation metrics. Our ablation studies highlight the essential contribution of each component in OwMatch. Individually, each plays a significant part in the intended functionality, and together, these elements coalesce into a cohesive and robust framework. We also ablate other factors, including the number of local views for clustering objectives and iterations for the SinkhornKnopp algorithm, with detailed statements provided in Table 15 and 16. ", "page_idx": 7}, {"type": "table", "img_path": "rle9X7DQuH/tmp/bbb3ecc200d2d63cf6b4d04dbd7e00d2a8384f72737dee360403da3326edae5f.jpg", "table_caption": ["Table 3: Ablation studies on each component with both novel class ratio and label ratio of $50\\%$ . Here, ConSL refers to conditional self-labeling, PLCR refers to pseudo-label consistency regularization, and OwHT refers to an open-world hierarchical thresholding scheme. "], "table_footnote": [], "page_idx": 7}, {"type": "text", "text": "Comparison study on varying thresholding strategies. We compare our proposed open-world hierarchical thresholding approach with two prominent techniques: static thresholding [36] and self-adaptive thresholding [42]. As illustrated in Table 4, our proposal achieves superior performance in both novel- and all-class clustering accuracy across varying thresholding techniques. While selfadaptive has proven effective under closed-world scenarios, it encounters challenges in open-world settings. The pronounced disparity in overall learning conditions between seen and novel classes, as illustrated in Figure 1b, can lead to unstable global thresholds. The class-wise adaptive approach based on that may exaggerate this issue, resulting in suboptimal performance. We implement a hierarchical structure to mitigate the instability sourcing from distinct learning dynamics of seen and novel classes. ", "page_idx": 7}, {"type": "text", "text": "", "page_idx": 8}, {"type": "table", "img_path": "rle9X7DQuH/tmp/3086260a8c9acb7c27c078cd91496947508d954c2d477006ab158565605c3367.jpg", "table_caption": [], "table_footnote": [], "page_idx": 8}, {"type": "table", "img_path": "rle9X7DQuH/tmp/164b5db68c95f48521ab946b16a11e59410d106c0b67a420a9774f1772b83739.jpg", "table_caption": ["Table 4: Performance comparison of static, self-Table 5: Comparison with GCD-related works: adaptive, and our OwHT thresholding techniques average accuracy on the ImageNet-100 with both on CIFAR-100 with both novel class ratio and novel class ratio and label ratio of $50\\%$ . label ratio of $50\\%$ "], "table_footnote": [], "page_idx": 8}, {"type": "text", "text": "On the comparison between OwSSL and Generalized Category Discovery. The OwSSL setting resembles the subsequently proposed Generalized Category Discovery (GCD) setting [40], with both assuming the existence of novel classes and that a portion of the data is labeled for seen classes. However, there are notable differences between these two groups of methods: 1) GCD-related methods leverage supervised contrastive learning [24] on labeled data and self-supervised contrastive learning [7] on all training data, whereas OwSSL typically employs pairwise similarity-based methods for clustering samples; 2) GCD-related works typically employ a pre-trained ViT-Base/16 backbone, which has significantly more parameters than the ResNet-18 or ResNet-50 models commonly used in OwSSL methods. ", "page_idx": 8}, {"type": "text", "text": "It is unfair to compare these two types of methods directly. Here, we still include a comparison with those GCD-related works to demonstrate the effectiveness of our method. Table 5 shows that our method outperforms existing approaches in novel-class and all-class accuracy on ImageNet-100 despite using a simpler model. ", "page_idx": 8}, {"type": "text", "text": "Ablation study on supervision components in the overall objective. The overall objective of OwMatch consists of a standard supervised objective, clustering objective, and confidence objective. Both the supervised and clustering objectives involve the use of labeled data, raising concerns about overlap in functionality. To investigate the significance of each component, we conduct an ablation study in which we modify the overall objective in two ways: 1) removing the supervised objective and 2) excluding labeled data from the online clustering process. The results are reported in Table 6. ", "page_idx": 8}, {"type": "text", "text": "In the first case, we observe a decrease in seen-class accuracy while maintaining novel-class clustering performance, while the latter case exhibits the opposite tendency: seen-class accuracy remains high, but novel-class clustering accuracy declines. In comparison to the previous cases, our overall objective integrates both components to strike a balance between clustering and confidence. The supervised objective enhances seen-class accuracy through one-hot supervision, while the clustering objective with conditional self-labeling improves novel-class clustering accuracy by incorporating labeled data. This harmonious approach yields the best all-class accuracy while roughly maintaining both seenand novel-class performance. ", "page_idx": 8}, {"type": "table", "img_path": "rle9X7DQuH/tmp/ab186b4485bf5440ecc34b70ca856408796085907cac066cd55dc813befc8e0c.jpg", "table_caption": ["Table 6: Model performance under varying appli-Table 7: Estimation of the number of classes cations of supervision in the overall objective. across benchmarks. "], "table_footnote": [], "page_idx": 8}, {"type": "text", "text": "The above evaluations are typically conducted under relatively ideal conditions: the datasets are class-balanced, and both the prior class distribution and the number of novel classes are available. ", "page_idx": 8}, {"type": "text", "text": "However, in real-world scenarios, it is crucial to address the dependency on these assumptions. We will elaborate on each of these aspects to demonstrate the practical effectiveness of OwMatch. ", "page_idx": 9}, {"type": "text", "text": "Estimating the number of novel classes. OwMatch and other baselines typically assume that the number of novel classes is pre-determined for clarity in evaluation. However, this prior knowledge is often unavailable in practice, necessitating a precise estimation of the number of novel classes in advance. We primarily follow the approaches of GCD [40] and TRSSL [34] to estimate the number of classes. Specifically, $K$ -means clustering is performed on representations of the entire dataset from the pre-trained ViT-B/16 backbone. The optimal value of $k$ is determined by evaluating the clustering accuracy on the labeled samples calculated by the Hungarian algorithm. This accuracy serves as a scoring function, optimized using Brent\u2019s algorithm to find the that maximizes performance on the labeled data. The estimation results across generic benchmarks are shown in Table 7, which illustrates that the estimated class numbers come close to the ground truth. We also evaluate OwMatch\u2019s sensitivity to varying extents of class number estimation error, with results reported in Appendix D. ", "page_idx": 9}, {"type": "table", "img_path": "rle9X7DQuH/tmp/06752719532bb21ada7f6aa97265a98c5115ae215845a4dcf3380d8891ac8867.jpg", "table_caption": ["Table 8: Performance on generic recognition benchmarks with varying imbalance factors (IF), with and without prior class distribution. These benchmarks come with both novel class ratio and label ratio of $50\\%$ . "], "table_footnote": [], "page_idx": 9}, {"type": "text", "text": "Data imbalance. Most generic benchmarks feature class-balanced, whereas real-world data tend to exhibit long-tailed class distribution. Our approach accommodate to arbitrary class distribution by constraining the optimized self-label assignment to comply with the prior class distribution, thereby naturally mitigating performance degradation caused by data imbalance. We evaluate our approach on imbalanced benchmarks, constructed with varying imbalance factors following TRSSL [34]. Results in Table 8 demonstrate that OwMatch effectively addresses the challenge of data imbalance. ", "page_idx": 9}, {"type": "text", "text": "Training without prior. In scenarios where prior class distribution is unavailable, we propose an adaptive estimation scheme to make OwMatch still function without relying on any prior assumptions. Specifically, we initially adopt class-balanced prior if no prior information is available; then, the class distribution for conditional self-labeling is estimated and continuously updated based on model prediction. Next, standard training with estimated class distribution and distribution estimation are alternately conducted, with results reported in Table 8. We observe that the reduction in all-class accuracy achieved through the adaptive estimation scheme remains within $3\\%$ across almost all benchmarks and imbalance factors. These results reveal that the straightforward estimation technique performs robustly in the absence of prior knowledge. ", "page_idx": 9}, {"type": "text", "text": "6 Conclusion ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "This work integrates techniques from self-SL and SSL, refining them to present a new perspective on solving open-world SSL. We demonstrate that conditional self-labeling can achieve an unbiased estimation of the class distribution on unlabeled data with prior information, leading to high-quality self-label assignment with reduced confirmation bias. Our future endeavors will be directed toward developing solutions that are more aligned with realistic scenarios where such prior information might not be readily available or hard to be estimated. This will involve exploring methodologies that can effectively handle uncertainty and variability inherent in real-world data distributions. ", "page_idx": 9}, {"type": "text", "text": "Acknowledgements ", "text_level": 1, "page_idx": 10}, {"type": "text", "text": "Chao Wang would like to acknowledge the support from the National Natural Science Foundation of China under Grant 12201286, the Shenzhen Science and Technology Program 20231115165836001, Guangdong Basic and Applied Research Foundation 2024A1515012347. This research was conducted using the computing resources provided by the Research Center for the Mathematical Foundations of Generative AI in the Department of Applied Mathematics at The Hong Kong Polytechnic University. ", "page_idx": 10}, {"type": "text", "text": "References ", "text_level": 1, "page_idx": 10}, {"type": "text", "text": "[1] Yuki M. Asano, Christian Rupprecht, and Andrea Vedaldi. Self-labelling via simultaneous clustering and representation learning. In International Conference on Learning Representations (ICLR), 2020.   \n[2] Mahmoud Assran, Mathilde Caron, Ishan Misra, Piotr Bojanowski, Armand Joulin, Nicolas Ballas, and Michael Rabbat. Semi-supervised learning of visual features by non-parametrically predicting view assignments with support samples. In Proceedings of the IEEE/CVF International Conference on Computer Vision (CVPR), pages 8443\u20138452, 2021.   \n[3] David Berthelot, Nicholas Carlini, Ekin D. Cubuk, Alex Kurakin, Kihyuk Sohn, Han Zhang, and Colin Raffel. ReMixMatch: semi-supervised learning with distribution alignment and augmentation anchoring. In International Conference on Learning Representations (ICLR), 2020.   \n[4] David Berthelot, Nicholas Carlini, Ian Goodfellow, Nicolas Papernot, Avital Oliver, and Colin A Raffel. Mixmatch: A holistic approach to semi-supervised learning. Advances in Neural Information Processing Systems (NeurIPS), 32, 2019.   \n[5] Kaidi Cao, Maria Brbic, and Jure Leskovec. Open-world semi-supervised learning. arXiv preprint arXiv:2102.03526, 2021.   \n[6] Mathilde Caron, Ishan Misra, Julien Mairal, Priya Goyal, Piotr Bojanowski, and Armand Joulin. Unsupervised learning of visual features by contrasting cluster assignments. Advances in Neural Information Processing Systems (NeurIPS), 33:9912\u20139924, 2020.   \n[7] Ting Chen, Simon Kornblith, Mohammad Norouzi, and Geoffrey Hinton. A simple framework for contrastive learning of visual representations. In International Conference on Machine Learning (ICML, pages 1597\u20131607. PMLR, 2020.   \n[8] Yanbei Chen, Xiatian Zhu, Wei Li, and Shaogang Gong. Semi-supervised learning under class distribution mismatch. In Proceedings of the AAAI Conference on Artificial Intelligence, volume 34, pages 3569\u20133576, 2020.   \n[9] Ekin D Cubuk, Barret Zoph, Jonathon Shlens, and Quoc V Le. Randaugment: Practical automated data augmentation with a reduced search space. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR) Workshops, pages 702\u2013703, 2020.   \n[10] Marco Cuturi. Sinkhorn distances: Lightspeed computation of optimal transport. Advances in Neural Information Processing Systems (NeurIPS), 26, 2013.   \n[11] Jia Deng, Wei Dong, Richard Socher, Li-Jia Li, Kai Li, and Li Fei-Fei. Imagenet: A large-scale hierarchical image database. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR), pages 248\u2013255. Ieee, 2009.   \n[12] Enrico Fini, Enver Sangineto, St\u00e9phane Lathuiliere, Zhun Zhong, Moin Nabi, and Elisa Ricci. A unified objective for novel class discovery. In Proceedings of the IEEE/CVF International Conference on Computer Vision (CVPR, pages 9284\u20139292, 2021.   \n[13] Ian Goodfellow, Yoshua Bengio, and Aaron Courville. Deep learning. MIT press, 2016.   \n[14] Yves Grandvalet and Yoshua Bengio. Semi-supervised learning by entropy minimization. Advances in Neural Information Processing Systems (NeurIPS), 17, 2004.   \n[15] Lan-Zhe Guo, Yi-Ge Zhang, Zhi-Fan Wu, Jie-Jing Shao, and Yu-Feng Li. Robust SemiSupervised Learning when Not All Classes have Labels. In Advances in Neural Information Processing Systems, May 2022.   \n[16] Lan-Zhe Guo, Zhen-Yu Zhang, Yuan Jiang, Yu-Feng Li, and Zhi-Hua Zhou. Safe Deep SemiSupervised Learning for Unseen-Class Unlabeled Data. In Proceedings of the 37th International Conference on Machine Learning, pages 3897\u20133906. PMLR, November 2020.   \n[17] Kai Han, Sylvestre-Alvise Rebuff,i Sebastien Ehrhardt, Andrea Vedaldi, and Andrew Zisserman. Automatically discovering and learning new visual categories with ranking statistics. In International Conference on Learning Representations (ICLR), 2020.   \n[18] Kai Han, Andrea Vedaldi, and Andrew Zisserman. Learning to discover novel visual categories via deep transfer clustering. In Proceedings of the IEEE/CVF International Conference on Computer Vision (CVPR), pages 8401\u20138409, 2019.   \n[19] Tao Han, Junyu Gao, Yuan Yuan, and Qi Wang. Unsupervised semantic aggregation and deformable template matching for semi-supervised learning. Advances in Neural Information Processing Systems (NeurIPS), 33:9972\u20139982, 2020.   \n[20] Shaozhe Hao, Kai Han, and Kwan-Yee K Wong. Cipr: An efficient framework with crossinstance positive relations for generalized category discovery. arXiv preprint arXiv:2304.06928, 2023.   \n[21] Kaiming He, Georgia Gkioxari, Piotr Doll\u00e1r, and Ross Girshick. Mask r-cnn. In IEEE International Conference on Computer Vision (ICCV), pages 2980\u20132988, 2017.   \n[22] Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun. Deep residual learning for image recognition. In Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition (CVPR), pages 770\u2013778, 2016.   \n[23] Junkai Huang, Chaowei Fang, Weikai Chen, Zhenhua Chai, Xiaolin Wei, Pengxu Wei, Liang Lin, and Guanbin Li. Trash to treasure: Harvesting ood data with cross-modal matching for open-set semi-supervised learning. In Proceedings of the IEEE/CVF International Conference on Computer Vision (CVPR), pages 8310\u20138319, 2021.   \n[24] Prannay Khosla, Piotr Teterwak, Chen Wang, Aaron Sarna, Yonglong Tian, Phillip Isola, Aaron Maschinot, Ce Liu, and Dilip Krishnan. Supervised contrastive learning. Advances in neural information processing systems, 33:18661\u201318673, 2020.   \n[25] Alex Krizhevsky, Geoffrey Hinton, et al. Learning multiple layers of features from tiny images. 2009.   \n[26] Harold W Kuhn. The Hungarian method for the assignment problem. Naval research logistics quarterly, 2(1-2):83\u201397, 1955.   \n[27] P. Langley. Crafting papers on machine learning. In Proceedings of the 17th International Conference on Machine Learning (ICML), pages 1207\u20131216, 2000.   \n[28] Ya Le and Xuan Yang. Tiny imagenet visual recognition challenge. CS 231N, 7(7):3, 2015.   \n[29] Dong-Hyun Lee. Pseudo-label : The simple and efficient semi-supervised learning method for deep neural networks. ICML 2013 Workshop : Challenges in Representation Learning (WREPL), 07 2013.   \n[30] Takeru Miyato, Shin-ichi Maeda, Masanori Koyama, and Shin Ishii. Virtual adversarial training: a regularization method for supervised and semi-supervised learning. IEEE Transactions on Pattern Analysis and machine intelligence, 41(8):1979\u20131993, 2018.   \n[31] Adam Paszke, Sam Gross, Francisco Massa, Adam Lerer, James Bradbury, Gregory Chanan, Trevor Killeen, Zeming Lin, Natalia Gimelshein, Luca Antiga, et al. Pytorch: An imperative style, high-performance deep learning library. Advances in Neural Information Processing Systems (NeurIPS), 32, 2019.   \n[32] Sarah Rastegar, Hazel Doughty, and Cees Snoek. Learn to categorize or categorize to learn? self-coding for generalized category discovery. Advances in Neural Information Processing Systems, 36, 2024.   \n[33] Mamshad Nayeem Rizve, Navid Kardan, Salman Khan, Fahad Shahbaz Khan, and Mubarak Shah. OpenLDN: learning to discover novel classes for open-world semi-supervised learning. In European Conference on Computer Vision (ECCV), pages 382\u2013401. Springer, 2022.   \n[34] Mamshad Nayeem Rizve, Navid Kardan, and Mubarak Shah. Towards realistic semi-supervised learning. In European Conference on Computer Vision (ECCV), pages 437\u2013455. Springer, 2022.   \n[35] Kuniaki Saito, Donghyun Kim, and Kate Saenko. Openmatch: Open-set semi-supervised learning with open-set consistency regularization. Advances in Neural Information Processing Systems, 34:25956\u201325967, 2021.   \n[36] Kihyuk Sohn, David Berthelot, Nicholas Carlini, Zizhao Zhang, Han Zhang, Colin A Raffel, Ekin Dogus Cubuk, Alexey Kurakin, and Chun-Liang Li. FixMatch: simplifying semisupervised learning with consistency and confidence. Advances in Neural Information Processing Systems (NeurIPS), 33:596\u2013608, 2020.   \n[37] Xin Sun, Zhenning Yang, Chi Zhang, Keck-Voon Ling, and Guohao Peng. Conditional Gaussian distribution learning for open set recognition. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR), pages 13480\u201313489, 2020.   \n[38] Yiyou Sun and Yixuan Li. OpenCon: open-world contrastive learning. Transactions on Machine Learning Research, 2023.   \n[39] Wouter Van Gansbeke, Simon Vandenhende, Stamatios Georgoulis, Marc Proesmans, and Luc Van Gool. Scan: Learning to classify images without labels. In European Conference on Computer Vision (ECCV), pages 268\u2013285. Springer, 2020.   \n[40] Sagar Vaze, Kai Han, Andrea Vedaldi, and Andrew Zisserman. Generalized category discovery. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 7492\u20137501, 2022.   \n[41] Xudong Wang, Long Lian, and Stella X Yu. Unsupervised selective labeling for more effective semi-supervised learning. In European Conference on Computer Vision (ECCV, pages 427\u2013445. Springer, 2022.   \n[42] Yidong Wang, Hao Chen, Qiang Heng, Wenxin Hou, Yue Fan, Zhen Wu, Jindong Wang, Marios Savvides, Takahiro Shinozaki, Bhiksha Raj, et al. Freematch: Self-adaptive thresholding for semi-supervised learning. arXiv preprint arXiv:2205.07246, 2022.   \n[43] Xin Wen, Bingchen Zhao, and Xiaojuan Qi. Parametric classification for generalized category discovery: A baseline study. In Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 16590\u201316600, 2023.   \n[44] Qizhe Xie, Zihang Dai, Eduard Hovy, Thang Luong, and Quoc Le. Unsupervised data augmentation for consistency training. Advances in Neural Information Processing Systems (NeurIPS), 33:6256\u20136268, 2020.   \n[45] Yi Xu, Lei Shang, Jinxing Ye, Qi Qian, Yu-Feng Li, Baigui Sun, Hao Li, and Rong Jin. Dash: Semi-supervised learning with dynamic thresholding. In International Conference on Machine Learning, pages 11525\u201311536. PMLR, 2021.   \n[46] Qing Yu, Daiki Ikami, Go Irie, and Kiyoharu Aizawa. Multi-task curriculum framework for open-set semi-supervised learning. In European Conference on Computer Vision (ECCV), pages 438\u2013454. Springer, 2020.   \n[47] Bowen Zhang, Yidong Wang, Wenxin Hou, Hao Wu, Jindong Wang, Manabu Okumura, and Takahiro Shinozaki. Flexmatch: Boosting semi-supervised learning with curriculum pseudo labeling. Advances in Neural Information Processing Systems (NeurIPS), 34:18408\u201318419, 2021.   \n[48] Sheng Zhang, Salman Khan, Zhiqiang Shen, Muzammal Naseer, Guangyi Chen, and Fahad Shahbaz Khan. Promptcal: Contrastive affinity learning via auxiliary prompts for generalized novel category discovery. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 3479\u20133488, 2023.   \n[49] Bingchen Zhao, Xin Wen, and Kai Han. Learning semi-supervised gaussian mixture models for generalized category discovery. In Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 16623\u201316633, 2023. ", "page_idx": 10}, {"type": "text", "text": "", "page_idx": 11}, {"type": "text", "text": "", "page_idx": 12}, {"type": "text", "text": "", "page_idx": 13}, {"type": "text", "text": "Technical Appendices ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "Roadmap of technical appendices. These appendices are structured as follows: Appendix A introduces dataset details utilized in our experiments. Appendix B outlines the implementation specifics, including data augmentations and hyperparameters. Modification details for utilized baselines are provided in Appendix C. Additional experiment results consisting of supplementary main results, in-depth analysis, and ablation study of hyperparameters are reported in Appendix D. Complete and rigorous proof of theoretical results is represented in Appendix E. Appendix F discusses the social impacts of our work, and the limitations are considered in Appendix G ", "page_idx": 14}, {"type": "text", "text": "A Datasets ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "The details of the datasets utilized in our experiments are provided in Table 9, which includes dataset statements, as well as the corresponding backbones and batch sizes for training. The choice of backbone and batch size matches previous works [5, 15] for fair comparison. For CIFAR-10/100 datasets, we employ a simple pre-processing encompassing random crop with padding and horizontal flip. To make ResNet-18 compatible with CIFAR input data with a small resolution of $32\\times32$ , we refine the CNN by setting the kernel size to $3\\times3$ and applying a stride of 1. We train the model with a batch size of 512 over 300 epochs. For ImageNet-100 and Tiny-ImageNet datasets, raw images are pre-processed with random resized crop and horizontal filp [22]. We use the standard version of ResNet-50 and ResNet-18 as the backbone, respectively. We leverage the standard SGD method with momentum and weight decay to optimize the network parameters; see hyperparameters in Table 11. ", "page_idx": 14}, {"type": "table", "img_path": "rle9X7DQuH/tmp/992c2c17efadc459cecbfd5187b9098084324a0bcd6c809ec5ac7774d3f5029f.jpg", "table_caption": ["Table 9: Details of evaluation benchmarks, we show the number of classes, dataset statistics, selected backbone, and batch size for training. "], "table_footnote": [], "page_idx": 14}, {"type": "text", "text": "B Implementation details ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "Computational resources. The foundational algorithm of our study is constructed utilizing Python 3.8 and PyTorch 2.1 [31]. All experiments are carried out on NVIDIA\u2019s Tesla A100 GPU with 40G memory. All benchmarks are public and can be easily downloaded. ", "page_idx": 14}, {"type": "text", "text": "Strong augmentation. Furthermore, we apply the strong augmentation to input data for all experiments following FixMatch [36], including random resized crop, horizontal flip, and RandAugment [9]. It should be noted that the only additional enhancement in strong augmentation is RandAugment compared to basic pre-processing. Specifically, RandAugment randomly selects transformations from a collection of options for each sample in a mini-batch. We employed the same sets of image transformations as those used in RandAugment. A complete list of these transformations can be found in the original work [9]. ", "page_idx": 14}, {"type": "text", "text": "OwMatch v.s. OwMatch+. We evaluate two versions of our approach in the main results, as illustrated in Table 1, 12 and 13. In short, OwMatch $^+$ further incorporates the multi-crop technique as an additional augmentation to boost clustering capacity and, hence, improve model performance. The multi-crop strategy was proposed by SwAV [6] to additionally augment images by covering only small sections. The resulting low-resolution images, referred to as local views, allow more augmentations at a marginally increased computational cost. Compared to simple preprocessing (global views), local views generated through a multi-crop strategy involve resized cropping at smaller scales but in greater numbers, as illustrated in Table 10. And they experience additional color distortion [7] consisting of random color jitters, solarizing, and equalization in pursuit of model robustness. Here we apply the multi-crop technique to produce many low-resolution images (local views) and set the hyperparameters following PAWS [2], as detailed in Table 10. ", "page_idx": 14}, {"type": "table", "img_path": "rle9X7DQuH/tmp/18745fd03f85509841349b61ae544f1661943e2062ce2dd619107f0b5f9faa37.jpg", "table_caption": ["Table 10: The details of crop augmentation hyperparameters. "], "table_footnote": [], "page_idx": 15}, {"type": "text", "text": "Except for additional multi-crop augmentations, OwMatch and OwMatch+ differ slightly in the form of clustering objective. Specifically, we augment the input image by taking 2 full-resolution crops (normally and strongly augmented global views) and $V$ low-resolution crops (local views). Note that we optimize the self-label $\\tilde{\\mathbf{q}}$ with only global views, since local views can only capture localized semantic information and are unable to provide a comprehensive overview of the entire image. We promote the model consistency by encouraging the prediction of different local views to be close to the optimized self-labels. Specifically, the clustering objective of OwMatch $^{+}$ is formulated by ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\mathcal{L}_{c l s}^{+}=\\frac{1}{(V+1)N}\\sum_{i=1}^{N}\\left[\\sum_{v=1}^{V}H(\\tilde{\\mathbf{q}}^{(i)},g_{\\theta}(\\alpha_{v}(\\mathbf{x}^{(i)})))+H(\\tilde{\\mathbf{q}}^{(i)},\\mathbf{p}^{(i)})\\right],\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "where $\\tilde{\\mathbf{q}}^{(i)}$ correspond to the optimized self-label of global view, and $g_{\\boldsymbol{\\theta}}(\\alpha_{1}(\\mathbf{x}^{(i)})),\\cdots,g_{\\boldsymbol{\\theta}}(\\alpha_{V}(\\mathbf{x}^{(i)}))$ stand for predictions of $V$ local views. Increasing the number of random low-resolution crops encourages the model to learn global-to-local information [2], which reflects in performance gain across all benchmarks; see main results in Table 1, 12 and 13. The utilization of low-resolution images boosts the model\u2019s efficiency with only a marginal rise in computational costs. ", "page_idx": 15}, {"type": "text", "text": "The effectiveness of conditional self-labeling is significantly compromised when the ratio of batch size $(B)$ to class numbers $(K)$ is relatively small. In a scenario where a class is disproportionately sampled in the labeled data of a batch, the conditional self-labeling mechanism might be unable to reassign the unlabeled data to that particular class. Notably, when this ratio falls below 1, assigning $B$ samples to all $K$ classes becomes unfeasible. Therefore, we leverage the queue structure to store data from previous batches by following SwAV [6]. In practice, a queue of 1024 logits are stored for the implementation of the Sinkhorn-Knopp algorithm, which is utilized to derive the self-label assignment. We then retain the logits from the last batch of the optimized self-labels to construct the clustering objective. Such queue length proves effective in our experiments with a large batch size (e.g., 512) and a relatively small number of categories (e.g., 100 classes for CIFAR-100). However, when dealing with high-resolution images that encompass a greater variety of categories, storing much more previous data information is essential. ", "page_idx": 15}, {"type": "text", "text": "Hyperparameters Here, we provide a comprehensive list of hyperparameters in Table 11. For hyperparameters related to the SGD optimizer, we adhere to the settings used in the previous works [5, 34] to ensure a fair comparison. Regarding hyperparameters introduced by our proposed method, we perform ablation studies to determine the most appropriate values, specifically for SK-iteration and the number of local views, as detailed in Appendix D. These hyperparameters are selected based on a balanced consideration of computational costs and model performance. ", "page_idx": 15}, {"type": "table", "img_path": "rle9X7DQuH/tmp/702c8be2f465d274210253eb017e749459d519722abcd6a9e273013292f2ef6a.jpg", "table_caption": ["Table 11: List of hyperparameters for CIFAR-10/100, ImageNet-100, and Tiny-ImageNet. "], "table_footnote": [], "page_idx": 15}, {"type": "text", "text": "C Baseline implementation details ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "We compare our proposal with baselines from other settings: traditional SSL, open-set semisupervised learning (OSSL), and novel class discovery (NCD). We will elaborate on the modifications to these settings separately. Traditional SSL methods cannot deal with the novel-class instances and we extend it in the following manner: samples are firstly divided into seen-class and novel-class instances based on out-of-distribution (OOD) criteria, then we report the standard classification accuracy on seen-class instances and apply K-means algorithms to achieve clustering accuracy on the novel-class instances. Hungarian algorithm [26] is utilized to match the clustering result and their ground-truth labels, this result is reported as novel-class accuracy. For the traditional SSL method, FixMatch [36], we separate the OOD samples based on confidence scores produced by the Softmax function. Many OSSL approaches like CGDL [37] are naturally capable of detecting outliers, thus we directly cluster the considered outliers by the K-means algorithm and report the clustering accuracy without manually inspecting OOD samples. Since DS3L [16] applies the re-weighting technique to downsize the passive effect of OOD samples, we consider the samples with the lowest weight as outliers. Both traditional SSL and weighting-based OSSL approaches depend on the OOD likelihood score to partition the inliers and outliers. Here we follow ORCA [5] to determine the threshold for OOD samples by using ground-truth class information. ", "page_idx": 16}, {"type": "text", "text": "NCD methods are trained to discover novel classes in unlabeled data with totally novel-class instances, thus failing to recognize seen-class instances. For NCD approaches without seen-class classification heads, like DTC [18] and RankStats [17], we report the performance on novel classes and extend them to classify seen classes by assuming the seen-class instances in unlabeled data as novel. Then we extend the unlabeled classification head to include logits for seen classes by following [5] and leverage the Hungarian algorithm to match the discovered classes with ground-truth labels within labeled data, the best assignment is reported as seen-class accuracy. And for recent UNO [12] with explicitly labeled classification heads, we generate pseudo-labels for both seen- and novel-class instances based on model predictions from concatenated labeled and unlabeled classification heads. Therefore, both seen and novel class classification accuracy can be directly computed and reported. We apply the same pre-trained model on NCD methods to demonstrate that the enhanced performance is not attributable to the the application of pre-training. Additionally, we present the clustering outcomes based on representations from the pre-trained model. ", "page_idx": 16}, {"type": "text", "text": "D Additional results ", "text_level": 1, "page_idx": 16}, {"type": "image", "img_path": "rle9X7DQuH/tmp/7d55e4f137a915d9598d6ca2b56970b9cb61eacb2e2c06c70b812e1fe3772e87.jpg", "img_caption": ["Figure 4: Confusion matrices on CIFAR-10 with both novel class ratio and label ratio of $50\\%$ . The model needs to classify the initial five seen classes accurately (as reflected in the diagonal elements). While for the novel classes (6-10), the classes clustering are required to align with the ground-truth label (dark blue in one cell). "], "img_footnote": [], "page_idx": 16}, {"type": "text", "text": "Training process. We plot the confusion matrices on CIFAR-10 with both novel class ratio and label ratio of $50\\%$ in Figure 4. This collection of images compellingly demonstrates that the bias derived from novel classes is progressively mitigated as the experiment advances, leading to continuous improvement in the model\u2019s prediction accuracy. ", "page_idx": 16}, {"type": "text", "text": "As depicted in Figure 4a, at the beginning of training, the model struggles to effectively distinguish between novel and seen class instances, although it can classify seen class instances normally. As training progresses, an increasing number of samples are assigned to the novel classes and prediction accuracy for the seen-class instances advances, as illustrated in Figure 4b. In the later stages of training as shown in Figure $4c$ , the model becomes capable of accurately classifying the seen-class instances and clustering novel-class instances simultaneously. ", "page_idx": 16}, {"type": "text", "text": "", "page_idx": 17}, {"type": "table", "img_path": "rle9X7DQuH/tmp/644af6ce3e1aac7bc9c379250aebece1a28aea51e2012793c7856f19393547b6.jpg", "table_caption": ["Table 12: Average accuracy on the CIFAR-10/100 and ImageNet-100 with novel class ratio of $50\\%$ and labeled ratio of $10\\%$ . "], "table_footnote": [], "page_idx": 17}, {"type": "text", "text": "Main results with label ratio of $10\\%$ . We evaluate our approach on CIFAR-10/100 and ImageNet100, closely similar to Table 1, but with the label ratio adjusted to $10\\%$ . The results are detailed in Table 12; OwMatch $^+$ continues to maintain state-of-the-art performance across most benchmarks and evaluation metrics. ", "page_idx": 17}, {"type": "text", "text": "Performance sensitivity to varying extents of class number estimation error. As illustrated in Figure 5, OwMatch maintains robust performance over a range of errors. ", "page_idx": 17}, {"type": "image", "img_path": "rle9X7DQuH/tmp/2471aabb602982dd6d1fca7ccd866b89bb437e38513aef5c42962b80627160e4.jpg", "img_caption": ["Figure 5: Accuracy as a function of class number estimation error on CIFAR-100 dataset. "], "img_footnote": [], "page_idx": 17}, {"type": "text", "text": "Main results on Tiny-ImageNet. In addition to the results on CIFAR and ImageNet datasets, we also evaluate OwMatch and OwMatch $^{+}$ on Tiny-ImageNet with $50\\%$ novel classes in Table 13. We found that both OwMatch and OwMatch $^+$ surpass previous state-of-the-art methods across benchmarks and evaluation metrics. ", "page_idx": 17}, {"type": "text", "text": "Different novel class ratio. Previously, we assessed model\u2019s performance with a constant novel class ratio of $50\\%$ , which is also variable in real-world scenarios. Here, we alter this value and fix the label ratio within seen classes to $50\\%$ ; the results are reported in Table 14. The model\u2019s performance generally exhibits a declining trend across all benchmarks and evaluation metrics as the novel class ratio increases. It is important to note that as the number of novel classes increases, the total amount of labeled data decreases. ", "page_idx": 17}, {"type": "table", "img_path": "rle9X7DQuH/tmp/7158106a496d51eca6d5d256922c10cbf293b1a103538d35459b2b92e17ea7c3.jpg", "table_caption": ["Table 13: Average accuracy on Tiny-ImageNet datasets with label ratio of $10\\%$ and $50\\%$ . "], "table_footnote": [], "page_idx": 18}, {"type": "table", "img_path": "rle9X7DQuH/tmp/1c5c0dfd7702056e9d712476438d37361d0c3f734c380505e84bd674493803de.jpg", "table_caption": ["Table 14: Model performance across benchmarks with varying novel class ratios. "], "table_footnote": [], "page_idx": 18}, {"type": "text", "text": "Efficient labeling strategy under a fixed budget. In the previously conducted experiments, we assessed the model\u2019s performance by altering the novel class ratio and label ratio, respectively. Merely altering a single factor does not yield highly convincing inferences, as it is impractical to fix the novel class ratio or the label ratio for some classes in real-world scenarios. Here, we consider a fixed budget, specifically the total number of labeled data, as illustrated in Figure 6. This comparison aims to shed light on how the balance between labeled data in seen classes and the proportion of novel classes influences model performance under a fixed level of supervision. ", "page_idx": 18}, {"type": "text", "text": "When the supervisory information is held constant, a configuration with a smaller portion of labeled data spread across a greater number of different classes results in higher accuracy for both all classes and novel classes. Additionally, it is observed that as the number of novel classes decreases, the accuracy of the seen classes improves. This improvement is attributed to the reduced complexity of the classification task when there are fewer categories to be classified. From these observations, it can be inferred that within a limited labeling budget, it is more effective to label a broader category of samples, thereby capturing as many representative points as possible within the feature space. This strategy appears to optimize the model\u2019s performance across both known and novel classes. ", "page_idx": 18}, {"type": "text", "text": "Hierarchical thresholding scheme with scarce supervision information. Previously, we observed that in the scenario where the label ratio on seen classes is $50\\%$ , the performance difference between adopting the hierarchical thresholding strategy and setting a high static threshold hyperparameter is not significant. Here, we maintain the novel class ratio as $50\\%$ while decreasing the label ratio to $10\\%$ . Figure 7a and Figure 7b demonstrate that a hierarchical thresholding scheme not only retains more pseudo-labels but also preserves the predictive accuracy of selected pseudo-labels. ", "page_idx": 18}, {"type": "table", "img_path": "rle9X7DQuH/tmp/3cb6b5e31fec4cfa777eacb31bbb1219b61ffba70efa539754ffab7e94ba240d.jpg", "table_caption": ["Table 15: Model performance on CIFAR-10/100 and Tiny-ImageNet with different number of local views to contrastive learning. "], "table_footnote": [], "page_idx": 18}, {"type": "text", "text": "Different number of local views in contrastive learning. Contrastive learning boosts clustering by acquiring different views of the data and promoting consistency across these views at the representation level. The manner of data augmentation and the number of augmented views largely determine the model performance. Here we take the combination of color distortion and random resized crop [7] as augmentation and apply a multi-crop technique [6] to produce many low-resolution images (local views). We compare the performance with varying number of local views, the results are reported in Table 15. ", "page_idx": 18}, {"type": "image", "img_path": "rle9X7DQuH/tmp/ed4124de8e574a86fbf1d328246c9e43db990c23acc9f8456b9e4d1767155a64.jpg", "img_caption": ["Figure 6: Model performance on CIFAR-100 with varying numbers of seen classes and a fixed amount of labeled data ( $5\\%$ of total data). Models trained with more seen classes generally perform better on both novel and all classes, despite having fewer labeled data per seen class. "], "img_footnote": [], "page_idx": 19}, {"type": "image", "img_path": "rle9X7DQuH/tmp/55eef5c84d4066d4a2efc697d9e6507f1821afcac28a3a2c4b32ee90e6af834b.jpg", "img_caption": ["Figure 7: Open-world hierarchical thresholding scheme generally selects more instances as pseudolabels (a), and the quality of pseudo-labels is also enhanced (b). "], "img_footnote": [], "page_idx": 19}, {"type": "text", "text": "", "page_idx": 19}, {"type": "text", "text": "The incorporation of local views significantly enhances model performance. However, it\u2019s observed that as the number of local views increases, the incremental benefits to the model come to plateau, while the training and computational time considerably escalate. This aligns with the notion that local views assist in capturing local patterns, aiding in the development of robust representations. However, there is a threshold beyond which the addition of more local views contributes less to learning, overshadowed by the rise in computational demands. ", "page_idx": 19}, {"type": "text", "text": "Different number of iterations in the Sinkhorn-Knopp algorithm. Conditional self-labeling is proposed to optimize high-quality self-label assignments, which depends on a fast version of the Sinkhorn-Knopp algorithm [10] to solve this complex linear programs efficiently. Resolving this involves iterative processes to converge on the optimal solution. We evaluate the model performance across different iterations, with the results presented in Table 16. ", "page_idx": 19}, {"type": "text", "text": "Generally, model performance tends to increase with more iterations of the Sinkhorn-Knopp algorithm. Despite the positive correlation tendency, we observe that certain iterations (e.g., 6 for CIFAR-100 with both novel class ratio and label ratio of $50\\%$ ) already achieve satisfactory outcomes, with only marginal gains from further iterations. ", "page_idx": 19}, {"type": "text", "text": "E Proof details ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "Here, we derive ECS for both unconditional and conditional self-labeling in the following two lemmas. ", "page_idx": 19}, {"type": "table", "img_path": "rle9X7DQuH/tmp/65a55c342b16c5bdd8c2489cd45576b5c524b1ece15619ddeb745c5be534cc01.jpg", "table_caption": ["Table 16: Model performance on CIFAR-10/100 and Tiny-ImageNet with different iteration numbers in Sinkhorn-Knopp algorithm. "], "table_footnote": [], "page_idx": 20}, {"type": "text", "text": "Lemma E.1. Estimators of A from unconditional self-labeling has the form of ", "page_idx": 20}, {"type": "equation", "text": "$$\n{\\bf A}_{\\mathrm{uncon}}=[N^{u}p_{1},N^{u}p_{2},\\cdot\\cdot\\cdot,N^{u}p_{K}],\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "and ECS for $\\begin{array}{r}{\\hat{\\mu}_{\\mathrm{uncon}}=\\frac{1}{N^{u}}{\\bf A}_{\\mathrm{uncon}}}\\end{array}$ can be derived as ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\mathrm{ECS}(\\hat{\\pmb{\\mu}}_{\\mathrm{uncon}})=\\sum_{i=1}^{K}\\frac{N^{u}(\\b{p}_{i}-\\b{p}_{i}^{u})^{2}}{p_{i}^{u}}.\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "Lemma E.2. Estimators of A from conditional self-labeling has the form of ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\mathbf{A}_{\\mathrm{con}}=[N p_{1}-N_{1}^{l},\\cdot\\cdot\\cdot,N p_{K}-N_{K}^{l}],\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "and ECS for $\\begin{array}{r}{\\hat{\\pmb{\\mu}}_{\\mathrm{con}}=\\frac{1}{N^{u}}{\\bf A}_{\\mathrm{con}}}\\end{array}$ can be derived as ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\mathrm{ECS}(\\hat{\\mu}_{\\mathrm{con}})=\\sum_{i=1}^{K}\\frac{N^{l}p_{i}^{l}(1-p_{i}^{l})}{N^{u}p_{i}^{u}}.\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "E.1 Proof of Lemma 4.2 ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Proof. Under the null hypothesis $H_{0}$ , the sample size of the $i$ -th class follows the Binary distribution with parameters of $N$ and $p_{i}$ . Therefore, we have the expectation and standard error of $N_{i}$ as $\\mathbb{E}_{\\mathcal{P}}(N_{i})\\,=\\,N p_{i}$ and $\\mathbb{S}\\mathbb{D}(N_{i})\\,=\\,N p_{i}(1\\,-\\,p_{i})$ , respectively, where the standard deviation of $N_{i}$ measures the average deviation of random variable $N_{i}$ from its expected value. And for observation $n_{i}$ for each class, the discrepancy can be denoted as $n_{i}-\\mathbb{E}_{\\mathcal{P}}(N_{i})$ . To ensure discrepancies for each class are evaluated on a consistent basis, dividing them by their standard errors under $H_{0}$ , which enables us to focus on the standardized variable(Nnpii\u2212(1E\u2212Pp(iN))i1)/2 . ", "page_idx": 20}, {"type": "text", "text": "Note that $\\begin{array}{r}{\\sum_{i=1}^{K}\\mathbb{E}\\pmb{\\mathscr{P}}(N_{i})=\\sum_{i=1}^{K}N p_{i}=N}\\end{array}$ , therefore the discrepancies across the $K$ classes cannot simultan eously be all posit ive or all negative. To measure the discrepancies of all $K$ classes, we sum the squares of the discrepancies of each class. This formulation ensures that discrepancies are independent of sign, merely reflecting the deviation between observed and expected values under $H_{0}$ : ", "page_idx": 20}, {"type": "equation", "text": "$$\n{\\frac{(n_{1}-N p_{1})^{2}}{N p_{1}(1-p_{1})}}+{\\frac{(n_{2}-N p_{2})^{2}}{N p_{2}(1-p_{2})}}+\\cdot\\cdot\\cdot+{\\frac{(n_{K}-N p_{K})^{2}}{N p_{i}(1-p_{K})}}.\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "We then prefer to exclude the factors $(1-p_{i})$ from the denominators of the sum for two primary reasons. Firstly, if numerous classes exist and none of them has significant large probabilities, then $(1-p_{i})$ is almost negligible. Moreover, when the expectation $\\mathbb{E}_{\\mathcal{P}}(N_{i})$ is substantial, the approximation of each discrepancy adheres to a standard normal distribution, which leads to the construct of chi-square statistics with the degree of freedom of $K-1$ . Then the summary statistic can be obtained as follows ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\chi^{2}=\\sum_{i=1}^{K}\\frac{(n_{i}-N p_{i})^{2}}{N p_{i}}=\\sum_{i=1}^{K}\\frac{(n_{i}-\\mathbb{E}_{\\mathcal{P}}[N_{i}]^{2})}{\\mathbb{E}_{\\mathcal{P}}[N_{i}]}\\sim\\chi_{K-1}^{2}.\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "E.2 Proof of Lemma E.1 ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "Proof. TRSSL [34] posits that unlabeled and real data share the same class distribution, and optimize the self-label assignment on unlabeled data solely based on prior information $\\mathcal{P}$ . Owing to the alignment constraint between the generative self-label assignment and prior information, as shown in (1). Then the estimated number of samples in each class from conditional self-labeling is ", "page_idx": 21}, {"type": "equation", "text": "$$\n{\\bf A}_{\\mathrm{uncon}}=[N^{u}p_{1},N^{u}p_{2},\\cdot\\cdot\\cdot,N^{u}p_{K}],\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "$N^{u}$ $p_{1},\\cdot\\cdot\\cdot,p_{K}$ caornes tkannot wvne,c ttohresr.e fTohreu $\\mathbf{A}_{\\mathrm{uncon}}$ CisS  af ocro eccatno rbse.  cTahlecnu ltahtee de sdtiirmecattloyr, $\\begin{array}{r}{\\hat{\\mu}_{\\mathrm{uncon}}=\\frac{1}{N^{u}}{\\bf A}_{\\mathrm{uncon}}}\\end{array}$ $\\hat{\\pmb{\\mu}}_{\\mathrm{uncon}}$ ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathrm{ECS}(\\hat{\\mu}_{\\mathrm{uncon}})=\\!\\mathbb{E}\\left[\\displaystyle\\sum_{i=1}^{K}\\frac{(N^{u}p_{i}-\\mathbb{E}\\mathcal{P}[N_{i}^{u}])^{2}}{\\mathbb{E}\\mathcal{P}[N_{i}^{u}]}\\right]}\\\\ &{\\phantom{\\mathrm{ECS}}\\!\\!\\!=\\!\\!\\sum_{i=1}^{K}\\frac{(N^{u}p_{i}-N^{u}p_{i}^{u}))^{2}}{N^{u}p_{i}^{u}}}\\\\ &{\\phantom{\\mathrm{ECS}}\\!\\!\\!=\\!\\!\\sum_{i=1}^{K}\\frac{N^{u}(p_{i}-p_{i}^{u})^{2}}{p_{i}^{u}}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "E.3 Proof of Lemma E.2 ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "Proof. Different from an unconditional setting, conditional self-labeling considers partial supervision. Specifically, except for the constraint brought from prior information, an additional constraint is constructed to realize the alignment between clustering results and existing labels in labeled data, as shown in (3). Then the estimated number of samples in each class from conditional self-labeling is ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\mathbf{A}_{\\mathrm{con}}=[N p_{1}-N_{1}^{l},\\cdot\\cdot\\cdot,N p_{K}-N_{K}^{l}],\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "where $N,p_{1},p_{2},\\cdot\\cdot\\cdot\\,,p_{K}$ are static values, and $N_{1}^{l},\\cdot\\cdot\\cdot\\,,N_{K}^{l}$ are a set of random variables. Note that in a specific experiment, we can get a set of observations of $N_{1}^{l},\\cdot\\cdot\\cdot\\,,N_{K}^{l}$ , thus estimation based on conditional self-labeling is feasible. Then consider the estimator $\\begin{array}{r}{\\hat{\\pmb{\\mu}}_{\\mathrm{con}}\\ \\ \\ \\hat{=}\\ \\frac{1}{N^{u}}\\mathbf{A}_{\\mathrm{con}}}\\end{array}$ , derivation steps of the ECS for $\\hat{\\pmb{\\mu}}_{\\mathrm{con}}$ are as follow, ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\mathrm{ECS}(\\hat{\\mu}_{\\mathrm{uncon}})=\\mathbb{E}\\left[\\sum_{i=1}^{K}\\frac{(N p_{i}-N_{i}^{l}-\\mathbb{E}_{\\mathcal{P}}[N_{i}^{u}])^{2}}{\\mathbb{E}_{\\mathcal{P}}[N_{i}^{u}]}\\right]=\\mathbb{E}\\left[\\sum_{i=1}^{K}\\frac{(N p_{i}-N_{i}^{l}-N^{u}p_{i}^{u})^{2}}{N^{u}p_{i}^{u}}\\right].\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "According to (10), we have ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\mathbb{E}\\left[\\sum_{i=1}^{K}\\frac{(N p_{i}-N_{i}^{l}-N^{u}p_{i}^{u})^{2}}{N^{u}p_{i}^{u}}\\right]=\\mathbb{E}\\left[\\sum_{i=1}^{K}\\frac{(N_{i}^{l}p_{i}^{l}-N_{i}^{l})^{2}}{N^{u}p_{i}^{u}}\\right]=\\mathbb{E}\\left[\\sum_{i=1}^{K}\\frac{(N_{i}^{l}-\\mathbb{E}p[N_{i}^{l}])^{2}}{N^{u}p_{i}^{u}}\\right].\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "Since ECS is also defined at the population level, thus we have ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\mathbb{E}\\left[\\sum_{i=1}^{K}\\frac{(N_{i}^{l}-\\mathbb{E}\\mathcal{P}[N_{i}^{l}])^{2}}{N^{u}p_{i}^{u}}\\right]=\\left[\\sum_{i=1}^{K}\\frac{\\mathbb{E}(N_{i}^{l}-\\mathbb{E}\\mathcal{P}[N_{i}^{l}])^{2}}{N^{u}p_{i}^{u}}\\right]=\\sum_{i=1}^{K}\\frac{\\mathrm{Var}(N_{i}^{l})}{N^{u}p_{i}^{u}}.\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "Since $N_{1}^{l},N_{2}^{l},\\cdot\\cdot\\cdot\\cdot,N_{K}^{l}\\sim\\mathrm{Multinomial}(N^{u},\\pmb{\\mathscr{P}}^{l}).$ , we have ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\sum_{i=1}^{K}\\frac{\\operatorname{Var}(N_{i}^{l})}{N^{u}p_{i}^{u}}=\\sum_{i=1}^{K}\\frac{N^{l}p_{i}^{l}(1-p_{i}^{l})}{N^{u}p_{i}^{u}}.\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "E.4 Proof of Theorem 4.4 ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Proof. From Theorem E.2 and Theorem E.3, we have that ", "page_idx": 22}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\hat{\\boldsymbol{\\mu}}_{\\mathrm{uncon}}=[p_{1},p_{2},\\cdot\\cdot\\cdot\\cdot,p_{K}]=\\mathcal{P},}\\\\ &{\\hat{\\boldsymbol{\\mu}}_{\\mathrm{con}}=\\left[\\frac{N p_{1}-N_{1}^{l}}{N^{u}},\\cdot\\cdot\\cdot,\\frac{N p_{K}-N_{K}^{l}}{N^{u}}\\right].}\\end{array}\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "Note that $\\hat{\\pmb{\\mu}}_{\\mathrm{uncon}}$ is exactly the prior information, $\\hat{\\pmb{\\mu}}_{\\mathrm{con}}$ are function of a set of random variables $N_{i}^{l},N_{2}^{l},\\cdot\\cdot\\cdot\\cdot,N_{K}^{l}$ , then we have ", "page_idx": 22}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{E}(\\hat{\\mu}_{\\mathrm{con}})=\\bigg[\\mathbb{E}(\\frac{N p_{1}-N_{1}^{l}}{N^{u}}),\\cdot\\cdot\\cdot\\cdot,\\mathbb{E}(\\frac{N p_{K}-N_{K}^{l}}{N^{u}})\\bigg]}\\\\ &{\\qquad\\qquad=\\bigg[\\frac{N p_{1}-N^{l}p_{1}^{l}}{N^{u}},\\cdot\\cdot\\cdot\\cdot,\\frac{N p_{1}-N^{l}p_{K}^{l}}{N^{u}}\\bigg]\\,.}\\end{array}\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "According to (10), we have ", "page_idx": 22}, {"type": "equation", "text": "$$\n\\begin{array}{r l r}{\\lefteqn{\\left[\\frac{N p_{1}-N^{l}p_{1}^{l}}{N^{u}},\\cdot\\cdot\\cdot,\\frac{N p_{1}-N^{l}p_{K}^{l}}{N^{u}}\\right]=\\left[\\frac{N^{u}p_{1}^{u}}{N^{u}},\\cdot\\cdot\\cdot,\\frac{N^{u}p_{K}^{u}}{N^{u}}\\right]}}&{}&\\\\ &{}&{=[p_{1}^{u},p_{2}^{u},\\cdot\\cdot\\cdot\\cdot,p_{K}^{u}]=\\mathcal{P}^{u}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "Thus, $\\hat{\\pmb{\\mu}}_{\\mathrm{con}}$ is a unbiased estimator of $\\mathcal{C}^{u}$ . ", "page_idx": 22}, {"type": "text", "text": "E.5 Proof of Theorem 4.5 ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Proof. Note that $\\begin{array}{r}{r_{i}:=\\frac{N^{l}\\cdot p_{i}^{l}}{N}}\\end{array}$ NlN\u00b7pli is non-negative and obtain zero if and only if the i-th class denote a novel class.   \nWhen the $i$ -th class refers to seen classes, we have $\\begin{array}{r}{p_{i}^{u}=\\frac{p_{i}-r_{i}}{1-r}}\\end{array}$ , then ", "page_idx": 22}, {"type": "text", "text": "", "page_idx": 22}, {"type": "equation", "text": "$$\nN^{u}(p_{i}-p_{i}^{u})^{2}\\geq N^{u}(r_{i}-r\\cdot p_{i}^{u})^{2}\\geq1.\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "When the $i$ -th class refers to an novel class, we have $\\begin{array}{r}{p_{i}^{u}=\\frac{p_{i}}{1-r}}\\end{array}$ , then ", "page_idx": 22}, {"type": "equation", "text": "$$\nN^{u}(p_{i}-p_{i}^{u})^{2}=N^{u}\\cdot\\left(p_{i}-\\frac{p_{i}}{1-r}\\right)^{2}=N^{u}\\cdot\\left(\\frac{r p_{i}}{1-r}\\right)^{2}\\geq N^{u}(r\\cdot p_{i})^{2}\\geq1.\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "Therefore, we get that ", "page_idx": 22}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathrm{ECS}(\\hat{\\mu}_{\\mathrm{uncon}})-\\mathrm{ECS}(\\hat{\\mu}_{\\mathrm{con}})=\\displaystyle\\sum_{i=1}^{K}\\frac{N^{u}(p_{i}-p_{i}^{u})^{2}-\\frac{N^{l}}{N^{u}}p_{i}^{l}(1-p_{i}^{l})}{p_{i}^{u}}}\\\\ &{\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\geq\\displaystyle\\sum_{i=1}^{K}\\frac{N^{u}(p_{i}-p_{i}^{u})^{2}-1}{p_{i}^{u}}\\geq0.}\\end{array}\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "F Broader impacts ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "This research delves into the issue of semi-supervised learning (SSL) in situations where not all classes possess labeled instances, an aspect that has received limited attention within the realm of SSL. We aim to draw increased focus towards examining the resilience of SSL in diverse real-world scenarios, thereby fostering a broader application of SSL in various contexts. However, the current accuracy is not very high for some challenging datasets. Therefore, the predictive results should be best used as references rather than treated as ground truth. ", "page_idx": 22}, {"type": "text", "text": "G Limitations ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "OwMatch, similar to existing methods in OwSSL, faces a significant challenge when applied to imbalanced datasets or unknown prior class distribution. Existing OwSSL methods are typically applied on class-balanced datasets where instances of each class share nearly the same frequency; the model performance would deteriorate when encountering imbalanced datasets. On the other hand, prior class distributions are not available in real-world applications. Addressing the dependency on prior class distribution and effectively handling datasets of arbitrary composition remain challenging for existing OwSSL algorithms, including OwMatch. ", "page_idx": 23}, {"type": "text", "text": "Recognizing this, we propose an adaptive estimation scheme for the OwMatch framework and show its feasibility in the experiments, with results reported in Table 8. Although a performance decline within $3\\%$ may seem acceptable, it is worth further consideration and exploration to determine whether further optimizations can enhance model performance without any prior. At the same time, we aim to prove the convergence of this adaptive algorithm in our future work. ", "page_idx": 23}, {"type": "text", "text": "NeurIPS Paper Checklist ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "1. Claims ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Question: Do the main claims made in the abstract and introduction accurately reflect the paper\u2019s contributions and scope? ", "page_idx": 24}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 24}, {"type": "text", "text": "Justification: We claim our scope and contributions clearly in abstract and Section 1 ", "page_idx": 24}, {"type": "text", "text": "Guidelines: ", "page_idx": 24}, {"type": "text", "text": "\u2022 The answer NA means that the abstract and introduction do not include the claims made in the paper.   \n\u2022 The abstract and/or introduction should clearly state the claims made, including the contributions made in the paper and important assumptions and limitations. A No or NA answer to this question will not be perceived well by the reviewers.   \n\u2022 The claims made should match theoretical and experimental results, and reflect how much the results can be expected to generalize to other settings.   \n\u2022 It is fine to include aspirational goals as motivation as long as it is clear that these goals are not attained by the paper. ", "page_idx": 24}, {"type": "text", "text": "2. Limitations ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Question: Does the paper discuss the limitations of the work performed by the authors? ", "page_idx": 24}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Justification: We discuss the limitations of this work and possible refinements in Appendix G. Guidelines: ", "page_idx": 24}, {"type": "text", "text": "\u2022 The answer NA means that the paper has no limitation while the answer No means that the paper has limitations, but those are not discussed in the paper.   \n\u2022 The authors are encouraged to create a separate \"Limitations\" section in their paper.   \n\u2022 The paper should point out any strong assumptions and how robust the results are to violations of these assumptions (e.g., independence assumptions, noiseless settings, model well-specification, asymptotic approximations only holding locally). The authors should reflect on how these assumptions might be violated in practice and what the implications would be.   \n\u2022 The authors should reflect on the scope of the claims made, e.g., if the approach was only tested on a few datasets or with a few runs. In general, empirical results often depend on implicit assumptions, which should be articulated.   \n\u2022 The authors should reflect on the factors that influence the performance of the approach. For example, a facial recognition algorithm may perform poorly when image resolution is low or images are taken in low lighting. Or a speech-to-text system might not be used reliably to provide closed captions for online lectures because it fails to handle technical jargon.   \n\u2022 The authors should discuss the computational efficiency of the proposed algorithms and how they scale with dataset size.   \n\u2022 If applicable, the authors should discuss possible limitations of their approach to address problems of privacy and fairness.   \n\u2022 While the authors might fear that complete honesty about limitations might be used by reviewers as grounds for rejection, a worse outcome might be that reviewers discover limitations that aren\u2019t acknowledged in the paper. The authors should use their best judgment and recognize that individual actions in favor of transparency play an important role in developing norms that preserve the integrity of the community. Reviewers will be specifically instructed to not penalize honesty concerning limitations. ", "page_idx": 24}, {"type": "text", "text": "3. Theory Assumptions and Proofs ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Question: For each theoretical result, does the paper provide the full set of assumptions and a complete (and correct) proof? ", "page_idx": 24}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 24}, {"type": "text", "text": "Justification: We provide all theoretical results with detailed assumptions in Section 4 and complete proof in Appendix E from the Appendix. ", "page_idx": 25}, {"type": "text", "text": "Guidelines: ", "page_idx": 25}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include theoretical results.   \n\u2022 All the theorems, formulas, and proofs in the paper should be numbered and crossreferenced.   \n\u2022 All assumptions should be clearly stated or referenced in the statement of any theorems.   \n\u2022 The proofs can either appear in the main paper or the supplemental material, but if they appear in the supplemental material, the authors are encouraged to provide a short proof sketch to provide intuition.   \n\u2022 Inversely, any informal proof provided in the core of the paper should be complemented by formal proofs provided in appendix or supplemental material.   \n\u2022 Theorems and Lemmas that the proof relies upon should be properly referenced. ", "page_idx": 25}, {"type": "text", "text": "4. Experimental Result Reproducibility ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "Question: Does the paper fully disclose all the information needed to reproduce the main experimental results of the paper to the extent that it affects the main claims and/or conclusions of the paper (regardless of whether the code and data are provided or not)? ", "page_idx": 25}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 25}, {"type": "text", "text": "Justification: We provide all training implementation details in Section 5.1 and Appendix B. Guidelines: ", "page_idx": 25}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 If the paper includes experiments, a No answer to this question will not be perceived well by the reviewers: Making the paper reproducible is important, regardless of whether the code and data are provided or not.   \n\u2022 If the contribution is a dataset and/or model, the authors should describe the steps taken to make their results reproducible or verifiable.   \n\u2022 Depending on the contribution, reproducibility can be accomplished in various ways. For example, if the contribution is a novel architecture, describing the architecture fully might suffice, or if the contribution is a specific model and empirical evaluation, it may be necessary to either make it possible for others to replicate the model with the same dataset, or provide access to the model. In general. releasing code and data is often one good way to accomplish this, but reproducibility can also be provided via detailed instructions for how to replicate the results, access to a hosted model (e.g., in the case of a large language model), releasing of a model checkpoint, or other means that are appropriate to the research performed.   \n\u2022 While NeurIPS does not require releasing code, the conference does require all submissions to provide some reasonable avenue for reproducibility, which may depend on the nature of the contribution. For example (a) If the contribution is primarily a new algorithm, the paper should make it clear how to reproduce that algorithm. (b) If the contribution is primarily a new model architecture, the paper should describe the architecture clearly and fully. (c) If the contribution is a new model (e.g., a large language model), then there should either be a way to access this model for reproducing the results or a way to reproduce the model (e.g., with an open-source dataset or instructions for how to construct the dataset). (d) We recognize that reproducibility may be tricky in some cases, in which case authors are welcome to describe the particular way they provide for reproducibility. In the case of closed-source models, it may be that access to the model is limited in some way (e.g., to registered users), but it should be possible for other researchers to have some path to reproducing or verifying the results. ", "page_idx": 25}, {"type": "text", "text": "5. Open access to data and code ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "Question: Does the paper provide open access to the data and code, with sufficient instructions to faithfully reproduce the main experimental results, as described in supplemental material? ", "page_idx": 25}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 26}, {"type": "text", "text": "Justification: All the datasets are public as illustrated in Appendix B. We will release the full code and commands once the manuscript gets accepted. ", "page_idx": 26}, {"type": "text", "text": "Guidelines: ", "page_idx": 26}, {"type": "text", "text": "\u2022 The answer NA means that paper does not include experiments requiring code.   \n\u2022 Please see the NeurIPS code and data submission guidelines (https://nips.cc/ public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 While we encourage the release of code and data, we understand that this might not be possible, so \u201cNo\u201d is an acceptable answer. Papers cannot be rejected simply for not including code, unless this is central to the contribution (e.g., for a new open-source benchmark).   \n\u2022 The instructions should contain the exact command and environment needed to run to reproduce the results. See the NeurIPS code and data submission guidelines (https: //nips.cc/public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 The authors should provide instructions on data access and preparation, including how to access the raw data, preprocessed data, intermediate data, and generated data, etc.   \n\u2022 The authors should provide scripts to reproduce all experimental results for the new proposed method and baselines. If only a subset of experiments are reproducible, they should state which ones are omitted from the script and why.   \n\u2022 At submission time, to preserve anonymity, the authors should release anonymized versions (if applicable).   \n\u2022 Providing as much information as possible in supplemental material (appended to the paper) is recommended, but including URLs to data and code is permitted. ", "page_idx": 26}, {"type": "text", "text": "6. Experimental Setting/Details ", "text_level": 1, "page_idx": 26}, {"type": "text", "text": "Question: Does the paper specify all the training and test details (e.g., data splits, hyperparameters, how they were chosen, type of optimizer, etc.) necessary to understand the results? ", "page_idx": 26}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 26}, {"type": "text", "text": "Justification: We claim the experiment setting and details in Section 5.1 and Appendix B. Choosing hyper-parameters is based on the observations of the ablation study, as illustrated in Appendix D. ", "page_idx": 26}, {"type": "text", "text": "Guidelines: ", "page_idx": 26}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments. \u2022 The experimental setting should be presented in the core of the paper to a level of detail that is necessary to appreciate the results and make sense of them. \u2022 The full details can be provided either with the code, in appendix, or as supplemental material. ", "page_idx": 26}, {"type": "text", "text": "7. Experiment Statistical Significance ", "text_level": 1, "page_idx": 26}, {"type": "text", "text": "Question: Does the paper report error bars suitably and correctly defined or other appropriate information about the statistical significance of the experiments? ", "page_idx": 26}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 26}, {"type": "text", "text": "Justification: The reported results are averaged after running experiments multiple times with the same random seeds. ", "page_idx": 26}, {"type": "text", "text": "Guidelines: ", "page_idx": 26}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The authors should answer \"Yes\" if the results are accompanied by error bars, confidence intervals, or statistical significance tests, at least for the experiments that support the main claims of the paper.   \n\u2022 The factors of variability that the error bars are capturing should be clearly stated (for example, train/test split, initialization, random drawing of some parameter, or overall run with given experimental conditions).   \n\u2022 The method for calculating the error bars should be explained (closed form formula, call to a library function, bootstrap, etc.)   \n\u2022 The assumptions made should be given (e.g., Normally distributed errors).   \n\u2022 It should be clear whether the error bar is the standard deviation or the standard error of the mean.   \n\u2022 It is OK to report 1-sigma error bars, but one should state it. The authors should preferably report a 2-sigma error bar than state that they have a $96\\%$ CI, if the hypothesis of Normality of errors is not verified.   \n\u2022 For asymmetric distributions, the authors should be careful not to show in tables or figures symmetric error bars that would yield results that are out of range (e.g. negative error rates).   \n\u2022 If error bars are reported in tables or plots, The authors should explain in the text how they were calculated and reference the corresponding figures or tables in the text. ", "page_idx": 26}, {"type": "text", "text": "", "page_idx": 27}, {"type": "text", "text": "8. Experiments Compute Resources ", "text_level": 1, "page_idx": 27}, {"type": "text", "text": "Question: For each experiment, does the paper provide sufficient information on the computer resources (type of compute workers, memory, time of execution) needed to reproduce the experiments? ", "page_idx": 27}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 27}, {"type": "text", "text": "Justification: We provide detailed information regarding compute resources in Appendix B from the Appendix. ", "page_idx": 27}, {"type": "text", "text": "Guidelines: ", "page_idx": 27}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The paper should indicate the type of compute workers CPU or GPU, internal cluster, or cloud provider, including relevant memory and storage.   \n\u2022 The paper should provide the amount of compute required for each of the individual experimental runs as well as estimate the total compute.   \n\u2022 The paper should disclose whether the full research project required more compute than the experiments reported in the paper (e.g., preliminary or failed experiments that didn\u2019t make it into the paper). ", "page_idx": 27}, {"type": "text", "text": "9. Code Of Ethics ", "text_level": 1, "page_idx": 27}, {"type": "text", "text": "Question: Does the research conducted in the paper conform, in every respect, with the NeurIPS Code of Ethics https://neurips.cc/public/EthicsGuidelines? ", "page_idx": 27}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 27}, {"type": "text", "text": "Justification: We have meticulously reviewed the NeurIPS Code of Ethics to ensure compliance with the requirements. ", "page_idx": 27}, {"type": "text", "text": "Guidelines: ", "page_idx": 27}, {"type": "text", "text": "\u2022 The answer NA means that the authors have not reviewed the NeurIPS Code of Ethics.   \n\u2022 If the authors answer No, they should explain the special circumstances that require a deviation from the Code of Ethics.   \n\u2022 The authors should make sure to preserve anonymity (e.g., if there is a special consideration due to laws or regulations in their jurisdiction). ", "page_idx": 27}, {"type": "text", "text": "10. Broader Impacts ", "text_level": 1, "page_idx": 27}, {"type": "text", "text": "Question: Does the paper discuss both potential positive societal impacts and negative societal impacts of the work performed? ", "page_idx": 27}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 27}, {"type": "text", "text": "Justification: We discuss the social impact in Appendix F. ", "page_idx": 27}, {"type": "text", "text": "Guidelines: ", "page_idx": 27}, {"type": "text", "text": "\u2022 The answer NA means that there is no societal impact of the work performed. \u2022 If the authors answer NA or No, they should explain why their work has no societal impact or why the paper does not address societal impact. ", "page_idx": 27}, {"type": "text", "text": "\u2022 Examples of negative societal impacts include potential malicious or unintended uses (e.g., disinformation, generating fake profiles, surveillance), fairness considerations (e.g., deployment of technologies that could make decisions that unfairly impact specific groups), privacy considerations, and security considerations.   \n\u2022 The conference expects that many papers will be foundational research and not tied to particular applications, let alone deployments. However, if there is a direct path to any negative applications, the authors should point it out. For example, it is legitimate to point out that an improvement in the quality of generative models could be used to generate deepfakes for disinformation. On the other hand, it is not needed to point out that a generic algorithm for optimizing neural networks could enable people to train models that generate Deepfakes faster.   \n\u2022 The authors should consider possible harms that could arise when the technology is being used as intended and functioning correctly, harms that could arise when the technology is being used as intended but gives incorrect results, and harms following from (intentional or unintentional) misuse of the technology.   \n\u2022 If there are negative societal impacts, the authors could also discuss possible mitigation strategies (e.g., gated release of models, providing defenses in addition to attacks, mechanisms for monitoring misuse, mechanisms to monitor how a system learns from feedback over time, improving the efficiency and accessibility of ML). ", "page_idx": 28}, {"type": "text", "text": "11. Safeguards ", "text_level": 1, "page_idx": 28}, {"type": "text", "text": "Question: Does the paper describe safeguards that have been put in place for responsible release of data or models that have a high risk for misuse (e.g., pretrained language models, image generators, or scraped datasets)? ", "page_idx": 28}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 28}, {"type": "text", "text": "Justification: This work focuses on classification algorithms using public datasets and therefore poses no risks concerning safeguards. ", "page_idx": 28}, {"type": "text", "text": "Guidelines: ", "page_idx": 28}, {"type": "text", "text": "\u2022 The answer NA means that the paper poses no such risks.   \n\u2022 Released models that have a high risk for misuse or dual-use should be released with necessary safeguards to allow for controlled use of the model, for example by requiring that users adhere to usage guidelines or restrictions to access the model or implementing safety filters.   \n\u2022 Datasets that have been scraped from the Internet could pose safety risks. The authors should describe how they avoided releasing unsafe images.   \n\u2022 We recognize that providing effective safeguards is challenging, and many papers do not require this, but we encourage authors to take this into account and make a best faith effort. ", "page_idx": 28}, {"type": "text", "text": "12. Licenses for existing assets ", "text_level": 1, "page_idx": 28}, {"type": "text", "text": "Question: Are the creators or original owners of assets (e.g., code, data, models), used in the paper, properly credited and are the license and terms of use explicitly mentioned and properly respected? ", "page_idx": 28}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 28}, {"type": "text", "text": "Justification: We properly cite all the original papers involved. All utilized dataset and models are public, as detailed in Appendix B. ", "page_idx": 28}, {"type": "text", "text": "Guidelines: ", "page_idx": 28}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not use existing assets.   \n\u2022 The authors should cite the original paper that produced the code package or dataset.   \n\u2022 The authors should state which version of the asset is used and, if possible, include a URL.   \n\u2022 The name of the license (e.g., CC-BY 4.0) should be included for each asset.   \n\u2022 For scraped data from a particular source (e.g., website), the copyright and terms of service of that source should be provided.   \n\u2022 If assets are released, the license, copyright information, and terms of use in the package should be provided. For popular datasets, paperswithcode.com/datasets has curated licenses for some datasets. Their licensing guide can help determine the license of a dataset.   \n\u2022 For existing datasets that are re-packaged, both the original license and the license of the derived asset (if it has changed) should be provided.   \n\u2022 If this information is not available online, the authors are encouraged to reach out to the asset\u2019s creators. ", "page_idx": 28}, {"type": "text", "text": "", "page_idx": 29}, {"type": "text", "text": "13. New Assets ", "text_level": 1, "page_idx": 29}, {"type": "text", "text": "Question: Are new assets introduced in the paper well documented and is the documentation provided alongside the assets? ", "page_idx": 29}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 29}, {"type": "text", "text": "Justification: The paper introduces newly developed code, which is well documented. The documentation includes detailed descriptions of the code\u2019s purpose, functionality, usage examples, and license details. The documentation will be publicly available. ", "page_idx": 29}, {"type": "text", "text": "Guidelines: ", "page_idx": 29}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not release new assets.   \n\u2022 Researchers should communicate the details of the dataset/code/model as part of their submissions via structured templates. This includes details about training, license, limitations, etc.   \n\u2022 The paper should discuss whether and how consent was obtained from people whose asset is used.   \n\u2022 At submission time, remember to anonymize your assets (if applicable). You can either create an anonymized URL or include an anonymized zip file. ", "page_idx": 29}, {"type": "text", "text": "14. Crowdsourcing and Research with Human Subjects ", "text_level": 1, "page_idx": 29}, {"type": "text", "text": "Question: For crowdsourcing experiments and research with human subjects, does the paper include the full text of instructions given to participants and screenshots, if applicable, as well as details about compensation (if any)? ", "page_idx": 29}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 29}, {"type": "text", "text": "Justification: This paper does not involve crowdsourcing nor research with human subjects. Guidelines: ", "page_idx": 29}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Including this information in the supplemental material is fine, but if the main contribution of the paper involves human subjects, then as much detail as possible should be included in the main paper.   \n\u2022 According to the NeurIPS Code of Ethics, workers involved in data collection, curation, or other labor should be paid at least the minimum wage in the country of the data collector. ", "page_idx": 29}, {"type": "text", "text": "15. Institutional Review Board (IRB) Approvals or Equivalent for Research with Human Subjects ", "text_level": 1, "page_idx": 29}, {"type": "text", "text": "Question: Does the paper describe potential risks incurred by study participants, whether such risks were disclosed to the subjects, and whether Institutional Review Board (IRB) approvals (or an equivalent approval/review based on the requirements of your country or institution) were obtained? ", "page_idx": 29}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 29}, {"type": "text", "text": "Justification: This paper does not involve crowdsourcing nor research with human subjects. Guidelines: ", "page_idx": 29}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects. ", "page_idx": 29}, {"type": "text", "text": "\u2022 Depending on the country in which research is conducted, IRB approval (or equivalent) may be required for any human subjects research. If you obtained IRB approval, you should clearly state this in the paper.   \n\u2022 We recognize that the procedures for this may vary significantly between institutions and locations, and we expect authors to adhere to the NeurIPS Code of Ethics and the guidelines for their institution.   \n\u2022 For initial submissions, do not include any information that would break anonymity (if applicable), such as the institution conducting the review. ", "page_idx": 30}]