[{"figure_path": "wQpNG9JnPK/figures/figures_2_1.jpg", "caption": "Figure 1: Left Figure: A comparison between our approach and previous methods(conclude ERM and IRM-based methods). (a): The comparison of our method, the ERM method, and the IRM method based on the F-norm metric. (b): The comparison of our method, the ERM method, and the IRM method in terms of OOD accuracy (%).", "description": "This figure compares the proposed method with ERM and IRM methods in terms of F-norm and OOD accuracy on a toy dataset. The left panel shows the visualization of how the three methods' features prototypes are organized and aligned in the feature space. The right panel shows the OOD accuracy comparison in the bar chart. The results demonstrate the effectiveness of the proposed method in aligning semantic features across environments.", "section": "1 Introduction"}, {"figure_path": "wQpNG9JnPK/figures/figures_3_1.jpg", "caption": "Figure 2. The overall framework of our method. Left Figure: Input information, including figure, label and environment. Middle Figure: In the scenario of unknown environments, the process of partitioning the environment. Right Figure: Utilizing neural collapse to guide learning of masks for extracting invariant components.", "description": "This figure illustrates the overall framework of the proposed Neural Collapse Inspired Feature Alignment (NCFAL) method for out-of-distribution generalization. It's divided into three parts:\n\n1. **Left:** Shows the input to the model, which includes the image features (x), the corresponding label (y), and the environment (env). The environment is represented by color, and a new mask (m) is applied to separate the semantic and spurious features.\n\n2. **Middle:**  Illustrates the environment partitioning process, crucial when environment labels are unknown. It uses local models trained on data from different environments to determine the environment of a new input sample by selecting the model with the maximum prediction probability.\n\n3. **Right:** Focuses on the neural collapse mechanism for learning the mask. The separated semantic features are used with a fixed ETF (Equiangular Tight Frame) classifier to guide the alignment of semantic features across different environments. This ensures that the features learned collapse to the same simplex in each environment, effectively decoupling semantic and spurious features.", "section": "Methodology"}, {"figure_path": "wQpNG9JnPK/figures/figures_5_1.jpg", "caption": "Figure 2: The overall framework of our method. Left Figure: Input information, including figure, label and environment. Middle Figure: In the scenario of unknown environments, the process of partitioning the environment. Right Figure: Utilizing neural collapse to guide learning of masks for extracting invariant components.", "description": "This figure illustrates the overall framework of the proposed Neural Collapse Inspired Feature Alignment (NCFAL) method. The left panel shows the input to the model, including the image, label, and environment information. The middle panel details the environment partitioning process for scenarios where environment labels are unknown, showing how the model predicts and selects the appropriate environment for each input. The right panel depicts the process of learning masks to extract invariant features, utilizing neural collapse to ensure alignment across environments.  The masks are designed to effectively separate the invariant features (semantic components) from the variable ones (spurious components).", "section": "4 Methodology"}, {"figure_path": "wQpNG9JnPK/figures/figures_8_1.jpg", "caption": "Figure 4: Comparative experiments for randomly and the different number of divided environments.", "description": "This figure compares the out-of-distribution (OOD) accuracy of the proposed method against a random environment splitting method.  The results are shown for two datasets, ColoredMNIST and COCOPlaces. The proposed method demonstrates significantly better performance, indicating its effectiveness in partitioning environments for improved OOD generalization. The bars represent the average OOD accuracy and the error bars represent the standard deviations.", "section": "5.3 Ablation Studies"}, {"figure_path": "wQpNG9JnPK/figures/figures_8_2.jpg", "caption": "Figure 4: Comparative experiments for randomly and the different number of divided environments. (a) The method for selecting environments. (b) The number of environments to partition.", "description": "This figure compares the performance of the proposed method for environment partitioning against a random partitioning approach.  The left subplot (a) shows that using maximum likelihood probability for environment assignment (the proposed method) outperforms random assignment on both ColoredMNIST and COCOPlaces datasets. The right subplot (b) demonstrates that the optimal performance is achieved when the number of partitioned environments is close to the actual number of environments, further validating the effectiveness of the proposed environment division method.", "section": "5.3 Ablation Studies"}, {"figure_path": "wQpNG9JnPK/figures/figures_12_1.jpg", "caption": "Figure 1: Left Figure: A comparison between our approach and previous methods(conclude ERM and IRM-based methods). (a): The comparison of our method, the ERM method, and the IRM method based on the F-norm metric. (b): The comparison of our method, the ERM method, and the IRM method in terms of OOD accuracy (%).", "description": "This figure compares the proposed method against ERM and IRM-based methods using two metrics: F-norm and OOD accuracy.  The left panel (a) shows that the proposed method achieves a lower F-norm, indicating better alignment with the standard simplex ETF, a key aspect of neural collapse. The right panel (b) demonstrates superior OOD accuracy of the proposed method on the ColoredMNIST dataset.", "section": "3 Preliminaries"}]