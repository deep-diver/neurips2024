---
title: "Risk-Averse Fine-tuning of Large Language Models"
summary: "Risk-Averse RLHF fine-tunes LLMs to minimize toxic outputs while maintaining performance."
categories: []
tags: ["Natural Language Processing", "Large Language Models", "üè¢ Amazon",]
showSummary: true
date: 2024-09-26
draft: false
---

<br>

{{< keywordList >}}
{{< keyword icon="fingerprint" >}} 1BZKqZphsW {{< /keyword >}}
{{< keyword icon="writer" >}} Sapana Chaudhary et el. {{< /keyword >}}
 
{{< /keywordList >}}

{{< button href="https://openreview.net/forum?id=1BZKqZphsW" target="_blank" >}}
‚Üó OpenReview
{{< /button >}}
{{< button href="https://neurips.cc/virtual/2024/poster/96880" target="_blank" >}}
‚Üó NeurIPS Homepage
{{< /button >}}{{< button href="https://huggingface.co/spaces/huggingface/paper-central?tab=tab-chat-with-paper&paper_id=1BZKqZphsW&paper_from=neurips" target="_blank" >}}
‚Üó Chat
{{< /button >}}



<audio controls>
    <source src="https://ai-paper-reviewer.com/1BZKqZphsW/podcast.wav" type="audio/wav">
    Your browser does not support the audio element.
</audio>


### TL;DR


{{< lead >}}

Large Language Models (LLMs) are increasingly used, but they can generate harmful or toxic content, particularly in response to negative or toxic prompts.  This is a significant challenge, as it limits the safe and responsible deployment of LLMs in various applications.  Existing methods often focus on maximizing expected rewards, ignoring the risk of generating rare but significant harmful outputs. 

This research tackles this issue by introducing a novel Risk-Averse Reinforcement Learning from Human Feedback (RA-RLHF) approach.  **RA-RLHF optimizes the risk measure of Conditional Value at Risk (CVaR) to reduce toxic outputs**, focusing on the worst-case scenarios. The approach incorporates a soft-risk scheduling technique to make the training process more stable and effective. Empirical results on various tasks demonstrate that RA-RLHF significantly outperforms traditional methods by generating safer and more constructive online discourse, **while maintaining the effectiveness of the LLMs on generative tasks**.

{{< /lead >}}


#### Key Takeaways

{{< alert "star" >}}
{{< typeit speed=10 lifeLike=true >}} A novel risk-averse reinforcement learning from human feedback (RA-RLHF) method is introduced to mitigate the generation of toxic content by LLMs. {{< /typeit >}}
{{< /alert >}}

{{< alert "star" >}}
{{< typeit speed=10 startDelay=1000 lifeLike=true >}} RA-RLHF effectively reduces toxic outputs while maintaining the performance of LLMs on generative tasks, as demonstrated by experimental results on sentiment modification and toxicity mitigation. {{< /typeit >}}
{{< /alert >}}

{{< alert "star" >}}
{{< typeit speed=10 startDelay=2000 lifeLike=true >}} Soft-risk scheduling is proposed as a technique to improve the stability and convergence of RA-RLHF during training. {{< /typeit >}}
{{< /alert >}}

#### Why does it matter?
This paper is crucial for researchers working on **large language models (LLMs)** and **AI safety**. It introduces a novel risk-averse approach to fine-tuning LLMs, addressing the critical issue of generating harmful content.  The findings offer valuable insights for developing safer and more reliable LLMs, advancing current research in AI safety and ethics.  The soft-risk scheduling technique is particularly relevant for researchers working with risk-averse reinforcement learning.  This research opens avenues for future work in enhancing LLM safety, such as investigating different risk measures and applying these methods to other LLMs and tasks.

------
#### Visual Insights



![](https://ai-paper-reviewer.com/1BZKqZphsW/figures_1_1.jpg)

> This figure visualizes the changes in reward distribution and quantiles across different model training methods (SFT, RLHF, RA-RLHF) for the IMDB-Gen task.  The leftmost panel shows the distribution of rewards from the input prompts themselves. The next three panels depict the distributions of rewards obtained after the models generate continuations of the input prompts.  The final panel displays a quantile-quantile plot illustrating the average reward generated by each model as a function of the input prompt's toxicity quantile.  This allows for a comparison of the models' performance in avoiding toxic outputs while maintaining effectiveness in generative tasks.





![](https://ai-paper-reviewer.com/1BZKqZphsW/tables_1_1.jpg)

> This table provides example outputs generated by three different LLMs (Supervised Fine-Tuning, Reinforcement Learning from Human Feedback, and Risk-Averse Reinforcement Learning from Human Feedback) for both IMDB and Jigsaw datasets.  The examples are chosen from the tail of the prompt reward distribution which represents prompts that were most challenging to generate positive/non-toxic responses to.  The table demonstrates the different models' performance in successfully generating positive or non-toxic responses even when the input prompts were negative or toxic in nature.





### In-depth insights


#### Risk-Averse RLHF
The proposed approach, **Risk-Averse Reinforcement Learning from Human Feedback (RA-RLHF)**, innovatively addresses the challenge of mitigating harmful outputs from Large Language Models (LLMs).  Instead of the traditional risk-neutral RLHF, which maximizes expected reward, RA-RLHF incorporates risk-averse principles by optimizing the Conditional Value at Risk (CVaR). This focuses on minimizing the expected cost of the worst-case scenarios, effectively reducing the likelihood of generating toxic or negative content. **The key contribution lies in combining risk-averse RL with soft-risk scheduling, enabling the model to initially learn from diverse outputs before gradually focusing on mitigating hazardous responses.** This strategy prevents overemphasis on avoiding rare but significant negative outputs at the expense of overall performance, ultimately enhancing both safety and LLM effectiveness.  Furthermore,  RA-RLHF demonstrates robust performance across various tasks, including sentiment modification and toxicity mitigation, with quantitative evaluations proving superior results to standard RLHF and other baselines.  The results suggest that a carefully balanced approach to risk-averse RLHF, **incorporating both positive and negative training instances**, leads to more robust, safer, and more effective LLMs,  promising significant improvements in the development of responsible and aligned AI systems.

#### LLM Safety
Large language model (LLM) safety is a critical concern, focusing on mitigating the generation of harmful or undesirable outputs.  Current approaches often involve techniques like **reinforcement learning from human feedback (RLHF)**, which trains the models to align with human preferences. However, RLHF alone may not adequately address the issue of rare but significant toxic outputs. This is where risk-averse methods come into play.  **Risk-averse fine-tuning**, as explored in the provided research, aims to explicitly minimize the probability of generating toxic content, even if it means sacrificing some performance on other tasks. This approach shifts the focus from maximizing expected reward (a risk-neutral strategy) to minimizing the risk of catastrophic failures, a more safety-conscious approach.  By incorporating risk measures like Conditional Value at Risk (CVaR), these methods prioritize preventing the worst-case scenarios, leading to safer and more reliable LLMs. The research highlights the importance of **carefully balancing the exposure to both positive and high-risk situations** during training to effectively learn robust and safe policies.  Ultimately, LLM safety research necessitates a multi-faceted approach, encompassing both risk-averse training methodologies and ongoing efforts to identify and address the biases that can lead to unsafe generation.

#### RA-RLHF Algorithm
The core of the proposed approach lies in the **Risk-Averse Reinforcement Learning from Human Feedback (RA-RLHF) algorithm**.  This algorithm cleverly integrates risk-averse principles into the standard RLHF framework, moving beyond the traditional risk-neutral paradigm. Instead of solely maximizing expected rewards, RA-RLHF focuses on minimizing the Conditional Value at Risk (CVaR), thereby prioritizing the mitigation of rare but significant harmful outputs.  This is achieved by carefully balancing the exposure to both positive and negative or toxic training examples.  **A crucial element is the soft-risk scheduling**, which gradually introduces risk aversion during the training process, starting with a phase where the entire dataset is used before progressively focusing on riskier samples.  This strategy prevents premature convergence to suboptimal solutions and encourages learning from challenging scenarios.   The algorithm's efficacy is demonstrated by empirical results across various language generation tasks using different base LLMs, highlighting the **superior performance of RA-RLHF in avoiding toxic outputs while maintaining generation quality**. The introduction of risk-averse principles results in a more robust and safer LLM, showcasing a meaningful advancement over traditional RLHF methods.

#### Empirical Results
An Empirical Results section in a research paper would present quantitative findings that validate or refute the study's hypotheses.  It would likely begin by describing the experimental setup, including the datasets, models, and evaluation metrics employed.  Then, the core of the section would focus on presenting key results, often using tables and figures to compare the performance of different models or methods. **Statistical significance** should be clearly reported to establish the reliability of the findings.  A strong Empirical Results section would also include detailed analysis interpreting the results, **discussing trends**, and relating the outcomes to the study's overarching goals.  **Potential limitations** of the findings should be acknowledged, including any biases in the data or limitations in the methods used.  Ideally, the discussion section would connect the empirical results to the theoretical background, providing a holistic understanding of the study's implications.

#### Future Work
The authors acknowledge limitations in their risk-averse fine-tuning approach for LLMs, specifically mentioning the need for further investigation into its effectiveness across diverse domains and languages.  **Extending the methodology to question-answering tasks** is proposed as a crucial next step.  A key area for future work involves a deeper exploration of ethical considerations and potential biases inherent in LLMs, particularly concerning the unintended consequences of risk-averse training.  **Further research into alternative risk measures** and the development of more robust methods for mitigating the generation of harmful content are highlighted as essential.  The authors also emphasize the importance of developing broader alignment strategies that effectively balance safety and utility.  Finally, **investigating the scalability and resource requirements** of risk-averse RLHF for larger, more complex LLMs is recognized as a vital direction for future research.


### More visual insights

<details>
<summary>More on figures
</summary>


![](https://ai-paper-reviewer.com/1BZKqZphsW/figures_1_2.jpg)

> This figure visualizes the shift in reward distribution and quantile plot after fine-tuning a language model using three different methods: supervised fine-tuning (SFT), reinforcement learning from human feedback (RLHF), and risk-averse reinforcement learning from human feedback (RA-RLHF).  The left four subplots show the distribution of prompt scores (toxicity levels) for each method, illustrating how the distribution changes after fine-tuning. The rightmost subplot shows the average reward obtained at different quantiles of the prompt score distribution. This comparison helps to understand the effectiveness of each method in mitigating the generation of toxic content, especially for prompts with high toxicity levels.


![](https://ai-paper-reviewer.com/1BZKqZphsW/figures_7_1.jpg)

> This figure shows the tail sentiment scores for different models on the IMDB-Gen task. The tail refers to the most negative movie reviews.  The x-axis represents the different models: GPT-2, Prompted GPT-2, DExperts, SFT, RLHF, Quark, and RA-RLHF. The y-axis shows the average sentiment score for the tail reviews of each model. The goal is to evaluate how effectively each model mitigates negative sentiments, especially in challenging situations. The lower the sentiment score, the more negative the sentiment generated by the model.


![](https://ai-paper-reviewer.com/1BZKqZphsW/figures_9_1.jpg)

> This figure visualizes the performance of both RA-RLHF and RLHF algorithms across two datasets (IMDB-Gen and Jigsaw-Gen) during the training process.  It presents two sub-figures for each dataset: one showing the average environment reward per training iteration, and the other showing the return over the batch of episodes for each iteration.  The shaded areas likely represent the standard deviation or confidence intervals around the average reward, providing a measure of the variability or stability of the training process. The figure helps illustrate the difference between RA-RLHF (risk-averse RLHF) and standard RLHF approaches, showing how RA-RLHF might achieve different rewards and variability.


![](https://ai-paper-reviewer.com/1BZKqZphsW/figures_9_2.jpg)

> This figure visualizes the average environment rewards and per-batch returns during the training process for two different datasets: IMDB-Gen and Jigsaw-Gen.  Separate plots are shown for each dataset, with one plot displaying the average environment reward over training iterations and the other showing the per-batch returns (rewards obtained for each batch of training episodes). This allows for analysis of the training progress across different metrics and datasets, revealing how the average reward changes over time and how rewards per training batch fluctuates. The lines represent the RLHF and RA-RLHF training methods, and the shaded areas indicate the standard deviation or variability within the training results. The figure provides insight into the stability and effectiveness of each training algorithm.


![](https://ai-paper-reviewer.com/1BZKqZphsW/figures_9_3.jpg)

> This figure shows the IMDB risk schedule analysis. The x-axis represents the training iterations, while the y-axis represents the batch size. Different colored lines represent different risk schedules, which are defined by the parameters n, Œ±, and œÅ. These parameters control the rate at which the batch size is reduced during training, balancing the exploration of both positive and negative scenarios to achieve risk aversion. The figure illustrates how different choices of these hyperparameters affect the risk schedule, demonstrating the trade-off between risk-aversion and exploration.


![](https://ai-paper-reviewer.com/1BZKqZphsW/figures_15_1.jpg)

> This figure shows the distribution of environment rewards (sentiment scores) for training prompts in the IMDB dataset.  Panel (a) displays the distribution for all training prompts, while panel (b) focuses specifically on the distribution for prompts with low scores (the tail of the distribution).  The x-axis represents the environment reward (sentiment score), and the y-axis represents the number of prompts. The different colored sections show the number of positive and negative prompts in each bin. This visualization helps to understand the characteristics of the training data, particularly the distribution of difficult prompts (those with negative sentiment).


![](https://ai-paper-reviewer.com/1BZKqZphsW/figures_15_2.jpg)

> This figure shows the distribution of environment rewards (sentiment scores) for training prompts of size 200 characters (approximately 64 tokens) in the IMDB review dataset.  It consists of two subfigures: (a) shows the distribution for all training prompts, while (b) focuses on the distribution for prompts in the tail (those with the lowest scores). The distributions for positive and negative sentiment prompts are shown separately in each subfigure. This visualization helps understand the distribution of sentiment in the training data and the characteristics of the more challenging prompts.


![](https://ai-paper-reviewer.com/1BZKqZphsW/figures_16_1.jpg)

> This figure shows the results of a k-means cluster analysis performed on the embeddings of critical prompts from the Jigsaw test dataset.  The embeddings were generated using the EleutherAI/gpt-j-6b model.  The resulting clusters were then projected into two dimensions using PCA for visualization. Each point represents a prompt, and the color indicates the cluster to which it belongs.  The caption is short, so this description provides further context on the methodology and interpretation of the visualization.


![](https://ai-paper-reviewer.com/1BZKqZphsW/figures_18_1.jpg)

> This figure shows the distribution of environment rewards (sentiment scores) for the IMDB dataset training prompts.  Panel (a) displays the distribution of scores for all training prompts, while panel (b) focuses on the distribution of scores for the 'tail' prompts, which are the most negative ones. The x-axis represents the sentiment score, and the y-axis represents the number of prompts with that score. The distribution in (b) helps to highlight the concentration of the most challenging negative prompts.


![](https://ai-paper-reviewer.com/1BZKqZphsW/figures_19_1.jpg)

> This figure shows the distribution of environment rewards (scores) for test prompts in the Jigsaw dataset.  Panel (a) displays the distribution for all test prompts, while panel (b) focuses specifically on the 'tail' test prompts, which represent the most challenging or difficult cases for the model to handle. The x-axis represents the environment score, which reflects the toxicity level of the prompt, with higher scores indicating less toxicity.  The y-axis represents the number of input prompts with that given score. The separation of scores for toxic and non-toxic prompts allows for visualization of the model's performance in handling a range of prompt toxicity levels, from easy to very challenging.


![](https://ai-paper-reviewer.com/1BZKqZphsW/figures_19_2.jpg)

> This figure shows the result of k-means clustering performed on the embeddings of critical prompts from the Jigsaw test dataset.  The embeddings were generated using the EleutherAI/gpt-j-6b model. The clusters are then projected into a 2D space using PCA for visualization. Each point represents a prompt, and the color indicates the cluster it belongs to.  Analysis of the prompts within each cluster reveals distinct patterns in terms of their toxicity and the topics they address. For example, some clusters contain prompts exhibiting hate speech targeting specific groups, while others feature more general insults or toxic language. This visualization helps to understand the nature and diversity of toxic prompts encountered in the dataset, and aids in identifying potential areas for improvement in toxicity mitigation strategies.


![](https://ai-paper-reviewer.com/1BZKqZphsW/figures_23_1.jpg)

> This figure shows the different risk schedules used during training with RA-RLHF.  The x-axis represents the number of training iterations, and the y-axis represents the batch size used for training. Different lines represent different hyperparameter settings (n, alpha, rho) which control the rate at which the batch size decreases during training, introducing risk aversion gradually.


![](https://ai-paper-reviewer.com/1BZKqZphsW/figures_23_2.jpg)

> This figure displays the training performance of both RLHF and RA-RLHF methods across two datasets: IMDB-Gen and Jigsaw-Gen.  It consists of four subplots. The top row shows the average environment reward (a measure of overall performance) and the average per-batch return (a measure of reward variability during training) for the IMDB-Gen dataset. The bottom row shows the same metrics but for the Jigsaw-Gen dataset.  Each subplot shows the trajectories of both algorithms, allowing visual comparison of their performance. The plots reveal that RA-RLHF generally results in slightly lower average rewards but with reduced variance compared to RLHF, suggesting improved robustness and stability.


![](https://ai-paper-reviewer.com/1BZKqZphsW/figures_23_3.jpg)

> This figure shows the training progress of both RLHF and RA-RLHF methods on two datasets, IMDB-Gen and Jigsaw-Gen.  It displays the average environment reward and the reward per batch across training iterations. The plots visualize the stability and performance of each method, illustrating how the risk-averse approach (RA-RLHF) impacts the training dynamics. By comparing RLHF and RA-RLHF, we can observe the effects of the risk-averse strategy on reward accumulation and training stability.


![](https://ai-paper-reviewer.com/1BZKqZphsW/figures_24_1.jpg)

> This figure presents a comprehensive analysis of reward distribution shifts and quantile plots for the IMDB-Gen task. It visually compares the performance of three different models: Supervised Fine-Tuning (SFT), Reinforcement Learning from Human Feedback (RLHF), and Risk-Averse RLHF (RA-RLHF).  The leftmost four subplots display histograms showing the distribution of prompt scores for positive and negative reviews across the three models.  These histograms illustrate how the reward distributions shift after fine-tuning using each method. The final subplot is a quantile plot, showing average reward as a function of the quantile of prompt scores. This helps visualize the risk-aversion properties of each model, highlighting how well each model handles rare, high-stakes scenarios (prompts with extreme negative scores). The results indicate that RA-RLHF is more effective in promoting safer, more constructive online discourse by shifting the reward distribution towards more positive outcomes, especially for challenging, high-risk prompts.


![](https://ai-paper-reviewer.com/1BZKqZphsW/figures_25_1.jpg)

> This figure visualizes the impact of different fine-tuning methods on the distribution of rewards in the IMDB-Gen environment.  It shows histograms of the reward distribution for prompts and their completions using Supervised Fine-Tuning (SFT), Reinforcement Learning from Human Feedback (RLHF), and Risk-Averse RLHF (RA-RLHF).  A quantile plot is also included, showing the average reward versus the prompt quantile. The goal is to show how well each method avoids generating negative or toxic content by shifting the reward distribution towards positive outcomes, particularly for the most challenging (riskiest) prompts.


</details>




<details>
<summary>More on tables
</summary>


![](https://ai-paper-reviewer.com/1BZKqZphsW/tables_7_1.jpg)
> This table presents the quantitative performance results of different LLMs on the IMDB-Gen task. It compares the sentiment scores (Senti), perplexity (PP), and diversity scores (Dist-1, Dist-2, Dist-3) for various models, including the baseline GPT-2,  Prompted GPT-2 (with added prompt for positive sentiment), DExperts, Supervised Fine-tuning (SFT), Reinforcement Learning from Human Feedback (RLHF), Quark, and the proposed Risk-Averse RLHF (RA-RLHF). Higher sentiment scores indicate more positive reviews, lower perplexity suggests better coherence, and higher diversity scores reflect a more varied range of generated text.  The results illustrate the comparative performance of the different methods in balancing positive sentiment generation with text quality and diversity.

![](https://ai-paper-reviewer.com/1BZKqZphsW/tables_8_1.jpg)
> This table presents the performance of different models on two tasks: Jigsaw-Gen and RealToxicityPrompts-Gen.  The models are evaluated based on negative toxicity scores (-Tox), and diversity metrics (Dist-1, Dist-2, Dist-3).  Higher -Tox scores indicate better performance in mitigating toxicity.  Diversity metrics assess the variety of text generated by each model. The table allows comparison of several baselines (GPT-2, Prompted, DExperts, SFT, RLHF, Quark) with the proposed RA-RLHF method.

![](https://ai-paper-reviewer.com/1BZKqZphsW/tables_8_2.jpg)
> This table presents the results of the IMDB (GPT-J) experiment. The table shows the average reward and perplexity for different models: GPT2, GPTJ, SFT, RLHF, and RA-RLHF (the proposed method). The average reward indicates how well the model performed on the IMDB sentiment classification task. The perplexity metric shows the model's ability to generate coherent text.

![](https://ai-paper-reviewer.com/1BZKqZphsW/tables_16_1.jpg)
> This table displays example outputs generated by different LLMs (Supervised Fine-Tuning (SFT), Reinforcement Learning from Human Feedback (RLHF), and Risk-Averse RLHF (RA-RLHF)) for both IMDB-Gen and Jigsaw-Gen datasets.  The examples are chosen from the tail of the prompt reward distribution, representing challenging prompts that are more likely to produce negative or toxic outputs. The table shows how RA-RLHF improves the models' ability to avoid generating such outputs while maintaining effectiveness in generative tasks.

![](https://ai-paper-reviewer.com/1BZKqZphsW/tables_21_1.jpg)
> This table shows example outputs generated by three different LLMs (Supervised Fine-Tuning, Reinforcement Learning from Human Feedback, and Risk-Averse Reinforcement Learning from Human Feedback) in response to prompts with negative sentiment scores.  The goal is to illustrate how the risk-averse model performs better at generating less toxic content in response to difficult prompts, showing its effectiveness in sentiment modification and toxicity mitigation.

![](https://ai-paper-reviewer.com/1BZKqZphsW/tables_21_2.jpg)
> This table shows example outputs generated by three different models (SFT, RLHF, and RA-RLHF) for a selection of prompts with negative or toxic characteristics.  The goal is to illustrate how the risk-averse fine-tuning method (RA-RLHF) improves the safety and quality of the generated text compared to the other methods.  The table includes the prompt, the generated text for each model, and a score indicating the negativity or toxicity of the prompt. 

![](https://ai-paper-reviewer.com/1BZKqZphsW/tables_21_3.jpg)
> This table displays example outputs generated by three different LLMs (Supervised Fine-Tuning (SFT), Reinforcement Learning from Human Feedback (RLHF), and Risk-Averse RLHF (RA-RLHF)) for both IMDB-Gen and Jigsaw-Gen datasets. The prompts used are those with the lowest reward scores (representing the most challenging cases). The table demonstrates how RA-RLHF effectively steers the generated text towards more positive and less toxic outputs compared to the other LLMs, particularly for difficult prompts.

![](https://ai-paper-reviewer.com/1BZKqZphsW/tables_21_4.jpg)
> This table provides example outputs generated by three different models (SFT, RLHF, and RA-RLHF) for both IMDB-Gen and Jigsaw-Gen datasets.  The examples shown are specifically selected from the tail of the prompt reward distribution, meaning these are prompts that are particularly challenging or likely to elicit negative or toxic responses. Each row shows a prompt, followed by the responses generated by the three models, along with the corresponding reward score for each response.  This highlights the models' performance in handling difficult prompts and illustrates the differences in outputs between the various approaches. The different models represent different approaches to training an LLM, showing how risk-averse fine-tuning can improve the ability of an LLM to avoid generating toxic content.

![](https://ai-paper-reviewer.com/1BZKqZphsW/tables_22_1.jpg)
> This table lists the hyperparameters used for Proximal Policy Optimization (PPO) training in the RLHF (Reinforcement Learning from Human Feedback) experiments.  It shows the values used for both the IMDB-Gen and Jigsaw-Gen tasks.  Hyperparameters not listed here were set to the default values provided by Hugging Face's PPOConfig object.

![](https://ai-paper-reviewer.com/1BZKqZphsW/tables_23_1.jpg)
> This table lists the hyperparameters used in the Risk-Averse Reinforcement Learning from Human Feedback (RA-RLHF) algorithm.  Specifically, it shows the risk level (Œ±), the warm start (n), and the œÅ parameter for both the IMDB-Gen and Jigsaw-Gen datasets. These parameters control the risk-aversion strategy during the fine-tuning process. The risk level determines the quantile of worst-case returns considered during optimization; the warm start determines the initial training phase without risk-aversion; and the œÅ parameter affects the rate of risk-aversion introduction.

![](https://ai-paper-reviewer.com/1BZKqZphsW/tables_24_1.jpg)
> This table presents the performance of different models on the IMDB dataset using GPT-J.  It shows the average reward, the average reward for the worst-performing prompts (tail), and the perplexity.  The results are based on a single seed.  Higher reward values indicate better performance in terms of generating positive reviews while lower perplexity suggests higher quality of generated text.

![](https://ai-paper-reviewer.com/1BZKqZphsW/tables_25_1.jpg)
> This table presents the quantitative performance results for the RealToxicityPrompts-Gen task.  It shows the average reward, the average reward on tail prompts (those with high toxicity), and the perplexity for four different models: the baseline GPT2 model, a model fine-tuned using supervised learning (SFT), a model fine-tuned using standard RLHF, and the proposed RA-RLHF model.  The metrics are used to compare the performance of the models in terms of both the overall reward and the ability to handle toxic prompts effectively.

</details>




### Full paper

{{< gallery >}}
<img src="https://ai-paper-reviewer.com/1BZKqZphsW/1.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="https://ai-paper-reviewer.com/1BZKqZphsW/2.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="https://ai-paper-reviewer.com/1BZKqZphsW/3.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="https://ai-paper-reviewer.com/1BZKqZphsW/4.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="https://ai-paper-reviewer.com/1BZKqZphsW/5.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="https://ai-paper-reviewer.com/1BZKqZphsW/6.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="https://ai-paper-reviewer.com/1BZKqZphsW/7.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="https://ai-paper-reviewer.com/1BZKqZphsW/8.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="https://ai-paper-reviewer.com/1BZKqZphsW/9.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="https://ai-paper-reviewer.com/1BZKqZphsW/10.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="https://ai-paper-reviewer.com/1BZKqZphsW/11.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="https://ai-paper-reviewer.com/1BZKqZphsW/12.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="https://ai-paper-reviewer.com/1BZKqZphsW/13.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="https://ai-paper-reviewer.com/1BZKqZphsW/14.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="https://ai-paper-reviewer.com/1BZKqZphsW/15.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="https://ai-paper-reviewer.com/1BZKqZphsW/16.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="https://ai-paper-reviewer.com/1BZKqZphsW/17.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="https://ai-paper-reviewer.com/1BZKqZphsW/18.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="https://ai-paper-reviewer.com/1BZKqZphsW/19.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="https://ai-paper-reviewer.com/1BZKqZphsW/20.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
{{< /gallery >}}