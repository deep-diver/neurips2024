[{"type": "text", "text": "Gradient-free Decoder Inversion in Latent Diffusion Models ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Seongmin Hong1 Suh Yoon Jeon1 Kyeonghyun Lee1 Ernest K. Ryu2,\u2217 Se Young Chun1,3,\u2217 ", "page_idx": 0}, {"type": "text", "text": "1Dept. of Electrical and Computer Engineering, 3INMC & IPAI, Seoul National University 2Dept. of Mathematics, University of California, Los Angeles   \n{smhongok, euniejeon, litiphysics, sychun}@snu.ac.kr, eryu@math.ucla.edu Project page: https://smhongok.github.io/dec-inv.html ", "page_idx": 0}, {"type": "text", "text": "Abstract ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "In latent diffusion models (LDMs), denoising diffusion process efficiently takes place on latent space whose dimension is lower than that of pixel space. Decoder is typically used to transform the representation in latent space to that in pixel space. While a decoder is assumed to have an encoder as an accurate inverse, exact encoder-decoder pair rarely exists in practice even though applications often require precise inversion of decoder. In other words, encoder is not the left-inverse but the right-inverse of the decoder; decoder inversion seeks the left-inverse. Prior works for decoder inversion in LDMs employed gradient descent inspired by inversions of generative adversarial networks. However, gradient-based methods require larger GPU memory and longer computation time for larger latent space. For example, recent video LDMs can generate more than 16 frames, but GPUs with $24\\ \\mathrm{GB}$ memory can only perform gradient-based decoder inversion for 4 frames. Here, we propose an efficient gradient-free decoder inversion for LDMs, which can be applied to diverse latent models. Theoretical convergence property of our proposed inversion has been investigated not only for the forward step method, but also for the inertial Krasnoselskii-Mann (KM) iterations under mild assumption on cocoercivity that is satisfied by recent LDMs. Our proposed gradient-free method with Adam optimizer and learning rate scheduling significantly reduced computation time and memory usage over prior gradient-based methods and enabled efficient computation in applications such as noise-space watermarking and background-preserving image editing while achieving comparable error levels. ", "page_idx": 0}, {"type": "text", "text": "1 Introduction ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Deep generative models have been actively investigated over the past decade across numerous modalities such as image [12, 41, 42, 37, 11, 35, 38], video [5, 4, 47, 52, 45, 46], audio [18, 21, 22] and molecular structure [17, 13]. They can sample new data points from the distribution of the training set, can model priors to solve regression problems, and can be used for applications like editing, retrieval, and density estimation. Representative classes of deep generative models include generative adversarial networks (GANs), variational autoencoders (VAEs), normalizing flows (NFs), and diffusion models (DMs). They used to be known not to simultaneously satisfy the three key requirements: (i) high-quality samples, (ii) diversity, and (iii) fast sampling, also referred to as the generative learning trilemma [50]. However, recent DMs such as Rectified Flow [23], Adversarial Diffusion Distillation [40] and Consistency models [43] require just one step for sampling. Thus, ", "page_idx": 0}, {"type": "table", "img_path": "nbqvjkOs6S/tmp/e574c2a5b200afe824dad325a76f9413927540710c772d5f5f1f4f18c5589240.jpg", "table_caption": ["Table 1: Comparison of deep generative models. DMs have overcome the generative learning trilemma [50], but they still lack invertibility compared to other models. In particular, LDMs have necessitated additional decoder inversion that has traditionally been addressed through memoryintensive and time-consuming gradient-based optimization methods. Here, we propose a method for efficiently (i.e., gradient-free) ensuring invertibility in LDM. "], "table_footnote": [], "page_idx": 1}, {"type": "text", "text": "DMs have overcome the trilemma and the old problem of slow sampling in recent DMs is no longer a concern as shown in the last row of Table 1. As a result, DMs have become one of the most prominent deep generative models, especially for image and video. However, there are still remaining challenges for DMs such as achieving invertibility, which is well-supported by other models (see Table 1). ", "page_idx": 1}, {"type": "text", "text": "Achieving invertibility for deep generative models has been an important topic. In GANs, prior works proposed GAN inversion techniques [49] (i.e., to find the latent vector $_{\\textit{z}}$ that generated the image) and their applications such as real image editing [1]. NFs are naturally invertible deep generative models by construction with related interesting applications [17]. There have also been attempts to achieve and utilize invertibility for DMs. The most popular one is the na\u00efve DDIM inversion that reverses the sampling process of DDIM\u2019s deterministic denoising [41], i.e., adding the estimated noise. While the na\u00efve DDIM inversion enables image editing, it is known to be somewhat inaccurate for seeking the true latent [14], for watermarking [48] and for background-preserving image editing [32]. To better ensure the exactness of the inversion, several prior works [44, 51, 31, 14, 10] have proposed more tailored algorithms than the na\u00efve DDIM inversion. ", "page_idx": 1}, {"type": "text", "text": "The use of latents in DMs has made ensuring invertibility more difficult. Latent diffusion models (LDMs) were proposed to move the diffusion denoising process from the pixel space to the (lowdimensional) latent space, thus efficiently generating high-quality and large-scale samples [37]. This issue may be critical since many recent popular DMs operate in latent space [37, 47, 52, 27, 40, 45, 5]. However, latents are usually lossy compression of pixels, making one-to-one mapping between the latent and pixel spaces very challenging. Thus, the accuracy of inversion in LDMs is typically lower than that in pixel-space [44, 31, 14], requiring additional efforts to compensate for it as illustrated in Figure 1b. One could na\u00efvely employ a gradient-based GAN inversion method to the decoder of LDMs, but it required very large GPU memory and computation time [14], especially for large-scale LDMs. Moreover, recent video LDMs [5, 4, 47, 52, 45, 46] generate dozens of frames at once, making gradient-based GAN inversion infeasible in a single GPU. ", "page_idx": 1}, {"type": "text", "text": "In this work, we aim to achieve better invertibility in LDM as shown in Table 1. Specifically, we propose decoder inversion to overcome the difficulty of ensuring invertibility in LDM due to the inexact encoder-decoder pair. The proposed decoder inversion is gradient-free, which is faster and more memory-efficient than the gradient-based methods suggested in GAN inversion. Section 3 describes the motivation and analysis of our decoder inversion, including the theoretical convergence guarantee under mild assumption not only for the vanilla forward step method, but also for the inertial Krasnoselskii-Mann (KM) iterations. The assumption for our theorems is also validated by showing experimental convergence to the ground truth as well as the effectiveness of momentum. Section 4 described how to refine our algorithm by integrating popular optimization techniques such as Adam [16] and learning rate scheduling as practical extensions of our gradient-free decoder inversion, demonstrating that our method works well on various latest LDMs compared to existing gradientbased methods. Lastly, Section 5 showcases interesting applications (noise space watermarking and background-preserving image editing) where our proposed gradient-free decoder inversion can be effectively utilized. The contributions of this work are: ", "page_idx": 1}, {"type": "image", "img_path": "nbqvjkOs6S/tmp/fdced050081f892e3a10ef86a1bea12af5da8904f65bb77d381a84ab835f43d1.jpg", "img_caption": ["(a) LDM vs Pixel-space DM "], "img_footnote": [], "page_idx": 2}, {"type": "image", "img_path": "nbqvjkOs6S/tmp/af6fa499643c501f658876ac22d9861f4f194bbc333de8e0b5f37bbd57af79a8.jpg", "img_caption": ["(b) Invertibility of generative models "], "img_footnote": [], "page_idx": 2}, {"type": "text", "text": "Figure 1: (a) The difference between LDM and pixel-space DM lies in the use of the decoder $(\\mathcal{D})$ . (b) This difference has caused the performance gap in exact inversions. Pixel-space DMs and gradientbased GAN inversion methods are located on the right side due to iterative gradient back-propagations. If gradient-based decoder inversions are used, which are computationally intensive, LDM is located on the rightmost side to address the lossiness of latents. Our proposed gradient-free decoder inversion method allows us to efficiently handle the transformation between latent and pixel spaces. ", "page_idx": 2}, {"type": "text", "text": "\u2022 proposing a gradient-free decoder inversion algorithm to achieve better invertibility in diverse latest LDMs. Our method has the following advantages with experimental evidences: \u2013 Fast: up to $5\\times$ faster, 1.89 s vs 9.51 s to achieve -16.4 dB (Fig. 3c and Tab. S1c) \u2013 Accurate: up to $2.3\\;\\mathrm{dB}$ lower, -21.37 dB vs -19.06 dB in 25.1 s (Fig. 3b and Tab. S1b) \u2013 Memory-efficient: up to ${\\bf{89}}\\,\\%$ can be saved, 7.13 GB vs 64.7 GB (Fig. 3b) \u2013 Precision-flexible: 16-bit vs 32-bit (Fig. 3)   \n\u2022 theoretically guaranteeing the convergence to the ground truth not only for the vanilla forward step method, but also for the inertial KM iterations,   \n\u2022 showcasing that our proposed gradient-free decoder inversion can be used in interesting applications. ", "page_idx": 2}, {"type": "text", "text": "2 Backgrounds ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "2.1 Latent diffusion models (LDMs) ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "Stable Diffusion 2.1 [37] is a widely known open-source text-to-image generation model. LaVie [47] is a text-conditioned video generation model, which can generate consecutive frames per inference. InstaFlow [24] is a one-step text-to-image generation model that can generate images whose quality is as good as Stable Diffusion. These three LDMs will be used in all the experiments of our work. ", "page_idx": 2}, {"type": "text", "text": "Exact inversion of accelerated DMs. Another factor that makes the exact inversion of DMs difficult, besides the use of latents, is acceleration. Due to the use of high-order ODE solvers, the exact inversion of DPM-Solvers [25, 26] is not as straightforward as in DDIM. Exact inversion algorithms for some DPM-Solvers have been proposed [14], but obtaining the exact inverses for other accelerated DMs [23, 40, 43, 24] has not been explored. ", "page_idx": 2}, {"type": "text", "text": "2.2 Optimization-based GAN inversion ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "For a target image $\\textbf{\\em x}$ , existing optimization-based GAN inversion methods typically perform the following optimization with respect to a latent vector $_{\\textit{z}}$ (usually assumed to lie on a simple distribution such as ${\\bar{\\mathcal{N}}}(0,1),$ : ", "page_idx": 2}, {"type": "equation", "text": "$$\n\\operatorname*{min}_{z}\\quad\\ell({\\pmb x},{\\mathcal G}({\\pmb z})),\n$$", "text_format": "latex", "page_idx": 2}, {"type": "text", "text": "where $\\ell$ is a distance metric and $\\mathcal{G}$ is the generator part of GAN [49]. Most works solve Eq. (1) through backpropagation with an optimizer. For optimizers, Adam [16] is employed in [1], and ", "page_idx": 2}, {"type": "text", "text": "L-BFGS [20] is employed in [54]. Some more recent works optimized the transformed latent feature $\\pmb{w}$ , which can be defined as $w=\\mathbf{M}\\mathbf{L}\\mathbf{P}(z)$ , in StyleGAN [15]. ", "page_idx": 3}, {"type": "text", "text": "To exploit the prior knowledge that $_{z}$ lies on the range space of an encoder, prior works often perform the following two methods: ", "page_idx": 3}, {"type": "text", "text": "(A) The output of the encoder $\\mathcal{E}$ is used as an initial point of the optimization process. (B) The domain-guided encoder is used to regularize the latent code within the semantic domain of the generator. For example, $\\operatorname*{min}_{z}\\|x-\\mathcal{G}(z)\\|_{2}+\\lambda_{\\mathrm{reg}}\\|z-\\mathcal{E}(\\mathcal{G}(z))\\|_{2}$ . ", "page_idx": 3}, {"type": "text", "text": "Since we already have the encoder, we employ (A), too. On the other hand, we will utilize the encoder in a novel way over (B). ", "page_idx": 3}, {"type": "text", "text": "2.3 Gradient-based decoder inversion in LDMs ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "Recent works [14] performed the same as Eq. (1) (hence they are iterative as illustrated in Figure 1b) for the decoder inversion: ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\operatorname*{min}_{z_{0}}\\quad\\ell({\\pmb x},{\\mathcal{D}}({\\pmb z}_{0})),\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "with a gradient-based method. For simplicity, we omit the subscript by setting $z_{\\mathrm{0}}=z$ . The vanilla gradient descent algorithm can be expressed as follows: ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\boldsymbol{z}^{k+1}=\\boldsymbol{z}^{k}-\\rho\\nabla_{\\boldsymbol{z}}\\ell(\\boldsymbol{x},\\mathcal{D}(\\boldsymbol{z}^{k})).\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "Advancements in backpropagation algorithms and libraries have made the computation of $\\nabla_{z}\\mathcal{D}(z^{k})$ more efficient, but it still requires a significant amount of GPU memory usage and lengthy runtime compared to inference. As the size of generated outputs of recent LDMs continues to increase, the computation of $\\nabla_{z}\\mathcal{D}(z^{k})$ through backpropagation is getting more and more burdensome. ", "page_idx": 3}, {"type": "text", "text": "3 Gradient-free decoder inversion in LDMs ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "In this work, as an alternative method to Eq. (3), we propose the following decoder inversion method, which is a form of the forward step method [39]: ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\pmb{z}^{k+1}=\\pmb{z}^{k}-\\rho(\\mathcal{E}(\\mathcal{D}(\\pmb{z}^{k}))-\\mathcal{E}(\\pmb{x})),\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "where the initial latent vector estimate ${\\pmb z}^{0}=\\mathcal{E}({\\pmb x})$ that is the same as (A) in Section 2.2. ", "page_idx": 3}, {"type": "text", "text": "3.1 Motivation ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "The definition of the decoder inversion problem for the given image $\\textbf{\\em x}$ is as follows: ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\operatorname{find}_{z\\in\\mathbb{R}^{F}}\\quad x=D(z).\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "Since directly dealing with Eq. (5) is impractical, we relax it as solving the following problem: ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\operatorname{find}_{z\\in\\mathbb{R}^{F}}\\quad{\\mathcal{E}}(x)={\\mathcal{E}}({\\mathcal{D}}(z)).\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "The following Remark 1 demonstrates that solving Eq. (6) is easier than solving Eq. (5). ", "page_idx": 3}, {"type": "text", "text": "Remark 1 (Eq. (6) is easier than Eq. (5)). $\\{z|x={\\mathcal{D}}(z)\\}\\subset\\{z|{\\mathcal{E}}(x)={\\mathcal{E}}({\\mathcal{D}}(z))\\}.$ ", "page_idx": 3}, {"type": "text", "text": "Remark 1 is true because $\\pmb{x}=\\mathcal{D}(\\pmb{z})\\Rightarrow\\pmb{\\mathcal{E}}(\\pmb{x})=\\pmb{\\mathcal{E}}(\\mathcal{D}(\\pmb{z}))$ . Equation (6) is equivalent to the following: ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{\\underset{z\\in\\mathbb{R}^{F}}{\\mathrm{find}}}&{{}z=z-\\rho(\\mathcal{E}(\\mathcal{D}(z))-\\mathcal{E}(\\pmb{x})),\\quad\\forall\\rho\\in\\mathbb{R}\\cap\\{0\\}^{C}}\\end{array}\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "where Eq. (7) refers to finding a fixed point of an operation $\\mathcal{T}-\\rho(\\mathcal{E}(\\mathcal{D}(\\cdot))-\\mathcal{E}(\\pmb{x}))$ whose another form is Eq. (4), the forward step method. ", "page_idx": 3}, {"type": "text", "text": "3.2 Convergence analysis on forward step method ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "Here, we demonstrate that our method converges to a fixed-point under reasonable conditions. Furthermore, although we solved an easier problem represented by Eq. (6) rather than directly solving Eq. (5), we show that our proposed method surprisingly finds the true solution of Eq. (6). ", "page_idx": 4}, {"type": "text", "text": "Theorem 1 (Convergence of the forward step method). Let $\\beta\\,>\\,0$ , $0\\,<\\,\\rho\\,<\\,2\\beta$ , and $\\pmb{x}\\,\\in\\,\\mathbb{R}^{N}$ . Assume $\\boldsymbol{\\mathcal{T}}(\\cdot)=\\boldsymbol{\\mathcal{E}}\\circ\\boldsymbol{\\mathcal{D}}(\\cdot)-\\boldsymbol{\\mathcal{E}}(\\mathbf{\\boldsymbol{\\mathscr{x}}})$ is continuous. Consider the iteration ", "page_idx": 4}, {"type": "equation", "text": "$$\nz^{k+1}=z^{k}-\\rho T z^{k}\\qquad f o r\\quad k=0,1,\\dots\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "Assume $z^{\\star}$ is a zero of $\\tau$ (i.e., $\\begin{array}{r}{\\boldsymbol{\\tau}_{\\boldsymbol{z}^{\\star}}=\\boldsymbol{0}_{\\!_{\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!$ ) and ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\langle\\mathcal T z^{k},z^{k}-z^{\\star}\\rangle\\geq\\beta\\|\\mathcal T z^{k}\\|_{2}^{2}\\;\\;\\;f o r\\;\\;\\;k=0,1,\\ldots.\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "Then, $\\boldsymbol{\\mathcal{T}}\\boldsymbol{z}^{k}\\rightarrow\\boldsymbol{0}$ . If, furthermore, $z^{k}\\to z^{\\infty}$ , then $z^{\\infty}$ is a zero of $\\tau$ (i.e., $\\begin{array}{r}{\\mathcal{T}z^{\\infty}=0,}\\end{array}$ ). ", "page_idx": 4}, {"type": "text", "text": "Proof outline. Equation (9) makes $\\|z^{k+1}-z^{\\star}\\|_{2}^{2}\\leq\\|z^{k}-z^{\\star}\\|_{2}^{2}-\\rho(2\\beta-\\rho)\\|\\mathcal{T}z^{k}\\|_{2}^{2}$ . Then, sum for $k=0,\\ldots,\\infty$ . \u53e3 ", "page_idx": 4}, {"type": "text", "text": "Theorem 1 assumes that Eq. (9) holds, which is refered as $\\beta.$ -cocoercivity. The assumption makes sense because we expect $\\mathcal{E D}\\simeq\\mathcal{T}$ . In fact, for linear autoencoders, it is proven by Baldi and Hornik [3] that $\\mathcal E\\mathcal D=\\mathcal T$ as the following Remark 2: ", "page_idx": 4}, {"type": "text", "text": "Remark 2 ( $E D={\\mathcal{T}}$ in linear autoencoders). Let $\\pmb{x}\\in\\mathbb{R}^{N}$ be a random vector such that $\\mathbb{E}[{\\pmb x}{\\pmb x}^{\\intercal}]=$ $\\boldsymbol{\\Sigma}\\in\\mathbb{R}^{N\\times N}$ . Assume $\\Sigma$ has distinct positive eigenvalues. Consider the optimization problem ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{m i n}&{{\\mathbb{E}}_{\\pmb{x}}\\,\\|{\\pmb{x}}-D E{\\pmb{x}}\\|_{2}^{2}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "Then, $E D=I$ (identity matrix).", "page_idx": 4}, {"type": "text", "text": "$\\mathcal{T}$ is 1-cocoercive, which suggests that our assumption is reasonable. In Section 3.4, we further demonstrate that the assumption is reasonable experimentally and $z^{k}$ actually converges well. ", "page_idx": 4}, {"type": "text", "text": "3.3 Convergence analysis on momentum for acceleration ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "Momentum is widely used in optimization to keep the optimization process going in the right direction, even when gradients are noisy or the landscape is flat. Among many momentum algorithms, we employ the inertial Krasnoselskii-Mann (KM) iteration [19, 28, 29] and analyze it since the convergence is guaranteed with some assumptions [29]. The inertial KM iteration in our setting can be defined as follows: ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\begin{array}{c}{{{\\pmb y}^{k}={\\pmb z}^{k}+\\alpha({\\pmb z}^{k}-{\\pmb z}^{k-1})}}\\\\ {{{\\pmb z}^{k+1}={\\pmb y}^{k}-2\\lambda\\beta T{\\pmb y}^{k},}}\\end{array}\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "where $\\begin{array}{r}{\\mathcal{T}(\\cdot)=\\mathcal{E}\\circ\\mathcal{D}(\\cdot)-\\mathcal{E}(\\pmb{x})}\\end{array}$ , $0<\\alpha<1$ , $\\beta>0$ , and $\\lambda>0$ . ", "page_idx": 4}, {"type": "text", "text": "We now present Theorem 2, ensuring that the inertial KM iterations converge. While the formulation and assumptions differ from [29], the theorem and its proof heavily rely on it. ", "page_idx": 4}, {"type": "text", "text": "Theorem 2 (Convergence of the inertial KM iterations). Let $0<\\alpha<1$ , $\\beta>0$ , $\\lambda>0$ and $\\pmb{x}\\in\\mathbb{R}^{N}$ . Assume $\\begin{array}{r}{\\pmb{\\mathcal{T}}(\\cdot)=\\pmb{\\mathcal{E}}\\circ\\pmb{\\mathcal{D}}(\\cdot)-\\pmb{\\mathcal{E}}(\\pmb{x})}\\end{array}$ is continuous. Let $(z^{k},y^{k})$ satisfy $(I O)$ and $(I I)$ . Assume $z^{\\star}$ is $a$ zero of $\\tau$ (i.e., $\\begin{array}{r}{\\boldsymbol{\\tau}_{\\boldsymbol{z}^{\\star}}=\\boldsymbol{0}_{\\!_{\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!$ ) and the following holds: ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\langle\\mathcal T y^{k},\\pmb y^{k}-\\pmb z^{\\star}\\rangle\\geq\\beta\\|\\mathcal T\\pmb y^{k}\\|_{2}^{2}\\;\\;\\;f o r\\quad k=0,1,\\ldots.\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "If ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\lambda(1-\\alpha+2\\alpha^{2})<(1-\\alpha)^{2},\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "then the followings are true: ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\sum_{k\\geq1}\\|z^{k+1}-2z^{k}+z^{k-1}\\|^{2},\\sum_{k\\geq1}\\|z^{k}-z^{k-1}\\|^{2}a n d\\sum_{k\\geq1}\\|\\mathcal{T}y^{k}\\|^{2}\\;c o n v e r g e.}\\end{array}\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "(B) There is a constant M > 0 such that min1\u2264k\u2264n \u2225T yk\u22252 \u2264M\u2225z1n\u2212z\u22c6\u22252. ", "page_idx": 4}, {"type": "text", "text": "(C) $\\begin{array}{r}{\\operatorname*{lim}_{k\\to\\infty}\\|z^{k}-z^{\\star}\\|}\\end{array}$ exists. ", "page_idx": 4}, {"type": "text", "text": "Here, similar to Theorem 1, the convergence of $\\big(z^{k}\\big)$ is guaranteed for a learning rate $(i.e.,\\,2\\lambda\\beta)$ smaller than some upper bound. However, unlike Theorem 1, this upper bound is determined not only by cocoercivity $(i.e.,\\beta)$ , but also by the inertial parameter $(i.e.,\\alpha)$ . ", "page_idx": 5}, {"type": "text", "text": "3.4 Validation of the assumption ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "In Theorems 1 and 2, we utilized the assumption that $\\boldsymbol{\\mathcal{T}}(\\cdot)=\\boldsymbol{\\mathcal{E}}\\circ\\boldsymbol{\\mathcal{D}}(\\cdot)-\\boldsymbol{\\mathcal{E}}(\\boldsymbol{x})$ is $\\beta$ -cocoercive for the $({\\boldsymbol{y}}^{k},z^{k})$ and $z^{\\star}$ . In this section, we experimentally investigate whether this assumption holds for the actual $\\big(\\boldsymbol{z}^{k}\\big)$ and $z^{\\infty}$ obtained in the experiments of Section 4, i.e., ", "page_idx": 5}, {"type": "equation", "text": "$$\n\\frac{\\langle\\mathcal{E}\\mathcal{D}z^{\\infty}-\\mathcal{E}\\mathcal{D}z^{k},z^{\\infty}-z^{k}\\rangle}{\\|\\mathcal{E}\\mathcal{D}z^{\\infty}-\\mathcal{E}\\mathcal{D}z^{k}\\|_{2}^{2}}\\geq\\beta>0.\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "Equations (9) and (12) are equivalent to Eq. (14) if $z^{\\star}=z^{\\infty}$ and $z^{k}=y^{k}$ . By (C) and (D) of Theorem 2, if Eq. (14) holds while $z^{k}\\to z^{\\star}$ , then the convergence was due to Eq. (14). ", "page_idx": 5}, {"type": "text", "text": "We conducted decoder inversion experiments in various recent LDMs such as Stable Diffusion 2.1 [37], LaVie [47], and InstaFlow [24]. With or without momentum, the learning rate $\\rho$ was fixed at 0.001. For inertial KM iterations, $\\alpha$ was set to 0.9. Figure 2 illustrates the $\\mathrm{min}_{k}$ of cocoercivity (14), convergence of the algorithm $(\\|z^{100}-z^{\\infty}\\|_{2})$ , and final NMSE $(\\|z^{\\infty}-z^{\\star}\\|_{2}^{2}/\\|z^{\\star}\\|_{2}^{2})$ for 100 instances in each scenario. The observations and the resulting insights are as follows, and they support the validity of our assumptions and theorems. ", "page_idx": 5}, {"type": "text", "text": "1. Our assumption on cocoercivity is reasonable: most of the instances showed $\\begin{array}{r}{\\frac{\\langle\\mathcal{E}D z^{\\infty}-\\mathcal{E}D z^{\\bar{k}},z^{\\infty}-z^{k}\\rangle}{\\|\\mathcal{E}D z^{\\infty}-\\mathcal{E}D z^{k}\\|_{2}^{2}}>0}\\end{array}$ for all $k$ .   \n2. The better the convergence, the more cocoercive it is: the ftited functions (red lines) have negative slopes.   \n3. Converging instances closely approximate the ground truth: the points at the bottom are darker. ", "page_idx": 5}, {"type": "image", "img_path": "nbqvjkOs6S/tmp/1bbeb46b72e8bd803afbdee5c5bb5c09594f1fdd4fa386b70102c5ad7586f4f7.jpg", "img_caption": [""], "img_footnote": [], "page_idx": 5}, {"type": "text", "text": "Figure 2: The six subfigures represent the relationship between cocoercivity and convergence for 3 models $\\times~2$ algorithms (vanilla forward step method and inertial KM iteration). The $\\mathbf{X}$ -axis represents the values of mink\u2208[0,100] \u27e8ED\u2225zE\u221eDz\u2212E\u221eD\u2212zEkD,zz\u221ek\u2225\u22122zk\u27e9, which informs whether the optimization path satisfies the assumptions of Theorems 1 and 2, while the y-axis represents the convergence (i.e., $\\circled{1}z^{100}-z^{\\infty}\\ensuremath{\\|z)}$ . The red line shows the linear function fitted by least squares. We set $z^{\\infty}=z^{300}$ ", "page_idx": 5}, {"type": "text", "text": "4 Experiments with practical optimization techniques ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "Adam optimizer. In Section 3, we proved that our proposed forward step method (Theorem 1) and inertial KM iterations (Theorem 2) converge. Moreover, we experimentally showed that the assumptions of the theorems hold for most instances and demonstrated their convergence as predicted (Fig. 2). However, it is generally believed that using the Adam optimizer [16] is preferable in many optimization problems. In this section, although we cannot prove convergence as in Theorems 1 and 2, we empirically demonstrate that using the Adam optimizer can achieve a good runtime and memory usage compared to conventional gradient-based methods. ", "page_idx": 6}, {"type": "text", "text": "(Optional) Learning rate scheduling. Following common beliefs and a prior work which solves the same problem [14], one can also use a cosine learning rate scheduler with warm-up steps. Similar to [14], the first $1/10$ of the steps are warm-up steps, followed by the application of cosine annealing. After $\\%$ of the total steps have passed (as the learning rate has sufficiently decreased), it is kept constant for the rest of steps. ", "page_idx": 6}, {"type": "image", "img_path": "nbqvjkOs6S/tmp/67c7fe69c32a35a700b104f38bd1289c417684c4faa272ce73f861012306253a.jpg", "img_caption": ["(c) InstaFlow, one-step image generating model [24]. "], "img_footnote": [], "page_idx": 6}, {"type": "text", "text": "Figure 3: Our gradient-free decoder inversion has a way shorter runtime than the gradient-based decoder inversion, and drastically reduces the GPU memory usage, on (a) SD2.1 [37], (b) LaVie [47], and (c) InstaFlow [24]. Note that 16-bit gradient-based approach is unimplementable, due to the underflow problem. Each point represents a different hyperparameter setting (e.g., the total number of iterations, learning rate, learning rate scheduling); by collecting experimental results from such diverse settings, the Pareto frontier can be obtained fairly without manipulation. ", "page_idx": 6}, {"type": "text", "text": "Results. Figure 3 shows the average NMSE and peak memory usage when performing decoder inversion using practical techniques (i.e., Adam and learning rate scheduling) in three different LDMs. While the gradient-based method required much runtime and GPU memory to achieve a certain accuracy, our approach achieves good accuracy in much less runtime and memory usage. One advantage of our proposed method is that it enables all operations to be performed in 16-bit through gradient-free methods, which would typically be infeasible with gradient-based approaches [30]. As a result, for video LDMs where large vectors need to be estimated (Fig. 3b), memory usages can be significantly reduced by almost 9 times. ", "page_idx": 7}, {"type": "text", "text": "5 Applications ", "text_level": 1, "page_idx": 7}, {"type": "text", "text": "5.1 Tree-rings watermarking for image generation ", "text_level": 1, "page_idx": 7}, {"type": "text", "text": "In this section, we show an interesting application of our gradient-free decoder inversion. Wen et al. [48] proposed tree-rings watermarking, which is an invisible and robust method for protecting the copyright of diffusion-generated images. Watermark is embedded into the Fourier transform of $z_{T}$ , and detected by inversion (i.e., estimating $z_{T}$ from $\\textbf{\\em x}$ ). Hong et al. [14] went beyond watermark detection to attempt watermark classification, which makes the problem more difficult; the inversion should be even more accurate. In the following scenarios with two image generation LDMs, we experimentally show that our decoder inversion can efficiently perform watermark classification. ", "page_idx": 7}, {"type": "text", "text": "Watermark classification in SD 2.1. Since watermark classification requires higher accuracy than detection, iterative diffusion inversion algorithms was used such as the backward Euler instead of the na\u00efve DDIM inversion. However, it is reported that iterative algorithms become unstable when the classifier-free guidance is large [31, 14]. So even for watermark classification, the na\u00efve DDIM inversion should be used for now. In this case, one promising option for improving the performance of watermark classification is decoder inversion. ", "page_idx": 7}, {"type": "text", "text": "Watermark classification in InstaFlow. One-step models such as InstaFlow [24] generate $z_{0}$ directly from $z_{T}$ . Therefore, rather than the na\u00efve DDIM inversion, the backward Euler method[14] should be used to obtain $z_{T}$ from $z_{\\mathrm{0}}$ . In this case, $\\ensuremath{\\boldsymbol{z}}_{0}$ is very sensitive to $z_{T}$ , so $z_{T}$ should be estimated accurately by decoder inversion. ", "page_idx": 7}, {"type": "text", "text": "Results. Table 2 shows the accuracy, peak memory usage and runtime of classifying three tree-rings watermarks using different decoder inversion algorithms. Our decoder inversion method achieves watermark classification performance comparable to a gradient-based method while significantly reducing runtime and peak memory usage. See the appendix for the details. ", "page_idx": 7}, {"type": "table", "img_path": "nbqvjkOs6S/tmp/a4d49ac4f7221b7506e7c5ac5551fe1fa4c031d69edd366e32ff23ccd5733b06.jpg", "table_caption": ["Table 2: Our gradient-free decoder inversion method achieves the tree-rings watermark [48] classification performance comparable to a gradient-based method while significantly reducing memory usage and runtime, in two different scenarios. "], "table_footnote": [], "page_idx": 7}, {"type": "text", "text": "5.2 Background-preserving image editing ", "text_level": 1, "page_idx": 7}, {"type": "text", "text": "Background-preserving editing, to manipulate an image based on a new condition while preserving background from the original image, requires the entire generating latent trajectory. When it is unknown, it must be recovered via inversion [32]. We empirically demonstrate that our algorithm enhances the background-preserving image editing, without the need for the original latents. Figure 4 shows the qualitative results of applying our algorithm to the experiment. To compare accuracy at similar execution times, we adjusted the number of iterations to match the execution time. At comparable execution times, our grad-free method better preserves the background and achieves a lower NMSE. ", "page_idx": 7}, {"type": "text", "text": "", "page_idx": 8}, {"type": "image", "img_path": "nbqvjkOs6S/tmp/7dd6fe19cd35e247e7eb835a08ede933a93f8c6596db6535415d6bdcc19d96b1.jpg", "img_caption": ["Figure 4: Our grad-free methods enables the background-preserving image editing, where the original trajectory $\\left(z_{t}\\right)$ is unknown. The first row (Oracle) shows the result with using the original trajectory. The latter cases estimate the trajectory with inversion methods. Our grad-free method demonstrates better performance compared to the grad-based method at a similar runtime. "], "img_footnote": [], "page_idx": 8}, {"type": "text", "text": "6 Discussion ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "6.1 Does the $\\beta$ -cocoercivity hold also when using Adam? Yes. ", "text_level": 1, "page_idx": 8}, {"type": "image", "img_path": "nbqvjkOs6S/tmp/d691a0002b1e8e91ca9e11658ec246aad3d96426127d4a7a87d95073fdca94d3.jpg", "img_caption": [], "img_footnote": [], "page_idx": 8}, {"type": "text", "text": "Figure 5: The assumptions also hold for Adam in many cases, as similar in Fig. 2. The $\\mathbf{X}$ -axis represents the values of $\\operatorname*{min}_{k\\in[0,50]}\\frac{\\langle\\mathcal{E}\\mathcal{D}z^{\\infty}-\\mathcal{E}\\mathcal{D}z^{k},z^{\\infty}-z^{k}\\rangle}{\\|\\mathcal{E}\\mathcal{D}z^{\\infty}-\\mathcal{E}\\mathcal{D}z^{k}\\|_{2}^{2}}$ , which informs whether the optimization path satisfies the assumptions of Theorems 1 and 2, while the y-axis represents the convergence (i.e., $\\|z^{50}-z^{\\infty}\\|_{2})$ . The red line shows the linear function fitted by least squares. Note that $z^{\\infty}$ was approximated by z300. ", "page_idx": 8}, {"type": "text", "text": "Although it is challenging to provide a proof regarding convergence for algorithms using Adam and learning rate scheduling (those used in Section 4 and Fig. 3c), we can rather test if $\\bar{(z^{k})}$ satisfy cocoercivity (9), as in Fig. 2. Figure 5 depicts the plot of Fig. 2 under the conditions of the experiments in Section 4, specifically with 16-bit precision and 50 iterations (as Adam converges faster than others). In the cases of Figs. S3b and S3c, cocoercivity is well satisfied, and even in Fig. S3a, many instances meet the cocoercivity requirement. Additionally, as in Fig. 2, the fitted functions have a negative slope. These findings show that our analysis can help explain some aspects of Adam\u2019s convergence. ", "page_idx": 8}, {"type": "text", "text": "", "page_idx": 9}, {"type": "text", "text": "6.2 Why this method has not been proposed in GAN inversion studies ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "Some may wonder why this gradient-free approach (replacing gradient descent of Eq. (3) with a forward step method of Eq. (4) using the encoder) has not been proposed in numerous GAN inversion studies. Here, we provide Table 3 to explain the reasons. The first reason is that GAN inversion cannot use the encoder from off-the-shelf [49]. It is because networks commonly used in GAN inversion, such as StyleGAN [1], were not born with an encoder even though there are some GAN methods that are inherently an autoencoder such as VQGAN [9] that was born with an encoder. Thus many GAN inversion works needed to train the encoder [33, 8, 34, 53, 6, 36, 7, 2], while we can use the encoder without any finetuning. The second reason is that the memory requirement was small in GAN inversion, as the size of the generated images was small. Even a standard GPU on a PC was capable of running gradient-based algorithms, so there was not much need for lighter algorithms than gradient-based methods. On the contrary, due to the increasing size of images/videos generated by recent LDMs, performing decoder inversion with gradient-based algorithms requires huge memory. Another reason is that many networks for GAN inversion operate in full precision (32 bits), making it easier to employ gradient-based methods here. Meanwhile, many recent LDMs often infer in half-precision (16 bits) to enhance efficiency, making gradient-based methods challenging [30]. ", "page_idx": 9}, {"type": "table", "img_path": "nbqvjkOs6S/tmp/09e6c7c08b89fe83f04cd8b5d8fef13b116ef081cb6eacd032c2d52f33b467e3.jpg", "table_caption": ["Table 3: Why has a gradient-free method not been proposed for GAN inversion? "], "table_footnote": [], "page_idx": 9}, {"type": "text", "text": "7 Conclusion ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "In this work, we proposed gradient-free decoder inversion methods for LDMs. The vanilla forward step method and its extension with momentum were shown to guarantee convergence, and the assumptions and theorems were validated for various LDMs. We experimentally showed that a practical algorithm significantly reduced runtime and memory usage compared to existing gradientbased methods. ", "page_idx": 9}, {"type": "text", "text": "Limitations Existing gradient-based method is more accurate than our method if sufficient runtime and GPU memory are available. In applications such as image editing, where the accuracy of latent reconstruction may not be critically important such as background preservation, decoder inversion is often unnecessary in most settings (i.e., using the encoder is just OK). ", "page_idx": 9}, {"type": "text", "text": "Broader impacts This study could positively impact the protection of copyright for LDM\u2019s outputs. One day, even if a new neural network architecture is invented and diffusion is no longer used, our method can still be efficiently utilized to improve the accuracy of decoder inversion as long as transformations between latent and pixel-space are required. ", "page_idx": 9}, {"type": "text", "text": "Acknowledgements ", "text_level": 1, "page_idx": 10}, {"type": "text", "text": "This work was supported by Institute of Information & communications Technology Planning & Evaluation (IITP) grant funded by the Korea government(MSIT) [NO.2021-0-01343, Artificial Intelligence Graduate School Program (Seoul National University)] and National Research Foundation of Korea (NRF) grants funded by the Korea government (MSIT) (NRF-2022R1A4A1030579, NRF2022M3C1A309202211). The authors acknowledged the financial support from the BK21 FOUR program of the Education and Research Program for Future ICT Pioneers, Seoul National University. ", "page_idx": 10}, {"type": "text", "text": "References ", "text_level": 1, "page_idx": 10}, {"type": "text", "text": "[1] Rameen Abdal, Yipeng Qin, and Peter Wonka. Image2StyleGAN: How to embed images into the stylegan latent space? In ICCV, 2019.   \n[2] Yuval Alaluf, Omer Tov, Ron Mokady, Rinon Gal, and Amit Bermano. HyperStyle: Stylegan inversion with hypernetworks for real image editing. In CVPR, 2022.   \n[3] Pierre Baldi and Kurt Hornik. Neural networks and principal component analysis: Learning from examples without local minima. Neural networks, 2(1):53\u201358, 1989.   \n[4] Andreas Blattmann, Tim Dockhorn, Sumith Kulal, Daniel Mendelevitch, Maciej Kilian, Dominik Lorenz, Yam Levi, Zion English, Vikram Voleti, Adam Letts, et al. Stable video diffusion: Scaling latent video diffusion models to large datasets. arXiv preprint arXiv:2311.15127, 2023.   \n[5] Andreas Blattmann, Robin Rombach, Huan Ling, Tim Dockhorn, Seung Wook Kim, Sanja Fidler, and Karsten Kreis. Align your latents: High-resolution video synthesis with latent diffusion models. In CVPR, 2023.   \n[6] Lucy Chai, Jonas Wulff, and Phillip Isola. Using latent space regression to analyze and leverage compositionality in gans. ICLR, 2021.   \n[7] Lucy Chai, Jun-Yan Zhu, Eli Shechtman, Phillip Isola, and Richard Zhang. Ensembling with deep generative views. In CVPR, 2021.   \n[8] Antonia Creswell and Anil Anthony Bharath. Inverting the generator of a generative adversarial network. IEEE transactions on neural networks and learning systems, 30(7):1967\u20131974, 2018.   \n[9] Patrick Esser, Robin Rombach, and Bjorn Ommer. Taming transformers for high-resolution image synthesis. In CVPR, 2021.   \n[10] Daniel Garibi, Or Patashnik, Andrey Voynov, Hadar Averbuch-Elor, and Daniel Cohen-Or. ReNoise: Real image inversion through iterative noising. arXiv preprint arXiv:2403.14602, 2024.   \n[11] Jonathan Ho and Tim Salimans. Classifier-free diffusion guidance. In NeurIPS 2021 Workshop on Deep Generative Models and Downstream Applications, 2021.   \n[12] Jonathan Ho, Ajay Jain, and Pieter Abbeel. Denoising diffusion probabilistic models. NeurIPS, 2020.   \n[13] Seongmin Hong and Se Young Chun. Neural diffeomorphic non-uniform b-spline flows. In AAAI, 2023.   \n[14] Seongmin Hong, Kyeonghyun Lee, Suh Yoon Jeon, Hyewon Bae, and Se Young Chun. On exact inversion of dpm-solvers. arXiv preprint arXiv:2311.18387, 2023.   \n[15] Tero Karras, Samuli Laine, and Timo Aila. A style-based generator architecture for generative adversarial networks. In CVPR, 2019.   \n[16] Diederik P Kingma and Jimmy Ba. Adam: A method for stochastic optimization. In ICLR, 2015.   \n[17] Jonas K\u00f6hler, Andreas Kr\u00e4mer, and Frank No\u00e9. Smooth normalizing flows. NeurIPS, 2021.   \n[18] Zhifeng Kong, Wei Ping, Jiaji Huang, Kexin Zhao, and Bryan Catanzaro. DiffWave: A versatile diffusion model for audio synthesis. In ICLR, 2021.   \n[19] Mark Aleksandrovich Krasnosel\u2019skii. Two remarks on the method of successive approximations. Uspekhi matematicheskikh nauk, 10(1):123\u2013127, 1955.   \n[20] Dong C Liu and Jorge Nocedal. On the limited memory bfgs method for large scale optimization. Mathematical programming, 45(1):503\u2013528, 1989.   \n[21] Haohe Liu, Zehua Chen, Yi Yuan, Xinhao Mei, Xubo Liu, Danilo Mandic, Wenwu Wang, and Mark D Plumbley. AudioLDM: Text-to-audio generation with latent diffusion models. In ICML, 2023.   \n[22] Haohe Liu, Qiao Tian, Yi Yuan, Xubo Liu, Xinhao Mei, Qiuqiang Kong, Yuping Wang, Wenwu Wang, Yuxuan Wang, and Mark D Plumbley. AudioLDM 2: Learning holistic audio generation with selfsupervised pretraining. arXiv preprint arXiv:2308.05734, 2023.   \n[23] Xingchao Liu, Chengyue Gong, and Qiang Liu. Flow straight and fast: Learning to generate and transfer data with rectified flow. arXiv preprint arXiv:2209.03003, 2022.   \n[24] Xingchao Liu, Xiwen Zhang, Jianzhu Ma, Jian Peng, et al. InstaFlow: One step is enough for high-quality diffusion-based text-to-image generation. In ICLR, 2023.   \n[25] Cheng Lu, Yuhao Zhou, Fan Bao, Jianfei Chen, Chongxuan Li, and Jun Zhu. DPM-Solver: A fast ODE solver for diffusion probabilistic model sampling in around 10 steps. NeurIPS, 2022.   \n[26] Cheng Lu, Yuhao Zhou, Fan Bao, Jianfei Chen, Chongxuan Li, and Jun Zhu. DPM-Solver++: Fast solver for guided sampling of diffusion probabilistic models. arXiv:2211.01095, 2022.   \n[27] Simian Luo, Yiqin Tan, Longbo Huang, Jian Li, and Hang Zhao. Latent consistency models: Synthesizing high-resolution images with few-step inference, 2023.   \n[28] W Robert Mann. Mean value methods in iteration. Proceedings of the American Mathematical Society, 4 (3):506\u2013510, 1953.   \n[29] Juan Jos\u00e9 Maul\u00e9n, Ignacio Fierro, and Juan Peypouquet. Inertial Krasnoselskii-Mann Iterations. Set-Valued and Variational Analysis, 32(2):10, 2024.   \n[30] Paulius Micikevicius, Sharan Narang, Jonah Alben, Gregory Diamos, Erich Elsen, David Garcia, Boris Ginsburg, Michael Houston, Oleksii Kuchaiev, Ganesh Venkatesh, et al. Mixed precision training. arXiv preprint arXiv:1710.03740, 2017.   \n[31] Zhihong Pan, Riccardo Gherardi, Xiufeng Xie, and Stephen Huang. Effective real image editing with accelerated iterative diffusion inversion. In ICCV, 2023.   \n[32] Or Patashnik, Daniel Garibi, Idan Azuri, Hadar Averbuch-Elor, and Daniel Cohen-Or. Localizing objectlevel shape variations with text-to-image diffusion models. In ICCV, 2023.   \n[33] Guim Perarnau, Joost Van De Weijer, Bogdan Raducanu, and Jose M \u00c1lvarez. Invertible conditional GANs for image editing. arXiv preprint arXiv:1611.06355, 2016.   \n[34] Stanislav Pidhorskyi, Donald A Adjeroh, and Gianfranco Doretto. Adversarial latent autoencoders. In CVPR, 2020.   \n[35] Aditya Ramesh, Prafulla Dhariwal, Alex Nichol, Casey Chu, and Mark Chen. Hierarchical text-conditional image generation with CLIP latents. arXiv:2204.06125, 2022.   \n[36] Elad Richardson, Yuval Alaluf, Or Patashnik, Yotam Nitzan, Yaniv Azar, Stav Shapiro, and Daniel Cohen-Or. Encoding in style: a stylegan encoder for image-to-image translation. In CVPR, 2021.   \n[37] Robin Rombach, Andreas Blattmann, Dominik Lorenz, Patrick Esser, and Bj\u00f6rn Ommer. High-resolution image synthesis with latent diffusion models. In CVPR, 2022.   \n[38] Nataniel Ruiz, Yuanzhen Li, Varun Jampani, Yael Pritch, Michael Rubinstein, and Kfir Aberman. DreamBooth: Fine tuning text-to-image diffusion models for subject-driven generation. In CVPR, 2023.   \n[39] Ernest K Ryu and Wotao Yin. Large-scale convex optimization: algorithms & analyses via monotone operators. Cambridge University Press, 2022.   \n[40] Axel Sauer, Dominik Lorenz, Andreas Blattmann, and Robin Rombach. Adversarial diffusion distillation. arXiv preprint arXiv:2311.17042, 2023.   \n[41] Jiaming Song, Chenlin Meng, and Stefano Ermon. Denoising diffusion implicit models. In ICLR, 2021.   \n[42] Yang Song and Stefano Ermon. Improved techniques for training score-based generative models. NeurIPS, 2020.   \n[43] Yang Song, Prafulla Dhariwal, Mark Chen, and Ilya Sutskever. Consistency models. arXiv preprint arXiv:2303.01469, 2023.   \n[44] Bram Wallace, Akash Gokul, and Nikhil Naik. EDICT: Exact Diffusion Inversion via Coupled Transformations. In CVPR, pages 22532\u201322541, 2023.   \n[45] Jiuniu Wang, Hangjie Yuan, Dayou Chen, Yingya Zhang, Xiang Wang, and Shiwei Zhang. Modelscope text-to-video technical report. arXiv preprint arXiv:2308.06571, 2023.   \n[46] Xiang Wang, Shiwei Zhang, Han Zhang, Yu Liu, Yingya Zhang, Changxin Gao, and Nong Sang. VideoLCM: Video latent consistency model. arXiv preprint arXiv:2312.09109, 2023.   \n[47] Yaohui Wang, Xinyuan Chen, Xin Ma, Shangchen Zhou, Ziqi Huang, Yi Wang, Ceyuan Yang, Yinan He, Jiashuo Yu, Peiqing Yang, et al. LaVie: High-quality video generation with cascaded latent diffusion models. arXiv preprint arXiv:2309.15103, 2023.   \n[48] Yuxin Wen, John Kirchenbauer, Jonas Geiping, and Tom Goldstein. Tree-Ring Watermarks: Fingerprints for diffusion images that are invisible and robust. arXiv:2305.20030, 2023.   \n[49] Weihao Xia, Yulun Zhang, Yujiu Yang, Jing-Hao Xue, Bolei Zhou, and Ming-Hsuan Yang. GAN Inversion: A survey. IEEE TPAMI, 45(3):3121\u20133138, 2022.   \n[50] Zhisheng Xiao, Karsten Kreis, and Arash Vahdat. Tackling the generative learning trilemma with denoising diffusion GANs. In ICLR, 2021.   \n[51] Guoqiang Zhang, Jonathan P Lewis, and W Bastiaan Kleijn. Exact diffusion inversion via bi-directional integration approximation. arXiv:2307.10829, 2023.   \n[52] Daquan Zhou, Weimin Wang, Hanshu Yan, Weiwei Lv, Yizhe Zhu, and Jiashi Feng. Magicvideo: Efficient video generation with latent diffusion models. arXiv preprint arXiv:2211.11018, 2022.   \n[53] Jiapeng Zhu, Yujun Shen, Deli Zhao, and Bolei Zhou. In-domain GAN inversion for real image editing. In ECCV, 2020.   \n[54] Jun-Yan Zhu, Philipp Kr\u00e4henb\u00fchl, Eli Shechtman, and Alexei A Efros. Generative visual manipulation on the natural image manifold. In ECCV, 2016. ", "page_idx": 10}, {"type": "text", "text": "", "page_idx": 11}, {"type": "text", "text": "", "page_idx": 12}, {"type": "text", "text": "A Appendix ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "A.1 Proofs ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "Throughout the paper and appendix, both the inner product and the norm are $l_{2}$ . ", "page_idx": 13}, {"type": "text", "text": "A.1.1 Proof of Theorem 1 ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "Proof of Theorem $^{\\,l}$ . ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\|z^{k+1}-z^{\\star}\\|_{2}^{2}=\\|z^{k}-z^{\\star}-\\rho\\mathcal{T}z^{k}\\|_{2}^{2}}\\\\ &{\\qquad\\qquad\\qquad=\\|z^{k}-z^{\\star}\\|_{2}^{2}-2\\rho\\langle\\mathcal{T}z^{k},z^{k}-z^{\\star}\\rangle+\\rho^{2}\\|\\mathcal{T}z^{k}\\|_{2}^{2}}\\\\ &{\\qquad\\qquad\\leq\\|z^{k}-z^{\\star}\\|_{2}^{2}-\\rho(2\\beta-\\rho)\\|\\mathcal{T}z^{k}\\|_{2}^{2}}\\end{array}\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "Sum both sides from $k=0,\\ldots,\\infty$ ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\rho(2\\beta-\\rho)\\sum_{k=0}^{\\infty}\\|\\mathcal{T}z^{k}\\|_{2}^{2}\\leq\\|z^{0}-z^{\\star}\\|_{2}^{2}<\\infty\\Rightarrow\\|\\mathcal{T}z^{k}\\|_{2}^{2}\\to0\\Rightarrow\\mathcal{T}z^{k}\\to0.\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "Finally, if $z^{k}\\to z^{\\infty}$ , then $\\tau{}z^{\\infty}=0$ by continuity. ", "page_idx": 13}, {"type": "text", "text": "A.1.2 Lemma 1 for Theorem 2 ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "For simplicity, we set ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\nu=(\\lambda^{-1}-1),}\\\\ &{\\delta^{k}=\\nu(1-\\alpha)\\|z^{k}-z^{k-1}\\|^{2},}\\\\ &{\\Delta^{k}(z^{\\star})=\\|z^{k}-z^{\\star}\\|^{2}-\\|z^{k-1}-z^{\\star}\\|^{2},\\quad\\Delta^{1}(z^{\\star})=0}\\\\ &{C^{k}(z^{\\star})=\\|z^{k}-z^{\\star}\\|^{2}-\\alpha\\|z^{k-1}-z^{\\star}\\|^{2}+\\delta^{k},\\quad C^{1}(z^{\\star})=\\|z^{1}-z^{\\star}\\|^{2}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "Before we prove, we need the following lemma. ", "page_idx": 13}, {"type": "text", "text": "Lemma S1. Let $\\beta>0$ , $0<\\rho<2\\beta$ , and $\\pmb{x}\\in\\mathbb{R}^{N}$ . Assume $\\begin{array}{r}{\\pmb{\\mathcal{T}}(\\cdot)=\\pmb{\\mathcal{E}}\\circ\\pmb{\\mathcal{D}}(\\cdot)-\\pmb{\\mathcal{E}}(\\pmb{x})}\\end{array}$ is continuous. Assume $\\begin{array}{r}{\\pmb{\\mathcal{T}}(\\cdot)=\\pmb{\\mathcal{E}}\\circ\\pmb{\\mathcal{D}}(\\cdot)-\\pmb{\\mathcal{E}}(\\pmb{x})}\\end{array}$ is continuous. Let $(z^{k},y^{k})$ satisfy (10) and $(I I)$ . Assume $z^{\\star}$ is $a$ zero of $\\tau$ (i.e., $\\begin{array}{r}{\\boldsymbol{\\tau}_{\\boldsymbol{z}^{\\star}}=\\boldsymbol{0}_{\\!_{\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!$ ) and Eq. (12) holds. Then, for $k=1,2,\\dots$ , ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\frac{\\lambda^{k+1}(z^{\\star})+\\delta^{k+1}+\\nu\\alpha\\|z^{k+1}-2z^{k}+z^{k-1}\\|^{2}\\leq\\alpha\\Delta^{k}(z^{\\star})+[\\alpha(1+\\alpha)+\\nu\\alpha(1-\\alpha)]\\|z^{k}-z^{k-1}\\|^{2}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "Proof of Lemma $_{S l}$ . Let $\\rho=2\\lambda\\beta$ . From Eq. (11), ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\|z^{k+1}-z^{\\star}\\|^{2}=\\|y^{k}-z^{\\star}\\|^{2}+\\rho^{2}\\|\\mathcal{T}y^{k}\\|^{2}-2\\rho\\langle y^{k}-z^{\\star},\\mathcal{T}y^{k}\\rangle.\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "Applying Eq. (12) on Eq. (S8), we have ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\|z^{k+1}-z^{\\star}\\|^{2}\\leq\\|y^{k}-z^{\\star}\\|^{2}-\\rho(2\\beta-\\rho)\\|\\mathcal{T}y^{k}\\|^{2}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "From Eq. (10), ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\|y^{k}-z^{\\star}\\|^{2}=\\|(1+\\alpha)(z^{k}-z^{\\star})-\\alpha(z^{k-1}-z^{\\star})\\|^{2}}\\\\ &{\\qquad\\qquad=(1+\\alpha)\\|z^{k}-z^{\\star}\\|^{2}+\\alpha(1+\\alpha)\\|z^{k}-z^{k-1}\\|^{2}-\\alpha\\|z^{k-1}-z^{\\star}\\|^{2}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "Combining Eq. (S9) and Eq. (S10), ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\begin{array}{r}{z^{k+1}-z^{\\star}\\|\\leq(1+\\alpha)\\|z^{k}-z^{\\star}\\|^{2}+\\alpha(1+\\alpha)\\|z^{k}-z^{k-1}\\|^{2}-\\alpha\\|z^{k-1}-z^{\\star}\\|^{2}-\\rho(2\\beta-\\rho)\\|T y^{k}\\|^{2}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "Using Eq. (S4), we can simplify Eq. (S11) as follows: ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\Delta^{k+1}(z^{\\star})\\leq\\alpha\\Delta^{k}(z^{\\star})+\\alpha(1+\\alpha)\\|z^{k}-z^{k-1}\\|^{2}-\\rho(2\\beta-\\rho)\\|\\mathcal{T}\\pmb{y}^{k}\\|^{2}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "On the other hand, by Eq. (10) and Eq. (11), we have ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\rho^{2}\\|\\mathcal{T}y^{k}\\|^{2}=\\|z^{k+1}-y^{k}\\|^{2}}\\\\ &{\\qquad\\qquad=\\|z^{k+1}-z^{k}-\\alpha(z^{k}-z^{k-1})\\|^{2}}\\\\ &{\\qquad\\qquad=\\|(1-\\alpha)(z^{k+1}-z^{k})+\\alpha(z^{k+1}-2z^{k}+z^{k-1})\\|^{2}}\\\\ &{\\qquad\\qquad=(1-\\alpha)\\|z^{k+1}-z^{k}\\|^{2}-\\alpha(1-\\alpha)\\|z^{k}-z^{k-1}\\|^{2}+\\alpha\\|z^{k+1}-2z^{k}+z^{k-1}\\|_{\\infty}^{2}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "Let\u2019s multiply $\\nu=(2\\beta-\\rho)/\\rho$ to Eq. (S13). Then ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\rho(2\\beta-\\rho)\\|\\mathcal{T}\\pmb{y}^{k}\\|^{2}=\\delta^{k+1}-\\nu\\alpha(1-\\alpha)\\|z^{k}-z^{k-1}\\|^{2}+\\nu\\alpha\\|z^{k+1}-2z^{k}+z^{k-1}\\|^{2}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "Finally, subtracting Eq. (S14) from Eq. (S12), we obtain Eq. (S7). ", "page_idx": 14}, {"type": "text", "text": "A.1.3 Proof of Theorem 2 ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "Proof of Theorem 2. We firstly show that $\\left(C^{k}(z^{\\star})\\right)_{k}$ is nonincreasing and nonnegative, thus $\\operatorname*{lim}_{k\\to\\infty}C^{k}(z^{\\star})$ exists. By Eq. (13), there exists $\\epsilon>0$ such that ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\alpha(1+\\alpha)+\\nu\\alpha(1-\\alpha)\\leq\\nu(1-\\alpha)-\\epsilon.\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "Combining Eq. (S7) and Eq. (S15), we have ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\Delta^{k+1}(z^{\\star})+\\delta^{k+1}+\\nu\\alpha\\|z^{k+1}-2z^{k}+z^{k-1}\\|^{2}}\\\\ &{\\quad\\leq\\alpha\\Delta^{k}(z^{\\star})+[\\alpha(1+\\alpha)+\\nu\\alpha(1-\\alpha)]\\|z^{k}-z^{k-1}\\|^{2}}\\\\ &{\\quad\\leq\\alpha\\Delta^{k}(z^{\\star})+[\\nu(1-\\alpha)-\\epsilon]\\|z^{k}-z^{k-1}\\|^{2}}\\\\ &{\\quad=\\alpha\\Delta^{k}(z^{\\star})+\\delta^{k}-\\epsilon\\|z^{k}-z^{k-1}\\|^{2}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "From Eq. (S6) and Eq. (S5), ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\begin{array}{c}{{C^{k+1}(z^{\\star})-C^{k}(z^{\\star})=\\Delta^{k+1}(z^{\\star})-\\alpha(\\|z^{k}-z^{\\star}\\|^{2}-\\|z^{k-1}-z^{\\star}\\|^{2})+\\delta^{k+1}-\\delta^{k}}}\\\\ {{=\\Delta^{k+1}(z^{\\star})+\\delta^{k+1}-\\alpha\\Delta^{k}(z^{\\star})-\\delta^{k}.}}\\end{array}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "By Eq. (S16) and Eq. (S17), we have ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\begin{array}{r}{C^{k+1}(z^{\\star})+\\nu\\alpha\\|z^{k+1}-2z^{k}+z^{k-1}\\|^{2}+\\epsilon\\|z^{k}-z^{k-1}\\|^{2}\\leq C^{k}(z^{\\star}),}\\end{array}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "which shows $\\left(C^{k}(z^{\\star})\\right)_{k}$ is nonincreasing. To prove it is nonnegative, suppose $C^{k_{1}}(z^{\\star})\\,<\\,0$ for some $k_{1}\\geq1$ . Since it is nonincreasing, from Eq. (S6), ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\|\\boldsymbol{z}^{k}-\\boldsymbol{z}^{\\star}\\|^{2}-\\alpha\\|\\boldsymbol{z}^{k-1}-\\boldsymbol{z}^{\\star}\\|^{2}\\leq C^{k}(\\boldsymbol{z}^{\\star})\\leq C^{k_{1}}(\\boldsymbol{z}^{\\star})<0}\\end{array}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "for all $k\\geq k_{1}$ . That is, $\\|z^{k}-z^{\\star}\\|^{2}\\leq\\|z^{k-1}-z^{\\star}\\|^{2}+C^{k_{1}}(z^{\\star})$ , hence ", "page_idx": 14}, {"type": "equation", "text": "$$\n0\\leq\\|z^{k}-z^{\\star}\\|^{2}\\leq\\|z^{k-1}-z^{\\star}\\|^{2}+C^{k_{1}}(z^{\\star})\\leq\\cdots\\leq\\|z^{k_{1}}-z^{\\star}\\|^{2}+(k-k_{1})C^{k_{1}}(z^{\\star})\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "for all $k\\geq k_{1}$ , and this is a contradiction as the right hand of Eq. (S20) diverges to $-\\infty$ as $k\\rightarrow\\infty$ .   \nTherefore, $\\left(C^{k}(z^{\\star})\\right)_{k}$ is nonincreasing and nonnegative, thus $\\operatorname*{lim}_{k\\to\\infty}C^{k}(z^{\\star})$ exists. ", "page_idx": 14}, {"type": "text", "text": "Now we begin showing (A). By the findings so far and Eq. (S18) and since $\\epsilon>0$ , $\\begin{array}{r l r}{\\lefteqn{\\sum_{k\\geq1}\\|z^{k+1}-}}\\end{array}$ $2z^{k}{+}z^{k-1}\\|^{2}$ and $\\begin{array}{r}{\\sum_{k\\geq1}\\|z^{k}-z^{k-1}\\|^{2}}\\end{array}$ converge. Since $\\begin{array}{r}{\\sum_{k\\geq1}\\|z^{k}-z^{k-1}\\|^{2}}\\end{array}$ converges, $\\sum_{k\\geq1}\\delta^{k}=$ $\\begin{array}{r}{\\sum_{k\\geq1}\\nu(1-\\alpha)\\|z^{k}-z^{k-1}\\|^{2}}\\end{array}$ also converges. Using Eq. (S13) and an identity $\\|a-b\\|^{2}\\leq2\\|a\\|^{2}+$ $2\\Vert b\\bar{\\Vert}^{2}$ , we have ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\rho^{2}\\|\\mathcal{T}y^{k}\\|^{2}=(1+\\alpha)\\|z^{k+1}-z^{k}\\|^{2}+\\alpha(1+\\alpha)\\|z^{k}-z^{k-1}\\|^{2}.\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "Summing Eq. (S18) over $k\\geq1$ , we have ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\epsilon\\sum_{k\\geq1}\\|z^{k}-z^{k-1}\\|^{2}\\leq C^{1}(z^{\\star})=\\|z^{1}-z^{\\star}\\|^{2}.\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "Using the summation of Eq. (S21) and Eq. (S22), we have ", "page_idx": 15}, {"type": "equation", "text": "$$\nn\\operatorname*{min}_{1\\leq k\\leq n}\\|\\mathcal{T}\\pmb{y}^{k}\\|^{2}\\leq\\sum_{k\\geq1}\\|\\mathcal{T}\\pmb{y}^{k}\\|^{2}\\leq\\frac{(1+\\alpha)^{2}}{\\epsilon\\rho^{2}}\\|\\pmb{z}^{1}-\\pmb{z}^{\\star}\\|^{2},\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "which shows that $\\begin{array}{r}{\\sum_{k\\geq1}\\|\\tau\\pmb{y}^{k}\\|^{2}}\\end{array}$ converges, and proves (B). ", "page_idx": 15}, {"type": "text", "text": "Now we prove (C). From Eq. (S16), we have ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\Delta^{k+1}(z^{\\star})\\leq\\alpha\\Delta^{k}(z^{\\star})+\\delta^{k}.\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "Let $[\\cdot]_{+}$ denotes the positive part. From Eq. (S24), ", "page_idx": 15}, {"type": "equation", "text": "$$\n(1-\\alpha)[\\Delta^{k+1}(z^{\\star})]_{+}+\\alpha[\\Delta^{k+1}(z^{\\star})]_{+}\\leq\\alpha[\\Delta^{k}(z^{\\star})]_{+}+\\delta^{k}.\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "Applying summation for $k\\geq1$ , we have ", "page_idx": 15}, {"type": "equation", "text": "$$\n(1-\\alpha)\\sum_{k\\geq1}[\\Delta^{k+1}(z^{\\star})]_{+}\\leq\\alpha[\\Delta^{1}(z^{\\star})]_{+}+\\sum_{k\\geq1}\\delta^{k}=\\sum_{k\\geq1}\\delta^{k}<\\infty.\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "Let $\\begin{array}{r}{h^{k}=\\|z^{k}-z^{\\star}\\|^{2}-\\sum_{j=1}^{k}[\\Delta^{j}(z^{\\star})]_{+}}\\end{array}$ . Then $h^{k+1}-h^{k}=\\Delta^{k+1}(z^{\\star})-[\\Delta^{k+1}(z^{\\star})]_{+}\\leq0$ so $\\left(h^{k}\\right)$ is nonincreasing. Since $\\begin{array}{r l}{\\sum_{k\\geq1}[\\Delta^{k+1}(z^{\\star})]_{+}}&{{}}\\end{array}$ is finite, $\\begin{array}{r}{\\operatorname*{lim}_{k\\rightarrow\\infty}\\|z^{k}-z^{\\star}\\|=\\operatorname*{lim}_{k\\rightarrow\\infty}h^{k}}\\end{array}$ exists. Finally, we now prove (D). By (A), $\\begin{array}{r}{\\operatorname*{lim}_{k\\rightarrow\\infty}\\|\\mathcal{T}\\pmb{y}^{k}\\|=\\operatorname*{lim}_{k\\rightarrow\\infty}\\|\\pmb{z}^{k}-\\pmb{z}^{k-1}\\|=0}\\end{array}$ . By Eq. (10) and (11), $(\\boldsymbol{y}^{k})$ and $\\big(z^{k}\\big)$ have the same limit points. \u53e3 ", "page_idx": 15}, {"type": "text", "text": "A.2 Experiment details and more results ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "A.2.1 Decoder inversion in LDMs ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "Hong et al. [14] successfully employed the gradient-based method in their experiments and completed hyperparameter tuning. Their tailored method may work well in their setting, so we used the code from Hong et al. [14]\u2019s official repository2 to perform decoder inversion on 100 images generated under the same settings (prompt, classifier-free guidance, random seed). This makes our comparison fair. Table S1 shows the settings, NMSE, number of iterations, runtime, and memory usage of the experiments. Although all the values in Table S1 are actually displayed in Fig. 3, Table S1 provides additional information, including on which specific settings correspond to the points in Fig. 3. ", "page_idx": 15}, {"type": "text", "text": "Gradient-based method For the gradient-based method (for comparision), we used Adam [16] with $l_{2}$ -loss. When optionally using a cosine learning rate scheduler, 1/10 of the total steps were warm-up steps (i.e., the learning rate increased linearly). Note that this setting is the same to [14]. In [14], the learning rate was 0.1 with 100 iterations, but it showed long runtimes. Thus, we set the iterations to 20, 30, 50, and 100. We could observe that reducing the number of iterations decreases the effectiveness of learning rate scheduling. Therefore, we additionally conducted experiments with a fixed learning rate of 0.01, and found that it performed better with a smaller number of iterations. As shown in Tables S1a and S1c, when comparing the $\\cdot0.1$ scheduled\u2019 and $\\cdot0.01$ fixed\u2019 rows under \u2018Grad-based 32-bit\u2019, the fixed learning rate outperforms at 20 and 30 iterations, whereas the scheduled learning rate outperforms at 50 and 100 iterations. By comparing existing methods under various hyperparameter settings, we can more reliably establish the Pareto frontier of these methods, ensuring the fairness of our comparisons. ", "page_idx": 15}, {"type": "text", "text": "Other details For Stable Diffusion 2.1 and InstaFlow, we used prompts from https:// huggingface.co/datasets/Gustavosta/Stable-Diffusion-Prompts. For LaVie, prompts were generated by ChatGPT, given the examples used in [47]. The classifier-free guidance was 3.0 in Stable Diffusion 2.1, 7.5 in LaVie, and 1.0 in InstaFlow. For LaVie, we found that 200 iterations for the gradient-free method is too long, so we adjusted the learning rate scheduling as if there were only 100 iterations (fixing the learning rate after 100 iterations). ", "page_idx": 15}, {"type": "text", "text": "Table S1: We can further improve the reconstruction quality, by using a cosine learning rate scheduler with warm-up steps (if the number of iterations or the runtime is predetermined). We conducted experiments of the decoder inversion in various LDMs, with all other conditions being the same to that in Fig. 3, but using a relatively scheduled learning rate at each iteration. $\\pm$ represents the $95\\%$ confidence interval. ", "page_idx": 16}, {"type": "table", "img_path": "nbqvjkOs6S/tmp/3590cfad1bcb16b9e125f381f6dbc730942b6688bed35351b86e0d6764610ff6.jpg", "table_caption": ["(a) Stable Diffusion 2.1 "], "table_footnote": ["aThis setting is the same as the setting in [14]. "], "page_idx": 16}, {"type": "table", "img_path": "nbqvjkOs6S/tmp/55fca2689f49af995448f9288be53368f1ef2b70b4a52d4a8d916aabf3ba7077.jpg", "table_caption": ["(b) LaVie "], "table_footnote": [], "page_idx": 16}, {"type": "table", "img_path": "nbqvjkOs6S/tmp/cf7839c57557565b7c859876c19c0c19dbf382316fc58ffa9a18d7af2626bdfd.jpg", "table_caption": ["(c) InstaFlow "], "table_footnote": [], "page_idx": 16}, {"type": "text", "text": "A.2.2 Watermark detection ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "For both scenarios, the number of steps was 100 and the learning rate was scheduled for both gradientbased and gradient-free methods. The maximum learning rate was 0.1 for grad-based methods and ", "page_idx": 16}, {"type": "text", "text": "0.01 for Grad-free methods, which is consistent with the experiments in Section 4. All experiments were conducted in 32-bit. ", "page_idx": 17}, {"type": "text", "text": "For Stable Diffusion 2.1, through decoder inversion, we obtain $z_{0}$ from $\\textbf{\\em x}$ , and perform na\u00efve DDIM inversion for 50 steps to obtain $z_{T}$ from $z_{0}$ . Except for employing the na\u00efve DDIM inversion due to the use of a large classifier-free guidance of 7.5 and resulting stability issues, the experimental settings are the same as those of [14]. For InstaFlow, the backward Euler (Algorithm 1 of [14]) with 100 iterations is applied for seeking $z_{T}$ from $\\scriptstyle z_{0}$ . ", "page_idx": 17}, {"type": "text", "text": "Figure S1 shows the confusion matrices for the experiments of Table 2 in the main paper. In Figure S2, we also present the qualitative results of applying our algorithm to the watermark classification experiment. Our grad-free method enables precise reconstruction, while reducing the runtime compared to the grad-based method. ", "page_idx": 17}, {"type": "image", "img_path": "nbqvjkOs6S/tmp/b567af57fda36b3243a069d40e55083e5c91f392174aaee01540648fc024f943.jpg", "img_caption": ["(a) Stable Diffusion 2.1. Accuracy: 186/300, 207/300, 202/300 "], "img_footnote": [], "page_idx": 17}, {"type": "image", "img_path": "nbqvjkOs6S/tmp/257127e355f9952ddad1daf4b5692a053dfacddd104744083460bad9fbf69cd3.jpg", "img_caption": ["(b) InstaFlow. Accuracy: 149/300, 227/300, 227/300 "], "img_footnote": [], "page_idx": 17}, {"type": "text", "text": "Figure S1: Confusion matrices for watermark classification on LDMs. Ours is better than the encoder and works as well as the grad-based method [14]. ", "page_idx": 17}, {"type": "image", "img_path": "nbqvjkOs6S/tmp/c181b58aa0cc4b9707fb23bd5db936161861be23ee63b8dbf81dfed316e19914.jpg", "img_caption": ["Figure S2: Qualitative result on the watermarking classification experiment [14]. Our grad-free decoder inversion aids in the accurate reconstruction of Tree-ring watermarking [48]. Specifically, it either reduces the processing time compared to the grad-based (column 3 vs 5) or achieves better accuracy within the same runtime (column 4 vs 5). "], "img_footnote": [], "page_idx": 17}, {"type": "text", "text": "Table S2: Ablation studies on optimizer and learning rate scheduling. Adam showed the best result compared to vanilla and KM iterations method. The learning scheduling we used showed consistently good performance across all intervals. ", "page_idx": 18}, {"type": "table", "img_path": "nbqvjkOs6S/tmp/0028ef3b21442d9580bc60b65584dc1fbd098b9896510111b9769115485424df.jpg", "table_caption": ["(a) Ablation study on optimizer "], "table_footnote": [], "page_idx": 18}, {"type": "table", "img_path": "nbqvjkOs6S/tmp/722583cd3c0c22925f574b4eaa5e8bde6fe05562db1eae83c01d4c15ff597f89.jpg", "table_caption": ["(b) Ablation study on learning rate scheduling "], "table_footnote": [], "page_idx": 18}, {"type": "text", "text": "A.2.3 Ablation Studies ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "We conducted an ablation study on each optimizer and learning rate scheduling, in SD2.1(32bit). Table S2a shows the result of only changing the optimizer while keeping all other conditions the same. In Table S2b, we observed what happens when using a fixed learning rate instead of applying learning rate scheduling with Adam. When using a fixed learning rate, we found that with a large learning rate $(\\mathrm{lr}{=}0.01)$ ), the performance was poor when the number of iterations was high, and with a small learning rate $\\scriptstyle{\\mathrm{lr}=0.002}\\rangle$ ), the performance was poor when the number of iterations was low. In contrast, the scheduled learning rate we used showed consistent performance across all intervals regardless of the number of iterations. ", "page_idx": 18}, {"type": "text", "text": "A.2.4 Analysis on the grad-based method ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "In Figure S3, we present the instance-wise cocoercivity, convergence, and accuracy for the gradientbased method, similar to Figure 2 and Figure 5. Similar to the results observed with the gradient-free method, the gradient-based method showed that most instances satisfied cocoercivity, and better convergence often led to higher accuracy. However, it was observed that cocoercivity and convergence are not significantly correlated. In other words, the correlation between cocoercivity and convergence is not a general characteristic, but a unique feature we discovered in our gradient-free method. ", "page_idx": 18}, {"type": "text", "text": "A.3 Supplementary explanation ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Figure 1b Normalizing flows (NFs) are born with its analytic invertibility, hence located at the bottom left. VAEs and learning-based GAN inversion methods have corresponding encoders, so they have short computation time but come with some inversion error. Some special structured DMs [44] are also located here. ", "page_idx": 18}, {"type": "text", "text": "A.4 Computational resources ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "For running Stable Diffusion 2.1, one NVIDIA GeForce RTX 3090 Ti was used. The RAM size of the GPU was 24 GB. Note that most of the computation was conducted on GPU. For CPU, one 11th Gen Intel(R) Core(TM) i9-11900KF $@$ 3.50GHz was used. For running LaVie, one NVIDIA A100 SXM4 80GB and AMD EPYC 7742 64-Core Processor were used. For InstaFlow, one NVIDIA GeForce RTX 3090 GPU with one 12th Gen Intel(R) Core(TM) 17-12700K $@$ 3.60GHz was used. ", "page_idx": 18}, {"type": "image", "img_path": "nbqvjkOs6S/tmp/e05fb2676042533b02d04e2990f26a0df5c388ce7b6c0c3d954e88ed99292aab.jpg", "img_caption": ["(b) LaVie "], "img_footnote": [], "page_idx": 19}, {"type": "text", "text": "Figure S3: Analysis on the grad-based method. x-axis: min \u27e8ED\u2225zE\u221eDz\u2212E\u221eD\u2212zEkD,zz\u221ek\u2225\u22122zk\u27e9, y-axis: convergence (i.e., $\\|z^{50}-z^{\\infty}\\|_{2})$ . The red line shows the linear function fitted by least squares. Note that $z^{\\infty}$ was approximated by $z^{300}$ . Better convergence and accuracy were observed, but no relationship with cocoercivity was found. ", "page_idx": 19}, {"type": "text", "text": "NeurIPS Paper Checklist ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "1. Claims ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Question: Do the main claims made in the abstract and introduction accurately reflect the paper\u2019s contributions and scope? ", "page_idx": 20}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 20}, {"type": "text", "text": "Justification: The abstract and introduction clearly reflect the paper\u2019s contributions and scope. ", "page_idx": 20}, {"type": "text", "text": "Guidelines: ", "page_idx": 20}, {"type": "text", "text": "\u2022 The answer NA means that the abstract and introduction do not include the claims made in the paper.   \n\u2022 The abstract and/or introduction should clearly state the claims made, including the contributions made in the paper and important assumptions and limitations. A No or NA answer to this question will not be perceived well by the reviewers.   \n\u2022 The claims made should match theoretical and experimental results, and reflect how much the results can be expected to generalize to other settings.   \n\u2022 It is fine to include aspirational goals as motivation as long as it is clear that these goals are not attained by the paper. ", "page_idx": 20}, {"type": "text", "text": "2. Limitations ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Question: Does the paper discuss the limitations of the work performed by the authors? ", "page_idx": 20}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Justification: This paper discusses the limitations in Section 7 ", "page_idx": 20}, {"type": "text", "text": "Guidelines: ", "page_idx": 20}, {"type": "text", "text": "\u2022 The answer NA means that the paper has no limitation while the answer No means that the paper has limitations, but those are not discussed in the paper.   \n\u2022 The authors are encouraged to create a separate \"Limitations\" section in their paper.   \n\u2022 The paper should point out any strong assumptions and how robust the results are to violations of these assumptions (e.g., independence assumptions, noiseless settings, model well-specification, asymptotic approximations only holding locally). The authors should reflect on how these assumptions might be violated in practice and what the implications would be.   \n\u2022 The authors should reflect on the scope of the claims made, e.g., if the approach was only tested on a few datasets or with a few runs. In general, empirical results often depend on implicit assumptions, which should be articulated.   \n\u2022 The authors should reflect on the factors that influence the performance of the approach. For example, a facial recognition algorithm may perform poorly when image resolution is low or images are taken in low lighting. Or a speech-to-text system might not be used reliably to provide closed captions for online lectures because it fails to handle technical jargon.   \n\u2022 The authors should discuss the computational efficiency of the proposed algorithms and how they scale with dataset size.   \n\u2022 If applicable, the authors should discuss possible limitations of their approach to address problems of privacy and fairness.   \n\u2022 While the authors might fear that complete honesty about limitations might be used by reviewers as grounds for rejection, a worse outcome might be that reviewers discover limitations that aren\u2019t acknowledged in the paper. The authors should use their best judgment and recognize that individual actions in favor of transparency play an important role in developing norms that preserve the integrity of the community. Reviewers will be specifically instructed to not penalize honesty concerning limitations. ", "page_idx": 20}, {"type": "text", "text": "3. Theory Assumptions and Proofs ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Question: For each theoretical result, does the paper provide the full set of assumptions and a complete (and correct) proof? ", "page_idx": 20}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 20}, {"type": "text", "text": "Justification: This paper provides Theorems 1,2 and their corresponding proofs. Guidelines: ", "page_idx": 21}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include theoretical results.   \n\u2022 All the theorems, formulas, and proofs in the paper should be numbered and crossreferenced.   \n\u2022 All assumptions should be clearly stated or referenced in the statement of any theorems.   \n\u2022 The proofs can either appear in the main paper or the supplemental material, but if they appear in the supplemental material, the authors are encouraged to provide a short proof sketch to provide intuition.   \n\u2022 Inversely, any informal proof provided in the core of the paper should be complemented by formal proofs provided in appendix or supplemental material.   \n\u2022 Theorems and Lemmas that the proof relies upon should be properly referenced. ", "page_idx": 21}, {"type": "text", "text": "4. Experimental Result Reproducibility ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "Question: Does the paper fully disclose all the information needed to reproduce the main experimental results of the paper to the extent that it affects the main claims and/or conclusions of the paper (regardless of whether the code and data are provided or not)? ", "page_idx": 21}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 21}, {"type": "text", "text": "Justification: This paper provides sufficient information that can reproduce the results of the main experiment in Section 4. ", "page_idx": 21}, {"type": "text", "text": "Guidelines: ", "page_idx": 21}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 If the paper includes experiments, a No answer to this question will not be perceived well by the reviewers: Making the paper reproducible is important, regardless of whether the code and data are provided or not.   \n\u2022 If the contribution is a dataset and/or model, the authors should describe the steps taken to make their results reproducible or verifiable.   \n\u2022 Depending on the contribution, reproducibility can be accomplished in various ways. For example, if the contribution is a novel architecture, describing the architecture fully might suffice, or if the contribution is a specific model and empirical evaluation, it may be necessary to either make it possible for others to replicate the model with the same dataset, or provide access to the model. In general. releasing code and data is often one good way to accomplish this, but reproducibility can also be provided via detailed instructions for how to replicate the results, access to a hosted model (e.g., in the case of a large language model), releasing of a model checkpoint, or other means that are appropriate to the research performed.   \n\u2022 While NeurIPS does not require releasing code, the conference does require all submissions to provide some reasonable avenue for reproducibility, which may depend on the nature of the contribution. For example (a) If the contribution is primarily a new algorithm, the paper should make it clear how to reproduce that algorithm. (b) If the contribution is primarily a new model architecture, the paper should describe the architecture clearly and fully. (c) If the contribution is a new model (e.g., a large language model), then there should either be a way to access this model for reproducing the results or a way to reproduce the model (e.g., with an open-source dataset or instructions for how to construct the dataset). (d) We recognize that reproducibility may be tricky in some cases, in which case authors are welcome to describe the particular way they provide for reproducibility. In the case of closed-source models, it may be that access to the model is limited in some way (e.g., to registered users), but it should be possible for other researchers to have some path to reproducing or verifying the results. ", "page_idx": 21}, {"type": "text", "text": "5. Open access to data and code ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "Question: Does the paper provide open access to the data and code, with sufficient instructions to faithfully reproduce the main experimental results, as described in supplemental material? ", "page_idx": 21}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 22}, {"type": "text", "text": "Justification: This paper provides code to reproduce the experimental results in Sections 4 and 5. ", "page_idx": 22}, {"type": "text", "text": "Guidelines: ", "page_idx": 22}, {"type": "text", "text": "\u2022 The answer NA means that paper does not include experiments requiring code.   \n\u2022 Please see the NeurIPS code and data submission guidelines (https://nips.cc/ public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 While we encourage the release of code and data, we understand that this might not be possible, so \u201cNo\u201d is an acceptable answer. Papers cannot be rejected simply for not including code, unless this is central to the contribution (e.g., for a new open-source benchmark).   \n\u2022 The instructions should contain the exact command and environment needed to run to reproduce the results. See the NeurIPS code and data submission guidelines (https: //nips.cc/public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 The authors should provide instructions on data access and preparation, including how to access the raw data, preprocessed data, intermediate data, and generated data, etc.   \n\u2022 The authors should provide scripts to reproduce all experimental results for the new proposed method and baselines. If only a subset of experiments are reproducible, they should state which ones are omitted from the script and why.   \n\u2022 At submission time, to preserve anonymity, the authors should release anonymized versions (if applicable).   \n\u2022 Providing as much information as possible in supplemental material (appended to the paper) is recommended, but including URLs to data and code is permitted. ", "page_idx": 22}, {"type": "text", "text": "6. Experimental Setting/Details ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Question: Does the paper specify all the training and test details (e.g., data splits, hyperparameters, how they were chosen, type of optimizer, etc.) necessary to understand the results? ", "page_idx": 22}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 22}, {"type": "text", "text": "Justification: This paper provides the details of the experiments sufficiently. Guidelines: ", "page_idx": 22}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments. \u2022 The experimental setting should be presented in the core of the paper to a level of detail that is necessary to appreciate the results and make sense of them. \u2022 The full details can be provided either with the code, in appendix, or as supplemental material. ", "page_idx": 22}, {"type": "text", "text": "7. Experiment Statistical Significance ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Question: Does the paper report error bars suitably and correctly defined or other appropriate information about the statistical significance of the experiments? ", "page_idx": 22}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Justification: This paper reports error bars $95\\%$ confidence interval) for the main experiment (Figure 3). ", "page_idx": 22}, {"type": "text", "text": "Guidelines: ", "page_idx": 22}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The authors should answer \"Yes\" if the results are accompanied by error bars, confidence intervals, or statistical significance tests, at least for the experiments that support the main claims of the paper.   \n\u2022 The factors of variability that the error bars are capturing should be clearly stated (for example, train/test split, initialization, random drawing of some parameter, or overall run with given experimental conditions).   \n\u2022 The method for calculating the error bars should be explained (closed form formula, call to a library function, bootstrap, etc.)   \n\u2022 The assumptions made should be given (e.g., Normally distributed errors).   \n\u2022 It should be clear whether the error bar is the standard deviation or the standard error of the mean.   \n\u2022 It is OK to report 1-sigma error bars, but one should state it. The authors should preferably report a 2-sigma error bar than state that they have a $96\\%$ CI, if the hypothesis of Normality of errors is not verified.   \n\u2022 For asymmetric distributions, the authors should be careful not to show in tables or figures symmetric error bars that would yield results that are out of range (e.g. negative error rates).   \n\u2022 If error bars are reported in tables or plots, The authors should explain in the text how they were calculated and reference the corresponding figures or tables in the text. ", "page_idx": 22}, {"type": "text", "text": "", "page_idx": 23}, {"type": "text", "text": "8. Experiments Compute Resources ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: For each experiment, does the paper provide sufficient information on the computer resources (type of compute workers, memory, time of execution) needed to reproduce the experiments? ", "page_idx": 23}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 23}, {"type": "text", "text": "Justification: Peak memory usages and time of executions are main concerns of this paper.   \nThis paper also provide information on computer resources in Section A.4. ", "page_idx": 23}, {"type": "text", "text": "Guidelines: ", "page_idx": 23}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The paper should indicate the type of compute workers CPU or GPU, internal cluster, or cloud provider, including relevant memory and storage.   \n\u2022 The paper should provide the amount of compute required for each of the individual experimental runs as well as estimate the total compute.   \n\u2022 The paper should disclose whether the full research project required more compute than the experiments reported in the paper (e.g., preliminary or failed experiments that didn\u2019t make it into the paper). ", "page_idx": 23}, {"type": "text", "text": "9. Code Of Ethics ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: Does the research conducted in the paper conform, in every respect, with the NeurIPS Code of Ethics https://neurips.cc/public/EthicsGuidelines? ", "page_idx": 23}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Justification: Yes, this paper does. ", "page_idx": 23}, {"type": "text", "text": "Guidelines: ", "page_idx": 23}, {"type": "text", "text": "\u2022 The answer NA means that the authors have not reviewed the NeurIPS Code of Ethics.   \n\u2022 If the authors answer No, they should explain the special circumstances that require a deviation from the Code of Ethics.   \n\u2022 The authors should make sure to preserve anonymity (e.g., if there is a special consideration due to laws or regulations in their jurisdiction). ", "page_idx": 23}, {"type": "text", "text": "10. Broader Impacts ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: Does the paper discuss both potential positive societal impacts and negative societal impacts of the work performed? ", "page_idx": 23}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Justification: This paper discusses societal impacts in Section 7. ", "page_idx": 23}, {"type": "text", "text": "Guidelines: ", "page_idx": 23}, {"type": "text", "text": "\u2022 The answer NA means that there is no societal impact of the work performed.   \n\u2022 If the authors answer NA or No, they should explain why their work has no societal impact or why the paper does not address societal impact.   \n\u2022 Examples of negative societal impacts include potential malicious or unintended uses (e.g., disinformation, generating fake profiles, surveillance), fairness considerations (e.g., deployment of technologies that could make decisions that unfairly impact specific groups), privacy considerations, and security considerations.   \n\u2022 The conference expects that many papers will be foundational research and not tied to particular applications, let alone deployments. However, if there is a direct path to any negative applications, the authors should point it out. For example, it is legitimate to point out that an improvement in the quality of generative models could be used to generate deepfakes for disinformation. On the other hand, it is not needed to point out that a generic algorithm for optimizing neural networks could enable people to train models that generate Deepfakes faster.   \n\u2022 The authors should consider possible harms that could arise when the technology is being used as intended and functioning correctly, harms that could arise when the technology is being used as intended but gives incorrect results, and harms following from (intentional or unintentional) misuse of the technology.   \n\u2022 If there are negative societal impacts, the authors could also discuss possible mitigation strategies (e.g., gated release of models, providing defenses in addition to attacks, mechanisms for monitoring misuse, mechanisms to monitor how a system learns from feedback over time, improving the efficiency and accessibility of ML). ", "page_idx": 23}, {"type": "text", "text": "", "page_idx": 24}, {"type": "text", "text": "11. Safeguards ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Question: Does the paper describe safeguards that have been put in place for responsible release of data or models that have a high risk for misuse (e.g., pretrained language models, image generators, or scraped datasets)? ", "page_idx": 24}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 24}, {"type": "text", "text": "Justification: This paper poses no such risks. ", "page_idx": 24}, {"type": "text", "text": "Guidelines: ", "page_idx": 24}, {"type": "text", "text": "\u2022 The answer NA means that the paper poses no such risks.   \n\u2022 Released models that have a high risk for misuse or dual-use should be released with necessary safeguards to allow for controlled use of the model, for example by requiring that users adhere to usage guidelines or restrictions to access the model or implementing safety filters.   \n\u2022 Datasets that have been scraped from the Internet could pose safety risks. The authors should describe how they avoided releasing unsafe images.   \n\u2022 We recognize that providing effective safeguards is challenging, and many papers do not require this, but we encourage authors to take this into account and make a best faith effort. ", "page_idx": 24}, {"type": "text", "text": "12. Licenses for existing assets ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Question: Are the creators or original owners of assets (e.g., code, data, models), used in the paper, properly credited and are the license and terms of use explicitly mentioned and properly respected? ", "page_idx": 24}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 24}, {"type": "text", "text": "Justification: This paper explicitly mentioned and properly respected the assets used in this paper. ", "page_idx": 24}, {"type": "text", "text": "Guidelines: ", "page_idx": 24}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not use existing assets.   \n\u2022 The authors should cite the original paper that produced the code package or dataset.   \n\u2022 The authors should state which version of the asset is used and, if possible, include a URL.   \n\u2022 The name of the license (e.g., CC-BY 4.0) should be included for each asset.   \n\u2022 For scraped data from a particular source (e.g., website), the copyright and terms of service of that source should be provided.   \n\u2022 If assets are released, the license, copyright information, and terms of use in the package should be provided. For popular datasets, paperswithcode.com/datasets has curated licenses for some datasets. Their licensing guide can help determine the license of a dataset.   \n\u2022 For existing datasets that are re-packaged, both the original license and the license of the derived asset (if it has changed) should be provided. ", "page_idx": 24}, {"type": "text", "text": "\u2022 If this information is not available online, the authors are encouraged to reach out to the asset\u2019s creators. ", "page_idx": 25}, {"type": "text", "text": "13. New Assets ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "Question: Are new assets introduced in the paper well documented and is the documentation provided alongside the assets? ", "page_idx": 25}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 25}, {"type": "text", "text": "Justification: The code of the supplementary material has its document README.md. Guidelines: ", "page_idx": 25}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not release new assets.   \n\u2022 Researchers should communicate the details of the dataset/code/model as part of their submissions via structured templates. This includes details about training, license, limitations, etc.   \n\u2022 The paper should discuss whether and how consent was obtained from people whose asset is used.   \n\u2022 At submission time, remember to anonymize your assets (if applicable). You can either create an anonymized URL or include an anonymized zip file. ", "page_idx": 25}, {"type": "text", "text": "14. Crowdsourcing and Research with Human Subjects ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "Question: For crowdsourcing experiments and research with human subjects, does the paper include the full text of instructions given to participants and screenshots, if applicable, as well as details about compensation (if any)? ", "page_idx": 25}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 25}, {"type": "text", "text": "Justification: This paper does not involve such crowdsourcing nor research with human subjects. ", "page_idx": 25}, {"type": "text", "text": "Guidelines: ", "page_idx": 25}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Including this information in the supplemental material is fine, but if the main contribution of the paper involves human subjects, then as much detail as possible should be included in the main paper.   \n\u2022 According to the NeurIPS Code of Ethics, workers involved in data collection, curation, or other labor should be paid at least the minimum wage in the country of the data collector. ", "page_idx": 25}, {"type": "text", "text": "15. Institutional Review Board (IRB) Approvals or Equivalent for Research with Human Subjects ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "Question: Does the paper describe potential risks incurred by study participants, whether such risks were disclosed to the subjects, and whether Institutional Review Board (IRB) approvals (or an equivalent approval/review based on the requirements of your country or institution) were obtained? ", "page_idx": 25}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 25}, {"type": "text", "text": "Justification: This paper does not involve such crowdsourcing nor research with human subjects. ", "page_idx": 25}, {"type": "text", "text": "Guidelines: ", "page_idx": 25}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Depending on the country in which research is conducted, IRB approval (or equivalent) may be required for any human subjects research. If you obtained IRB approval, you should clearly state this in the paper.   \n\u2022 We recognize that the procedures for this may vary significantly between institutions and locations, and we expect authors to adhere to the NeurIPS Code of Ethics and the guidelines for their institution.   \n\u2022 For initial submissions, do not include any information that would break anonymity (if applicable), such as the institution conducting the review. ", "page_idx": 25}]