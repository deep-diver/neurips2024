[{"figure_path": "eUcyIe1AzY/figures/figures_1_1.jpg", "caption": "Figure 1: The ground truth discrete ODM (two-way contingency table) can be reconstructed through either multiple expensive ABM simulations [2] (ABM rectangle) or approximated by a continuous representation A coupled with the Harris-Wilson SDE (SIM rectangle). In the latter, the ground truth can be reconstructed by sampling in the discrete combinatorial space of constrained ODMs conditioned on A (GENSIT rectangle). ABM simulations scale with O(M log(M)) compared to GENSIT which scales with O(IJ), where M \u226b I + J is the size of the agent interaction graph.", "description": "This figure illustrates three different approaches for generating origin-destination matrices (ODMs):  Agent-based models (ABMs), Spatial Interaction Models (SIMs) using the Harris-Wilson stochastic differential equation (SDE), and the proposed Generative Neural Spatial Interaction Tables (GeNSIT) method.  It highlights the computational cost differences between the methods, showing that ABMs are computationally expensive, scaling with O(M log(M)), while GeNSIT scales linearly with O(IJ), where M is much larger than I+J (the number of origin-destination pairs).  The figure shows how GeNSIT improves upon SIMs by directly sampling from the discrete space of ODMs conditioned on the continuous approximation from the SIM, thereby avoiding discretization errors.", "section": "1 Introduction"}, {"figure_path": "eUcyIe1AzY/figures/figures_1_2.jpg", "caption": "Figure 2: The space Tc of 3 \u00d7 3 discrete ODMs with summary statistics CT. Sampling on the continuous relaxation of Tc (A level) with quantisation can lead to either large rejection rates, or poor exploration of the distribution over Tc.", "description": "This figure illustrates the challenges of sampling discrete origin-destination matrices directly from the constrained space Tc.  The figure shows a 3x3 contingency table (ODM) with summary statistics (C_T) represented as constraints.  The space of possible tables satisfying the constraints is shown, and it is demonstrated that directly sampling from this constrained space is difficult, leading to either high rejection rates (many samples are rejected because they don't meet the constraints) or poor exploration of the distribution (samples don't sufficiently cover the entire space of valid tables).  The problem is further complicated by continuous approximations of the ODM using Spatial Interaction Models (SIMs), which require subsequent quantization, potentially introducing further errors.", "section": "1 Introduction"}, {"figure_path": "eUcyIe1AzY/figures/figures_4_1.jpg", "caption": "Figure 3: GENSIT: (a) successive iterations of Alg. 1 for a given ensemble member, (b) plate diagram for every iteration, ensemble member. We propose two schemes: a Joint and a Disjoint (see App. B.3.1 for details). Contrary to the latter, the former passes table T information to the loss L (see \u2212\u2212\u2212\u2192 in (b)). We perform an optimisation step in the intensity A space and a sampling step in T space, with associated complexities O(TJ + IJ) and O(IJ). The A arises by the well-known family of SIMs (3),(4) coupled with the HW-SDE (6). The T sampling step generates discrete CT-constrained ODMs contrary to [13, 17], which only operate on the continuous mean-field level A.", "description": "This figure illustrates the GENSIT framework.  Panel (a) shows the iterative process of the algorithm, moving between neural SIM calibration (intensity A) and Markov basis sampling (discrete ODM T). Panel (b) provides a plate diagram clarifying the model's structure and the flow of information, highlighting the 'joint' and 'disjoint' sampling schemes.  The joint scheme incorporates feedback from T into the loss function, whereas the disjoint scheme does not.  The figure also shows the complexities associated with intensity and table sampling.", "section": "3 Neural Calibration of Spatial Interaction Models"}, {"figure_path": "eUcyIe1AzY/figures/figures_7_1.jpg", "caption": "Figure 4: Total computation time (left) of GENSIT and SIM-NN [17] versus the number of origin-destination pairs IJ with (I \u00d7 J) equal to 100 \u00d7 100, 200 \u00d7 200, ..., 1000 \u00d7 1000. The two algorithms are run for N = 103 iterations with CT = {T.+, T+, TX50%}. Constraint TX50% means that 50% of table cells chosen uniformly at random are fixed. Total computation time is the sum of the T sampling (middle) and A learning (right) times. Intensity learning and table sampling times are computed for lines 6-12 and lines 19-24 of Alg. 1, respectively. Our framework scales linearly with IJ, which is much faster than SIM-MCMC and SIT-MCMC. SIM-NN does not operate at all in the discrete table space, which explains its faster computational speed.", "description": "This figure compares the computation time of GENSIT and SIM-NN for varying numbers of origin-destination pairs.  It shows that GENSIT's computation time scales linearly with the number of origin-destination pairs, while SIM-NN's time remains relatively constant.  The figure also breaks down the computation time into table sampling and intensity learning components.", "section": "4.1 Synthetic ODM Scalability"}, {"figure_path": "eUcyIe1AzY/figures/figures_7_2.jpg", "caption": "Figure 5: SRMSE by total number of agents A (left) and ODM dimension (I \u00d7 J) (right) of GENSIT's discrete ODM sampling (line 24 of Alg. 1) for N = 104 iterations, a fixed intensity A and CT = {T.+, TX50%}. On the left we set (I \u00d7 J) = 150 \u00d7 150. The reconstruction error (SRMSE) scales linearly in IJ and exponentially in A = T++.", "description": "This figure shows the results of an experiment evaluating the scalability and accuracy of the GENSIT method for reconstructing origin-destination matrices (ODMs).  The left panel shows that the SRMSE (a measure of reconstruction error) scales exponentially with the total number of agents (A) in the system, while the right panel demonstrates that the SRMSE scales linearly with the dimension (I x J) of the ODM. These results highlight that, while GENSIT scales linearly in the number of origin-destination pairs, the error increases rapidly with the number of agents.", "section": "4.1 Synthetic ODM Scalability"}, {"figure_path": "eUcyIe1AzY/figures/figures_9_1.jpg", "caption": "Figure 6: SRMSE and CP for C = {T.+} (\u2022), {T.+, T+., TX2} (\u25b2) computed cumulatively along N iterations of Alg. 1 for T|D, C samples for GENSIT (Joint) and SIT-MCMC for the Cambridge dataset. The Joint GENSIT converges to a lower SRMSE faster than SIT-MCMC while achieving better T* coverage. The singly constrained ODM (C = {T.+}) has very large support Te given that CP is decreasing with N. See App. E for all cases of C and frameworks.", "description": "This figure compares the performance of the proposed GENSIT (Joint) algorithm against SIT-MCMC in terms of SRMSE and CP for different constraint sets. The results indicate that GENSIT (Joint) achieves lower SRMSE and higher CP than SIT-MCMC, particularly when considering more complex constraint sets, demonstrating its effectiveness in estimating origin-destination matrices.", "section": "4.2.1 Cambridge, UK"}, {"figure_path": "eUcyIe1AzY/figures/figures_19_1.jpg", "caption": "Figure 3: GENSIT: (a) successive iterations of Alg. 1 for a given ensemble member, (b) plate diagram for every iteration, ensemble member. We propose two schemes: a Joint and a Disjoint (see App. B.3.1 for details). Contrary to the latter, the former passes table T information to the loss L (see  - -\u25ba in (b)). We perform an optimisation step in the intensity A space and a sampling step in T space, with associated complexities O(TJ + IJ) and O(IJ). The A arises by the well-known family of SIMs (3),(4) coupled with the HW-SDE (6). The T sampling step generates discrete CT-constrained ODMs contrary to [13, 17], which only operate on the continuous mean-field level A.", "description": "This figure illustrates the GENSIT framework, showing the iterative process of neural SIM calibration and discrete ODM sampling.  Panel (a) depicts the iterative steps for a single ensemble member, while panel (b) provides a plate diagram representing the process across all ensemble members and iterations. Two sampling schemes are compared: Joint and Disjoint, differing in how table T information is used in the loss function calculation. The framework combines continuous optimization in the intensity (A) space with discrete sampling in the discrete origin-destination matrix (T) space, leveraging the Harris-Wilson SDE to model the continuous intensity. This approach enables efficient generation of constrained discrete ODMs, unlike previous methods that only operate at the continuous level.", "section": "3 Neural Calibration of Spatial Interaction Models"}, {"figure_path": "eUcyIe1AzY/figures/figures_21_1.jpg", "caption": "Figure 3: GENSIT: (a) successive iterations of Alg. 1 for a given ensemble member, (b) plate diagram for every ensemble member. We propose two schemes: a Joint and a Disjoint (see App. B.3.1 for details). Contrary to the latter, the former passes table T information to the loss L (see \u2212\u2212\u2192 in (b)). We perform an optimisation step in the intensity A space and a sampling step in T space, with associated complexities O(TJ + IJ) and O(IJ). The A arises by the well-known family of SIMs (3),(4),(5) coupled with the HW-SDE (6). The T sampling step generates discrete CT-constrained ODMs contrary to [13, 17], which only operate on the continuous mean-field level A.", "description": "This figure illustrates the GENSIT framework, showing its iterative process.  Panel (a) depicts a single ensemble member's iterations through Algorithm 1. Panel (b) provides a plate diagram illustrating the entire ensemble and the relationships between the different components. The framework involves both a continuous (intensity A) and a discrete (ODM T) space.  The key difference between the Joint and Disjoint schemes is the information flow; the Joint scheme incorporates the discrete table T into the loss function, whereas the Disjoint scheme does not.  Both schemes involve neural calibration of the underlying spatial interaction model (SIM) parameters using the Harris-Wilson SDE.", "section": "3 Neural Calibration of Spatial Interaction Models"}, {"figure_path": "eUcyIe1AzY/figures/figures_23_1.jpg", "caption": "Figure 3: GENSIT: (a) successive iterations of Alg. 1 for a given ensemble member, (b) plate diagram for every iteration, ensemble member. We propose two schemes: a Joint and a Disjoint (see App. B.3.1 for details). Contrary to the latter, the former passes table T information to the loss L (see  in (b)). We perform an optimisation step in the intensity A space and a sampling step in T space, with associated complexities O(TJ + IJ) and O(IJ). The A arises by the well-known family of SIMs (3),(4),(5) coupled with the HW-SDE (6). The T sampling step generates discrete CT-constrained ODMs contrary to [13, 17], which only operate on the continuous mean-field level A.", "description": "This figure illustrates the proposed Generative Neural Spatial Interaction Tables (GENSIT) framework.  Panel (a) shows the iterative process of the algorithm, highlighting the steps involved in neural SIM calibration, Markov basis sampling, and the overall flow. Panel (b) provides a plate diagram, visualizing the structure and dependencies between different variables in a single iteration and across ensemble members.  The figure emphasizes the framework's ability to operate in both continuous (intensity A) and discrete (table T) spaces, contrasting it with existing approaches that only work in the continuous domain. The two schemes, Joint and Disjoint, are distinguished based on whether the table T information is passed to the loss function or not.", "section": "3 Neural Calibration of Spatial Interaction Models"}]