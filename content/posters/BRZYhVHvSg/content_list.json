[{"type": "text", "text": "Multi-Group Proportional Representation in Retrieval ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Alex Oesterling\u2217 Claudio Mayrink Verdun\u2217 Carol Xuan Long Alexander Glynn Harvard University Harvard University Harvard University Harvard University ", "page_idx": 0}, {"type": "text", "text": "Lucas Monteiro Paes Sajani Vithana Martina Cardone Flavio P. Calmon Harvard University Harvard University University of Minnesota Harvard University ", "page_idx": 0}, {"type": "text", "text": "Abstract ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Image search and retrieval tasks can perpetuate harmful stereotypes, erase cultural identities, and amplify social disparities. Current approaches to mitigate these representational harms balance the number of retrieved items across population groups defined by a small number of (often binary) attributes. However, most existing methods overlook intersectional groups determined by combinations of group attributes, such as gender, race, and ethnicity. We introduce Multi-Group Proportional Representation (MPR), a novel metric that measures representation across intersectional groups. We develop practical methods for estimating MPR, provide theoretical guarantees, and propose optimization algorithms to ensure MPR in retrieval. We demonstrate that existing methods optimizing for equal and proportional representation metrics may fail to promote MPR. Crucially, our work shows that optimizing MPR yields more proportional representation across multiple intersectional groups specified by a rich function class, often with minimal compromise in retrieval accuracy. Code is provided at https://github.com/ alex-oesterling/multigroup-proportional-representation. ", "page_idx": 0}, {"type": "text", "text": "1 Introduction ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "A recognized objective in fair machine learning (ML) is discovering, reporting, and mitigating representational harms [1\u20133]. Representational harms arise when systems reinforce and perpetuate the marginalization of population groups based on characteristics such as race, socioeconomic status, cultural background, and gender [1, 4\u20136]. These harms often manifest through the biased portrayal or misrepresentation of these groups, stereotype reinforcement, and erasure of cultural identities [7, 8]. Representational harms have been widely documented in ML systems. For instance, many freely available datasets used in ML are not geo-diverse [9], and generative models can output images that under-represent demographic minorities across gender and racial identities [10\u201312]. ", "page_idx": 0}, {"type": "text", "text": "We focus on representation in retrieval tasks. Representational harms in retrieval and ranking tasks arise when retrieved items do not accurately reflect the true diversity and proportions present in reality, perpetuating harmful stereotypes and biases [13]. For instance, Kay et al. [2] demonstrated that, in 2015, only $\\bar{10}\\%$ of the top 100 results for CEO in Google Image Search were women, despite $28\\%$ of CEOs in the US being women, and recent studies [14, 15] have demonstrated that this bias is still present in modern image search engines. Later, Otterbacher et al. [16] showed that the search engine Bing usually produced twice as many men as compared to women when queried with the word \u201cperson\u201d. Finally, [17] systematically studied gender biases in image representations by auditing the four most important image search engines: Google, Bing, Baidu, and Yandex. In particular, among other findings, this study showed that when a qualifier such as \u201cintelligent\u201d is added to the query \u201cperson\u201d, the engines still exhibit a significant gender discrepancy; see also [1, Chapter 7]. When retrieval is based on a search over vector embeddings of images and text, biases in embedding models can propagate to retrieved results, leading to disparate representation of people by demographic groups such as gender or race [18\u201320], as well as propagating spurious correlations from the dataset more broadly [21] or distorting results due to stereotypes present in the representation [22]. Though correlations between unrelated semantic concepts do not necessarily constitute representational harms, a wealth of research charts undesirable bias in embedding models, including publicly available vision-language embedding models such as CLIP [23] used for retrieval. Bias in embeddings can lead to bias in retrieval [24\u201326]. In fact, recent work by Srinivasan et al. [27] argues that many image retrieval systems lack \u201csocial diversity\u201d as perceived by humans. ", "page_idx": 0}, {"type": "text", "text": "", "page_idx": 1}, {"type": "text", "text": "Several interventions aim to control gross statistical deviations in group representations in retrieval. A common approach is ensuring equal representation of pre-defined population groups in retrieved items [28, 29]. An alternative goal is proportional representation (PR) [20, 30], where the target representation of different groups is proportional to some reference population or statistic. Various interventions have been proposed to achieve equal or proportional representation, including optimizing for diversity in addition to the similarity in retrieval [27, 31], directly selecting the objects retrieved based on balancing known or predicted sensitive attributes [29] and, for vector databases, modifying embeddings directly to remove information about group-defining attributes [18, 20]. ", "page_idx": 1}, {"type": "text", "text": "Achieving proportional representation across multiple intersectional groups is challenging, as existing fairness interventions typically consider only a small number of pre-defined groups. Ensuring representation across individual groups (e.g., given by gender or race) does not guarantee representation across intersectional groups (e.g., given by gender and race), as demonstrated in Table 1 (and Table 5 in the Appendix). The study of intersectionality and its consequences is rooted in work in law and the social sciences [32\u201334] and has been a well-discussed problem for several decades. In machine learning systems, lack of intersectional representation can contribute to the invisibility of historically marginalized groups determined by multiple axes of identity [35], or their mistreatment through \u201cfairness gerrymandering,\u201d where interventions on fairness for specific groups may harm fairness on intersectional subgroups [36]. However, as the number of group-denoting attributes increases, the number of intersectional groups grows exponentially, quickly surpassing the number of retrieved items and limiting the achievable proportional representation. In fact, achieving optimal proportional representation across multiple attributes has been shown to be NP-hard [37]. ", "page_idx": 1}, {"type": "text", "text": "We propose a metric called Multi-group Proportional Representation (MPR) to quantify the representation of intersectional groups in retrieval tasks. MPR measures the worst-case deviation between the average values of a collection of representation statistics computed over retrieved items relative to a reference population whose representation we aim to match. The set of representation statistics is given by a function class $\\mathcal{C}$ , where each function $c\\in{\\mathcal{C}}$ maps a retrieved item $x$ to a real number. For instance, $c(x)\\in\\{-1,1\\}$ may denote binary group membership for an input $x$ . In theory, $\\mathcal{C}$ can be given by bounded complexity function classes, such as linear functions or shallow decision trees. In practice, $\\mathcal{C}$ are functions defined over item attributes, such as vector embeddings or group-denoting labels, enabling MPR to measure proportional representation across complex, intersectional subgroups. Compared to naively counting the number of retrieved items across a (potentially exponential) number of pre-defined groups, MPR offers a more flexible, scalable, and theoretically grounded metric for multi-group representation in retrieval. ", "page_idx": 1}, {"type": "text", "text": "In addition to introducing and carefully motivating the MPR metric, cf. Section 2, we make three contributions. First, we show how to compute MPR for several function classes in Section 3. Computing MPR relies on a curated dataset that represents the desired population whose proportional representation we aim to reflect in retrieved items. We derive sample complexity bounds for the size of this curated dataset based on the complexity of the function class $\\mathcal{C}$ . We also prove that MPR can be computed in closed form for certain function classes or with a regression oracle. Second, we propose MOPR, an algorithm that retrieves items from a vector database to maximize their average similarity to a query embedding while satisfying an MPR constraint relative to the curated dataset (Section 4). MOPR achieves this by iteratively calling an oracle that computes MPR violations, yielding both relevant and representative retrieved items. Third, we evaluate MOPR on retrieval tasks using datasets such as CelebA [38], the Occupations dataset [31], Fairface [39], and UTKFace [40]. In section 5, we show that MOPR Pareto-dominates competing approaches in balancing retrieval similarity and MPR. ", "page_idx": 1}, {"type": "text", "text": "Related Work. Broadly speaking, existing work on fair and diverse retrieval with pretrained embeddings either: 1) modifies the embedding space to prioritize downstream fairness, or 2) provides retrieval algorithms optimizing for diversity or fairness. ", "page_idx": 2}, {"type": "text", "text": "Mitigating Bias in Embedding Space. Various approaches have been proposed to produce vector embeddings of text and images that target diversity or mitigate bias. These include modifying loss functions to encourage group fairness [41], adversarial training [42, 43], disentangling representations [44], and in-processing fair sampling methods for gender imbalance [18]. Many popular embedding models are not trained with such approaches, so post-processing methods for fairness have also been developed for multimodal models such as CLIP [23], including CLIP-clip [18], CLIP-debias [20], and FairCLIP [19]. Recent work by Srinivasan et al. [27] builds upon the pretrained image-text model CoCa and leverages text-guided projections to extract an embedding, called PATHS, that captures complex notions of diversity in people, and then conduct diverse retrieval with a greedy algorithm. However, code for implementing and reproducing PATHS embeddings was not available at the time of publication. In our experiments, we report the MPR achieved by CLIP-clip and CLIP-debias in retrieval tasks and approximate the greedy retrieval algorithm proposed in [27] with vanilla CLIP embeddings. Unlike the aforementioned methods, MOPR is not based on modifying embeddings. ", "page_idx": 2}, {"type": "text", "text": "Retrieval Algorithms with Diversity or Fairness. Instead of modifying embeddings, several methods aim to promote diversity, given possibly biased embeddings. Given an additional diversity constraint, a popular approach is Maximal Marginal Relevance (MMR) [45], where items are greedily retrieved in order to maximize a linear combination of similarity and diversity metrics. Celis et al. [30] and Celis and Keswani [31] focus on diversity and fairness in image retrieval, using a reweighing method that combines similarity and MMR to select diverse yet relevant images. Alternatively, the PostHoc Bias Mitigation [29] method aims to achieve equal representation over a pre-defined attribute (such as gender) through calls to an oracle classifier and selecting a balanced group of images. We extend this prior work in two key ways: (i) we aim to achieve proportional representation across intersectional groups, going beyond the representation of two groups defined by binary attributes; (ii) MOPR explicitly balances MPR and retrieval similarity via an optimization that controls for both, offering an efficient alternative to greedy MMR-based methods. ", "page_idx": 2}, {"type": "text", "text": "Diversity Metrics. A traditional measure of diversity for a set is the pairwise similarity of the retrieved items [46]. However, the general visual (dis)similarity metric is insufficient in optimizing for peoplerelated diversity such as skin tone or gender [30]. When the attribute (e.g., race) along which diversity is optimized is known, or, in other words, we have access to a ground truth attribute label, one can use fairness definition-derived metrics such as proportional representation (see next section and [47]). For more complex notions of diversity that aim to capture intersectional or subtle sociocultural identities (e.g., cultural backgrounds, lifestyles, nationalities, religions), human annotators can be employed to determine if the selected set of images is more diverse than the baseline (retrieval based on similarity to query only) [27]. MPR complements existing metrics by providing a rigorous approach to measuring representation across complex, intersectional groups defined by a rich class of functions. However, as with any fairness metric, MPR has limitations \u2013 see Section 6 \u2013 and may not always align with human perceptions of representation. In particular, we underscore the importance of involving stakeholders in defining representation goals and auditing retrieval systems. ", "page_idx": 2}, {"type": "text", "text": "Multi-Group Fairness. Our work is directly informed by the burgeoning literature on multi-group fairness in classification, particularly the work of H\u00e9bert-Johnson et al. [48], Kim et al. [49, 50] who proposed rigorous frameworks of multi-group fairness auditing and post-processing to ensure fair predictions across identifiable subgroups. Recent efforts in this field include [51\u201353], which analyze sample complexity aspects of measuring and reporting multi-group representation, and [54, 55] who develop stronger variants of multi-group fairness notions. Unlike prior work, we focus on multi-group representation in retrieval rather than multi-group fairness in classification and regression. ", "page_idx": 2}, {"type": "text", "text": "Multi-Attribute Proportional Representation. A recognized challenge in computational social choice research is building committees, groups, or sets of items that ensure proportional representation across several attributes [56\u201359]. The work most closely related to ours is by Lang and Skowron [37], which introduced the problem of multi-attribute proportional representation, where a set of items must be selected to reflect desired distributions over multiple attributes simultaneously. Their work established fundamental computational complexity results, showing that finding optimal proportional representation is NP-hard, and developed approximation algorithms and integer linear programs for promoting proportional representation across attributes. While our work shares similar goals, our MPR metric takes a different approach by measuring the worst-case deviation over computationally-identifiable groups defined by a function class $\\mathcal{C}$ . This formulation connects naturally with statistical learning theory through MMD [60] and sample complexity bounds (Propositions 1 and 2). Though we use the term multi-group rather than multi-attribute to emphasize connections with the burgeoning literature on multi-group fairness [48, 49], both terms describe related problems of ensuring representation across multiple dimensions. We also highlight that work on multi-attribute representation in computational social choice (including [37]) strives for proportional representation marginally on each attribute, while our primary goal with this work is to achieve intersectional representation. Finally, while [37] similarly seeks to match retrieved candidates to a target distribution, we focus on database retrieval rather than social choice applications. The rich history of proportional representation in social choice theory and political sciences provides, however, an important context for our work. We briefly discuss these connections in Appendix E. There, we elaborate on how our approach relates to and differs in terms of representation formulation from [37]. ", "page_idx": 2}, {"type": "text", "text": "", "page_idx": 3}, {"type": "text", "text": "2 A Multi-Group Proportional Representation Metric ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "Preliminaries. Consider a retrieval dataset of items from which we aim to retrieve relevant entries, denoted by $\\mathcal{D}_{R}=\\{\\pmb{x}_{1}^{r},...,\\pmb{x}_{n}^{r}\\}$ . We assume that $\\pmb{x}_{i}^{r}\\in\\mathbb{R}^{d}\\times\\mathcal{G}$ , where $\\mathcal{G}$ is a set of additional labels for each item. For example, items $\\pmb{x}_{i}^{r}$ can be $d$ -dimensional embeddings of images, videos, or textual content, in which case $\\mathcal{G}=\\emptyset$ . Alternatively, $\\pmb{x}_{i}^{r}=(\\mathbf{e}_{i},\\mathbf{g}_{i})$ , where $\\mathbf{e}_{i}\\in\\mathbb{R}^{d}$ is an embedding and $\\mathbf{g}_{i}$ is a vector of labels indicating group membership (e.g., gender, race, ethnicity). ", "page_idx": 3}, {"type": "text", "text": "Given a query embedding $\\mathbf{q}\\in\\mathbb{R}^{d}$ , the goal of retrieval is to search and return the top- $k$ most similar items to $\\mathbf{q}$ in $\\mathcal{D}_{R}$ . The similarity between an embedding of $\\mathbf{q}$ and items in $\\mathcal{D}_{R}$ is measured according to a metric $\\kappa:\\mathbb{R}^{d}\\times\\mathbb{R}^{d}\\to\\mathbb{R}$ . Throughout the paper, we assume that $\\mathcal{D}_{R}$ is a vector database and $\\kappa$ is cosine similarity between embeddings, though this formulation can be generalized. To retrieve items from $\\mathcal{D}_{R}$ , users prompt a query $q$ (e.g., \"Fortune 500 CEOs\") which is then embedded $\\mathbb{R}^{d}$ . Ideally, the user receives $k$ retrieved items $\\mathcal{R}(\\mathbf{q})=\\{\\pmb{x}_{1}^{r},...,\\pmb{x}_{k}^{r}\\}\\subset\\mathcal{D}_{R}$ such that $\\kappa(\\mathbf{q},\\pmb{x}_{i}^{r})\\geq\\kappa(\\mathbf{q},\\pmb{x})$ for all $\\mathbf{\\Delta}x\\notin\\mathcal{R}(\\mathbf{q})$ and $i\\in[k]$ . ", "page_idx": 3}, {"type": "text", "text": "The simplest setting for measuring representation is to consider only two population groups denoted by a binary variable \u2013 a setting commonly found in the fair retrieval and generation literature [18, 19]. In this case, group membership is determined by a group-denoting function $c:\\mathbb{R}^{d}\\times\\mathcal{G}\\rightarrow\\{-1,1\\}$ . For an item $\\pmb{x}_{i}^{r}$ , $\\bar{c}(\\pmb{x}_{i}^{r})$ indicates membership to group $-1$ or 1 (e.g., male/female) based on its embedding $\\mathbf{e}_{i}$ and associated labels $\\mathbf{g}_{i}$ . If the retrieval dataset $\\mathcal{D}_{R}$ contains annotations for group membership, $c(\\pmb{x}_{i}^{r})$ can simply return the relevant feature from $\\mathbf{g}_{i}$ . However, when group labels are not present (i.e., $\\mathcal{G}=\\emptyset$ ), $c(\\pmb{x}_{i}^{r})$ can be implemented as a classifier that predicts group membership based on the item\u2019s embedding ${\\bf{e}}_{i}$ . ", "page_idx": 3}, {"type": "text", "text": "With a group-denoting function $c(\\pmb{x}^{r})$ in hand, we can measure the representation of each group in a set of retrieved items $\\mathcal{R}(\\mathbf{q})$ . One popular constraint for representation is equal representation [2, 28], which aims to ensure that the number of retrieved items in each group is approximately the same, i.e., $\\begin{array}{r}{\\frac{1}{k}\\sum_{\\mathbf{x}^{r}\\in\\mathcal{R}(\\mathbf{q})}c(\\mathbf{x}^{r})\\approx0}\\end{array}$ . An alternative metric is proportional representation [20, 61], which quantifies the deviation of group membership from a reference distribution $Q$ . Methods that promote proportional representation aim to ensure $\\begin{array}{r}{\\frac{\\hbar}{k}\\sum_{{\\pmb x}^{r}\\in\\mathcal{R}({\\bf q})}c({\\pmb x}^{r})\\approx\\mathbb{E}_{Q}\\left[c(X)\\right]}\\end{array}$ . Here, the measure $Q$ captures the distribution of a reference population whose representation statistics we aim to match. For example, if $Q$ were the distribution of individuals in the US, $\\mathbb{E}_{Q}\\left[c(X)\\right]$ could measure the proportion of men vs. women in the US and be approximated using Census data. ", "page_idx": 3}, {"type": "text", "text": "Proportional representation generalizes equal representation since different groups are rarely uniformly distributed over a given population. Naturally, the choice of distribution $Q$ is application and context-dependent \u2013 we revisit the choice of $Q$ below. Importantly, if $Q$ is biased, then biases will be propagated to the retrieved items. ", "page_idx": 3}, {"type": "text", "text": "Multi-Group Proportional Representation. We aim to ensure that retrieved items represent individuals from diverse and intersectional population groups. Instead of measuring proportional representation in terms of the average of a single group-denoting function $c(\\pmb{x}^{r})$ , we consider a class of $Q$ -measurable functions, the representation statistics class, $\\mathcal{C}\\subset\\{c:\\mathbb{R}^{d}\\times\\mathcal{G}\\rightarrow\\mathbb{R}\\}$ . This set $\\mathcal{C}$ may represent multiple, potentially uncountable overlapping groups. We formally define multi-group proportional representation next. ", "page_idx": 3}, {"type": "text", "text": "Definition 1. For a reference representation distribution $Q$ , a set of $Q$ -measurable set of representation statistics $\\mathcal{C}$ , and a set of $k$ retrieved items $\\mathcal{R}$ , we define the Multi-Group Proportional Representation $(M P R)$ metric as ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\mathrm{MPR}(\\mathcal{C},\\mathcal{R},Q)\\triangleq\\operatorname*{sup}_{c\\in\\mathcal{C}}\\left|\\frac{1}{k}\\sum_{\\pmb{x}^{r}\\in\\mathcal{R}}c(\\pmb{x}^{r})-\\mathbb{E}_{Q}[c(X)]\\right|.\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "A set of items $\\mathcal{R}$ is $(\\mathcal{C},\\rho)$ -multi-group proportional representative of $Q$ if $\\mathrm{MPR}(\\mathcal{C},\\mathcal{R},Q)\\leq\\rho$ . ", "page_idx": 4}, {"type": "text", "text": "The MPR metric quantifies the \u201crepresentativeness\u201d of a rich class of statistics, denoted by functions in $\\mathcal{C}$ , within a set of retrieved items $\\mathcal{R}$ . This generalization is crucial for capturing intersectional groups. For example, $\\mathcal{C}$ could contain functions that map items to demographic groups based on race, gender, age, or combinations thereof. Alternatively, when labels in $\\mathcal{G}$ contain such group-denoting attributes, $\\mathcal{C}$ can represent decision trees of a given depth over features (e.g., all combinations of pairs of race, gender, and age). The MPR metric compares the empirical average of each $c\\in{\\mathcal{C}}$ over the retrieved set $\\mathcal{R}$ to its expectation under the reference distribution $Q$ . By defining $Q$ appropriately, we can flexibly specify different statistical representation goals, such as equal representation $(\\mathbb{E}_{Q}[c(X)]=0$ for binary $c$ ) or proportional representation w.r.t. a target population. Measuring representation requires defining what constitutes \u201cfair and proportional representation.\u201d While equal representation may suffice for binary groups, proportional representation of more complex intersectional groups requires care. The choice of representation reference statistics (given by the distribution Q in the definition of MPR) should be application-dependent, context-aware, and culturally sensitive. ", "page_idx": 4}, {"type": "text", "text": "Remark 1. MPR is equivalent to the maximum mean discrepancy (MMD) of representation statistics in $\\mathcal{C}$ between the empirical distribution over retrieved items $\\mathcal{R}$ and the reference distribution $Q$ . MMD-based metrics have a long history [60, 62] and are used in hypothesis testing for comparing distributions. MMD is a particular case of the Integral Probability Metric (IPM) [63, 64], allowing us to borrow from the rich literature on IPMs to measure and ensure MPR in practice. ", "page_idx": 4}, {"type": "text", "text": "Remark 2. MPR can be viewed as the \u201crepresentation in retrieval\u201d counterpart of multi-group fairness metrics found in classification, such as multiaccuracy [49] and multicalibration [48]. Whereas multiaccuracy and multicalibration measure if classification error residuals are correlated with any group represented within a class $\\mathcal{C}$ , MPR captures proportional representation of groups in $\\mathcal{C}$ within a set of retrieved items \u2013 a fundamentally different problem. The idea of representing groups in terms of a \u201ccomputationally identifiable\u201d class of functions $\\mathcal{C}$ is directly inspired by the multi-group fairness in classification literature, and we adopt similar notation (i.e., $c$ and $\\mathcal{C}$ ). ", "page_idx": 4}, {"type": "text", "text": "Curated Datasets for Proportional Representation. A key challenge in computing MPR is selecting the reference representation distribution $Q$ and measuring the expectation of functions in $\\mathcal{C}$ against this distribution. In the simple case where $\\mathcal{C}$ consists of a small number of functions indicating membership in individual groups, we could potentially set the proportional representation targets $\\mathbb{E}_{Q}[c(X)]$ for each group $c\\in{\\mathcal{C}}$ manually, e.g., by defining a target fraction of men/women or individuals from different ethnic backgrounds. This quickly becomes infeasible when there are many intersectional groups \u2013 and impossible if $\\mathcal{C}$ is uncountable. Moreover, in most practical settings, $Q$ will very likely not have a simple closed-form analytical expression. ", "page_idx": 4}, {"type": "text", "text": "In practice, i.i.d. samples drawn for $Q$ may be available. For instance, the retrieval dataset $\\mathcal{D}_{R}$ itself may be drawn from the target population for which we aim to preserve proportional representation in retrieved items. Alternatively, we may have access to a dataset that was carefully curated to be representative of a diverse population. Examples include the FairFace dataset [39], which was designed to be balanced across race, gender, and age groups, and the AVFS dataset [65]. More generally, we refer to datasets with samples drawn from the target population $Q$ as a curated dataset. ", "page_idx": 4}, {"type": "text", "text": "Definition 2 (Curated Dataset). Let $Q$ be a probability distribution over $\\mathbb{R}^{d}\\times\\mathcal{G}$ tailored to account for diversity and representation of stakeholders who query the retrieval dataset. The curated dataset with $m$ samples drawn the distribution $Q$ is denoted as $\\mathcal{D}_{C}\\triangleq\\{\\pmb{x}_{1}^{c},...,\\pmb{x}_{m}^{c}\\}$ . We denote the MPR of a set of retrieved items $\\mathcal{R}$ relative to the empirical distribution over $\\mathcal{D}_{C}$ as $\\mathrm{MPR}(\\mathcal{C},\\mathcal{R},\\mathcal{D}_{C})$ . ", "page_idx": 4}, {"type": "text", "text": "Constructing a proper $\\mathcal{D}_{C}$ is critical to properly measuring bias and preventing downstream harms, and the nature of $\\mathcal{D}_{C}$ is context-dependent and may vary based on the specific application and desired representation goals. We reiterate that if the curated dataset is biased, then these biases will be propagated to downstream usages of MPR. For these reasons, we recommend that curated datasets used for MPR measurements be developed and verified through participatory design approaches [66, 67] in collaboration with diverse stakeholders. By involving stakeholders in defining representation goals, we can help ensure that the proportional representation in information retrieval systems measured by MPR aligns with the values and needs of the user base these systems serve. ", "page_idx": 4}, {"type": "text", "text": "", "page_idx": 5}, {"type": "text", "text": "Finally, we note that we can also condition the curated dataset on a given query. Specifically, for a query q, we can retrieve relevant samples from both the curated dataset $\\mathcal{D}_{C}$ and the retrieval dataset $\\mathcal{D}_{R}$ . The samples retrieved from $\\mathcal{D}_{C}$ can then serve as a \u201cconditional\u201d curated dataset, denoted as $\\mathcal{D}_{C|\\mathbf{q}}$ , which captures the desired representation target specific to the query q. This approach allows for a more granular and context-aware proportional representation. ", "page_idx": 5}, {"type": "text", "text": "In the next two sections, we introduce theoretical guarantees and algorithms that are agnostic to the specific choice of $\\mathcal{D}_{C}$ . In other words, our proposed methods for measuring and promoting MPR in retrieval are general and can be applied regardless of how the curated dataset is constructed. In our numerical experiments, presented in Section 5, we use FairFace [39] as the curated dataset. ", "page_idx": 5}, {"type": "text", "text": "3 Computing Multi-Group Proportional Representation ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "Computing MPR in Defnition 1 requires approximating two quantities: the representation distribution $Q$ and the supremum $\\operatorname{sup}_{c\\in{\\mathcal{C}}}$ . We first establish generalization bounds for approximating $Q$ using i.i.d. samples. We then show how to compute $\\operatorname{sup}_{c\\in C}$ for several classes of representation statistics $\\mathcal{C}$ . ", "page_idx": 5}, {"type": "text", "text": "Error in approximation $Q$ via a curated dataset. Proposition 1, proved in Appendix C, bounds the deviation between the empirical MPR computed over the curated dataset $\\mathcal{D}_{C}$ drawn i.i.d. from reference distribution $Q$ and the true MPR measured over $Q$ . ", "page_idx": 5}, {"type": "text", "text": "Proposition 1 (Generalization Gap of MPR). Let $\\mathbf{\\mathcal{R}}(q)=\\{\\mathbf{x}_{i}^{r}\\}_{i=1}^{k}$ be a set of $k$ retrieved samples, $\\bar{D_{C}}\\bar{=}\\ \\{x_{i}^{c}\\}_{i=1}^{m}$ be a curated dataset comprised of $m$ i.i.d. samples from a target representation distribution $Q$ , and $\\delta>0$ . If $\\mathcal{C}=\\{c:\\mathcal{R}^{d}\\times\\mathcal{G}\\rightarrow\\{-1,1\\}\\}$ with Rademacher complexity $\\mathcal{R}_{m}(\\mathcal{C})$ then, with probability at least $1-\\delta$ , ", "page_idx": 5}, {"type": "equation", "text": "$$\n|\\mathrm{MPR}(\\mathcal{C},\\mathcal{R},\\mathcal{D}_{C})-\\mathrm{MPR}(\\mathcal{C},\\mathcal{R},Q)|\\leq\\mathcal{R}_{m}(\\mathcal{C})+\\sqrt{\\frac{\\log{(2/\\delta)}}{8m}}.\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "We can extend Proposition 1 to any set of bounded functions $\\mathcal{C}$ (see, e.g., bounds on empirical MMD estimates in [60]). Note that the guarantee in (2) only holds for a single set of retrieved items $\\mathcal{R}$ in response to a query. Proposition 2 provides a bound on the size $m$ of an i.i.d. curated dataset $\\mathcal{D}_{C}$ that ensures an $\\epsilon$ -accurate estimate of MPR for a set of $M$ queries. ", "page_idx": 5}, {"type": "text", "text": "Proposition 2 (Query Budget Guarantee). Consider any set of $M$ queries $\\mathcal{Q}=\\left\\{\\mathbf{q}_{1},...,\\mathbf{q}_{M}\\right\\}$ where $M\\in\\mathbb{N}.$ . Let ${\\mathsf{V C}}({\\mathcal{C}})$ denote the VC-dimension of the class $\\mathcal{C}$ with range in $\\{-1,1\\}$ . For $\\epsilon>0$ , $i f\\,\\mathcal{D}_{C}$ consists of m i.i.d. samples drawn from $Q$ where $m$ satisfies ", "page_idx": 5}, {"type": "equation", "text": "$$\nm\\ge\\frac{32\\mathsf{V}\\mathsf{C}(\\mathcal{C})}{\\epsilon^{2}}+\\frac{2\\log\\left(\\frac{2M}{\\delta}\\right)}{2\\epsilon^{2}},\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "then, with probability at least $1-\\delta,\\,|\\mathrm{MPR}(\\mathcal{C},\\mathcal{R},\\mathcal{D}_{C})-\\mathrm{MPR}(\\mathcal{C},\\mathcal{R},Q)|\\leq\\epsilon.$ ", "page_idx": 5}, {"type": "text", "text": "The above results provide guidelines on the size of the curated dataset required to accurately estimate MPR relative to a true target representation distribution $Q$ . If the class of representation statistics $\\mathcal{C}$ is very complex (in the VC-dimension sense), then the size $m$ of the curated dataset $\\mathcal{D}_{C}$ must be proportionally large to represent $Q$ accurately. Hence, the curation dataset should be designed having in mind (i) the number of diverse queries being asked and (ii) the complexity of the function class $\\mathcal{C}$ . While Proposition 2 provides a conservative bound, as generalization bounds are often not tight [68], these results nevertheless offer insight into the relationship between the complexity of $\\mathcal{C}$ and the accuracy of MPR estimation. ", "page_idx": 5}, {"type": "text", "text": "In the remainder of the paper, we assume that MPR is computed against a fixed curated dataset $\\mathcal{D}_{C}$ of size $m$ . We consider four specific instantiations of the set of representation statistics $\\mathcal{C}$ : (i) $\\mathcal{C}$ is closed under scalar multiplication, i.e., if $c\\in{\\mathcal{C}}$ , then $\\lambda c\\in{\\mathcal{C}}$ for any $\\lambda\\in\\mathbb{R}$ , (ii) $\\mathcal{C}$ is a set of functions taking values in $\\{-1,1\\}$ ; (iii) $\\mathcal{C}$ consists of linear functions; and (iv) $\\mathcal{C}$ consists of functions in a Reproducing Kernel Hilbert Space (RKHS). Next, we show that for cases (i) and (ii) MPR can be computed using calls to an oracle that performs regression over $\\mathcal{C}$ and, for linear functions (iii), MPR has a simple closed-form expression. Due to its technical nature, we defer the calculation of MPR for functions in an RKHS to Appendix D.2. ", "page_idx": 5}, {"type": "text", "text": "", "page_idx": 6}, {"type": "text", "text": "Computing MPR via Mean Square Error (MSE) Minimization. When $\\mathcal{C}$ is closed under multiplication or consists of binary functions with values $-1,1$ , MPR can be expressed as an MSE minimization. This enables us to compute MPR by leveraging existing black-box oracles that perform regression under quadratic loss, such as regressors implemented in scikit-learn [69]. ", "page_idx": 6}, {"type": "text", "text": "The key observation for expressing MPR as an MSE minimization is that MPR can be formulated as a maximum correlation problem. Consider the (row-wise) concatenation of the retrieval dataset $\\mathcal{D}_{R}$ and the curated dataset $\\mathcal{D}_{C}$ , given by $\\mathbf{X}\\triangleq[\\pmb{\\mathscr{x}}_{1}^{r},...,\\pmb{\\mathscr{x}}_{n}^{r},\\pmb{\\mathscr{x}}_{1}^{c},...,\\pmb{\\mathscr{x}}_{m}^{c}]$ , where $\\pmb{x}_{i}$ is the $i$ -th entry of $\\mathbf{X}$ For the remainder of this section, we consider a fixed set of retrieved items $\\mathcal{R}$ . Let ${\\mathbf a}\\in\\{0,1\\}^{n}$ be a vector indicating items that are retrieved from $\\mathcal{D}_{R}$ for a given query, i.e., $a_{i}=1\\Leftrightarrow\\pmb{x}_{i}^{r}\\in\\mathcal{R}$ . Under this notation, where retrieved items are indicated by the vector a, MPR can be reformulated as ", "page_idx": 6}, {"type": "equation", "text": "$$\n\\mathrm{MPR}(\\mathcal{C},\\mathcal{R},\\mathcal{D}_{C})=\\operatorname*{sup}_{c\\in\\mathcal{C}}\\left|\\frac{1}{k}\\sum_{i=1}^{n}a_{i}c(\\pmb{x}_{i}^{r})-\\frac{1}{m}\\sum_{i=1}^{m}c(\\pmb{x}_{i}^{c})\\right|=\\operatorname*{sup}_{c\\in\\mathcal{C}}\\left|\\sum_{i=1}^{n+m}c(\\pmb{x}_{i})\\widetilde{a}_{i}\\right|,\n$$", "text_format": "latex", "page_idx": 6}, {"type": "text", "text": "wherea \u2208Rn+m has i-th entry given byai \u225c1i\u2264n aki \u22121i>n m1 . This reformulation will be useful for explicitly casting MPR-constrained retrieval as an optimization problem. ", "page_idx": 6}, {"type": "text", "text": "When $\\mathcal{C}$ consists of binary functions in range $\\{-1,1\\}$ , MPR is equivalent to regression over $\\mathcal{C}$ of $\\widetilde{\\mathbf{a}}$ under quadratic loss, since ", "page_idx": 6}, {"type": "equation", "text": "$$\n\\operatorname*{inf}_{c\\in{\\mathcal C}}\\sum_{i=1}^{n+m}\\left(c(\\pmb{x}_{i})-\\widetilde{a}_{i}\\right)^{2}=n+m+\\widetilde{\\mathbf{a}}^{\\intercal}\\widetilde{\\mathbf{a}}+2\\operatorname*{sup}_{c\\in{\\mathcal C}}\\sum_{i=1}^{n+m}c(\\pmb{x}_{i})\\widetilde{a}_{i}.\n$$", "text_format": "latex", "page_idx": 6}, {"type": "text", "text": "The absolute value in (4) can be recovered by regressing $-\\widetilde{{\\mathbf a}}$ instead of $\\widetilde{\\mathbf{a}}$ . ", "page_idx": 6}, {"type": "text", "text": "Most classes of regression functions in $\\mathbb{R}$ are closed under scalar multiplication (e.g., multiplying the output of a decision tree regressor by a constant still yields a decision tree regressor). However, in this case, it follows from (4) that MPR is unbounded. Even for bounded $\\mathcal{C}$ , without proper normalization MPR can scale with dataset size, which is undesirable for a representational measure. We constrain $\\mathcal{C}$ to a set of normalized functions for MPR to be bounded and independent of dataset size. This constraint also allows us to cast MPR as an MSE minimization over $\\mathcal{C}$ . We formally state this result next, proven in Appendix C, which will be applied in Section 4 to develop a cutting-plane-based algorithm for ensuring MPR in retrieval called MOPR. ", "page_idx": 6}, {"type": "text", "text": "Proposition 3. Let $\\begin{array}{r}{\\mathcal{C}^{\\prime}\\triangleq\\{c\\in\\mathcal{C}\\:\\vert\\:\\sum_{i=1}^{m+n}c(\\pmb{x}_{i})^{2}=\\frac{m k}{m+k}\\}}\\end{array}$ where $\\mathcal{C}$ is closed under scalar multiplication. Let $c(\\mathbf{X})=[c(\\mathbf{x_{1}}),...,c(\\mathbf{x_{n+m}})]$ . Then $0\\leq\\mathrm{MPR}(\\mathcal{C}^{\\prime},\\mathcal{R},\\mathcal{D}_{C})\\leq1$ , and for any ", "page_idx": 6}, {"type": "equation", "text": "$$\nc^{*}\\in\\underset{c\\in\\mathcal{C}}{\\arg\\operatorname*{inf}}\\,\\sum_{i=1}^{n+m}(c(\\pmb{x}_{i})-\\widetilde{a}_{i})^{2},\n$$", "text_format": "latex", "page_idx": 6}, {"type": "text", "text": "let $\\hat{c}:\\mathcal{X}\\rightarrow\\mathbb{R}$ be defined as $\\begin{array}{r}{\\hat{c}(\\mathbf{x})=\\frac{\\sqrt{m k/(m+k)}}{\\|c^{*}(\\mathbf{X})\\|_{2}}c^{*}(\\mathbf{x})}\\end{array}$ . Then, we have that ", "page_idx": 6}, {"type": "equation", "text": "$$\n\\hat{c}\\in\\underset{c\\in\\mathcal{C}^{\\prime}}{\\arg\\operatorname*{sup}}\\left|\\sum_{i=1}^{n+m}c(\\pmb{x}_{i})\\widetilde{\\boldsymbol{a}}_{i}\\right|.\n$$", "text_format": "latex", "page_idx": 6}, {"type": "text", "text": "Computing MPR for Bounded-Norm Linear Regression. Recall that each item in the retrieval or curated datasets is of the form $x_{i}=(e_{i},g_{i})$ , where $e_{i}$ is an embedding and $g_{i}$ are labels. When $x_{i}\\in\\mathbb{R}^{l}$ (i.e., the labels have numerical values), we can consider $\\mathcal{C}$ as a linear set of functions over retrieved items. In this case, MPR enjoys a closed-form expression, as stated in the next proposition. ", "page_idx": 6}, {"type": "text", "text": "Proposition 4. Let items in the retrieval and curated datasets be vectors in $\\mathbb{R}^{l}$ for $l<m+n$ and $\\mathcal{C}=\\left\\{x\\mapsto w^{\\mathsf{T}}x\\ |\\ w\\in\\mathbb{R}^{k}\\right\\}$ . Moreover, let $\\mathbf{X}\\in\\mathbb{R}^{(m+n)\\times l}$ be the matrix formed by concatenating items in the retrieval and curated dataset $\\mathcal{D}_{R}$ and $\\mathcal{D}_{C}$ , respectively. For $\\mathcal{C^{\\prime}}$ in Proposition 3, we have ", "page_idx": 6}, {"type": "equation", "text": "$$\n\\mathrm{MPR}(\\mathcal{C^{\\prime}},\\mathcal{R},\\mathcal{D}_{C})=\\sqrt{\\frac{m k}{m+k}}\\left\\|\\mathbf{U}_{l}^{\\sf T}\\widetilde{\\mathbf{a}}\\right\\|_{2},\n$$", "text_format": "latex", "page_idx": 6}, {"type": "text", "text": "Input: $\\mathcal{D}_{R}$ , query q, number of iterations $T$ , number of items to retrieve $k$ , MPR constraint $\\rho$ , Oracle(a)   \nthat computes solves (4) and returns $c\\in{\\mathcal{C}}$ that approximates the sup.   \n1: $\\tilde{c}\\gets\\hat{\\emptyset}$ , $s_{i}=\\kappa(\\pmb{x}_{i}^{r},q)$   \n2:  for iter $\\in\\{1,2,...,T\\}$ do   \n3: a \u2190arg maxa\u2208[0,1]n a\u22bas subject to $\\begin{array}{r}{\\left|\\frac{1}{k}\\sum_{i=1}^{n}a_{i}c(\\pmb{x}_{i}^{r})-\\frac{1}{m}\\sum_{i=1}^{m}c(\\pmb{x}_{i}^{c})\\right|\\leq\\rho}\\end{array}$ for $c\\in{\\widetilde{\\mathcal{C}}}$   \n4: $(\\mathtt{m p r_{-}v i o l a t i o n},c)\\gets0\\mathtt{r a c l e}(\\mathbf{a})$ \u25b7Solve (4)   \n5: if mpr_violation $\\le\\rho$ or ${\\mathtt{i t e r}}=T$ then   \n6: return $\\mathcal{R}\\leftarrow\\left\\{\\pmb{x}_{i}^{r}\\in\\mathcal{D}_{R}\\right.$ corresponding to $k$ largest entries of $a_{i}\\}$   \n7: else   \n8: $\\widetilde{\\mathcal{C}}\\gets\\widetilde{\\mathcal{C}}\\cup\\{c\\}$   \n9: end if   \n10: end for ", "page_idx": 7}, {"type": "text", "text": "where $\\mathbf{X}\\,=\\,\\mathbf{U}\\Sigma\\mathbf{V}^{\\top}$ is the SVD of $\\mathbf{X}$ and $\\mathbf{U}_{l}\\;\\in\\;\\mathbb{R}^{(m+n)\\times l}$ are the left singular vectors in U corresponding to the top- $l$ largest singular values. ", "page_idx": 7}, {"type": "text", "text": "Proposition 4 can be directly adapted to linear functions defined only over embeddings or a subset of features of retrieved items. The closed-form expression for MPR in (8) also allows MPR-constrained retrieval to be computed by a quadratic program, as discussed in Appendix D.1. ", "page_idx": 7}, {"type": "text", "text": "4 Promoting Multi-Group Proportional Representation in Retrieval Tasks ", "text_level": 1, "page_idx": 7}, {"type": "text", "text": "We develop an optimization framework for retrieving the $k$ most similar items in a vector database to a given query $\\mathbf{q}$ while satisfying a target MPR threshold of $\\rho$ . We formulate the retrieval goal as maximizing the average similarity between a query and retrieved items, given by $s_{i}=\\kappa(\\pmb{x}_{i}^{r},\\mathbf{q})$ (recall Section 2 for notation), where $\\kappa(\\pmb{x}_{i}^{r},\\mathbf{q})$ is given by cosine similarity in our experiments. The problem of maximizing utility in retrieval while satisfying an MPR constraint (expressed as Eq. (4)) can be formulated as the integer program: ", "page_idx": 7}, {"type": "equation", "text": "$$\n\\operatorname*{max}_{\\mathbf{a}\\in\\{0,1\\}^{n}}\\;\\mathbf{a}^{\\mathsf{T}}\\mathbf{s}\\;\\;\\mathrm{subject}\\;\\mathbf{0}\\;\\;\\operatorname*{sup}_{c\\in\\mathcal{C}}\\left|\\frac{1}{k}\\sum_{i=1}^{n}a_{i}c(\\pmb{x}_{i}^{r})-\\frac{1}{m}\\sum_{i=1}^{m}c(\\pmb{x}_{i}^{c})\\right|\\leq\\rho,\\quad\\sum_{i=1}^{k}a_{i}=k.\n$$", "text_format": "latex", "page_idx": 7}, {"type": "text", "text": "When $\\mathcal{C}$ is given by normalized linear functions as in Proposition 4, the integer constraints can be relaxed to $\\mathbf{a}\\in[0,1]^{n}$ and the optimization can be approximated via standard quadratic solvers; see Appendix D.1. ", "page_idx": 7}, {"type": "text", "text": "Multi-Group Optimized Proportional Retrieval. We approximate (9) via the Multi-Group Optimized Proportional Retrieval Algorithm (MOPR), described in Algorithm 1. MOPR is essentially a cutting-plane method that aims to find a set of $k$ items that maximize utility while approximately satisfying an MPR constraint of $\\rho$ . The algorithm iterates between (i) a call to an oracle that computes MPR and returns a function $c\\in{\\mathcal{C}}$ that achieves the supremum in (4) and (ii) a call to a linear program (LP) solver that approximates the top- $k$ most similar items to a query subject to linear constraints on the violation measured by $c$ . Each oracle call adds an additional constraint to the LP solver which, in turn, approximates the top- $k$ items under an increasing set of constraints. The solution of the LP is rounded to satisfy the integer constraint a $\\in\\{0,1\\}^{n}$ . In our implementation, we assume that MPR can be computed via MSE minimization (cf. Section 3) \u2013 in which case we consider the normalized class $\\mathcal{C}^{\\prime}$ . The oracle call consists of running a black-box quadratic loss minimization over $\\mathcal{C}$ and normalizing. ", "page_idx": 7}, {"type": "text", "text": "Interestingly, we observe that, despite relaxing the integer constraints in each LP call, the solution to the relaxed problem is very sparse and (after rounding) approximates well the solution of the ideal integer program (9) for moderate values of $\\rho$ . However, the method can fail to accurately approximate the IP solution when $\\rho$ is small. We present a more detailed analysis of MOPR in Appendix D, which discusses potential convergence issues with the cutting plane method as well as stopping conditions. ", "page_idx": 7}, {"type": "image", "img_path": "BRZYhVHvSg/tmp/5dc26e7477a9cdfa6cbc2296d9e40ea81eff8b3df0e8c00a2e3a95edd0180d4e.jpg", "img_caption": ["Figure 1: Fraction of Top- $\\cdot k$ cosine similarity vs Fraction of Top- $k$ MPR averaged over 10 queries for $k=50$ images retrieved. From Left-to-Right: CelebA, UTKFaces, Occupations. Values are normalized so Top- $\\cdot k$ MPR and similarity is the point (1,1). MOPR Pareto-dominates baselines and significantly closes the MPR gap. "], "img_footnote": [], "page_idx": 8}, {"type": "text", "text": "5 Numerical Experiments ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "In this section, we show that MOPR is effective in promoting more proportional representation across intersectional groups while preserving similarity between retrieved items and a given query. Notably, MOPR Pareto-dominates competing benchmarks in terms of achieved MPR gap and utility. ", "page_idx": 8}, {"type": "text", "text": "Datasets. We conduct retrieval over three image datasets of faces: CelebA [38], which includes labels for gender, age, and various other attributes, UTKFace [40], which contains gender, age, and race attributes, and Occupations [2], which contains gender attributes. We compute MPR for equal representation by constructing a synthetic dataset $\\mathcal{D}_{C}$ balanced over all attributes and for proportional representation using FairFace [39] as the curated dataset $\\mathcal{D}_{C}$ , since it is a carefully designed dataset of faces with subgroup attributes for race, gender, and age. In all cases, each dataset entry consists of an image (CLIP) embedding $\\mathbf{e}_{i}$ and a set of labels $\\mathbf{g}_{i}$ . ", "page_idx": 8}, {"type": "text", "text": "Benchmarks. We compare our method with four baselines. DebiasCLIP [20] modifies text queries with a prepended learned embedding for debiased retrieval but does not allow for tunable control of the representation-similarity trade-off, so it only results in a single retrieval set over which we compute similarity and MPR. CLIP-Clip [18] trims features from CLIP embeddings that have high \u201cmutual information\u201d with gender, allowing for control of how many features are clipped from the embedding. PBM [29] post-processes CLIP embeddings to mitigate bias by predicting gender attributes and subsampling from each gender equally. PBM also allows tuning the representation-similarity tradeoff by controlling the likelihood of sampling at random or in a balanced manner from the retrieval dataset. Finally, the state-of-the-art for fair retrieval first constructs PATHS embeddings [27], which use a set of adjective-noun keywords to capture a broad set of identity vectors in vision-language models, and then greedily samples using the MMR [45] algorithm to navigate the representation-similarity tradeoff. However, the authors\u2019 method of computing PATHS embeddings is not public, so we used CLIP embeddings to replicate their algorithm. We refer to this method as MMR. For a detailed discussion of these algorithms and their approaches to representation, see Appendix E. ", "page_idx": 8}, {"type": "text", "text": "Experimental Setup. We consider three classes of representation statistics $\\mathcal{C}$ : linear regression, decision trees, and MLPs (the last two are presented in Appendix G). In both cases, we compute MPR over $\\mathcal{C}^{\\prime}$ , i.e., $\\mathcal{C}$ normalized over the retrieval and curated datasets (see Prop. 3). We report results over 10 queries for occupations suggested by ChatGPT 3.5 (Appendix H) and an additional 45 occupations for the the Occupations dataset. To accelerate retrieval, we query each of our retrieval datasets for the top 10k items according to the prompt \u201cA photo of a {query}\" in terms of raw similarity using FAISS [70]. We similarly retrieve the top $10\\mathbf{k}$ items from FairFace as the query-conditioned curated dataset $\\mathcal{D}_{C}$ . One reason we first fliter for the top 10k items is the runtime of MMR, which is a greedy algorithm that traverses the full dataset for each retrieval $k$ (even for $10\\mathbf{k}$ entries and $k=50$ retrieved items, MMR takes hours to run for 10 queries). ", "page_idx": 8}, {"type": "text", "text": "In order to evaluate representation over interpretable population groups, we consider that representation statistics $\\mathcal{C}$ are computed only over labels $\\mathbf{g}_{i}$ given in FairFace. These labels are not present in all retrieval datasets. Thus, for CelebA and Occupations, we train linear probes on FairFace\u2019s CLIP embeddings to predict their race and age attributes, and when using UTKFace, we map from FairFace\u2019s race labels to UTKFace\u2019s race labels by mapping Southeast Asian and East Asian to Asian and Middle Eastern and Latino_Hispanic to Other. While the fair ML community should engage in broader discussions addressing the ethics of predicting sensitive attributes from CLIP embeddings [71] (especially given that CLIP itself has been found to be biased) and the issues surrounding the grouping and re-grouping of diverse racial identities, we acknowledge that these are larger-scale issues that our work does not presume to address. ", "page_idx": 8}, {"type": "table", "img_path": "BRZYhVHvSg/tmp/5244315dd187ababcbd44e263071f27a9429f74012e883217c92bc67a1fbb6b8.jpg", "table_caption": ["Table 1: Retrieval averaged over 10 queries with 50 retrievals on UTKFace dataset [40] for MOPR, $k$ -NN, and MMR [27]. Entries indicate average percentage representation in retrieved items. MOPR is able to balance representation across classes, whereas $k$ -NN and MMR miss intersectional groups (highlighted in red). "], "table_footnote": [], "page_idx": 9}, {"type": "text", "text": "", "page_idx": 9}, {"type": "text", "text": "We retrieve $k=50$ items for each of the above queries. For a given function class and query, we compute the baseline MPR and average cosine similarity given by the top 50 most similar items. Then, we conduct a parameter sweep over $\\rho$ starting from this max-MPR value, inputting each value to MOPR in Algorithm 1. We normalize our results such that the Top- $k$ MPR and similarity are the point (1,1) on each graph, and each point measures the fraction of Top- $k$ MPR and similarity. ", "page_idx": 9}, {"type": "text", "text": "Results. In Fig. 1 we report results for proportional representation for the query \u201cA photo of a programmer\u201d with respect to FairFace for linear regression models, with additional results for other queries, as well as decision trees and MLPs in Appendix G (Figs. 8-19). We observe that MOPR Pareto-dominates benchmark methods, and is able to preserve similarity while reaching lower levels of MPR. Methods based on directly modifying embeddings or queries for a single group attribute such as CLIP-Clip and DebiasCLIP only partially reduce MPR at a high utility cost. This is because these methods do not modify the retrieval algorithm but use an unbiased embedding and hope by chance that the retrieved items will be representational. The most competitive method to ours is the retrieval algorithm MMR, which is our attempt to replicate PATHS. Though MMR is competitive to ours for large MPR, it fails to achieve small values of MPR relative to MOPR. It is also notable that MOPR can drive MPR to near zero for UTKFace, yet gaps remain in CelebA and Occupations, indicating this gap may be caused by the use of probes to estimate group attribute labels. ", "page_idx": 9}, {"type": "text", "text": "In Table 1, we construct a synthetic curation set with an equal number of each group attribute. This allows us to evaluate the performance of MOPR in achieving equal representation. We conduct a similar hyperparameter sweep as above, and take the retrieval set with the minimum MPR averaged over all 10 queries to fairly compare the best possible representation of each method.2 Our results demonstrate that MOPR can exactly achieve our equal representation goals when provided with an equally-balanced curation dataset, whereas prior baselines (see DebiasCLIP, CLIP-Clip, and PBM in Appendix Table 5) underrepresent several intersectional groups. ", "page_idx": 9}, {"type": "text", "text": "6 Concluding Remarks ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "In this work, we introduced a novel retrieval metric called Multi-group Proportional Representation (MPR) and developed algorithms to ensure MPR in retrieval tasks. By measuring deviations in a set of representation statistics, MPR provides a scalable approach to quantifying and enforcing proportional representation for complex, intersectional groups. We analyzed the generalization properties and realizable regimes of MPR and, through experiments in image retrieval, demonstrated its favorable utility-fairness trade-off compared to existing fair retrieval algorithms. ", "page_idx": 9}, {"type": "text", "text": "7 Acknowledgements ", "text_level": 1, "page_idx": 10}, {"type": "text", "text": "The authors would like to thank the discussions with Filipe Goulart Cabral. This material is based upon work supported by the National Science Foundation under awards CAREER-1845852, CIF-1900750, CIF-2231707, and CIF-2312667, FAI-2040880, and also by the National Science Foundation Graduate Research Fellowship under Grant No. DGE-2140743. The views expressed here are those of the authors and do not reflect the official policy or position of the funding agencies. ", "page_idx": 10}, {"type": "text", "text": "References ", "text_level": 1, "page_idx": 10}, {"type": "text", "text": "[1] Solon Barocas, Moritz Hardt, and Arvind Narayanan. Fairness and machine learning: Limitations and opportunities. MIT Press, 2023.   \n[2] Matthew Kay, Cynthia Matuszek, and Sean A Munson. Unequal representation and gender stereotypes in image search results for occupations. In Proceedings of the 33rd annual acm conference on human factors in computing systems, pages 3819\u20133828, 2015.   \n[3] Kate Crawford. The trouble with bias, 2017. Accessed May 1, 2024. https://www.youtube. com/watch?v $=$ fMym_BKWQzk.   \n[4] Sarah Myers West, Meredith Whittaker, and Kate Crawford. Discriminating systems. AI Now, pages 1\u201333, 2019.   \n[5] Solon Barocas, Kate Crawford, Aaron Shapiro, and Hanna Wallach. The problem with bias: Allocative versus representational harms in machine learning. In 9th Annual conference of the special interest group for computing, information and society, page 1. Philadelphia, PA, USA, 2017.   \n[6] Sanjana Gautam, Pranav Narayanan Venkit, and Sourojit Ghosh. From melting pots to misrepresentations: Exploring harms in generative ai. arXiv preprint arXiv:2403.10776, 2024.   \n[7] Harini Suresh and John Guttag. A framework for understanding sources of harm throughout the machine learning life cycle. In Proceedings of the 1st ACM Conference on Equity and Access in Algorithms, Mechanisms, and Optimization, pages 1\u20139, 2021.   \n[8] Jared Katzman, Angelina Wang, Morgan Scheuerman, Su Lin Blodgett, Kristen Laird, Hanna Wallach, and Solon Barocas. Taxonomizing and measuring representational harms: A look at image tagging. In Proceedings of the AAAI Conference on Artificial Intelligence, volume 37, pages 14277\u201314285, 2023. [9] Shreya Shankar, Yoni Halpern, Eric Breck, James Atwood, Jimbo Wilson, and D Sculley. No classification without representation: Assessing geodiversity issues in open data sets for the developing world. arXiv preprint arXiv:1711.08536, 2017.   \n[10] Sasha Luccioni, Christopher Akiki, Margaret Mitchell, and Yacine Jernite. Stable bias: Evaluating societal representations in diffusion models. Advances in Neural Information Processing Systems, 36, 2024.   \n[11] Federico Bianchi, Pratyusha Kalluri, Esin Durmus, Faisal Ladhak, Myra Cheng, Debora Nozza, Tatsunori Hashimoto, Dan Jurafsky, James Zou, and Aylin Caliskan. Easily accessible text-to-image generation amplifies demographic stereotypes at large scale. In Proceedings of the 2023 ACM Conference on Fairness, Accountability, and Transparency, pages 1493\u20131504, 2023.   \n[12] Alexander Lin, Lucas Monteiro Paes, Sree Harsha Tanneru, Suraj Srinivas, and Himabindu Lakkaraju. Word-level explanations for analyzing bias in text-to-image models. arXiv preprint arXiv:2306.05500, 2023.   \n[13] Latanya Sweeney. Discrimination in online ad delivery. Communications of the ACM, 56(5): 44\u201354, 2013.   \n[14] Dana\u00eb Metaxa, Michelle A Gan, Su Goh, Jeff Hancock, and James A Landay. An image of society: Gender and racial representation and impact in image search results for occupations. Proceedings of the ACM on Human-Computer Interaction, 5(CSCW1):1\u201323, 2021.   \n[15] Yunhe Feng and Chirag Shah. Has CEO Gender Bias Really Been Fixed? Adversarial Attacking and Improving Gender Fairness in Image Search . In Proceedings of the AAAI Conference on Artificial Intelligence, volume 36, pages 11882\u201311890, 2022.   \n[16] Jahna Otterbacher, Jo Bates, and Paul Clough. Competent men and warm women: Gender stereotypes and backlash in image search results. In Proceedings of the 2017 chi conference on human factors in computing systems, pages 6620\u20136631, 2017.   \n[17] Roberto Ulloa, Ana Carolina Richter, Mykola Makhortykh, Aleksandra Urman, and Celina Sylwia Kacperski. Representativeness and face-ism: Gender bias in image search. new media & society, 26(6):3541\u20133567, 2024.   \n[18] Jialu Wang, Yang Liu, and Xin Wang. Are gender-neutral queries really gender-neutral? mitigating gender bias in image search. In Proceedings of the 2021 Conference on Empirical Methods in Natural Language Processing, pages 1995\u20132008, 2021.   \n[19] Junyang Wang, Yi Zhang, and Jitao Sang. Fairclip: Social bias elimination based on attribute prototype learning and representation neutralization. arXiv preprint arXiv:2210.14562, 2022.   \n[20] Hugo Berg, Siobhan Hall, Yash Bhalgat, Hannah Kirk, Aleksandar Shtedritski, and Max Bain. A prompt array keeps the bias away: Debiasing vision-language models with adversarial learning. In Proceedings of the 2nd Conference of the Asia-Pacific Chapter of the Association for Computational Linguistics and the 12th International Joint Conference on Natural Language Processing (Volume 1: Long Papers), pages 806\u2013822, 2022.   \n[21] Jae Myung Kim, A. Sophia Koepke, Cordelia Schmid, and Zeynep Akata. Exposing and mitigating spurious correlations for cross-modal retrieval. 2023 IEEE/CVF Conference on Computer Vision and Pattern Recognition Workshops (CVPRW), pages 2585\u20132595, 2023.   \n[22] Mohsen Abbasi, Sorelle A Friedler, Carlos Scheidegger, and Suresh Venkatasubramanian. Fairness in representation: quantifying stereotyping as a representational harm. In Proceedings of the 2019 SIAM International Conference on Data Mining, pages 801\u2013809. SIAM, 2019.   \n[23] Alec Radford, Jong Wook Kim, Chris Hallacy, Aditya Ramesh, Gabriel Goh, Sandhini Agarwal, Girish Sastry, Amanda Askell, Pamela Mishkin, Jack Clark, et al. Learning transferable visual models from natural language supervision. In International conference on machine learning, pages 8748\u20138763. PMLR, 2021.   \n[24] Siobhan Mackenzie Hall, Fernanda Gon\u00e7alves Abrantes, Hanwen Zhu, Grace Sodunke, Aleksandar Shtedritski, and Hannah Rose Kirk. Visogender: A dataset for benchmarking gender bias in image-text pronoun resolution. Advances in Neural Information Processing Systems, 36, 2024.   \n[25] Robert Wolfe and Aylin Caliskan. Markedness in visual semantic ai. In Proceedings of the 2022 ACM Conference on Fairness, Accountability, and Transparency, pages 1269\u20131279, 2022.   \n[26] Tolga Bolukbasi, Kai-Wei Chang, James Y Zou, Venkatesh Saligrama, and Adam T Kalai. Man is to computer programmer as woman is to homemaker? debiasing word embeddings. Advances in neural information processing systems, 29, 2016.   \n[27] Hansa Srinivasan, Candice Schumann, Aradhana Sinha, David Madras, Gbolahan Oluwafemi Olanubi, Alex Beutel, Susanna Ricco, and Jilin Chen. Generalized people diversity: Learning a human perception-aligned diversity representation for people images. arXiv preprint arXiv:2401.14322, 2024.   \n[28] Anay Mehrotra and Elisa Celis. Mitigating bias in set selection with noisy protected attributes. Proceedings of the 2021 ACM Conference on Fairness, Accountability, and Transparency, 2020.   \n[29] Fanjie Kong, Shuai Yuan, Weituo Hao, and Ricardo Henao. Mitigating test-time bias for fair image retrieval. Advances in Neural Information Processing Systems, 36, 2024.   \n[30] Elisa Celis, Vijay Keswani, Damian Straszak, Amit Deshpande, Tarun Kathuria, and Nisheeth Vishnoi. Fair and diverse dpp-based data summarization. In International conference on machine learning, pages 716\u2013725. PMLR, 2018.   \n[31] L Elisa Celis and Vijay Keswani. Implicit diversity in image summarization. Proceedings of the ACM on Human-Computer Interaction, 4(CSCW2):1\u201328, 2020.   \n[32] Kimberle Crenshaw. Demarginalizing the intersection of race and sex: A black feminist critique of antidiscrimination doctrine, feminist theory and antiracist politics. In University of Chicago Legal Forum, volume 1989, page 8, 1989.   \n[33] Kimberl\u00e9 Williams Crenshaw. Mapping the margins: Intersectionality, identity politics, and violence against women of color. In The public nature of private violence, pages 93\u2013118. Routledge, 2013.   \n[34] Sumi Cho, Kimberl\u00e9 Williams Crenshaw, and Leslie McCall. Toward a field of intersectionality studies: Theory, applications, and praxis. Signs: Journal of women in culture and society, 38 (4):785\u2013810, 2013.   \n[35] Joy Buolamwini and Timnit Gebru. Gender shades: Intersectional accuracy disparities in commercial gender classification. In Conference on fairness, accountability and transparency, pages 77\u201391. PMLR, 2018.   \n[36] Michael Kearns, Seth Neel, Aaron Roth, and Zhiwei Steven Wu. Preventing fairness gerrymandering: Auditing and learning for subgroup fairness. In International conference on machine learning, pages 2564\u20132572. PMLR, 2018.   \n[37] J\u00e9r\u00f4me Lang and Piotr Skowron. Multi-attribute proportional representation. Artificial Intelligence, 263:74\u2013106, 2018.   \n[38] Ziwei Liu, Ping Luo, Xiaogang Wang, and Xiaoou Tang. Deep learning face attributes in the wild. In Proceedings of International Conference on Computer Vision (ICCV), December 2015.   \n[39] Kimmo Karkkainen and Jungseock Joo. Fairface: Face attribute dataset for balanced race, gender, and age for bias measurement and mitigation. In Proceedings of the IEEE/CVF winter conference on applications of computer vision, pages 1548\u20131558, 2021.   \n[40] Zhifei Zhang, Yang Song, and Hairong Qi. Age progression/regression by conditional adversarial autoencoder. In IEEE Conference on Computer Vision and Pattern Recognition (CVPR). IEEE, 2017.   \n[41] Rich Zemel, Yu Wu, Kevin Swersky, Toni Pitassi, and Cynthia Dwork. Learning fair representations. In Sanjoy Dasgupta and David McAllester, editors, Proceedings of the 30th International Conference on Machine Learning, volume 28 of Proceedings of Machine Learning Research, pages 325\u2013333, Atlanta, Georgia, USA, 17\u201319 Jun 2013. PMLR.   \n[42] Harrison Edwards and Amos Storkey. Censoring representations with an adversary. In 4th International Conference on Learning Representations, pages 1\u201314, 2016.   \n[43] David Madras, Elliot Creager, Toniann Pitassi, and Richard Zemel. Learning adversarially fair and transferable representations. In Jennifer Dy and Andreas Krause, editors, Proceedings of the 35th International Conference on Machine Learning, volume 80 of Proceedings of Machine Learning Research, pages 3384\u20133393. PMLR, 10\u201315 Jul 2018.   \n[44] Elliot Creager, David Madras, J\u00f6rn-Henrik Jacobsen, Marissa Weis, Kevin Swersky, Toniann Pitassi, and Richard Zemel. Flexibly fair representation learning by disentanglement. In International conference on machine learning, pages 1436\u20131445. PMLR, 2019.   \n[45] Jaime Carbonell and Jade Goldstein. The use of mmr, diversity-based reranking for reordering documents and producing summaries. In Proceedings of the 21st annual international ACM SIGIR conference on Research and development in information retrieval, pages 335\u2013336, 1998.   \n[46] Barry Smyth and Paul McClave. Similarity vs. diversity. In International conference on case-based reasoning, pages 347\u2013361. Springer, 2001.   \n[47] Evaggelia Pitoura, Kostas Stefanidis, and Georgia Koutrika. Fairness in rankings and recommendations: an overview. The VLDB Journal, pages 1\u201328, 2022.   \n[48] Ursula H\u00e9bert-Johnson, Michael Kim, Omer Reingold, and Guy Rothblum. Multicalibration: Calibration for the (computationally-identifiable) masses. In International Conference on Machine Learning, pages 1939\u20131948. PMLR, 2018.   \n[49] Michael P Kim, Amirata Ghorbani, and James Zou. Multiaccuracy: Black-box post-processing for fairness in classification. In Proceedings of the 2019 AAAI/ACM Conference on AI, Ethics, and Society, pages 247\u2013254, 2019.   \n[50] Michael P Kim, Christoph Kern, Shafi Goldwasser, Frauke Kreuter, and Omer Reingold. Universal adaptability: Target-independent inference that competes with propensity scoring. Proceedings of the National Academy of Sciences, 119(4):e2108097119, 2022.   \n[51] Eliran Shabat, Lee Cohen, and Yishay Mansour. Sample complexity of uniform convergence for multicalibration. Advances in Neural Information Processing Systems, 33:13331\u201313340, 2020.   \n[52] Lucas Monteiro Paes, Ananda Theertha Suresh, Alex Beutel, Flavio Calmon, and Ahmad Beirami. Multi-group fairness evaluation via conditional value-at-risk testing. arXiv preprint arXiv:2312.03867, 2023.   \n[53] Parikshit Gopalan, Lunjia Hu, and Guy N Rothblum. On computationally efficient multi-class calibration. arXiv preprint arXiv:2402.07821, 2024.   \n[54] Parikshit Gopalan, Michael P Kim, Mihir A Singhal, and Shengjia Zhao. Low-degree multicalibration. In Conference on Learning Theory, pages 3193\u20133234. PMLR, 2022.   \n[55] Zhun Deng, Cynthia Dwork, and Linjun Zhang. Happymap: A generalized multicalibration method. In 14th Innovations in Theoretical Computer Science Conference, ITCS 2023, page 41. Schloss Dagstuhl-Leibniz-Zentrum fur Informatik GmbH, Dagstuhl Publishing, 2023.   \n[56] Bailey Flanigan, Paul G\u00f6lz, Anupam Gupta, Brett Hennig, and Ariel D Procaccia. Fair algorithms for selecting citizens\u2019 assemblies. Nature, 596(7873):548\u2013552, 2021.   \n[57] Edith Elkind, Piotr Faliszewski, Piotr Skowron, and Arkadii Slinko. Properties of multiwinner voting rules. Social Choice and Welfare, 48:599\u2013632, 2017.   \n[58] Virginie Do, Jamal Atif, J\u00e9r\u00f4me Lang, and Nicolas Usunier. Online selection of diverse committees. arXiv preprint arXiv:2105.09295, 2021.   \n[59] Piotr Skowron, Piotr Faliszewski, and J\u00e9r\u00f4me Lang. Finding a collective set of items: From proportional multirepresentation to group recommendation. Artificial Intelligence, 241:191\u2013 216, 2016.   \n[60] Arthur Gretton, Karsten M Borgwardt, Malte J Rasch, Bernhard Sch\u00f6lkopf, and Alexander Smola. A kernel two-sample test. The Journal of Machine Learning Research, 13(1):723\u2013773, 2012.   \n[61] Ajil Jalal, Sushrut Karmalkar, Jessica Hoffmann, Alex Dimakis, and Eric Price. Fairness for image generation with uncertain sensitive attributes. In International Conference on Machine Learning, pages 4721\u20134732. PMLR, 2021.   \n[62] Karsten M Borgwardt, Arthur Gretton, Malte J Rasch, Hans-Peter Kriegel, Bernhard Sch\u00f6lkopf, and Alex J Smola. Integrating structured biological data by kernel maximum mean discrepancy. Bioinformatics, 22(14):e49\u2013e57, 2006.   \n[63] Alfred M\u00fcller. Integral probability metrics and their generating classes of functions. Advances in applied probability, 29(2):429\u2013443, 1997.   \n[64] Bharath K Sriperumbudur, Kenji Fukumizu, Arthur Gretton, Bernhard Sch\u00f6lkopf, and Gert RG Lanckriet. On the empirical estimation of integral probability metrics. Electronic Journal of Statistics, 6:1550\u20131599, 2012.   \n[65] Jerone Theodore Alexander Andrews, Przemyslaw Joniak, and Alice Xiang. A view from somewhere: Human-centric face representations. In The Eleventh International Conference on Learning Representations, 2022.   \n[66] Fernando Delgado, Stephen Yang, Michael Madaio, and Qian Yang. Stakeholder participation in ai: Beyond\" add diverse stakeholders and stir\". arXiv preprint arXiv:2111.01122, 2021.   \n[67] Douglas Zytko, Pamela J. Wisniewski, Shion Guha, Eric PS Baumer, and Min Kyung Lee. Participatory design of ai systems: opportunities and challenges across diverse users, relationships, and application domains. In CHI Conference on Human Factors in Computing Systems Extended Abstracts, pages 1\u20134, 2022.   \n[68] Yiding Jiang, Behnam Neyshabur, Hossein Mobahi, Dilip Krishnan, and Samy Bengio. Fantastic generalization measures and where to find them. In International Conference on Learning Representations, 2019.   \n[69] F. Pedregosa, G. Varoquaux, A. Gramfort, V. Michel, B. Thirion, O. Grisel, M. Blondel, P. Prettenhofer, R. Weiss, V. Dubourg, J. Vanderplas, A. Passos, D. Cournapeau, M. Brucher, M. Perrot, and E. Duchesnay. Scikit-learn: Machine learning in Python. Journal of Machine Learning Research, 12:2825\u20132830, 2011.   \n[70] Jeff Johnson, Matthijs Douze, and Herv\u00e9 J\u00e9gou. Billion-scale similarity search with GPUs. IEEE Transactions on Big Data, 7(3):535\u2013547, 2019.   \n[71] Foad Hamidi, Morgan Klaus Scheuerman, and Stacy M Branham. Gender recognition or gender reductionism? the social implications of embedded gender recognition systems. In Proceedings of the 2018 chi conference on human factors in computing systems, pages 1\u201313, 2018.   \n[72] Peter L. Bartlett and Shahar Mendelson. Rademacher and gaussian complexities: Risk bounds and structural results. Journal of Machine Learning Research, 2002.   \n[73] Martin J Wainwright. High-dimensional statistics: A non-asymptotic viewpoint, volume 48. Cambridge university press, 2019.   \n[74] Jun Yang, Shengyang Sun, and Daniel M Roy. Fast-rate pac-bayes generalization bounds via shifted rademacher processes. Advances in Neural Information Processing Systems, 32, 2019.   \n[75] Yuheng Bu, Shaofeng Zou, and Venugopal V Veeravalli. Tightening mutual information-based bounds on generalization error. IEEE Journal on Selected Areas in Information Theory, 1(1): 121\u2013130, 2020.   \n[76] Amir Asadi, Emmanuel Abbe, and Sergio Verd\u00fa. Chaining mutual information and tightening generalization bounds. Advances in Neural Information Processing Systems, 31, 2018.   \n[77] Ron Amit, Baruch Epstein, Shay Moran, and Ron Meir. Integral probability metrics pac-bayes bounds. Advances in Neural Information Processing Systems, 35:3123\u20133136, 2022.   \n[78] James E Kelley, Jr. The cutting-plane method for solving convex programs. Journal of the society for Industrial and Applied Mathematics, 8(4):703\u2013712, 1960.   \n[79] Elliot Ward Cheney and Allen A Goldstein. Newton\u2019s method for convex programming and tchebycheff approximation. Numerische Mathematik, 1(1):253\u2013268, 1959.   \n[80] B Curtis Eaves and WI Zangwill. Generalized cutting plane algorithms. SIAM Journal on Control, 9(4):529\u2013542, 1971.   \n[81] Dimitri Bertsekas. Convex optimization algorithms. Athena Scientific, 2015.   \n[82] Donald M Topkis. Cutting-plane methods without nested constraint sets. Operations Research, 18(3):404\u2013413, 1970.   \n[83] Jean-Louis Goffin and Jean-Philippe Vial. Convex nondifferentiable optimization: A survey focused on the analytic center cutting plane method. Optimization methods and software, 17 (5):805\u2013867, 2002.   \n[84] Laurence A Wolsey and George L Nemhauser. Integer and combinatorial optimization. John Wiley & Sons, 2014.   \n[85] Bernhard Sch\u00f6lkopf and Alexander J Smola. Learning with kernels: support vector machines, regularization, optimization, and beyond. MIT press, 2002.   \n[86] T Hofmann, B Sch\u00f6lkopf, and AJ Smola. Kernel methods in machine learning. The Annals of Statistics, 36(3):1171\u20131220, 2008.   \n[87] Weihao Gao, Sreeram Kannan, Sewoong Oh, and Pramod Viswanath. Estimating mutual information for discrete-continuous mixtures, 2018.   \n[88] Duncan Black. Theory Committees and Elections. Cambridge University Press, 1958.   \n[89] John R Chamberlin and Paul N Courant. Representative deliberations and representative decisions: Proportional representation and the borda rule. American Political Science Review, 77(3):718\u2013733, 1983.   \n[90] Burt L Monroe. Fully proportional representation. American Political Science Review, 89(4): 925\u2013940, 1995.   \n[91] Friedrich Pukelsheim. Proportional representation. Springer, 2017.   \n[92] Jonathan K Hodge and Richard E Klima. The mathematics of voting and elections: a hands-on approach, volume 30. American Mathematical Soc., 2018.   \n[93] Thomas Hare. A Treatise on the Election of Representatives, Parliamentary and Municipal. Longman, Green, Longman, & Roberts, 1861.   \n[94] Michel Balinski. Fair majority voting (or how to eliminate gerrymandering). The American Mathematical Monthly, 115(2):97\u2013113, 2008.   \n[95] Ariel D Procaccia, Jeffrey S Rosenschein, and Aviv Zohar. On the complexity of achieving proportional representation. Social Choice and Welfare, 30(3):353\u2013362, 2008.   \n[96] Nadja Betzler, Arkadii Slinko, and Johannes Uhlmann. On the computation of fully proportional representation. Journal of Artificial Intelligence Research, 47:475\u2013519, 2013.   \n[97] Felix Brandt, Vincent Conitzer, Ulle Endriss, J\u00e9r\u00f4me Lang, and Ariel D Procaccia. Handbook of computational social choice. Cambridge University Press, 2016.   \n[98] Gurobi Optimization, LLC. Gurobi Optimizer Reference Manual, 2024. URL https://www. gurobi.com.   \n[99] Steven Diamond and Stephen Boyd. CVXPY: A Python-embedded modeling language for convex optimization. Journal of Machine Learning Research, 17(83):1\u20135, 2016.   \n[100] Akshay Agrawal, Robin Verschueren, Steven Diamond, and Stephen Boyd. A rewriting system for convex optimization problems. Journal of Control and Decision, 5(1):42\u201360, 2018. ", "page_idx": 10}, {"type": "text", "text": "", "page_idx": 11}, {"type": "text", "text": "", "page_idx": 12}, {"type": "text", "text": "", "page_idx": 13}, {"type": "text", "text": "", "page_idx": 14}, {"type": "text", "text": "", "page_idx": 15}, {"type": "text", "text": "Supplementary material to the paper Multi-Group Proportional Representation in Retrieval ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "In this supplement to the paper, we begin in Section A and Section B by noting some ethical considerations and limitations for our work, respectively. Then, we present our proofs of Propositions 1, 3, 2, and 4 in Appendix C. In Appendix D, we discuss the MOPR algorithm, its convergence aspects, and MOPR for linear functions and functions belonging to an RKHS. We also compare the linear relaxation to the integer program optimization problem in Equation 9 empirically and similarly compare the result of MOPR to directly solving the closed form linear program in the case of linear models. In Appendix E, we describe the baselines reported in this paper and provide further retrieval statistics. In particular, we describe the algorithms CLIP-clip Wang et al. [18], CLIP-debias Berg et al. [20], Post-Hoc Bias Mitigation ([29] and PATHS [27]. In F, we provide a brief discussion about proportional representation in political sciences, give a few historical comments about social choice theory, and discuss the contribution given by [37]. Then, in Appendix G, we include an additional table of results for equal representation with the other baseline methods (Table 5). We also include plots for additional queries for the linear regression model (Figs. 8, 9, and 10) for as well as two additional models, 1) decision tree models in Figs. 11, 12, and 13 and for 2) multilayer perceptrons in Figs. 14, 15, and 16. We provide additional details on the experiment setting in Appendix H. Finally, we include some example sets of retrieved images for qualitative comparison. ", "page_idx": 16}, {"type": "text", "text": "A Ethics considerations ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "It is important to consider the long-term societal impact of enforcing MPR in real-world retrieval systems to understand its potential benefits and risks. First, applying MPR, such as with MOPR in deployment settings, could result in \u201cethics-washing\"\u2013where a company claims their system is fair because they measured MPR when, in fact, there are still representational harms\u2013or could provide users and developers with a false sense of fairness. Second, MPR is just one of many ways of analyzing representation, and as a statistical metric, it fails to consider aspects such as human perceptions of representation. There are legal and regulatory risks with overreliance on a single metric for fairness, especially if this metric is used to inform policy and decision-making. As mentioned previously, any biases present in the curation dataset will propagate to the results and downstream uses of MPR; furthermore, the choice of what dataset and what attributes to consider is an inherently social and political choice made by humans, subject to its own limitations and biases. Finally, the introduction of MPR in real-world retrieval systems could introduce new stereotypes or erase identities if not conducted properly. ", "page_idx": 16}, {"type": "text", "text": "B Limitations ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "Our aggregate results (e.g., Table 1) should be approached with caution, as each MPR-similarity curve is sampled from a different distribution of data conditioned on a query, limiting our ability to draw statistical conclusions. This does not preclude the existence of a query where a competing method may achieve an MPR-similarity trade-off point not achieved by MOPR. However, we note that MOPR is specifically optimized to promote MPR while preserving similarity, explaining its favorable performance. In all instances observed by the authors, MOPR Pareto dominates competing benchmarks and was the most successful method in achieving low values of MPR while maintaining high levels of similarity with a given query. Second, while MPR is designed to handle a large number of groups, the computational complexity of the proposed cutting-plane algorithm in the case of a general function class $\\mathcal{C}$ can be a concern for high-dimensional feature spaces. Developing more efficient algorithms or approximation techniques could help address this issue. Finally, MPR is inherently limited by the curated dataset. If this dataset is biased against a given group, this bias will be propagated by MOPR. The creation and selection of curated datasets must carefully account for stakeholder interest and target representation statistics. Additionally, we note that not every combination of intersectional identities (such as \u201cwhite male\" as opposed to \u201cblack female\") may be considered intersectional from a sociological perspective, and furthermore, these datasets do not contain multiracial labels. We do not presume to address representational issues in ML datasets, and instead, our experiments aim to demonstrate the flexibility and scalability of the MPR metric in handling complex intersectional groups. We hope that MPR will only prove more useful as datasets become more representative. ", "page_idx": 16}, {"type": "text", "text": "C Proofs from Section 3 ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "We start by proving Proposition 1 from Section 3 which bounds the error in MPR estimates when $Q$ is approximated via a curated dataset $\\mathcal{D}_{C}$ . We do so by using tools from standard Rademacher complexity results in statistical learning theory, e.g., [72]. See also [73, Chapter 4]. We restate the theorems here to facilitate readability. We start with a lemma about the difference of suprema. ", "page_idx": 17}, {"type": "text", "text": "Lemma 1. Let $P$ and $P^{\\prime}$ be two distributions over $\\mathcal{X}$ and $\\mathcal{C}=\\{c:\\mathcal{X}\\to[0,1]\\}$ . Then ", "page_idx": 17}, {"type": "equation", "text": "$$\n\\operatorname*{sup}_{c\\in{\\mathcal{C}}}\\mathbb{E}_{P}[c(X)]-\\operatorname*{sup}_{c\\in{\\mathcal{C}}}\\mathbb{E}_{P^{\\prime}}[c(X)]\\leq\\operatorname*{sup}_{c\\in{\\mathcal{C}}}\\left\\{\\mathbb{E}_{P}[c(X)]-\\mathbb{E}_{P^{\\prime}}[c(X)]\\right\\}.\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "Proof. ", "page_idx": 17}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\underset{c\\in\\mathcal{C}}{\\operatorname*{sup}}\\mathbb{E}_{P}[c(X)]-\\underset{c\\in\\mathcal{C}}{\\operatorname*{sup}}\\mathbb{E}_{P^{\\prime}}[c(X)],}\\\\ &{=\\underset{c\\in\\mathcal{C}}{\\operatorname*{sup}}\\left\\{\\mathbb{E}_{P}[c(X)]-\\mathbb{E}_{P^{\\prime}}[c(X)]+\\mathbb{E}_{P^{\\prime}}[c(X)]\\right\\}-\\underset{c\\in\\mathcal{C}}{\\operatorname*{sup}}\\mathbb{E}_{P^{\\prime}}[c(X)],}\\\\ &{\\leq\\underset{c\\in\\mathcal{C}}{\\operatorname*{sup}}\\left\\{\\mathbb{E}_{P}[c(X)]-\\mathbb{E}_{P^{\\prime}}[c(X)]\\right\\}+\\underset{c\\in\\mathcal{C}}{\\operatorname*{sup}}\\mathbb{E}_{P^{\\prime}}[c(X)]-\\underset{c\\in\\mathcal{C}}{\\operatorname*{sup}}\\mathbb{E}_{P^{\\prime}}[c(X)],}\\\\ &{\\leq\\underset{c\\in\\mathcal{C}}{\\operatorname*{sup}}\\left\\{\\mathbb{E}_{P}[c(X)]-\\mathbb{E}_{P^{\\prime}}[c(X)]\\right\\}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "Proposition 1 (Generalization Gap of MPR). Let $\\mathbf{\\mathcal{R}}(q)=\\{\\mathbf{x}_{i}^{r}\\}_{i=1}^{k}$ be a set of $k$ retrieved samples, $\\bar{D_{C}}\\bar{=}\\ \\{x_{i}^{c}\\}_{i=1}^{m}$ be a curated dataset comprised of $m$ i.i.d. samples from a target representation distribution $Q$ , and $\\delta>0,$ . If $\\mathcal{C}=\\{c:\\mathcal{R}^{d}\\times\\mathcal{G}\\rightarrow\\{-1,1\\}\\}$ with Rademacher complexity $\\mathcal{R}_{m}(\\mathcal{C})$ then, with probability at least $1-\\delta$ , ", "page_idx": 17}, {"type": "equation", "text": "$$\n|\\mathrm{MPR}(\\mathcal{C},\\mathcal{R},\\mathcal{D}_{C})-\\mathrm{MPR}(\\mathcal{C},\\mathcal{R},Q)|\\leq\\mathcal{R}_{m}(\\mathcal{C})+\\sqrt{\\frac{\\log{(2/\\delta)}}{8m}}.\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "Proof. First, note that ", "page_idx": 17}, {"type": "equation", "text": "$$\n\\begin{array}{r l r}&{}&{\\mathrm{MPR}(\\mathcal{C},\\mathcal{R},\\mathcal{D}_{\\mathcal{C}})-\\mathrm{MPR}(\\mathcal{C},\\mathcal{R},\\mathcal{Q})}\\\\ &{}&{=\\displaystyle\\operatorname*{sup}_{c\\in\\mathcal{C}}\\left|\\frac{1}{k}\\sum_{i=1}^{k}c(x_{i}^{\\prime})-\\frac{1}{m}\\sum_{i=1}^{m}c(x_{i}^{\\prime})\\right|-\\operatorname*{sup}_{c\\in\\mathcal{C}}\\left|\\frac{1}{k}\\sum_{i=1}^{k}c(x_{i}^{\\prime})-\\mathbb{E}_{\\mathcal{Q}}[c(X)]\\right|,}\\\\ &{}&{\\le\\displaystyle\\operatorname*{sup}_{c\\in\\mathcal{C}}\\left\\{\\left|\\frac{1}{k}\\sum_{i=1}^{k}c(x_{i}^{\\prime})-\\frac{1}{m}\\sum_{i=1}^{m}c(x_{i}^{\\circ})\\right|-\\left|\\frac{1}{k}\\sum_{i=1}^{k}c(x_{i}^{\\prime})-\\mathbb{E}_{\\mathcal{Q}}[c(X)]\\right|\\right\\},}\\\\ &{}&{\\le\\displaystyle\\operatorname*{sup}_{c\\in\\mathcal{C}}\\left|\\left|\\frac{1}{k}\\sum_{i=1}^{k}c(x_{i}^{\\prime})-\\frac{1}{m}\\sum_{i=1}^{m}c(x_{i}^{\\circ})\\right|-\\left|\\frac{1}{k}\\sum_{i=1}^{k}c(x_{i}^{\\prime})-\\mathbb{E}_{\\mathcal{Q}}[c(X)]\\right|\\right\\},}\\\\ &{}&{\\le\\displaystyle\\operatorname*{sup}_{c\\in\\mathcal{C}}\\left|\\frac{1}{m}\\sum_{i=1}^{m}c(x_{i}^{\\circ})-\\mathbb{E}_{\\mathcal{Q}}[c(X)]\\right|.}\\end{array}\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "Where (13) comes from Lemma 1 and (15) comes from the triangular inequality. ", "page_idx": 17}, {"type": "text", "text": "Additionally, by switching $\\mathrm{MPR}(\\mathcal{C},\\mathcal{R},Q)$ by $\\begin{array}{r}{\\operatorname*{sup}_{c\\in{\\mathcal{C}}}\\left|{\\frac{1}{k}}\\sum_{i=1}^{k}c(x_{i})-\\mathbb{E}_{Q}[c(X)]\\right|}\\end{array}$ in (11) and repeating the previous argument, we conclude that: ", "page_idx": 17}, {"type": "equation", "text": "$$\n\\left|\\operatorname{MPR}(\\mathcal{C},\\mathcal{R},\\mathcal{D}_{C})-\\operatorname*{sup}_{c\\in\\mathcal{C}}\\left|\\frac{1}{k}\\sum_{i=1}^{k}c(x_{i})-\\mathbb{E}_{Q}[c(X)]\\right|\\right|\\leq\\operatorname*{sup}_{c\\in\\mathcal{C}}\\left|\\frac{1}{m}\\sum_{i=1}^{m}c({\\pmb x}_{i}^{c})-\\mathbb{E}_{Q}[c(X)]\\right|.\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "Therefore, from (16) we show ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\begin{array}{l}{\\mathrm{Pr}\\left[\\displaystyle\\left|\\mathrm{MPR}(\\mathcal{C},\\mathcal{R},\\mathcal{D}_{C})-\\displaystyle\\operatorname*{sup}_{c\\in\\mathcal{C}}\\left|\\frac{1}{k}\\sum_{i=1}^{k}c(x_{i})-\\mathbb{E}_{Q}[c(X)]\\right|\\right|\\geq2\\mathcal{R}_{m}(\\mathcal{C})+\\sqrt{\\displaystyle\\frac{\\log\\left(\\frac{2}{\\delta}\\right)}{2m}}\\right],}\\\\ {\\leq\\mathrm{Pr}\\left[\\displaystyle\\operatorname*{sup}_{c\\in\\mathcal{C}}\\left|\\frac{1}{m}\\sum_{i=1}^{m}c(x_{i}^{c})-\\mathbb{E}_{Q}[c(X)]\\right|\\geq2\\mathcal{R}_{m}(\\mathcal{C})+\\sqrt{\\displaystyle\\frac{\\log\\left(\\frac{2}{\\delta}\\right)}{2m}}\\right],}\\\\ {\\leq\\mathrm{Pr}\\left[\\displaystyle\\operatorname*{sup}_{c\\in\\mathcal{C}}\\left|\\frac{1}{m}\\sum_{i=1}^{m}\\frac{c(x_{i}^{c})}{2}-\\mathbb{E}_{Q}\\left[\\frac{c(X)}{2}\\right]\\right|\\geq\\mathcal{R}_{m}(\\mathcal{C})+\\sqrt{\\displaystyle\\frac{\\log\\left(\\frac{2}{\\delta}\\right)}{8m}}\\right]\\leq\\delta,}\\end{array}\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "here (19) comes from the generalization bound using Rademacher complexity from [72] and the fact that $\\frac{c(x)}{2}\\in[-\\frac{1}{2},\\frac{1}{2}]$ hence the image of $\\frac{c}{2}$ is in an interval of size 1. \u53e3 ", "page_idx": 18}, {"type": "text", "text": "We now prove Proposition 2, which provides a bound on the size $m$ of an i.i.d. curated dataset $\\mathcal{D}_{C}$ that ensures an $\\epsilon$ -accurate estimate of MPR for a set of $M$ queries. ", "page_idx": 18}, {"type": "text", "text": "Proposition 2 (Query Budget Guarantee). Consider any set of $M$ queries $\\mathcal{Q}=\\left\\{\\mathbf{q}_{1},...,\\mathbf{q}_{M}\\right\\}$ where $M\\in\\mathbb{N}$ . Let ${\\mathsf{V C}}({\\mathcal{C}})$ denote the VC-dimension of the class $\\mathcal{C}$ with range in $\\{-1,1\\}$ . For $\\epsilon>0$ , if $\\mathcal{D}_{C}$ consists of m i.i.d. samples drawn from $Q$ where $m$ satisfies ", "page_idx": 18}, {"type": "equation", "text": "$$\nm\\ge\\frac{32\\mathsf{V}\\mathsf{C}(\\mathcal{C})}{\\epsilon^{2}}+\\frac{2\\log\\left(\\frac{2M}{\\delta}\\right)}{2\\epsilon^{2}},\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "then, with probability at least 1 \u2212 $\\delta,\\,|\\mathrm{MPR}(\\mathcal{C},\\mathcal{R},\\mathcal{D}_{C})-\\mathrm{MPR}(\\mathcal{C},\\mathcal{R},Q)|\\leq\\epsilon.$ ", "page_idx": 18}, {"type": "text", "text": "Proof. First, recall that the Rademacher complexity $\\mathcal{R}_{m}(\\mathcal{C})$ is upper bounded by the VC-dimension of $\\mathcal{C}$ by the relation ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\mathcal{R}_{m}(\\mathcal{C})\\leq\\sqrt{\\frac{2\\mathrm{VC}(\\mathcal{C})\\log\\left(\\frac{e m}{\\mathrm{VC}(\\mathcal{C})}\\right)}{m}},\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "where $e$ is Euler\u2019s number. ", "page_idx": 18}, {"type": "text", "text": "Denote the samples retrieved for a given query $q$ by $\\mathbf{\\mathcal{R}}(q)=\\{\\mathbf{x}_{i}^{r}(q)\\}_{i=1}^{k}$ . From Proposition 1 we have that for all $\\delta^{*}$ ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\operatorname*{Pr}\\left[\\left|\\mathrm{MPR}(\\mathcal{C},\\mathcal{R},\\mathcal{D}_{C})-\\mathrm{MPR}(\\mathcal{C},\\mathcal{R},Q)\\right|\\geq\\mathcal{R}_{m}(\\mathcal{C})+\\sqrt{\\frac{\\log\\left(\\frac{2}{\\delta^{*}}\\right)}{8m}}\\right]\\leq\\delta^{*}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "Therefore, using the previous equation if we take $\\begin{array}{r}{\\delta^{*}=\\frac{\\delta}{M}}\\end{array}$ and denote $\\mathcal{R}(q)=\\mathcal{R}$ we have that ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\operatorname*{Pr}\\left[\\underset{q\\in\\mathcal{Q}}{\\operatorname*{sup}}\\left|\\mathrm{MPR}(\\mathcal{C},\\mathcal{R},\\mathcal{D}_{C})-\\mathrm{MPR}(\\mathcal{C},\\mathcal{R},Q)\\right|\\geq\\mathcal{R}_{m}(\\mathcal{C})+\\sqrt{\\frac{\\log\\big(\\frac{2}{\\delta^{*}}\\big)}{8m}}\\right],}\\\\ &{\\leq\\underset{q\\in\\mathcal{Q}}{\\sum}\\operatorname*{Pr}\\left[\\left|\\mathrm{MPR}(\\mathcal{C},\\mathcal{R},\\mathcal{D}_{C})-\\mathrm{MPR}(\\mathcal{C},\\mathcal{R},Q)\\right|\\geq\\mathcal{R}_{m}(\\mathcal{C})+\\sqrt{\\frac{\\log\\big(\\frac{2}{\\delta^{*}}\\big)}{8m}}\\right],}\\\\ &{\\leq\\underset{q\\in\\mathcal{Q}}{\\sum}\\delta^{*}=\\frac{\\delta M}{M}=\\delta.}\\end{array}\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "Hence, we have that, with probability at least $1-\\delta$ for all $q\\in\\mathcal{Q}$ ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\operatorname*{sup}_{c\\in\\mathcal{C}}\\left|\\frac{1}{k}\\sum_{i=1}^{k}c(\\boldsymbol{x}_{i}^{r}(\\boldsymbol{q}))-\\mathbb{E}_{\\boldsymbol{Q}}[c(\\boldsymbol{X})]\\right|\\leq\\operatorname{MPR}(\\mathcal{C},\\mathcal{R}(\\boldsymbol{q}),\\mathcal{D}_{C})+\\mathcal{R}_{m}(\\mathcal{C})+\\sqrt{\\frac{\\log\\left(\\frac{2M}{\\delta}\\right)}{8m}},\n$$", "text_format": "latex", "page_idx": 18}, {"type": "equation", "text": "$$\n\\leq\\mathbf{MPR}(\\mathcal{C},\\mathcal{R}(q),\\mathcal{D}_{C})+\\sqrt{\\frac{2\\mathrm{VC}(\\mathcal{C})\\log\\left(\\frac{e m}{\\mathrm{VC}(\\mathcal{C})}\\right)}{m}}+\\sqrt{\\frac{\\log\\left(\\frac{2M}{\\delta}\\right)}{8m}}.\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "Where the inequality in (23) comes from the upper bound in (20). ", "page_idx": 19}, {"type": "text", "text": "Moreover, if $m\\geq{\\frac{32{\\boldsymbol{\\nabla}}{\\boldsymbol{C}}({\\boldsymbol{\\mathcal{C}}})}{\\epsilon^{2}}}$ )then $\\begin{array}{r}{\\sqrt{\\frac{2\\mathrm{VC}(\\mathcal{C})\\log\\left(\\frac{e m}{\\mathrm{VC}(c)}\\right)}{m}}\\leq\\frac{\\epsilon}{2}}\\end{array}$ and if $\\begin{array}{r}{m\\geq\\frac{\\log\\left(\\frac{2M}{\\delta}\\right)}{2\\epsilon^{2}}}\\end{array}$ then $\\begin{array}{r}{\\sqrt{\\frac{\\log\\left(\\frac{2M}{\\delta}\\right)}{8m}}\\le\\frac{\\epsilon}{2}}\\end{array}$ . Therefore, we conclude that if $m$ is such that ", "page_idx": 19}, {"type": "equation", "text": "$$\nm\\ge\\frac{32\\tt V C}{\\epsilon^{2}}(\\mathcal{C})+\\frac{\\log\\left(\\frac{2M}{\\delta}\\right)}{2\\epsilon^{2}},\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "then ", "page_idx": 19}, {"type": "equation", "text": "$$\n\\operatorname*{sup}_{c\\in\\mathcal{C}}\\left\\lvert\\frac{1}{k}\\sum_{i=1}^{k}c(\\pmb{x}_{i}^{r}(q))-\\mathbb{E}_{Q}[c(X)]\\right\\rvert\\leq\\mathbf{M}\\mathbf{P}\\mathbf{R}(\\mathcal{C},\\mathcal{R}(q),\\mathcal{D}_{C})+\\epsilon.\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "As described in Section 3, such bounds tend to be conservative and these bounds can be improved by doing a sharper analysis with PAC-Bayesian [74] or mutual information bounds [75]. See also [76] and [77]. ", "page_idx": 19}, {"type": "text", "text": "We now prove Proposition 3. This proposition states that for specific function classes, computing MPR is equivalent to solving an MSE regression problem. This proposition allows us to efficiently estimate MPR with standard regression models from packages such as scikit-learn [69]. ", "page_idx": 19}, {"type": "text", "text": "Proposition 3. Let $\\begin{array}{r}{\\mathcal{C}^{\\prime}\\triangleq\\{c\\in\\mathcal{C}\\:\\vert\\:\\sum_{i=1}^{m+n}c(\\pmb{x}_{i})^{2}=\\frac{m k}{m+k}\\}}\\end{array}$ where $\\mathcal{C}$ is closed under scalar multiplication. Let $c(\\mathbf{X})=[c(\\mathbf{x_{1}}),...,c(\\mathbf{x_{n+m}})]$ . Then $0\\leq\\mathrm{MPR}(\\mathcal{C}^{\\prime},\\mathcal{R},\\mathcal{D}_{C})\\leq1$ , and for any ", "page_idx": 19}, {"type": "equation", "text": "$$\nc^{*}\\in\\underset{c\\in\\mathcal{C}}{\\arg\\operatorname*{inf}}\\,\\sum_{i=1}^{n+m}(c(\\pmb{x}_{i})-\\widetilde{a}_{i})^{2},\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "let $\\hat{c}:\\mathcal{X}\\rightarrow\\mathbb{R}$ be defined as $\\begin{array}{r}{\\hat{c}(\\mathbf{x})=\\frac{\\sqrt{m k/(m+k)}}{\\|c^{*}(\\mathbf{X})\\|_{2}}c^{*}(\\mathbf{x})}\\end{array}$ . Then, we have that ", "page_idx": 19}, {"type": "equation", "text": "$$\n\\hat{c}\\in\\underset{c\\in\\mathcal{C}^{\\prime}}{\\arg\\operatorname*{sup}}\\left|\\sum_{i=1}^{n+m}c(\\pmb{x}_{i})\\widetilde{\\boldsymbol{a}}_{i}\\right|.\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "Proof. We begin proving $\\begin{array}{r}{0\\;\\;\\le\\;\\;\\mathrm{MPR}({\\mathcal C}^{\\prime},{\\mathcal R},{\\mathcal D}_{C})\\;\\;\\le\\;\\;1,}\\end{array}$ . As a shorthand, let $c(\\mathbf{X})\\ =$ $[c(\\mathbf{x_{1}}),...,c(\\mathbf{x_{n+m}})]$ . The Cauchy-Schwarz inequality gives, ", "page_idx": 19}, {"type": "equation", "text": "$$\n\\left|\\sum_{i=1}^{n+m}c(\\pmb{x}_{i})\\widetilde{\\boldsymbol{a}}_{i}\\right|\\leq\\|c(\\mathbf{X})\\|_{2}\\|\\widetilde{\\mathbf{a}}\\|_{2},\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "where $\\mathbf{X}\\in\\mathbb{R}^{(m+n)\\times l}$ is the matrix formed by the row-wise concatenation of $\\mathcal{D}_{R}$ and $\\mathcal{D}_{C}$ and $\\widetilde{\\mathbf{a}}$ is the vector $[\\widetilde{a}_{0},...,\\widetilde{a}_{m+n}]$ . $\\mathcal{C}^{\\prime}$ gives us a constraint on the norm of $c(\\mathbf{X})$ , and we can compute $\\widetilde{\\mathbf{a}}$ g i ven there are $k$ terms with value $1/k$ , $m$ terms with value $1/m$ , and $n-k$ terms with value 0. Also note that mk $\\begin{array}{r}{\\frac{m k}{m+k}=(\\frac{1}{k}+\\frac{1}{m})^{-1}}\\end{array}$ ", "page_idx": 19}, {"type": "equation", "text": "$$\n\\left|\\sum_{i=1}^{n+m}c({\\pmb x}_{i})\\widetilde a_{i}\\right|\\leq(\\frac{1}{k}+\\frac{1}{m})^{-\\frac{1}{2}}(\\frac{1}{k}+\\frac{1}{m})^{\\frac{1}{2}}=1.\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "Next, we prove the second statement. Consider the minimizer of the MSE problem, ", "page_idx": 19}, {"type": "equation", "text": "$$\n\\underset{c\\in\\mathcal{C}}{\\arg\\operatorname*{inf}}\\,\\sum_{i=1}^{n+m}(c(\\pmb{x}_{i})-\\widetilde{\\boldsymbol{a}}_{i})^{2},\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "As $\\mathcal{C}$ is closed under scalar multiplication, we can equivalently write this a two-part optimization problem ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\underset{c\\in\\mathcal{C}}{\\arg\\operatorname*{inf}}\\left(\\operatorname*{inf}_{\\lambda}\\sum_{i=1}^{n+m}(\\lambda c(\\pmb{x}_{i})-\\widetilde{\\boldsymbol{a}}_{i})^{2}\\right),\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "where the inner optimization is quadratic and yields a solution ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\lambda^{*}=\\frac{\\sum_{i=1}^{n+m}c(\\mathbf{x}_{i})\\widetilde{a}_{i}}{\\|c(\\mathbf{X})\\|_{2}^{2}},\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "as $\\|c(\\mathbf{X})\\|_{2}<\\infty$ . Plugging this back into Equation (29), the MSE problem becomes ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\underset{c\\in\\mathbb{C}}{\\arg\\operatorname*{inf}}\\ \\underset{i=1}{\\overset{n+m}{\\sum}}(\\frac{\\sum_{i=1}^{n+m}c(\\mathbf{x}_{i})\\widetilde{\\alpha}_{i}}{\\|c(\\mathbf{X})\\|_{2}^{2}}c(\\mathbf{x}_{i})-\\widetilde{\\alpha}_{i})^{2},}\\\\ &{=\\underset{c\\in\\mathbb{C}}{\\arg\\operatorname*{inf}}\\ \\underset{i=1}{\\overset{n+m}{\\sum}}\\left(\\frac{\\langle c(\\mathbf{X}),\\widetilde{\\mathbf{a}}\\rangle^{2}}{\\|c(\\mathbf{X})\\|_{2}^{4}}c(\\mathbf{x}_{i})^{2}-2\\frac{\\langle c(\\mathbf{X}),\\widetilde{\\mathbf{a}}\\rangle}{\\|c(\\mathbf{X})\\|_{2}^{2}}c(\\mathbf{x}_{i})\\widetilde{\\alpha}_{i}+\\widetilde{\\alpha}_{i}^{2}\\right),}\\\\ &{=\\underset{c\\in\\mathbb{C}}{\\arg\\operatorname*{inf}}\\ \\left(\\frac{\\langle c(\\mathbf{X}),\\widetilde{\\mathbf{a}}\\rangle^{2}}{\\|c(\\mathbf{X})\\|_{2}^{4}}\\|c(\\mathbf{X})\\|_{2}^{2}-2\\frac{\\langle c(\\mathbf{X}),\\widetilde{\\mathbf{a}}\\rangle}{\\|c(\\mathbf{X})\\|_{2}^{2}}\\langle c(\\mathbf{X}),\\widetilde{\\mathbf{a}}\\rangle+\\underset{i=1}{\\overset{n+m}{\\sum}}\\widetilde{\\alpha}_{i}^{2}\\right),}\\\\ &{=\\underset{c\\in\\mathbb{C}}{\\arg\\operatorname*{inf}}\\ \\frac{\\langle c(\\mathbf{X}),\\widetilde{\\mathbf{a}}\\rangle^{2}}{\\|c(\\mathbf{X})\\|_{2}^{2}}+\\underset{i=1}{\\overset{n+m}{\\sum}}\\widetilde{\\alpha}_{i}^{2}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "As $\\widetilde{a}_{i}$ does not depend on $c$ , this optimization is equivalent to ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\arg\\operatorname*{sup}_{c\\in\\mathcal{C}}\\frac{\\langle c(\\mathbf{X}),\\widetilde{\\mathbf{a}}\\rangle^{2}}{\\|c(\\mathbf{X})\\|_{2}^{2}}=\\arg\\operatorname*{sup}_{c\\in\\mathcal{C}}\\frac{|\\langle c(\\mathbf{X}),\\widetilde{\\mathbf{a}}\\rangle|^{2}}{\\|c(\\mathbf{X})\\|_{2}^{2}}.\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "Note that the supremum can be multiplied by a constant. Then we can multiply by some $\\Delta>0$ and get ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\underset{c\\in\\mathcal{C}}{\\arg\\operatorname*{sup}}\\,\\frac{\\Delta|\\langle c(\\mathbf{X}),\\widetilde{\\mathbf{a}}\\rangle|^{2}}{\\|c(\\mathbf{X})\\|_{2}^{2}}=\\underset{\\|c(\\mathbf{X})\\|_{2}=\\sqrt{\\Delta}}{\\arg\\operatorname*{sup}}\\ |\\langle c(\\mathbf{X}),\\widetilde{\\mathbf{a}}\\rangle|^{2}.\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "In other words, for $\\Delta>0$ and ", "page_idx": 20}, {"type": "equation", "text": "$$\nc^{*}\\in\\arg\\operatorname*{sup}_{c\\in{\\mathcal{C}}}\\frac{|\\langle c(\\mathbf{X}),\\widetilde{\\mathbf{a}}\\rangle|^{2}}{\\|c(\\mathbf{X})\\|_{2}^{2}},\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "and letting $\\hat{c}:\\mathcal{X}\\rightarrow\\mathbb{R}$ be defined as $\\begin{array}{r}{\\hat{c}(\\mathbf{x})=\\frac{\\sqrt{\\Delta}}{\\|c^{*}(\\mathbf{X})\\|_{2}}c^{*}(\\mathbf{x})}\\end{array}$ , we have that ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\hat{c}\\in\\displaystyle\\operatorname{arg\\,sup}_{\\|c(\\mathbf{X})\\|_{2}=\\sqrt{\\Delta}}|\\langle c(\\mathbf{X}),\\widetilde{\\mathbf{a}}\\rangle|^{2}\\!\\!=\\!\\!\\operatorname*{arg\\,sup}_{c\\in\\mathcal{C},\\atop\\|c(\\mathbf{X})\\|_{2}=\\sqrt{\\Delta}}\\left|\\sum_{i=1}^{n+m}c(\\mathbf{x}_{i})\\widetilde{a}_{i}\\right|^{2}=\\underset{\\|c(\\mathbf{X})\\|_{2}=\\sqrt{\\Delta}}{\\arg\\operatorname*{sup}}\\left|\\sum_{i=1}^{n+m}c(\\mathbf{x}_{i})\\widetilde{a}_{i}\\right|.\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "Letting \u2206=mm+kk , we can conclude that solving an MSE regression problem is equivalent to finding the representation statistic for MPR. \u53e3 ", "page_idx": 20}, {"type": "text", "text": "Now, we establish Proposition 4, restated below for convenience. It says that MPR enjoys a closedform expression whenever the class $\\mathcal{C}$ is given by linear functions. This proposition allows us to simplify MOPR since, in this case, the optimization problem can be cast as a quadratic program. ", "page_idx": 20}, {"type": "text", "text": "Proposition 4. Let items in the retrieval and curated datasets be vectors in $\\mathbb{R}^{l}$ for $l<m+n$ and $\\mathcal{C}=\\left\\{x\\mapsto w^{\\mathsf{T}}x\\ |\\ w\\in\\mathbb{R}^{k}\\right\\}$ . Moreover, let $\\mathbf{X}\\in\\mathbb{R}^{(m+n)\\times l}$ be the matrix formed by concatenating items in the retrieval and curated dataset $\\mathcal{D}_{R}$ and $\\mathcal{D}_{C}$ , respectively. For $\\mathcal{C^{\\prime}}$ in Proposition 3, we have ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\mathrm{MPR}(\\mathcal{C^{\\prime}},\\mathcal{R},\\mathcal{D}_{C})=\\sqrt{\\frac{m k}{m+k}}\\left\\|\\mathbf{U}_{l}^{\\sf T}\\widetilde{\\mathbf{a}}\\right\\|_{2},\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "where $\\mathbf{X}\\,=\\,\\mathbf{U}\\Sigma\\mathbf{V}^{\\top}$ is the SVD of $\\mathbf{X}$ and $\\mathbf{U}_{l}\\;\\in\\;\\mathbb{R}^{(m+n)\\times l}$ are the left singular vectors in $\\mathbf{U}$ corresponding to the top- $l$ largest singular values. ", "page_idx": 20}, {"type": "text", "text": "The closed-form expression for MPR in (8) allows MPR-constrained retrieval to be approximated by a quadratic program, whose proof can be found in Appendix D. Moreover, the above proposition can be directly adapted to linear functions defined only for embeddings or a subset of features of retrieved items. ", "page_idx": 21}, {"type": "text", "text": "Proof. Since we are considering the class $\\begin{array}{r}{\\mathcal{C}^{\\prime}\\triangleq\\{c\\in\\mathcal{C}\\vert\\,\\sum_{i=1}^{m+n}c(\\pmb{x}_{i})^{2}\\,=\\,\\frac{m k}{m+k}\\}}\\end{array}$ mm+kk}, where C = $\\left\\{x\\mapsto w^{\\mathsf{T}}x\\mid w\\in\\mathbb{R}^{d}\\right\\}$ , the computation of the Multi-Group Proportional Representation metric ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\mathrm{MPR}(\\mathcal{C}^{\\prime},\\mathcal{R},\\mathcal{D}_{C})=\\underset{c\\in\\mathcal{C}}{\\arg\\operatorname*{sup}}\\left|\\sum_{i=1}^{n+m}c(x_{i})\\widetilde{a}_{i}\\right|\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "boils down to the following optimization problem ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{\\displaystyle\\operatorname*{max}_{c\\in\\mathcal{C}}}&{\\displaystyle\\sum_{i=1}^{n+m}(w^{\\intercal}x)\\widetilde{a_{i}}}\\\\ {\\mathrm{subject\\to}}&{\\displaystyle\\sum_{i=1}^{m+n}[w^{\\intercal}x]^{2}=\\frac{m k}{m+k},}\\end{array}\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "which can be written as ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{\\underset{w\\in\\mathbb{R}^{n+m}}{\\mathrm{max}}}&{\\widetilde{\\mathbf{a}}^{T}\\mathbf{X}\\mathbf{w}}\\\\ &{\\mathrm{subject\\,to}\\ \\,\\,\\|\\mathbf{X}\\mathbf{w}\\|_{2}^{2}\\!\\!=\\frac{m k}{m+k},}\\end{array}\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "where $\\mathbf{X}\\in\\mathbb{R}^{(n+m)\\times l}$ is the matrix formed by concatenating items in the retrieval and curated dataset $\\mathcal{D}_{R}$ and $\\mathcal{D}_{C}$ , respectively. Let $\\mathbf{X}=\\mathbf{U}\\pmb{\\Sigma}\\mathbf{V}^{\\top}$ be the SVD of $\\mathbf{X}$ and $\\mathbf{U}_{l}\\,\\in\\,\\mathbb{R}^{(m+n)\\,\\times\\,l}$ are the left singular vectors in $\\mathbf{U}$ corresponding to the top- $l$ largest singular values. Then, the problem becomes ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{\\underset{w\\in\\mathbb{R}^{m+n}}{\\mathrm{max}}}&{\\widetilde{\\mathbf{a}}^{T}\\mathbf{U}\\Sigma\\mathbf{V}^{\\intercal}\\mathbf{w}}\\\\ &{\\mathrm{subject\\to}\\ \\left\\Vert\\Sigma\\mathbf{V}^{\\intercal}\\mathbf{w}\\right\\Vert_{2}^{2}\\!\\!=\\frac{m k}{m+k}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "Now, by a change of variables $\\Sigma\\mathbf{{V}}^{\\top}\\mathbf{w}=\\widetilde{\\mathbf{w}}$ and $\\mathbf{U}_{l}^{\\top}\\widetilde{\\mathbf{a}}=\\mathbf{z}$ ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\underset{\\widetilde{\\mathbf{w}},\\mathbf{w}\\in\\mathbb{R}^{m+n}}{\\mathrm{max}}\\,\\,\\,\\mathbf{z}^{T}\\widetilde{\\mathbf{w}}}\\\\ &{\\mathrm{subject~to~}\\,\\,\\|\\widetilde{\\mathbf{w}}\\|_{2}^{2}\\!=\\frac{m k}{m+k},}\\\\ &{\\Sigma\\mathbf{V}^{\\top}\\mathbf{w}=\\widetilde{\\mathbf{w}}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "We can use the method of Lagrange multipliers. Let us define the Lagrangian function: ", "page_idx": 21}, {"type": "equation", "text": "$$\nL(\\widetilde{\\mathbf{w}},\\mathbf{w},\\boldsymbol{\\lambda},\\mu)=\\mathbf{z}^{T}\\widetilde{\\mathbf{w}}-\\frac{\\boldsymbol{\\lambda}}{2}\\left(\\|\\widetilde{\\mathbf{w}}\\|_{2}^{2}\\!-\\!\\frac{m k}{m+k}\\right)-\\mu^{T}(\\Sigma\\mathbf{V}^{\\intercal}\\mathbf{w}-\\widetilde{\\mathbf{w}}).\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "To find the optimal solution, we set the partial derivatives of the Lagrangian with respect to $\\widetilde{\\mathbf{w}},\\mathbf{w},\\lambda$ , and $\\pmb{\\mu}$ to zero: ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\begin{array}{r l r}&{}&{\\displaystyle\\frac{\\partial{\\cal L}}{\\partial{\\bf\\tilde{w}}}={\\bf z}-\\lambda{\\bf\\tilde{w}}+\\mu=0,}\\\\ &{}&{\\displaystyle\\frac{\\partial{\\cal L}}{\\partial{\\bf w}}=-{\\bf V}\\Sigma\\mu=0,}\\\\ &{}&{\\displaystyle\\frac{\\partial{\\cal L}}{\\partial\\lambda}=\\frac{1}{2}\\left(\\|{\\bf\\tilde{w}}\\|_{2}^{2}\\!-\\!\\frac{m k}{m+k}\\right)=0,}\\\\ &{}&{\\displaystyle\\frac{\\partial{\\cal L}}{\\partial\\mu}=\\Sigma{\\bf V}^{\\top}{\\bf w}-{\\bf\\tilde{w}}=0.}\\end{array}\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "From (42), we have $\\mathbf{V}\\pmb{\\Sigma}\\pmb{\\mu}=0$ . Assuming $\\mathbf{V}$ and $\\Sigma$ are full rank, this implies $\\pmb{\\mu}=0$ . Substituting this into (39), we get: ", "page_idx": 22}, {"type": "equation", "text": "$$\n{\\mathbf z}-\\lambda\\widetilde{{\\mathbf w}}=0\\implies\\widetilde{{\\mathbf w}}=\\frac{1}{\\lambda}{\\mathbf z}.\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "Using (43) and the constraint $\\begin{array}{r}{\\|\\widetilde{\\mathbf{w}}\\|_{2}^{2}=\\frac{m k}{m+k}}\\end{array}$ mm+kk, we can solve for \u03bb: ", "page_idx": 22}, {"type": "equation", "text": "$$\n\\|\\widetilde{\\mathbf{w}}\\|_{2}^{2}\\!\\!=\\frac{1}{\\lambda^{2}}\\|\\mathbf{z}\\|_{2}^{2}\\!\\!=\\frac{m k}{m+k}\\implies\\lambda=\\pm\\|\\mathbf{z}\\|_{2}\\!\\sqrt{\\frac{m+k}{m k}}\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "Since we are maximizing $\\mathbf{z}^{T}\\widetilde{\\mathbf{w}}$ , we choose the positive value of $\\lambda$ . Thus, the optimal $\\widetilde{\\mathbf{w}}$ is: ", "page_idx": 22}, {"type": "equation", "text": "$$\n\\widetilde{\\mathbf{w}}^{*}=\\frac{\\sqrt{\\frac{m k}{m+k}}}{\\|\\mathbf{z}\\|_{2}}\\mathbf{z}.\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "Finally, using (45), we can find the optimal w: ", "page_idx": 22}, {"type": "equation", "text": "$$\n\\Sigma\\mathbf{V}^{\\mathsf{T}}\\mathbf{w}^{*}=\\widetilde{\\mathbf{w}}^{*}\\implies\\mathbf{w}^{*}=(\\Sigma\\mathbf{V}^{\\mathsf{T}})^{-1}\\widetilde{\\mathbf{w}}^{*}=\\frac{\\sqrt{\\frac{m k}{m+k}}}{\\|\\mathbf{z}\\|_{2}}(\\Sigma\\mathbf{V}^{\\mathsf{T}})^{-1}\\mathbf{z}=\\frac{\\sqrt{\\frac{m k}{m+k}}}{\\|\\mathbf{z}\\|_{2}}(\\Sigma\\mathbf{V}^{\\mathsf{T}})^{-1}\\mathbf{U}_{l}^{\\mathsf{T}}\\widetilde{\\mathbf{a}}.\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "The optimal $\\mathbf{w}$ is then obtained by solving the linear system $\\boldsymbol{\\Sigma}\\mathbf{V}^{\\intercal}\\mathbf{w}^{*}=\\widetilde{\\mathbf{w}}^{*}$ . Finally, plugging the solution back in to our objective and canceling terms, we arrive at our solution. Note that we can replace $\\mathbf{U}$ with $\\mathbf{U}_{l}$ in our original SVD as $\\mathbf{U}\\in\\mathbf{\\dot{R}}^{(m+n)\\times l}$ , so we can truncate the vectors in the null space of $\\mathbf{U}$ . ", "page_idx": 22}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{\\underset{w\\in\\mathbb{R}^{m+n}}{\\operatorname*{max}}}&{\\widetilde{\\mathbf{a}}^{T}\\mathbf{U}\\Sigma\\mathbf{V}^{\\top}\\mathbf{w}}\\\\ &{=\\widetilde{\\mathbf{a}}^{T}\\mathbf{U}_{l}\\Sigma\\mathbf{V}^{\\top}\\frac{\\sqrt{\\frac{m k}{m+k}}}{\\left\\|\\mathbf{z}\\right\\|_{2}}(\\Sigma\\mathbf{V}^{\\top})^{-1}\\mathbf{U}_{l}^{\\top}\\widetilde{\\mathbf{a}}}\\\\ &{=\\frac{\\sqrt{\\frac{m k}{m+k}}}{\\left\\|\\mathbf{U}_{l}^{\\top}\\widetilde{\\mathbf{a}}\\right\\|_{2}}\\widetilde{\\mathbf{a}}^{T}\\mathbf{U}_{l}\\mathbf{U}_{l}^{\\top}\\widetilde{\\mathbf{a}}}\\\\ &{=\\sqrt{\\frac{m k}{m+k}}\\|\\mathbf{U}_{l}^{\\top}\\widetilde{\\mathbf{a}}\\|_{2}}\\end{array}\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "D The Multi-group Optimized Retrieval Algorithm ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "In this section, we discuss the convergence of MOPR, the Multi-group Optimized Proportional Retrieval algorithm. As described in Section 4, the MOPR is essentially a cutting plane method (also known as the Kelley-Cheney-Goldstein method [78, 79]) applied to the linear function $\\mathbf{a}^{T}\\mathbf{s}$ ; see also [80]. ", "page_idx": 22}, {"type": "text", "text": "The algorithm begins by identifying the $k$ -most similar items to a given query in $\\mathcal{D}_{R}$ . Then, an MSE-minimizing oracle is called and returns the statistic (or group-denoting function) $c\\in{\\mathcal{C}}$ with the most disproportionate representation for the set of retrieved items. The function $c$ is then added as a constraint to a linear program that outputs a vector $\\mathbf{a}\\in[0,1]^{n}$ maximizing average similarity as in (9) subject to a single constraint  k1 i = 1naic(xir ) \u2212m1  im=1 , where integer constraints are relaxed. The optimal a is rounded so only the largest $k$ entries are marked as 1, corresponding to a new set of retrieved items. The process repeats with an increasing number of constraints to the linear program and halts when the oracle does not return a function that violates the target MPR constraint $\\rho$ . In mathematical terms, we start by solving the problem ", "page_idx": 22}, {"type": "equation", "text": "$$\n\\operatorname*{max}_{\\mathbf{a}\\in\\{0,1\\}^{n}}\\mathbf{a}^{\\mathsf{T}}\\mathbf{s}\n$$", "text_format": "latex", "page_idx": 22}, {"type": "equation", "text": "$$\n{\\mathrm{subject~to~}}\\sum_{i=1}^{k}\\mathbf{a}_{i}=k.\n$$", "text_format": "latex", "page_idx": 23}, {"type": "text", "text": "Note that the solution to this problem is given by the vector a that finds the $k$ th largest entries of s, i.e., it identifies the $k$ -most similar items to a given query in $\\mathcal{D}_{R}$ . Then, Proposition 3 provides a way to generate cuts given the vector $\\mathbf{a}_{k}\\in\\mathbb{R}^{n}$ found as a solution of the previous iteration. These cuts are given by the function $c\\in{\\mathcal{C}}$ with the most disproportionate representation for the set of retrieved items. ", "page_idx": 23}, {"type": "text", "text": "At each iteration, we test if the MPR constraint, less or equal to $\\rho$ , is satisfied. If not, this gives us a new inequality to be incorporated into the linear problem (D) that outputs a vector $\\mathbf{a}\\in[0,1]^{n}$ maximizing average similarity as in (9) subject to a single constraint $\\begin{array}{r}{\\left|\\frac{1}{k}\\sum_{i=1}^{n}a_{i}c(\\pmb{x}_{i}^{r})-\\frac{1}{m}\\sum_{i=1}^{m}c(\\pmb{x}_{i}^{c})\\right|\\leq\\rho,}\\end{array}$ where integer constraints are relaxed. Therefore, the algorithm consists of iteratively adding a new constraint (cut) of the form ", "page_idx": 23}, {"type": "equation", "text": "$$\nG(a)=:\\operatorname*{sup}_{c\\in C}\\left|\\frac{1}{k}\\sum_{i=1}^{n}a_{i}c(\\pmb{x}_{i}^{r})-\\frac{1}{m}\\sum_{i=1}^{m}c(\\pmb{x}_{i}^{c})\\right|\n$$", "text_format": "latex", "page_idx": 23}, {"type": "text", "text": "and solving the problem again until all the inequalities are fulfilled, i.e., until the oracle does not return a function that violates the target MPR constraint $\\rho$ . At this point, the algorithm halts. It remains to be shown that the description above indeed corresponds to a traditional cutting plane method for convex functions. For the subsequent discussion, we will denote the term inside the supremum in (48) by $g(\\mathbf{a},c)$ , i.e., ", "page_idx": 23}, {"type": "equation", "text": "$$\ng(\\mathbf{a},c)=\\frac{1}{k}\\sum_{i=1}^{n}a_{i}c(\\pmb{x}_{i}^{r})-\\frac{1}{m}\\sum_{i=1}^{m}c(\\pmb{x}_{i}^{c}),\\quad\\mathrm{for}\\;c\\in\\widetilde{\\mathcal{C}}.\n$$", "text_format": "latex", "page_idx": 23}, {"type": "text", "text": "The next proposition links the oracle via MSE, described in Proposition 3, with the subdifferential of the function $G(\\mathbf{a})$ . ", "page_idx": 23}, {"type": "text", "text": "Proposition 5. Let $\\mathcal{C}$ be in infinite set and let $G(\\mathbf{a})\\ =\\ \\operatorname*{sup}_{c\\in{\\mathcal{C}}}|g(\\mathbf{a},c)|$ be the convex restriction of the optimization problem (9) given by the supremum, i.e., $G(\\mathbf{a})~\\leq~\\rho,\\forall\\mathbf{a}~\\in~\\mathbb{R}^{n}$ . If $c^{*}\\;\\in\\;\\arg\\operatorname*{sup}_{c\\in{\\mathcal{C}}}|g(\\mathbf{a}^{*},c)|$ and c denote the function $c^{*}$ evaluated at the points $x_{1},\\ldots,x_{n}$ , i.e., $\\mathbf{c}=[c_{*}(x_{1}),\\hdots,c_{*}(x_{m})],$ then $\\begin{array}{r}{g^{*}:=\\mathrm{sign}(g(\\mathbf{a}^{*},c^{*}))\\cdot\\mathbf{c}\\in\\partial G(\\mathbf{a}^{*}),}\\end{array}$ , i.e., $g^{*}$ is a subgradient of $G$ at a point $\\mathbf{a}^{*}$ . ", "page_idx": 23}, {"type": "text", "text": "Proof. We start by noting that $G(\\mathbf{a})$ is a convex function since it is a supremum of a composition of an affine function with the absolute value. Also, note that $G(\\mathbf{a})$ can be written as $\\bar{G}(\\mathbf{a})\\,=$ $\\begin{array}{r}{\\operatorname*{sup}_{c\\in\\mathcal{C}}|g(\\mathbf{a},c)|{=}\\operatorname*{sup}_{c\\in\\mathcal{C}}|\\mathbf{c}^{\\top}\\mathbf{a}+b_{c}|}\\end{array}$ , where $b:{\\mathcal{C}}\\rightarrow\\mathbb{R}$ . We need to prove that ", "page_idx": 23}, {"type": "equation", "text": "$$\nG(\\mathbf{a}^{*})+g^{*\\top}(\\mathbf{a}-\\mathbf{a}^{*})\\leq G(\\mathbf{a}),\\forall\\mathbf{a}\\in\\mathbb{R}^{n}\n$$", "text_format": "latex", "page_idx": 23}, {"type": "text", "text": "In fact, starting from the left-hand side leads to ", "page_idx": 23}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{g(\\mathbf{a}^{*},c^{*})\\vert+\\mathrm{sign}(g(\\mathbf{a}^{*},c^{*}))\\mathbf{c}^{\\mathsf{T}}(\\mathbf{a}-\\mathbf{a}^{*})}\\\\ &{=\\vert\\mathbf{c}^{\\mathsf{T}}\\mathbf{a}+b_{c}\\vert+\\frac{\\mathbf{c}^{\\mathsf{T}}\\mathbf{a}+b_{c}}{\\vert\\mathbf{c}^{\\mathsf{T}}\\mathbf{a}+b_{c}\\vert}\\mathbf{c}^{\\mathsf{T}}(\\mathbf{a}-\\mathbf{a}^{*})}\\\\ &{=\\vert\\mathbf{c}^{\\mathsf{T}}\\mathbf{a}+b_{c}\\vert+\\frac{\\mathbf{c}^{\\mathsf{T}}\\mathbf{a}+b_{c}}{\\vert\\mathbf{c}^{\\mathsf{T}}\\mathbf{a}+b_{c}\\vert}-\\mathbf{c}^{\\mathsf{T}}\\mathbf{a}^{*}-b_{c}\\ast+\\mathbf{c}^{\\mathsf{T}}\\mathbf{a}+b_{c}\\ast}\\\\ &{=\\vert\\mathbf{c}^{\\mathsf{T}}\\mathbf{a}+b_{c}\\vert-\\frac{\\vert\\mathbf{c}^{\\mathsf{T}}\\mathbf{a}+b_{c}\\vert^{2}}{\\vert\\mathbf{c}^{\\mathsf{T}}\\mathbf{a}+b_{c}\\vert}+\\mathrm{sign}(g(\\mathbf{a}^{*},c^{*}))(\\mathbf{c}^{\\mathsf{T}}\\mathbf{a}+b_{c}\\ast)}\\\\ &{\\leq\\vert\\mathbf{c}^{\\mathsf{T}}\\mathbf{a}+b_{c}\\vert\\leq G(\\mathbf{a}),\\forall\\mathbf{a}\\in\\mathbb{R}^{n}}\\end{array}\n$$", "text_format": "latex", "page_idx": 23}, {"type": "text", "text": "This shows that $\\mathbf{c}=[c_{*}(x_{1}),\\hdots,c_{*}(x_{m})]$ is a subgradient of $G(\\mathbf{a})$ . ", "page_idx": 23}, {"type": "text", "text": "The cutting plane strategy described in Algorithm 1 addresses the constraints of the form $G(\\mathbf{a})\\leq\\rho$ that are not fulfilled. Since (50) holds, the algorithm adds linear approximations (or cutting planes) of the form ", "page_idx": 24}, {"type": "equation", "text": "$$\nG(\\mathbf{a}^{*})+g^{*}\\,^{\\mathsf{T}}(\\mathbf{a}-\\mathbf{a}^{*})\\leq\\rho\n$$", "text_format": "latex", "page_idx": 24}, {"type": "text", "text": "to the problem at each iteration until the solution satisfies all the inequalities. This reformulation demonstrates that the MOPR algorithm can be viewed as a traditional cutting plane method for minimizing a linear function over the polyhedron $\\begin{array}{r}{P=\\{a_{i}\\in[0,1]\\cap\\sum_{i=1}^{n}a_{i}\\stackrel{=}{=}\\dot{k}\\}}\\end{array}$ . If, at a certain iteration, the algorithm finds an iterate that satisfies all the inequalities, it terminates since the lower bound provided by the cutting plane method matches the upper bound. In the case where the algorithm continues adding constraints, the accumulation point (guaranteed to exist due to the compactness of the set $P$ ) will converge to an optimal solution, as proven in [81, Proposition 4.1.2] or the main theorem in [78, Section 2]. ", "page_idx": 24}, {"type": "text", "text": "However, it is important to note that even when the algorithm terminates in a finite number of steps, the cutting plane method often requires a substantial number of iterations to converge and may exhibit numerical instabilities. Addressing these instabilities or exploring techniques to discard certain cuts for improved convergence, such as partial cutting plane methods, is beyond the scope of this paper. For further information on these topics, refer to [82, 83] and the references therein. ", "page_idx": 24}, {"type": "text", "text": "The integer program may not be as scalable as its convex relaxation. If we relax it to $a_{i}\\in[0,1]$ , this becomes a convex optimization problem solvable by standard methods (even for very large $\\mathbf{C}$ ) and provides an upper bound to the original program for reasonable values of the MPR violation (and for which Proposition 5 applies). However, the optimal solution of the relaxed problem might not be feasible for the original problem, because it might have fractional values for some $a_{i}$ , while the original problem requires these to be binary. There are certain special cases where the optimal solution of the relaxed problem is guaranteed to be integral (i.e., all $a_{i}$ are 0 or 1), in which case it is also an optimal solution for the original problem. This is the case, for example, when the constraint matrix is totally unimodular and the right-hand sides of the constraints are integral [84]. Still, we observe from empirical experiments that selecting the top k $a_{i}$ of the relaxed problem is a computationally efficient alternative to solving the integer program in Equation (9), since results from rounding produce a negligible difference to the upper bound (see Figures 2 and 3). ", "page_idx": 24}, {"type": "image", "img_path": "BRZYhVHvSg/tmp/2615d260cf2d308a50d3a259b16746189f66501f8a44b7f6f3cb50df537d70db.jpg", "img_caption": ["Figure 2: Comparison of linear program with and without taking the top- $\\cdot k$ to integer program. Solving the relaxed program is much more computationally efficient and achieves similar performance after rounding to solving the integer program. "], "img_footnote": [], "page_idx": 24}, {"type": "text", "text": "D.1 Multi-group Optimized Retrieval via Quadratic Programming ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Proposition 4 allowed us to have a simple closed-form representation of MPR in the case of boundednorm linear regression functions, i.e., when ${\\mathcal{C}}^{\\prime}\\;\\triangleq\\;\\{c\\;\\in\\;{\\mathcal{C}}\\;\\mid\\;{\\sqrt{\\frac{m k}{m+k}}}\\sum_{i=1}^{m+n}c(x_{i})^{2}\\;=\\;1\\}$ , and $\\mathcal{C}=\\left\\{x\\mapsto w^{\\mathsf{T}}x\\ |\\ w\\in\\mathbb{R}^{d}\\right\\}$ . In this case, MOPR becomes ", "page_idx": 24}, {"type": "image", "img_path": "BRZYhVHvSg/tmp/19ba315f0335110dc4849a9d9fe0182c773fd8cd778d9ea8c47f589e92720468.jpg", "img_caption": ["Figure 3: Additional comparisons of relaxed problem and top- $\\cdot k$ selection to integer program. \u201cchef\", \u201cnurse\", \u201cartist\", \u201clawyer\", \u201cteacher\", \u201cengineer\", \u201carchitect\", \u201cscientist\", and \u201cprogrammer\". "], "img_footnote": [], "page_idx": 25}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathrm{subject\\,to\\,}~\\sqrt{\\displaystyle\\frac{m k}{m+k}}\\,\\|\\mathbf{U}_{l}^{\\mathsf{T}}\\widetilde{\\mathbf{a}}\\|_{2}\\leq\\rho,}\\\\ &{\\mathbf{a}^{\\mathsf{T}}\\mathbf{1}=k,}\\\\ &{a_{i}\\in\\{0,1\\},}\\end{array}\n$$", "text_format": "latex", "page_idx": 25}, {"type": "text", "text": "where $\\widetilde{\\mathbf{a}}\\in\\mathbb{R}^{n+m}$ has $i$ -th entry given by $\\widetilde{a}_{i}\\triangleq\\mathbb{1}_{i\\leq n}\\frac{a_{i}}{k}-\\mathbb{1}_{i>n}\\frac{1}{m}$ . ", "page_idx": 25}, {"type": "text", "text": "This result allows us to explore the efficiency of the cutting plane algorithm in MOPR by comparing it to the solution to (52), which is a closed-form, convex quadratic program that can be easily optimized with existing solvers. Note that in these experiments, top- $k$ refers to the process of solving the relaxed linear program and then rounding to get a solution in $\\{0,1\\}^{n}$ by selecting the $k$ items with the highest score given by a. This is different than the Top- $k$ described elsewhere in the paper, which denotes conducting vanilla retrieval without fairness considerations. In Figures 4 and 6, we compare the quadratic optimization problem (Eqn. 52) to MOPR (a linear program, Algorithm 1) for linear regression and measure the MPR of our solutions with the closed form value from Proposition 4. As we can see, while the quadratic program traces a smoother curve, MOPR\u2019s cutting plane approach well-approximates the closed form solution. In these experiments, we retrieve 50 items from CelebA, without a curation set. Finally, in Figures 5 and 7, we run MOPR with the quadratic program oracle and compare our measurement of MPR with the closed form solution and linear regressor-approximated measurement of MPR. In other words, where Figures 4 and 6 measure the quality of our retrieval algorithm given a perfect (closed form) MPR oracle, Figures 5 and 7 measure the quality of our MSE estimator of MPR in comparison to the perfect oracle. We observe that the MSE oracle is a perfect approximator of the closed form for MPR, as expected. ", "page_idx": 25}, {"type": "image", "img_path": "BRZYhVHvSg/tmp/121a5406f2768419ff5e3a4c3263e09a3ca46b6c10ae9f6ed8de8221d7483d44.jpg", "img_caption": ["Figure 4: Similarity vs MPR for Quadratic Program (Eqn. 52) and MOPR. MOPR well approximates the quadratic program along the Pareto frontier. Measured over a single query \u201cA photo of a lawyer\" for 50 retrieved samples on CelebA. "], "img_footnote": [], "page_idx": 26}, {"type": "image", "img_path": "BRZYhVHvSg/tmp/42da1959db46f4da22f4bcceea0e46d9ca0b4358b8da383ec1106eadbc69d1a1.jpg", "img_caption": ["Figure 5: Similarity vs MPR for MSE estimated (Prop 3 and closed form (Prop 4) measures of MPR. For the class of linear models, a linear regression oracle perfectly achieves the analytical solution for MPR. Measured over a single query \u201cA photo of a lawyer\" for 50 retrieved samples on CelebA. "], "img_footnote": [], "page_idx": 26}, {"type": "text", "text": "D.2 Computing MPR for Functions in an RKHS ", "text_level": 1, "page_idx": 26}, {"type": "text", "text": "Kernel methods are a generalized but practical, non-linear, and easy technique to implement algorithms for a plethora of important problems in machine learning [85, 86]. As MPR is closely related to the maximum mean discrepancy problem, a closed-form expression of MPR can be easily deduced by using results from [60, Lemma 6] when $\\mathcal{C}$ is a reproducing kernel Hilbert space, which includes, for example, linear regression, logistic regression, Gaussian kernel ridge regression, and hard-margin SVMs. ", "page_idx": 26}, {"type": "text", "text": "Proposition 6 (MPR for RKHS [60]). Let $\\{x_{i}^{r}\\}_{i=1}^{k}$ be retrieved samples $\\mathcal{R}$ and $\\{{\\pmb x}_{i}^{c}\\}_{i=1}^{m}$ the samples from the curation dataset $\\mathcal{D}_{C}$ . Let $\\mathcal{C}$ be a reproducing kernel hilbert space with kernel $\\mathcal{K}(.,.)$ , then ", "page_idx": 26}, {"type": "equation", "text": "$$\n\\mathrm{MPR}(\\mathcal{C},\\mathcal{R},Q)=\\left[\\frac{1}{k^{2}}\\sum_{i,j=1}^{k}K(\\boldsymbol{x}_{i}^{r},\\boldsymbol{x}_{j}^{r})-\\frac{2}{m k}\\sum_{i,j=1}^{k,m}K(\\boldsymbol{x}_{i}^{r},\\boldsymbol{x}_{j}^{c})+\\frac{1}{n^{2}}\\sum_{i,j=1}^{m}K(\\boldsymbol{x}_{i}^{c},\\boldsymbol{x}_{j}^{c})\\right]^{1/2}.\n$$", "text_format": "latex", "page_idx": 26}, {"type": "text", "text": "Therefore, given a kernel $\\boldsymbol{\\kappa}(.,.)$ , we can easily compute MPR $\\mathcal{C},\\mathcal{R},Q)$ by evaluating the kernel at the points $\\pmb{x}_{i}^{r},\\pmb{x}_{j}^{c}$ and use this in Algorithm 1. ", "page_idx": 26}, {"type": "image", "img_path": "BRZYhVHvSg/tmp/9c38feeb23187dca76a0ad9e2f6f2528210f9731d832e7b73fcdc8876d6d4938.jpg", "img_caption": [], "img_footnote": [], "page_idx": 27}, {"type": "text", "text": "Figure 6: Additional comparisons of Quadratic Program (Eqn. 52) and MOPR over queries \u201cchef\", \u201cnurse\", \u201cartist\", \u201cdoctor\", \u201cteacher\", \u201cengineer\", \u201carchitect\", \u201cscientist\", and \u201cprogrammer\". ", "page_idx": 27}, {"type": "image", "img_path": "BRZYhVHvSg/tmp/73d4081143b74a834bf9f140b9119906e54f39aa58ca19a594984d5cf96482bf.jpg", "img_caption": ["Figure 7: Additional comparisons of MSE to closed form MPR estimator for queries \u201cchef\", \u201cnurse\", \u201cartist\", \u201cdoctor\", \u201cteacher\", \u201cengineer\", \u201carchitect\", \u201cscientist\", and \u201cprogrammer\". "], "img_footnote": [], "page_idx": 27}, {"type": "table", "img_path": "BRZYhVHvSg/tmp/96a3b022cbf2ed744e29806aa51d07283b860e5fecca9cf42484f9aab01652d5.jpg", "table_caption": [], "table_footnote": ["Table 2: Axis of comparison for ours and existing fair retrieval methods. The blue color indicates a positive feature of the method, while the red color indicates a negative one. "], "page_idx": 28}, {"type": "text", "text": "E Description of Fair Retrieval Algorithms and Retrieval Statistics ", "text_level": 1, "page_idx": 28}, {"type": "text", "text": "In this section, we describe the methods we benchmark against that aim to promote fairness multimodal models like CLIP [23]. We also briefly overview proportional representation in political sciences. ", "page_idx": 28}, {"type": "text", "text": "\u2022 CLIP-clip (Wang et al. [18]): CLIP-clip is a post-processing algorithm with two stages. First, the mutual information between each positional feature of an embedding and some sensitive attributes is estimated (treating each sensitive attribute as a discrete random variable and each position as a continuous random variable [87]). Then, in order of greatest to lowest mutual information, at test-time some number of CLIP features are dropped from both the text and image embedding, resulting in less bias (at cost to the fidelity of the embedding). By varying the number of features dropped, a recall-bias trade-off is induced.   \n\u2022 CLIP-debias (Berg et al. [20]): The algorithm learns a series of tokens that are pre-pended to text queries into CLIP via adversarial training to minimize the ability to predict a sensitive attribute of the resulting embedding (in the default case, gender). Then, retrieval is conducted with the debiased embeddings.   \n\u2022 Post-Hoc Bias Mitigation ([29]): Post-Hoc Bias Mitigation is a post-processing method that relies on an oracle classifier to label elements that might be retrieved with either one of several sensitive attributes or a neutral label. Then, iteratively, Post-Hoc Bias Mitigation adds either a set of elements (one of each predicted sensitive attribute) or a predicted neutral element to target equal representation, based on which option has higher average cosine similarity. The oracle may be a pretrained classifier, a zero-shot method using CLIP embeddings, or the true labels.   \n\u2022 PATHS (Srinivasan et al. [27]): PATHS is a new embedding space built upon the pretrained image-text model CoCa and leveraged text-guided projections to extract an embedding that captures complex notions of diversity in people, upon which a diverse retrieval method (such as the MMR method detailed above, or even MOPR) can be run to effectively increase the diversity of the returned samples. ", "page_idx": 28}, {"type": "text", "text": "F Connection to Social Choice Theory ", "text_level": 1, "page_idx": 28}, {"type": "text", "text": "In this section, we comment on the role of proportional representation in social sciences. As described in the related works in Section 1, proportional representation (broadly construed) has a long history in social choice theory and political sciences [88\u201392] and has been a guiding principle in the design of political systems, aiming to ensure representation reflects underlying population preferences and demographics. The foundations of social choice theory can be traced back to the late 18th century, with the seminal works of Jean-Charles de Borda and the Marquis de Condorcet, who developed fundamental voting methods and paradoxes that continue to influence modern computational approaches. During this same period, early proponents of proportional representation emerged, such as Honor\u00e9 Gabriel Riqueti, Comte de Mirabeau, who discussed the idea in 1780. ", "page_idx": 28}, {"type": "text", "text": "The 19th century saw significant contributions to the development of proportional representation, including the works of Thomas Wright Hill, Thomas Hare, and Charles Dodgson (better known as Lewis Carroll), who made substantial contributions to voting theory and proportional representation systems. Hare\u2019s 1859 publication, \u201cA Treatise on the Election of Representatives, Parliamentary and Municipal\u201d [93], outlined a system of single transferable vote for proportional representation. In the late 19th and early 20th centuries, the works of Carl Andrae, Victor D\u2019Hondt, and John Stuart Mill further explored and contributed to the discussion of proportional representation in the political science literature. The field was revolutionized in the 20th century by Kenneth Arrow\u2019s seminal work, whose impossibility theorem fundamentally shaped our understanding of social choice mechanisms. See [88\u201392]. ", "page_idx": 28}, {"type": "text", "text": "", "page_idx": 29}, {"type": "text", "text": "Similarly, in ML, our aim is proportional representation in data and outputs, ensuring equitable performance across groups and mirroring representation goals in political systems. PR electoral systems [94], used by countries like Uruguay, Sweden, South Africa, and New Zealand, allocate legislative seats proportionally to votes received by parties. Challenges include, e.g., gerrymandering [94] and the complexity of apportionment and seat allocation [95, 96]. ", "page_idx": 29}, {"type": "text", "text": "The emergence of computational social choice theory [97] in recent decades has built upon these classical foundations while introducing new algorithmic perspectives to address modern challenges. Researchers began studying algorithmic aspects of proportional representation, particularly focusing on the complexity of achieving different notions of proportionality in committee selection [95, 96]. The Hamilton and d\u2019Hondt methods, initially developed for parliamentary seat allocation, have been extended and generalized to handle more complex scenarios. As mentioned at the end of Section 1, a notable contribution in this direction is the work of Lang and Skowron [37], who introduced multiattribute proportional representation. Their framework generalizes classical apportionment methods to scenarios where candidates possess multiple attributes (such as gender, profession, and age), and representation goals must be satisfied across all these dimensions simultaneously. Their work provides both theoretical guarantees through approximation algorithms and practical methods for achieving proportional representation in modern committee selection problems, bridging the gap between classical political science approaches and contemporary computational challenges. In particular, they introduced the problem of multi-attribute proportional representation in committee selection. Their framework can be viewed as solving an $(m,t)$ -fliling problem: given $m$ buckets (representing intersectional groups) with target capacities $\\{t_{1},...,t_{m}\\}$ (derived from marginal probabilities), the goal is to optimally fill these buckets with appropriately labeled balls (committee members). ", "page_idx": 29}, {"type": "text", "text": "While groundbreaking in extending classical apportionment methods to multiple attributes, their approach differs from ours in several key aspects. First, their work considers multiple attributes, but they primarily focus on matching target proportions derived from marginal distributions for each attribute independently rather than truly addressing intersectional representation. That is, their approach aims to satisfy target proportions for each individual attribute (like gender or profession separately) but does not explicitly handle the complex interactions between attributes (like representation of specific gender-profession combinations). This is in contrast to our framework, where the function class $\\mathcal{C}$ can directly capture and measure such intersectional relationships. Moreover, their formulation focuses solely on matching target distributions without additional objectives, whereas our work explicitly balances representation with retrieval utility through cosine similarity maximization. Second, while they work with pre-specified target probabilities, we estimate the desired representation from a reference dataset, making our approach more flexible and data-driven. Third, and perhaps most importantly, our MPR metric measures representation through the lens of computationally identifiable groups defined by the aforementioned function class $\\mathcal{C}$ rather than explicitly enumerating all possible intersectional groups. Through $\\mathcal{C}$ , our framework provides a unified way to handle both simple and complex representations: it can capture discrete indicators for each attribute-value pair (like the Hamilton method; see Definition 5 in [37]) but also complex nonlinear relationships (like d\u2019Hondt method; see Definition 6 in [37]), and goes beyond both to measure intersectional representation via decision trees, linear functions, neural networks, or more generally, any function in a reproducing kernel Hilbert space (RKHS). This allows us to handle more complex notions of representation while maintaining computational tractability. In essence, while [37] provides fundamental insights for multi-attribute committee selection, our framework offers a more general approach suitable for modern retrieval systems where both representation and relevance matter. ", "page_idx": 29}, {"type": "text", "text": "G Additional Results ", "text_level": 1, "page_idx": 29}, {"type": "text", "text": "In this section, we include additional experimental results. First, we include a comparison of runtimes for each method in Table 3. We find that MOPR provides up to a 100x speedup when compared with the most competitive retrieval algorithm, MMR, while remaining competitive to methods such as CLIP-Clip and DebiasCLIP that do not modify the retrieval algorithm at all and just use embedding similarity search. We additionally provide the similarity score for the minimum MPR achieved by each algorithm, which was used to report the results in Tables 1 and 5. These similarity scores can be found in Table 4. Even when significantly closing the MPR gap and achieving more representation than other methods, MOPR also preserves high cosine similarity with respect to the query. ", "page_idx": 29}, {"type": "text", "text": "", "page_idx": 30}, {"type": "text", "text": "Second, we include full tables of intersectional retrieval performance on UTKFace for our method, Top- $k$ , MMR, CLIP-Clip, PBM, and DebiasCLIP. We report averaged results for each of the 10 queries while retrieving 50 images. In Table 5, we compute MPR with a linear regression oracle and optimize our method with the same linear regression oracle. We are able to perfectly balance across intersectional groups while other methods often fail to account for the \u2018Others\u2019 race category and the \u2018Female\u2019 gender category. Some methods, such as PBM, which optimize for equal representation, are able to achieve balanced representation across the gender axis but fail to consider diversity in race. In Table 6, we see a similar story for MPR measured and optimized with a decision tree. ", "page_idx": 30}, {"type": "text", "text": "Next, we include additional similarity-MPR tradeoff curves for the other 9 queries not reported in the main paper (Figs. 8,9,10), as well as for all 10 queries on two additional models: a decision tree (Figs. 11, 12, 13) and with an MLP with 1 hidden layer of dimension 64 (Figs. 14, 15, 16). We observe a similar Pareto-domination to that observed in the main paper, as our method is able to lower MPR the most while preserving similarity even with more nonlinear oracle estimators of MPR. In the MLP setting, while PBM preserves high similarity on the whole, it is still unable to decrease MPR as low as MOPRis able to at $\\approx95\\%$ of top- $\\cdot\\mathbf{k}$ similarity. ", "page_idx": 30}, {"type": "text", "text": "We also include results for an additional 45 queries for the Occupations dataset (with FairFace as the curation dataset), as this dataset comes with 45 ground-truth occupations labels. These results again highlight the Pareto-dominance of MOPR, as shown in Figures 17, 18, and 19. ", "page_idx": 30}, {"type": "text", "text": "In Figure 20, we explore the performance of MOPR in terms of precision, a common retrieval metric. We can do this using the Occupations dataset, as it has ground truth occupations labels with which we can benchmark retrieval precision. We see that MOPR performs competitively in terms of precision while also traversing more of the precision-MPR Pareto frontier. In Figure 21, we include nine additional precision-representation curves. Similar to the result for the query \u201cchief executive officer\", MOPR maintains similar precision-representation performance to baseline methods. ", "page_idx": 30}, {"type": "text", "text": "Finally, we include example sets of retrievals for \u2018architect\u2019 and \u2018teacher\u2019 queries over UTKFace with each of our baselines. Similar to the tables, we select each algorithm\u2019s solution with the lowest MPR after doing a hyperparameter sweep for each respective algorithm and plot the corresponding images below. The rest of the Appendix is solely tables and figures. ", "page_idx": 30}, {"type": "table", "img_path": "BRZYhVHvSg/tmp/7a514c404df5168c061e1e28773a439f5c7168975facfc4cbb9b89f1d17e6d48.jpg", "table_caption": [], "table_footnote": [], "page_idx": 30}, {"type": "table", "img_path": "BRZYhVHvSg/tmp/a217acffc07d6db04817e6e0bb81c1ce01e70cfca727b78a0435f977ddcf3b84.jpg", "table_caption": ["Table 3: Average running time (in seconds) over ten queries for $\\overline{{\\mathrm{k}{=}10}}$ , 50, and 150 items for the different methods. MOPR is able to achieve 100x speedup over the SOTA retrieval algorithm, MMR, and maintains competitive performance with vanilla KNN-based methods such as CLIP-Clip and DebiasCLIP. For more discussion, see the general comment in the rebuttal. "], "table_footnote": [], "page_idx": 30}, {"type": "table", "img_path": "BRZYhVHvSg/tmp/e4ae8031c2ef40edaa2a1c6f5f3c13f9b57ab0a2803ab9e5e5d19f47fbf94012.jpg", "table_caption": ["Table 5: Retrieval averaged over 10 queries with 50 retrievals on UTKFace dataset [40] for MOPR, $k$ -NN, MMR [27], CLIP-Clip, PBM, and DebiasCLIP with MPR optimized and measured with a linear regression oracle. Entries indicate the average percentage representation in retrieved items. MOPR is able to balance representation across classes, whereas other baselines miss intersectional groups (highlighted in red). "], "table_footnote": [], "page_idx": 31}, {"type": "table", "img_path": "BRZYhVHvSg/tmp/d8fae0c07d90afe912f952100a5fcb25daafe04a3df9315a9f61c50b6863aacd.jpg", "table_caption": ["Table 6: Retrieval averaged over 10 queries with 50 retrievals on UTKFace dataset [40] for MOPR, $k$ -NN, MMR [27], PBM, and DebiasCLIP with MPR optimized and measured with a decision tree oracle. Entries indicate the average percentage representation in retrieved items. MOPR is able to balance representation across classes, whereas other baselines miss intersectional groups (highlighted in red). "], "table_footnote": [], "page_idx": 31}, {"type": "image", "img_path": "BRZYhVHvSg/tmp/9f1b6726a2df3337f2473a17230c69a81815dd8e4477daec93d873351e78354a.jpg", "img_caption": ["Figure 8: Fraction of Top- $k$ cosine similarity vs Fraction of Top- $k$ MPR over linear regression models for 9 additional queries for the CelebA dataset. Values are normalized so Top- ${\\bf\\nabla}\\cdot{\\bf\\nabla}k$ achieves point (1,1) in each case. MOPR Pareto-dominates baselines and significantly closes the MPR gap. "], "img_footnote": [], "page_idx": 32}, {"type": "image", "img_path": "BRZYhVHvSg/tmp/57e1b66dfae2fc201df6ddafe870e9471ef84d7522e6b57c855c92e14554792c.jpg", "img_caption": ["Figure 9: Fraction of Top- $k$ cosine similarity vs Fraction of Top- ${\\bf\\nabla}\\cdot{\\bf\\nabla}k$ MPR over linear regression models for 9 additional queries for the UTKFace dataset. Values are normalized so Top- $k$ achieves point (1,1) in each case. MOPR Pareto-dominates baselines and significantly closes the MPR gap. "], "img_footnote": [], "page_idx": 33}, {"type": "image", "img_path": "BRZYhVHvSg/tmp/d95a19a54ce680d69eaa076b09b4a8e1a417b272e34de906c1d64f9b2d7b4f74.jpg", "img_caption": ["Figure 10: Fraction of Top- $k$ cosine similarity vs Fraction of Top- $\\cdot k$ MPR over linear regression models for 9 additional queries for the Occupations dataset. Values are normalized so Top- ${\\bf\\nabla}\\cdot{\\bf\\nabla}k$ achieves point (1,1) in each case. MOPR Pareto-dominates baselines and significantly closes the MPR gap. "], "img_footnote": [], "page_idx": 33}, {"type": "image", "img_path": "BRZYhVHvSg/tmp/459ed5cfc62352c827cf25b9f4beafe7d6c45936635758d91e172bc87f7474ca.jpg", "img_caption": ["Figure 11: Fraction of Top- ${\\bf\\nabla}\\cdot{\\bf\\nabla}k$ cosine similarity vs. Fraction of Top- $k$ MPR over decision trees for 10 queries for the CelebA dataset. Values are normalized so Top- $k$ achieves point (1,1) in each case. MOPR Pareto-dominates baselines and significantly closes the MPR gap. "], "img_footnote": [], "page_idx": 34}, {"type": "image", "img_path": "BRZYhVHvSg/tmp/dc07b850c0caf78141949e21ada827916f568540c57ea65b39f9b300c6cee05b.jpg", "img_caption": ["Figure 12: Fraction of Top- $k$ cosine similarity vs Fraction of Top- $k$ MPR over decision trees for 10 queries for the UTKFace dataset. Values are normalized so Top- $k$ achieves point (1,1) in each case. MOPR Pareto-dominates baselines and significantly closes the MPR gap. "], "img_footnote": [], "page_idx": 34}, {"type": "image", "img_path": "BRZYhVHvSg/tmp/98fd2c87a91e9dba660357a191743a93718f5e249fc31d67bb461c828373b2c5.jpg", "img_caption": ["Figure 13: Fraction of Top- ${\\bf\\nabla}\\cdot{\\bf\\nabla}k$ cosine similarity vs. Fraction of Top- $k$ MPR over decision trees for 10 queries for the Occupations dataset. Values are normalized so Top- $k$ achieves point (1,1) in each case. MOPR Paretodominates baselines and significantly closes the MPR gap. "], "img_footnote": [], "page_idx": 35}, {"type": "image", "img_path": "BRZYhVHvSg/tmp/5f25f46d8a247bde7f092089481664e615e3611e5caf503cad64cd678dc14b27.jpg", "img_caption": ["Figure 14: Fraction of Top- $\\cdot k$ cosine similarity vs Fraction of Top- $k$ MPR over 2-layer MLPs (hidden dimension 64) for 10 queries for the CelebA dataset. Values are normalized so Top- $k$ achieves point (1,1) in each case. MOPR Pareto-dominates baselines and significantly closes the MPR gap. "], "img_footnote": [], "page_idx": 35}, {"type": "image", "img_path": "BRZYhVHvSg/tmp/a9d88e7d9cac497b01f3a0b95c194ca2fd1c93f02069317ac6d0629de8b9fabb.jpg", "img_caption": ["Figure 15: Fraction of Top- $\\cdot k$ cosine similarity vs Fraction of Top- ${\\bf\\nabla}\\cdot{\\bf\\nabla}k$ MPR over 2-layer MLPs (hidden dimension 64) for 10 queries for the UTKFace dataset. Values are normalized so Top- ${\\bf\\nabla}\\cdot{\\bf\\nabla}k$ achieves point (1,1) in each case. MOPR Pareto-dominates baselines and significantly closes the MPR gap. "], "img_footnote": [], "page_idx": 36}, {"type": "image", "img_path": "BRZYhVHvSg/tmp/538c047d3e20d289bedd5b3c262b8f40a18a15c48d92c86c4fd38e6a568d1933.jpg", "img_caption": ["Figure 16: Fraction of Top- $\\cdot k$ cosine similarity vs Fraction of Top- ${\\bf\\nabla}\\cdot{\\bf\\nabla}k$ MPR over 2-layer MLPs (hidden dimension 64) for 10 queries for the Occupations dataset. Values are normalized so Top- $k$ achieves point (1,1) in each case. MOPR Pareto-dominates baselines and significantly closes the MPR gap. "], "img_footnote": [], "page_idx": 36}, {"type": "image", "img_path": "BRZYhVHvSg/tmp/0c0c688a91fb1d7690df4abdc64adfb72b95af8d17127ff9265544b7fe2669d4.jpg", "img_caption": ["Figure 17: Fraction of Top- $\\cdot k$ cosine similarity vs Fraction of Top- ${\\bf\\nabla}\\cdot{\\bf\\nabla}k$ MPR over linear regression models for 45 (First 15, see Figures 18 and 19) occupations present in the Occupations dataset. Values are normalized so Top- ${\\bf\\nabla}\\cdot{\\bf\\nabla}k$ achieves point (1,1) in each case. MOPR Pareto-dominates baselines and significantly closes the MPR gap. "], "img_footnote": [], "page_idx": 37}, {"type": "image", "img_path": "BRZYhVHvSg/tmp/53050229545505d777cd7996671a41ee4315b945f200aef1f542e5086981c1e9.jpg", "img_caption": ["Figure 18: Fraction of Top- $\\cdot k$ cosine similarity vs Fraction of Top- ${\\bf\\nabla}\\cdot{\\bf\\nabla}k$ MPR over linear regression models for 45 (Second 15, see Figures 17 and 19) occupations present in the Occupations dataset. Values are normalized so Top- ${\\bf\\nabla}\\cdot{\\bf k}$ achieves point (1,1) in each case. MOPR Pareto-dominates baselines and significantly closes the MPR gap. "], "img_footnote": [], "page_idx": 38}, {"type": "image", "img_path": "BRZYhVHvSg/tmp/f141c9ff806da4a5d08421c3593d3c5c842cd0fcdfcf18e3edcc93f4456974ea.jpg", "img_caption": ["Figure 19: Fraction of Top- $\\cdot k$ cosine similarity vs Fraction of Top- ${\\bf\\nabla}\\cdot{\\bf\\nabla}k$ MPR over linear regression models for 45 (Third 15, see Figures 17 and 18) occupations present in the Occupations dataset. Values are normalized so Top- ${\\bf\\nabla}\\cdot{\\bf k}$ achieves point (1,1) in each case. MOPR Pareto-dominates baselines and significantly closes the MPR gap. "], "img_footnote": [], "page_idx": 39}, {"type": "image", "img_path": "BRZYhVHvSg/tmp/29ea80d0f2185b5bbfd9eaeeb7465ec6dd6fccfda61a55fff688b1fa3fea79ea.jpg", "img_caption": ["Figure 20: Precision-MPR curve on Occupations dataset over linear regression. Retrieving 50 items for the query \u201cA photo of a chief executive officer.\" MPR remains competitive in terms of retrieval performance. "], "img_footnote": [], "page_idx": 40}, {"type": "image", "img_path": "BRZYhVHvSg/tmp/75c62749bb23b8e28c8a2602e9a8419b2c3ecaca86ca73cc9de315bb34a84221.jpg", "img_caption": ["Figure 21: Additional precision-representation plots over queries \u201cbartender\", \u201cbus driver\", \u201cchemist\", \u201cconstruction worker\", \u201ccustomer service representative\", \u201chousekeeper\", \u201cnurse practitioner\", \u201creceptionist\", and \u201csepecial ed teacher\". "], "img_footnote": [], "page_idx": 40}, {"type": "image", "img_path": "BRZYhVHvSg/tmp/ae9e2511aef0bc924d37b1097132f6fdf71743ddf7776368399c1f9dd3b4ce9f.jpg", "img_caption": ["Figure 22: Retrievals for MOPR with query \u201cA photo of a teacher\" "], "img_footnote": [], "page_idx": 41}, {"type": "image", "img_path": "BRZYhVHvSg/tmp/d938e12f09db68fbca0ade12108179132c892e3155d3e4b2a219785f36141c79.jpg", "img_caption": ["Figure 23: Retrievals for $k$ -NN with query \u201cA photo of a teacher\" "], "img_footnote": [], "page_idx": 41}, {"type": "image", "img_path": "BRZYhVHvSg/tmp/4905d409867dc249829212420e7d8e5fe369c324b5cfeeaadca524000b4e12fa.jpg", "img_caption": ["Figure 24: Retrievals for MMR with query \u201cA photo of a teacher\" "], "img_footnote": [], "page_idx": 42}, {"type": "image", "img_path": "BRZYhVHvSg/tmp/9382d9d43be27e5ef5d6af7ec9a5df77e2140a00c7a2514b90da9ec9663a00a1.jpg", "img_caption": ["Figure 25: Retrievals for CLIP-Clip with query \u201cA photo of a teacher\" "], "img_footnote": [], "page_idx": 42}, {"type": "image", "img_path": "BRZYhVHvSg/tmp/4bd476f5342e21f06596f899c947d756bccbb24134beb00e18eaa6e60ce68e7a.jpg", "img_caption": ["Figure 26: Retrievals for PBM with query \u201cA photo of a teacher\" "], "img_footnote": [], "page_idx": 43}, {"type": "image", "img_path": "BRZYhVHvSg/tmp/946a0e90c9b41832e10b82b9579dca3b86edaa84c6a8f4f180890c9c1b2df1e2.jpg", "img_caption": ["Figure 27: Retrievals for DebiasCLIP with query \u201cA photo of a teacher\" "], "img_footnote": [], "page_idx": 43}, {"type": "image", "img_path": "BRZYhVHvSg/tmp/bdf0894010c33b7ab435a6421c09d3dd4b59d032ec9126ac2056d24e1f2ec7eb.jpg", "img_caption": ["Figure 28: Retrievals for MOPR with query \u201cA photo of an architect\" "], "img_footnote": [], "page_idx": 44}, {"type": "image", "img_path": "BRZYhVHvSg/tmp/6bc93aecda146e6b1a7cd12cff9449cc7a9229c5a0b1e99848f0be3fc6136c92.jpg", "img_caption": ["Figure 29: Retrievals for $k$ -NN with query \u201cA photo of an architect\" "], "img_footnote": [], "page_idx": 44}, {"type": "image", "img_path": "BRZYhVHvSg/tmp/beb0038e4f907a3f9cd0d6e258c1e8d88e0e88c49037c078b9b13730217eeead.jpg", "img_caption": ["Figure 30: Retrievals for MMR with query \u201cA photo of an architect\" "], "img_footnote": [], "page_idx": 45}, {"type": "image", "img_path": "BRZYhVHvSg/tmp/883b7fd1639d836e363852223fca986d5abae1a0b076c7f133cb4a3903e830df.jpg", "img_caption": ["Figure 31: Retrievals for CLIP-Clip with query \u201cA photo of an architect\" "], "img_footnote": [], "page_idx": 45}, {"type": "image", "img_path": "BRZYhVHvSg/tmp/6b310293c3326b2b99b4064f5b427fcf3e05ec0f9353744fe4620e6faa4deb29.jpg", "img_caption": ["Figure 32: Retrievals for PBM with query \u201cA photo of an architect\" "], "img_footnote": [], "page_idx": 46}, {"type": "image", "img_path": "BRZYhVHvSg/tmp/0bad40c401d1552cc5694a70587da88ba38d131c97d779ea67119707451d44f1.jpg", "img_caption": ["Figure 33: Retrievals for DebiasCLIP with query \u201cA photo of an architect\" "], "img_footnote": [], "page_idx": 46}, {"type": "text", "text": "H Experiment Notes ", "text_level": 1, "page_idx": 47}, {"type": "text", "text": "H.1 GPT Generated Queries. ", "text_level": 1, "page_idx": 47}, {"type": "text", "text": "The 10 queries used in experiments and generated by GPT are as follows: [programmer, nurse, architect, scientist, artist, chef, lawyer, teacher, engineer, doctor]. ", "page_idx": 47}, {"type": "text", "text": "H.2 Experiment Setting and Details. ", "text_level": 1, "page_idx": 47}, {"type": "text", "text": "These experiments were conducted mainly on CPU after initially using a single A100 GPU to compute CLIP and DebiasCLIP embeddings and run FAISS to compute the top $10\\mathbf{k}$ candidates for each. Then, all embeddings are saved so that retrieval across all methods can be run on the CPU. When training linear probes, we conduct a cross-validated hyperparameter search from 0.01 to 100 over $\\ell_{2}$ regularized logistic regression models from scikit-learn [69] to find the optimal probe. ", "page_idx": 47}, {"type": "text", "text": "To run MOPR, we use Gurobi [98] with an Academic License to solve Eqn. (9) each iteration of our cutting plane method and use CVXPY [99, 100] to solve our closed-form, quadratic program. ", "page_idx": 47}, {"type": "text", "text": "To train our oracle estimators, we call scikit-learn\u2019s implementations of Linear Regression, Decision Trees with depth 3, and MLPs with one hidden layer of size 64. ", "page_idx": 47}, {"type": "text", "text": "On average, the runtime for MOPR is approximately 1-5 minutes with 50 queries and 10000 elements in each of our retrieval and curation sets. However, with more features (such as using CLIP embeddings instead of group attributes), this runtime can increase. We note, however, that our most competitive baseline, MMR, is a greedy algorithm that requires 1-2 hours per query to compute. In live image retrieval settings, this runtime is too slow to be of any practical use. ", "page_idx": 47}, {"type": "text", "text": "NeurIPS Paper Checklist ", "text_level": 1, "page_idx": 47}, {"type": "text", "text": "1. Claims ", "text_level": 1, "page_idx": 47}, {"type": "text", "text": "Question: Do the main claims made in the abstract and introduction accurately reflect the paper\u2019s contributions and scope? ", "page_idx": 47}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 47}, {"type": "text", "text": "Justification: In this paper, we introduce the novel metric Multi-Group Proportional Representation (MPR) in Section 4, we provide theoretical guarantees in Section 3, we develop a practical algorithm in Section 4 and we numerically show that existing methods optimizing for equal and proportional representation metrics may fail to promote MPR in Section 5 ", "page_idx": 47}, {"type": "text", "text": "Guidelines: ", "text_level": 1, "page_idx": 47}, {"type": "text", "text": "\u2022 The answer NA means that the abstract and introduction do not include the claims made in the paper.   \n\u2022 The abstract and/or introduction should clearly state the claims made, including the contributions made in the paper and important assumptions and limitations. A No or NA answer to this question will not be perceived well by the reviewers.   \n\u2022 The claims made should match theoretical and experimental results, and reflect how much the results can be expected to generalize to other settings.   \n\u2022 It is fine to include aspirational goals as motivation as long as it is clear that these goals are not attained by the paper. ", "page_idx": 47}, {"type": "text", "text": "2. Limitations ", "text_level": 1, "page_idx": 47}, {"type": "text", "text": "Question: Does the paper discuss the limitations of the work performed by the authors? Answer: [Yes] ", "page_idx": 47}, {"type": "text", "text": "Justification: We describe them at the conclusion. First, while MPR is designed to handle a large number of groups, the computational complexity of the proposed cutting-plane algorithm in the case of a general function class $\\mathcal{C}$ can be a concern for high-dimensional feature spaces. Developing more efficient algorithms or approximation techniques could help address this issue. Second, while we focused on retrieval tasks, adapting MPR to other domains, such as ranking, recommendation systems, and image generation, could broaden its impact and applicability. Future research could also investigate the long-term societal impact of enforcing MPR in real-world retrieval systems to understand its potential beneftis and risks. Finally, MPR is inherently limited by the curated dataset. If this dataset is biased against a given group, this bias will be propagated by MOPR. ", "page_idx": 47}, {"type": "text", "text": "", "page_idx": 48}, {"type": "text", "text": "Guidelines: ", "page_idx": 48}, {"type": "text", "text": "\u2022 The answer NA means that the paper has no limitation while the answer No means that the paper has limitations, but those are not discussed in the paper.   \n\u2022 The authors are encouraged to create a separate \"Limitations\" section in their paper.   \n\u2022 The paper should point out any strong assumptions and how robust the results are to violations of these assumptions (e.g., independence assumptions, noiseless settings, model well-specification, asymptotic approximations only holding locally). The authors should reflect on how these assumptions might be violated in practice and what the implications would be.   \n\u2022 The authors should reflect on the scope of the claims made, e.g., if the approach was only tested on a few datasets or with a few runs. In general, empirical results often depend on implicit assumptions, which should be articulated.   \n\u2022 The authors should reflect on the factors that influence the performance of the approach. For example, a facial recognition algorithm may perform poorly when image resolution is low or images are taken in low lighting. Or a speech-to-text system might not be used reliably to provide closed captions for online lectures because it fails to handle technical jargon.   \n\u2022 The authors should discuss the computational efficiency of the proposed algorithms and how they scale with dataset size.   \n\u2022 If applicable, the authors should discuss possible limitations of their approach to address problems of privacy and fairness.   \n\u2022 While the authors might fear that complete honesty about limitations might be used by reviewers as grounds for rejection, a worse outcome might be that reviewers discover limitations that aren\u2019t acknowledged in the paper. The authors should use their best judgment and recognize that individual actions in favor of transparency play an important role in developing norms that preserve the integrity of the community. Reviewers will be specifically instructed to not penalize honesty concerning limitations. ", "page_idx": 48}, {"type": "text", "text": "3. Theory Assumptions and Proofs ", "text_level": 1, "page_idx": 48}, {"type": "text", "text": "Question: For each theoretical result, does the paper provide the full set of assumptions and a complete (and correct) proof? ", "page_idx": 48}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 48}, {"type": "text", "text": "Justification: We prove all the theorems in the paper in Section C and Section D. Guidelines: ", "page_idx": 48}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include theoretical results.   \n\u2022 All the theorems, formulas, and proofs in the paper should be numbered and crossreferenced.   \n\u2022 All assumptions should be clearly stated or referenced in the statement of any theorems.   \n\u2022 The proofs can either appear in the main paper or the supplemental material, but if they appear in the supplemental material, the authors are encouraged to provide a short proof sketch to provide intuition.   \n\u2022 Inversely, any informal proof provided in the core of the paper should be complemented by formal proofs provided in appendix or supplemental material.   \n\u2022 Theorems and Lemmas that the proof relies upon should be properly referenced. ", "page_idx": 48}, {"type": "text", "text": "4. Experimental Result Reproducibility ", "text_level": 1, "page_idx": 48}, {"type": "text", "text": "Question: Does the paper fully disclose all the information needed to reproduce the main experimental results of the paper to the extent that it affects the main claims and/or conclusions of the paper (regardless of whether the code and data are provided or not)? ", "page_idx": 48}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 48}, {"type": "text", "text": "Justification: All the necessary information to reproduce the main results will be available in a Github repository with precise instructions for each figure generated in this paper. ", "page_idx": 48}, {"type": "text", "text": "Guidelines: ", "page_idx": 49}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 If the paper includes experiments, a No answer to this question will not be perceived well by the reviewers: Making the paper reproducible is important, regardless of whether the code and data are provided or not.   \n\u2022 If the contribution is a dataset and/or model, the authors should describe the steps taken to make their results reproducible or verifiable.   \n\u2022 Depending on the contribution, reproducibility can be accomplished in various ways. For example, if the contribution is a novel architecture, describing the architecture fully might suffice, or if the contribution is a specific model and empirical evaluation, it may be necessary to either make it possible for others to replicate the model with the same dataset, or provide access to the model. In general. releasing code and data is often one good way to accomplish this, but reproducibility can also be provided via detailed instructions for how to replicate the results, access to a hosted model (e.g., in the case of a large language model), releasing of a model checkpoint, or other means that are appropriate to the research performed.   \n\u2022 While NeurIPS does not require releasing code, the conference does require all submissions to provide some reasonable avenue for reproducibility, which may depend on the nature of the contribution. For example (a) If the contribution is primarily a new algorithm, the paper should make it clear how to reproduce that algorithm. (b) If the contribution is primarily a new model architecture, the paper should describe the architecture clearly and fully. (c) If the contribution is a new model (e.g., a large language model), then there should either be a way to access this model for reproducing the results or a way to reproduce the model (e.g., with an open-source dataset or instructions for how to construct the dataset). (d) We recognize that reproducibility may be tricky in some cases, in which case authors are welcome to describe the particular way they provide for reproducibility. In the case of closed-source models, it may be that access to the model is limited in some way (e.g., to registered users), but it should be possible for other researchers to have some path to reproducing or verifying the results. ", "page_idx": 49}, {"type": "text", "text": "5. Open access to data and code ", "text_level": 1, "page_idx": 49}, {"type": "text", "text": "Question: Does the paper provide open access to the data and code, with sufficient instructions to faithfully reproduce the main experimental results, as described in supplemental material? ", "page_idx": 49}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 49}, {"type": "text", "text": "Justification: The datasets CelebA [38], occupations Celis and Keswani [31], Fairface [39], and UTKFace [40] are all publicly available and the code to generated all the figures presented in the paper and to reproduce all the experiments will be available in a public Github repository. ", "page_idx": 49}, {"type": "text", "text": "Guidelines: ", "text_level": 1, "page_idx": 49}, {"type": "text", "text": "\u2022 The answer NA means that paper does not include experiments requiring code.   \n\u2022 Please see the NeurIPS code and data submission guidelines (https://nips.cc/ public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 While we encourage the release of code and data, we understand that this might not be possible, so \u201cNo\u201d is an acceptable answer. Papers cannot be rejected simply for not including code, unless this is central to the contribution (e.g., for a new open-source benchmark).   \n\u2022 The instructions should contain the exact command and environment needed to run to reproduce the results. See the NeurIPS code and data submission guidelines (https: //nips.cc/public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 The authors should provide instructions on data access and preparation, including how to access the raw data, preprocessed data, intermediate data, and generated data, etc.   \n\u2022 The authors should provide scripts to reproduce all experimental results for the new proposed method and baselines. If only a subset of experiments are reproducible, they should state which ones are omitted from the script and why.   \n\u2022 At submission time, to preserve anonymity, the authors should release anonymized versions (if applicable).   \n\u2022 Providing as much information as possible in supplemental material (appended to the paper) is recommended, but including URLs to data and code is permitted. ", "page_idx": 49}, {"type": "text", "text": "", "page_idx": 50}, {"type": "text", "text": "6. Experimental Setting/Details ", "text_level": 1, "page_idx": 50}, {"type": "text", "text": "Question: Does the paper specify all the training and test details (e.g., data splits, hyperparameters, how they were chosen, type of optimizer, etc.) necessary to understand the results? ", "page_idx": 50}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 50}, {"type": "text", "text": "Justification: The experimental setting is described in H. ", "page_idx": 50}, {"type": "text", "text": "Guidelines: ", "page_idx": 50}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments. \u2022 The experimental setting should be presented in the core of the paper to a level of detail that is necessary to appreciate the results and make sense of them. \u2022 The full details can be provided either with the code, in appendix, or as supplemental material. ", "page_idx": 50}, {"type": "text", "text": "7. Experiment Statistical Significance ", "text_level": 1, "page_idx": 50}, {"type": "text", "text": "Question: Does the paper report error bars suitably and correctly defined or other appropriate information about the statistical significance of the experiments? ", "page_idx": 50}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 50}, {"type": "text", "text": "Justification: Tables 1, 5 and 6 have deviation bars, and the experiments are averaged over multiple queries. ", "page_idx": 50}, {"type": "text", "text": "Guidelines: ", "page_idx": 50}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The authors should answer \"Yes\" if the results are accompanied by error bars, confidence intervals, or statistical significance tests, at least for the experiments that support the main claims of the paper.   \n\u2022 The factors of variability that the error bars are capturing should be clearly stated (for example, train/test split, initialization, random drawing of some parameter, or overall run with given experimental conditions).   \n\u2022 The method for calculating the error bars should be explained (closed form formula, call to a library function, bootstrap, etc.)   \n\u2022 The assumptions made should be given (e.g., Normally distributed errors).   \n\u2022 It should be clear whether the error bar is the standard deviation or the standard error of the mean.   \n\u2022 It is OK to report 1-sigma error bars, but one should state it. The authors should preferably report a 2-sigma error bar than state that they have a $96\\%$ CI, if the hypothesis of Normality of errors is not verified.   \n\u2022 For asymmetric distributions, the authors should be careful not to show in tables or figures symmetric error bars that would yield results that are out of range (e.g. negative error rates).   \n\u2022 If error bars are reported in tables or plots, The authors should explain in the text how they were calculated and reference the corresponding figures or tables in the text. ", "page_idx": 50}, {"type": "text", "text": "8. Experiments Compute Resources ", "text_level": 1, "page_idx": 50}, {"type": "text", "text": "Question: For each experiment, does the paper provide sufficient information on the computer resources (type of compute workers, memory, time of execution) needed to reproduce the experiments? ", "page_idx": 50}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 50}, {"type": "text", "text": "Justification: The computer resources are described in Appendix H. ", "page_idx": 50}, {"type": "text", "text": "Guidelines: ", "page_idx": 51}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The paper should indicate the type of compute workers CPU or GPU, internal cluster, or cloud provider, including relevant memory and storage.   \n\u2022 The paper should provide the amount of compute required for each of the individual experimental runs as well as estimate the total compute.   \n\u2022 The paper should disclose whether the full research project required more compute than the experiments reported in the paper (e.g., preliminary or failed experiments that didn\u2019t make it into the paper). ", "page_idx": 51}, {"type": "text", "text": "9. Code Of Ethics ", "text_level": 1, "page_idx": 51}, {"type": "text", "text": "Question: Does the research conducted in the paper conform, in every respect, with the NeurIPS Code of Ethics https://neurips.cc/public/EthicsGuidelines? ", "page_idx": 51}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 51}, {"type": "text", "text": "Justification: The research conducted in this paper conforms in every respect to the NeurIPS Code of Ethics. The paper aims to develop techniques for improving multi-group representation in image retrieval systems, which aligns with the Code\u2019s principles of avoiding discrimination and promoting fairness. The paper does not raise any ethical concerns related to safety, security, privacy, or human rights. The techniques are designed to be applied to standard, publicly available image datasets and do not involve any surveillance, tracking or identifying of individuals. No deception or harassment is involved. In the paper, we include a discussion of broader impacts, both positive and negative. On the positive side, the techniques can help mitigate biases and underrepresentation of certain groups in image search results. This can have significant societal benefits by reducing stereotyping and increasing visibility of marginalized groups. We do not anticipate any direct negative societal impacts, as the methods aim to improve fairness without privileging any groups. ", "page_idx": 51}, {"type": "text", "text": "Guidelines: ", "page_idx": 51}, {"type": "text", "text": "\u2022 The answer NA means that the authors have not reviewed the NeurIPS Code of Ethics.   \n\u2022 If the authors answer No, they should explain the special circumstances that require a deviation from the Code of Ethics.   \n\u2022 The authors should make sure to preserve anonymity (e.g., if there is a special consideration due to laws or regulations in their jurisdiction). ", "page_idx": 51}, {"type": "text", "text": "10. Broader Impacts ", "text_level": 1, "page_idx": 51}, {"type": "text", "text": "Question: Does the paper discuss both potential positive societal impacts and negative societal impacts of the work performed? ", "page_idx": 51}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 51}, {"type": "text", "text": "Justification: As discussed in the previous answer, we included a discussion of broader impacts, both positive and negative. Regarding potential negative impacts, we acknowledge in the paper that if the reference distribution is biased, then biases will be propagated to the retrieved items. Still, we believe that our method represents an improvement over current approaches that do not consider representational fairness at all. On the positive side, our method has the potential to significantly reduce representational harms in image retrieval systems. By ensuring that results reflect the diversity of the population, we can help combat stereotyping, erasure, and discrimination. This can have wide-ranging societal benefits in shaping perceptions and providing visibility for marginalized groups. ", "page_idx": 51}, {"type": "text", "text": "We discuss these limitations openly. ", "page_idx": 51}, {"type": "text", "text": "Guidelines: ", "page_idx": 51}, {"type": "text", "text": "\u2022 The answer NA means that there is no societal impact of the work performed.   \n\u2022 If the authors answer NA or No, they should explain why their work has no societal impact or why the paper does not address societal impact.   \n\u2022 Examples of negative societal impacts include potential malicious or unintended uses (e.g., disinformation, generating fake profiles, surveillance), fairness considerations (e.g., deployment of technologies that could make decisions that unfairly impact specific groups), privacy considerations, and security considerations.   \n\u2022 The conference expects that many papers will be foundational research and not tied to particular applications, let alone deployments. However, if there is a direct path to any negative applications, the authors should point it out. For example, it is legitimate to point out that an improvement in the quality of generative models could be used to generate deepfakes for disinformation. On the other hand, it is not needed to point out that a generic algorithm for optimizing neural networks could enable people to train models that generate Deepfakes faster.   \n\u2022 The authors should consider possible harms that could arise when the technology is being used as intended and functioning correctly, harms that could arise when the technology is being used as intended but gives incorrect results, and harms following from (intentional or unintentional) misuse of the technology.   \n\u2022 If there are negative societal impacts, the authors could also discuss possible mitigation strategies (e.g., gated release of models, providing defenses in addition to attacks, mechanisms for monitoring misuse, mechanisms to monitor how a system learns from feedback over time, improving the efficiency and accessibility of ML). ", "page_idx": 51}, {"type": "text", "text": "", "page_idx": 52}, {"type": "text", "text": "11. Safeguards ", "text_level": 1, "page_idx": 52}, {"type": "text", "text": "Question: Does the paper describe safeguards that have been put in place for responsible release of data or models that have a high risk for misuse (e.g., pretrained language models, image generators, or scraped datasets)? ", "page_idx": 52}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 52}, {"type": "text", "text": "Justification: We are not generating any new datasets or models and, therefore, we dont need safeguard. ", "page_idx": 52}, {"type": "text", "text": "Guidelines: ", "page_idx": 52}, {"type": "text", "text": "\u2022 The answer NA means that the paper poses no such risks.   \n\u2022 Released models that have a high risk for misuse or dual-use should be released with necessary safeguards to allow for controlled use of the model, for example by requiring that users adhere to usage guidelines or restrictions to access the model or implementing safety filters.   \n\u2022 Datasets that have been scraped from the Internet could pose safety risks. The authors should describe how they avoided releasing unsafe images.   \n\u2022 We recognize that providing effective safeguards is challenging, and many papers do not require this, but we encourage authors to take this into account and make a best faith effort. ", "page_idx": 52}, {"type": "text", "text": "12. Licenses for existing assets ", "text_level": 1, "page_idx": 52}, {"type": "text", "text": "Question: Are the creators or original owners of assets (e.g., code, data, models), used in the paper, properly credited and are the license and terms of use explicitly mentioned and properly respected? ", "page_idx": 52}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 52}, {"type": "text", "text": "Justification: We are citing all the publicly available datasets and codes used in the paper. Guidelines: ", "page_idx": 52}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not use existing assets.   \n\u2022 The authors should cite the original paper that produced the code package or dataset.   \n\u2022 The authors should state which version of the asset is used and, if possible, include a URL.   \n\u2022 The name of the license (e.g., CC-BY 4.0) should be included for each asset.   \n\u2022 For scraped data from a particular source (e.g., website), the copyright and terms of service of that source should be provided.   \n\u2022 If assets are released, the license, copyright information, and terms of use in the package should be provided. For popular datasets, paperswithcode.com/datasets has curated licenses for some datasets. Their licensing guide can help determine the license of a dataset.   \n\u2022 For existing datasets that are re-packaged, both the original license and the license of the derived asset (if it has changed) should be provided. ", "page_idx": 52}, {"type": "text", "text": "\u2022 If this information is not available online, the authors are encouraged to reach out to the asset\u2019s creators. ", "page_idx": 53}, {"type": "text", "text": "13. New Assets ", "text_level": 1, "page_idx": 53}, {"type": "text", "text": "Question: Are new assets introduced in the paper well documented and is the documentation provided alongside the assets? ", "page_idx": 53}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 53}, {"type": "text", "text": "Justification: We have added an anonymous repository https://github.com/ alex-oesterling/multigroup-proportional-representation with all the code and instructions to reproduce our experiments. ", "page_idx": 53}, {"type": "text", "text": "Guidelines: ", "page_idx": 53}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not release new assets.   \n\u2022 Researchers should communicate the details of the dataset/code/model as part of their submissions via structured templates. This includes details about training, license, limitations, etc.   \n\u2022 The paper should discuss whether and how consent was obtained from people whose asset is used.   \n\u2022 At submission time, remember to anonymize your assets (if applicable). You can either create an anonymized URL or include an anonymized zip file. ", "page_idx": 53}, {"type": "text", "text": "14. Crowdsourcing and Research with Human Subjects ", "text_level": 1, "page_idx": 53}, {"type": "text", "text": "Question: For crowdsourcing experiments and research with human subjects, does the paper include the full text of instructions given to participants and screenshots, if applicable, as well as details about compensation (if any)? ", "page_idx": 53}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 53}, {"type": "text", "text": "Justification: [NA] Guidelines: ", "page_idx": 53}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Including this information in the supplemental material is fine, but if the main contribution of the paper involves human subjects, then as much detail as possible should be included in the main paper.   \n\u2022 According to the NeurIPS Code of Ethics, workers involved in data collection, curation, or other labor should be paid at least the minimum wage in the country of the data collector. ", "page_idx": 53}, {"type": "text", "text": "15. Institutional Review Board (IRB) Approvals or Equivalent for Research with Human Subjects ", "text_level": 1, "page_idx": 53}, {"type": "text", "text": "Question: Does the paper describe potential risks incurred by study participants, whether such risks were disclosed to the subjects, and whether Institutional Review Board (IRB) approvals (or an equivalent approval/review based on the requirements of your country or institution) were obtained? ", "page_idx": 53}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 53}, {"type": "text", "text": "Justification: [NA] ", "page_idx": 53}, {"type": "text", "text": "Guidelines: ", "page_idx": 53}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Depending on the country in which research is conducted, IRB approval (or equivalent) may be required for any human subjects research. If you obtained IRB approval, you should clearly state this in the paper.   \n\u2022 We recognize that the procedures for this may vary significantly between institutions and locations, and we expect authors to adhere to the NeurIPS Code of Ethics and the guidelines for their institution.   \n\u2022 For initial submissions, do not include any information that would break anonymity (if applicable), such as the institution conducting the review. ", "page_idx": 53}]