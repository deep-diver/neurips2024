[{"figure_path": "HeoRsnaD44/figures/figures_1_1.jpg", "caption": "Figure 1: UniGuide handles diverse conditioning modalities for guidance, including: (i) a target receptor for SBDD, (ii) additional molecular fragments for FBDD, or (iii) a predefined 3D shape for LBDD. It combines a source condition s \u2208 S and the unconditional model eo (zt, t) within its condition map to enable self-guidance. The flexible formulation of our approach can be generalised to new geometric tasks, for example, conditioning on atomic densities.", "description": "This figure illustrates the UniGuide framework's ability to handle diverse conditioning modalities for geometry-conditioned molecular generation.  It shows how UniGuide combines a source condition (representing various geometric constraints like target receptor shape in structure-based drug design, fragments in fragment-based drug design, or 3D shapes in ligand-based drug design) with an unconditional diffusion model. This combination, facilitated by a 'condition map', allows for flexible conditioning during inference without the need for extra training or networks.  The figure highlights the framework's versatility and adaptability to various drug discovery tasks, including its potential for handling new geometric tasks, exemplified by the example of conditioning on atomic densities.", "section": "4 UniGuide"}, {"figure_path": "HeoRsnaD44/figures/figures_5_1.jpg", "caption": "Figure 2: Surface condition map Cav: For each atom coordinate xi, the closest surface points y; are computed. The target condition cxi is the projection along the mean of neighbours \u1ef9; to the inside of the volume by a margin a, where x0 denotes the conformation of the clean data point estimation 20 as computed by Eq. (11). To satisfy Theorem 4.1, Cav first aligns y with x0 by a rotation Rx \u2208 R3\u00d73 resulting from the ICP algorithm [61]. For every atom coordinate \u00e6i, Cav subsequently computes the mean \u1ef9i over \u0302xi's k closest surface points:", "description": "This figure shows how the surface condition map Cav works for ligand-based drug design (LBDD).  The map takes as input a set of points (y) sampled from the surface of a reference ligand and the estimated clean conformation (x0) from an unconditional model.  To align the reference ligand's shape with the molecule being generated, a rotation (Rx) is applied using the Iterative Closest Point (ICP) algorithm.  The algorithm then computes the mean of the k nearest neighbors (\u1ef9i) for each atom (xi) and projects it inwards by a margin (a) to generate a target condition (cxi) for guiding the molecule generation process.", "section": "4.2 UniGuide for drug discovery"}, {"figure_path": "HeoRsnaD44/figures/figures_7_1.jpg", "caption": "Figure 3: Examples of the two shape-conditioned ligands generated by UniGuide. The goal is to have low molecular graph similarity and high shape similarity.", "description": "This figure shows two examples of ligand molecules generated using the UniGuide method.  The goal of the ligand-based drug design (LBDD) task is to create new molecules that have a similar 3D shape to a reference molecule, but different molecular structures.  The figure demonstrates that UniGuide successfully generated two ligands (in blue) that are very similar in 3D shape to their respective reference molecules (in grey).   Importantly, the figure emphasizes that the generated ligands have low molecular graph similarity to their reference molecules, indicating that UniGuide can generate molecules with the same 3D shape but substantially different structures. This is a key aspect of the LBDD task, which aims to find novel molecules with similar shapes but potentially different interactions with a target protein.", "section": "5.1 Ligand-based drug design"}, {"figure_path": "HeoRsnaD44/figures/figures_8_1.jpg", "caption": "Figure 3: Examples of the two shape-conditioned ligands generated by UniGuide. The goal is to have low molecular graph similarity and high shape similarity.", "description": "This figure shows two examples of ligands generated using UniGuide with shape conditioning.  The goal of the method is to create molecules with similar 3D shapes to a reference ligand, but different molecular structures (low graph similarity, high shape similarity). The figure visually demonstrates that UniGuide can successfully generate molecules fulfilling this objective.", "section": "5.1 Ligand-based drug design"}, {"figure_path": "HeoRsnaD44/figures/figures_9_1.jpg", "caption": "Figure 1: UniGuide handles diverse conditioning modalities for guidance, including: (i) a target receptor for SBDD, (ii) additional molecular fragments for FBDD, or (iii) a predefined 3D shape for LBDD. It combines a source condition s \u2208 S and the unconditional model \u03b8(zt, t) within its condition map to enable self-guidance. The flexible formulation of our approach can be generalised to new geometric tasks, for example, conditioning on atomic densities.", "description": "This figure illustrates the versatility of UniGuide in handling diverse conditioning modalities for geometry-conditioned molecular generation.  It shows how UniGuide incorporates different types of geometric constraints (target receptor for structure-based drug design, fragments for fragment-based drug design, and 3D shape for ligand-based drug design) into an unconditional diffusion model using a condition map. The figure highlights the flexibility of UniGuide, emphasizing its adaptability to various geometric tasks beyond the three examples shown, such as conditioning on atomic densities.", "section": "1 Introduction"}, {"figure_path": "HeoRsnaD44/figures/figures_18_1.jpg", "caption": "Figure 6: Examples of the ligands generated by ShapeMol, Pos-Correct and UniGuide. Pos-Correct is the position correction technique proposed by Chen et al. [14]. Both Pos-Correct and UniGuide are combined with the unconditionally trained model ShapeMol [U]. We plot the reference ligand as well as the generated ligands with their shapes.", "description": "This figure compares the 3D shapes of ligands generated by three different methods: ShapeMol, Pos-Correct, and UniGuide.  All three methods used an unconditionally trained ShapeMol model. The goal was to generate ligands that have similar 3D shapes to a reference ligand, but different molecular structures. The figure shows that UniGuide is able to generate ligands with similar shapes to the reference ligand, but with a wider variety of structures compared to ShapeMol and Pos-Correct.", "section": "D.2 Additional results"}, {"figure_path": "HeoRsnaD44/figures/figures_25_1.jpg", "caption": "Figure 1: UniGuide handles diverse conditioning modalities for guidance, including: (i) a target receptor for SBDD, (ii) additional molecular fragments for FBDD, or (iii) a predefined 3D shape for LBDD. It combines a source condition s \u2208 S and the unconditional model eo (zt, t) within its condition map to enable self-guidance. The flexible formulation of our approach can be generalised to new geometric tasks, for example, conditioning on atomic densities.", "description": "This figure illustrates the UniGuide framework's ability to handle various geometric conditions for molecular generation.  It shows how UniGuide combines a source condition (e.g., target receptor, molecular fragments, 3D shape) with an unconditional diffusion model to guide the generation process. The key innovation is the condition map, which transforms complex geometric conditions into a format compatible with the diffusion model, enabling flexible conditioning during inference without additional training or networks. The framework can adapt to new geometric tasks beyond the examples shown (e.g., conditioning on atomic densities).", "section": "4 UniGuide"}, {"figure_path": "HeoRsnaD44/figures/figures_26_1.jpg", "caption": "Figure 8: Given a source density of oxygens, we can extend UniGuide to generate ligands satisfying the condition.", "description": "This figure shows two examples of how UniGuide can be extended to generate molecules with desired atom densities.  The top row shows a protein (5I87) and its reference ligand, along with a density map highlighting aromatic carbon rings (in green).  UniGuide is then used to generate new ligands, shown in the 'Conditional Samples with UniGuide' section and also individually in the 'Individual Examples' section.  These generated ligands incorporate the desired aromatic carbon rings. The bottom row follows the same procedure, but focuses on generating ligands with specific oxygen (red) and nitrogen (blue) atom densities for a different protein (5n8v). The generated ligands successfully include these desired atoms.", "section": "G Atom densities in 3D space"}]