[{"type": "text", "text": "Image Reconstruction Via Autoencoding Sequential Deep Image Prior ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Ismail R. Alkhouri\u22171,2, Shijun Liang\u22173, Evan $\\mathbf{Bell}^{1}$ , Qing $\\mathbf{Qu^{2}}$ , Rongrong Wang1,4, Saiprasad Ravishankar1,3 ", "page_idx": 0}, {"type": "text", "text": "1Department of Computational Mathematics, Science, & Engineering, Michigan State University   \n2Department of Electrical Engineering & Computer Science, University of Michigan - Ann Arbor 3Department of Biomedical Engineering, Michigan State University 4Department of Mathematics, Michigan State University {alkhour3,liangs16,belleva1,wangron6,ravisha3}@msu.edu {ismailal,qingqu}@umich.edu ", "page_idx": 0}, {"type": "text", "text": "Abstract ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Recently, Deep Image Prior (DIP) has emerged as an effective unsupervised oneshot learner, delivering competitive results across various image recovery problems. This method only requires the noisy measurements and a forward operator, relying solely on deep networks initialized with random noise to learn and restore the structure of the data. However, DIP is notorious for its vulnerability to overfitting due to the overparameterization of the network. Building upon insights into the impact of the DIP input and drawing inspiration from the gradual denoising process in cutting-edge diffusion models, we introduce Autoencoding Sequential DIP (aSeqDIP) for image reconstruction. This method progressively denoises and reconstructs the image through a sequential optimization of network weights. This is achieved using an input-adaptive DIP objective, combined with an autoencoding regularization term. Compared to diffusion models, our method does not require training data and outperforms other DIP-based methods in mitigating noise overfitting while maintaining a similar number of parameter updates as Vanilla DIP. Through extensive experiments, we validate the effectiveness of our method in various image reconstruction tasks, such as MRI and CT reconstruction, as well as in image restoration tasks like image denoising, inpainting, and non-linear deblurring. Our code is available at the GitHub repository aSeqDIP. ", "page_idx": 0}, {"type": "text", "text": "1 Introduction ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Inverse imaging problems arise across various real-world applications [1]. These include tasks such as image denoising [2], image deblurring [3], restoring missing portions of images [4] (in-painting), super-resolution [5], magnetic resonance imaging (MRI) [6], and reconstructing X-ray computed tomography (CT) scans [7]. The common challenge in these scenarios is the reconstruction of images from limited and/or corrupted measurements. ", "page_idx": 0}, {"type": "text", "text": "Recently, a plethora of Deep Neural Network (DNN) techniques have emerged to solve inverse imaging problems, including supervised models that are trained to process measurements and generate estimates approximating the true image [8, 9, 10, 11, 12]. Generative model, such as Diffusion models (DMs) [13], have shown state-of-the-art (SOTA) performance in various imaging inverse problems such as the works in [14, 15, 16]. However, training diffusion models is not only computationally expensive but also demands a significant amount of clean (or fully-sampled) data points [17], limiting their application to data-limited or data-corrupted tasks such as in medical imaging (MRI and CT). To address this challenge, previous DM-based MRI and CT methods typically fine-tune pre-trained DMs (trained on natural images) using limited fully-sampled data points, which are not as readily available as natural images [14, 15]. As such, there is a pressing need to develop methods that can alleviate the reliance on large, clean datasets and/or pre-trained models. ", "page_idx": 0}, {"type": "text", "text": "", "page_idx": 1}, {"type": "text", "text": "One well-known method is Deep Image Prior (DIP) [18], which does not require pre-trained models and relies on the parameters of an architecture (e.g., U-Net [19]). DIP finds a solution without needing any data other than the limited/corrupted task-specific measurements and the forward operator. DIP has shown competitive reconstruction/restoration results in inverse imaging problems such as MRI [20] and image denoising [18]. However, DIP (and most of its variants) suffer from the problem of overfitting. ", "page_idx": 1}, {"type": "text", "text": "In this paper, we introduce Autoencoding Sequential DIP (aSeqDIP) to mitigate noise overfitting artifacts. Our approach comprises a sequential update of network weights. A significant advantage of our approach, in contrast to DM-based methods, is its ability to operate without the need for training data or pre-trained models, thus ftiting into the framework of dataless training [21]. Notably, the total number of parameter updates in aSeqDIP remains equivalent to that of Vanilla DIP [18]. Furthermore, unlike a recent work [20], aSeqDIP eliminates the need for gradient-based input updates. ", "page_idx": 1}, {"type": "text", "text": "Contributions: ", "text_level": 1, "page_idx": 1}, {"type": "text", "text": "\u2022 Building upon an insight about the impact of the DIP network input, we introduce Autoencoding Sequential DIP (aSeqDIP), which incorporates a U-Net architecture whose weights are updated sequentially. These updates are based on objective functions that consist of (i) an input-adaptive data consistency term and $(i i)$ an autoencoding regularization term used for noise overftiting mitigation. \u2022 Our extensive experimental evaluations, in terms of standard image reconstruction metrics and required run-time, highlight the superior (or competitive) performance of aSeqDIP compared to DIP-based and leading DM-based methods for the tasks of MRI and CT reconstruction, denoising, in-painting, and non-linear deblurring. ", "page_idx": 1}, {"type": "text", "text": "Organization: In Section 2, we provide an overview of the considered tasks, and review recent advancements in both DIP-based and DM-based methods. Section 3 introduces our approach, aSeqDIP. Our experimental results are presented in Section 4, followed by discussions on conclusions and future directions in Section 5. ", "page_idx": 1}, {"type": "text", "text": "2 Preliminaries & Related Work ", "text_level": 1, "page_idx": 1}, {"type": "text", "text": "2.1 The Image Reconstruction Problem ", "text_level": 1, "page_idx": 1}, {"type": "text", "text": "Image reconstruction tasks can be defined as recovering an image $\\mathbf{x}^{\\ast}\\,\\in\\,\\mathbb{R}^{n}$ from measurements $\\textbf{y}\\in\\mathbb{R}^{m}$ , where $m\\leq n$ , governed by the forward operator A. For multi-coil MRI, the forward operator is $\\mathbf{A}=\\mathbf{M}\\mathbf{F}\\mathbf{S}$ , where M denotes coil-wise undersampling, $\\mathbf{F}$ is the coil-by-coil Fourier transform, and S represents the sensitivity encoding with multiple coils2. For CT, a simplified forward operator will be used to study the sparse-views setting: $\\mathbf{A}=\\mathbf{C}\\mathbf{R}$ , where $\\mathbf{C}$ is an undersampling operator that selects specific projection views or angles, and $\\mathbf{R}$ denotes the radon transform [22] (corresponding to parallel-beam geometry in CT). For both MRI and CT with limited acquired data (done to accelerate scan or reduce $\\Chi$ -ray dose, etc.), the condition $m<n$ applies. ", "page_idx": 1}, {"type": "text", "text": "For the denoising task, the forward operator is the identity matrix, whereas for in-painting, it is equivalent to applying a binary mask element-wise that masks corrupted or missing pixels. For deblurring, the non-linear forward operator is the neural network approximated kernel in [3]. Next, we review prior arts within the context of DIP-based and DM-based methods. ", "page_idx": 1}, {"type": "text", "text": "2.2 Related Work ", "text_level": 1, "page_idx": 1}, {"type": "text", "text": "DIP-based Methods: Deep Image Prior (DIP) was first introduced by [18]. The authors demonstrated that the architecture of a generator network alone is capable of capturing a significant amount ", "page_idx": 1}, {"type": "text", "text": "of low-level image statistics even before any learning takes place. Specifically, the DIP image reconstruction is obtained through the minimization of the following objective: ", "page_idx": 2}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\hat{\\theta}=\\underset{\\theta}{\\operatorname{argmin}}\\ \\|\\mathbf{A}f_{\\theta}(\\mathbf{z})-\\mathbf{y}\\|_{2}^{2}\\,,\\quad\\hat{\\mathbf{x}}=f_{\\hat{\\theta}}(\\mathbf{z})\\,,}\\end{array}\n$$", "text_format": "latex", "page_idx": 2}, {"type": "text", "text": "where $\\hat{\\bf x}$ is the reconstructed image, and $\\theta$ corresponds to the parameters of network $f:\\mathbb{R}^{n}\\rightarrow\\mathbb{R}^{n}$ , which is typically implemented using a U-Net architecture [19]. The input to the network, $\\mathbf{z}\\in\\mathbb{R}^{n}$ , is randomly chosen and remains fixed throughout the optimization process. While standard DIP was shown to perform well in many tasks, selecting the number of iterations to optimize objective (1) poses a challenge as the network would eventually fti the noise present in y or could fti to undesired images based on the null space of A. ", "page_idx": 2}, {"type": "text", "text": "To mitigate the problem of noise overftiting, previous studies considered different approaches such as regularization, early stopping (ES), and network pruning [23]. For regularization-based methods, the work in [24] enhanced the standard DIP by introducing a total variation (TV) regularization term for denoising and deblurring tasks, whereas the study in [25] proposed combining DIP with stochastic gradient Langevin dynamics (SGLD) [26]. The authors in [27] use running variance as the criterion for ES, whereas the authors of [28] propose combining self-validation and training to apply ES. ", "page_idx": 2}, {"type": "text", "text": "The input to the standard DIP (or Vanilla DIP) network is a random noise vector that, in most works, remains fixed during the optimization. Nevertheless, other works, such as those in [29] and [30], have explored cases where the input contains some structure of the ground truth. The approach employed in reference-guided DIP (Ref-Guided DIP) [29] follows the same objective as standard DIP in (1). However, instead of using a fixed random noise vector as input, it utilizes a reference image closely resembling the one undergoing reconstruction. This method was applied to the task of MRI. This methodology proves particularly effective when datasets comprising structurally similar data points are available. The reference required here makes this method a data-dependent approach. ", "page_idx": 2}, {"type": "text", "text": "Inspired by the departure from using a random fixed input, the authors in [20] recently introduced Self-Guided DIP. Unlike Ref-Guided DIP [29], a prior image that closely resembles the unknown (to be estimated) image is not needed, and the optimization occurs simultaneously with respect to both the input and the parameters of the network. Specifically, Self-Guided DIP employs the following objective: ", "page_idx": 2}, {"type": "equation", "text": "$$\n\\hat{\\theta},\\hat{\\mathbf{z}}=\\mathop{\\mathrm{argmin}}_{\\theta,\\mathbf{z}}\\left\\|\\mathbf{A}\\mathbb{E}_{\\eta}[f_{\\theta}(\\mathbf{z}+\\eta)]-\\mathbf{y}\\right\\|_{2}^{2}+\\alpha\\|\\mathbb{E}_{\\eta}[f_{\\theta}(\\mathbf{z}+\\eta)]-\\mathbf{z}\\|_{2}^{2}\\,,\n$$", "text_format": "latex", "page_idx": 2}, {"type": "text", "text": "where $\\eta$ is random noise, and $\\alpha$ is a regularization parameter. The first (resp. second) term is used for data consistency (resp. denoising regularization) and final reconstruction is obtained as $\\hat{\\mathbf{x}}=\\mathbb{E}_{\\eta}[f_{\\hat{\\theta}}(\\hat{\\mathbf{z}}+\\pmb{\\eta})]$ . aSeqDIP is different from Self-Guided DIP as our method does not require gradient-based updates for the input, making it computationally less expensive. Self-Guided DIP has demonstrated superior performance compared to Vanilla DIP, TV-DIP, and SGLD-DIP, thus serving as a primary baseline for comparison. ", "page_idx": 2}, {"type": "text", "text": "DM-based Methods: In recent years, there has been an abundance of DM-based methods proposed to address inverse imaging problems [14, 15, 16, 31, 32, 33]. A well-known method for natural images is Diffusion Posterior sampling (DPS) [16]. DPS incorporates a gradient step into the reverse sampling process of pre-trained DMs, ensuring data consistency and enabling sampling from the conditional distribution. In the context of image reconstruction and restoration tasks, numerous diffusion-based approaches have emerged, as evidenced by works such as [34, 35, 36]. Notably, the authors in [14] and [15] introduced a SOTA DM-based approach for addressing the MRI and CT reconstruction inverse problems, respectively. They propose incorporating the predictor-corrector sampling algorithm [37] for data consistency, akin to DPS, thereby facilitating the sampling from a conditional distribution. ", "page_idx": 2}, {"type": "text", "text": "One clear distinction between aSeqDIP and DM-based methods is that our approach does not necessitate pre-trained models. For our experiments in MRI, CT, and denoising (as well as in-painting and deblurring) tasks, we will utilize Score-MRI [14], Manifold Constrained Gradient (MCG) [15], and DPS [16], respectively, as DM-based baselines. ", "page_idx": 2}, {"type": "text", "text": "3 Autoencoding Sequential DIP ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "In this section, we begin by investigating the impact of the input on DIP. Then, we introduce our method, aSeqDIP. We note that while we consider linear and non-linear inverse problems, in our formulations, we use a linear forward model to simplify notation. ", "page_idx": 3}, {"type": "text", "text": "3.1 Motivation of aSeqDIP: The Impact of the Network Input in Vanilla DIP ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "Here, we aim to address the question: How does employing a noisy version of the ground truth image, which retains some structure of the ground truth, as the fixed input to the Vanilla DIP objective in (1), affect performance? To investigate, we conduct the following experiment. ", "page_idx": 3}, {"type": "text", "text": "Consider the MRI task defined as $\\mathbf{y}\\approx\\mathbf{A}\\mathbf{x}^{*}$ . Let the input to the standard DIP objective in (1) be denoted as $\\mathbf{z}=\\mathbf{x}^{*}+\\delta$ , where $\\delta\\sim\\mathcal{N}(\\mathbf{0},\\sigma^{2}\\mathbf{I})$ . Here, $\\sigma$ controls the magnitude of the perturbations added to the ground truth image, indicating that a larger $\\sigma$ results in a greater deviation between z and $\\mathbf{x}^{*}$ . We optimize (1) for various values of $\\sigma$ , recording the best possible PSNR compared to the ground truth, i.e., prior to the start of the noise overfitting decay. ", "page_idx": 3}, {"type": "text", "text": "Figure 1 displays the average results for 8 images. Notably, for all images, a closer similarity of the DIP network input to $\\mathbf{x}^{*}$ , as indicated by $\\sigma$ , corresponds to higher reconstruction quality, measured by PSNR. Larger variance in the standard Gaussian distribution corresponds to larger additive perturbations even for the case of $\\mathbf{x}^{*}=\\mathbf{0}$ (the red curve). We conjecture that this still leads to larger distances from the ground truth and hence worse performance. ", "page_idx": 3}, {"type": "text", "text": "Based on this discussion, a notable insight emerges: ", "page_idx": 3}, {"type": "text", "text": "The proximity of the DIP network input to the ground truth correlates with the quality of the reconstruction. This promotes the question: Can we develop an input-adaptive DIP method that mitigates noise overfitting? ", "page_idx": 3}, {"type": "text", "text": "We proceed to address this question by proposing our method, which we refer to as Autoencoding Sequential DIP (aSeqDIP). In Appendix A, we provide a case study and theory on the impact of the DIP network input through the lens of the Neural Tangent Kernel in residual networks. The onset of severe noise overfitting therein is delayed for better inputs (Appendix A.2). ", "page_idx": 3}, {"type": "image", "img_path": "K1EG2ABzNE/tmp/960c6b333da044b14cf8b8c61d34f80f9a0a4924c648ae7a5e06f23c99d61dd2.jpg", "img_caption": ["Figure 1: Average best possible PSNR values (in dB) obtained from standard DIP in (1) for 8 MRI (with $4\\mathbf{x}$ acceleration factor) scans (y-axis), where the network input $\\mathbf{z}$ is either a perturbed version of the ground truth or pure noise. The noise is a zero-mean additive Gaussian noise with strength determined by $\\sigma$ ( $\\bf\\delta X$ -axis). "], "img_footnote": [], "page_idx": 3}, {"type": "text", "text": "3.2 The Proposed aSeqDIP Algorithm ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "Consider that we have a U-Net architecture defined by $f:\\mathbb{R}^{n}\\rightarrow\\mathbb{R}^{n}$ whose weights are given by $\\phi_{k}$ , where $k\\in[K]$ , and $[K]:=\\{1,\\ldots,K\\}$ . Each set of parameters in $f_{\\phi_{k}}$ takes an input $\\mathbf{z}_{k}$ and outputs $f_{\\phi_{k}}({\\bf z}_{k})$ . Based on the insight from the previous subsection, we initially set $\\mathbf{z}_{\\mathrm{0}}$ to y (resp. $\\mathbf A^{H}\\mathbf y)$ for denoising, in-painting, and deblurring (resp. MRI and CT). The initialization of $\\phi_{1}$ follows the same initialization as any other DIP-based method. The parameters in $f_{\\phi_{k}}$ , and the input, $\\mathbf{z}_{k}$ , are then updated sequentially through ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\phi_{k}\\leftarrow\\operatorname*{argmin}_{\\phi_{k}}\\|\\mathbf{A}f_{\\phi_{k}}(\\mathbf{z}_{k-1})-\\mathbf{y}\\|_{2}^{2}+\\lambda\\|f_{\\phi_{k}}(\\mathbf{z}_{k-1})-\\mathbf{z}_{k-1}\\|_{2}^{2}\\,,\n$$", "text_format": "latex", "page_idx": 3}, {"type": "equation", "text": "$$\n\\mathbf{z}_{k}\\leftarrow f_{\\phi_{k}}(\\mathbf{z}_{k-1})\\;,\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "where $\\lambda\\in\\mathbb{R}_{+}$ is a regularization parameter, and the initialization of $\\phi_{k}$ is the optimized $\\phi_{k-1}$ in (3). The final reconstruction is given as: ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\hat{{\\bf x}}={\\bf z}_{K}=f_{\\phi_{K}}({\\bf z}_{K-1})\\;.\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "The proposed procedure outlined in (3) and (4) consists of two key components. First, the optimization of each set of weights in $f_{\\phi_{k}}$ using an objective that consists of the data consistency term and the ", "page_idx": 3}, {"type": "text", "text": "Algorithm 1 Autoencoding Sequential Deep Image Prior (aSeqDIP) ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "Input: Measurements $\\mathbf{y}$ , forward operator $\\mathbf{A}$ , number of input updates $K$ , number of gradient updates $N$ per input update, regularization parameter $\\lambda$ , and learning rate $\\beta$ .   \nOutput: Reconstructed image $\\hat{\\bf x}$ . ", "page_idx": 4}, {"type": "text", "text": "Initialization: $\\mathbf{z}_{0}=\\mathbf{A}^{H}\\mathbf{y};\\boldsymbol{\\phi}_{0}\\sim\\mathcal{N}(\\mathbf{0},\\mathbf{I})$ .   \n1: For each $k\\in[K]$   \n2: Initialize $\\phi_{k}^{(0)}\\leftarrow\\phi_{k-1}^{(N)}$ for $k\\in\\{2,\\ldots,K\\}$ , and $\\phi_{k}^{(0)}\\leftarrow\\phi^{(0)}$ for $k=1$ .   \n3: For each $i\\in[N]$ . (Network parameters update)   \n4: $\\begin{array}{r}{\\phi_{k}^{(i)}=\\phi_{k}^{(i-1)}-\\beta\\nabla_{\\phi_{k}}\\Big[\\|\\mathbf{A}f_{\\phi_{k}}(\\mathbf{z}_{k-1})-\\mathbf{y}\\|_{2}^{2}+\\lambda\\|f_{\\phi_{k}}(\\mathbf{z}_{k-1})-\\mathbf{z}_{k-1}\\|_{2}^{2}\\Big]\\Big|_{\\phi_{k}=\\phi_{k}^{(i-1)}}.}\\end{array}$   \n5: Obtain $\\mathbf{z}_{k}:=f_{\\phi_{k}^{(N)}}\\big(\\mathbf{z}_{k-1}\\big)$ . (Network input update)   \n6: Reconstructed image: $\\hat{\\bf x}={\\bf z}_{K}=f_{\\phi_{K}^{(N)}}({\\bf z}_{K-1})$ ", "page_idx": 4}, {"type": "image", "img_path": "K1EG2ABzNE/tmp/4ec7e4c177187c99c670db8846015c588b37ebc247293a48870cb8339c978836.jpg", "img_caption": ["Figure 2: Illustrative block diagram of the proposed aSeqDIP procedure. Each trapezoid corresponds to the updates of $f_{\\phi_{k}}$ that takes $\\mathbf{z}_{k-1}$ as input and is initialized with the optimized parameters $\\phi_{k-1}$ for $k\\in\\{2,\\ldots,K\\}$ or randomly for $k=1$ . The optimization for each set of weights takes place based on (3) and is run for $N$ steps. The final reconstruction is $f_{\\phi_{K}}\\left({\\bf z}_{K-1}\\right)$ . "], "img_footnote": [], "page_idx": 4}, {"type": "text", "text": "second autoencoding term that aims to alleviate noise overftiting. Second, the update of the input, $\\mathbf{z}_{k}$ , after optimizing each set of weights $f_{\\phi_{k}}$ , so that our method is input-adaptive. ", "page_idx": 4}, {"type": "text", "text": "Algorithm 1 presents the procedure of our proposed approach. As inputs, the algorithm takes $\\mathbf{y}$ , A, $K$ , $N,\\lambda$ , and the learning rate $\\beta$ . Apart from the measurements and the forward operator, the remaining parameters are considered hyper-parameters, typical in most DIP-based methods. The parameters in $f_{\\phi_{k}}$ are set to $\\phi_{k-1}$ (step 2) and subsequently optimized for $N$ iterations using a gradient-based optimizer, such as gradient descent (as depicted in Algorithm 1) or Adam [38]. A block diagram of our proposed aSeqDIP method is presented in Figure 2. ", "page_idx": 4}, {"type": "text", "text": "In the following remarks, we provide insights into our proposed aSeqDIP method. ", "page_idx": 4}, {"type": "text", "text": "Remark 3.1 (Differences from Vanilla DIP [18]). Assume that the iterates of (3) and (4) converge, i.e., as $k\\rightarrow\\infty$ , $\\mathbf{z}_{k}\\to\\mathbf{z}^{*}$ and $\\phi_{k}\\to\\phi^{*}$ . Then, according to (4), for a continuous mapping $f$ , we have $\\mathbf{z}^{\\ast}\\,=\\,f_{\\phi^{\\ast}}(\\mathbf{z}^{\\ast})$ . Substituting this into (3) in the limit, we get $\\phi^{*}\\,=\\,\\{\\mathrm{argmin}_{\\phi}\\,\\|{\\bf A}f_{\\phi}({\\bf z}^{*})\\mathrm{~-~}$ $\\mathbf{y}\\|_{2}^{2}\\;:\\;f_{\\phi}(\\mathbf{z}^{*})=\\mathbf{z}^{*}\\}$ , which corresponds to the minimizer of ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\operatorname*{min}_{\\phi}\\|\\mathbf{A}f_{\\phi}(\\mathbf{z})-\\mathbf{y}\\|_{2}^{2}\\quad s.t.\\quad\\mathbf{z}=f_{\\phi}(\\mathbf{z}).\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "The limit points of aSeqDIP correspond to the solution of a constrained version of the Vanilla DIP objective in (1). The constraint enforces additional prior that could alleviate overfitting. While its not straightforward to use a gradient-based algorithm for (6) given the hard constraint, the aSeqDIP scheme\u2019s limit points nevertheless minimize (6). Furthermore, aSeqDIP automatically estimates the network input by a sequential feed forward process without needing expensive updates. The main point is to show that aSeqDIP is solving the optimization problem in (6), which is different than Vanilla DIP in (1). ", "page_idx": 4}, {"type": "text", "text": "Remark 3.2 (Differences from Self-Guided DIP [20]). While both aSeqDIP and Self-Guided DIP [20] update the input and network parameters simultaneously, there exist fundamental differences. Firstly, Self-Guided DIP solves the optimization problem in (2) which does not strictly enforce the auto-encoder constraint ${\\bf z}=f_{\\phi}({\\bf z})$ as in (6). Secondly, aSeqDIP only requires a network forward pass to update $\\mathbf{z}$ , resulting in significantly fewer computations as will further be demonstrated in our experimental results. Thirdly, the second term in the aSeqDIP objective does not require computing the expectation, as it is an auto-encoder rather than a denoiser that results in higher resistance to noise overftiting. Lastly, our method does not require initializing z randomly and generating random vectors $\\l_{\\eta}$ in (2)). The selection of $\\eta$ introduces an additional hyper-parameter that we avoid, focusing solely on selecting $N K$ (total number of iterations) and $\\lambda$ (regularization strength), which are necessary in most DIP-based methods. ", "page_idx": 4}, {"type": "image", "img_path": "K1EG2ABzNE/tmp/4c2ee93af9d8a94d633246b0b5e07ded4663170e56baa3c97d40d1fc1e1125be.jpg", "img_caption": ["Figure 3: An overview of differences between aSeqDIP and prior arts in terms of data dependency, network architecture(s), and procedural requisites. \u2018Data-Dependency\u2019 here indicates whether a method depend on a prior reference image or pre-trained models. "], "img_footnote": [], "page_idx": 5}, {"type": "text", "text": "", "page_idx": 5}, {"type": "text", "text": "Remark 3.3 (Computational Requirements). The computational requirements of aSeqDIP are determined by two factors: $(i)$ the $N K$ gradient-based parameter updates, and $(i i)$ the number of function evaluations necessary for updating ${\\bf z}$ , which is $K$ . In our experiments, we have found that setting $N=2$ and $K=2000$ is generally sufficient. This configuration makes aSeqDIP nearly as efficient as Vanilla DIP. ", "page_idx": 5}, {"type": "text", "text": "Remark 3.4 (Relationship to DMs). aSeqDIP bears resemblance to the reverse process in DMs due to their shared gradual denoising steps. However, despite these similarities, several distinctions emerge. Firstly, unlike the DM network, aSeqDIP does not require encoding a scalar representing time $t$ . Secondly, and perhaps most significantly, aSeqDIP operates without requiring any training data or pre-trained networks. Thirdly, aSeqDIP operates in a truly sequential manner in terms of time, whereas in DMs, whether it\u2019s training (e.g., denoising score matching [39]) or sampling, the prevalent technique involves sampling from time $t\\sim\\mathcal{U}[0,1]$ (uniform distribution), which allows for non-sequential time points. ", "page_idx": 5}, {"type": "text", "text": "Figure 3 illustrates how different approaches compare to aSeqDIP. ", "page_idx": 5}, {"type": "text", "text": "3.2.1 Mitigating Noise Overfitting in aSeqDIP ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "In DIP-based approaches, noise overftiting occurs as the network attempts to fti its output to the noisy or subsampled measurements, $\\mathbf{y}$ , as $k$ increases during training. However, the specific value of $k$ at which this PSNR decay begins is uncertain and varies across tasks and even among images within the same task and distribution. In aSeqDIP, when the output of network $f_{\\phi_{k}}$ improves compared to that of $f_{\\phi_{k-1}}$ , the autoencoder term enforces similarity between the input and output of the network, thus delaying the onset of noise overfitting decay. This occurs because we are not only enforcing the network output to be measurement-consistent, but also enforcing that the output and input become similar. Consequently, as $k$ increases, noise ftiting is delayed, and utilizing the autoencoder provides regularization against noise overftiting. In Section 4, we will demonstrate how the proposed autoencoding term effectively regulates noise overfitting. ", "page_idx": 5}, {"type": "text", "text": "One might expect that incorporating the autoencoder could negatively impact reconstruction quality. However, empirical observations reveal that not only is noise overftiting delayed with the autoencoder term, but also image reconstruction quality is enhanced. To further support this statement, in Appendix B, we investigate whether a trained autoencoder on clean images can act as a reconstructor at testing time by optimizing the input. ", "page_idx": 5}, {"type": "table", "img_path": "K1EG2ABzNE/tmp/d84d7c9414f5e1620c163f2571cec8e7384b272c45c2a7d8be6f3e388615d7f8.jpg", "table_caption": [], "table_footnote": ["Table 1: Tasks, settings, and baselines considered in our experiments. For MRI, we consider two Acceleration (Ax) factors, $_{4\\mathrm{x}}$ and $\\mathrm{8x}$ , that determine the subsampling of the measurements. For 2D CT (parallel beam geometry), we use two sparse view settings: 18 and 30 views. For denoising, we perturb the ground truth images using two noise levels determined by $\\sigma_{\\mathrm{d}}$ . In in-painting, we use two hole-to-image area ratios (HIAR), 0.1 and 0.25. For non-linear deblurring, we use the Blurring Kernel Space Exploring (BKSE) setting [3], described in Equations (56) to (59) of [16]. Each baseline that utilizes pre-trained models or a reference image is considered data-dependent. Further details are provided in Appendix C.6. "], "page_idx": 6}, {"type": "text", "text": "4 Experimental Results ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "4.1 Settings, Datasets, and Baselines ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "In our experiments, we consider five tasks: MRI reconstruction from undersampled measurements, sparse-view CT image reconstruction, denoising, non-linear deblurring and in-painting. For MRI, we use the fastMRI dataset3. The forward model is $\\mathbf{y}\\,\\approx\\,\\mathbf{A}\\mathbf{x}^{*}$ . The multi-coil data is obtained using 15 coils and is cropped to a resolution of $320\\times320$ pixels. To simulate undersampling of the MRI $\\mathbf{k}$ -space, we use a Cartesian mask with $4\\mathbf{x}$ and $8\\mathbf{x}$ accelerations. Sensitivity maps for the coils are obtained using the BART toolbox [40]. For CT, we use the AAPM dataset4. For parallel beam CT, the input image with $512\\times512$ pixels is transformed into its sinogram representation using a Radon transform (the operator A). The forward model assuming a monoenergetic source and no scatter, noise is $y_{i}=I_{0}\\bar{e}^{-[\\mathbf{Ax}^{*}]_{i}}$ , with $I_{0}$ denoting the number of incident photons per ray (assumed to be 1 for simplicity) and $i$ indexing the ith measurement or detector pixel. We use the post-log measurements for reconstruction. We use a full set of 180 projection angles and simulate two different sparse view acquisition scenarios (with equispaced angles). Specifically, we created cases with 18 and 30 angles/views. The image resolution is kept at a fixed size. ", "page_idx": 6}, {"type": "text", "text": "For the tasks of denoising, in-painting, and non-linear deblurring, we use the CBSD68 dataset5. For each task, we use 20 measurements/corrupted images. To evaluate the reconstruction quality, we use the Peak Signal to Noise Ratio (PSNR), and the Structural SIMilarity (SSIM) index [41]. For experimental settings and baselines, see Table 1 and its caption. Note that we consider datadependent and data-independent baselines as shown in the third and fourth columns of Table 1. All the experiments are conducted on a single RTX5000 GPU machine. Further implementation details are provided in Appendix C.6. ", "page_idx": 6}, {"type": "text", "text": "For the proposed aSeqDIP method in Algorithm 1, we use the Adam optimizer with learning rate of $\\beta=0.{\\bar{0001}}$ . Furthermore, the regularization parameter is set to $\\lambda=1$ following the ablation study in Appendix C.4. We select $N=2$ and $K=2000$ following the ablation study in Appendix C.5. ", "page_idx": 6}, {"type": "text", "text": "4.2 Impact of the Autoencoding term on Noise Overfitting ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "In this subsection, we showcase the impact of the proposed autoencoding regularization in aSeqDIP on noise or null space (nuisance) overfitting. ", "page_idx": 6}, {"type": "text", "text": "We conducted experiments using $20\\,\\mathrm{MRI}$ scans and $20\\,\\mathrm{CT}$ scans, considering two cases of aSeqDIP as outlined in Algorithm 1. The first case sets $\\lambda=1$ , consistent with the remainder of the paper, while the second case sets $\\lambda=0$ , effectively disabling the autoencoding regularization term in (3). Additionally, for comparison, we report results for Vanilla DIP and Self-Guided DIP. The average PSNR results for these cases are depicted in Figure 4. ", "page_idx": 6}, {"type": "image", "img_path": "K1EG2ABzNE/tmp/c7bd8acac9970b1eff62ebb448864374615ac22b89263836f617552155e3e84c.jpg", "img_caption": ["Figure 4: Average PSNR results w.r.t. iteration $i$ of $20\\,\\mathrm{MRI}$ (with 4x) scans (left) and $20\\,\\mathrm{CT}$ (with 18 views) scans (right) to show the impact of the proposed autoencoding regularization term on noise overftiting in aSeqDIP. Furthermore, average results of Vanilla DIP and Self-Guided DIP are also reported for comparison. For aSeqDIP, iteration $i\\in[N K]$ , where $N=2$ . Vertical lines approximately indicate the start of the PSNR decay for every case. In Appendix C.1, we include the PSNR curves of aSeqDIP and other DIP-based methods for the task of denoising. "], "img_footnote": [], "page_idx": 7}, {"type": "text", "text": "", "page_idx": 7}, {"type": "text", "text": "As observed, when the autoencoder term is disabled in aSeqDIP (blue dashed lines), noise overftiting in MRI, akin to Self-Guided DIP, begins after nearly 1600 iterations. For CT, we note that aSeqDIP without regularization starts noise overfitting at around iteration 3800, whereas Self-Guided DIP experiences PSNR decay earlier, after approximately 1250 iterations. Importantly, when the autoencoding term is utilized (blue solid lines), not only does the decay in noise overftiting not commence until after iteration 4000, but the reconstruction quality (measured by PSNR) also improves. ", "page_idx": 7}, {"type": "text", "text": "As expected, PSNR decay in Vanilla DIP begins early, at around iteration 500 and 750 for MRI and CT, respectively. In Appendix C.4, we provide an ablation study to better show the impact of the value of $\\lambda$ in aSeqDIP. ", "page_idx": 7}, {"type": "text", "text": "4.3 Main Results ", "text_level": 1, "page_idx": 7}, {"type": "text", "text": "Here, we present our primary results regarding the reconstruction quality, measured by PSNR and SSIM, as well as the associated run-time. Table 2 presents the results for the considered tasks in this paper. Column 3 indicates whether the baselines depend on prior data or pre-trained models. The last three columns provide the PSNR, SSIM, and run-time results where the arrows indicate favorable results. For PSNR and SSIM, the settings correspond to the second column of Table 1. The black (resp. blue) text corresponds to the first (resp. second) setting. Values after the $\\pm$ sign indicate standard deviation. Subsequently, we offer observations on the main results. ", "page_idx": 7}, {"type": "text", "text": "Compared to data-independent methods, i.e., the baselines that do not depend on a reference image or pre-trained models, aSeqDIP demonstrates improved PSNR and SSIM scores. For example, aSeqDIP, apart from Self-Guided DIP, shows nearly a 1dB improvement for MRI 8X acceleration compared to conventional methods. For the task of 30-views CT, aSeqDIP reports SSIM score of 0.92 which is $5\\%$ more than the second best, which is Self-Guided DIP with SSIM of 0.872. Although improvements against Self-Guided DIP are generally marginal in terms of reconstruction quality, our method proves to be 2X faster for MRI and CT reconstruction and requires 1 minute less than Self-Guided DIP for denoising and in-painting. This speed-up is attributed to updating the input using one forward pass of the trained network at each iteration $k$ , instead of computing gradients with respect to the input for the update. Compared to Vanilla DIP, our method, on average, only requires an additional 30 to 60 seconds. When compared to ES-DIP [27], our method requires longer time, but on average achieves better reconstruction results across three tasks and different settings. ", "page_idx": 7}, {"type": "text", "text": "In comparison to data-dependent methods such as Score-MRI and MCG, our approach not only yields the best PSNR and SSIM but also requires reduced run-time, all without requiring any training data or pre-trained models. For instance, on average, aSeqDIP achieves nearly a 2dB improvement in 30-views CT compared to MCG while being 2X faster. In comparison to DPS, on average, our method report higher SSIM. Our method requires slightly less run-time on average but enhances the PSNR by approximately 0.6dB for both denoising and in-painting. Notably, our method is an optimization-based approach, whereas DM-based methods only require function evaluations. However, the generally larger run-time reported for DM-based methods is due to the necessity of running a large number of reverse sampling steps. When compared to Ref-Guided DIP, our method achieves higher PSNR and SSIM results without the need for any prior (or reference image) image. ", "page_idx": 7}, {"type": "table", "img_path": "K1EG2ABzNE/tmp/acb7b01d8cfb713fe3ac3ce7b61564a0e8b2778cadb99babc8284ce00f0b5d2f.jpg", "table_caption": [], "table_footnote": ["Table 2: Average PSNR, SSIM, and run-time results reported by our method against the selected baselines for the tasks of MRI reconstruction, CT reconstruction, image denoising, in-painting, and non-linear deblurring. \u2018Data-Independency\u2019 in column 3 indicates whether the methods depend on prior data or pre-trained models. Setting 1 and Setting 2, in the fourth and fifth columns correspond to the scenarios in the second column of Table 1. For tasks with two settings, the run-time results are averaged over the two settings. Values past $\\pm$ represent the standard deviation. See Appendix C.2 and Appendix C.3 for more comparison results. "], "page_idx": 8}, {"type": "text", "text": "", "page_idx": 8}, {"type": "text", "text": "4.4 Visualizations ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "Figure 5 shows reconstructed images for the five considered tasks using aSeqDIP and the other baselines. Each row corresponds to a task. The first column displays the ground truth (GT) image whereas the second column shows the degraded image. Column 3 to the column before last present the reconstructed images by the baselines, while the last column shows the reconstructed images by aSeqDIP. PSNR values are provided at the bottom of each reconstructed image. ", "page_idx": 8}, {"type": "text", "text": "As observed, aSeqDIP achieves the highest PSNR scores. Additionally, the top right green boxes, which show the difference between the central region of the reconstructed and GT images, indicate that for MRI and CT, our method visually exhibits the least difference, making it the closest to the GT. ", "page_idx": 8}, {"type": "text", "text": "A similar observation is seen for the denoising task for the zoomed in bottom box. For inpainting, we note that aSeqDIP introduces the fewest unwanted artifacts as observed in the clouds (for DPS), and the left wing of the plane. While aSeqDIP contains artifacts for the task of Deblurring when compared to DPS, the latter generates a perceptually different image when compared to the GT. Similar observation are noticed with the additional visualizations provided in Appendix C.7. ", "page_idx": 8}, {"type": "image", "img_path": "K1EG2ABzNE/tmp/9dd867e884d63e18e76047dd322fdc4e825c3064cf281ef039199c20b4dc2029.jpg", "img_caption": ["Figure 5: Reconstructed/recovered images using our proposed approach, aSeqDIP, and the baselines for the considered tasks. The ground truth (GT) and degraded images are shown in the first and second columns, respectively, followed by three or four baselines per task. The last column presents our method. PSNR results are given at the bottom of each reconstructed image. For MRI (8x undersampling) and CT (18 views), the top right box shows the absolute difference between the center region box of the reconstructed image and the same region in the GT image. Denoising and in-painting used $\\sigma_{d}=25$ and $\\mathrm{HIAR}=0.25$ . For the task of Deblurring, aSeqDIP contains artifacts when compared to DPS. However, DPS generates a perceptually different image when compared to the GT. For all other tasks, aSeqDIP reconstructions contain sharper and clearer image features than other methods. "], "img_footnote": [], "page_idx": 9}, {"type": "text", "text": "5 Conclusions & Future Work ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "In this paper, we introduced Autoencoding Sequential Deep Image Prior (aSeqDIP), a new unsupervised image recovery algorithm. Notably, aSeqDIP operates without the need of pre-trained models, relying solely on a sequential update of network parameters. These parameters are optimized using an input-adaptive data consistency objective combined with autoencoding regularization, effectively mitigating noise overfitting. Our experimental results across various tasks highlight the competitive performance of the proposed algorithm, matching (or outperforming) diffusion-based methods in terms of reconstruction quality and required run time, all without the need for pre-trained models. ", "page_idx": 9}, {"type": "text", "text": "For future directions, we aim to explore the applicability of aSeqDIP to other image recovery problems, thereby expanding its versatility and potential impact across diverse domains. Additionally, we are interested in investigating the integration of a network input update mechanism to dynamically adjust the autoencoding regularization parameter and the number of gradient updates per iteration. ", "page_idx": 9}, {"type": "text", "text": "Acknowledgments ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "This work was supported by the National Science Foundation (NSF) grants CCF-2212065, CCF2212066, and BCS-2215155. The authors would like to thank Xiang Li (University of Michigan), Avrajit Ghosh (Michigan State University), Huijie Zhang (University of Michigan), and Siddhant Gautam (Michigan State University) for insightful discussions. ", "page_idx": 9}, {"type": "text", "text": "References ", "text_level": 1, "page_idx": 10}, {"type": "text", "text": "[1] Michael T McCann, Kyong Hwan Jin, and Michael Unser. Convolutional neural networks for inverse problems in imaging: A review. IEEE Signal Processing Magazine, 34(6):85\u201395, 2017.   \n[2] B. Goyal, A. Dogra, S. Agrawal, B.S. Sohi, and A. Sharma. Image denoising review: From classical to state-of-the-art approaches. Information Fusion, 55:220\u2013244, 2020.   \n[3] Phong Tran, Anh Tuan Tran, Quynh Phung, and Minh Hoai. Explore image deblurring via encoded blur kernel space. In Proceedings of the IEEE/CVF conference on computer vision and pattern recognition, pages 11956\u201311965, 2021.   \n[4] O. Elharrouss, N. Almaadeed, S. Al-Maadeed, and Y. Akbari. Image inpainting: A review. Neural Processing Letters, 51:2007\u20132028, 2020.   \n[5] Christian Ledig, Lucas Theis, Ferenc Husz\u00e1r, Jose Caballero, Andrew Cunningham, Alejandro Acosta, Andrew Aitken, Alykhan Tejani, Johannes Totz, Zehan Wang, et al. Photo-realistic single image super-resolution using a generative adversarial network. In Proceedings of the IEEE conference on computer vision and pattern recognition, pages 4681\u20134690, 2017.   \n[6] J. A. Fessler. Model-Based Image Reconstruction for MRI. IEEE Signal Processing Magazine, 27(4):81\u201389, 2010.   \n[7] I. A. Elbakri and J. A. Fessler. Statistical image reconstruction for polyenergetic X-ray computed tomography. IEEE Transactions on Medical Imaging, 21(2):89\u201399, 2002.   \n[8] Lujun Zhai, Yonghui Wang, Suxia Cui, and Yu Zhou. A comprehensive review of deep learning-based real-world image restoration. IEEE Access, 11:21049\u201321067, 2023.   \n[9] Hanene Ben Yedder, Ben Cardoen, and Ghassan Hamarneh. Deep learning for biomedical image reconstruction: A survey. Artificial intelligence review, 54(1):215\u2013251, 2021.   \n[10] Shijun Liang, Anish Lahiri, and Saiprasad Ravishankar. Adaptive local neighborhood-based neural networks for mr image reconstruction from undersampled data. IEEE Transactions on Computational Imaging, 2024.   \n[11] Ling Chen, Zhishen Huang, Yong Long, and Saiprasad Ravishankar. Enhancing low-dose ct image reconstruction by integrating supervised and unsupervised learning. arXiv preprint arXiv:2311.12071, 2023.   \n[12] Bihan Wen, Saiprasad Ravishankar, Zhizhen Zhao, Raja Giryes, and Jong Chul Ye. Physicsdriven machine learning for computational imaging: Part 2 [from the guest editors]. IEEE Signal Processing Magazine, 40(2):13\u201315, 2023.   \n[13] Jonathan Ho, Ajay Jain, and Pieter Abbeel. Denoising diffusion probabilistic models. Advances in neural information processing systems, 33:6840\u20136851, 2020.   \n[14] Hyungjin Chung and Jong Chul Ye. Score-based diffusion models for accelerated mri. Medical image analysis, 80:102479, 2022.   \n[15] Hyungjin Chung, Byeongsu Sim, Dohoon Ryu, and Jong Chul Ye. Improving diffusion models for inverse problems using manifold constraints. Advances in Neural Information Processing Systems, 35:25683\u201325696, 2022.   \n[16] Hyungjin Chung, Jeongsol Kim, Michael Thompson Mccann, Marc Louis Klasky, and Jong Chul Ye. Diffusion posterior sampling for general noisy inverse problems. In The Eleventh International Conference on Learning Representations, 2023.   \n[17] Huijie Zhang, Jinfan Zhou, Yifu Lu, Minzhe Guo, Peng Wang, Liyue Shen, and Qing Qu. The emergence of reproducibility and consistency in diffusion models. In Forty-first International Conference on Machine Learning, 2024.   \n[18] Dmitry Ulyanov, Andrea Vedaldi, and Victor Lempitsky. Deep image prior. In Proceedings of the IEEE conference on computer vision and pattern recognition, pages 9446\u20139454, 2018.   \n[19] Olaf Ronneberger, Philipp Fischer, and Thomas Brox. U-net: Convolutional networks for biomedical image segmentation. In Medical image computing and computer-assisted intervention\u2013MICCAI 2015: 18th international conference, Munich, Germany, October 5-9, 2015, proceedings, part III 18, pages 234\u2013241. Springer, 2015.   \n[20] Shijun Liang, Evan Bell, Qing Qu, Rongrong Wang, and Saiprasad Ravishankar. Analysis of deep image prior and exploiting self-guidance for image reconstruction. arXiv preprint arXiv:2402.04097, 2024.   \n[21] Ismail R Alkhouri, George K Atia, and Alvaro Velasquez. A differentiable approach to the maximum independent set problem using dataless neural networks. Neural Networks, 155:168\u2013 176, 2022.   \n[22] HH Barrett. The radon transform and its applications. PROGRESS IN OPTICS, 31:217\u2013217, 1993.   \n[23] Avrajit Ghosh, Xitong Zhang, Kenneth K Sun, Qing Qu, Saiprasad Ravishankar, and Rongrong Wang. Optimal eye surgeon: Finding image priors through sparse generators at initialization. In Forty-first International Conference on Machine Learning, 2024.   \n[24] Jiaming Liu, Yu Sun, Xiaojian Xu, and Ulugbek S Kamilov. Image restoration using total variation regularized deep image prior. In ICASSP 2019-2019 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP), pages 7715\u20137719. Ieee, 2019.   \n[25] Zezhou Cheng, Matheus Gadelha, Subhransu Maji, and Daniel Sheldon. A bayesian perspective on the deep image prior. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 5443\u20135451, 2019.   \n[26] Max Welling and Yee W Teh. Bayesian learning via stochastic gradient langevin dynamics. In Proceedings of the 28th international conference on machine learning (ICML-11), pages 681\u2013688. Citeseer, 2011.   \n[27] Hengkang Wang, Taihui Li, Zhong Zhuang, Tiancong Chen, Hengyue Liang, and Ju Sun. Early stopping for deep image prior. Transactions on Machine Learning Research, 2023.   \n[28] Taihui Li, Zhong Zhuang, Hengyue Liang, Le Peng, Hengkang Wang, and Ju Sun. Selfvalidation: Early stopping for single-instance deep generative priors. In Proceedings of the British Machine Vision Conference (BMVC), 2021., 2021.   \n[29] Di Zhao, Feng Zhao, and Yongjin Gan. Reference-driven compressed sensing mr image reconstruction using deep convolutional neural networks without pre-training. Sensors, 20(1):308, 2020.   \n[30] Juli\u00e1n Tachella, Junqi Tang, and Mike Davies. The neural tangent link between cnn denoisers and non-local filters. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 8618\u20138627, 2021.   \n[31] Xiang Li, Soo Min Kwon, Ismail R Alkhouri, Saiprasad Ravishankar, and Qing Qu. Decoupled data consistency with diffusion purification for image restoration. arXiv preprint arXiv:2403.06054, 2024.   \n[32] Bowen Song, Soo Min Kwon, Zecheng Zhang, Xinyu Hu, Qing Qu, and Liyue Shen. Solving inverse problems with latent diffusion models via hard data consistency. In The Twelfth International Conference on Learning Representations, 2024.   \n[33] Giannis Daras, Hyungjin Chung, Chieh-Hsin Lai, Yuki Mitsufuji, Peyman Milanfar, Alexandros G. Dimakis, Chul Ye, and Mauricio Delbracio. A survey on diffusion models for inverse problems. 2024.   \n[34] Y Xie and Q Li. Measurement-conditioned denoising diffusion probabilistic model for undersampled medical image reconstruction. In International Conference on Medical Image Computing and Computer-Assisted Intervention, pages 655\u2013664. Springer, 2022.   \n[35] A G\u00fcng\u00f6r, S U Dar, $\\mathrm{S}$ \u00d6zt\u00fcrk, Y Korkmaz, H A Bedel, G Elmas, M Ozbey, and T \u00c7ukur. Adaptive diffusion priors for accelerated MRI reconstruction. Medical Image Analysis, page 102872, 2023.   \n[36] C Peng, P Guo, S K Zhou, V M Patel, and R Chellappa. Towards performant and reliable undersampled MR reconstruction via diffusion model sampling. In International Conference on Medical Image Computing and Computer-Assisted Intervention, pages 623\u2013633. Springer, 2022.   \n[37] Yang Song, Jascha Sohl-Dickstein, Diederik P Kingma, Abhishek Kumar, Stefano Ermon, and Ben Poole. Score-based generative modeling through stochastic differential equations. In International Conference on Learning Representations, 2021.   \n[38] Diederik P. Kingma and Jimmy Ba. Adam: A method for stochastic optimization. arXiv preprint arXiv:1412.6980, 2014.   \n[39] Pascal Vincent. A connection between score matching and denoising autoencoders. Neural computation, 23(7):1661\u20131674, 2011.   \n[40] J. I. Tamir, F. Ong, J. Y. Cheng, M. Uecker, and M. Lustig. Generalized magnetic resonance image reconstruction using the berkeley advanced reconstruction toolbox. In ISMRM Workshop on Data Sampling & Image Reconstruction, Sedona, AZ, 2016.   \n[41] Zhou Wang, Alan C Bovik, Hamid R Sheikh, and Eero P Simoncelli. Image quality assessment: from error visibility to structural similarity. IEEE transactions on image processing, 13(4):600\u2013 612, 2004.   \n[42] Gengsheng L Zeng. Fast flitered backprojection algorithm for low-dose computed tomography. Journal of radiology and imaging, 4(7):45, 2020.   \n[43] Yeonsik Jo, Se Young Chun, and Jonghyun Choi. Rethinking deep image prior for denoising. In Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 5087\u20135096, 2021.   \n[44] A. Jacot, F. Gabriel, and C. Hongler. Neural tangent kernel: convergence and generalization in neural networks. In Proceedings of the 32nd Neurips, NIPS\u201918, page 8580\u20138589. Curran Associates Inc., 2018.   \n[45] Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun. Delving deep into rectifiers: Surpassing human-level performance on imagenet classification. In 2015 IEEE International Conference on Computer Vision (ICCV), pages 1026\u20131034, 2015.   \n[46] Sanjeev Arora, Simon S Du, Wei Hu, Zhiyuan Li, Russ R Salakhutdinov, and Ruosong Wang. On exact computation with an infinitely wide neural net. In H. Wallach, H. Larochelle, A. Beygelzimer, F. d'Alch\u00e9-Buc, E. Fox, and R. Garnett, editors, Advances in Neural Information Processing Systems, volume 32. Curran Associates, Inc., 2019.   \n[47] J. Zbontar, F. Knoll, A. Sriram, T. Murrell, Z. Huang, M. J. Muckley, A. Defazio, R. Stern, P. Johnson, M. Bruno, et al. fastMRI: An open dataset and benchmarks for accelerated MRI. arXiv preprint arXiv:1811.08839, 2018.   \n[48] Anuroop Sriram, Jure Zbontar, Tullie Murrell, Aaron Defazio, C Lawrence Zitnick, Nafissa Yakubova, Florian Knoll, and Patricia Johnson. End-to-end variational networks for accelerated mri reconstruction. In Medical Image Computing and Computer Assisted Intervention\u2013MICCAI 2020: 23rd International Conference, Lima, Peru, October 4\u20138, 2020, Proceedings, Part II 23, pages 64\u201373. Springer, 2020.   \n[49] Yinhuai Wang, Jiwen Yu, and Jian Zhang. Zero-shot image restoration using denoising diffusion null-space model. In The Eleventh International Conference on Learning Representations, 2023. ", "page_idx": 10}, {"type": "text", "text": "", "page_idx": 11}, {"type": "text", "text": "", "page_idx": 12}, {"type": "text", "text": "Appendix ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "In the Appendix, we first shed more light on the impact of the DIP network input by studying the training dynamics using the neural tangent kernel for CNNs with residual connections. Next, we show how trained autoencoders on clean images can be used as reconstructors at testing time. Lastly, we provide additional experimental results and visualizations. ", "page_idx": 13}, {"type": "text", "text": "A Case Study: Impact of the DIP Network Input through lens of Neural Tangent Kernel in Residual Networks ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "We show the impact of the DIP input through the lens of the Neural Tangent Kernel (NTK) [30, 44] for residual networks6. The NTK is a tool used to analyze the training dynamics of neural networks in the infinite width limit, where for CNNs the network width corresponds to the number of channels. In this limit, the change of any individual parameter during training becomes very small, which means that the change in the network\u2019s output during training can be accurately approximated by a first order Taylor expansion around its initialization. In the context of DIP, we consider training a neural network $f$ with parameters $\\theta$ and a fixed input $\\mathbf{z}$ using gradient descent. At each training iteration, the network parameters are updated according to: ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\boldsymbol{\\theta}^{(t+1)}=\\boldsymbol{\\theta}^{(t)}-\\beta\\nabla_{\\theta}\\mathcal{L}(f_{\\boldsymbol{\\theta}^{(t)}}(\\mathbf{z})),\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "where $\\mathcal{L}$ is the loss function, and $\\beta$ is the learning rate. We also consider the resulting change in the network\u2019s output due to this parameter update using the first order Taylor expansion: ", "page_idx": 13}, {"type": "equation", "text": "$$\nf_{\\theta^{(t+1)}}(\\mathbf{z})\\approx f_{\\theta^{(t)}}(\\mathbf{z})+\\nabla_{\\theta}f_{\\theta}(\\mathbf{z})\\big|_{\\theta=\\theta^{(t)}}(\\theta^{(t+1)}-\\theta^{(t)}).\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "Substituting (7) into (8) and applying the chain rule to write ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\nabla_{\\theta}\\mathcal{L}\\big(f_{\\theta^{(t)}}(\\mathbf{z})\\big)=\\big(\\nabla_{\\theta}f_{\\theta}(\\mathbf{z})\\big|_{\\theta=\\theta^{(t)}}\\big)^{T}\\big(\\nabla_{f_{\\theta^{(t)}}(\\mathbf{z})}\\mathcal{L}\\big(f_{\\theta^{(t)}}(\\mathbf{z})\\big)\\big)\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "yields the equation: ", "page_idx": 13}, {"type": "equation", "text": "$$\nf_{\\theta^{(t+1)}}(\\mathbf{z})\\approx f_{\\theta^{(t)}}(\\mathbf{z})-\\beta\\underbrace{(\\nabla_{\\theta}f_{\\theta}(\\mathbf{z}){\\big|}_{\\theta=\\theta^{(t)}})(\\nabla_{\\theta}f_{\\theta}(\\mathbf{z}){\\big|}_{\\theta=\\theta^{(t)}})^{T}}_{\\Theta^{(t)}}(\\nabla_{f_{\\theta^{(t)}}(\\mathbf{z})}\\mathcal{L}(f_{\\theta^{(t)}}(\\mathbf{z})))\\,.\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "In the infinite width limit, NTK theory states that the matrix $\\Theta^{(t)}\\qquad:=$ $\\big(\\nabla_{\\theta}f_{\\theta}\\big(\\mathbf{z}\\big)\\big|_{\\theta=\\theta^{(t)}}\\big)\\big(\\nabla_{\\theta}f_{\\theta}\\big(\\mathbf{z}\\big)\\big|_{\\theta=\\theta^{(t)}}\\big)^{T}$ stays fixed throughout training, so that $\\Theta^{(t)}~=~\\Theta^{(0)}$ for all $t$ . This matrix is called the neural tangent kernel, and we denote it as . Moreover, because the parameters $\\theta^{(0)}$ are initialized randomly, in the infinite width limit, the NTK $\\Theta$ becomes deterministic (as a function of ${\\bf z}$ ) due to the law of large numbers [30], and does not depend on the specific instantiation of $\\theta^{(0)}$ . In DIP, the loss function is the least squares loss given in (1). For simplicity, we consider the denoising case, where the forward operator $\\mathbf A=\\mathbf I$ . Then, substituting the gradient of the loss into (10) shows explicitly how the output of deep image prior evolves during training: ", "page_idx": 13}, {"type": "equation", "text": "$$\nf_{\\theta^{(t+1)}}(\\mathbf{z})=f_{\\theta^{(t)}}(\\mathbf{z})+\\beta\\Theta(\\mathbf{y}-f_{\\theta^{(t)}}(\\mathbf{z})).\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "Using this recursion relation, one can derive a closed form of the network output at iteration $t$ in terms of the initial output and NTK [20, 30]. The reconstruction at iteration $t$ is given by: ", "page_idx": 13}, {"type": "equation", "text": "$$\nf_{\\theta^{(t)}}(\\mathbf{z})=\\mathbf{y}-(\\mathbf{I}-\\beta\\Theta)^{t}(\\mathbf{y}-f_{\\theta^{(0)}}(\\mathbf{z})).\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "It is evident from (12) that the initial reconstruction of the network, $f_{\\boldsymbol{\\theta}^{(0)}}(\\mathbf{z})$ , has important effects on the training dynamics of DIP. Furthermore, networks used in DIP often feature skip connections from earlier layers to later ones, and it is natural to believe that these connections may cause the input $\\mathbf{z}$ to have a large effect on $f_{\\boldsymbol{\\theta}^{(0)}}(\\mathbf{z})$ . In the following theorem, we analyze the training dynamics of CNNs with a very similar architectural modification: a residual connection that adds the input directly to the network output. ", "page_idx": 13}, {"type": "text", "text": "Theorem A.1 (Dynamics of DIP with Residual Connections). Let g be a convolutional neural network with parameters $\\theta$ . We consider the complementary residual network $f$ defined by $f_{\\theta}(\\mathbf{z})=\\mathbf{z}+g_{\\theta}(\\mathbf{z})$ . Suppose that $f$ is trained using gradient descent with the loss $\\begin{array}{r}{\\mathcal{L}(f_{\\theta}(\\bar{\\mathbf{z}}))\\stackrel{{}=}\\frac{1}{2}||f_{\\theta}(\\bar{\\mathbf{z}})-\\mathbf{\\bar{y}}||_{2}^{2}}\\end{array}$ . Then, in the infinite width limit (number of channels), in expectation over the initialization of the parameters $\\theta$ , we have that the output at training iteration $t$ is given by: ", "page_idx": 14}, {"type": "equation", "text": "$$\nf_{\\theta^{(t)}}(\\mathbf{z})=\\mathbf{y}-(\\mathbf{I}-\\beta\\Theta)^{t}(\\mathbf{y}-\\mathbf{z}).\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "The proof of Theorem A.1 is provided in Appendix A.1, along with a precise statement of the assumptions on the network architecture and parameter initialization. Additionally, in Appendix A.2 we provide a simple experiment to validate that the training dynamics given in (13) hold for real networks. ", "page_idx": 14}, {"type": "text", "text": "Remark A.2. Theorem A.1 can be used to understand how the choice of network input affects the performance of DIP for image denoising. To gain intuition, we consider two special cases. First, we consider using the noisy image y as the input z. In this case, equation (13) simplifies to $f_{\\theta^{(t)}}(\\mathbf{y})\\,=\\,\\mathbf{y}$ for all iterations $t$ . In this case absolutely no denoising occurs. On the other hand, we consider the oracle case where the clean image x is used as z. This gives us $f_{\\theta^{(t)}}(\\mathbf{x})=$ $\\mathbf{y}-(\\mathbf{I}-\\beta\\Theta)^{t}(\\mathbf{y}-\\mathbf{x})$ . We see that at initialization ${{t}}=0$ ), we already expect perfect denoising, since $f_{\\theta^{(0)}}(\\mathbf{x})=\\mathbf{y}-(\\mathbf{I}-\\beta\\Theta)^{0}(\\mathbf{y}-\\mathbf{x})=\\mathbf{x}.$ . These two cases support intuition that using a network input closer to the true image could result in better performance in fewer training iterations. ", "page_idx": 14}, {"type": "text", "text": "A.1 Proof of Theorem A.1 ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "Setting of Theorem A.1. We first precisely state the conditions of Theorem A.1, in particular the network architectures considered and the corresponding parameter initializations. The present setting is very similar to the setting considered in [30], but we provide the details here for completeness. We consider an $L$ layer CNN with $c_{\\mathrm{in}}$ input channels and $c_{\\mathrm{out}}$ output channels, with $c$ hidden channels in all intermediate layers. We assume that $c_{\\mathrm{in}},c_{\\mathrm{out}}<<c$ . We assume all convolutions have a filter size of $r$ . For simplicity, the network input and output are vectorized, so convolutions of any dimension are treated identically. For example, for a 2D CNN with $5\\times5$ kernels, $r=25$ . Written explicitly, a network $g$ with this architecture takes the form ", "page_idx": 14}, {"type": "equation", "text": "$$\ng_{\\theta}(\\mathbf{z})=C_{L}(\\varphi(C_{L-1}(\\varphi(\\cdot\\cdot\\cdot\\varphi(C_{1}(\\mathbf{z})))))),\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "where the operators $C_{i}$ represent convolutions with an additive bias, and $\\varphi$ is a pointwise activation function such as ReLU. In this section, we also consider the residual network architecture defined by $f_{\\theta}(\\mathbf{z})=\\mathbf{z}+g_{\\theta}(\\mathbf{z})$ . ", "page_idx": 14}, {"type": "text", "text": "We assume that the parameters are initialized using the He initialization [45]. With this initialization, the first layer convolutional filter weights are drawn from $\\textstyle N(0,\\frac{\\sigma_{w}^{2}}{c_{\\mathrm{in}}r})$ , and the filter weights for all other layers are drawn from $\\textstyle{N(0,{\\frac{\\sigma_{w}^{2}}{c r}})}$ , where the variance $\\sigma_{w}^{2}$ depends on the non-linearity used in the network. For ReLU networks, $\\sigma_{w}^{2}=2$ [45]. All biases are initialized to 0. ", "page_idx": 14}, {"type": "text", "text": "Proof. In the setting described above, the NTK emerges in the limit $c\\rightarrow\\infty$ . A body of existing theory [30, 44, 46] establishes that in this limit the NTK is a deterministic matrix as a function of the network input ${\\bf z}$ . This theory does not consider residual connections, but applies immediately to both $g$ and $f$ . For $g$ , the NTK is given by ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\Theta:=\\left.\\big(\\nabla_{\\theta}g_{\\theta}(\\mathbf{z})\\big|_{\\theta=\\theta^{(0)}}\\big)\\big(\\nabla_{\\theta}g_{\\theta}(\\mathbf{z})\\big|_{\\theta=\\theta^{(0)}}\\big)^{T}\\,.\\right.\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "However, we can see that $\\nabla_{\\theta}g_{\\theta}(\\mathbf{z})\\big|_{\\theta=\\theta^{(0)}}=\\nabla_{\\theta}f_{\\theta}(\\mathbf{z})\\big|_{\\theta=\\theta^{(0)}}$ ", "page_idx": 14}, {"type": "text", "text": "Therefore, the linearization given in equation (10) holds for $f$ using the same kernel $\\Theta$ , and equation (12) describes the training dynamics of $f$ . ", "page_idx": 14}, {"type": "text", "text": "Using equation (12), we can write: ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{f_{\\boldsymbol{\\theta}^{(t)}}(\\mathbf{z})=\\mathbf{y}-(\\mathbf{I}-\\boldsymbol{\\beta}\\Theta)^{t}(\\mathbf{y}-f_{\\boldsymbol{\\theta}^{(0)}}(\\mathbf{z}))}\\\\ &{\\quad\\quad\\quad\\quad=\\mathbf{y}-(\\mathbf{I}-\\boldsymbol{\\beta}\\Theta)^{t}(\\mathbf{y}-\\mathbf{z}-g_{\\boldsymbol{\\theta}^{(0)}}(\\mathbf{z}))}\\end{array}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "To prove Theorem A.1, we consider the output $f_{\\theta^{(t)}}(\\mathbf{z})$ in expectation over the initialization $\\theta^{(0)}$ . Since all parameters $\\theta^{(0)}$ are drawn from mean 0 gaussian distributions, we find that $\\mathbb{E}_{\\theta^{(0)}}\\big[g_{\\theta^{(0)}}\\big(\\mathbf{z}\\big)\\big]=$ 0 for any input $\\mathbf{z}$ . Since $\\Theta$ is deterministic in the limit $c\\rightarrow\\infty$ , in expectation over $\\theta^{(0)}$ equation (16) reduces to $\\bar{f}_{\\theta^{(t)}}(\\mathbf{z})=\\mathbf{y}-(\\mathbf{I}-\\beta\\Theta)^{t}(\\mathbf{y}-\\mathbf{z})$ , which proves Theorem A.1. \u53e3 ", "page_idx": 14}, {"type": "text", "text": "A.2 Example to support the results of Theorem A.1 ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "We now provide a simple example using real networks to support the validity of Theorem A.1. This experiment substantiates both of the special cases considered in Remark A.2. Additionally, it shows that using the ground truth as the network input greatly inhibits overftiting. Indeed, in this experiment, we find that a residual network trained with the ground truth as input takes approximately 25 times more training iterations to completely learn the noisy signal than a residual network trained using a random noise input. ", "page_idx": 15}, {"type": "text", "text": "We use DIP for denoising a 1D sinusoidal signal. We denote the clean signal $\\mathbf{x}$ . The noisy signal is $\\textbf{y}=\\textbf{x}+\\textbf{n}$ , where $\\bar{\\textbf{n}}\\sim\\mathcal{N}(\\bar{0,\\mathbf{I}})$ . The network used is a five layer ReLU CNN with a residual connection. The full architecture can be written as $f(\\mathbf{z})\\;\\;=\\;\\;\\mathbf{z}\\;+$ $C_{5}(\\mathrm{ReLU}(C_{4}(\\cdot\\cdot\\cdot\\mathrm{ReLU}(C_{2}(\\mathrm{ReLU}(C_{1}(\\mathbf{z}))))))$ ), where each $C_{i}$ represents a convolution (with bias). The signal has a size of 100, and the convolutions each have a fliter size of 3, with 64 hidden channels. In all cases, the network is trained using gradient descent with a learning rate of $5\\times10^{-4}$ . The same seed was used to initialize the network in all cases. ", "page_idx": 15}, {"type": "text", "text": "We trained this network using three different inputs: the true signal $\\mathbf{x}$ , the noisy signal y, and noise $\\mathbf{z}\\sim\\mathcal{N}(0,\\mathbf{I})$ . The results of training the network using these three inputs are shown in Figure 6. We find that the results for training this real, reasonably sized network show the behavior predicted by Theorem A.1, which was obtained in the infinite width limit. Indeed, equation (13) predicts that when $\\mathbf{x}$ is used as the input, the initial error will be small, with eventual overftiting to the noisy signal. This is observed in Figure 6, where the error is lowest at initialization, and it steadily increases throughout training. With this input, the network is highly resistant to overfitting, requiring approximately $10^{5}$ training iterations to completely fti the noisy signal. We also see that when $\\mathbf{y}$ is used as the input, the error curve obtained is essentially flat and converges quickly to the error of the noisy signal. This agrees with the expectation that the network output will be y for all iterations $t$ when $\\mathbf{y}$ is used as the input. Finally, when random noise $\\mathbf{z}$ is used as the input, the typical DIP behavior emerges. ", "page_idx": 15}, {"type": "image", "img_path": "K1EG2ABzNE/tmp/d585e1eae64d804b8f6101cdb72aedb2d57c69242136d519a6ee8efedb3a87fc.jpg", "img_caption": ["Figure 6: Ground truth signal and measurements $(l e f t)$ , and the results of the denoising experiment in Appendix A.2 (right) to support the claims in Theorem A.1 and Remark A.2. "], "img_footnote": [], "page_idx": 15}, {"type": "text", "text": "B Trained Autoencoders as Reconstructors ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "Here, we investigate how the autoencoder term in aSeqDIP is improving the reconstruction quality while mitigating the impact of noise overftiting. In particular, we try to answer the question: Can an autoencoder trained on clean images operate as a reconstructor at testing time? ", "page_idx": 15}, {"type": "text", "text": "To address this question, we perform the following steps: $(i)$ train an autoencoder on fully sampled measurements or clean data images and $(i i)$ utilize the trained autoencoder with unseen subsampled or corrupted measurements, optimizing over the input using the DIP objective with the autoencoder term. This enables the autoencoder to function as an image reconstructor. Specifically, given a training dataset, $\\mathcal{D}$ , comprising unperturbed images or fully sampled MRI/CT data, denoted by $\\mathbf{x}$ , we train an autoencoder U-Net $g:\\mathbb{R}^{n}\\rightarrow\\mathbb{R}^{n}$ with parameters $\\psi$ . The training process seeks to obtain $\\hat{\\psi}$ as ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\hat{\\psi}=\\underset{\\psi}{\\operatorname{argmin}}\\,\\frac{1}{|\\mathcal{D}|}\\sum_{\\mathbf{x}\\in\\mathcal{D}}\\|g_{\\psi}(\\mathbf{x})-\\mathbf{x}\\|_{2}^{2}\\,.\n$$", "text_format": "latex", "page_idx": 15}, {"type": "image", "img_path": "K1EG2ABzNE/tmp/ee79980074184a06a8a80072c7e6cbc5d7b26ac031564747e832e84b0f11b36c.jpg", "img_caption": ["Figure 7: Average PSNR (y-axis) of 8 MRI images (with $4\\mathbf{x}$ undersampling) obtained by optimizing the input of a trained autoencoder (using (17)) w.r.t. different values of the regularization parameter $\\lambda_{a}$ in (18) $\\bf\\delta X$ -axis). "], "img_footnote": [], "page_idx": 16}, {"type": "text", "text": "Subsequently, given unseen measurements $\\mathbf{y}$ and the learned autoencoder\u2019s parameters $\\hat{\\psi}$ , we test the reconstruction of ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\mathbf{z}\\gets\\underset{\\mathbf{z}}{\\mathrm{argmin}}\\,\\|\\mathbf{A}g_{\\hat{\\psi}}(\\mathbf{z})-\\mathbf{y}\\|_{2}^{2}+\\lambda_{a}\\|g_{\\hat{\\psi}}(\\mathbf{z})-\\mathbf{z}\\|_{2}^{2}\\,,\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "where $\\lambda_{a}\\,\\in\\,\\mathbb{R}_{+}$ is a regularization parameter. We perform this experiment by training $\\psi$ using 3000 fully sampled scans from the fastMRI dataset [47]. We then evaluate the reconstruction quality of the trained encoder using 8 scans from the fastMRI testing set. The average PSNR results for different values of $\\lambda_{a}$ are depicted in Figure 7. As observed, a trained autoencoder effectively serves as a reconstructor as evidenced by the achieved PSNR. Thus, we deduce that the autoencoder term in aSeqDIP not only mitigates noise overfitting but also enhances the reconstruction quality as an important prior. ", "page_idx": 16}, {"type": "text", "text": "C Additional Experiments ", "text_level": 1, "page_idx": 16}, {"type": "image", "img_path": "K1EG2ABzNE/tmp/5b070b13f1f0a83c01cc9fb81702e272a6bd1927800a5bb4131ea14257a08258.jpg", "img_caption": ["C.1 Robustness to Noise Overfitting for the Denoising Task ", "Figure 8: Average PSNR results of 20 images w.r.t. to the optimization iteration using aSeqDIP and DIP-based baselines. "], "img_footnote": [], "page_idx": 16}, {"type": "text", "text": "In this subsection, we illustrate aSeqDIP\u2019s robustness to the noise overftiting issue for the denoising task. The average PSNR for 20 images from the CBSD68 dataset for denoising using aSeqDIP and other DIP-based methods are given in Figure 8. We observe two key points. First, in addition to higher PSNR, aSeqDIP shows higher robustness against noise overfitting compared to other DIP-based methods, consistent with MRI and CT results in Figure 4. Second, unlike MRI and CT, the onset of noise overfitting occurs earlier, but the subsequent decay is very small. ", "page_idx": 16}, {"type": "text", "text": "C.2 Comparison with VarNet: An End-to-End MRI Supervised Method ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "Here, we compare aSeqDIP with the End-to-End (E2E) MRI supervised model [48] that uses the variational network (VarNet). Results are given in Table 3. As observed, we slightly under-perform when compared to VarNet (trained on 8000 data points) for the task of MRI reconstruction all without requiring any labeled training data. It is important to note that, at inference, E2E models only require a few unrolling steps, whereas aSeqDIP is an optimization method that requires to train the network parameters for each new set of measurements. ", "page_idx": 16}, {"type": "text", "text": "", "page_idx": 17}, {"type": "table", "img_path": "K1EG2ABzNE/tmp/4e7ff10ba4d2ce507bc458fda29b0b26c4d5c0cd46e6b4ae5e593032f5310368.jpg", "table_caption": [], "table_footnote": [], "page_idx": 17}, {"type": "table", "img_path": "K1EG2ABzNE/tmp/570823867f18c8e41488ec856bd24e4b5b355de9a05762926d729afafe57d54a.jpg", "table_caption": ["Table 3: Average PSNR results (over $20\\ \\mathrm{MRI}$ scans at $_{4\\mathrm{x}}$ undersampling from the testing set of fastMRI) reported by our method against E2E VarNet [48] (pre-trained on fastMRI) for the task of MRI reconstruction. ", "C.3 Comparison with DM-based Methods on the FFHQ Dataset "], "table_footnote": [], "page_idx": 17}, {"type": "text", "text": "Here, we present average PSNR results (averaged over 20 images) for the tasks of denoising , random inpainting ${}^{97\\%}$ missing pixels), box-in-painting (with HIAR of 0.25), and non-linear deblurring of our method versus Denoising Diffusion Null-Space Model (DDNM) [49] and DPS [16] on the FFHQ testing dataset. For DPS and DDNM, we used a pre-trained model that was trained on the training set of FFHQ. As observed, our training-data-free method achieves competitive or slightly improved results when compared to data-intensive methods on all tasks other than box-inpainting (for which we under-perform by less than 1 dB), all without requiring a pre-trained model. ", "page_idx": 17}, {"type": "text", "text": "C.4 Ablation Study on the Regularization Parameter in aSeqDIP ", "text_level": 1, "page_idx": 17}, {"type": "image", "img_path": "K1EG2ABzNE/tmp/fb6539690adc7ceccb9a6b00b65c87330f085e11f44a24ef91bc2766c897031d.jpg", "img_caption": ["Table 4: Average PSNR results reported by our method against DPS as well as a more recent leading method DDNM [49] for four image restoration tasks: Denoising, Random In-Painting, non-linear Deblurring, and Box In-Painting. ", "Figure 9: Average PSNR results of $20\\;\\mathrm{MRI}$ (with $_{4\\mathrm{x}}$ undersampling) scans in aSeqDIP for the cases where $\\lambda\\in\\{0.5,1,2\\}$ and $i\\in[10000]$ . "], "img_footnote": [], "page_idx": 17}, {"type": "text", "text": "In this section, we conduct an ablation study on the choice of the autoencoding regularization parameter, $\\lambda$ , in (3). Specifically, we conduct an experiment using $20\\ \\mathrm{MRI}$ scans to examine the impact of $\\lambda$ on the reconstruction quality and noise overfitting in aSeqDIP. We note that while the main results in Section 4 use $N K=4000$ , in these experiments, we run our algorithm for an extended number of iterations to investigate the onset of noise overfitting. We set $K=5000$ and $N=2$ for this purpose. ", "page_idx": 17}, {"type": "text", "text": "In this experiment, we run aSeqDIP with values of $\\lambda\\in\\{0.5,1,2\\}$ . Average PSNR results are given in Figure 9. It is evident that, on average, using $\\lambda=1$ yields the most favorable results in terms of ", "page_idx": 17}, {"type": "text", "text": "PSNR values, which is our selected choice. Furthermore, we observe that for $\\lambda=0.5$ (red), the start of the PSNR decay (the onset of noise overftiting) precedes that of $\\lambda=1$ and $\\lambda=2$ (blue and black). ", "page_idx": 18}, {"type": "text", "text": "C.5 Ablation Study on $N$ and $K$ in aSeqDIP ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "In this section, we conduct an ablation study to investigate the impact of the number of gradient updates $(N)$ per one set of parameter $(K)$ in aSeqDIP. Specifically, we report the PSNR results across the tasks of MRI, CT, denoising, and in-painting for the case of $N K=4000$ , considering combinations of $(N,K)$ as $(1,4000)$ , (2, 2000), and (4, 1000). The results, presented in Figure 10, reveal that across all tasks considered, the combination of $N=2$ and $K=2000$ consistently yields the most favorable results in terms of PSNR. ", "page_idx": 18}, {"type": "image", "img_path": "K1EG2ABzNE/tmp/bdbb3f252488dcb643b3e2d60e92c73e20921ba56323ae720fe2f2fe4f7bd9af.jpg", "img_caption": ["Figure 10: Ablation study on the choice of the number of gradient updates $N$ per U-Net, and the number of U-Nets $K$ in terms of PSNR using the four considered tasks for the case of $N K=4000$ . "], "img_footnote": [], "page_idx": 18}, {"type": "text", "text": "C.6 Additional Implementation Details ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "For denoising, each noisy RGB image is $512\\times512$ and is generated by adding an additive Gaussian white noise with two noise levels as descired in Table 1. For in-painting, we consider a central region mask, and we evaluate two hole-to-image area ratios (HIAR) with image size $512\\times512$ . ", "page_idx": 18}, {"type": "text", "text": "For Vanilla DIP, Self-Guided DIP, Reference-guided DIP, TV-DIP, Rethinking DIP, and SGLD DIP, we use 4000 iterations. For TV-DIP, we set the regularization parameter to 1. For ES-DIP, we use the default configuration provided by the authors for the three considered tasks. ", "page_idx": 18}, {"type": "text", "text": "The reference image in Reference-guided DIP is chosen as (using a distance metric such as Euclidean distance or other metric) that which is most similar to an estimated test reconstruction from undersampled data or sparse-view data. ", "page_idx": 18}, {"type": "text", "text": "For DM-based approaches, we use the codes attached to the authors\u2019 papers. Specifically, Score-MRI [14], MCG [15], and DPS [16]. For our experiments with natural images (denoising, in-painting, and non-linear deblurring) in Table 2, we used the CBSD68 dataset. As such, for DPS (the DM-based method), we utilized a pre-trained model that was trained on a very large and diverse dataset which is ImageNet $128\\times128$ , $256\\times256$ , and $512\\times512$ . This pre-trained model is much more generalizable when compared to the other option which was trained on FFHQ (a dataset of faces). According to [17], the ImageNet pre-trained model has high generalizability. For the FFHQ comparison results in Appendix C.3, we used an FFHQ-pre-trained DM for DPS and DDNM. ", "page_idx": 18}, {"type": "text", "text": "For MRI, the pre-trained model used in Score-MRI was originally trained on natural images then fine-tuned using the training set of fastMRI. Similar approach was used for the CT pre-trained model used in MCG. ", "page_idx": 18}, {"type": "text", "text": "C.7 Additional Visualizations ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Figures 11 and 12 present additional MRI visualisations, whereas Figures 13 and 14 present CT visualizations. Samples from the natural image restoration tasks are given in Figure 15, Figure 16, and Figure 17 for box-inpainting, denoising, and non-linear deblurring, respectively. ", "page_idx": 18}, {"type": "image", "img_path": "K1EG2ABzNE/tmp/0d1811021cfe97527f57ba3176ecdc18cffc5a5ac2e3ae3d932dc30056f2439d.jpg", "img_caption": ["Figure 11: Visualization of ground-truth and reconstructed images using different methods of a knee image from the fastMRI dataset with $4\\mathrm{~x~k~}$ -space undersampling. A region of interest is shown with a green box and its error (magnitude) is shown in the panel on the top right. aSeqDIP provides the sharpest and clearest reconstruction of image features. "], "img_footnote": [], "page_idx": 19}, {"type": "image", "img_path": "K1EG2ABzNE/tmp/b0fb94f65e324ff01f4dd52cb6e9cb1b79bbb0c37ce544b241d3d02214583781.jpg", "img_caption": ["Figure 12: Visualization of ground-truth and reconstructed images using different methods of a knee image from the fastMRI dataset with $8\\mathrm{x}\\,\\mathrm{k}$ -space undersampling. A region of interest is shown with a green box and its error (magnitude) is shown in the panel on the top right. aSeqDIP provides the clearest reconstruction of image features amongst the methods. "], "img_footnote": [], "page_idx": 19}, {"type": "image", "img_path": "K1EG2ABzNE/tmp/da6f63ab57557bc74f04c4cdaf0a0df7e152c41a3d7034d7a04d71ac59207be5.jpg", "img_caption": ["Figure 13: Visualization of ground-truth and reconstructed images using different methods of a CT scan from the AAPM dataset with 18 views. A region of interest is shown with a green box and its error (magnitude) is shown in the panel on the top right. aSeqDIP provides the sharpest and clearest reconstruction of image features. "], "img_footnote": [], "page_idx": 20}, {"type": "image", "img_path": "K1EG2ABzNE/tmp/2e3e8a097de5b1d59e228c6a149b6985f7c9950f71fdf10c3720148b67dc44b9.jpg", "img_caption": ["Figure 14: Visualization of ground-truth and reconstructed images using different methods of a CT scan from the AAPM dataset with with 30 views. A region of interest is shown with a green box and its error (magnitude) is shown in the panel on the top right. aSeqDIP provides better reconstruction of small and low-contrast image features. "], "img_footnote": [], "page_idx": 20}, {"type": "image", "img_path": "K1EG2ABzNE/tmp/dfd746a7e8b07f1a2fe19ad5102100f2dd19661658b3db01d97146f97611815d.jpg", "img_caption": ["Figure 15: In-painting example with 0.1 HIAR where image restorations of different methods are given using an example from the CBSD68 dataset. The diffusion-based DPS produces spurious (although sharp) content in the hole region while aSeqDIP much better preserves features in the original ground truth. "], "img_footnote": [], "page_idx": 21}, {"type": "image", "img_path": "K1EG2ABzNE/tmp/be8ad2e2da3f59ffc5d9c5d82f0ce0c55f367c3916232cc1826b1b94e5904f0e.jpg", "img_caption": ["Figure 16: Denoising example with $\\sigma_{\\mathrm{d}}=25$ where image restorations of different methods are given using an example from the CBSD68 dataset. aSeqDIP provides the sharpest and clear reconstruction of image features. "], "img_footnote": [], "page_idx": 21}, {"type": "image", "img_path": "K1EG2ABzNE/tmp/84eb22601d3f3fb7a99389b1e6a5ab5f53ff7566acd546a721d1c9bbc239c88d.jpg", "img_caption": ["Figure 17: Non-linear deblurring samples where image restorations of different methods are given using an example from the FFHQ dataset. "], "img_footnote": [], "page_idx": 22}, {"type": "text", "text": "NeurIPS Paper Checklist ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "1. Claims ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Question: Do the main claims made in the abstract and introduction accurately reflect the paper\u2019s contributions and scope? ", "page_idx": 22}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 22}, {"type": "text", "text": "Justification: The Abstract and Introduction highlight the challenges of previous works, leading to the motivation of the our proposed approach, followed by the contributions of the paper. ", "page_idx": 22}, {"type": "text", "text": "2. Limitations ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Question: Does the paper discuss the limitations of the work performed by the authors? ", "page_idx": 22}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 22}, {"type": "text", "text": "Justification: In Section 3, we show that while we use the autoencoding regularization term to mitigate the issue of noise overfitting, the problem still exists. Nevertheless, it is highly mitigated when compared to previous works. This was supported by experiments. ", "page_idx": 22}, {"type": "text", "text": "3. Theory Assumptions and Proofs ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Question: For each theoretical result, does the paper provide the full set of assumptions and a complete (and correct) proof? ", "page_idx": 22}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 22}, {"type": "text", "text": "Justification: For the first remark, we provide the assumptions needed to state the results. ", "page_idx": 22}, {"type": "text", "text": "4. Experimental Result Reproducibility ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Question: Does the paper fully disclose all the information needed to reproduce the main experimental results of the paper to the extent that it affects the main claims and/or conclusions of the paper (regardless of whether the code and data are provided or not)? ", "page_idx": 22}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 22}, {"type": "text", "text": "Justification: We provide the detailed settings, baselines, and forward models for each imaging task we consider (Table 1). Furthermore, the implementation details for baselines are provided in Appendix C.6. ", "page_idx": 22}, {"type": "text", "text": "5. Open access to data and code ", "page_idx": 22}, {"type": "text", "text": "Question: Does the paper provide open access to the data and code, with sufficient instructions to faithfully reproduce the main experimental results, as described in supplemental material? ", "page_idx": 23}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 23}, {"type": "text", "text": "Justification: Our code that contains all the experiments of our method and most baselines are included in the repo link we provide. ", "page_idx": 23}, {"type": "text", "text": "6. Experimental Setting/Details ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: Does the paper specify all the training and test details (e.g., data splits, hyperparameters, how they were chosen, type of optimizer, etc.) necessary to understand the results? ", "page_idx": 23}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 23}, {"type": "text", "text": "Justification: In Section 4, we provide all the details needed to understand the results. ", "page_idx": 23}, {"type": "text", "text": "7. Experiment Statistical Significance ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: Does the paper report error bars suitably and correctly defined or other appropriate information about the statistical significance of the experiments? ", "page_idx": 23}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 23}, {"type": "text", "text": "Justification: We report average PSNR and SSIM scores as well as standard deviation in Section 3 for the main experiments. ", "page_idx": 23}, {"type": "text", "text": "8. Experiments Compute Resources ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: For each experiment, does the paper provide sufficient information on the computer resources (type of compute workers, memory, time of execution) needed to reproduce the experiments? ", "page_idx": 23}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 23}, {"type": "text", "text": "Justification: In the beginning of Section 4, we exactly specify the GPU machine used to run our method and all other baselines. Furthermore, in Table 2, we report run time results. ", "page_idx": 23}, {"type": "text", "text": "9. Code Of Ethics ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: Does the research conducted in the paper conform, in every respect, with the NeurIPS Code of Ethics https://neurips.cc/public/EthicsGuidelines? ", "page_idx": 23}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 23}, {"type": "text", "text": "Justification: Authors have reviewed the code of ethics. ", "page_idx": 23}, {"type": "text", "text": "10. Broader Impacts ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: Does the paper discuss both potential positive societal impacts and negative societal impacts of the work performed? ", "page_idx": 23}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 23}, {"type": "text", "text": "Justification: The paper addresses the problem of image reconstruction, and our method can not be used for image manipulation. Therefore, there is no societal impact of the work performed. ", "page_idx": 23}, {"type": "text", "text": "11. Safeguards ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: Does the paper describe safeguards that have been put in place for responsible release of data or models that have a high risk for misuse (e.g., pretrained language models, image generators, or scraped datasets)? ", "page_idx": 23}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 23}, {"type": "text", "text": "Justification: We cite the code used for baselines, and provide the links used for each dataset. ", "page_idx": 23}, {"type": "text", "text": "12. Licenses for existing assets ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: Are the creators or original owners of assets (e.g., code, data, models), used in the paper, properly credited and are the license and terms of use explicitly mentioned and properly respected? ", "page_idx": 23}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 23}, {"type": "text", "text": "Justification: We cite the code used for baselines, and provide the links used for each dataset. ", "page_idx": 24}, {"type": "text", "text": "13. New Assets ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Question: Are new assets introduced in the paper well documented and is the documentation provided alongside the assets? ", "page_idx": 24}, {"type": "text", "text": "Answer: [NA] Justification: We only release code for our algorithm. ", "page_idx": 24}, {"type": "text", "text": "14. Crowdsourcing and Research with Human Subjects ", "page_idx": 24}, {"type": "text", "text": "Question: For crowdsourcing experiments and research with human subjects, does the paper include the full text of instructions given to participants and screenshots, if applicable, as well as details about compensation (if any)? ", "page_idx": 24}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 24}, {"type": "text", "text": "Justification: The paper does not involve crowdsourcing nor research with human subjects. ", "page_idx": 24}, {"type": "text", "text": "15. Institutional Review Board (IRB) Approvals or Equivalent for Research with Human Subjects ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Question: Does the paper describe potential risks incurred by study participants, whether such risks were disclosed to the subjects, and whether Institutional Review Board (IRB) approvals (or an equivalent approval/review based on the requirements of your country or institution) were obtained? ", "page_idx": 24}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 24}, {"type": "text", "text": "Justification: The paper does not involve crowdsourcing nor research with human subjects. ", "page_idx": 24}]