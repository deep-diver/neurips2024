[{"type": "text", "text": "Taming the Long Tail in Human Mobility Prediction ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Xiaohang $\\mathbf{X}\\mathbf{u}^{1}$ , Renhe Jiang1\u2217, Chuang Yang1, Zipei $\\mathbf{Fan^{1}}$ , Kaoru Sezaki1 ", "page_idx": 0}, {"type": "text", "text": "1The University of Tokyo xhxu@g.ecc.u-tokyo.ac.jp {jiangrh, chuang.yang}@csis.u-tokyo.ac.jp {fanzipei, sezaki}@iis.u-tokyo.ac.jp ", "page_idx": 0}, {"type": "text", "text": "Abstract ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "With the popularity of location-based services, human mobility prediction plays a key role in enhancing personalized navigation, optimizing recommendation systems, and facilitating urban mobility and planning. This involves predicting a user\u2019s next POI (point-of-interest) visit using their past visit history. However, the uneven distribution of visitations over time and space, namely the long-tail problem in spatial distribution, makes it difficult for AI models to predict those POIs that are less visited by humans. In light of this issue, we propose the LongTail Adjusted Next POI Prediction (LoTNext) framework for mobility prediction, combining a Long-Tailed Graph Adjustment module to reduce the impact of the long-tailed nodes in the user-POI interaction graph and a novel Long-Tailed Loss Adjustment module to adjust loss by logit score and sample weight adjustment strategy. Also, we employ the auxiliary prediction task to enhance generalization and accuracy. Our experiments with two real-world trajectory datasets demonstrate that LoTNext significantly surpasses existing state-of-the-art works. Our code is available at https://github.com/Yukayo/LoTNext. ", "page_idx": 0}, {"type": "text", "text": "1 Introduction ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Human mobility prediction is essential in various applications, aiming to forecast the next Point of Interest (POI) a user may visit based on their historical location data, preferences, and patterns [10, 8, 53, 33]. By predicting user movements, it supports urban planning, traffic management, and environmental protection, and provides intelligent personalized Location-Based Social Networking (LBSN) services [7, 37], enhancing people\u2019s life quality. ", "page_idx": 0}, {"type": "text", "text": "The growth of POI prediction tasks is closely linked to the development of LBSN platforms, where users frequently share their itineraries and reviews, leading to a substantial accumulation of geographical visitation data. However, data collection faces challenges due to network and privacy constraints on mobile devices and the requirement for user authorization to record check-ins. This often results in data being sparse and biased towards popular locations, exhibiting a severe long-tail effect. Currently, these methods fall into two primary categories: Sequence-based and Graph-based models. ", "page_idx": 0}, {"type": "text", "text": "\u2022 Sequence-based models treat users\u2019 trajectories as independent visitation sequences. Existing methods include Recurrent Neural Networks (RNNs) [6, 12, 11], Long Short Term Memory (LSTM) [2, 20, 14, 13] and Gated Recurrent Unit (GRU) [4, 5] for modeling the rich spatialtemporal information implied in the visitation sequence. ", "page_idx": 0}, {"type": "text", "text": "\u2022 Graph-based models focus on building models and data structures to capture trend information in the data to enhance the prediction performance, such as the movement trends among all users [45, 39, 34, 35, 41], geographic adjacency [27, 22, 26], and category transition between POIs [49, 48]. This helps in modeling complex global visitation preferences and the semantic context of locations. ", "page_idx": 0}, {"type": "text", "text": "Nevertheless, existing works often overlook the intrinsic long-tailed distribution problem in spatial visitation patterns. As shown in Figure 1, it provides the evidence of long-tailed distribution on Gowalla1 dataset, a real LBSN dataset. From the visualization results, it is evident that only a few POIs are visited more than 100 times. In addition, the illustrative diagram above the graph presents a hypothetical scenario. The prediction model might inaccurately predict that a user would visit a common location, such as McDonald\u2019s (a Head POI), while the user actually visits a less common place like a ramen restaurant (a Long-Tail POI). This highlights the importance of designing models capable of accurately predicting visits to Long-Tail POIs. The concept of a long-tailed distribution, while first extensively studied and addressed within the computer vision (CV) field [44], manifests differently in the context of POI prediction. In POI prediction, long-tailed POIs are embedded within users\u2019 complex trajectories. This distinction means that unlike in CV, where long-tailed samples can be selectively augmented to balance datasets, selecting long-tailed POIs without considering the spatial-temporal context in which they occur risks losing crucial trajectory information. ", "page_idx": 1}, {"type": "text", "text": "Against this background, to mitigate the longtail problem in the human next POI prediction task, we propose the Long-Tail Adjusted Next POI prediction (LoTNext) framework, which is a generic framework aimed at optimizing and fully utilizing long-tailed POI information. More specifically, our solution first employs a Long-Tailed Graph Adjustment module to reduce noise and long-tailed nodes in the userPOI interaction graph, thereby mitigating the impact of long-tailed POIs on model performance. Through graph adjustment, the model can more accurately capture spatial-temporal information from trajectory contexts. Furthermore, to pre", "page_idx": 1}, {"type": "image", "img_path": "wT2TIfHKp8/tmp/821502b2c550296c8dfdf35dd57db520bd36daa32403373276148eddac81561f.jpg", "img_caption": ["Figure 1: The long-tailed distribution for POI check-in frequency from the Gowalla dataset. "], "img_footnote": [], "page_idx": 1}, {"type": "text", "text": "vent the model from overly focusing on head POIs (high-frequency POIs), we propose the Long-Tailed Loss Adjustment module to balance the loss between head and tail POI data. Finally, to alleviate the intrinsic sparsity issue without introducing additional data sources, we incorporate auxiliary prediction tasks to further integrate the POI feature and spatial-temporal information. ", "page_idx": 1}, {"type": "text", "text": "We conclude our contributions as follows: (1) We propose the LoTNext framework based on graph adjustment to effectively address the challenges of dataset-inherent sparsity in the user-POI interaction graph. (2) We design the Long-Tailed Loss Adjustment module for adaptive sample re-weighting, which more effectively balances the loss between head and tail samples. (3) We introduce the auxiliary prediction task, which achieves complementarity of POI feature information and spatial-temporal information. (4) We evaluate LoTNext on two public LBSN datasets, comparing it with numerous baselines. The results demonstrate that LoTNext significantly outperforms state-of-the-art methods. ", "page_idx": 1}, {"type": "text", "text": "2 Related Work ", "text_level": 1, "page_idx": 1}, {"type": "text", "text": "Next POI Prediction. Most current works on the next POI prediction treat trajectories as time series, further incorporating spatial-temporal contexts into models to enrich the semantics of POIs. The pioneering ST-RNN [18] introduces spatial-temporal intervals to RNN for context awareness. DeepMove [6] integrates LSTM with attention mechanisms to consider both the short-term and longterm preferences of users comprehensively, and LSTPM [29] enhances spatial context integration. The Flashback model [43] tackles user sparsity by mining similar contexts in historical data. However, due to the limited capability of RNN in modeling long sequences, researchers have explored using graphs for improvements. GETNext [45], based on the Transformer architecture, combines global mobility patterns graph with various spatial-temporal contexts to fully utilize information among similar user trajectories for improving prediction performance. Graph-Flashback [27] considers constructing a knowledge graph to improve POI representation and integrates it with sequence recommendation models. SNPM [46] builds a POI similarity graph to aggregate similar POIs and enhance POI representation results. However, all these studies overlook the significant impact of the long-tail problem on the next POI prediction. ", "page_idx": 1}, {"type": "table", "img_path": "wT2TIfHKp8/tmp/a1f8d2736eda3fde5df042c2baa75d0b99b1525bf4364f18c5f409bcddc41d15.jpg", "table_caption": ["Figure 2: The Architecture of Long-Tail Adjusted Network for Next POI Prediction (LoTNext). "], "table_footnote": [], "page_idx": 2}, {"type": "text", "text": "Long-Tailed Learning. The long-tail problem has always been a focus in the fields of CV [3, 30] and recommendation systems [15]. The most direct solution is re-sampling [50], varying from random to progressively balanced. Another common strategy is logit adjustment [24, 25, 31], aimed at modifying the logistic output to address the imbalanced data class problem. A study by Google [24] has proven that logit adjustment satisfies Fisher consistency and can effectively minimize the average error per category. Compared to the CV field, the long-tail problem is more pronounced in recommendation systems [1, 19]. Typically, the number of items far exceeds the number of users, leading to many items rarely or infrequently accessed by users. Some works tackle the long-tail problem by learning item similarities through random walk algorithms [47] or utilizing transfer learning to transfer the knowledge from head to tail data [51]. [36] used meta-learning to enhance the information representation of the user-item graph. [21] introduced a novel edge addition module to enrich the connectivity for tail samples. However, unlike traditional recommendation tasks, the next POI prediction involves complex spatial-temporal semantics due to the nature of trajectory data, making it more challenging to improve the representation of long-tailed POI samples. To the best of our knowledge, our work is the first to propose a general framework for the next POI prediction under the long-tail problem. ", "page_idx": 2}, {"type": "text", "text": "3 Problem Definition ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "Given a user set $U\\,=\\,\\bigl\\{u_{1},u_{2},...,u_{|U|}\\bigr\\}$ and a POI set $P\\,=\\,\\{p_{1},p_{2},...,p_{|P|}\\}$ , with $|U|$ and $|P|$ indicating the number of users and POIs respectively, we denote the POI check-in as a triplet $\\langle u,p,t\\rangle$ , which means a user $u$ visits ${\\mathrm{POI}}\\,p$ at time $t$ . Each ${\\mathrm{POI}}\\,p$ is a triplet $p=\\langle l a t,l o n,f r e q\\rangle$ , representing its latitude, longitude, and visit frequency. We proceed to outline our problem definition as follows. ", "page_idx": 2}, {"type": "text", "text": "Definition 1 (User Next POI Prediction) Given a user check-in sequence denoted as $Q_{u}\\!=$ $\\left(\\langle p_{1},t_{1}\\rangle,\\langle p_{2},t_{2}\\rangle,\\dots,\\langle p_{n},t_{n}\\rangle\\right)$ , our goal is to predict a list of top POIs that the user u is likely to visit next, which can be taken as a typical sequence classification task over $|P|$ POI candidates. In particular, our work focuses on how to accurately predict the \u201cless visited\u201d POIs belonging to the long-tailed interval. ", "page_idx": 2}, {"type": "text", "text": "4 Methodology ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "In this section, we introduce the details of the LoTNext framework, as shown in Figure 2, which consists of the preliminary POI prediction model, Long-Tailed Graph Adjustment module, and Long-Tailed Loss Adjustment module. ", "page_idx": 2}, {"type": "text", "text": "4.1 Preliminary Model ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "We first construct a preliminary end-to-end model, which is designed for precise next POI prediction. ", "page_idx": 2}, {"type": "text", "text": "Trajectory Embedding Layer. For the embedding generation, we initialize embeddings for POIs $E^{P}\\in\\mathbb{R}^{|\\bar{P}|\\times d_{p}}$ , timestamps $\\overline{{E}}^{T}\\in\\mathbb{R}^{|T|\\times d_{t}}$ , and users $E^{U}\\in\\mathbb{R}^{|U|\\times d_{u}}$ , where $d_{p}$ , $d_{t}$ and $d_{u}$ are the corresponding embedding dimension and $|T|$ is the number of the time slots. In our case, considering each hour slot over a week, there are 168 time slots in total. During the sequence processing phase, we select embedding from $E^{P}$ and $E^{T}$ based on the POI and time indices in the input sequence $Q_{u}$ to construct an embedding sequence $X\\in\\mathbb{R}^{n\\times(d_{p}+d_{t})}$ , as $X=[(E_{p_{1}}^{P},E_{p_{2}}^{P},...,E_{p_{n}}^{P})||(E_{t_{1}}^{T},E_{t_{2}}^{T},...,E_{t_{n}}^{T})]$ , where is the sequence length and $\\bigstar\\bigstar||\\bigstar$ denotes the concatenation operation. ", "page_idx": 3}, {"type": "text", "text": "Transformer Encoder. Transformer [32] architecture in modeling trajectories has been demonstrated in multiple studies [39, 45, 40], we adopt its encoder block to encode spatial-temporal contexts within trajectories, focusing on capturing long-distance dependencies through multi-layer stacking. To maintain positional information in the sequence, we incorporate a learnable positional embedding $E_{p o s}\\in\\mathbb{R}^{n\\times d_{p}}$ with the raw embedding sequence $X$ to form the Transformer input $\\widetilde{X}=X+E_{p o s}$ . Next, we define the Transformer encoder block as follows: ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{Z=\\mathrm{LayerNorm}(\\widetilde{X}+\\mathrm{Multi-Head}\\mathrm{~Attention}(\\widetilde{X})),}\\\\ &{\\widetilde{Z}=\\mathrm{LayerNorm}(Z)+\\mathrm{FFN}(Z)),}\\end{array}\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "where FFN is a fully connected layer and the Multi-Head Attention can be described as: ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathrm{Multi-Head}(\\widetilde{X})=\\lceil\\mathrm{head}_{1}\\rceil|\\mathrm{head}_{2}||...||\\mathrm{head}_{h}|W^{O},}\\\\ &{\\qquad\\qquad\\mathrm{head}_{i}=\\mathrm{Softmax}\\left(\\frac{\\widetilde{X}^{i}W^{Q}(\\widetilde{X}^{i}W^{K})^{T}}{\\sqrt{d_{k}}}\\right)\\widetilde{X}^{i}W^{V},}\\end{array}\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "where ${\\widetilde{X}}^{i}$ is the input of the $i^{\\th}$ -th\u221a head, $W^{O},W^{Q},W^{K}$ , and $W^{V}$ are the learnable weights matrix, $h$ is the n umber of the head, and $\\sqrt{d_{k}}$ is the scaling factor. ", "page_idx": 3}, {"type": "text", "text": "Spatial Contextual Attention Layer. Inspired by Flashback [43], we introduce the Spatial Contextual Attention Layer to analyze the relationship between spatial proximity and user interactions. It assigns dynamic weights to POIs in a sequence, taking into account both the order and geographical distances, focusing on POIs most influential to future movements. The spatial weight $\\omega_{k}$ for each POI $p_{k}$ in the sequence $\\left(p_{1},p_{2},...,p_{k},...,p_{n}\\right)$ , considering its spatial distance to all previous POIs $p_{1}{\\sim}p_{k}$ , is: ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\omega_{k}=\\sum_{j=1}^{k}\\left(e^{-\\beta(\\Delta(p_{j},p_{k}))}+\\epsilon\\right),\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "where $\\Delta(p_{j},p_{k})$ is the haversine distance between $p_{j}$ and $p_{k}$ , $\\beta$ is the distance decay weight, and $\\epsilon$ is a small constant to prevent division by zero. Considering $\\tilde{z}_{k}$ , an element from the Transformer output sequence $\\widetilde{Z}=(\\widetilde{z}_{1},\\widetilde{z}_{2},...,\\widetilde{z}_{k},...,\\widetilde{z}_{n})$ . The refined output $\\tilde{z}_{k}^{\\prime}$ is obtained by applying spatial weight to the cumulative previous outputs, defined as follows: ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\widetilde{z}_{k}^{\\prime}=\\frac{\\sum_{j=1}^{k}\\omega_{j}\\cdot\\widetilde{z}_{j}}{\\sum_{j=1}^{k}\\omega_{j}}.\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "Prediction Layer. To provide personalized predictive outcomes and ensure accurate representation even for users with fewer check-ins, we further introduce user embeddings $E_{u}^{U}$ and fuse it with refined output ${\\widetilde{Z}}^{\\prime}$ to form the input $\\mathcal{O}=[\\widetilde{Z}^{\\prime}||E_{u}^{U}]$ for the final fully connected layer $L=O W+b^{P}$ , where $W\\in\\mathbb{R}^{(d_{p}+d_{u})\\times|P|}$ is the weight m atrix of the fully connected layer, $b\\in\\mathbb{R}^{|P|}$ is the bias, and $L\\in\\mathbb{R}^{n\\times|P|}$ is the logit scores for $n$ steps of POI prediction. As the POI prediction is essentially a sequence classification task, we adopt the standard cross-entropy loss $\\mathcal{L}_{C E}$ as follows: ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\mathcal{L}_{C E}=-\\frac{1}{N}\\sum_{k=1}^{N}\\sum_{i=1}^{|P|}y_{i}^{k}\\log\\left(\\frac{\\exp(l_{i}^{k})}{\\sum_{j=1}^{|P|}\\exp(l_{j}^{k})}\\right),\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "where $l_{i}^{k}\\in\\mathbb{R}^{1}$ represents the logit score of the $k$ -th sample for the $i$ -th POI candidate in $P$ , and $y_{i}^{k}$ is the ground-truth indicator on POI label $i$ for the $k$ -th sample. In our implementation, we mix the $n$ steps of prediction and $B$ samples in one batch together as $N=n\\times B$ samples in total. ", "page_idx": 3}, {"type": "text", "text": "4.2 Long-Tailed Graph Adjustment ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "In the next POI prediction task, we model user-POI interactions via a User-POI Interaction Graph ${\\mathcal{G}}^{I n}$ $=(\\gamma^{I n},A^{I n})$ , where $\\gamma^{I n}=[E^{U}||E^{P}]\\in\\mathbb{R}^{(|U|+|P|)\\times d}$ is the input node feature matrix of the ${\\mathcal{G}}^{I n}$ , $d$ $=d_{p}=d_{u}$ , and $\\mathcal{A}^{I n}\\in\\mathbb{R}^{|U|\\times|P|}$ is the adjacent matrix. It\u2019s a bipartite graph where user $U$ and POI $P$ nodes connect through edges symbolizing interaction frequencies or preferences. Graph Neural Networks (GNNs) [38] can leverage graphs to learn complex node representations, but performance hinges on graph quality. However, the $\\boldsymbol{\\mathcal{G}^{I n}}$ often has long-tailed distributions\u2014most interactions are limited to few nodes with high visit frequency, which affects the quality of node embeddings and model efficacy. To tackle the long-tail problem in ${\\mathcal{G}}^{I n}$ , we propose a denoising layer to prune and reduce sparse interactions caused by the distribution. This layer evaluates edge importance, retaining only beneficial edges for learning. Initially, an attention layer weights edges according to user-POI embedding interactions, processed by a multilayer perceptron (MLP) to obtain attention scores: ", "page_idx": 4}, {"type": "equation", "text": "$$\nA_{i j}=\\sigma(W^{B}\\cdot\\mathrm{LeakyReLU}(W^{A}[E_{i}^{U}||E_{j}^{P}]+b^{A})+b^{B}).\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "Here, $\\sigma$ denotes the sigmoid function, ensuring that the attention scores $A_{i j}$ lie in the $(0,1)$ interval, $E_{i}^{U}$ and $E_{j}^{P}$ means the embedding of user and POI, $W$ represents the trainable weight matrix, and $b$ represents the bias. Based on the attention score $A_{i j}$ , the denoising process applies a thresholding operation to fliter out edges with scores below a threshold $\\delta$ , effectively reducing noise and focusing on high-quality interactions. This process aims to derive the denoised graph $\\widetilde{\\mathcal{G}}^{I n}=(\\mathcal{V}^{I n},\\widetilde{\\mathcal{A}}^{I n})$ can be formalized as: ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\widetilde{\\mathcal{A}}_{i j}^{I n}={\\mathcal{A}}_{i j}^{I n}\\cdot\\mathbf{1}[A_{i j}\\geq\\delta],\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "where $\\widetilde{A}_{i j}^{I n}$ denotes the refined edge and $\\mathbf{1}[\\cdot]$ is the indicator function. The threshold $\\delta$ controls the sparsit y of the graph, only edges with weights signifying a strong user-POI relationship are retained in ${\\widetilde{Q}}^{I n}$ . It is worth noting that when all edges fall below $\\delta$ , the edge with the highest attention score is retained to prevent isolated nodes in the graph. The model then leverages the Graph Convolutional Network (GCN) [16] layer to learn the node embedding $E^{I n}$ of the $\\widetilde{\\mathcal{G}}^{I^{n}}$ , as follows: ", "page_idx": 4}, {"type": "equation", "text": "$$\nE^{I n}=\\mathrm{LeakyReLU}\\left((D^{I n})^{-\\frac{1}{2}}\\widetilde{\\mathcal{A}}^{I n}(D^{I n})^{-\\frac{1}{2}}\\mathcal{V}^{I n}W^{I n}\\right),\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "where $D^{I n}$ is the degree matrix of the $\\widetilde{A}^{I n}$ , and $W^{I n}$ is the graph convolution weight. It is noted that here we perform a slicing op eration $E^{I n}=E^{I n}[|P|\\bar{\\ };]$ to select the node embedding representing the POI of ${\\widetilde{Q}}^{I n}$ . Beyond merely focusing on direct interactions between users and POIs, we further extend our exploration to utilize all users\u2019 check-in data to uncover global mobility patterns among POIs. We build a user-independent directed Global Transition Graph $\\mathcal{G}^{T r}=(\\mathcal{V}^{\\natural\\bar{T}^{\\sharp}},\\mathcal{A}^{T r})$ , where $\\mathcal{V}^{T r}\\in\\mathbb{R}^{|P|\\times d_{p}}$ and $\\mathcal{A}^{T r}\\,\\in\\,\\mathbb{R}^{|P|\\times|P|}$ . Here, $\\mathcal{V}^{T r}$ is equal to $E^{P}$ , and $\\boldsymbol{A}^{T r}$ stores the visit frequency between two different POIs. It is important to note that we do not perform a denoising process on the $\\mathcal{G}^{T r}$ , as it accurately reflects the mobility patterns of all users, containing a wealth of global transition information. Similarly, we employ GCN refer to Equation (8) to learn the node embedding $E^{T r}$ of the $\\mathcal{G}^{T r}$ . Finally, we perform mean pooling to combine the two node embeddings $E^{I n}$ and $E^{T r}$ , which yields the denoised POI embedding $\\widetilde{E}^{P}\\!=\\!\\,\\frac{1}{2}(E^{I n}+E^{T r})$ that incorporate comprehensive user mobility patterns from interaction and tran sition graphs. To introduce denoised embedding in our model, we refine our input embedding sequence $X$ construction process as $X=\\left[(\\widetilde{E}_{p_{1}}^{P},\\widetilde{E}_{p_{2}}^{P},...,\\widetilde{E}_{p_{n}}^{P})||(E_{t_{1}}^{T},E_{t_{2}}^{T},...,E_{t_{n}}^{T})\\right]$ . ", "page_idx": 4}, {"type": "text", "text": "4.3 Long-Tailed Loss Adjustment ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "Logit Score Adjustment. Traditional classification models often mechanically employ the softmax function for outputting predictions, which may lead to an oversight of the potential discrepancies in the posterior distributions between training and testing data. To improve model discrimination, logit adjustment has been explored, which originates in the domain of face recognition [28, 52], It involves modifying the model\u2019s output layer (i.e., logits) to encourage the generation of more compact intra-class representations while increasing the distance between classes, thereby augmenting the model\u2019s capability to handle long-tailed data. ", "page_idx": 4}, {"type": "text", "text": "To address the long-tail problem in human next POI prediction tasks, we propose the Logit Score Adjustment module. It adjusts the logits by a factor that is inversely correlated with the frequency of occurrence of each label, effectively dampening the influence of frequently occurring labels and amplifying that of rarer ones. The adjustment factor $\\alpha_{i}$ for label $i$ with frequency $f r e q$ is given by: ", "page_idx": 4}, {"type": "text", "text": "", "page_idx": 5}, {"type": "equation", "text": "$$\n\\alpha_{i}=\\tau\\left[1-\\frac{\\log(f r e q_{i}+\\epsilon)}{\\log(f r e q_{m a x}+\\epsilon)}\\right],\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "where $f r e q_{m a x}$ is the maximum label frequency observed in the dataset, $\\tau$ is the logit adjustment weight and $\\epsilon$ is a small constant to stabilize the logarithm operation. We can adjust final logits $\\widetilde{l}_{i}\\in\\mathbb{R}^{1}$ based on the logits $l_{i}\\in\\mathbb{R}^{1}$ as $\\widetilde{l}_{i}=l_{i}+\\alpha_{i}$ . ", "page_idx": 5}, {"type": "text", "text": "Sample Weight Adjustment. Based on the Equation (5), for the standard cross-entropy loss, we can find due to the nature of the softmax function, which normalizes the logits $l_{i}^{k}$ into probabilities, the model can become biased toward head classes. This imbalance means that the model\u2019s updates are predominantly driven by the head classes, as the loss from incorrectly classified examples in long-tailed classes contributes insignificantly to the overall loss. Even marginal improvements in the predictions for these long-tailed classes may contribute insignificantly to the overall loss. Therefore, it is necessary to reweight long-tailed samples, like with Focal Loss [17], which reduces the weights of well-classified samples to better focus on minority classes, but it does not explicitly consider the imbalance degree between classes in the long-tailed distribution. Unlike Focal Loss, we propose a novel Long-Tail Adjusted (LTA) loss to adaptively re-weight long-tailed samples. Specifically, for the final prediction layer, we have the hidden inputs of $N$ samples $\\bar{\\mathcal{O}}=(o^{1},o^{2},...,o^{N})$ and the weights $W=(w^{1},w^{2},...,w^{|P|})$ for $|P|$ candidates, where $o^{k}\\in\\mathbb{R}^{(d_{u}+d_{p})}$ is from the $k$ -th sample. The true class label for the $k$ -th sample is denoted by $y_{k}$ . We can take $\\boldsymbol{w}^{y_{k}}\\in\\mathbb{R}^{(d_{u}+d_{p})}$ as the class \u201ccenter\u201d for the class to which the $k$ -th sample truly belongs. Then we assess the impact posed by the $k$ -th sample to the overall prediction through the cosine similarity between ok and $w^{y_{k}}$ as follows: ", "page_idx": 5}, {"type": "equation", "text": "$$\nc o s(o^{k},w^{y_{k}})=\\frac{o^{k}\\cdot w^{y_{k}}}{\\|o^{k}\\|\\|w^{y_{k}}\\|}.\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "Based on these cosine similarities, we compute the adjusted vector magnitude $\\xi^{k}$ for each sample as: ", "page_idx": 5}, {"type": "equation", "text": "$$\n\\xi^{k}=\\left\\{1,\\ \\ \\ \\,\\begin{array}{l l}{c o s(o^{k},w^{y_{k}})\\leq0,}\\\\ {1-c o s(o^{k},w^{y_{k}}),\\ }&{c o s(o^{k},w^{y_{k}})>0.}\\end{array}\\right.\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "Then we determine the geometric mean of the vector magnitude to serve as a baseline magnitude $\\bar{\\xi}$ The traditional definition of the geometric mean of the vector magnitudes is the $N$ -th root of their product $\\bar{\\xi}=\\;\\sqrt[N]{\\xi^{1}\\xi^{2}\\cdot\\cdot\\cdot\\xi^{N}}$ . However, it can be problematic in practice due to numerical underflow or overflow when dealing with very small or very large values. To mitigate this issue, we utilize logarithm to turn the product into a sum, making the calculation more numerically stable, as follows: ", "page_idx": 5}, {"type": "equation", "text": "$$\n\\bar{\\xi}=\\exp\\left(\\frac{1}{N}\\sum_{k=1}^{N}\\log(\\xi^{k}+\\epsilon)\\right).\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "We calculate adaptive weights $\\phi^{k}$ for each sample using the deviation of vector magnitude from the geometric mean: ", "page_idx": 5}, {"type": "equation", "text": "$$\n\\phi^{k}=\\left\\{1,\\begin{array}{l l}{{\\xi^{k}-\\bar{\\xi}\\leq0,}}\\\\ {{1+\\xi^{k}-\\bar{\\xi},}}&{{\\xi^{k}-\\bar{\\xi}>0.}}\\end{array}\\right.\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "Finally, the overall Long-Tail Adjusted loss $\\mathcal{L}_{L T A}$ can be formulated as: ", "page_idx": 5}, {"type": "equation", "text": "$$\n\\mathcal{L}_{L T A}=-\\frac{1}{N}\\sum_{k=1}^{N}\\phi^{k}\\sum_{i=1}^{|P|}y_{i}^{k}\\log\\left(\\frac{\\exp(\\widetilde{l}_{i}^{k})}{\\sum_{j=1}^{|P|}\\exp(\\widetilde{l}_{j}^{k})}\\right).\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "By combining the Logit Score Adjustment and the Sample Weight Adjustment, we present a nuanced approach to recalibrating the model\u2019s focus across the spectrum of label frequencies. It ensures that each sample contributes to the model\u2019s learning process in proportion to its significance, as dictated by the distributional characteristics of the dataset and the discriminative capacity of the model. ", "page_idx": 5}, {"type": "text", "text": "4.4 Model Optimization ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "Building upon our Long-Tailed Loss Adjustment module, we further embrace auxiliary prediction tasks to optimize LoTNext. To incorporate these tasks, we define a joint loss function that combines three distinct loss components: the standard cross-entropy loss $(\\mathcal{L}_{C E})$ , the Long-Tail Adjusted Loss $(\\mathcal{L}_{L T A})$ , and the Mean Squared Error loss for auxiliary time prediction $(\\mathcal{L}_{A u x})$ . Each component serves a critical role: $\\mathcal{L}_{C E}$ ensures the fidelity of the next POI prediction, $\\mathcal{L}_{L T A}$ addresses the long-tailed data imbalance through adaptive weighting, and ${\\mathcal{L}}_{A u x}$ measures the accuracy of the timing predictions, an auxiliary task that supports the model by providing it with temporal context, thereby improving prediction accuracy and robustness, which can be denoted as: ", "page_idx": 6}, {"type": "equation", "text": "$$\n\\mathcal{L}_{A u x}=\\frac{1}{N}\\sum_{k=1}^{N}||\\hat{t}^{k}-t^{k}||^{2},\n$$", "text_format": "latex", "page_idx": 6}, {"type": "text", "text": "where $\\hat{t}^{k}$ is the forecasted time slot of $k$ -th candidate POI and $t^{k}$ is the ground truth time slot. The overall loss function is constructed as a weighted sum of these components, with the weights $\\lambda$ being learnable parameters, as follows: ", "page_idx": 6}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\mathcal{L}_{J o i n t}=\\lambda_{1}\\mathcal{L}_{C E}+\\lambda_{2}\\mathcal{L}_{L T A}+\\lambda_{3}\\mathcal{L}_{A u x}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 6}, {"type": "text", "text": "5 Experiments ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "Datasets & Baselines. We evaluate our LoTNext on two publicly available real-world LBSN datasets: Gowalla and Foursquare2 Each user check-in record includes the User ID, POI ID, latitude, longitude, and timestamp. To focus solely on the impact of long-tailed POIs and ensure the dataset\u2019s quality, we filter out inactive users with fewer than 100 check-ins. We then split each user\u2019s check-in records according to temporal order, using the first $80\\%$ for training and the remaining $20\\%$ for testing. To batch training, we uniformly segment the length of each input trajectory (e.g., 20). The specific statistical results are shown in Table 1, where we additionally calculated the percentage of POIs with a frequency smaller than 200 times and smaller than 100 times out of the total number of POIs. For instance, defining long-tailed POIs as those with a frequency of less than 100 times, approximately $98.38\\%$ of POIs could be considered long-tailed POIs. Considering both Table 1 and Table 2, the reason why the model performs about $20\\%$ points better on Foursquare compared to Gowalla is due to the more severe long-tail effect on the Gowalla dataset, along with a sparser density of the dataset. ", "page_idx": 6}, {"type": "table", "img_path": "wT2TIfHKp8/tmp/9533e2002e045d1a6b4a05b3cc7d1c1505f476a04b9c9be385d0d210b8d77b9c.jpg", "table_caption": ["Table 1: Basic dataset statistics. "], "table_footnote": [], "page_idx": 6}, {"type": "text", "text": "To demonstrate the performance of the LoTNext, we implement the following 10 state-of-the-art methods as the comparison baselines: ", "page_idx": 6}, {"type": "text", "text": "\u2022 ST-RNN [18] extends the RNN by introducing the spatial and temporal transition matrices. ", "page_idx": 6}, {"type": "text", "text": "\u2022 DeepMove [6] considers long-term and short-term interests of users by attention mechanism.   \n\u2022 LBSN2Vec [42] introduces the hypergraph and calculates the similarity of users and time embeddings to rank POIs.   \n\u2022 LightGCN [9] simplifies the structure of Graph Convolutional Network (GCN) to learn user preferences for POIs. ", "page_idx": 6}, {"type": "table", "img_path": "wT2TIfHKp8/tmp/b2eb5c6514d7f566142f35e47c41296e020801ff4bd488b4eab45c21f7db5b8c.jpg", "table_caption": ["Table 2: $\\operatorname{Acc}\\ @\\operatorname{k}$ and MRR performance comparison on Gowalla and Foursquare datasets. "], "table_footnote": [], "page_idx": 7}, {"type": "text", "text": "\u2022 LSTPM [29] proposes geo-nonlocal LSTM to further extend DeepMove structure. ", "page_idx": 7}, {"type": "text", "text": "\u2022 Flashback [43] searches the most similar hidden states in historical information based on the current context information and updates the model.   \n\u2022 STAN [23] explores the influence between non-adjacent check-in records in trajectory sequences through the attention mechanism.   \n\u2022 GETNext [45] introduces the global mobility patterns of all users into the Transformer architecture to improve model prediction effects.   \n\u2022 Graph-Flashback [27] combines Spatial-Temporal Knowledge Graph with the sequential model to enrich the representation of each POI.   \n\u2022 SNPM [46] learns the general characteristics of POIs by constructing a POI similarity graph and aggregating similar POIs. ", "page_idx": 7}, {"type": "text", "text": "Metrics. To evaluate the model performance, we utilize two of the most common metrics for the next POI prediction: Accuracy $@_{\\mathrm{k}}$ $(\\operatorname{Acc}\\!\\Theta\\mathbf{k})$ and Mean Reciprocal Rank (MRR). Acc $@_{\\mathrm{k}}$ effectively measures whether the true label is present within the top- $\\cdot\\mathbf{k}$ predicted results. Here, we consider $\\scriptstyle{\\mathrm{k}}=1$ , 5, and 10 to comprehensively assess the model\u2019s performance. MRR directly quantifies the average rank of the correct label among all predictions when the correct label is not within the top- $\\cdot\\mathbf{k}$ predictions, with higher values indicating better average prediction performance by the model. ", "page_idx": 7}, {"type": "text", "text": "Settings. We implement LoTNext using PyTorch 1.13.1 on a Linux server equipped with 384GB RAM, 10-core Intel(R) Xeon(R) Silver 4210R CPU $\\textcircled{a}\\ 2.40\\mathrm{GHz}$ , and Nvidia RTX 3090 GPUs. The embedding dimensions for POIs and users are set to 10, and the time embedding dimension is set to 6. For the Transformer architecture, we incorporate two multi-head attention mechanisms and 2 encoder blocks. For the spatial decay rate $\\beta$ , we follow the settings of Flashback [43]. ", "page_idx": 7}, {"type": "text", "text": "Overall Performance. Table 2 shows the predictive performance of all baseline methods and LoTNext on two datasets. Based on Table 2, we can draw the following conclusions: ", "page_idx": 7}, {"type": "text", "text": "\u2022 On both public datasets, LoTNext outperforms all other state-of-the-art baseline methods across all metrics. Compared to the most recent and best-performing baseline method, SNPM, LoTNext achieves more significant improvements in $\\operatorname{Acc}\\left(\\!\\omega\\!\\,1\\right)$ . These results indicate that LoTNext is better at predicting long-tailed POIs that are less popular but highly relevant to specific users. ", "page_idx": 7}, {"type": "text", "text": "\u2022 Utilizing graphs to model all user mobility patterns, thereby improving POI embeddings, representing as SNPM, Graph-Flashback, and GETNext, significantly outperform sequential methods represented by LSTPM and DeepMove, which rely solely on an individual user\u2019s short-term and long-term interests to predict the user\u2019s next location. However, the raw User-POI Interaction Graph has a large number of long-tailed nodes with a degree of 1 or very small. LoTNext, through its long-tailed graph adjustment module, effectively fliters these long-tailed nodes, thereby enhancing the model\u2019s predictive performance. ", "page_idx": 7}, {"type": "text", "text": "Performance on Long-Tailed Samples. To evaluate whether our model achieves accuracy improvement on long-tailed samples, we define samples with a frequency less than 100 on Gowalla dataset as long-tailed samples to test the model\u2019s specific predictive performance on both long-tailed and head samples. We compare LoTNext with Graph-Flashback which provides the pre-trained model for ease of comparison. As shown in Figure 3(a) and Figure 3(b), LoTNext consistently outperforms Graph-Flashback on both $\\operatorname{Acc}\\@1$ and MRR metrics, whether for head or long-tailed samples. Furthermore, Figure 3(c) reveals a notable distinction in the prediction of long-tailed POIs, LoTNext exhibits a roughly $6\\%$ higher propensity to predict long-tailed POIs compared to Graph-Flashback. This increment not only underscores the enhanced capacity of LoTNext to identify and anticipate long-tailed POIs but also demonstrates the efficacy of our methodology. ", "page_idx": 7}, {"type": "text", "text": "", "page_idx": 8}, {"type": "image", "img_path": "wT2TIfHKp8/tmp/6d2bdffb39313e46ca85733f29c6d6b22ce1050ec0b151e5c7fce60988a481ae.jpg", "img_caption": ["Figure 3: The performance comparison of the long-tailed and head POIs between LoTNext and Graph-Flashback on Gowalla dataset. "], "img_footnote": [], "page_idx": 8}, {"type": "text", "text": "Ablation Study. To analyze the impact of different modules on LoTNext, we conducted the following ablation settings: (1) without the Long-Tailed Graph Adjustment module (w/o LTGA), where we conducted with the raw graph without graph adjustment. (2) without the Long-Tailed Loss Adjustment module (w/o LTLA), meaning we only used the original cross-entropy loss for testing. (3) without the original cross-entropy loss (w/o $\\mathcal{L}_{C E}$ ), meaning we only use Long-Tailed Loss Adjustment module $\\mathcal{L}_{L T A}$ loss). (4) without the auxiliary prediction task module, we utilized the LTLA module and cross-entropy loss function, removing the auxiliary time prediction task, denoted as w/o ${\\mathcal{L}}_{A u x}$ . ", "page_idx": 8}, {"type": "table", "img_path": "wT2TIfHKp8/tmp/50f5874bf0c5ed08c2e131ca4a60e6e09568b5b54ac95781639b2b6244b8331e.jpg", "table_caption": ["Table 3: The performance comparison among the LoTNext and variants without some components. "], "table_footnote": [], "page_idx": 8}, {"type": "text", "text": "From Table 3, we have the following findings: (1) The embeddings obtained after the LTGA module contribute to the model\u2019s predictive performance. This is mainly because long-tailed POIs can be considered noise to some extent, and appropriately eliminating some noise helps with model prediction. (2) Utilizing only the original cross-entropy loss results in performance below SNPM, indicating that the strategy of considering the long-tailed distribution through the LTLA module is effective for improving model accuracy in identifying the most relevant items. (3) The results using only the $\\mathcal{L}_{L T A}$ loss show slightly higher metrics than results w/o LTLA, which suggests that the model may over-focus on long-tail data, leading to a decline in the recommendation performance for head data. For this reason, we consider incorporating the $\\mathcal{L}_{C E}$ to balance the recommendation performance between long-tail data and head data. (4) Without the time prediction task, we observe a decline in the MRR metric, suggesting that temporal features play a crucial role in helping the model capture the dynamic changes in user behavior. ", "page_idx": 8}, {"type": "text", "text": "Case Study: Learned POI Embedding. Figure 4 presents t-SNE visualizations of the embeddings for the four least frequently occurring POIs on Gowalla dataset. In Figure 4(b) representing LoTNext the embeddings of these low-frequency POIs are more distinct and well-separated, indicating that LoTNext effectively captures the unique characteristics of these tail POIs. This clear separation demonstrates that LoTNext can learn meaningful representations even for the least frequent POIs, which is crucial for accurate prediction and recommendation. In contrast, Figure 4(a) showing GraphFlashback\u2019s performance, reveals more overlapping and less distinct clusters for these low-frequency ", "page_idx": 8}, {"type": "image", "img_path": "wT2TIfHKp8/tmp/b927a7b21a1e6813a6e0b6f7508a80f5059cb2b954dadf2f242a0d23d0f21019.jpg", "img_caption": ["Figure 4: The visualization of tail POIs on Gowalla dataset. The color represents the POI frequency. "], "img_footnote": [], "page_idx": 9}, {"type": "text", "text": "POIs. This overlap suggests that Graph-Flashback struggles to differentiate between the tail POIs, potentially leading to less accurate predictions for these rarely visited locations. ", "page_idx": 9}, {"type": "text", "text": "Case Study: Prediction on Long-Tailed Sample. ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "Figure 5 provides a visual comparison of sample predictions made by the Graph-Flashback and LoTNext models on a trajectory from the Gowalla dataset for user 5. Each POI in the user\u2019s trajectory is identified by a unique ID and its visitation frequency, where the number in parentheses represents the frequency of visits. In this specific trajectory, user 5 visits a sequence of POIs. For the given POI 934, LoTNext accurately predicts the next POI to be 933, a long-tail POI with a visitation frequency of 94. In contrast, the Graph-Flashback model incorrectly predicts the next POI to be 61, a head POI with an extremely high visitation frequency of 2023. This is the same sample as the problem ", "page_idx": 9}, {"type": "image", "img_path": "wT2TIfHKp8/tmp/f78273db56621f11da31ba471372c14d3820205ea60390c5247651ed8e58dc25.jpg", "img_caption": ["Figure 5: Sample prediction from Gowalla dataset with Graph-Flashback and LoTNext. "], "img_footnote": [], "page_idx": 9}, {"type": "text", "text": "shown in Figure 1, demonstrating the efficacy of LoTNext in capturing the user\u2019s actual movement pattern, which encompasses both frequently and infrequently visited POIs. ", "page_idx": 9}, {"type": "text", "text": "6 Conclusion ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "In this work, we propose LoTNext, a novel framework for human next POI prediction under longtailed data distribution. Specifically, we employ a Long-Tailed Graph Adjustment module to mitigate the impact of long-tailed nodes within the User-POI Interaction Graph. Additionally, to balance the influence of long-tailed data in the loss, we propose the Long-Tailed Loss Adjustment module to adjust the model\u2019s predicted logits and adaptively increase the weight of long-tailed samples. Moreover, we leverage the auxiliary prediction task to achieve spatial and temporal prediction synergy. Through comparisons with 10 state-of-the-art methods, we demonstrate the superiority of LoTNext over the most advanced approaches. A limitation of our approach lies in that LoTNext\u2019s reliance on extensive user trajectory data poses a potential risk for privacy breaches if deployed by certain institutions or companies, which could lead to negative social impacts. We plan to address it in future work. ", "page_idx": 9}, {"type": "text", "text": "Acknowledgments and Disclosure of Funding ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "This work was supported by JST SPRING Grant Number JPMJSP2108, JSPS KAKENHI Grant Number JP24K02996, JST CREST Grant Number JPMJCR21M2 including AIP challenge program, and Initiative on Recommendation Program for Young Researchers and Woman Researchers, Information Technology Center, The University of Tokyo. ", "page_idx": 9}, {"type": "text", "text": "References ", "text_level": 1, "page_idx": 10}, {"type": "text", "text": "[1] Alex Beutel, Ed H Chi, Zhiyuan Cheng, Hubert Pham, and John Anderson. Beyond globally optimal: Focused learning for improved recommendations. In Proceedings of the 26th International Conference on World Wide Web, pages 203\u2013212, 2017.   \n[2] Quanjun Chen, Renhe Jiang, Chuang Yang, Zekun Cai, Zipei Fan, Kota Tsubouchi, Ryosuke Shibasaki, and Xuan Song. Dualsin: Dual sequential interaction network for human intentional mobility prediction. In Proceedings of the 28th International Conference on Advances in Geographic Information Systems, pages 283\u2013292, 2020.   \n[3] Yingxiao Du and Jianxin Wu. No one left behind: Improving the worst categories in long-tailed learning. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 15804\u2013 15813, 2023.   \n[4] Zipei Fan, Xuan Song, Tianqi Xia, Renhe Jiang, Ryosuke Shibasaki, and Ritsu Sakuramachi. Online deep ensemble learning for predicting citywide human mobility. Proceedings of the ACM on Interactive, Mobile, Wearable and Ubiquitous Technologies, 2(3):1\u201321, 2018.   \n[5] Zipei Fan, Xiaojie Yang, Wei Yuan, Renhe Jiang, Quanjun Chen, Xuan Song, and Ryosuke Shibasaki. Online trajectory prediction for metropolitan scale mobility digital twin. In Proceedings of the 30th International Conference on Advances in Geographic Information Systems, pages 1\u201312, 2022.   \n[6] Jie Feng, Yong Li, Chao Zhang, Funing Sun, Fanchao Meng, Ang Guo, and Depeng Jin. Deepmove: Predicting human mobility with attentional recurrent networks. In Proceedings of the 2018 world wide web conference, pages 1459\u20131468, 2018.   \n[7] Qiang Gao, Wei Wang, Kunpeng Zhang, Xin Yang, Congcong Miao, and Tianrui Li. Self-supervised representation learning for trip recommendation. Knowledge-Based Systems, 247:108791, 2022.   \n[8] Peng Han, Shuo Shang, Aixin Sun, Peilin Zhao, Kai Zheng, and Xiangliang Zhang. Point-of-interest recommendation with global and local context. IEEE Transactions on Knowledge and Data Engineering, 34(11):5484\u20135495, 2021.   \n[9] Xiangnan He, Kuan Deng, Xiang Wang, Yan Li, Yongdong Zhang, and Meng Wang. Lightgcn: Simplifying and powering graph convolution network for recommendation. In Proceedings of the 43rd International ACM SIGIR conference on research and development in Information Retrieval, pages 639\u2013648, 2020.   \n[10] Dou Huang, Xuan Song, Zipei Fan, Renhe Jiang, Ryosuke Shibasaki, Yu Zhang, Haizhong Wang, and Yugo Kato. A variational autoencoder based generative model of urban human mobility. In 2019 IEEE conference on multimedia information processing and retrieval (MIPR), pages 425\u2013430. IEEE, 2019.   \n[11] Renhe Jiang, Xuan Song, Zipei Fan, Tianqi Xia, Quanjun Chen, Qi Chen, and Ryosuke Shibasaki. Deep roi-based modeling for urban human mobility prediction. Proceedings of the ACM on Interactive, Mobile, Wearable and Ubiquitous Technologies, 2(1):1\u201329, 2018.   \n[12] Renhe Jiang, Xuan Song, Zipei Fan, Tianqi Xia, Quanjun Chen, Satoshi Miyazawa, and Ryosuke Shibasaki. Deepurbanmomentum: An online deep-learning system for short-term urban mobility prediction. In Proceedings of the AAAI conference on artificial intelligence, volume 32, 2018.   \n[13] Renhe Jiang, Xuan Song, Zipei Fan, Tianqi Xia, Zhaonan Wang, Quanjun Chen, Zekun Cai, and Ryosuke Shibasaki. Transfer urban human mobility via poi embedding over multiple cities. ACM Transactions on Data Science, 2(1):1\u201326, 2021.   \n[14] Renhe Jiang, Quanjun Chen, Zekun Cai, Zipei Fan, Xuan Song, Kota Tsubouchi, and Ryosuke Shibasaki. Will you go where you search? a deep learning framework for estimating user search-and-go behavior. Neurocomputing, 472:338\u2013348, 2022.   \n[15] Yejin Kim, Kwangseob Kim, Chanyoung Park, and Hwanjo Yu. Sequential and diverse recommendation with long tail. In IJCAI, volume 19, pages 2740\u20132746, 2019.   \n[16] Thomas N. Kipf and Max Welling. Semi-supervised classification with graph convolutional networks. In 5th International Conference on Learning Representations, ICLR, 2017.   \n[17] Tsung-Yi Lin, Priya Goyal, Ross Girshick, Kaiming He, and Piotr Doll\u00e1r. Focal loss for dense object detection. In Proceedings of the IEEE international conference on computer vision, pages 2980\u20132988, 2017.   \n[18] Qiang Liu, Shu Wu, Liang Wang, and Tieniu Tan. Predicting the next location: A recurrent model with spatial and temporal contexts. In Proceedings of the AAAI conference on artificial intelligence, volume 30, 2016.   \n[19] Siyi Liu and Yujia Zheng. Long-tail session-based recommendation. In Proceedings of the 14th ACM Conference on Recommender Systems, pages 509\u2013514, 2020.   \n[20] Xin Liu, Yongjian Yang, Yuanbo Xu, Funing Yang, Qiuyang Huang, and Hong Wang. Real-time poi recommendation via modeling long-and short-term user preferences. Neurocomputing, 467:454\u2013464, 2022.   \n[21] Sichun Luo, Chen Ma, Yuanzhang Xiao, and Linqi Song. Improving long-tail item recommendation with graph augmentation. In Proceedings of the 32nd ACM International Conference on Information and Knowledge Management, pages 1707\u20131716, 2023.   \n[22] Yan Luo, Haoyi Duan, Ye Liu, and Fu-Lai Chung. Timestamps as prompts for geography-aware location recommendation. In Proceedings of the 32nd ACM International Conference on Information and Knowledge Management, pages 1697\u20131706, 2023.   \n[23] Yingtao Luo, Qiang Liu, and Zhaocheng Liu. Stan: Spatio-temporal attention network for next location recommendation. In Proceedings of the web conference 2021, pages 2177\u20132185, 2021.   \n[24] Aditya Krishna Menon, Sadeep Jayasumana, Ankit Singh Rawat, Himanshu Jain, Andreas Veit, and Sanjiv Kumar. Long-tail learning via logit adjustment. In 9th International Conference on Learning Representations, 2021.   \n[25] Foster Provost. Machine learning from imbalanced data sets 101. In Proceedings of the AAAI Workshop Imbalanced Data Sets, pages 1\u20133, 2000.   \n[26] Yifang Qin, Hongjun Wu, Wei Ju, Xiao Luo, and Ming Zhang. A diffusion model for poi recommendation. ACM Transactions on Information Systems, 42(2):1\u201327, 2023.   \n[27] Xuan Rao, Lisi Chen, Yong Liu, Shuo Shang, Bin Yao, and Peng Han. Graph-flashback network for next location recommendation. In Proceedings of the 28th ACM SIGKDD Conference on Knowledge Discovery and Data Mining, pages 1463\u20131471, 2022.   \n[28] Jiawei Ren, Cunjun Yu, Xiao Ma, Haiyu Zhao, Shuai Yi, et al. Balanced meta-softmax for long-tailed visual recognition. Advances in neural information processing systems, 33:4175\u20134186, 2020.   \n[29] Ke Sun, Tieyun Qian, Tong Chen, Yile Liang, Quoc Viet Hung Nguyen, and Hongzhi Yin. Where to go next: Modeling long-and short-term user preferences for point-of-interest recommendation. In Proceedings of the AAAI Conference on Artificial Intelligence, volume 34, pages 214\u2013221, 2020.   \n[30] Yingfan Tao, Jingna Sun, Hao Yang, Li Chen, Xu Wang, Wenming Yang, Daniel Du, and Min Zheng. Local and global logit adjustments for long-tailed learning. In Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 11783\u201311792, 2023.   \n[31] Junjiao Tian, Yen-Cheng Liu, Nathaniel Glaser, Yen-Chang Hsu, and Zsolt Kira. Posterior re-calibration for imbalanced datasets. Advances in Neural Information Processing Systems, 33:8101\u20138113, 2020.   \n[32] Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N Gomez, \u0141ukasz Kaiser, and Illia Polosukhin. Attention is all you need. Advances in neural information processing systems, 30, 2017.   \n[33] Jiawei Wang, Renhe Jiang, Chuang Yang, Zengqing Wu, Makoto Onizuka, Ryosuke Shibasaki, and Chuan Xiao. Large language models as urban residents: An llm agent framework for personal mobility generation. arXiv preprint arXiv:2402.14744, 2024.   \n[34] Xinfeng Wang, Fumiyo Fukumoto, Jin Cui, Yoshimi Suzuki, Jiyi Li, and Dongjin Yu. Eedn: Enhanced encoder-decoder network with local and global context learning for poi recommendation. In Proceedings of the 46th International ACM SIGIR Conference on Research and Development in Information Retrieval, pages 383\u2013392, 2023.   \n[35] Zhaobo Wang, Yanmin Zhu, Chunyang Wang, Wenze Ma, Bo Li, and Jiadi Yu. Adaptive graph representation learning for next poi recommendation. In Proceedings of the 46th International ACM SIGIR Conference on Research and Development in Information Retrieval, pages 393\u2013402, 2023.   \n[36] Chunyu Wei, Jian Liang, Di Liu, Zehui Dai, Mang Li, and Fei Wang. Meta graph learning for long-tail recommendation. In Proceedings of the 29th ACM SIGKDD Conference on Knowledge Discovery and Data Mining, pages 2512\u20132522, 2023.   \n[37] Yuxia Wu, Ke Li, Guoshuai Zhao, and Xueming Qian. Personalized long-and short-term preference learning for next poi recommendation. IEEE Transactions on Knowledge and Data Engineering, 34(4): 1944\u20131957, 2020.   \n[38] Zonghan Wu, Shirui Pan, Fengwen Chen, Guodong Long, Chengqi Zhang, and S Yu Philip. A comprehensive survey on graph neural networks. IEEE transactions on neural networks and learning systems, 32(1): 4\u201324, 2020.   \n[39] Xiaohang Xu, Toyotaro Suzumura, Jiawei Yong, Masatoshi Hanai, Chuang Yang, Hiroki Kanezashi, Renhe Jiang, and Shintaro Fukushima. Revisiting mobility modeling with graph: A graph transformer model for next point-of-interest recommendation. In Proceedings of the 31st ACM International Conference on Advances in Geographic Information Systems, pages 1\u201310, 2023.   \n[40] Hao Xue, Flora Salim, Yongli Ren, and Nuria Oliver. Mobtcast: Leveraging auxiliary trajectory forecasting for human mobility prediction. Advances in Neural Information Processing Systems, 34:30380\u201330391, 2021.   \n[41] Xiaodong Yan, Tengwei Song, Yifeng Jiao, Jianshan He, Jiaotuan Wang, Ruopeng Li, and Wei Chu. Spatiotemporal hypergraph learning for next poi recommendation. In Proceedings of the 46th international ACM SIGIR conference on research and development in information retrieval, pages 403\u2013412, 2023.   \n[42] Dingqi Yang, Bingqing Qu, Jie Yang, and Philippe Cudre-Mauroux. Revisiting user mobility and social relationships in lbsns: a hypergraph embedding approach. In The world wide web conference, pages 2147\u20132157, 2019.   \n[43] Dingqi Yang, Benjamin Fankhauser, Paolo Rosso, and Philippe Cudre-Mauroux. Location prediction over sparse user mobility traces using rnns. In Proceedings of the Twenty-Ninth International Joint Conference on Artificial Intelligence, pages 2184\u20132190, 2020.   \n[44] Lu Yang, He Jiang, Qing Song, and Jun Guo. A survey on long-tailed visual recognition. International Journal of Computer Vision, 130(7):1837\u20131872, 2022.   \n[45] Song Yang, Jiamou Liu, and Kaiqi Zhao. Getnext: trajectory flow map enhanced transformer for next poi recommendation. In Proceedings of the 45th International ACM SIGIR Conference on research and development in information retrieval, pages 1144\u20131153, 2022.   \n[46] Feiyu Yin, Yong Liu, Zhiqi Shen, Lisi Chen, Shuo Shang, and Peng Han. Next poi recommendation with dynamic graph and explicit dependency. In Proceedings of the AAAI Conference on Artificial Intelligence, volume 37, pages 4827\u20134834, 2023.   \n[47] Hongzhi Yin, Bin Cui, Jing Li, Junjie Yao, and Chen Chen. Challenging the long tail recommendation. Proc. VLDB Endow., 5(9):896\u2013907, 2012.   \n[48] Fuqiang Yu, Lizhen Cui, Wei Guo, Xudong Lu, Qingzhong Li, and Hua Lu. A category-aware deep model for successive poi recommendation on sparse check-in data. In Proceedings of the web conference 2020, pages 1264\u20131274, 2020.   \n[49] Lu Zhang, Zhu Sun, Jie Zhang, Horst Kloeden, and Felix Klanner. Modeling hierarchical category transition for next poi recommendation with uncertain check-ins. Information Sciences, 515:169\u2013190, 2020.   \n[50] Yifan Zhang, Bingyi Kang, Bryan Hooi, Shuicheng Yan, and Jiashi Feng. Deep long-tailed learning: A survey. IEEE Transactions on Pattern Analysis and Machine Intelligence, 2023.   \n[51] Yin Zhang, Derek Zhiyuan Cheng, Tiansheng Yao, Xinyang Yi, Lichan Hong, and Ed H Chi. A model of two tales: Dual transfer learning framework for improved long-tail item recommendation. In Proceedings of the web conference 2021, pages 2220\u20132231, 2021.   \n[52] Yan Zhao, Weicong Chen, Xu Tan, Kai Huang, and Jihong Zhu. Adaptive logit adjustment loss for long-tailed visual recognition. In Proceedings of the AAAI Conference on Artificial Intelligence, volume 36, pages 3472\u20133480, 2022.   \n[53] Yuanshao Zhu, Yongchao Ye, Shiyao Zhang, Xiangyu Zhao, and James Yu. Difftraj: Generating gps trajectory with diffusion probabilistic model. Advances in Neural Information Processing Systems, 36: 65168\u201365188, 2023. ", "page_idx": 10}, {"type": "text", "text": "", "page_idx": 11}, {"type": "text", "text": "", "page_idx": 12}, {"type": "text", "text": "A Appendix / supplemental material ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "A.1 Notations ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "The notations used in our paper are summarized as follows. ", "page_idx": 13}, {"type": "table", "img_path": "wT2TIfHKp8/tmp/843cdbdde4a4e3126a59285e1a4b7a6f276a6d56e9838df8d990b4d79c0bab40.jpg", "table_caption": ["Table 4: Notation Table. "], "table_footnote": [], "page_idx": 13}, {"type": "text", "text": "A.2 Computational Cost ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "In this section, we explore the computational cost of LoTNext. We selected three sequence-based and three graph-based baselines to demonstrate the computational efficiency of our approach. Table 5 lists the inference time for each deep learning model during the testing phase (running one training/testing instance, i.e., test time divided by batch size). We ensured that all models were executed on the same RTX 3090 GPU. Surprisingly, due to batch training, the graph-based methods generally run significantly faster than the sequence-based methods. DeepMove is the fastest among the sequencebased methods, as it only considers calculating attention using historical trajectories. Compared to DeepMove, LSTPM further introduces a geographical relationship adjacency matrix to enrich the spatial context, making it slightly slower than DeepMove. STAN employs a dual-layer attention architecture, with one attention layer aggregating spatiotemporal correlations within user trajectories and the other selecting the most likely next POI based on weighted check-ins, resulting in the longest inference time for STAN. ", "page_idx": 13}, {"type": "text", "text": "", "page_idx": 14}, {"type": "table", "img_path": "wT2TIfHKp8/tmp/a84e2eea991933860ebe72a678684c64ab192ee98639c23e94f8003922642475.jpg", "table_caption": ["Table 5: Comparison of computational cost. Each method is benchmarked on the same NVIDIA GeForce RTX 3090 GPU. "], "table_footnote": [], "page_idx": 14}, {"type": "text", "text": "In the graph-based methods, GETNext introduces additional computational overhead due to the need for extra POI candidate probability reorganization based on transition attention during the final prediction stage. SNPM requires extra computation time due to the search for similar neighborhoods within the graph. As for our LoTNext, it requires more time to run compared to Graph-Flashback because LoTNext includes graph denoising and an auxiliary temporal prediction task. However, Table 2 and Table 3 demonstrate the effectiveness of our proposed modules, even at the cost of some computational time. Thus, considering that LoTNext encompasses more processing steps and overall accuracy, the increase in inference time is still acceptable. ", "page_idx": 14}, {"type": "text", "text": "A.3 Hyperparameter Analysis ", "text_level": 1, "page_idx": 14}, {"type": "image", "img_path": "wT2TIfHKp8/tmp/ed2feb67e6c46d8b612ae715b4baca340af2c91af3c5afc19af0ccde6a2a42a7.jpg", "img_caption": ["Figure 6: Impact of denoising thresholds $\\delta$ and logit adjustment weight $\\tau$ "], "img_footnote": [], "page_idx": 14}, {"type": "text", "text": "(a) The impact of parame- (b) The impact of parame-(c) The impact of pa- (d) The impact of pater $\\delta$ on Gowalla dataset. ter $\\tau$ on Gowalla dataset. rameter $\\delta$ on Foursquare rameter $\\tau$ on Foursquare dataset. dataset. ", "page_idx": 14}, {"type": "text", "text": "We conduct hyperparameter sensitivity experiments on the Long-Tailed Graph Adjustment module\u2019s threshold $\\delta$ and the weight $\\tau$ of the logit adjustment module to identify the optimal parameter values on Gowalla and Foursquare datasets. We first experiment with a range of thresholds $\\delta$ from 0.1 to 0.9 in increments of 0.2, which controls the sensitivity of the model to the long-tailed distribution by filtering less significant edges in the graph. The results, shown in Figure 6(a) for Gowalla and Figure 6(c) for Foursquare, indicate that $\\operatorname{Acc}\\left(\\!\\omega\\!\\,1\\right)$ and MRR remain stable across different values, with the optimal threshold identified as $\\delta=0.5$ . Next, we vary the logit adjustment weight $\\tau$ from 1 to 2 in increments of 0.2 to test the model\u2019s performance in balancing class imbalances. Figure 6(b) and Figure 6(d) reveal that $\\tau=1.2$ yields the best results on both datasets, suggesting a moderate adjustment weight helps generalize better without overly amplifying rare classes. These consistent findings across both datasets underscore the robustness of $\\delta=0.5$ and $\\tau=1.2$ , highlighting the importance of hyperparameter tuning in improving model accuracy and ranking metrics for better prediction of user behavior in diverse datasets. ", "page_idx": 14}, {"type": "text", "text": "A.4 Model Training Pseudo-code ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "Algorithm 1 shows the pseudo-code of the LoTNext training process. In our experiments, all training instances are processed through mini-batches. ", "page_idx": 15}, {"type": "text", "text": "Algorithm 1 Pseudo-code of training LoTNext   \n1: Input: User set $U$ , POI set $P$ , user check-in sequences $Q_{u}$ for each user $u\\in U$   \n2: Output: Trained model parameters $\\gamma$   \n3: $\\gamma\\leftarrow$ Initialize randomly   \n4: while not converge do   \n5: Construct graph $G^{I n}$ and $G^{T r}$ , apply denoising, and learn node embeddings $E^{I n}$ and $E^{T r}$ by Eqs.   \n(8)-(11) $\\triangleright$ Graph Adjustment   \n6: Compute denoised POI embedding $\\tilde{E}^{P}$ by Eq. (12) \u25b7Embedding Denoising   \n7: Calculate time and user embeddings $E^{T},\\dot{E}^{U}$ , and construct embedding sequence $X$ by Eq. (1) \u25b7   \nEmbedding Initialization   \n8: Transform input $\\tilde{X}$ by Eq. (1) $\\triangleright$ Positional Encoding   \n9: Calculate Transformer encoder output $\\tilde{Z}$ by Eq. (2) \u25b7Transformer Encoder   \n10: for each POI $p_{k}$ in sequence do   \n11: Calculate spatial weight $\\omega_{k}$ by Eq. (4) $\\triangleright$ Spatial Weight Calculation   \n12: Refine output $\\tilde{z}_{k}$ by Eq. (5) $\\triangleright$ Output Refinement   \n13: end for   \n14: Calculate fused output $O$ and logits $L$ by Eq. (6) \u25b7Prediction Layer   \n15: Compute cross-entropy loss $L_{C E}$ by Eq. (7) \u25b7Loss Calculation   \n16: Adjust logits using $\\alpha_{i}$ and recompute logits $\\tilde{l}_{i}$ by Eqs. (13)-(14) \u25b7Logit Adjustment   \n17: Calculate adaptive weights $\\phi^{k}$ and overall loss $L_{L T A}$ by Eqs. (19)-(20) \u25b7Loss Adjustment   \n18: Compute auxiliary loss $L_{A u x}$ by Eq. (21) \u25b7Auxiliary Loss   \n19: Update parameters $\\gamma$ by minimizing joint loss $L_{J o i n t}$ by Eq. (22) \u25b7Parameter Update   \n20: end while   \n21: return $\\gamma$ ", "page_idx": 15}, {"type": "text", "text": "NeurIPS Paper Checklist ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "1. Claims ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "Question: Do the main claims made in the abstract and introduction accurately reflect the paper\u2019s contributions and scope? ", "page_idx": 16}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 16}, {"type": "text", "text": "Justification: The abstract and introduction effectively summarize the paper\u2019s main contributions and the scope of the study, which focus on improving POI prediction through the proposed LoTNext method. This method addresses challenges related to the long-tailed distribution of location visitations. The main claims include the development of the LongTailed Graph Adjustment module and the Long-Tailed Loss Adjustment module, along with the incorporation of auxiliary prediction tasks to enhance model generalization and accuracy. These elements are precisely reflected in the detailed methodology and results sections of the paper, where the effectiveness of LoTNext is demonstrated on real-world datasets, significantly outperforming existing methods. Thus, the abstract and introduction provide a clear and accurate preview of the paper\u2019s technical content and its contributions to the field. ", "page_idx": 16}, {"type": "text", "text": "Guidelines: ", "page_idx": 16}, {"type": "text", "text": "\u2022 The answer NA means that the abstract and introduction do not include the claims made in the paper.   \n\u2022 The abstract and/or introduction should clearly state the claims made, including the contributions made in the paper and important assumptions and limitations. A No or NA answer to this question will not be perceived well by the reviewers.   \n\u2022 The claims made should match theoretical and experimental results, and reflect how much the results can be expected to generalize to other settings.   \n\u2022 It is fine to include aspirational goals as motivation as long as it is clear that these goals are not attained by the paper. ", "page_idx": 16}, {"type": "text", "text": "2. Limitations ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "Question: Does the paper discuss the limitations of the work performed by the authors? ", "page_idx": 16}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "Justification: The paper explicitly discusses the limitations of the proposed method, LoTNext. It acknowledges that the model does not account for emergent events such as vehicle accidents and extreme weather conditions, which are typical examples of long-tail data that can affect human mobility and, consequently, the model\u2019s robustness. Additionally, the paper highlights the privacy concerns associated with the extensive use of user trajectory data, acknowledging the potential risks if the model is deployed by certain entities. This discussion in the paper ensures that readers are fully aware of the conditions under which the model was tested and its potential limitations in real-world scenarios. ", "page_idx": 16}, {"type": "text", "text": "Guidelines: ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "\u2022 The answer NA means that the paper has no limitation while the answer No means that the paper has limitations, but those are not discussed in the paper.   \n\u2022 The authors are encouraged to create a separate \"Limitations\" section in their paper.   \n\u2022 The paper should point out any strong assumptions and how robust the results are to violations of these assumptions (e.g., independence assumptions, noiseless settings, model well-specification, asymptotic approximations only holding locally). The authors should reflect on how these assumptions might be violated in practice and what the implications would be.   \n\u2022 The authors should reflect on the scope of the claims made, e.g., if the approach was only tested on a few datasets or with a few runs. In general, empirical results often depend on implicit assumptions, which should be articulated.   \n\u2022 The authors should reflect on the factors that influence the performance of the approach. For example, a facial recognition algorithm may perform poorly when image resolution is low or images are taken in low lighting. Or a speech-to-text system might not be used reliably to provide closed captions for online lectures because it fails to handle technical jargon.   \n\u2022 The authors should discuss the computational efficiency of the proposed algorithms and how they scale with dataset size.   \n\u2022 If applicable, the authors should discuss possible limitations of their approach to address problems of privacy and fairness.   \n\u2022 While the authors might fear that complete honesty about limitations might be used by reviewers as grounds for rejection, a worse outcome might be that reviewers discover limitations that aren\u2019t acknowledged in the paper. The authors should use their best judgment and recognize that individual actions in favor of transparency play an important role in developing norms that preserve the integrity of the community. Reviewers will be specifically instructed to not penalize honesty concerning limitations. ", "page_idx": 16}, {"type": "text", "text": "", "page_idx": 17}, {"type": "text", "text": "3. Theory Assumptions and Proofs ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "Question: For each theoretical result, does the paper provide the full set of assumptions and a complete (and correct) proof? ", "page_idx": 17}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 17}, {"type": "text", "text": "Justification: The paper does not include theoretical results or formal proofs as it primarily focuses on the application of deep learning techniques to the problem of the next POI prediction. The mathematical formulations presented within the paper represent specific operational processes within the deep learning model rather than propositions requiring formal proofs. These formulations are used to describe the architecture and function of the proposed LoTNext method, including its components like the Long-Tailed Graph Adjustment module and the Long-Tailed Loss Adjustment module. Since the paper\u2019s contributions are empirical and methodological rather than theoretical, it does not involve the derivation of theorems or the necessity of providing rigorous proofs. ", "page_idx": 17}, {"type": "text", "text": "Guidelines: ", "page_idx": 17}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include theoretical results.   \n\u2022 All the theorems, formulas, and proofs in the paper should be numbered and crossreferenced.   \n\u2022 All assumptions should be clearly stated or referenced in the statement of any theorems.   \n\u2022 The proofs can either appear in the main paper or the supplemental material, but if they appear in the supplemental material, the authors are encouraged to provide a short proof sketch to provide intuition.   \n\u2022 Inversely, any informal proof provided in the core of the paper should be complemented by formal proofs provided in appendix or supplemental material.   \n\u2022 Theorems and Lemmas that the proof relies upon should be properly referenced. ", "page_idx": 17}, {"type": "text", "text": "4. Experimental Result Reproducibility ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "Question: Does the paper fully disclose all the information needed to reproduce the main experimental results of the paper to the extent that it affects the main claims and/or conclusions of the paper (regardless of whether the code and data are provided or not)? ", "page_idx": 17}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "Justification: The paper provides the detailed information required for the reproducibility of the main experimental results. It describes the datasets used, namely the Gowalla and Foursquare datasets, including the criteria for data filtering and splitting for training and testing purposes. It also specifies the baselines against which the proposed LoTNext method is compared, encompassing a comprehensive list of state-of-the-art methods. Furthermore, the paper outlines the evaluation metrics used, such as Accuracy $@_{\\mathrm{k}}$ and Mean Reciprocal Rank (MRR), and explains their significance in the context of the next POI prediction. Additionally, detailed descriptions of the experimental settings, including hardware specifications and software versions, are provided. This level of detail in the experimental setup, methodology, and evaluation ensures that other researchers can replicate the study and verify the claims made about the performance of the LoTNext method. The disclosure of this information supports the reproducibility of the research, adhering to the standards required for scientific verification and validation. ", "page_idx": 17}, {"type": "text", "text": "Guidelines: ", "page_idx": 17}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments. ", "page_idx": 17}, {"type": "text", "text": "\u2022 If the paper includes experiments, a No answer to this question will not be perceived well by the reviewers: Making the paper reproducible is important, regardless of whether the code and data are provided or not.   \n\u2022 If the contribution is a dataset and/or model, the authors should describe the steps taken to make their results reproducible or verifiable.   \n\u2022 Depending on the contribution, reproducibility can be accomplished in various ways. For example, if the contribution is a novel architecture, describing the architecture fully might suffice, or if the contribution is a specific model and empirical evaluation, it may be necessary to either make it possible for others to replicate the model with the same dataset, or provide access to the model. In general. releasing code and data is often one good way to accomplish this, but reproducibility can also be provided via detailed instructions for how to replicate the results, access to a hosted model (e.g., in the case of a large language model), releasing of a model checkpoint, or other means that are appropriate to the research performed.   \n\u2022 While NeurIPS does not require releasing code, the conference does require all submissions to provide some reasonable avenue for reproducibility, which may depend on the nature of the contribution. For example (a) If the contribution is primarily a new algorithm, the paper should make it clear how to reproduce that algorithm.   \n(b) If the contribution is primarily a new model architecture, the paper should describe the architecture clearly and fully. (c) If the contribution is a new model (e.g., a large language model), then there should either be a way to access this model for reproducing the results or a way to reproduce the model (e.g., with an open-source dataset or instructions for how to construct the dataset).   \n(d) We recognize that reproducibility may be tricky in some cases, in which case authors are welcome to describe the particular way they provide for reproducibility. In the case of closed-source models, it may be that access to the model is limited in some way (e.g., to registered users), but it should be possible for other researchers to have some path to reproducing or verifying the results. ", "page_idx": 18}, {"type": "text", "text": "5. Open access to data and code ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Question: Does the paper provide open access to the data and code, with sufficient instructions to faithfully reproduce the main experimental results, as described in supplemental material? ", "page_idx": 18}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Justification: The paper grants open access to both the code and data necessary for reproducing the main experimental results, as stated in the abstract and introduction sections. The code for the proposed LoTNext method is available at a specified URL, hosted on a public repository which maintains anonymity as per submission guidelines. This repository includes detailed instructions on setting up the environment, executing the code, and reproducing the experiments conducted with the LoTNext method. Additionally, the datasets used, Gowalla and Foursquare, are publicly available and well-documented, allowing researchers to access and use them for replication purposes. Instructions for data preprocessing and setup are clearly provided, ensuring that other researchers can faithfully replicate the study\u2019s findings. This comprehensive provision of resources supports the transparency and reproducibility of the research, aligning with the conference\u2019s guidelines for open access to data and code. ", "page_idx": 18}, {"type": "text", "text": "Guidelines: ", "page_idx": 18}, {"type": "text", "text": "\u2022 The answer NA means that paper does not include experiments requiring code.   \n\u2022 Please see the NeurIPS code and data submission guidelines (https://nips.cc/ public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 While we encourage the release of code and data, we understand that this might not be possible, so \u201cNo\u201d is an acceptable answer. Papers cannot be rejected simply for not including code, unless this is central to the contribution (e.g., for a new open-source benchmark).   \n\u2022 The instructions should contain the exact command and environment needed to run to reproduce the results. See the NeurIPS code and data submission guidelines (https: //nips.cc/public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 The authors should provide instructions on data access and preparation, including how to access the raw data, preprocessed data, intermediate data, and generated data, etc.   \n\u2022 The authors should provide scripts to reproduce all experimental results for the new proposed method and baselines. If only a subset of experiments are reproducible, they should state which ones are omitted from the script and why.   \n\u2022 At submission time, to preserve anonymity, the authors should release anonymized versions (if applicable).   \n\u2022 Providing as much information as possible in supplemental material (appended to the paper) is recommended, but including URLs to data and code is permitted. ", "page_idx": 18}, {"type": "text", "text": "", "page_idx": 19}, {"type": "text", "text": "6. Experimental Setting/Details ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "Question: Does the paper specify all the training and test details (e.g., data splits, hyperparameters, how they were chosen, type of optimizer, etc.) necessary to understand the results? ", "page_idx": 19}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 19}, {"type": "text", "text": "Justification: The paper provides comprehensive details about the experimental setup necessary to understand and reproduce the results. It specifies the data splits used for training and testing, with $80\\%$ of the data used for training and the remaining $20\\%$ for testing. The paper also describes the hyperparameters employed, including the dimensions for user and POI embeddings, and the configuration of the Transformer architecture used in the model. ", "page_idx": 19}, {"type": "text", "text": "Guidelines: ", "page_idx": 19}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments. \u2022 The experimental setting should be presented in the core of the paper to a level of detail that is necessary to appreciate the results and make sense of them. \u2022 The full details can be provided either with the code, in appendix, or as supplemental material. ", "page_idx": 19}, {"type": "text", "text": "7. Experiment Statistical Significance ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "Question: Does the paper report error bars suitably and correctly defined or other appropriate information about the statistical significance of the experiments? ", "page_idx": 19}, {"type": "text", "text": "Answer: [No] ", "page_idx": 19}, {"type": "text", "text": "Justification: To ensure the reproducibility of our experimental results, we fixed the random seed during the data splitting and model execution phases. As a result, we did not report statistical significance measures such as error bars, confidence intervals, or statistical significance tests. ", "page_idx": 19}, {"type": "text", "text": "Guidelines: ", "page_idx": 19}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The authors should answer \"Yes\" if the results are accompanied by error bars, confidence intervals, or statistical significance tests, at least for the experiments that support the main claims of the paper.   \n\u2022 The factors of variability that the error bars are capturing should be clearly stated (for example, train/test split, initialization, random drawing of some parameter, or overall run with given experimental conditions).   \n\u2022 The method for calculating the error bars should be explained (closed form formula, call to a library function, bootstrap, etc.)   \n\u2022 The assumptions made should be given (e.g., Normally distributed errors).   \n\u2022 It should be clear whether the error bar is the standard deviation or the standard error of the mean.   \n\u2022 It is OK to report 1-sigma error bars, but one should state it. The authors should preferably report a 2-sigma error bar than state that they have a $96\\%$ CI, if the hypothesis of Normality of errors is not verified. ", "page_idx": 19}, {"type": "text", "text": "\u2022 For asymmetric distributions, the authors should be careful not to show in tables or figures symmetric error bars that would yield results that are out of range (e.g. negative error rates). \u2022 If error bars are reported in tables or plots, The authors should explain in the text how they were calculated and reference the corresponding figures or tables in the text. ", "page_idx": 20}, {"type": "text", "text": "8. Experiments Compute Resources ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Question: For each experiment, does the paper provide sufficient information on the computer resources (type of compute workers, memory, time of execution) needed to reproduce the experiments? ", "page_idx": 20}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 20}, {"type": "text", "text": "Justification: The paper provides detailed information in Section 5 about the compute resources used for the experiments, including the type of compute workers (Linux server with Intel Xeon Silver 4210R CPU and Nvidia RTX 3090 GPUs), memory (384GB RAM), and the software environment (PyTorch 1.13.1). The specifications for the embedding dimensions, the Transformer architecture, and the spatial decay rate are also clearly described, ensuring that the experiments can be accurately reproduced. ", "page_idx": 20}, {"type": "text", "text": "Guidelines: ", "page_idx": 20}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The paper should indicate the type of compute workers CPU or GPU, internal cluster, or cloud provider, including relevant memory and storage.   \n\u2022 The paper should provide the amount of compute required for each of the individual experimental runs as well as estimate the total compute.   \n\u2022 The paper should disclose whether the full research project required more compute than the experiments reported in the paper (e.g., preliminary or failed experiments that didn\u2019t make it into the paper). ", "page_idx": 20}, {"type": "text", "text": "9. Code Of Ethics ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Question: Does the research conducted in the paper conform, in every respect, with the NeurIPS Code of Ethics https://neurips.cc/public/EthicsGuidelines? ", "page_idx": 20}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Justification: We read the NeurIPS Code of Ethics carefully and ensure we follow all the requirements. ", "page_idx": 20}, {"type": "text", "text": "Guidelines: ", "page_idx": 20}, {"type": "text", "text": "\u2022 The answer NA means that the authors have not reviewed the NeurIPS Code of Ethics.   \n\u2022 If the authors answer No, they should explain the special circumstances that require a deviation from the Code of Ethics.   \n\u2022 The authors should make sure to preserve anonymity (e.g., if there is a special consideration due to laws or regulations in their jurisdiction). ", "page_idx": 20}, {"type": "text", "text": "10. Broader Impacts ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Question: Does the paper discuss both potential positive societal impacts and negative societal impacts of the work performed? ", "page_idx": 20}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Justification: The paper addresses both the potential positive and negative societal impacts of the proposed LoTNext method. On the positive side, the method aims to enhance personalized navigation, optimize recommendation systems, and facilitate urban mobility and planning. These improvements could significantly enhance the quality of life for city residents by making navigation and planning more efficient and tailored to individual needs. On the negative side, the paper acknowledges specific risks associated with the deployment of LoTNext, particularly concerning privacy. The reliance on extensive user trajectory data could potentially lead to privacy breaches if the model is employed by institutions or companies without stringent data protection measures. This could have adverse social impacts, such as unauthorized surveillance or misuse of personal data. The paper\u2019s discussion of these potential harms demonstrates an awareness of the broader implications of deploying such technology in real-world settings. By addressing both the potential benefits and risks, the paper provides a balanced view of its societal impact, complying with ethical standards for transparency and responsibility in AI research. This acknowledgment of both positive and negative impacts ensures that readers and potential users are well-informed about the capabilities and limitations of the proposed method. ", "page_idx": 20}, {"type": "text", "text": "", "page_idx": 21}, {"type": "text", "text": "Guidelines: ", "page_idx": 21}, {"type": "text", "text": "\u2022 The answer NA means that there is no societal impact of the work performed.   \n\u2022 If the authors answer NA or No, they should explain why their work has no societal impact or why the paper does not address societal impact.   \n\u2022 Examples of negative societal impacts include potential malicious or unintended uses (e.g., disinformation, generating fake profiles, surveillance), fairness considerations (e.g., deployment of technologies that could make decisions that unfairly impact specific groups), privacy considerations, and security considerations.   \n\u2022 The conference expects that many papers will be foundational research and not tied to particular applications, let alone deployments. However, if there is a direct path to any negative applications, the authors should point it out. For example, it is legitimate to point out that an improvement in the quality of generative models could be used to generate deepfakes for disinformation. On the other hand, it is not needed to point out that a generic algorithm for optimizing neural networks could enable people to train models that generate Deepfakes faster.   \n\u2022 The authors should consider possible harms that could arise when the technology is being used as intended and functioning correctly, harms that could arise when the technology is being used as intended but gives incorrect results, and harms following from (intentional or unintentional) misuse of the technology.   \n\u2022 If there are negative societal impacts, the authors could also discuss possible mitigation strategies (e.g., gated release of models, providing defenses in addition to attacks, mechanisms for monitoring misuse, mechanisms to monitor how a system learns from feedback over time, improving the efficiency and accessibility of ML). ", "page_idx": 21}, {"type": "text", "text": "11. Safeguards ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "Question: Does the paper describe safeguards that have been put in place for responsible release of data or models that have a high risk for misuse (e.g., pretrained language models, image generators, or scraped datasets)? ", "page_idx": 21}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 21}, {"type": "text", "text": "Justification: Our paper poses no such risks. We did not use any pre-trained models, and all datasets are sourced from publicly available data, which are commonly used in related work. Guidelines: ", "page_idx": 21}, {"type": "text", "text": "\u2022 The answer NA means that the paper poses no such risks.   \n\u2022 Released models that have a high risk for misuse or dual-use should be released with necessary safeguards to allow for controlled use of the model, for example by requiring that users adhere to usage guidelines or restrictions to access the model or implementing safety filters.   \n\u2022 Datasets that have been scraped from the Internet could pose safety risks. The authors should describe how they avoided releasing unsafe images.   \n\u2022 We recognize that providing effective safeguards is challenging, and many papers do not require this, but we encourage authors to take this into account and make a best faith effort. ", "page_idx": 21}, {"type": "text", "text": "12. Licenses for existing assets ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "Question: Are the creators or original owners of assets (e.g., code, data, models), used in the paper, properly credited and are the license and terms of use explicitly mentioned and properly respected? ", "page_idx": 21}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 21}, {"type": "text", "text": "Justification: We have properly credited the creators and original owners of all assets used in the paper, including code, data, and models. The sources and relevant citations are clearly indicated in the paper. Additionally, the licenses and terms of use for these assets have been explicitly mentioned and properly respected. We have used publicly available datasets, citing the original papers that produced them, and included the specific versions and URLs where applicable. The licenses, such as CC-BY 4.0, have been noted, ensuring compliance with the terms of use. ", "page_idx": 21}, {"type": "text", "text": "", "page_idx": 22}, {"type": "text", "text": "Guidelines: ", "page_idx": 22}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not use existing assets.   \n\u2022 The authors should cite the original paper that produced the code package or dataset.   \n\u2022 The authors should state which version of the asset is used and, if possible, include a URL.   \n\u2022 The name of the license (e.g., CC-BY 4.0) should be included for each asset.   \n\u2022 For scraped data from a particular source (e.g., website), the copyright and terms of service of that source should be provided.   \n\u2022 If assets are released, the license, copyright information, and terms of use in the package should be provided. For popular datasets, paperswithcode.com/datasets has curated licenses for some datasets. Their licensing guide can help determine the license of a dataset.   \n\u2022 For existing datasets that are re-packaged, both the original license and the license of the derived asset (if it has changed) should be provided.   \n\u2022 If this information is not available online, the authors are encouraged to reach out to the asset\u2019s creators. ", "page_idx": 22}, {"type": "text", "text": "13. New Assets ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Question: Are new assets introduced in the paper well documented and is the documentation provided alongside the assets? ", "page_idx": 22}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 22}, {"type": "text", "text": "Justification: The new assets introduced in the paper are thoroughly documented. Detailed documentation is provided alongside the assets, including information about the dataset/code/model, training procedures, licenses, and limitations. This ensures that other researchers can effectively utilize and build upon our work. ", "page_idx": 22}, {"type": "text", "text": "Guidelines: ", "page_idx": 22}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not release new assets.   \n\u2022 Researchers should communicate the details of the dataset/code/model as part of their submissions via structured templates. This includes details about training, license, limitations, etc.   \n\u2022 The paper should discuss whether and how consent was obtained from people whose asset is used.   \n\u2022 At submission time, remember to anonymize your assets (if applicable). You can either create an anonymized URL or include an anonymized zip file. ", "page_idx": 22}, {"type": "text", "text": "14. Crowdsourcing and Research with Human Subjects ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Question: For crowdsourcing experiments and research with human subjects, does the paper include the full text of instructions given to participants and screenshots, if applicable, as well as details about compensation (if any)? ", "page_idx": 22}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 22}, {"type": "text", "text": "Justification: Although our research involves predicting human next points of interest (POI), our data is sourced from publicly available datasets, which are commonly used in related work. The sources and relevant citations are clearly indicated in the paper, making this question not applicable to our study. ", "page_idx": 22}, {"type": "text", "text": "Guidelines: ", "page_idx": 22}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Including this information in the supplemental material is fine, but if the main contribution of the paper involves human subjects, then as much detail as possible should be included in the main paper. ", "page_idx": 22}, {"type": "text", "text": "\u2022 According to the NeurIPS Code of Ethics, workers involved in data collection, curation, or other labor should be paid at least the minimum wage in the country of the data collector. ", "page_idx": 23}, {"type": "text", "text": "15. Institutional Review Board (IRB) Approvals or Equivalent for Research with Human Subjects ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: Does the paper describe potential risks incurred by study participants, whether such risks were disclosed to the subjects, and whether Institutional Review Board (IRB) approvals (or an equivalent approval/review based on the requirements of your country or institution) were obtained? ", "page_idx": 23}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 23}, {"type": "text", "text": "Justification: Although our research involves predicting human next points of interest (POI), our data is sourced from publicly available datasets, which are commonly used in related work. The sources and relevant citations are clearly indicated in the paper, making this question not applicable to our study. ", "page_idx": 23}, {"type": "text", "text": "Guidelines: ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Depending on the country in which research is conducted, IRB approval (or equivalent) may be required for any human subjects research. If you obtained IRB approval, you should clearly state this in the paper.   \n\u2022 We recognize that the procedures for this may vary significantly between institutions and locations, and we expect authors to adhere to the NeurIPS Code of Ethics and the guidelines for their institution.   \n\u2022 For initial submissions, do not include any information that would break anonymity (if applicable), such as the institution conducting the review. ", "page_idx": 23}]