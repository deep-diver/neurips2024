[{"figure_path": "9lGJrkqJUw/figures/figures_1_1.jpg", "caption": "Figure 1: (a) a conditional neural field encodes a molecular field v into a low dimensional latent code z. (b) using a learned score function ge, FuncMol performs sampling in latent space via Langevin MCMC. These codes are decoded back into molecules.", "description": "This figure shows the overall architecture of the FuncMol model.  Panel (a) illustrates how a conditional neural field encodes a 3D molecular field representation (atomic density) into a lower-dimensional latent code. Panel (b) depicts the generative process. It uses a learned score function and Langevin Monte Carlo Markov Chain (MCMC) to sample noisy codes from a Gaussian-smoothed distribution, denoises them, and decodes these into a final molecular field representation.  The process is shown as a walk-jump sampling chain, progressing from noisy samples to more refined samples and finally a complete molecule.", "section": "1 Introduction"}, {"figure_path": "9lGJrkqJUw/figures/figures_3_1.jpg", "caption": "Figure 2: Conditional neural field f\u03b8 using the multiplicative filter network architecture. (a) A latent code z and some coordinates x are given as input to the model that outputs the occupancy field at that location for the corresponding molecule, f\u03b8(x, z). (b) The code and coordinates are processed via FiLM layers and Hadamard products. We denote the overall operation at layer l as H(l).", "description": "This figure shows the architecture of the conditional neural field used in FuncMol.  Panel (a) depicts the overall flow, where a latent code z and 3D coordinates x are input, and the occupancy field at x is output. Panel (b) zooms in on a single multiplicative block, showing the processing steps involving FiLM (FiLM layers) and elementwise multiplication (Hadamard product) within each layer.", "section": "3 Molecular neural fields"}, {"figure_path": "9lGJrkqJUw/figures/figures_9_1.jpg", "caption": "Figure 3: Qualitative evaluation on CREMP following [84]. Left: Comparison of the bond angles (\u03b8\u2081, \u03b8\u2082, \u03b8\u2083) in each amino acid residue and dihedral distributions (\u03c6, \u03c8, \u03c9) for each residue from the reference test set (gray) and the generated samples (blue). KL divergence is calculated as KL(test || sampled). Right: Ramachandran plots [94] (colored by density where darker tones represent high density regions).", "description": "This figure shows a qualitative comparison of generated molecules from the FuncMol model against the ground truth CREMP dataset. The left side displays the comparison of bond angles (\u03b8\u2081, \u03b8\u2082, \u03b8\u2083) and dihedral angle distributions (\u03c6, \u03c8, \u03c9) for each amino acid residue. The right side shows Ramachandran plots which represent the distribution of dihedral angles (\u03c6, \u03c8) in proteins, where darker areas indicate higher densities.", "section": "5.4 Results on CREMP"}, {"figure_path": "9lGJrkqJUw/figures/figures_15_1.jpg", "caption": "Figure 4: Auto-encoding approach for neural field representation. A voxelized representation of molecule is encoded int the latent space z with a 3D CNN. This representation is then decoded with a conditional MFN for any point x in space.", "description": "This figure illustrates the auto-encoding approach used in the FuncMol model. A 3D convolutional neural network (CNN) encodes a voxelized representation of a molecule into a low-dimensional latent code z. This code is then used as input to a conditional multiplicative filter network (MFN), which decodes the latent code back into a continuous occupancy field representing the 3D structure of the molecule.  The process involves mapping 3D coordinates to atomic densities, allowing for a continuous representation of the molecule, and overcoming the limitations of discrete grid-based representations.", "section": "B Implementation details"}, {"figure_path": "9lGJrkqJUw/figures/figures_17_1.jpg", "caption": "Figure 5: Interpolation in the latent modulation space for different pairs of molecules from GEOM-drugs. Each interpolated codes is protected back to the learned manifold of molecules via a noise/denoise operation. FuncMol produces semantically meaningful patterns in the interpolated space and we observe that molecules close in latent space share similar structure.", "description": "This figure shows six interpolation trajectories in the latent space of molecules.  Each trajectory starts and ends with a molecule from the GEOM-drugs dataset.  Intermediate points along the trajectory represent interpolated latent codes, which are then decoded back into molecules using the FuncMol model's denoising process. The figure demonstrates that nearby points in latent space correspond to molecules with similar structures, showcasing the model's ability to learn a meaningful representation of molecular similarity.", "section": "C Analysis of the latent space"}, {"figure_path": "9lGJrkqJUw/figures/figures_18_1.jpg", "caption": "Figure 5: Interpolation in the latent modulation space for different pairs of molecules from GEOM-drugs. Each interpolated codes is protected back to the learned manifold of molecules via a noise/denoise operation. FuncMol produces semantically meaningful patterns in the interpolated space and we observe that molecules close in latent space share similar structure.", "description": "This figure shows six interpolation trajectories in the latent modulation space of the FuncMol model.  Each trajectory connects two molecules from the GEOM-drugs dataset. Intermediate points along each trajectory represent interpolated modulation codes.  These codes are then decoded back into molecular structures using the model's denoising process.  The figure demonstrates that nearby molecules in the latent space tend to have similar structures, suggesting the latent space encodes meaningful chemical information.", "section": "C Analysis of the latent space"}, {"figure_path": "9lGJrkqJUw/figures/figures_19_1.jpg", "caption": "Figure 6: t-SNE plots of latent modulations codes of QM9 molecules for different molecular properties. For each plot, we pick 200 molecules from validation set with high value of a property (blue) and 200 with low value (red). We show results for four properties: (a) heat capacity (Cv), (b) internal energy (U0), (c) isotropic polarization (\u03b1) and (d) dipole moment (\u00b5).", "description": "This figure shows the t-SNE plots of the latent modulation codes for QM9 molecules.  For each of four molecular properties (heat capacity, internal energy, isotropic polarization, and dipole moment), 200 molecules with high values and 200 molecules with low values were selected from the validation set.  The t-SNE visualization aims to reveal clusters of molecules with similar property values in the latent space, demonstrating that the latent codes effectively capture these properties.", "section": "C Analysis of the latent space"}, {"figure_path": "9lGJrkqJUw/figures/figures_19_2.jpg", "caption": "Figure 7: Performance of linear regression model (a.k.a linear probing) trained on modulation codes to predict molecular properties on QM9. We show the scatter plots and Spearman correlation for four different properties: (a) heat capacity (Cv), (b) internal energy (Uo), (c) isotropic polarization (a) and (d) dipole moment (\u03bc).", "description": "This figure demonstrates the performance of a linear regression model trained using only the learned modulation codes (latent codes) to predict four different molecular properties of the QM9 dataset.  The results indicate high Spearman correlations, suggesting a strong relationship between the latent codes and these properties, despite the unsupervised nature of the code learning process.", "section": "C Analysis of the latent space"}, {"figure_path": "9lGJrkqJUw/figures/figures_21_1.jpg", "caption": "Figure 8: Ablation: code robustness to noise on GEOM-drugs (blue) and QM9 (red). Stable molecule (a) and bond angle distance (b) metrics as we increasingly add noise to the codes. Metrics are computed with 4000 generated samples on validation reference set.", "description": "This figure shows the impact of adding Gaussian noise to the latent codes on the quality of the generated molecules.  The plots display the average stable molecule percentage and bond angle Wasserstein distance (W1) for different noise levels (\u03c3) on both the GEOM-drugs and QM9 datasets.  The results demonstrate the robustness of the model's latent code representation to noise.", "section": "E Ablations"}, {"figure_path": "9lGJrkqJUw/figures/figures_22_1.jpg", "caption": "Figure 9: Cumulative distribution function of strain energy of generated molecules on GEOM-drugs based on 10000 molecules.", "description": "This figure shows the cumulative distribution function (CDF) of the strain energy for molecules generated by different models on the GEOM-drugs dataset. The strain energy, calculated using the Universal Force Field (UFF), measures the difference between the energy of a generated molecule's pose and its relaxed pose. A lower strain energy indicates a more stable and realistic conformation.  The CDF plots allow comparison of the models' ability to generate molecules with realistic strain energy distributions, reflecting their ability to produce stable, chemically plausible structures.  The reference line represents the true distribution of strain energies from the dataset, while the other lines represent the distributions of strain energies for molecules generated by each model (EDM, GeoLDM, VoxMol, FuncMol).", "section": "F Additional quantitative results"}, {"figure_path": "9lGJrkqJUw/figures/figures_22_2.jpg", "caption": "Figure 10: Histograms (over 10000 samples) showing (first row) distribution of number of fragments, (second) distribution of ring size, and (third) distribution of number of atoms per molecule.", "description": "This figure compares the distributions of the number of fragments, ring size, and number of atoms per molecule between generated molecules from different models and a reference dataset.  It provides a visual representation of how well each generative model is able to capture the structural properties of real-world molecules, in terms of their size and complexity.", "section": "F Additional quantitative results"}, {"figure_path": "9lGJrkqJUw/figures/figures_23_1.jpg", "caption": "Figure 1: (a) a conditional neural field encodes a molecular field v into a low dimensional latent code z. (b) using a learned score function ge, FuncMol performs sampling in latent space via Langevin MCMC. These codes are decoded back into molecules.", "description": "The figure shows the process of FuncMol. First, a conditional neural field encodes a molecular field into a low-dimensional latent code. Second, FuncMol performs sampling in the latent space using Langevin MCMC with a learned score function. Finally, the sampled codes are decoded back into molecules.", "section": "1 Introduction"}, {"figure_path": "9lGJrkqJUw/figures/figures_24_1.jpg", "caption": "Figure 12: Generated samples from FuncMol trained on GEOM-drugs.", "description": "This figure displays 16 examples of molecules generated by the FuncMol model, which was trained on the GEOM-drugs dataset.  Each molecule is depicted in 3D, showcasing its spatial structure. The variety in molecular structures highlights the model's ability to generate diverse drug-like molecules. The figure serves as a qualitative assessment of FuncMol's performance, illustrating its capacity to produce chemically plausible and structurally varied molecules.", "section": "H Additional qualitative results"}, {"figure_path": "9lGJrkqJUw/figures/figures_25_1.jpg", "caption": "Figure 13: Generated samples from FuncMol trained on CREMP.", "description": "This figure shows 16 example molecules generated by the FuncMol model trained on the CREMP dataset.  CREMP is a dataset of macrocyclic peptides which are larger and more complex than the molecules in other datasets used in the paper. The figure demonstrates the ability of FuncMol to generate diverse and complex molecules.", "section": "Additional qualitative results"}, {"figure_path": "9lGJrkqJUw/figures/figures_25_2.jpg", "caption": "Figure 1: (a) a conditional neural field encodes a molecular field v into a low dimensional latent code z. (b) using a learned score function ge, FuncMol performs sampling in latent space via Langevin MCMC. These codes are decoded back into molecules.", "description": "This figure shows the overall process of FuncMol. (a) shows that a conditional neural field takes a molecular field as input and encodes it into a low-dimensional latent code z. (b) illustrates how FuncMol uses a learned score function and Langevin MCMC sampling in the latent space to generate new molecules. These latent codes are then decoded back into 3D molecular structures.", "section": "1 Introduction"}]