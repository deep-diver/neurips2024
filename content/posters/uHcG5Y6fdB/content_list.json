[{"type": "text", "text": "Pretrained Transformer Efficiently Learns Low-Dimensional Target Functions In-Context ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Kazusato $\\mathbf{O}\\mathbf{k}\\mathbf{o}^{1,3}$ , Yujin Song2,3, Taiji Suzuki2,3, Denny Wu4,5 ", "page_idx": 0}, {"type": "text", "text": "1University of California, Berkeley, 2University of Tokyo, 3RIKEN AIP 4New York University, 5Flatiron Institute ", "page_idx": 0}, {"type": "text", "text": "oko@berkeley.edu, song-yujin139@g.ecc.u-tokyo.ac.jp, taiji@mist.i.u-tokyo.ac.jp, dennywu@nyu.edu ", "page_idx": 0}, {"type": "text", "text": "Abstract ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Transformers can efficiently learn in-context from example demonstrations. Most existing theoretical analyses studied the in-context learning (ICL) ability of transformers for linear function classes, where it is typically shown that the minimizer of the pretraining loss implements one gradient descent step on the least squares objective. However, this simplified linear setting arguably does not demonstrate the statistical efficiency of ICL, since the pretrained transformer does not outperform directly solving linear regression on the test prompt. In this paper, we study ICL of a nonlinear function class via transformer with nonlinear MLP layer: given a class of single-index target functions $f_{*}(\\pmb{x})=\\sigma_{*}(\\langle\\pmb{x},\\pmb{\\beta}\\rangle)$ , where the index features $\\beta\\in\\mathbb{R}^{d}$ are drawn from a $r$ -dimensional subspace, we show that a nonlinear transformer optimized by gradient descent (with a pretraining sample complexity that depends on the information exponent of the link functions $\\sigma_{*}$ ) learns $f_{*}$ in-context with a prompt length that only depends on the dimension of the distribution of target functions $r$ ; in contrast, any algorithm that directly learns $f_{*}$ on test prompt yields a statistical complexity that scales with the ambient dimension $d$ . Our result highlights the adaptivity of the pretrained transformer to low-dimensional structures of the function class, which enables sample-efficient ICL that outperforms estimators that only have access to the in-context data. ", "page_idx": 0}, {"type": "text", "text": "1 Introduction ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Pretrained transformers $[\\mathrm{VSP^{+}17}]$ possess the remarkable ability of in-context learning $(I C L)$ $[{\\mathbf{B}}{\\mathbf{M}}{\\mathbf{R}}^{+}20]$ , whereby the model constructs a predictor from a prompt sequence consisting of pairs of labeled examples without updating any parameters. A common explanation is that the trained transformer can implement a learning algorithm, such as gradient descent on the in-context examples, in its forward pass $[\\mathrm{HvMM^{+}19}$ , $\\bar{\\mathrm{DSD}^{\\bar{+}}}22$ , $\\operatorname{VONR}^{+}23]$ . Such explanation has been empirically studied in synthetic tasks such as linear regression [GTLV22, $\\mathrm{ASA}^{+}22]$ , which has motivated theoretical analyses of the statistical and computational complexity of ICL in learning simple function classes. ", "page_idx": 0}, {"type": "text", "text": "Many recent theoretical works on ICL focus on learning the function class of linear models using linear transformers trained via empirical risk minimization. In this setting, it can be shown that minima of the pretraining loss implements one (preconditioned) gradient descent step on the least squares objective computed on the test prompt [ZFB23, ACDS23, MHM23]. This implies that the forward pass of the pretrained transformer can learn linear targets with $n\\gtrsim d$ in-context examples, hence matching the sample complexity of linear regression on the test prompt. Subsequent works also studied how the distribution and \u201cdiversity\u201d of pretrained tasks affect the ICL solution in similar problem settings $[\\mathbf{W}\\mathbf{Z}\\mathbf{C}^{+}23$ , RPCG23, ZWB24, LLZV $^{+}24]$ . ", "page_idx": 0}, {"type": "text", "text": "The motivation of our work is the observation that the simple setting of learning linear models with linear transformers does not fully capture the statistical efficiency and adaptivity of ICL. Specifically, \u2022 A linear transformer has limited expressivity and hence only implements simple operations in the forward pass, such as one gradient step for least squares regression. This limits the class of algorithms that can be executed in-context, and consequently, the pretrained transformer cannot outperform directly solving linear regression on the test prompt. We therefore ask the question: ", "page_idx": 1}, {"type": "text", "text": "", "page_idx": 1}, {"type": "text", "text": "With the aid of MLP layer, can a pretrained transformer learn a nonlinear function class in-context, and outperform baseline algorithms that only have access to the test prompt? ", "page_idx": 1}, {"type": "text", "text": "\u2022 A key feature of ICL is the adaptivity to structure of the learning problem. For example, [GTLV22] empirically showed that transformers can match the performance of either ridge regression or LASSO, depending on parameter sparsity of the target class; [RPCG23] observed that transformers transitions from a weighted-sum estimator to ridge regression as the number of pretraining tasks increases. Such adaptivity enables the pretrained model to outperform algorithms that only have access to the test prompt, which cannot take into account the \u201cprior\u201d distribution of target functions. Hence a natural question to ask is ", "page_idx": 1}, {"type": "text", "text": "Can a pretrained transformer adapt to certain structures of the target function class, and how does such adaptivity contribute to the statistical efficiency of ICL? ", "page_idx": 1}, {"type": "text", "text": "1.1 Our Contributions ", "text_level": 1, "page_idx": 1}, {"type": "text", "text": "1.1.1 Function Class: Gaussian Single-index Models ", "text_level": 1, "page_idx": 1}, {"type": "text", "text": "To address the above questions, we study the in-context learning of arguably the simplest nonlinear extension of linear regression where a nonlinearity is applied to the response. Specifically, we consider the following class of single-index target functions, where the $t$ -th pretraining task is constructed as ", "page_idx": 1}, {"type": "equation", "text": "$$\nx_{1}^{t},x_{2}^{t},\\ldots,x_{N}^{t},x^{t\\mathrm{~i.i.d.}}{\\mathcal{N}}(0,I_{d}),\\quad y_{i}^{t}=\\sigma_{*}^{t}(\\langle x_{i}^{t},\\beta^{t}\\rangle)+\\varsigma_{i}^{t},\n$$", "text_format": "latex", "page_idx": 1}, {"type": "text", "text": "where $\\sigma_{*}^{t}:\\mathbb{R}\\rightarrow\\mathbb{R}$ is the unknown link function, and $\\beta^{t}\\in\\mathbb{R}^{d}$ is the index feature vector which is drawn from some fixed $r$ -dimensional subspace for some $r\\ll d$ . The task is to learn this input-output relation by reading the context $({\\pmb x}_{1},y_{1},\\dots,{\\pmb x}_{N},y_{N})$ and predict the output corresponding to the query $\\textbf{\\em x}$ (See Section 2 for details). This problem setting is based on the following considerations. ", "page_idx": 1}, {"type": "text", "text": "\u2022 Nonlinearity of function class. Due to the nonlinear link function, single-index targets cannot be learned by linear transformers. For this class of functions, the statistical efficiency of simple algorithms has been extensively studied: given a link function with degree $P$ and information exponent $Q$ (defined as the index of the smallest non-zero coefficient in the Hermite expansion), we know that kernel methods require at least $n\\gtrsim d^{P}$ samples [GMMM21, DWY21], whereas twolayer neural network trained by gradient descent can achieve better sample complexity $n\\gtrsim d^{\\Theta(Q)}$ [BAGJ21, BBSS22]. Hence these algorithms, if directly applied to the test prompt, require a context length polynomial in the ambient dimensionality $d$ , which arguably deviates from practical settings of ICL where the pretrained transformer learns from a few in-context examples which may come from high dimensional data space. These algorithms serve as a baseline for comparing the statistical efficiency of ICL.   \n\u2022 Two types of low-dimensional structures. Prior works on gradient-based feature learning highlights the adaptivity of neural network to low-dimensional functions, i.e., single-index model $\\sigma_{*}(\\langle\\pmb{x}_{i},\\beta\\rangle)$ that depends on one direction (index features) $\\beta$ in $\\mathbb{R}^{d}$ [AAM22, $\\mathrm{BES}^{+}22$ , BMZ23]. In such setting, the complexity of gradient descent is dominated by the search for direction $\\beta\\in\\mathbb{R}^{d}$ , the difficulty of which can be characterized by various computational lower bounds [DLS22, AAM23, DPVLB24]. Importantly, our pretraining problem setup introduces another notion of low dimensionality: the \u201cdistribution\u201d of target functions is low-dimensional, since the index features for each task $\\beta_{t}$ are drawn from a rank- $^r$ subspace. This low-dimensionality of function class cannot be exploited by any algorithms that directly estimate the target function from test prompt, but as we will see, transformers can adapt to this additional structure via gradient-based pretraining, which reduces the search problem (for the index features $\\beta$ ) to $r$ -dimensional in the in-context phase. Therefore, when $r\\ll d$ , we expect pretrained transformers to outperform baseline algorithms on the in-context examples (kernel methods, neural network, etc.). ", "page_idx": 1}, {"type": "text", "text": "Empirical observations. We pretrain a GPT-2 model $[\\mathrm{R}\\bar{\\mathrm{W}}\\bar{\\mathrm{C}}^{+}19]$ (with the same configurations as the incontext linear regression setting in [GTLV22]) to learn the Gaussian single-index task (1.1) with degree-3 link function, and compare its in-context sample complexity against baseline algorithms (see Section 4 for details). In Figure 1 we observe that the pretrained transformer achieves low prediction risk using fewer in-context examples than two baseline algorithms: kernel ridge regression, and neural network trained by gradient descent. Moreover, we observe that unlike the baseline methods, ", "page_idx": 2}, {"type": "text", "text": "Transformer achieves an in-context sample complexity (almost) independent of the ambient dimensionality $d,$ . ", "page_idx": 2}, {"type": "text", "text": "The goal of this work is to rigorously establish a $d$ - independent in-context sample complexity in an idealized theoretical setting for a shallow transformer optimized via gradient-based pretraining. ", "page_idx": 2}, {"type": "image", "img_path": "uHcG5Y6fdB/tmp/d77c2bd1ed90c1eeaa24d10d3bd4e7bb130bf86038f6a34d2cd7c4815f41aa24.jpg", "img_caption": ["Figure 1: In-context generalization error (with standard deviation) of kernel ridge regression, neural network $^+$ gradient descent, and pretrained transformer. The target function is a polynomial single-index model. We fix $r=8$ and vary $d=16,32$ . "], "img_footnote": [], "page_idx": 2}, {"type": "text", "text": "1.1.2 Main Result: Learning Single-index Models In-Context ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "We characterize the sample complexity of learning (1.1) in-context, using a nonlinear transformer optimized by gradient descent. Each single-index task is specified by an unknown index feature vector $\\beta\\in\\dot{\\mathbb{R}}^{d}$ drawn from some $r$ -dimensional subspace, and a link function $\\sigma_{*}$ with degree $P$ and information exponent $Q\\le P$ ; we allow the degree and information exponent to vary across tasks, to model the scenario where the difficult of pretraining tasks may differ. We show that pretraining of the nonlinear MLP layer can extract the low-dimensional structure of the function class, and the attention layer efficiently approximates the nonlinear link function. Our main theorem upper bounds the in-context generalization error of the pretrained transformer. ", "page_idx": 2}, {"type": "text", "text": "Theorem (Informal). Let $f:(\\pmb{x}_{1},y_{1},\\dots,\\pmb{x}_{N},y_{N},\\pmb{x})\\mapsto y$ be a transformer with nonlinear MLP layer pretrained with gradient descent (Algorithm 1) on the single-index regression task (1.1). With probability at least 0.99, the model $f$ achieves in-context prediction risk $\\mathbb{E}|f(\\pmb{x})-f_{*}(\\pmb{x})|-\\tau=o_{d}(1),$ , where $\\tau$ is the noise level, if the number of pretraining tasks $T$ , the number of training examples $N$ , the test prompt length $N^{*}$ , and the network width m satisfy (we omit polylogarithmic factors) ", "page_idx": 2}, {"type": "equation", "text": "$$\n\\underbrace{T\\gtrsim d^{\\Theta(Q)},\\quad N T\\gg T\\gtrsim d^{\\Theta(Q)}}_{p r e t r a i n i n g},\\quad\\underbrace{N^{*}\\gtrsim r^{\\Theta(P)}}_{i n f e r e n c e},\\quad\\underbrace{m\\gtrsim r^{\\Theta(P)}}_{a p p r o x i m a t i o n},\n$$", "text_format": "latex", "page_idx": 2}, {"type": "image", "img_path": "", "img_caption": ["where $Q,P$ are the information exponent and the highest degree of link functions, respectively. "], "img_footnote": [], "page_idx": 2}, {"type": "text", "text": "To the best of our knowledge, this is the first end-to-end optimization and statistical guarantee for in-context regression of this nonlinear function class. We make the following remarks. ", "page_idx": 2}, {"type": "text", "text": "\u2022 The required sample size for pretraining $T,N$ scale with the ambient dimensionality $d$ . In particular, the number of pretraining tasks $T$ is parallel to the complexity of learning a single-index model with information exponent $Q$ using a two-layer neural network. On the other hand, the sample complexity for the in-context phase only depends on the dimensionality of the function class $r\\ll d$ \u2022 Note that any estimator that only has access to the in-context examples requires $n\\gtrsim d$ samples to learn the single-index model, as suggested by the information theoretic lower bound (e.g., see [MM18, $\\mathrm{BKM}^{+}19]$ ). Therefore, when $r\\ll d$ , we see a separation between pretrained transformer and algorithms that directly learn from the test prompt, such as linear/kernel regression and neural network $^+$ gradient descent. This highlights the adaptivity (via pretraining) of transformers to low-dimensional structures of the target function class. \u2022 Our analysis of pretraining reveals the following mechanism analogous to $[\\mathrm{GHM}^{+}23]$ : the nonlinear MLP layer extract useful features and adapt to the low-dimensionality of the function class, whereas the attention layer performs in-context function approximation on top of the learned features. ", "page_idx": 2}, {"type": "text", "text": "1.2 Related Works ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "Theory of in-context learning. Many recent works studied the in-context learning ability of transformers trained by gradient descent. [ZFB23, ACDS23, MHM23, $\\mathrm{WZC}^{+}23$ , ZWB24] studied the training of linear transformer models to learn linear target functions in-context by implementing one gradient descent step in the forward pass. Similar optimization results have been established for looped linear transformers $[\\mathrm{GSR}^{+}24]$ , transformers with SoftMax attention [HCL23, NDL24, CSWY24a, CSWY24b] or nonlinear MLP layer [KS24, $\\mathrm{LWL}^{+}24]$ . Our problem setting resembles [KS24], where a nonlinear MLP block is used to extract features, followed by a linear attention layer; the main difference is that we establish end-to-end guarantees on the optimization and sample complexity for learning a concrete nonlinear function class, whereas [KS24] focused on convergence of optimization. [CCS23] showed that transformers can learn nonlinear functions in-context via a functional gradient mechanism, but no statistical and optimization guarantees were given. If we do not take gradient-based optimization into account, the function class that can be implemented incontext by transformers has been characterized in many prior works $[\\mathbf{B}\\mathbf{C}\\mathbf{W}^{+}23$ , $\\mathrm{GHM}^{+}23$ , ZZYW23, JLLVR24, $\\mathrm{SGS}^{+}24$ , KNS24]. These results typically aim to encode specific algorithms (LASSO, gradient descent, etc.) in the forward pass or directly analyze the Bayes-optimal estimator. ", "page_idx": 2}, {"type": "text", "text": "", "page_idx": 3}, {"type": "text", "text": "Gradient-based learning of low-dimensional functions. The complexity of learning lowdimensional functions with neural network has been extensively studied in the feature learning theory literature. Typical target functions include single-index models [BAGJ21, $\\mathrm{BES}^{+}22$ , BBSS22, $\\mathrm{MHPG}^{+}23$ , DNGL23, $\\mathrm{BES}^{+}23]$ and multi-index models [DLS22, AAM22, AAM23, BBPV23]. While a shallow neural network can efficiently approximate such low-dimensional functions, the efficiency of gradient-based training is governed by properties of the nonlinearity $\\sigma^{*}$ . In the single-index setting, prior works established a sufficient sample size $n\\gtrsim d^{\\Theta(K)}$ , where $K\\,\\in\\,\\mathbb{N}$ is the information exponent for algorithms utilizing correlational information [BAGJ21, BBSS22, DNGL23, MHWSE23], or the generative exponent for algorithms that employ suitable label transformations [DPVLB24, LOSW24, $\\mathrm{ADK}^{+}24$ , JMS24]. Moreover, $n\\asymp d$ samples are information theoretically necessary without additional structural assumptions; this entails that estimators that only access the test prompt inevitably pay a sample size that scales with the ambient dimensionality. As we will see, pretrained transformers can avoid this \u201ccurse of dimensionality\u201d by exploiting the low-dimensionality of the task distribution. Low-dimensional structure of the function class similar to our setting has been assumed to study the efficiency of transfer learning [DLS22] and multi-task learning $[\\mathrm{CHS}^{+}23]$ . ", "page_idx": 3}, {"type": "text", "text": "2 Problem Setting ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "Notations. $\\|\\cdot\\|$ denotes the $\\ell_{2}$ norm for vectors and the $\\ell_{2}\\to\\ell_{2}$ operator norm for matrices. For a vector $\\pmb{w}$ , we use $\\pmb{w}_{a;b}$ for $a\\leq b$ to denote the vector $[w_{a},w_{a+1},\\ldots,w_{b}]^{\\top}$ . ${\\mathbf{1}}_{N}$ denotes the all-one vector of size $N$ . The indicator function of $A$ is denoted by $\\mathbb{I}_{A}$ . Let $N$ be a nonnegative integer; then $[N]$ denotes the set $\\{n\\in\\mathbb{Z}\\mid1\\leq n\\leq N\\}$ . For a nonnegative integer $i$ , the $i$ -th Hermite polynomial is defined as $\\begin{array}{r}{\\mathrm{He}_{i}(z)=(-1)^{i}\\mathrm{e}^{\\frac{z^{2}}{2}}\\frac{\\mathrm{d}^{i}}{\\mathrm{d}z^{i}}\\mathrm{e}^{\\frac{-z^{2}}{2}}}\\end{array}$ . For a set $S$ , $\\mathrm{Unif}(S)$ denotes the uniform distribution over $S$ . We denote the unit sphere $\\{\\pmb{x}\\in\\mathbb{R}^{d}\\mid\\|\\pmb{x}\\|=1\\}$ by $\\mathbb{S}^{d-1}$ . $\\Tilde{O}(\\cdot),\\Tilde{\\Omega}(\\cdot)$ represent $O(\\cdot)$ and $\\Omega(\\cdot)$ notations where polylogarithmic terms are hidden. We write $a\\lesssim b$ when there exists a constant $c$ such that $a\\leq c b$ . If both $a\\lesssim b$ and $b\\lesssim a$ holds, we write $a\\asymp b$ . ", "page_idx": 3}, {"type": "text", "text": "2.1 Data Generating Process ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "2.1.1 In-context learning ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "We first introduce the basic setting of ICL $[{\\mathbf{B}}{\\mathbf{M}}{\\mathbf{R}}^{+}20]$ of simple function classes as investigated in [GTLV22, $\\mathrm{ASA}^{+}22]$ . In each task, the learner is given a sequence of inputs and outputs $(\\pmb{x}_{1},y_{1},\\dots,\\pmb{x}_{N},y_{N},\\pmb{x})$ referred to as prompt, where $\\overline{{\\mathbf{\\pi}_{i}}},\\mathbf{x}\\,\\in\\,\\mathbb{R}^{d}$ and $y_{i}\\ \\in\\ \\mathbb{R}$ . The labeled examples $X=(x_{1}\\quad\\cdot\\cdot\\cdot\\quad x_{N})\\in\\mathbb{R}^{d\\times N},\\,y=\\left(y_{1}\\quad\\cdot\\cdot\\cdot\\quad y_{N}\\right)^{\\top}\\in\\mathbb{R}^{N}$ are called context, and $\\textbf{\\em x}$ is the query. Given input distribution ${\\pmb x}_{1},\\pmb{\\dots},{\\pmb x}_{N},{\\pmb x}\\stackrel{\\mathrm{i.i.d.}}{\\sim}\\mathcal{D}_{\\pmb x}$ , the output $y_{i}$ is expressed as ", "page_idx": 3}, {"type": "equation", "text": "$$\ny_{i}=f_{*}(\\mathbf{x}_{i})+\\varsigma_{i},\\quad i\\in[N],\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "where $f_{*}$ is the true function describing the input-output relation and $\\varsigma_{i}\\overset{\\mathrm{i.i.d.}}{\\sim}\\mathcal{D}_{\\varsigma}$ is i.i.d. label noise. Note that $f_{*}$ also varies across tasks \u2014 we assume $f_{*}$ is drawn i.i.d. from some true distribution $\\boldsymbol{\\mathcal{D}}_{f_{*}}$ . In the pretraining phase, we optimize the model parameters given training data from $T$ distinct tasks $\\left\\{(\\pmb{x}_{1}^{t},y_{1}^{t},\\ldots,\\pmb{x}_{M}^{t},y_{M}^{t},\\pmb{x}^{t},y^{t})\\right\\}_{t=1}^{T}$ , which is composed of prompts $\\left\\{(\\pmb{x}_{1}^{t},y_{1}^{t},\\ldots,\\pmb{x}_{M}^{t},y_{M}^{t},\\pmb{x}^{t})\\right\\}_{t=1}^{T}$ and responses $\\left\\{y^{t}\\right\\}_{t=1}^{T}$ for queries $\\left\\{\\pmb{x}^{t}\\right\\}_{t=1}^{T}$ , where $y^{t}=f_{*}^{t}(\\pmb{x}^{t})+\\varsigma^{t}$ and $\\varsigma^{t}\\overset{\\mathrm{i.i.d.}}{\\sim}\\mathcal{D}_{\\varsigma}$ . ", "page_idx": 3}, {"type": "text", "text": "We say a model learns these functional relations in-context, when the model can predict the output $f_{*}(x)$ corresponding to query $\\textbf{\\em x}$ by solely examining the context $(X,y)$ , without updating model parameters for each task. Given the pretrained model $f(X,y,x;\\theta)$ with parameter $\\pmb{\\theta}$ which predicts the label of query $\\textbf{\\em x}$ from context $(X,y)$ , we define the expected ICL risk as ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\mathcal{R}_{N^{*}}(f):=\\mathbb{E}[|f(X_{1:N^{*}},y_{1:N^{*}},x;\\pmb\\theta)-y|],\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "where ${\\pmb{y}}\\,=\\,f_{*}({\\pmb{x}})+\\varsigma$ and the expectation is taken over the in-context data: $\\pmb{x}_{1},\\pmb{\\ldots},\\pmb{x}_{N^{*}},\\pmb{x}\\;\\sim$ $\\mathcal{D}_{\\pmb{x}},f_{*}\\,\\sim\\,\\mathcal{D}_{f_{*}},\\varsigma_{1},\\hdots,\\varsigma_{N^{*}},\\varsigma\\,\\sim\\,\\mathcal{D}_{\\varsigma}$ . Note that we take the expectation with respect to contexts $\\left(X_{1:N^{*}},y_{1:N^{*}}\\right)\\in\\mathbb{R}^{d\\times N^{*}}\\times\\mathbb{R}^{N^{*}}$ of length $N^{*}$ , in order to examine the behavior of ICL at a specific context length. ", "page_idx": 4}, {"type": "text", "text": "2.1.2 Gaussian single-index models ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "We consider the situation where the true input-output relation is expressed by single-index models, i.e., functions that only depend on the direction of the index vector $\\beta$ in the input space. An efficient learning algorithm should adapt to this feature and identify the relevant subspace from highdimensional observations; hence this problem setting has been extensively studied in the deep learning theory literature [BL19, $\\mathrm{BES}^{+}22$ , BBSS22, $\\mathrm{MHPG}^{+}23$ , $\\mathrm{MZD}^{+}23]$ to demonstrate the adaptivity of gradient-based feature learning. ", "page_idx": 4}, {"type": "text", "text": "Assumption 1. Let $\\tau\\geq0$ be the noise level. The prompt $(\\pmb{x}_{1},y_{1},\\dots,\\pmb{x}_{N},y_{N},\\pmb{x})$ is generated as ", "page_idx": 4}, {"type": "equation", "text": "$$\nx_{1},x_{2},\\ldots,x_{N},x\\stackrel{\\mathrm{i.i.d.}}{\\sim}\\mathcal{D}_{x}=\\mathcal{N}(0,I_{d}),\\quad y_{i}=f_{*}(x_{i})+\\varsigma_{i},\\quad f_{*}(x_{i})=\\sigma_{*}(\\langle x_{i},\\beta\\rangle),\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "where $\\varsigma_{1},\\ldots,\\varsigma_{N}\\overset{\\mathrm{i.i.d.}}{\\sim}\\mathrm{Unif}\\big(\\{-\\tau,\\tau\\}\\big)$ , and the distribution $\\mathcal{D}_{f_{*}}$ of the true function $f_{*}$ is specified as: ", "page_idx": 4}, {"type": "text", "text": "1. Index Features. Let $\\boldsymbol{S}$ be an $r\\leq d$ -dimensional linear subspace of $\\mathbb{R}^{d}$ . We draw $\\beta$ uniformly from the unit sphere $\\mathbb{S}(S)$ in $\\boldsymbol{S}$ , i.e., from $\\mathbb{S}(\\mathcal{S}):=\\{\\beta\\mid\\beta\\in\\bar{\\mathcal{S}},\\|\\beta\\|=1\\}$ . ", "page_idx": 4}, {"type": "text", "text": "2. Link Function. $\\begin{array}{r}{\\sigma_{*}(z)=\\sum_{i=Q}^{P}\\frac{c_{i}}{i!}\\mathrm{He}_{i}(z)}\\end{array}$ , where $2\\leq Q\\leq P$ . We draw the Hermite coefficients $\\{c_{i}\\}_{i=Q}^{P}$ from any distribution satisfying ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\mathbb{E}[c_{Q}^{2}]=\\Theta_{d,r}(1)\\neq0,\\sum_{i=Q}^{P}c_{i}^{2}\\leq R_{c}^{2}\\;(a.s.)\\;\\;a n d\\;(c_{Q},\\ldots,c_{P})\\neq(0,\\ldots,0)\\;(a.s.).\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "Throughout the paper, we assume that $P\\ll d,r$ and $r\\ll d$ ; specifically, we take $P=\\Theta_{d,r}(1)$ and $r\\lesssim d^{1/2}$ . Note that the condition $r\\ll d$ entails that the class of target functions is low-dimensional, and as we will see, such structure can be adapted by the transformer via pretraining. ", "page_idx": 4}, {"type": "text", "text": "Remark 1. We make the following remarks on the assumption of single-index function class. ", "page_idx": 4}, {"type": "text", "text": "\u2022 For each task, the target is a single-index model with different index features drawn from some rank-r subspace, and different link function with degree at most $P$ and information exponent (defined as the index of the lowest degree non-zero coefficient in the Hermite expansion of the link function, i.e, $\\operatorname*{min}\\{i\\mid c_{i}\\neq0\\}$ in this case; see [BAGJ21, DH18]) at least $Q$ . This heterogeneity reflects the situation where the difficulty of learning the input-output relation varies across tasks. Note that we allow for different distributions of the Hermite coefficients $\\{c_{i}\\}$ : for example, we may set $\\begin{array}{r}{(c_{Q},\\dotsc,c_{P})\\sim\\mathrm{Unif}\\Big\\{(c_{Q},\\dotsc.c_{P})|\\sum_{i=Q}^{P}\\frac{c_{i}^{2}}{i!}=1\\Big\\}}\\end{array}$ (manifold of coefficients satisfying $\\mathbb{E}_{\\boldsymbol{x}}[f_{*}(\\boldsymbol{x})]=1),\\,\\mathrm{Unif}\\big(\\{0,1\\}^{P-Q+1}\\,\\backslash\\,(0,\\dots,0)\\big),$ , or $\\cdot\\operatorname{Unif}\\left(\\left\\{(1,\\ldots,0),\\ldots,(0,\\ldots,1)\\right\\}\\right)$ . \u2022 The condition $Q\\geq2$ (i.e., the Hermite expansion of $\\sigma_{*}$ does not contain constant and linear terms) ensures that the gradient update detects the entire $r$ -dimensional subspace instead of the trivial rank-1 component. For generic polynomial $\\sigma_{*}$ , this assumption can be satisfied by a simple preprocessing step that subtracts the low-degree components, as done in [DLS22]. ", "page_idx": 4}, {"type": "text", "text": "", "page_idx": 4}, {"type": "text", "text": "2.2 Student Model: Transformer with Nonlinear MLP Layer ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "We consider a transformer composed of a single-layer self-attention module preceded by an embedding module using a nonlinear multi-layer perceptron (MLP). Let $\\boldsymbol{E}\\in\\mathbb{R}^{d_{e}^{\\star}\\times d_{N}}$ be an embedding ", "page_idx": 4}, {"type": "text", "text": "matrix constructed from prompt $(\\pmb{x}_{1},y_{1},\\dots,\\pmb{x}_{N},y_{N},\\pmb{x})$ . A single-layer SoftMax self-attention module $[\\mathrm{VSP^{+}17}]$ is given as ", "page_idx": 5}, {"type": "equation", "text": "$$\nf_{\\mathrm{Attn}}(E;W^{P},W^{V},W^{K},W^{Q})=E+W^{P}W^{V}E\\cdot\\mathrm{softmax}\\bigg(\\frac{(W^{K}E)^{\\top}W^{Q}E}{\\rho}\\bigg),\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "where $\\rho$ is the temperature, and ${\\cal W}^{K},{\\cal W}^{Q}\\in\\mathrm{R}^{d_{k}\\times d_{e}}$ , $W^{V}\\in\\mathrm{R}^{d_{v}\\times d_{e}}$ and $W^{P}\\in\\mathrm{R}^{d_{e}\\times d_{v}}$ are the key, query, value, and projection matrix, respectively. Following prior theoretical works [ZFB23, ACDS23, MHM23, KNS24], we remove the SoftMax and instead analyze the linear attention with $\\rho\\,=\\,N$ ; it has been argued that such simplification can reproduce phenomena in practical transformer training $\\scriptstyle\\left[\\mathrm{ACS}^{+}23\\right]$ . We further simplify the original self-attention module (2.3) by merging $W^{P}W^{V}$ as $W^{P V}\\,\\in\\,\\mathbb{R}^{d_{e}\\times d_{e}}$ and $(W^{\\star})^{\\intercal}W^{Q}$ as $\\mathbf{\\bar{W}}^{K Q}\\,\\in\\,\\mathbb{R}^{d_{e}\\times d_{e}}$ , and consider the following parameterization also introduced in [ZFB23, ACDS23, $\\mathtt{W Z C}^{+}23]$ , ", "page_idx": 5}, {"type": "equation", "text": "$$\nW^{P V}=\\left[{\\bf{0}}_{1\\times(d_{e}-1)}^{*}\\quad\\ast\\biggr],W^{K Q}=\\left[{\\bf{K}}_{1\\times(d_{e}-1)}^{K}\\quad\\ast\\biggr],\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "where $v~\\in~\\mathbb{R}$ and $\\pmb{K}\\ \\in\\ \\mathbb{R}^{(d_{e}-1)\\times(d_{e}-1)}$ . Then, the simplified attention module is written as $\\begin{array}{r}{\\tilde{f}_{\\mathrm{Attn}}(E;W^{P V},W^{K Q})=E+W^{P V}E\\Bigl(\\frac{E^{\\top}W^{K Q}E}{N}\\Bigr)}\\end{array}$ , and we take the right-bottom entry as the prediction of $y$ corresponding to query $\\textbf{\\em x}$ . ", "page_idx": 5}, {"type": "text", "text": "Prior analyses of linear transformers [ZFB23, ACDS23, MHM23] defined the embedding matrix $\\boldsymbol{E}$ simply as the input-output pairs; however, the combination of linear embedding and liner attention is not sufficient to learn nonlinear single-index models. Instead, we set $d_{e}=m+1,d_{N}=N+1$ for $m\\in\\mathbb{N}$ and construct $\\pmb{E}$ using an MLP layer: ", "page_idx": 5}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\pmb{{\\cal E}}=\\left[\\begin{array}{c c c c}{\\sigma(\\pmb{w}_{1}^{\\top}\\pmb{x}_{1}+b_{1})}&{\\cdots}&{\\sigma(\\pmb{w}_{1}^{\\top}\\pmb{x}_{N}+b_{1})}&{\\sigma(\\pmb{w}_{1}^{\\top}\\pmb{x}+b_{1})}\\\\ {\\vdots}&{\\ddots}&{\\vdots}&{\\vdots}\\\\ {\\sigma(\\pmb{w}_{m}^{\\top}\\pmb{x}_{1}+b_{m})}&{\\cdots}&{\\sigma(\\pmb{w}_{m}^{\\top}\\pmb{x}_{N}+b_{m})}&{\\sigma(\\pmb{w}_{m}^{\\top}\\pmb{x}+b_{m})}\\\\ {y_{1}}&{\\cdots}&{y_{N}}&{0}\\end{array}\\right]\\in\\mathbb{R}^{(m+1)\\times(N+1)},}\\end{array}\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "where $\\pmb{w}_{1},\\dots,\\pmb{w}_{m}\\in\\mathbb{R}^{d}$ and $b_{1},\\ldots,b_{m}\\in\\mathbb{R}$ are trainable parameters and $\\sigma:\\mathbb{R}\\rightarrow\\mathbb{R}$ is a nonlinear activation function; we use $\\sigma(z)=\\mathrm{ReLU}(z)=\\operatorname*{max}\\{z,0\\}$ . This is to say, we define the embedding as the \u201chidden representation\u201d $\\sigma({\\pmb w}^{\\top}{\\pmb x}+b)$ of a width- $^{\\cdot m}$ two-layer neural network. For concise notation we write $W=({\\pmb w}_{1},\\pmb\\cdot\\cdot\\cdot,{\\pmb w}_{m})^{\\top},{\\pmb b}=({\\pmb b}_{1},\\pmb\\cdot\\cdot\\cdot,{\\pmb b}_{m})^{\\top}$ . ", "page_idx": 5}, {"type": "text", "text": "Remark 2. We make the following remarks on the considered architecture. ", "page_idx": 5}, {"type": "text", "text": "\u2022 The MLP embedding layer before attention has been adopted in recent works $I G H M^{+}23$ , KS24, KNS24]. This setting can be interpreted as an idealized version of the mechanism that lower layers of the transformer construct useful representation, on top of which upper attention layers implement the in-context learning algorithm. \u2022 Our architecture is also inspired by recent theoretical analyses of gradient-based feature learning, where it is shown that gradient descent on the MLP layer yields adaptivity to features of the target function and hence improved statistical efficiency [AAM22, DLS22, $B E S^{+}22J$ . ", "page_idx": 5}, {"type": "text", "text": "Combining the attention $\\tilde{f}_{\\mathrm{Attn}}$ and MLP embedding (2.5), we can express the model prediction $y$ as ", "page_idx": 5}, {"type": "equation", "text": "$$\nf(\\ensuremath{\\boldsymbol{X}},\\ensuremath{\\boldsymbol{y}},\\ensuremath{\\boldsymbol{x}};W,\\ensuremath{\\boldsymbol{\\Gamma}},\\ensuremath{\\boldsymbol{b}})=\\left\\langle\\frac{\\ensuremath{\\boldsymbol{\\Gamma}}\\sigma(W\\ensuremath{\\boldsymbol{X}}+b\\ensuremath{\\boldsymbol{1}}_{N}^{\\top})\\ensuremath{\\boldsymbol{y}}}{N},\\left[\\begin{array}{c}{\\sigma(\\ensuremath{\\boldsymbol{w}}_{1}^{\\top}\\ensuremath{\\boldsymbol{x}}+b_{1})}\\\\ {\\vdots}\\\\ {\\sigma(\\ensuremath{\\boldsymbol{w}}_{m}^{\\top}\\ensuremath{\\boldsymbol{x}}+b_{m})\\right]\\right\\rangle,\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "where $\\mathbf{T}=\\boldsymbol{v}\\mathbf{K}^{\\top}$ and $\\sigma(W X+b\\mathbf{1}_{N}^{\\top})$ denotes the $m\\times N$ matrix whose $(i,j)$ -th entry is $\\sigma(\\pmb{w}_{i}^{\\top}\\pmb{x}_{j}+$ $b_{i}$ ); see Appendix E for full derivation. We refer to $\\mathbf{T}$ as the attention matrix. ", "page_idx": 5}, {"type": "text", "text": "2.3 Pretraining: Empirical Risk Minimization via Gradient Descent ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "We pretrain the transformer (2.6) by the gradient-based learning algorithm specified in Algorithm 1, which is inspired by the layer-wise training procedure studied in the neural network theory literature [AAM22, DLS22, $\\mathbf{\\dot{B}E S}^{+}22\\mathbf{\\dot{J}}$ . In particular, we update the trainable parameters in a sequential manner. ", "page_idx": 5}, {"type": "text", "text": "Input :Learning rate $\\eta_{1}$ , weight decay $\\lambda_{1},\\lambda_{2}$ , prompt length $N_{1},N_{2}$ , number of tasks $T_{1},T_{2}$ , attention matrix initialization scale $\\gamma$ .   \n1 Initialize $w_{j}^{(0)}\\sim\\mathrm{Unif}(\\mathbb{S}^{d-1})\\;(j\\in[m]);\\,b_{j}^{(0)}\\sim\\mathrm{Unif}([-1,1])\\;(j\\in[m]);$ $\\Gamma_{j,j}^{(0)}\\sim\\mathrm{Unif}(\\{\\pm\\gamma\\})\\;(j\\in[m])$ and $\\Gamma_{i,j}^{(0)}=0\\;(i\\neq j\\in[m])$ . ", "page_idx": 6}, {"type": "text", "text": "2 Stage I: Gradient descent for MLP layer ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "Draw data $\\{(\\pmb{x}_{1}^{t},y_{1}^{t},\\ldots,\\pmb{x}_{N_{1}}^{t},y_{N_{1}}^{t},\\pmb{x}^{t},y^{t})\\}_{t=1}^{T_{1}}$ with prompt length $N_{1}$ . $\\begin{array}{r}{w_{j}^{(1)}\\gets w_{j}^{(0)}-\\eta_{1}\\Big[\\nabla_{w_{j}^{(0)}}\\frac{1}{T_{1}}\\sum_{t=1}^{T_{1}}(y^{t}-f(X^{t},y^{t},x^{t};W^{(0)},\\mathbf{I}^{(0)},b^{(0)}))^{2}+\\lambda_{1}w_{j}^{(0)}\\Big].}\\end{array}$ ", "page_idx": 6}, {"type": "text", "text": "5 Initialize $b_{j}\\sim\\mathrm{Unif}([-\\log d,\\log d])$ . ", "page_idx": 6}, {"type": "text", "text": "$\\mathbf{6}$ Stage II: Empirical risk minimization for attention layer ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "7 Draw data $\\{(\\pmb{x}_{1}^{t},y_{1}^{t},.~.~.,\\pmb{x}_{N_{2}}^{t},y_{N_{2}}^{t},\\pmb{x}^{t},y^{t})\\}_{t=T_{1}+1}^{T_{1}+T_{2}}$ with prompt length $N_{2}$ .   \n8 \u0393\u2217\u2190ar $\\begin{array}{r}{\\operatorname*{gmin}_{\\mathbf{T}}\\frac{1}{T_{2}}\\sum_{t=T_{1}+1}^{T_{1}+T_{2}}(y^{t}-f(X^{t},y^{t},x^{t};W^{(1)},\\mathbf{r},b))^{2}+\\frac{\\lambda_{2}}{2}\\|\\mathbf{r}\\|_{F}^{2}.}\\end{array}$ ", "page_idx": 6}, {"type": "text", "text": "Output :Prediction function $\\mathbf{\\alpha}x\\rightarrow f(X,y,x;W^{(1)},\\Gamma^{*},b)$ . ", "page_idx": 6}, {"type": "text", "text": "\u2022 In Stage I we optimize the parameters of the MLP (embedding) layer, which is a non-convex problem due to the nonlinear activation function. To circumvent the nonlinear training dynamics, we follow the recipe in recent theoretical analyses of gradient-based feature learning [DLS22, $\\mathrm{BES}^{+}22$ , $\\mathrm{BEG}^{+}22\\bar{]}$ ; specifically, we zoom into the early phase of optimization by taking one gradient step on on the regularized empirical risk. As we will see, the first gradient step already provides a reliable estimate of the target subspace $\\boldsymbol{S}$ , which enables the subsequent attention layer to implement a sample-efficient in-context learning algorithm. ", "page_idx": 6}, {"type": "text", "text": "\u2022 In Stage II we train the attention layer, which is a convex problem and the global minimizer can be efficiently found. We show that the optimized attention matrix $\\mathbf{T}$ performs regression on the polynomial basis (defined by the MLP embedding), which can be seen as an in-context counterpart to the second-layer training (to learn the polynomial link) in [DLS22, AAM23, OSSW24]. ", "page_idx": 6}, {"type": "text", "text": "3 Transformer Learns Single-index Models In-Context ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "3.1 Main Theorem ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "Our main theorem characterizes the pretraining and in-context sample complexity of the transformer with MLP layer (2.6) optimized by layer-wise gradient-based pretraining outlined in Algorithm 1. ", "page_idx": 6}, {"type": "text", "text": "Theorem 1. Given Assumption $^{\\,l}$ and $r\\lesssim d^{\\frac12}$ . We pretrain the transformer (2.6) using Algorithm $^{\\,l}$ with $\\begin{array}{r}{m\\;=\\;\\tilde{\\Omega}(r^{P}),T_{1}\\;=\\;\\tilde{\\Omega}(d^{Q+1}r^{Q}),\\;\\tilde{N}_{1}T_{1}\\;=\\;\\tilde{\\Omega}(d^{2Q+1}r),\\;\\gamma\\;\\asymp\\;\\frac{1}{m^{\\frac{3}{2}}r^{\\frac{1}{2}}d^{Q}},\\eta_{1}\\;\\asymp\\;m^{\\frac{3}{2}}r d^{2Q-\\frac{1}{2}}}\\end{array}$ $(\\log d)^{-C_{\\eta}}$ for constant $C_{\\eta}$ . Then, for appropriately chosen regularization parameters $\\lambda_{1},\\lambda_{2}>0$ , with probability at least $\\it0.99$ over the data distribution and random initialization, the ICL prediction risk (2.1) with test prompt length $N^{*}$ for the output $f$ of Algorithm $^{\\,l}$ can be upper bounded as ", "page_idx": 6}, {"type": "equation", "text": "$$\n\\mathcal{R}_{N^{*}}(f)-\\tau=\\tilde{O}\\left(\\sqrt{\\frac{r^{3P}}{m}+r^{4P}\\bigg(\\frac{1}{T_{2}}+\\frac{1}{N_{2}}+\\frac{1}{N^{*}}\\bigg)}\\right).\n$$", "text_format": "latex", "page_idx": 6}, {"type": "text", "text": "Theorem 1 suggests that to achieve low in-context prediction risk, it is sufficient to set ${\\cal T}_{1},{\\cal N}_{1}=$ $\\tilde{\\Omega}\\big(d^{\\Theta(Q)}\\big)$ , and $\\bar{m},T_{2},N_{2},N^{*}=\\tilde{\\Omega}(r^{\\Theta(P)})$ . Observe that the pretraining complexity $T_{1},N_{1}$ scales with the ambient dimensionality $d$ , but the in-context sample complexity $N^{*}$ only scales with the dimensionality of the function class $r\\ll d$ . This illustrates the in-context efficiency of pretrained transformers and aligns with our observations in the GPT-2 experiment reported in Figure 1. ", "page_idx": 6}, {"type": "text", "text": "Remark 3. We make the following remarks. ", "page_idx": 6}, {"type": "text", "text": "\u2022 The sample complexity highlights different roles of the two sources of low dimensionality in our setting. The low dimensionality of single-index $f_{*}$ entails that the pretraining cost scales as $N\\gtrsim\\breve{d}^{\\Theta(Q)}$ , which is consistent with prior analyses on gradient-based feature learning [BAGJ21, DNGL23]. On the other hand, the low dimensionality of function class (i.e., $\\beta$ lies in $r$ -dimensional subspace) leads to an in-context sample complexity that scales as $N^{*}\\gtrsim r^{\\Theta(P)}$ , which, roughly speaking, is the rate achieved by polynomial regression or kernel models on $r$ -dimensional data. ", "page_idx": 6}, {"type": "text", "text": "", "page_idx": 7}, {"type": "text", "text": "\u2022 The multiplicative scaling between $N_{1}$ and $T_{1}$ in the sample complexity suggests that one can tradeoff between the two quantities, that is, pretraining on more diverse tasks (larger $T_{1}$ ) can reduce the required pretraining context length $N_{1}$ . ", "page_idx": 7}, {"type": "text", "text": "\u2022 Similar low-dimensional function class has been considered in the setting of transfer or multi-task learning with two-layer neural networks [DLS22, $C H S^{+}23J;$ , where the first-layer weights identify the span of all target functions, and the second-layer approximates the nonlinearity. However, the crucial difference is that we do not update the network parameters based on the in-context examples; instead, the single-index learning is implemented by the forward pass of the transformer. ", "page_idx": 7}, {"type": "text", "text": "Comparison against baseline methods. Below we summarize the statistical complexity of commonly-used estimators that only have access to $N^{*}$ in-context examples, but not the pretraining data. Note that the in-context sample complexity all depends on the ambient dimensionality $d\\gg r$ . ", "page_idx": 7}, {"type": "text", "text": "\u2022 Kernel models. Recall that our target function is a degree- $P$ polynomial, and hence kernel ridge regression requires $N^{*}\\gtrsim d^{P}$ in-context examples [GMMM21, DWY21]. ", "page_idx": 7}, {"type": "text", "text": "\u2022 CSQ learners. The correlational statistical query (CSQ) lower bound suggests that an algorithm making use of correlational information requires $N^{*}\\gtrsim d^{\\Theta(Q)}$ samples to learn a single-index model with information exponent $Q$ [DLS22, AAM22]. This sample complexity can be achieved by online SGD training of shallow neural network [BAGJ21, DNGL23]. ", "page_idx": 7}, {"type": "text", "text": "\u2022 Information theoretic limit. Since the single-index model (1.1) contains $d$ unknown parameters, we can infer an information theoretic lower bound of $N^{*}\\gtrsim d$ samples to estimate this function. This complexity can be achieved (up to polylog factors) by tailored SQ algorithms [CM20, DPVLB24] or modified gradient-base training of neural network [LOSW24, $\\mathrm{ADK}^{+}24$ , JMS24]. ", "page_idx": 7}, {"type": "text", "text": "3.2 Proof Sketch of Main Theorem ", "text_level": 1, "page_idx": 7}, {"type": "text", "text": "We provide a sketch of derivation for Theorem 1. The essential mechanism is outlined as follows: after training the MLP embedding via one gradient descent step, the MLP parameters $\\{{\\pmb w}_{j}^{(1)}\\}$ align with the common subspace of the target functions $\\boldsymbol{S}$ . Subsequently, the (linear) attention module estimates the input-output relation $f_{*}$ (which varies across tasks) on this $r$ -dimensional subspace. We explain these two ingredients in the ensuing sections. ", "page_idx": 7}, {"type": "text", "text": "3.2.1 Training the MLP Layer ", "text_level": 1, "page_idx": 7}, {"type": "text", "text": "We first show that the first gradient descent step on $W$ results in significant alignment with the target subspace $\\boldsymbol{S}$ , using a proof strategy pioneered in [DLS22]. Note that under sufficiently small initialization and appropriately chosen weight decay, we have ", "page_idx": 7}, {"type": "equation", "text": "$$\n\\begin{array}{r}{{\\pmb w}_{j}^{(1)}\\simeq\\eta_{1}\\cdot\\frac{2}{T_{1}}\\sum_{t=1}^{T_{1}}y^{t}\\nabla_{{\\pmb w}_{j}^{(0)}}f(X^{t},y^{t},x^{t};W^{(0)},{\\pmb\\Gamma}^{(0)},b^{(0)}).}\\end{array}\n$$", "text_format": "latex", "page_idx": 7}, {"type": "text", "text": "The key observation is that this correlation between $y$ and the gradient of model output contains information of $\\boldsymbol{S}$ . We establish the concentration of this empirical gradient around the expected (population) one, which determines the required rates of $T_{1}$ and $N_{1}$ . For the population gradient, we make use of the Hermite expansion of $\\sigma_{b_{j}}(z)\\,=\\,\\sigma(z+b_{j})$ and show that its leading term is proportional to $\\left[\\!\\!\\begin{array}{l}{\\mathbf{\\boldsymbol{w}}_{1:r}^{(0)}}\\\\ {\\mathbf{\\boldsymbol{0}}_{d-r}}\\end{array}\\!\\!\\right]$ , which is contained in the target subspace $\\boldsymbol{S}$ ; see Appendix B for details. ", "page_idx": 7}, {"type": "text", "text": "3.2.2 Attention Matrix with Good Approximation Property ", "text_level": 1, "page_idx": 7}, {"type": "text", "text": "Next we construct the attention matrix $\\bar{\\Gamma}$ which satisfies the following approximation property: Proposition 2 (Informal). There exists $\\bar{\\Gamma}$ such that with high probability, ", "page_idx": 7}, {"type": "equation", "text": "$$\n\\Big|f(X^{t},y^{t},x^{t};W^{(1)},\\bar{\\Gamma},b)-y^{t}\\Big|-\\tau=\\tilde{O}\\bigg(\\sqrt{r^{3P}/m+r^{2P}/N_{2}}\\bigg)\n$$", "text_format": "latex", "page_idx": 7}, {"type": "text", "text": "for all $t\\in\\{T_{1}+1,\\ldots,T_{2}\\}$ . Moreover, we have $\\|\\bar{\\mathbf{T}}\\|_{F}=\\tilde{O}\\big(r^{2P}/m\\big)$ . ", "page_idx": 7}, {"type": "text", "text": "We provide an intuitive explanation of this construction. Recall that the target function can be written in its Hermite expansion $\\begin{array}{r}{\\bar{f}_{*}(\\pmb{x})=\\sum_{i=Q}^{P}\\frac{c_{i}}{i!}\\mathrm{He}_{i}\\big(\\langle\\pmb{x},\\beta\\rangle\\big)}\\end{array}$ . We build an orthonormal basis for $f_{*}$ as follows. Let $\\{\\beta_{1},\\ldots,\\beta_{r}\\}$ be an orthonormal basis of $\\boldsymbol{S}$ . Then, any $f_{*}$ can be expressed as a linear combination of functions in $\\begin{array}{r}{\\mathcal{H}=\\{\\prod_{i=1}^{r}\\mathrm{He}_{p_{j}}(\\langle\\beta_{j},\\cdot\\rangle)\\;|\\;Q\\leq p_{1}+\\cdot\\cdot\\cdot+p_{r}\\leq P,p_{1}\\geq0,\\dotsc,p_{r}\\geq0\\}}\\end{array}$ $0\\}$ , where $\\mathbb{E}_{{\\pmb x}\\sim\\mathcal{N}(0,I_{d})}[h({\\pmb x})h^{\\prime}({\\pmb x})]=\\\"\\mathbb{I}_{{\\pmb h}={\\pmb h}^{\\prime}}$ holds for $h,h^{\\prime}\\in\\mathcal{H}$ . We write $\\mathcal{H}=\\{h_{1},\\dotsc,h_{B_{P}}\\}$ with $B_{P}=|\\mathcal{H}|=\\Theta(r^{P})$ , and observe that a two-layer neural network can be constructed to approximate each $h_{n}$ . Specifically, there exist vectors $\\pmb{a}^{1},\\dots,\\pmb{a}^{B_{P}}\\in\\mathbb{R}^{m}$ such that $\\begin{array}{r}{\\sum_{j=1}^{m}a_{j}^{n}\\sigma\\big(\\langle{\\pmb w}_{j}^{(1)},{\\pmb x}\\rangle+b_{j}\\big)\\simeq}\\end{array}$ $h_{n}(x)$ for each $n\\in[B_{P}]$ . ", "page_idx": 8}, {"type": "text", "text": "Consequently, we can build the desired attention matrix using coefficients $\\mathbf{\\boldsymbol{a}}^{1},\\ldots,\\mathbf{\\boldsymbol{a}}^{B_{P}}$ . Let $\\mathbf{A}=$ $\\left(\\pmb{a}^{1}\\quad\\therefore\\cdot\\cdot\\quad\\mathring{\\pmb{a}}^{B_{P}}\\right)\\in\\mathbb{R}^{m\\times B_{P}}$ and $\\bar{\\mathbf{T}}=A A^{\\top}$ , the attention module can recover the true function as $\\begin{array}{r l}&{\\quad\\Big\\langle\\frac{1}{N_{2}}\\bar{\\Gamma}\\sigma(W^{(1)}X^{t}+b\\mathbf{1}_{N_{2}}^{\\top})y^{t},\\sigma(W^{(1)}x+b)\\Big\\rangle}\\\\ &{=\\sum_{n=1}^{B_{P}}\\Big(\\frac{1}{N_{2}}\\sum_{i=1}^{N_{2}}\\Bigl(\\sum_{j=1}^{m}a_{j}^{n}\\sigma\\bigl(\\bigl\\langle w_{j}^{(1)},\\mathbf{x}_{i}\\bigr\\rangle+b_{j}\\bigr)\\Bigr)y_{i}\\Bigr)\\Bigl(\\sum_{j=1}^{m}a_{j}^{n}\\sigma\\bigl(\\bigl\\langle w_{j}^{(1)},\\mathbf{x}\\bigr\\rangle+b_{j}\\bigr)\\Bigr)}\\\\ &{\\overset{(3)}{\\simeq}\\sum_{n=1}^{B_{P}}\\Bigl(\\frac{1}{N_{2}}\\sum_{i=1}^{N_{2}}h_{n}(x_{i})y_{i}\\Bigr)h_{n}(x)\\overset{(b)}{\\simeq}\\sum_{n=1}^{B_{P}}\\mathbb{E}[h_{n}(x)f_{*}(x)]h_{n}(x)=f_{*}(x).}\\end{array}$ (3. ", "page_idx": 8}, {"type": "text", "text": "", "page_idx": 8}, {"type": "text", "text": "Roughly speaking, the self-attention architecture computes the correlation between the target function and basis element $h_{i}$ to estimate the corresponding coefficient in this basis decomposition. We evaluate (a) the approximation error of two-layer neural network in Appendix C.1, and (b) the discrepancy between the empirical and true correlations in Appendix C.2. ", "page_idx": 8}, {"type": "text", "text": "Note that the approximation errors and the norm of $\\bar{\\Gamma}$ at this stage scale only with $r$ up to polylogarithmic terms; this is because $W^{(1)}$ already identifies the low-dimensional target subspace $\\boldsymbol{S}$ . Consequently, the in-context sample size $N^{*}$ only scales with the target dimensionality $r\\ll d$ . ", "page_idx": 8}, {"type": "text", "text": "3.2.3 Generalization Error Analysis ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "Finally, we transfer the learning guarantee from the constructed $\\bar{\\Gamma}$ to the (regularized) empirical risk minimization solution $\\mathbf{T}^{*}$ . By the equivalence between optimization with $L_{2}$ regularization and norm-constrained optimization, there exists $\\lambda_{2}$ such that $\\|\\mathbf{T}^{*}\\|_{F}\\leq\\|\\bar{\\mathbf{T}}\\|_{F}$ and the empirical ICL loss by $\\mathbf{T}^{*}$ is no larger than that of $\\bar{\\Gamma}$ . Hence, we can bound the generalization error by $\\mathbf{T}^{*}$ using a standard Rademacher complexity bound for norm-constrained transformers provided in Appendix D.1. One caveat here is that the context length $N^{*}$ at test time may differ from training time; hence we establish a context length-free generalization bound, which is discussed in Appendix D.2. ", "page_idx": 8}, {"type": "text", "text": "4 Synthetic Experiments ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "4.1 Experimental Setting ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "We pretrain a GPT-2 model $[\\mathrm{RWC}^{+}19]$ to learn the Gaussian single-index function class (1.1). Specifically, we consider the 12-layer architecture (with $22.3\\mathbf{M}$ parameters) used in [GTLV22] for in-context linear regression. The pretraining data is generated from random single-index models: for each task $t$ , the context $\\{(\\pmb{x}_{i}^{t},y_{i}^{t})\\}_{i=1}^{N}$ is generated as $\\pmb{x}_{i}^{t}$ i.i\u223c.d. $\\mathcal{N}(0,I_{d})$ and $\\begin{array}{r l r}{y_{i}^{t}\\!}&{{}=}&{\\!\\sum_{i=Q}^{P}\\frac{c_{i}^{t}}{i!}\\mathrm{He}_{i}\\big(\\langle\\pmb{x}_{i}^{t},\\beta^{t}\\rangle\\big)}\\end{array}$ , where $(c_{Q}^{t},\\ldots c_{P}^{t})$ i.i\u223c.d. $\\mathrm{Unif}\\Big\\{(c_{Q},\\dotsc.\\dotsc c_{P})|\\sum_{i=Q}^{P}\\frac{c_{i}^{2}}{i!}=1\\Big\\}$ and $\\beta^{t\\mathrm{~i.i.d.}}\\operatorname{Unif}\\left\\{\\beta|\\beta=[\\beta_{1},\\dots,\\beta_{r},0,\\dots,0]^{\\top}|,\\|\\beta\\|=1\\right\\}$ . See Appendix $\\boldsymbol{\\mathrm{F}}$ for further details. ", "page_idx": 8}, {"type": "text", "text": "4.2 Empirical Findings ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "Ambient dimension-free sample complexity. In Figure 2 we examine how the in-context sample complexity of the GPT-2 model depends on the ambient dimensionality $d$ and the function class dimensionality $r$ . For each problem setting the model is pretrained for 100, 000 steps using the data of degree $P=4$ and information exponent $Q=2$ (see Appendix F for details). In Figure 2(a) we observe that for fixed $r=8$ , varying the ambient dimensionality $d=16$ , 32, 64 leads to negligible change in the model performance for the in-context phase. In contrast, Figure 2(b) illustrates that for fixed $d$ , the required sample size $N^{*}$ scales with the dimensionality of the function class $r=2,4,8$ . This confirms our theoretical finding that transformers can adapt to low-dimensional structure of the distribution of target functions via gradient-based pretraining. ", "page_idx": 8}, {"type": "image", "img_path": "uHcG5Y6fdB/tmp/62f6d7f398bccb2e57d0a6ceecf72d0ce073eaca66cfd63cdd3963dce4ca2e69.jpg", "img_caption": ["Figure 2: In-context sample complexity of GPT-2 model pretrained on Gaussian single-index function (see Section 4.1 for details) of degree-4 polynomial. Observe that $(a)$ the ICL risk curve overlaps for different ambient dimensions $d$ but the same target (subspace) dimensionality $r$ , and $(b)$ the required sample size $N^{*}$ becomes larger as $r$ increases. "], "img_footnote": [], "page_idx": 9}, {"type": "text", "text": "Superiority over baseline algorithms. In Figure 1 we compare the in-context sample complexity of the GPT-2 model pretrained by data of $Q\\,=\\,3$ and $P\\,=\\,2$ against two baseline algorithms that directly learn $f_{*}$ on the test prompt: $(i)$ kernel ridge regression with the Gaussian RBF kernel $k(\\pmb{x},\\pmb{x}^{\\prime})\\,=\\,\\exp\\bigl(-\\|\\pmb{x}-\\pmb{x}^{\\prime}\\|^{2}/\\sigma^{2}\\bigr)$ , and $(i i)$ two-layer neural network with ReLU activation $\\begin{array}{r}{f_{\\mathrm{NN}}({\\pmb x})\\;=\\;\\frac{1}{m}\\sum_{i=1}^{m}a_{i}\\sigma(\\langle{\\pmb x},{\\pmb w}_{i}\\rangle)}\\end{array}$ trained by the Adam optimizer [KB15]. We observe that for $r\\,=\\,8,d\\,=\\,16,32$ , the pretrained transformer outperforms both KRR and two-layer NN; moreover, the performance of these two baseline algorithms deteriorates significantly as the ambient dimensionality $d$ becomes larger. ", "page_idx": 9}, {"type": "text", "text": "5 Conclusion and Future Direction ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "We study the complexity of in-context learning for the Gaussian single-index models using a pretrained transformer with nonlinear MLP layer. We provide an end-to-end analysis of gradient-based pretraining and establish a generalization error bound that takes into account the number of pretraining tasks, the number of pretraining and in-context examples, and the network width. Our analysis suggests that when the distribution of target functions exhibits low-dimensional structure, transformers can identify and adapt to such structure during pretraining, whereas any algorithm that only has access to the test prompt necessarily requires a larger sample complexity. ", "page_idx": 9}, {"type": "text", "text": "We outline a few limitations and possible future directions. ", "page_idx": 9}, {"type": "text", "text": "\u2022 The in-context sample complexity we derived $r^{\\Theta(P)}$ corresponds to that of polynomial regression or kernel methods in $r$ -dimensional space. This rate is natural as discussed in Section 3.2.2, where the linear self-attention module extracts the coefficients with respect to fixed basis functions (of size $r^{\\Theta(P)}$ ). An interesting question is whether transformers can implement a more efficient in-context algorithm that matches the complexity of gradient-based feature learning in $r$ dimensions. This can be achieved if the pretrained model learns features in-context. \u2022 Our pretraining complexity is based on one GD step analysis similar to [DLS22, $\\mathrm{BES}^{+}22]$ which makes use of the correlational information; hence the information exponent of the link functions plays an important role. We conjecture that the sample complexity can be improved if we modify the pretraining procedure or training objective, as done in $[\\mathrm{D\\bar{T}A^{+}}2\\bar{4}$ , LOSW24, $\\mathrm{ADK}^{+}24$ , JMS24]. ", "page_idx": 9}, {"type": "text", "text": "Acknowledgement ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "KO was partially supported by JST, ACT-X Grant Number JPMJAX23C4. TS was partially supported by JSPS KAKENHI (24K02905) and JST CREST (JPMJCR2015). This research is unrelated to DW\u2019s work at xAI. ", "page_idx": 9}, {"type": "text", "text": "References ", "text_level": 1, "page_idx": 10}, {"type": "text", "text": "[AAM22] Emmanuel Abbe, Enric Boix Adsera, and Theodor Misiakiewicz. The mergedstaircase property: a necessary and nearly sufficient condition for sgd learning of sparse functions on two-layer neural networks. In Conference on Learning Theory, pages 4782\u20134887. PMLR, 2022.   \n[AAM23] Emmanuel Abbe, Enric Boix Adsera, and Theodor Misiakiewicz. SGD learning on neural networks: leap complexity and saddle-to-saddle dynamics. In Conference on Learning Theory, pages 2552\u20132623. PMLR, 2023.   \n[ACDS23] Kwangjun Ahn, Xiang Cheng, Hadi Daneshmand, and Suvrit Sra. Transformers learn to implement preconditioned gradient descent for in-context learning. Advances in Neural Information Processing Systems, 36, 2023.   \n$[\\mathrm{ACS}^{+}23]$ Kwangjun Ahn, Xiang Cheng, Minhak Song, Chulhee Yun, Ali Jadbabaie, and Suvrit Sra. Linear attention is (maybe) all you need (to understand transformer optimization). arXiv preprint arXiv:2310.01082, 2023.   \n$[\\mathrm{ADK}^{+}24]$ Luca Arnaboldi, Yatin Dandi, Florent Krzakala, Luca Pesce, and Ludovic Stephan. Repetita iuvant: Data repetition allows sgd to learn high-dimensional multi-index functions. arXiv preprint arXiv:2405.15459, 2024.   \n$[\\mathrm{ASA}^{+}22]$ ] Ekin Aky\u00fcrek, Dale Schuurmans, Jacob Andreas, Tengyu Ma, and Denny Zhou. What learning algorithm is in-context learning? investigations with linear models. arXiv preprint arXiv:2211.15661, 2022.   \n[BAGJ21] Gerard Ben Arous, Reza Gheissari, and Aukosh Jagannath. Online stochastic gradient descent on non-convex losses from high-dimensional inference. The Journal of Machine Learning Research, 22(1):4788\u20134838, 2021.   \n[BBPV23] Alberto Bietti, Joan Bruna, and Loucas Pillaud-Vivien. On learning Gaussian multiindex models with gradient flow. arXiv preprint arXiv:2310.19793, 2023.   \n[BBSS22] Alberto Bietti, Joan Bruna, Clayton Sanford, and Min Jae Song. Learning single-index models with shallow neural networks. Advances in Neural Information Processing Systems, 35, 2022.   \n$[\\mathbf{BCW}^{+}23]$ Yu Bai, Fan Chen, Huan Wang, Caiming Xiong, and Song Mei. Transformers as statisticians: Provable in-context learning with in-context algorithm selection. Advances in Neural Information Processing Systems, 36, 2023.   \n$[{\\mathbf{B}}{\\mathbf{E}}{\\mathbf{G}}^{+}22]$ Boaz Barak, Benjamin Edelman, Surbhi Goel, Sham Kakade, Eran Malach, and Cyril Zhang. Hidden progress in deep learning: Sgd learns parities near the computational limit. Advances in Neural Information Processing Systems, 35, 2022.   \n$[\\mathbf{BES}^{+}22]$ Jimmy Ba, Murat A Erdogdu, Taiji Suzuki, Zhichao Wang, Denny Wu, and Greg Yang. High-dimensional asymptotics of feature learning: How one gradient step improves the representation. Advances in Neural Information Processing Systems, 35, 2022.   \n$[\\mathbf{B}\\mathbf{E}\\mathbf{S}^{+}23]$ Jimmy Ba, Murat A Erdogdu, Taiji Suzuki, Zhichao Wang, and Denny Wu. Learning in the presence of low-dimensional structure: A spiked random matrix perspective. Advances in Neural Information Processing Systems, 36, 2023.   \n$\\mathbf{\\left.BKM^{+}19\\right]}$ Jean Barbier, Florent Krzakala, Nicolas Macris, L\u00e9o Miolane, and Lenka Zdeborov\u00e1. Optimal errors and phase transitions in high-dimensional generalized linear models. Proceedings of the National Academy of Sciences, 116(12):5451\u20135460, 2019. [BL19] Yu Bai and Jason D Lee. Beyond linearization: On quadratic and higher-order approximation of wide neural networks. arXiv preprint arXiv:1910.01619, 2019.   \n$[{\\mathbf{B}}{\\mathbf{M}}{\\mathbf{R}}^{+}20]$ Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared D Kaplan, Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell, et al. Language models are few-shot learners. Advances in Neural Information Processing Systems, 33, 2020. ", "page_idx": 10}, {"type": "text", "text": "", "page_idx": 11}, {"type": "text", "text": "[BMZ23] Rapha\u00ebl Berthier, Andrea Montanari, and Kangjie Zhou. Learning time-scales in two-layers neural networks. arXiv preprint arXiv:2303.00055, 2023. [CCS23] Xiang Cheng, Yuxin Chen, and Suvrit Sra. Transformers implement functional gradient descent to learn non-linear functions in context. arXiv preprint arXiv:2312.06528, 2023. $[\\mathrm{CHS}^{+}23]$ ] Liam Collins, Hamed Hassani, Mahdi Soltanolkotabi, Aryan Mokhtari, and Sanjay Shakkottai. Provable multi-task representation learning by two-layer relu neural networks. arXiv preprint arXiv:2307.06887, 2023. [CM20] Sitan Chen and Raghu Meka. Learning polynomials in few relevant dimensions. In Conference on Learning Theory, pages 1161\u20131227. PMLR, 2020.   \n[CSWY24a] Siyu Chen, Heejune Sheen, Tianhao Wang, and Zhuoran Yang. Training dynamics of multi-head softmax attention for in-context learning: Emergence, convergence, and optimality. arXiv preprint arXiv:2402.19442, 2024.   \n[CSWY24b] Siyu Chen, Heejune Sheen, Tianhao Wang, and Zhuoran Yang. Unveiling induction heads: Provable training dynamics and feature learning in transformers. arXiv preprint arXiv:2409.10559, 2024. [DH18] Rishabh Dudeja and Daniel Hsu. Learning single-index models in gaussian space. In Conference On Learning Theory, pages 1887\u20131930. PMLR, 2018. [DLS22] Alexandru Damian, Jason Lee, and Mahdi Soltanolkotabi. Neural networks can learn representations with gradient descent. In Conference on Learning Theory, pages 5413\u20135452. PMLR, 2022. [DNGL23] Alex Damian, Eshaan Nichani, Rong Ge, and Jason D. Lee. Smoothing the landscape boosts the signal for SGD: Optimal sample complexity for learning single index models. Advances in Neural Information Processing Systems, 36, 2023.   \n[DPVLB24] Alex Damian, Loucas Pillaud-Vivien, Jason D Lee, and Joan Bruna. The computational complexity of learning gaussian single-index models. arXiv preprint arXiv:2403.05529, 2024. $[\\mathrm{DSD}^{+}22]$ Damai Dai, Yutao Sun, Li Dong, Yaru Hao, Shuming Ma, Zhifang Sui, and Furu Wei. Why can gpt learn in-context? language models implicitly perform gradient descent as meta-optimizers. arXiv preprint arXiv:2212.10559, 2022. $[\\mathrm{DTA}^{+}24]$ Yatin Dandi, Emanuele Troiani, Luca Arnaboldi, Luca Pesce, Lenka Zdeborov\u00e1, and Florent Krzakala. The benefits of reusing batches for gradient descent in two-layer networks: Breaking the curse of information and leap exponents. arXiv preprint arXiv:2402.03220, 2024. [DWY21] Konstantin Donhauser, Mingqi Wu, and Fanny Yang. How rotational invariance of common kernels prevents generalization in high dimensions. In International Conference on Machine Learning, pages 2804\u20132814. PMLR, 2021.   \n$[\\mathrm{GHM}^{+}23]$ ] Tianyu Guo, Wei Hu, Song Mei, Huan Wang, Caiming Xiong, Silvio Savarese, and Yu Bai. How do transformers learn in-context beyond simple functions? a case study on learning with representations. arXiv preprint arXiv:2310.10616, 2023.   \n[GMMM21] Behrooz Ghorbani, Song Mei, Theodor Misiakiewicz, and Andrea Montanari. Linearized two-layers neural networks in high dimension. The Annals of Statistics, 49(2):1029\u20131054, 2021. $[\\mathrm{GSR}^{+}24]$ Khashayar Gatmiry, Nikunj Saunshi, Sashank J Reddi, Stefanie Jegelka, and Sanjiv Kumar. Can looped transformers learn to implement multi-step gradient descent for in-context learning? In International Conference on Machine Learning, 2024. [GSS21] Friedrich G\u00f6tze, Holger Sambale, and Arthur Sinulis. Concentration inequalities for polynomials in $\\alpha$ -sub-exponential random variables. Electronic Journal of Probability, 26:1 \u2013 22, 2021. [GTLV22] Shivam Garg, Dimitris Tsipras, Percy S Liang, and Gregory Valiant. What can transformers learn in-context? a case study of simple function classes. Advances in Neural Information Processing Systems, 35, 2022. [HCL23] Yu Huang, Yuan Cheng, and Yingbin Liang. In-context convergence of transformers. arXiv preprint arXiv:2310.05249, 2023.   \n$[\\mathrm{HvMM}^{+}19]$ Evan Hubinger, Chris van Merwijk, Vladimir Mikulik, Joar Skalse, and Scott Garrabrant. Risks from learned optimization in advanced machine learning systems. arXiv preprint arXiv:1906.01820, 2019.   \n[JLLVR24] Hong Jun Jeon, Jason D Lee, Qi Lei, and Benjamin Van Roy. An information-theoretic analysis of in-context learning. arXiv preprint arXiv:2401.15530, 2024. [JMS24] Nirmit Joshi, Theodor Misiakiewicz, and Nathan Srebro. On the complexity of learning sparse functions with statistical and gradient queries. arXiv preprint arXiv:2407.05622, 2024. [KB15] Diederik P. Kingma and Jimmy Ba. Adam: A method for stochastic optimization. In International Conference on Learning Representations, 2015. [KNS24] Juno Kim, Tai Nakamaki, and Taiji Suzuki. Transformers are minimax optimal nonparametric in-context learners. arXiv preprint arXiv:2408.12186, 2024. [KS24] Juno Kim and Taiji Suzuki. Transformers learn nonlinear features in context: Nonconvex mean-field dynamics on the attention landscape. arXiv preprint arXiv:2402.01258, 2024.   \n[LLZV+24] Yue M Lu, Mary I Letey, Jacob A Zavatone-Veth, Anindita Maiti, and Cengiz Pehlevan. Asymptotic theory of in-context learning by linear attention. arXiv preprint arXiv:2405.11751, 2024.   \n[LOSW24] Jason D. Lee, Kazusato Oko, Taiji Suzuki, and Denny Wu. Neural network learns low-dimensional polynomials with sgd near the information-theoretic limit. arXiv preprint arXiv:2406.01581, 2024. $[\\mathrm{LWL}^{+}24]$ Hongkang Li, Meng Wang, Songtao Lu, Xiaodong Cui, and Pin-Yu Chen. How do nonlinear transformers learn and generalize in in-context learning? In International Conference on Machine Learning, 2024. [Mau16] Andreas Maurer. A vector-contraction inequality for rademacher complexities. In Algorithmic Learning Theory: 27th International Conference, ALT 2016, Bari, Italy, October 19-21, 2016, Proceedings 27, pages 3\u201317. Springer, 2016. [MHM23] Arvind Mahankali, Tatsunori B Hashimoto, and Tengyu Ma. One step of gradient descent is provably the optimal in-context learner with one layer of linear self-attention. arXiv preprint arXiv:2307.03576, 2023.   \n$[\\mathrm{MHPG^{+}}23]$ Alireza Mousavi-Hosseini, Sejun Park, Manuela Girotti, Ioannis Mitliagkas, and Murat A Erdogdu. Neural networks efficiently learn low-dimensional representations with SGD. In International Conference on Learning Representations, 2023.   \n[MHWSE23] Alireza Mousavi-Hosseini, Denny Wu, Taiji Suzuki, and Murat A Erdogdu. Gradientbased feature learning under structured data. Advances in Neural Information Processing Systems, 36, 2023. [MM18] Marco Mondelli and Andrea Montanari. Fundamental limits of weak recovery with applications to phase retrieval. In Conference On Learning Theory, pages 1445\u20131450. PMLR, 2018. $[\\mathbf{M}Z\\mathbf{D}^{+}23]$ ] Arvind Mahankali, Haochen Zhang, Kefan Dong, Margalit Glasgow, and Tengyu Ma. Beyond ntk with vanilla gradient descent: A mean-field analysis of neural networks with polynomial width, samples, and time. Advances in Neural Information Processing Systems, 36, 2023. ", "page_idx": 11}, {"type": "text", "text": "", "page_idx": 12}, {"type": "text", "text": "[NDL24] Eshaan Nichani, Alex Damian, and Jason D Lee. How transformers learn causal structure with gradient descent. arXiv preprint arXiv:2402.14735, 2024. [OSSW24] Kazusato Oko, Yujin Song, Taiji Suzuki, and Denny Wu. Learning sum of diverse features: computational hardness and efficient gradient-based training for ridge combinations. arXiv preprint arXiv:2406.11828, 2024. [RPCG23] Allan Ravent\u00f3s, Mansheej Paul, Feng Chen, and Surya Ganguli. Pretraining task diversity and the emergence of non-bayesian in-context learning for regression. Advances in Neural Information Processing Systems, 36, 2023. $[\\mathrm{RWC}^{+}19]$ Alec Radford, Jeff Wu, Rewon Child, David Luan, Dario Amodei, and Ilya Sutskever. Language models are unsupervised multitask learners. 2019. $[\\mathrm{SGS}^{+}24]$ Michael E Sander, Raja Giryes, Taiji Suzuki, Mathieu Blondel, and Gabriel Peyr\u00e9. How do transformers perform in-context autoregressive learning? arXiv preprint arXiv:2402.05787, 2024. [Ver18] Roman Vershynin. High-Dimensional Probability: An Introduction with Applications in Data Science. Cambridge Series in Statistical and Probabilistic Mathematics. Cambridge University Press, 2018. $[\\mathrm{VONR}^{+}23]$ Johannes Von Oswald, Eyvind Niklasson, Ettore Randazzo, Jo\u00e3o Sacramento, Alexander Mordvintsev, Andrey Zhmoginov, and Max Vladymyrov. Transformers learn in-context by gradient descent. In International Conference on Machine Learning, pages 35151\u201335174. PMLR, 2023. $[\\mathsf{V S P}^{+}17]$ Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N Gomez, \u0141 ukasz Kaiser, and Illia Polosukhin. Attention is all you need. In I. Guyon, U. Von Luxburg, S. Bengio, H. Wallach, R. Fergus, S. Vishwanathan, and R. Garnett, editors, Advances in Neural Information Processing Systems, volume 30. Curran Associates, Inc., 2017. [Wai19] Martin J Wainwright. High-Dimensional Statistics: A Non-Asymptotic Viewpoint. Cambridge University Press, 2019. $[\\mathbf{WZC}^{+}23]$ Jingfeng Wu, Difan Zou, Zixiang Chen, Vladimir Braverman, Quanquan Gu, and Peter L Bartlett. How many pretraining tasks are needed for in-context learning of linear regression? arXiv preprint arXiv:2310.08391, 2023. [ZFB23] Ruiqi Zhang, Spencer Frei, and Peter L Bartlett. Trained transformers learn linear models in-context. arXiv preprint arXiv:2306.09927, 2023. [ZWB24] Ruiqi Zhang, Jingfeng Wu, and Peter L Bartlett. In-context learning of a linear transformer block: Beneftis of the mlp component and one-step gd initialization. arXiv preprint arXiv:2402.14951, 2024. [ZZYW23] Yufeng Zhang, Fengzhuo Zhang, Zhuoran Yang, and Zhaoran Wang. What and how does in-context learning learn? bayesian model averaging, parameterization, and generalization. arXiv preprint arXiv:2305.19420, 2023. ", "page_idx": 13}, {"type": "text", "text": "Table of Contents ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "1 Introduction ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "1.1 Our Contributions 2   \n1.2 Related Works . 3 ", "page_idx": 14}, {"type": "text", "text": "2 Problem Setting ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "2.1 Data Generating Process 4   \n2.2 Student Model: Transformer with Nonlinear MLP Layer 5   \n2.3 Pretraining: Empirical Risk Minimization via Gradient Descent . 6 ", "page_idx": 14}, {"type": "text", "text": "3 Transformer Learns Single-index Models In-Context 7 ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "3.1 Main Theorem   \n3.2 Proof Sketch of Main Theorem 8 ", "page_idx": 14}, {"type": "text", "text": "4 Synthetic Experiments 9 ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "4.1 Experimental Setting 9   \n4.2 Empirical Findings 9 ", "page_idx": 14}, {"type": "text", "text": "5 Conclusion and Future Direction 10 ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "A Preliminaries 16 ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "A.1 Definition of High Probability Event 16   \nA.2 Tensor Notations 16   \nA.3 Hermite Polynomials 16   \nA.4 Other Auxiliary Lemmas 18 ", "page_idx": 14}, {"type": "text", "text": "B Proofs for the MLP Layer 19 ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "B.1 Calculation of Population Gradient 20   \nB.2 Concentration of Empirical Gradient 24 ", "page_idx": 14}, {"type": "text", "text": "C Construction of Attention Matrix 29 ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "C.1 Approximation Error of Two-layer Neural Network 29   \nC.2 Concentration of Correlation . 34   \nC.3 Proof of Proposition 2 . . 36 ", "page_idx": 14}, {"type": "text", "text": "D Generalization Error Analysis and Proof of Theorem 1 37 ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "D.1 Rademacher Complexity Bound 38   \nD.2 Prompt Length-free Generalization Bound 40   \nD.3 Proof of Theorem 1 41 ", "page_idx": 14}, {"type": "text", "text": "E Derivation of Simplified Self-attention Module 42 ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "Details of Experiments 43   \nF.1 Detailed Experimental Settings . 43   \nF.2 Experiment on Our Architecture and Algorithm 1 44 ", "page_idx": 14}, {"type": "text", "text": "A Preliminaries ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "We consider the high-dimensional setting, i.e., our result holds for all $d\\geq D$ where $D$ is a constant which does not depend on $d$ and $r$ . Throughout the proofs, we take $\\boldsymbol{S}=\\left\\{(\\boldsymbol{x}_{1},\\ldots,\\boldsymbol{x}_{r},0,\\ldots,0)^{\\top}\\ |\\right.$ $x_{1},\\ldots,x_{r}\\in\\mathbb{R}\\}$ and $\\beta\\sim\\mathrm{Unif}(\\mathbb{S}(S))=\\mathrm{Unif}(\\{(\\beta_{1},\\ldots,\\beta_{r},0,\\ldots,0)^{\\top}~|~\\beta_{1}^{2}+\\cdots+\\beta_{r}^{2}=1\\})$ ). Note that this assumption is without loss of generality by the rotational invariance of the Gaussian distribution. ", "page_idx": 15}, {"type": "text", "text": "A.1 Definition of High Probability Event ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "Definition 3. We say that an event $A$ occurs with high probability when there exists a sufficiently large constant $C^{*}$ which does not depend on $d,r$ and ", "page_idx": 15}, {"type": "equation", "text": "$$\n1-P r[A]\\leq O(d^{-C^{*}})\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "holds. ", "page_idx": 15}, {"type": "text", "text": "We implicitly assume that we can redefine the constant $C^{*}$ to be sufficiently large as needed. The lemma below is a basic example and will be used in the proofs: ", "page_idx": 15}, {"type": "text", "text": "Lemma 4. Let $x\\sim\\mathcal{N}(0,1)$ . Then, $|x|\\lesssim{\\sqrt{\\log d}}$ holds with high probability. ", "page_idx": 15}, {"type": "text", "text": "Proof. F\u221arom the tail bound of Gaussian, ${\\mathbb P}(|x|~\\ge~t)~\\le~2\\exp\\left(-t^{2}/2\\right)$ holds. Hence we get $\\mathbb{P}(|x|\\geq\\sqrt{2C^{*}\\log d})\\leq O(d^{-C^{*}})$ . \u53e3 ", "page_idx": 15}, {"type": "text", "text": "Note that $C^{*}$ can be redefined by changing the hidden constant in $|x|\\lesssim{\\sqrt{\\log d}}$ . ", "page_idx": 15}, {"type": "text", "text": "If $A_{1},\\ldots,A_{M}$ occurs with high probability where $M=O(\\mathrm{poly}(d))$ , then $A_{1}\\cap\\cdots\\cap A_{M}$ also occurs with high probability (by redefining $C^{*}$ ). In particular, throughout this paper we assume that $m,N_{1},N_{2},T_{1}^{\\bar{+}},\\bar{T_{2}^{\\bar{+}}}={\\cal O}(\\mathrm{po}\\bar{\\mathrm{ly}}(\\bar{d}))$ , which allows us to take such unions. ", "page_idx": 15}, {"type": "text", "text": "A.2 Tensor Notations ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "In this paper, a $k$ -tensor is a multidimensional array which has $k$ indices: for example, matrices are 2-tensors. Let $\\pmb{A}$ be a $k$ -tensor. $A_{i_{1},\\dots,i_{k}}$ denotes $(i_{1},\\ldots,i_{k})$ -th entry of $\\pmb{A}$ . Let $\\pmb{A}$ be a $k$ -tensor and $_B$ be a $l$ -tensor where $k\\geq l$ . $A(B)$ denotes a $k-l$ tensor whose $(i_{1},\\dots,i_{k-l})$ -th entry is ", "page_idx": 15}, {"type": "equation", "text": "$$\n{\\pmb A}({\\pmb B})_{i_{1},\\dots,i_{k-l}}=\\sum_{j_{1},\\dots,j_{l}}A_{i_{1},\\dots,i_{k-l},j_{1},\\dots,j_{l}}B_{j_{1},\\dots,j_{l}},\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "and is defined only when sizes are compatible. If $k\\,=\\,l$ , we sometimes write $A(B)$ as $A\\circ B$ or $\\langle A,B\\rangle$ . Let $\\pmb{v}\\in\\mathbb{R}^{d}$ be a vector and $k$ be a positive integer. Then, $\\pmb{v}^{\\otimes k}\\in\\mathbb{R}^{d\\times\\cdots\\times d}$ denotes a $k$ -tensor whose $(i_{1},\\ldots,i_{k})$ -th entry is $v_{i_{1}}\\cdot\\cdot\\cdot v_{i_{k}}$ . ", "page_idx": 15}, {"type": "text", "text": "Let $f(\\pmb{x}):\\mathbb{R}^{d}\\rightarrow\\mathbb{R}$ be a $d_{\\cdot}$ -variable differentiable function. A $k$ -tensor $\\nabla^{k}f({\\pmb x})$ is defined as ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\left(\\nabla^{k}f({\\pmb x})\\right)_{i_{1},\\dots,i_{k}}=\\frac{\\partial}{\\partial x_{i_{1}}}\\cdot\\cdot\\cdot\\frac{\\partial}{\\partial x_{i_{k}}}f({\\pmb x}).\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "The following properties can be verified easily. ", "page_idx": 15}, {"type": "text", "text": "Lemma 5. For tensors $\\pmb{A}$ and $_B$ , $\\|A(B)\\|_{F}^{2}\\leq\\|A\\|_{F}^{2}\\|B\\|_{F}^{2}$ holds ", "page_idx": 15}, {"type": "text", "text": "Lemma 6. For a vector $\\pmb{v}$ , $\\lVert\\pmb{v}^{\\otimes k}\\rVert_{F}^{2}=(\\lVert\\pmb{v}\\rVert_{2}^{2})^{k}$ holds ", "page_idx": 15}, {"type": "text", "text": "A.3 Hermite Polynomials ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "We frequently use (probablists\u2019) Hermite polynomials, which is defined as ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\operatorname{He}_{i}(z)=(-1)^{i}\\mathrm{e}^{\\frac{z^{2}}{2}}{\\frac{\\mathrm{d}^{i}}{\\mathrm{d}z^{i}}}\\mathrm{e}^{\\frac{-z^{2}}{2}},\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "where $i$ is a nonnegative integer. We often make use of the orthogonality property: $\\mathbb{E}_{z\\sim\\mathcal{N}(0,1)}[\\mathrm{He}_{i}(z)\\mathrm{He}_{j}(z)]~=~i!\\delta_{i,j}$ . The Hermite expansion for $\\sigma\\,:\\,\\mathbb{R}\\ \\rightarrow\\ \\mathbb{R}$ is defined as $\\begin{array}{r}{\\sigma(z)=\\sum_{i\\geq0}\\frac{a_{i}}{i!}\\mathrm{He}_{i}(z)}\\end{array}$ where $a_{i}\\stackrel{.}{=}\\mathbb{E}_{z\\sim\\mathcal{N}(0,1)}[\\sigma(z)\\mathrm{He}_{i}(z)]$ . Similarly, the multivariate Hermite ", "page_idx": 15}, {"type": "text", "text": "expansion for f : Rd \u2192 R is defined as f(z) =  i1\u22650,...,id\u22650(ia1i)1!,\u00b7.\u00b7.\u00b7.(,iidd)! $\\begin{array}{r}{f(z)\\,=\\,\\sum_{i_{1}\\geq0,\\dots,i_{d}\\geq0}\\frac{a_{i_{1},\\dots,i_{d}}}{(i_{1})!\\cdots(i_{d})!}\\mathrm{He}_{i_{1}}(z_{1})\\cdot\\cdot\\cdot\\mathrm{He}_{i_{d}}(z_{d}),}\\end{array}$ where $a_{i_{1},\\dots,i_{d}}=\\mathbb{E}_{z_{1},\\dots,z_{d}\\sim\\mathcal{N}(0,1)}[f(z)\\mathrm{He}_{i_{1}}(z_{1})\\cdot\\cdot\\cdot\\mathrm{He}_{i_{d}}(z_{d})]$ . The coefficient $a_{i_{1},\\dots,i_{d}}$ can also be $\\begin{array}{r}{a_{i_{1},\\dots,i_{d}}=\\mathbb{E}_{z_{1},\\dots,z_{d}\\sim\\mathcal{N}(0,1)}\\Bigg[\\frac{\\partial^{i_{1}}}{\\partial z_{1}^{i_{1}}}\\cdot\\cdot\\cdot\\frac{\\partial^{i_{d}}}{\\partial z_{d}^{i_{d}}}f(z)\\Bigg]}\\end{array}$ ", "page_idx": 16}, {"type": "text", "text": "Consider $f_{*}$ in our problem setting (Assumption 1). We can bound $\\mathbb{E}[f_{*}(x)^{2}]$ and $\\mathbb{E}[f_{*}(x)^{4}]$ as follows. ", "page_idx": 16}, {"type": "text", "text": "Lemma 7. Under Assumption $^{\\,l}$ , $\\mathbb{E}_{\\pmb{x},f_{*}}[f_{*}(\\pmb{x})^{2}]=\\Theta_{d,r}(1)$ and $\\mathbb{E}_{\\pmb{x},f_{*}}[f_{*}(\\pmb{x})^{4}]=O_{d,r}(1)$ holds. Proof. From (2.2) and $P=\\Theta_{d,r}(1)$ , ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{E}_{\\mathbf{x}\\sim\\mathcal{N}(0,I_{d}),f_{*}\\sim\\mathcal{D}_{f_{*}}}\\left[f_{*}(\\pmb{x})^{2}\\right]=\\mathbb{E}_{\\mathbf{z}\\sim\\mathcal{N}(0,1),\\left\\{c_{i}\\right\\}}\\left[\\left(\\displaystyle\\sum_{i=Q}^{P}\\frac{c_{i}}{i!}\\mathrm{He}_{i}(z)\\right)^{2}\\right]}\\\\ &{\\qquad\\qquad\\qquad\\qquad\\qquad=\\mathbb{E}\\left[\\displaystyle\\sum_{i=Q}^{P}\\frac{c_{i}^{2}}{i!}\\right]}\\\\ &{\\qquad\\qquad\\qquad\\qquad\\qquad=\\Theta_{d,r}(1).}\\end{array}\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "We can bound $\\begin{array}{r}{\\mathbb{E}_{\\boldsymbol{x}}[f_{*}(\\boldsymbol{x})^{4}]=\\mathbb{E}_{\\boldsymbol{z}\\sim\\mathcal{N}(0,1),\\{\\boldsymbol{c}_{i}\\}}\\biggl[\\biggl(\\sum_{i=Q}^{P}\\frac{c_{i}}{i!}\\mathrm{He}_{i}(\\boldsymbol{z})\\biggr)^{4}\\biggr]}\\end{array}$ naively as follows: let $\\zeta_{P}^{4}=$ $\\begin{array}{r}{\\operatorname*{max}_{Q\\leq i\\leq P}\\mathbb{E}_{z\\sim N(0,1)}[\\mathrm{He}_{i}(z)^{4}]}\\end{array}$ . $\\zeta_{P}$ is an $O(1)$ quantity depending only on $P$ and $Q$ . Then, ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{E}_{z\\sim N(0,1),\\{c_{i}\\}}\\left[\\left(\\displaystyle\\sum_{i=Q}^{P}\\frac{c_{i}}{i!}\\mathrm{He}_{i}(z)\\right)^{4}\\right]}\\\\ &{\\leq\\displaystyle\\sum_{Q\\leq i,j,k,l\\leq P}\\frac{\\mathbb{E}[|c_{i}c_{j}c_{k}c_{l}|]}{i!j!k!l!}\\mathbb{E}[|\\mathrm{He}_{i}(z)\\mathrm{He}_{j}(z)\\mathrm{He}_{k}(z)\\mathrm{He}_{l}(z)|]}\\\\ &{\\leq\\displaystyle\\sum_{Q\\leq i,j,k,l\\leq P}R_{c}^{4}\\mathbb{E}_{z}[\\mathrm{He}_{i}(z)^{4}]^{1/4}\\mathbb{E}_{z}[\\mathrm{He}_{j}(z)^{4}]^{1/4}\\mathbb{E}_{z}[\\mathrm{He}_{k}(z)^{4}]^{1/4}\\mathbb{E}_{z}[\\mathrm{He}_{l}(z)^{4}]^{1/4}}\\\\ &{\\leq P^{4}R_{c}^{4}\\varsigma^{4}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "The lemma below is useful to find a basis of the set of single-index functions. ", "page_idx": 16}, {"type": "text", "text": "Lemma 8. Suppose $\\beta\\in\\mathbb{S}(S)$ . Then, ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\mathrm{He}_{p}(\\langle x,\\beta\\rangle)=\\sum_{p_{1}\\geq0,\\ldots,p_{r}\\geq0}^{p_{1}+\\cdots+p_{r}=p}\\frac{p!}{p_{1}!\\cdots p_{r}!}\\cdot\\beta_{1}^{p_{1}}\\cdot\\cdot\\cdot\\beta_{r}^{p_{r}}\\cdot\\mathrm{He}_{p_{1}}(x_{1})\\cdot\\cdot\\cdot\\mathrm{He}_{p_{r}}(x_{r})\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "holds. ", "page_idx": 16}, {"type": "text", "text": "Proof. Note that Ex1,...,xr\u223cN(0,1) \u2202i1 \u2202\u2202xiirr Hep(\u27e8x, \u03b2\u27e9) is nonzero only when \u2202xi1   \n$i_{1}\\,+\\,\\cdot\\,\\cdot\\,+\\,i_{r}\\;=\\;p$ , because $\\begin{array}{r}{\\frac{\\mathtt{j}_{1}^{i_{1}}}{x_{1}^{i_{1}}}\\cdot\\cdot\\cdot\\frac{\\partial^{i_{r}}}{\\partial x_{r}^{i_{r}}}\\mathrm{He}_{p}(\\langle x,\\beta\\rangle)\\;=\\;p(p\\,-\\,1)\\cdot\\cdot\\cdot(p\\,-\\,(i_{1}\\,+\\,\\cdot\\,\\cdot\\,+\\,i_{r})\\,+\\,}\\end{array}$ \u2202   \n$1)\\beta_{1}^{i_{1}}\\cdot\\cdot\\cdot\\beta_{r}^{i_{r}}\\mathrm{He}_{p-(i_{1}+\\cdot\\cdot\\cdot+i_{r})}(\\langle{\\pmb x},\\beta\\rangle)$ and $\\mathbb{E}_{\\boldsymbol{x}_{1},\\dots,\\boldsymbol{x}_{r}\\sim\\mathcal{N}(\\boldsymbol{0},\\boldsymbol{1})}[\\mathrm{He}_{q}(\\langle\\boldsymbol{x},\\beta\\rangle)]=\\mathbb{E}_{\\boldsymbol{z}\\sim\\mathcal{N}(\\boldsymbol{0},\\boldsymbol{1})}[\\mathrm{He}_{q}(\\boldsymbol{z})]=0$   \nif $q>0$ . When $i_{1}+\\cdot\\cdot+i_{r}=p$ , then $\\begin{array}{r}{\\mathbb{E}_{\\boldsymbol{x}_{1},\\dots,\\boldsymbol{x}_{r}\\sim\\mathcal{N}(0,1)}\\left|\\frac{\\partial^{i_{1}}}{\\partial x_{1}^{i_{1}}}\\cdot\\cdot\\cdot\\frac{\\partial^{i_{r}}}{\\partial x_{r}^{i_{r}}}\\mathrm{He}_{p}(\\langle\\pmb{x},\\beta\\rangle)\\right|=p!\\beta_{1}^{i_{1}}\\cdot\\cdot\\cdot\\beta_{r}^{i_{r}}}\\end{array}$   \nholds. Thus, from the multivariate Hermite expansion we obtain the claim. \u53e3 ", "page_idx": 16}, {"type": "text", "text": "Corollary 9. Let $\\begin{array}{r}{f_{*}(\\pmb{x})=\\sum_{i=Q}^{P}\\frac{c_{i}}{i!}\\mathrm{He}_{i}(\\langle\\pmb{x},\\beta\\rangle)}\\end{array}$ . Then, $\\mathbb{E}_{\\pmb{x}}[\\nabla^{k}f_{*}(\\pmb{x})]=c_{k}\\beta^{\\otimes k}$ if $Q\\le k\\le P$ and otherwise it is the zero tensor. ", "page_idx": 16}, {"type": "text", "text": "A.4 Other Auxiliary Lemmas ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "Lemmas on random vectors. Let $\\chi(d)$ be the distribution of $\\sqrt{z_{1}^{2}+\\cdots+z_{d}^{2}}$ where $z_{i}$ \u223c i.i.d. $\\mathcal{N}(0,1)$ . Note that the Gaussian vector $\\pmb{v}\\sim\\mathcal{N}(0,I_{d})$ can be decomposed as $\\pmb{v}~=~z w$ where $z\\,\\sim\\,\\chi(d)$ and $\\pmb{w}\\sim\\mathrm{Unif}(\\mathbb{S}^{d-1})$ , because the norm and the direction of the Gaussian vector are independent of each other. ", "page_idx": 17}, {"type": "text", "text": "Lemma 10 (Example 2.11 in [Wai19]). For $z\\sim\\chi(d)$ and $0<t<1$ , ", "page_idx": 17}, {"type": "equation", "text": "$$\n{\\mathbb{P}}[|z^{2}-d|\\geq d t]\\leq2\\exp(-d t^{2}/8)\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "holds. ", "page_idx": 17}, {"type": "text", "text": "Lemma 11. Let $C>0$ . For $\\pmb{w}\\sim\\mathrm{Unif}(\\mathbb{S}^{d-1})$ , $\\begin{array}{r}{\\|\\pmb{w}_{1:r}\\|^{2}\\leq\\frac{4C r}{d}\\log d}\\end{array}$ holds with probability at least $1-2\\exp(-d/32)-2r d^{-C}$ (then with high probability). ", "page_idx": 17}, {"type": "text", "text": "Proof. Let $z^{2}\\sim\\chi^{2}(d)$ be independent from $\\pmb{w}$ . We observe that the distribution of $z^{2}\\|\\pmb{w}_{1:r}\\|^{2}$ is the $\\chi^{2}(r)$ -distribution. First, from Lemma 10, with probability at least $1-2\\exp(-d/32)$ , $z^{2}\\geq d/2$ holds. Moreover, we can say that $(z^{\\prime})^{2}\\sim\\chi^{2}(r)$ satisfies $\\bar{(z^{\\prime})}^{2}\\leq2C r\\log d$ with high probability for sufficiently large constant: let us decompose $(z^{\\prime})^{2}=v_{1}^{2}+\\cdots+v_{r}^{2}$ where $v_{i}\\sim\\mathcal{N}(0,1)$ ; from Lemma 4, $v_{i}^{2}\\stackrel{.}{\\leq}2\\bar{C}\\log d$ holds with probability at least $1-2d^{-C}$ , and thus $(z^{\\prime})^{2}\\leq2C r\\log d$ holds with probability at least $1-2r d^{-C}$ . Taking the union bound yields the result. \u53e3 ", "page_idx": 17}, {"type": "text", "text": "Lemma 12. For $k\\geq1$ and $r\\leq d_{!}$ , ", "page_idx": 17}, {"type": "equation", "text": "$$\n\\mathbb{E}_{\\pmb{w}\\sim\\mathbb{S}^{d-1}}[\\|\\pmb{w}_{1:r}\\|^{2k}]=O_{d,r}\\bigg(\\Big(\\frac{r}{d}\\Big)^{k}\\bigg)\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "holds. ", "page_idx": 17}, {"type": "text", "text": "Proof. Since $\\Vert\\pmb{w}_{1:r}\\Vert^{2}$ is a polynomial of $\\pmb{w}$ , Lemma 24 in [DLS22] yields $\\mathbb{E}_{\\pmb{w}\\sim\\mathbb{S}^{d-1}}[\\|\\pmb{w}_{1:r}\\|^{2k}]\\lesssim$ $\\mathbb{E}_{\\pmb{w}\\sim\\mathbb{S}^{d-1}}[\\|\\pmb{w}_{1:r}\\|^{4}]^{k/2}$ . Here, $\\begin{array}{r}{\\mathbb{E}_{w\\sim\\mathrm{Unif}(\\mathbb{S}^{d-1})}[\\|w_{1:r}\\|^{4}]\\,=\\,\\frac{\\mathbb{E}_{v_{i}\\sim N(0,1)}[(v_{1}^{2}+\\cdots+v_{r}^{2})^{2}]}{\\mathbb{E}_{z\\sim\\chi^{4}(d)}[z]}\\,=\\,\\frac{3r+r(r-1)}{d(d+2)}\\,=\\,}\\end{array}$ $\\Theta(r^{2}/d^{2})$ yields the result. \u53e3 ", "page_idx": 17}, {"type": "text", "text": "Lemma 13 (Sub Gaussian vector). Let x be a $d$ -dimensional random vector and suppo\u221ase that $\\langle\\boldsymbol{u},\\boldsymbol{x}\\rangle$ is zero-mean $\\sigma^{2}$ -sub Gaussian for any $\\pmb{u}\\in\\mathbb{R}^{d}$ such that $\\|u\\|=1$ . Then, $\\|{\\pmb x}\\|=\\tilde{O}(\\sigma\\sqrt{d})$ holds with high probabillity. ", "page_idx": 17}, {"type": "text", "text": "Lemma 14. Let $X$ be a $\\sigma^{2}$ - sub Gaussian random variable and $Y$ be a bounded random variable satisfying $|Y|\\le R$ almost surely. Then, $X Y-\\mathbb{E}[X Y]$ is $O(\\sigma^{2}R^{2})$ -sub Gaussian. ", "page_idx": 17}, {"type": "text", "text": "Proof. $X Y$ is $\\sigma^{2}R^{2}$ -Gaussian by examining the tail probability. Hence, $X Y\\mathrm{~-~}\\mathbb{E}[X Y]$ is $O(\\sigma^{2}R^{2})$ -sub Gaussian from Lemma 2.6.8 in [Ver18]. ", "page_idx": 17}, {"type": "text", "text": "Polynomial concentration. We frequently use the following bounds on an output data $y$ (which is a polynomial of $\\textbf{\\em x}$ ). ", "page_idx": 17}, {"type": "text", "text": "Lemma 15 (Theorem 1.5 in [GSS21]). Let $\\pmb{x}\\sim\\mathcal{N}(0,\\pmb{I}_{n})$ and $f$ be a degree- $\\mathcal{D}$ $n$ -variable polynomial function. Then, for all $t\\geq0$ it holds that ", "page_idx": 17}, {"type": "equation", "text": "$$\n\\mathbb{P}(|f(\\pmb{x})-\\mathbb{E}_{\\pmb{x}}[f(\\pmb{x})]|\\ge t)\\le2\\exp\\left(-\\frac{1}{C_{D}M^{2}}\\operatorname*{min}_{1\\le k\\le D}\\left(\\frac{t}{\\|\\mathbb{E}_{\\pmb{x}}[\\nabla^{k}f(\\pmb{x})]\\|_{F}}\\right)^{2/k}\\right),\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "where $M$ is an absolute constant and $C_{D}$ is a constant depending only on $D\\,(i f\\,\\|\\mathbb{E}_{{\\pmb x}}[\\nabla^{k}f({\\pmb x})]\\|_{F}=0$ then we ignore the term with $k$ ). ", "page_idx": 17}, {"type": "text", "text": "Lemma 16. Let $\\pmb{x}\\sim\\mathcal{N}(0,I_{d})$ and $\\begin{array}{r}{y=f_{*}(\\pmb{x})+\\varsigma=\\sum_{i=Q}^{P}\\frac{c_{i}}{i!}\\mathrm{He}_{i}(\\langle\\pmb{x},\\beta\\rangle)+\\varsigma}\\end{array}$ where $c_{i}$ and $\\beta$ are drawn according to Assumption , and $\\varsigma\\sim\\mathrm{Unif}\\{\\pm\\tau\\}$ . Then, for any fixed $\\{c_{i}\\}$ and $\\beta$ on the support of their distributions, it holds that ", "page_idx": 17}, {"type": "equation", "text": "$$\n\\mathbb{P}(|y|\\geq t+\\tau)\\leq2\\exp\\left(-\\frac{1}{C_{P}M^{2}}\\operatorname*{min}_{2\\leq k\\leq P}\\left(\\frac{t}{R_{c}}\\right)^{2/k}\\right),\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "where $M$ is an absolute constant and $C_{P}$ is a constant depending only on $P$ . ", "page_idx": 17}, {"type": "text", "text": "Proof. Note that from Corollary 9, $\\mathbb{E}_{\\pmb{x}}[f_{*}(\\pmb{x})]=0,\\mathbb{E}_{\\pmb{x}}[\\nabla f(\\pmb{x})]=\\mathbf{0}$ and $\\mathbb{E}_{\\pmb{x}}[\\nabla^{i}f_{*}(\\pmb{x})]=c_{i}(\\pmb{\\beta})^{\\otimes i}$ ; by (2.2), Lemma 6 and $\\|\\beta\\|=1$ , $\\|\\mathbb{E}_{\\pmb{x}}[\\nabla^{i}f_{*}(\\pmb{x})]\\|_{F}\\leq R_{c}$ holds. Lemma 15 yields the result. \u53e3 ", "page_idx": 18}, {"type": "text", "text": "Corollary 17. Fix any $\\{c_{i}\\}$ and $\\beta$ on the support of their distributions. Then, $|f_{*}({\\pmb x})|,|y|\\lesssim$ $(\\log d)^{P/2}$ holds with high probability over the distribution of $\\textbf{\\em x}$ and $\\varsigma$ . ", "page_idx": 18}, {"type": "text", "text": "B Proofs for the MLP Layer ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "This section analyzes the behavior of MLP weight $\\mathbf{\\nabla}w$ after one gradient descent step (line 4 in Algorithm 1), as sketched in Section 3.2.1. ", "page_idx": 18}, {"type": "text", "text": "We set $\\lambda_{1}=\\eta_{1}^{-1}$ . From line 4 of Algorithm 1, for each $j\\in[m]$ , ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{w_{j}^{(1)}=2\\eta_{1}\\frac{1}{T_{1}}\\displaystyle\\sum_{t=1}^{T_{1}}y^{t}\\nabla_{w_{j}^{(0)}}f(X^{t},y^{t},x^{t};W^{(0)},\\mathbf{b}^{(0)})}\\\\ &{\\qquad\\,-2\\eta_{1}\\displaystyle\\frac{1}{T_{1}}\\int_{t=1}^{T_{1}}f(X^{t},y^{t},x^{t};W^{(0)},\\mathbf{b}^{(0)})\\nabla_{w_{j}^{(0)}}f(X^{t},y^{t},x^{t};W^{(0)},\\mathbf{F}^{(0)})}\\\\ &{=2\\eta_{1}\\Gamma_{j,j}^{(0)}\\displaystyle\\left(\\sum_{t=1}^{T_{1}}\\frac{1}{T_{1}}y^{t}\\alpha_{b_{j}}(w_{j}^{(0)}{^{\\top}}x^{t})\\displaystyle\\frac{1}{N_{1}}\\displaystyle\\sum_{t=1}^{N_{1}}y_{t}^{t}\\alpha_{b_{j}}^{(0)^{\\top}}x_{i}^{t}\\right.}\\\\ &{\\qquad\\left.+\\displaystyle\\sum_{t=1}^{T_{1}}\\displaystyle\\frac{1}{T_{1}}y^{t}\\sigma_{b_{j}}^{(0)^{\\top}}x^{t})x^{t}\\displaystyle\\frac{1}{N_{1}}\\displaystyle\\sum_{t=1}^{N_{1}}y_{t}^{t}\\alpha_{b_{j}}(w_{j}^{(0)}{^{\\top}}x_{i}^{t})\\right)}\\\\ &{\\qquad\\,-2\\eta_{1}\\displaystyle\\frac{1}{T_{1}}\\displaystyle\\sum_{t=1}^{T_{1}}f(X^{t},y^{t},x^{t};W^{(0)},\\mathbf{F}^{(0)},\\mathbf{b}^{(0)})\\nabla_{w_{j}^{(0)}}f(X^{t},y^{t},x^{t};W^{(0)},\\mathbf{F}^{(0)}).}\\end{array}\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "holds where $\\sigma_{b_{j}}(z):=\\sigma(z+b_{j})$ . Here, $\\pmb{x}_{i}^{t}$ and $y_{i}^{t}$ is the input and output of $i$ -th context at $t$ -th task, respectively. First we show that the final term is sufficiently small, if we set $\\gamma=|\\Gamma_{j,j}^{(0)}|$ sufficiently small. ", "page_idx": 18}, {"type": "text", "text": "Lemma 18. With high probability over the distribution of $\\{(\\pmb{X}^{t},\\pmb{y}^{t},\\pmb{x}^{t},y^{t})\\}_{t=1}^{T_{1}}$ and $\\{w_{j}^{(0)}\\}_{j=1}^{m}$ , ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\left\\|2\\eta_{1}\\cfrac{1}{T_{1}}\\sum_{t=1}^{T_{1}}f(\\boldsymbol{X}^{t},\\boldsymbol{y}^{t},\\boldsymbol{x}^{t};W^{(0)},\\Gamma^{(0)},\\boldsymbol{b}^{(0)})\\nabla_{w_{j}^{(0)}}f(\\boldsymbol{X}^{t},\\boldsymbol{y}^{t},\\boldsymbol{x}^{t};W^{(0)},\\Gamma^{(0)},\\boldsymbol{b}^{(0)})\\right\\|}\\\\ &{=\\tilde{O}\\Big(\\eta_{1}\\gamma^{2}m\\sqrt{d}\\Big).}\\end{array}\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "Proof. Recall that ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\begin{array}{r}{f(X^{t},y^{t},x^{t};W^{(0)},\\mathbf{r}^{(0)},b^{(0)})=\\displaystyle\\sum_{j=1}^{m}\\Gamma_{j,j}^{(0)}\\left(\\frac{1}{N_{1}}\\sum_{i=1}^{N_{1}}y_{i}^{t}\\sigma_{b_{j}}(w_{j}^{(0)^{\\top}}x_{i}^{t})\\right)\\sigma_{b_{j}}(w_{j}^{(0)^{\\top}}x^{t}),}\\\\ {\\nabla_{w_{j}^{(0)}}f(X^{t},y^{t},x^{t};W^{(0)},\\mathbf{r}^{(0)},b^{(0)})=\\Gamma_{j,j}^{(0)}\\left(\\frac{1}{N_{1}}\\sum_{i=1}^{N_{1}}y_{i}^{t}\\sigma_{b_{j}}^{\\prime}(w_{j}^{(0)^{\\top}}x_{i}^{t})x_{i}^{t}\\right)\\sigma_{b_{j}}(w_{j}^{(0)^{\\top}}x^{t})}\\\\ {\\displaystyle+\\,\\Gamma_{j,j}^{(0)}\\left(\\frac{1}{N_{1}}\\sum_{i=1}^{N_{1}}y_{i}^{t}\\sigma_{b_{j}}(w_{j}^{(0)^{\\top}}x_{i}^{t})\\right)\\sigma_{b_{j}}^{\\prime}(w_{j}^{(0)^{\\top}}x^{t})x^{t}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "Fix $i,t,j$ and consider the inner product between wj(0)\u223cUnif(Sd\u22121) and xit \u223cN(0, Id). From the rotational invariance, without loss of generality, we can assume that $\\pmb{w}_{j}^{(0)}=[1,0,\\dots,0]^{\\top}$ and $\\pmb{x}_{i}^{t}\\sim\\mathcal{N}(\\boldsymbol{0},I_{d})$ . Therefore, $\\left\\langle{\\pmb w}_{j}^{(0)},{\\pmb x}_{i}^{t}\\right\\rangle\\sim\\mathcal{N}(0,1)$ . From Lemma 4, $\\left\\langle\\pmb{w}_{j}^{(0)},\\pmb{x}_{i}^{t}\\right\\rangle^{2}\\lesssim\\log d$ holds with high probability. Moreover, from Lemma 10 and Corollary 17, we know that $|y_{i}^{t}|,|y^{t}|\\lesssim(\\log d)^{P/2}$ and $\\|\\pmb{x}_{i}^{t}\\|,\\|\\pmb{x}^{t}\\|\\lesssim\\sqrt{d}$ holds. We can take the union bound with respect to all the $i,t,j$ , retaining the high probability bound (see Appendix A). Therefore, noting that $|\\bar{b_{j}}|\\leq1$ , we obtain ", "page_idx": 18}, {"type": "text", "text": "", "page_idx": 19}, {"type": "equation", "text": "$$\n|f(X^{t},y^{t},x^{t};W^{(0)},\\Gamma^{(0)},b^{(0)})|\\lesssim m\\gamma(\\log d)^{P/2+1}\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "and ", "page_idx": 19}, {"type": "equation", "text": "$$\n\\|\\nabla_{w_{j}^{(0)}}f(X^{t},y^{t},x^{t};W^{(0)},\\mathbf{r}^{(0)},b^{(0)})\\|\\lesssim\\gamma(\\log d)^{P/2+1/2}\\sqrt{d}.\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "Thus we obtain the assertion. ", "page_idx": 19}, {"type": "text", "text": "From now on we focus on analyzing (B.1), which expresses the correlation between the output label $y$ and the gradient of model output $\\nabla_{w}f$ . Let ", "page_idx": 19}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\quad g_{T_{1},N_{1}}(\\boldsymbol{w},\\boldsymbol{b},\\{(\\boldsymbol{X}^{t},\\boldsymbol{y}^{t},\\boldsymbol{x}^{t},\\boldsymbol{y}^{t})\\}_{t=1}^{T_{1}})}\\\\ &{:=\\displaystyle\\sum_{i=1}^{T_{1}}\\frac{1}{T_{1}}y^{t}\\sigma_{b}(\\boldsymbol{w}^{\\top}\\boldsymbol{x}^{t})\\frac{1}{N_{1}}\\sum_{i=1}^{N_{1}}y_{i}^{t}\\sigma_{b}^{\\prime}(\\boldsymbol{w}^{\\top}\\boldsymbol{x}_{i}^{t})x_{i}^{t}}\\\\ &{\\quad\\quad+\\displaystyle\\sum_{i=1}^{T_{1}}\\frac{1}{T_{1}}y^{t}\\sigma_{b}^{\\prime}(\\boldsymbol{w}^{\\top}\\boldsymbol{x}^{t})x^{t}\\frac{1}{N_{1}}\\sum_{i=1}^{N_{1}}y_{i}^{t}\\sigma_{b}(\\boldsymbol{w}^{\\top}\\boldsymbol{x}_{i}^{t}),}\\end{array}\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "and $g(\\pmb{w},b)=\\mathbb{E}[g_{T_{1},N_{1}}(\\pmb{w},b,\\{(\\pmb{X}^{t},\\pmb{y}^{t},\\pmb{x}^{t},y^{t})\\}_{t=1}^{T_{1}})]$ , where the expectation is taken with respect to the data $\\{(\\pmb{X}^{t},\\pmb{y}^{t},\\pmb{x}^{t},y^{t})\\}_{t=1}^{T_{1}}$ . Note that ", "page_idx": 19}, {"type": "equation", "text": "$$\nw_{j}^{(1)}=2\\eta_{1}\\Gamma_{j,j}^{(0)}g_{T_{1},N_{1}}(w_{j}^{(0)},b_{j}^{(0)},\\{(X^{t},y^{t},x^{t},y^{t})\\}_{t=1}^{T_{1}})+\\tilde{O}\\Big(\\eta_{1}\\gamma^{2}m\\sqrt{d}\\Big)\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "from Lemma 18. ", "page_idx": 19}, {"type": "text", "text": "In Appendix B.1, we analyze the explicit form of $\\scriptstyle\\pmb{g}(\\pmb{w},\\,b)$ via the Hermite expansion: we can check that its main term aligns with the low-dimensional subspace $\\boldsymbol{S}$ . In Appendix B.2, we show the concentration of ${g_{T}}_{1},{N_{1}}$ around $\\textbf{\\textit{g}}$ . ", "page_idx": 19}, {"type": "text", "text": "B.1 Calculation of Population Gradient ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "B.1.1 Hermite Expansion ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "First, note that ", "page_idx": 19}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{g(w,b)=\\mathbb{E}\\big[y\\sigma_{b}(w^{\\top}x)y_{i}\\sigma_{b}^{\\prime}(w^{\\top}x_{i})x_{i}\\big]+\\mathbb{E}\\big[y\\sigma_{b}^{\\prime}(w^{\\top}x)x y_{i}\\sigma_{b}(w^{\\top}x_{i})\\big]}\\\\ &{\\qquad\\qquad=\\mathbb{E}_{f_{\\star}}\\big[\\mathbb{E}_{\\{x_{i}\\},x,\\{s_{i}\\},\\zeta}\\big[(f_{\\star}(x)+\\varsigma)\\sigma_{b}(w^{\\top}x)(f_{\\star}(x_{i})+\\varsigma_{i})\\sigma_{b}^{\\prime}(w^{\\top}x_{i})x_{i}\\big]\\big]}\\\\ &{\\qquad\\qquad+\\mathbb{E}_{f_{\\star}}\\big[\\mathbb{E}_{\\{x_{i}\\},x,\\{s_{i}\\},\\zeta}\\big[(f_{\\star}(x)+\\varsigma)\\sigma_{b}^{\\prime}(w^{\\top}x)x(f_{\\star}(x_{i})+\\varsigma_{i})\\sigma_{b}(w^{\\top}x_{i})\\big]\\big]}\\\\ &{\\qquad=\\mathbb{E}_{f_{\\star}}\\big[\\mathbb{E}_{x,\\zeta}\\big[(f_{\\star}(x)+\\varsigma)\\sigma_{b}(w^{\\top}x)\\big]\\mathbb{E}_{\\{x_{i}\\},\\{s_{i}\\}}\\big[(f_{\\star}(x_{i})+\\varsigma_{i})\\sigma_{b}^{\\prime}(w^{\\top}x_{i})x_{i}\\big]\\big]}\\\\ &{\\qquad+\\mathbb{E}_{f_{\\star}}\\big[\\mathbb{E}_{x,\\zeta}\\big[(f_{\\star}(x)+\\varsigma)\\sigma_{b}^{\\prime}(w^{\\top}x)x\\big]\\mathbb{E}_{\\{x_{i}\\},\\{s_{i}\\}}\\big[(f_{\\star}(x_{i})+\\varsigma_{i})\\sigma_{b}(w^{\\top}x_{i})\\big]\\big]}\\\\ &{\\qquad=2\\mathbb{E}_{f_{\\star}}\\big[\\mathbb{E}_{x}\\big[f_{\\star}(x)\\sigma_{b}^{\\prime}(w^{\\top}x)x\\big]\\mathbb{E}_{x}\\big[f_{\\star}(x)\\sigma_{b}(w^{\\top}x)\\big]\\big].}\\end{array}\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "Here $\\mathbb{E}_{f_{*}}$ denotes the expectation with respect to the distribution of the true function $f_{*}$ (i.e., the distribution of $\\{c_{i}\\}_{i=Q}^{P}$ and $\\beta$ ) specified in Assumption 1. Now let $\\begin{array}{r}{\\sigma_{b}(z)=\\sum_{i\\geq0}\\frac{a_{i}(b)}{i!}\\mathrm{He}_{i}(z)}\\end{array}$ the Hermite expansion of student activation $\\sigma_{b}(z)=\\mathrm{ReLU}(z+b)$ . ", "page_idx": 19}, {"type": "text", "text": "Lemma 19. It holds that ", "page_idx": 19}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\quad\\mathbb{E}_{x}[f_{*}(x)\\sigma_{b}^{\\prime}(w^{\\top}x)x]}\\\\ &{=\\displaystyle\\sum_{i=Q-1}^{P-1}\\frac{a_{i+1}(b)\\mathbb{E}_{x}[\\nabla^{i+1}f_{*}(x)](w^{\\otimes i})}{i!}+w\\displaystyle\\sum_{i=Q}^{P}\\frac{a_{i+2}(b)\\mathbb{E}_{x}[\\nabla^{i}f_{*}(x)](w^{\\otimes i})}{i!},}\\\\ &{\\displaystyle\\mathbb{E}_{x}[f_{*}(x)\\sigma_{b}({w^{\\top}x})]=\\displaystyle\\sum_{i=Q}^{P}\\frac{a_{i}(b)\\mathbb{E}_{x}[\\nabla^{i}f_{*}(x)](w^{\\otimes i})}{i!}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "Proof. Consider a function $\\begin{array}{r}{g(\\pmb{w}^{\\top}\\pmb{x})\\ =\\ \\sum_{i\\geq0}\\frac{\\tilde{a}_{i}}{i!}\\mathrm{He}_{i}(\\pmb{w}^{\\top}\\pmb{x})}\\end{array}$ . Here $\\mathbb{E}_{\\pmb{x}}[f_{*}(\\pmb{x})g(\\pmb{w}^{\\top}\\pmb{x})]$ can be calculated as ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{E}_{\\boldsymbol{x}}\\big[f_{*}(\\boldsymbol{x})g(\\boldsymbol{w}^{\\top}\\boldsymbol{x})\\big]=\\displaystyle\\sum_{i\\geq0}\\frac{\\hat{a}_{i}}{i!}\\mathbb{E}_{\\boldsymbol{x}}\\big[f_{*}(\\boldsymbol{x})\\mathrm{He}_{i}(\\boldsymbol{w}^{\\top}\\boldsymbol{x})\\big]}\\\\ &{\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\hat{a}_{i}\\frac{w_{1}^{i_{1}}\\cdot\\ldots+i_{d}}{i!}\\underbrace{w_{i}^{i_{1}}\\cdot\\ldots\\cdot w_{d}^{i_{d}}}_{i!\\,1\\,\\cdots\\,i_{d}!}\\mathbb{E}_{\\boldsymbol{x}}\\big[f_{*}(\\boldsymbol{x})\\mathrm{He}_{i_{1}}(\\boldsymbol{x}_{1})\\cdot\\ldots\\mathrm{He}_{i_{d}}(\\boldsymbol{x}_{d})\\big]\\left(\\cdot\\operatorname{Lemma}8\\right)}\\\\ &{\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\tilde{a}_{i}\\frac{w_{1}^{i_{1}}\\cdot\\ldots\\cdot i_{d}!}{i!}\\mathbb{E}_{\\boldsymbol{x}}\\bigg[\\frac{\\partial^{i_{1}}}{\\partial x_{1}^{i_{1}}}\\cdots\\frac{\\partial^{i_{d}}}{\\partial x_{r}^{i_{d}}}f_{*}(\\boldsymbol{x})\\bigg]}\\\\ &{\\qquad=\\displaystyle\\sum_{i\\geq0}\\frac{\\hat{a}_{i}\\mathbb{E}_{\\boldsymbol{x}}\\big[\\nabla^{i_{f}}f_{*}(\\boldsymbol{x})\\big](\\boldsymbol{w}^{\\otimes i})}{i!}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "Where the final line is obtained noting that the tensor $\\nabla^{i}f_{*}(x)$ has $\\frac{i!}{i_{1}!\\cdots i_{d}!}$ entries whose value is $\\begin{array}{r}{\\frac{\\partial^{i_{1}}}{\\partial x_{1}^{i_{1}}}\\cdot\\cdot\\cdot\\frac{\\partial^{i_{d}}}{\\partial x_{r}^{i_{d}}}f_{*}(\\pmb{x}).}\\end{array}$ . ", "page_idx": 20}, {"type": "text", "text": "Note that $\\begin{array}{r}{\\mathbb{E}_{\\boldsymbol{x}}[\\nabla^{i}f_{*}(\\boldsymbol{x})]=\\mathbb{E}_{\\boldsymbol{x}}\\Big[\\nabla^{i}\\sum_{j=Q}^{P}\\frac{c_{j}}{j!}\\mathrm{He}_{j}\\big(\\langle\\pmb{x},\\beta\\rangle\\big)\\Big]}\\end{array}$ is a nonzero tensor only when $Q\\le i\\le P$ , from Lemma 8. We can also show (B.3) as ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\,\\mathbb{E}_{x}[f_{*}(x)\\sigma_{b}^{\\prime}(w^{\\top}x)x]}\\\\ &{=\\!\\mathbb{E}_{x}[\\nabla f_{*}(x)\\sigma_{b}^{\\prime}(w^{\\top}x)]+\\mathbb{E}_{x}[f_{*}(x)\\sigma_{b}^{\\prime\\prime}(w^{\\top}x)]w\\ (\\because\\mathrm{~Stein`s~lemma~})}\\\\ &{=\\!\\displaystyle\\sum_{i\\ge0}\\frac{a_{i+1}(b)\\mathbb{E}_{x}[\\nabla^{i+1}f_{*}(x)](w^{\\otimes i})}{i!}+w\\displaystyle\\sum_{i\\ge0}\\frac{a_{i+2}(b)\\mathbb{E}_{x}[\\nabla^{i}f_{*}(x)](w^{\\otimes i})}{i!}}\\\\ &{=\\displaystyle\\sum_{i=Q-1}^{P-1}\\frac{a_{i+1}(b)\\mathbb{E}_{x}[\\nabla^{i+1}f_{*}(x)](w^{\\otimes i})}{i!}+w\\displaystyle\\sum_{i=Q}^{P}\\frac{a_{i+2}(b)\\mathbb{E}_{x}[\\nabla^{i}f_{*}(x)](w^{\\otimes i})}{i!}}\\end{array}\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "Using Lemma 19, $\\scriptstyle\\pmb{g}(\\pmb{w},\\,b)$ can be expanded as ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{g(w,b)=\\mathbb{E}_{f_{*}}\\left[2\\Bigg(\\sum_{i=Q-1}^{P-1}\\frac{a_{i+1}(b)\\mathbb{E}_{x}\\left[\\nabla^{i+1}f_{*}(x)\\right]\\left(w^{\\otimes i}\\right)}{i!}~~~\\right.}\\\\ &{~~~~~~~~~~~~~~~~~~~~~~~~\\left.\\left.+w\\displaystyle\\sum_{i=Q}^{P}\\frac{a_{i+2}(b)\\mathbb{E}_{x}\\left[\\nabla^{i}f_{*}(x)\\right]\\left(w^{\\otimes i}\\right)}{i!}\\right)\\Bigg(\\sum_{i=Q}^{P}\\frac{a_{i}(b)\\mathbb{E}_{x}\\left[\\nabla^{i}f_{*}(x)\\right]\\left(w^{\\otimes i}\\right)}{i!}\\Bigg)\\right]}\\\\ &{~~~~~~~~~~~~~~~~~~~~~~~~=:\\mathbb{E}_{f_{*}}\\left[\\frac{2a_{Q}(b)}{\\left(Q-1\\right)!}\\mathbb{E}_{x}[\\nabla^{Q}f_{*}(x)](w^{\\otimes(Q-1)})\\frac{a_{Q}(b)\\mathbb{E}_{x}\\left[\\nabla^{Q}f_{*}(x)\\right]\\left(w^{\\otimes Q}\\right)}{Q!}\\right]+s(w,b)}\\\\ &{~~~~~~~~~~~~~~~~~~~~~=\\frac{2a_{Q}(b)^{2}}{Q!\\left(Q-1\\right)!}\\mathbb{E}_{f_{*}}\\left[\\mathbb{E}_{x}\\big[\\nabla^{Q}f_{*}(x)\\big](w^{\\otimes(Q-1)})\\cdot\\mathbb{E}_{x}\\big[\\nabla^{Q}f_{*}(x)\\big](w^{\\otimes Q})\\right]+s(w,b),\\quad\\mathrm{(B)}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "where ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathscr{s}(w,b)}\\\\ &{=\\!\\!2\\mathbb{E}_{f_{*}}\\!\\left[\\left(\\sum_{i=Q-1}^{P-1}\\frac{a_{i+1}(b)\\mathbb{E}_{x}\\left[\\nabla^{i+1}f_{*}(x)\\right](w^{\\otimes i})}{i!}+w\\sum_{i=Q}^{P}\\frac{a_{i+2}(b)\\mathbb{E}_{x}\\left[\\nabla^{i}f_{*}(x)\\right](w^{\\otimes i})}{i!}\\right)\\right.}\\\\ &{\\quad\\cdot\\left(\\sum_{i=Q}^{P}\\!\\frac{a_{i}(b)\\mathbb{E}_{x}\\left[\\nabla^{i}f_{*}(x)\\right](w^{\\otimes i})}{i!}\\right)-\\frac{a_{Q}(b)^{2}}{(Q-1)!}\\mathbb{E}_{x}[\\nabla^{Q}f_{*}(x)](w^{\\otimes(Q-1)})\\frac{\\mathbb{E}_{x}\\left[\\nabla^{Q}f_{*}(x)\\right](w^{\\otimes Q})}{Q!}\\right]}\\end{array}\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "expresses terms in the asymptotic expansion which are not the leading term. ", "page_idx": 20}, {"type": "text", "text": "Note that, in this explicit formulation, $a_{i}(b)=\\mathbb{E}_{z\\sim\\mathcal{N}(0,1)}[\\sigma_{b}(z)\\mathrm{He}_{i}(z)]$ appears. It will be helpful to show that this coefficient is well-controlled. ", "page_idx": 20}, {"type": "text", "text": "Lemma 20. There are constants $C_{H}$ and $C_{L}$ depending only on $Q$ and $P$ satisfying the following condition. Let $\\sigma_{b}(z)=\\sigma(z+b)$ and $b\\sim\\operatorname{Unif}([-1,1])$ . Then, ", "page_idx": 21}, {"type": "text", "text": "$\\left|\\mathbb{E}_{z\\sim\\mathcal{N}(0,1)}[\\sigma_{b}(z)\\mathrm{He}_{i}(z)]\\right|\\le C_{H}$ $2\\leq i\\leq P+2)$ and $\\left|\\mathbb{E}_{z\\sim\\mathcal{N}(0,1)}[\\sigma_{b}(z)\\mathrm{He}_{Q}(z)]\\right|\\geq C_{L}$ (B.5) holds with probability $1/2$ . Especially, $\\left|\\mathbb{E}_{z\\sim\\mathcal{N}(0,1)}[\\sigma_{b}(z)\\mathrm{He}_{i}(z)]\\right|\\le C_{H}$ ( $2\\leq i\\leq P+2)$ holds with probability $^{\\,l}$ . ", "page_idx": 21}, {"type": "text", "text": "Proof. From Lemma 15 in $[\\mathbf{B}\\mathbf{E}\\mathbf{S}^{+}23]$ , we know that for $i\\ \\geq\\ 2$ , $\\left|\\mathbb{E}_{z\\sim\\mathcal{N}(0,1)}[\\sigma_{b}(z)\\mathrm{He}_{i}(z)]\\right|\\ =$ e\u2212\u221ab22\u03c0/2 |Hei\u22122(b)| holds. First, as b \u223cUnif([\u22121, 1]), by setting sufficiently large CH, |Hei(b)| \u2264 $C_{H}$ holds for all $0\\;\\;\\leq\\;\\;i\\;\\;\\leq\\;\\;P$ . Therefore, as $\\begin{array}{r l r}{\\left|\\mathbb{E}_{z\\sim\\mathcal{N}(0,1)}[\\sigma_{b}(z)\\mathrm{He}_{i}(z)]\\right|}&{\\le}&{\\left|\\mathrm{He}_{i-2}(b)\\right|}\\end{array}$ , $\\left|\\mathbb{E}_{z\\sim\\mathcal{N}(0,1)}[\\sigma_{b}(z)\\mathrm{He}_{i}(z)]\\right|\\le C_{H}$ holds for all $2\\leq i\\leq P+2$ with probability one. ", "page_idx": 21}, {"type": "text", "text": "From continuity we know that there exists $C_{L}$ such that $\\left|\\mathbb{E}_{z\\sim\\mathcal{N}(0,1)}[\\sigma_{b}(z)\\mathrm{He}_{Q}(z)]\\right|\\,\\geq\\,C_{L}$ with probability $1/2$ . ", "page_idx": 21}, {"type": "text", "text": "In the following, we first calculate the main term and then upper bound the residual terms. ", "page_idx": 21}, {"type": "text", "text": "B.1.2 Calculation of the Main Term ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "Let us calculate the main term in (B.4) explicitly. ", "page_idx": 21}, {"type": "text", "text": "Lemma 21. ", "text_level": 1, "page_idx": 21}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\quad\\frac{2a_{Q}(b)^{2}}{Q!(Q-1)!}\\mathbb{E}_{f_{*}}[\\mathbb{E}_{\\mathbf{x}}[\\nabla^{Q}f_{*}(\\mathbf{x})](\\mathbf{w}^{\\otimes(Q-1)})\\cdot\\mathbb{E}_{\\mathbf{x}}[\\nabla^{Q}f_{*}(\\mathbf{x})](\\mathbf{w}^{\\otimes Q})]}\\\\ &{=\\!\\frac{2a_{Q}(b)^{2}\\mathbb{E}_{c_{Q}}[c_{Q}^{2}]}{Q!(Q-1)!}\\frac{(2Q-1)!!}{\\mathbb{E}_{z\\sim\\chi_{r}}[z^{2Q}]}\\|\\mathbf{w}_{1:r}\\|^{2Q-2}\\Big[\\mathbf{w}_{1:r}\\Big]}\\end{array}\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "holds. ", "page_idx": 21}, {"type": "text", "text": "Proof. From Corollary 9, it holds that $\\mathbb{E}_{\\pmb{x}}[\\nabla^{Q}f_{\\ast}(\\pmb{x})]=c_{Q}(\\pmb{\\beta})^{\\otimes Q}$ . Then, we obtain ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\quad\\mathbb{E}_{f_{*}}[\\mathbb{E}_{\\pmb{x}}[\\nabla^{Q}f_{*}(\\pmb{x})](\\pmb{w}^{\\otimes(Q-1)})\\cdot\\mathbb{E}_{\\pmb{x}}[\\nabla^{Q}f_{*}(\\pmb{x})](\\pmb{w}^{\\otimes Q})]}\\\\ &{=\\!\\mathbb{E}_{c_{Q}}[c_{Q}^{2}]\\mathbb{E}_{\\beta}[(\\beta^{\\otimes Q}\\pmb{w}^{\\otimes(Q-1)})\\cdot(\\beta^{\\otimes Q}\\circ\\pmb{w}^{\\otimes Q})]}\\\\ &{=\\!\\mathbb{E}_{c_{Q}}[c_{Q}^{2}]\\mathbb{E}_{\\beta}[\\beta^{\\otimes2Q}](\\pmb{w}^{\\otimes(2Q-1)}).}\\end{array}\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "Next, let us show ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\mathbb{E}_{\\beta}[\\beta^{\\otimes2Q}](\\pmb{w}^{\\otimes(2Q-1)})=\\frac{(2Q-1)!!}{\\mathbb{E}_{z\\sim\\chi_{r}}[z^{2Q}]}\\|\\pmb{{w}}_{1:r}\\|^{2Q-2}\\bigg[\\pmb{{w}}_{{d-r}}\\bigg].\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "First, note that by letting $\\beta^{\\prime}\\sim\\mathcal{N}(0,\\pmb{\\Sigma}_{\\beta})$ where ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\Sigma_{\\beta}=\\left[\\mathbf{0}_{r}^{T_{r}}\\quad\\mathbf{0}_{d-r}\\right],\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "and $\\begin{array}{r l r}{z}&{{}\\sim}&{\\chi_{r}}\\end{array}$ independent from $\\beta,\\ \\beta^{\\prime}\\ \\sim\\ \\beta z$ holds (recall that we assumed that $\\beta\\ \\sim$ $\\operatorname{Unif}(\\{(\\beta_{1},\\stackrel{\\cdot\\,\\cdot\\,}{\\dots},\\beta_{r},0,\\stackrel{\\cdot\\,}{\\dots},0)^{\\top}\\mid\\beta_{1}^{2}+\\dots+\\beta_{r}^{2}=1\\})$ \u2013 see Appendix A). Then, ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\mathbb{E}_{\\beta}[\\beta^{\\otimes2Q}]=\\frac{1}{\\mathbb{E}_{z\\sim\\chi_{r}}[z^{2Q}]}\\mathbb{E}_{\\pmb{v}_{1:r}^{\\prime}\\sim\\mathcal{N}(0,I_{r}),\\pmb{v}_{r+1:d}^{\\prime}=0}[\\pmb{v}^{\\prime\\otimes2Q}].\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "It suffices to show that $\\mathbb{E}_{v\\sim\\mathcal{N}(0,I_{r})}[\\pmb{v}^{\\otimes2Q}]\\big(\\pmb{z}^{\\otimes(2Q-1)}\\big)=(2Q-1)!!z\\|\\pmb{z}\\|^{2Q-2}$ for $z\\in\\mathbb{R}^{r}$ . As an example, we show that the first entry of $\\mathbb{E}_{\\pmb{v}\\sim\\mathcal{N}(0,I_{r})}[\\pmb{v}^{\\otimes2Q}](\\pmb{z}^{\\otimes(2Q-1)})$ equals to $(2Q-1)!!z_{1}\\|z\\|^{2}\\|^{2}{\\cal Q}^{-2}$ : the other components can be calculated similarly. First, we expand $(\\mathbb{E}_{v\\sim\\mathcal{N}(0,I_{r})}[{\\pmb v}^{\\otimes2Q}](z^{\\otimes(2Q-1)}))_{1}$ as ", "page_idx": 21}, {"type": "equation", "text": "$$\n(\\mathbb{E}_{v\\sim\\mathcal{N}(0,I_{r})}[v^{\\otimes2Q}](z^{\\otimes(2Q-1)}))_{1}=\\sum_{\\substack{i_{1},\\dots,i_{2Q-1}\\in[r]}}\\mathbb{E}[v_{1}v_{i_{1}}\\cdot\\cdot\\cdot v_{i_{2Q-1}}]z_{i_{1}}\\cdot\\cdot\\cdot z_{i_{2Q-1}}.\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "Note that $\\mathbb{E}[v_{1}v_{i_{1}}\\cdot\\cdot\\cdot v_{i_{2Q-1}}]\\neq0$ if and only if the degree of $v_{1}v_{i_{1}}\\cdot\\cdot\\cdot v_{i_{2Q-1}}$ with respect to $v_{j}$ is even, for all $j\\in[r]$ . Then, we obtain ", "page_idx": 21}, {"type": "equation", "text": "$$\n(\\mathbb{E}_{v\\sim\\mathcal{N}(0,I_{r})}[v^{\\otimes2Q}](z^{\\otimes(2Q-1)}))_{1}\n$$", "text_format": "latex", "page_idx": 21}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{=\\displaystyle\\sum_{q_{1}\\geq1,q_{2},\\ldots,q_{r}\\geq0}^{q_{1}+\\cdots+q_{r}=Q}c_{q_{1},\\ldots,q_{r}}\\mathbb{E}[v_{1}^{2q_{1}}v_{2}^{2q_{2}}\\cdot\\cdot\\cdot v_{r}^{2q_{r}}]z_{1}^{2q_{1}-1}z_{2}^{2q_{2}}\\cdot\\cdot\\cdot z_{r}^{2q_{r}}}\\\\ &{=\\displaystyle\\sum_{q_{1}\\geq1,q_{2},\\ldots,q_{r}\\geq0}^{q_{1}+\\cdots+q_{r}=Q}}\\\\ &{=z_{1}\\displaystyle\\sum_{q_{1}\\geq1,q_{2},\\ldots,q_{r}\\geq0}^{q_{1}+\\cdots+q_{r}=Q}\\mathbb{E}[v_{1}^{2q_{1}}v_{2}^{2q_{2}}\\cdot\\cdot\\cdot v_{r}^{2q_{r}}]z_{1}^{2q_{1}-2}z_{2}^{2q_{2}}\\cdot\\cdot\\cdot z_{r}^{2q_{r}},}\\end{array}\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "where $\\begin{array}{r}{c_{q_{1},\\ldots,q_{r}}=\\frac{(2Q-1)!}{(2q_{1}-1)!(2q_{2})!\\cdots(2q_{r})!}}\\end{array}$ is the number of ways to assign $(2q_{1}-1)$ \u201c1\u201ds, $\\left(2q_{2}\\right)$ \u201c2\u201ds, ..., among $i_{1}$ to $i_{2Q-1}$ . ", "page_idx": 22}, {"type": "text", "text": "Note that $\\mathbb{E}_{v\\sim\\mathcal{N}(0,1)}[v^{2q}]=(2q-1)!!$ . Therefore, we obtain ", "page_idx": 22}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\quad(\\mathbb{E}_{v\\sim N(0,I_{r})}[v^{\\otimes2Q}](z^{\\otimes(2Q-1)}))_{1}}\\\\ &{\\quad\\quad\\underset{q_{1}\\geq1,q_{2},\\ldots,q_{r}\\geq0}{\\sum}\\frac{(2Q-1)!}{(2q_{1}-1)!(2q_{2})!\\cdot\\ldots(2q_{r})!}(2q_{1}-1)!!\\cdot\\ldots(2q_{r}-1)!!z_{1}^{2q_{1}-2}z_{2}^{2q_{2}}\\cdot\\cdot\\cdot z_{r}^{2q_{r}}}\\\\ &{\\quad\\quad\\underset{q_{1}\\leq\\ldots+q_{r}=Q}{\\underbrace{q_{1}+\\ldots+q_{r}=Q}}(2q_{1}-1)!}\\\\ &{=z_{1}\\sum_{q_{2}\\geq1,q_{2},\\ldots,q_{r}\\geq0}\\frac{(Q-1)!}{(q_{1}-1)!(q_{2})!\\cdot\\ldots(q_{r})!}(2Q-1)!!(z_{1}^{2})^{q_{1}-1}(z_{2}^{2})^{q_{2}}\\cdot\\cdot\\cdot(z_{r}^{2})^{q_{r}}}\\\\ &{\\quad\\quad q_{1}\\geq1,!!z_{1}(z_{1}^{2}+\\ldots+z_{r}^{2})^{Q-1}\\quad\\quad\\quad\\langle:\\cdot\\mathrm{mulinomial~theorem})}\\end{array}\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "which concludes the assertion. ", "page_idx": 22}, {"type": "text", "text": "By Lemma 21, we observe that the main term of the expected one-step gradient aligns to the $r$ - dimensional subspace $\\boldsymbol{S}$ . In other words, the MLP layer captures the information of $\\boldsymbol{S}$ via pretraining, which will be useful in the later stage. ", "page_idx": 22}, {"type": "text", "text": "B.1.3 Bounding Residual Terms ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "First, similarly to the Lemma 21, we can obtain the explicit formulation of the entire $\\scriptstyle\\pmb{g}(\\pmb{w},\\,b)$ . ", "page_idx": 22}, {"type": "text", "text": "Lemma 22. ", "text_level": 1, "page_idx": 22}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\quad g(w,b)}\\\\ &{=\\displaystyle\\sum_{Q\\leq j\\leq P_{-1}\\atop i+j\\;i\\delta\\;o d}\\frac{2a_{i+1}(b)a_{j}(b)\\mathbb{E}[c_{i+1}c_{j}]}{i!j!}\\frac{(i+j)!!}{\\mathbb{E}_{z\\sim\\chi_{r}}[z^{i+j+1}]}\\|w_{1:r}\\|^{i+j-1}\\bigg[\\pmb{w}_{1:r}\\bigg]}\\\\ &{\\quad+\\displaystyle\\sum_{w\\leq j\\leq P_{-1}\\atop i\\neq j\\leq P_{-1}}\\frac{2a_{i+2}(b)a_{j}(b)\\mathbb{E}[c_{i}c_{j}]}{i!j!}\\frac{(i+j-1)!!}{\\mathbb{E}_{z\\sim\\chi_{r}}[z^{i+j}]}\\|w_{1:r}\\|^{i+j}}\\\\ &{\\qquad\\underbrace{Q\\leq j\\leq P_{-1}}_{i+j\\;i\\delta\\;e V\\neq n},}\\end{array}\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "holds. ", "page_idx": 22}, {"type": "text", "text": "Proof. Note that ", "page_idx": 22}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\mathbb{E}_{\\beta}[\\beta^{\\otimes n}](\\pmb{w}^{\\otimes(n-1)})=\\left\\{\\begin{array}{l l}{\\frac{(n-1)!!}{\\mathbb{E}_{z\\sim\\chi_{r}}[z^{n}]}\\|\\pmb{w}_{1:r}\\|^{n-2}\\bigg[\\pmb{w}_{1:r}\\bigg]\\;(n\\mathrm{~is~even})}\\\\ {0\\;(n\\mathrm{~is~odd})}\\end{array}\\right.}\\end{array}\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "and ", "page_idx": 22}, {"type": "equation", "text": "$$\n\\mathbb{E}_{\\beta}[\\beta^{\\otimes n}](\\pmb{w}^{\\otimes n})=\\left\\{\\begin{array}{l l}{\\frac{(n-1)!!}{\\mathbb{E}_{z\\sim\\chi_{r}}[z^{n}]}\\|\\pmb{w}_{1:r}\\|^{n}\\;(n\\;\\mathrm{is~even})}\\\\ {0\\;(n\\;\\mathrm{is~odd})}\\end{array}\\right.\\;,\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "which can be obtained similarly to the proof of Lemma 21. ", "page_idx": 22}, {"type": "text", "text": "Let us upper bound the non-leading terms; we need to show that the moment of first $r$ components in residual term $\\pmb{\\mathscr{s}}(\\pmb{\\mathscr{w}},b)$ are sufficiently small. ", "page_idx": 22}, {"type": "text", "text": "Lemma 23. Let $j=4k$ where $k\\in[P]$ . then, ", "page_idx": 23}, {"type": "equation", "text": "$$\n\\mathbb{E}_{{\\pmb w}\\sim\\mathbb{S}^{d-1}}[\\|{\\pmb s}({\\pmb w},{b})_{1:r}\\|^{j}]^{1/j}=\\tilde{O}_{d,r}\\!\\left(\\sqrt{\\frac{r}{d^{2Q+1}}}\\right)\n$$", "text_format": "latex", "page_idx": 23}, {"type": "text", "text": "holds uniformly over all $b\\in[-1,1]$ . ", "page_idx": 23}, {"type": "text", "text": "Proof. Note that $\\|\\pmb{s}(\\pmb{w},b)_{1:r}\\|^{2}$ is a polynomial in $\\pmb{w}$ ; from Lemma 24 in [DLS22], it suffices to show the case $k=1$ . ", "page_idx": 23}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\quad s(\\pmb{w},\\pmb{b})_{1:r}}\\\\ &{=\\underset{Q\\leq j\\leq P_{1},}{\\sum}\\frac{2a_{i+1}(b)a_{j}(b)\\mathbb{E}[c_{i+1}c_{j}]}{i!j!}\\frac{(i+j)!}{\\mathbb{E}_{z\\sim\\chi_{r}}[z^{i+j+1}]}\\|\\pmb{w}_{1:r}\\|^{i+j-1}\\pmb{w}_{1:r}}\\\\ &{\\quad\\overset{Q\\leq i\\leq P_{1}}{i+j!\\,\\mathfrak{s o t d}},}\\\\ &{\\quad i\\frac{i+j}{i!}(Q-1,Q)}\\\\ &{\\quad+\\underset{Q\\leq i\\leq P_{1}}{\\sum}\\frac{2a_{i+2}(b)a_{j}(b)\\mathbb{E}[c_{i}c_{j}]}{i!j!}\\frac{(i+j-1)!!}{\\mathbb{E}_{z\\sim\\chi_{r}}[z^{i+j}]}\\|\\pmb{w}_{1:r}\\|^{i+j}\\pmb{w}_{1:r}.}\\\\ &{\\quad\\overset{Q\\leq i\\leq P_{1}}{i+j!\\,\\mathfrak{s e v}},}\\end{array}\n$$", "text_format": "latex", "page_idx": 23}, {"type": "text", "text": "By Minkowski\u2019s inequality $\\mathbb{E}[\\|\\pmb{x}+\\pmb{y}\\|^{4}]^{1/4}\\leq\\mathbb{E}[\\|\\pmb{x}\\|^{4}]^{1/4}+\\mathbb{E}[\\|\\pmb{y}\\|^{4}]^{1/4}$ , it suffices to show that (B.7) holds for each term. Note that $\\mathbb{E}[c_{i+1}c_{j}]\\ \\leq\\ R_{c}^{2}$ and $\\mathbb{E}[\\stackrel{...}{c_{i}}c_{j}]\\ \\stackrel{.}{\\leq}\\ R_{c}^{2}$ from Assumption 1, $|a_{i}(b)|\\le C_{H}$ from Lemma 20, and $\\mathbb{E}_{w}[\\|{\\pmb w}_{1:r}\\|^{4k}]=O((r/d)^{2k})$ from Lemma 12. Moreover, it is known that $\\mathbb{E}_{z\\sim\\chi_{r}}[z^{2l}]=\\Theta(r^{l})$ . Putting these things together yields the assertion. \u53e3 ", "page_idx": 23}, {"type": "text", "text": "It is also needed in later stages to give a high probability upper bound on the $\\|\\pmb{g}(\\pmb{w},b)\\|$ ; ", "page_idx": 23}, {"type": "text", "text": "Lemma 24. ", "page_idx": 23}, {"type": "equation", "text": "$$\n\\operatorname*{sup}_{b\\in[-1,1]}\\|g(\\pmb{w},b)\\|=\\tilde{O}_{d,r}\\left(\\sqrt{\\frac{1}{r d^{2Q-1}}}\\right)\n$$", "text_format": "latex", "page_idx": 23}, {"type": "text", "text": "holds with high probability over $w\\sim\\mathrm{Unif}(\\mathbb{S}^{d-1})$ ", "page_idx": 23}, {"type": "text", "text": "Proof. This can be shown similarly to Lemma 23 \u2013 we use Lemma 11 instead of Lemma 12 to obtain a high probability bound (note that this bound includes not only $s(\\pmb{w},b)$ but also the main term, and it is for $\\scriptstyle\\pmb{g}(\\pmb{w},\\,b)$ , instead of $\\pmb{g}(\\pmb{w},b)_{1:r})$ . \u53e3 ", "page_idx": 23}, {"type": "text", "text": "B.2 Concentration of Empirical Gradient ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Now we control the deviation of $g_{T_{1},N_{1}}(\\pmb{w},b,\\{(\\pmb{X}^{t},\\pmb{y}^{t},\\pmb{x}^{t},y^{t})\\}_{t=1}^{T_{1}})\\operatorname{from}g(\\pmb{w},b).$ ", "page_idx": 23}, {"type": "text", "text": "Lemma 25. Under Assumption $^{\\,l}$ , ", "page_idx": 23}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\underset{f_{*},b\\in[-1,1]}{\\operatorname*{sup}}\\,\\big\\|\\mathbb{E}_{x}\\big[f_{*}(x)\\sigma_{b}^{\\prime}(w^{\\top}x)x\\big]\\|\\lesssim\\sqrt{\\Big(\\frac{r}{d}\\log d\\Big)^{Q-1}},}\\\\ {\\underset{f_{*},b\\in[-1,1]}{\\operatorname*{sup}}\\,\\big\\|\\mathbb{E}_{x}\\big[f_{*}(x)\\sigma_{b}^{\\prime}(w^{\\top}x)x\\big]_{1:r}\\|\\lesssim\\sqrt{\\Big(\\frac{r}{d}\\log d\\Big)^{Q-1}},}\\\\ {\\underset{f_{*},b\\in[-1,1]}{\\operatorname*{sup}}\\,\\big\\|\\mathbb{E}_{x}\\big[f_{*}(x)\\sigma_{b}(w^{\\top}x)\\big]\\big|\\lesssim\\sqrt{\\Big(\\frac{r}{d}\\log d\\Big)^{Q}}\\quad}\\\\ {\\underset{f_{*},b\\in[-1,1]}{\\operatorname*{sup}}\\,\\big\\|\\mathbb{E}_{x}\\big[f_{*}(x)\\sigma_{b}(w^{\\top}x)\\big]\\big|\\lesssim\\sqrt{\\Big(\\frac{r}{d}\\log d\\Big)^{Q}}\\quad}\\end{array}\n$$", "text_format": "latex", "page_idx": 23}, {"type": "text", "text": "holds with high probability over $\\pmb{w}\\sim\\mathrm{Unif}(\\mathbb{S}^{d-1}),$ , respectively. Here $\\operatorname{sup}_{f_{*}}$ denotes the supremum over the support of $f_{*}$ whose distribution is specified in Assumption $^{\\,l}$ . ", "page_idx": 23}, {"type": "text", "text": "Proof. We bound the leading term $\\frac{a_{Q}(b)\\mathbb{E}_{\\mathbf{x}}[\\nabla^{Q}f_{*}(\\mathbf{x})](\\pmb{w}^{\\otimes(Q-1)})}{(Q\\!-\\!1)!}$ in (B.3) of Lemma 19 to show (B.8). From Lemmas 5 and 6, we have ", "page_idx": 23}, {"type": "equation", "text": "$$\n\\left\\|\\frac{a_{Q}(b)\\mathbb{E}_{x}[\\nabla^{Q}f_{*}(x)](w^{\\otimes(Q-1)})}{(Q-1)!}\\right\\|^{2}=\\left\\|\\frac{a_{Q}(b)c_{Q}}{(Q-1)!}(\\beta)^{\\otimes Q}(w^{\\otimes(Q-1)})\\right\\|^{2}\n$$", "text_format": "latex", "page_idx": 23}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{=\\left\\|\\frac{a_{Q}(b)c_{Q}}{(Q-1)!}(\\beta)^{\\otimes Q}({\\pmb w}_{1:r}^{\\otimes(Q-1)})\\right\\|^{2}}\\\\ &{\\leq\\left|\\frac{a_{Q}(b)c_{Q}}{(Q-1)!}\\right|^{2}\\|\\beta\\|^{2Q}\\|{\\pmb w}_{1:r}\\|^{2(Q-1)}}\\\\ &{=\\left|\\frac{a_{Q}(b)c_{Q}}{(Q-1)!}\\right|^{2}\\|{\\pmb w}_{1:r}\\|^{2(Q-1)}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 24}, {"type": "text", "text": "Moreover, Lemma 20 tells us that $|a_{Q}(b)|\\;\\;\\leq\\;\\;C_{H}$ always holds when $b\\ \\in\\ [-1,1]$ , and Assumption 1 ensures that $|c_{Q}|\\quad\\leq\\quad R_{c}$ . Therefore, from Lemma 11, we can show that $\\begin{array}{r l r}{\\bigg\\|\\frac{a_{Q}(b)\\mathbb{E}_{x}\\left[\\nabla^{Q}f_{*}(x)\\right]\\left(w^{\\otimes(Q-1)}\\right)}{(Q-1)!}\\bigg\\|^{2}}&{\\leq}&{\\bigg(\\frac{C_{H}R_{c}}{(Q-1)!}\\bigg)^{2}\\Big(\\frac{4C r}{d}\\log d\\Big)^{Q-1}}\\end{array}$ with probability at least $1-2\\exp(-d/32)-2r d^{-C}$ . (B.9) and (B.10) can be obtained similarly. \u53e3 ", "page_idx": 24}, {"type": "text", "text": "The following lemma is parallel to Lemma 19 in [DLS22]. ", "page_idx": 24}, {"type": "text", "text": "Lemma 26. Fix any $t\\in[T_{1}]$ , $b\\in[-1,1]$ and $\\pmb{w}\\in\\mathbb{S}^{d-1}$ satisfying the conditions (B.8) to (B.10). Then, with high probability over the distribution of $(X^{t},y^{t},x^{t},y^{t})$ , it holds that ", "page_idx": 24}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\left\\|\\displaystyle\\frac{1}{N_{1}}\\sum_{i=1}^{N_{1}}y_{i}^{t}\\sigma_{b}^{\\prime}(w^{\\top}x_{i}^{t})x_{i}^{t}-\\mathbb{E}_{x}[f_{*}^{t}(x)\\sigma_{b}^{\\prime}(w^{\\top}x)x]\\right\\|\\le\\tilde{O}\\bigg(\\sqrt{\\frac{d}{N_{1}}}\\bigg),}\\\\ {\\left\\|\\displaystyle\\bigg(\\frac{1}{N_{1}}\\sum_{i=1}^{N_{1}}y_{i}^{t}\\sigma_{b}^{\\prime}(w^{\\top}x_{i}^{t})x_{i}^{t}-\\mathbb{E}_{x}[f_{*}^{t}(x)\\sigma_{b}^{\\prime}(w^{\\top}x)x]\\bigg)_{1:r}\\right\\|\\le\\tilde{O}\\bigg(\\sqrt{\\frac{r}{N_{1}}}\\bigg),}\\\\ {\\displaystyle\\bigg|\\displaystyle\\frac{1}{N_{1}}\\sum_{i=1}^{N_{1}}y_{i}^{t}\\sigma_{b}(w^{\\top}x_{i}^{t})-\\mathbb{E}_{x}[f_{*}^{t}(x)\\sigma_{b}(w^{\\top}x)]\\bigg|\\le\\tilde{O}\\bigg(\\sqrt{\\frac{1}{N_{1}}}\\bigg).}\\end{array}\n$$", "text_format": "latex", "page_idx": 24}, {"type": "text", "text": "Here the right-hand sides do not depend on $t$ . ", "page_idx": 24}, {"type": "text", "text": "Proof. We only present the proof of the first inequality, as other bounds can be attained similarly. From Corollary 17, $|f_{*}^{t}({\\pmb x})|\\leq R$ where $R\\lesssim(\\log\\bar{d})^{P/2}$ holds with high probability for all $t\\in[T_{1}]$ . Conditioned on this, ", "page_idx": 24}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\quad\\bigg\\|\\displaystyle\\frac{1}{N_{1}}\\displaystyle\\sum_{i=1}^{N_{1}}f_{*}^{t}(\\pmb{x}_{i}^{t})\\sigma_{b}^{\\prime}(\\pmb{w}^{\\top}\\pmb{x}_{i}^{t})\\pmb{x}_{i}^{t}-\\mathbb{E}_{\\boldsymbol{x}}[f_{*}^{t}(\\pmb{x})\\sigma_{b}^{\\prime}(\\pmb{w}^{\\top}\\pmb{x})\\pmb{x}]\\bigg\\|}\\\\ &{\\le\\!\\Bigg\\|\\displaystyle\\frac{1}{N_{1}}\\displaystyle\\sum_{i=1}^{N_{1}}f_{*}^{t}(\\pmb{x}_{i}^{t})\\mathbb{I}_{f_{*}^{t}(\\pmb{x}_{i}^{t})\\le R}\\sigma_{b}^{\\prime}(\\pmb{w}^{\\top}\\pmb{x}_{i}^{t})\\pmb{x}_{i}^{t}-\\mathbb{E}_{\\boldsymbol{x}}[f_{*}^{t}(\\pmb{x})\\mathbb{I}_{f_{*}^{t}(\\pmb{x})\\le R}\\sigma_{b}^{\\prime}(\\pmb{w}^{\\top}\\pmb{x})\\pmb{x}]\\Bigg\\|}\\\\ &{\\quad+\\left\\|\\mathbb{E}_{\\pmb{x}}[f_{*}^{t}(\\pmb{x})\\mathbb{I}_{f_{*}^{t}(\\pmb{x})>R}\\sigma_{b}^{\\prime}(\\pmb{w}^{\\top}\\pmb{x})\\pmb{x}]\\right\\|}\\end{array}\n$$", "text_format": "latex", "page_idx": 24}, {"type": "text", "text": "Note that $f_{*}^{t}({\\pmb x}_{i}^{t})\\mathbb{I}_{f_{*}^{t}({\\pmb x}_{i}^{t})\\leq R}\\sigma_{b}^{\\prime}({\\pmb w}^{\\top}{\\pmb x}_{i}^{t})\\langle{\\pmb x}_{i}^{t},{\\pmb u}\\rangle-\\mathbb{E}_{{\\pmb x}}[f_{*}^{t}({\\pmb x})\\mathbb{I}_{f_{*}^{t}({\\pmb x})\\leq R}\\sigma_{b}^{\\prime}({\\pmb w}^{\\top}{\\pmb x})\\langle{\\pmb x},{\\pmb u}\\rangle]$ is $R^{2}$ -sub Gaussian for any $\\|u\\|=1$ from Lemma 14. Hence the first term can be upper bounded by $\\tilde{O}\\Big(R\\sqrt{\\frac{d}{N_{1}}}\\Big)$ with high probability from Lemma 13. For the second term, we observe that ", "page_idx": 24}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\big\\|\\mathbb E_{x}\\big[f_{*}^{t}(x)\\mathbb J_{f_{*}^{t}(x)>R}\\sigma_{b}^{\\prime}(w^{\\top}x)x\\big]\\big\\|\\leq\\mathbb E_{x}[\\|f_{*}^{t}(x)\\mathbb J_{f_{*}^{t}(x)>R}\\sigma_{b}^{\\prime}(w^{\\top}x)x\\|]}\\\\ &{\\qquad\\qquad\\qquad\\qquad\\qquad\\leq\\mathbb E_{x}[f_{*}^{t}(x)^{2}]^{1/2}\\mathbb E_{x}[(\\sigma_{b}^{\\prime}(w^{\\top}x)\\|x\\|)^{2}]^{1/2}\\mathbb E_{x}[(\\mathbb J_{*}^{t}(x)\\!>\\!R)^{4}]^{1/4}}\\\\ &{\\qquad\\qquad\\qquad\\qquad\\qquad\\leq\\mathbb E_{x}[f_{*}^{t}(x)^{2}]^{1/2}\\mathbb E_{x}[\\|x\\|^{2}]^{1/2}\\mathbb E_{x}[(\\mathbb I_{f_{*}^{t}(x)>R})]^{1/4}}\\\\ &{\\qquad\\qquad\\qquad\\qquad\\leq O(\\sqrt{d}\\cdot d^{-C/4})}\\end{array}\n$$", "text_format": "latex", "page_idx": 24}, {"type": "text", "text": "for sufficiently large $C$ ; hence this term can be ignored. Finally, $\\varsigma_{i}\\sigma_{b}^{\\prime}(w^{\\top}x_{i}^{t})\\langle x_{i}^{t},u\\rangle$ is $\\tau^{2}$ -sub Gaussian for any $\\|u\\|=1$ and then $\\begin{array}{r}{\\|\\frac{1}{N_{1}}\\sum_{i=1}^{N_{1}}\\varsigma\\sigma_{b}^{\\prime}(\\pmb{w}^{\\top}\\pmb{x}_{i}^{t})\\pmb{x}_{i}^{t}\\|=\\tilde{O}(\\sqrt{d/N_{1}})}\\end{array}$ with high probability. ", "page_idx": 24}, {"type": "text", "text": "By similar procedure, we can obtain a bound of $\\|g_{T_{1},N_{1}}(\\pmb{w},b,\\{(\\pmb{X}^{t},\\pmb{y}^{t},\\pmb{x}^{t},y^{t})\\}_{t=1}^{T_{1}})-\\pmb{g}(\\pmb{w},b)\\|$ . ", "page_idx": 24}, {"type": "text", "text": "Lemma 27. Fix any $b\\in[-1,1]$ and $\\pmb{w}\\in\\mathbb{S}^{d-1}$ satisfying the conditions (B.8)-(B.10). Then, with high probability over the distribution of $\\{(\\pmb{X}^{t},\\pmb{y}^{t},\\pmb{x}^{t},y^{t})\\}_{t=1}^{T_{1}}$ , ", "page_idx": 25}, {"type": "equation", "text": "$$\n\\begin{array}{r l r}&{}&{\\left\\|g_{T_{1},N_{1}}(w,b,\\{(X^{t},y^{t},x^{t},y^{t})\\}_{t=1}^{T_{1}})-g(w,b)\\right\\|=\\tilde{O}\\left(\\sqrt{\\frac{r^{Q-1}}{d^{Q-1}}}\\sqrt{\\frac{d}{T_{1}}}+\\sqrt{\\frac{d^{2}}{N_{1}T_{1}}}\\right),}\\\\ &{}&{\\left\\|(g_{T_{1},N_{1}}(w,b,\\{(X^{t},y^{t},x^{t},y^{t})\\}_{t=1}^{T_{1}})-g(w,b))_{1:r}\\right\\|=\\tilde{O}\\left(\\sqrt{\\frac{r^{Q-1}}{d^{Q-1}}}\\sqrt{\\frac{r}{T_{1}}}+\\sqrt{\\frac{r^{2}}{N_{1}T_{1}}}\\right),}\\end{array}\n$$", "text_format": "latex", "page_idx": 25}, {"type": "text", "text": "holds. ", "page_idx": 25}, {"type": "text", "text": "Proof. In this proof, the term \u201cwith high probability\u201d indicates the probability with respect to the distribution of $\\{(\\pmb{X}^{t},\\pmb{y}^{t},\\pmb{x}^{t},y^{t})\\}_{t=1}^{T_{1}}$ . Let ", "page_idx": 25}, {"type": "equation", "text": "$$\nz_{1}(w,b,\\{(X^{t},y^{t},x^{t},y^{t})\\}_{t=1}^{T_{1}})=\\sum_{t=1}^{T_{1}}\\frac{1}{T_{1}}y^{t}\\sigma_{b}(w^{\\top}x^{t})\\frac{1}{N_{1}}\\sum_{i=1}^{N_{1}}y_{i}^{t}\\sigma_{b}^{\\prime}(w^{\\top}x_{i}^{t})x_{i}^{t}\n$$", "text_format": "latex", "page_idx": 25}, {"type": "text", "text": "and ", "page_idx": 25}, {"type": "equation", "text": "$$\nz_{2}(\\boldsymbol{w},\\boldsymbol{b},\\{(\\boldsymbol{X}^{t},\\boldsymbol{y}^{t},\\boldsymbol{x}^{t},\\boldsymbol{y}^{t})\\}_{t=1}^{T_{1}})=\\sum_{t=1}^{T_{1}}\\frac{1}{T_{1}}\\boldsymbol{y}^{t}\\sigma_{b}^{\\prime}(\\boldsymbol{w}^{\\top}\\boldsymbol{x}^{t})\\boldsymbol{x}^{t}\\frac{1}{N_{1}}\\sum_{i=1}^{N_{1}}y_{i}^{t}\\sigma_{b}(\\boldsymbol{w}^{\\top}\\boldsymbol{x}_{i}^{t}).\n$$", "text_format": "latex", "page_idx": 25}, {"type": "text", "text": "Note that $g_{T_{1},N_{1}}=z_{1}+z_{2}$ holds. ", "page_idx": 25}, {"type": "text", "text": "Let us consider $z_{1}(\\pmb{w},b,\\{(\\pmb{X}^{t},\\pmb{y}^{t},\\pmb{x}^{t},y^{t})\\}_{t=1}^{T_{1}})$ . Since we assume (B.8)-(B.10) hold, by taking union bound for Lemma 26 with respect to $t\\in[T_{1}]$ , with high probability $\\begin{array}{r}{\\|\\frac{1}{N_{1}}\\sum_{i=1}^{N_{1}}y_{i}^{t}\\sigma_{b}^{\\prime}(\\pmb{w}^{\\top}\\pmb{x}_{i}^{t})\\pmb{x}_{i}^{t}\\|\\leq}\\end{array}$ $\\begin{array}{r}{R=\\tilde{O}\\bigg(\\sqrt{\\frac{d}{N_{1}}}+\\sqrt{\\frac{r^{Q-1}}{d^{Q-1}}}\\bigg)}\\end{array}$ for each $t$ . Moreover, from Corollary 17, $|y^{t}|\\leq R^{\\prime}=\\tilde{O}(1)$ for each $t$ . Here, we notice that the procedure in the proof of Lemma 26 can be applied, yielding ", "page_idx": 25}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\ \\ \\ \\|z_{1}(w,b,\\{(X^{t},y^{t},x^{t},y^{t})\\}_{t=1}^{T_{1}})-\\mathbb{E}[z_{1}(w,b,\\{(X^{t},y^{t},x^{t},y^{t})\\}_{t=1}^{T_{1}})]\\|}\\\\ &{=\\!\\tilde{O}\\Big(R R^{\\prime}\\sqrt{d/T_{1}}\\Big)}\\\\ &{=\\!\\tilde{O}\\Bigg(\\!\\left(\\sqrt{\\frac{r^{Q-1}}{d^{Q-1}}}+\\sqrt{\\frac{d}{N_{1}}}\\right)\\!\\sqrt{\\frac{d}{T_{1}}}\\Bigg)}\\end{array}\n$$", "text_format": "latex", "page_idx": 25}, {"type": "text", "text": "with high probability. Similarly we can obtain ", "page_idx": 25}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\bullet\\ \\|z_{2}-\\mathbb{E}[z_{2}]\\|=\\tilde{O}\\bigg(\\bigg(\\sqrt{\\frac{r^{Q}}{d^{Q}}}+\\sqrt{\\frac{1}{N_{1}}}\\bigg)\\sqrt{\\frac{d}{T_{1}}}\\bigg),}\\\\ &{\\bullet\\ \\|(z_{1}-\\mathbb{E}[z_{1}])_{1:r}\\|=\\tilde{O}\\bigg(\\bigg(\\sqrt{\\frac{r^{Q-1}}{d^{Q-1}}}+\\sqrt{\\frac{r}{N_{1}}}\\bigg)\\sqrt{\\frac{r}{T_{1}}}\\bigg),}\\\\ &{\\bullet\\ \\|(z_{2}-\\mathbb{E}[z_{2}])_{1:r}\\|=\\tilde{O}\\bigg(\\bigg(\\sqrt{\\frac{r^{Q}}{d^{Q}}}+\\sqrt{\\frac{1}{N_{1}}}\\bigg)\\sqrt{\\frac{r}{T_{1}}}\\bigg),}\\end{array}\n$$", "text_format": "latex", "page_idx": 25}, {"type": "text", "text": "which concludes the proof. ", "page_idx": 25}, {"type": "text", "text": "We need to obtain a bound uniformly over $b\\in[-1,1]$ . We first introduce the following definition. ", "page_idx": 25}, {"type": "text", "text": "Definition 28. Fix any $\\pmb{w}\\in\\mathbb{S}^{d-1}$ and $X=\\bigcup_{t=1}^{T_{1}}\\{\\pmb{x}_{1}^{t},\\pmb{\\ldots},\\pmb{x}_{N_{1}}^{t},\\pmb{x}^{t}\\}\\subset\\mathbb{R}^{d}$ . Then, define a finite disjoint partition $\\mathcal{B}(\\pmb{w},X)=\\left\\{B_{1},\\dots,B_{N(\\pmb{w},X)}\\right\\}$ of $[-1,1]$ , i.e., $\\cup_{i}B_{i}=[-1,1]$ and $B_{i}\\cap B_{j}=$ $\\emptyset\\left(i\\neq j\\right)$ as follows: b and $b^{\\prime}$ belong to the same $B_{i}$ if and only $i f\\mathrm{sign}(\\langle{\\pmb w},{\\pmb x}\\rangle\\!+\\!b)=\\mathrm{sign}(\\langle{\\pmb w},{\\pmb x}\\rangle\\!+\\!b^{\\prime})$ for all $\\pmb{x}\\in X$ . ", "page_idx": 25}, {"type": "text", "text": "It is clear that $|\\mathcal{B}(\\pmb{w},X)|\\lesssim|X|\\leq(N_{1}+1)T_{1}$ holds because it suffices to divide $[-1,1]$ at the point satisfying $\\langle{\\pmb w},{\\pmb x}\\rangle+b=0$ for each $\\pmb{x}\\in X$ . ", "page_idx": 25}, {"type": "text", "text": "Lemma 29. Fix any $\\textbf{\\textit{w}}\\in\\ \\mathbb{S}^{d-1}$ . Then, with high probability over the distribution of $\\{(\\pmb{X}^{t},\\pmb{y}^{t},\\pmb{x}^{t},y^{t})\\}_{t=1}^{T_{1}}$ , the following holds: ", "page_idx": 25}, {"type": "text", "text": "\u2022 $g(\\pmb{w},b)$ is $L_{1}$ -Lipschitz continuous with respect to $b$ in the interval $[-1,1]$ . ", "page_idx": 26}, {"type": "text", "text": "\u2022 Let $\\begin{array}{r}{X=\\bigcup_{t=1}^{T_{1}}\\{\\pmb{x}_{1}^{t},\\pmb{\\cdot}\\cdot\\cdot,\\pmb{x}_{N_{1}}^{t},\\pmb{x}^{t}\\}}\\end{array}$ . Then, $g_{T_{1},N_{1}}(\\pmb{w},b,\\{(\\pmb{X}^{t},\\pmb{y}^{t},\\pmb{x}^{t},y^{t})\\}_{t=1}^{T_{1}})$ is $L_{2}$ -Lipschitz continuous with respect to $b$ in each interval $B_{i}\\in B(\\pmb{w},X)$ . ", "page_idx": 26}, {"type": "text", "text": "Here $L_{1}=O(1)$ and $L_{2}={\\tilde{O}}({\\sqrt{d}})$ do not depend on $\\pmb{w}$ . ", "page_idx": 26}, {"type": "text", "text": "Proof. By the explicit form of $g(\\pmb{w},b)$ (B.6), we notice that each term is made by taking the product between the term as $a_{j}(b)a_{k}(b)$ and a vector independent of $b$ whose norm is $O(1)$ . Thus, it suffices to show that $a_{j}(b)a_{k}(b)$ is $O(1)$ -Lipschitz. This follows from the fact $a_{j}=\\pm\\frac{{\\mathrm{e}^{-b^{2}/2}}}{\\sqrt{2\\pi}}\\mathrm{He}_{j-2}(b)$ (see the proof of Lemma 20) and $\\mathrm{He}_{j-2}(b)\\mathrm{e}^{-b^{2}/2}$ is $O(1)$ -Lipschitz continuous on the bounded set $[-1,1]$ . Next, let us see $g_{T_{1},N_{1}}(\\pmb{w},b,\\{(\\pmb{X}^{t},\\pmb{y}^{t},\\pmb{x}^{t},y^{t})\\}_{t=1}^{T_{1}})$ . Recall that ", "page_idx": 26}, {"type": "equation", "text": "$$\n:=\\sum_{i=1}^{T_{1}}\\frac{1}{T_{1}}y^{t}\\sigma_{b}(w^{\\top}x^{t})\\frac{1}{N_{1}}\\sum_{i=1}^{N_{1}}y_{i}^{t}\\sigma_{b}^{\\prime}(w^{\\top}x_{i}^{t})x_{i}^{t}+\\sum_{i=1}^{T_{1}}\\frac{1}{T_{1}}y^{t}\\sigma_{b}^{\\prime}(w^{\\top}x^{t})x^{t}\\frac{1}{N_{1}}\\sum_{i=1}^{N_{1}}y_{i}^{t}\\sigma_{b}(w^{\\top}x_{i}^{t}).\n$$", "text_format": "latex", "page_idx": 26}, {"type": "text", "text": "From Lemma 10 and Corollary 17, we know that $|y_{i}^{t}|,|y^{t}|\\lesssim(\\log d)^{P/2}$ and $\\|\\pmb{x}_{i}^{t}\\|,\\|\\pmb{x}^{t}\\|\\lesssim\\sqrt{d}$ holds for all $i,t$ with high probability. Assuming this and noting \u221athat $\\sigma$ is 1-Lipschitz, in each interval in $\\mathcal{B}(\\boldsymbol{w},\\boldsymbol{X}),g_{T_{1},N_{1}}\\bar{(\\boldsymbol{w},\\boldsymbol{b},\\{(\\boldsymbol{X}^{t},\\dot{\\boldsymbol{y}}^{t},\\boldsymbol{x}^{t},\\boldsymbol{y}^{t})\\}_{t=1}^{\\bar{T}_{1}})}$ is $L_{2}={\\tilde{O}}{\\bar{(}}{\\sqrt{d}})$ -Lipschitz. \u53e3 ", "page_idx": 26}, {"type": "equation", "text": "$$\n\\operatorname*{sup}_{b\\in[-1,1]}\\|g_{T_{1},N_{1}}(w,b,\\{(X^{t},y^{t},x^{t},y^{t})\\}_{t=1}^{T_{1}})-g(w,b)\\|=\\tilde{O}\\left(\\sqrt{\\frac{r^{Q-1}}{d^{Q-1}}}\\sqrt{\\frac{d}{T_{1}}}+\\sqrt{\\frac{d^{2}}{N_{1}T_{1}}}\\right),\n$$", "text_format": "latex", "page_idx": 26}, {"type": "equation", "text": "$$\n\\operatorname*{sup}_{b\\in[-1,1]}\\|(g_{T_{1},N_{1}}(w,b,\\{(X^{t},y^{t},x^{t},y^{t})\\}_{t=1}^{T_{1}})-g(w,b))_{1:r}\\|=\\tilde{O}\\left(\\sqrt{\\frac{r^{Q-1}}{d^{Q-1}}}\\sqrt{\\frac{r}{T_{1}}}+\\sqrt{\\frac{r^{2}}{N_{1}T_{1}}}\\right)\n$$", "text_format": "latex", "page_idx": 26}, {"type": "text", "text": "holds. ", "page_idx": 26}, {"type": "text", "text": "Proof. Let $\\begin{array}{r}{X=\\bigcup_{t=1}^{T_{1}}\\{\\pmb{x}_{1}^{t},\\pmb{\\cdot}_{1},\\pmb{x}_{N_{1}}^{t},\\pmb{x}^{t}\\}}\\end{array}$ and consider $\\mathcal{B}(\\pmb{w},X)=\\left\\{B_{1},\\dots,B_{N(\\pmb{w},X)}\\right\\}$ . Then, let $B$ be the union of $\\begin{array}{r}{\\tilde{O}\\bigg(\\bigg(\\sqrt{\\frac{r^{Q-1}}{d^{Q-1}}}\\sqrt{\\frac{r}{T_{1}}}+\\sqrt{\\frac{r^{2}}{N_{1}T_{1}}}\\bigg)/\\sqrt{d}\\bigg)}\\end{array}$ -coverings of $B_{i}\\in B(\\pmb{w},X)$ . Since $|B|$ is polynomial in $d$ , Lemma 27 holds with high probability uniformly over $b\\in B$ . ", "page_idx": 26}, {"type": "text", "text": "Moreover, from the construction and Lemma 29, for $b\\in[-1,1]\\setminus B$ , there exists $\\pi(b)\\in B$ such that ", "page_idx": 26}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\lvert\\lvert\\lvert g_{T_{1},N_{1}}(\\pmb{w},b,\\{({X}^{t},{y}^{t},{x}^{t},{y}^{t})\\}_{t=1}^{T_{1}})-g(\\pmb{w},b)\\rvert\\rvert}\\\\ &{\\quad-\\lvert\\lvert g_{T_{1},N_{1}}(\\pmb{w},\\pi(b),\\{({X}^{t},{y}^{t},{x}^{t},{y}^{t})\\}_{t=1}^{T_{1}})-g(\\pmb{w},\\pi(b))\\rvert\\rvert}\\\\ &{\\le\\tilde{O}\\left(\\sqrt{\\frac{r^{Q-1}}{d^{Q-1}}}\\sqrt{\\frac{r}{T_{1}}}+\\sqrt{\\frac{r^{2}}{N_{1}T_{1}}}\\right)}\\end{array}\n$$", "text_format": "latex", "page_idx": 26}, {"type": "text", "text": "holds. ", "page_idx": 26}, {"type": "text", "text": "Lemma 31. With high probability over the distribution of $\\{(\\pmb{X}^{t},\\pmb{y}^{t},\\pmb{x}^{t},y^{t})\\}_{t=1}^{T_{1}}$ , ", "page_idx": 26}, {"type": "text", "text": "\u2022 It holds that ", "page_idx": 26}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\underset{b\\in[-1,1]}{\\operatorname*{sup}}\\,\\lVert g(\\pmb{w},b)-g_{T_{1},N_{1}}(\\pmb{w},b,\\{(\\pmb{X}^{t},\\pmb{y}^{t},\\pmb{x}^{t},\\boldsymbol{y}^{t})\\}_{t=1}^{T_{1}})\\rVert}\\\\ &{=\\Tilde{O}\\left(\\sqrt{\\frac{r^{Q-1}}{d^{Q-1}}}\\sqrt{\\frac{d}{T_{1}}}+\\sqrt{\\frac{d^{2}}{N_{1}T_{1}}}\\right)}\\end{array}\n$$", "text_format": "latex", "page_idx": 26}, {"type": "text", "text": "with high probability over $w\\sim\\mathrm{Unif}(\\mathbb{S}^{d-1})$ . ", "page_idx": 26}, {"type": "text", "text": "\u2022 It holds that ", "page_idx": 27}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\underset{b\\in[-1,1]}{\\operatorname*{sup}}\\mathbb{E}_{w\\sim\\mathrm{Unif}(\\mathbb{S}^{d-1})}[\\|g(w,b)-g_{T_{1},N_{1}}(w,b,\\{(X^{t},y^{t},x^{t},y^{t})\\}_{t=1}^{T_{1}})\\|^{j}]^{1/j}}\\\\ &{=\\!\\tilde{O}\\left(\\sqrt{\\frac{r^{Q-1}}{d^{Q-1}}}\\sqrt{\\frac{r}{T_{1}}}+\\sqrt{\\frac{r^{2}}{N_{1}T_{1}}}\\right)}\\end{array}\n$$", "text_format": "latex", "page_idx": 27}, {"type": "text", "text": "for $j\\in[4P]$ . ", "page_idx": 27}, {"type": "text", "text": "Proof. If an event $A$ occurs with probability at least $1-d^{-C}$ over the simultaneous distribution of $(\\pmb{w},\\{(\\pmb{X}^{t},\\pmb{y}^{t},\\pmb{x}^{t},y^{t})\\}_{t=1}^{T_{1}})$ , then we can say that ", "page_idx": 27}, {"type": "text", "text": "\u2022 with probability at least $1-d^{C/2}$ over $\\{(\\pmb{X}^{t},\\pmb{y}^{t},\\pmb{x}^{t},y^{t})\\}_{t=1}^{T_{1}}$ , Pw{A | {(Xt, yt, xt, yt)}tT=11)} \u2265 $1-d^{-C/2}$ holds. ", "page_idx": 27}, {"type": "text", "text": "(B.12) follows from this remark and Corollary 30. ", "page_idx": 27}, {"type": "text", "text": "For (B.13), with high probability over the distribution of $\\{(\\pmb{X}^{t},\\pmb{y}^{t},\\pmb{x}^{t},y^{t})\\}_{t=1}^{T_{1}}$ , $\\mathbb{P}_{\\pmb{w}}\\{(\\mathbf{B}.11)\\ \\mid\\$ $\\{(X^{t},\\pmb{y}^{t},\\pmb{x}^{t},\\pmb{y}^{t})\\}_{t=1}^{T_{1}}\\}\\geq1-d^{-\\tilde{C}}$ is satisfied for some $\\tilde{C}$ . Also, from Lemma 10 and Corollary \u221a17, with high probability over the distribution of $\\{(\\pmb{X}^{t},\\pmb{y}^{t},\\pmb{x}^{t},y^{t})\\}_{t=1}^{T_{1}}$ , we have $\\|\\pmb{x}_{i}^{t}\\|,\\|\\pmb{x}^{t}\\|=O(\\sqrt{d})$ and $|y^{t}|\\;=\\;\\tilde{O}(1)$ . From the definition of $g_{T_{1},N_{1}}(\\pmb{w},b,\\{(\\pmb{X}^{t},\\pmb{y}^{t},\\pmb{x}^{t},y^{t})\\}_{t=1}^{T_{1}})$ (B.2) and expansion of $\\scriptstyle\\pmb{g}(\\pmb{w},\\,b)$ (B.6) $\\begin{array}{r l}&{\\operatorname*{sup}_{w}\\|g(\\pmb{w},b)-g_{T_{1},N_{1}}(\\pmb{w},b,\\{(\\pmb{X}^{t},\\pmb{y}^{t},\\pmb{x}^{t},y^{t})\\}_{t=1}^{T_{1}})\\|\\leq\\operatorname*{sup}_{w}\\|g(\\pmb{w},b)\\|+}\\end{array}$ $\\begin{array}{r l}&{\\operatorname*{sup}_{{\\pmb w}}\\|g_{T_{1},N_{1}}({\\pmb w},b,\\{({\\pmb X}^{t},{\\pmb y}^{t},{\\pmb x}^{t},y^{t})\\}_{t=1}^{T_{1}})\\|}\\end{array}$ is upper bounded by ${\\tilde{O}}(d)$ . Therefore, with high probability ", "page_idx": 27}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\quad\\underset{b\\in[-1,1]}{\\operatorname*{sup}}\\mathbb{E}_{w\\sim\\mathrm{Unif}(\\mathbb{S}^{d-1})}[\\|g(w,b)-g_{T_{1},N_{1}}(w,b,\\{(X^{t},y^{t},x^{t},y^{t})\\}_{t=1}^{T_{1}})\\|^{j}]^{1/j}}\\\\ &{\\le\\!\\mathbb{E}_{w\\sim\\mathrm{Unif}(\\mathbb{S}^{d-1})}\\left[\\left(\\underset{b\\in[-1,1]}{\\operatorname*{sup}}\\|g(w,b)-g_{T_{1},N_{1}}(w,b,\\{(X^{t},y^{t},x^{t},y^{t})\\}_{t=1}^{T_{1}})\\|\\right)^{j}\\right]^{1/j}}\\\\ &{=\\!\\tilde{O}\\left(\\left(\\left(1-d^{-\\tilde{C}}\\right)\\left(\\sqrt{\\frac{r^{Q-1}}{d^{Q-1}}}\\sqrt{\\frac{r}{T_{1}}}+\\sqrt{\\frac{r^{2}}{N_{1}T_{1}}}\\right)^{j}+\\left(d^{-\\tilde{C}}\\right)d^{j}\\right)^{1/j}\\right).}\\end{array}\n$$", "text_format": "latex", "page_idx": 27}, {"type": "text", "text": "By setting sufficiently large $\\tilde{C}$ , we arrive at the claim. ", "page_idx": 27}, {"type": "text", "text": "Summary. We combine the obtained results and show that $\\begin{array}{r l}&{\\|g_{T_{1},N_{1}}(\\pmb{w},b,\\{(\\pmb{X}^{t},\\pmb{y}^{t},\\pmb{x}^{t},y^{t})\\}_{t=1}^{T_{1}})\\|}\\end{array}$ and the moment of the residual terms are bounded with high probability. ", "page_idx": 27}, {"type": "text", "text": "Corollary 32. With high probability over the distribution of $\\{(\\pmb{X}^{t},\\pmb{y}^{t},\\pmb{x}^{t},y^{t})\\}_{t=1}^{T_{1}}$ , ", "page_idx": 27}, {"type": "text", "text": "(I) $\\begin{array}{r l}{g_{T_{1}^{1},N_{1}}(w,b,\\{(X^{t},y^{t},x^{t},y^{t})\\}_{t=1}^{T_{1}})}&{=\\ m(w,b)\\ +\\ r(w,b,\\{(X^{t},y^{t},x^{t},y^{t})\\}_{t=1}^{T_{1}})}\\end{array}$ holds where ", "page_idx": 27}, {"type": "equation", "text": "$$\n\\pmb{m}(\\pmb{w},b):=\\frac{2a_{Q}(b)^{2}\\mathbb{E}_{c_{Q}}[c_{Q}^{2}]}{Q!(Q-1)!}\\frac{(2Q-1)!!}{\\mathbb{E}_{z\\sim\\chi_{r}}[z^{2Q}]}\\|\\pmb{w}_{1:r}\\|^{2Q-2}\\bigg[\\pmb{w}_{1:r}\\bigg],\n$$", "text_format": "latex", "page_idx": 27}, {"type": "text", "text": "and ", "page_idx": 27}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\underset{b\\in[-1,1]}{\\operatorname*{sup}}\\mathbb{E}_{w\\sim\\mathrm{Unif}(\\mathbb{S}^{d-1})}\\left[\\left\\|\\left(r(w,b,\\{(X^{t},y^{t},x^{t},y^{t})\\}_{t=1}^{T_{1}})\\right)_{1:r}\\right\\|^{j}\\right]^{1/j}}\\\\ &{=\\tilde{O}_{d,r}\\left(\\sqrt{\\frac{r^{Q-1}}{d^{Q-1}}}\\sqrt{\\frac{r}{T_{1}}}+\\sqrt{\\frac{r^{2}}{N_{1}T_{1}}}+\\sqrt{\\frac{r}{d^{2Q+1}}}\\right).}\\end{array}\n$$", "text_format": "latex", "page_idx": 27}, {"type": "text", "text": "(II) I $\\dot{\\gamma}_{1\\dot{\\gamma}}\\leq\\sqrt{r d^{2Q-1}}/C_{1}(\\log d)^{C_{2}}$ for sufficiently large $C_{1}$ and $C_{2}$ , $T_{1}\\gtrsim r^{Q}d^{Q+1}$ , and $N_{1}T_{1}\\gtrsim$ $r d^{2Q+1}$ , then ", "page_idx": 28}, {"type": "equation", "text": "$$\n\\operatorname*{sup}_{b\\in[-1,1]}\\|2\\eta_{1}\\gamma\\pmb{g}_{T_{1},N_{1}}(\\pmb{w},b,\\{(\\pmb{X}^{t},\\pmb{y}^{t},\\pmb{x}^{t},\\pmb{y}^{t})\\}_{t=1}^{T_{1}})\\|\\le1\n$$", "text_format": "latex", "page_idx": 28}, {"type": "text", "text": "holds with high probability over $w\\sim\\mathrm{Unif}(\\mathbb{S}^{d-1})$ . Moreover, ", "page_idx": 28}, {"type": "equation", "text": "$$\n\\operatorname*{sup}_{b\\in[-1,1]}\\left\\vert\\left\\langle2\\eta_{1}\\gamma\\pmb{g}_{T_{1},N_{1}}(\\pmb{w},b,\\{(\\boldsymbol{X}^{t},\\pmb{y}^{t},\\pmb{x}^{t},\\boldsymbol{y}^{t})\\}_{t=1}^{T_{1}},\\boldsymbol{z})\\right\\rangle\\right\\vert\\leq\\log d\n$$", "text_format": "latex", "page_idx": 28}, {"type": "text", "text": "holds with high probability over $w\\sim\\mathrm{Unif}(\\mathbb{S}^{d-1})$ and the training data for the second stage $\\{(\\pmb{X}^{t},\\pmb{y}^{t},\\pmb{x}^{t},\\pmb{y}^{t})\\}_{t=T_{1}+1}^{T_{2}}$ , where $\\begin{array}{r}{z\\in\\bigcup_{t=T_{1}+1}^{T_{2}}\\{\\pmb{x}_{1}^{t},\\pmb{\\mathscr{s}}_{1},\\pmb{\\mathscr{s}}_{2}^{t},\\pmb{x}_{N_{2}}^{t},\\pmb{x}^{t}\\}.}\\end{array}$ . ", "page_idx": 28}, {"type": "text", "text": "Proof. Combining Lemmas 23 and 31 yields (I). For (II), by the condition for $T_{1}$ and $N_{1}$ , we obtain ", "page_idx": 28}, {"type": "equation", "text": "$$\n\\begin{array}{r l r}{\\lefteqn{\\operatorname*{sup}_{\\forall[-1,1]}\\lVert g_{T_{1},N_{1}}(\\pmb{w},b,\\{(\\pmb{X}^{t},\\pmb{y}^{t},\\pmb{x}^{t},y^{t})\\}_{t=1}^{T_{1}})\\rVert\\leq\\tilde{O}_{d,r}\\left(\\sqrt{\\frac{r^{Q-1}}{d^{Q-1}}}\\sqrt{\\frac{d}{T_{1}}}+\\sqrt{\\frac{d^{2}}{N_{1}T_{1}}}+\\sqrt{\\frac{1}{r d^{2Q-1}}}\\right)}}\\\\ &{}&{=\\tilde{O}_{d,r}\\left(\\sqrt{\\frac{1}{r d^{2Q-1}}}\\right)}\\end{array}\n$$", "text_format": "latex", "page_idx": 28}, {"type": "text", "text": "from Lemmas 24 and 31. Then, as \u03b71\u03b3 \u2272 rd2Q\u22121/C1(log d)C2, $\\begin{array}{r l}&{\\operatorname*{sup}_{b\\in[-1,1]}\\|2\\eta_{1}\\gamma g_{T_{1},N_{1}}(\\pmb{w},b,\\{(\\pmb{X}^{t},\\pmb{y}^{t},\\pmb{x}^{t},\\pmb{y}^{t})\\}_{t=1}^{T_{1}})\\|\\leq1}\\end{array}$ is achieved. ", "page_idx": 28}, {"type": "text", "text": "By an argument similar to the one in the proof of Lemma 18, we obtain that with high probability, $\\begin{array}{r}{\\left|\\left<2\\eta_{1}\\gamma\\pmb{g}_{T_{1},N_{1}}^{-}(\\pmb{w},b,\\{(\\pmb{X}^{t},\\pmb{y}^{t},\\pmb{x}^{t},y^{t})\\}_{t=1}^{T_{1}},\\pmb{z})\\right>\\right|\\lesssim\\log d}\\end{array}$ for $z\\in\\bigcup_{t=T_{1}+1}^{T_{2}}\\{\\pmb{x}_{1}^{t},\\allowbreak\\cdot\\cdot\\cdot,\\pmb{x}_{N_{2}}^{t},\\pmb{x}^{t}\\}$ . To obtain the supremum bound over $b\\in[-1,1]$ , it suffices to utilize Lemma 29 again. \u53e3 ", "page_idx": 28}, {"type": "text", "text": "In the following sections, we assume that these two events (I) and (II) occur. ", "page_idx": 28}, {"type": "text", "text": "C Construction of Attention Matrix ", "text_level": 1, "page_idx": 28}, {"type": "text", "text": "We construct an attention matrix $\\bar{\\Gamma}$ with a good approximation property: see Section 3.2.2 for the proof outline. ", "page_idx": 28}, {"type": "text", "text": "In this section, a set of basis functions $\\mathcal{H}$ is defined as ", "page_idx": 28}, {"type": "equation", "text": "$$\n{\\mathcal{H}}=\\left\\{x\\mapsto\\prod_{j=1}^{r}{\\frac{1}{\\sqrt{j!}}}\\mathrm{He}_{p_{j}}(x_{j})\\Bigg|Q\\leq p_{1}+\\cdot\\cdot+p_{r}\\leq P,p_{1}\\geq0,\\ldots,p_{r}\\geq0\\right\\}.\n$$", "text_format": "latex", "page_idx": 28}, {"type": "text", "text": "We let $B_{P}:=|\\mathcal{H}|$ and introduce a numbering $\\mathcal{H}=\\{h_{1},\\dotsc,h_{B_{P}}\\}$ . Note that ", "page_idx": 28}, {"type": "equation", "text": "$$\nB_{P}=\\sum_{i=Q}^{P}{\\binom{r+i-1}{i}}=\\Theta(r^{P}).\n$$", "text_format": "latex", "page_idx": 28}, {"type": "text", "text": "C.1 Approximation Error of Two-layer Neural Network ", "text_level": 1, "page_idx": 28}, {"type": "text", "text": "As sketched in Section 3.2.2, we need to show that there is a set of two-layer neural networks which can approximate basis functions well. The goal of this section is to show the following proposition. ", "page_idx": 28}, {"type": "text", "text": "Proposition 33. Assume $T_{1}\\,=\\,\\tilde{\\Omega}(d^{Q+1}r^{Q})$ and $N_{1}T_{1}\\,=\\,\\tilde{\\Omega}(d^{2Q+1}r)$ . Let $\\{{\\pmb w}_{j}^{(1)}\\}_{j}$ be neurons $^{\\,l}$ $\\begin{array}{r}{\\gamma\\asymp\\frac{1}{m^{\\frac{3}{2}}r^{\\frac{1}{2}}d^{Q}},\\eta_{1}\\asymp m^{\\frac{3}{2}}r d^{2Q-\\frac{1}{2}}\\cdot(\\log d)^{-C_{\\eta}}}\\end{array}$ $C_{\\eta}$ Assume b is re-initialized in Line 5 of Algorithm $^{\\,l}$ . Then, with high probability over the distribution of training data and the initialization of model parameters, there exist vectors $\\pmb{a}^{1},\\dots,\\pmb{a}^{B_{P}}\\in\\mathbb{R}^{m}$ such that for each $n\\in[B_{P}]$ , ", "page_idx": 28}, {"type": "equation", "text": "$$\n\\operatorname*{sup}_{i\\in[N_{2}],T_{1}+1\\leq t\\leq T_{2}}\\left(\\sum_{j=1}^{m}a_{j}^{n}\\sigma({w_{j}^{(1)}}^{\\top}x_{i}^{t}+b_{j})-h_{n}(x_{i}^{t})\\right)^{2}=\\tilde{O}\\bigg(\\frac{r^{P}}{m}+\\frac{1}{N_{2}}\\bigg),\n$$", "text_format": "latex", "page_idx": 28}, {"type": "equation", "text": "$$\n\\operatorname*{sup}_{T_{1}+1\\leq t\\leq T_{2}}\\left(\\sum_{j=1}^{m}a_{j}^{n}\\sigma({w_{j}^{(1)}}^{\\top}{x^{t}}+b_{j})-h_{n}({\\pmb x}^{t})\\right)^{2}=\\tilde{O}\\!\\left(\\frac{r^{P}}{m}+\\frac{1}{N_{2}}\\right)\n$$", "text_format": "latex", "page_idx": 29}, {"type": "text", "text": "holds. Moreover, $\\begin{array}{r}{\\operatorname*{sup}_{n\\in[B_{P}]}\\|\\pmb{a}^{n}\\|^{2}=\\tilde{O}\\Big(\\frac{r^{P}}{m}\\Big)}\\end{array}$ . ", "page_idx": 29}, {"type": "text", "text": "This proposition states that there exists a two-layer neural network $\\begin{array}{r}{\\sum_{j=1}^{m}a_{j}^{n}\\sigma\\Big(\\langle\\pmb{w}_{j}^{(1)},\\cdot\\rangle+b_{j}\\Big)}\\end{array}$ which can approximate the basis function $h_{n}$ , and its second-layer magnitude $\\|\\pmb{a}^{n}\\|^{2}$ only scales with $r$ . Note that the condition of $T_{1}$ and $N_{1}T_{1}$ comes from Corollary 32, which implies that the noise terms of the one-step gradient is well controlled. ", "page_idx": 29}, {"type": "text", "text": "C.1.1 Alignment to $\\boldsymbol{S}$ and Efficient Approximation ", "text_level": 1, "page_idx": 29}, {"type": "text", "text": "From now on, we suppose that $\\pmb{g}_{T_{1},N_{1}}(\\pmb{w},b)$ satisfies the conditions in Corollary 32 (to simplify the notation, we drop the dependency on $\\{(\\pmb{X}^{t},\\pmb{y}^{t},\\pmb{x}^{t},y^{t})\\}_{t=1}^{T_{1}})$ . An important previous result [DLS22] is that, if $\\pmb{g}_{T_{1},N_{1}}(\\pmb{w},b)$ aligns with the $r$ -dimensional subspace $\\boldsymbol{S}$ , then it can be used to approximate polynomials on $\\boldsymbol{S}$ efficiently. ", "page_idx": 29}, {"type": "text", "text": "Lemma 34 (Lemma 21 in [DLS22]). There exists a set of symmetric $r$ -dimensional tensors $\\{\\pmb{T}_{k}^{n}\\}_{0\\leq k\\leq P,n\\in\\{B_{P}\\}}$ such that ", "page_idx": 29}, {"type": "equation", "text": "$$\nh_{n}(\\pmb{x})=\\sum_{0\\leq k\\leq P}\\langle\\pmb{T}_{k}^{n},\\pmb{x}_{1:r}^{\\otimes k}\\rangle\n$$", "text_format": "latex", "page_idx": 29}, {"type": "text", "text": "and $\\|T_{k}^{n}\\|_{F}\\lesssim r^{\\frac{P-k}{4}}$ . ", "page_idx": 29}, {"type": "text", "text": "Definition 35 $(f(r,d)$ -alignment). We call that $\\pmb{g}_{T_{1},N_{1}}(\\pmb{w},b)$ has $f(r,d)$ -alignment with $\\boldsymbol{S}$ , if the following holds: ", "page_idx": 29}, {"type": "text", "text": "\u2022 For any $0\\leq k\\leq P$ -symmetric $r$ -dimensional tensor $_T$ , ", "page_idx": 29}, {"type": "equation", "text": "$$\n\\mathbb{E}_{w\\sim\\mathrm{Unif}(\\mathbb{S}^{d-1})}[\\left\\langle T,g_{T_{1},N_{1}}(\\pmb{w},b)_{1:r}^{\\otimes k}\\right\\rangle^{2}]\\gtrsim f(r,d)^{k}\\|\\pmb{T}\\|_{F}^{2},\n$$", "text_format": "latex", "page_idx": 29}, {"type": "text", "text": "and the hidden constant in $\\hat{\\mathbf{\\Omega}}^{\\ast}\\gtrsim$ \u201d needs to be uniformly lower bounded. ", "page_idx": 29}, {"type": "text", "text": "Lemma 36 (Corollary 4 in [DLS22], adapted). Suppose that $\\pmb{g}_{T_{1},N_{1}}(\\pmb{w},b)$ has $f(r,d)$ -alignment with $\\boldsymbol{S}$ . Let $_T$ be a $0\\leq k\\leq P$ -symmetric $r$ -dimensional tensor. Then, there exists $\\psi_{T}(\\boldsymbol{w},\\boldsymbol{b})$ such that ", "page_idx": 29}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{E}_{{\\mathbf w}\\sim\\mathrm{Unif}(\\mathbb{S}^{d-1})}[\\psi_{T}({\\mathbf w},b)\\langle g_{T_{1},N_{1}}({\\mathbf w},b),{\\mathbf x}\\rangle^{k}]=\\langle T,x_{1:r}^{\\otimes k}\\rangle,}\\\\ &{\\qquad\\qquad\\qquad\\mathbb{E}_{{\\mathbf w}\\sim\\mathrm{Unif}(\\mathbb{S}^{d-1})}[\\psi_{T}({\\mathbf w},b)^{2}]\\lesssim f(r,d)^{-k}\\|T\\|_{F}^{2},}\\\\ &{\\qquad\\qquad\\qquad\\qquad\\quad|\\psi_{T}({\\mathbf w},b)|\\lesssim f(r,d)^{-k}\\|T\\|_{F}\\|g_{T_{1},N_{1}}({\\mathbf w},b)\\|^{k}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 29}, {"type": "text", "text": "Intuitively speaking, $f(r,d)$ -alignment ensures that the MLP gradient $\\pmb{g}_{T_{1},N_{1}}(\\pmb{w},b)$ has sufficiently large component on $\\boldsymbol{S}$ . If so, the lemma states that, an infinite-width neural network $\\mathbb{E}_{\\pmb{w}}[\\psi_{T}(\\pmb{w},b)\\langle\\pmb{g}_{T_{1},N_{1}}(\\pmb{w},b),\\cdot\\rangle^{k}]$ , whose hidden layer weight is $\\pmb{g}_{T_{1},N_{1}}(\\pmb{w},b)$ and the activation is $z\\mapsto z^{k}$ , can express the functions $\\langle\\pmb{T},\\pmb{x}_{1:r}^{\\otimes k}\\rangle$ with small output layer $\\psi_{T}(\\boldsymbol{w},\\boldsymbol{b})$ . ", "page_idx": 29}, {"type": "text", "text": "Let us show that our $\\pmb{g}_{T_{1},N_{1}}(\\pmb{w},b)$ has sufficient alignment if $b$ satisfies (B.5). ", "page_idx": 29}, {"type": "text", "text": "Lemma 37 (Tensor expectation lower bound). Let $\\textbf{\\emph{T}}$ be a $k\\leq P$ -symmetric $r$ -dimensional tensor and $\\bar{\\pmb{w}}=\\pmb{w}_{1:r}\\|\\pmb{w}_{1:r}\\|^{2}\\pmb{\\dot{Q}}-2$ . Then ", "page_idx": 29}, {"type": "equation", "text": "$$\n\\mathbb{E}_{w\\sim\\mathrm{Unif}(\\mathbb{S}^{d-1})}[\\pmb{T}(\\bar{\\pmb{w}}^{\\otimes k})^{2}]\\gtrsim\\frac{r^{Q i}}{d^{(Q+1)i}}\\mathbb{E}[\\|\\pmb{T}(\\bar{\\pmb{w}}^{\\otimes k-i})\\|_{F}^{2}]\n$$", "text_format": "latex", "page_idx": 29}, {"type": "text", "text": "holds for all $0\\leq i\\leq k$ . Here $\\pmb{T}(\\pmb{\\bar{w}}^{\\otimes0}):=\\pmb{T}$ . ", "page_idx": 29}, {"type": "text", "text": "Proof. Let $\\pmb{u}\\sim\\mathcal{N}(0,I_{d})$ , $z\\,\\sim\\,\\chi(d)$ and $\\bar{\\pmb{u}}\\,=\\,\\pmb{u}_{1:r}\\|\\pmb{u}_{1:r}\\|^{2Q-2}$ . We can decompose $\\bar{\\pmb u}$ as $\\bar{\\pmb u}=$ $z^{2Q-1}\\bar{w}$ . Therefore ", "page_idx": 29}, {"type": "equation", "text": "$$\n\\mathbb{E}[T(\\bar{u}^{\\otimes k})^{2}]=\\mathbb{E}[z^{(4Q-2)k}]\\mathbb{E}[T(\\bar{w}^{\\otimes k})^{2}]\n$$", "text_format": "latex", "page_idx": 29}, {"type": "text", "text": "holds. On the other hand, let $\\textstyle x\\sim\\mathbb{S}^{r-1}$ and $z^{\\prime}\\sim\\chi(r)$ . Then we can decompose $\\bar{\\pmb u}$ as $\\bar{\\pmb u}=(z^{\\prime})^{2Q-1}\\pmb x$ . Thus ", "page_idx": 30}, {"type": "equation", "text": "$$\n\\mathbb{E}[T(\\bar{\\pmb{u}}^{\\otimes k})^{2}]=\\mathbb{E}[(z^{\\prime})^{(4Q-2)k}]\\mathbb{E}[T(\\pmb{x}^{\\otimes k})^{2}]\n$$", "text_format": "latex", "page_idx": 30}, {"type": "text", "text": "holds. It implies that ", "page_idx": 30}, {"type": "equation", "text": "$$\n\\mathbb{E}[T(\\bar{\\boldsymbol{w}}^{\\otimes k})^{2}]=\\frac{\\mathbb{E}[(\\boldsymbol{z}^{\\prime})^{(4Q-2)k}]}{\\mathbb{E}[\\boldsymbol{z}^{(4Q-2)k}]}\\mathbb{E}[T(\\pmb{x}^{\\otimes k})^{2}].\n$$", "text_format": "latex", "page_idx": 30}, {"type": "text", "text": "Similarly, ", "page_idx": 30}, {"type": "equation", "text": "$$\n\\mathbb{E}[\\|T(\\pmb{\\bar{w}}^{\\otimes k-i})\\|_{F}^{2}]=\\frac{\\mathbb{E}[(z^{\\prime})^{(4Q-2)(k-i)}]}{\\mathbb{E}[z^{(4Q-2)(k-i)}]}\\mathbb{E}[\\|T(\\pmb{x}^{\\otimes(k-i)})\\|_{F}^{2}]\n$$", "text_format": "latex", "page_idx": 30}, {"type": "text", "text": "is satisfied. Now from Corollary 13 in [DLS22], ", "page_idx": 30}, {"type": "equation", "text": "$$\n\\mathbb{E}[\\|T({\\pmb x}^{\\otimes(k-i)})\\|_{F}^{2}]\\lesssim r^{i}\\mathbb{E}[T({\\pmb x}^{\\otimes k})^{2}]\n$$", "text_format": "latex", "page_idx": 30}, {"type": "text", "text": "holds. Therefore we obtain ", "page_idx": 30}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{E}[T(\\bar{w}^{\\otimes k})^{2}]=\\frac{\\mathbb{E}[(z^{\\prime})^{(4Q-2)k}]}{\\mathbb{E}[z^{(4Q-2)k}]}\\mathbb{E}[T(x^{\\otimes k})^{2}]}\\\\ &{\\quad\\quad\\quad\\quad\\quad\\gtrsim r^{-i}\\frac{\\mathbb{E}[(z^{\\prime})^{(4Q-2)k}]}{\\mathbb{E}[z^{(4Q-2)k}]}\\mathbb{E}[\\|T(x^{\\otimes(k-i)})\\|_{F}^{2}]}\\\\ &{\\quad\\quad\\quad\\quad=r^{-i}\\frac{\\mathbb{E}[(z^{\\prime})^{(4Q-2)k}]}{\\mathbb{E}[z^{(4Q-2)k}]}\\frac{\\mathbb{E}[z^{(4Q-2)(k-i)}]}{\\mathbb{E}[(z^{\\prime})^{(4Q-2)(k-i)}]^{\\mathbb{E}}[\\|T(\\bar{w}^{\\otimes k-i})\\|_{F}^{2}]}\\mathbb{E}[\\|T(\\bar{w}^{\\otimes k-i})\\|_{F}^{2}]}\\\\ &{\\quad\\quad\\quad\\quad=\\frac{r^{(2Q-2)i}}{d^{(2Q-1)i}}\\mathbb{E}[\\|T(\\bar{w}^{\\otimes k-i})\\|_{F}^{2}].}\\end{array}\n$$", "text_format": "latex", "page_idx": 30}, {"type": "text", "text": "Corollary 38. Let $\\textbf{\\emph{T}}$ be a $k\\ \\le\\ {\\cal P}$ -symmetric $r$ -dimensional tensor and let $m({\\pmb w},{\\boldsymbol b})_{1:r}\\;\\;=\\;\\;$ Q2!a(QQ(\u2212b)12)!EcQE[zc\u223cQ\u03c7]r( [2zQ2Q\u2212]1)!!\u2225w1:r\u22252Q\u22122w1:r. Moreover, assume that (B.5) holds. Then, ", "page_idx": 30}, {"type": "equation", "text": "$$\n\\mathbb{E}_{w\\sim\\mathrm{Unif}(\\mathbb{S}^{d-1})}[\\left\\langle T,m(w,b)_{1:r}^{\\otimes k}\\right\\rangle^{2}]\\gtrsim\\frac{1}{d^{(2Q-1)i}r^{2i}}\\mathbb{E}[\\|T(m(w,b)_{1:r}^{\\otimes k-i})\\|_{F}^{2}]\n$$", "text_format": "latex", "page_idx": 30}, {"type": "text", "text": "holds for all $0\\leq i\\leq k$ . ", "page_idx": 30}, {"type": "text", "text": "Proof. This is obtained by calibrating the coefficients from the previous lemma. ", "page_idx": 30}, {"type": "text", "text": "Lemma 39. Let $_T$ be a $0\\,\\leq\\,k\\,\\leq\\,P$ -symmetric $r$ -dimensional tensor. Assume that (B.5) holds. Furthermore, suppose $r\\lesssim d^{\\frac12}$ , $T_{1}=\\tilde{\\Omega}(d^{Q+1}r^{Q})$ and $N_{1}T_{1}=\\tilde{\\Omega}(d^{2Q+1}r)$ . Then, ", "page_idx": 30}, {"type": "equation", "text": "$$\n\\mathbb{E}_{w\\sim\\mathrm{Unif}(\\mathbb{S}^{d-1})}[\\left\\langle T,g_{T_{1},N_{1}}(w,b)_{1:r}^{\\otimes k}\\right\\rangle^{2}]\\gtrsim\\frac{1}{d^{(2Q-1)k}r^{2k}}\\|T\\|_{F}^{2}\n$$", "text_format": "latex", "page_idx": 30}, {"type": "text", "text": "holds for all $0\\leq k\\leq P$ . Therefore, $\\pmb{g}_{T_{1},N_{1}}(\\pmb{w},b)$ has $d^{-2Q+1}r^{-2}$ -alignment with $\\boldsymbol{S}$ . ", "page_idx": 30}, {"type": "text", "text": "Proof. Decompose ${\\pmb g}_{T_{1},N_{1}}({\\pmb w},b)={\\pmb m}({\\pmb w},b)+{\\pmb r}({\\pmb w},b)$ as defined in Corollary 32. From the proof of Lemma 11 in [DLS22], we can show that ", "page_idx": 30}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\quad\\mathbb{E}_{\\mathbf{w}\\sim\\mathrm{Unif}(\\mathbb{S}^{d-1})}[\\left\\langle\\pmb{T},\\pmb{g}_{T_{1},N_{1}}(\\pmb{w},b)_{1:r}^{\\otimes k}\\right\\rangle^{2}]}\\\\ &{\\geq\\!\\mathbb{E}_{\\mathbf{w}\\sim\\mathrm{Unif}(\\mathbb{S}^{d-1})}\\left[\\frac{1}{2}\\!\\left\\langle\\pmb{T},\\pmb{m}(\\pmb{w},b)_{1:r}^{\\otimes k}\\right\\rangle^{2}\\right]-\\mathbb{E}_{\\mathbf{w}\\sim\\mathrm{Unif}(\\mathbb{S}^{d-1})}[\\delta(\\pmb{w},b)^{2}]}\\end{array}\n$$", "text_format": "latex", "page_idx": 30}, {"type": "text", "text": "for some $\\delta({\\pmb w},\\,b)$ satisfying ", "page_idx": 30}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\quad\\mathbb{E}_{\\boldsymbol{w}\\sim\\mathrm{Unif}(\\mathbb{S}^{d-1})}[\\delta(\\boldsymbol{w},\\boldsymbol{b})^{2}]}\\\\ &{\\lesssim\\sum_{i=1}^{k}\\mathbb{E}_{\\boldsymbol{w}\\sim\\mathrm{Unif}(\\mathbb{S}^{d-1})}[\\|T(\\boldsymbol{m}(\\boldsymbol{w},\\boldsymbol{b})_{1:r}^{\\otimes k-i})\\|_{F}^{2}]\\sqrt{\\mathbb{E}_{\\boldsymbol{w}\\sim\\mathrm{Unif}(\\mathbb{S}^{d-1})}[\\|\\boldsymbol{r}(\\boldsymbol{w},\\boldsymbol{b})_{1:r}\\|^{4i}]}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 30}, {"type": "text", "text": "Here, from Corollaries 32 and 38, ", "page_idx": 31}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\quad\\mathbb{E}_{w\\sim\\mathrm{Unif}(\\mathbb{S}^{d-1})}[\\delta(w,b)^{2}]}\\\\ &{\\lesssim\\sum_{i=1}^{k}d^{(2Q-1)i}r^{2i}\\mathbb{E}_{w\\sim\\mathrm{Unif}(\\mathbb{S}^{d-1})}[\\langle T,m(w,b)_{1:r}^{\\otimes k}\\rangle^{2}]\\tilde{O}_{d,r}\\Bigg(\\left(\\frac{r^{Q-1}}{d^{Q-1}}\\frac{r}{T_{1}}+\\frac{r^{2}}{N_{1}T_{1}}+\\frac{r}{d^{2Q+1}}\\right)^{i}\\Bigg)}\\end{array}\n$$", "text_format": "latex", "page_idx": 31}, {"type": "text", "text": "holds. Now, from the condition of $N_{1}$ and $T_{1}$ , and $r\\lesssim{\\sqrt{d}}$ , we know ", "page_idx": 31}, {"type": "equation", "text": "$$\nd^{(2Q-1)}r^{2}\\biggl(\\frac{r^{Q-1}}{d^{Q-1}}\\frac{r}{T_{1}}+\\frac{r^{2}}{N_{1}T_{1}}+\\frac{r}{d^{2Q+1}}\\biggr)\\lesssim1.\n$$", "text_format": "latex", "page_idx": 31}, {"type": "text", "text": "Therefore we can achieve $\\begin{array}{r}{\\mathbb{E}_{w\\sim\\mathrm{Unif}(\\mathbb{S}^{d-1})}[\\delta(\\pmb{w},b)^{2}]\\le\\frac{1}{4}\\mathbb{E}_{\\pmb{w}\\sim\\mathrm{Unif}(\\mathbb{S}^{d-1})}[\\left\\langle T,m(\\pmb{w},b)_{1:r}^{\\otimes k}\\right\\rangle^{2}]}\\end{array}$ . Applying this and Corollary 38 $\\ Y=k^{\\prime}$ ) to (C.1) yields the result. ", "page_idx": 31}, {"type": "text", "text": "C.1.2 Approximation Power of Infinite-width Neural Network ", "text_level": 1, "page_idx": 31}, {"type": "text", "text": "No we can show that some \u201cinfinite-width\u201d neural network can approximate the functions $h\\in\\mathcal H$ . Lemma 40 (Lemma 9 in [DLS22], adapted). Let $a\\sim\\operatorname{Unif}(\\{-1,1\\})$ and $b\\sim\\mathrm{Unif}([-\\log d,\\log d])$ . Then, for any $k\\geq0$ there exists $v_{k}(a,b)$ such that for $|x|\\leq\\log d_{\\mathrm{i}}$ , ", "page_idx": 31}, {"type": "equation", "text": "$$\n\\mathbb{E}_{a,b}[v_{k}(a,b)\\sigma(a x+b)]=x^{k},\\operatorname*{sup}_{a,b}|v_{k}(a,b)|=\\tilde{O}_{d}(1).\n$$", "text_format": "latex", "page_idx": 31}, {"type": "text", "text": "Lemma 41 (Lemma 12 and Corollary 5 in [DLS22], adapted). There exists $\\phi_{n}(a,{\\pmb w},b_{1},b_{2})$ such that if ", "page_idx": 31}, {"type": "equation", "text": "$$\nf_{\\phi_{n}}(\\pmb{x}):=\\mathbb{E}_{a,\\pmb{w},b_{1},b_{2}}\\big[\\phi_{n}(\\pmb{a},\\pmb{w},b_{1},b_{2})\\sigma\\big(2\\eta_{1}a\\pmb{g}_{T_{1},N_{1}}(\\pmb{w},b_{1})+b_{2}\\big)\\big]\n$$", "text_format": "latex", "page_idx": 31}, {"type": "text", "text": "where ", "page_idx": 31}, {"type": "equation", "text": "$$\n\\boldsymbol{a}\\sim\\mathrm{Unif}\\{\\pm\\gamma\\},\\boldsymbol{w}\\sim\\mathrm{Unif}(\\mathbb{S}^{d-1}),b_{1}\\sim\\mathrm{Unif}([-1,1]),b_{2}\\sim\\mathrm{Unif}([-\\log d,\\log d]),\n$$", "text_format": "latex", "page_idx": 31}, {"type": "text", "text": "it holds that ", "page_idx": 31}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\displaystyle\\operatorname*{sup}_{i\\in[N_{2}],T_{1}+1\\leq t\\leq T_{2}}\\left(f_{\\phi_{n}}(\\pmb{x}_{i}^{t})-h_{n}(\\pmb{x}_{i}^{t})\\right)^{2}\\lesssim\\frac{1}{N_{2}},}\\\\ &{\\quad\\quad\\quad\\quad\\quad\\displaystyle\\operatorname*{sup}_{T_{1}+1\\leq t\\leq T_{2}}\\left(f_{\\phi_{n}}(\\pmb{x}^{t})-h_{n}(\\pmb{x}^{t})\\right)^{2}\\lesssim\\frac{1}{N_{2}},}\\\\ &{\\quad\\quad\\quad\\quad\\mathbb{E}_{a,\\pmb{w},b_{1},b_{2}}[\\phi_{n}(a,\\pmb{w},b_{1},b_{2})^{2}]=\\tilde{O}(r^{P}),}\\\\ &{\\quad\\quad\\quad\\quad\\quad\\operatorname*{sup}_{a,\\pmb{w},b_{1},b_{2}}|\\phi_{n}(a,\\pmb{w},b_{1},b_{2})|=\\tilde{O}(r^{P})}\\\\ &{\\quad\\quad\\quad\\quad\\quad\\quad\\alpha,\\pmb{w},b_{1},b_{2}}\\end{array}\n$$", "text_format": "latex", "page_idx": 31}, {"type": "text", "text": "for each $n\\in[B_{P}]$ . ", "page_idx": 31}, {"type": "text", "text": "Proof. We first construct $\\phi_{\\mathbf{T}_{k}^{n}}(a,\\mathbf{w},b_{1},b_{2})$ for basis tensors defined in Lemma 34, such that if ", "page_idx": 31}, {"type": "equation", "text": "$$\nf_{\\phi_{T_{k}^{n}}}(\\pmb{x}):=\\mathbb{E}_{a,\\pmb{w},b_{1},b_{2}}\\big[\\phi_{T_{k}^{n}}(a,\\pmb{w},b_{1},b_{2})\\sigma\\big(\\langle2\\eta_{1}a\\pmb{g}_{T_{1},N_{1}}(\\pmb{w},b_{1}),\\pmb{x}\\rangle+b_{2}\\big)\\big],\n$$", "text_format": "latex", "page_idx": 31}, {"type": "text", "text": "it holds that ", "page_idx": 31}, {"type": "equation", "text": "$$\n\\begin{array}{r l r}&{}&{\\operatorname*{sup}_{i\\in[N_{2}],T_{1}+1\\leq t\\leq T_{2}}\\Big(f_{\\phi_{T_{k}^{n}}}(\\pmb{x}_{i}^{t})-\\langle\\pmb{T}_{k}^{n},(\\pmb{x}_{i}^{t})_{1:r}^{\\otimes k}\\rangle\\Big)^{2}\\lesssim\\frac{1}{N_{2}},}\\\\ &{}&{\\operatorname*{sup}_{T_{1}+1\\leq t\\leq T_{2}}\\Big(f_{\\phi_{T_{k}^{n}}}(\\pmb{x}^{t})-\\langle\\pmb{T}_{k}^{n},(\\pmb{x}^{t})_{1:r}^{\\otimes k}\\rangle\\Big)^{2}\\lesssim\\frac{1}{N_{2}}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 31}, {"type": "text", "text": "Let $\\begin{array}{r l r}{\\phi_{\\pmb{T}_{k}^{n}}(a,\\pmb{w},b_{1},b_{2})}&{{}\\!=\\!}&{\\frac{2v_{k}(a,b_{2})\\psi_{\\pmb{T}_{k}^{n}}(\\pmb{w},b_{1})}{(2\\eta_{1})^{k}\\gamma^{k}}\\mathbb{I}_{A(\\pmb{w})}\\mathbb{I}_{B(b_{1})}}\\end{array}$ where $v_{k}$ and $\\psi_{\\pmb{T}_{k}^{n}}$ are constructed in Lemma 36 and the events $A(w)$ and $B(b_{1})$ are defined as ", "page_idx": 31}, {"type": "equation", "text": "$$\nA(w):=\\left\\{\\operatorname*{sup}_{b_{1}\\in[-1,1]}2\\eta_{1}\\gamma|\\left\\langle g_{T_{1},N_{1}}(w,b_{1}),\\pmb{x}_{i}^{t}\\right\\rangle|,\\operatorname*{sup}_{b_{1}\\in[-1,1]}2\\eta_{1}\\gamma|\\left\\langle g_{T_{1},N_{1}}(w,b_{1}),\\pmb{x}^{t}\\right\\rangle|\\leq\\log d\\eta_{1}\\right\\},\n$$", "text_format": "latex", "page_idx": 31}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\qquad\\mathrm{for}\\;i\\in[N_{2}],T_{1}+1\\le t\\le T_{2}\\bigg\\}}\\\\ &{\\qquad\\qquad\\cap\\left\\{\\underset{b_{1}\\in[-1,1]}{\\operatorname*{sup}}\\left\\|2\\eta_{1}\\gamma g_{T_{1},N_{1}}(\\pmb{w},b_{1})\\right\\|\\le1\\right\\}\\qquad}\\\\ &{B(b_{1}):=\\big\\{\\big|\\mathbb{E}_{z\\sim\\mathcal{N}(0,1)}[\\sigma_{b_{1}}(z)\\mathrm{He}_{i}(z)]\\big|\\le C_{H}\\left(2\\le i\\le P+2\\right)\\big\\}}\\\\ &{\\qquad\\qquad\\cap\\left\\{\\left|\\mathbb{E}_{z\\sim\\mathcal{N}(0,1)}[\\sigma_{b_{1}}(z)\\mathrm{He}_{Q}(z)]\\right|\\ge C_{L}\\right\\}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 32}, {"type": "text", "text": "Then, ", "page_idx": 32}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\quad f_{\\phi_{T_{k}^{n}}}(x)}\\\\ &{=\\!\\!\\mathbb{E}_{a,w,b_{1},b_{2}}\\!\\left[\\frac{2v_{k}\\left(a,b_{2}\\right)\\psi_{T_{k}^{n}}\\left(w,b_{1}\\right)}{\\left(2\\eta_{1}\\right)^{k}\\gamma^{k}}\\mathbb{I}_{A(w)}\\mathbb{I}_{B(b_{1})}\\sigma\\big(\\langle2\\eta_{1}a g_{T_{1},N_{1}}(w,b_{1}),x\\rangle+b_{2}\\big)\\right]}\\\\ &{=\\!\\!\\mathbb{E}_{b_{1}}\\!\\left[2\\cdot\\mathbb{I}_{B(b_{1})}\\mathbb{E}_{w}\\!\\left[\\frac{\\psi_{T_{k}^{n}}\\left(w,b_{1}\\right)}{\\left(2\\eta_{1}\\right)^{k}\\gamma^{k}}\\mathbb{I}_{A(w)}\\mathbb{E}_{a^{\\prime},b_{2}}\\lbrack v_{k}(a,b_{2})\\sigma\\big(\\langle2\\eta_{1}a^{\\prime}\\gamma g_{T_{1},N_{1}}(w,b_{1}),x\\rangle+b_{2}\\big)\\right]\\right]\\!,}\\end{array}\n$$", "text_format": "latex", "page_idx": 32}, {"type": "text", "text": "where $a^{\\prime}\\sim\\mathrm{Unif}(\\{\\pm1\\})$ . Here, if $\\begin{array}{r}{\\pmb{x}\\in\\bigcup_{t=T_{1}+1}^{T_{2}}\\{\\pmb{x}_{1}^{t},\\pmb{\\ldots},\\pmb{x}_{N_{2}}^{t},\\pmb{x}^{t}\\},}\\end{array}$ ", "page_idx": 32}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{E}_{w}\\bigg[\\frac{\\psi_{T_{k}^{n}}(w,b_{1})}{(2\\eta_{1})^{k}\\gamma^{k}}\\mathbb{I}_{A(w)}\\mathbb{E}_{a^{\\prime}\\sim\\mathrm{Unif}(\\{\\pm1\\}),b_{2}}\\big[v_{k}(a,b_{2})\\sigma\\big(\\langle2\\eta_{1}a^{\\prime}\\gamma g_{T_{1},N_{1}}(w,b_{1}),x\\rangle+b_{2}\\big)\\big]\\bigg]}\\\\ &{=\\!\\mathbb{E}_{w}\\bigg[\\psi_{T_{k}^{n}}(w,b_{1})\\big\\langle g_{T_{1},N_{1}}(w,b_{1}),x\\big\\rangle^{k}\\bigg]+\\mathbb{E}_{w}\\bigg[\\psi_{T_{k}^{n}}(w,b_{1})\\big(1-\\mathbb{I}_{A(w)}\\big)\\big\\langle g_{T_{1},N_{1}}(w,b_{1}),x\\big\\rangle^{k}\\bigg].}\\end{array}\n$$", "text_format": "latex", "page_idx": 32}, {"type": "text", "text": "Note that the absolute value of second term above can be upper bounded by $\\mathbb{E}_{w}\\big[\\big(1-\\mathbb{I}_{A(w)}\\big)\\big]^{1/2}\\mathbb{E}_{w}\\Big[\\big(\\psi_{T_{k}^{n}}({\\pmb w},b_{1})\\langle g_{T_{1},N_{1}}({\\pmb w},b_{1}),{\\pmb x}\\rangle^{k}\\big)^{2}\\Big]^{1/2}.$ Recall that $A(w)$ occurs with high probability from Corollary 32, and $\\mathbb{E}_{\\mathbf{w}}\\left[\\big(\\psi_{{\\pmb T}_{k}^{n}}({\\pmb w},b_{1})\\langle{\\pmb g}_{T_{1},N_{1}}({\\pmb w},b_{1}),{\\pmb x}\\rangle^{k}\\big)^{2}\\right]^{1/2}$ is polynomial in $d$ . Hence we can set the second term to be $O(1/\\sqrt{N_{2}})$ .   \nMoreover, as $\\mathbb{P}[B(b_{1})]=1/2$ from Lemma 20, we have ", "page_idx": 32}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\quad\\mathbb{E}_{b_{1}}\\Big[2\\cdot\\mathbb{I}_{B(b_{1})}\\mathbb{E}_{w}\\Big[\\psi_{T_{k}^{n}}({\\pmb w},b_{1})\\langle g_{T_{1},N_{1}}({\\pmb w},b_{1}),{\\pmb x}\\rangle^{k}\\Big]\\Big]}\\\\ &{=\\!\\mathbb{E}_{b_{1}}\\big[2\\cdot\\langle{\\pmb T}_{k}^{n},{\\pmb x}^{\\otimes k}\\rangle\\big]+\\mathbb{E}_{b_{1}}\\big[2(1-\\mathbb{I}_{B(b_{1})})\\langle{\\pmb T}_{k}^{n},{\\pmb x}^{\\otimes k}\\rangle\\big]=\\langle{\\pmb T}_{k}^{n},{\\pmb x}^{\\otimes k}\\rangle.}\\end{array}\n$$", "text_format": "latex", "page_idx": 32}, {"type": "text", "text": "Therefore, (C.2) and (C.3) holds. Noting that $\\eta_{1}\\gamma\\asymp\\sqrt{r d^{2Q-1}}/C_{1}(\\log d)^{C_{2}}$ , We obtain ", "page_idx": 32}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\quad\\mathbb{E}_{a,w,b_{1},b_{2}}\\big[\\phi_{T_{k}^{n}}(a,w,b_{1},b_{2})^{2}\\big]}\\\\ &{\\le\\!\\frac4{(2\\eta_{1})^{2k}\\gamma^{2k}}\\mathbb{E}_{a,b_{2}}\\big[v_{k}(a,b_{2})^{2}\\big]\\mathbb{E}_{w,b_{1}}\\big[\\mathbb{I}_{B(b_{1})}\\psi_{T_{k}^{n}}(w,b_{1})^{2}\\big]}\\\\ &{\\lesssim\\!\\frac4{(2\\eta_{1})^{2k}\\gamma^{2k}}\\mathbb{E}_{a,b_{2}}\\big[v_{k}(a,b_{2})^{2}\\big](d^{(2Q-1)}r^{2})^{k}\\|T_{k}^{n}\\|_{F}^{2}}\\\\ &{=\\!\\tilde{O}\\Big(r^{k}r^{\\frac{P-k}{2}}\\Big)}\\end{array}\n$$", "text_format": "latex", "page_idx": 32}, {"type": "text", "text": "and ", "page_idx": 32}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\quad\\underset{a,w,b_{1},b_{2}}{\\operatorname*{sup}}|\\phi_{T_{k}^{n}}(a,{\\pmb w},b_{1},b_{2})|}\\\\ &{\\le\\!\\frac{2}{(2\\eta_{1})^{k}\\gamma^{k}}|v_{k}(a,b_{2})|\\mathbb{I}_{A({\\pmb w})}\\mathbb{I}_{B(b_{1})}|\\psi_{T_{k}^{n}}({\\pmb w},b_{1})|}\\\\ &{\\lesssim\\!\\frac{2}{(2\\eta_{1})^{2k}\\gamma^{2k}}(d^{(2Q-1)}r^{2})^{k}\\|T_{k}^{n}\\|_{F}\\|(2\\eta_{1}\\gamma)g_{T_{1},N_{1}}({\\pmb w},b_{1})\\|^{k}\\mathbb{I}_{A({\\pmb w})}\\mathbb{I}_{B(b_{1})}}\\\\ &{\\lesssim\\!\\tilde{O}\\Big(r^{k}r^{\\frac{P-k}{4}}\\Big)}\\end{array}\n$$", "text_format": "latex", "page_idx": 32}, {"type": "text", "text": "from Lemmas 36 and 39. To show the original claim, it suffices to set $\\phi_{n}(a,{\\boldsymbol{w}},b_{1},b_{2})\\;=\\;\\;$ $\\begin{array}{r}{\\sum_{k=0}^{P}\\phi_{\\mathbf{T}_{k}^{n}}(a,\\mathbf{w},b_{1},b_{2})}\\end{array}$ , which yields the upper bounds on the magnitude of $\\phi_{n}$ because $\\begin{array}{r}{\\sum_{k=0}^{P}r^{k}r^{\\frac{P-k}{2}}\\lesssim r^{P}}\\end{array}$ and $\\begin{array}{r}{\\sum_{k=0}^{P}r^{k}r^{\\frac{P-k}{4}}\\lesssim r^{P}}\\end{array}$ . \u53e3 ", "page_idx": 32}, {"type": "text", "text": "C.1.3 Proof of Proposition 33 ", "text_level": 1, "page_idx": 33}, {"type": "text", "text": "We discretize Lemma 41 to establish Proposition 33. ", "page_idx": 33}, {"type": "text", "text": "Proof. [Proof of Proposition 33] First, in the same discretization manner as the proof of Lemma 13 in [DLS22], we can show that there exists $\\mathbf{\\boldsymbol{a}}^{1},\\ldots,\\mathbf{\\boldsymbol{a}}^{B_{P}}$ such that for each $n\\in[\\bar{B}_{P}]$ , ", "page_idx": 33}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\underset{i\\in[N_{2}],T_{1}+1\\leq t\\leq T_{2}}{\\operatorname*{sup}}\\Biggl(\\sum_{j=1}^{m}a_{j}^{n}\\sigma\\Bigl(\\Bigl\\langle2\\eta_{1}\\Gamma_{j,j}^{(0)}g_{T_{1},N_{1}}(w_{j}^{(0)},b_{j}^{(0)}),\\mathbf{x}_{i}^{t}\\Bigr\\rangle+b_{j}\\Bigr)-h_{n}(\\mathbf{x}_{i}^{t})\\Biggr)^{2}}\\\\ &{=\\bar{O}\\bigg(\\frac{r^{P}}{m}+\\frac{1}{N_{2}}\\bigg),}\\\\ &{\\underset{T_{1}+1\\leq t\\leq T_{2}}{\\operatorname*{sup}}\\Biggl(\\sum_{j=1}^{m}a_{j}^{n}\\sigma\\Bigl(\\Bigl\\langle2\\eta_{1}\\Gamma_{j,j}^{(0)}g_{T_{1},N_{1}}(w_{j}^{(0)},b_{j}^{(0)}),\\mathbf{x}^{t}\\Bigr\\rangle+b_{j}\\Bigr)-h_{n}(\\mathbf{x}^{t})\\Biggr)^{2}}\\\\ &{=\\bar{O}\\bigg(\\frac{r^{P}}{m}+\\frac{1}{N_{2}}\\bigg)}\\end{array}\n$$", "text_format": "latex", "page_idx": 33}, {"type": "text", "text": "and $\\begin{array}{r l r}{\\mathrm{sup}_{n\\in[B_{P}]}\\,\\|{\\pmb{a}}^{n}\\|^{2}}&{=}&{\\tilde{O}\\Big(\\frac{r^{P}}{m}\\Big)}\\end{array}$ with high probability $(b_{j}^{(0)},~b_{j}$ denotes the biases at the first and second initialization, respectively). Recall that ${\\pmb w}_{j}^{(1)}~=~2\\eta_{1}\\Gamma_{j,j}^{(0)}{\\pmb g}_{T_{1},N_{1}}({\\pmb w}_{j}^{(0)},b_{j}^{(0)})~-$ $\\begin{array}{r}{2\\eta_{1}\\frac{1}{T_{1}}\\sum_{t=1}^{T_{1}}f(X^{t},y^{t},x^{t};W^{(0)},\\Gamma^{(0)},b^{(0)})\\nabla_{w_{j}^{(0)}}f(X^{t},y^{t},x^{t};W^{(0)},\\Gamma^{(0)},b^{(0)})}\\end{array}$ . It remains to bound the effect of the second term. By Lemma 18, we know that the norm of second term is $\\tilde{O}\\Big(\\eta_{1}\\gamma^{2}m\\sqrt{d}\\Big)$ . Similar to the argument in the proof of Lemma 18, the inner product between the second term and $\\pmb{x}^{t},\\pmb{x}_{i}^{t}\\left(i\\in[N_{2}],T_{1}+1\\leq t\\leq T_{2}\\right)$ is also $\\tilde{O}\\Big(\\eta_{1}\\gamma^{2}m\\sqrt{d}\\Big)$ , with high probability. From the Cauchy-Schwarz inequality and the Lipschitz continuity of $\\sigma$ , ", "page_idx": 33}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\left|\\displaystyle\\sum_{j=1}^{m}a_{j}^{n}\\sigma\\Big(\\Big\\langle2\\eta_{1}\\Gamma_{j,j}^{(0)}g_{T_{1},N_{1}}(w_{j}^{(0)},b_{j}^{(0)}),x\\Big\\rangle+b_{j}\\Big)-\\displaystyle\\sum_{j=1}^{m}a_{j}^{n}\\sigma\\Big(\\Big\\langle w_{j}^{(1)},x\\Big\\rangle+b_{j}\\Big)\\right|}\\\\ &{=\\!\\tilde{O}\\Bigg(\\sqrt{\\displaystyle\\frac{r^{P}}{m}}\\eta_{1}\\gamma^{2}m\\sqrt{d}\\sqrt{m}\\Bigg)=\\tilde{O}\\Bigg(\\sqrt{\\displaystyle\\frac{r^{P}}{m}}\\Bigg).}\\end{array}\n$$", "text_format": "latex", "page_idx": 33}, {"type": "text", "text": "We obtain the assertion. ", "page_idx": 33}, {"type": "text", "text": "C.2 Concentration of Correlation ", "text_level": 1, "page_idx": 33}, {"type": "text", "text": "eNxepxetc, tawtieo ne vfaolru eaatec ht ,r ewphaincch yd ebceitdwees etnh et haep peromxpiirmiactailo nc oerrrreolra tiino (nb $\\begin{array}{r}{\\frac{1}{N_{2}}\\sum_{j=1}^{N_{2}}y_{j}h(\\mathbf{x}_{j})}\\end{array}$ and its $h\\in\\mathcal H$   \nRecall that can be written in the form ", "page_idx": 33}, {"type": "text", "text": "$h\\in\\mathcal H$ ", "page_idx": 33}, {"type": "equation", "text": "$$\nh(\\pmb{x})=\\prod_{i=1}^{r}\\frac{1}{\\sqrt{p_{i}!}}\\mathrm{He}_{p_{i}}(x_{i})\\;\\big(Q\\leq p_{1}+\\cdot\\,\\cdot\\,+\\,p_{r}\\leq P,p_{1}\\geq0,\\dots,p_{r}\\geq0\\big).\n$$", "text_format": "latex", "page_idx": 33}, {"type": "text", "text": "Also note that ", "page_idx": 33}, {"type": "equation", "text": "$$\n\\begin{array}{l}{\\displaystyle\\frac{1}{N_{2}}\\sum_{j=1}^{N_{2}}y_{j}h({\\boldsymbol x}_{j})-\\mathbb{E}_{{\\boldsymbol x},{\\boldsymbol\\zeta}}[y h({\\boldsymbol x})]}\\\\ {\\displaystyle=\\frac{1}{N_{2}}\\sum_{j=1}^{N_{2}}\\varsigma_{j}h({\\boldsymbol x}_{j})+\\frac{1}{N_{2}}\\sum_{j=1}^{N_{2}}\\sigma_{\\ast}(\\langle{\\boldsymbol x}_{j},\\beta\\rangle)h({\\boldsymbol x}_{j})-\\mathbb{E}_{{\\boldsymbol x}}[\\sigma_{\\ast}(\\langle{\\boldsymbol x},\\beta\\rangle)h({\\boldsymbol x})],}\\end{array}\n$$", "text_format": "latex", "page_idx": 33}, {"type": "text", "text": "where $\\begin{array}{r}{\\sigma_{*}(z)=\\sum_{i=Q}^{P}\\frac{c_{i}}{i!}\\mathrm{He}_{i}(z)}\\end{array}$ . First we give an upper bound for $\\begin{array}{r}{|\\frac{1}{N_{2}}\\sum_{j=1}^{N_{2}}\\sigma_{*}(\\langle\\pmb{x}_{j},\\beta\\rangle)h(\\pmb{x}_{j})-}\\end{array}$ $\\mathbb{E}_{\\pmb{x}}[\\sigma_{*}(\\langle\\pmb{x},\\beta\\rangle)h(\\pmb{x})]|$ . ", "page_idx": 33}, {"type": "text", "text": "Lemma 42. Let $D\\,\\leq\\,2P$ be the degree of $\\sigma_{*}(\\langle\\pmb{x},\\beta\\rangle)h(\\pmb{x})$ , when we regard it as an $r$ -variable polynomial with respect to $(x_{1},\\ldots,x_{r})$ . For all $t>0$ there exist absolute constants $M$ and $C_{D}$ depending only on $D$ such that ", "page_idx": 34}, {"type": "equation", "text": "$$\n\\begin{array}{l}{\\displaystyle\\mathbb{P}\\left(\\left|\\frac{1}{N_{2}}\\sum_{j=1}^{N_{2}}\\sigma_{*}(\\langle x_{j},\\beta\\rangle)h(x_{j})-\\mathbb{E}_{\\mathbf{x}}[\\sigma_{*}(\\langle x,\\beta\\rangle)h(\\pmb{x})]\\right|\\geq t\\right)}\\\\ {\\displaystyle\\leq2\\exp\\left(-\\frac{1}{C_{D}M^{2}}\\operatorname*{min}_{1\\leq k\\leq D}\\left(\\frac{t\\sqrt{N_{2}}}{\\|\\mathbb{E}[\\nabla_{x}^{k}(\\sigma_{*}(\\langle x,\\beta\\rangle)h(\\pmb{x}))]\\|_{F}}\\right)^{2/k}\\right)}\\end{array}\n$$", "text_format": "latex", "page_idx": 34}, {"type": "text", "text": "holds, where $C_{D}$ and $M$ are constants. ", "page_idx": 34}, {"type": "text", "text": "Proof. Let F(x1, . . . , xN) = N12 $\\begin{array}{r l r}{F(\\pmb{x}_{1},\\pmb{\\ldots},\\pmb{x}_{N})}&{{}\\!\\!=}&{\\!\\!\\frac{1}{N_{2}}\\sum_{j=1}^{N_{2}}\\sigma_{*}(\\langle\\pmb{x}_{j},\\beta\\rangle)h(\\pmb{x}_{j})}\\end{array}$ . It is a degree- $D$ polynomial for $x_{1,1},.~.~.~,x_{1,r},.~.~.~,x_{N_{2},r}$ , which are standard Gaussian variables. Also, ", "page_idx": 34}, {"type": "equation", "text": "$$\n\\|\\mathbb{E}[\\nabla^{k}F(x_{1},\\ldots,x_{N})]\\|_{F}=\\sqrt{{N_{2}}^{-1}}\\|\\mathbb{E}[\\nabla^{k}(\\sigma_{*}(\\langle{\\pmb x},\\beta\\rangle)h(x))]\\|_{F}\n$$", "text_format": "latex", "page_idx": 34}, {"type": "text", "text": "is satisfied. Then, applying Lemma 15 to $F$ yields the desired result. ", "page_idx": 34}, {"type": "text", "text": "Then, our aim is to bound $\\|\\mathbb{E}[\\nabla^{k}(\\sigma_{*}(\\langle{\\pmb x},\\beta\\rangle)h({\\pmb x}))]\\|_{F}$ . ", "page_idx": 34}, {"type": "text", "text": "Lemma 43. Let $\\begin{array}{r}{h(\\pmb{x})=\\prod_{i=1}^{r}\\frac{1}{\\sqrt{p_{i}}}\\mathrm{He}_{p_{i}}(x_{i})}\\end{array}$ and $\\tilde{P}=p_{1}+\\cdots+p_{r}$ . For $Q+\\tilde{P}\\leq k\\leq P+\\tilde{P}$ , ", "page_idx": 34}, {"type": "equation", "text": "$$\n\\|\\mathbb{E}[\\nabla^{k}(\\sigma_{*}(\\langle\\pmb{x},\\beta\\rangle)h(\\pmb{x}))]\\|_{F}^{2}\\leq R_{c}^{2}\\bar{C}_{k}\n$$", "text_format": "latex", "page_idx": 34}, {"type": "text", "text": "holds where $\\bar{C}_{k}$ is a constant depending only on $k$ . For other $k$ , $\\|\\mathbb{E}[\\nabla^{k}(\\sigma_{*}(\\langle\\pmb{x},\\beta\\rangle)h(\\pmb{x}))]\\|_{F}=0.$ . ", "page_idx": 34}, {"type": "text", "text": "Proof. First, ", "page_idx": 34}, {"type": "equation", "text": "$$\n\\|\\mathbb{E}[\\nabla^{k}(\\sigma_{*}(\\langle{\\pmb x},\\beta\\rangle)h({\\pmb x}))]\\|_{F}^{2}=\\left\\|\\sum_{i=Q}^{P}\\frac{c_{i}}{i!}\\mathbb{E}[\\nabla^{k}(\\operatorname{He}_{i}(\\langle{\\pmb x},\\beta\\rangle)h({\\pmb x}))]\\right\\|_{F}^{2}\n$$", "text_format": "latex", "page_idx": 34}, {"type": "text", "text": "holds. To calculate $\\mathbb{E}[\\nabla^{k}(\\mathrm{He}_{i}(\\langle\\mathbf{x},\\beta\\rangle)h(\\mathbf{x}))]$ , note that from Lemma 8, ", "page_idx": 34}, {"type": "equation", "text": "$$\n=\\left(\\sum_{q_{j}\\ge0}^{q_{1}+\\cdots+q_{r}=i}\\frac{i!}{q_{1}!\\cdot\\cdot\\cdot q_{r}!}\\beta_{1}^{q_{1}}\\cdot\\cdot\\cdot\\beta_{r}^{q_{r}}\\mathrm{He}_{q_{1}}(x_{1})\\cdot\\cdot\\cdot\\mathrm{He}_{q_{r}}(x_{r})\\right)\\frac{\\mathrm{He}_{p_{1}}(x_{1})}{\\sqrt{p_{1}!}}\\cdot\\cdot\\cdot\\frac{\\mathrm{He}_{p_{r}}(x_{r})}{\\sqrt{p_{r}!}}.\n$$", "text_format": "latex", "page_idx": 34}, {"type": "text", "text": "Also, from the discussion in Appendix A.3, x \u2202\u2202xss111 \u00b7 \u00b7 \u00b7 \u2202\u2202zsrsrr Hei(\u27e8x, \u03b2\u27e9)h(x) is equal to the coefficient of (C.4) with respect t os1!\u00b7\u00b71\u00b7sr!Hes1(x1) \u00b7 \u00b7 \u00b7 Hesr(xr). Therefore, E[\u2207k(Hei(\u27e8x, \u03b2\u27e9)h(x))] \u0338= $o$ if and only if $\\begin{array}{r l r l r}{i}&{{}+\\Tilde{P}}&{=}&{k}&{{}}\\end{array}$ . Then, $\\begin{array}{r l}{\\left\\|\\sum_{i=Q}^{P}\\frac{c_{i}}{i!}\\mathbb{E}\\big[\\nabla^{k}\\big(\\mathrm{He}_{i}(\\langle\\pmb{x},\\beta\\rangle)h(\\pmb{x})\\big)\\big]\\right\\|_{F}^{2}}&{{}=}\\end{array}$ $\\begin{array}{r}{\\left\\|\\frac{c_{k-\\tilde{P}}}{(k-\\tilde{P})!}\\mathbb{E}[\\nabla^{k}(\\mathrm{He}_{k-\\tilde{P}}(\\langle{\\pmb x},\\beta\\rangle)h({\\pmb x}))]\\right\\|_{F}^{2}.}\\end{array}$ ", "page_idx": 34}, {"type": "text", "text": "Here, we can observe that the $(j_{1},\\ldots,j_{k})$ -th entry of the tensor $\\frac{c_{k-\\tilde{P}}}{(k{-}\\tilde{P})!}\\mathbb{E}[\\nabla^{k}(\\mathrm{He}_{k-\\tilde{P}}(\\langle{\\pmb x},{\\beta}\\rangle)h({\\pmb x}))]$ is equal to ", "page_idx": 34}, {"type": "equation", "text": "$$\nc_{k-\\tilde{P}}\\frac{s_{1}!\\cdot\\cdot\\cdot s_{r}!}{(s_{1}-p_{1})!\\cdot\\cdot\\cdot(s_{r}-p_{r})!}\\cdot\\beta_{1}^{s_{1}-p_{1}}\\cdot\\cdot\\cdot\\beta_{r}^{s_{r}-p_{r}}\\frac{1}{\\sqrt{p_{1}!\\cdot\\cdot\\cdot\\cdot\\sqrt{p_{r}!}}}\\mathbb{I}_{s_{1}-p_{1}\\ge0,\\dots,s_{r}-p_{r}\\ge0}\n$$", "text_format": "latex", "page_idx": 34}, {"type": "text", "text": "where $\\begin{array}{r}{s_{i}=\\sum_{k^{\\prime}=1}^{k}\\mathbb{I}_{j_{k^{\\prime}}=i}\\left(i\\in\\left[r\\right]\\right)}\\end{array}$ . There are $\\frac{k!}{s_{1}!\\cdots s_{r}!}$ index sets $(j_{1},\\ldots,j_{k})$ having the same entry, and thus ", "page_idx": 34}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{~~\\left\\|\\frac{c_{k-\\tilde{P}}}{(k-\\tilde{P})!}\\mathbb{E}[\\nabla^{k}(\\mathrm{He}_{k-\\tilde{P}}(\\langle x,\\beta\\rangle)h(x))]\\right\\|_{F}^{2}}\\\\ &{=\\displaystyle\\sum_{s_{1}+\\cdots+s_{r}=k}c_{k-\\tilde{P}}^{2}\\frac{1}{p_{1}!\\cdots p_{r}!}\\frac{k!}{s_{1}!\\cdots s_{r}!}\\bigg(\\frac{s_{1}!\\cdot\\cdot\\cdot s_{r}!}{(s_{1}-p_{1})!\\cdot\\cdot\\cdot(s_{r}-p_{r})!}\\bigg)^{2}}\\end{array}\n$$", "text_format": "latex", "page_idx": 34}, {"type": "equation", "text": "$$\n\\begin{array}{r l r}&{}&{\\cdot\\left(\\beta_{1}^{s_{1}-p_{1}}\\cdots\\beta_{r}^{s_{r}-p_{r}}\\right)^{2}\\mathbb{I}_{s_{1}-p_{1}\\geq0,\\ldots,s_{r}-p_{r}\\geq0}}\\\\ &{=}&{\\sum_{q_{1}+\\cdots+q_{r}=k-\\bar{P},q_{2}\\geq0}c_{k-\\bar{P}}^{2}\\frac{1}{p_{1}!\\cdots p_{r}!}\\frac{k!}{(q_{1}+p_{1})!\\cdots(q_{r}+p_{r})!}\\Bigg(\\frac{(q_{1}+p_{1})!\\cdots(q_{r}+p_{r})!}{q_{1}!\\cdots q_{r}!}\\Bigg)^{2}}\\\\ &{}&{\\cdot\\left(\\beta_{1}^{q_{1}}\\cdots\\beta_{r}^{q_{r}}\\right)^{2}}\\\\ &{=}&{\\sum_{q_{1}+\\cdots+q_{r}=k-\\bar{P},q_{2}\\geq0}^{(\\bar{q_{1}}+\\bar{p})(\\cdots\\bar{p})!}\\frac{k!}{(k-\\bar{P})!}\\frac{(q_{1}+p_{1})!\\cdots(q_{r}+p_{r})!}{p_{1}!\\cdots p_{r}!q_{1}!\\cdots q_{r}!}\\Bigg)}\\\\ &{}&{\\cdot\\left(\\beta_{1}^{q_{1}}\\cdots\\beta_{r}^{q_{r}}\\right)^{2}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 35}, {"type": "text", "text": "We can verify that there exists a constant $\\bar{C}_{k}$ depending only on $P$ such that $\\begin{array}{r}{\\frac{k!}{(k-\\tilde{P})!}\\left(\\frac{(q_{1}+p_{1})!\\cdots(q_{r}+p_{r})!}{p_{1}!\\cdots p_{r}!q_{1}!\\cdots q_{r}!}\\right)\\leq\\bar{C}_{k}}\\end{array}$ holds uniformly; for example, one can naively obtain ", "page_idx": 35}, {"type": "equation", "text": "$$\n\\frac{k!}{(k-\\tilde{P})!}\\Bigg(\\frac{(q_{1}+p_{1})!\\cdots(q_{r}+p_{r})!}{p_{1}!\\cdots p_{r}!q_{1}!\\cdots q_{r}!}\\Bigg)\\leq k!(q_{1}+p_{1})!\\cdots(q_{r}+p_{r})!\\leq k!k^{k}.\n$$", "text_format": "latex", "page_idx": 35}, {"type": "text", "text": "Here we used $\\left(q_{1}+p_{1}\\right)+\\cdots+\\left(q_{r}+p_{r}\\right)=k.$ . ", "page_idx": 35}, {"type": "text", "text": "Moreover, $\\begin{array}{r}{\\sum_{q_{1}+\\cdots+q_{r}=k-\\tilde{P},q_{i}\\geq0}\\frac{(k-\\tilde{P})!}{q_{1}!\\cdots q_{r}!}(\\beta_{1}^{q_{1}}\\cdot\\cdot\\cdot\\beta_{r}^{q_{r}})^{2}\\,=\\,\\|\\beta^{\\otimes k-\\tilde{P}}\\|_{F}^{2}\\,=\\,1}\\end{array}$ holds. Hence (C.5) is upper bounded by $c_{k-\\tilde{P}}^{2}\\bar{C}_{k}\\leq R_{c}^{2}\\bar{C}_{k}$ . ", "page_idx": 35}, {"type": "text", "text": "Corollary 44. With high probability, ", "page_idx": 35}, {"type": "equation", "text": "$$\n\\left|\\frac{1}{N_{2}}\\sum_{j=1}^{N_{2}}y_{j}h(x_{j})-\\mathbb{E}_{x}[\\sigma_{*}(\\langle x,\\beta\\rangle)h(x)]\\right|=\\tilde{O}\\bigg(\\frac{1}{\\sqrt{N_{2}}}\\bigg)\n$$", "text_format": "latex", "page_idx": 35}, {"type": "text", "text": "holds. ", "page_idx": 35}, {"type": "text", "text": "Proof. Plugging the results above and $\\begin{array}{r}{t=\\Theta(\\frac{1}{\\sqrt{N_{2}}}(\\log d)^{P})}\\end{array}$ into Lemma 42 yields ", "page_idx": 35}, {"type": "equation", "text": "$$\n\\left|\\frac{1}{N_{2}}\\sum_{j=1}^{N_{2}}\\sigma_{*}(\\langle x_{j},\\beta\\rangle)h(x_{j})-\\mathbb{E}_{x}[\\sigma_{*}(\\langle x,\\beta\\rangle)h(x)]\\right|\\lesssim\\frac{1}{\\sqrt{N_{2}}}(\\log d)^{P}\n$$", "text_format": "latex", "page_idx": 35}, {"type": "text", "text": "with high probability. Moreover, we can easily verify $\\begin{array}{r l r}{\\left|\\frac{1}{N_{2}}\\sum_{j=1}^{N_{2}}\\varsigma_{j}h({\\pmb x}_{j})\\right|\\!\\!}&{{}=}&{\\!\\!\\tilde{O}\\!\\left(\\frac{1}{\\sqrt{N_{2}}}\\right)}\\end{array}$ by the method used in the proof of Lemma 26. \u53e3 ", "page_idx": 35}, {"type": "text", "text": "C.3 Proof of Proposition 2 ", "text_level": 1, "page_idx": 35}, {"type": "text", "text": "We prove the following Proposition 2 using the preparations above. ", "page_idx": 35}, {"type": "text", "text": "Proposition 2. Let $\\pmb{X}^{t}=(\\pmb{x}_{1}^{t},\\dots,\\pmb{x}_{N_{2}}^{t})$ and $\\pmb{y}^{t}=(y_{1}^{t},\\dots,y_{N_{2}}^{t})^{\\top}$ where $T_{1}+1\\leq t\\leq T_{1}+T_{2}$ . With high probability over the data distribution and random initialization of the parameters, there exists $\\bar{\\Gamma}$ such that ", "page_idx": 35}, {"type": "equation", "text": "$$\n\\left|f(X^{t},y^{t},x^{t};W^{(1)},\\bar{\\Gamma},b)-y^{t}\\right|-\\tau=\\tilde{O}\\left(\\sqrt{\\frac{r^{3P}}{m}+\\frac{r^{2P}}{N_{2}}}\\right)\n$$", "text_format": "latex", "page_idx": 35}, {"type": "text", "text": "holds for all $t\\,\\in\\,\\{T_{1}\\,+1,\\dots,T_{2}\\}$ , where $W^{(1)}$ is obtained by line $^{4}$ of Algorithm $^{\\,l}$ and $^{b}$ is re-initialized in Line $^{5}$ of Algorithm $^{\\,l}$ , where the conditions on $\\eta_{1},\\lambda_{1},m,\\gamma,N_{1},T_{1}$ are identical to that in Theorem 1. Moreover, $\\|\\bar{\\mathbf{T}}\\|_{F}=\\tilde{O}\\big(r^{2P}/m\\big)$ is satisfied. ", "page_idx": 35}, {"type": "text", "text": "Proof. It suffices to show the proposition for each $T_{1}+1\\le t\\le T_{1}+T_{2}$ , and then take the union bound. We drop the superscript $t$ for simplicity. ", "page_idx": 35}, {"type": "text", "text": "Note that, from Lemma 8 and $\\mathbb{E}_{\\mathbf{x}}[h(\\mathbf{x})h^{\\prime}(\\mathbf{x})]\\,=\\,\\mathbb{I}_{h=h^{\\prime}}$ for $h,h^{\\prime}\\,\\in\\,\\mathcal{H}$ , we can expand $f_{*}(x)$ as $\\begin{array}{r}{f_{*}(\\pmb{x})=\\sum_{n=1}^{B_{P}}\\mathbb{E}_{\\pmb{x}\\sim\\mathcal{N}(0,I_{d})}[f_{*}(\\pmb{x})\\dot{h_{n}}(\\pmb{x})]h_{n}(\\pmb{x})}\\end{array}$ . Now let $\\pmb{A}=\\left[\\pmb{a}^{1}\\quad\\cdot\\cdot\\cdot\\quad\\pmb{a}^{B_{P}}\\right]\\in\\mathbb{R}^{m\\times B_{P}}$ , where ", "page_idx": 35}, {"type": "text", "text": "$\\{\\pmb{a}^{n}\\}_{n=1}^{B_{P}}$ is constructed in Proposition 33. Then, by setting $\\bar{\\mathbf{T}}=A A^{\\top}$ , ", "page_idx": 36}, {"type": "equation", "text": "$$\n\\begin{array}{l}{{\\displaystyle\\left<{\\frac{A A^{\\top}\\sigma(W^{(1)}X+b_{1}^{\\top})}{N_{2}}}y_{,\\left[\\sigma(W_{1}^{(1)^{\\top}}x+b_{1})\\right]}\\right>-y}\\ ~}\\\\ {{\\displaystyle=\\sum_{n=1}^{B{\\nu}}\\left(h_{n}(x)+\\epsilon_{n}(x)\\right)\\left(\\mathbb{E}[f_{n}h_{n}]+\\left(\\frac{1}{N_{2}}\\sum_{j=1}^{N_{2}}y_{j}h_{n}(x_{j})-\\mathbb{E}[f_{n}h_{n}]\\right)+\\frac{1}{N_{2}}\\sum_{j=1}^{N_{2}}y_{j}\\epsilon_{n}(x_{j})\\right)}}\\\\ {{\\displaystyle=\\sum_{n=1}^{B{\\nu}}\\left(h_{n}(x)+\\epsilon_{n}(x)\\right)\\left(\\mathbb{E}[f_{n}h_{n}]+\\left(\\frac{1}{N_{2}}\\sum_{j=1}^{N_{2}}y_{j}h_{n}(x_{j})-\\mathbb{E}[f_{n}h_{n}]\\right)+\\frac{1}{N_{2}}\\sum_{j=1}^{N_{2}}y_{j}\\epsilon_{n}(x_{j})\\right)}}\\\\ {{\\displaystyle=\\sum_{n=1}^{B{\\nu}}\\left(h_{n}(x)+\\epsilon_{n}(x)\\right)\\left(\\mathbb{E}[f_{n}h_{n}]+\\left(\\frac{1}{N_{2}}\\sum_{j=1}^{N_{2}}y_{j}h_{n}(x_{j})-\\mathbb{E}[f_{n}h_{n}]\\right)+\\frac{1}{N_{2}}\\sum_{j=1}^{N_{2}}y_{j}\\epsilon_{n}(x_{j})\\right)}}\\\\ {{\\displaystyle~~~~-\\sum_{n=1}^{B{\\nu}}h_{n}(x)\\mathbb{E}[f_{n}h_{n}]-<}\\end{array}\n$$", "text_format": "latex", "page_idx": 36}, {"type": "text", "text": "holds, wher $\\begin{array}{r}{\\mathtt{s}\\left.\\epsilon_{n}(\\pmb{x}):=\\sum_{j=1}^{m}\\pmb{a}_{j}^{n}\\sigma(\\pmb{w}_{j}^{(1)^{\\top}}\\pmb{x}+b_{j})-h_{n}(\\pmb{x})\\mathrm{~satisfits~}|\\epsilon_{n}(\\pmb{x})|=\\tilde{O}\\Big(\\sqrt{r^{P}/m+1/N_{2}}\\Big)\\right.}\\end{array}$ from Proposition 33. ", "page_idx": 36}, {"type": "text", "text": "To bound the error, we note that the following holds for each $n$ : ", "page_idx": 36}, {"type": "text", "text": "\u2022 As $h_{n}(x)$ is a polynomial whose degree is at most $P$ , and $\\mathbb{E}_{\\mathbf{x}}[\\nabla^{k}h_{n}(\\mathbf{x})]\\,=\\,O(1),\\,|h_{n}(\\mathbf{x})|\\,\\leq$ $(\\log d)^{P/2}$ holds with high probability from Lemma 15.   \n\u2022 From lemma 8, $|\\mathbb{E}[f_{*}(\\pmb{x})h_{n}(\\pmb{x})]|=O(1)$ holds.   \n\u2022 From Corollary 17, $|y_{j}|\\lesssim(\\log d)^{P/2}$ holds with high probability. ", "page_idx": 36}, {"type": "text", "text": "Hence, for each $n\\in[B_{P}]$ , we obtain ", "page_idx": 36}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\left|\\left(\\displaystyle\\sum_{\\widehat{\\partial}(1)}\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\! \n$$", "text_format": "latex", "page_idx": 36}, {"type": "text", "text": "Combining this with $\\boldsymbol{B}_{P}=\\Theta(r^{P})$ and $m=\\tilde{\\Omega}(r^{P})$ , we arrive at the upper bound. ", "page_idx": 36}, {"type": "text", "text": "Finally for $\\|{\\bar{\\mathbf{T}}}\\|_{F}$ , we have ", "page_idx": 36}, {"type": "equation", "text": "$$\n\\|\\bar{\\boldsymbol{\\Gamma}}\\|_{F}\\leq\\sum_{n=1}^{B_{P}}\\|\\boldsymbol{a}^{n}(\\boldsymbol{a}^{n})^{\\top}\\|_{F}=\\sum_{n=1}^{B_{P}}\\|\\boldsymbol{a}^{n}\\|^{2}=\\tilde{O}\\big(r^{2P}/m\\big).\n$$", "text_format": "latex", "page_idx": 36}, {"type": "text", "text": "D Generalization Error Analysis and Proof of Theorem 1 ", "text_level": 1, "page_idx": 36}, {"type": "text", "text": "Note that after one-step gradient descent, $\\lVert\\pmb{w}_{j}^{(1)}\\rVert=\\tilde{O}_{d,r}(1)$ is ensured with high probability from Lemma 18 and Corollary 32. ", "page_idx": 36}, {"type": "text", "text": "D.1 Rademacher Complexity Bound ", "text_level": 1, "page_idx": 37}, {"type": "text", "text": "Let $W=W^{(1)}$ and suppose $b_{1},\\ldots,b_{m}$ are biases obtained in line 5 of Algorithm 1. Let ", "page_idx": 37}, {"type": "equation", "text": "$$\n\\mathcal{F}_{N,G}=\\left\\{(X,y,x)\\mapsto\\left\\langle\\frac{\\mathbf{I}\\sigma(W^{(1)}X+b\\mathbf{1}_{N}^{\\top})y}{N},\\left[\\begin{array}{c}{\\sigma((w_{1}^{(1)})^{\\top}x+b_{1})}\\\\ {\\vdots}\\\\ {\\sigma((w_{m}^{(1)})^{\\top}x+b_{m})}\\end{array}\\right]\\right\\rangle\\middle|\\Vert\\mathbf{T}\\Vert_{F}\\leq G\\right\\}\n$$", "text_format": "latex", "page_idx": 37}, {"type": "text", "text": "be the set of transformers where the norm of the attention matrix is constrained, and let ", "page_idx": 37}, {"type": "equation", "text": "$$\n\\operatorname{Rad}_{T}(\\mathcal{F}_{N,G})=\\mathbb{E}_{\\{X^{t}\\},\\{y^{t}\\},\\{x^{t}\\},\\{\\epsilon^{t}\\}}\\Bigg[\\operatorname*{sup}_{f\\in\\mathcal{F}_{N,G}}\\frac{1}{T}\\sum_{t=1}^{T}\\epsilon^{t}f\\big(X^{t},y^{t},x^{t}\\big)\\Bigg]\n$$", "text_format": "latex", "page_idx": 37}, {"type": "text", "text": "be its Rademacher complexity, where $\\epsilon^{t}\\sim\\mathrm{Unif}(\\{\\pm1\\})$ . Here contexts $\\boldsymbol{X}\\in\\mathbb{R}^{d\\times N}$ and $\\pmb{y}\\in\\mathbb{R}^{N}$ are of length $N$ . We can evaluate the Rademacher complexity as follows. ", "page_idx": 37}, {"type": "text", "text": "Proposition 45. ", "page_idx": 37}, {"type": "equation", "text": "$$\n\\mathrm{Rad}_{T}({\\mathcal F}_{N,G})=\\tilde{O}_{d,r}\\left({\\frac{G m}{\\sqrt{T}}}\\right)\n$$", "text_format": "latex", "page_idx": 37}, {"type": "text", "text": "holds, when $|b_{j}|=\\tilde{O}_{d,r}(1)$ and $\\lVert\\pmb{w}_{j}^{(1)}\\rVert=\\tilde{O}_{d,r}(1)$ for all $j\\in[m]$ . ", "page_idx": 37}, {"type": "text", "text": "Proof. First, it holds that ", "text_level": 1, "page_idx": 37}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{E}\\{\\left|\\sum_{j\\in\\mathcal{N}(\\cdot)}z_{j\\in\\mathcal{N}_{j}}\\right|}\\\\ &{=\\mathbb{E}\\left\\{\\underset{0\\leq t\\leq0}{\\leq}\\frac{1}{w_{1}(1)},|\\alpha_{1}|,\\left\\{\\sum_{j\\in\\mathcal{N}_{\\delta}}\\sum_{i=1}^{t}f_{i}(X_{j}^{\\varepsilon},q_{i}^{\\varepsilon})\\right\\}}\\\\ &{=\\mathbb{E}\\left[\\underset{0\\leq t\\leq0}{\\leq}\\frac{1}{w_{1}^{2}}\\int_{\\mathbb{R}^{d}}^{\\varepsilon}\\Bigg\\langle\\frac{\\Gamma_{0}(W^{\\varepsilon}(1)X^{\\varepsilon}+\\mathbb{H}_{\\delta}^{-1})\\log^{\\varepsilon}\\Bigg[\\rho(w_{1}^{(\\varepsilon)})^{\\varepsilon}x^{\\varepsilon}+h_{\\delta}^{-1}\\Bigg]\\right\\}\\Bigg]}\\\\ &{\\overset{(a)}{\\leq}\\mathbb{E}\\left[\\frac{1}{\\underset{0\\leq t\\leq0}{\\leq}\\Gamma_{f}(W_{\\varepsilon}^{\\varepsilon})(1)}\\left\\{\\sum_{i=1}^{\\varepsilon}\\frac{\\rho(W^{\\varepsilon}(1)X^{\\varepsilon}+\\mathbb{H}_{\\delta}^{-1})\\log^{\\varepsilon}\\Bigg[\\rho(w_{1}^{(\\varepsilon)})^{\\varepsilon}x^{\\varepsilon}+h_{\\delta}^{-1}\\Bigg]\\right\\}^{2}\\Bigg]}\\\\ &{=\\frac{\\varepsilon}{T}\\mathbb{E}\\Bigg[\\Bigg\\|\\sum_{i=1}^{\\varepsilon}\\frac{\\rho(W^{\\varepsilon}(1)X^{\\varepsilon}+\\mathbb{H}_{\\delta}^{-1})\\log^{\\varepsilon}\\Bigg[\\rho(w_{1}^{(\\varepsilon)})^{\\varepsilon}x^{\\varepsilon}+h_{\\delta}^{-1}\\Bigg]\\Bigg\\}^{2}\\Bigg]}\\\\ &{\\leq\\frac{\\varepsilon}{T}\\left[\\mathbb{E}\\Bigg[\\Bigg\\|\\sum_{i=1}^{\\varepsilon}\\frac{\\rho(W^{\\varepsilon}(1)X^{\\varepsilon}+\\mathbb{H}_{\\delta}^{-1})\\log^{\\varepsilon}\\Bigg[\\rho(w_{1}^{(\\varepsilon)})^{\\varepsilon}x^{\\varepsilon}+h_{\\delta}\\Bigg]}{\\hat{N}}\\Bigg]\\Bigg\\|_{r}^{2}\\Bigg]}\\end{array}\n$$$$\n\\begin{array}{r l}&{\\frac{\\langle\\overline{{S}}_{i}^{\\nu}\\overline{{S}}_{j}^{\\nu}\\overline{{S}}_{i}^{\\nu}|\\overline{{Y}}_{j}\\rangle\\times\\frac{\\langle\\sigma_{i}^{\\nu}\\overline{{S}}_{i}^{\\nu}\\overline{{S}}_{j}^{\\nu}|\\overline{{Y}}_{i}\\rangle}{{\\cal N}}\\left[\\frac{\\langle\\overline{{S}}_{i}^{\\nu}\\overline{{S}}_{j}^{\\nu}\\overline{{S}}_{i}^{\\nu}|\\overline{{Y}}_{j}\\rangle}{{\\cal N}}\\right]\\times\\frac{\\langle\\overline{{S}}_{i}^{\\nu}\\overline{{S}}_{j}^{\\nu}\\overline{{S}}_{i}^{\\nu}|\\overline{{Y}}_{j}\\rangle}{{\\cal N}}\\left[\\langle\\sigma_{i}^{\\nu}\\overline{{S}}_{j}^{\\nu}\\overline{{S}}_{i}^{\\nu}\\rangle+\\right.}\\\\ &{\\left.-\\frac{\\langle\\overline{{S}}_{i}^{\\nu}\\overline{{S}}_{j}^{\\nu}\\overline{{S}}_{i}^{\\nu}\\overline{{S}}_{j}^{\\nu}\\overline{{S}}_{i}^{\\nu}\\overline{{S}}_{j}^{\\nu}\\overline{{S}}_{i}^{\\nu}\\overline{{S}}_{j}^{\\nu}\\overline{{S}}_{i}^{\\nu}\\overline{{S}}_{j}^{\\nu}\\overline{{S}}_{i}^{\\nu}\\overline{{S}}_{j}^{\\nu}\\overline{{S}}_{i}^{\\nu}\\overline{{S}}_{j}^{\\nu}\\right]\\Bigg]\\Bigg[\\frac{\\sqrt{\\lambda}}{\\sqrt{\\lambda}}}\\\\ &{\\leq\\frac{G}{\\sqrt{\\kappa}}\\left[\\frac{\\sqrt{\\lambda}}{\\sqrt{\\kappa}}\\frac{\\rho_{i}^{\\nu}\\overline{{S}}_{i}^{\\nu}\\overline{{S}}_{j}^{\\nu}\\overline{{S}}_{i}^{\\nu}\\overline{{S}}_{j}^{\\nu}\\overline{{S}}_{i}^{\\nu}\\overline{{S}}_{j}^{\\nu}\\overline{{S}}_{i}^{\\nu}\\overline{{S}}_{j}^{\\nu}\\overline{{S}}_{i}^{\\nu}\\overline{{S}}_{j}^{\\nu}\\overline{{S}}_{i}^{\\nu}\\overline{{S}}_{j}^{\\nu}\\overline{{S}}_{i}^{\\nu}\\\n$$", "text_format": "latex", "page_idx": 37}, {"type": "equation", "text": "", "text_format": "latex", "page_idx": 37}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\overset{(c)}{\\leq}\\frac{G}{\\sqrt{T}}\\sqrt{\\displaystyle\\sum_{k,l=1}^{m}\\mathbb{E}_{\\mathbf{x}\\sim\\mathcal{N}(0,I_{d}),\\mathbf{x}^{\\prime}\\sim\\mathcal{N}(0,I_{d}),f_{*},\\mathfrak{c}}\\Big[\\big(f_{*}(\\mathbf{x})+\\varsigma)^{2}\\sigma\\big((w_{k}^{(1)})^{\\top}\\mathbf{x}+b_{k}\\big)^{2}\\sigma\\big((w_{l}^{(1)})^{\\top}\\mathbf{x}^{\\prime}+b_{l}\\big)^{2}\\Big]}}\\\\ &{\\overset{(d)}{\\leq}\\frac{G}{\\sqrt{T}}\\sqrt{\\displaystyle\\sum_{k,l=1}^{m}\\mathbb{E}_{\\mathbf{x},f_{*},\\mathfrak{c}}\\Big[\\big(2f_{*}(\\mathbf{x})^{2}+2\\varsigma^{2}\\big)\\big(2((w_{k}^{(1)})^{\\top}\\mathbf{x})^{2}+2b_{k}^{2}\\big)\\Big]\\mathbb{E}_{\\mathbf{x}^{\\prime}}\\Big[\\big(2((w_{l}^{(1)})^{\\top}\\mathbf{x}^{\\prime})^{2}+2b_{l}^{2}\\big)\\Big]},}\\end{array}\n$$", "text_format": "latex", "page_idx": 38}, {"type": "text", "text": "where the annotated equality/inequalities are obtained by (a) Cauchy\u2013Schwarz inequality, (b) $\\begin{array}{r}{{\\mathbb E}_{\\epsilon_{t}\\sim\\mathrm{Unif}\\left\\{\\pm1\\right\\}}[\\|\\sum_{t}\\epsilon_{t}\\pmb{A}_{t}^{\\prime}\\|_{F}^{2}]\\stackrel{}{=}\\sum_{t}^{}\\|\\pmb{A}_{t}\\|_{F}^{2}}\\end{array}$ , (c) convexity of $f(z)\\;=\\;{\\dot{z}}^{2}$ , and $(\\mathrm{d})(\\sigma(\\stackrel{\\cdot}{\\alpha}+\\stackrel{\\cdot}{\\beta)})^{2}\\,\\stackrel{\\cdot}{\\leq}$ $(\\alpha+\\beta)^{2}\\le2\\alpha^{2}+2\\beta^{2}$ . ", "page_idx": 38}, {"type": "text", "text": "Let us further evaluate the last line: from the assumption and Lemma 7, we know that $\\|w_{k}\\|,\\|b_{k}\\|$ and $\\mathbb{E}[f_{*}(x)^{2}]$ are all $\\tilde{O}(1)$ : in particular, we can easily obtain that $E_{\\pmb{x}\\sim\\mathcal{N}(0,\\pmb{I}_{d})}\\left[((\\pmb{w}_{k}^{(1)})^{\\top}\\pmb{x})^{2}\\right]=\\tilde{O}_{d,r}(1)$ . Consequently, the last line is $\\begin{array}{r}{\\frac{G}{\\sqrt{T}}\\sqrt{\\sum_{k,l=1}^{m}\\mathbb{E}_{\\pmb{x}\\sim\\mathcal{N}(0,I_{d}),f_{\\ast}}\\Big[\\big(2f_{\\ast}(\\pmb{x})^{2}\\big)\\big(2\\big((\\pmb{w}_{k}^{(1)})^{\\top}\\pmb{x}\\big)^{2}\\big)\\Big]+\\tilde{O}_{d,r}(1)},}\\end{array}$ and remains to evaluate $\\mathbb{E}_{\\pmb{x}\\sim\\mathcal{N}(0,\\pmb{I}_{d}),f_{\\ast}}\\left[f_{\\ast}(\\pmb{x})^{2}((\\pmb{w}_{k}^{(1)})^{\\top}\\pmb{x})^{2}\\right]$ . On this term, we obtain ", "page_idx": 38}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{E}_{\\mathbf{x},f_{*}}\\Big[f_{*}(x)^{2}((w_{k}^{(1)})^{\\top}x)^{2}\\Big]\\leq\\mathbb{E}_{\\mathbf{x},f_{*}}\\big[f_{*}(x)^{4}\\big]^{1/2}\\mathbb{E}_{\\mathbf{x}}\\Big[((w_{k}^{(1)})^{\\top}x)^{4}\\Big]^{1/2}}\\\\ &{\\qquad\\qquad\\qquad\\qquad\\qquad=\\tilde{O}(1)\\left(\\cdot\\cdot\\mathrm{~Lemma~}7\\right).}\\end{array}\n$$", "text_format": "latex", "page_idx": 38}, {"type": "text", "text": "Hence we can conclude $\\begin{array}{r}{\\mathrm{Rad}_{T}(\\mathcal{F}_{N,G})=O\\Big(\\frac{G m}{\\sqrt{T}}\\Big)}\\end{array}$ . ", "page_idx": 38}, {"type": "text", "text": "Corollary 46. Let ", "text_level": 1, "page_idx": 38}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\tilde{\\mathcal{F}}_{N,G}=\\bigg\\{({\\pmb X},{\\pmb y},{\\pmb x},{\\pmb y})\\mapsto\\bigg\\langle\\frac{{\\pmb\\Gamma}\\sigma({\\pmb W}^{(1)}{\\pmb X}+{\\pmb b}\\mathbf{1}_{N}^{\\top}){\\pmb y}}{N},\\left[\\begin{array}{l}{\\sigma((\\pmb w_{1}^{(1)})^{\\top}{\\pmb x}+b_{1})}\\\\ {\\vdots}\\\\ {\\sigma((\\pmb w_{m}^{(1)})^{\\top}{\\pmb x}+b_{m})}\\end{array}\\right]\\bigg\\rangle\\bigg|\\|{\\pmb\\Gamma}\\|_{F}\\leq G\\bigg\\}}\\\\ &{\\qquad\\cup\\,\\bigg\\{({\\pmb X},{\\pmb y},{\\pmb x},{\\pmb y})\\mapsto{\\pmb y}\\bigg\\}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 38}, {"type": "text", "text": "Then, $\\begin{array}{r}{\\mathrm{Rad}_{T}(\\tilde{\\mathcal{F}}_{N,G})\\;=\\;\\tilde{O}_{d,r}\\Big(\\frac{G m}{\\sqrt{T}}\\Big)}\\end{array}$ holds when $|b_{j}|\\;=\\;\\tilde{O}_{d,r}(1)$ and $\\lVert\\pmb{w}_{j}^{(1)}\\rVert\\;=\\;\\tilde{O}_{d,r}(1)$ for all $j\\in[m]$ . ", "page_idx": 38}, {"type": "text", "text": "Proof. Note that ", "text_level": 1, "page_idx": 38}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{E}_{\\{X^{t}\\},\\{y^{t}\\},\\{x^{t}\\},\\{\\epsilon^{t}\\},\\{\\epsilon^{t}\\}}\\left[\\underset{f\\in\\tilde{\\mathcal{F}}_{N,G}}{\\operatorname*{sup}}\\frac{1}{T}\\sum_{t=1}^{T}\\epsilon^{t}f(X^{t},y^{t},x^{t},y^{t})\\right]}\\\\ &{\\le\\!\\mathbb{E}_{\\{X^{t}\\},\\{y^{t}\\},\\{x^{t}\\},\\{\\epsilon^{t}\\}}\\!\\left[\\underset{f\\in\\tilde{\\mathcal{F}}_{N,G}}{\\operatorname*{sup}}\\frac{1}{T}\\sum_{t=1}^{T}\\epsilon^{t}f(X^{t},y^{t},x^{t})\\right]+\\mathbb{E}_{\\{y^{t}\\},\\{\\epsilon^{t}\\}}\\!\\left[\\bigg|\\frac{1}{T}\\sum_{t=1}^{T}\\epsilon^{t}y^{t}\\!\\bigg|\\right]\\!.}\\end{array}\n$$", "text_format": "latex", "page_idx": 38}, {"type": "text", "text": "This follows from $\\begin{array}{r}{\\operatorname*{sup}_{f\\in\\mathcal{F}_{N,G}}\\frac{1}{T}\\sum_{t=1}^{T}\\epsilon^{t}f\\big(X^{t},\\pmb{y}^{t},\\pmb{x}^{t}\\big)\\geq0}\\end{array}$ , as $\\mathcal{F}_{N,G}$ contains zero function corresponding to $\\ensuremath{\\mathbf{\\Gamma}}_{\\ensuremath{\\mathbf{\\Gamma}}}=O$ . The second term in the last line can be bounded as ", "page_idx": 38}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{E}_{\\{y^{t}\\},\\{\\epsilon^{t}\\}}\\left[\\left|\\displaystyle\\frac{1}{T}\\sum_{t=1}^{T}\\epsilon^{t}y^{t}\\right|\\right]\\leq\\sqrt{\\mathbb{E}_{\\{y^{t}\\},\\{\\epsilon^{t}\\}}\\left[\\left(\\displaystyle\\frac{1}{T}\\sum_{t=1}^{T}\\epsilon^{t}y^{t}\\right)^{2}\\right]}}\\\\ &{\\qquad\\qquad\\qquad\\qquad=\\displaystyle\\frac{1}{\\sqrt{T}}\\mathbb{E}[(y^{t})^{2}]=O\\bigg(\\frac{1}{\\sqrt{T}}\\bigg)}\\end{array}\n$$", "text_format": "latex", "page_idx": 38}, {"type": "text", "text": "by Lemma 7. ", "page_idx": 38}, {"type": "text", "text": "D.2 Prompt Length-free Generalization Bound ", "text_level": 1, "page_idx": 39}, {"type": "text", "text": "The ICL risk for prompt length $N$ was defined as ", "page_idx": 39}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\mathcal{R}_{N}(f)=\\mathbb{E}_{X,y,x,y}[|f(X_{1:N},y_{1:N},x;W,\\Gamma,b)-y|],}\\end{array}\n$$", "text_format": "latex", "page_idx": 39}, {"type": "text", "text": "where the length of $X_{1:N}$ and $\\pmb{y}_{1:N}$ is fixed to $N$ . In this section, we show that the ICL risk \u201cconverges\u201d when the context length is sufficiently large. ", "page_idx": 39}, {"type": "text", "text": "Proposition 47. Assume that $\\|\\pmb{w}_{j}\\|=\\tilde{O}_{d,r}(1)$ and $|b_{j}|=\\tilde{O}_{d,r}(1)$ for each $j\\in[m]$ . Then, ", "page_idx": 39}, {"type": "equation", "text": "$$\n\\lvert\\mathcal{R}_{N}(f)-\\mathcal{R}_{M}(f)\\rvert=\\tilde{O}\\Big(\\lvert\\lvert\\Gamma\\rvert\\rvert_{F}m\\sqrt{1/N+1/M}\\Big)\n$$", "text_format": "latex", "page_idx": 39}, {"type": "text", "text": "holds. ", "page_idx": 39}, {"type": "text", "text": "Proof. Note that ", "text_level": 1, "page_idx": 39}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\quad|\\mathbb{R}_{N}(f)-\\mathcal{R}_{M}(f)|}\\\\ &{\\le\\mathbb{E}\\|f({\\\\\\mathbf{X}}_{1:\\mathcal{N}_{1},\\mathcal{N}_{1},\\mathcal{N}_{1}},T,b)-f({\\mathbf{X}}_{1:M},y_{1:M},x;W,{\\mathbf{F}},b)\\|}\\\\ &{=\\mathbb{E}\\left[\\left|\\left\\langle\\mathbf{r}\\left(\\frac{\\sigma({\\mathbf{W}}\\mathbf{X}_{1:\\mathcal{N}_{1}}+b\\mathbf{\\hat{I}}_{N}^{T})\\mathbf{y}_{1:\\mathcal{N}_{1}}}{\\boldsymbol{\\Lambda}}-\\frac{\\sigma({\\mathbf{W}}\\mathbf{X}_{1:M}+b\\mathbf{\\hat{I}}_{N}^{T})\\mathbf{y}_{1:\\mathcal{N}_{1}}}{\\boldsymbol{\\Lambda}}\\right),\\left[\\frac{\\sigma({\\mathbf{w}}_{1}^{\\top}\\mathbf{x}+b_{1})}{\\boldsymbol{\\Lambda}}\\right]\\right\\rangle\\right|\\right]}\\\\ &{\\overset{(a)}{\\le}\\left\\|\\mathbf{r}\\|e^{\\mathbb{E}}\\left[\\left\\|\\left(\\frac{\\sigma({\\mathbf{W}}\\mathbf{X}_{1:N}+b\\mathbf{\\hat{I}}_{N}^{T})\\mathbf{y}_{1:\\mathcal{N}_{1}}}{\\boldsymbol{\\Lambda}}-\\frac{\\sigma({\\mathbf{W}}\\mathbf{X}_{1:M}+b\\mathbf{\\hat{I}}_{N}^{T})\\mathbf{y}_{1:\\mathcal{N}_{1}}}{\\boldsymbol{M}}\\right)\\right\\|\\right]\\left[\\sigma({\\mathbf{w}}_{1:\\mathcal{N}_{1}}^{\\top}+b_{1})\\right]\\right\\|}\\\\ &{\\le\\mathbb{E}\\|{\\mathbf{r}}\\|e^{\\mathbb{E}}\\left[\\left\\|\\left(\\frac{\\sigma({\\mathbf{W}}\\mathbf{X}_{1:N}+b\\mathbf{\\hat{I}}_{N}^{T})\\mathbf{y}_{1:\\mathcal{N}_{1}}}{\\boldsymbol{\\Lambda}}-\\frac{\\sigma({\\mathbf{W}}\\mathbf{X}_{1:M}+b\\mathbf{\\hat{I}}_{N}^{T})\\mathbf{y}_{1:\\mathcal{N}_{1}}}{\\boldsymbol{M}}\\right)\\right\\|^{2}\\right]^{1/2}}\\\\ &{\\qquad\\cdot\\mathbb{E}\\left[\\left\\|\\left[\\frac{\\sigma({\\mathbf{w}}_{1:\\mathcal{N}_{1}}^{\\top}+b_{1})}{\\boldsymbol{\\Lambda \n$$", "text_format": "latex", "page_idx": 39}, {"type": "text", "text": "where (a) holds because $\\pmb{a}^{\\top}\\pmb{\\Gamma}\\pmb{b}=\\pmb{\\Gamma}\\circ(\\pmb{a}\\pmb{b}^{\\top})\\leq\\|\\pmb{\\Gamma}\\|_{F}\\|\\pmb{a}\\pmb{b}^{\\top}\\|_{F}=\\|\\pmb{\\Gamma}\\|_{F}\\|\\pmb{a}\\|\\|\\pmb{b}\\|.$ ", "page_idx": 39}, {"type": "text", "text": "$\\begin{array}{r l}&{\\mathrm{Let}\\quad\\operatorname*{us}\\quad\\mathrm{bound}\\quad\\mathbb{E}\\Bigg[\\Bigg\\|\\bigg(\\frac{\\sigma(W X_{1:N}+b\\mathbf{1}_{N}^{\\top})y_{1:N}}{N}-\\frac{\\sigma(W X_{1:M}+b\\mathbf{1}_{M}^{\\top})y_{1:M}}{M}\\bigg)\\bigg\\|^{2}\\Bigg],\\quad\\mathrm{~which~}}\\\\ &{\\sum_{j=1}^{m}\\mathbb{E}_{f_{*}}\\Bigg[\\mathbb{E}_{X,y}\\Bigg[\\bigg(\\frac{1}{N}\\sum_{i=1}^{N}\\sigma\\big(w_{j}^{\\top}x_{i}+b_{j}\\big)y_{i}-\\frac{1}{M}\\sum_{i=1}^{M}\\sigma\\big(w_{j}^{\\top}x_{i}+b_{j}\\big)y_{i}\\bigg)^{2}\\Bigg]\\Bigg].\\quad\\mathrm{~For~}\\ ,}\\end{array}$ is to simplicity, we drop the subscript $j$ and obtain ", "page_idx": 39}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\quad\\mathbb{E}_{X,\\eta}\\Bigg[\\Bigg(\\frac{1}{N}\\displaystyle\\sum_{i=1}^{N}\\sigma(\\mathbf{w^{T}}x_{i}+b)y_{i}-\\frac{1}{M}\\displaystyle\\sum_{i=1}^{M}\\sigma(\\mathbf{w^{T}}x_{i}+b)y_{i}\\Bigg)^{2}\\Bigg]}\\\\ &{\\le2\\mathbb{E}\\Bigg[\\Bigg(\\frac{1}{N}\\displaystyle\\sum_{i=1}^{N}\\sigma(\\mathbf{w^{T}}x_{i}+b)y_{i}-\\mathbb{E}\\big[\\sigma(\\mathbf{w^{T}}x+b)y\\big]\\Bigg)^{2}\\Bigg]}\\\\ &{+2\\mathbb{E}\\Bigg[\\Bigg(\\frac{1}{M}\\displaystyle\\sum_{i=1}^{M}\\sigma(\\mathbf{w^{T}}x_{i}+b)y_{i}-\\mathbb{E}\\big[\\sigma(\\mathbf{w^{T}}x+b)y\\big]\\Bigg)^{2}\\Bigg]}\\\\ &{=\\frac{2}{N}\\mathbb{V}\\big[\\big(\\sigma(\\mathbf{w^{T}}x+b)y\\big)\\big]+\\frac{2}{M}\\mathbb{V}\\big[\\big(\\sigma(\\mathbf{w^{T}}x+b)y\\big)\\big]}\\\\ &{\\le\\Big(\\frac{2}{N}+\\frac{2}{M}\\Big)\\mathbb{E}\\big[\\sigma(\\mathbf{w^{T}}x+b)^{2}(f_{+}(x)+s)^{2}\\big]}\\\\ &{\\overset{(a)}{\\le}\\Big(\\frac{2}{N}+\\frac{2}{M}\\Big)\\mathbb{E}\\big[(2(\\mathbf{w^{T}}x)^{2}+2b^{2})(2f_{+}(x)^{2}+2s^{2})\\big].}\\end{array}\n$$", "text_format": "latex", "page_idx": 39}, {"type": "text", "text": "Here (a) is obtained in the same vein as the derivation of (d) in the proof of Proposition 45. Moreover, in the same way as that proof, we can show that $\\begin{array}{r}{\\mathbb{E}\\big[(2({\\pmb w}^{\\top}{\\pmb x})^{2}+2b^{2})(2f_{*}({\\pmb x})^{2}+2\\varsigma^{2})\\big]=\\tilde{O}_{d,r}(1).}\\end{array}$ Consequently we get \u03c3(W X1:NN+b1N\u22a4)y1:N\u2212\u03c3(W X1:MM+b1\u22a4M)y1:M   2 = N2 +M2 O\u02dcd,r(m). Next, we observe that ", "page_idx": 40}, {"type": "equation", "text": "$$\n\\mathbb{E}\\left[\\left\\Vert\\left[\\overbrace{\\sigma(w_{1}^{\\top}x+b_{1})}^{\\top}\\right]\\right\\Vert^{2}\\right]\\leq2\\sum_{j=1}^{m}\\mathbb{E}[(w_{j}^{\\top}x)^{2}+b_{j}^{2}]=\\tilde{O}_{d,r}(m).\n$$", "text_format": "latex", "page_idx": 40}, {"type": "text", "text": "Putting all things together, we arrive at ", "page_idx": 40}, {"type": "equation", "text": "$$\n\\begin{array}{r}{|\\mathcal{R}_{N}(f)-\\mathcal{R}_{M}(f)|=\\tilde{O}\\Big(\\|\\mathbf{r}\\|_{F}m\\sqrt{1/N+1/M}\\Big).}\\end{array}\n$$", "text_format": "latex", "page_idx": 40}, {"type": "text", "text": "D.3 Proof of Theorem 1 ", "text_level": 1, "page_idx": 40}, {"type": "text", "text": "Finally we are ready to prove our main theorem. ", "page_idx": 40}, {"type": "text", "text": "Proof. [Proof of Theorem 1] Let $\\bar{\\Gamma}$ be the attention matrix constructed in Proposition 2 and let $\\mathbf{T}^{*}$ be the minimizer of the ridge regression problem (line 8 in Algorithm 1). By the equivalence between optimization with $L_{2}$ regularization and norm-constrained optimization, there exists $\\lambda_{2}$ such that ", "page_idx": 40}, {"type": "equation", "text": "$$\n\\|\\Gamma^{*}\\|_{F}\\leq\\|\\bar{\\Gamma}\\|_{F}=\\tilde{O}\\big(r^{2P}/m\\big),\n$$", "text_format": "latex", "page_idx": 40}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\quad\\Bigg(\\cfrac{1}{T_{2}}\\,\\underset{t=T_{1}+1}{\\sum_{\\atop\\\\\\\\\\\\\\\\gamma}}\\,|y^{t}-f(X^{t},y^{t},x^{t};W^{(1)},\\Gamma^{*},b)|\\Bigg)^{2}}\\\\ &{\\leq\\cfrac{1}{T_{2}}\\,\\underset{t=T_{1}+1}{\\sum_{\\atop\\t=T_{2}+1}^{T_{1}+T_{2}}}\\,(y^{t}-f(X^{t},y^{t},x^{t};W^{(1)},\\Gamma^{*},b))^{2}}\\\\ &{\\leq\\cfrac{1}{T_{2}}\\,\\underset{t=T_{1}+1}{\\sum_{\\substack{\\ t=T_{1}+1}}^{T_{1}+T_{2}}}\\,(y^{t}-f(X^{t},y^{t},x^{t};W^{(1)},\\bar{\\Gamma},b))^{2}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 40}, {"type": "text", "text": "Then, from Proposition 2, ", "page_idx": 40}, {"type": "equation", "text": "$$\n\\frac{1}{T_{2}}\\sum_{t=T_{1}+1}^{T_{1}+T_{2}}|y^{t}-f(X^{t},y^{t},x^{t};W^{(1)},\\Gamma^{*},b)|-\\tau=\\tilde{O}\\left(\\sqrt{\\frac{r^{3P}}{m}+\\frac{r^{2P}}{N_{2}}}\\right)\n$$", "text_format": "latex", "page_idx": 40}, {"type": "text", "text": "holds. ", "page_idx": 40}, {"type": "text", "text": "We evaluate $\\mathcal{R}_{N_{2}}(f)-\\tau$ where $f=f(X^{t},y^{t},x^{t};W^{(1)},\\Gamma^{*},b)$ using the Rademacher complexity. ", "page_idx": 40}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{K_{N_{2}}(f)-\\tau}\\\\ &{=\\cfrac{1}{T_{2}}\\csum_{t=T_{1}+1}^{T_{1}+T_{2}}|y^{t}-f(X^{t},y^{t},x^{t};W^{(1)},\\Gamma^{*},b)|}\\\\ &{\\phantom{=\\ }+\\left(\\mathcal{R}_{N_{2}}(f)-\\cfrac{1}{T_{2}}\\cfrac{T_{1}+T_{2}}{t-T_{1}+1}|y^{t}-f(X^{t},y^{t},x^{t};W^{(1)},\\Gamma^{*},b)|\\right)-\\tau}\\\\ &{\\le\\tilde{O}\\left(\\sqrt{\\cfrac{r^{3P}}{m}+\\cfrac{r^{2P}}{N_{2}}}\\right)}\\\\ &{\\phantom{\\le\\ }+\\cfrac{\\operatorname*{sup}}{f\\in\\mathcal{F}_{N_{1},\\1}}\\left(\\mathcal{R}_{N_{2}}(f)-\\cfrac{1}{T_{2}}\\cfrac{T_{1}+T_{2}}{t-T_{1}+1}\\ |y^{t}-f(X^{t},y^{t},x^{t},y^{t})|\\right)}\\end{array}\n$$", "text_format": "latex", "page_idx": 40}, {"type": "text", "text": "holds, where $\\tilde{\\mathcal F}$ is defined in Corollary 46. We can evaluate the expectation value of the second term of the last line as, using $\\epsilon^{t}$ i.i\u223c.d. $\\mathrm{Unif}\\{\\pm1\\}$ , ", "page_idx": 41}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{E}_{({\\mathbf x}^{t}),\\{{\\mathbf y}^{t}\\},\\{{\\mathbf x}^{t}\\},\\Big}\\Bigg[\\underset{j\\in\\tilde{\\mathcal{F}}_{N,\\lfloor\\mathrm{F}\\rfloor,\\tilde{\\mathcal{G}}}}{\\operatorname*{sup}}\\Bigg(\\mathcal{R}_{N_{2}}(j)-\\frac{1}{T_{2}}\\frac{T_{1}+T_{2}}{\\sum_{t=1}^{t-1}}|{\\mathbf y}^{t}-f(X^{t},{\\mathbf y}^{t},{\\mathbf x}^{t},y^{t})|\\Bigg)\\Bigg]}\\\\ &{\\stackrel{(a)}{\\le}\\mathbb{E}_{({\\mathbf x}^{t}),\\{{\\mathbf y}^{t}\\},\\{{\\mathbf x}^{t}\\},\\Big}\\exp\\Bigg[\\underset{j\\in\\tilde{\\mathcal{F}}_{N,\\lfloor\\mathrm{F}\\rfloor,\\tilde{\\mathbf{F}}}}{\\operatorname*{sup}}\\frac{1}{T_{2}}\\frac{T_{1}+T_{2}}{t-T_{1}+t}\\;{\\mathbf y}^{t}-f(X^{t},{\\mathbf y}^{t},{\\mathbf x}^{t},y^{t})|\\Bigg]}\\\\ &{\\stackrel{(b)}{\\lesssim}\\mathrm{Rad}_{T_{2}}(\\tilde{\\mathcal{F}}_{N_{2},\\lfloor\\mathrm{F}\\rfloor,\\tilde{\\mathbf y}})+\\mathbb{E}_{y\\times\\Big[\\frac{1}{T_{2}}\\frac{T_{1}+T_{2}}{t-T_{1}+t}\\;{\\mathbf y}^{t}\\Big]}\\\\ &{\\le\\mathrm{Rad}_{T_{2}}(\\tilde{\\mathcal{F}}_{N_{2},\\lfloor\\mathrm{F}\\rfloor,\\tilde{\\mathbf y}})+\\mathbb{E}_{y\\times\\Bigg[\\left(\\frac{1}{T_{2}}\\sum_{t=1}^{t+T_{2}}c_{t}^{t}y\\right)^{2}\\right]^{1/2}}\\\\ &{\\le\\mathrm{Rad}_{T_{2}}(\\tilde{\\mathcal{F}}_{N_{2},\\lfloor\\mathrm{F}\\rfloor,\\tilde{\\mathbf y}})+\\frac{1}{\\sqrt{T_{2}}}\\mathbb{E}[{y}^{t}]^{1/2}\\stackrel{(a)}{\\le}\\tilde{\\mathcal{O}}\\Bigg(\\sqrt{\\frac{T^{4/F}}{T_{2}}}\\Bigg).}\\end{array}\n$$", "text_format": "latex", "page_idx": 41}, {"type": "text", "text": "Here, (a) holds from the standard symmetrization argument (see eq. (4.17)\u221a in [Wai19] for example), (b) is derived using eq. (1) in [Mau16], noting that $(x,y)^{\\top}\\mapsto|x-y|$ is $\\sqrt{2}$ -Lipschitz continuous, and (c) follows from the bound of $\\|\\bar{\\mathbf{T}}\\|_{F}$ in Proposition 2, together with Lemma 7 and Proposition 45. Note that ", "page_idx": 41}, {"type": "equation", "text": "$$\n\\operatorname*{sup}_{f\\in\\tilde{\\mathcal{F}}_{N,\\parallel\\Bar{\\mathbf{r}}\\parallel_{F}}}\\left(\\mathcal{R}_{N_{2}}(f)-\\frac{1}{T_{2}}\\sum_{t=T_{1}+1}^{T_{1}+T_{2}}|y^{t}-f(X^{t},y^{t},x^{t},y^{t})|\\right)\n$$", "text_format": "latex", "page_idx": 41}, {"type": "text", "text": "is nonnegative because $f(X,y,x,y)=y$ is included in $\\mathcal{\\tilde{F}}_{N,\\|\\bar{\\mathbf{T}}\\|_{F}}$ . Hence from Markov\u2019s inequality, (D.1) is $\\tilde{O}\\bigg(\\sqrt{\\frac{r^{4P}}{T_{2}}}\\bigg)$ with probability at least 0.995. Hence we obtain ", "page_idx": 41}, {"type": "equation", "text": "$$\n\\mathcal{R}_{N_{2}}(f)-\\tau=\\tilde{O}\\left(\\sqrt{\\frac{r^{3P}}{m}+\\frac{r^{2P}}{N_{2}}}+\\sqrt{\\frac{r^{4P}}{T_{2}}}\\right).\n$$", "text_format": "latex", "page_idx": 41}, {"type": "text", "text": "Now we have done the upper bound for $\\mathcal{R}_{N_{2}}(f)$ . For $\\mathcal{R}_{N^{*}}(f)$ , we can use Proposition 47. ", "page_idx": 41}, {"type": "text", "text": "Note that all the desired events occur with high probability, except for the one described above, which occurs with probability 0.995. This completes the proof of Theorem 1. \u53e3 ", "page_idx": 41}, {"type": "text", "text": "E Derivation of Simplified Self-attention Module ", "text_level": 1, "page_idx": 41}, {"type": "text", "text": "We derive equation (2.6), following the same line of argument as [ZFB23]. As we assumed that $W^{P V}~W^{K Q}$ are in the form as (2.4), the output of the attention layer is written as ", "page_idx": 41}, {"type": "equation", "text": "$$\n\\tilde{f}_{\\mathrm{Attn}}(E;W^{P V},W^{K Q})=E+\\left[\\mathbf{0}_{1\\times m}^{*}\\quad\\mathit{\\ast}_{\\right]}^{*}E\\cdot\\frac{E^{\\top}\\Bigl[\\mathbf{0}_{1\\times m}^{K}\\quad\\ast\\Bigr]E}{N}.\n$$", "text_format": "latex", "page_idx": 41}, {"type": "text", "text": "Note that we adopt the right-bottom entry $\\Big(\\tilde{f}_{\\mathrm{Attn}}(E;W^{P V},W^{K Q})\\Big)_{m+1,N+1}$ as a prediction for output of the query. By (E.1). Hence we have ", "page_idx": 41}, {"type": "equation", "text": "$$\n\\Big(\\tilde{f}_{\\mathrm{Attn}}(E;W^{P V},W^{K Q})\\Big)_{m+1,N+1}\n$$", "text_format": "latex", "page_idx": 41}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{E^{*}\\left[\\underset{0\\leq t_{*}}{K}+\\frac{1}{n}\\Bigg]\\Bigg[\\sigma(w_{\\infty}^{*};\\pmb{x}+h_{1})\\Bigg]}\\\\ {=(\\vartheta_{1,\\infty};\\,v)E\\cdot\\frac{E^{*}\\left[\\sigma(w_{\\infty}^{*};\\pmb{x}+h_{\\infty})\\right]}{N}}\\\\ &{=\\sigma(\\vartheta_{1,\\infty};\\,v)E\\cdot\\frac{E^{*}\\left[\\sigma\\left(w_{\\infty}^{*};\\pmb{x}+h_{\\infty}\\right)\\right]}{N}}\\\\ {=\\sigma(\\vartheta_{1})}&{\\cdots\\quad\\mathcal{Y}\\times\\quad\\vartheta_{1}\\cdot\\frac{E^{*}\\left[\\sigma(w_{\\infty}^{*};\\pmb{x}+h_{\\infty})\\right]}{N}}\\end{array}\n$$", "text_format": "latex", "page_idx": 42}, {"type": "text", "text": "Setting $\\mathbf{T}=v\\mathbf{K}^{\\top}$ yields equation (2.6). ", "page_idx": 42}, {"type": "text", "text": "F Details of Experiments ", "text_level": 1, "page_idx": 42}, {"type": "text", "text": "F.1 Detailed Experimental Settings ", "text_level": 1, "page_idx": 42}, {"type": "text", "text": "For the experiments in Section 4, test loss was averaged over 128 independent tasks, with 2048 and 128 independent queries generated for each task in the experiment of Figure 1 and 2, respectively. During the validation of the e\u221axperiment\u221a of Figure 1, the coefficients $\\{c_{i}\\}$ in the single-index model were fixed to be $(c_{2},c_{3})=(\\sqrt{2\\cdot2!}/2,\\sqrt{2\\cdot3!}/2)$ to reduce the variance in the baseline methods. ", "page_idx": 42}, {"type": "text", "text": "GPT-2 model. The experiments in Section 4 were based on the architecture used in $[\\mathrm{GTLV}22]^{1}$ , whose backbone is the GPT-2 model $[\\mathrm{RWC}^{+}19]$ . Given the prompt $\\{(\\pmb{x}_{i},y_{i})\\}_{i=1}^{N+1}$ , the embedding $E\\in\\mathbb{R}^{d\\times(2N+2)}$ was constructed as ${\\cal E}=[\\pmb{x}_{1},\\pmb{\\tilde{y}}_{1},\\dots,\\pmb{x}_{N},\\pmb{\\tilde{y}}_{N}]$ where $\\pmb{\\tilde{y}}_{i}=[y_{i},0,\\dots,0]^{\\top}$ . This embedding was mapped to $\\tilde{E}\\in\\mathbb{R}^{256\\times(2N+\\bar{2})}$ through the read-in layer. The transformed embedding $\\tilde{E}$ was then passed through the 12-layer GPT-2 backbone with 8 heads, with dropout disabled. Finally, the output was converted into a $2N+2$ -dimensional vector through the read-out layer, where the $(2k-1)$ -th entry $(k\\,\\in\\,[N+1])$ corresponds to the prediction $\\hat{y}_{k}\\big(\\mathbf{\\bar{x}}_{1}^{t},y_{1}^{t}\\cdot\\dots,x_{k-1}^{t},\\dot{y}_{k-1}^{t},\\mathbf{x}_{k}^{t}\\big)$ for $y_{k}$ , that is, the answer for the query $\\pmb{x}_{k}^{t}$ reading the context of length $k\\,-\\,1$ . We used the Adam optimizer [KB15] with a learning rate of 0.0001. The training loss at each step was set as $\\begin{array}{r}{\\frac{1}{B}\\sum_{t=1}^{B}\\sum_{k=1}^{N+1}\\bigl(y_{k}^{t}-\\hat{y}_{k}\\bigl(\\mathbf{x}_{1}^{t},y_{1}^{t}\\cdot\\cdot\\cdot,\\mathbf{x}_{k-1}^{t},y_{k-1}^{t},\\mathbf{x}_{k}^{t}\\bigr)\\bigr)^{2}}\\end{array}$ where $B=8$ is the minibatch size. ", "page_idx": 42}, {"type": "text", "text": "Baseline algorithms. Baseline algorithms used in the comparison experiment are as follows: ", "page_idx": 42}, {"type": "text", "text": "\u2022 Two-layer neural network $\\begin{array}{r}{f(\\pmb{x})\\,=\\,\\sum_{j=1}^{m}a_{j}\\sigma(\\pmb{w}_{j}^{\\top}\\pmb{x})}\\end{array}$ where $\\sigma\\,=\\,\\mathrm{ReLU}$ and $m\\:=\\:256$ . The   \ninitialization scale followed the mean-field regime, with $a_{j}\\overset{\\mathrm{i.i.d.}}{\\sim}\\mathrm{Unif}(\\{\\pm1/m\\})$ and ${\\pmb w}_{j}$ i.i\u223c.d. $\\mathrm{Unif}(\\mathbb{S}^{d-1})$ . The architecture was trained using the Adam optimizer, with a learning rate of 0.1 for the first layer and $0.1/m$ for the second layer, along with a weight dacay rate of 0.0001. Early stopping was applied to prevent overfitting.   \n\u2022 Kernel ridge regression using the Gaussian RBF kernel. The ridge regression parameter $\\lambda$ was set to $\\lambda=0.01$ . ", "page_idx": 42}, {"type": "text", "text": "Again, note that these baseline algorithms were trained from scratch for each validation task, whereas the parameters of the pretrained GPT-2 model remained unchanged across all validation tasks. ", "page_idx": 42}, {"type": "text", "text": "F.2 Experiment on Our Architecture and Algorithm 1 ", "text_level": 1, "page_idx": 43}, {"type": "text", "text": "In addition to the GPT-2 experiments, we also conducted comparison between our Algorithm 1 on our simplified architecture and baseline algorithms. Data is generated as $y_{i}^{t}\\ =\\ \\mathrm{He}_{2}(\\langle\\pmb{x}_{i}^{t},\\beta^{t}\\rangle)$ , where $\\beta^{t}$ t i.i.d. \u223c $\\mathrm{Unif}\\{\\beta\\ \\in\\ \\mathbb{R}^{d}\\ \\mid\\ \\beta\\ =\\ [\\beta_{1:r},\\mathbf{0}]^{\\top},\\|\\beta\\|\\ =\\ 1\\}$ with $d=32$ and $r\\,=\\,2$ . We pretrained our transformer architecture (2.6) with $m\\,=\\,8,000$ , using Algorithm 1 with $T_{1}~=~10^{5},N_{1}~=~10^{4},\\eta_{1}~=~10^{5}$ (recall that $\\eta_{1}~\\asymp~m^{\\frac{3}{2}}r d^{2Q-\\frac{1}{2}}$ \u00b7 $(\\log d)^{-C_{\\eta}}$ should be large) and $T_{2}=3,000,N_{2}=512,\\lambda_{2}=0.1$ . We used mini-batch SGD to find an approximate optimizer $\\mathbf{T}^{*}$ of the ridge regression. For validation, we altered the context length from $2^{4.5}$ to $2^{9}$ and compared its test error with onestep GD (training the first layer via one-step gradient descent, and then conducting ridge regression on the second layer) on a two-layer NN of width 8, 000 and kernel ridge regression with RBF kernel working directly on the test prompt. In Figure 3 we see that our simplified transformer also outperforms neural network and kernel method, especially in short context regime. ", "page_idx": 43}, {"type": "text", "text": "", "page_idx": 43}, {"type": "image", "img_path": "uHcG5Y6fdB/tmp/c8441c352f0cd533ae26f441c9f8af3a452fbf57d334aeee89d35a194a88fb94.jpg", "img_caption": ["Figure 3: In-context generalization error of kernel ridge regression, neural network $^+$ onestep gradient descent, and Algorithm 1 on our Transformer (2.6). "], "img_footnote": [], "page_idx": 43}, {"type": "text", "text": "NeurIPS Paper Checklist ", "text_level": 1, "page_idx": 44}, {"type": "text", "text": "1. Claims ", "text_level": 1, "page_idx": 44}, {"type": "text", "text": "Question: Do the main claims made in the abstract and introduction accurately reflect the paper\u2019s contributions and scope? ", "page_idx": 44}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 44}, {"type": "text", "text": "Justification: They are presented accurately. ", "page_idx": 44}, {"type": "text", "text": "Guidelines: ", "page_idx": 44}, {"type": "text", "text": "\u2022 The answer NA means that the abstract and introduction do not include the claims made in the paper.   \n\u2022 The abstract and/or introduction should clearly state the claims made, including the contributions made in the paper and important assumptions and limitations. A No or NA answer to this question will not be perceived well by the reviewers.   \n\u2022 The claims made should match theoretical and experimental results, and reflect how much the results can be expected to generalize to other settings.   \n\u2022 It is fine to include aspirational goals as motivation as long as it is clear that these goals are not attained by the paper. ", "page_idx": 44}, {"type": "text", "text": "2. Limitations ", "text_level": 1, "page_idx": 44}, {"type": "text", "text": "Question: Does the paper discuss the limitations of the work performed by the authors? ", "page_idx": 44}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 44}, {"type": "text", "text": "Justification: We mentioned the limitation of our result and the future challenge in Section 5. Guidelines: ", "page_idx": 44}, {"type": "text", "text": "\u2022 The answer NA means that the paper has no limitation while the answer No means that the paper has limitations, but those are not discussed in the paper.   \n\u2022 The authors are encouraged to create a separate \"Limitations\" section in their paper.   \n\u2022 The paper should point out any strong assumptions and how robust the results are to violations of these assumptions (e.g., independence assumptions, noiseless settings, model well-specification, asymptotic approximations only holding locally). The authors should reflect on how these assumptions might be violated in practice and what the implications would be.   \n\u2022 The authors should reflect on the scope of the claims made, e.g., if the approach was only tested on a few datasets or with a few runs. In general, empirical results often depend on implicit assumptions, which should be articulated.   \n\u2022 The authors should reflect on the factors that influence the performance of the approach. For example, a facial recognition algorithm may perform poorly when image resolution is low or images are taken in low lighting. Or a speech-to-text system might not be used reliably to provide closed captions for online lectures because it fails to handle technical jargon.   \n\u2022 The authors should discuss the computational efficiency of the proposed algorithms and how they scale with dataset size.   \n\u2022 If applicable, the authors should discuss possible limitations of their approach to address problems of privacy and fairness.   \n\u2022 While the authors might fear that complete honesty about limitations might be used by reviewers as grounds for rejection, a worse outcome might be that reviewers discover limitations that aren\u2019t acknowledged in the paper. The authors should use their best judgment and recognize that individual actions in favor of transparency play an important role in developing norms that preserve the integrity of the community. Reviewers will be specifically instructed to not penalize honesty concerning limitations. ", "page_idx": 44}, {"type": "text", "text": "3. Theory Assumptions and Proofs ", "text_level": 1, "page_idx": 44}, {"type": "text", "text": "Question: For each theoretical result, does the paper provide the full set of assumptions and a complete (and correct) proof? ", "page_idx": 44}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 44}, {"type": "text", "text": "Justification: We presented full-proofs for our results in the appendix, and sketched the proof in Section 3.2. ", "page_idx": 45}, {"type": "text", "text": "Guidelines: ", "page_idx": 45}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include theoretical results.   \n\u2022 All the theorems, formulas, and proofs in the paper should be numbered and crossreferenced.   \n\u2022 All assumptions should be clearly stated or referenced in the statement of any theorems.   \n\u2022 The proofs can either appear in the main paper or the supplemental material, but if they appear in the supplemental material, the authors are encouraged to provide a short proof sketch to provide intuition.   \n\u2022 Inversely, any informal proof provided in the core of the paper should be complemented by formal proofs provided in appendix or supplemental material.   \n\u2022 Theorems and Lemmas that the proof relies upon should be properly referenced. ", "page_idx": 45}, {"type": "text", "text": "4. Experimental Result Reproducibility ", "text_level": 1, "page_idx": 45}, {"type": "text", "text": "Question: Does the paper fully disclose all the information needed to reproduce the main experimental results of the paper to the extent that it affects the main claims and/or conclusions of the paper (regardless of whether the code and data are provided or not)? ", "page_idx": 45}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 45}, {"type": "text", "text": "Justification: See Appendix F. ", "page_idx": 45}, {"type": "text", "text": "Guidelines: ", "page_idx": 45}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 If the paper includes experiments, a No answer to this question will not be perceived well by the reviewers: Making the paper reproducible is important, regardless of whether the code and data are provided or not.   \n\u2022 If the contribution is a dataset and/or model, the authors should describe the steps taken to make their results reproducible or verifiable.   \n\u2022 Depending on the contribution, reproducibility can be accomplished in various ways. For example, if the contribution is a novel architecture, describing the architecture fully might suffice, or if the contribution is a specific model and empirical evaluation, it may be necessary to either make it possible for others to replicate the model with the same dataset, or provide access to the model. In general. releasing code and data is often one good way to accomplish this, but reproducibility can also be provided via detailed instructions for how to replicate the results, access to a hosted model (e.g., in the case of a large language model), releasing of a model checkpoint, or other means that are appropriate to the research performed.   \n\u2022 While NeurIPS does not require releasing code, the conference does require all submissions to provide some reasonable avenue for reproducibility, which may depend on the nature of the contribution. For example (a) If the contribution is primarily a new algorithm, the paper should make it clear how to reproduce that algorithm. (b) If the contribution is primarily a new model architecture, the paper should describe the architecture clearly and fully. (c) If the contribution is a new model (e.g., a large language model), then there should either be a way to access this model for reproducing the results or a way to reproduce the model (e.g., with an open-source dataset or instructions for how to construct the dataset). (d) We recognize that reproducibility may be tricky in some cases, in which case authors are welcome to describe the particular way they provide for reproducibility. In the case of closed-source models, it may be that access to the model is limited in some way (e.g., to registered users), but it should be possible for other researchers to have some path to reproducing or verifying the results. ", "page_idx": 45}, {"type": "text", "text": "5. Open access to data and code ", "text_level": 1, "page_idx": 45}, {"type": "text", "text": "Question: Does the paper provide open access to the data and code, with sufficient instructions to faithfully reproduce the main experimental results, as described in supplemental material? ", "page_idx": 45}, {"type": "text", "text": "Answer: [No] ", "page_idx": 46}, {"type": "text", "text": "Justification: This is a theory paper where the toy experiments are not central to our contribution. ", "page_idx": 46}, {"type": "text", "text": "Guidelines: ", "page_idx": 46}, {"type": "text", "text": "\u2022 The answer NA means that paper does not include experiments requiring code.   \n\u2022 Please see the NeurIPS code and data submission guidelines (https://nips.cc/ public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 While we encourage the release of code and data, we understand that this might not be possible, so \u201cNo\u201d is an acceptable answer. Papers cannot be rejected simply for not including code, unless this is central to the contribution (e.g., for a new open-source benchmark).   \n\u2022 The instructions should contain the exact command and environment needed to run to reproduce the results. See the NeurIPS code and data submission guidelines (https: //nips.cc/public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 The authors should provide instructions on data access and preparation, including how to access the raw data, preprocessed data, intermediate data, and generated data, etc.   \n\u2022 The authors should provide scripts to reproduce all experimental results for the new proposed method and baselines. If only a subset of experiments are reproducible, they should state which ones are omitted from the script and why.   \n\u2022 At submission time, to preserve anonymity, the authors should release anonymized versions (if applicable).   \n\u2022 Providing as much information as possible in supplemental material (appended to the paper) is recommended, but including URLs to data and code is permitted. ", "page_idx": 46}, {"type": "text", "text": "6. Experimental Setting/Details ", "text_level": 1, "page_idx": 46}, {"type": "text", "text": "Question: Does the paper specify all the training and test details (e.g., data splits, hyperparameters, how they were chosen, type of optimizer, etc.) necessary to understand the results? ", "page_idx": 46}, {"type": "text", "text": "Answer:[Yes] ", "page_idx": 46}, {"type": "text", "text": "Justification: See Section 4 and Appendix F. ", "page_idx": 46}, {"type": "text", "text": "Guidelines: ", "page_idx": 46}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments. \u2022 The experimental setting should be presented in the core of the paper to a level of detail that is necessary to appreciate the results and make sense of them. \u2022 The full details can be provided either with the code, in appendix, or as supplemental material. ", "page_idx": 46}, {"type": "text", "text": "7. Experiment Statistical Significance ", "text_level": 1, "page_idx": 46}, {"type": "text", "text": "Question: Does the paper report error bars suitably and correctly defined or other appropriate information about the statistical significance of the experiments? ", "page_idx": 46}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 46}, {"type": "text", "text": "Justification: See Section 4 and Appendix F. ", "page_idx": 46}, {"type": "text", "text": "Guidelines: ", "page_idx": 46}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The authors should answer \"Yes\" if the results are accompanied by error bars, confidence intervals, or statistical significance tests, at least for the experiments that support the main claims of the paper.   \n\u2022 The factors of variability that the error bars are capturing should be clearly stated (for example, train/test split, initialization, random drawing of some parameter, or overall run with given experimental conditions).   \n\u2022 The method for calculating the error bars should be explained (closed form formula, call to a library function, bootstrap, etc.)   \n\u2022 The assumptions made should be given (e.g., Normally distributed errors).   \n\u2022 It should be clear whether the error bar is the standard deviation or the standard error of the mean.   \n\u2022 It is OK to report 1-sigma error bars, but one should state it. The authors should preferably report a 2-sigma error bar than state that they have a $96\\%$ CI, if the hypothesis of Normality of errors is not verified.   \n\u2022 For asymmetric distributions, the authors should be careful not to show in tables or figures symmetric error bars that would yield results that are out of range (e.g. negative error rates).   \n\u2022 If error bars are reported in tables or plots, The authors should explain in the text how they were calculated and reference the corresponding figures or tables in the text. ", "page_idx": 46}, {"type": "text", "text": "", "page_idx": 47}, {"type": "text", "text": "8. Experiments Compute Resources ", "text_level": 1, "page_idx": 47}, {"type": "text", "text": "Question: For each experiment, does the paper provide sufficient information on the computer resources (type of compute workers, memory, time of execution) needed to reproduce the experiments? ", "page_idx": 47}, {"type": "text", "text": "Answer: [No] ", "page_idx": 47}, {"type": "text", "text": "Justification: We only have toy experiments and it is not a central part of this paper. ", "page_idx": 47}, {"type": "text", "text": "Guidelines: ", "page_idx": 47}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The paper should indicate the type of compute workers CPU or GPU, internal cluster, or cloud provider, including relevant memory and storage.   \n\u2022 The paper should provide the amount of compute required for each of the individual experimental runs as well as estimate the total compute.   \n\u2022 The paper should disclose whether the full research project required more compute than the experiments reported in the paper (e.g., preliminary or failed experiments that didn\u2019t make it into the paper). ", "page_idx": 47}, {"type": "text", "text": "9. Code Of Ethics ", "text_level": 1, "page_idx": 47}, {"type": "text", "text": "Question: Does the research conducted in the paper conform, in every respect, with the NeurIPS Code of Ethics https://neurips.cc/public/EthicsGuidelines? ", "page_idx": 47}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 47}, {"type": "text", "text": "Justification: Yes, and we checked the code. ", "page_idx": 47}, {"type": "text", "text": "Guidelines: ", "page_idx": 47}, {"type": "text", "text": "\u2022 The answer NA means that the authors have not reviewed the NeurIPS Code of Ethics.   \n\u2022 If the authors answer No, they should explain the special circumstances that require a deviation from the Code of Ethics.   \n\u2022 The authors should make sure to preserve anonymity (e.g., if there is a special consideration due to laws or regulations in their jurisdiction). ", "page_idx": 47}, {"type": "text", "text": "10. Broader Impacts ", "text_level": 1, "page_idx": 47}, {"type": "text", "text": "Question: Does the paper discuss both potential positive societal impacts and negative societal impacts of the work performed? ", "page_idx": 47}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 47}, {"type": "text", "text": "Justification: Our results are purely theoretical working on a small simplified model, thus there seems no societal impact. ", "page_idx": 47}, {"type": "text", "text": "Guidelines: ", "page_idx": 47}, {"type": "text", "text": "\u2022 The answer NA means that there is no societal impact of the work performed.   \n\u2022 If the authors answer NA or No, they should explain why their work has no societal impact or why the paper does not address societal impact.   \n\u2022 Examples of negative societal impacts include potential malicious or unintended uses (e.g., disinformation, generating fake profiles, surveillance), fairness considerations (e.g., deployment of technologies that could make decisions that unfairly impact specific groups), privacy considerations, and security considerations.   \n\u2022 The conference expects that many papers will be foundational research and not tied to particular applications, let alone deployments. However, if there is a direct path to any negative applications, the authors should point it out. For example, it is legitimate to point out that an improvement in the quality of generative models could be used to generate deepfakes for disinformation. On the other hand, it is not needed to point out that a generic algorithm for optimizing neural networks could enable people to train models that generate Deepfakes faster.   \n\u2022 The authors should consider possible harms that could arise when the technology is being used as intended and functioning correctly, harms that could arise when the technology is being used as intended but gives incorrect results, and harms following from (intentional or unintentional) misuse of the technology.   \n\u2022 If there are negative societal impacts, the authors could also discuss possible mitigation strategies (e.g., gated release of models, providing defenses in addition to attacks, mechanisms for monitoring misuse, mechanisms to monitor how a system learns from feedback over time, improving the efficiency and accessibility of ML). ", "page_idx": 47}, {"type": "text", "text": "", "page_idx": 48}, {"type": "text", "text": "11. Safeguards ", "text_level": 1, "page_idx": 48}, {"type": "text", "text": "Question: Does the paper describe safeguards that have been put in place for responsible release of data or models that have a high risk for misuse (e.g., pretrained language models, image generators, or scraped datasets)? ", "page_idx": 48}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 48}, {"type": "text", "text": "Justification: We don\u2019t have any models or datasets to release. ", "page_idx": 48}, {"type": "text", "text": "Guidelines: ", "page_idx": 48}, {"type": "text", "text": "\u2022 The answer NA means that the paper poses no such risks.   \n\u2022 Released models that have a high risk for misuse or dual-use should be released with necessary safeguards to allow for controlled use of the model, for example by requiring that users adhere to usage guidelines or restrictions to access the model or implementing safety filters.   \n\u2022 Datasets that have been scraped from the Internet could pose safety risks. The authors should describe how they avoided releasing unsafe images.   \n\u2022 We recognize that providing effective safeguards is challenging, and many papers do not require this, but we encourage authors to take this into account and make a best faith effort. ", "page_idx": 48}, {"type": "text", "text": "12. Licenses for existing assets ", "text_level": 1, "page_idx": 48}, {"type": "text", "text": "Question: Are the creators or original owners of assets (e.g., code, data, models), used in the paper, properly credited and are the license and terms of use explicitly mentioned and properly respected? ", "page_idx": 48}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 48}, {"type": "text", "text": "Justification: We included the information in Appendix F. ", "page_idx": 48}, {"type": "text", "text": "Guidelines: ", "page_idx": 48}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not use existing assets.   \n\u2022 The authors should cite the original paper that produced the code package or dataset.   \n\u2022 The authors should state which version of the asset is used and, if possible, include a URL.   \n\u2022 The name of the license (e.g., CC-BY 4.0) should be included for each asset.   \n\u2022 For scraped data from a particular source (e.g., website), the copyright and terms of service of that source should be provided.   \n\u2022 If assets are released, the license, copyright information, and terms of use in the package should be provided. For popular datasets, paperswithcode.com/datasets has curated licenses for some datasets. Their licensing guide can help determine the license of a dataset.   \n\u2022 For existing datasets that are re-packaged, both the original license and the license of the derived asset (if it has changed) should be provided. ", "page_idx": 48}, {"type": "text", "text": "\u2022 If this information is not available online, the authors are encouraged to reach out to the asset\u2019s creators. ", "page_idx": 49}, {"type": "text", "text": "13. New Assets ", "text_level": 1, "page_idx": 49}, {"type": "text", "text": "Question: Are new assets introduced in the paper well documented and is the documentation provided alongside the assets? ", "page_idx": 49}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 49}, {"type": "text", "text": "Justification: We don\u2019t release any assets. ", "page_idx": 49}, {"type": "text", "text": "Guidelines: ", "page_idx": 49}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not release new assets.   \n\u2022 Researchers should communicate the details of the dataset/code/model as part of their submissions via structured templates. This includes details about training, license, limitations, etc.   \n\u2022 The paper should discuss whether and how consent was obtained from people whose asset is used.   \n\u2022 At submission time, remember to anonymize your assets (if applicable). You can either create an anonymized URL or include an anonymized zip file. ", "page_idx": 49}, {"type": "text", "text": "14. Crowdsourcing and Research with Human Subjects ", "text_level": 1, "page_idx": 49}, {"type": "text", "text": "Question: For crowdsourcing experiments and research with human subjects, does the paper include the full text of instructions given to participants and screenshots, if applicable, as well as details about compensation (if any)? ", "page_idx": 49}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 49}, {"type": "text", "text": "Justification: Our paper does not include such subjects. ", "page_idx": 49}, {"type": "text", "text": "Guidelines: ", "page_idx": 49}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Including this information in the supplemental material is fine, but if the main contribution of the paper involves human subjects, then as much detail as possible should be included in the main paper.   \n\u2022 According to the NeurIPS Code of Ethics, workers involved in data collection, curation, or other labor should be paid at least the minimum wage in the country of the data collector. ", "page_idx": 49}, {"type": "text", "text": "15. Institutional Review Board (IRB) Approvals or Equivalent for Research with Human Subjects ", "text_level": 1, "page_idx": 49}, {"type": "text", "text": "Question: Does the paper describe potential risks incurred by study participants, whether such risks were disclosed to the subjects, and whether Institutional Review Board (IRB) approvals (or an equivalent approval/review based on the requirements of your country or institution) were obtained? ", "page_idx": 49}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 49}, {"type": "text", "text": "Justification: Our paper does not include such subjects. ", "page_idx": 49}, {"type": "text", "text": "Guidelines: ", "page_idx": 49}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Depending on the country in which research is conducted, IRB approval (or equivalent) may be required for any human subjects research. If you obtained IRB approval, you should clearly state this in the paper.   \n\u2022 We recognize that the procedures for this may vary significantly between institutions and locations, and we expect authors to adhere to the NeurIPS Code of Ethics and the guidelines for their institution.   \n\u2022 For initial submissions, do not include any information that would break anonymity (if applicable), such as the institution conducting the review. ", "page_idx": 49}]