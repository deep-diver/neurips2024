[{"figure_path": "xeXRhTUmcf/figures/figures_1_1.jpg", "caption": "Figure 1.1: Motivation example and general scheme of our method.", "description": "The figure demonstrates the proposed method's workflow. (a) shows the two-moons dataset where GDA fails to capture the distribution, highlighting the need for a non-parametric approach.  (b) illustrates the general scheme.  A feature extractor processes inputs (X), creating features (\u03a6\u03b8\u2081(X) \u2208 F). These features are used to compute the Fermat distance and then the Lens Depth, resulting in an uncertainty score S that determines whether a prediction is in-distribution (ID) or out-of-distribution (OOD).", "section": "1 Introduction"}, {"figure_path": "xeXRhTUmcf/figures/figures_3_1.jpg", "caption": "Figure 3.1: LD using Euclidean distance. Using Euclidean distance cannot capture correctly the distribution.", "description": "This figure shows a comparison of Lens Depth (LD) calculations using Euclidean distance for two different data distributions: a Gaussian distribution and a two-moons distribution.  The contour lines represent the LD values, with darker shades indicating higher depth. The black points represent the data points themselves.  The figure highlights that using Euclidean distance fails to properly capture the shape and density of the two-moons distribution, as the contour lines do not accurately reflect the cluster structure. In contrast, the Euclidean distance works relatively well for the Gaussian data because of the data's spherical shape.", "section": "3 Background"}, {"figure_path": "xeXRhTUmcf/figures/figures_3_2.jpg", "caption": "Figure 3.2: Sample Fermat path between two randomly chosen points with different values of \u03b1.", "description": "This figure visualizes the Fermat paths between two randomly selected points within a dataset for various values of the parameter \u03b1. The Fermat distance, a key component of the proposed method, is used to measure the distance between these points, taking into account the density and geometry of the data distribution.  In panel (a), where \u03b1 = 1, the Fermat path is a straight line representing the Euclidean distance. As \u03b1 increases (b-d), the Fermat path starts to bend and adapts to the shape and density of the cluster.  This demonstrates how the parameter \u03b1 controls the sensitivity of the Fermat distance to the data's underlying structure, which is essential in effectively capturing the depth of a point with respect to the data distribution.", "section": "3.2 Fermat distance"}, {"figure_path": "xeXRhTUmcf/figures/figures_4_1.jpg", "caption": "Figure 4.1: LD with Sample Fermat Distance on moon and spiral datasets. (a) and (b) are results of using directly sample Fermat distance in Eq. (3.5). This produces undesirable artifacts where we observe zones of constant value of LD. This phenomenon is explained by Proposition 1. (c) and (d) use our modified version in Eq. (4.1): it captures perfectly the distributions.", "description": "This figure shows the results of applying Lens Depth (LD) with the sample Fermat distance on two datasets: moon and spiral.  Subfigures (a) and (b) demonstrate the artifacts produced by using the classical Fermat distance, showing zones of constant LD values.  In contrast, subfigures (c) and (d) illustrate the improved performance of the modified sample Fermat distance introduced by the authors, which accurately captures the distribution of both datasets.", "section": "4 Combining LD and Fermat Distance"}, {"figure_path": "xeXRhTUmcf/figures/figures_6_1.jpg", "caption": "Figure 5.1: Methods for uncertainty estimation applied on the same neural net trained to classify 2 classes in moon-shape (represented by yellow and black points respectively). Uncertainty estimations are computed based solely on the feature space of the model without seeing directly the inputs. Red represents high uncertainty. Our method (Fig. 5.1a, 5.1b and 5.1c) gives excellent results and much better than other methods.", "description": "The figure shows a comparison of different uncertainty estimation methods applied to a two-moon dataset.  The methods compared are Lens Depth (LD) with different values of the hyperparameter 'a', Euclidean distance, Gaussian Discriminant Analysis (GDA), and predictive entropy. The figure demonstrates that LD is able to capture the shape and density of the data distribution more effectively than the other methods, especially in complex shapes where GDA fails.", "section": "5.1 How is the input distribution represented in the feature space of softmax model?"}, {"figure_path": "xeXRhTUmcf/figures/figures_7_1.jpg", "caption": "Figure 5.2: Consistency curves for FashionMNIST/MNIST, CIFAR10/SVHN, CIFAR10/CIFAR100 and CIFAR10/Tiny-ImageNet over 5 runs (each curve corresponds to an independently trained model).", "description": "This figure shows the consistency curves for four different pairs of datasets: FashionMNIST/MNIST, CIFAR10/SVHN, CIFAR10/CIFAR100, and CIFAR10/Tiny-ImageNet. Each curve represents the accuracy of the model on the retained samples as a function of the percentage of samples rejected based on the Lens Depth (LD) score.  The results are shown for 5 independent runs, with each curve corresponding to a separately trained model. The increasing trend of the curves demonstrates the effectiveness of LD as a measure of uncertainty; rejecting more uncertain samples (those with lower LD scores) increases the overall accuracy of the model on the remaining samples.", "section": "5.2 FashionMNIST vs MNIST"}, {"figure_path": "xeXRhTUmcf/figures/figures_13_1.jpg", "caption": "Figure C.1: LD using only 20% of points (200 points) on simulated spiral dataset of 1000 points over 10 runs. We see that the contours of LD level changes slightly between different tries, but in general, the proposed method captures well the general form of distribution. Note that the points presented in the plot are the full dataset of 1000 points.", "description": "This figure shows the stability of the proposed method (LD with Sample Fermat Distance) when using only 20% of the data points from the spiral dataset.  Ten independent trials were conducted, each using a different random subset of 200 points out of the original 1000.  The contours of the LD level sets vary slightly across trials, demonstrating a degree of robustness, but the overall shape and structure of the distribution are consistently well-captured.", "section": "More qualitative results of Fermat Lens Depth on spiral dataset using 20% points"}, {"figure_path": "xeXRhTUmcf/figures/figures_14_1.jpg", "caption": "Figure D.1: LD using only a certain portion of points until LD fails to capture the shape of the distribution. Each row represents a fixed percentage, for which we performs 5 independent runs. Notice that the points displayed on the figure is the full dataset of 1000 points, so that we can observe how well LD captures the original data distribution. Please also note that we randomly sample a small portion of the original points. Hence, the sampled points can be concentrated in a small region instead of being distributed along the spiral. So, the sampled points can represent not very correctly the original distribution. Therefore, it is not surprising that LD fails to capture the original support at around 5 - 6% of the original size. (Note that we use 20% for results in Fig.4.2.b in the main paper.)", "description": "This figure shows the results of an experiment where the number of points used to compute the Lens Depth (LD) on a spiral dataset is progressively reduced.  Each row shows results for a different percentage of the original 1000 data points (20%, 10%, 8%, 6%, 5%).  The images illustrate that while LD can effectively capture the shape of the distribution with 20% of the data, its performance deteriorates as the data sparsity increases.  At around 5-6% of the original data, LD loses the capacity to accurately represent the data distribution.", "section": "D More qualitative results of Fermat Lens Depth on spiral dataset using a portion of point until failing"}, {"figure_path": "xeXRhTUmcf/figures/figures_15_1.jpg", "caption": "Figure 4.1: LD with Sample Fermat Distance on moon and spiral datasets. (a) and (b) are results of using directly sample Fermat distance in Eq. (3.5). This produces undesirable artifacts where we observe zones of constant value of LD. This phenomenon is explained by Proposition 1. (c) and (d) use our modified version in Eq. (4.1): it captures perfectly the distributions.", "description": "This figure shows the results of applying Lens Depth (LD) with the Sample Fermat Distance on two datasets: the two-moons dataset and the spiral dataset. The left two subfigures (a and b) show the results obtained using the original Sample Fermat Distance, which produces artifacts in the form of regions with constant LD values. The right two subfigures (c and d) show the results obtained using a modified version of the Sample Fermat Distance, which successfully captures the distributions.", "section": "4 Combining LD and Fermat Distance"}, {"figure_path": "xeXRhTUmcf/figures/figures_16_1.jpg", "caption": "Figure 5.2: Consistency curves for FashionMNIST/MNIST, CIFAR10/SVHN, CIFAR10/CIFAR100 and CIFAR10/Tiny-ImageNet over 5 runs (each curve corresponds to an independently trained model).", "description": "This figure displays the consistency curves obtained from five independent runs for four different dataset pairs (FashionMNIST/MNIST, CIFAR10/SVHN, CIFAR10/CIFAR100, and CIFAR10/Tiny-ImageNet).  Each curve shows the relationship between the percentage of samples rejected based on their Lens Depth (LD) score and the accuracy on the retained samples.  The consistently increasing nature of the curves demonstrates that LD serves as a reliable indicator of uncertainty in model predictions, with higher accuracy observed as more uncertain samples are removed.", "section": "5.2 FashionMNIST vs MNIST"}]