[{"type": "text", "text": "Fine-grained Image-to-LiDAR Contrastive Distillation with Visual Foundation Models ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Yifan Zhang and Junhui Hou\u2217 Department of Computer Science, City University of Hong Kong yzhang3362-c@my.cityu.edu.hk;jh.hou@cityu.edu.hk ", "page_idx": 0}, {"type": "text", "text": "Abstract ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Contrastive image-to-LiDAR knowledge transfer, commonly used for learning 3D representations with synchronized images and point clouds, often faces a selfconfilct dilemma. This issue arises as contrastive losses unintentionally dissociate features of unmatched points and pixels that share semantic labels, compromising the integrity of learned representations. To overcome this, we harness Visual Foundation Models (VFMs), which have revolutionized the acquisition of pixel-level semantics, to enhance 3D representation learning. Specifically, we utilize offthe-shelf VFMs to generate semantic labels for weakly-supervised pixel-to-point contrastive distillation. Additionally, we employ von Mises-Fisher distributions to structure the feature space, ensuring semantic embeddings within the same class remain consistent across varying inputs. Furthermore, we adapt sampling probabilities of points to address imbalances in spatial distribution and category frequency, promoting comprehensive and balanced learning. Extensive experiments demonstrate that our approach mitigates the challenges posed by traditional methods and consistently surpasses existing image-to-LiDAR contrastive distillation methods in downstream tasks. Code is available at https://github.com/Eaphan/OLIVINE. ", "page_idx": 0}, {"type": "text", "text": "1 Introduction ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "LiDAR sensors deliver critical information in the 3D environment, crucial for applications such as autonomous driving [78, 75, 79]. State-of-the-art neural networks have shown promising performance on point clouds processing, which rely on extensive annotated datasets [29, 77, 17]. However, the process of annotating point clouds is not only time-consuming but also costly, presenting significant challenges in terms of scalability and practicality [36]. Self-supervision offers a solution by leveraging vast quantities of unlabeled data to pre-train networks and subsequently fine-tuning them with a smaller, labeled dataset. This approach significantly reduces the reliance on extensive annotated data sets [10]. ", "page_idx": 0}, {"type": "text", "text": "A prevalent method for learning 3D representations involves contrastive pixel-to-point knowledge transfer, using synchronized and calibrated images and point clouds. PPKT [39] enables a 3D network to derive extensive knowledge from a pre-trained 2D image backbone through a pixelto-point contrastive loss. This entire pre-training process necessitates no annotations for either images or point clouds. Then SLidR [50] employs superpixels to cluster pixels and points from visually coherent regions, leading to a more meaningful contrastive task. Building on this, Seal [38] utilizes semantically rich superpixels generated by visual foundation models and introduces temporal consistency regularization across point segments at different times. Meanwhile, HVDistill [73] innovates by implementing cross-modality contrastive distillation that integrates both image-plane and bird-eye views. ", "page_idx": 0}, {"type": "text", "text": "Unfortunately, existing contrastive distillation methods are hindered by several critical limitations. Firstly, a \"self-confilct\" issue arises during pre-training, where (super)pixels that belong to the same category as an anchor (super)point but do not directly correspond are simply treated as negative samples (see Fig.1(a)). This approach neglects the inherent semantic connections within the same category, leading to confilcts in the learning process where beneficial relationships might be disregarded. This problem is magnified by the contrastive loss\u2019s intrinsic hardness-aware characteristic, which results in the most substantial gradient influences derived from negative samples that are semantically the most similar [59, 41]. While ST-SLidR [41] has introduced a semantically tolerant loss to mitigate this issue, the absence of a robust high-level semantic understanding could not fundamentally change ", "page_idx": 1}, {"type": "text", "text": "the intrinsic hardness-aware nature of the contrastive loss. Secondly, conventional sampling methods for point-pixel pairs fail to consider significant category imbalances or variations in point densities relative to their distance from sensors [39]. For example, bicycles comprise only $1.47\\%$ of annotations in the nuSceneslidarseg dataset, whereas drivable surfaces make up $37.66\\%$ . This oversight can result in a skewed representation of the environment, where dominant categories or densely populated areas are over-represented, impacting the model\u2019s effectiveness and fairness. ", "page_idx": 1}, {"type": "text", "text": "In this study, we address the \"self-conflict\" issue by leveraging supervised contrastive distillation enhanced with weak semantic labels generated by VFMs (Visual Foundation Models). VFMs like ", "page_idx": 1}, {"type": "image", "img_path": "63xeWav1lU/tmp/e1ab0354f23184938bb6d32583debc9e88bb8b7f0dec2d8869588ca6558822c2.jpg", "img_caption": ["Figure 1: Illustration of (a) self-conflict that exists in conventional pixel-to-point contrastive distillation and $({\\bf b})$ our weakly supervised contrastive distillation. "], "img_footnote": [], "page_idx": 1}, {"type": "text", "text": "SAM (Segment Anything Model), trained on expansive datasets, has revolutionized computer vision by simplifying the acquisition of pixel-level semantics. These models are exceptionally adaptable, enabling the direct derivation of semantic labels through specified prompts without the need for retraining. As depicted in Fig.1(b), with these weak labels, we draw the embeddings of an anchor point and corresponding pixels of the same class closer together, while distancing the anchor from \u201cnegative\u201d pixels of differing classes. Furthermore, given that representation of samples in the same class can vary significantly across different batches, we introduce semantic-guided consistency regularization to enhance 3D representation learning. This approach structures the feature space by modeling each class with a von Mises-Fisher distribution and making point features adhere closely to their respective distributions. ", "page_idx": 1}, {"type": "text", "text": "Considering the challenges posed by category imbalance and the non-uniform distribution of point clouds, we propose a density and category-aware sampling strategy. This method accounts for both the density of points and the frequency of their categories. By adjusting the sampling probabilities of different anchor points, we enhance the quality of learned 3D representations, particularly for points that fall into minority categories or are situated in areas of low density. ", "page_idx": 1}, {"type": "text", "text": "Extensive experiments reveal that our pre-training approach outperforms state-of-the-art 3D selfsupervised methods on both the nuScenes and SemanticKITTI datasets. The primary contributions of this work are summarized as follows: 1) To tackle the challenge of \u201cself-conflict\u201d, we utilize off-the-shelf VFMs to generate semantic labels for weakly-supervised pixel-to-point contrastive distillation. 2) We introduce semantic-guided consistency regularization to cultivate a meaningful and structured feature space. 3) We develop an innovative sampling strategy for point-pixel pairs that considers both the category frequency and spatial density of points. ", "page_idx": 1}, {"type": "text", "text": "2 Related Work ", "text_level": 1, "page_idx": 1}, {"type": "text", "text": "3D Representation Learning. Recent advancements in 3D self-supervised learning have closely paralleled innovations in the image domain, extending these methods to diverse 3D contexts such as object-level point clouds [49, 60, 23], indoor scenes [61, 12, 81, 68, 9, 32, 69, 58], and outdoor settings [34, 4, 71, 42, 18]. These techniques are grounded in contrastive learning [66, 71, 42], mask modeling [72], and other pretext tasks [4, 76]. PPKT [39] utilized the InfoNCE loss to facilitate the 3D network in distilling rich knowledge from the 2D image backbone. Sautier et al.[50] pioneered a superpixelto-superpoint contrastive loss for self-supervised 2D-to-3D representation distillation. ", "page_idx": 1}, {"type": "image", "img_path": "63xeWav1lU/tmp/a201617033ba2cf6598e6d932fa8429fc02aba2634066a7a717c13d9d16f671c.jpg", "img_caption": ["Figure 2: The overall pipeline of our proposed OLIVINE. The pipeline starts with feature extraction via a trainable 3D backbone and a pre-trained 2D backbone, followed by feature alignment in a common space. The learning is driven by weakly-supervised contrastive distillation with coarse semantic labels, self-supervised distillation of randomly sampled point-pixel pairs, and semantic consistency regularization through the von Mises-Fisher distribution. Besides, our approach is also characterized by the novel sampling strategy of point-pixel pairs addressing spatial and category distribution imbalances. "], "img_footnote": [], "page_idx": 2}, {"type": "text", "text": "Building on this, Mahmoud et al. [41] enhanced the approach by incorporating a semantically tolerant contrastive constraint and a class-balancing loss. Liu et al.[38] further refined these techniques through semantic-aware spatial and temporal consistency regularization, advancing feature learning. Moreover, Zhang et al. [73] explored cross-modality contrastive distillation across not only the image plane but also the bird-eye views. ", "page_idx": 2}, {"type": "text", "text": "Visual Foundation Models. The advent of powerful visual neural networks, trained on extensive datasets [46, 27] or through cutting-edge self-supervised learning techniques [7, 11, 21], catalyzed significant advancements within the community. Notably, the Segment Anything Model (SAM) [27] initiated a new paradigm in general-purpose image segmentation, demonstrating remarkable zero-shot transfer capabilities across a variety of downstream tasks. Building on this, Grounded-SAM [47] enhanced the model by incorporating elements from Grounding-DINO [37], an open-set object detector capable of recognizing and classifying previously unseen objects during training [37]. In our work, we leverage the inherent semantic awareness of these VFMs [84] to generate weak semantic labels, which are crucial for our supervised contrastive distillation framework. ", "page_idx": 2}, {"type": "text", "text": "3D Scene Understanding. Traditional approaches to 3D scene understanding primarily utilize paradigms based on raw points [55, 16, 8, 62], voxels [17, 13], range views [29, 56], and multi-view fusion [19, 67]. Despite the effectiveness of these methods in capturing detailed environmental features, they are significantly constrained by their dependence on large-scale annotated data. Acquiring and annotating this data is both time-consuming and costly, limiting the scalability of 3D segmentation models [36]. To reduce the reliance on large annotated datasets, recent studies have also turned to semi-supervised [31, 22], weakly-supervised [35, 15], and active learning techniques [40, 65]. ", "page_idx": 2}, {"type": "text", "text": "3 Proposed Method ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "Overview. As depicted in Fig. 2, our method, namely OLIVINE, integrates a visual foundation model for pre-training with paired point clouds and images. Feature extraction is conducted using a trainable 3D backbone for point clouds and a pre-trained 2D backbone for images, with these features then mapped into a common feature space via decoupled projection heads for both point-pixel level and category-level contrastive distillation. The representation learning in OLIVINE is driven by three objectives: weakly-supervised contrastive distillation using coarse semantic labels to identify positive pairs by category, self-supervised contrastive distillation applied to randomly sampled point-pixel pairs, and a regularization framework based on the von Mises-Fisher distribution to ensure semantic consistency. Additionally, we address imbalances in spatial distribution and category frequency through a targeted sampling strategy, ensuring a balanced representation in the learning process. ", "page_idx": 2}, {"type": "text", "text": "Notation. Let $P=\\{p_{1},p_{2},...,p_{N}|p_{i}\\in\\mathbb{R}^{3}\\}$ be a point cloud consisting of $N$ points collected by a LiDAR sensor, and $\\mathcal{T}=\\{I_{c}\\vert\\vert\\;c=1,...,N_{\\mathrm{cam}}\\}$ multi-view images captured by $N_{\\mathrm{cam}}$ synchronized cameras, where $I_{c}\\in\\mathbb{R}^{H\\times W\\times3}$ is a single image with height $H$ and width $W$ . ", "page_idx": 2}, {"type": "text", "text": "3.1 Baseline Architecture ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "We follow the existing work [39] to perform the basic point-to-pixel contrastive distillation, based on which we build our whole pipeline. Starting with point cloud and image inputs, we employ distinct encoders for feature extraction. The 3D features are extracted using an encoder $f_{\\mathrm{{3D}}}(\\cdot):\\dot{\\mathbb{R}}^{N\\times3}\\rightarrow$ $\\mathbb{R}^{N\\times C_{3\\mathrm{D}}}$ , which processes the point clouds to produce features of dimension $\\ensuremath{C_{\\mathrm{3D}}}$ per point. For image features, we use an encoder $f_{2D}(\\cdot)\\,:\\mathbb{R}^{\\bar{H}\\times W\\times3}\\,\\rightarrow\\,\\mathbb{R}^{H^{\\prime}\\times W^{\\prime}\\times C_{2\\mathrm{D}}}$ , initialized with weights from pre-trained image models. This setup facilitates knowledge transfer from the 2D domain to the 3D domain through contrastive learning. For the computation of contrastive loss, we design trainable projection heads, $h_{\\mathrm{2D}}^{\\mathrm{pp}}$ for 2D features and $h_{\\mathrm{3D}}^{\\mathrm{pp}}$ for 3D features, bpopth aligning the features into a unified dimensional space. Specifically, the 3D projection head $h_{\\mathrm{3D}}^{\\mathrm{pp}}$ is a linear layer with $\\ell_{2}$ -normalization, converting 3D features to a normalized $C$ -dimensional space. Similarly, the 2D projection head h2ppD , a convolution layer with a $1\\!\\times\\!1$ kernel followed by a bi-linear interpolation layer adjusting the spatial dimensions by a factor of 4, also applies $\\ell_{2}$ -normalization. ", "page_idx": 3}, {"type": "text", "text": "Utilizing the calibration matrix, we establish dense point-to-pixel correspondences $\\{\\boldsymbol{F}_{i}^{\\mathrm{3D}},\\boldsymbol{F}_{i}^{\\mathrm{2D}}\\}_{i=1}^{M}$ , where $F_{i}^{\\mathrm{3D}}$ and $F_{i}^{\\mathrm{2D}}$ represent the paired features of points and images for the $i$ -th pair, with $M$ denoting the total count of such valid pairs. Previous methods achieve cross-modal knowledge transfer by attracting positive pairs and repelling negative pairs within the feature space, employing the InfoNCE loss [43]. The point-pixel level contrastive loss is defined as ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\mathcal{L}_{\\mathrm{PPNCE}}=-\\frac{1}{M_{s}}\\!\\sum_{i=1}^{M_{s}}\\log\\left[\\frac{\\exp(\\langle F_{i}^{\\mathrm{3D}},F_{i}^{\\mathrm{2D}}\\rangle/\\tau)}{\\sum_{j=1}^{M_{s}}\\exp(\\langle F_{i}^{\\mathrm{3D}},F_{j}^{\\mathrm{2D}}\\rangle/\\tau)}\\right]\\!,\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "where $\\tau$ is the temperature factor, $M_{s}$ is the number of sampled corresponding point-pixel pairs, $\\langle\\cdot,\\cdot\\rangle$ denotes the scalar product measure the similarity between features. ", "page_idx": 3}, {"type": "text", "text": "3.2 Weakly-supervised Contrastive Distillation ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "Existing methods [39, 50, 38] often mistakenly treat unmatched points and pixels that share semantic labels as negative pairs. This practice overlooks the intrinsic semantic connections within the same categories, leading to potential conflicts in the learning process where beneficial relationships are ignored. To address this, we utilize the Segment Anything Model, which adeptly interprets and translates semantic cues from text prompts into precise semantic segmentation of images. This application of SAM allows us to generate high-quality semantic labels without repetitive training, enhancing the learning process. We represent these labels as $Y^{\\mathrm{co}}\\,=\\,\\{y_{i}^{\\mathrm{co}}\\}_{i=1}^{M}$ , where each label corresponds to a specific point-pixel pair. ", "page_idx": 3}, {"type": "text", "text": "In point-pixel level contrastive loss, the pixels that belong to the same category but do not correspond to the given anchor point are taken as negative samples (see Eq. (1)). Therefore, we argue that the 2D and 3D features used for weakly-supervised contrastive learning, which take the category information into consideration, should differ from the features $F^{\\mathrm{3D}}$ and $F^{\\mathrm{2D}}$ that represent the individual points and pixels. To address this issue, we apply another two heads $h_{\\mathrm{2D}}^{\\mathrm{sem}}:\\bar{\\mathbb{R}}^{H^{\\prime}\\times W^{\\prime}\\times C_{\\mathrm{2D}}}\\rightarrow\\mathbb{R}^{H\\times W\\times C}$ and $\\mathbf{\\bar{\\mathit{h}}}_{\\mathrm{3D}}^{\\mathrm{sem}}:\\mathbb{R}^{N\\times C_{\\mathrm{3D}}}\\rightarrow\\mathbb{R}^{N\\times C}$ to extract the semantic-level feature embeddings $G^{\\mathrm{2D}}$ and $G^{\\mathrm{3D}}$ . ", "page_idx": 3}, {"type": "text", "text": "For the sampled points and pixels, we use their semantic labels to identify positive and negative pairs. Positive pairs are defined as point and pixel features that share the same semantic label, whereas negative pairs are those with different labels [26]. The weakly-supervised contrastive loss is defined as ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\mathcal{L}_{\\mathrm{sup}}=-\\frac{1}{M_{s}}\\sum_{i=1}^{M_{s}}\\log\\left[\\frac{1}{|A(i)|}\\sum_{a\\in A(i)}\\frac{\\exp(\\langle G_{i}^{\\mathrm{3D}},G_{a}^{\\mathrm{2D}}\\rangle/\\tau)}{\\sum_{j=1}^{M_{s}}\\exp(\\langle G_{i}^{\\mathrm{3D}},G_{j}^{\\mathrm{2D}}\\rangle/\\tau)}\\right],\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "where $A(i)$ denotes the set of indices of matched point-to-pixel pairs in the batch that have the same class with $i$ -th point-pixel pair, and $|A(i)|$ indicates its cardinality. ", "page_idx": 3}, {"type": "text", "text": "3.3 Semantic-guided Consistency Regularization ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "We advocate that the construction of latent semantic structures in feature space could enhance representation learning. By leveraging semantic labels derived from SAM inference, we organize points with identical semantic labels into coherent groups. This grouping promotes feature consistency within these semantic categories, thereby stabilizing the learning of feature representations across varied data instances and yielding structured feature space. ", "page_idx": 3}, {"type": "text", "text": "Distribution Assumption. Intuitively, the point features extracted by the projection head $h_{\\mathrm{3D}}^{\\mathrm{sem}}$ from the same class should exhibit similarity in the feature space. For the purposes of contrastive learning, these features are normalized to exist on the unit hypersphere. Consequently, we model the point features of each class $k$ as a von Mises-Fisher (vMF) distribution $\\operatorname{vMF}(z;\\mu_{k},\\kappa_{k})$ . This distribution is a spherical adaptation of the normal distribution, suitable for data constrained to a hypersphere [33]. Here, $\\mu_{k}$ represents the mean direction, while $\\kappa_{k}$ is the concentration parameter, indicating the degree to which category features are concentrated around $\\mu_{k}$ . The probability density function for the vMF distribution, applicable to a random $C$ -dimensional unit vector $_{z}$ , is formulated as follows: ", "page_idx": 4}, {"type": "equation", "text": "$$\nf_{C}(z;\\mu_{k},\\kappa_{k})={\\cal K}_{C}(\\kappa_{k})\\exp(\\kappa_{k}\\mu_{k}^{\\top}z),\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "where $\\kappa\\geq0$ and $\\|\\mu\\|_{2}=1$ . The normalization constant $\\displaystyle\\mathcal{\\kappa}_{C}(\\kappa)$ is defined as: ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\mathcal{K}_{C}(\\kappa_{k})=\\frac{\\kappa_{k}^{C/2-1}}{(2\\pi)^{C/2}\\mathcal{Z}_{(C/2-1)}(\\kappa_{k})},\n$$", "text_format": "latex", "page_idx": 4}, {"type": "equation", "text": "$$\n\\mathcal{Z}_{(C/2-1)}(x)=\\sum_{m=0}^{\\infty}\\frac{1}{m!\\Gamma(C/2-1+m+1)}\\left(\\frac{x}{2}\\right)^{2m+C/2-1},\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "where $\\mathcal{T}_{(C/2-1)}$ is the modified Bessel function of the first kind at order $C/2-1$ . The distribution exhibits a higher concentration around the mean direction $\\mu_{k}$ as $\\kappa_{k}$ increases, and becomes uniform on the hypersphere when $\\kappa_{k}=0$ . ", "page_idx": 4}, {"type": "text", "text": "Parameter Updating. Specifically, we conduct the semantic-guided consistency regularization in a two-stage framework. First, we update the parameter of $\\operatorname{vMF}(z;\\mu_{k},\\kappa_{k}))$ with the features $G^{\\mathrm{3D}}$ extracted from point cloud branch. During training, we obtain the statistical value of feature embeddings via the EMA (Exponential Moving Average) algorithm, following: ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\bar{z}_{k}^{t}=\\alpha\\bar{z}_{k}^{t-1}+(1-\\alpha)\\bar{z}_{k}^{\\prime t},\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "where $\\begin{array}{r}{\\bar{z}_{k}^{\\prime t}=\\frac{1}{M_{k}}\\sum_{i=1}^{M}\\mathbf{1}_{\\{y_{i}^{\\mathrm{co}}=k\\}}G_{i}^{\\mathrm{3D}}}\\end{array}$ denotes the sample mean of class $k$ at $t$ -th mini-batch, $\\alpha$ is the fixed smoothness coefficient. The maximum likelihood estimates of the mean direction $\\mu_{k}$ is simply the normalized arithmetic mean: ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\mu_{k}=\\bar{z}_{k}/\\bar{R}_{k},\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "where $\\bar{R}_{k}\\,=\\,||\\bar{z}_{k}||$ . And the concentration parameter $\\kappa_{k}$ could be obtained by the solving the equation: ", "page_idx": 4}, {"type": "equation", "text": "$$\nA_{C}(\\kappa)=\\bar{R}_{k},\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "where $A_{C}(\\kappa)=\\ensuremath{\\mathcal{Z}}_{C/2}(\\kappa)/\\ensuremath{\\mathcal{Z}}_{C/2-1}(\\kappa)$ . Sra [52] proposed a simple method to estimate the $\\kappa_{k}$ : ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\hat{\\kappa}_{k}=\\frac{\\bar{R}_{k}(C-\\bar{R}_{k}^{2})}{1-\\bar{R}_{k}^{2}}.\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "And we model the features of each observed point as a Spherical Dirac Delta distribution during training: ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\delta(z-\\pmb{G}_{i}^{\\mathrm{3D}})=\\left\\{\\begin{array}{l l}{0,}&{z\\neq\\pmb{G}_{i}^{\\mathrm{3D}}}\\\\ {\\infty,}&{z=\\pmb{G}_{i}^{\\mathrm{3D}}}\\end{array}\\right.\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "Loss Function of Regularization. At the second step, we could perform the semantic-guided consistency regularization by pulling the points features and distribution of its corresponding category $\\mathrm{vMF}(z;\\bar{\\mu_{k}},\\bar{\\kappa_{k}})$ with Kullback-Leibler (KL) Divergence loss: ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\begin{array}{l}{{\\displaystyle\\gimel_{\\mathrm{kl}}=\\frac{1}{M}\\sum_{i=1}^{M}D_{\\mathrm{KL}}(\\delta(z-G_{i}^{3\\mathrm{D}})||\\mathrm{vMF}(z;\\mu_{k},\\kappa_{k}))=\\frac{1}{M}\\sum_{i=1}^{M}\\sum_{k=1}^{K}\\mathbf{1}_{\\{y_{i}^{\\mathrm{co}}=k\\}}-\\log f_{C}(G_{i}^{3\\mathrm{D}};\\mu_{k},\\kappa_{k})}}\\\\ {{\\displaystyle\\quad=\\frac{1}{M}\\sum_{i=1}^{M}\\sum_{k=1}^{K}\\mathbf{1}_{\\{y_{i}^{\\mathrm{co}}=k\\}}-\\log K_{C}(\\kappa_{k})-\\kappa_{k}\\mu_{k}^{\\top}G_{i}^{3\\mathrm{D}}.}}\\end{array}\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "In summary, the overall loss function for pre-training is written as $\\mathcal{L}=\\lambda_{1}\\mathcal{L}_{\\mathrm{PPNCE}}+\\lambda_{2}\\mathcal{L}_{\\mathrm{sup}}+\\lambda_{3}\\mathcal{L}_{\\mathrm{kl}}$ , where $\\lambda_{1},\\lambda_{2}$ , and $\\lambda_{3}$ are the weights to balance the three terms. ", "page_idx": 4}, {"type": "text", "text": "3.4 Density and Category-aware Sampling Strategy ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "Previous methods [39] neglect the spatial distribution and category frequency imbalances in the sampling of point-pixel pairs for contrastive distillation. To overcome these challenges, we introduce a novel sampling strategy that utilizes both the distance of each point from the LiDAR sensor and the occurrence frequency of its category. First, we calculate the distance of each point in the point cloud from the LiDAR sensor. We then apply kernel density estimation (KDE) to these distances to determine the probability density function of the spatial distribution of points. Given a point, its density can be calculated using the formula based on its distance $d$ from the LiDAR sensor: ", "page_idx": 5}, {"type": "equation", "text": "$$\nf_{\\mathrm{h}}(d)=\\frac{1}{M h}\\sum_{i=1}^{M}K_{h}\\left(\\frac{d-d_{i}}{h}\\right),\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "where $d_{i}$ denotes the distance of point $p_{i}$ from the LiDAR sensor, $h$ is the bandwidth, $K_{h}$ is the kernel function. This density estimation helps us understand how densely points are distributed with respect to their distance from the sensor, which is crucial for addressing areas of high point concentration that may bias the learning process. ", "page_idx": 5}, {"type": "text", "text": "Simultaneously, we assess the frequency of each category in the valid point-pixel pairs. By counting the occurrences of each category, we can identify which categories are underrepresented or overrepresented in the dataset. ", "page_idx": 5}, {"type": "text", "text": "Combining these two dimensions of analysis, we define the sampling probability for each point as inversely proportional to both its KDE-derived density and its category occurrence frequency. Mathematically, the sampling probability for a point $p_{i}$ is given by: ", "page_idx": 5}, {"type": "equation", "text": "$$\n\\rho(p_{i})=1/(f_{\\mathrm{h}}(d_{i})\\times|A(i)|).\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "By implementing this sampling strategy, we aim to ensure a more uniform representation of both spatial and categorical dimensions in our contrastive learning setup. This method reduces the risk of overftiting to dense clusters of points or to frequently occurring categories, thereby fostering a more robust and generalizable representation learning. ", "page_idx": 5}, {"type": "text", "text": "4 Experiments ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "4.1 Transfer on Semantic Segmentation ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "Evaluation Protocol. We evaluate the learned representations for semantic segmentation on nuSceneslidarseg and SemanticKITTI datasets. The nuScenes-lidarseg and SemanticKITTI datasets contain 16 and 19 semantic categories for validation, respectively. We modify the network by adding a 3D convolutional layer to the pre-trained backbone as the segmentation head. Basically, we finetune the whole network on different portions of annotated data. Following previous works [50, 41], we finetune the network for 100 epochs with a batch size of 10 and 16 on SemanticKITTI and nuSceneslidarseg, respectively. The initial learning rate of the backbone and the segmentation head are set to 0.05 and 2.0, respectively. When utilizing $1\\%$ of the annotated data, the network is fine-tuned for 100 epochs, whereas for other percentages, it is fine-tuned for 50 epochs. In another protocol, we evaluate the quality of learned representation by linear probing. Different from the setting of finetuning, we optimize only the added segmentation head and keep the weights of backbone $f_{\\mathrm{{3D}}}$ frozen on the ", "page_idx": 5}, {"type": "table", "img_path": "63xeWav1lU/tmp/df4a346b88614fe76c17fd57590db13a91150e21343e8efa3d8aac0847eff77a.jpg", "table_caption": ["Table 1: Comparison of various pre-training techniques for semantic segmentation tasks using either finetuning or linear probing (LP). This evaluation uses different proportions of accessible annotations from the nuScenes or SemanticKITTI datasets and presents the mean Intersection over Union (mIoU) scores on the validation set. "], "table_footnote": [], "page_idx": 5}, {"type": "image", "img_path": "63xeWav1lU/tmp/3b6ea51506ad8df3060b89b0dcfab077b2c73a49938e6e19e0e07c954ee0c0c7.jpg", "img_caption": [], "img_footnote": [], "page_idx": 6}, {"type": "text", "text": "Figure 3: The visual results of various point cloud pretraining strategies, pre-trained on nuScenes and fine-tuned using merely $1\\%$ of annotated data, are displayed. To illustrate the distinctions, we mark correctly predicted areas in gray color and incorrect ones in red. ", "page_idx": 6}, {"type": "table", "img_path": "63xeWav1lU/tmp/d282a723a45e017e47536ffbb08eba72bf33d5bf6705af516ac1905a8486dfbf.jpg", "table_caption": ["Table 2: Finetuning results on SemanticKITTI across various percentages of annotated data. The table compares the improvement achieved by our method relative to the SLidR [50]. "], "table_footnote": [], "page_idx": 6}, {"type": "text", "text": "nuScenes-lidarseg dataset. For both protocols, the training objective is a linear combination of the cross-entropy loss and the Lov\u00e1sz-Softmax loss [3]. ", "page_idx": 6}, {"type": "text", "text": "Results of Linear Probing. Under the linear probing scenario, our method achieves the highest mIoU of $50.09\\%$ , surpassing the previous state-of-the-art method, Seal [38], which records a mIoU of $44.95\\%$ (see Table 1). This performance indicates a significant improvement in extracting useful features directly from pre-trained models without additional training of the 3D backbone. ", "page_idx": 6}, {"type": "text", "text": "Results of Fine-tuning. For the fine-tuning on nuScenes, our consistently excel, particularly at smaller data proportions. With only $1\\%$ of the training data of the nuScenes, our method achieves a mIoU of $50.58\\%$ . This trend persists across other data proportions, with our method consistently leading or closely competing with the best results, particularly at $60.19\\%$ mIoU with $5\\%$ of the data and $65.01\\%$ mIoU with $10\\%$ of the data. The qualitative results are presented in Fig. 3. ", "page_idx": 6}, {"type": "text", "text": "We also fine-tuned various models on the SemanticKITTI dataset to assess their performance across a spectrum of annotated data availability, from as low as $1\\%$ to full data utilization (see Table 2). Besides, as shown in Table 3, our method consistently achieves state-of-the-art performance on another six datasets. ", "page_idx": 6}, {"type": "text", "text": "4.2 Transfer on 3D Object Detection ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "Evaluation Protocol. In evaluating our pre-trained model for 3D object detection, we utilized two prominent architectures: SECOND [70] and PV-RCNN [51]. Both are built on the VoxelNet 3D backbone [82], which processes voxels via 3D sparse convolutions and includes a 2D backbone for bird\u2019s-eye-view encoding after BEV projection. The primary distinction between the architectures is in their detection heads. SECOND uses a region proposal network (RPN) directly on the 2D backbone, while PV-RCNN refines RPN predictions with fine-grained keypoint features, enhancing bounding box accuracy and confidence in estimations. ", "page_idx": 6}, {"type": "table", "img_path": "63xeWav1lU/tmp/cc78567a7563d09c5a3933048c93ab23ba0abf591b3f8f195898b04b27773c0f.jpg", "table_caption": ["Table 3: Evaluation of various pretraining methods initially trained on the nuScenes dataset and subsequently fine-tuned on multiple downstream point cloud datasets. The mIoU scores are presented as percentages $(\\%)$ . "], "table_footnote": [], "page_idx": 6}, {"type": "table", "img_path": "63xeWav1lU/tmp/262c3affd27d826e6801d4d3e6e2ad82e5da78389c5a0e85d866be64de78332e.jpg", "table_caption": ["Table 4: Comparison of our method with other pre-training techniques through fine-tuning on the KITTI dataset. The results reflect the 3D object detection performance under moderate difficulty on the validation set. "], "table_footnote": [], "page_idx": 7}, {"type": "text", "text": "", "page_idx": 7}, {"type": "text", "text": "In the fine-tuning stage, we integrate the detection head of SECOND or PV-RCNN with the pre-trained backbone (VoxelNet). This integrated detector is then fine-tuned on the train data of KITTI [20], which includes implementations of these detectors and follows the standard training parameters specified by OpenPCDet [54]. We conduct the fine-tuning three separate times, and report the highest mean Average Precision (mAP) recorded on the KITTI validation set. ", "page_idx": 7}, {"type": "text", "text": "Results. The experimental results detailed in Table 4 showcase the performance of various initialization strategies. When using the SECOND architecture, our method outperforms other pre-training techniques. Starting from a baseline with random initialization, the performance improves consistently with more specialized pre-trained weights like PPKT and SLidR, and ultimately, our method achieves the highest mAP at $68.3\\%$ . Significant gains are observed across all categories, with particularly notable improvements in detecting pedestrians and cyclists. Similarly, the PV-RCNN architecture beneftis from refined initialization methods. Our method again yields the highest overall mAP $@40$ at $72.8\\%$ , surpassing the performance of SLidR. ", "page_idx": 7}, {"type": "text", "text": "Remark. Compared to the semantic segmentation task, the model architecture for object detection is more complex. Besides the 3D backbone, 3D detectors typically project features to a BEV plane, followed by a 2D convolutional network and RoI operations. These crucial components were not pre-trained, which may limit the overall performance gain from our pre-training approach. It\u2019s important to note that semantic segmentation and object detection use different metrics and scales, making direct performance comparisons improper. The nature of these tasks and their evaluation criteria inherently lead to varying degrees of improvement when applying our proposed method. ", "page_idx": 7}, {"type": "table", "img_path": "63xeWav1lU/tmp/9f9258237c77d28dcff3d1c2853fc7c3e1cf6cd3667bd3ad8566d81fb15fd9b7.jpg", "table_caption": ["Table 5: Ablation study of each component pre-trained on nuScenes and fine-tuned on nuSceneslidarseg and SemanticKITTI. WCD: Weakly-supervised Contrastive Distillation. SCR: Sematicguided Consistency Regularization. DCAS: Denstiy and Category-aware Sampling. "], "table_footnote": [], "page_idx": 7}, {"type": "text", "text": "4.3 Ablation Studies ", "text_level": 1, "page_idx": 7}, {"type": "text", "text": "Effect of Key Components. In Table 5, we investigate the effect of each added component in our method. The integration of Weakly-supervised Contrastive Distillation alone yields a significant increase in performance, improving mIoU by $5.23\\%$ for linear probing. Similarly, incorporating Sematic-guided Consistency Regularization also enhances model performance, delivering a $3.71\\%$ increase in mIoU. When these components are combined, they synergistically contribute to a further mIoU gain of $7.89\\%$ for linear probing. Additionally, the application of Denstiy and Category-aware ", "page_idx": 7}, {"type": "text", "text": "Table 6: Comprehensive ablation studies for the key components. We report the fine-tuned results on nuScenes-lidarseg and SemanticKITTI (S.K.) datasets with $1\\%$ of the labeled data. ", "page_idx": 8}, {"type": "table", "img_path": "63xeWav1lU/tmp/b120369c43fd4b7221a70f33bdef90811410aa72b50dab5671b37cfb59b0ee25.jpg", "table_caption": [], "table_footnote": [], "page_idx": 8}, {"type": "table", "img_path": "63xeWav1lU/tmp/d79b2b39c3b4e75e95395f53caf01e6329d53b09c6d6756d3fb40bfd022783f2.jpg", "table_caption": ["(a) Different types of supervision utilized for con- (c) Different distributions to model semantic features. trastive distillation. "], "table_footnote": [], "page_idx": 8}, {"type": "table", "img_path": "63xeWav1lU/tmp/b67fd6a60f92242d98d044414647acf2558958a49ecf50ab2c08f6de734eaee1.jpg", "table_caption": ["(b) Different architectures of projection heads. "], "table_footnote": [], "page_idx": 8}, {"type": "table", "img_path": "63xeWav1lU/tmp/bf1495b728ca6d1141d0009f59de3926f4fc2c7cdc261520b75177ebede40d16.jpg", "table_caption": ["(d) Different sampling strategies. "], "table_footnote": [], "page_idx": 8}, {"type": "text", "text": "Sampling independently provides a substantial performance boost. The culmination of integrating all proposed components results in the optimal model, achieving a mIoU improvement of $10.43\\%$ for linear probing. This comprehensive analysis underscores the effectiveness of each component and their collective impact in enhancing the model\u2019s segmentation capabilities. ", "page_idx": 8}, {"type": "text", "text": "Potential of Supervised Contrastive Distillation. As mentioned in Section. 3, we perform weaklysupervised contrastive distillation with the pseudo-labels predicted by SAM. With the free and available models, our method learns effective 3D representations. When we replace the weak labels with the ground truth provided in nuScenes-lidarseg dataset, we can obtain a significant improvement in downstream tasks (see Table 6a). The results further demonstrate the effectiveness of supervision for cross-modal contrastive distillation and the potential of our pipeline with stronger VFMs. ", "page_idx": 8}, {"type": "text", "text": "Effect of the Decoupled Projection Heads. The experimental results outlined in Table 6b demonstrate the effectiveness of employing decoupled projection heads in our model. These results highlight a distinct performance enhancement when projection heads are specialized for distinct tasks \u2014 specifically, self-supervised and weakly-supervised contrastive distillation. On the nuScenes dataset, the implementation of decoupled projection heads results in a mIoU improvement of $3.53\\%$ , indicating a robust enhancement in the model\u2019s ability to generalize from the training data. Similarly, for the SemanticKITTI dataset, a gain of $1.89\\%$ in mIoU is observed, further substantiating the benefits of this architectural modification. ", "page_idx": 8}, {"type": "text", "text": "Effect of the vMF Distribution. The ablation study in Table 6c compares the use of deterministic (Dirac delta) and von Mises-Fisher (vMF) distributions for modeling semantic features of each class, demonstrating clear advantages with vMF on both nuScenes and SemanticKITTI datasets. Specifically, the vMF distribution, with its adjustable concentration parameter, provides a mIoU improvement of $1.97\\%$ on nuScenes and $1.37\\%$ on SemanticKITTI compared to the deterministic approach. The learned concentration parameter that represents the uncertainty helps in mitigating overfitting by providing robustness against inaccuracies in coarse semantic labels. ", "page_idx": 8}, {"type": "text", "text": "Effect of Different Sampling Strategies. In Table 6d, Category-aware and density-aware sampling determine the sampling probability of a point by its category frequency and distance information, respectively. These are part of a hybrid strategy we refer to as density and category-aware sampling. We found that the density and category-aware sampling strategy consistently achieves the best performance on downstream tasks. ", "page_idx": 8}, {"type": "text", "text": "4.4 Further Discussions ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "We would like to emphasize the uniqueness and advantages of our approach over existing ones: ", "page_idx": 8}, {"type": "text", "text": "\u2022 Previous works [39, 50, 41, 38, 73] have not solved the self-conflict problem properly. Especially, Seal [38] generates semantically coherent superpixels for distinct objects and backgrounds in the 3D scene. However, the superpoints and superpixels with the same category may still be mistakenly considered negative pairs during contrastive learning. By contrast, our method explicitly defines the points and pixels with the same semantic labels as positive pairs during weakly-supervised contrastive learning. ", "page_idx": 8}, {"type": "text", "text": "", "page_idx": 9}, {"type": "text", "text": "\u2022 Our pipeline performs knowledge distillation on two levels: self-supervised and weaklysupervised contrastive learning. To achieve this, we develop two different heads in both the image and point cloud branches to decouple the learned representation. Previous methods [39, 50, 41, 38, 73] have only attempted self-supervised contrastive distillation and have not explored using labels to guide contrastive distillation.   \n\u2022 The representation of samples in the same class can vary significantly across different batches during the contrastive distillation, so the model will struggle to learn stable semantic features. By making point features of the same class closely aligned, our method aims to create a more consistent and structured feature space.   \n\u2022 Existing methods [50, 41, 38, 73] are highly dependent on the generated superpixels. Superpixels balance asymmetries between areas with denser coverage of points and sparser areas in the contrastive loss. However, we do not need this process at all and ensure a uniform representation of both spatial and categorical dimensions by employing a novel sampling strategy.   \n\u2022 ST-SLidR [41] reduces the contribution of false negative samples based on superpixel-tosuperpixel similarity, using 2D self-supervised features to determine semantic similarities between superpixels. By contrast, our method directly estimates the semantic labels of images with VFMs, and defines pixels and points with the same label as positive pairs.   \n\u2022 The purposes of using VFMs in Seal and our method are completely different. To avoid oversegmenting semantically coherent areas, Seal generates superpixels using visual foundation models (VFMs) to replace the traditional method SLIC [1]. In contrast, our method does not rely on superpixels. Although we also use VFMs, we leverage them to obtain coarse semantic labels for fine-grained contrastive distillation. ", "page_idx": 9}, {"type": "text", "text": "4.5 Visualization and Analysis ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "The T-SNE visualization shown in Fig. 4 demonstrates the efficacy of our method in achieving a more discriminative and well-separated feature distribution for each category compared to the baseline model PPKT [39]. To some extent, each category forms a distinct cluster with our method, with relatively clear boundaries separating different classes. This enhanced clustering effect underscores the beneftis of our approach, which incorporates semantic supervision and applies semantic-guided consistency regular - ization during pre-training. ", "page_idx": 9}, {"type": "image", "img_path": "63xeWav1lU/tmp/467d9f3176c76d5130c18183ca4258cb110c40fce3d49bb53361085942d54b41.jpg", "img_caption": ["Figure 4: T-SNE visualization of the extracted point cloud features by PPKT and our OLIVINE (with head $h_{\\mathrm{3D}}^{\\mathrm{sem}}$ ). Each feature is colorized based on its groundtruth semantic labels on nuScenes dataset. "], "img_footnote": [], "page_idx": 9}, {"type": "text", "text": "5 Conclusion ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "We have introduced OLIVINE, a novel method that leverages visual foundation models for finegrained image-to-LiDAR knowledge transfer. The key ingredient of our method is utilizing the weak semantic labels generated from VFMs to avoid semantically similar negative samples and tackle the challenge of \u201cself-confilct\u201d challenges. We further exploit the semantic labels with semantic-guided consistency regularization, which makes embeddings of points in the same class remain consistent across varying inputs and yields structured feature space. Extensive experiments on various datasets confirm that our method achieves superior performance in downstream tasks compared to existing image-to-LiDAR contrastive distillation methods. ", "page_idx": 9}, {"type": "text", "text": "Acknowledgement ", "text_level": 1, "page_idx": 10}, {"type": "text", "text": "This work was supported in part by the National Natural Science Foundation of China Excellent Young Scientists Fund 62422118, and in part by the Hong Kong Research Grants Council under Grants 11219324 and 11219422. This work used the computational facilities provided by the Computing Services Centre at the City University of Hong Kong. Besides, we thank the anonymous reviewers for their invaluable feedback that improved our manuscript. ", "page_idx": 10}, {"type": "text", "text": "References ", "text_level": 1, "page_idx": 10}, {"type": "text", "text": "[1] Radhakrishna Achanta, Appu Shaji, Kevin Smith, Aurelien Lucchi, Pascal Fua, and Sabine S\u00fcsstrunk. Slic superpixels compared to state-of-the-art superpixel methods. IEEE Transactions on Pattern Analysis and Machine Intelligence, 34(11):2274\u20132282, 2012.   \n[2] Jens Behley, Martin Garbade, Andres Milioto, Jan Quenzel, Sven Behnke, Cyrill Stachniss, and Jurgen Gall. Semantickitti: A dataset for semantic scene understanding of lidar sequences. In Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 9297\u20139307, 2019.   \n[3] Maxim Berman, Amal Rannen Triki, and Matthew B Blaschko. The lov\u00e1sz-softmax loss: A tractable surrogate for the optimization of the intersection-over-union measure in neural networks. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 4413\u20134421, 2018.   \n[4] Alexandre Boulch, Corentin Sautier, Bj\u00f6rn Michele, Gilles Puy, and Renaud Marlet. Also: Automotive lidar self-supervision by occupancy estimation. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 13455\u201313465, 2023.   \n[5] S.R. Bowman, L. Vilnis, O. Vinyals, A.M. Dai, R. Jozefowicz, and S. Bengio. Generating sentences from a continuous space. In Proceedings of The 20th SIGNLL Conference on Computational Natural Language Learning, pages 10\u201321, 2016.   \n[6] Holger Caesar, Varun Bankiti, Alex H Lang, Sourabh Vora, Venice Erin Liong, Qiang Xu, Anush Krishnan, Yu Pan, Giancarlo Baldan, and Oscar Beijbom. nuscenes: A multimodal dataset for autonomous driving. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 11621\u2013 11631, 2020.   \n[7] Mathilde Caron, Hugo Touvron, Ishan Misra, Herv\u00e9 J\u00e9gou, Julien Mairal, Piotr Bojanowski, and Armand Joulin. Emerging properties in self-supervised vision transformers. In Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 9650\u20139660, 2021.   \n[8] Chen Chen, Zhe Chen, Jing Zhang, and Dacheng Tao. Sasa: Semantics-augmented set abstraction for pointbased 3d object detection. In Proceedings of the AAAI Conference on Artificial Intelligence, volume 36, pages 221\u2013229, 2022.   \n[9] Runnan Chen, Youquan Liu, Lingdong Kong, Xinge Zhu, Yuexin Ma, Yikang Li, Yuenan Hou, Yu Qiao, and Wenping Wang. Clip2scene: Towards label-efficient 3d scene understanding by clip. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 7020\u20137030, 2023.   \n[10] Xinlei Chen, Haoqi Fan, Ross Girshick, and Kaiming He. Improved baselines with momentum contrastive learning. arXiv preprint arXiv:2003.04297, 2020.   \n[11] Xinlei Chen, Saining Xie, and Kaiming He. An empirical study of training self-supervised vision transformers. In Proceedings of the IEEE/CVF International Conference on Computer Vision, 2021.   \n[12] Yujin Chen, Matthias Nie\u00dfner, and Angela Dai. 4dcontrast: Contrastive learning with dynamic correspondences for 3d scene understanding. In European Conference on Computer Vision, pages 543\u2013560, 2022.   \n[13] Yukang Chen, Jianhui Liu, Xiangyu Zhang, Xiaojuan Qi, and Jiaya Jia. Voxelnext: Fully sparse voxelnet for 3d object detection and tracking. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 21674\u201321683, 2023.   \n[14] Huixian Cheng, Xianfeng Han, and Guoqiang Xiao. Cenet: Toward concise and efficient lidar semantic segmentation for autonomous driving. In IEEE International Conference on Multimedia and Expo, pages 1\u20136, 2022.   \n[15] Julian Chibane, Francis Engelmann, Tuan Anh Tran, and Gerard Pons-Moll. Box2mask: Weakly supervised 3d semantic instance segmentation using bounding boxes. In European Conference on Computer Vision, pages 681\u2013699, 2022.   \n[16] Jaesung Choe, Chunghyun Park, Francois Rameau, Jaesik Park, and In So Kweon. Pointmixer: Mlp-mixer for point cloud understanding. In European Conference on Computer Vision, pages 620\u2013640. Springer, 2022.   \n[17] Jiajun Deng, Shaoshuai Shi, Peiwei Li, Wengang Zhou, Yanyong Zhang, and Houqiang Li. Voxel r-cnn: Towards high performance voxel-based 3d object detection. In Proceedings of the AAAI Conference on Artificial Intelligence, pages 1201\u20131209, 2021.   \n[18] Chaoqun Du, Yulin Wang, Shiji Song, and Gao Huang. Probabilistic contrastive learning for long-tailed visual recognition. IEEE Transactions on Pattern Analysis and Machine Intelligence, 2024.   \n[19] Sudeep Fadadu, Shreyash Pandey, Darshan Hegde, Yi Shi, Fang-Chieh Chou, Nemanja Djuric, and Carlos Vallespi-Gonzalez. Multi-view fusion of sensor data for improved perception and prediction in autonomous driving. In Proceedings of the IEEE/CVF Winter Conference on Applications of Computer Vision, pages 2349\u20132357, 2022.   \n[20] Andreas Geiger, Philip Lenz, and Raquel Urtasun. Are we ready for autonomous driving? the kitti vision benchmark suite. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 3354\u20133361, 2012.   \n[21] Kaiming He, Xinlei Chen, Saining Xie, Yanghao Li, Piotr Doll\u00e1r, and Ross Girshick. Masked autoencoders are scalable vision learners. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 16000\u201316009, 2022.   \n[22] Cheng-Ju Ho, Chen-Hsuan Tai, Yen-Yu Lin, Ming-Hsuan Yang, and Yi-Hsuan Tsai. Diffusion-ss3d: Diffusion model for semi-supervised 3d object detection. Advances in Neural Information Processing Systems, 36, 2024.   \n[23] Siyuan Huang, Yichen Xie, Song-Chun Zhu, and Yixin Zhu. Spatio-temporal self-supervised representation learning for 3d point clouds. In Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 6535\u20136545, 2021.   \n[24] Siyuan Huang, Yichen Xie, Song-Chun Zhu, and Yixin Zhu. Spatio-temporal self-supervised representation learning for 3d point clouds. In Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 6535\u20136545, 2021.   \n[25] Peng Jiang, Philip Osteen, Maggie Wigness, and Srikanth Saripallig. Rellis-3d dataset: Data, benchmarks and analysis. In IEEE International Conference on Robotics and Automation, pages 1110\u20131116, 2021.   \n[26] Prannay Khosla, Piotr Teterwak, Chen Wang, Aaron Sarna, Yonglong Tian, Phillip Isola, Aaron Maschinot, Ce Liu, and Dilip Krishnan. Supervised contrastive learning. Advances in Neural Information Processing Systems, 33:18661\u201318673, 2020.   \n[27] Alexander Kirillov, Eric Mintun, Nikhila Ravi, Hanzi Mao, Chloe Rolland, Laura Gustafson, Tete Xiao, Spencer Whitehead, Alexander C Berg, Wan-Yen Lo, et al. Segment anything. In Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 4015\u20134026, 2023.   \n[28] Alexey Klokov, Di Un Pak, Aleksandr Khorin, Dmitry Yudin, Leon Kochiev, Vladimir Luchinskiy, and Vitaly Bezuglyj. Daps3d: Domain adaptive projective segmentation of 3d lidar point clouds. Preprint, 2023.   \n[29] Lingdong Kong, Youquan Liu, Runnan Chen, Yuexin Ma, Xinge Zhu, Yikang Li, Yuenan Hou, Yu Qiao, and Ziwei Liu. Rethinking range view representation for lidar segmentation. In Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 228\u2013240, 2023.   \n[30] Lingdong Kong, Youquan Liu, Xin Li, Runnan Chen, Wenwei Zhang, Jiawei Ren, Liang Pan, Kai Chen, and Ziwei Liu. Robo3d: Towards robust and reliable 3d perception against corruptions. In Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 19994\u201320006, 2023.   \n[31] Lingdong Kong, Jiawei Ren, Liang Pan, and Ziwei Liu. Lasermix for semi-supervised lidar semantic segmentation. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 21705\u201321715, 2023.   \n[32] Lanxiao Li and Michael Heizmann. A closer look at invariances in self-supervised pre-training for 3d vision. In European Conference on Computer Vision, pages 656\u2013673, 2022.   \n[33] Shen Li, Jianqing Xu, Xiaqing Xu, Pengcheng Shen, Shaoxin Li, and Bryan Hooi. Spherical confidence learning for face recognition. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 15629\u201315637, 2021.   \n[34] Guibiao Liao, Jiankun Li, and Xiaoqing Ye. Vlm2scene: Self-supervised image-text-lidar learning with foundation models for autonomous driving scene understanding. In Proceedings of the AAAI Conference on Artificial Intelligence, volume 38, pages 3351\u20133359, 2024.   \n[35] Kunhao Liu, Fangneng Zhan, Jiahui Zhang, Muyu Xu, Yingchen Yu, Abdulmotaleb El Saddik, Christian Theobalt, Eric Xing, and Shijian Lu. Weakly supervised 3d open-vocabulary segmentation. Advances in Neural Information Processing Systems, 36:53433\u201353456, 2023.   \n[36] Minghua Liu, Yin Zhou, Charles R Qi, Boqing Gong, Hao Su, and Dragomir Anguelov. Less: Labelefficient semantic segmentation for lidar point clouds. In European Conference on Computer Vision, pages 70\u201389, 2022.   \n[37] Shilong Liu, Zhaoyang Zeng, Tianhe Ren, Feng Li, Hao Zhang, Jie Yang, Chunyuan Li, Jianwei Yang, Hang Su, Jun Zhu, et al. Grounding dino: Marrying dino with grounded pre-training for open-set object detection. arXiv preprint arXiv:2303.05499, 2023.   \n[38] Youquan Liu, Lingdong Kong, Jun Cen, Runnan Chen, Wenwei Zhang, Liang Pan, Kai Chen, and Ziwei Liu. Segment any point cloud sequences by distilling vision foundation models. Advances in Neural Information Processing Systems, 36, 2024.   \n[39] Yueh-Cheng Liu, Yu-Kai Huang, Hung-Yueh Chiang, Hung-Ting Su, Zhe-Yu Liu, Chin-Tang Chen, ChingYu Tseng, and Winston H Hsu. Learning from 2d: Contrastive pixel-to-point knowledge transfer for 3d pretraining. arXiv preprint arXiv:2104.04687, 2021.   \n[40] Yadan Luo, Zhuoxiao Chen, Zijian Wang, Xin Yu, Zi Huang, and Mahsa Baktashmotlagh. Exploring active 3d object detection from a generalization perspective. In The Eleventh International Conference on Learning Representations, 2023.   \n[41] Anas Mahmoud, Jordan SK Hu, Tianshu Kuai, Ali Harakeh, Liam Paull, and Steven L Waslander. Selfsupervised image-to-point distillation via semantically tolerant contrastive loss. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 7102\u20137110, 2023.   \n[42] Lucas Nunes, Rodrigo Marcuzzi, Xieyuanli Chen, Jens Behley, and Cyrill Stachniss. Segcontrast: 3d point cloud feature representation learning through self-supervised segment discrimination. IEEE Robotics and Automation Letters, 7(2):2116\u20132123, 2022.   \n[43] Aaron van den Oord, Yazhe Li, and Oriol Vinyals. Representation learning with contrastive predictive coding. arXiv preprint arXiv:1807.03748, 2018.   \n[44] Yancheng Pan, Biao Gao, Jilin Mei, Sibo Geng, Chengkun Li, and Huijing Zhao. Semanticposs: A point cloud dataset with large quantity of dynamic instances. In IEEE Intelligent Vehicles Symposium, pages 687\u2013693, 2020.   \n[45] Gilles Puy, Alexandre Boulch, and Renaud Marlet. Using a waffle iron for automotive point cloud semantic segmentation. In Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 3379\u20133389, 2023.   \n[46] Alec Radford, Jong Wook Kim, Chris Hallacy, Aditya Ramesh, Gabriel Goh, Sandhini Agarwal, Girish Sastry, Amanda Askell, Pamela Mishkin, Jack Clark, et al. Learning transferable visual models from natural language supervision. In International Conference on Machine Learning, pages 8748\u20138763. PMLR, 2021.   \n[47] Tianhe Ren, Shilong Liu, Ailing Zeng, Jing Lin, Kunchang Li, He Cao, Jiayu Chen, Xinyu Huang, Yukang Chen, Feng Yan, et al. Grounded sam: Assembling open-world models for diverse visual tasks. arXiv preprint arXiv:2401.14159, 2024.   \n[48] Olaf Ronneberger, Philipp Fischer, and Thomas Brox. U-net: Convolutional networks for biomedical image segmentation. In Medical Image Computing and Computer Assisted Intervention, pages 234\u2013241. Springer, 2015.   \n[49] Jonathan Sauder and Bjarne Sievers. Self-supervised deep learning on point clouds by reconstructing space. In Advances in Neural Information Processing Systems, volume 32, 2019.   \n[50] Corentin Sautier, Gilles Puy, Spyros Gidaris, Alexandre Boulch, Andrei Bursuc, and Renaud Marlet. Image-to-lidar self-supervised distillation for autonomous driving data. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 9891\u20139901, 2022.   \n[51] Shaoshuai Shi, Chaoxu Guo, Li Jiang, Zhe Wang, Jianping Shi, Xiaogang Wang, and Hongsheng Li. Pv-rcnn: Point-voxel feature set abstraction for 3d object detection. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 10529\u201310538, 2020.   \n[52] Suvrit Sra. A short note on parameter approximation for von mises-fisher distributions: and a fast implementation of i s (x). Computational Statistics, 27:177\u2013190, 2012.   \n[53] Haotian Tang, Zhijian Liu, Shengyu Zhao, Yujun Lin, Ji Lin, Hanrui Wang, and Song Han. Searching efficient 3d architectures with sparse point-voxel convolution. In European Conference on Computer Vision, pages 685\u2013702, 2020.   \n[54] OpenPCDet Development Team. Openpcdet: An open-source toolbox for 3d object detection from point clouds. https://github.com/open-mmlab/OpenPCDet, 2020.   \n[55] Hugues Thomas, Charles R Qi, Jean-Emmanuel Deschaud, Beatriz Marcotegui, Fran\u00e7ois Goulette, and Leonidas J Guibas. Kpconv: Flexible and deformable convolution for point clouds. In Proceedings of the IEEE/CVF international conference on computer vision, pages 6411\u20136420, 2019.   \n[56] Zhi Tian, Xiangxiang Chu, Xiaoming Wang, Xiaolin Wei, and Chunhua Shen. Fully convolutional onestage 3d object detection on lidar range images. Advances in Neural Information Processing Systems, 35:34899\u201334911, 2022.   \n[57] Ozan Unal, Dengxin Dai, and Luc Van Gool. Scribble-supervised lidar semantic segmentation. In IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 2697\u20132707, 2022.   \n[58] Chengyao Wang, Li Jiang, Xiaoyang Wu, Zhuotao Tian, Bohao Peng, Hengshuang Zhao, and Jiaya Jia. Groupcontrast: Semantic-aware self-supervised representation learning for 3d understanding. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, 2024.   \n[59] Feng Wang and Huaping Liu. Understanding the behaviour of contrastive loss. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 2495\u20132504, 2020.   \n[60] Hanchen Wang, Qi Liu, Xiangyu Yue, Joan Lasenby, and Matt J. Kusner. Unsupervised point cloud pre-training via occlusion completion. In Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 9782\u20139792, 2021.   \n[61] Ziyi Wang, Yongming Rao, Xumin Yu, Jie Zhou, and Jiwen Lu. Point-to-pixel prompting for point cloud analysis with pre-trained image models. IEEE Transactions on Pattern Analysis and Machine Intelligence, 46(06):4381\u20134397, 2024.   \n[62] Lintai Wu, Qijian Zhang, Junhui Hou, and Yong Xu. Leveraging single-view images for unsupervised 3d point cloud completion. IEEE Transactions on Multimedia, pages 1\u201314, 2023.   \n[63] Aoran Xiao, Jiaxing Huang, Dayan Guan, Fangneng Zhan, and Shijian Lu. Transfer learning from synthetic to real lidar point cloud for semantic segmentation. In AAAI Conference on Artificial Intelligence, pages 2795\u20132803, 2022.   \n[64] Aoran Xiao, Jiaxing Huang, Weihao Xuan, Ruijie Ren, Kangcheng Liu, Dayan Guan, Abdulmotaleb El Saddik, Shijian Lu, and Eric Xing. 3d semantic segmentation in the wild: Learning generalized models for adverse-condition point clouds. In IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 9382\u20139392, 2023.   \n[65] Binhui Xie, Shuang Li, Qingju Guo, Chi Liu, and Xinjing Cheng. Annotator: A generic active learning baseline for lidar semantic segmentation. Advances in Neural Information Processing Systems, 36, 2023.   \n[66] Saining Xie, Jiatao Gu, Demi Guo, Charles R Qi, Leonidas Guibas, and Or Litany. Pointcontrast: Unsupervised pre-training for 3d point cloud understanding. In European Conference on Computer Vision, pages 574\u2013591, 2020.   \n[67] Jianyun Xu, Ruixiang Zhang, Jian Dou, Yushi Zhu, Jie Sun, and Shiliang Pu. Rpvnet: A deep and efficient range-point-voxel fusion network for lidar point cloud segmentation. In Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 16024\u201316033, 2021.   \n[68] Mingye Xu, Mutian Xu, Tong He, Wanli Ouyang, Yali Wang, Xiaoguang Han, and Yu Qiao. Mm-3dscene: 3d scene understanding by customizing masked modeling with informative-preserved reconstruction and self-distilled consistency. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 4380\u20134390, 2023.   \n[69] Ryosuke Yamada, Hirokatsu Kataoka, Naoya Chiba, Yukiyasu Domae, and Tetsuya Ogata. Point cloud pretraining with natural 3d structures. In IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 21283\u201321293, 2022.   \n[70] Yan Yan, Yuxing Mao, and Bo Li. Second: Sparsely embedded convolutional detection. Sensors, 18(10):3337, 2018.   \n[71] Junbo Yin, Dingfu Zhou, Liangjun Zhang, Jin Fang, Cheng-Zhong Xu, Jianbing Shen, and Wenguan Wang. Proposalcontrast: Unsupervised pre-training for lidar-based 3d object detection. In European Conference on Computer Vision, pages 17\u201333, 2022.   \n[72] Xumin Yu, Lulu Tang, Yongming Rao, Tiejun Huang, Jie Zhou, and Jiwen Lu. Point-bert: Pre-training 3d point cloud transformers with masked point modeling. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 19313\u201319322, 2022.   \n[73] Sha Zhang, Jiajun Deng, Lei Bai, Houqiang Li, Wanli Ouyang, and Yanyong Zhang. Hvdistill: Transferring knowledge from images to point clouds via unsupervised hybrid-view distillation. International Journal of Computer Vision, pages 1\u201315, 2024.   \n[74] Yang Zhang, Zixiang Zhou, Philip David, Xiangyu Yue, Zerong Xi, Boqing Gong, and Hassan Foroosh. Polarnet: An improved grid representation for online lidar point clouds semantic segmentation. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 9601\u20139610, 2020.   \n[75] Yifan Zhang, Junhui Hou, and Yixuan Yuan. A comprehensive study of the robustness for lidar-based 3d object detectors against adversarial attacks. International Journal of Computer Vision, 132(5):1592\u20131624, 2024.   \n[76] Yifan Zhang, Siyu Ren, Junhui Hou, Jinjian Wu, and Guangming Shi. Self-supervised learning of lidar 3d point clouds via 2d-3d neural calibration. arXiv preprint arXiv:2401.12452, 2024.   \n[77] Yifan Zhang, Qijian Zhang, Junhui Hou, Yixuan Yuan, and Guoliang Xing. Unleash the potential of image branch for cross-modal 3d object detection. In Advances in Neural Information Processing Systems, volume 36, pages 51562\u201351583, 2023.   \n[78] Yifan Zhang, Qijian Zhang, Zhiyu Zhu, Junhui Hou, and Yixuan Yuan. Glenet: Boosting 3d object detectors with generative label uncertainty estimation. International Journal of Computer Vision, 131(12):3332\u20133352, 2023.   \n[79] Yifan Zhang, Zhiyu Zhu, Junhui Hou, and Dapeng Wu. Spatial-temporal graph enhanced detr towards multi-frame 3d object detection. IEEE Transactions on Pattern Analysis and Machine Intelligence, 2024.   \n[80] Zaiwei Zhang, Rohit Girdhar, Armand Joulin, and Ishan Misra. Self-supervised pretraining of 3d features on any point-cloud. In Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 10252\u201310263, 2021.   \n[81] Zhuoyang Zhang, Yuhao Dong, Yunze Liu, and Li Yi. Complete-to-partial 4d distillation for self-supervised point cloud sequence representation learning. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 17661\u201317670, 2023.   \n[82] Yin Zhou and Oncel Tuzel. Voxelnet: End-to-end learning for point cloud based 3d object detection. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 4490\u20134499, 2018.   \n[83] Xinge Zhu, Hui Zhou, Tai Wang, Fangzhou Hong, Yuexin Ma, Wei Li, Hongsheng Li, and Dahua Lin. Cylindrical and asymmetrical 3d convolution networks for lidar segmentation. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 9939\u20139948, 2021.   \n[84] Xueyan Zou, Jianwei Yang, Hao Zhang, Feng Li, Linjie Li, Jianfeng Wang, Lijuan Wang, Jianfeng Gao, and Yong Jae Lee. Segment everything everywhere all at once. Advances in Neural Information Processing Systems, 36, 2023. ", "page_idx": 10}, {"type": "text", "text": "", "page_idx": 11}, {"type": "text", "text": "", "page_idx": 12}, {"type": "text", "text": "", "page_idx": 13}, {"type": "text", "text": "", "page_idx": 14}, {"type": "text", "text": "A Appendix ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "In this appendix, we present the details omitted from the manuscript due to space constraints. The appendix is organized as follows: ", "page_idx": 15}, {"type": "text", "text": "\u2022 Section A.1: Theoretical justification for the application of the vMF distribution.   \n\u2022 Section A.2: Details of the dataset and evaluation metrics.   \n\u2022 Section A.3: Experimental setup of pre-training.   \n\u2022 Section A.4: More quantitative results.   \n\u2022 Section A.5: More qualitative results.   \n\u2022 Section A.6: Potential limitations of our method.   \n\u2022 Section A.7: Societal and environmental impact of our work.   \n\u2022 Section A.8: Public resources used in this work. ", "page_idx": 15}, {"type": "text", "text": "A.1 Theoretical Analysis ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "Proposition 1: The features of each class $k$ can be modeled as a von Mises-Fisher (vMF) distribution. This means that for class $k$ , the feature vectors $g_{i}$ lie on a unit hypersphere and are centered around a mean direction $\\mu_{k}$ with a concentration parameter $\\kappa_{k}$ . ", "page_idx": 15}, {"type": "text", "text": "Justification: To show that the features of each class can be effectively modeled by a vMF distribution, we use maximum likelihood estimation (MLE) to determine that the parameters $\\mu_{k}$ and $\\kappa_{k}$ are optimal for the given set of feature vectors. ", "page_idx": 15}, {"type": "text", "text": "For a set of $M_{k}$ feature vectors $\\{g_{i}\\}_{i=1}^{M_{k}}$ from class $k$ , the likelihood function for the vMF distribution is: ", "page_idx": 15}, {"type": "equation", "text": "$$\nL(\\mu_{k},\\kappa_{k})=\\prod_{i=1}^{M_{k}}f(g_{i};\\mu_{k},\\kappa_{k})=\\prod_{i=1}^{M_{k}}{\\cal K}_{C}(\\kappa_{k})\\exp(\\kappa_{k}\\mu_{k}^{T}g_{i})\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "Taking the natural logarithm of the likelihood function, we get the log-likelihood: ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\log L(\\mu_{k},\\kappa_{k})=\\sum_{i=1}^{M_{k}}\\log f(g_{i};\\mu_{k},\\kappa_{k})=M_{k}\\log K_{C}(\\kappa_{k})+\\kappa_{k}\\sum_{i=1}^{M_{k}}\\mu_{k}^{T}g_{i}\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "Substituting the expression for $\\displaystyle{\\mathcal{K}}_{C}(\\kappa_{k})$ , we get: ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\log L(\\mu_{k},\\kappa_{k})=M_{k}\\left[\\log\\left(\\frac{\\kappa_{k}^{C/2-1}}{(2\\pi)^{C/2}I_{C/2-1}(\\kappa_{k})}\\right)+\\frac{\\kappa_{k}}{M_{k}}\\sum_{i=1}^{M_{k}}\\mu_{k}^{T}g_{i}\\right]\n$$", "text_format": "latex", "page_idx": 15}, {"type": "equation", "text": "$$\n\\log L(\\mu_{k},\\kappa_{k})=M_{k}\\left[(C/2-1)\\log\\kappa_{k}-\\log I_{C/2-1}(\\kappa_{k})-\\frac{C}{2}\\log(2\\pi)+\\frac{\\kappa_{k}}{M_{k}}\\sum_{i=1}^{M_{k}}\\mu_{k}^{T}g_{i}\\right]\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "To maximize the log-likelihood, we normalize $\\mu_{k}$ by setting it to the normalized sum of the feature vectors: ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\mu_{k}=\\frac{\\sum_{i=1}^{M_{k}}g_{i}}{\\Vert\\sum_{i=1}^{M_{k}}g_{i}\\Vert}\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "The derivative of the log-likelihood with respect to $\\kappa_{k}$ is: ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\frac{\\partial\\log L(\\mu_{k},\\kappa_{k})}{\\partial\\kappa_{k}}=M_{k}\\left[\\frac{C/2-1}{\\kappa_{k}}-\\frac{I_{C/2}(\\kappa_{k})}{I_{C/2-1}(\\kappa_{k})}+\\frac{1}{M_{k}}\\sum_{i=1}^{M_{k}}\\mu_{k}^{T}g_{i}\\right]\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "Setting this derivative to zero, we get: ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\frac{C/2-1}{\\kappa_{k}}-\\frac{I_{C/2}(\\kappa_{k})}{I_{C/2-1}(\\kappa_{k})}+\\frac{1}{M_{k}}\\sum_{i=1}^{M_{k}}\\mu_{k}^{T}g_{i}=0\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "Solving for $\\kappa_{k}$ , we obtain: ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\kappa_{k}=\\frac{\\|\\sum_{i=1}^{M_{k}}g_{i}\\|(C-\\|\\sum_{i=1}^{M_{k}}g_{i}\\|^{2})}{1-\\|\\sum_{i=1}^{M_{k}}g_{i}\\|^{2}}\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "This equation allows us to compute the concentration parameter $\\kappa_{k}$ based on the alignment of the feature vectors. The concentration parameter $\\kappa_{k}$ is larger when the distribution is more tightly clustered around the mean direction, and smaller when the features are more uniformly spread across the hypersphere. ", "page_idx": 16}, {"type": "text", "text": "By maximizing the likelihood function for the vMF distribution, we have shown that the parameters $\\mu_{k}$ and $\\kappa_{k}$ can be estimated to model the distribution of feature vectors for each class. The mean direction $\\mu_{k}$ denotes the central direction of the feature cluster, and the concentration parameter $\\kappa_{k}$ controls the tightness of this clustering. Moreover, the way we estimate the parameters of vMF distribution in EMA is also consistent with the results of the above theoretical derivation. ", "page_idx": 16}, {"type": "text", "text": "Proposition 2: The representation of samples in the same class can vary significantly across different batches during contrastive distillation, and semantic-guided consistency regularization helps to learn structured features. ", "page_idx": 16}, {"type": "text", "text": "Justification: Without regularization, the representation of samples within the same class can vary significantly across different batches during contrastive distillation. This variance arises due to random sampling and the influence of negative samples in different batches. The weakly-supervised contrastive loss is defined as: ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\mathcal{L}_{\\mathrm{sup}}=-\\frac{1}{M_{s}}\\sum_{i=1}^{M_{s}}\\log\\left[\\frac{1}{|A(i)|}\\sum_{a\\in A(i)}\\frac{\\exp(\\langle G_{i}^{\\mathrm{3D}},G_{a}^{\\mathrm{2D}}\\rangle/\\tau)}{\\sum_{j=1}^{M_{s}}\\exp(\\langle G_{i}^{\\mathrm{3D}},G_{j}^{\\mathrm{2D}}\\rangle/\\tau)}\\right],\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "The features of negative samples $G_{j}^{\\mathrm{2D}}$ vary across batches, leading to different optimization paths for each mini-batch. This introduces variability in the learned representations $G_{i}^{\\mathrm{3D}}$ for samples of the same class $k$ . ", "page_idx": 16}, {"type": "text", "text": "When we do not use semantic-guided consistency regularization, the within-class variance for class $k$ across different batches is: ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\sigma_{W}^{2}=\\frac{1}{|B|}\\sum_{B}\\frac{1}{M_{k}}\\sum_{i=1}^{M_{k}^{B}}\\|g_{i}^{k}-\\mu_{k}^{B}\\|^{2}\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "For ease of reading, we use $g_{i}$ to refer to point feature $G_{i}^{\\mathrm{3D}}$ . And $\\mu_{k}^{B}$ is the mean feature vector for class $k$ in batch $B$ . Due to the batch-wise variability in negative samples, $\\mu_{k}^{B}$ can differ significantly across batches, leading to high within-class variance. ", "page_idx": 16}, {"type": "text", "text": "By minimizing the KL divergence, we align feature vectors $g_{i}$ of class $k$ with the mean direction $\\mu_{k}$ , reducing the spread of feature vectors within the same class. The within-class variance with regularization is: ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\sigma_{W}^{2}=\\frac{1}{K}\\sum_{k=1}^{K}\\frac{1}{M_{k}}\\sum_{i=1}^{M_{k}}\\|g_{i}^{k}-\\mu_{k}\\|^{2}\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "Since $\\mu_{k}$ is consistent across batches due to the regularization, the within-class variance is significantly reduced. This results in structured feature representations, enhancing class separability and improving performance in downstream tasks. ", "page_idx": 16}, {"type": "text", "text": "Proposition 3: Learning structural representation during pretraining can benefit downstream tasks. ", "page_idx": 17}, {"type": "text", "text": "Justification: Structured features are those well-aligned within the same class (low within-class variance $\\sigma_{W}^{2}$ ) and well-separated between different classes (high between-class variance $\\sigma_{B}^{2}$ ). ", "page_idx": 17}, {"type": "text", "text": "With semantic-guided consistency regularization, feature vectors $g_{i}^{k}$ for class $k$ are closely aligned with the mean direction $\\mu_{k}$ . This alignment reduces the within-class variance $\\sigma_{W}^{2}$ . Weakly-supervised contrastive learning pushes apart feature vectors of different classes, increasing the separation between class means $\\mu_{k}$ . This increases the between-class variance $\\sigma_{B}^{2}$ . ", "page_idx": 17}, {"type": "text", "text": "Take the linear classifier as an example, the decision boundary is determined by the separation between class means. Higher $\\sigma_{B}^{2}$ and lower $\\sigma_{W}^{2}$ result in clearer decision boundaries, reducing classification errors. ", "page_idx": 17}, {"type": "text", "text": "Consider a simple linear classifier with weight vector $w$ and bias $b$ . The decision function is: ", "page_idx": 17}, {"type": "equation", "text": "$$\nf(x)=w^{\\mathrm{T}}x+b\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "The decision boundary is given by: ", "page_idx": 17}, {"type": "equation", "text": "$$\nw^{\\mathrm{T}}x+b=0\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "For well-structured features, the margin (distance between decision boundary and nearest samples) is maximized. The margin $\\gamma$ for class $k$ can be expressed as: ", "page_idx": 17}, {"type": "equation", "text": "$$\n\\gamma={\\frac{w^{\\mathrm{T}}(\\mu_{k}-\\mu)}{\\|w\\|}}\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "Higher between-class variance $(\\sigma_{B}^{2})$ and lower within-class variance $(\\sigma_{W}^{2})$ increase this margin, leading to better classification performance. ", "page_idx": 17}, {"type": "text", "text": "A.2 Dataset and Evaluation Metric ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "NuScenes Dataset. The NuScenes dataset, compiled from driving recordings in Boston and Singapore, utilizes a vehicle equipped with a 32-beam LiDAR and additional sensing technologies [6]. This comprehensive dataset is equipped with the typical sensor array found on autonomous vehicles, including a 32-beam LiDAR setup, six cameras, and radar systems, ensuring full 360-degree environmental perception. It includes 850 driving scene snippets, with 700 designated for training and 150 for validation, each scene lasting 20 seconds with annotations provided every 0.5 seconds. The dataset features extensive annotations across several object categories, including vehicles, pedestrians, bicycles, and road barriers, with each object encapsulated in a 3D bounding box and supplemented with attributes detailing visibility, activity, and pose. ", "page_idx": 17}, {"type": "text", "text": "NuScenes-lidarseg Dataset. The nuScenes dataset now encompasses features for semantic and panoptic segmentation through its extension, nuScenes-lidarseg [6]. This enhanced dataset provides semantic labeling across 32 distinct categories, with each point in the dataset\u2019s keyframes meticulously annotated. We utilize the 700 training scenes equipped with segmentation labels for refining our semantic segmentation models, and we assess model performance using the 150 scenes in the validation set. ", "page_idx": 17}, {"type": "text", "text": "SemanticKITTI Dataset. The SemanticKITTI (SK) dataset features paired RGB images and point cloud data derived from KITTI\u2019s urban scenes, specifically designed for semantic segmentation tasks [2]. This dataset is gathered using sensors mounted on a vehicle, including more than 200,000 images alongside their corresponding point clouds across 21 distinct sequences. Both images and point clouds are aligned to maintain a consistent relative transformation. Originally, the images are captured at a resolution of 1241x376 pixels, and each point cloud is composed of roughly 40,000 3D points. In line with standard practices, the dataset is divided into training and validation sets, with 10 sequences designated for training and the eighth sequence reserved for validation. ", "page_idx": 17}, {"type": "text", "text": "KITTI Dataset. KITTI is a crucial dataset for advancing 3D object detection in autonomous driving.   \nWith 7481 training and 7518 test point clouds, it covers diverse urban and suburban environments [20]. ", "page_idx": 17}, {"type": "text", "text": "The dataset includes 3D point clouds and RGB images captured using a Velodyne HDL-64E LiDAR sensor. Calibration information between the camera and LiDAR is provided, essential for cross-modal knowledge transfer or sensor fusion tasks. Annotated with 3D bounding boxes, it features common objects like cars, pedestrians, and cyclists. The dataset is split into training (3712 samples) and validation (3769 samples) subsets. ", "page_idx": 18}, {"type": "text", "text": "ScribbleKITTI Dataset. ScribbleKITTI is derived from the SemanticKITTI dataset but introduces weak supervision in the form of line scribbles rather than fully labeled point clouds [57]. It retains the same set of 19,130 LiDAR scans, captured by a Velodyne HDL-64E sensor, but only about $8.06\\%$ of the semantic labels are provided compared to the fully-supervised SemanticKITTI dataset. This method of annotation drastically reduces the time required for labeling, offering around a $90\\%$ time saving. We use this dataset to evaluate how well models pre-trained on other datasets generalize under weaker annotations. For our experiments, we follow the SLidR protocol to create different splits of the training set, e.g., one scan is selected from every 100 frames to generate $1\\%$ labeled samples. The model\u2019s performance is evaluated on the official validation set. ", "page_idx": 18}, {"type": "text", "text": "RELLIS-3D Dataset. RELLIS-3D is a multimodal dataset collected from off-road environments on the Texas A&M University campus [25]. The dataset comprises 13,556 annotated LiDAR scans, providing a challenging scenario with complex terrain and class imbalance. It is valuable for assessing model performance in outdoor environments with varying topographies and object densities. ", "page_idx": 18}, {"type": "text", "text": "SemanticPOSS Dataset. SemanticPOSS is a smaller dataset focused on dynamic objects, captured on the campus of Peking University [44]. It includes 2,988 LiDAR scans from a Hesai Pandora 40-channel LiDAR sensor. The dataset is designed to challenge models with its focus on moving instances and dense environments, making it a useful resource for evaluating the adaptability of models to dynamic scenes. In our setup, sequences 00 and 01 are used to create half of the annotated training samples, and sequences 00 to 05, excluding sequence 02, are used for validation. ", "page_idx": 18}, {"type": "text", "text": "SemanticSTF Dataset. This dataset features 2,076 LiDAR scans collected under adverse weather conditions such as snow, fog, and rain, using a Velodyne HDL64 S3D sensor [64]. The dataset is split into training, validation, and test sets, ensuring an even distribution of weather conditions across all subsets. SemanticSTF is particularly suited for testing the robustness of models in extreme environmental conditions. ", "page_idx": 18}, {"type": "text", "text": "SynLiDAR Dataset. The SynLiDAR dataset is composed of synthetic point clouds generated in virtual environments using Unreal Engine 4 [63]. It consists of 13 sequences with a total of 198,396 scans. This synthetic dataset enables large-scale experimentation in scenarios that closely mimic real-world conditions, offering a controlled environment for model pre-training and testing. For our fine-tuning experiments, we use a uniformly downsampled subset of the dataset. ", "page_idx": 18}, {"type": "text", "text": "DAPS-3D Dataset. DAPS-3D includes both semi-synthetic and real-world data, with the subset DAPS-1 consisting of over 23,000 labeled LiDAR scans across 11 sequences [28]. The data was collected in the context of an autonomous robot\u2019s deployment in a real-world scenario. This dataset helps evaluate the transferability of models pre-trained on synthetic data to real-world tasks. In our setup, we use the sequence $^{6}38\\substack{-18\\_7\\_72\\_90\"}$ for training and validate the model on the sequences \u201c38-18_7_72_90\", \u201c42-48_10_78_90\", and \u201c44-18_11_15_32\". This configuration helps in evaluating the model\u2019s performance on both synthetic and real-world data. ", "page_idx": 18}, {"type": "text", "text": "Robo3D (nuScenes-C) Benchmark. As a part of the Robo3D benchmark [30], nuScenes-C tests the robustness of models against various corruptions that simulate real-world challenges, such as severe weather and sensor malfunctions. These corruptions are categorized into different levels of severity (light, moderate, heavy), and the dataset includes eight types of disturbances like fog, snow, motion blur, and sensor interference. It is designed to assess how well models perform under out-of-distribution conditions. We follow the standard protocol of the Robo3D benchmark to evaluate model robustness under these out-of-distribution scenarios, using the official validation set to report results. ", "page_idx": 18}, {"type": "text", "text": "Evaluation Metrics. In semantic segmentation tasks, performance is assessed through Intersectionover-Union (IoU) for individual classes and mean IoU (mIoU) across all classes. In 3D object detection, the 3D detector\u2019s efficacy on the KITTI dataset is measured using Average Precision (AP) metrics at IoU thresholds of 0.7 for cars, 0.5 for pedestrians, and 0.5 for cyclists. Similarly, for the Waymo dataset, evaluation is based on 3D mean Average Precision (mAP). ", "page_idx": 18}, {"type": "text", "text": "A.3 Experimental Setup of 3D Pretraining ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "Network Architectures. For the image processing branch, we utilize the ResNet-50 structure as the core architecture. This 2D backbone is initialized with weights that have been pre-trained using MoCov2 [10] on the ImageNet dataset. To preserve the receptive field while keeping the spatial resolution intact, we substitute the second and subsequent stridden convolutions with dilated convolutions, following established methodologies [50]. The up-sampling projection head includes a $1\\!\\times\\!1$ convolutional layer that reduces the channel count from 2048 to 64, followed by a bi-linear interpolation up-sampling layer that enlarges the scale by a factor of 4. This up-sampling process effectively restores the resolution of the 2D feature map to match that of the original input images, specifically to the size of $416\\!\\times\\!224$ . ", "page_idx": 19}, {"type": "text", "text": "In the point cloud processing branch, we adopt two types of backbones. For the 3D semantic segmentation task, we employ the Sparse Residual 3D U-Net 34 (SR-UNet34) [48], adhering to practices previously established in SLidR [50]. The output from SR-UNet34 offers 256 channels, whereas the image branch outputs a 64-dimensional feature map. To align these dimensions, a 3D convolutional layer is used in the projection head to reduce the channel count of the point features to 64. We process the 3D point data into voxels to serve as input for the SR-UNet. The voxels are formatted in Cartesian coordinates covering an X-axis and Y-axis range of $[-51.2\\mathrm{m}$ , $51.2\\mathrm{mJ}$ and a Z-axis range of $[-5.0\\mathrm{m}$ , 3.0m], with each voxel measuring $(0.1\\mathrm{m},0.1\\mathrm{m},0.1\\mathrm{m})$ . To fully evaluate our method, we pre-train and transfer another VoxelNet [82] for the 3D object detection task. ", "page_idx": 19}, {"type": "text", "text": "Pre-training Details. We utilize momentum SGD for optimization, setting the initial learning rate at 0.5 and 0.01 for SR-UNet34 and VoxelNet respectively, with a momentum of 0.9 and a weight decay of 1e-4. To adjust the learning rate, we employ a cosine annealing scheduler [5] that gradually reduces it from the initial value to 0 over 50 epochs. The 3D network is pre-trained for these 50 epochs on four NVIDIA-3090 GPUs, processing a total batch size of 16, unless specified otherwise. For data augmentation, we incorporate several techniques. For the point cloud data, we apply random rotations around the ${\\bf Z}$ -axis, randomly filp the x and y axes, and omit points within a randomly selected cuboid, following the method described in [80]. For image data, augmentations include random horizontal filps and random crop-resize operations. In terms of generating weak semantic labels, the prompts we provided to the SEEM [84] encompass a total of 16 object categories: barrier, bicycle, bus, car, truck, trailer, motorcycle, construction vehicle, pedestrian, traffic cone, road, sidewalk, terrain, vegetation, building, and other ground. Unless otherwise specified, the semantic labels used in the ablation study are inferred with Grounded-SAM. ", "page_idx": 19}, {"type": "image", "img_path": "63xeWav1lU/tmp/b14f33d7f0c25ce2410718032fcca070b51cf29a5d8733c1fa381109199c0c41.jpg", "img_caption": ["Figure 5: Class distribution at the pixel level for nuScenes dataset. "], "img_footnote": [], "page_idx": 19}, {"type": "image", "img_path": "63xeWav1lU/tmp/1b637801dbf0c1f7e0e35a09893de383fd9b8e942f4f7d2c8e308c5fbb22fc05.jpg", "img_caption": ["Figure 6: Class distribution at the pixel level for SemanticKITTI dataset. "], "img_footnote": [], "page_idx": 20}, {"type": "text", "text": "A.4 More Quantitative Results ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Effectiveness of Pre-training on A Stronger 3D Backbone. A key question arises: is the reduced effectiveness with larger data due to the model\u2019s insufficient size or inherent limitations in the proposed approach? When the available training data is limited, the benefits of pre-trained model weights on downstream tasks become more apparent. This phenomenon, commonly observed in self-supervised learning, is particularly important when downstream task data is scarce. In such cases, pre-trained representations offer a strong foundation, capturing crucial features that would otherwise remain unlearned from the limited labeled data. However, as the volume of labeled data increases, the model is capable of learning these features directly from the data itself, rendering the pre-trained representations less essential. ", "page_idx": 20}, {"type": "text", "text": "To further investigate this, we conducted experiments using a more robust 3D backbone, WaffleIron [45] (see Table 7). The results demonstrate that the effect of pre-training weights becomes less significant when sufficient training data is available for downstream tasks. This suggests that the reduced effectiveness with larger datasets is not due to the backbone\u2019s capability, but rather to the diminishing importance of pre-trained features as the model learns directly from ample labeled data. ", "page_idx": 20}, {"type": "table", "img_path": "63xeWav1lU/tmp/488438b0ae3098efd562dbe03d8b7e073cff65f376797afd5faa29d576417908.jpg", "table_caption": ["Table 7: Performance for 3D backbone WaffleIron. "], "table_footnote": [], "page_idx": 20}, {"type": "text", "text": "Results on OOD Datasets. Table 8 presents the robustness evaluation of several state-of-the-art pretraining methods under eight out-of-distribution (OOD) corruption scenarios from the nuScenes-C dataset, part of the Robo3D benchmark. The corruptions include conditions such as fog, snow, motion blur, beam missing, cross-sensor interference, and more. The table reports three key metrics: mean Corruption Error (mCE, lower is better), mean Recovery Rate (mRR, higher is better), and mean Intersection over Union (mIoU, higher is better). Random Initialization: Among the randomly initialized models, Cylinder3D demonstrates the best overall performance in terms of mRR $(78.08\\%)$ and mIoU $(62.29\\%)$ , indicating relatively better robustness across corruption scenarios. WaffleIron achieves the lowest mCE (106.73), but its performance in mRR and mIoU is slightly lower than Cylinder3D. SPVCNN also shows competitive results in mIoU $(62.29\\%)$ but slightly lags in mRR. Pretrained Methods: Pretraining methods, such as PPKT, SLidR, and Seal, show a clear improvement in robustness compared to random initialization. Seal stands out with the second-best mCE (92.63) and mRR (83.08), along with a strong mIoU $(72.66\\%)$ . However, our method demonstrates the best overall performance, achieving the lowest mCE (90.85) and the highest mRR (83.35), as well as competitive mIoU (70.62). This indicates that our approach outperforms both random initialization and other pretraining techniques in most OOD corruption scenarios, especially in beam missing $(67.28\\%)$ and cross-sensor interference $(59.47\\%)$ . These results confirm that pretraining, particularly with our method, enhances the model\u2019s resilience to OOD corruptions, leading to more robust performance across varying environmental disturbances. ", "page_idx": 20}, {"type": "text", "text": "", "page_idx": 21}, {"type": "table", "img_path": "63xeWav1lU/tmp/96748cc2bfe1dcd09537b828153c3c6827bcd6c6a40b5179af9c3dca39e438d6.jpg", "table_caption": ["Table 8: Robustness evaluation of state-of-the-art pretraining methods under eight out-of-distribution corruptions in the nuScenes- $C$ dataset from the Robo3D benchmark. All mCE (\u2193), mRR (\u2191), and mIoU (\u2191) scores are given as percentages $(\\%)$ . "], "table_footnote": [], "page_idx": 21}, {"type": "text", "text": "Computational Cost. Our approach, OLIVINE, focuses on providing pre-trained weights and does not impact the inference speed of the model on downstream tasks. As seen in the Table 9, OLIVINE requires similar GPU memory and training time compared to other pre-training methods, demonstrating that our method does not significantly increase computational costs during pre-training. ", "page_idx": 21}, {"type": "table", "img_path": "63xeWav1lU/tmp/ea3148dbb3aa70cdb229d694fb96a7c2ebed891f469e9630c8bdad33b084b14c.jpg", "table_caption": ["Table 9: Comparison with other methods regarding the computational cost during pre-training. "], "table_footnote": [], "page_idx": 21}, {"type": "text", "text": "Class Unbalance in Datasets. The visualizations in Figures 5 and 6 illustrate the class distribution at the pixel level for the nuScenes and SemanticKITTI datasets, respectively. These figures reveal a significant class imbalance, a common challenge in many real-world datasets, where some classes are overwhelmingly more frequent than others. Such imbalance can skew the training process, leading to models that perform well on frequent classes but poorly on rare ones. This disparity predominantly affects the model\u2019s ability to generalize effectively across different scenarios, particularly underrepresented ones, resulting in biased predictions and reduced overall accuracy. For instance, infrequent but critical objects like pedestrians or bicycles might not be detected reliably, which is particularly concerning in autonomous driving contexts where safety is paramount. ", "page_idx": 21}, {"type": "text", "text": "To mitigate these issues, our method incorporates an optimized sampling strategy. This strategy involves adjusting the probability of selecting samples from underrepresented classes during the training process. By increasing the likelihood of including rare classes in the training set, we ensure that the model does not overlook these important but less frequent categories. ", "page_idx": 21}, {"type": "text", "text": "Per-class Performance. In Tables 10 and 11, we showcase the per-class performance of various point cloud pretraining strategies, including our method and other baselines, fine-tuned using just $1\\%$ of labeled data from the nuScenes-lidarseg and SemanticKITTI datasets. Our approach consistently surpasses other methods, achieving the highest mean Intersection over Union (mIoU) in nearly all categories. This marked superiority is also significant in complex categories like the bus and truck that demand more precise segmentation, highlighting our method\u2019s robustness in processing sparse and intricate data scenarios. ", "page_idx": 21}, {"type": "text", "text": "Effects of Different VFMs. The impact of different VFMs on the performance of OLIVINE is an important consideration. The precision of the semantic labels generated by these VFMs plays a crucial role in the success of OLIVINE. Those VFMs that also enable text prompts can be applied in OLIVINE to further improve its performance. Stronger VFMs are able to produce more accurate ", "page_idx": 21}, {"type": "text", "text": "Table 10: Per-class results on the nuScenes-lidarseg dataset using only $1\\%$ of the labeled data for fine-tuning. This chart displays the IoU scores for each category, with the highest and second-highest scores marked in dark blue and light blue, respectively. ", "page_idx": 22}, {"type": "table", "img_path": "63xeWav1lU/tmp/2d7921e702f01b373fd95981fbadce82969d1a250ce97b6959c7f51078884601.jpg", "table_caption": [], "table_footnote": [], "page_idx": 22}, {"type": "text", "text": "Table 11: Per-class performance on SemanticKITTI with $1\\%$ of the labeled data utilized for finetuning. The figure shows the IoU for each class, where the top and second top scores are indicated by dark blue and light blue backgrounds, respectively. ", "page_idx": 22}, {"type": "table", "img_path": "63xeWav1lU/tmp/9290f5d8db62a489d15d29f39371f603407d0c1a75a90bdd58cabf1e4c806546.jpg", "table_caption": [], "table_footnote": [], "page_idx": 22}, {"type": "text", "text": "semantic labels, which in turn lead to better learned representations during the pre-training process. As shown in the table below, the use of a stronger VFM, such as SEEM [84], can improve performance, highlighting the potential of our method when paired with more advanced models. ", "page_idx": 22}, {"type": "table", "img_path": "63xeWav1lU/tmp/57c4ec0621928e07655e46bbe1e5eb3bfddd26e4240c4419aa133bc6e583fb0e.jpg", "table_caption": ["Table 12: Effects of different VFMs for generating semantic labels. "], "table_footnote": [], "page_idx": 22}, {"type": "text", "text": "A.5 More Qualitative Results ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "2D-3D Feature Similarities. The visualization presented in Figure 7 showcases the feature similarities between image and point cloud data as extracted through different projection heads. In the first column, the raw image is displayed alongside the projection of an anchor point within that image, setting the context for the comparison. The second column visualizes the feature similarities as extracted by the conventional projection heads, $h_{\\mathrm{3D}}^{\\mathrm{pp}}$ and $h_{\\mathrm{2D}}^{\\mathrm{pp}}$ , used for point-pixel level contrastive distillation. Here, only the features of the pixel that directly correspond to the anchor point show a high degree of similarity, emphasizing a tight, point-to-point correspondence. ", "page_idx": 22}, {"type": "text", "text": "In contrast, the third column introduces results from the extra projection heads, $h_{\\mathrm{3D}}^{\\mathrm{sem}}$ and $h_{\\mathrm{2D}}^{\\mathrm{sem}}$ , which are designed for weakly-supervised (category-aware) contrastive distillation. This setup reveals a broader similarity pattern, where points and pixels sharing the same category exhibit notably higher feature similarities. This suggests that our newly proposed projection heads are effective in capturing and reinforcing category-level feature associations across the 3D and 2D domains, thus enhancing the model\u2019s ability to recognize semantically similar but spatially disparate features. ", "page_idx": 22}, {"type": "text", "text": "Visual Results on Downstream Tasks. In Figures 8, 9, 10, and 11, we present additional qualitative results from fine-tuning tasks on downstream datasets. The application of pre-training strategies markedly improves model accuracy over baselines that use random initialization. Notably, our proposed OLIVINE outperforms SLiDR [50], highlighting its superior segmentation capabilities. ", "page_idx": 22}, {"type": "image", "img_path": "63xeWav1lU/tmp/7997f747bda816f1712b5e223bc8f429ef01e7e1bda1ab96d23d4867298605fe.jpg", "img_caption": ["Figure 7: Visualization of the similarities between image and point cloud feature. In the first column, we show the raw image and the projection of anchor point in the image. In second columns, we illustrate the similarities between 3D query and 2D features extracted by the conventional projection heads $h_{\\mathrm{3D}}^{\\mathrm{pp}}$ and $h_{\\mathrm{2D}}^{\\mathrm{pp}}$ for point-pixel level contrastive distillation. In third columns, we illustrate the similarities between 3D query and 2D features extracted by the extra projection heads $h_{\\mathrm{3D}}^{\\mathrm{sem}}$ and $h_{\\mathrm{2D}}^{\\mathrm{sem}}$ for weakly-supervised (category-aware) contrastive distillation. "], "img_footnote": [], "page_idx": 23}, {"type": "text", "text": "Despite these advancements, we note the occurrence of false positive predictions in edge cases, which we aim to address in future research. ", "page_idx": 24}, {"type": "text", "text": "Visualization of the Weak Semantic Labels. The weak labels generated by SEEM [84] using targeted prompts play a vital role in our processing pipeline. While reviewing these labels, we observe instances of imprecision (see Fig. 12 and Fig. 13). Should future advancements in Segmentation Anything Models yield more robust and accurate results, the effectiveness of our 3D pre-training strategy is likely to improve significantly. This progression would enhance our model\u2019s ability to interpret and learn from nuanced environmental data, ultimately leading to superior representation learning. ", "page_idx": 24}, {"type": "text", "text": "A.6 Potential Limitations ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "While our method, OLIVINE, effectively enhances the fine-grained image-to-LiDAR contrastive distillation process and demonstrates significant improvements in 3D scene understanding, there are technical and potential limitations that merit attention: ", "page_idx": 24}, {"type": "text", "text": "Semantic Label Accuracy. The accuracy of the weak semantic labels generated by VFMs is critical to the success of our model. Any deficiencies in these labels could propagate through the learning process, potentially compounding errors in the learned representations. ", "page_idx": 24}, {"type": "text", "text": "Training Data Diversity. Currently, our model is pre-trained using a single dataset, which may limit its applicability to environments or scenarios not well-represented in the training data. Expanding the training to include diverse datasets with varying characteristics could enhance the robustness and generalizability of our model. ", "page_idx": 24}, {"type": "text", "text": "Dependency on High-Quality Data Calibration. Our framework relies on the precise calibration and synchronization between LiDAR sensors and cameras. In real-world applications, perfect synchronization and calibration can be challenging to maintain, potentially affecting the accuracy and reliability of the semantic labels generated and subsequently the distillation process [50, 38, 73]. ", "page_idx": 24}, {"type": "text", "text": "These limitations highlight areas for future development and research, suggesting a path toward more robust, adaptable, and efficient systems for 3D scene understanding in diverse and dynamic environments. ", "page_idx": 24}, {"type": "text", "text": "A.7 Societal and Environmental Impact ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Our method, OLIVINE, which enhances image-to-LiDAR contrastive distillation using Visual Foundation Models, significantly impacts society and the environment. Societally, it boosts the safety and reliability of autonomous systems, increasing public trust and improving data analysis in various industries. Environmentally, deploying advanced deep learning models requires increased computational resource usage, which can lead to higher energy consumption and associated carbon emissions. This is particularly relevant during the intensive training phases that require high-performance GPUs and long training durations, especially as the model scales to larger datasets or more complex scenarios. Conversely, by distributing our pre-trained models, we aim to reduce the need for repetitive training across multiple downstream tasks, which can decrease the overall computational load and energy consumption needed to achieve high performance in various applications. This aspect potentially mitigates some of the environmental costs. ", "page_idx": 24}, {"type": "text", "text": "A.8 Public Resources Used ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "We acknowledge the use of the following public resources, during the course of this work: ", "page_idx": 24}, {"type": "text", "text": "\u2022 Grounded-Segment-Anything Apache License 2.0 \u2022 KITTI Dataset3 CC BY-NC-SA 3.0 \u2022 MinkowskiEngine4 . .MIT License \u2022 nuScenes . CC BY-NC-SA 4.0 \u2022 ScribbleKITTI6 . Unknown \u2022 RELLIS-3D7 . CC BY-NC-SA 3.0 \u2022 SemanticPOSS8 . . Unknown \u2022 SemanticSTF9 . CC BY-NC-SA 4.0 \u2022 SynLiDAR10 . MIT License \u2022 DAPS-3D11 MIT License \u2022 nuScenes-C12 . CC BY-NC-SA 4.0 \u2022 nuScenes-devkit13 Apache License 2.0 \u2022 OpenPCDet14 Apache License 2.0 \u2022 PyTorch-Lightning Apache License 2.0 \u2022 SemanticKITTI16 .CC BY-NC-SA 4.0 \u2022 SLidR17 Apache License 2.0 \u2022 SEEM18 Apache License 2.0 ", "page_idx": 24}, {"type": "text", "text": "", "page_idx": 25}, {"type": "image", "img_path": "63xeWav1lU/tmp/eb955ff5ff9effefeb9aa0c57cf895dd632cb2089f9b35d35c088a1abe6fc16e.jpg", "img_caption": ["Figure 8: Qualitative results of fine-tuning on $1\\%$ of the nuScenes-lidarseg dataset with different pre-training strategies. Note that the results are shown as error maps on the right, where red points indicate incorrect predictions. Best viewed in color and zoom in for more details. "], "img_footnote": [], "page_idx": 26}, {"type": "image", "img_path": "63xeWav1lU/tmp/65c78734eb6e4a7b6efe0c5aa042aaa4ec1e41c8ab0d862b6a3f2289c6faeae9.jpg", "img_caption": ["Figure 9: Qualitative results of fine-tuning on $1\\%$ of the nuScenes-lidarseg dataset with different pre-training strategies. Note that the results are shown as error maps on the right, where red points indicate incorrect predictions. Best viewed in color and zoom in for more details. "], "img_footnote": [], "page_idx": 27}, {"type": "image", "img_path": "63xeWav1lU/tmp/192217c4fbaf5570d1baab4e65aac6f0b1b3afb7940b53086145909ccd2b9de6.jpg", "img_caption": ["Figure 10: Qualitative results of fine-tuning on $1\\%$ of the SemanticKITTI dataset with different pre-training strategies. Note that the results are shown as error maps on the right, where red points indicate incorrect predictions. Best viewed in color and zoom in for more details. "], "img_footnote": [], "page_idx": 28}, {"type": "image", "img_path": "63xeWav1lU/tmp/a3dceb61cbe5357b164b80de62048d34f366d5e9bb5bcfec2a3603800f6ca382.jpg", "img_caption": ["Figure 11: Qualitative results of fine-tuning on $1\\%$ of the SemanticKITTI dataset with different pre-training strategies. Note that the results are shown as error maps on the right, where red points indicate incorrect predictions. Best viewed in color and zoom in for more details. "], "img_footnote": [], "page_idx": 29}, {"type": "image", "img_path": "63xeWav1lU/tmp/73a9e418062d7c918d829ef74286144876e342cf21544b510f929cca4d217374.jpg", "img_caption": ["Figure 12: Illustration of the weak semantic labels predicted by Grounded SAM. The top half of the figure displays the raw RGB images and LiDAR point clouds, while the bottom half presents the corresponding weak semantic labels applied to both images and point clouds, aligned using camera parameters. Each distinct segment is represented by a unique color. Best viewed in color. "], "img_footnote": [], "page_idx": 30}, {"type": "image", "img_path": "63xeWav1lU/tmp/d242cb89674fe38e5bc23c0c59fc34cfb99e812d102bfe023bd7e2c55cf79a5f.jpg", "img_caption": [], "img_footnote": [], "page_idx": 30}, {"type": "text", "text": "Figure 13: Illustration of the weak semantic labels predicted by Grounded-SAM. The top half of the figure displays the raw RGB images and LiDAR point clouds, while the bottom half presents the corresponding weak semantic labels applied to both images and point clouds, aligned using camera parameters. Each distinct segment is represented by a unique color. Best viewed in color. ", "page_idx": 30}, {"type": "text", "text": "NeurIPS Paper Checklist ", "text_level": 1, "page_idx": 31}, {"type": "text", "text": "The checklist is designed to encourage best practices for responsible machine learning research, addressing issues of reproducibility, transparency, research ethics, and societal impact. Do not remove the checklist: The papers not including the checklist will be desk rejected. The checklist should follow the references and follow the (optional) supplemental material. The checklist does NOT count towards the page limit. ", "page_idx": 31}, {"type": "text", "text": "Please read the checklist guidelines carefully for information on how to answer these questions. For each question in the checklist: ", "page_idx": 31}, {"type": "text", "text": "\u2022 You should answer [Yes] , [No] , or [NA] .   \n\u2022 [NA] means either that the question is Not Applicable for that particular paper or the relevant information is Not Available.   \n\u2022 Please provide a short (1\u20132 sentence) justification right after your answer (even for NA). ", "page_idx": 31}, {"type": "text", "text": "The checklist answers are an integral part of your paper submission. They are visible to the reviewers, area chairs, senior area chairs, and ethics reviewers. You will be asked to also include it (after eventual revisions) with the final version of your paper, and its final version will be published with the paper. ", "page_idx": 31}, {"type": "text", "text": "The reviewers of your paper will be asked to use the checklist as one of the factors in their evaluation. While \"[Yes] \" is generally preferable to \"[No] \", it is perfectly acceptable to answer \"[No] \" provided a proper justification is given (e.g., \"error bars are not reported because it would be too computationally expensive\" or \"we were unable to find the license for the dataset we used\"). In general, answering \"[No] \" or \"[NA] \" is not grounds for rejection. While the questions are phrased in a binary way, we acknowledge that the true answer is often more nuanced, so please just use your best judgment and write a justification to elaborate. All supporting evidence can appear either in the main paper or the supplemental material, provided in appendix. If you answer [Yes] to a question, in the justification please point to the section(s) where related material for the question can be found. ", "page_idx": 31}, {"type": "text", "text": "IMPORTANT, please: ", "page_idx": 31}, {"type": "text", "text": "\u2022 Delete this instruction block, but keep the section heading \u201cNeurIPS paper checklist\", \u2022 Keep the checklist subsection headings, questions/answers and guidelines below. \u2022 Do not modify the questions and only use the provided macros for your answers. ", "page_idx": 31}, {"type": "text", "text": "1. Claims ", "text_level": 1, "page_idx": 31}, {"type": "text", "text": "Question: Do the main claims made in the abstract and introduction accurately reflect the paper\u2019s contributions and scope? ", "page_idx": 31}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 31}, {"type": "text", "text": "Justification: The main claims made in the abstract and introduction accurately reflect the paper\u2019s contributions and scope. These sections effectively summarize the key aspects of the research. They set clear expectations for the reader about the methodologies employed and the advancements over existing techniques. ", "page_idx": 31}, {"type": "text", "text": "2. Limitations ", "text_level": 1, "page_idx": 31}, {"type": "text", "text": "Question: Does the paper discuss the limitations of the work performed by the authors? Answer: [Yes] ", "page_idx": 31}, {"type": "text", "text": "Justification: We discuss the potential limitations of our method in Section A.6. ", "page_idx": 31}, {"type": "text", "text": "3. Theory Assumptions and Proofs ", "page_idx": 31}, {"type": "text", "text": "Question: For each theoretical result, does the paper provide the full set of assumptions and a complete (and correct) proof? ", "page_idx": 31}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 31}, {"type": "text", "text": "Justification: The focus of our paper is primarily on the application and empirical validation of VFMs for image-to-LiDAR contrastive distillation, rather than on deriving new theoretical results. Consequently, our work does not introduce formal theorems or proofs that would necessitate a detailed discussion of assumptions or a mathematical proof structure. ", "page_idx": 31}, {"type": "text", "text": "4. Experimental Result Reproducibility ", "text_level": 1, "page_idx": 32}, {"type": "text", "text": "Question: Does the paper fully disclose all the information needed to reproduce the main experimental results of the paper to the extent that it affects the main claims and/or conclusions of the paper (regardless of whether the code and data are provided or not)? ", "page_idx": 32}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 32}, {"type": "text", "text": "Justification: Our paper provides detailed methodology and experimental settings necessary to reproduce the main results, supporting our core claims and conclusions. ", "page_idx": 32}, {"type": "text", "text": "5. Open access to data and code ", "text_level": 1, "page_idx": 32}, {"type": "text", "text": "Question: Does the paper provide open access to the data and code, with sufficient instructions to faithfully reproduce the main experimental results, as described in supplemental material? ", "page_idx": 32}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 32}, {"type": "text", "text": "Justification: We attach the code in supplementary materials, where we provide sufficient instructions to reproduce the main results. And we will release the source code on github in the future. ", "page_idx": 32}, {"type": "text", "text": "6. Experimental Setting/Details ", "text_level": 1, "page_idx": 32}, {"type": "text", "text": "Question: Does the paper specify all the training and test details (e.g., data splits, hyperparameters, how they were chosen, type of optimizer, etc.) necessary to understand the results? ", "page_idx": 32}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 32}, {"type": "text", "text": "Justification: The paper meticulously details all training and testing parameters, including data splits, hyperparameters, selection criteria, and the type of optimizer used, ensuring complete understanding of the experimental results. ", "page_idx": 32}, {"type": "text", "text": "7. Experiment Statistical Significance ", "text_level": 1, "page_idx": 32}, {"type": "text", "text": "Question: Does the paper report error bars suitably and correctly defined or other appropriate information about the statistical significance of the experiments? ", "page_idx": 32}, {"type": "text", "text": "Answer: [No] ", "page_idx": 32}, {"type": "text", "text": "Justification: Error bars are not included due to the computational expense involved. However, we generally ensure robustness against random seed variations by reporting results averaged over three independent experiments. For the fine-tuning on 3D detection task, we recorded the best results from the three experiments. ", "page_idx": 32}, {"type": "text", "text": "8. Experiments Compute Resources ", "text_level": 1, "page_idx": 32}, {"type": "text", "text": "Question: For each experiment, does the paper provide sufficient information on the computer resources (type of compute workers, memory, time of execution) needed to reproduce the experiments? ", "page_idx": 32}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 32}, {"type": "text", "text": "Justification: Please refer to the details in Section A.3. ", "page_idx": 32}, {"type": "text", "text": "9. Code Of Ethics ", "text_level": 1, "page_idx": 32}, {"type": "text", "text": "Question: Does the research conducted in the paper conform, in every respect, with the NeurIPS Code of Ethics https://neurips.cc/public/EthicsGuidelines? ", "page_idx": 32}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 32}, {"type": "text", "text": "Justification: Yes, we adhere to the NeurIPS Code of Ethics. ", "page_idx": 32}, {"type": "text", "text": "10. Broader Impacts ", "text_level": 1, "page_idx": 32}, {"type": "text", "text": "Question: Does the paper discuss both potential positive societal impacts and negative societal impacts of the work performed? ", "page_idx": 32}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 32}, {"type": "text", "text": "Justification: We discuss the societal impacts of our paper in Section A.7. ", "page_idx": 32}, {"type": "text", "text": "11. Safeguards ", "text_level": 1, "page_idx": 32}, {"type": "text", "text": "Question: Does the paper describe safeguards that have been put in place for responsible release of data or models that have a high risk for misuse (e.g., pretrained language models, image generators, or scraped datasets)? ", "page_idx": 33}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 33}, {"type": "text", "text": "Justification: Our paper does not involve the release of models or datasets that pose a high risk for misuse. Therefore, safeguards for responsible release and use were not necessary for this research. We will consider this issue when we release our pre-trained model. ", "page_idx": 33}, {"type": "text", "text": "12. Licenses for existing assets ", "text_level": 1, "page_idx": 33}, {"type": "text", "text": "Question: Are the creators or original owners of assets (e.g., code, data, models), used in the paper, properly credited and are the license and terms of use explicitly mentioned and properly respected? ", "page_idx": 33}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 33}, {"type": "text", "text": "Justification: We cite the relevant papers and credit the term of used resource in Section A.8. ", "page_idx": 33}, {"type": "text", "text": "13. New Assets ", "text_level": 1, "page_idx": 33}, {"type": "text", "text": "Question: Are new assets introduced in the paper well documented and is the documentation provided alongside the assets? ", "page_idx": 33}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 33}, {"type": "text", "text": "Justification: We attach the source with documentation in the supplementary materials anonymously. ", "page_idx": 33}, {"type": "text", "text": "14. Crowdsourcing and Research with Human Subjects ", "text_level": 1, "page_idx": 33}, {"type": "text", "text": "Question: For crowdsourcing experiments and research with human subjects, does the paper include the full text of instructions given to participants and screenshots, if applicable, as well as details about compensation (if any)? ", "page_idx": 33}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 33}, {"type": "text", "text": "Justification: This paper does not involve crowdsourcing nor research with human subjects. ", "page_idx": 33}, {"type": "text", "text": "15. Institutional Review Board (IRB) Approvals or Equivalent for Research with Human Subjects ", "page_idx": 33}, {"type": "text", "text": "Question: Does the paper describe potential risks incurred by study participants, whether such risks were disclosed to the subjects, and whether Institutional Review Board (IRB) approvals (or an equivalent approval/review based on the requirements of your country or institution) were obtained? ", "page_idx": 33}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 33}, {"type": "text", "text": "Justification: the paper does not involve crowdsourcing nor research with human subjects. ", "page_idx": 33}]