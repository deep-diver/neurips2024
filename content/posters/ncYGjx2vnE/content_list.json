[{"type": "text", "text": "Chimera: Effectively Modeling Multivariate Time Series with 2-Dimensional State Space Models ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Ali Behrouz Michele Santacatterina Ramin Zabih Cornell University New York University Cornell University ab2947@cornell.edu santam13@nyu.edu rdz@cs.cornell.edu ", "page_idx": 0}, {"type": "text", "text": "Abstract ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Modeling multivariate time series is a well-established problem with a wide range of applications from healthcare to financial markets. It, however, is challenging as it requires methods to (1) have high expressive power of representing complicated dependencies along the time axis to capture both long-term progression and seasonal patterns, (2) capture the inter-variate dependencies when it is informative, (3) dynamically model the dependencies of variate and time dimensions, and (4) have efficient training and inference for very long sequences. Traditional State Space Models (SSMs) are classical approaches for univariate time series modeling due to their simplicity and expressive power to represent linear dependencies. They, however, have fundamentally limited expressive power to capture non-linear dependencies, are slow in practice, and fail to model the inter-variate information flow. Despite recent attempts to improve the expressive power of SSMs by using deep structured SSMs, the existing methods are either limited to univariate time series, fail to model complex patterns (e.g., seasonal patterns), fail to dynamically model the dependencies of variate and time dimensions, and/or are input-independent. We present Chimera, an expressive variation of the 2-dimensional SSMs with careful design of parameters to maintain high expressive power while keeping the training complexity linear. Using two SSM heads with different discretization processes and input-dependent parameters, Chimera is provably able to learn long-term progression, seasonal patterns, and desirable dynamic autoregressive processes. To improve the efficiency of complex 2D recurrence, we present a fast training using a new 2-dimensional parallel selective scan. Our experimental evaluation shows the superior performance of Chimera on extensive and diverse benchmarks, including ECG and speech time series classification, long-term and short-term time series forecasting, and time series anomaly detection. ", "page_idx": 0}, {"type": "text", "text": "1 Introduction ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Modeling time series is a well-established problem with a wide range of applications from healthcare [1\u20133] to financial markets [4, 5] and energy management [6]. The complex nature of time series data, its diverse domains of applicability, and its broad range of tasks (e.g., classification [2, 7], imputation [8, 9], anomaly detection [2, 10], and forecasting [6]), however, raise fundamental challenges to design effective and generalizable models: (1) The higher-order, seasonal, and long-term patterns in time series require an effective model to be able to expressively capture complex and autoregressive dependencies; (2) In the presence of multiple variates of time series, an effective model need to capture the complex dynamics of the dependencies between time and variate axes. More specifically, most existing multivariate models seem to suffer from overftiting especially when the target time series is not correlated with other covariates [11]. Accordingly, an effective model needs to adaptively learn to select (resp. fliter) informative (resp. irrelevant) variates; (3) The diverse set of domains and tasks requires effective models to be free of manual pre-processing and domain knowledge and instead adaptively learn them; and (4) Due to the processing of very long sequences, effective methods need efficient training and inference. ", "page_idx": 0}, {"type": "image", "img_path": "ncYGjx2vnE/tmp/0c5f7de88a404bc9025000c67e340fe914ba69e198d791f4d8c2fd4424386a1f.jpg", "img_caption": ["Figure 1: The Overview of Contributions and Architecture of Chimera. We present a 2-dimensional SSM with careful and expressive parameterization. It uses different learnable discretization processes to learn seasonal and long-term progression patterns, and leverages a parallelizable and fast training process by re-formulating the 2D input dependent recurrence as a 2D prefix sum problem. "], "img_footnote": [], "page_idx": 1}, {"type": "text", "text": "", "page_idx": 1}, {"type": "text", "text": "Classical methods (e.g., State Space Models [12, 13], ARIMA [14], SARIMA [15], Exponential Smoothing (ETS) [16]) require manual data preprocessing and model selection, and often are not able to capture complex non-linear dynamics. The raise of deep learning methods and more specifically Transformers [17] has led to significant research efforts to address the limitation of classical methods and develop effective deep models [18\u201327]. Unfortunately, most existing deep models struggle to achieve all the above four criteria. The main body of research in this direction has focused on designing attention modules that use the special traits of time series [21, 20]. However, the inherent permutation equivariance of attentions contradicts the causal nature of time series and often results in suboptimal performance compared to simple linear methods [11]. Moreover, they often either overlook difference of seasonal and long-term trend or use non-learnable methods to handle them [20]. ", "page_idx": 1}, {"type": "text", "text": "A considerable subset of deep models overlook the importance of modeling the dependencies of variates [11, 28, 29]. These dependencies, however, are not always useful; specifically when the target time series is not correlated with other covariates [30]. Despite several studies exploring the importance of learning cross variate dependencies [26, 27, 30], there has been no universal standard and the conclusion has been different depending on the domain and benchmarks. Accordingly, we argue that an effective model need to adaptively learn to capture the dependencies of variates in a data-dependent manner. In this direction, recently, Liu et al. [27] argue that attention mechanisms are more effective when they are used across variates, showing the importance of modeling complex non-linear dependencies across the variate axis in a data-dependent manner. However, the quadratic complexity of Transformers challenges the model on multivariate time series with a large number of variates (e.g., brain activity signals [2] or traffic forecasting [6]), limiting the efficient training and inference (see Table 3, and Table 5). ", "page_idx": 1}, {"type": "text", "text": "The objective of this study is to develop a provably expressive model for multivariate time series that not only can model the dynamics of the depenendencies along both time and variates, but it also takes advantage of fast training and inference. To this end, we present a Chimera, a three-headed two-dimensional State Space Model (SSM) that is based on linear layers along (i) time, (ii) variates, (iii) time $\\rightarrow$ variate, and (iv) variate $\\rightarrow$ time. Chimera has a careful parameterization based on the pair of companion and diagonal matrices (see Figure 1), which is provably expressive to recover both classical methods [16, 14, 15], linear attentions, and recent SSM-based models [31, 32]. It further uses an adaptive module based on a 2D SSM with an especially designed discretization process to capture seasonal patterns. While our theoretical results and design of Chimera guarantee the first three criteria of an effective model, due to its 2D recurrence, the naive implementation of Chimera results in slow training. To address this issue, we reformulate its 2D recurrence as the prefix sum problem with a 2-dimensional associative operators. This new formulation can be done in parallel and has hardware-friendly implementation, resulting in much faster training and inference. ", "page_idx": 1}, {"type": "text", "text": "", "page_idx": 2}, {"type": "text", "text": "In our experimental evaluation, we explore the performance of Chimera in a wide range of tasks: ECG and audio speech time series classification, long- and short-term time series forecasting, and anomaly detection tasks. We find that Chimera achieve superior or on par performance with state-of-the-art methods, while having faster training and less memory consumption. We perform a case study on the human brain activity signals [2] to show (1) the effectiveness of Chimera and (2) evaluate the importance of modeling the dynamics of the variates dependencies. ", "page_idx": 2}, {"type": "text", "text": "2 Preliminaries ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "Notations. In this paper we mainly focus on classification and forecasting tasks. Note that anomaly detection can be seen as a binary classification task, where 0 means \u201cnormall\u201d and 1 means \u201canomaly\u201d. We let $\\mathbf{X}\\,=\\,\\{\\mathbf{x}_{1},\\hdots,\\mathbf{x}_{N}\\}\\,\\in\\,\\overset{\\cdot}{\\mathbb{R}}^{N\\times T}$ be the input sequences, where $N$ is the number of variates and $T$ is the time steps. We use ${\\bf x}_{v,t}$ to refer to the value of the series $v$ at time $t$ . In classification (anomaly detection) tasks, we aim to classify input sequences and for forecasting tasks, given an input sequence $\\mathbf{x}_{i}$ , we aim to predict $\\tilde{\\mathbf{x}}_{i}\\in\\mathbb{R}^{1\\ '\\times H}$ , i.e., the next $H$ time steps for variate $\\mathbf{x}_{i}$ , where $H$ is called horizon. In 2D SSMs formulation, for a 2-dimensional vector $x\\in\\mathbb{C}^{1}$ , we use $x^{(1)}$ and $x^{(2)}$ to refer to its real and imaginary components, respectively. ", "page_idx": 2}, {"type": "text", "text": "Multi-Dimensional State Space Models. We build our approach on the continuous State Space Model (SSM) but later we make each component of Chimera discrete by a designed discretization process. For additional discussion on 1D SSMs see Appendix A. Given parameters A\u03c41 \u2208RN(\u03c41)\u00d7N(\u03c41), $\\mathbf{B}_{\\tau_{2}}\\,\\in\\,\\mathbb{C}^{N^{(\\tau_{2})}\\times1}$ , and $\\mathbf{C}\\,\\in\\,\\mathbb{C}^{N_{1}\\times N_{2}}$ for $\\tau_{1}\\,\\in\\,\\{1,...,4\\}$ and $\\tau_{2}\\in\\{1,2\\}$ , the general form of the time-invariant 2D SSM is the map $\\mathbf{x}\\in\\mathbb{C}^{1}\\mapsto\\mathbf{\\dot{y}}\\in\\mathbb{C}^{1}$ defined by the linear Partial Differential Equation (PDE) with initial condition $h(0,0)=0$ : ", "page_idx": 2}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\displaystyle\\frac{\\partial}{\\partial t^{(1)}}h\\left(t^{(1)},t^{(2)}\\right)=\\left(\\mathbf{A}_{1}h^{(1)}\\left(t^{(1)},t^{(2)}\\right),\\mathbf{A}_{2}h^{(2)}\\left(t^{(1)},t^{(2)}\\right)\\right)+\\mathbf{B}_{1}\\mathbf{x}\\left(t^{(1)},t^{(2)}\\right),}\\\\ &{\\displaystyle\\frac{\\partial}{\\partial t^{(2)}}h\\left(t^{(1)},t^{(2)}\\right)=\\left(\\mathbf{A}_{3}h^{(1)}\\left(t^{(1)},t^{(2)}\\right),\\mathbf{A}_{4}h^{(2)}\\left(t^{(1)},t^{(2)}\\right)\\right)+\\mathbf{B}_{2}\\mathbf{x}\\left(t^{(1)},t^{(2)}\\right),}\\\\ &{\\mathbf{y}\\left(t^{(1)},t^{(2)}\\right)=\\langle\\mathbf{C},\\mathbf{x}\\left(t^{(1)},t^{(2)}\\right)\\rangle.}\\end{array}\n$$", "text_format": "latex", "page_idx": 2}, {"type": "text", "text": "Contrary to the multi-dimensional SSMs discussed by Gu and Dao [33], Gu et al. [34], in which multi-dimension refers to the dimension of the input but with one time variable, the above formulation uses two variables, meaning that the mapping is from a 2D grid to a 2D grid. ", "page_idx": 2}, {"type": "text", "text": "(Seasonal) Autoregressive Process. Autoregressive process is a basic yet essential premise for time series modeling, which models the causal nature of time series. Given $p\\in\\mathbb N$ , $\\mathbf{x}_{k}^{\\bar{}}\\in\\mathbb{R}^{d}$ , the simple linear autoregressive relationships between $\\mathbf{x}_{k}$ and its past samples $\\mathbf{x}_{k-1},\\mathbf{x}_{k-2},\\ldots,\\mathbf{x}_{k-p}$ can be modeled as $\\mathbf{x}_{k}=\\phi_{1}\\mathbf{x}_{k-1}+\\phi_{2}\\mathbf{x}_{k-2}+...\\,,\\phi_{p}\\mathbf{x}_{k-p}$ , where $\\phi_{1},...,\\phi_{p}$ are coefficients. This is called $\\operatorname{AR}(p)$ . Similarly, in the presence of seasonal patterns, the seasonal autoregressive process, $\\mathrm{SAR}(p,q,s)$ , is: ", "page_idx": 2}, {"type": "equation", "text": "$$\n\\mathbf{x}_{k}=\\phi_{1}\\mathbf{x}_{k-1}+\\phi_{2}\\mathbf{x}_{k-2}+\\hdots,\\phi_{p}\\mathbf{x}_{k-p}+\\eta_{1}\\mathbf{x}_{k-s}+\\eta_{2}\\mathbf{x}_{k-2s}+\\cdot\\cdot\\cdot+\\eta_{q}\\mathbf{x}_{k-q s},\n$$", "text_format": "latex", "page_idx": 2}, {"type": "text", "text": "where $s$ is the frequency of seasonality, and $\\phi_{1},\\ldots,\\phi_{p}$ and $\\eta_{1},\\ldots,\\eta_{q}$ are coefficients. Note that one can simply extend the above formulation to multivariate time series by letting coefficients to be vectors and replace the product with element-wise product. ", "page_idx": 2}, {"type": "text", "text": "3 Chimera: A Three-headed 2-Dimensional State Space Model ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "In this section, we first present a mathematical model for multivariate time series data and then based on this model, we present a neural architecture that can satisfy all the criteria discussed in $\\S1$ . ", "page_idx": 2}, {"type": "text", "text": "3.1 Motivations & Chimera Model ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "SSMs have been long-standing methods for modeling time series [12, 13], mainly due to their simplicity and expressive power to represent complicated and autoregressive dependencies. Their states, however, are the function of a single-variable (e.g., time). Multivariate time series, on the other hand, require capturing dependencies along both time and variate dimensions, requiring the current state of the model to be the function of both time and variate. Classical 2D SSMs [35\u201338], however, struggle to achieve good performance compared to recent advanced deep learning methods as they are : (1) only able to capture linear dependencies, (2) discrete by design, having a pre-determined resolution, and so cannot simply model seasonal patterns, (3) slow in practice for large datasets, (4) their update parameters are static and cannot capture the dynamics of dependencies. Deep learning-based methods [6, 30, 27], on the other hand, potentially are able to address a subset of the above limitations, while having their own drawbacks (discussed in $\\S1$ ). In this section, we start with continuous SSMs due to their connection to both classical methods [12, 13] and recent breakthrough in deep learning [34, 33]. We then discuss our contributions on how to take the advantages of the best of both worlds, addressing all the abovementioned limitations. ", "page_idx": 3}, {"type": "text", "text": "Discrete 2D SSM. We use 2-dimensional SSMs, introduced in Equation 1-3, to model multivariate time series, where the first axis corresponds to the time dimension and the second axis is the variates. Accordingly, each state is a function of both time and variates. The first stage is to transform the continuous form of 2D SSMs to discrete form. Given the step size $\\Delta_{1}$ and $\\Delta_{2}$ , which represent the resolution of the input along the axes, discrete form of the input is defined as $\\mathbf{x}_{k,\\ell}=\\mathbf{x}(k\\Delta_{1},\\ell\\Delta_{2})$ . Using Zero-Order Hold (ZOH) method, we can discretize the input as (see Appendix C for details): ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\binom{h_{k,\\ell+1}^{(1)}}{h_{k+1,\\ell}^{(2)}}=\\binom{\\bar{\\mathbf{A}}_{1}}{\\bar{\\mathbf{A}}_{3}}\\ \\ \\bar{\\mathbf{A}}_{4}\\left(\\!\\!\\begin{array}{c}{\\!\\!\\bar{h}_{k,\\ell}^{(1)}\\!}\\\\ {\\!\\!h_{k,\\ell}^{(2)}\\!}\\end{array}\\!\\!\\right)+\\left(\\!\\!\\begin{array}{c}{\\!\\!\\bar{\\mathbf{B}}_{1}\\!}\\\\ {\\!\\!\\bar{\\mathbf{B}}_{2}\\!}\\end{array}\\!\\!\\right)\\otimes\\left(\\!\\!\\frac{\\bar{\\mathbf{x}}_{k,\\ell+1}\\!}{\\bar{\\mathbf{x}}_{k+1,\\ell}}\\!\\!\\right),\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "where $\\bar{\\mathbf{A}}_{i}\\ =\\ \\exp\\left(\\Delta_{\\lfloor\\frac{i+1}{2}\\rfloor}\\mathbf{A}_{i}\\right)$ for i = 1, 2, 3, 4, $\\bar{\\bf B}_{1}\\ =\\ \\left({\\bf A}_{1}^{-1}\\left(\\bar{\\bf A}_{1}-{\\bf I}\\right){\\bf B}_{1}^{(1)}\\right),$ A12\u22121 A\u00af2 \u2212I B(112) , and \u00afB2 = $\\left(\\mathbf{A}_{3}^{-1}\\left(\\bar{\\mathbf{A}}_{3}-\\mathbf{I}\\right)\\mathbf{B}_{2}^{(1)}\\right)$ . Note that this formulation can also be viewed as the modification of the discrete Roesser\u2019s SSM model [35] when we add a lag of 1 in the inputs $\\left(\\bar{\\mathbf{x}}_{i,j}\\right)$ . This modification, however, misses the discretization step, which is an important step in our model. We later use the discretization step to (1) empower the model to select (resp. fliter) relevant (resp. irrelevant) information, (2) adaptively adjust the resolution of the method, capturing seasonal patterns. ", "page_idx": 3}, {"type": "text", "text": "From now on, we use $t$ (resp. $v$ ) to refer to the index along the time (resp. variate) dimension. Therefore, for the sake of simplicity, we reformulate Equation 5 as follows: ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{h_{v,t+1}^{(1)}=\\bar{\\mathbf{A}}_{1}h_{v,t}^{(1)}+\\bar{\\mathbf{A}}_{2}h_{v,t}^{(2)}+\\bar{\\mathbf{B}}_{1}\\mathbf{x}_{v,t+1},}\\\\ &{h_{v+1,t}^{(2)}=\\bar{\\mathbf{A}}_{3}h_{v,t}^{(1)}+\\bar{\\mathbf{A}}_{4}h_{v,t}^{(2)}+\\bar{\\mathbf{B}}_{2}\\mathbf{x}_{v+1,t},}\\\\ &{\\mathbf{y}_{v,t}=\\mathbf{C}_{1}h_{v,t}^{(1)}+\\mathbf{C}_{2}h_{v,t}^{(2)},}\\end{array}\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "where $\\bar{\\mathbf{A}}_{1},\\bar{\\mathbf{A}}_{2},\\bar{\\mathbf{A}}_{3},\\bar{\\mathbf{A}}_{4}\\in\\mathbb{R}^{N\\times N},\\,\\bar{\\mathbf{B}}_{1},\\bar{\\mathbf{B}}_{2}\\,\\in\\,\\mathbb{R}^{N\\times1}$ , and $\\mathbf{C}_{1},\\mathbf{C}_{2}\\,\\in\\,\\mathbb{R}^{1\\times N}$ are parameters of the model, $h_{v,t}^{(1)},h_{v,t}^{(2)}\\,\\in\\,\\mathbb{R}^{N\\times d}$ are hidden states, and $\\mathbf{x}_{v,t}\\,\\in\\,\\mathbb{R}^{1\\times d}$ is the input. In this formulation, intuitively, $h_{v,t}^{(1)}$ is the hidden state that carries cross-time information (each state depends on its previous time stamp but within the same variate), where $\\bar{\\bf A}_{1}$ and $\\bar{\\bf A}_{2}$ control the emphasis on past cross-time and cross-variate information, respectively. Similarly, $h_{v,t}^{(2)}$ is the hidden state that carries cross-variate information (each state depends on other variates but with the same time stamp). Later in this section, we discuss to modify the model to bi-directional setting along the variate dimension, to enhance information flow along this non-causal dimension. ", "page_idx": 3}, {"type": "text", "text": "Interpretation of Discretization. Time series data are often sampled from an underlying continuous process [39, 40]. In these cases, variable $\\Delta_{1}$ in the discretization of the time axis can be interpreted as resolution or the sampling rate from the underlying continuous data. However, discretization along the variate axis, which is discrete by its nature, or when working directly with discrete data [41] is an unintuitive process, and raise questions about its significance. The discretization step in 1D SSMs has deep connections to gating mechanisms of RNNs [42, 33], automatically ensures that the model is normalized [43], and results in desirable properties such as resolution invariance [32]. ", "page_idx": 3}, {"type": "image", "img_path": "ncYGjx2vnE/tmp/94e0ec1e11b82510fdceb86a0bcb8da16dc95ba097610514dbfd51fc888d0bb4.jpg", "img_caption": ["Figure 2: Different forms of Chimera. (Top-Left) Chimera has a recurrence form (bi-directional along the variates), which also can be computed as a global convolution in training. (Top-Right) In forecasting, we present the multivariate closed-loop to improve the performance for long horizons. (Bottom) Using data-dependent parameters, Chimera training can be done as a parallel 2D scan. "], "img_footnote": [], "page_idx": 4}, {"type": "text", "text": "", "page_idx": 4}, {"type": "text", "text": "Proposition 3.1. The $2D$ discrete SSM introduced in Equation 6-8 with parameters $(\\{\\bar{\\mathbf{A}_{i}^{\\bullet}}\\},\\{\\bar{\\mathbf{B}}_{i}\\},\\{\\bar{\\mathbf{C}}_{i}\\},k\\underline{{\\Delta_{1}}},\\ell\\underline{{\\Delta_{2}}})$ evolves at a rate $k$ (resp. \u2113) times as fast as the $2D$ discrete SSM with parameters $(\\{\\bar{\\mathbf{A}}_{i}\\},\\{\\bar{\\mathbf{B}}_{i}\\},\\{\\bar{\\mathbf{C}}_{i}\\},\\Delta_{1},\\ell\\Delta_{2})$ (resp. $(\\{\\bar{\\mathbf{A}_{i}}\\},\\{\\bar{\\mathbf{B}}_{i}\\},\\{\\bar{\\mathbf{C}}_{i}\\},k\\Delta_{1},\\Delta_{2})^{2}$ . ", "page_idx": 4}, {"type": "text", "text": "Accordingly, parameters $\\Delta_{1}$ can be viewed as the controller of the length of dependencies that the model captures. That is, based on the above result, we see the discretization along the time axis as the setting of the resolution or sampling rate: while small $\\Delta_{1}$ can capture long-term progression, larger $\\Delta_{1}$ captures seasonal patterns. For now, we see the discretization along the variate axis as a mechanism similar to gating in RNNs [44, 33], where $\\Delta_{2}$ controls the length of the model context. Larger values of $\\Delta_{2}$ means less context window, ignoring other variates, while smaller values of $\\Delta_{2}$ means more emphesis on the dependencies of variates. Later, inspired by Gu and Dao [33], we discuss making $\\Delta_{2}$ as the function of the input, resulting in a selection mechanism that filters irrelevant variates. ", "page_idx": 4}, {"type": "text", "text": "Structure of Transition Matrices. For Chimera to be expressive and able to recover autoregressive process, hidden states $h_{v,t}^{(1)}$ should carry information about past time stamps. While making all the parameters in $\\mathbf{A}_{i}$ learnable allows the model to learn any arbitrary structure for $\\mathbf{A}_{i}$ , previous studies show that this is not possible unless the structure of transition matrices are restricted [45, 46]. To this end, inspired by Zhang et al. [28] that argue that companion matrices are effective to capture the dependencies along the time dimension, we restrict ${\\bf A}_{1}$ and $\\mathbf{A}_{2}$ matrices to have companion structure (see Appendix D for the details). Not only this formulation is shown to be effective for capturing dependencies along the time dimension [28] (also see Theorem 3.4), but it also can help us to compute the power of ${\\bf A}_{1}$ and $\\mathbf{A}_{2}$ faster in the convolutional form, as discussed by Zhang et al. [28]. Also, for ${\\bf A}_{3}$ and ${\\bf A}_{4}$ , we observe that even a simpler structure of diagonal matrices is effective to fuse information along the variate dimension. Not only these simple structured matrices make the training of the model faster, but they also are proven to be effective [45]. ", "page_idx": 4}, {"type": "text", "text": "Bi-Directionality. The causal nature of the 2D SSM result in limited information flow along the variate dimension as variate are not ordered. To overcome this challenge, inspired by the bi-directional 1D SSMs [47, 48, 1], we use two different modules for forward and backward pass along the variate dimension. The details of formulation is in Appendix E. ", "page_idx": 4}, {"type": "text", "text": "Convolution Form. As discussed by Baron et al. [49], similar to 1D SSMs [34], the data-independent formulation of 2D-SSMs can be viewed as a convolution with a kernel K. This formulation not only results in faster training by providing the ability of parallel processing, but it also connect Chimera with very recent studies of modern convolution-based architecture for time series [9]. Applying the recurrent rules in Equation 6-8, we can write the output as: ", "page_idx": 4}, {"type": "text", "text": "", "page_idx": 5}, {"type": "equation", "text": "$$\n\\mathbf{y}_{v,t}=\\sum_{1\\leq\\hat{v}\\leq v}\\sum_{1\\leq\\hat{t}\\leq t}\\left(\\mathbf{C}_{1}\\mathbf{K}_{\\hat{v},\\hat{t}}^{(1)}+\\mathbf{C}_{2}\\mathbf{K}_{\\hat{v},\\hat{t}}^{(2)}\\right)\\mathbf{x}_{\\hat{v},\\hat{t}},\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "where kernels $\\begin{array}{r}{{\\bf K}_{\\hat{v},\\hat{t}}^{(\\tau)}=\\sum_{(z_{1},\\dots,z_{5})\\in{\\bf P}^{(\\tau)}}q_{i}\\;\\bar{\\bf A}_{1}^{p_{1}}\\bar{\\bf A}_{2}^{p_{2}}\\bar{\\bf A}_{3}^{p_{3}}\\bar{\\bf A}_{4}^{p_{4}}\\bar{\\bf B}_{p_{5}}}\\end{array}$ , and $\\mathbf{P}^{(\\tau)}$ is the partitioning of the paths from the starting point to $(\\hat{v},\\hat{t})$ for $\\tau\\in\\{1,2\\}$ . As discussed by Baron et al. [49], if the power of $\\bar{\\mathbf{A}}_{i}\\mathbf{s}$ are given and cached, calculating the partitioning of all paths can be done very efficiently (near-linearly) as it the generalization of pascal triangle. To calculate the power of $\\bar{\\mathbf{A}}_{i}$ , note that we use diagonal matrices as the structure of $\\dot{\\mathbf{A}}_{3}$ , and $\\bar{\\bf A}_{4}$ , and so computing their powers is very fast. On the other hand, for $\\bar{\\bf A}_{1}$ and $\\bar{\\bf A}_{2}$ with companion structures, we can use sparse matrix multiplication, which results in linear complexity in terms of the sequence length. ", "page_idx": 5}, {"type": "text", "text": "Data-Dependent Parameters. As discussed earlier, parameters $\\bar{\\mathbf{A}}_{1}$ and $\\bar{\\bf A}_{2}$ controls the emphasis on past cross-time and cross-variate information. Similarly, parameters $\\Delta_{1}$ and $\\bar{\\bf B}_{1}$ controls the emphasis on the current input and historical data. Since these parameters are data-independent, one can interpret them as a global feature of the system. In complex systems (e.g., human neural activity), however, the emphasis depends on the current input, requiring these parameters to be the function of the input (see $\\S4.1\\$ ). The input-dependency of parameters allows the model to select relevant and fliter irrelevant information for each input data, providing a similar mechanism as transformers [33]. Additionally, as we argue earlier, depending on the data, the model needs to adaptively learn if mixing information along the variates is useful. Making parameters input-dependent further overcomes this challenge and lets our model to mix relevant and filter irrelevant variates for the modeling of a variate of interest. One of our main technical contributions is to let $\\bar{\\mathbf{B}}_{i}$ , $\\bar{\\mathbf{C}}_{i}$ , and $\\Delta_{i}$ for $i\\in\\{1,2\\}$ be the function of the input ${\\bf{x}}_{v,t}$ . This input-dependent 2D SSM, unfortunately, does not have the convolution form, limiting the scalability and efficiency of the training. We overcome this challenge by computing the model recurrently with a new 2D scan. ", "page_idx": 5}, {"type": "text", "text": "2D Selective Scan. Inspired by the scanning in 1D SSMs [50, 33], we present an algorithm to decrease the sequential steps that are required to calculate hidden states. Given $p,q$ , each of which with 6 elements, we first define operation \u22c7as: ( $\\odot$ is matrix-matrix and $\\otimes$ is matrix-vector multiplication) ", "page_idx": 5}, {"type": "equation", "text": "$$\np\\stackrel{,}{\\ast}q=\\binom{p_{1}}{p_{4}}\\begin{array}{c c c}{p_{2}}&{p_{3}}\\\\ {p_{5}}&{p_{6}}\\end{array}\\stackrel{,}{\\ast}\\left(\\begin{array}{c c c}{q_{1}}&{q_{2}}&{q_{3}}\\\\ {q_{4}}&{q_{5}}&{q_{6}}\\end{array}\\right)=\\binom{q_{1}\\odot\\,p_{1}}{q_{4}\\odot\\,p_{4}}\\begin{array}{c c c}{q_{2}\\odot\\,p_{2}}&{q_{1}\\otimes p_{3}+q_{2}\\otimes p_{6}+q_{3}}\\\\ {q_{5}\\odot\\,p_{5}}&{q_{4}\\otimes p_{3}+q_{5}\\otimes p_{6}+q_{6}}\\end{array}\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "The proofs of the next two theorems are in Appendix G. ", "page_idx": 5}, {"type": "text", "text": "Theorem 3.2. Operator \u22c7is associative: Given $p,q$ , and $r$ , we have: $(p\\ast q)\\ast r=p\\ast(q\\ast r)$ . Theorem 3.3. 2D SSM recurrence can be done in parallel using parallel prefix sum algorithms with associative operator \u22c7, when fixing the variate. ", "page_idx": 5}, {"type": "text", "text": "3.2 New Variant of 2D SSM: 2D Mamba ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "Figure 2 (Top-Left) shows the recurrence form of our 2D SSM. Each small square is a state of the system, i.e., the state of a variate at a certain time stamp. 2D SSM considers two hidden states for each state (represented by two colors: light red and blue), encoding the information along the time (red) and variate (blue), respectively. Furthermore, each arrow represents a transition matrix $\\mathbf{A}_{i}$ that decides to how information need to be fused. In this section, we discuss a spacial instance of our 2D SSM by limiting its parameters. ", "page_idx": 5}, {"type": "text", "text": "2D Mamba. We let $\\mathbf{A}_{2}=\\mathbf{A}_{3}=\\mathbf{0}$ in our 2D SSM. The resulting model is equivalent to: ", "page_idx": 5}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{h_{v,t+1}^{(1)}=\\bar{\\mathbf{A}}_{1}h_{v,t}^{(1)}+\\bar{\\mathbf{B}}_{1}\\mathbf{x}_{v,t+1},}\\\\ &{h_{v+1,t}^{(2)}=\\bar{\\mathbf{A}}_{4}h_{v,t}^{(2)}+\\bar{\\mathbf{B}}_{2}\\mathbf{x}_{v+1,t},}\\\\ &{\\mathbf{y}_{v,t}=\\mathbf{C}_{1}h_{v,t}^{(1)}+\\mathbf{C}_{2}h_{v,t}^{(2)},}\\end{array}\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "where $\\bar{\\bf A}_{1}\\ =\\ \\exp\\left(\\Delta_{1}{\\bf A}_{1}\\right),\\ \\bar{\\bf A}_{2}\\ =\\ \\exp\\left(\\Delta_{2}{\\bf A}_{2}\\right),\\ \\bar{\\bf B}_{1}\\ =\\ \\left[{\\bf A}_{1}^{-1}\\left(\\bar{\\bf A}_{1}-{\\bf I}\\right){\\bf B}_{1}^{(1)}\\right],$ and $\\begin{array}{r l}{\\bar{\\bf B}_{2}}&{{}=}\\end{array}$ $\\left[\\mathbf{1}_{4}^{-1}\\left(\\bar{\\mathbf{A}}_{4}^{}-\\mathbf{I}\\right)\\mathbf{B}_{2}^{(2)}\\right]$ . This formulation with data-dependent parameters, is equivalent to using two ", "page_idx": 5}, {"type": "text", "text": "S6 blocks [33] each of which along a dimension. Notably, these two S6 blocks are not separate as the output ${\\bf y}_{v,t}$ is based on both hidden states $h_{v,t}^{(1)}$ and $h_{v,t}^{(2)}$ , capturing 2D inductive bias. ", "page_idx": 6}, {"type": "text", "text": "3.3 Chimera Neural Architecture ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "In this section, we use a stack of our 2D SSMs, with non-linearity in between, to enhance the expressive power and capabilities of the abovementioned 2D SSM. To this end, similar to deep SSM models [28], we allow all parameters to be learnable and in each layer we use multiple 2D SSMs, each of which with its own responsibility. Also, in the data-dependent variant of Chimera, we let parameters $\\mathbf{B}_{i},\\mathbf{C}_{i}$ , and $\\Delta_{i}$ for $i\\in\\{1,2\\}$ be the function of the input x: ", "page_idx": 6}, {"type": "equation", "text": "$$\n\\mathbf{B}_{i}=\\mathbf{\\mathrm{Linear}}_{\\mathbf{B}_{i}}(x),\\qquad\\mathbf{C}_{i}=\\mathbf{\\mathrm{Linear}}_{\\mathbf{C}_{i}}(x),\\qquad\\Delta_{i}=\\mathbf{\\mathrm{Softplus}}\\left(\\mathbf{\\mathrm{Linear}}_{\\Delta_{i}}(x)\\right).\n$$", "text_format": "latex", "page_idx": 6}, {"type": "text", "text": "Chimera follows the commonly used decomposition of time series, and decomposes them into trend components and seasonal patterns. it, however, uses special traits of 2D SSM to capture these terms. ", "page_idx": 6}, {"type": "text", "text": "Seasonal Patterns. To capture the multi-resolution seasonal patterns, we take advantage of the discretization process. Proposition 3.1 states that if $\\mathbf{x}(v,t)\\,\\,\\mapsto\\,\\,\\mathbf{y}(v,t)$ with parameters $(\\{\\bar{\\mathbf{A}}_{i}\\},\\{\\bar{\\mathbf{B}}_{i}\\},\\{\\bar{\\mathbf{C}}_{i}\\}\\overset{\\cdot}{,}\\Delta_{1},\\Delta_{2})$ then ${\\bf x}(v,k t)\\;\\mapsto\\;{\\bf y}(v,k t)$ with $(\\{\\bar{\\mathbf{A}}_{i}\\},\\{\\bar{\\mathbf{B}}_{i}\\},\\{\\bar{\\mathbf{C}}_{i}\\},k\\Delta_{1},\\Delta_{2})$ . Accordingly, we use $2{\\mathsf{D}}{-}{\\mathsf{S S M}}(.)$ module with a separate learnable $\\Delta_{s}$ that is responsible to learn the best resolution to capture seasonal patterns. Another interpretation for this module is based on $\\mathrm{SAR}(p,q,s)$ (Equation 4). In this case, $\\Delta_{s}$ aims to learn a proper parameter $s$ to capture seasonal patterns. Since we expect the resolution before and after this module matches, we add additional re-discretization module (a simple linear layer), after this module. ", "page_idx": 6}, {"type": "text", "text": "Trend Components. The second module of Chimera, $2\\mathtt{D-S S M}_{t}$ (.) simply uses a sequence of multiple 2D SSMs to learn trend components. Proper combination of the outputs of this and the previous modules can capture both seasonal and trend components. ", "page_idx": 6}, {"type": "text", "text": "Both Modules Together. We followed previous studies [51] and consider residual connection modeling for learning trend and seasonal patterns. Given input data $\\tilde{\\mathbf{X}}_{0}=\\mathbf{X}$ , and $\\ell=0,\\ldots,\\mathcal{L}$ , we have: ", "page_idx": 6}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\hat{\\mathbf{X}}_{\\ell+1}=2\\mathrm{D}\\mathrm{-}\\mathrm{SSM}_{t}\\left(\\tilde{\\mathbf{X}}_{\\ell}\\right),}\\\\ &{\\tilde{\\mathbf{X}}_{\\ell+1}=\\mathtt{R e}\\mathrm{-}\\mathrm{Di}\\,\\mathrm{scretization}\\left(2\\mathrm{D}\\mathrm{-}\\mathrm{SSM}_{s}\\left(\\tilde{\\mathbf{X}}_{\\ell}-\\hat{\\mathbf{X}}_{\\ell+1}\\right)\\right).}\\end{array}\n$$", "text_format": "latex", "page_idx": 6}, {"type": "text", "text": "Figure 1 illustrate the architecture of Chimera. Due to the ability of our 2D SSM to recover smoothing techniques (see Theorem 3.4), this combination of modules for trend and seasonal patterns can be viewed as a generalization of traditional methods that use moving average with residual connection to model seasonality [51]. ", "page_idx": 6}, {"type": "text", "text": "Gating with Linear Mapping. Inspired by the success of gated recurrent and SSM-based models [52, 33], we use a head of a fully connected layer with Swish [53], resulting in SwiGLU variant [54]. While we validate the significance of this head, this ", "page_idx": 6}, {"type": "text", "text": "Closed-Loop 2D SSM Decoder. To enhance the generalizability and the ability of our model for longer-horizon, we extend the closed-loop decoder module [28], which is similar to autoregression, to multivariate time series. We use distinct processes for the inputs and outputs, using additional matrices $\\mathbf{D}_{1}$ and $\\mathbf{D}_{2}$ in each decoder 2D SSM, we model future input time-steps explicitly: ", "page_idx": 6}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{{\\bf y}_{v,t}={\\bf C}_{1}h_{v,t}^{(1)}+{\\bf C}_{2}h_{v,t}^{(2)},}\\\\ &{{\\bf u}_{v,t}={\\bf D}_{1}h_{v,t}^{(1)}+{\\bf D}_{2}h_{v,t}^{(2)},}\\end{array}\n$$", "text_format": "latex", "page_idx": 6}, {"type": "text", "text": "where $\\mathbf{u}_{v,t}$ is the next input and ${\\bf y}_{v,t}$ is the output. Note that the other parts (recurrence) are the same as Equation 6. Figure 2 illustrate the architecture of closed-loop 2D SSM. ", "page_idx": 6}, {"type": "text", "text": "3.4 Theoretical Justification ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "In this section, we provide some theoretical evidences for the performance of Chimera. These results are mostly revisiting the theorems by Zhang et al. [28] and Baron et al. [49], and extending them ", "page_idx": 6}, {"type": "text", "text": "for Chimera. In the first theorem, we show that Chimera recovers several classic methods, and pre-processing steps as it can recover SpaceTime [28] and additionally because of its design, it can recover SARIMA [15]: ", "page_idx": 7}, {"type": "text", "text": "Theorem 3.4. Chimera can represent seasonal autoregressive process, SARIMA [15], SpaceTime [28], and so ARIMA [14], and exponential smoothing [16]. ", "page_idx": 7}, {"type": "text", "text": "Theorem 3.5. Chimera can represent S4nd [32], TSM2 [31], and TSMixer [30]. ", "page_idx": 7}, {"type": "text", "text": "Next theorem compares the expressiveness of Chimera with some existing 2D deep SSMs. Since Chimera can recover 2DSSM [49], it can express full-rank kernels with a constant number of parameters: ", "page_idx": 7}, {"type": "text", "text": "Theorem 3.6. Similar to 2DSSM [49], Chimera can express full-rank kernels with $\\mathcal{O}\\left(1\\right)$ parameters, while existing deep SSMs [32, 31] require $\\mathcal{O}\\left(N\\right)$ parameters to express $N$ -rank kernels. ", "page_idx": 7}, {"type": "text", "text": "4 Experiments ", "text_level": 1, "page_idx": 7}, {"type": "text", "text": "Goals and Baselines. We evaluate Chimera on a wide range of time series tasks. In $\\S\\,{4.1}$ we compare Chimera with the state-of-the-art general multivariate time series models [8, 9, 18, 20, 21, 24, 26, 27, 31, 55\u201357] on long-term forecasting and classification tasks. In the next part, we test the performance of Chimera in short-term forecasting. In $\\S\\ 4.1$ we perform a case study on human neural activity to classify seen images, which requires capturing complex dynamic dependencies of variates, to test the ability of Chimera in capturing cross-variate information and the significance of data-dependency. In $\\S\\ 4.2$ , we evaluate the significance of the Chimera\u2019s components by performing ablation studies. In $\\S\\ 4.2$ , we evaluate whether the superior performance of Chimera coincide with its efficiency. Finally, we test the Chimera\u2019s generalizability on unseen variates and further evaluate its ability to filter irrelevant context in $\\S\\ 4.3$ . The details and additional experiments are in Appendix I. ", "page_idx": 7}, {"type": "table", "img_path": "ncYGjx2vnE/tmp/00061adb3be409be1dc60249455f1cc0fa3e155691e2c58edc6ece533e4b4100.jpg", "table_caption": ["Table 1: Average Performance on long-term forecasting task. The first and second results are highlighted in red (bold) and orange (underline). Full results are reported in Appendix I. "], "table_footnote": [], "page_idx": 7}, {"type": "text", "text": "4.1 Main Results: Classification and Forecasting ", "text_level": 1, "page_idx": 7}, {"type": "text", "text": "Long-Term Forecasting. We perform experiments in long-term forecasting task on benchmark datasets [6]. Table 1 reports the average of results over different horizons (for the results of each see Table 8). Chimera shows outstanding performance, achieving the best or the second best results in all the datasets and outperforms baselines in 5 out of 8 benchmarks. Notably, it surpasses extensively studied MLP-based and Transformer-based models while being more efficient (see Table 3, Figure 4, and Appendix I), providing a better balance of performance and efficiency. It further significantly outperforms recurrent models, including very recent Mamba-based architectures [31, 57], unleashing the potential of classical models, SSMs, when are carefully designed in deep learning settings. ", "page_idx": 7}, {"type": "text", "text": "Classification and Anomaly Detection. We evaluate the performance of Chimera in ECG classification on PTB-XL dataset [7] (see Table 2), speech classification [39] (Table 3), 10 multivariate datasets from UEA Time Series Classification Archive [60] (see Figure 3 and Table 10), and anomaly detection tasks on five widely-used benchmarks: SMD [10], SWaT [61], PSM [62] and SMAP [63] (see Figure 3 and Table 11). For each benchmark, we use the state-of-the-art methods that are applicable to the task as the baselines. Table 2 reports the performance of Chimera and baselines on ECG classification tasks. Chimera outperforms all the baselines in 4/6 tasks, while achieving the second best results on the remaining tasks. Since these tasks are univariate time series, we attribute the outstanding performance of Chimera, specifically compared to SpaceTime [28], to its ability of capturing seasonal patterns and its input-dependent parameters, resulting in dynamically learn dependencies. ", "page_idx": 7}, {"type": "text", "text": "", "page_idx": 8}, {"type": "text", "text": "Table 3 reports the results on speech audio classification task, which require long-range modeling of time series. Due to the length of the sequence (16K), LSSL [34] and Transformer [17] has out of memory (OOM) issue, showing the efficiency of Chimera compared to alternative backbones. ", "page_idx": 8}, {"type": "text", "text": "Finally, we report the summary of the results in multivariate time series classification and anomaly detection tasks in Figure 3. The full list of results can be found in Table 10 and Table 11. Chimera shows outstanding performance, achieving highest average accuracy and F1 score in classification and anomaly detection tasks even compared to very recent and state-of-the-art methods [8, 9]. ", "page_idx": 8}, {"type": "table", "img_path": "ncYGjx2vnE/tmp/fd7dadf61b07b82fd5cfdcd915a1c104bbb6f51b7364f0afde41d2a2d84c81c6.jpg", "table_caption": ["Table 2: ECG statement classification on PTB-XL ( $100\\:\\mathrm{Hz}$ version). Table 3: Speech classification. "], "table_footnote": [], "page_idx": 8}, {"type": "text", "text": "Short-Term Forecasting. Our evaluation on short-term forecasting tasks on M4 benchmark datasets [64] reports in Table 4 (Full list in Table 9), which also shows the superior performance of Chimera compared to baselines. ", "page_idx": 8}, {"type": "table", "img_path": "ncYGjx2vnE/tmp/9664aa02744ca41c062ff056338bcb5819b5949007b094f85ae53148f4eec83a.jpg", "table_caption": ["Table 4: Short-term forecasting task on the M4 dataset. Full results are reported in Appendix I. "], "table_footnote": [], "page_idx": 8}, {"type": "text", "text": "Case Study of Brain Activity. Input dependency is a must to capture the dynamic of dependencies. To support this claim, we use BVFC [2] (multivariate time series only), which aim to classify seen images by its corresponding brain activity response. This task, requires focusing more on the dependencies of brain units and their responses rather than the actual time series. Also, since each window corresponds to a specific image, the model needs to capture the dependencies based on the current window, requiring to be input-dependent. Results are reported in Table 5. Chimera significantly outperforms all the baselines including our Chimera but without data-dependent parameters (convolution form). Due to the large number of brain units, i.e., 9K, in the first dataset, transformer-based methods face OOM issue. However, they are also data-dependent and so shows the second best results in second and third datasets. This results support the significance of data-dependency in Chimera. ", "page_idx": 8}, {"type": "text", "text": "4.2 Ablation Study and Efficiency ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "To evaluate the significance of the Chimera\u2019s design, we perform ablation studies and remove one of the components at each time, keeping other parts unchanged. Table 6 reports the results. The first row reports the Chimera\u2019s performance, while row 2 uses unidirectional recurrence along the variate dimension, row 3 removes the gating mechanism, row 4 uses convolution form (data-independent), and row 5 removes the module for seasonal patterns. The results show that all the components of Chimera contributes to its performance. ", "page_idx": 8}, {"type": "table", "img_path": "ncYGjx2vnE/tmp/2fcd185706c6d58e5c85be1b689a4d712d117f7d84ba95e56adc04755623c34d.jpg", "table_caption": ["Table 5: Image classification by brain activity (Acc. $\\%$ ). "], "table_footnote": [], "page_idx": 9}, {"type": "image", "img_path": "ncYGjx2vnE/tmp/db8c75fa73e05f8a98a17cdc3ec1f6b00731ac1640a9ee71f915ed9bda8816c2.jpg", "img_caption": [], "img_footnote": [], "page_idx": 9}, {"type": "table", "img_path": "ncYGjx2vnE/tmp/8083a4ad94626994367660a23412e360c51ba63554f788e7a515320259b2ae81.jpg", "table_caption": ["Table 6: Ablation study on the Chimera\u2019s design. "], "table_footnote": [], "page_idx": 9}, {"type": "image", "img_path": "ncYGjx2vnE/tmp/f269601163fca20663303dc60d41e56d5bd1ff22a057c244ffdc84ef5d160c2e.jpg", "img_caption": ["Figure 3: Classification and anomaly detection performance. Full list with additional baselines is in Appendix I. ", "Figure 4: Wall-clock scaling. "], "img_footnote": [], "page_idx": 9}, {"type": "text", "text": "Length of Time Series. We perform experiments on the effect of the sequence length on the efficiency of Chimera and baselines. The results are reported in Figure 4. Chimera scales linearly with respect to the sequence length and has smoother scaling than S4 [34] and Transformers [17]. These results also highlight the significance of our algorithm that uses 2D parallel scans for training Chimera. This algorithm results in $\\approx\\times4$ faster training, which is very closed to the convolutional format without data dependency. Chimera also has a close running time to SpaceTime [28], which has 1D recurrent. ", "page_idx": 9}, {"type": "text", "text": "4.3 Selection Mechanism Along Time and Variate ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "Variate Generalization. We argue that the data-dependency with discretization allows the model to filter the irrelevant context based on the input, resulting in more generalizability. Inspired by Liu et al. [27], we train our model (and baseline) on $20\\%$ of variates and evaluate its generalizability to unseen variates. The results are reported in Figure 5. Chimera has on par generalizability compared to Transformers (when applied along the variate dimension), which we attributes to its data-dependent parameters as Chimera with convolution form performs poorly on unseen variates. ", "page_idx": 9}, {"type": "text", "text": "Context Filtering. Increasing the lookback length does not necessarily result in better performance for Transformers [27]. Due to the selection mechanism of Chimera, we expect it to filter irrelevant information and monotonically performs better. Figure 6 reports the Chimera\u2019s performance (w/ and w/o data-dependency) and transformer-based baselines [6, 22] while varying the lookback length. Chimera due to its selection mechanism monotonically performs better with increasing the lookback. ", "page_idx": 9}, {"type": "image", "img_path": "ncYGjx2vnE/tmp/e6ad57b7f0a7e8beb5cdcbe678dfa66b5a02b8cf04442d735a4c11285973b7c5.jpg", "img_caption": ["Figure 5: Selection results in generalization to unseen variates. "], "img_footnote": [], "page_idx": 9}, {"type": "image", "img_path": "ncYGjx2vnE/tmp/4157dbf822ea15154289baa13f92172fe541f4be15cf7e95754aebb9b59e324a.jpg", "img_caption": ["Figure 6: Effect of lookback length. "], "img_footnote": [], "page_idx": 9}, {"type": "text", "text": "5 Conclusion ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "This paper presents Chimera, a three-headed 2-dimensional SSM model with provably high expressive power. Chimera is based on 2D SSMs with careful design of parameters that allows it to dynamically and simultaneously capture the dependencies along both time and variate dimensions. We provide different views of our 2D SSM for efficient training, and present a data-dependent formulation with a fast implementation using 2D scans. Our experimental and theoretical results support the effectiveness and efficiency of Chimera in a wide range of tasks. ", "page_idx": 9}, {"type": "text", "text": "Acknowledgments and Disclosure of Funding ", "text_level": 1, "page_idx": 10}, {"type": "text", "text": "This material is based upon work supported by the National Science Foundation under Award No. 2306556. Any opinions, findings and conclusions or recommendations expressed in this material are those of the authors and do not necessarily reflect the views of the National Science Foundation. ", "page_idx": 10}, {"type": "text", "text": "References ", "text_level": 1, "page_idx": 10}, {"type": "text", "text": "[1] Ali Behrouz and Farnoosh Hashemi. Brain-mamba: Encoding brain activity via selective state space models. In Conference on Health, Inference, and Learning, pages 233\u2013250. PMLR, 2024.   \n[2] Ali Behrouz, Parsa Delavari, and Farnoosh Hashemi. Unsupervised representation learning of brain activity via bridging voxel activity and functional connectivity. In International conference on machine learning (ICML), 2024.   \n[3] Plamen Ch Ivanov, Luis A Nunes Amaral, Ary L Goldberger, Shlomo Havlin, Michael G Rosenblum, Zbigniew R Struzik, and H Eugene Stanley. Multifractality in human heartbeat dynamics. Nature, 399(6735):461\u2013465, 1999. [4] Kelum Gajamannage, Yonggi Park, and Dilhani I Jayathilake. Real-time forecasting of time series in financial markets using sequentially trained dual-lstms. Expert Systems with Applications, 223:119879, 2023.   \n[5] Steve Pincus and Rudolf E Kalman. Irregularity, volatility, risk, and financial market time series. Proceedings of the National Academy of Sciences, 101(38):13709\u201313714, 2004.   \n[6] Haoyi Zhou, Shanghang Zhang, Jieqi Peng, Shuai Zhang, Jianxin Li, Hui Xiong, and Wancai Zhang. Informer: Beyond efficient transformer for long sequence time-series forecasting. In Proceedings of the AAAI conference on artificial intelligence, volume 35, pages 11106\u201311115, 2021.   \n[7] Patrick Wagner, Nils Strodthoff, Ralf-Dieter Bousseljot, Dieter Kreiseler, Fatima I Lunze, Wojciech Samek, and Tobias Schaeffter. Ptb-xl, a large publicly available electrocardiography dataset. Scientific data, 7(1):1\u201315, 2020.   \n[8] Haixu Wu, Tengge Hu, Yong Liu, Hang Zhou, Jianmin Wang, and Mingsheng Long. Timesnet: Temporal 2d-variation modeling for general time series analysis. In The Eleventh International Conference on Learning Representations, 2023. URL https://openreview.net/forum? id=ju_Uqw384Oq.   \n[9] Donghao Luo and Xue Wang. ModernTCN: A modern pure convolution structure for general time series analysis. In The Twelfth International Conference on Learning Representations, 2024. URL https://openreview.net/forum?id $\\equiv$ vpJMJerXHU.   \n[10] Ya Su, Youjian Zhao, Chenhao Niu, Rong Liu, Wei Sun, and Dan Pei. Robust anomaly detection for multivariate time series through stochastic recurrent neural network. In Proceedings of the 25th ACM SIGKDD international conference on knowledge discovery & data mining, pages 2828\u20132837, 2019.   \n[11] Ailing Zeng, Muxi Chen, Lei Zhang, and Qiang Xu. Are transformers effective for time series forecasting? In AAAI, 2023.   \n[12] Andrew C Harvey. Forecasting, structural time series models and the kalman fliter. Cambridge university press, 1990.   \n[13] Masanao Aoki. State space modeling of time series. Springer Science & Business Media, 2013.   \n[14] David J Bartholomew. Time series analysis forecasting and control., 1971.   \n[15] Michael Bender and Slobodan Simonovic. Time-series modeling for long-range stream-flow forecasting. Journal of Water Resources Planning and Management, 120(6):857\u2013870, 1994.   \n[16] Peter R Winters. Forecasting sales by exponentially weighted moving averages. Management science, 6(3):324\u2013342, 1960.   \n[17] Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N Gomez, \u0141ukasz Kaiser, and Illia Polosukhin. Attention is all you need. Advances in neural information processing systems, 30, 2017.   \n[18] Bryan Lim and Stefan Zohren. Time-series forecasting with deep learning: a survey. Philosophical Transactions of the Royal Society A, 379(2194):20200209, 2021.   \n[19] Zonglei Chen, Minbo Ma, Tianrui Li, Hongjun Wang, and Chongshou Li. Long sequence time-series forecasting with deep learning: A survey. Information Fusion, 97:101819, 2023.   \n[20] Gerald Woo, Chenghao Liu, Doyen Sahoo, Akshat Kumar, and Steven C. H. Hoi. Etsformer: Exponential smoothing transformers for time-series forecasting. arXiv preprint arXiv:2202.01381, 2022.   \n[21] Haixu Wu, Jiehui Xu, Jianmin Wang, and Mingsheng Long. Autoformer: Decomposition transformers with auto-correlation for long-term series forecasting. Advances in neural information processing systems, 34:22419\u201322430, 2021.   \n[22] Haixu Wu, Jialong Wu, Jiehui Xu, Jianmin Wang, and Mingsheng Long. Flowformer: Linearizing transformers with conservation flows. In ICML, 2022.   \n[23] Shizhan Liu, Hang Yu, Cong Liao, Jianguo Li, Weiyao Lin, Alex X Liu, and Schahram Dustdar. Pyraformer: Low-complexity pyramidal attention for long-range time series modeling and forecasting. In International conference on learning representations, 2021.   \n[24] Tian Zhou, Ziqing Ma, Qingsong Wen, Xue Wang, Liang Sun, and Rong Jin. Fedformer: Frequency enhanced decomposed transformer for long-term series forecasting. In International conference on machine learning, pages 27268\u201327286. PMLR, 2022.   \n[25] Nikita Kitaev, Lukasz Kaiser, and Anselm Levskaya. Reformer: The efficient transformer. In ICLR, 2020.   \n[26] Yunhao Zhang and Junchi Yan. Crossformer: Transformer utilizing cross-dimension dependency for multivariate time series forecasting. In The eleventh international conference on learning representations, 2023.   \n[27] Yong Liu, Tengge Hu, Haoran Zhang, Haixu Wu, Shiyu Wang, Lintao Ma, and Mingsheng Long. itransformer: Inverted transformers are effective for time series forecasting. In The Twelfth International Conference on Learning Representations, 2024. URL https://openreview. net/forum?id $\\equiv$ JePfAI8fah.   \n[28] Michael Zhang, Khaled Kamal Saab, Michael Poli, Tri Dao, Karan Goel, and Christopher Re. Effectively modeling time series with simple discrete state spaces. In The Eleventh International Conference on Learning Representations, 2023. URL https://openreview.net/forum? id $\\equiv$ 2EpjkjzdCAa.   \n[29] Yuqi Nie, Nam H Nguyen, Phanwadee Sinthong, and Jayant Kalagnanam. A time series is worth 64 words: Long-term forecasting with transformers. In The Eleventh International Conference on Learning Representations, 2023. URL https://openreview.net/forum? id $=$ Jbdc0vTOcol.   \n[30] Si-An Chen, Chun-Liang Li, Nate Yoder, Sercan O Arik, and Tomas Pfister. Tsmixer: An all-mlp architecture for time series forecasting. arXiv preprint arXiv:2303.06053, 2023.   \n[31] Ali Behrouz, Michele Santacatterina, and Ramin Zabih. Mambamixer: Efficient selective state space models with dual token and channel selection. arXiv preprint arXiv:2403.19888, 2024.   \n[32] Eric Nguyen, Karan Goel, Albert Gu, Gordon Downs, Preey Shah, Tri Dao, Stephen Baccus, and Christopher R\u00e9. S4nd: Modeling images and videos as multidimensional signals with state spaces. Advances in neural information processing systems, 35:2846\u20132861, 2022.   \n[33] Albert Gu and Tri Dao. Mamba: Linear-time sequence modeling with selective state spaces. arXiv preprint arXiv:2312.00752, 2023.   \n[34] Albert Gu, Karan Goel, and Christopher Re. Efficiently modeling long sequences with structured state spaces. In International Conference on Learning Representations, 2022. URL https: //openreview.net/forum?id $\\equiv$ uYLFoz1vlAC.   \n[35] Sun-Yuan Kung, Bernard C Levy, Martin Morf, and Thomas Kailath. New results in 2-d systems theory, part ii: 2-d state-space models\u2014realization and the notions of controllability, observability, and minimality. Proceedings of the IEEE, 65(6):945\u2013961, 1977.   \n[36] Ettore Fornasini and Giovanni Marchesini. Doubly-indexed dynamical systems: State-space models and structural properties. Mathematical systems theory, 12(1):59\u201372, 1978.   \n[37] Rikus Eising. Realization and stabilization of 2-d systems. IEEE Transactions on Automatic Control, 23(5):793\u2013799, 1978.   \n[38] Ts Hinamoto. Realizations of a state-space model from two-dimensional input-output map. IEEE Transactions on Circuits and Systems, 27(1):36\u201344, 1980.   \n[39] Pete Warden. Speech commands: A dataset for limited-vocabulary speech recognition. arXiv preprint arXiv:1804.03209, 2018.   \n[40] Martin N Hebart, Oliver Contier, Lina Teichmann, Adam H Rockter, Charles Y Zheng, Alexis Kidder, Anna Corriveau, Maryam Vaziri-Pashkam, and Chris I Baker. Things-data, a multimodal collection of large-scale datasets for investigating object representations in human brain and behavior. Elife, 12:e82580, 2023.   \n[41] Alistair EW Johnson, Lucas Bulgarelli, Lu Shen, Alvin Gayles, Ayad Shammout, Steven Horng, Tom J Pollard, Sicheng Hao, Benjamin Moody, Brian Gow, et al. Mimic-iv, a freely accessible electronic health record dataset. Scientific data, 10(1):1, 2023.   \n[42] Corentin Tallec and Yann Ollivier. Can recurrent neural networks warp time? In International Conference on Learning Representations, 2018. URL https://openreview.net/forum? id=SJcKhk-Ab.   \n[43] Albert Gu, Isys Johnson, Aman Timalsina, Atri Rudra, and Christopher Re. How to train your HIPPO: State space models with generalized orthogonal basis projections. In International Conference on Learning Representations, 2023. URL https://openreview.net/forum? id=klK17OQ3KB.   \n[44] Albert Gu, Caglar Gulcehre, Thomas Paine, Matt Hoffman, and Razvan Pascanu. Improving the gating mechanism of recurrent neural networks. In International Conference on Machine Learning, pages 3800\u20133809. PMLR, 2020.   \n[45] Albert Gu, Karan Goel, Ankit Gupta, and Christopher R\u00e9. On the parameterization and initialization of diagonal state space models. In Alice H. Oh, Alekh Agarwal, Danielle Belgrave, and Kyunghyun Cho, editors, Advances in Neural Information Processing Systems, 2022. URL https://openreview.net/forum?id $=$ yJE7iQSAep.   \n[46] Albert Gu, Isys Johnson, Karan Goel, Khaled Saab, Tri Dao, Atri Rudra, and Christopher R\u00e9. Combining recurrent, convolutional, and continuous-time models with linear state space layers. Advances in neural information processing systems, 34:572\u2013585, 2021.   \n[47] Junxiong Wang, Jing Nathan Yan, Albert Gu, and Alexander Rush. Pretraining without attention. In Houda Bouamor, Juan Pino, and Kalika Bali, editors, Findings of the Association for Computational Linguistics: EMNLP 2023, pages 58\u201369, Singapore, December 2023. Association for Computational Linguistics. doi: 10.18653/v1/2023.findings-emnlp.5. URL https://aclanthology.org/2023.findings-emnlp.5.   \n[48] Ali Behrouz and Farnoosh Hashemi. Graph mamba: Towards learning on graphs with state space models. In Proceedings of the 30th ACM SIGKDD Conference on Knowledge Discovery and Data Mining, pages 119\u2013130, 2024.   \n[49] Ethan Baron, Itamar Zimerman, and Lior Wolf. A 2-dimensional state space layer for spatial inductive bias. In The Twelfth International Conference on Learning Representations, 2024. URL https://openreview.net/forum?id=BGkqypmGvm.   \n[50] Jimmy T.H. Smith, Andrew Warrington, and Scott Linderman. Simplified state space layers for sequence modeling. In The Eleventh International Conference on Learning Representations, 2023. URL https://openreview.net/forum?id $\\equiv$ Ai8Hw3AXqks.   \n[51] William Toner and Luke Darlow. An analysis of linear time series forecasting models. International conference on machine learning (ICML), 2024.   \n[52] Zhen Qin, Songlin Yang, and Yiran Zhong. Hierarchically gated recurrent neural network for sequence modeling. Advances in Neural Information Processing Systems, 36, 2023.   \n[53] Prajit Ramachandran, Barret Zoph, and Quoc V Le. Searching for activation functions. arXiv preprint arXiv:1710.05941, 2017.   \n[54] Hugo Touvron, Thibaut Lavril, Gautier Izacard, Xavier Martinet, Marie-Anne Lachaux, Timoth\u00e9e Lacroix, Baptiste Rozi\u00e8re, Naman Goyal, Eric Hambro, Faisal Azhar, et al. Llama: Open and efficient foundation language models. arXiv preprint arXiv:2302.13971, 2023.   \n[55] Abhimanyu Das, Weihao Kong, Andrew Leach, Shaan K Mathur, Rajat Sen, and Rose Yu. Longterm forecasting with tiDE: Time-series dense encoder. Transactions on Machine Learning Research, 2023. ISSN 2835-8856. URL https://openreview.net/forum?id $\\equiv$ pCbC3aQB5W.   \n[56] Minhao Liu, Ailing Zeng, Muxi Chen, Zhijian Xu, Qiuxia Lai, Lingna Ma, and Qiang Xu. Scinet: Time series modeling and forecasting with sample convolution and interaction. Advances in Neural Information Processing Systems, 35:5816\u20135828, 2022.   \n[57] Badri N. Patro and Vijay S. Agneeswaran. Simba: Simplified mamba-based architecture for vision and multivariate time series, 2024.   \n[58] Zhe Li, Shiyi Qi, Yiduo Li, and Zenglin Xu. Revisiting long-term time series forecasting: An investigation on linear mapping. arXiv preprint arXiv:2305.10721, 2023.   \n[59] Ailing Zeng, Muxi Chen, Lei Zhang, and Qiang Xu. Are transformers effective for time series forecasting? In Proceedings of the AAAI conference on artificial intelligence, volume 37, pages 11121\u201311128, 2023.   \n[60] Anthony Bagnall, Hoang Anh Dau, Jason Lines, Michael Flynn, James Large, Aaron Bostrom, Paul Southam, and Eamonn Keogh. The uea multivariate time series classification archive, 2018. arXiv preprint arXiv:1811.00075, 2018.   \n[61] Aditya P Mathur and Nils Ole Tippenhauer. Swat: A water treatment testbed for research and training on ics security. In 2016 international workshop on cyber-physical systems for smart water networks (CySWater), pages 31\u201336. IEEE, 2016.   \n[62] Ahmed Abdulaal, Zhuanghua Liu, and Tomer Lancewicki. Practical approach to asynchronous multivariate time series anomaly detection and localization. In Proceedings of the 27th ACM SIGKDD conference on knowledge discovery & data mining, pages 2485\u20132494, 2021.   \n[63] Kyle Hundman, Valentino Constantinou, Christopher Laporte, Ian Colwell, and Tom Soderstrom. Detecting spacecraft anomalies using lstms and nonparametric dynamic thresholding. In Proceedings of the 24th ACM SIGKDD international conference on knowledge discovery & data mining, pages 387\u2013395, 2018.   \n[64] Rakshitha Godahewa, Christoph Bergmeir, Geoffrey I Webb, Rob J Hyndman, and Pablo Montero-Manso. Monash time series forecasting archive. arXiv preprint arXiv:2105.06643, 2021.   \n[65] Cristian Challu, Kin G Olivares, Boris N Oreshkin, Federico Garza, Max Mergenthaler, and Artur Dubrawski. N-hits: Neural hierarchical interpolation for time series forecasting. arXiv preprint arXiv:2201.12886, 2022.   \n[66] Boris N Oreshkin, Dmitri Carpov, Nicolas Chapados, and Yoshua Bengio. N-BEATS: Neural basis expansion analysis for interpretable time series forecasting. ICLR, 2019.   \n[67] T. Zhang, Yizhuo Zhang, Wei Cao, J. Bian, Xiaohan Yi, Shun Zheng, and Jian Li. Less is more: Fast multivariate time series forecasting with light sampling-oriented mlp structures. arXiv preprint arXiv:2207.01186, 2022.   \n[68] Yong Liu, Haixu Wu, Jianmin Wang, and Mingsheng Long. Non-stationary transformers: Rethinking the stationarity in time series forecasting. In NeurIPS, 2022.   \n[69] S. Hochreiter and J. Schmidhuber. Long short-term memory. Neural Comput., 1997.   \n[70] Albert Gu, Tri Dao, Stefano Ermon, Atri Rudra, and Christopher R\u00e9. Hippo: Recurrent memory with optimal polynomial projections. Advances in neural information processing systems, 33: 1474\u20131487, 2020.   \n[71] Eric Martin and Chris Cundy. Parallelizing linear recurrent neural nets over sequence length. In International Conference on Learning Representations, 2018. URL https://openreview. net/forum?id=HyUNwulC-.   \n[72] George EP Box and Gwilym M Jenkins. Some recent advances in forecasting and control. Journal of the Royal Statistical Society. Series $C$ (Applied Statistics), 17(2):91\u2013109, 1968.   \n[73] Junyoung Chung, Caglar Gulcehre, KyungHyun Cho, and Yoshua Bengio. Empirical evaluation of gated recurrent neural networks on sequence modeling. arXiv preprint arXiv:1412.3555, 2014.   \n[74] David Salinas, Valentin Flunkert, Jan Gasthaus, and Tim Januschowski. Deepar: Probabilistic forecasting with autoregressive recurrent networks. International journal of forecasting, 36(3): 1181\u20131191, 2020.   \n[75] Songlin Yang, Bailin Wang, Yikang Shen, Rameswar Panda, and Yoon Kim. Gated linear attention transformers with hardware-efficient training. In International conference on machine learning (ICML), 2024.   \n[76] Angelos Katharopoulos, Apoorv Vyas, Nikolaos Pappas, and Fran\u00e7ois Fleuret. Transformers are rnns: Fast autoregressive transformers with linear attention. In International conference on machine learning, pages 5156\u20135165. PMLR, 2020.   \n[77] Imanol Schlag, Kazuki Irie, and J\u00fcrgen Schmidhuber. Linear transformers are secretly fast weight programmers. In International Conference on Machine Learning, pages 9355\u20139366. PMLR, 2021.   \n[78] Jun Ma, Feifei Li, and Bo Wang. U-mamba: Enhancing long-range dependency for biomedical image segmentation. arXiv preprint arXiv:2401.04722, 2024.   \n[79] Yue Liu, Yunjie Tian, Yuzhong Zhao, Hongtian Yu, Lingxi Xie, Yaowei Wang, Qixiang Ye, and Yunfan Liu. Vmamba: Visual state space model. arXiv preprint arXiv:2401.10166, 2024.   \n[80] Yair Schiff, Chia-Hsiang Kao, Aaron Gokaslan, Tri Dao, Albert Gu, and Volodymyr Kuleshov. Caduceus: Bi-directional equivariant long-range dna sequence modeling. arXiv preprint arXiv:2403.03234, 2024.   \n[81] Yuxin Jia, Youfang Lin, Xinyan Hao, Yan Lin, Shengnan Guo, and Huaiyu Wan. WITRAN: Water-wave information transmission and recurrent acceleration network for long-range time series forecasting. In Thirty-seventh Conference on Neural Information Processing Systems, 2023. URL https://openreview.net/forum?id $\\equiv$ y08bkEtNBK.   \n[82] Romain Ilbert, Ambroise Odonnat, Vasilii Feofanov, Aladin Virmaux, Giuseppe Paolo, Themis Palpanas, and Ievgen Redko. Unlocking the potential of transformers in time series forecasting with sharpness-aware minimization and channel-wise attention. arXiv preprint arXiv:2402.10198, 2024.   \n[83] Tian Zhou, Ziqing Ma, Qingsong Wen, Liang Sun, Tao Yao, Wotao Yin, Rong Jin, et al. Film: Frequency improved legendre memory model for long-term time series forecasting. Advances in Neural Information Processing Systems, 35:12677\u201312690, 2022.   \n[84] Yong Liu, Chenyu Li, Jianmin Wang, and Mingsheng Long. Koopa: Learning non-stationary time series dynamics with koopman predictors. Advances in Neural Information Processing Systems, 36, 2023.   \n[85] Rui Wang, Yihe Dong, Sercan O Arik, and Rose Yu. Koopman neural operator forecaster for time-series with temporal distributional shifts. In The Eleventh International Conference on Learning Representations, 2023.   \n[86] Yong Liu, Haixu Wu, Jianmin Wang, and Mingsheng Long. Non-stationary transformers: Exploring the stationarity in time series forecasting. Advances in Neural Information Processing Systems, 35:9881\u20139893, 2022.   \n[87] Chi-Tsong Chen. Linear system theory and design. Saunders college publishing, 1984.   \n[88] Guokun Lai, Wei-Cheng Chang, Yiming Yang, and Hanxiao Liu. Modeling long-and short-term temporal patterns with deep neural networks. In SIGIR, 2018.   \n[89] Shiyang Li, Xiaoyong Jin, Yao Xuan, Xiyou Zhou, Wenhu Chen, Yu-Xiang Wang, and Xifeng Yan. Enhancing the locality and breaking the memory bottleneck of transformer on time series forecasting. In NeurIPS, 2019.   \n[90] Jean-Yves Franceschi, Aymeric Dieuleveut, and Martin Jaggi. Unsupervised scalable representation learning for multivariate time series. In NeurIPS, 2019.   \n[91] Jiehui Xu, Haixu Wu, Jianmin Wang, and Mingsheng Long. Anomaly transformer: Time series anomaly detection with association discrepancy. In ICLR, 2021. ", "page_idx": 10}, {"type": "text", "text": "", "page_idx": 11}, {"type": "text", "text": "", "page_idx": 12}, {"type": "text", "text": "", "page_idx": 13}, {"type": "text", "text": "", "page_idx": 14}, {"type": "text", "text": "", "page_idx": 15}, {"type": "text", "text": "A Background ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "A.1 1D Space State Models ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "1D Space State Models (SSMs) are linear time-invariant systems that map input sequence $x(t)\\in$ $\\mathbb{R}^{L}\\stackrel{\\cdot}{\\mapsto}y(t)\\in\\mathbb{R}^{L}$ [13]. SSMs use a latent state $h(t)\\in\\mathbb{R}^{N\\times\\mathbf{\\tilde{L}}}$ , transition parameter $\\mathbf{A}\\in\\mathbb{R}^{N\\times N}$ , and projection parameters ${\\bf B}\\in\\mathbb{R}^{N\\times1}$ , $\\mathbf{C}\\in\\mathbb{R}^{1\\times N}$ to model the input and output as: ", "page_idx": 16}, {"type": "equation", "text": "$$\nh^{\\prime}(t)=\\mathbf{A}\\;h(t)+\\mathbf{B}\\;x(t),\\;\\;\\;\\;\\;\\;\\;\\;\\;\\;\\;\\;\\;\\;y(t)=\\mathbf{C}\\;h(t).\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "Most existing SSMs [34, 33, 31], first discretize the signals $\\mathbf{A},\\mathbf{B}$ , and $\\mathbf{C}$ . That is, using a parameter $\\Delta$ and zero-order hold, the discretized formulation is defined as: ", "page_idx": 16}, {"type": "equation", "text": "$$\nh_{t}=\\bar{\\textbf{A}}h_{t-1}+\\bar{\\textbf{B}}x_{t},\\qquad\\qquad y_{t}=\\textbf{C}h_{t},\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "where $\\bar{\\mathbf{A}}=\\exp\\left(\\Delta\\mathbf{A}\\right)$ and $\\bar{\\mathbf{B}}=(\\Delta\\mathbf{A})^{-1}\\left(\\exp\\left(\\Delta\\mathbf{A}-I\\right)\\right)$ . $\\Delta\\mathbf{B}$ . [70] show that discrete SSMs can be interpreted as both convolutions and recurrent networks: i.e., ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\bar{\\bf K}=\\left({\\bf C}\\bar{\\bf B},{\\bf C}\\bar{\\bf A}\\bar{\\bf B},\\ldots,{\\bf C}\\bar{\\bf A}^{L-1}\\bar{\\bf B}\\right),}\\\\ &{y=x*\\bar{\\bf K},}\\end{array}\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "which makes their training and inference very efficient as a convolution and recurrent model, respectively. ", "page_idx": 16}, {"type": "text", "text": "A.2 Data Dependency ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "Above discrete SSMs are based on data-independent parameters. That is, parameters $\\Delta,\\bar{\\bf A},\\bar{\\bf B}.$ , and $\\mathbf{C}$ are time invariant and are the same for any input. Gu and Dao [33] argue that this time invariance has the cost of limiting SSMs effectiveness in compressing context into a smaller state [33]. To overcome this challenge, they present a selective SSMs (S6) block that effectively selects relevant context by enabling dependence of the parameters $\\bar{\\mathbf{B}},\\bar{\\mathbf{C}}$ , and $\\Delta$ on the input $x_{t}$ , i.e.: ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\bar{\\mathbf{B}}_{t}=\\mathrm{Linear}_{\\mathbf{B}}(x_{t})}\\\\ &{\\bar{\\mathbf{C}}_{t}=\\mathrm{Linearc}(x_{t})}\\\\ &{\\Delta_{t}=\\mathsf{S o f t p l u s}\\left(\\mathrm{Linear}_{\\Delta}(x_{t})\\right),}\\end{array}\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "where Linear $(.)$ is a linear projection and So ${\\mathrm{ftp1us}}(.)=\\log(1+\\exp(.))$ . This data dependency comes at the cost of efficiency as the model cannot be trained as a convolution. To overcome this challenge, Gu and Dao [33] show that the linear recurrence in Equation 1 can be formulated as an associative scan [71], which accepts efficient parallel algorithms. ", "page_idx": 16}, {"type": "text", "text": "B Additional Related Work ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "Classical Approach. Modeling time series data is a long-standing problem and has attracted much attention during the past 60 years. There have been several mathematical models to capture the time series traits like exponential smoothing[16], autoregressive integrated moving average (ARIMA) [14], SARIMA [15], Box-Jenkins method [72], and more recently state-space models [12, 13]. Despite their more interpretability, these methods usually fail to capture non-linear dependencies and also often require manually analyzing time series features (e.g., trend or seasonality), resulting in lack of generalizability. ", "page_idx": 16}, {"type": "text", "text": "Recurrent and Deep State Space Models. Another group of relevant studies to ours is deep sequence models. A common class of architectures for sequence modeling are recurrent neural networks such as like GRUs [73], DeepAR [74], LSTMs [69]. The main drawback of RNNs is their potential for vanishing/exploding gradients and also their slow training. Recently, linear attention methods with fast training attracted attention [75\u201377]. Katharopoulos et al. [76] show that these methods have recurrent formulation and can be fast in inference. ", "page_idx": 16}, {"type": "text", "text": "Recently, deep state space models have attracted much attention as the alternative of Transformers [17], due to their fast training and inference [70]. These methods are the combination of traditional SSMs with deep neural networks by directly parameterizing the layers of a neural network with multiple linear SSMs, and overcome common recurrent training drawbacks by leveraging the convolutional view of SSMs [70, 45, 46, 34, 50]. Recently, Gu and Dao [33] present a new formulation of deep SSMs by allowing the parameters to be the function of inputs. This architecture shows promissing potential in various domains like NLP [33], vision [78, 79, 31], graphs [48], DNA modeling [33, 80]. ", "page_idx": 16}, {"type": "text", "text": "", "page_idx": 17}, {"type": "text", "text": "All the above methods are design for 1D data, meaning that the states depends on one variable. There are, however, a few studies that uses 2D SSMs in deep learning settings. S4ND [32] uses continuous signals to model images. These methods not only consider two separate SSM for the axes, but it also directly treat the system as a continuous system without discretization step. Furthermore, S4ND has data-independent parameters. Another similar approach is 2DSSM [49], that models images as discrete signals. That is, the initial SSM model is discrete and again there is a lack of discretization step, which is important for time series as we discussed earlier. Also, their method again is based on data-independent parameters. Both S4ND and 2DSSM can be computed as a convolution. We, however, present a new scanning technique for fast training of 2D SSMs, even with input-dependent parameters. ", "page_idx": 17}, {"type": "text", "text": "WITRAN [81] is a 2D RNN approach for univariate time series, which is different from our approaches from different aspects: (1) Goal: The main goal of WITRAN is to use 2D RNN to model univariate time series data. That is, the first dimension corresponds to short-term, and the second dimension corresponds to long-term patterns. On the other hand, our 2D SSM aims to model multivariate time series where the first dimension corresponds to time, and the second dimension corresponds to variates. (2) Backbone: WITRAN is based on GSC (LSTM-like cell), which uses non-linear transition. Our 2D SSM is based on state space models, is simpler, and uses linear transitions. (3) Data-dependency: WITRAN is based on data-independent parameters, meaning that it uses the same transition process for all time steps. 2D SSM, however, is based on data-dependent parameters, which allows it to filter irrelevant/noisy time steps. (4) Recurrence, Hidden States, and Training: Although both models have recurrent form, WITRAN\u2019s recurrence is over extracted short-term and long-term patterns. Our 2D SSM\u2019s recurrence, however, is over time and variate dimensions. WITRAN uses only one hidden state for each state of the system, while 2D SSM uses 2 different hidden states for each state of the system, allowing more flexibility to capture cross-variate and cross-time information. ", "page_idx": 17}, {"type": "text", "text": "Other methods. Transformer-based models have attracted much attention over recent years for multivariate time series forecasting, when modeling the complex relationships of co-variates or along the time dimension is required [24\u201326, 11, 6, 23, 21, 82, 29]. Several studies have focused on designing more efficient and effective attentions with using special traits of time series [20]. Some other studies have focused on extracting long-term information for better forecasting [29, 83]. In addition to transformers, linear models also have shown promising results [8, 30]. For example, Chen et al. [30] present TSMixer, an all-MLP architecture for time series forecasting, with promising performance. Due to the expressive power of our 2D SSM, these linear methods sometimes can be viewed as a special case of 2D SSMs. Recently, convolution-based models for time series have shown promising results [9]. These methods by using global kernels enhance the global receptive field. Our data-independent formulation of Chimera is connected to this line of work as it can be written as a global convolution. ", "page_idx": 17}, {"type": "text", "text": "Recently, Koopman-based deep models [84, 85] are designed to capture non-linear dependencies in the data. Existing methods, however, does not consider dynamics in different variates and might miss complex dependencies of variates. Moreover, despite their promising results in the time series forecasting, these approaches can be hard to be parallelizable and so might have longer training for large models. ", "page_idx": 17}, {"type": "text", "text": "C Details of the Discretization ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "Given PDE with initial condition $h(0,0)=0$ : ", "page_idx": 17}, {"type": "equation", "text": "$$\n\\frac{\\displaystyle\\frac{\\partial}{\\partial t^{(1)}}h^{(1)}\\left(t^{(1)},t^{(2)}\\right)=\\left(\\mathbf{A}_{1}h^{(1)}\\left(t^{(1)},t^{(2)}\\right),\\mathbf{A}_{2}h^{(2)}\\left(t^{(1)},t^{(2)}\\right)\\right)+\\mathbf{B}_{1}\\mathbf{x}\\left(t^{(1)},t^{(2)}\\right)\\right)=\\left(\\mathbf{A}_{1}1\\mathrm{\\mathbf{1}},t^{(2)}\\right),}\\\\ {\\displaystyle\\frac{\\partial}{\\partial t^{(1)}}h^{(2)}\\left(t^{(1)},t^{(2)}\\right)=\\left(\\mathbf{A}_{1}h^{(1)}\\left(t^{(1)},t^{(2)}\\right),\\mathbf{A}_{2}h^{(2)}\\left(t^{(1)},t^{(2)}\\right)\\right)+\\mathbf{B}_{1}\\mathbf{x}\\left(t^{(1)},t^{(2)}\\right)\\right),}\\\\ {\\displaystyle\\frac{\\partial}{\\partial t^{(2)}}h^{(1)}\\left(t^{(1)},t^{(2)}\\right)=\\left(\\mathbf{A}_{3}h^{(1)}\\left(t^{(1)},t^{(2)}\\right),\\mathbf{A}_{4}h^{(2)}\\left(t^{(1)},t^{(2)}\\right)\\right)+\\mathbf{B}_{2}\\mathbf{x}\\left(t^{(1)},t^{(2)}\\right)\\right)=\\left(\\mathbf{A}_{3}\\mathbf{x}\\left(t^{(1)},t^{(2)}\\right)\\right),}\\\\ {\\displaystyle\\frac{\\partial}{\\partial t^{(2)}}h^{(2)}\\left(t^{(1)},t^{(2)}\\right)=\\left(\\mathbf{A}_{3}h^{(1)}\\left(t^{(1)},t^{(2)}\\right),\\mathbf{A}_{4}h^{(2)}\\left(t^{(1)},t^{(2)}\\right)\\right)+\\mathbf{B}_{2}\\mathbf{x}\\left(t^{(1)},t^{(2)}\\right),}\\end{array}\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "over the sampling intervals $[k\\Delta t^{(1)},(k+1)\\Delta t^{(1)}]$ and $[\\ell\\Delta t^{(2)},(\\ell+1)\\Delta t^{(2)}]$ we have: ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\begin{array}{l}{{\\displaystyle\\int_{k\\Delta t^{(1)}}^{(k+1)\\Delta t^{(1)}}\\frac{\\partial}{\\partial t^{(1)}}h^{(1)}\\left(t^{(1)},t^{(2)}\\right)\\,d t^{(1)}}\\ }\\\\ {{\\displaystyle=\\int_{k\\Delta t^{(1)}}^{(k+1)\\Delta t^{(1)}}\\left(\\mathbf{A}_{1}h^{(1)}\\left(t^{(1)},t^{(2)}\\right)+\\mathbf{B}_{1}^{(1)}\\mathbf{x}^{(1)}\\left(t^{(1)},t^{(2)}\\right)\\right)\\,d t^{(1)}}\\ }\\end{array}\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "and so: ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\quad\\int_{k\\Delta t^{(1)}}^{(k+1)\\Delta t^{(1)}}\\frac{\\partial}{\\partial t^{(1)}}h^{(2)}\\left(t^{(1)},t^{(2)}\\right)\\,d t^{(1)}}\\\\ &{=\\int_{k\\Delta t^{(1)}}^{(k+1)\\Delta t^{(1)}}\\left(\\mathbf{A}_{2}h^{(2)}\\left(t^{(1)},t^{(2)}\\right)+\\mathbf{B}_{1}^{(2)}\\mathbf{x}^{(2)}\\left(t^{(1)},t^{(2)}\\right)\\right)\\,d t^{(1)}}\\end{array}\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "Similarly, for the second equation we have: ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\begin{array}{l}{{\\displaystyle\\int_{\\ell\\Delta t^{(2)}}^{(\\ell+1)\\Delta t^{(2)}}\\frac{\\partial}{\\partial t^{(2)}}h^{(1)}\\left(t^{(1)},t^{(2)}\\right)\\,d t^{(2)}}}\\\\ {{\\,=\\displaystyle\\int_{\\ell\\Delta t^{(2)}}^{(\\ell+1)\\Delta t^{(2)}}\\left(\\mathbf{A}_{3}h^{(1)}\\left(t^{(1)},t^{(2)}\\right)+\\mathbf{B}_{2}^{(1)}\\mathbf{x}^{(1)}\\left(t^{(1)},t^{(2)}\\right)\\right)\\,d t^{(2)}}}\\end{array}\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "and so: ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\begin{array}{l}{{\\displaystyle\\int_{\\ell\\Delta t^{(2)}}^{(\\ell+1)\\Delta t^{(2)}}\\frac{\\partial}{\\partial t^{(2)}}h^{(2)}\\left(t^{(1)},t^{(2)}\\right)\\,d t^{(2)}}}\\\\ {{\\,=\\displaystyle\\int_{\\ell\\Delta t^{(2)}}^{(\\ell+1)\\Delta t^{(2)}}\\left(\\mathbf{A}_{4}h^{(2)}\\left(t^{(1)},t^{(2)}\\right)+\\mathbf{B}_{2}^{(2)}\\mathbf{x}^{(2)}\\left(t^{(1)},t^{(2)}\\right)\\right)\\,d t^{(2)}}}\\end{array}\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "Next, the integrals can be simplified as: ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\quad h^{(1)}\\left((k+1)\\Delta t^{(1)},t^{(2)}\\right)}\\\\ &{=e^{\\mathbf{A}_{1}\\Delta t^{(1)}}h^{(1)}\\left(k\\Delta t^{(1)},t^{(2)}\\right)+\\int_{k\\Delta t^{(1)}}^{(k+1)\\Delta t^{(1)}}e^{\\mathbf{A}_{1}(t^{(1)}-k\\Delta t^{(1)})}\\mathbf{B}_{1}^{(1)}\\mathbf{x}^{(1)}\\left(t^{(1)},t^{(2)}\\right)\\,d t^{(1)},}\\end{array}\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "and ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\quad h^{(2)}\\left((k+1)\\Delta t^{(1)},t^{(2)}\\right)}\\\\ &{=e^{\\mathbf{A}_{2}\\Delta t^{(1)}}h^{(2)}\\left(k\\Delta t^{(1)},t^{(2)}\\right)+\\int_{k\\Delta t^{(1)}}^{(k+1)\\Delta t^{(1)}}e^{\\mathbf{A}_{2}(t^{(1)}-k\\Delta t^{(1)})}\\mathbf{B}_{1}^{(2)}\\mathbf{x}^{(2)}\\left(t^{(1)},t^{(2)}\\right)\\,d t^{(1)},}\\end{array}\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "and similarly for the third and fourth equations we have: ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\quad h^{(1)}\\left(t^{(1)},(\\ell+1)\\Delta t^{(2)}\\right)}\\\\ &{=e^{\\mathbf{A}_{3}\\Delta t^{(2)}}h^{(1)}\\left(t^{(1)},\\ell\\Delta t^{(2)}\\right)+\\int_{\\ell\\Delta t^{(2)}}^{(\\ell+1)\\Delta t^{(2)}}e^{\\mathbf{A}_{3}(t^{(2)}-\\ell\\Delta t^{(2)})}\\mathbf{B}_{2}^{(1)}\\mathbf{x}^{(1)}\\left(t^{(2)},t^{(1)}\\right)\\,d t^{(2)}}\\end{array}\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "and ", "page_idx": 19}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\quad h^{(2)}\\left(t^{(1)},(\\ell+1)\\Delta t^{(2)}\\right)}\\\\ &{=e^{\\mathbf{A}_{4}\\Delta t^{(2)}}h^{(2)}\\left(t^{(1)},\\ell\\Delta t^{(2)}\\right)+\\int_{\\ell\\Delta t^{(2)}}^{(\\ell+1)\\Delta t^{(2)}}e^{\\mathbf{A}_{4}(t^{(2)}-\\ell\\Delta t^{(2)})}\\mathbf{B}_{2}^{(2)}\\mathbf{x}^{(2)}\\left(t^{(2)},t^{(1)}\\right)\\,d t^{(2)}}\\end{array}\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "Using ZOH assumption, we have: ", "page_idx": 19}, {"type": "equation", "text": "$$\n\\begin{array}{l}{{\\displaystyle\\int_{0}^{\\Delta t^{(1)}}e^{{\\bf A}_{1}s}\\,d s={\\bf A}^{(1)^{-1}}\\left(e^{{\\bf A}_{1}\\Delta t^{(1)}}-{\\bf I}\\right)}\\ ~}\\\\ {{\\displaystyle\\int_{0}^{\\Delta t^{(1)}}e^{{\\bf A}_{2}s}\\,d s={\\bf A}^{(2)^{-1}}\\left(e^{{\\bf A}_{2}\\Delta t^{(1)}}-{\\bf I}\\right)}\\ ~}\\\\ {{\\displaystyle\\int_{0}^{\\Delta t^{(2)}}e^{{\\bf A}_{3}s}\\,d s={\\bf A}^{(3)^{-1}}\\left(e^{{\\bf A}_{3}\\Delta t^{(2)}}-{\\bf I}\\right)}\\ ~}\\\\ {{\\displaystyle\\int_{0}^{\\Delta t^{(2)}}e^{{\\bf A}_{4}s}\\,d s={\\bf A}^{(4)^{-1}}\\left(e^{{\\bf A}_{4}\\Delta t^{(2)}}-{\\bf I}\\right)}\\ ~}\\end{array}\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "Accordingly, the discretized form is as follows: ", "page_idx": 19}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{h_{k+1,\\ell}^{(1)}=e^{\\mathbf{A}_{1}\\Delta t^{(1)}}h_{k,\\ell}^{(1)}+\\mathbf{A}^{(1)^{-1}}\\left(e^{\\mathbf{A}_{1}\\Delta t^{(1)}}-\\mathbf{I}\\right)\\mathbf{B}_{1}^{(1)}\\mathbf{x}_{k+1,\\ell}^{(1)}}\\\\ &{h_{k+1,\\ell}^{(2)}=e^{\\mathbf{A}_{2}\\Delta t^{(1)}}h_{k,\\ell}^{(2)}+\\mathbf{A}^{(2)^{-1}}\\left(e^{\\mathbf{A}_{2}\\Delta t^{(1)}}-\\mathbf{I}\\right)\\mathbf{B}_{1}^{(2)}\\mathbf{x}_{k+1,\\ell}^{(2)}}\\\\ &{h_{k,\\ell+1}^{(1)}=e^{\\mathbf{A}_{3}\\Delta t^{(2)}}h_{k,\\ell}^{(1)}+\\mathbf{A}^{(3)^{-1}}\\left(e^{\\mathbf{A}_{3}\\Delta t^{(2)}}-\\mathbf{I}\\right)\\mathbf{B}_{2}^{(1)}\\mathbf{x}_{k,\\ell+1}^{(1)}}\\\\ &{h_{k,\\ell+1}^{(2)}=e^{\\mathbf{A}_{4}\\Delta t^{(2)}}h_{k,\\ell}^{(2)}+\\mathbf{A}^{(4)^{-1}}\\left(e^{\\mathbf{A}_{4}\\Delta t^{(2)}}-\\mathbf{I}\\right)\\mathbf{B}_{2}^{(2)}\\mathbf{x}_{k,\\ell+1}^{(2)},}\\end{array}\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "which means that: ", "page_idx": 19}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\bar{\\bf A}_{1}=\\exp\\left({\\bf A}_{1}\\Delta_{1}\\right),}\\\\ {\\bar{\\bf A}_{2}=\\exp\\left({\\bf A}_{2}\\Delta_{1}\\right),}\\\\ {\\bar{\\bf A}_{3}=\\exp\\left({\\bf A}_{3}\\Delta_{2}\\right),}\\\\ {\\bar{\\bf A}_{4}=\\exp\\left({\\bf A}_{4}\\Delta_{2}\\right),}\\end{array}\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "and ", "page_idx": 19}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\bar{\\mathbf{B}}_{1}=\\left[\\mathbf{A}^{(1)^{-1}}\\left(e^{\\mathbf{A}_{1}\\Delta_{1}}-\\mathbf{I}\\right)\\mathbf{B}_{1}^{(1)}\\right],}\\\\ &{\\left[\\mathbf{A}^{(2)^{-1}}\\left(e^{\\mathbf{A}_{2}\\Delta_{1}}-\\mathbf{I}\\right)\\mathbf{B}_{1}^{(2)}\\right],}\\\\ &{\\bar{\\mathbf{B}}_{2}=\\left[\\mathbf{A}^{(3)^{-1}}\\left(e^{\\mathbf{A}_{3}\\Delta_{2}}-\\mathbf{I}\\right)\\mathbf{B}_{2}^{(1)}\\right].}\\end{array}\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "D Details of the Structure of Transition Matrices ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "Definition D.1 (Companion Matrix). A matrix $A\\in\\mathbb{R}^{N\\times N}$ has companion form if it can be written as: ", "page_idx": 19}, {"type": "equation", "text": "$$\nA=\\left(\\begin{array}{c c c c c}{{0}}&{{0}}&{{\\ldots}}&{{0}}&{{a_{1}}}\\\\ {{1}}&{{0}}&{{\\ldots}}&{{0}}&{{a_{2}}}\\\\ {{0}}&{{1}}&{{\\ldots}}&{{0}}&{{a_{3}}}\\\\ {{\\vdots}}&{{\\vdots}}&{{\\ddots}}&{{\\vdots}}&{{\\vdots}}\\\\ {{0}}&{{0}}&{{\\ldots}}&{{0}}&{{a_{N_{1}}}}\\\\ {{0}}&{{0}}&{{\\ldots}}&{{1}}&{{a_{N}}}\\end{array}\\right).\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "These matrices can be decomposed into a shift and a low-rank matrix. That is: ", "page_idx": 20}, {"type": "equation", "text": "$$\nA=\\left({\\begin{array}{c c c c c}{0}&{0}&{\\dots}&{0}&{a_{1}}\\\\ {1}&{0}&{\\dots}&{0}&{a_{2}}\\\\ {0}&{1}&{\\dots}&{0}&{a_{3}}\\\\ {\\vdots}&{\\vdots}&{\\ddots}&{\\vdots}&{\\vdots}\\\\ {0}&{0}&{\\dots}&{0}&{a_{N_{1}}}\\\\ {0}&{0}&{\\dots}&{1}&{a_{N}}\\end{array}}\\right)=\\underbrace{\\left({\\begin{array}{c c c c c}{0}&{0}&{\\dots}&{0}&{0}\\\\ {1}&{0}&{\\dots}&{0}&{0}\\\\ {0}&{1}&{\\dots}&{0}&{0}\\\\ {\\vdots}&{\\vdots}&{\\ddots}&{\\vdots}&{\\vdots}\\\\ {0}&{0}&{\\dots}&{0}&{0}\\\\ {0}&{0}&{\\dots}&{1}&{0}\\end{array}}\\right)}_{\\displaystyle\\underbrace{+\\left({\\begin{array}{c c c c c}{0}&{0}&{\\dots}&{0}&{a_{1}}\\\\ {0}&{0}&{\\dots}&{0}&{a_{2}}\\\\ {0}&{0}&{\\dots}&{0}&{a_{3}}\\\\ {\\vdots}&{\\vdots}&{\\ddots}&{\\vdots}&{\\vdots}\\\\ {0}&{0}&{\\dots}&{0}&{a_{N_{1}}}\\\\ {0}&{0}&{\\dots}&{0}&{a_{N_{1}}}\\end{array}}\\right)}_{\\displaystyle\\left({\\begin{array}{c c c c c}{0}&{0}&{\\dots}&{0}&{0}\\\\ {0}&{0}&{\\dots}&{0}&{a_{N_{1}}}\\\\ {0}&{0}&{\\dots}&{0}&{a_{N_{2}}}\\\\ {\\vdots}&{\\vdots}&{\\ddots}&{\\vdots}&{\\vdots}\\\\ {0}&{0}&{\\dots}&{0}&{a_{N_{1}}}\\\\ {0}&{0}&{\\dots}&{0}&{a_{N_{1}}}\\end{array}}\\right)}.\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "This formulation can help us to compute the power of $A$ faster in the convolutional form, as discussed by Zhang et al. [28]. ", "page_idx": 20}, {"type": "text", "text": "E Bidirectionality Across Variates ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "The causal nature of the 2D SSM result in limited information flow along the variate dimension as variate are not ordered. To overcome this challenge, inspired by the bi-directional 1D SSMs [47, 48, 1], we use two different modules for forward and backward pass along the variate dimension: ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{h_{v,t+1}^{(1)^{f}}=\\bar{\\mathbf{A}}_{1}^{f}h_{v,t}^{(1)}+\\bar{\\mathbf{A}}_{2}^{f}h_{v,t}^{(2)^{f}}+\\bar{\\mathbf{B}}_{1}^{f}\\mathbf{x}_{v,t+1},}\\\\ &{h_{v,t+1}^{(1)^{b}}=\\bar{\\mathbf{A}}_{1}^{b}h_{v,t}^{(1)}+\\bar{\\mathbf{A}}_{2}^{b}h_{v,t}^{(2)}+\\bar{\\mathbf{B}}_{1}^{b}\\mathbf{x}_{v,t+1},}\\\\ &{h_{v,t+1}^{(2)^{f}}=\\bar{\\mathbf{A}}_{3}^{f}h_{v,t}^{(1)}+\\bar{\\mathbf{A}}_{4}^{f}h_{v,t}^{(2)^{f}}+\\bar{\\mathbf{B}}_{2}^{f}\\mathbf{x}_{v+1,t},}\\\\ &{h_{v-1,t}^{(2)^{b}}=\\bar{\\mathbf{A}}_{3}^{b}h_{v,t}^{(1)^{b}}+\\bar{\\mathbf{A}}_{4}^{b}h_{v,t}^{(2)^{f}}+\\bar{\\mathbf{B}}_{2}^{b}\\mathbf{x}_{v-1,t},}\\\\ &{\\mathbf{y}_{v,t}^{f}=\\mathbf{C}_{1}^{f}h_{v,t}^{(1)^{f}}+\\mathbf{C}_{2}^{f}h_{v,t}^{(2)^{f}},}\\\\ &{\\mathbf{y}_{v,t}^{b}=\\mathbf{C}_{1}^{b}h_{v,t}^{(1)^{b}}+\\mathbf{C}_{2}^{b}h_{v,t}^{(2)^{b}},}\\\\ &{\\mathbf{y}_{v,t}=y_{v,t}^{f}+\\mathbf{y}_{v,t}^{b},}\\end{array}\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "where $\\bar{\\mathbf{A}}_{1}^{\\tau},\\bar{\\mathbf{A}}_{2}^{\\tau},\\bar{\\mathbf{A}}_{3}^{\\tau},\\bar{\\mathbf{A}}_{4}^{\\tau}\\in\\mathbb{R}^{N\\times N}$ , \u00afB\u03c41, $\\bar{\\mathbf{B}}_{2}^{\\tau}\\in\\mathbb{R}^{N\\times1}$ , and $\\mathbf{C}_{1}^{\\tau},\\mathbf{C}_{2}^{\\tau}\\,\\in\\,\\mathbb{R}^{1\\times N}$ are parameters of the model, $h_{v,t}^{(1)^{\\tau}},h_{v,t}^{(2)^{\\tau}}\\in\\mathbb{R}^{N\\times d}$ are hidden states, $\\mathbf{x}_{v,t}\\in\\mathbb{R}^{1\\times d}$ is the input, and $\\tau\\in\\{f,b\\}$ . Figure 2 illustrates the bi-directional recurrence process in Chimera. For the sake of simplicity, we continue with unidirectional pass, but adapting them for bi-directional setting is simple as we use two separate blocks, each of which for a direction. ", "page_idx": 20}, {"type": "text", "text": "F Time Complexity of 2D-SSM ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Let $T$ be the length of the time series and $V$ be the number of variates. Since for each variate we have ${\\mathcal{O}}(T)$ recurrence and we have $V$ variates, the total number of recurrence is $\\mathcal{O}(T V)$ . In each step, we have the matrix multiplication of transition matrices $A_{i}$ with the hidden states and also $B_{i}\\mathbf{s}$ with the input. Accordingly, if we use $d$ as the state dimension, the complexity is $\\mathcal{O}(d^{2}T V)$ . Given the fact that $d$ is usually a small number, the overall complexity is linear with respect to each of $V$ and $T$ . ", "page_idx": 20}, {"type": "text", "text": "G Theoretical Results ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "G.1 Proof of Theorem 3.2 ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "In this part, we want to prove that \u22c7is associative. This operator is defined as: ", "page_idx": 20}, {"type": "equation", "text": "$$\np\\lneq q={\\binom{p_{1}}{p_{4}}}\\quad p_{2}\\quad p_{3}\\Bigr)\\lneq{\\binom{q_{1}}{q_{4}}}\\quad q_{2}\\quad q_{3}\\Bigr)={\\binom{q_{1}\\odot p_{1}}{q_{4}\\odot p_{4}}}\\quad q_{2}\\odot p_{2}\\quad q_{1}\\otimes p_{3}+q_{2}\\otimes p_{6}+q_{3}\\Bigr)\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "Accordingly, we have: ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\left(p\\ast q\\right)\\ast r=\\left(q_{1}\\odot p_{1}\\quad q_{2}\\odot p_{2}\\quad q_{1}\\otimes p_{3}+q_{2}\\otimes p_{6}+q_{3}\\right)\\ast\\left(r_{1}\\quad r_{2}\\quad r_{3}\\right),\n$$", "text_format": "latex", "page_idx": 20}, {"type": "table", "img_path": "ncYGjx2vnE/tmp/a7928ae4c8752eecaf86f21f873ecdfe4cd1aac04770f70a30fa59f659cbafcb.jpg", "table_caption": ["Table 7: Dataset descriptions. The dataset size is organized in (Train, Validation, Test). "], "table_footnote": [], "page_idx": 21}, {"type": "text", "text": "( ${\\begin{array}{r l}{p\\not\\equiv q\\right)\\not\\equiv r=\\left({q_{1}\\odot p_{1}}}&{q_{2}\\odot p_{2}}&{q_{1}\\otimes p_{3}+q_{2}\\otimes p_{6}+q_{3}\\right)\\not\\equiv\\left({r_{1}\\begin{array}{c c}{r_{2}}&{r_{3}}\\\\ {r_{4}}&{r_{5}}\\end{array}}}&{(58)}\\\\ {=\\left({r_{1}\\odot\\left(q_{1}\\odot p_{1}\\right)}}&{r_{2}\\odot\\left(q_{2}\\odot p_{2}\\right)}&{r_{1}\\otimes\\left(q_{1}\\otimes p_{3}+q_{2}\\otimes p_{6}+q_{3}\\right)+r_{2}\\odot\\left(q_{4}\\otimes p_{3}+q_{3}\\right)}\\\\ {r_{4}\\odot\\left(q_{4}\\odot p_{4}\\right)}&{r_{5}\\odot\\left(q_{5}\\odot p_{5}\\right)}&{r_{4}\\otimes\\left(q_{1}\\otimes p_{3}+q_{2}\\otimes p_{6}+q_{3}\\right)+r_{4}\\otimes\\left(q_{4}\\otimes p_{3}+q_{4}\\right)}\\end{array}}\\right)}\\\\ {=\\left({r_{1}\\odot\\left(q_{1}\\odot p_{1}\\right)}}&{r_{2}\\odot\\left(q_{2}\\odot p_{2}\\right)}&{r_{1}\\otimes\\left(q_{1}\\otimes p_{3}+q_{2}\\otimes p_{6}+q_{3}\\right)}\\\\ {r_{4}\\odot\\left(q_{4}\\odot p_{4}\\right)}&{r_{5}\\odot\\left(q_{5}\\odot p_{5}\\right)}&{r_{4}\\otimes\\left(q_{1}\\otimes p_{3}+q_{2}\\otimes p_{6}+q_{3}\\right)}\\end{array}}$ q5 \u2297p6 + q6) + r3 q5 \u2297p6 + q6) + r6 (59) ", "page_idx": 21}, {"type": "table", "img_path": "ncYGjx2vnE/tmp/75e297be8eb58db767c4e74d25799f3ae6c3ac592633468b6dae9ee25e30b825.jpg", "table_caption": ["Table 8: Long-term forecasting task with different horizons H. "], "table_footnote": [], "page_idx": 22}, {"type": "text", "text": "Using the fact that $\\odot$ and $\\otimes$ are associative, we have: ", "page_idx": 22}, {"type": "equation", "text": "$$\n{\\begin{array}{r l r}{p\\not\\equiv q\\rightleftarrows{\\boldsymbol{r}}={\\left(\\begin{array}{l l l}{q_{1}\\odot p_{1}}&{q_{2}\\odot p_{2}}&{q_{1}\\otimes p_{3}+q_{2}\\otimes p_{6}+q_{3}}\\\\ {q_{4}\\odot p_{4}}&{q_{5}\\odot p_{5}}&{q_{4}\\otimes p_{3}+q_{5}\\otimes p_{6}+q_{6}}\\end{array}\\right)}*{\\left(\\begin{array}{l l l}{r_{1}}&{r_{2}}&{r_{3}}\\\\ {r_{4}}&{r_{5}}&{r_{6}}\\end{array}\\right)}}&{{\\begin{array}{r l}{(60)}&{r_{4}}\\\\ {r_{5}\\odot(q_{1}\\odot p_{1})}&{r_{2}\\odot(q_{2}\\odot p_{2})}&{r_{1}\\otimes(q_{1}\\otimes p_{3}+q_{2}\\otimes p_{6}+q_{3})+r_{2}\\odot{\\left(q_{4}\\otimes p_{3}+q_{4}\\right)}}\\\\ {r_{4}\\odot(q_{4}\\odot p_{4})}&{r_{5}\\odot(q_{5}\\odot p_{5})}&{r_{4}\\otimes(q_{1}\\otimes p_{3}+q_{2}\\otimes p_{6}+q_{3})+r_{4}\\otimes(q_{4}\\otimes p_{3}+q_{4})}\\end{array}}}\\\\ &{={\\left(\\begin{array}{l l l}{p_{1}}&{p_{2}}&{p_{3}}\\\\ {p_{4}}&{p_{5}}&{p_{6}}\\end{array}\\right)}*{\\left(\\begin{array}{l l l}{r_{1}\\odot q_{1}}&{r_{2}\\odot q_{2}}&{r_{1}\\otimes q_{3}+r_{2}\\otimes q_{6}+r_{3}}\\\\ {r_{4}\\odot q_{4}}&{r_{5}\\odot q_{5}}&{r_{4}\\otimes q_{3}+r_{5}\\otimes q_{6}+r_{6})}}&{{\\begin{array}{r l}{(62)}&{r_{5}}\\\\ {(6)}&{r_{6}}&{(5)}\\end{array}}}\\\\ &{=p*{\\left(q\\not\\equiv r\\right)},}&{{\\begin{array}{r l}{(6)}&{r_{1}\\otimes(q_{1})}&{r_{2}\\odot q_{2}}\\end{array}}}\\end{array}}\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "G.2 Proof of Theorem 3.3 ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "For each $v,t$ , we can pre-compute $\\mathbf{B}_{1}\\mathbf{x}_{v,t}$ and $\\mathbf{B}_{2}\\mathbf{x}_{v,t+1}$ . Accordingly, all the following parameters are pre-computed: ", "page_idx": 22}, {"type": "equation", "text": "$$\nc_{v,t}^{(i,j,k,\\ell)}=\\left(\\mathbf{A}_{1}\\quad\\mathbf{A}_{2}\\quad\\mathbf{B}_{1}\\mathbf{x}_{v+i,t+j}\\right),\n$$", "text_format": "latex", "page_idx": 22}, {"type": "table", "img_path": "ncYGjx2vnE/tmp/a631be46fd9bb36b5e53b8a2bb7698c143d468f4c19efe255ecec76176313c26.jpg", "table_caption": ["Table 9: Full results for the short-term forecasting task in the M4 dataset. $^*$ . in the Transformers indicates the name of \u2217former. Stationary means the Non-stationary Transformer. "], "table_footnote": [], "page_idx": 23}, {"type": "text", "text": "for all inputs ${\\bf{x}}_{v,t}$ and $i,j,k,\\ell\\in\\{0,1\\}$ . Now, starting from $\\begin{array}{r}{\\left(\\begin{array}{l}{\\mathbf{S}_{0,0}^{(1)}}\\\\ {\\mathbf{S}_{0,0}^{(2)}\\right)=\\left(\\begin{array}{l l l}{I}&{I}&{0}\\\\ {I}&{I}&{0}\\end{array}\\right)}\\end{array}$ , we have: ", "page_idx": 23}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\left(\\mathbf{S}_{0,1}\\right)=\\left(\\begin{array}{l l l}{I}&{I}&{0}\\\\ {I}&{I}&{0}\\end{array}\\right)\\ast\\left(\\mathbf{A}_{1}\\quad\\mathbf{A}_{2}\\quad\\mathbf{B}_{1}\\mathbf{x}_{0,1}\\right)}\\\\ &{\\qquad\\qquad=\\left(\\mathbf{A}_{1}\\quad\\mathbf{A}_{2}\\quad\\mathbf{B}_{1}\\mathbf{x}_{0,1}\\right).}\\end{array}\n$$", "text_format": "latex", "page_idx": 23}, {"type": "text", "text": "Re-using operator \u22c7, we have: ", "page_idx": 23}, {"type": "equation", "text": "$$\n{\\begin{array}{r l}&{{\\bf\\left({\\bf S}_{1,1}\\atop{\\bf S}_{1,1}\\right)}={\\left({\\bf S}_{0,1}\\atop{\\bf S}_{1,0}\\right)}\\ast\\underbrace{{\\left({\\bf A}_{1}\\quad{\\bf A}_{2}\\quad{\\bf B}_{1}{\\bf x}_{1,1}\\right)}}_{{\\bf P r e-c o m p u t e d}}}\\\\ &{\\qquad={\\left({\\bf A}_{1}^{2}\\quad{\\bf A}_{2}^{2}\\quad{\\bf A}_{1}{\\bf B}_{1}{\\bf x}_{0,1}+{\\bf A}_{2}{\\bf B}_{2}{\\bf x}_{1,0}+{\\bf B}_{1}{\\bf x}_{1,1}\\right)}}\\\\ &{\\qquad={\\left({\\bf A}_{3}\\quad{\\bf A}_{4}^{2}\\quad{\\bf A}_{3}{\\bf B}_{1}{\\bf x}_{0,1}+{\\bf A}_{4}{\\bf B}_{2}{\\bf x}_{1,0}+{\\bf B}_{2}{\\bf x}_{1,1}\\right)}}\\end{array}}\n$$", "text_format": "latex", "page_idx": 23}, {"type": "text", "text": "Fixing the variate by putting 0 as the initial points of the operator, and then looking at the third element of each row, these elements are calculating the hidden states of the recurrent (it can be shown by a straightforward induction). Accordingly, using this operation, we can recursively calculate the outputs of 2D SSM. ", "page_idx": 23}, {"type": "text", "text": "However, using Theorem 3.2, we know that this is an associative operation, so instead of calculating in the recurrent form, we can use parallel pre-fix sum make this computation parallel, decreasing the sequential operations required to calculate the hidden states. Note that since our above operation can model the problem as an parallel prefix, all the algorithms for this problem can be used to enhance the efficiency. ", "page_idx": 23}, {"type": "text", "text": "G.3 Proof of Theorem 3.4 ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "To prove this theorem, we need to (1) show that Chimera can recover SpaceTime. Given this, since SpaceTime is capable of recovering ARIMA [14], exponential smoothing [16], and controllable linear time\u2013invariant systems [87], we can conclude that Chimera can also recover these methods. Then, (2) we need to prove that Chimera can recover SARIMA. This is the model that SpaceTime is not capable of recovering due to the additional seasonal terms. ", "page_idx": 23}, {"type": "text", "text": "Note that using ${\\bf A}_{2}={\\bf A}_{3}={\\bf A}_{4}=0$ , results in a 1D SSM, with companion matrix as the structure of ${\\bf A}_{1}$ , which is SpaceTime. Accordingly, SpaceTime is a special case of Chimera when the recurrence only happen along the time direction. ", "page_idx": 23}, {"type": "text", "text": "Note that as discussed in Proposition 3.1, multiplying the discretization parameter $\\Delta$ results in multiplying the steps. Accordingly, using $s$ as the $\\Delta$ in our seasonal module and also letting $\\mathbf{A}_{2}=\\mathbf{A}_{3}=\\mathbf{A}_{4}=0$ for the seasonal module, we can model the seasonal terms in the formulation of $\\mathrm{SAR}(p,q,s)$ , meaning that Chimera can also recover SARIMA which is ARIMA with seasonal terms. Note that the reason that Chimera is capable of such modeling is that it uses two heads separately for trend and seasonal terms. Therefore, using different discretization parameters, each can model their own corresponding terms in $\\mathrm{SAR}(p,q,s)$ . ", "page_idx": 24}, {"type": "text", "text": "G.4 Proof of Theorem 3.5 ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Similar to the above, using ${\\bf A}_{2}\\,=\\,{\\bf A}_{3}\\,=\\,0$ , our formulation is equivalent to S4D, while we use diagonal matrices as the structure of ${\\bf A}_{1}$ . Similarly, as discussed by Behrouz et al. [31], MambaMixer is equivalent to S4ND but on patched data. Using our Theorem 5, we can recover linear layers, resulting in recovering TSMixer by setting $\\mathbf{A}_{2}=\\mathbf{A}_{3}=0$ . ", "page_idx": 24}, {"type": "text", "text": "G.5 Proof of Theorem 3.6 ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "We in fact will show that restricting Chimera results in recovering 2DSSM [49]. As discussed earlier, this method do not use discretization and initially starts from a discrete system. Also, it uses inputindependent parameters. Therefore, we use $\\mathtt{L i n e a r}_{\\Delta_{1}}(.)=\\mathtt{L i n e a r}_{\\Delta_{2}}(.)$ as broadcast function, and restrict Chimera to have input-independent parameters, then Chimera can recover 2DSSM [49]. ", "page_idx": 24}, {"type": "text", "text": "H Experimental Settings ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "We provide the description of datasets in Table 7. ", "page_idx": 24}, {"type": "text", "text": "H.1 Baselines ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "In our experiments, we use the following baselines: ", "page_idx": 24}, {"type": "text", "text": "\u2022 Table 8: TSM2 [31], Simba [57], TCN [9], iTransformer [27], RLinear [58], PatchTST [29], Crossformer [26], TiDE [55], TimesNet [8], DLinear [59], SCINet [56], FEDformer [24], Stationary [86], Autoformer [21].   \n\u2022 Table 9: ModernTCN [9], PatchTST [29], TimesNet [8], N-HiTS [65], N-BEATS\u2217[66], ETSformer [20], LightTS [67], DLinear [11], FEDformer [24], Stationary [68], Autoformer [21], Pyraformer [23], Informer [6], Reformer [25], LSTM [69].   \n\u2022 Table 10: LSTM [69], LSTNet [88], LSSL [34], Trans.former [17], Reformer [25], Informer [6], Pyraformer [23], Autoformer [21], Station. [68], FEDformer [24], ETSformer [20], Flowformer [22], DLinear [11], LightTS. [67], TimesNet [8], PatchTST [29], MTCN [9]. ", "page_idx": 24}, {"type": "text", "text": "For the results of the baselines, we re-use the results reported by Wu et al. [8], or from the original cited papers. ", "page_idx": 24}, {"type": "text", "text": "I Additional Experimental Results ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "I.1 Long Term Forecasting Full Results ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "The complete results of long term forecasting are reported in Table 8. ", "page_idx": 24}, {"type": "text", "text": "I.2 Short-Term Forecasting ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "The complete results of short term forecasting are reported in Table 9. ", "page_idx": 24}, {"type": "text", "text": "I.3 Classification ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "The complete results of time series classification are reported in Table 10. ", "page_idx": 24}, {"type": "table", "img_path": "ncYGjx2vnE/tmp/9441ec42a6c10acf9498d9a7a28ccfa5a917be2f4fdb3f5d48b5a77af829576a.jpg", "table_caption": ["Table 10: Full results for the classification task (accuracy $\\%$ ). We omit \u201cformer\u201d from the names of Transformer-based methods. For all methods, the standard deviation is less than $0.1\\%$ . "], "table_footnote": [], "page_idx": 25}, {"type": "table", "img_path": "ncYGjx2vnE/tmp/45b1ddce2ffdaa382eecdac6730d20d99bec2d16c40626cbc3ffad16dbd484f4.jpg", "table_caption": ["Table 11: Full results for the anomaly detection task. The P, R and F1 represent the precision, recall and F1-score $(\\%)$ respectively. A higher value of P, R and F1 indicates a better performance. "], "table_footnote": [], "page_idx": 25}, {"type": "text", "text": "I.4 Anomaly Detection ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "The complete results of anomaly detection tasks are reported in Table 11. ", "page_idx": 25}, {"type": "text", "text": "J Additional Ablation Study ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "K Comparison with Koopman-based Deep Models ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "We also compare the results of Chimera with Koopman-based deep models [84]. In ECL dataset, Chimera achieves 0.132, 0.141, 0.144 for ( $/h\\,=\\,96$ , 144, 192), while Koopa [84] achieves 0.136, 0.149, 0.156. Similarly, in ETTh2, Chimera achieves 0.262, 0.309, 0.320 for $h=96$ , 144, 192), while Koopa achieves 0.297, 0.333, 0.356. Similarly, in Exchange, Chimera achieves 0.077, 0.126, 0.159 for ( $[h=96$ , 144, 192), while Koopa achieves 0.083, 0.130, 0.184. Since Liu et al. [84] has focused on these datasets and values for the horizon, we use the same setting for Chimera. The results for Koopa are from its original paper. ", "page_idx": 25}, {"type": "table", "img_path": "ncYGjx2vnE/tmp/676cce0361253b18b3d36fd667a292f097abb455575eebadd279e2a45f879b15.jpg", "table_caption": ["Table 12: Ablation Study on additional datasets. "], "table_footnote": [], "page_idx": 26}, {"type": "text", "text": "L Limitations ", "text_level": 1, "page_idx": 26}, {"type": "text", "text": "The main goal of this study is to enhance the time series modeling with a wide range of impact on society, from improving the healthcare system using developing deep learning models for analysing medical health records to forecasting stock. We, however, emphasis that our work is a proof-ofconcept, meaning that it has error modes. ", "page_idx": 26}, {"type": "text", "text": "1. Claims ", "text_level": 1, "page_idx": 27}, {"type": "text", "text": "Question: Do the main claims made in the abstract and introduction accurately reflect the paper\u2019s contributions and scope? ", "page_idx": 27}, {"type": "text", "text": "Answer: [Yes] Justification: [NA] ", "page_idx": 27}, {"type": "text", "text": "Guidelines: ", "page_idx": 27}, {"type": "text", "text": "\u2022 The answer NA means that the abstract and introduction do not include the claims made in the paper.   \n\u2022 The abstract and/or introduction should clearly state the claims made, including the contributions made in the paper and important assumptions and limitations. A No or NA answer to this question will not be perceived well by the reviewers.   \n\u2022 The claims made should match theoretical and experimental results, and reflect how much the results can be expected to generalize to other settings.   \n\u2022 It is fine to include aspirational goals as motivation as long as it is clear that these goals are not attained by the paper. ", "page_idx": 27}, {"type": "text", "text": "2. Limitations ", "text_level": 1, "page_idx": 27}, {"type": "text", "text": "Question: Does the paper discuss the limitations of the work performed by the authors? ", "page_idx": 27}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 27}, {"type": "text", "text": "Justification: See Appendix L. ", "page_idx": 27}, {"type": "text", "text": "Guidelines: ", "page_idx": 27}, {"type": "text", "text": "\u2022 The answer NA means that the paper has no limitation while the answer No means that the paper has limitations, but those are not discussed in the paper.   \n\u2022 The authors are encouraged to create a separate \"Limitations\" section in their paper.   \n\u2022 The paper should point out any strong assumptions and how robust the results are to violations of these assumptions (e.g., independence assumptions, noiseless settings, model well-specification, asymptotic approximations only holding locally). The authors should reflect on how these assumptions might be violated in practice and what the implications would be.   \n\u2022 The authors should reflect on the scope of the claims made, e.g., if the approach was only tested on a few datasets or with a few runs. In general, empirical results often depend on implicit assumptions, which should be articulated.   \n\u2022 The authors should reflect on the factors that influence the performance of the approach. For example, a facial recognition algorithm may perform poorly when image resolution is low or images are taken in low lighting. Or a speech-to-text system might not be used reliably to provide closed captions for online lectures because it fails to handle technical jargon.   \n\u2022 The authors should discuss the computational efficiency of the proposed algorithms and how they scale with dataset size.   \n\u2022 If applicable, the authors should discuss possible limitations of their approach to address problems of privacy and fairness.   \n\u2022 While the authors might fear that complete honesty about limitations might be used by reviewers as grounds for rejection, a worse outcome might be that reviewers discover limitations that aren\u2019t acknowledged in the paper. The authors should use their best judgment and recognize that individual actions in favor of transparency play an important role in developing norms that preserve the integrity of the community. Reviewers will be specifically instructed to not penalize honesty concerning limitations. ", "page_idx": 27}, {"type": "text", "text": "3. Theory Assumptions and Proofs ", "text_level": 1, "page_idx": 27}, {"type": "text", "text": "Question: For each theoretical result, does the paper provide the full set of assumptions and a complete (and correct) proof? ", "page_idx": 27}, {"type": "text", "text": "Answer: [Yes]   \nJustification: See Appendix G. Guidelines:   \n\u2022 The answer NA means that the paper does not include theoretical results.   \n\u2022 All the theorems, formulas, and proofs in the paper should be numbered and crossreferenced.   \n\u2022 All assumptions should be clearly stated or referenced in the statement of any theorems.   \n\u2022 The proofs can either appear in the main paper or the supplemental material, but if they appear in the supplemental material, the authors are encouraged to provide a short proof sketch to provide intuition.   \n\u2022 Inversely, any informal proof provided in the core of the paper should be complemented by formal proofs provided in appendix or supplemental material.   \n\u2022 Theorems and Lemmas that the proof relies upon should be properly referenced. ", "page_idx": 27}, {"type": "text", "text": "", "page_idx": 28}, {"type": "text", "text": "4. Experimental Result Reproducibility ", "text_level": 1, "page_idx": 28}, {"type": "text", "text": "Question: Does the paper fully disclose all the information needed to reproduce the main experimental results of the paper to the extent that it affects the main claims and/or conclusions of the paper (regardless of whether the code and data are provided or not)? ", "page_idx": 28}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 28}, {"type": "text", "text": "Justification: See Appendix H. ", "page_idx": 28}, {"type": "text", "text": "Guidelines: ", "page_idx": 28}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 If the paper includes experiments, a No answer to this question will not be perceived well by the reviewers: Making the paper reproducible is important, regardless of whether the code and data are provided or not.   \n\u2022 If the contribution is a dataset and/or model, the authors should describe the steps taken to make their results reproducible or verifiable.   \n\u2022 Depending on the contribution, reproducibility can be accomplished in various ways. For example, if the contribution is a novel architecture, describing the architecture fully might suffice, or if the contribution is a specific model and empirical evaluation, it may be necessary to either make it possible for others to replicate the model with the same dataset, or provide access to the model. In general. releasing code and data is often one good way to accomplish this, but reproducibility can also be provided via detailed instructions for how to replicate the results, access to a hosted model (e.g., in the case of a large language model), releasing of a model checkpoint, or other means that are appropriate to the research performed.   \n\u2022 While NeurIPS does not require releasing code, the conference does require all submissions to provide some reasonable avenue for reproducibility, which may depend on the nature of the contribution. For example (a) If the contribution is primarily a new algorithm, the paper should make it clear how to reproduce that algorithm. (b) If the contribution is primarily a new model architecture, the paper should describe the architecture clearly and fully. (c) If the contribution is a new model (e.g., a large language model), then there should either be a way to access this model for reproducing the results or a way to reproduce the model (e.g., with an open-source dataset or instructions for how to construct the dataset). (d) We recognize that reproducibility may be tricky in some cases, in which case authors are welcome to describe the particular way they provide for reproducibility. In the case of closed-source models, it may be that access to the model is limited in some way (e.g., to registered users), but it should be possible for other researchers to have some path to reproducing or verifying the results. ", "page_idx": 28}, {"type": "text", "text": "5. Open access to data and code ", "text_level": 1, "page_idx": 28}, {"type": "text", "text": "Question: Does the paper provide open access to the data and code, with sufficient instructions to faithfully reproduce the main experimental results, as described in supplemental material? ", "page_idx": 28}, {"type": "text", "text": "Answer: [Yes] Justification: It is available in this link. ", "page_idx": 28}, {"type": "text", "text": "Guidelines: ", "page_idx": 29}, {"type": "text", "text": "\u2022 The answer NA means that paper does not include experiments requiring code.   \n\u2022 Please see the NeurIPS code and data submission guidelines (https://nips.cc/ public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 While we encourage the release of code and data, we understand that this might not be possible, so \u201cNo\u201d is an acceptable answer. Papers cannot be rejected simply for not including code, unless this is central to the contribution (e.g., for a new open-source benchmark).   \n\u2022 The instructions should contain the exact command and environment needed to run to reproduce the results. See the NeurIPS code and data submission guidelines (https: //nips.cc/public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 The authors should provide instructions on data access and preparation, including how to access the raw data, preprocessed data, intermediate data, and generated data, etc.   \n\u2022 The authors should provide scripts to reproduce all experimental results for the new proposed method and baselines. If only a subset of experiments are reproducible, they should state which ones are omitted from the script and why.   \n\u2022 At submission time, to preserve anonymity, the authors should release anonymized versions (if applicable).   \n\u2022 Providing as much information as possible in supplemental material (appended to the paper) is recommended, but including URLs to data and code is permitted. ", "page_idx": 29}, {"type": "text", "text": "6. Experimental Setting/Details ", "text_level": 1, "page_idx": 29}, {"type": "text", "text": "Question: Does the paper specify all the training and test details (e.g., data splits, hyperparameters, how they were chosen, type of optimizer, etc.) necessary to understand the results? ", "page_idx": 29}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 29}, {"type": "text", "text": "Justification: See above question. Guidelines: ", "page_idx": 29}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments. \u2022 The experimental setting should be presented in the core of the paper to a level of detail that is necessary to appreciate the results and make sense of them. \u2022 The full details can be provided either with the code, in appendix, or as supplemental material. ", "page_idx": 29}, {"type": "text", "text": "7. Experiment Statistical Significance ", "text_level": 1, "page_idx": 29}, {"type": "text", "text": "Question: Does the paper report error bars suitably and correctly defined or other appropriate information about the statistical significance of the experiments? ", "page_idx": 29}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 29}, {"type": "text", "text": "Justification: [NA] ", "page_idx": 29}, {"type": "text", "text": "Guidelines: ", "page_idx": 29}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The authors should answer \"Yes\" if the results are accompanied by error bars, confidence intervals, or statistical significance tests, at least for the experiments that support the main claims of the paper.   \n\u2022 The factors of variability that the error bars are capturing should be clearly stated (for example, train/test split, initialization, random drawing of some parameter, or overall run with given experimental conditions).   \n\u2022 The method for calculating the error bars should be explained (closed form formula, call to a library function, bootstrap, etc.)   \n\u2022 The assumptions made should be given (e.g., Normally distributed errors).   \n\u2022 It should be clear whether the error bar is the standard deviation or the standard error of the mean.   \n\u2022 It is OK to report 1-sigma error bars, but one should state it. The authors should preferably report a 2-sigma error bar than state that they have a $96\\%$ CI, if the hypothesis of Normality of errors is not verified. ", "page_idx": 29}, {"type": "text", "text": "\u2022 For asymmetric distributions, the authors should be careful not to show in tables or figures symmetric error bars that would yield results that are out of range (e.g. negative error rates). \u2022 If error bars are reported in tables or plots, The authors should explain in the text how they were calculated and reference the corresponding figures or tables in the text. ", "page_idx": 30}, {"type": "text", "text": "8. Experiments Compute Resources ", "text_level": 1, "page_idx": 30}, {"type": "text", "text": "Question: For each experiment, does the paper provide sufficient information on the computer resources (type of compute workers, memory, time of execution) needed to reproduce the experiments? ", "page_idx": 30}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 30}, {"type": "text", "text": "Justification: See question 5. ", "page_idx": 30}, {"type": "text", "text": "Guidelines: ", "page_idx": 30}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The paper should indicate the type of compute workers CPU or GPU, internal cluster, or cloud provider, including relevant memory and storage.   \n\u2022 The paper should provide the amount of compute required for each of the individual experimental runs as well as estimate the total compute.   \n\u2022 The paper should disclose whether the full research project required more compute than the experiments reported in the paper (e.g., preliminary or failed experiments that didn\u2019t make it into the paper). ", "page_idx": 30}, {"type": "text", "text": "9. Code Of Ethics ", "text_level": 1, "page_idx": 30}, {"type": "text", "text": "Question: Does the research conducted in the paper conform, in every respect, with the NeurIPS Code of Ethics https://neurips.cc/public/EthicsGuidelines? ", "page_idx": 30}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 30}, {"type": "text", "text": "Justification: We have reviewed NeurIPS Code of Ethics. ", "page_idx": 30}, {"type": "text", "text": "Guidelines: ", "page_idx": 30}, {"type": "text", "text": "\u2022 The answer NA means that the authors have not reviewed the NeurIPS Code of Ethics.   \n\u2022 If the authors answer No, they should explain the special circumstances that require a deviation from the Code of Ethics.   \n\u2022 The authors should make sure to preserve anonymity (e.g., if there is a special consideration due to laws or regulations in their jurisdiction). ", "page_idx": 30}, {"type": "text", "text": "10. Broader Impacts ", "text_level": 1, "page_idx": 30}, {"type": "text", "text": "Question: Does the paper discuss both potential positive societal impacts and negative societal impacts of the work performed? ", "page_idx": 30}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 30}, {"type": "text", "text": "Justification: See Appendix L. ", "page_idx": 30}, {"type": "text", "text": "Guidelines: ", "page_idx": 30}, {"type": "text", "text": "\u2022 The answer NA means that there is no societal impact of the work performed.   \n\u2022 If the authors answer NA or No, they should explain why their work has no societal impact or why the paper does not address societal impact.   \n\u2022 Examples of negative societal impacts include potential malicious or unintended uses (e.g., disinformation, generating fake profiles, surveillance), fairness considerations (e.g., deployment of technologies that could make decisions that unfairly impact specific groups), privacy considerations, and security considerations.   \n\u2022 The conference expects that many papers will be foundational research and not tied to particular applications, let alone deployments. However, if there is a direct path to any negative applications, the authors should point it out. For example, it is legitimate to point out that an improvement in the quality of generative models could be used to generate deepfakes for disinformation. On the other hand, it is not needed to point out that a generic algorithm for optimizing neural networks could enable people to train models that generate Deepfakes faster. ", "page_idx": 30}, {"type": "text", "text": "\u2022 The authors should consider possible harms that could arise when the technology is being used as intended and functioning correctly, harms that could arise when the technology is being used as intended but gives incorrect results, and harms following from (intentional or unintentional) misuse of the technology. \u2022 If there are negative societal impacts, the authors could also discuss possible mitigation strategies (e.g., gated release of models, providing defenses in addition to attacks, mechanisms for monitoring misuse, mechanisms to monitor how a system learns from feedback over time, improving the efficiency and accessibility of ML). ", "page_idx": 31}, {"type": "text", "text": "11. Safeguards ", "text_level": 1, "page_idx": 31}, {"type": "text", "text": "Question: Does the paper describe safeguards that have been put in place for responsible release of data or models that have a high risk for misuse (e.g., pretrained language models, image generators, or scraped datasets)? ", "page_idx": 31}, {"type": "text", "text": "Answer:[NA] Justification: [NA] Guidelines: ", "page_idx": 31}, {"type": "text", "text": "\u2022 The answer NA means that the paper poses no such risks.   \n\u2022 Released models that have a high risk for misuse or dual-use should be released with necessary safeguards to allow for controlled use of the model, for example by requiring that users adhere to usage guidelines or restrictions to access the model or implementing safety filters.   \n\u2022 Datasets that have been scraped from the Internet could pose safety risks. The authors should describe how they avoided releasing unsafe images.   \n\u2022 We recognize that providing effective safeguards is challenging, and many papers do not require this, but we encourage authors to take this into account and make a best faith effort. ", "page_idx": 31}, {"type": "text", "text": "12. Licenses for existing assets ", "text_level": 1, "page_idx": 31}, {"type": "text", "text": "Question: Are the creators or original owners of assets (e.g., code, data, models), used in the paper, properly credited and are the license and terms of use explicitly mentioned and properly respected? ", "page_idx": 31}, {"type": "text", "text": "Answer: [Yes] Justification: [NA] ", "page_idx": 31}, {"type": "text", "text": "Guidelines: ", "page_idx": 31}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not use existing assets.   \n\u2022 The authors should cite the original paper that produced the code package or dataset.   \n\u2022 The authors should state which version of the asset is used and, if possible, include a URL.   \n\u2022 The name of the license (e.g., CC-BY 4.0) should be included for each asset.   \n\u2022 For scraped data from a particular source (e.g., website), the copyright and terms of service of that source should be provided.   \n\u2022 If assets are released, the license, copyright information, and terms of use in the package should be provided. For popular datasets, paperswithcode.com/datasets has curated licenses for some datasets. Their licensing guide can help determine the license of a dataset.   \n\u2022 For existing datasets that are re-packaged, both the original license and the license of the derived asset (if it has changed) should be provided.   \n\u2022 If this information is not available online, the authors are encouraged to reach out to the asset\u2019s creators. ", "page_idx": 31}, {"type": "text", "text": "13. New Assets ", "text_level": 1, "page_idx": 31}, {"type": "text", "text": "Question: Are new assets introduced in the paper well documented and is the documentation provided alongside the assets? ", "page_idx": 31}, {"type": "text", "text": "Answer: [NA] Justification: [NA] ", "page_idx": 31}, {"type": "text", "text": "Guidelines: ", "page_idx": 32}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not release new assets.   \n\u2022 Researchers should communicate the details of the dataset/code/model as part of their submissions via structured templates. This includes details about training, license, limitations, etc.   \n\u2022 The paper should discuss whether and how consent was obtained from people whose asset is used.   \n\u2022 At submission time, remember to anonymize your assets (if applicable). You can either create an anonymized URL or include an anonymized zip file. ", "page_idx": 32}, {"type": "text", "text": "14. Crowdsourcing and Research with Human Subjects ", "text_level": 1, "page_idx": 32}, {"type": "text", "text": "Question: For crowdsourcing experiments and research with human subjects, does the paper include the full text of instructions given to participants and screenshots, if applicable, as well as details about compensation (if any)? ", "page_idx": 32}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 32}, {"type": "text", "text": "Justification: [NA] Guidelines: ", "page_idx": 32}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Including this information in the supplemental material is fine, but if the main contribution of the paper involves human subjects, then as much detail as possible should be included in the main paper.   \n\u2022 According to the NeurIPS Code of Ethics, workers involved in data collection, curation, or other labor should be paid at least the minimum wage in the country of the data collector. ", "page_idx": 32}, {"type": "text", "text": "15. Institutional Review Board (IRB) Approvals or Equivalent for Research with Human Subjects ", "page_idx": 32}, {"type": "text", "text": "Question: Does the paper describe potential risks incurred by study participants, whether such risks were disclosed to the subjects, and whether Institutional Review Board (IRB) approvals (or an equivalent approval/review based on the requirements of your country or institution) were obtained? ", "page_idx": 32}, {"type": "text", "text": "Answer: [NA] Justification: [NA] Guidelines: ", "page_idx": 32}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Depending on the country in which research is conducted, IRB approval (or equivalent) may be required for any human subjects research. If you obtained IRB approval, you should clearly state this in the paper.   \n\u2022 We recognize that the procedures for this may vary significantly between institutions and locations, and we expect authors to adhere to the NeurIPS Code of Ethics and the guidelines for their institution.   \n\u2022 For initial submissions, do not include any information that would break anonymity (if applicable), such as the institution conducting the review. ", "page_idx": 32}]