[{"figure_path": "zb8jLAh2VN/figures/figures_2_1.jpg", "caption": "Figure 1: Switching Recurrent Neural Network (SRNN) (A) Schematic showing an SRNN with neural outputs. (B) Structure of the generative model for SRNN. (C) Structure of Inference Neural Network for SRNN. The h\u1ecb and hi represent the states of a bidirectional RNN, followed by a h\u1ec9, which model the inferred ht from the given observation yt.", "description": "This figure shows the architecture of the Switching Recurrent Neural Network (SRNN) model proposed in the paper. Panel A shows a schematic of the SRNN, highlighting the switching mechanism between different RNNs based on discrete hidden states. Panel B illustrates the generative model's structure, depicting how the hidden states and observations are generated from the RNNs and the switch. Finally, Panel C presents the inference network, illustrating how the model infers the hidden states given the observations. Each panel provides a visual representation of the model's different components and their interactions.", "section": "3 Methods"}, {"figure_path": "zb8jLAh2VN/figures/figures_6_1.jpg", "caption": "Figure 3: Curved Reaching: (A) Examples of comparison between behavioral states and neural dynamical states recovered by SRNNs, SLDS, rSLDS, SNLDS, and mrSDS. (B) Error between behaviorally-relevant states and recovered neural dynamical states; each dot represents one session, with the triangle as the mean of all sessions. (C) Mean squared error (MSE) between neural activity and the reconstruction. (D) MSE between neural activity and the prediction forward in time. (E) Flow fields of latent dynamics of SRNNs in different discrete states. (F) Reconstruction of neural activity and the corresponding ground truth for one example neuron for three models, the top color bars represent the performance on 0.1 seconds ahead prediction. More examples are shown in Figure D.2. All results for direct reaching are shown in Figure D.1.", "description": "This figure shows the results of applying different models (SRNN, SLDS, rSLDS, SNLDS, mrSDS) to curved reaching data.  Panel A shows examples of how well each model aligns the inferred neural dynamical states with the behavioral states. Panel B shows the error between the inferred and actual behavioral states, indicating SRNN's superior performance. Panel C displays the MSE between the neural activity and its reconstruction by each model.  Panel D presents the prediction accuracy of each model. Panel E visualizes the flow fields of the latent dynamics in different discrete states, showcasing their distinct characteristics using SRNN. Finally, panel F compares the neural activity reconstructions for a single neuron across the different models, highlighting SRNN's accurate reconstruction and prediction. ", "section": "4.2 Experimental data: Electrophysiology Recordings during a Monkey Reaching Task"}, {"figure_path": "zb8jLAh2VN/figures/figures_8_1.jpg", "caption": "Figure 4: WFCI Decision-Making: (A-F) Legend similar to Figure 3 legend. The top color bars in (F) represent 0.33s ahead prediction accuracy; more examples shown in Figure D.2.", "description": "This figure displays the results of applying the Switching Recurrent Neural Network (SRNN) model, along with other competing models like SLDS, rSLDS, SNLDS, and mrSDS, to analyze widefield calcium imaging (WFCI) data from a mouse decision-making task.  Panel A shows a comparison between behavioral states and the neural dynamical states identified by each model. Panel B illustrates the error between behavioral states and the recovered states for each model. Panel C depicts the mean squared error (MSE) between the neural activity and the reconstruction for each model.  Panel D presents the MSE between the neural activity and the prediction made by each model for different time points into the future. Panel E visualizes the flow fields of latent dynamics in distinct states for the SRNN model. Finally, panel F showcases example neural activity reconstructions by various methods in comparison to the ground truth, with a color bar to show the performance of the 0.33-second ahead predictions.  The figure demonstrates the SRNN model's ability to accurately reconstruct and predict neural activity related to behaviorally-relevant states in a decision making task.", "section": "4.3 Experimental data: Widefield Calcium Imaging during Mouse Decision-Making"}, {"figure_path": "zb8jLAh2VN/figures/figures_9_1.jpg", "caption": "Figure 3: Curved Reaching: (A) Examples of comparison between behavioral states and neural dynamical states recovered by SRNNs, SLDS, rSLDS, SNLDS, and mrSDS. (B) Error between behaviorally-relevant states and recovered neural dynamical states; each dot represents one session, with the triangle as the mean of all sessions. (C) Mean squared error (MSE) between neural activity and the reconstruction. (D) MSE between neural activity and the prediction forward in time. (E) Flow fields of latent dynamics of SRNNs in different discrete states. (F) Reconstruction of neural activity and the corresponding ground truth for one example neuron for three models, the top color bars represent the performance on 0.1 seconds ahead prediction. More examples are shown in Figure D.2. All results for direct reaching are shown in Figure D.1.", "description": "This figure shows a comparison of the performance of SRNNs against other methods (SLDS, rSLDS, SNLDS, and mrSDS) on a monkey reaching task. It visualizes how well each method recovers behavioral states from neural activity and predicts future neural activity, along with the neural dynamics in different discrete states. The figure also includes a reconstruction of neural activity for a single neuron to showcase the performance differences between the models.", "section": "4.2 Experimental data: Electrophysiology Recordings during a Monkey Reaching Task"}, {"figure_path": "zb8jLAh2VN/figures/figures_14_1.jpg", "caption": "Figure 3: Curved Reaching: (A) Examples of comparison between behavioral states and neural dynamical states recovered by SRNNs, SLDS, rSLDS, SNLDS, and mrSDS. (B) Error between behaviorally-relevant states and recovered neural dynamical states; each dot represents one session, with the triangle as the mean of all sessions. (C) Mean squared error (MSE) between neural activity and the reconstruction. (D) MSE between neural activity and the prediction forward in time. (E) Flow fields of latent dynamics of SRNNs in different discrete states. (F) Reconstruction of neural activity and the corresponding ground truth for one example neuron for three models, the top color bars represent the performance on 0.1 seconds ahead prediction. More examples are shown in Figure D.2. All results for direct reaching are shown in Figure D.1.", "description": "This figure shows a comparison of the performance of SRNNs against other methods for identifying behavioral states from neural activity in a monkey reaching task.  Panel A shows examples comparing the recovered neural dynamical states with the actual behavioral states. Panel B quantifies the error between recovered and actual behavioral states. Panel C and D show mean squared error (MSE) for reconstruction and prediction, respectively. Panel E displays the flow fields of the latent dynamics in each discrete state of the SRNN. Panel F shows reconstruction vs ground truth for a single neuron, illustrating prediction accuracy.", "section": "4.2 Experimental data: Electrophysiology Recordings during a Monkey Reaching Task"}, {"figure_path": "zb8jLAh2VN/figures/figures_15_1.jpg", "caption": "Figure 2: Lorenz Attractor: (A) Reconstruction using an SRNN on simulated data (thick red is the original data, thin black is the reconstruction by SRNN. The reconstruction is almost overlapped with the ground truth). (B) Comparison between ground truth discrete states and SRNN-recovered discrete states. (C) Plot of latent dynamics in each discrete state shows recovery of dynamics.", "description": "This figure demonstrates the performance of Switching Recurrent Neural Networks (SRNNs) on a simulated Lorenz attractor dataset. Panel A shows the high accuracy of SRNNs in reconstructing the simulated data, with the SRNN reconstruction almost perfectly overlapping the ground truth. Panel B compares the ground truth discrete states with those recovered by the SRNN model, highlighting the model's ability to accurately identify the discrete states. Finally, Panel C visualizes the latent dynamics within each discrete state, showcasing the model's successful recovery of the underlying dynamical features of the system.", "section": "4 Results"}, {"figure_path": "zb8jLAh2VN/figures/figures_15_2.jpg", "caption": "Figure D.1: Direct Reaching: (A) Examples of comparison between behavioral states and neural dynamical states recovered by SRNNs, SLDS, and rSLDS. (B) Error between behaviorally-relevant states and recovered neural dynamical states; each dot represents one session, with the triangle as the mean of all sessions. (C) Mean squared error (MSE) between neural activity and the reconstruction. (D) MSE between neural activity and the prediction forward in time. (E) Reconstruction of neural activity and the corresponding ground truth for one example neuron for three models, the top color bars represent the performance on 0.1 seconds ahead prediction. More examples are shown in Figure D.2. (F) Flow fields of latent dynamics of SRNNs in different discrete states.", "description": "This figure shows a comparison of the performance of SRNNs, SLDS, and rSLDS on a direct reaching task.  Panel A displays examples of the comparison between behavioral states and the neural dynamical states recovered by each model. Panel B shows the error between behavioral states and recovered states for each session. Panel C presents the mean squared error (MSE) between the neural activity and the reconstruction for each model. Panel D shows the MSE between neural activity and predictions made 0.1 seconds into the future. Panel E shows the reconstruction of neural activity and the corresponding ground truth for a single neuron. Finally, Panel F illustrates the flow fields of latent dynamics in different discrete states recovered by SRNNs.", "section": "Appendix Figures"}, {"figure_path": "zb8jLAh2VN/figures/figures_15_3.jpg", "caption": "Figure D.2: Reconstruction of neural activity and the corresponding ground truth in different brain region/neuron for (A) curved reaching, (B) direct reaching, (C) self-initiated decision making, and (D) self-initiated lever pull. Red color represents SLDS, green color represents rSLDS, blue color represents SRNN, purple color represents SNLDS, and orange color represents mrSDS.", "description": "This figure displays the reconstruction of neural activity by different models (SLDS, rSLDS, SNLDS, mrSDS, and SRNN) compared to the true neural activity for four different tasks: curved reaching, direct reaching, self-initiated decision-making, and self-initiated lever pull.  Each subfigure shows the true neural activity and the reconstructed neural activity for several example neurons from different brain regions. The color coding helps to distinguish between the different models in the reconstructions.", "section": "Appendix Figures"}, {"figure_path": "zb8jLAh2VN/figures/figures_15_4.jpg", "caption": "Figure D.2: Reconstruction of neural activity and the corresponding ground truth in different brain region/neuron for (A) curved reaching, (B) direct reaching, (C) self-initiated decision making, and (D) self-initiated lever pull. Red color represents SLDS, green color represents rSLDS, blue color represents SRNN, purple color represents SNLDS, and orange color represents mrSDS.", "description": "This figure shows the reconstruction of neural activity by four different models: SLDS, rSLDS, SNLDS, and mrSDS, compared to the ground truth. The reconstruction is shown for four different tasks: curved reaching, direct reaching, self-initiated decision making, and self-initiated lever pull.  Different colors represent different models. The figure helps visualize how well each model reconstructs the neural activity for each task and brain region.", "section": "Appendix Figures"}, {"figure_path": "zb8jLAh2VN/figures/figures_16_1.jpg", "caption": "Figure D.3: Curved Reaching: (A) Examples of comparison between behavioral states and neural dynamical states recovered by SRNN with K = 4, K = 5, and K = 6. (B) Mean squared error (MSE) between neural activity and the reconstruction by SRNN with K = 4, K = 5, and K = 6. (C) Mean squared error (MSE) between neural activity and the reconstruction by SRNN with K = 4, K = 5, and K = 6 using the co-smoothing test. (D) Variance of behavioral states recovered by SRNN with K = 4, K = 5, and K = 6.", "description": "This figure shows the results of applying the Switching Recurrent Neural Network (SRNN) model with different numbers of discrete hidden states (K=4, 5, and 6) to curved reaching data.  Panel A visually compares the behavioral states with the neural dynamical states recovered by the SRNN for each value of K. Panels B and C show the mean squared error (MSE) between the neural activity and the SRNN reconstruction, with Panel C specifically using a \"co-smoothing\" technique to address potential issues with the model's learning process.  Panel D presents the variance in behavioral states identified by the SRNN for different values of K. The overall goal of this figure is to show how the choice of K affects the model's performance in reconstructing neural dynamics and identifying behaviorally relevant states.", "section": "Appendix Figures"}, {"figure_path": "zb8jLAh2VN/figures/figures_16_2.jpg", "caption": "Figure D.4: WFCI Decision-Making: (A) Examples of comparison between behavioral states and neural dynamical states recovered by SRNN with K = 4, K = 5, and K = 6. (B) Mean squared error (MSE) between neural activity and the reconstruction by SRNN with K = 4, K = 5, and K = 6. (C) Mean squared error (MSE) between neural activity and the reconstruction by SRNN with K = 4, K = 5, and K = 6 using the co-smoothing test. (D) Variance of behavioral states recovered by SRNN with K = 4, K = 5, and K = 6.", "description": "Figure D.4 shows the result of applying the Switching Recurrent Neural Network (SRNN) model with different numbers of discrete hidden states (K=4, 5, and 6) to the widefield calcium imaging (WFCI) data from a decision-making task.  The figure compares the model's performance in reconstructing the neural activity (MSE), aligning with behavioral states (error), and the variability of the recovered behavioral states. This helps determine the optimal number of states for the SRNN model.", "section": "Appendix Figures"}, {"figure_path": "zb8jLAh2VN/figures/figures_17_1.jpg", "caption": "Figure D.5: WFCI Self-Initiated Lever Pull: (A) Examples of comparison between behavioral states and neural dynamical states recovered by SRNN with K = 2, K = 3, and K = 4. (B) Mean squared error (MSE) between neural activity and the reconstruction by SRNN with K = 2, K = 3, and K = 4. (C) Mean squared error (MSE) between neural activity and the reconstruction by SRNN with K = 2, K = 3, and K = 4 using the co-smoothing test. (D) Variance of behavioral states recovered by SRNN with K = 2, K = 3, and K = 4.", "description": "This figure displays the results of applying Switching Recurrent Neural Networks (SRNNs) with varying numbers of discrete states (K) to widefield calcium imaging (WFCI) data from a mouse self-initiated lever pull task.  It shows a comparison between behavioral states and the neural dynamical states recovered by the model, mean squared errors (MSE) for different numbers of states, MSEs after applying a 'co-smoothing' technique to reduce noise, and the variance of behavioral states across runs.  The goal is to determine the optimal number of discrete states for the SRNN model on this particular dataset.", "section": "Appendix Figures"}, {"figure_path": "zb8jLAh2VN/figures/figures_17_2.jpg", "caption": "Figure 2: Lorenz Attractor: (A) Reconstruction using an SRNN on simulated data (thick red is the original data, thin black is the reconstruction by SRNN. The reconstruction is almost overlapped with the ground truth). (B) Comparison between ground truth discrete states and SRNN-recovered discrete states. (C) Plot of latent dynamics in each discrete state shows recovery of dynamics.", "description": "This figure demonstrates the performance of the Switching Recurrent Neural Network (SRNN) model on a simulated Lorenz attractor dataset. Panel A shows the reconstruction of the simulated data using the SRNN model, almost perfectly overlapping the ground truth. Panel B compares the ground truth discrete states to those recovered by the SRNN model, indicating a high degree of accuracy. Finally, Panel C visualizes the latent dynamics within each discrete state, showcasing the model's ability to capture the underlying dynamical features.", "section": "4 Results"}, {"figure_path": "zb8jLAh2VN/figures/figures_18_1.jpg", "caption": "Figure D.7: First column: Plot of SRNN training loss across 5000 epochs for example run in (A) reaching dataset, (D) self-initiated lever pull dataset, and (G) self-initiated decision making dataset. Second column: Plot of MSE between desired neural activity in validation set and the corresponding reconstruction by SRNN for (B) reaching dataset, (E) self-initiated lever pull dataset, and (H) self-initiated decision making dataset. Third column: Plot of error between behavioral states in validation set and the corresponding recovered state by SRNN for (C) reaching dataset, (F) self-initiated lever pull dataset, and (I) self-initiated decision making dataset.", "description": "This figure shows the training loss, reconstruction error (MSE), and discrete state recovery error during training of SRNNs on three different datasets: monkey reaching task, mouse self-initiated lever pull task, and mouse self-initiated decision making task.  Each column represents a different metric across 5000 training epochs, displayed for each dataset.  The plot illustrates the convergence of SRNNs on each task and provides insight into their training dynamics.", "section": "Appendix Figures"}, {"figure_path": "zb8jLAh2VN/figures/figures_18_2.jpg", "caption": "Figure D.1: Direct Reaching: (A) Examples of comparison between behavioral states and neural dynamical states recovered by SRNNs, SLDS, and rSLDS. (B) Error between behaviorally-relevant states and recovered neural dynamical states; each dot represents one session, with the triangle as the mean of all sessions. (C) Mean squared error (MSE) between neural activity and the reconstruction. (D) MSE between neural activity and the prediction forward in time. (E) Reconstruction of neural activity and the corresponding ground truth for one example neuron for three models, the top color bars represent the performance on 0.1 seconds ahead prediction. More examples are shown in Figure D.2. (F) Flow fields of latent dynamics of SRNNs in different discrete states.", "description": "This figure compares the performance of SRNNs, SLDS, and rSLDS models on a monkey reaching task.  Panel A shows examples of the comparison between behavioral and neural dynamical states. Panel B quantifies the error between recovered states and behavioral states across sessions. Panel C displays the MSE between reconstructed and actual neural activity. Panel D shows the MSE for neural activity prediction. Panel E illustrates an example neuron's activity reconstruction and ground truth, showing predictive capabilities. Finally, Panel F visualizes the neural dynamics' flow fields in different discrete states.", "section": "Appendix Figures"}, {"figure_path": "zb8jLAh2VN/figures/figures_19_1.jpg", "caption": "Figure 2: Lorenz Attractor: (A) Reconstruction using an SRNN on simulated data (thick red is the original data, thin black is the reconstruction by SRNN. The reconstruction is almost overlapped with the ground truth). (B) Comparison between ground truth discrete states and SRNN-recovered discrete states. (C) Plot of latent dynamics in each discrete state shows recovery of dynamics.", "description": "This figure shows the results of applying the Switching Recurrent Neural Network (SRNN) model to a simulated Lorenz attractor dataset.  Panel A demonstrates the SRNN's ability to accurately reconstruct the simulated data, almost perfectly overlapping the ground truth. Panel B compares the discrete states identified by the SRNN model against the ground truth, demonstrating a high degree of accuracy in state identification. Finally, Panel C visualizes the latent dynamics within each of the discrete states, revealing the successful recovery of the underlying dynamical features by the SRNN model.", "section": "4 Results"}]