[{"figure_path": "pU0z2sNM1M/figures/figures_2_1.jpg", "caption": "Figure 1: Motivating example. Causal Dependence Plots (top row) and the Explanatory Causal Model (bottom) for the motivating example. Points show the explanatory dataset, which in this example is also the training data for the predictive models. Counterfactual curves for individual points are shown as thin, light lines, with averages displayed as thick, dark lines. Total Dependence (TDP) is represented in blue and Natural Direct Dependence in orange. Panel (a) shows the relationships of the ECM. Panels (b-c) show CDPs for a linear model and random forest (RF) model, respectively. Panel (d) shows PDP and ICE curves for the RF model from a standard software library. This is identical to our NDDP in panel (c). We show this holds true in general: PDP/ICE are a special case of CDPs.", "description": "This figure demonstrates a motivating example of Causal Dependence Plots (CDPs) by comparing them with Partial Dependence Plots (PDPs) and Individual Conditional Expectation (ICE) plots. It shows how a model's predictions depend on changes in a given predictor, considering causal changes in other variables, unlike PDPs/ICE that assume independence or hold other variables constant.  The top row visualizes CDPs for different predictive models (linear model, Random Forest) showing Total Dependence (TDP) in blue and Natural Direct Dependence (NDDP) in orange.  The bottom panel displays the Explanatory Causal Model (ECM) used to generate the data.", "section": "1 Introduction"}, {"figure_path": "pU0z2sNM1M/figures/figures_5_1.jpg", "caption": "Figure 2: An ECM for predictors is used to produce an explanation E(f) of the predictive model f. Solid arrows represent possible causal relationships in the ECM, and dotted arrows show dependence of the model explanation on predictors. In (a) Gx denotes the subgraph of the SCM for predictors. In the mediation example (b), predictor X causes Y directly and also through mediator M, creating an important distinction between direct dependence (orange) and total dependence (blue). The reverse causality example (c) shows variables useful in predicting Y may be caused by Y, and also be causes of prediction \u0176 = f(X, M) and the explanation of that prediction.", "description": "This figure demonstrates how an Explanatory Causal Model (ECM) can be used to generate explanations for a predictive model. It shows three scenarios: (a) direct prediction without mediation, (b) mediation where X influences Y both directly and indirectly through M, and (c) reverse causality where Y also affects the predictors.  The solid arrows in the diagrams represent causal relationships within the ECM, while the dashed arrows indicate the dependence of the model explanation on the predictors.  Each scenario highlights how the structure of the ECM affects the interpretation of the model's predictions.", "section": "2.5 Causal Dependence Plots"}, {"figure_path": "pU0z2sNM1M/figures/figures_7_1.jpg", "caption": "Figure 3: TDP, NDDP, and NIDP uncertainty bands for the salary example using the random forest model in Figure 1. The range of curves is induced by two candidate ECMs described in Section 2.7.", "description": "This figure compares the Total Dependence Plot (TDP), Natural Direct Dependence Plot (NDDP), and Natural Indirect Dependence Plot (NIDP) for the salary example introduced in Figure 1.  The key takeaway is that the range of curves (uncertainty bands) for each plot is generated by using two different candidate Explanatory Causal Models (ECMs), highlighting the sensitivity of the plots to the choice of causal model. This illustrates how uncertainty in the causal structure can affect the interpretation of causal relationships between input features and the model predictions.", "section": "Experiments"}, {"figure_path": "pU0z2sNM1M/figures/figures_8_1.jpg", "caption": "Figure 4: Comparison of CDP (a) with PDP (b), ALE (c), and SHAP plots (d) for the salary example in Figure 1. Our TDP stands out, and all other plots are qualitatively similar.", "description": "This figure compares the Causal Dependence Plot (CDP) with other model-agnostic explanation methods such as Partial Dependence Plots (PDP), Accumulated Local Effects (ALE), and SHAP plots.  The comparison uses the salary prediction example from Figure 1, illustrating the differences in how these methods visualize the relationship between a predictor (parental income) and the predicted outcome (salary).  The key takeaway is that the CDP provides a unique and distinct perspective compared to the others, suggesting its value in model interpretation.", "section": "3 Experiments"}, {"figure_path": "pU0z2sNM1M/figures/figures_8_2.jpg", "caption": "Figure 5: ECM for the Sachs et al. [49] dataset (left), CDPs for an MLP predictive model (center), ALE (line) and SHAP (points) plots (right). All plots visualize the effect of PKA on predicted p44/42. PKA and its descendants are bolded. The NDDP (i.e. PDP + ICE), ALE, and SHAP all show an overall decrease, while the TDP shows an increase. Conclusions depend strongly, qualitatively, on the specific interpretive question we ask, and causal modeling allows us to formulate questions precisely. visualizing uncertainty, for example by leveraging sensitivity analysis based on conformal prediction [9, 21, 31, 61].", "description": "This figure shows an ECM (Explanatory Causal Model) for the Sachs et al. dataset of protein expression levels, CDPs (Causal Dependence Plots) for a multi-layer perceptron (MLP) predictive model, and ALE (Accumulated Local Effects) and SHAP (SHapley Additive exPlanations) plots.  It compares different ways of visualizing the effect of PKA (protein kinase A) on the prediction of p44/42. The CDPs, particularly the TDP (Total Dependence Plot), highlight the importance of causal modeling in interpreting the relationships between variables, as the TDP shows an increase in p44/42 with increased PKA, contrasting with the decrease shown by NDDP (Natural Direct Dependence Plot), ALE, and SHAP. This difference emphasizes how different methods can lead to different conclusions depending on the specific question being asked. The figure also demonstrates how causal modeling can help to address uncertainty in model interpretation.", "section": "3 Experiments"}, {"figure_path": "pU0z2sNM1M/figures/figures_17_1.jpg", "caption": "Figure 6: CDPs for the simulation example with data from (7), shown for a 'good' black-box and correct ECM (top row), a 'bad' black-box model and correct ECM (middle row), and a 'good' black-box and misspecified ECM (bottom row).", "description": "This figure shows the effect of using different black-box models and explanatory causal models (ECMs) on the resulting causal dependence plots (CDPs).  The top row demonstrates the case where the black-box model is accurate and the ECM is correct, which should produce accurate and reliable CDPs. The middle row shows a case where the black-box model is inaccurate while using the correct ECM.  This would reveal information about the flaws of the black-box model rather than providing useful inferences about the true data generation process.  Finally, the bottom row presents a case where the black-box model is accurate but the ECM is misspecified. This shows the sensitivity of the CDPs to the specification of the causal model.  In short, this figure highlights the importance of both an accurate black-box predictive model and a correctly specified ECM for reliable causal analysis and visualization. ", "section": "B Model misspecification"}, {"figure_path": "pU0z2sNM1M/figures/figures_17_2.jpg", "caption": "Figure 4: Comparison of CDP (a) with PDP (b), ALE (c), and SHAP plots (d) for the salary example in Figure 1. Our TDP stands out, and all other plots are qualitatively similar.", "description": "This figure compares the Causal Dependence Plot (CDP) with three other model-agnostic explanation methods: Partial Dependence Plot (PDP), Accumulated Local Effects (ALE), and SHAP.  The comparison uses data from a simulated salary prediction example (Figure 1).  The figure highlights that the CDP provides a qualitatively different explanation compared to the others, suggesting a unique perspective stemming from its causal modeling approach. The other methods, while providing visualizations of predictor impact, appear quite similar.", "section": "3 Experiments"}, {"figure_path": "pU0z2sNM1M/figures/figures_18_1.jpg", "caption": "Figure 8: Breast cancer data example. CDPs for a random forest classifier and predictors Clump Thickness (first row) and Uniformity of Cell Shape (second row). Structural graph GB for the ECM learned by the PC algorithm (last row). The outcome Class is binary: 2 for benign, 4 for malignant.", "description": "This figure shows Causal Dependence Plots (CDPs) for a random forest classifier trained on a breast cancer dataset.  It visualizes the relationship between the predicted tumor class (benign or malignant) and two specific input features: Clump Thickness and Uniformity of Cell Shape. Different types of CDPs (Total Dependence, Partially Controlled Dependence, Natural Direct Dependence, and Natural Indirect Dependence) are shown for each feature.  The bottom panel displays the explanatory causal model (ECM) used, learned from the data using the PC algorithm, showing the causal relationships between the predictor variables.  This demonstrates how CDPs can be used alongside causal structure learning for model interpretation.", "section": "3 Experiments"}, {"figure_path": "pU0z2sNM1M/figures/figures_19_1.jpg", "caption": "Figure 9: Total Dependence Plots, Natural Direct Dependence Plots and Natural Indirect Dependence Plots for the Breast Cancer Wisconsin dataset under three possible DAGs consistent with the PC algorithm output: (1) with the edge Cell Shape \u2192 Cell Size, (2) with the edge Cell Size \u2192 Cell Shape, and (3) with no edge between Cell Size and Cell Shape.", "description": "This figure compares three different causal dependence plots (Total Dependence, Natural Direct Dependence, and Natural Indirect Dependence) for a breast cancer prediction model. The plots show how the predicted outcome (tumor class) changes depending on the 'Uniformity of Cell Shape' feature. Three different models are used, each representing a different causal relationship between 'Uniformity of Cell Shape' and 'Cell Size', demonstrating how these causal relationships influence the interpretation of the dependence plots.", "section": "B.2 Real data with structural causal learning"}, {"figure_path": "pU0z2sNM1M/figures/figures_19_2.jpg", "caption": "Figure 10: Individual counterfactual curves can show heterogeneous effects. In this example the relationship is positive for some individuals and negative for others with average effect of zero.", "description": "This figure displays individual counterfactual curves for a Total Dependence Plot (TDP).  Each light blue line represents the causal effect of an intervention on a single data point, showing the model's prediction after an intervention on predictor X1. The thick teal line shows the average of these individual effects (the Causal Effect Function, or CEF). The key takeaway is that the average effect masks substantial heterogeneity; the individual curves reveal both positive and negative causal relationships of varying strength, despite an overall average effect near zero. This highlights the importance of examining individual-level effects rather than relying solely on the average effect.", "section": "B.3 Individual curves showing heterogeneity"}, {"figure_path": "pU0z2sNM1M/figures/figures_19_3.jpg", "caption": "Figure 11: Regular versus CDP residuals for the example in Figure 1, plotted against feature P in the top row and F in the bottom row. Model multiplicity means two models can produce nearly the same predictions, with high accuracy, while using different functional relationships. Accuracy can only show if the model is \u201cobservationally correct,\u201d (left column) while CDPs can help determine if the model is also \u201ccausally correct\u201d (middle vs right columns).", "description": "This figure compares different ways of visualizing model residuals.  The top row shows residuals plotted against parental income (P), and the bottom row shows them plotted against school funding (F). Three visualizations are shown for each feature:\n\n1.  **Residuals (RF):** A standard residual plot from a random forest model. This shows the raw prediction errors without any causal consideration.\n2.  **TDP Residuals (RF):** A causal dependence plot (CDP) of the residuals using the Total Dependence (TDP) method. This shows the causal relationship between residuals and the feature while accounting for other factors in the model.\n3.  **TDP Residuals (Correct Model):** A CDP of the residuals using a model with the correct causal structure.  This serves as a baseline for comparison to show what the residual plot should ideally look like if the model perfectly captured the causal relationships.\n\nThe comparison highlights that simply having accurate predictions (as measured by standard residuals) isn't enough to ensure a model's explanation is causally valid.  CDPs offer a way to check if the model understands the causal relationships, going beyond just prediction accuracy.", "section": "B Experiments supplement"}]