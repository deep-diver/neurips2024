[{"figure_path": "859DtlwnAD/figures/figures_1_1.jpg", "caption": "Figure 1: Comparison of molecular encoders trained via different paradigms: train-from-scratch, pretrain-then-freeze, and pretrain-then-finetune. The evaluation is conducted across two datasets and three encoder architectures [20, 47, 66]. The results consistently demonstrate that while pretraining outperforms training from scratch, the current methods do not yet effectively facilitate finetuning.", "description": "The figure compares the performance of three different molecular encoder training methods: training from scratch, pre-training then freezing the weights, and pre-training then fine-tuning the weights.  It shows ROC-AUC scores across two datasets (Tox21 and SIDER) and three encoder architectures (GIN-Mol, CMPNN, and Graphormer). The results highlight the effectiveness of pre-training but reveal the limitations of current fine-tuning techniques, indicating that fine-tuning often results in performance inferior to simply freezing the pre-trained encoder weights.", "section": "1 Introduction"}, {"figure_path": "859DtlwnAD/figures/figures_4_1.jpg", "caption": "Figure 2: (a) The vanilla encoder-classifier framework for MPP. (b) The framework widely adopted by existing FSMPP methods, which contains a pre-trained molecular encoder and a context-aware property classifier. (c) Our proposed framework for FSMPP, in which we introduce a Pin-Tuning method to update the pre-trained molecular encoder followed by the property classifier. (d) The details of our proposed Pin-Tuning method for pre-trained molecular encoders. In (b) and (c), we use the property names like SR-HSE to denote the molecular context in episodes.", "description": "This figure illustrates the evolution of the molecular property prediction framework from vanilla MPP to the proposed FSMPP with Pin-Tuning. (a) shows the simple encoder-classifier framework. (b) highlights the existing FSMPP approach utilizing pre-trained molecular encoders and context-aware classifiers. (c) presents the proposed framework incorporating Pin-Tuning for parameter-efficient adaptation. (d) details the Pin-Tuning method applied to pre-trained molecular encoders, focusing on message passing layer and embedding layer adaptations.", "section": "3.2 Encoder-classifier framework for FSMPP"}, {"figure_path": "859DtlwnAD/figures/figures_8_1.jpg", "caption": "Figure 4: Effect of different hyper-parameters. The y-axis represents ROC-AUC scores (%) and the x-axis is the different hyper-parameters.", "description": "This figure shows the sensitivity analysis of two hyperparameters: \u03bb (lambda), the weight of the Emb-BWC regularizer, and d2, the hidden dimension of the MP-Adapter.  The plots show ROC-AUC scores on four datasets (Tox21, SIDER, MUV, PCBA) for different values of \u03bb and d2. The results demonstrate the impact of these hyperparameters on the model's performance.  Optimal values are found for both \u03bb and d2, showing the importance of tuning these parameters for optimal results.", "section": "5.4 Sensitivity analysis"}, {"figure_path": "859DtlwnAD/figures/figures_8_2.jpg", "caption": "Figure 5: ROC-AUC (%) and number of trainable parameters of Pin-Tuning with varied value of d2 and full Fine-Tuning method (e.g., GS-Meta) on the Tox21 dataset.", "description": "This figure shows the trade-off between the number of trainable parameters and the ROC-AUC score achieved by the proposed Pin-Tuning method compared to the full fine-tuning method (GS-Meta) on the Tox21 dataset.  Different values of the hyperparameter d2 (hidden dimension of the MP-Adapter) are tested, demonstrating that Pin-Tuning achieves comparable or better performance with significantly fewer trainable parameters.", "section": "5.4 Sensitivity analysis"}, {"figure_path": "859DtlwnAD/figures/figures_8_3.jpg", "caption": "Figure 2: (a) The vanilla encoder-classifier framework for MPP. (b) The framework widely adopted by existing FSMPP methods, which contains a pre-trained molecular encoder and a context-aware property classifier. (c) Our proposed framework for FSMPP, in which we introduce a Pin-Tuning method to update the pre-trained molecular encoder followed by the property classifier. (d) The details of our proposed Pin-Tuning method for pre-trained molecular encoders. In (b) and (c), we use the property names like SR-HSE to denote the molecular context in episodes.", "description": "This figure shows four different frameworks for molecular property prediction (MPP) tasks. (a) depicts the basic encoder-classifier framework. (b) shows the standard few-shot MPP framework using a pre-trained encoder and context-aware classifier. (c) illustrates the proposed framework incorporating the Pin-Tuning method. Finally, (d) provides a detailed overview of the Pin-Tuning method for adapting pre-trained molecular encoders, highlighting the modifications made to the message passing layers and embedding layers.", "section": "3.2 Encoder-classifier framework for FSMPP"}, {"figure_path": "859DtlwnAD/figures/figures_20_1.jpg", "caption": "Figure 2: (a) The vanilla encoder-classifier framework for MPP. (b) The framework widely adopted by existing FSMPP methods, which contains a pre-trained molecular encoder and a context-aware property classifier. (c) Our proposed framework for FSMPP, in which we introduce a Pin-Tuning method to update the pre-trained molecular encoder followed by the property classifier. (d) The details of our proposed Pin-Tuning method for pre-trained molecular encoders. In (b) and (c), we use the property names like SR-HSE to denote the molecular context in episodes.", "description": "This figure illustrates the evolution of molecular property prediction (MPP) frameworks from a basic encoder-classifier model to the few-shot learning (FSL) adaptation with context information and finally to the proposed Pin-Tuning method.  (a) shows the standard MPP setup. (b) introduces the use of pre-trained molecular encoders and context-aware classifiers, typical in FSMPP. (c) presents the authors' proposed approach, incorporating their Pin-Tuning method to improve upon existing FSMPP frameworks. Lastly, (d) provides a detailed diagram of their proposed Pin-Tuning technique for adapting pre-trained molecular encoders.", "section": "3.2 Encoder-classifier framework for FSMPP"}, {"figure_path": "859DtlwnAD/figures/figures_20_2.jpg", "caption": "Figure 2: (a) The vanilla encoder-classifier framework for MPP. (b) The framework widely adopted by existing FSMPP methods, which contains a pre-trained molecular encoder and a context-aware property classifier. (c) Our proposed framework for FSMPP, in which we introduce a Pin-Tuning method to update the pre-trained molecular encoder followed by the property classifier. (d) The details of our proposed Pin-Tuning method for pre-trained molecular encoders. In (b) and (c), we use the property names like SR-HSE to denote the molecular context in episodes.", "description": "This figure shows four different frameworks for molecular property prediction. (a) shows a basic encoder-classifier model. (b) shows a few-shot learning model that uses a pre-trained encoder. (c) shows the proposed Pin-Tuning model, which adds an adapter to the pre-trained encoder. (d) shows a detailed diagram of the Pin-Tuning adapter.", "section": "3.2 Encoder-classifier framework for FSMPP"}, {"figure_path": "859DtlwnAD/figures/figures_20_3.jpg", "caption": "Figure 2: (a) The vanilla encoder-classifier framework for MPP. (b) The framework widely adopted by existing FSMPP methods, which contains a pre-trained molecular encoder and a context-aware property classifier. (c) Our proposed framework for FSMPP, in which we introduce a Pin-Tuning method to update the pre-trained molecular encoder followed by the property classifier. (d) The details of our proposed Pin-Tuning method for pre-trained molecular encoders. In (b) and (c), we use the property names like SR-HSE to denote the molecular context in episodes.", "description": "This figure shows four different frameworks for molecular property prediction. (a) shows a basic encoder-classifier framework. (b) shows a framework using a pre-trained molecular encoder and a context-aware classifier, common in few-shot molecular property prediction. (c) presents the authors' proposed framework which uses Pin-Tuning to update the pre-trained encoder. (d) provides detailed information of the proposed Pin-Tuning method for pre-trained molecular encoders. ", "section": "3.2 Encoder-classifier framework for FSMPP"}, {"figure_path": "859DtlwnAD/figures/figures_20_4.jpg", "caption": "Figure 2: (a) The vanilla encoder-classifier framework for MPP. (b) The framework widely adopted by existing FSMPP methods, which contains a pre-trained molecular encoder and a context-aware property classifier. (c) Our proposed framework for FSMPP, in which we introduce a Pin-Tuning method to update the pre-trained molecular encoder followed by the property classifier. (d) The details of our proposed Pin-Tuning method for pre-trained molecular encoders. In (b) and (c), we use the property names like SR-HSE to denote the molecular context in episodes.", "description": "This figure shows four different frameworks for molecular property prediction (MPP). (a) is a basic encoder-classifier framework. (b) shows an existing framework for few-shot MPP (FSMPP) that utilizes a pre-trained molecular encoder. (c) shows the proposed FSMPP framework that incorporates a Pin-Tuning method to improve the adaptation of the pre-trained encoder. (d) provides a detailed illustration of the Pin-Tuning method applied to pre-trained molecular encoders.", "section": "3.2 Encoder-classifier framework for FSMPP"}, {"figure_path": "859DtlwnAD/figures/figures_20_5.jpg", "caption": "Figure 2: (a) The vanilla encoder-classifier framework for MPP. (b) The framework widely adopted by existing FSMPP methods, which contains a pre-trained molecular encoder and a context-aware property classifier. (c) Our proposed framework for FSMPP, in which we introduce a Pin-Tuning method to update the pre-trained molecular encoder followed by the property classifier. (d) The details of our proposed Pin-Tuning method for pre-trained molecular encoders. In (b) and (c), we use the property names like SR-HSE to denote the molecular context in episodes.", "description": "This figure shows four different frameworks for molecular property prediction. (a) shows the basic encoder-classifier framework for general molecular property prediction. (b) illustrates an existing framework for few-shot molecular property prediction (FSMPP) that incorporates a pre-trained molecular encoder to leverage pre-existing knowledge and a context-aware classifier to utilize the many-to-many relationships between molecules and properties. (c) presents the proposed FSMPP framework, named Pin-Tuning, which enhances the pre-trained encoder with a parameter-efficient in-context tuning method to prevent over-fitting and catastrophic forgetting.  Finally, (d) details the proposed Pin-Tuning method for adapting the pre-trained molecular encoder, specifically targeting the message passing and embedding layers with lightweight adapters and Bayesian weight consolidation.", "section": "3 Preliminaries"}, {"figure_path": "859DtlwnAD/figures/figures_20_6.jpg", "caption": "Figure 2: (a) The vanilla encoder-classifier framework for MPP. (b) The framework widely adopted by existing FSMPP methods, which contains a pre-trained molecular encoder and a context-aware property classifier. (c) Our proposed framework for FSMPP, in which we introduce a Pin-Tuning method to update the pre-trained molecular encoder followed by the property classifier. (d) The details of our proposed Pin-Tuning method for pre-trained molecular encoders. In (b) and (c), we use the property names like SR-HSE to denote the molecular context in episodes.", "description": "This figure shows four different frameworks for molecular property prediction (MPP). (a) shows a basic encoder-classifier framework. (b) shows a framework for few-shot molecular property prediction (FSMPP) that uses a pre-trained molecular encoder and a context-aware classifier. (c) shows the authors' proposed framework which uses Pin-Tuning to update the pre-trained molecular encoder. (d) shows a detailed diagram of the Pin-Tuning method.", "section": "3.2 Encoder-classifier framework for FSMPP"}, {"figure_path": "859DtlwnAD/figures/figures_20_7.jpg", "caption": "Figure 3: Convert the context information of a 2-shot episode into a context graph.", "description": "This figure demonstrates how context information from a 2-shot episode is converted into a context graph.  The left table shows the labels of molecules for the target property (pt) and seen properties (pseen).  The question marks (?) represent labels that are unknown and need to be predicted. This information is then transformed into a context graph (shown on the right) with molecule nodes (m) and property nodes (p), and different types of edges indicating relationships between molecules and properties.  This graph is then used as input to a GNN-based context encoder, enabling the model to perceive and utilize the context when performing few-shot predictions.", "section": "4.2 Enabling contextual perceptiveness in MP-Adapter"}, {"figure_path": "859DtlwnAD/figures/figures_20_8.jpg", "caption": "Figure 3: Convert the context information of a 2-shot episode into a context graph.", "description": "The figure illustrates how context information from a 2-shot episode is converted into a context graph.  The left side shows a table with the labels of molecules for the target property (pt) and other seen properties (pseen). The shaded values represent available context. The right side displays the resulting context graph, which contains molecule nodes and property nodes connected by various edges representing different relationships.", "section": "4.2 Enabling contextual perceptiveness in MP-Adapter"}, {"figure_path": "859DtlwnAD/figures/figures_20_9.jpg", "caption": "Figure 2: (a) The vanilla encoder-classifier framework for MPP. (b) The framework widely adopted by existing FSMPP methods, which contains a pre-trained molecular encoder and a context-aware property classifier. (c) Our proposed framework for FSMPP, in which we introduce a Pin-Tuning method to update the pre-trained molecular encoder followed by the property classifier. (d) The details of our proposed Pin-Tuning method for pre-trained molecular encoders. In (b) and (c), we use the property names like SR-HSE to denote the molecular context in episodes.", "description": "This figure illustrates the different frameworks used for molecular property prediction (MPP) and few-shot molecular property prediction (FSMPP). (a) shows the basic encoder-classifier framework. (b) shows the framework commonly used in FSMPP which uses a pre-trained molecular encoder and a context-aware classifier. (c) presents the proposed framework, which incorporates the Pin-Tuning method to improve the pre-trained encoder. (d) details the Pin-Tuning method's application to pre-trained molecular encoders.  The figure highlights the evolution of the framework from vanilla MPP to the proposed FSMPP method.", "section": "3.2 Encoder-classifier framework for FSMPP"}, {"figure_path": "859DtlwnAD/figures/figures_20_10.jpg", "caption": "Figure 2: (a) The vanilla encoder-classifier framework for MPP. (b) The framework widely adopted by existing FSMPP methods, which contains a pre-trained molecular encoder and a context-aware property classifier. (c) Our proposed framework for FSMPP, in which we introduce a Pin-Tuning method to update the pre-trained molecular encoder followed by the property classifier. (d) The details of our proposed Pin-Tuning method for pre-trained molecular encoders. In (b) and (c), we use the property names like SR-HSE to denote the molecular context in episodes.", "description": "This figure shows four different frameworks for molecular property prediction (MPP) tasks. (a) shows a simple encoder-classifier framework. (b) shows a common framework for few-shot MPP (FSMPP) which uses a pre-trained molecular encoder and a context-aware classifier. (c) shows the proposed framework which uses a Pin-Tuning method for updating pre-trained encoders. (d) illustrates the details of the Pin-Tuning method. This method is designed to address the limitations of existing FSMPP methods by improving the parameter efficiency and incorporating contextual information.", "section": "3.2 Encoder-classifier framework for FSMPP"}, {"figure_path": "859DtlwnAD/figures/figures_20_11.jpg", "caption": "Figure 3: Convert the context information of a 2-shot episode into a context graph.", "description": "This figure demonstrates how context information is converted into a context graph. The left table shows the labels for two molecules (m1, m2) for a target property (pt). Other shaded values represent the labels of query molecules for other properties. This information is converted into a context graph (Gt = (Vt, At, Xt)) with M molecule nodes and P property nodes. Three types of edges represent the relationship between the nodes.", "section": "4.2 Enabling contextual perceptiveness in MP-Adapter"}]