[{"type": "text", "text": "Clustering in Causal Attention Masking ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Nikita Karagodin\u2217 Yury Polyanskiy\u2020 Philippe Rigollet\u2021 ", "page_idx": 0}, {"type": "text", "text": "Abstract ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "This work presents a modification of the self-attention dynamics proposed by Geshkovski et al. (2023b) to better reflect the practically relevant, causally masked attention used in transformer architectures for generative AI. This modification translates into an interacting particle system that cannot be interpreted as a mean-field gradient flow. Despite this loss of structure, we significantly strengthen the results of Geshkovski et al. (2023b) in this context: While previous rigorous results focused on cases where all three matrices (Key, Query, and Value) were scaled identities, we prove asymptotic convergence to a single cluster for arbitrary key-query matrices and a value matrix equal to the identity. Additionally, we establish a connection to the classical R\u00e9nyi parking problem from combinatorial geometry to make initial theoretical steps towards demonstrating the existence of meta-stable states. ", "page_idx": 0}, {"type": "text", "text": "1 Introduction ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "The introduction of the Transformer architecture Vaswani et al. (2017) has markedly impacted the landscape of natural language processing (NLP), signaling the advent of large language models. Central to the Transformer architecture is the self-attention mechanism, a special kind of layer that distinguishes it from preceding models such as ResNets. This innovation has yielded unprecedented performance not only in machine translation and text summarization but also in areas beyond NLP, including computer vision, speech recognition, and robotics. The flexibility and efficiency of Transformers underscore their integral role in the progression of artificial intelligence. Despite their widespread use, the theoretical foundations underlying their success remain underexplored. ", "page_idx": 0}, {"type": "text", "text": "Following Sander et al. (2022), recent studies by Geshkovski et al. (2023a) and Geshkovski et al. (2023b) have proposed a mathematical framework to analyze Transformers as interacting particle systems, demonstrating that tokens, when modeled as particles, exhibit clustering under certain conditions on the Key, Query, and Value matrices. These works primarily focus on full (mean-field) attention mechanisms, where each token can interact with every other token. Building upon this foundation, our research extends the analysis to causal attention mechanisms, wherein each token is restricted to interact only with preceding tokens. This distinction is crucial, as causal attention is prevalent in Transformer models employed in generative AI and known as decoder architectures. ", "page_idx": 0}, {"type": "text", "text": "Causal attention is crucial for sequence generation tasks, ensuring that each token only attends to previous tokens and not future ones, thereby preserving the correct temporal order. This mechanism, also known as autoregressive attention, masks future tokens during attention computation to prevent the model from accessing information it hasn\u2019t generated yet. At inference time, causal attention allows the model to generate text one token at a time, using previously generated tokens to inform the next, ensuring coherent and contextually accurate sequences. This step-by-step generation process is computationally efficient, as each token is produced in a forward pass without needing to revisit previous steps. In contrast to full attention, which considers all tokens simultaneously and is suitable for tasks like machine translation where the entire sequence is known, causal attention is essential for tasks requiring real-time, sequential output. This computational advantage explains the pervasiveness of causal attention not only in natural language processing but also in image generation with tools like DALL-E (Ramesh et al., 2021), VQGAN (Esser et al., 2021), or Parti (Yu et al., 2022) and multimodal foundation models, notably Chameleon (Team, 2024). More generally, the use of masked attention where tokens pay attention to a subset of other tokens has been driving recent scaling efforts and has led to state-of-the-art models such as MUSE (Chang et al., 2023) or Alphafold 3 (Abramson et al., 2024). Causal attention can also be recast as an interacting particle system but it requires different analytical techniques. This is the goal of our paper. ", "page_idx": 0}, {"type": "table", "img_path": "OiVxYf9trg/tmp/58dcc206313b0c75dcf63fa9b23e76f35b64d281fe32247bfafa269569fa7a60.jpg", "table_caption": ["Table 1: Possible Final Configurations of Particles "], "table_footnote": [], "page_idx": 1}, {"type": "text", "text": "", "page_idx": 1}, {"type": "text", "text": "Our contributions. Our main theoretical result establishes asymptotic clustering of tokens for causal self-attention transformer modeled as an interacting particles system on the sphere (Theorem 4.1). While mathematically accurate, this asymptotic collapse to a single cluster is seldom observed numerically. Instead, particles collapse to multiple clusters and stay in this configuration for a very long time (see Fig. 2 for a representative example) \u2014 such meta-stable states were already alluded to in Geshkovski et al. (2023b) and their study was recently initiated in Koubbi et al. (2024). In Section 5 we describe such meta-stable states using analogy with the R\u00e9nyi parking process (Lemma 2, Theorem 5.1). Additionally, Theorem 5.1 covers asymptotic clustering of tokens for causal self-attention with additional cross-attention component. Moreover, we predict that, akin to linear dynamical systems, the most important factors that qualitatively describe final particles configuration both in causal and full-attention cases are the eigenvalue of the Value matrix $V$ with the largest real part $\\lambda_{\\mathrm{max}}$ and its eigenspace $L$ , while Query and Key matrices $Q,K$ and temperature parameter $\\beta$ do not matter. Our conjectured atlas of possible meta-stable configurations is listed in Table 1. We prove the result stated as the first line of this table, namely that particles eventually collapse into a point when $V=I_{d}$ in Theorem 4.1. We remark that assumptions of Theorem 4.1 are much weaker than for the similar results in the full-attention case Geshkovski et al. (2023b), in particular we put no constraints on $K,Q$ or $\\beta$ . This work is a combination of rigorous mathematical results and non-trivial predictions based on analytical insights and numerical simulations. We summarize all limitations in Section 6. ", "page_idx": 1}, {"type": "text", "text": "Related work. Our work builds upon the framework of Geshkovski et al. (2023b,a) where clustering properties of transformers are analyzed as systems of particles interacting on the sphere. Specifically, Geshkovski et al. (2023b) proved that encoder-only (i.e. unmasked) self-attention with (post) LayerNorm leads to tokens clustering to a single point, in the limit of number of layers going to infinity. This phenomenon is also known as consensus in the related literature of multi-agent systems Markdahl et al. (2017); Criscitiello et al. (2024) and Kuramoto oscillators Strogatz (2000); Abdalla et al. (2022). Work Geshkovski et al. (2023b) in turn expands on the original perspective brought forward by Sander et al. (2022) that identify the self-attention layer as a measure-to-measure map, see also Vuckovic et al. (2021). More recently, Castin et al. (2024) studied the smoothness of this map in a framework that also covers causal attention. This work introduces a clever reparametrization that allows them to recast causal attention as mean-field dynamics, akin to their full attention counterpart. Using various approximations, Cowsik et al. (2024) were able to study a more realistic architecture that also includes MLP layers and produce accurate predictions for the final configuration of particles. This setup was further investigated by Agrachev and Letrouit (2024) from a geometric control perspective. We note also that clustering in the absence of a residual connection (replace ${\\dot{x}}_{k}(t)$ with $x_{k}(t+1)$ in (SA)) was established in Wu et al. (2023). Additional effects of the residual connection are studied in Dong et al. (2021) and Zhang et al. (2024). ", "page_idx": 1}, {"type": "image", "img_path": "OiVxYf9trg/tmp/64811fdf3c2a6814ee4ba2441a52c5c27c8b8484b8ada0ab4df75271b8a6b7ad.jpg", "img_caption": ["Figure 1: Particle trajectories for different Value matrices. In all cases we take simple Query and Key matrices $K=Q=I_{d}$ , temperature $\\beta=9$ and final time $T=5000$ for $n=32$ particles initialized uniformly at random on the sphere. Positions of particles at time $T$ are indicated by a red dot. "], "img_footnote": [], "page_idx": 2}, {"type": "text", "text": "2 Causal attention ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "Before describing our model of causal attention dynamics, we review the idea of Geshkovski et al. (2023b) for modeling the full attention dynamics. In that work, the evolution of representations of tokens through the layers is modeled as a system of $n$ coupled Ordinary Differential Equations (ODEs) describing dynamics of a system of particles $x_{1}(t),\\ldots,x_{n}(t)$ . A brief part of their derivation of the dynamics from the transformers architecture is written in Section A.1. The particle position $x_{k}(t)$ corresponds to representation of the $k$ -th token at layer $t$ (where for convenience, $t$ is allowed to take non-integer values) and due to RMSNorm the particles are forced to live on a unit sphere $\\mathbb{S}^{d-1}$ . (RMSNorm layer usually also includes a multiplication by a trainable diagonal matrix $D$ , but the effect of this step can be equivalently achieved by multiplying $K,Q,V$ matrices by $D$ .) These ODEs are parametrized by three matrices, known as the query $Q$ , the key $K$ and the value $V$ , respectively, and that are assumed to be square $d\\times d$ matrices. More specifically, token $k$ evolves according to ", "page_idx": 2}, {"type": "equation", "text": "$$\n\\dot{x}_{k}(t)=\\mathbf{P}_{x_{k}(t)}\\Big(\\frac{1}{Z_{k}(t)}\\sum_{j=1}^{n}e^{\\beta\\langle Q x_{k}(t),K x_{j}(t)\\rangle}V x_{j}(t)\\Big),\n$$", "text_format": "latex", "page_idx": 2}, {"type": "text", "text": "$\\begin{array}{r}{\\mathbf{P}_{x}y=y-\\frac{\\langle x,y\\rangle x}{|x|^{2}}}\\end{array}$ is the projection onto the tangent space of $\\mathbb{S}^{d-1}$ at $x$ , and ", "page_idx": 2}, {"type": "equation", "text": "$$\nZ_{k}(t)=\\sum_{j=1}^{n}e^{\\beta\\langle Q x_{k}(t),K x_{j}(t)\\rangle}\n$$", "text_format": "latex", "page_idx": 2}, {"type": "text", "text": "is a normalizing factor. Note that the dynamics of the $k$ -th token depend on the positions of all tokens $j\\in[n]$ , which is a landmark characteristic of full attention leading to the so-called mean-field dynamics studied in Geshkovski et al. (2023b); see also Geshkovski et al. (2023a); Castin et al. (2024); Paul and Tr\u00e9lat (2024). ", "page_idx": 2}, {"type": "text", "text": "In this work we focus on causal attention, where the dynamics of token $k$ depend only on the position of tokens $j\\leq k$ . As described in the introduction, this modification is by now the dominant type of transformer architecture in generative AI. To reflect causal masking, we modify the ODE governing the dynamics of token $k$ as follows: ", "page_idx": 2}, {"type": "equation", "text": "$$\n\\dot{x}_{k}(t)=\\mathbf{P}_{x_{k}(t)}\\Big(\\frac{1}{Z_{k}(t)}\\sum_{j=1}^{k}{e^{\\beta\\langle Q x_{k}(t),K x_{j}(t)\\rangle}V{x}_{j}(t)}\\Big),\n$$", "text_format": "latex", "page_idx": 2}, {"type": "text", "text": "where the normalizing factor $Z_{k}(t)$ is naturally updated to ", "page_idx": 3}, {"type": "equation", "text": "$$\nZ_{k}(t)=\\sum_{j=1}^{k}e^{\\beta\\left\\langle Q x_{k}(t),K x_{j}(t)\\right\\rangle}.\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "3 Single token dynamics ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "Note that in (CSA) dynamics, the first token is evolving fully autonomously without the influence of others. Thus, we start from the description of its evolution. It will also guide our understanding of the dynamics of subsequent tokens. The first token moves according to the equation ", "page_idx": 3}, {"type": "equation", "text": "$$\n{\\dot{x}}(t)=\\mathbf{P}_{x(t)}(V x(t)).\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "To state its behavior for any matrix $V$ , we need a few definitions. Denote $\\lambda_{\\mathrm{max}}$ as the largest real part of all the eigenvalues of $V$ . Let $L^{\\prime}$ be the span of all generalized eigenvectors of $V$ associated to eigenvalues(potentially different) with their real part equal to $\\lambda_{\\mathrm{max}}$ . Let $L\\subset L^{\\prime}$ be the subspace generated by only the eigenvectors in $L^{\\prime}$ with the largest corresponding Jordan block (the vectors might correspond to different blocks and even to different eigenvalues). ", "page_idx": 3}, {"type": "text", "text": "Lemma 1. Let $x(t)$ be a solution of an ODE ${\\dot{x}}(t)=\\mathbf{P}_{x(t)}(V x(t))$ defined on the unit sphere $\\mathbb{S}^{d-1}$ . Then, for almost every initial value $x(0)\\,\\in\\,\\mathbb{S}^{d-1}$ , there exists $C,c>0$ such that the following convergence rates for the geodesic distance dist hold: ", "page_idx": 3}, {"type": "text", "text": "(ii) linear convergence to $[:d i s t(x(t),L\\cap\\mathbb{S}^{d-1})\\leq c t^{-1}$ ", "page_idx": 3}, {"type": "text", "text": "This result can be derived from standard results on the theory of linear ODEs (proof in Section B.1). We note that this result is important for other tokens as well. Indeed, for every token $x_{k}$ , the contribution to $\\dot{x}_{k}$ in (CSA) from the term with $j~=~k$ often has the biggest weight, an effect amplified by large $\\beta$ . ", "page_idx": 3}, {"type": "text", "text": "In general, eigenvectors corresponding to a real eigenvalue $\\lambda=\\lambda_{\\operatorname*{max}}$ create a fixed set in $L\\cap\\mathbb{S}^{d-1}$ , while the complex eigenvalues with the largest real part produce a limit torus in $L\\cap\\mathbb{S}^{d-1}$ . In what follows, we only consider the case where the eigenvalue with the largest real part is real itself and it only has Jordan blocks of size 1. Then, $L=L^{\\prime}$ and convergence to $L$ is exponentially fast. Note also that when $\\dim I=1$ , we have $L\\cap\\mathbb{S}^{1}=\\{\\pm\\xi\\}$ for some unit vector $\\xi$ . In this case, $x(t)\\rightarrow\\pm\\xi$ as $t\\to\\infty$ , again with exponential speed. These observations will be important for the next section, when we describe asymptotic configurations of tokens. ", "page_idx": 3}, {"type": "text", "text": "4 Final Configuration ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "The system of $n$ tokens that we are studying is far more complicated than for a single token. Even establishing convergence to some point as $t\\,\\rightarrow\\,\\infty$ is challenging. In Geshkovski et al. (2023b), similar models were analyzed analytically by noticing that the dynamical system has the structure of the gradient flow of some potential function: ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\dot{\\boldsymbol{x}}(t)=\\boldsymbol{\\nabla}H(\\boldsymbol{x})\\,.\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "For such systems, groundbreaking results of \u0141ojasiewicz (1962, 1965, 1984) (see Haraux (2012) for a self-contained overview) guarantee convergence to a critical point of $H$ assuming it is real-analytic. ", "page_idx": 3}, {"type": "text", "text": "However, our system (CSA) does not have a gradient-flow structure and thus techniques of \u0141ojasiewicz are not applicable. On the other hand, we have a significant advantage in the hierarchical structure of our system, allowing us to study tokens sequentially. ", "page_idx": 3}, {"type": "text", "text": "We have already understood the evolution of the first token. In this section, we do two things. First, we describe, based on our analytical and numerical insights, conjectures about the asymptotic configuration $x(t)$ for $t\\to\\infty$ . The surprising result here is that only the spectral properties of $V$ (and not $K$ or $Q$ ) affect asymptotics. Second, we rigorously prove convergence to a single point for the special case of $V=I_{d}$ . We note that unlike the proof in Geshkovski et al. (2023b) (see also Markdahl et al. (2017); Criscitiello et al. (2024)), our result works for all $K$ and $Q$ matrices, while the proof in Geshkovski et al. (2023b) works only for $Q^{\\top}K=V$ and Markdahl et al. (2017); Criscitiello et al. (2024) is restricted to $Q^{\\top}\\bar{K}=I_{d}$ . ", "page_idx": 3}, {"type": "text", "text": "", "page_idx": 4}, {"type": "text", "text": "Our main insight is that there are two major forces that drive each token: its internal force which is described by Lemma 1, and the external force induced by all the particles preceding it, which is either attractive or repulsive depending on the sign of the top eigenvalue(s) of $V$ . The balance between the two forces is defined via attention. ", "page_idx": 4}, {"type": "text", "text": "To get a better grasp of how the external force works, we consider the case where the first (internal) force vanishes, that is, $V=I_{d}$ . In this case, the tokens collapse asymptotically to a single point. ", "page_idx": 4}, {"type": "text", "text": "Theorem 4.1. Let $V\\,=\\,I_{d}$ and $Q,K$ be arbitrary matrices. Then, for almost any starting point $(x_{1}(0),\\ldots,x_{n}(0))$ with respect to the volume measure on $(\\mathbb{S}^{d-1})^{n}$ , the causal transformer dynamics (CSA) converge to a single cluster: ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\forall\\,k\\in[n],\\,\\operatorname*{lim}_{t\\to\\infty}x_{k}(t)=x_{1}(0).\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "We prove this result in Section B.2. In the proof, weight functions are only required to be positive and continuously differentiable $(C^{1})$ . This ambiguity suggests that incorporating time-dependence of $Q$ and $K$ might not alter the theorem\u2019s validity, but it significantly adds complexity to the proof in dealing with non-autonomous systems. ", "page_idx": 4}, {"type": "text", "text": "Steps similar to our proof of Theorem 4.1 can be followed to study the more general case of the matrix $V\\neq I_{d}$ . Unfortunately, one runs into multiple technical issues with application of the stable-manifold theorem from dynamical systems due to the emergence of critical manifolds (as opposed to critical points in the $V=I_{d},$ ) case. Thus, we leave the general case at the status of conjectures, which we describe next. ", "page_idx": 4}, {"type": "text", "text": "In what follows, we denote the eigenvalue of $V$ with the largest real part as $\\lambda_{\\mathrm{max}}$ and assume that it is real. If it is not, the limiting configuration is additionally rotating with a constant speed, which complicates the discussion and so is omitted. ", "page_idx": 4}, {"type": "text", "text": "Let $L$ denote the eigenspace of $\\lambda_{\\mathrm{max}}$ . If $\\lambda_{\\mathrm{max}}$ has multiplicity 1, then we denote the corresponding unit eigenvectors as $\\pm\\xi$ . For simplicity we assume that $\\lambda_{\\mathrm{max}}$ has all of the corresponding Jordan blocks of size 1. ", "page_idx": 4}, {"type": "text", "text": "First of all, if $\\dim I=1$ then, according to Lemma 1, every token is driven towards $\\xi$ or $-\\xi$ by their own force. Moreover, for $\\lambda_{\\operatorname*{max}}>0$ the force of other tokens is attractive, while for $\\lambda_{\\operatorname*{max}}<0$ it is repulsive. ", "page_idx": 4}, {"type": "text", "text": "Thus, for $\\lambda_{\\operatorname*{max}}>0$ all the particles collapse into $\\xi$ and $-\\xi$ , whereas for $\\lambda_{\\operatorname*{max}}<0$ the repulsion force prevents the particles from going all the way to $\\pm\\xi$ and instead the particles stabilize at two clouds around $\\xi$ and $-\\xi$ . This behavior is captured in Figures 1c and $1\\mathrm{e}^{4}$ . For the case $\\lambda_{\\operatorname*{max}}>0$ we formally express it as: ", "page_idx": 4}, {"type": "text", "text": "Conjecture 1. Let $Q,K$ be arbitrary matrices and $V$ be diagonalizable with d different positive real eigenvalues. Denote the largest eigenvalue as $\\lambda_{\\mathrm{max}}$ and unit vector $\\xi:V\\xi=\\lambda_{\\mathrm{max}}\\xi$ . Then, for almost any starting point $(x_{1}(0),\\ldots,x_{n}(0))$ with respect to the volume measure on $(\\mathring{\\mathbb{S}}^{d-1})^{n}$ , the causal transformer dynamics (CSA) converge to two clusters ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\forall\\,k\\in[n],\\,\\operatorname*{lim}_{t\\rightarrow\\infty}x_{k}(t)\\in\\{\\xi,-\\xi\\}.\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "If $\\lambda_{\\mathrm{max}}$ has multiplicity at least 2, then from Lemma 1 each token internally gets attracted by the eigenspace $L$ . When tokens are close to $L$ , the action of $V$ becomes close to $\\lambda_{\\mathrm{max}}I_{d}$ , which for $\\lambda_{\\operatorname*{max}}>0$ according to Theorem 4.1 forces tokens to collapse to a singleton, while for $\\lambda_{\\operatorname*{max}}<0$ other tokens exude a repelling force, causing particles to spread out around $L$ . This behavior is captured in Figures 1b and 1d. For the case $\\lambda_{\\operatorname*{max}}>0$ we formalize it as follows: ", "page_idx": 4}, {"type": "text", "text": "Conjecture 2. Let $Q,K$ be arbitrary matrices and $V$ be any matrix such that its largest eigenvalue $\\lambda_{\\operatorname*{max}}>0$ is real and has an eigenspace $L$ of dimension $\\dim L\\geq2$ , while for any $z\\in\\bar{L}^{\\perp}$ one has $V z\\in L^{\\perp}$ with $\\langle V z,z\\rangle<\\lambda_{\\mathrm{max}}|z|^{2}$ . Then, for almost any initialization $(x_{1}(0),\\ldots,x_{n}(0))$ , the causal attention dynamics (CSA) converge to one cluster. More specifically, if we define $\\xi$ as the normalized $L$ -component of $x_{1}(0)$ , i.e., for $y_{1}:=\\mathbf{P}_{L^{\\perp}}(x_{1}(0)),\\,\\xi:=y_{1}/|y_{1}|$ , then ", "page_idx": 4}, {"type": "image", "img_path": "OiVxYf9trg/tmp/7ed85d459faf40a48fea3b3b3f8c61b1a49b1d78c46b695d0543eb8ad8241446.jpg", "img_caption": ["Figure 2: Evolution of the system (CSA) with $K=Q=V=I_{2}$ with $n=200$ , $d=2$ , $\\beta=64$ , strong R\u00e9nyi centers (red) and R\u00e9nyi centers (black) with $\\delta=4\\beta^{-1/2}$ . Note that strong R\u00e9nyi centers are visually stationary (as per Lemma 2) but do not explain all clusters. In turn, R\u00e9nyi centers are moving and merging (one disappears between $t=75$ and $t=150$ ), but capture more meta-stable clusters. "], "img_footnote": [], "page_idx": 5}, {"type": "text", "text": "", "page_idx": 5}, {"type": "equation", "text": "$$\n\\forall\\,k\\in[n],\\,\\operatorname*{lim}_{t\\to\\infty}x_{k}(t)=\\xi.\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "(Note that $\\xi$ is undefined when $x_{1}(0)\\perp L$ , but this happens with probability zero.) ", "page_idx": 5}, {"type": "text", "text": "An important practical observation is that these conjectures explain that $V$ performs dimensionality reduction in the following way. Tokens converge to $L\\cap\\mathbb{S}^{d-\\tilde{1}}$ and, in that space, they move as if acted upon by the $\\lambda I_{d}$ matrix on a sphere $\\mathbb{S}^{\\mathrm{dim}\\,L^{=1}}$ . For the pre-trained Lan et al. (2020) the spectra of value matrices is depicted in Figure 4. Interestingly, there are heads with negative $\\lambda_{\\mathrm{max}}$ . Future work will be concerned with studying real-world matrices $V$ and connecting their top eigenspaces to semantic meaning of layers and tokens. ", "page_idx": 5}, {"type": "text", "text": "5 Meta-stable clustering ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "As we discussed earlier, perhaps the most fascinating discovery of Geshkovski et al. (2023b) is the existence of meta-stable clusters in the full-attention dynamics. It turns out that the same phenomenon persists in the causal-attention dynamics that we study here. ", "page_idx": 5}, {"type": "text", "text": "The dynamical evolution of the system is illustrated in Fig. 2. At $t\\,=\\,150$ , the initially uniform distribution of 200 particles consolidates into seven distinct clusters. While Theorem 4.1 establishes the eventual collapse into a single cluster, these intermediate clusters exhibit remarkable metastability, persisting with negligible movement over extended time periods\u2014at least until $t=500$ according to Fig. 2\u2014before sequential merging occurs. We define these meta-stable configurations as meta-stable clusters, with three-dimensional analogues shown in Fig. 1a and 1b. ", "page_idx": 5}, {"type": "text", "text": "Given that the time parameter in our dynamics corresponds to network depth in transfo\u221armer architectures, the meta-stable configurations, rather than final states (achieved at $t=\\exp(\\Omega(\\sqrt{\\beta})))$ , hold greater practical significance. The emergence of meta-stable clustering and its associated dimensionality reduction may provide fundamental insights into transformers\u2019 capacity for generating efficient context-dependent representations. ", "page_idx": 5}, {"type": "text", "text": "From a theoretical perspective, understanding meta-stable clustering presents significant challenges, as traditional techniques for asymptotic analysis\u2014such as those used in our Theorem 4.1\u2014prove insufficient. Recent work on full attention transformers has made partial progress in this direction. Koubbi et al. (2024) demonstrated that when self-attention dynamics approach a nearly clustered state, they will converge to a tightly clustered configuration and remain stable for an exponential time period. Complementing this, Bruno et al. (2024) proved that tokens initialized near a uniform distribution on the sphere will spontaneously organize into a loosely clustered state. However, the bounds on the clustering tightness in this second line of work are not sufficient to trigger the convergence conditions required by Koubbi et al. (2024)\u2019s theorem. ", "page_idx": 6}, {"type": "text", "text": "This Section presents a fundamental discovery regarding the identification of cluster centers in causal-attention dynamics. We establish three key claims: First, we demonstrate that initialization irregularities generate distinctive tokens, termed R\u00e9nyi parking centers, which evolve into meta-stable cluster nuclei. While this phenomenon is primarily supported by numerical evidence (Fig. 3), it provides crucial insight into the clustering mechanism. Second, we prove that a subset of these special tokens, called strong R\u00e9nyi centers, maintains near-stationarity over extended time periods (Lemma 2). Both R\u00e9nyi and strong R\u00e9nyi centers occur with frequency $\\Theta(\\beta^{\\frac{d-1}{2}})$ , confirming the $\\sqrt{\\beta}$ scaling predicted for $d=2$ by Geshkovski et al. (2023b); see also Koubbi et al. (2024); Bruno et al. (2024). Third, we establish in Theorem 5.1 that as $t\\to\\infty$ , all remaining tokens will converge to the vicinity of one of these stationary tokens, completing the meta-stable clustering process. ", "page_idx": 6}, {"type": "text", "text": "This section restricts our analysis to the case where $V=I_{d}$ . For general matrices $V$ , our empirical observations suggest that particles rapidly converge to a lower-dimensional subspace spanned by $d_{1}\\ll d$ principal eigenvectors. Consequently, we conjecture that the number of meta-stable clusters should rather be $\\beta^{\\frac{d_{1}-1}{2}}$ , where the ambient dimension $d$ is replaced by the effective dimension $d_{1}$ . While a rigorous proof of this dimension-reduction remains an open problem for future investigation, this phenomenon motivates our focus on low-dimensional cases (specifically $d=2$ ) throughout this section. ", "page_idx": 6}, {"type": "text", "text": "For convenience, we also fix $Q=K=I_{d}$ , though this condition could be easily relaxed (e.g. to $Q^{\\top}K=K^{\\top}Q=V)$ . Under these assumptions, the system can be rewritten in polar coordinates $x_{k}=[\\cos(\\varphi_{k}),\\sin(\\varphi_{k})]^{\\top}$ as ", "page_idx": 6}, {"type": "equation", "text": "$$\n\\dot{\\varphi}_{k}=\\frac{1}{Z_{k}}\\sum_{j=1}^{k}e^{\\beta(\\cos(\\varphi_{k}-\\varphi_{j})-1)}\\sin(\\varphi_{j}-\\varphi_{k})=\\frac{1}{Z_{k}}\\sum_{j=1}^{k-1}h(\\varphi_{j}-\\varphi_{k}),\n$$", "text_format": "latex", "page_idx": 6}, {"type": "text", "text": "with interaction potential given by ", "page_idx": 6}, {"type": "equation", "text": "$$\nh(x):=e^{\\beta(\\cos(x)-1)}\\sin x,\\quad{\\mathrm{and}}\\quad Z_{k}=\\sum_{j=1}^{k}e^{\\beta(\\cos(\\varphi_{k}-\\varphi_{j})-1)}.\n$$", "text_format": "latex", "page_idx": 6}, {"type": "text", "text": "5.1 R\u00e9nyi Parking ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "The prediction of meta-stable clustering center locations exhibits a notable connection to the R\u00e9nyi parking problem. ", "page_idx": 6}, {"type": "text", "text": "Consider a sequence of tokens $(x_{j})_{j\\geq1}$ on the sphere $\\mathbb{S}^{d-1}$ equipped with geodesic distance dist. For a fixed separation parameter $\\delta>0$ , we define: ", "page_idx": 6}, {"type": "text", "text": "\u2022 R\u00e9nyi centers as the subsequence $(x_{s_{j}})_{j\\geq1}$ , where $(s_{j})_{j\\geq1}$ is strictly increasing and satisfies: ", "page_idx": 6}, {"type": "equation", "text": "$$\n\\mathsf{d i s t}(x_{s_{j}},x_{s_{i}})>\\delta\\quad\\mathrm{for\\,all}\\;i<j\n$$", "text_format": "latex", "page_idx": 6}, {"type": "text", "text": "\u2022 Strong R\u00e9nyi centers as the subsequence $(x_{s_{j}})_{j\\geq1}$ satisfying: ", "page_idx": 6}, {"type": "equation", "text": "$$\n{\\mathsf{d i s t}}(x_{s_{j}},x_{i})>\\delta\\quad{\\mathrm{for~all~}}i<s_{j}\n$$", "text_format": "latex", "page_idx": 6}, {"type": "text", "text": "By construction, the set of Strong R\u00e9nyi centers forms a subset of R\u00e9nyi centers. ", "page_idx": 6}, {"type": "text", "text": "As demonstrated in Section A.2, particles in our system exert maximal attractive force at distances of order at most $\\beta^{-1/2}$ , with rapid decay beyond this scale. For strong R\u00e9nyi centers defined with separation parameter $\\delta=c\\beta^{-1/2}$ (where $c$ is sufficiently large), this decay ensures negligible influence from preceding particles and thus remain stable for a long time\u2014a phenomenon formally established in Lemma 2. This metastability, coupled with rapid particle aggregation tokens, indicates that strong R\u00e9nyi centers serve as primary attractors for subsequent tokens. ", "page_idx": 6}, {"type": "image", "img_path": "OiVxYf9trg/tmp/cf27b26ec2612e7bb6550cba2636005f6122ba1fd4c75f9b00256eef5db3edef.jpg", "img_caption": ["Figure 3: Total percentage of particles consumed by R\u00e9nyi and strong R\u00e9nyi centers over time. Here we have plotted average, 0.1 and 0.9 quantiles over 5000 experiments with $n=200$ , $d=2$ , $\\beta=64$ , $\\delta=4\\beta^{-\\bar{1}/2}$ . "], "img_footnote": [], "page_idx": 7}, {"type": "text", "text": "", "page_idx": 7}, {"type": "text", "text": "R\u00e9nyi centers are unaffected by previous particles but only by previous R\u00e9nyi centers, thereby generating new clustering centers. For fixed $\\delta$ , there are more R\u00e9nyi centers than strong R\u00e9nyi centers (see Section C.4 for exact cardinality analysis). While R\u00e9nyi centers better capture the meta-stable clustering effect, as illustrated in Figures 3 and 2, they lack positional stability and may converge to other centers over time. Although R\u00e9nyi centers rapidly aggregate a large fraction of particles, some of these particles continue to migrate and eventually converge to strong R\u00e9nyi centers. ", "page_idx": 7}, {"type": "text", "text": "The next result shows that strong R\u00e9nyi centers remain nearly fixed for a long time. ", "page_idx": 7}, {"type": "text", "text": "Lemma 2. Let $d=2$ and $Q=K=V=I_{2}$ . Consider a subsequence of strong R\u00e9nyi centers $x_{s_{1}},\\ldots,x_{s_{m}}$ satisfying the separation condition with constants $\\varepsilon,c>0$ ", "page_idx": 7}, {"type": "equation", "text": "$$\n\\operatorname*{min}_{i<s_{j}}|x_{s_{j}}-x_{i}|>c(1+2\\varepsilon)\\beta^{-1/2}.\n$$", "text_format": "latex", "page_idx": 7}, {"type": "text", "text": "Assume that ", "page_idx": 7}, {"type": "equation", "text": "$$\nc>\\beta^{1/2}\\operatorname{arccos}((-1+\\sqrt{4\\beta^{2}+1})/(2\\beta)).\n$$", "text_format": "latex", "page_idx": 7}, {"type": "text", "text": "Then for any time $T_{j}$ such that ", "page_idx": 7}, {"type": "equation", "text": "$$\nT_{j}s_{j}h(c\\beta^{-1/2})<\\varepsilon c\\beta^{-1/2},\n$$", "text_format": "latex", "page_idx": 7}, {"type": "text", "text": "where the interaction potential $h$ is defined in (IntPot), the displacement of each center is bounded by ", "page_idx": 7}, {"type": "equation", "text": "$$\n\\operatorname*{max}_{t\\in[0,T_{j}]}|x_{s_{j}}(t)-x_{s_{j}}(0)|<\\varepsilon c\\beta^{-1/2}.\n$$", "text_format": "latex", "page_idx": 7}, {"type": "text", "text": "The key observation driving this result is that strong R\u00e9nyi centers are weakly affected by all previous particles. However, though this is correct on short time scales, it should be checked for all times in $[0,T]$ . A complete proof can be found in Section C.1. ", "page_idx": 7}, {"type": "text", "text": "Remark 1. Using the properties of h derived in Section A.2 it can be shown that ", "page_idx": 7}, {"type": "text", "text": "\u2022 For $\\beta>1$ a sufficient condition for (1) to hold is simply $c>1$ , ", "page_idx": 7}, {"type": "text", "text": "\u2022 a sufficient condition for (2) to hold is ", "page_idx": 7}, {"type": "equation", "text": "$$\nT_{j}s_{j}<e^{c^{2}/2-c^{4}/(24\\beta)}\\varepsilon.\n$$", "text_format": "latex", "page_idx": 7}, {"type": "text", "text": "Moreover, it is easy to prove that indexes $s_{j}$ are mostly small. Thus, we see that early strong R\u00e9nyi centers are almost stationary for a time that is exponential with the square of separation magnitude. ", "page_idx": 7}, {"type": "text", "text": "R\u00e9nyi centers and strong R\u00e9nyi centers play a fundamental role in meta-stable clustering, warranting analysis of their properties as extreme points in a sequence. While defined here using geodesic distance on a sphere, the definition extends naturally to distances induced by $\\langle Q x,K y\\rangle$ under appropriate conditions. This generalization aligns with our observation that meta-stable clustering occurs in the subspace $L$ where $V$ sends tokens and acts as the identity on $L$ . ", "page_idx": 8}, {"type": "text", "text": "The distribution of these centers under various initialization schemes presents a key analytical challenge. Section C.4 addresses the uniform i.i.d. case, where R\u00e9nyi\u2019s classical result characterizes the expected number of centers. Extensions to general distributions and Markov processes\u2014more relevant to language processing applications\u2014remain open for R\u00e9nyi centers due to their structural complexity, particularly in higher dimensions $(d>2)$ ). In contrast, strong R\u00e9nyi centers are much easier to handle: even our computation of the average number of centers in Section C.4 works for any distribution regardless of the dimension. ", "page_idx": 8}, {"type": "text", "text": "5.2 Fixed Meta-stable Clustering Centers ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "Having established the existence of $O(\\sqrt{\\beta})$ quasi-stationary tokens for $d\\,=\\,2$ and $n\\gg1$ , we next examine their role as cluster centers. While Figures 3 and 2 provide substantial numerical evidence that these tokens attract and aggregate nearby particles, a rigorous proof remains elusive. We establish instead a weaker result: when quasi-stationary tokens are artificially frozen (analogous to cross-attention in encoder-decoder architectures), all other tokens converge to these frozen centers. This simplified model, while instructive, differs from true meta-stable clustering in important aspects detailed in Section 6. ", "page_idx": 8}, {"type": "text", "text": "We only state our result for $d=2$ and identity parameter matrices as in (CSA-2d). ", "page_idx": 8}, {"type": "text", "text": "Theorem 5.1 (Clustering to frozen tokens for $K=Q=V=I_{2}$ ). Let $\\theta_{1},\\ldots,\\theta_{m}$ be fixed tokens that are well-separated, namely $|\\theta_{i}-\\theta_{j}|>c\\beta^{-1/2}$ . Let $\\mu_{0}$ be an absolutely continuous probability measure on $(\\mathbb{S}^{1})^{n}$ and let $\\varphi_{1}(0),\\ldots,\\varphi_{n}(0)\\sim\\mu_{0}$ . Consider causal attention dynamics (CSA-2d), with additional influence from the fixed tokens $\\theta_{j}$ , which enter evolution with additional weights $a_{j}\\geq1$ . Specifically, we have ", "page_idx": 8}, {"type": "equation", "text": "$$\n\\dot{\\varphi}_{k}=\\frac{1}{Z_{k}}\\Big(\\sum_{j=1}^{k}e^{\\beta(\\cos(\\varphi_{k}-\\varphi_{j})-1)}\\sin(\\varphi_{j}-\\varphi_{k})+\\sum_{j=1}^{m}a_{j}e^{\\beta(\\cos(\\varphi_{k}-\\theta_{j})-1)}\\sin(\\theta_{j}-\\varphi_{k})\\Big),\n$$", "text_format": "latex", "page_idx": 8}, {"type": "text", "text": "with ", "page_idx": 8}, {"type": "equation", "text": "$$\nZ_{k}=\\sum_{j=1}^{k}e^{\\beta(\\cos(\\varphi_{k}-\\varphi_{j})-1)}+\\sum_{j=1}^{m}a_{j}e^{\\beta(\\cos(\\varphi_{k}-\\theta_{j})-1)}.\n$$", "text_format": "latex", "page_idx": 8}, {"type": "text", "text": "Define $\\begin{array}{r}{N=n+\\sum_{j=1}^{m}a_{j}}\\end{array}$ and $g=h^{\\prime}$ where $h$ is the interaction potential of (IntPot). ", "page_idx": 8}, {"type": "text", "text": "If $'N,\\beta,\\varepsilon>0,$ , and $c>2+2\\varepsilon$ satisfy: ", "page_idx": 8}, {"type": "equation", "text": "$$\n\\begin{array}{r}{N h((c-1-2\\varepsilon)\\beta^{-1/2})<h(\\varepsilon\\beta^{-1/2})}\\\\ {N g((c-2\\varepsilon)\\beta^{-1/2})<g(\\varepsilon\\beta^{-1/2}),}\\end{array}\n$$", "text_format": "latex", "page_idx": 8}, {"type": "text", "text": "then with probability one, $\\varphi(t)$ converges to an asymptotically stable critical point $\\varphi^{*}\\,\\in\\,(\\mathbb{S}^{1})^{n}$ satisfying: ", "page_idx": 8}, {"type": "equation", "text": "$$\n\\forall k\\in[n],\\ \\exists j\\in[m]:|\\varphi_{k}^{*}-\\theta_{j}|<\\varepsilon\\beta^{-1/2}.\n$$", "text_format": "latex", "page_idx": 8}, {"type": "text", "text": "Since our dynamical system is not a gradient flow, the classical \u0141ojasiewicz convergence theorem does not apply. Instead, we establish convergence by observing that the causal dynamics (both with and without frozen tokens) is, in fact, a sequential gradient flow, where each particle minimizes a slightly different energy potential. For such systems on ${\\mathbb S}^{1}$ , we demonstrate convergence through an alternative approach that circumvents the \u0141ojasiewicz framework. ", "page_idx": 8}, {"type": "text", "text": "Lemma 3. Consider a system of $n$ particles on $\\mathbb{S}^{1}$ with angular coordinates $\\varphi_{1},\\ldots,\\varphi_{n}\\in2\\pi\\mathbb{R}/\\mathbb{Z}$ evolving according to ", "page_idx": 8}, {"type": "equation", "text": "$$\n\\dot{\\varphi}_{k}=-\\frac{1}{Z_{k}(\\varphi_{1},\\ldots,\\varphi_{k})}\\frac{\\partial}{\\partial\\varphi_{k}}E_{k}(\\varphi_{1},\\ldots,\\varphi_{k}),\n$$", "text_format": "latex", "page_idx": 8}, {"type": "text", "text": "where $E_{1},\\ldots,E_{n}$ are $C^{1}$ energy functions and $Z_{k}$ are $C^{1}$ normalization factors bounded by $0<$ $c<Z_{k}(\\varphi)<C$ . Assume: ", "page_idx": 8}, {"type": "text", "text": "2. For any $k\\in[n]$ , critical points restricted to the first k particles are either strongly stable (the Jacobian has only eigenvalues with strictly negative real parts) or strongly unstable (there is an eigenvalue with a strictly positive real part). ", "page_idx": 9}, {"type": "text", "text": "Then for almost every initial condition $\\varphi(0)$ with respect to Lebesgue measure, $\\varphi(t)$ converges to a strongly stable critical point $\\varphi^{*}$ . ", "page_idx": 9}, {"type": "text", "text": "The proof is deferred to Section C.2. Remark 2. The conditions of Theorem 5.1 are satisfied under the following explicit bounds: ", "page_idx": 9}, {"type": "equation", "text": "$$\n\\varepsilon<0.1,\\quad c\\ \\ \\geq5.5+2\\varepsilon,\\quad\\beta\\geq(c-1-2\\varepsilon)^{2}/2,\\quad N\\ \\ \\leq\\frac{\\varepsilon}{c-1}\\exp(3(c-1-2\\varepsilon)^{2}/8).\n$$", "text_format": "latex", "page_idx": 9}, {"type": "text", "text": "Note that this result requires only $\\beta\\gtrsim\\log N$ . For example, taking $\\varepsilon=0.1$ and $c=6.5$ yields $\\beta\\ge14$ and $N\\leq700$ is sufficient. See Lemma 5 for the proof. ", "page_idx": 9}, {"type": "text", "text": "6 Limitations ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "Our analysis presents both theoretical and practical limitations. From a theoretical perspective, we establish two key results: (1) strong R\u00e9nyi centers maintain quasi-stationarity for time scales of order $\\exp(c^{2}/2)$ per Lemma 2, and (2) exactly stationary centers attract all remaining particles (Theorem 5.1). However, this falls short of proving meta-stable clustering, as Theorem 5.1 provides no bounds on the convergence time. Consequently, we cannot guarantee that strong R\u00e9nyi centers remain sufficiently stationary during particle aggregation. A complete meta-stability theory would require demonstrating that each R\u00e9nyi center captures $\\Omega(n)$ particles in $O(1)$ time as $n\\,\\rightarrow\\,\\infty$ . Currently, even the weaker claim of capturing $\\omega(1)$ particles remains unproven, presenting a crucial direction for future research. ", "page_idx": 9}, {"type": "text", "text": "The practical limitations stem from two model simplifications: the use of tied weights across layers (though supported by successful implementations, see Lan et al. (2020)), and the omission of the MLP layer central to Transformer architectures. Incorporating the MLP dynamics into our theoretical framework remains a significant open challenge. ", "page_idx": 9}, {"type": "text", "text": "Acknowledgments ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "The work of NK and YP was partially supported by the MIT-IBM Watson AI Lab and the National Science Foundation under Grant No CCF-2131115. PR is supported by NSF grants DMS-2022448 and CCF-2106377, and a gift from Apple. ", "page_idx": 9}, {"type": "text", "text": "References ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "Abdalla, P., Bandeira, A. S., Kassabov, M., Souza, V., Strogatz, S. H., and Townsend, A. (2022). Expander graphs are globally synchronising. arXiv preprint arXiv:2210.12788. ", "page_idx": 9}, {"type": "text", "text": "Abramson, J., Adler, J., Dunger, J., Evans, R., Green, T., Pritzel, A., Ronneberger, O., Willmore, L., Ballard, A. J., Bambrick, J., Bodenstein, S. W., Evans, D. A., Hung, C.-C., O\u2019Neill, M., Reiman, D., Tunyasuvunakool, K., Wu, Z., \u017demgulyte\u02d9, A., Arvaniti, E., Beattie, C., Bertolli, O., Bridgland, A., Cherepanov, A., Congreve, M., Cowen-Rivers, A. I., Cowie, A., Figurnov, M., Fuchs, F. B., Gladman, H., Jain, R., Khan, Y. A., Low, C. M. R., Perlin, K., Potapenko, A., Savy, P., Singh, S., Stecula, A., Thillaisundaram, A., Tong, C., Yakneen, S., Zhong, E. D., Zielinski, M., \u017d\u00eddek, A., Bapst, V., Kohli, P., Jaderberg, M., Hassabis, D., and Jumper, J. M. (2024). Accurate structure prediction of biomolecular interactions with alphafold 3. Nature. ", "page_idx": 9}, {"type": "text", "text": "Agrachev, A. and Letrouit, C. (2024). Generic controllability of equivariant systems and applications to particle systems and neural networks. arXiv preprint arXiv:2404.08289. ", "page_idx": 9}, {"type": "text", "text": "Bruno, G., Pasqualotto, F., and Agazzo, A. (2024). Emergence of meta-stable clustering in mean-field transformer models. ", "page_idx": 9}, {"type": "text", "text": "Castin, V., Ablin, P., and Peyr\u00e9, G. (2024). How smooth is attention? In International Conference on Machine Learning.   \nChang, H., Zhang, H., Barber, J., Maschinot, A., Lezama, J., Jiang, L., Yang, M.-H., Murphy, K. P., Freeman, W. T., Rubinstein, M., Li, Y., and Krishnan, D. (2023). Muse: Text-to-image generation via masked generative transformers. In Krause, A., Brunskill, E., Cho, K., Engelhardt, B., Sabato, S., and Scarlett, J., editors, Proceedings of the 40th International Conference on Machine Learning, volume 202 of Proceedings of Machine Learning Research, pages 4055\u20134075. PMLR.   \nCowsik, A., Nebabu, T., Qi, X.-L., and Ganguli, S. (2024). Geometric dynamics of signal propagation predict trainability of transformers. arXiv preprint arXiv:2403.02579.   \nCriscitiello, C., McRae, A., Rebjock, Q., and Boumal, N. (2024). Synchronization on circles and spheres with nonlinear interactions. arXiv preprint arXiv:2405.18273.   \nDong, Y., Cordonnier, J.-B., and Loukas, A. (2021). Attention is not all you need: pure attention loses rank doubly exponentially with depth. In Meila, M. and Zhang, T., editors, Proceedings of the 38th International Conference on Machine Learning, volume 139 of Proceedings of Machine Learning Research, pages 2793\u20132803. PMLR.   \nDvoretzky, A. and Robbins, H. (1964). On the parking problem. Publ. Math. Inst. Hung. Acad. Sci., 9:209\u2013224.   \nEsser, P., Rombach, R., and Ommer, B. (2021). Taming transformers for high-resolution image synthesis. In 2021 IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR), pages 12868\u201312878, Los Alamitos, CA, USA. IEEE Computer Society.   \nGeshkovski, B., Letrouit, C., Polyanskiy, Y., and Rigollet, P. (2023a). The emergence of clusters in self-attention dynamics. Advances in Neural Information Processing Systems, 36:57026\u201357037.   \nGeshkovski, B., Letrouit, C., Polyanskiy, Y., and Rigollet, P. (2023b). A mathematical perspective on transformers. arXiv preprint arXiv:2312.10794.   \nHaraux, A. (2012). Some applications of the \u0141ojasiewicz gradient inequality. Communications on Pure and Applied Analysis, 11(6):2417\u20132427.   \nKoubbi, H., Geshkovski, B., Polyanskiy, Y., and Rigollet, P. (2024). Dynamic metastability in the self-attention model. arXiv preprint arXiv:2410.06833.   \nLan, Z., Chen, M., Goodman, S., Gimpel, K., Sharma, P., and Soricut, R. (2020). ALBERT: A Lite BERT for Self-supervised Learning of Language Representations. In International Conference on Learning Representations.   \n\u0141ojasiewicz, S. (1962). Une propri\u00e9t\u00e9 topologique des sous-ensembles analytiques r\u00e9els. In Colloques internationaux du C.N.R.S.: Les \u00e9quations aux d\u00e9riv\u00e9es partielles, pages 87\u201389, Paris. Editions du C.N.R.S.   \n\u0141ojasiewicz, S. (1965). Ensembles semi-analytiques. Preprint, I.H.E.S., Bures-sur-Yvette.   \n\u0141ojasiewicz, S. (1984). Sur les trajectoires du gradient d\u2019une fonction analytique. In Geometry seminars, 1982-1983 (Bologna, 1982-1983), pages 115\u2013117, Univ. Stud. Bologna, Bologna.   \nMarkdahl, J., Thunberg, J., and Gon\u00e7alves, J. (2017). Almost global consensus on the $n$ -sphere. IEEE Transactions on Automatic Control, 63(6):1664\u20131675.   \nPaul, T. and Tr\u00e9lat, E. (2024). From microscopic to macroscopic scale dynamics: mean field, hydrodynamic and graph limits.   \nRamesh, A., Pavlov, M., Goh, G., Gray, S., Voss, C., Radford, A., Chen, M., and Sutskever, I. (2021). Zero-shot text-to-image generation. In Meila, M. and Zhang, T., editors, Proceedings of the 38th International Conference on Machine Learning, volume 139 of Proceedings of Machine Learning Research, pages 8821\u20138831. PMLR.   \nRenyi, A. (1958). On a one-dimensional problem concerning space-fliling. Publ. Math. Inst. Hungar. Acad. Sci., 3:109\u2013127. ", "page_idx": 10}, {"type": "text", "text": "Sander, M. E., Ablin, P., Blondel, M., and Peyr\u00e9, G. (2022). Sinkformers: Transformers with doubly stochastic attention. In International Conference on Artificial Intelligence and Statistics, pages 3515\u20133530. PMLR. ", "page_idx": 11}, {"type": "text", "text": "Shub, M. (2013). Global stability of dynamical systems. Springer Science Business Media. ", "page_idx": 11}, {"type": "text", "text": "Strogatz, S. H. (2000). From Kuramoto to Crawford: exploring the onset of synchronization in populations of coupled oscillators. Physica D: Nonlinear Phenomena, 143(1-4):1\u201320.   \nTeam, C. (2024). Chameleon: Mixed-modal early-fusion foundation models. arXiv preprint arXiv:2405.09818.   \nVaswani, A., Shazeer, N., Parmar, N., Uszkoreit, J., Jones, L., Gomez, A. N., Kaiser, L. u., and Polosukhin, I. (2017). Attention is all you need. In Guyon, I., Luxburg, U. V., Bengio, S., Wallach, H., Fergus, R., Vishwanathan, S., and Garnett, R., editors, Advances in Neural Information Processing Systems, volume 30. Curran Associates, Inc.   \nVuckovic, J., Baratin, A., and des Combes, R. T. (2021). On the regularity of attention. arXiv preprint arXiv:2102.05628.   \nWu, X., Ajorlou, A., Wu, Z., and Jadbabaie, A. (2023). Demystifying oversmoothing in attentionbased graph neural networks. In Oh, A., Naumann, T., Globerson, A., Saenko, K., Hardt, M., and Levine, S., editors, Advances in Neural Information Processing Systems, volume 36, pages 35084\u201335106. Curran Associates, Inc.   \nYu, J., Xu, Y., Koh, J. Y., Luong, T., Baid, G., Wang, Z., Vasudevan, V., Ku, A., Yang, Y., Ayan, B. K., Hutchinson, B., Han, W., Parekh, Z., Li, X., Zhang, H., Baldridge, J., and Wu, Y. (2022). Scaling autoregressive models for content-rich text-to-image generation. Transactions on Machine Learning Research. Featured Certification.   \nZhang, B. and Sennrich, R. (2019). Root mean square layer normalization. Proceedings of the 33rd International Conference on Neural Information Processing Systems.   \nZhang, X., Jiang, R., Gao, W., Willett, R., and Maire, M. (2024). Residual connections harm self-supervised abstract feature learning. arXiv preprint arXiv:2404.10947. ", "page_idx": 11}, {"type": "text", "text": "A Supplementary Material ", "text_level": 1, "page_idx": 12}, {"type": "text", "text": "A.1 From Transformers to ODEs ", "text_level": 1, "page_idx": 12}, {"type": "text", "text": "The derivation of the equation (SA) was thoroughly described in Geshkovski et al. (2023b), but for completeness, we briefly repeat it here to explain how the problem arises. ", "page_idx": 12}, {"type": "text", "text": "In general, a typical Transformer architecture consists of repeated layers of multi-head attention, multi-layer perceptrons (MLP), normalization, and residual connections Vaswani et al. (2017). In this work, we simplify this setting by focusing only on the geometric behavior of a single-head attention layer with normalization and residual connections, omitting the MLP for brevity. ", "page_idx": 12}, {"type": "text", "text": "One head of a standard attention layer is defined as follows. Given an input sequence represented by the token embeddings $X\\in\\mathbb{R}^{n\\times d}$ , where $n$ is the number of tokens and $d$ is the dimension of the embedding space, and matrices $W_{Q}$ , $W_{K}$ , $W_{V}$ to compute queries, keys, and values, the attention mechanism computes a weighted sum of values based on their relevance to a query in the following form ", "page_idx": 12}, {"type": "equation", "text": "$$\n\\mathrm{Attention}(X)=\\mathrm{softmax}\\left(\\frac{X W_{Q}W_{K}^{\\top}X^{\\top}}{\\sqrt{d}}\\right)X W_{V}.\n$$", "text_format": "latex", "page_idx": 12}, {"type": "text", "text": "By adding an RMS normalization from Zhang and Sennrich (2019) and a residual connection, the transformation from layer $t$ to layer $t+1$ is given by: ", "page_idx": 12}, {"type": "equation", "text": "$$\nX^{t+1}=X^{t}+\\mathrm{{RMSNorm}}(\\mathrm{{Attention}}(X^{t})).\n$$", "text_format": "latex", "page_idx": 12}, {"type": "text", "text": "Here, different tokens are represented as rows of the matrix $X$ for computational reasons. For consistency with the convention that vectors are represented as columns, we transpose everything and denote a sequence of tokens encoded as particles in the $d$ -dimensional embedding space $\\mathbb{R}^{d}$ as $(x_{1},\\ldots,x_{n})$ , corresponding to the columns of $X^{\\top}$ . Additionally, to simplify the notation we denote $V:=W_{V}^{\\top}$ , $\\stackrel{\\cdot}{Q}:=W_{Q}^{\\top}$ , and $K:=W_{K}^{\\top}$ , and introduce an arbitrary temperature parameter $\\beta$ instead of the fixed scaling factor $1/\\sqrt{d}$ . With these notational adjustments, one term of attention added to the $k$ -th token can be written explicitly as: ", "page_idx": 12}, {"type": "equation", "text": "$$\n\\operatorname{attn}(x_{1},\\dots,x_{n})_{k}={\\frac{1}{Z_{k}}}\\sum_{j=1}^{n}e^{\\beta\\langle Q x_{k},K x_{j}\\rangle}V x_{j},\n$$", "text_format": "latex", "page_idx": 12}, {"type": "text", "text": "where ", "page_idx": 12}, {"type": "equation", "text": "$$\nZ_{k}=\\sum_{j=1}^{n}e^{\\beta\\langle Q x_{k},K x_{j}\\rangle}.\n$$", "text_format": "latex", "page_idx": 12}, {"type": "text", "text": "The equation (3) can be interpreted as a discrete derivative, with $X^{t+1}\\mathrm{~-~}X^{t}$ representing the difference between layers. Therefore, the trajectory $X^{t}$ can be viewed as a discretization of a continuous flow. RMS normalization ensures that tokens remain on the scaled unit sphere, but from properly rescaling $Q,K,V$ we can assume that they stay on the standard unit sphere $\\mathbb{S}^{d-1}$ . Combining all these observations, the dynamics of token propagation through layers can be expressed as: ", "page_idx": 12}, {"type": "equation", "text": "$$\n\\dot{x}_{k}(t)=\\frac{1}{Z_{k}(t)}P_{x_{k}(t)}\\left(\\sum_{j=1}^{n}e^{\\beta\\langle Q(t)x_{k}(t),K(t)x_{j}(t)\\rangle}V(t)x_{j}(t)\\right),\n$$", "text_format": "latex", "page_idx": 12}, {"type": "text", "text": "with ", "page_idx": 12}, {"type": "equation", "text": "$$\nZ_{k}(t)=\\sum_{j=1}^{n}e^{\\beta\\langle Q(t)x_{k}(t),K(t)x_{j}(t)\\rangle},\n$$", "text_format": "latex", "page_idx": 12}, {"type": "text", "text": "and the projector $P_{x}(y):=y-\\langle x,y\\rangle x/|x|^{2}$ ensuring that $x_{k}$ remains on the sphere. This leads to the equation (SA), and applying a causal constraint, where each token attends only to the previous ones, transforms it into the causal attention equation (CSA) studied in this work. ", "page_idx": 12}, {"type": "text", "text": "A.2 Interaction Potential ", "text_level": 1, "page_idx": 12}, {"type": "text", "text": "For completeness, here we describe the key properties of the interaction potential $h(x)\\ =$ $e^{\\beta(\\cos(x)-1)}\\sin(x)$ from (IntPot), which defines the interactions between particles, and its derivative $g(x)=h^{\\prime}(x)$ . ", "page_idx": 12}, {"type": "text", "text": "Lemma 4 (Properties of Interaction Functions). Let $h(x)\\,=\\,e^{\\beta(\\cos x-1)}\\sin x$ and $g(x)\\,=\\,h^{\\prime}(x)$ . Then: ", "page_idx": 13}, {"type": "text", "text": "1. $h(x)$ is odd and $g(x)$ is even. ", "page_idx": 13}, {"type": "text", "text": "2. $h(x)$ is increasing on $[0,\\tau_{\\beta}^{*}]$ and decreasing on $[\\tau_{\\beta}^{*},\\infty)$ , where ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\cos\\tau_{\\beta}^{*}=\\frac{-1+\\sqrt{4\\beta^{2}+1}}{2\\beta}\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "and for $\\beta\\geq1$ , ", "page_idx": 13}, {"type": "equation", "text": "$$\n(\\beta+1/2)^{-1/2}<\\tau_{\\beta}^{*}<\\beta^{-1/2}\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "3. For $x>0$ , $h(x)$ is bounded by ", "page_idx": 13}, {"type": "equation", "text": "$$\ne^{-\\beta x^{2}/2}(x-x^{3}/6)<h(x)<e^{-\\beta x^{2}/2+\\beta x^{4}/24}x\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "4. For $g(x)$ , the following bounds hold: ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\begin{array}{l l}{{g(x)>e^{-\\beta x^{2}/2}(1-x^{2}/2-\\beta x^{2})\\qquad}}&{{f o r\\,0<x<(\\beta+1/2)^{-1/2}}}\\\\ {{\\ }}&{{g(x)>-e^{-\\beta x^{2}/2+\\beta x^{4}/24}\\beta x^{2}\\qquad}}&{{f o r\\,x>0}}\\end{array}\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "Proof. 1. The oddness of $h$ and evenness of $g$ follow directly from their definitions. ", "page_idx": 13}, {"type": "text", "text": "2. Computing $g(x)$ explicitly: ", "page_idx": 13}, {"type": "equation", "text": "$$\ng(x)=e^{\\beta(\\cos(x)-1)}(-\\beta\\sin^{2}(x)+\\cos(x))=e^{\\beta(\\cos(x)-1)}(\\beta\\cos(x)^{2}+\\cos(x)-\\beta)\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "The sign of $g(x)$ changes at $\\tau_{\\beta}^{*}$ , where ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\cos\\tau_{\\beta}^{*}=\\frac{-1+\\sqrt{4\\beta^{2}+1}}{2\\beta}\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "establishing that $h(x)$ increases on $[0,\\tau_{\\beta}^{*}]$ and decreases on $[\\tau_{\\beta}^{*},\\infty)$ . ", "page_idx": 13}, {"type": "text", "text": "For the the lower bound on $\\tau_{\\beta}^{*}$ : For $x<(\\beta+1/2)^{-1/2}$ , we have ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\cos x>1-x^{2}/2>\\beta x^{2}>\\beta\\sin^{2}x\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "implying $g(x)>0$ in this region. ", "page_idx": 13}, {"type": "text", "text": "For the upper bound on $\\tau_{\\beta}^{*}$ , fix $z=\\beta^{-1/2}$ and observe that it suffices to show ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\cos\\tau_{\\beta^{*}}=\\frac{-1+\\sqrt{4\\beta^{2}+1}}{2\\beta}>\\cos\\beta^{-1/2}=\\cos z\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "Using $\\cos z<1-z^{2}/2+z^{4}/24$ , this reduces to verifying ", "page_idx": 13}, {"type": "equation", "text": "$$\n-z^{2}/2+{\\sqrt{1+z^{4}/4}}>1-z^{2}/2+z^{4}/24\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "which holds for $z<3.13$ , satisfied when $\\beta=z^{-2}\\geq1$ . ", "page_idx": 13}, {"type": "text", "text": "3. and 4. The bounds on $h$ and $g$ follow from the standard inequalities ", "page_idx": 13}, {"type": "equation", "text": "$$\nx-x^{3}/6<\\sin x<x,\\quad{\\mathrm{and}}\\quad-x^{2}/2<\\cos x<-x^{2}/2+x^{4}/24\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "combined with our characterization of $g$ \u2019s sign via $\\tau_{\\beta}^{*}$ . ", "page_idx": 13}, {"type": "text", "text": "We now turn to the proof of Remark 2. ", "page_idx": 13}, {"type": "text", "text": "Lemma 5. Let $N,\\,c,\\,\\varepsilon$ , and $\\beta$ satisfy: ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\begin{array}{l}{c\\geq5.5+2\\varepsilon}\\\\ {\\beta\\geq(c-1-2\\varepsilon)^{2}/2}\\\\ {N<e^{3(c-1-2\\varepsilon)^{2}/8}\\displaystyle\\frac{\\varepsilon}{c-1}}\\end{array}\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "Then: ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{N h((c-1-2\\varepsilon)\\beta^{-1/2})<h(\\varepsilon\\beta^{-1/2})}&{{}a n d}&{{}-N g((c-2\\varepsilon)\\beta^{-1/2})<g(\\varepsilon\\beta^{-1/2})}\\end{array}\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "Proof. Let $r:=c-1-2\\varepsilon$ . From the assumptions, we have $r\\geq4.5$ , $\\beta\\geq r^{2}/2>10$ , and $\\varepsilon<0.1$ . We must verify: ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\begin{array}{l}{{N<\\displaystyle\\frac{h(\\varepsilon\\beta^{-1/2})}{h(r\\beta^{-1/2})}}}\\\\ {{N<\\displaystyle\\frac{g(\\varepsilon\\beta^{-1/2})}{-g((r+1)\\beta^{-1/2})}}}\\end{array}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "Using the bounds from Lemma 4, these inequalities reduce to: ", "page_idx": 14}, {"type": "equation", "text": "$$\nN<\\frac{\\exp(-\\varepsilon^{2}/2)\\varepsilon\\beta^{-1/2}(1-\\varepsilon^{2}/(6\\beta))}{\\exp(-r^{2}/2+r^{4}/(24\\beta))r\\beta^{-1/2}}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "and ", "page_idx": 14}, {"type": "equation", "text": "$$\nN<\\frac{\\exp(-\\varepsilon^{2}/2)(1-\\varepsilon^{2}/(2\\beta)-\\varepsilon^{2})}{\\exp(-(r+1)^{2}/2+(r+1)^{4}/(24\\beta))(r+1)^{2}}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "Given $N<\\exp(3r^{2}/8)\\varepsilon/r$ , it suffices to verify: ", "page_idx": 14}, {"type": "text", "text": "1. First inequality: Taking logarithms and using $\\varepsilon<0.1,\\beta>10$ , we need: ", "page_idx": 14}, {"type": "equation", "text": "$$\n-\\frac{r^{2}}{8}+\\frac{r^{4}}{24\\beta}+\\frac{\\varepsilon^{2}}{2}<-\\frac{3}{200}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "Since $\\beta\\geq r^{2}/2$ , this follows from: ", "page_idx": 14}, {"type": "equation", "text": "$$\n-\\frac{r^{2}}{8}+\\frac{r^{2}}{12}<-\\frac{1}{50}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "which holds for $r\\geq4.5$ . ", "page_idx": 14}, {"type": "text", "text": "2. Second inequality: After simplification using $\\beta\\ge r^{2}/2,\\beta\\ge10,\\varepsilon<0.1.$ , we need: ", "page_idx": 14}, {"type": "equation", "text": "$$\nf(r)={\\frac{3r^{2}}{8}}-{\\frac{(r+1)^{2}}{2}}+{\\frac{(r+1)^{4}}{12r^{2}}}+{\\frac{1}{200}}+2\\ln(r+1)-\\ln(9.8r)<0\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "The derivative ", "page_idx": 14}, {"type": "equation", "text": "$$\nf^{\\prime}(r)=\\frac{1}{3}r-1+\\frac{6r^{3}}{(r+1)^{3}(r-1)}+\\frac{2}{r+1}-\\frac{1}{r}>0\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "for $r>4.5$ , as $r>3$ and $2r>r+1$ . Therefore, it suffices to verify $f(4.5)\\approx-4.14<0$ . ", "page_idx": 14}, {"type": "text", "text": "B Final configuration ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "B.1 Proof of Lemma 1 ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "Let us show that trajectories $x(t)$ of our system can be characterized as normalized solutions of a linear homogeneous ODE in $\\mathbb{R}^{d}$ . Consider a solution $y(t)$ of: ", "page_idx": 14}, {"type": "equation", "text": "$$\n{\\dot{y}}(t)=V y(t),\\qquad y(0)=x(0)\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "For $s(t):=y(t)/\\lVert y(t)\\rVert$ , we derive: ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\dot{s}(t)=\\frac{\\dot{y}(t)}{\\|y(t)\\|}-\\frac{y(t)}{\\|y(t)\\|^{2}}\\left\\langle\\frac{y(t)}{\\|y(t)\\|},\\dot{y}(t)\\right\\rangle=V s(t)-\\langle s(t),V s(t)\\rangle s(t)=\\mathbf{P}_{s(t)}(V s(t))\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "Thus $x(t)\\equiv s(t)=y(t)/\\|y(t)\\|$ . ", "page_idx": 14}, {"type": "text", "text": "The solution to (4) has the following explicit form. Let $\\{J_{k}\\}$ denote the Jordan blocks of $V$ with: sizes $n_{k}$ , eigenvalues $\\lambda_{k}$ , and generalized eigenvectors $\\{\\xi_{1}^{k},\\dots,\\xi_{n_{k}}^{k}\\}$ . ", "page_idx": 14}, {"type": "text", "text": "Then: ", "page_idx": 14}, {"type": "equation", "text": "$$\ny(t)=\\sum_{k}{e^{\\lambda_{k}t}\\sum_{j=1}^{n_{k}}{c_{j}^{k}\\sum_{i=1}^{j}{\\frac{t^{j-i}}{(j-i)!}\\xi_{i}^{k}}}}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "where the coefficients $\\{c_{j}^{k}\\}$ satisfy: ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\sum_{k}\\sum_{j=1}^{n_{k}}c_{j}^{k}\\xi_{j}^{k}=x(0)\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "For almost all initial conditions $x(0)$ with respect to the surface measure on the sphere, all coefficients $c_{j}^{k}$ are non-zero. For complex eigenvalues $\\lambda_{k}$ , we combine conjugate terms to obtain real-valued solutions involving trigonometric functions. ", "page_idx": 15}, {"type": "text", "text": "The asymptotic behavior follows from two observations: (i) Terms with largest $\\Re(\\lambda_{k})$ dominate as $t\\to\\infty$ , corresponding to convergence to $L^{\\prime}\\cap S^{d-1}$ at exponential rate, and (ii) Among these terms, those with highest power of $t$ (i.e., $t^{n_{k}-1}\\xi_{1}^{k}$ terms) determine the slower convergence to $L\\cap S^{d-1}$ ", "page_idx": 15}, {"type": "text", "text": "B.2 Proof of Theorem 4.1 ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "We begin with a simple geometric lemma. ", "page_idx": 15}, {"type": "text", "text": "Lemma 6. Let $x,y,z\\in\\mathbb{R}^{d}$ with $\\|x\\|=\\|y\\|=1.\\;I f|\\langle y,z\\rangle|\\leq\\langle x,z\\rangle,$ , then: ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\langle x,z\\rangle\\geq\\langle x,y\\rangle\\langle y,z\\rangle\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "with equality if and only if either: (i $)\\;\\langle x,z\\rangle=0,$ , or (ii) $|\\langle y,z\\rangle|=\\langle x,z\\rangle$ and $\\langle x,y\\rangle=s i g n(\\langle y,z\\rangle)$ . ", "page_idx": 15}, {"type": "text", "text": "Proof. By the Cauchy-Schwarz inequality and the hypothesis: ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\langle x,y\\rangle\\langle y,z\\rangle\\leq|\\langle x,y\\rangle||\\langle y,z\\rangle|\\leq|\\langle x,y\\rangle|\\langle x,z\\rangle\\leq\\langle x,z\\rangle\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "where the last inequality follows since $|\\langle x,y\\rangle|\\leq1$ for unit vectors. ", "page_idx": 15}, {"type": "text", "text": "The equality conditions follow from examining when each inequality becomes equality in the chain above. \u53e3 ", "page_idx": 15}, {"type": "text", "text": "We continue with the proof of Theorem 4.1. ", "page_idx": 15}, {"type": "text", "text": "Proof. The system of particles is governed by equations ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\dot{x}_{k}=\\frac{1}{Z_{k}}\\sum_{j=1}^{k}e^{\\beta\\langle Q x_{k},K x_{j}\\rangle}(x_{j}-\\langle x_{j},x_{k}\\rangle x_{k}),\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "where we omit $t$ from the notation for simplicity. ", "page_idx": 15}, {"type": "text", "text": "This system is autonomous, so we first explore its critical points and their stability. For autonomous systems with established convergence, it is well-known that for any absolutely continuous initialization, the limiting point is strongly unstable with probability zero (see (Shub, 2013, Thm. III.7, Ex. III.3) and (Geshkovski et al., 2023b, Lemma B.1)). Note that the proof in Geshkovski et al. (2023b) is stated for gradient ascent dynamics but it readily extends to any smooth autonomous dynamics on a compact Riemannian manifold. ", "page_idx": 15}, {"type": "text", "text": "Define: ", "page_idx": 15}, {"type": "equation", "text": "$$\nf_{k}(\\boldsymbol{x}):=\\frac{1}{\\sum_{j=1}^{k}e^{\\beta\\langle Q x_{k},K x_{j}\\rangle}}\\cdot\\sum_{j=1}^{k}e^{\\beta\\langle Q x_{k},K x_{j}\\rangle}(x_{j}-\\langle x_{j},x_{k}\\rangle x_{k})\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "We aim to (i) find stationary points $x$ where all $f_{k}(x)=0$ and (ii) analyze eigenvalues of the Jacobian $\\big(\\frac{\\partial f_{k}}{\\partial x_{j}}\\big)$ at said stationary points. ", "page_idx": 15}, {"type": "text", "text": "Any critical point must satisfy one of the following: ", "page_idx": 15}, {"type": "equation", "text": "", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "Indeed, if the first condition fails, consider the first token $x_{s}$ where $x_{s}\\neq x_{1}$ . Then $f_{s}(x)=0$ implies $\\boldsymbol{x}_{s}-\\langle\\boldsymbol{x}_{s},\\boldsymbol{\\xi}\\rangle\\boldsymbol{\\xi}=0$ , forcing $x_{s}=\\pm\\xi$ so that $x_{s}=-\\xi$ since we required $x_{s}\\neq x_{1}$ . ", "page_idx": 16}, {"type": "text", "text": "Our goal is to show that stationary points of the second kind are limiting points with probability zero with respect to the initialization distribution. Observe that since the system formed by the first $s$ particles is independent of subsequent ones, it suffices to show: ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\mathbb{P}((x_{1},\\ldots,x_{s-1},x_{s})\\to(\\xi,\\ldots,\\xi,-\\xi))=0\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "Since $x_{1}(t)=x_{1}(0)$ , this reduces to: ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\mathbb{P}(x_{1}=\\xi,(x_{2},\\ldots,x_{s-1},x_{s})\\to(\\xi,\\ldots,\\xi,-\\xi))=0\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "By the law of total probability, it suffices to show that for almost all $\\xi\\in S^{d-1}$ : ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\mathbb{P}_{x_{2},\\ldots,x_{s}|x_{1}=\\xi}((x_{2},\\ldots,x_{s-1},x_{s})\\to(\\xi,\\ldots,\\xi,-\\xi))=0\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "We are left to the function $f_{s}$ around $(x_{1},\\ldots,x_{s-1},x_{s})=(\\xi,\\ldots,\\xi,-\\xi)$ . Observe that ", "page_idx": 16}, {"type": "equation", "text": "$$\nf_{s}(\\xi,\\dots,\\xi,x_{s})=w(\\xi,x_{s})(\\xi-\\langle\\xi,x_{s}\\rangle x_{s})\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "where ", "page_idx": 16}, {"type": "equation", "text": "$$\nw(\\xi,x_{s})=\\frac{(s-1)e^{\\beta\\langle Q x_{s},K\\xi\\rangle}}{(s-1)e^{\\beta\\langle Q x_{s},K\\xi\\rangle}+e^{\\beta\\langle Q x_{s},K x_{s}\\rangle}}>0.\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "Observe that the Jacobian $\\textstyle\\bigl(\\frac{\\partial f_{k}}{\\partial x_{j}}\\bigr)$ is block lower triangular, with blocks given by $\\textstyle{\\frac{\\partial f_{k}}{\\partial x_{k}}}$ . We show below that \u2202\u2202xfss has an eigenvalue with positive real part, which is sufficient to establish strong instability. ", "page_idx": 16}, {"type": "equation", "text": "$$\nf_{s}(\\xi,\\dots,\\xi,x_{s})=w(\\xi,x_{s})(\\xi-\\langle\\xi,x_{s}\\rangle x_{s})\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "where ", "page_idx": 16}, {"type": "equation", "text": "$$\nw(\\xi,x_{s})=\\frac{(s-1)e^{\\beta\\langle Q x_{s},K\\xi\\rangle}}{(s-1)e^{\\beta\\langle Q x_{s},K\\xi\\rangle}+e^{\\beta\\langle Q x_{s},K x_{s}\\rangle}}>0.\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "The classical Jacobian in $\\mathbb{R}^{d}$ is: ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\frac{\\partial}{\\partial x_{s}}f_{s}(\\xi,\\dots,\\xi,x_{s})=\\left(\\frac{\\partial}{\\partial x_{s}}w(\\xi,x_{s})\\right)(\\xi-\\langle\\xi,x_{s}\\rangle x_{s})^{\\top}+w(\\xi,x_{s})\\frac{\\partial}{\\partial x_{s}}(\\xi-\\langle\\xi,x_{s}\\rangle x_{s})\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "Hence ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\frac{\\partial}{\\partial x_{s}}f_{s}(\\xi,\\ldots,\\xi,x_{s})\\big|_{x_{s}=-\\xi}=w(\\xi,x_{s})\\frac{\\partial}{\\partial x_{s}}(\\xi-\\langle\\xi,x_{s}\\rangle x_{s})\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "The spherical Jacobian is obtained by projecting onto $\\xi^{\\perp}$ and given by ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\big(\\mathbf{I}-\\xi\\xi^{\\top}\\big)\\frac\\partial{\\partial x_{s}}f_{s}\\big(\\xi,\\dots,\\xi,x_{s}\\big)\\big|_{x_{s}=-\\xi}=w\\big(\\xi,-\\xi\\big)\\cdot\\big(\\mathbf{I}-\\xi\\xi^{\\top}\\big)\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "This linear operator acts on $\\xi^{\\perp}$ and has eigenvalues $w(\\xi,-\\xi)$ with multiplicity $d-1$ , which are all real positive, confirming strong instability. ", "page_idx": 16}, {"type": "text", "text": "By the center-stable manifold theorem (Shub, 2013, Thm. III.7, Ex. III.3), if a point has at least one   \neaingde (nivi)a lPueo iwntist hc poonsvietirvgei nrge atlo  ptahrits,  tehqeuni:l i(bir)i uThme  mceunstte re-nsttearb naitf solod $W_{l o c}^{c s}$ ithea sti pmoes iatinvde  (ciioi-)d tihmee snesti oonf $W_{l o c}^{c s}$   \nsuch points has measure zero. ", "page_idx": 16}, {"type": "text", "text": "More precisely, if a trajectory $(x_{2},\\ldots,x_{s})$ converges to $(\\xi,\\ldots,\\xi,-\\xi)$ , then: ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\exists\\,m\\in\\mathbb{Z}_{\\geq0}:(x_{2}(m),\\dots,x_{s}(m))\\in W_{l o c}^{c s}.\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "Since our flow is a diffeomorphism, the pre-image of $W_{l o c}^{c s}$ is also a manifold of positive codimension. Therefore, the set of initial conditions leading to convergence to $(\\xi,\\ldots,\\xi,-\\xi)$ is contained in a countable union of measure-zero sets, making it a measure-zero set itself. ", "page_idx": 16}, {"type": "text", "text": "We continue with an induction on the number of particles to show that with probability one, $x_{2},\\ldots,x_{n}$ all converge to $\\xi$ . ", "page_idx": 17}, {"type": "text", "text": "For the base case $k=2$ , observe that $x_{2}$ converges to $\\xi$ except when initialized unstable equilibrium $x_{2}(0)=-\\xi$ . ", "page_idx": 17}, {"type": "text", "text": "Assume next that $x_{2},\\ldots,x_{k-1}\\to\\xi$ with probability one so that for any $\\varepsilon>0$ , there exists a time $T_{0}$ after which ", "page_idx": 17}, {"type": "equation", "text": "$$\n\\operatorname*{min}_{j<k}\\langle x_{j},\\xi\\rangle>1-\\varepsilon\\quad{\\mathrm{a.s.}}\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "Consider: ", "page_idx": 17}, {"type": "equation", "text": "$$\n\\begin{array}{r l r}{\\lefteqn{\\frac{d\\langle x_{k}(t),\\xi\\rangle}{d t}=\\left\\langle\\mathbf{P}_{x_{k}(t)}\\left(\\frac{1}{Z_{k}(t)}\\sum_{j=1}^{k-1}e^{\\beta\\langle Q x_{k}(t),K x_{j}(t)\\rangle}x_{j}(t)\\right),\\xi\\right\\rangle}}\\\\ &{}&{=\\frac{1}{Z_{k}(t)}\\left(\\sum_{j=1}^{k-1}e^{\\beta\\langle Q x_{k}(t),K x_{j}(t)\\rangle}(\\langle x_{j}(t),\\xi\\rangle-\\langle x_{j}(t),x_{k}(t)\\rangle\\langle x_{k}(t),\\xi\\rangle)\\right).}\\end{array}\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "From Lemma 6 we get that $\\langle x_{j}(t),\\xi\\rangle-\\langle x_{j}(t),x_{k}(t)\\rangle\\langle x_{k}(t),\\xi\\rangle>0$ if $\\langle x_{j},\\xi\\rangle>0$ and $|\\langle x_{k},\\xi\\rangle|<$ $\\langle x_{j},\\xi\\rangle$ . In particular, we get that the time derivative above is positive after time $T_{0}$ whenever $-\\bar{1}+\\varepsilon<\\langle x_{k},\\xi\\rangle<1-\\varepsilon$ since we are guaranteed that $\\forall j<k$ , $\\langle\\bar{x}_{j},\\xi\\rangle>1-\\varepsilon>0$ after that time. But from the center-stable theorem argument, we know that $\\langle x_{k},\\xi\\rangle$ does not converge to $-1$ so there exists a time $T_{1}>T_{0}$ at which $\\langle x_{k},\\xi\\rangle>-1+\\varepsilon$ . After this time, either $x_{k}$ gets closer to $\\xi$ (positive derivative) until $\\langle x_{k},\\xi\\rangle=1-\\overset{\\cdot}{\\varepsilon}$ after which time, $\\langle x_{k},\\xi\\rangle\\geq1-\\varepsilon$ forever. Since this argument is valid, for all $\\varepsilon>0$ , we get that $x_{k}\\rightarrow\\xi$ . ", "page_idx": 17}, {"type": "text", "text": "By induction, all points converge to $\\xi$ with probability one. ", "page_idx": 17}, {"type": "text", "text": "B.3 Spectra of V ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "Here we include a figure showing the spectra of value matrices of different heads of a pre-trained transformer. Notice that most of them have real eigenvalue corresponding to $\\lambda_{\\mathrm{max}}$ , justifying our focus on the real case. Interestingly, there are heads with negative $\\lambda_{\\mathrm{max}}$ , even though starting spectrum of a Gaussian matrix is far from the left half-plane. This could indicate that some properties of $\\lambda_{\\operatorname*{max}}<0$ are desirable in practice, suggesting to consider other ways to initialise of $V$ for training. ", "page_idx": 17}, {"type": "image", "img_path": "OiVxYf9trg/tmp/3cdc5fd6794cbe90060f4d6afb4c928f437becedc2a68f4c289d21ebd680c7ba.jpg", "img_caption": ["Figure 4: Eigenvalues of different heads of pre-trained albert-xlarge-v2 model in the complex plane. "], "img_footnote": [], "page_idx": 17}, {"type": "text", "text": "C Meta-stable clustering ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "C.1 Proof of Lemma 2 ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "We prove the lemma for $d=2$ . ", "page_idx": 18}, {"type": "text", "text": "Proof. For $d=2$ , written in polar coordinates $x_{k}=\\exp(i\\varphi_{k})$ , the system is ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\dot{\\varphi}_{k}=\\frac{1}{Z_{k}}\\sum_{j=1}^{k-1}e^{\\beta(\\cos(\\varphi_{k}-\\varphi_{j})-1)}\\sin(\\varphi_{j}-\\varphi_{k}),\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "with ", "page_idx": 18}, {"type": "equation", "text": "$$\nZ_{k}=\\sum_{j=1}^{k}e^{\\beta(\\cos(\\varphi_{k}-\\varphi_{j})-1)}.\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "Because of the $j=k$ term one has $Z_{k}\\ge1$ , which implies ", "page_idx": 18}, {"type": "equation", "text": "$$\n|\\dot{\\varphi}_{s_{k}}|\\leq\\sum_{j=1}^{s_{k}-1}e^{\\beta(\\cos(\\varphi_{s_{k}}-\\varphi_{j})-1)}|\\sin(\\varphi_{j}-\\varphi_{s_{k}})|=\\sum_{j=1}^{s_{k}-1}h(|\\varphi_{j}-\\varphi_{s_{k}}|).\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "Consider $\\varphi_{r^{*}}$ to be the closest particle to $\\varphi_{s_{k}}$ among previous ones, here $r^{*}$ depends on $s_{k}$ and $t$ Wlog, let us assume that $\\varphi_{r^{*}}\\in[\\varphi_{s_{k}},\\varphi_{s_{k}}+\\ddot{\\pi}]$ and denote $\\Delta=\\varphi_{r^{*}}-\\varphi_{s_{k}}$ . We are going to show that $\\Delta$ cannot decrease fast. At any time one has ", "page_idx": 18}, {"type": "equation", "text": "$$\n-\\dot{\\Delta}=\\dot{\\varphi}_{s_{k}}-\\dot{\\varphi}_{r^{*}}=\\frac{1}{Z_{s_{k}}}\\sum_{j=1}^{s_{k}-1}h(\\varphi_{j}-\\varphi_{s_{k}})-\\frac{1}{Z_{r^{*}}}\\sum_{j=1}^{r^{*}-1}h(\\varphi_{j}-\\varphi_{r^{*}}).\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "Let us bound both terms separately. Due to the definition of $\\Delta$ , and as long as $\\Delta\\,>\\,\\tau_{\\beta}^{*}$ (from Lemma 4) we can bound the first term ", "page_idx": 18}, {"type": "equation", "text": "$$\n|\\dot{\\varphi}_{s_{k}}|\\leq s_{k}h(\\Delta).\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "For the second one, we only leave the terms with $\\varphi_{j}\\in\\left[\\varphi_{r^{*}}-\\pi,\\varphi_{r^{*}}\\right]$ , because the other ones are negative ", "page_idx": 18}, {"type": "equation", "text": "$$\n-\\dot{\\varphi}_{r^{\\ast}}\\leq\\dot{\\sum_{j=1}^{r^{\\ast}-1}}\\vert h(\\varphi_{j}-\\varphi_{r^{\\ast}})\\vert\\mathbf{1}_{\\varphi_{j}\\in[\\varphi_{r^{\\ast}}-\\pi,\\varphi_{r^{\\ast}}]}.\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "In other words, the only particles that drive $\\varphi_{r^{*}}$ towards $\\varphi_{s_{k}}$ are the ones that are in the same direction. However, there are no particles closer to $\\varphi_{s_{k}}$ than $\\varphi_{r^{*}}$ . Therefore, being in the same direction implies being at least $2\\Delta$ -far away from $\\varphi_{r^{*}}$ . ", "page_idx": 18}, {"type": "text", "text": "If $h(2\\Delta)<0$ , there are no particles $\\varphi_{j}\\,\\in\\,[\\varphi_{r^{\\ast}}-\\pi,\\varphi_{r^{\\ast}}]$ and the sum is zero, otherwise we use Lemma 4 to upper bound each term with $h(2\\Delta)$ . Thus, ", "page_idx": 18}, {"type": "equation", "text": "$$\n-\\dot{\\varphi}_{r^{\\ast}}\\leq s_{k}\\operatorname*{max}(h(2\\Delta),0)\\leq s_{k}h(\\Delta).\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "The last inequality follows from the fact that $h(\\Delta)\\,>\\,0$ and monotonicity of $h$ when $\\Delta\\,>\\,\\tau_{\\beta^{*}}$ . Combining the estimates, we obtain that for $\\Delta>\\tau_{\\beta}^{*}$ one has ", "page_idx": 18}, {"type": "equation", "text": "$$\n-\\dot{\\Delta}\\leq2s_{k}h(\\Delta).\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "To prove that for $t\\in[0,T_{k}]$ we have $\\Delta(t)>c\\beta^{-1/2}$ , we just need to verify that $c\\beta^{-1/2}>\\tau_{\\beta^{*}}$ and that initially ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\Delta(0)>c\\beta^{-1/2}+2s_{k}T_{k}h(c\\beta^{-1/2}),\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "which is true by definition of R\u00e9nyi centers, and bounds on $c$ (1) and $T_{k}$ (2). Then, from (7) one has ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\operatorname*{max}_{t\\in[0,T_{k}]}|\\varphi_{s_{k}}(t)-\\varphi_{s_{k}}(0)|<s_{k}T_{k}h(c\\beta^{-1/2})<\\varepsilon c\\beta^{-1/2}.\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "C.2 Proof of Lemma 3 ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "Proof. We prove that the particles converge exponentially fast to some strongly stable critical point $\\varphi^{*}$ via induction on their number. ", "page_idx": 19}, {"type": "text", "text": "Induction base. In this proof the induction base for $n=1$ follows from the induction step proof applied to the first particle $\\varphi_{1}$ . ", "page_idx": 19}, {"type": "text", "text": "Induction step. Consider $\\varphi_{1}(t),\\ldots,\\varphi_{n-1}(t)$ . They do not depend on $\\varphi_{n}$ and from induction hypothesis converge exponentially fast to some asymptotically stable point $\\varphi_{1}^{*},\\ldots,\\varphi_{n-1}^{*}$ . In particular, one has $\\dot{\\varphi}_{k}\\in\\bar{L_{1}}([0,\\bar{\\infty})),k\\in[n-1]$ . ", "page_idx": 19}, {"type": "text", "text": "Consider full derivative ", "page_idx": 19}, {"type": "equation", "text": "$$\n\\frac{d E_{n}(\\varphi(t))}{d t}=\\sum_{j=1}^{n-1}\\frac{\\partial E_{n}}{\\partial\\varphi_{j}}\\dot{\\varphi}_{j}(t)+\\frac{\\partial E_{n}}{\\partial\\varphi_{n}}\\dot{\\varphi}_{n}(t)=\\sum_{j=1}^{n-1}\\frac{\\partial E_{n}}{\\partial\\varphi_{j}}\\dot{\\varphi}_{j}(t)-Z_{n}(t)|\\dot{\\varphi}_{n}(t)|^{2}.\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "Since all partial derivatives $\\partial E_{n}/\\partial\\varphi_{j}$ are bounded on the compact manifold and all derivatives $\\dot{\\varphi}_{j},j<n$ are in $L_{1}([0,\\infty))$ , one has ", "page_idx": 19}, {"type": "equation", "text": "$$\ng(t):=\\sum_{j=1}^{n-1}\\frac{\\partial E_{n}}{\\partial\\varphi_{j}}\\dot{\\varphi}_{j}(t)\\in L_{1}([0,\\infty)).\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "For the base case, i.e. $n=1$ , one simply has $g(t)\\equiv0$ . Let us show that $\\begin{array}{r}{f(t):=\\frac{d E_{n}(\\varphi(t))}{d t}}\\end{array}$ is also in $L_{1}([0,\\infty))$ . Notice how $f(t)$ has a finite integral on any interval ", "page_idx": 19}, {"type": "equation", "text": "$$\n\\int_{a}^{b}f(t)d t=E_{n}(\\varphi(a))-E_{n}(\\varphi(b))<C<\\infty\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "and is upper bounded ", "page_idx": 19}, {"type": "equation", "text": "$$\nf(t)\\leq g(t)\\in L_{1}([0,\\infty)).\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "Consider $f_{+}=f(t)\\mathbf{1}_{f(t)>0}$ , $f\\,=\\,f_{+}\\,-\\,f_{-}$ . Clearly $f_{+}\\,\\in\\,L_{1}([0,\\infty))$ as it is upper bounded by $|g|\\in L_{1}([0,\\infty))$ . Moreover, the bound (8) shows that for all $T>0$ one has ", "page_idx": 19}, {"type": "equation", "text": "$$\n\\int_{0}^{T}f_{-}(s)d s\\leq\\int_{0}^{T}f_{+}(s)d s+C<\\|f_{+}\\|_{L_{1}([0,\\infty))}+C.\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "From this we get that $f_{-}\\in L_{1}([0,\\infty))$ . Consequently, $f\\in L_{1}([0,\\infty))$ . Since ", "page_idx": 19}, {"type": "equation", "text": "$$\nZ_{n}(t)|\\dot{\\varphi}_{n}|^{2}=g(t)-f(t)\\in L_{1}([0,\\infty)),\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "and $Z_{n}(t)$ has a uniform lower bound, we obtain $\\dot{\\varphi}_{n}\\in L_{2}([0,\\infty))$ . ", "page_idx": 19}, {"type": "text", "text": "Let us show that $\\dot{\\varphi}_{n}$ is absolutely continuous. The trajectory of all particles $\\varphi(t)$ is absolutely continuous, because ${\\dot{\\varphi}}(t)$ is bounded as a continuous vector field on a compact manifold. Then, $\\dot{\\varphi}_{n}(t)$ is absolutely continuous, because it is a composition of absolutely continuous vector field and an absolute continuous trajectory $\\varphi(t)$ . ", "page_idx": 19}, {"type": "text", "text": "Because $\\dot{\\varphi}\\in L_{2}([0,\\infty))$ and $\\dot{\\varphi}_{n}$ is absolutely continuous, it satisfies ", "page_idx": 19}, {"type": "equation", "text": "$$\n\\operatorname*{lim}_{t\\to\\infty}|\\dot{\\varphi}_{n}(t)|=0.\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "In other words, because of the upper bound $Z_{n}(t)<C$ , one has ", "page_idx": 19}, {"type": "equation", "text": "$$\n\\operatorname*{lim}_{t\\to\\infty}\\left|{\\frac{\\partial}{\\partial\\varphi_{n}}}E_{n}(\\varphi_{1}(t),\\ldots,\\varphi_{n}(t))\\right|=0.\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "Finally, we are going to prove that $\\varphi_{n}$ converges to some critical point $\\varphi_{n}^{*}$ with ", "page_idx": 19}, {"type": "equation", "text": "$$\n{\\frac{\\partial}{\\partial\\varphi_{n}}}E_{n}(\\varphi_{1}^{*},\\ldots,\\varphi_{n}^{*})=0.\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "Consider the set $\\mathcal{E}\\,=\\,\\{\\psi\\,:\\,\\frac{\\partial}{\\partial\\varphi_{n}}E(\\varphi_{1}^{*},\\dots,\\varphi_{n-1}^{*},\\psi)\\,=\\,0\\}$ . By assumption, the energy function $E_{n}(\\varphi_{1}^{*},\\ldots,\\varphi_{n-1}^{*},\\psi)$ has isolated critical points w.r.t. $\\psi$ , thus the set of zeroes $\\mathcal{E}$ is a finite collection of points $\\mathcal{E}=\\{\\psi_{1},\\dots,\\psi_{m}\\}$ . ", "page_idx": 19}, {"type": "text", "text": "When $\\varphi_{1},\\ldots,\\varphi_{n-1}$ converge to $\\varphi_{1}^{*},\\ldots,\\varphi_{n-1}^{*}$ the set ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\left\\{\\varphi_{n}:\\left|{\\frac{\\partial}{\\partial\\varphi_{n}}}E(\\varphi_{1},\\ldots,\\varphi_{n})\\right|<\\varepsilon\\right\\}\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "is inside a collection of distinct intervals around $\\psi_{1},\\ldots,\\psi_{m}$ for small enough $\\varepsilon$ . Therefore, due to (9), from some moment $\\varphi_{n}(t)$ stays only in one of those intervals. They collapse into points as we take $\\varepsilon\\rightarrow0$ and $t\\to\\infty$ , proving that $\\varphi_{n}$ converges to some $\\varphi_{n}^{*}\\in\\mathcal{E}$ . It remains to prove that observed convergence is to a strongly stable point. ", "page_idx": 20}, {"type": "text", "text": "We know that the limiting point is critical and for almost any initialisation it is not strongly unstable. This is a well-known fact that for autonomous systems convergence to a strongly unstable point happens with probability zero, that we used in Section B.2. One could find it in (Geshkovski et al., 2023b, Lemma B.1), based on the center manifold theorem (Shub, 2013, Thm. III.7, Ex. III.3). Therefore, from the assumption on critical points, the limiting point is strongly stable. Then, the convergence happens exponentially fast, because locally the whole neighbourhood of a strongly stable point is its stable manifold $W_{l o c}^{s}$ , see (Shub, 2013, Thm. III.7, Ex. III.3). \u53e3 ", "page_idx": 20}, {"type": "text", "text": "C.3 Proof of Theorem 5.1 ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Proof. Our prove consists of two parts. In order to obtain convergence we are going to apply Lemma 3. The system has exactly gradient-like form for energy functionals ", "page_idx": 20}, {"type": "equation", "text": "$$\nE_{k}(\\varphi_{1},\\ldots,\\varphi_{k})=-\\left(\\sum_{j=1}^{k-1}e^{\\beta(\\cos(\\varphi_{k}-\\varphi_{j})-1)}+\\sum_{j=1}^{m}a_{j}e^{\\beta(\\cos(\\varphi_{k}-\\theta_{j})-1)}\\right)\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "and bounded normalization factors ", "page_idx": 20}, {"type": "equation", "text": "$$\nZ_{k}(\\varphi_{1},\\ldots,\\varphi_{k})=\\sum_{j=1}^{k}e^{\\beta(\\cos(\\varphi_{k}-\\varphi_{j})-1)}+\\sum_{j=1}^{m}a_{j}e^{\\beta(\\cos(\\varphi_{k}-\\theta_{j})-1)}.\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "Therefore, if conditions of Lemma 3 are satisfied, we have convergence to a strongly stable critical point. In that case, it is sufficient to prove that for any strongly stable critical point $\\varphi^{*}$ , all particles $\\varphi_{k}^{*}$ are $\\varepsilon\\beta^{-1/2}$ -close to one of the centers $\\theta_{j}$ . We show this via induction on $k$ , because new particles do not affect the movement of the previous ones. ", "page_idx": 20}, {"type": "text", "text": "To justify our use of Lemma 3, we need to check that all critical points are either strongly stable or strongly unstable, i.e. that the Jacobian at any critical point with only non-positive eigenvalues actually has no zero eigenvalues. Moreover, for our conclusion, we need to check that if all the eigenvalues are negative, then the critical point is clustered around $\\theta$ . Let us start with that. ", "page_idx": 20}, {"type": "text", "text": "In what follows we repeatedly use properties of $h$ and $g$ from Lemma 4. ", "page_idx": 20}, {"type": "text", "text": "The system is of the form ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\dot{\\varphi}_{k}=-\\frac{1}{Z_{k}}\\left(\\sum_{j=1}^{k-1}h(\\varphi_{k}-\\varphi_{j})+\\sum_{j=1}^{m}a_{j}h(\\varphi_{k}-\\theta_{j})\\right)=:f_{k}(\\varphi,\\theta).\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "Since $f_{k}$ does not depend on $\\varphi_{k+1},\\ldots,\\varphi_{n}$ , the Jacobian $\\big(\\frac{\\partial f_{k}}{\\partial\\varphi_{j}}\\big)$ is lower-triangular. Therefore, its eigenvalues are $\\frac{\\partial f_{k}}{\\partial\\varphi_{k}}$ . Let us assume that all of the eigenvalues are non-positive. Since at a critical point $f_{k}(\\varphi^{*},\\theta)$ itself is zero, one has ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\frac{\\partial f_{k}}{\\partial\\varphi_{k}}(\\varphi^{*},\\theta)=-\\frac{1}{Z_{k}}\\left(\\sum_{j=1}^{k-1}g(\\varphi_{k}^{*}-\\varphi_{j}^{*})+\\sum_{j=1}^{m}a_{j}g(\\varphi_{k}^{*}-\\theta_{j})\\right)\\le0.\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "This implies that one of the terms $g(\\varphi_{k}^{*}-\\varphi_{j}^{*})$ or $g\\big(\\varphi_{k}^{*}-\\theta_{j}\\big)$ is positive. From properties of $g$ in Section A.2, we obtain that $\\varphi_{k}^{*}$ is $\\tau_{\\beta}^{*}$ -close to either one of the centers $\\theta_{j}$ or one of the previous particles $\\varphi_{j}^{*}$ . By induction hypothesis, all previous particles are $\\varepsilon\\beta^{-1/2}$ -close to the centers, i.e. $\\varphi_{k}^{*}$ is in $\\tau_{\\beta}^{*}+\\varepsilon\\beta^{-1/2}$ -neighbourhood of some center, wlog $\\theta_{1}$ . ", "page_idx": 20}, {"type": "text", "text": "Let us assume that $\\varphi_{k}^{*}$ is $\\varepsilon\\beta^{-1/2}$ -far from $\\theta_{1}$ . From criticality of the point, it is true that ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\sum_{j=1}^{k-1}h(\\varphi_{k}^{*}-\\varphi_{j}^{*})+\\sum_{j=1}^{m}a_{j}h(\\varphi_{k}^{*}-\\theta_{j})=0,\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "By induction hypothesis, all previous particles are $\\varepsilon\\beta^{-1/2}$ -close to some center. Denote the set of particles that are close to $\\theta_{1}$ as $S$ . Then the criticality can be written as ", "page_idx": 21}, {"type": "equation", "text": "$$\na_{1}h(\\varphi_{k}^{*}-\\theta_{1})+\\sum_{j\\in S}h(\\varphi_{k}^{*}-\\varphi_{j}^{*})=-\\sum_{j\\notin S}h(\\varphi_{k}^{*}-\\varphi_{j}^{*})-\\sum_{j=2}^{m}a_{j}h(\\varphi_{k}^{*}-\\theta_{j}).\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "All of the terms on the left hand side have the same sign, because $\\varphi_{j}^{*},j\\in S$ are $\\varepsilon\\beta^{-1/2}$ -close to $\\theta_{1}$ and $\\varphi_{k}^{*}$ is $(\\tau_{\\beta}^{*}+\\varepsilon\\beta^{-1/2})$ -close to $\\theta_{1}$ . Any other particle/center is at least $(c-2\\varepsilon)\\beta^{-1/2}-\\tau_{\\beta}^{*}$ far from $\\varphi_{k}^{*}$ , because centers are $c\\beta^{-1/2}$ -separated. The absolute value of the l.h.s. can be lower bounded ", "page_idx": 21}, {"type": "equation", "text": "$$\n|a_{1}h(\\varphi_{k}^{*})+\\sum_{j\\in S}h(\\varphi_{k}^{*}-\\varphi_{j}^{*})|\\geq h(\\varepsilon\\beta^{-1/2}).\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "The absolute value of the r.h.s. can be upper bounded ", "page_idx": 21}, {"type": "equation", "text": "$$\n|\\sum_{j\\notin S}h(\\varphi_{k}^{*}-\\varphi_{j}^{*})+\\sum_{j=2}^{m}a_{j}h(\\varphi_{k}^{*}-\\theta_{j})|\\leq N h((c-2\\varepsilon)\\beta^{-1/2}-\\tau_{\\beta}^{*})<N h((c-1-2\\varepsilon)\\beta^{-1/2}),\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "where in the last part we used the fact from Section A.2 that $\\tau_{\\beta}^{*}<\\beta^{-1/2}$ . ", "page_idx": 21}, {"type": "text", "text": "Therefore, one has ", "page_idx": 21}, {"type": "equation", "text": "$$\nN h((c-1-2\\varepsilon)\\beta^{-1/2})\\geq h(\\varepsilon\\beta^{-1/2}),\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "which contradicts our assumption on system parameters. ", "page_idx": 21}, {"type": "text", "text": "It remains to check that when the eigenvalues of the Jacobian are not positive, they are actually strictly negative. We already know that in that case all the particles are clustered around centers $\\theta_{j}$ . Let us assume that ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\frac{\\partial f_{k}}{\\partial\\varphi_{k}}(\\varphi^{\\ast},\\theta)=0.\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "We know that $\\varphi_{k}^{*}$ is $\\varepsilon\\beta^{-1/2}$ -close to some center, wlog $\\theta_{1}$ . Therefore, ", "page_idx": 21}, {"type": "equation", "text": "$$\ng(\\varphi_{k}^{*}-\\theta_{1})\\geq g(\\varepsilon\\beta^{-1/2}).\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "On the other hand, the only negative terms in the sum ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\sum_{j=1}^{k-1}g(\\varphi_{k}^{*}-\\varphi_{j}^{*})+\\sum_{j=1}^{m}a_{j}g(\\varphi_{k}^{*}-\\theta_{j})=0\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "are from particles that are not in the neighbourhood of $\\theta_{1}$ , so they are at least $(c-2\\varepsilon)\\beta^{-1/2}$ -far from $\\varphi_{k}$ . Therefore, for the negative terms to balance the positive $g\\big(\\varphi_{k}^{*}-\\theta_{1}\\big)$ , it should be true that ", "page_idx": 21}, {"type": "equation", "text": "$$\ng(\\varepsilon\\beta^{-1/2})<-N g((c-2\\varepsilon)\\beta^{-1/2}).\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "This contradicts the parameters choice. ", "page_idx": 21}, {"type": "text", "text": "C.4 R\u00e9nyi centers vs strong R\u00e9nyi centers ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "In this section we estimate the number of clusters our approach predicts. As a reminder, for a sequence of particles $X_{i}$ on a unit sphere, and geodesic distance dist, we consider two subsequences \u2022 R\u00e9nyi centers is $X_{s_{j}},j\\ge1$ such that $\\forall j\\operatorname*{min}_{i<j}\\mathsf{d i s t}(X_{s_{j}},X_{s_{i}})>\\delta,$ \u2022 strong R\u00e9nyi centers is $X_{s_{j}},j\\ge1$ such that $\\forall j\\operatorname*{min}_{i<s_{j}}$ dist $\\cdot(X_{s_{j}},X_{i})>\\delta.$ . ", "page_idx": 21}, {"type": "text", "text": "", "page_idx": 21}, {"type": "text", "text": "Estimating the number of elements in the first sub-sequence is well-known as famous R\u00e9nyi parking problem Renyi (1958). In the case $d=2$ , the result from Dvoretzky and Robbins (1964) implies that as $\\delta\\rightarrow0$ , the average number of elements in the sequence approaches $c2\\pi/\\delta$ superexponentially fast, where $c\\approx0.75$ is the R\u00e9nyi constant. However, this problem becomes significantly harder in higher dimensions. In contrast, it is easy to compute the average number of elements in the second sequence in any dimension and even for a wider class of distributions. ", "page_idx": 22}, {"type": "text", "text": "Lemma 7. In an infinitely long sequence $X_{i}$ the average number of variables $X_{s_{j}}$ chosen by strong R\u00e9nyi parking is the inverse spherical cap surface area $1/\\sigma^{d-1}(B_{\\delta})$ . In particular, it grows as $1/\\delta^{d-1}$ with dimension and can be computed directly in lower dimensions ", "page_idx": 22}, {"type": "equation", "text": "$$\n1/\\sigma^{d-1}(B_{\\delta})=\\binom{\\pi\\delta^{-1},d=2}{(3\\sin^{2}(\\delta/2))^{-1},d=3}\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "Proof. Consider a sequence of i.i.d. points $X_{i}$ being sampled on a $d$ -dimensional sphere $\\mathbb{S}^{d-1}$ according to some distribution $\\mu$ . Let us find the probability that $k$ -th particle $X_{k}$ is chosen by strong R\u00e9nyi parking with distance $\\delta$ . This event can be written as ", "page_idx": 22}, {"type": "equation", "text": "$$\n\\mathbb{P}[\\cap_{j=1}^{k-1}\\{{\\sf d i s t}(X_{k},X_{j})>\\delta\\}]=\\int_{\\mathbb{S}^{d-1}}\\mathbb{P}[\\cap_{j=1}^{k-1}\\{{\\sf d i s t}(x,X_{j})>\\delta\\}]d\\mu(x),\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "where we used total probability formula. Then, since $X_{j}$ are i.i.d., we can write it as ", "page_idx": 22}, {"type": "equation", "text": "$$\n\\int_{\\mathbb{S}^{d-1}}\\mathbb{P}({\\sf d i s t}(x,X_{1})>\\delta)^{k-1}d\\mu(x)=\\int_{\\mathbb{S}^{d-1}}(1-\\mu(B_{\\delta}(x)))^{k-1}d\\mu(x).\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "From this we obtain that the average number of chosen points is equal to ", "page_idx": 22}, {"type": "equation", "text": "$$\n\\int_{\\mathbb{S}^{d-1}}\\sum_{k=1}^{\\infty}\\mathbb{P}({\\sf d i s t}(x,X_{1})>\\delta)^{k-1}d\\mu(x)=\\int_{\\mathbb{S}^{d-1}}\\frac{1}{\\mu(B_{\\delta}(x))}d\\mu(x)=\\frac{1}{\\sigma^{d-1}(B_{\\delta})},\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "where the last equality is correct for any spherically harmonic distribution $\\mu$ , in particular for a uniform measure. \u53e3 ", "page_idx": 22}, {"type": "text", "text": "NeurIPS Paper Checklist ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "1. Claims ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: Do the main claims made in the abstract and introduction accurately reflect the paper\u2019s contributions and scope? ", "page_idx": 23}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 23}, {"type": "text", "text": "Justification: The work is dedicated to causal self-attention from interacting particles point of view. Asymptotic convergence for arbitrary key-query matrices is proven in Theorem 4.1, final configuration for non-identity Value matrices is presented in Table 1 and Figure 1. Connection with R\u00e9nyi parking is shown in Section 5 and properties of meta-stable clusters are proven in Lemma 2 and Theorem 5.1. ", "page_idx": 23}, {"type": "text", "text": "Guidelines: ", "page_idx": 23}, {"type": "text", "text": "\u2022 The answer NA means that the abstract and introduction do not include the claims made in the paper.   \n\u2022 The abstract and/or introduction should clearly state the claims made, including the contributions made in the paper and important assumptions and limitations. A No or NA answer to this question will not be perceived well by the reviewers.   \n\u2022 The claims made should match theoretical and experimental results, and reflect how much the results can be expected to generalize to other settings.   \n\u2022 It is fine to include aspirational goals as motivation as long as it is clear that these goals are not attained by the paper. ", "page_idx": 23}, {"type": "text", "text": "2. Limitations ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: Does the paper discuss the limitations of the work performed by the authors? ", "page_idx": 23}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Justification: Significant limitations are discussed in Section 6. As mentioned in Section 4, provided approach to asymptotical convergence is generally close, but insufficient to prove all results listed in Table 1, that is why those results are only conjectured. ", "page_idx": 23}, {"type": "text", "text": "Guidelines: ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "\u2022 The answer NA means that the paper has no limitation while the answer No means that the paper has limitations, but those are not discussed in the paper.   \n\u2022 The authors are encouraged to create a separate \"Limitations\" section in their paper.   \n\u2022 The paper should point out any strong assumptions and how robust the results are to violations of these assumptions (e.g., independence assumptions, noiseless settings, model well-specification, asymptotic approximations only holding locally). The authors should reflect on how these assumptions might be violated in practice and what the implications would be.   \n\u2022 The authors should reflect on the scope of the claims made, e.g., if the approach was only tested on a few datasets or with a few runs. In general, empirical results often depend on implicit assumptions, which should be articulated.   \n\u2022 The authors should reflect on the factors that influence the performance of the approach. For example, a facial recognition algorithm may perform poorly when image resolution is low or images are taken in low lighting. Or a speech-to-text system might not be used reliably to provide closed captions for online lectures because it fails to handle technical jargon.   \n\u2022 The authors should discuss the computational efficiency of the proposed algorithms and how they scale with dataset size.   \n\u2022 If applicable, the authors should discuss possible limitations of their approach to address problems of privacy and fairness.   \n\u2022 While the authors might fear that complete honesty about limitations might be used by reviewers as grounds for rejection, a worse outcome might be that reviewers discover limitations that aren\u2019t acknowledged in the paper. The authors should use their best judgment and recognize that individual actions in favor of transparency play an important role in developing norms that preserve the integrity of the community. Reviewers will be specifically instructed to not penalize honesty concerning limitations. ", "page_idx": 23}, {"type": "text", "text": "3. Theory Assumptions and Proofs ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Question: For each theoretical result, does the paper provide the full set of assumptions and a complete (and correct) proof? ", "page_idx": 24}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Justification: The proofs of all claimed results can be found in appendix. When stated, every result refers to the section that is dedicated to its proof. All proofs are well-structured, rely on known results and have all the assumptions clearly stated. ", "page_idx": 24}, {"type": "text", "text": "Guidelines: ", "page_idx": 24}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include theoretical results.   \n\u2022 All the theorems, formulas, and proofs in the paper should be numbered and crossreferenced.   \n\u2022 All assumptions should be clearly stated or referenced in the statement of any theorems.   \n\u2022 The proofs can either appear in the main paper or the supplemental material, but if they appear in the supplemental material, the authors are encouraged to provide a short proof sketch to provide intuition.   \n\u2022 Inversely, any informal proof provided in the core of the paper should be complemented by formal proofs provided in appendix or supplemental material.   \n\u2022 Theorems and Lemmas that the proof relies upon should be properly referenced. ", "page_idx": 24}, {"type": "text", "text": "4. Experimental Result Reproducibility ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Question: Does the paper fully disclose all the information needed to reproduce the main experimental results of the paper to the extent that it affects the main claims and/or conclusions of the paper (regardless of whether the code and data are provided or not)? ", "page_idx": 24}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 24}, {"type": "text", "text": "Justification: The only experiments are numerical models of considered dynamics presented in Figures 1, 3 and 2. Their main purpose is to support what is claimed visually. These calculations can be easily reproduced, as all the parameters used are listed and the system is not computationally complicated. ", "page_idx": 24}, {"type": "text", "text": "Guidelines: ", "page_idx": 24}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 If the paper includes experiments, a No answer to this question will not be perceived well by the reviewers: Making the paper reproducible is important, regardless of whether the code and data are provided or not.   \n\u2022 If the contribution is a dataset and/or model, the authors should describe the steps taken to make their results reproducible or verifiable.   \n\u2022 Depending on the contribution, reproducibility can be accomplished in various ways. For example, if the contribution is a novel architecture, describing the architecture fully might suffice, or if the contribution is a specific model and empirical evaluation, it may be necessary to either make it possible for others to replicate the model with the same dataset, or provide access to the model. In general. releasing code and data is often one good way to accomplish this, but reproducibility can also be provided via detailed instructions for how to replicate the results, access to a hosted model (e.g., in the case of a large language model), releasing of a model checkpoint, or other means that are appropriate to the research performed.   \n\u2022 While NeurIPS does not require releasing code, the conference does require all submissions to provide some reasonable avenue for reproducibility, which may depend on the nature of the contribution. For example (a) If the contribution is primarily a new algorithm, the paper should make it clear how to reproduce that algorithm. (b) If the contribution is primarily a new model architecture, the paper should describe the architecture clearly and fully. (c) If the contribution is a new model (e.g., a large language model), then there should either be a way to access this model for reproducing the results or a way to reproduce the model (e.g., with an open-source dataset or instructions for how to construct the dataset). ", "page_idx": 24}, {"type": "text", "text": "(d) We recognize that reproducibility may be tricky in some cases, in which case authors are welcome to describe the particular way they provide for reproducibility. In the case of closed-source models, it may be that access to the model is limited in some way (e.g., to registered users), but it should be possible for other researchers to have some path to reproducing or verifying the results. ", "page_idx": 25}, {"type": "text", "text": "5. Open access to data and code ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "Question: Does the paper provide open access to the data and code, with sufficient instructions to faithfully reproduce the main experimental results, as described in supplemental material? ", "page_idx": 25}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 25}, {"type": "text", "text": "Justification: The only experiments are numerical modelings of the system, that were used to support conjectures in Section 4 and show performance of predicted meta-stable clustering centers in Figure 3. They are not claimed as main results of the paper and if needed the code for creating the pictures is easy to reproduce. ", "page_idx": 25}, {"type": "text", "text": "Guidelines: ", "page_idx": 25}, {"type": "text", "text": "\u2022 The answer NA means that paper does not include experiments requiring code.   \n\u2022 Please see the NeurIPS code and data submission guidelines (https://nips.cc/ public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 While we encourage the release of code and data, we understand that this might not be possible, so \u201cNo\u201d is an acceptable answer. Papers cannot be rejected simply for not including code, unless this is central to the contribution (e.g., for a new open-source benchmark).   \n\u2022 The instructions should contain the exact command and environment needed to run to reproduce the results. See the NeurIPS code and data submission guidelines (https: //nips.cc/public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 The authors should provide instructions on data access and preparation, including how to access the raw data, preprocessed data, intermediate data, and generated data, etc.   \n\u2022 The authors should provide scripts to reproduce all experimental results for the new proposed method and baselines. If only a subset of experiments are reproducible, they should state which ones are omitted from the script and why.   \n\u2022 At submission time, to preserve anonymity, the authors should release anonymized versions (if applicable).   \n\u2022 Providing as much information as possible in supplemental material (appended to the paper) is recommended, but including URLs to data and code is permitted. ", "page_idx": 25}, {"type": "text", "text": "6. Experimental Setting/Details ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "Question: Does the paper specify all the training and test details (e.g., data splits, hyperparameters, how they were chosen, type of optimizer, etc.) necessary to understand the results? ", "page_idx": 25}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 25}, {"type": "text", "text": "Justification: The paper does not include experiments. ", "page_idx": 25}, {"type": "text", "text": "Guidelines: ", "page_idx": 25}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments. \u2022 The experimental setting should be presented in the core of the paper to a level of detail that is necessary to appreciate the results and make sense of them. \u2022 The full details can be provided either with the code, in appendix, or as supplemental material. ", "page_idx": 25}, {"type": "text", "text": "7. Experiment Statistical Significance ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "Question: Does the paper report error bars suitably and correctly defined or other appropriate information about the statistical significance of the experiments? ", "page_idx": 25}, {"type": "text", "text": "Answer: [No] ", "page_idx": 25}, {"type": "text", "text": "Justification: The paper does not include experiments. Guidelines: ", "page_idx": 25}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The authors should answer \"Yes\" if the results are accompanied by error bars, confidence intervals, or statistical significance tests, at least for the experiments that support the main claims of the paper.   \n\u2022 The factors of variability that the error bars are capturing should be clearly stated (for example, train/test split, initialization, random drawing of some parameter, or overall run with given experimental conditions).   \n\u2022 The method for calculating the error bars should be explained (closed form formula, call to a library function, bootstrap, etc.)   \n\u2022 The assumptions made should be given (e.g., Normally distributed errors).   \n\u2022 It should be clear whether the error bar is the standard deviation or the standard error of the mean.   \n\u2022 It is OK to report 1-sigma error bars, but one should state it. The authors should preferably report a 2-sigma error bar than state that they have a $96\\%$ CI, if the hypothesis of Normality of errors is not verified.   \n\u2022 For asymmetric distributions, the authors should be careful not to show in tables or figures symmetric error bars that would yield results that are out of range (e.g. negative error rates).   \n\u2022 If error bars are reported in tables or plots, The authors should explain in the text how they were calculated and reference the corresponding figures or tables in the text. ", "page_idx": 26}, {"type": "text", "text": "8. Experiments Compute Resources ", "text_level": 1, "page_idx": 26}, {"type": "text", "text": "Question: For each experiment, does the paper provide sufficient information on the computer resources (type of compute workers, memory, time of execution) needed to reproduce the experiments? ", "page_idx": 26}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 26}, {"type": "text", "text": "Justification: The paper does not include experiments. ", "page_idx": 26}, {"type": "text", "text": "Guidelines: ", "page_idx": 26}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The paper should indicate the type of compute workers CPU or GPU, internal cluster, or cloud provider, including relevant memory and storage.   \n\u2022 The paper should provide the amount of compute required for each of the individual experimental runs as well as estimate the total compute.   \n\u2022 The paper should disclose whether the full research project required more compute than the experiments reported in the paper (e.g., preliminary or failed experiments that didn\u2019t make it into the paper). ", "page_idx": 26}, {"type": "text", "text": "9. Code Of Ethics ", "text_level": 1, "page_idx": 26}, {"type": "text", "text": "Question: Does the research conducted in the paper conform, in every respect, with the NeurIPS Code of Ethics https://neurips.cc/public/EthicsGuidelines? ", "page_idx": 26}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 26}, {"type": "text", "text": "Justification: Conducted research conforms with the Code of Ethics. ", "page_idx": 26}, {"type": "text", "text": "Guidelines: ", "page_idx": 26}, {"type": "text", "text": "\u2022 The answer NA means that the authors have not reviewed the NeurIPS Code of Ethics.   \n\u2022 If the authors answer No, they should explain the special circumstances that require a deviation from the Code of Ethics.   \n\u2022 The authors should make sure to preserve anonymity (e.g., if there is a special consideration due to laws or regulations in their jurisdiction). ", "page_idx": 26}, {"type": "text", "text": "10. Broader Impacts ", "text_level": 1, "page_idx": 26}, {"type": "text", "text": "Question: Does the paper discuss both potential positive societal impacts and negative societal impacts of the work performed? ", "page_idx": 26}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 26}, {"type": "text", "text": "Justification: The paper is focused on theoretical research and does not provide any direct improvement of existing models, thus it has no way of deployment that could somehow have harmful societal impact. In general, this work aims to improve our theoretical understanding of Transformers, that are prevalent in modern state-of-the-art AI models. In this regard, it could lead to improved long-term development of the field, that we see to be beneficial for the society. ", "page_idx": 27}, {"type": "text", "text": "Guidelines: ", "page_idx": 27}, {"type": "text", "text": "\u2022 The answer NA means that there is no societal impact of the work performed.   \n\u2022 If the authors answer NA or No, they should explain why their work has no societal impact or why the paper does not address societal impact.   \n\u2022 Examples of negative societal impacts include potential malicious or unintended uses (e.g., disinformation, generating fake profiles, surveillance), fairness considerations (e.g., deployment of technologies that could make decisions that unfairly impact specific groups), privacy considerations, and security considerations.   \n\u2022 The conference expects that many papers will be foundational research and not tied to particular applications, let alone deployments. However, if there is a direct path to any negative applications, the authors should point it out. For example, it is legitimate to point out that an improvement in the quality of generative models could be used to generate deepfakes for disinformation. On the other hand, it is not needed to point out that a generic algorithm for optimizing neural networks could enable people to train models that generate Deepfakes faster.   \n\u2022 The authors should consider possible harms that could arise when the technology is being used as intended and functioning correctly, harms that could arise when the technology is being used as intended but gives incorrect results, and harms following from (intentional or unintentional) misuse of the technology.   \n\u2022 If there are negative societal impacts, the authors could also discuss possible mitigation strategies (e.g., gated release of models, providing defenses in addition to attacks, mechanisms for monitoring misuse, mechanisms to monitor how a system learns from feedback over time, improving the efficiency and accessibility of ML). ", "page_idx": 27}, {"type": "text", "text": "11. Safeguards ", "text_level": 1, "page_idx": 27}, {"type": "text", "text": "Question: Does the paper describe safeguards that have been put in place for responsible release of data or models that have a high risk for misuse (e.g., pretrained language models, image generators, or scraped datasets)? ", "page_idx": 27}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 27}, {"type": "text", "text": "Justification: The paper is theoretical and does not have any model to release. ", "page_idx": 27}, {"type": "text", "text": "Guidelines: ", "page_idx": 27}, {"type": "text", "text": "\u2022 The answer NA means that the paper poses no such risks.   \n\u2022 Released models that have a high risk for misuse or dual-use should be released with necessary safeguards to allow for controlled use of the model, for example by requiring that users adhere to usage guidelines or restrictions to access the model or implementing safety filters.   \n\u2022 Datasets that have been scraped from the Internet could pose safety risks. The authors should describe how they avoided releasing unsafe images.   \n\u2022 We recognize that providing effective safeguards is challenging, and many papers do not require this, but we encourage authors to take this into account and make a best faith effort. ", "page_idx": 27}, {"type": "text", "text": "12. Licenses for existing assets ", "text_level": 1, "page_idx": 27}, {"type": "text", "text": "Question: Are the creators or original owners of assets (e.g., code, data, models), used in the paper, properly credited and are the license and terms of use explicitly mentioned and properly respected? ", "page_idx": 27}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 27}, {"type": "text", "text": "Justification: The paper does not utilize any existing code. Every existing idea or intellectual result is properly referenced upon its introduction. ", "page_idx": 27}, {"type": "text", "text": "Guidelines: ", "page_idx": 28}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not use existing assets.   \n\u2022 The authors should cite the original paper that produced the code package or dataset.   \n\u2022 The authors should state which version of the asset is used and, if possible, include a URL.   \n\u2022 The name of the license (e.g., CC-BY 4.0) should be included for each asset.   \n\u2022 For scraped data from a particular source (e.g., website), the copyright and terms of service of that source should be provided.   \n\u2022 If assets are released, the license, copyright information, and terms of use in the package should be provided. For popular datasets, paperswithcode.com/datasets has curated licenses for some datasets. Their licensing guide can help determine the license of a dataset.   \n\u2022 For existing datasets that are re-packaged, both the original license and the license of the derived asset (if it has changed) should be provided.   \n\u2022 If this information is not available online, the authors are encouraged to reach out to the asset\u2019s creators. ", "page_idx": 28}, {"type": "text", "text": "13. New Assets ", "text_level": 1, "page_idx": 28}, {"type": "text", "text": "Question: Are new assets introduced in the paper well documented and is the documentation provided alongside the assets? ", "page_idx": 28}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 28}, {"type": "text", "text": "Justification: The paper does not release new assets. ", "page_idx": 28}, {"type": "text", "text": "Guidelines: ", "page_idx": 28}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not release new assets.   \n\u2022 Researchers should communicate the details of the dataset/code/model as part of their submissions via structured templates. This includes details about training, license, limitations, etc.   \n\u2022 The paper should discuss whether and how consent was obtained from people whose asset is used.   \n\u2022 At submission time, remember to anonymize your assets (if applicable). You can either create an anonymized URL or include an anonymized zip file. ", "page_idx": 28}, {"type": "text", "text": "14. Crowdsourcing and Research with Human Subjects ", "text_level": 1, "page_idx": 28}, {"type": "text", "text": "Question: For crowdsourcing experiments and research with human subjects, does the paper include the full text of instructions given to participants and screenshots, if applicable, as well as details about compensation (if any)? ", "page_idx": 28}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 28}, {"type": "text", "text": "Justification: The answer NA means that the paper does not involve crowdsourcing nor research with human subjects. ", "page_idx": 28}, {"type": "text", "text": "Guidelines: ", "page_idx": 28}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Including this information in the supplemental material is fine, but if the main contribution of the paper involves human subjects, then as much detail as possible should be included in the main paper.   \n\u2022 According to the NeurIPS Code of Ethics, workers involved in data collection, curation, or other labor should be paid at least the minimum wage in the country of the data collector. ", "page_idx": 28}, {"type": "text", "text": "15. Institutional Review Board (IRB) Approvals or Equivalent for Research with Human Subjects ", "text_level": 1, "page_idx": 28}, {"type": "text", "text": "Question: Does the paper describe potential risks incurred by study participants, whether such risks were disclosed to the subjects, and whether Institutional Review Board (IRB) approvals (or an equivalent approval/review based on the requirements of your country or institution) were obtained? ", "page_idx": 28}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 29}, {"type": "text", "text": "Justification: The answer NA means that the paper does not involve crowdsourcing nor research with human subjects. ", "page_idx": 29}, {"type": "text", "text": "Guidelines: ", "page_idx": 29}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Depending on the country in which research is conducted, IRB approval (or equivalent) may be required for any human subjects research. If you obtained IRB approval, you should clearly state this in the paper.   \n\u2022 We recognize that the procedures for this may vary significantly between institutions and locations, and we expect authors to adhere to the NeurIPS Code of Ethics and the guidelines for their institution.   \n\u2022 For initial submissions, do not include any information that would break anonymity (if applicable), such as the institution conducting the review. ", "page_idx": 29}]