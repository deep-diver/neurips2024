[{"figure_path": "348hfcprUs/figures/figures_1_1.jpg", "caption": "Figure 1: Left: An illustration of our method. Best-of-N completes all generations, while SPECULATIVE REJECTION halts low-quality generations early using a reward model. Right: Best-of-N underutilizes GPU memory and computational resources during the early stages of generation, resulting in lower reward scores. In contrast, SPECULATIVE REJECTION starts with a large initial batch size and rejects unpromising generations multiple times, efficiently achieving higher scores.", "description": "The figure illustrates a comparison between Best-of-N and Speculative Rejection.  The left panel shows schematics of the two methods. Best-of-N generates all N sequences before selecting the best one according to a reward model, while Speculative Rejection uses a reward model to selectively stop generating low-scoring sequences early.  The right panel shows graphs comparing memory usage, batch size, reward scores, and generation length for both methods.  Speculative Rejection is shown to be more efficient in utilizing resources and achieving comparable or better reward scores.", "section": "4 SPECULATIVE REJECTION"}, {"figure_path": "348hfcprUs/figures/figures_4_1.jpg", "caption": "Figure 2: Partial and final reward for an example. We generate N = 1000 responses via Llama-3-8B-Instruct and evaluate the partial rewards (at T = 256) and final rewards via Mistral-7B-RM. Blue line: the Ordinary Least Square fit. Red dot: the scores for the best response. Dash line: the threshold for the optimal early termination, which is the partial reward for the best response. Blue area: the confidence set for the OLS fit.", "description": "This figure shows the correlation between partial rewards (rewards calculated at a certain point during text generation, using 256 tokens) and final rewards (rewards of the completed text). The scatter plot shows that the partial rewards are positively correlated with the final rewards, supporting the idea that the quality of a response can be predicted early in the generation process.  The blue line represents an Ordinary Least Squares (OLS) regression fit to the data, illustrating the trend. The shaded blue region shows the confidence interval of the regression, and the red dot highlights the response with the highest final reward. The vertical red dashed line indicates a threshold based on the partial reward of the best response, suggesting a point where generations with lower partial scores could be safely stopped, thereby improving computational efficiency without losing the best responses.", "section": "4.1 Observation"}, {"figure_path": "348hfcprUs/figures/figures_15_1.jpg", "caption": "Figure 4: Pearson correlation (left) and Kendall\u2019s tau correlation coefficient (right) for the partial and final rewards. We randomly sample 100 prompts in the AlpacaFarm-Eval dataset. The responses are generated via Llama3-8b-Instruct and rewards are evaluated via Mistral-7B-RM.", "description": "This figure shows the Pearson and Kendall\u2019s Tau correlation coefficients between partial and final rewards for different decision token lengths.  The data is from 100 randomly sampled prompts from the AlpacaFarm-Eval dataset, with responses generated using Llama3-8b-Instruct and rewards evaluated using Mistral-7B-RM. The violin plots illustrate the distribution of correlation coefficients across prompts for each decision token length, showing the strength of the relationship between the early and final scores.", "section": "B Correlation between partial and final rewards"}]