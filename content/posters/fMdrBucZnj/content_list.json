[{"type": "text", "text": "Expected Probabilistic Hierarchies ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Marcel Kollovieh1,2,3 Bertrand Charpentier4 Daniel Z\u00fcgner5 Stephan G\u00fcnnemann1,2,3,4 ", "page_idx": 0}, {"type": "text", "text": "1 School of Computation, Information and Technology, Technical University of Munich 2 Munich Data Science Institute 3 Munich Center for Machine Learning 4 Pruna AI 5 Microsoft Research AI for Science ", "page_idx": 0}, {"type": "text", "text": "Correspondence to: m.kollovieh@tum.de ", "page_idx": 0}, {"type": "text", "text": "Abstract ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Hierarchical clustering has usually been addressed by discrete optimization using heuristics or continuous optimization of relaxed scores for hierarchies. In this work, we propose to optimize expected scores under a probabilistic model over hierarchies. (1) We show theoretically that the global optimal values of the expected Dasgupta cost and Tree-Sampling divergence (TSD), two unsupervised metrics for hierarchical clustering, are equal to the optimal values of their discrete counterparts contrary to some relaxed scores. (2) We propose Expected Probabilistic Hierarchies (EPH), a probabilistic model to learn hierarchies in data by optimizing expected scores. EPH uses differentiable hierarchy sampling enabling end-to-end gradient descent based optimization, and an unbiased subgraph sampling approach to scale to large datasets. (3) We evaluate EPH on synthetic and real-world datasets including vector and graph datasets. EPH outperforms all other approaches quantitatively and provides meaningful hierarchies in qualitative evaluations. ", "page_idx": 0}, {"type": "text", "text": "1 Introduction ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "A fundamental problem in unsupervised learning is clustering. Given a dataset, the task is to partition the instances into similar groups. While flat clustering algorithms such as $k$ -means group data points into disjoint groups, a hierarchical clustering divides the data recursively into smaller clusters, which yields several advantages over a flat one. Instead of only providing cluster assignments of the data points, it captures the clustering at multiple granularities, allowing the user to choose the desired level of fine and coarseness depending on the task. The hierarchical structure can be easily visualized in a dendrogram (e.g., see Fig. 4), making it easy to interpret and analyze. Hierarchical clustering finds applications in many areas, from personalized recommendation [39] and document clustering [35] to gene-expression [16] and phylogenetics [17]. Furthermore, the presence of hierarchical structures can be observed in many real-world graphs in nature and society [33]. ", "page_idx": 0}, {"type": "text", "text": "A first family of methods for hierarchical clustering are discrete approaches. They aim at optimizing some hierarchical clustering quality scores on a discrete search space, i.e.: ", "page_idx": 0}, {"type": "equation", "text": "$$\n\\operatorname*{max}_{\\hat{\\mathcal{T}}}{\\mathrm{score}(X,\\hat{\\mathcal{T}})}~{\\mathrm{s.t.}}{\\hat{\\mathcal{T}}}\\in\\mathrm{discrete}~{\\mathrm{hierarchies}},\n$$", "text_format": "latex", "page_idx": 0}, {"type": "text", "text": "where $\\mathbf{\\deltaX}$ denotes a given (vector or graph) dataset. Examples of score optimization could be the minimization of the discrete Dasgupta score [12], the minimization of the error sum of squares [37], the maximization of the discrete TSD [8], or the maximization of the modularity score [4]. Discrete approaches have two main limitations: the optimization search space of discrete hierarchies is large and constrained, which often makes the problem intractable without using heuristics, and the learning procedure is not differentiable and thus not amenable to gradient-based optimization, as done by most deep learning approaches. To mitigate these issues, a second, more recent family of continuous methods proposes to optimize some (soft-)scores on a continuous search space of relaxed hierarchies: ", "page_idx": 0}, {"type": "text", "text": "", "page_idx": 1}, {"type": "equation", "text": "$$\n\\operatorname*{max}_{\\mathcal{T}}\\operatorname{soft-score}(X,{\\mathcal{T}}){\\mathrm{~s.t.}}{\\mathcal{T}}\\in{\\mathrm{relaxed~hierarchies}}.\n$$", "text_format": "latex", "page_idx": 1}, {"type": "text", "text": "Examples are the relaxation of Dasgupta [7, 10, 41] or TSD scores [41]. A major drawback of continuous methods is that the optimal hierarchy of soft scores might not align with their discrete counterparts. ", "page_idx": 1}, {"type": "text", "text": "Contributions. In this work, we propose to optimize expected discrete scores, called Exp-Das and Exp-TSD, moving away from prior work on relaxed soft scores. In particular, our contributions can be summarized as follows: ", "page_idx": 1}, {"type": "text", "text": "\u2022 Theoretical contribution: We analyze the theoretical properties of both soft and expected scores. We show that the minimal value of a continuous relaxation can be different from that of the discrete Dasgupta cost while the optimal values of the expected scores are equal to their optimal discrete counterparts. \u2022 Model contribution: We propose a new method called Expected Probabilistic Hierarchies (EPH) to optimize Exp-Das and Exp-TSD. EPH provides an unbiased estimate of Exp-Das and Exp-TSD with biased gradients based on differentiable hierarchy sampling. By utilizing an unbiased subgraph sampling procedure, EPH scales to large (vector) datasets. \u2022 Experimental contribution: In quantitative experiments, we show that EPH outperforms other baselines on 20/24 cases on 16 datasets, including both graph and vector datasets. In qualitative experiments, we show that EPH provides meaningful hierarchies. ", "page_idx": 1}, {"type": "text", "text": "2 Related Work ", "text_level": 1, "page_idx": 1}, {"type": "text", "text": "Discrete Methods. We further differentiate between agglomerative (bottom-up) and divisive (top-down) discrete algorithms. Well-established agglomerative methods are the linkage algorithms that subsequently merge the two clusters with the lowest distance into a new cluster. There are several ways to define the similarity of two clusters. The average linkage (AL) method uses the average similarity, while single linkage (SL) and complete linkage (CL) use the minimum and maximum similarity between the groups, respectively [18]. Finally, the ward linkage (WL) algorithm [37] operates on Euclidean distances and merges the two clusters with the lowest increase in the sum of squares. In contrast, Bayesian Hierarchical Clustering [19] uses statistical hypothesis tests to decide which clusters to merge. Another agglomerative approach is the Louvain algorithm [4], which iteratively maximizes the modularity score. A more recent parallelized agglomerative graph-based approach, ParHAC, enables scaling to massive datasets. In terms of quality, however, ParHAC performs inferior to AL w.r.t. the Dasgupta cost [14]. Unlike agglomerative methods, divisive algorithms work in a top-down fashion. Initially, all leaves share the same cluster and are recursively divided into smaller ones using flat clustering algorithms. Famous examples are based on the $k$ -means algorithm [35] or use approximations of the sparsest cut [12]. ", "page_idx": 1}, {"type": "text", "text": "Continuous Methods. In recent years, many continuous algorithms have emerged to solve hierarchical clustering. These methods minimize continuous relaxations of the Dasgupta cost using gradient descent based optimizers. Monath et al. [27] optimized a probabilistic cost version. To parametrize the probabilities, they performed a softmax operation on learnable routing functions from each node on a fixed binary hierarchy. Chierchia and Perret [10] proposed UFit, a model operating in the ultrametric space. Furthermore, to optimize their model, they presented a soft-cardinal measure to compute a differentiable relaxed version of the Dasgupta cost. Other approaches operate on continuous representations in hyperbolic space, such as gHHC [28] and HypHC [7]. ", "page_idx": 1}, {"type": "text", "text": "Z\u00fcgner et al. [41] recently presented a flexible probabilistic hierarchy model (FPH). FPH directly parametrizes a probabilistic hierarchy and substitutes the discrete terms in the Dasgupta cost and Tree-Sampling Divergence with their probabilistic counterparts. This results in a differentiable objective function, which they optimize using projected gradient descent. ", "page_idx": 1}, {"type": "text", "text": "Differentiable Sampling Methods. Stochastic models with discrete random variables are difficult to train as the backpropagation algorithm requires all operations to be differentiable. To address this problem, estimators such as the Gumbel-Softmax [20] or Gumbel-Sinkhorn [26] are used to retain gradients when sampling discrete variables. These differentiable sampling methods have been used for several tasks, including DAG predictions [9], spanning trees or subset selection [30], and generating graphs [6]. In contrast to prior work, EPH enables optimizing the expected clustering scores under a probabilistic hierarchy by utilizing differentiable sampling. Note that sampling spanning trees is not applicable in our case since we have a restricted structure where the nodes of the graph correspond to the leaves of the tree. ", "page_idx": 1}, {"type": "text", "text": "", "page_idx": 2}, {"type": "text", "text": "3 Probabilistic Hierarchical Clustering ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "We consider a graph dataset. Let $\\mathcal{G}\\,=\\,(V,E)$ be a graph with $n$ vertices $V\\,=\\,\\{\\mathbf{v}_{1},\\dots,\\mathbf{v}_{n}\\}$ and $m$ edges $E=\\bar{\\{}\\mathbf{e}_{1},\\dots,\\mathbf{e}_{m}\\bigr\\}$ . Let $w_{i,j}$ denote the weight of the edge connecting the nodes $\\mathbf{v}_{i}$ and $\\mathbf{v}_{j}$ if $(i,j)\\in E$ , 0 otherwise, and $\\begin{array}{r}{\\boldsymbol{w}_{i}=\\sum_{j}w_{i,j}}\\end{array}$ the weight of the node $\\mathbf{v}_{i}$ . In general, we assume a directed graph, i.e., $w_{i,j}\\neq w_{j,i}$ . We  define the edge distribution $P(\\mathbf{v}_{i},\\mathbf{v}_{j})$ for pairs of nodes, $P(\\mathbf{v}_{i},\\mathbf{v}_{j})\\propto w_{i,j}$ , s.t. $\\begin{array}{r}{\\sum_{\\mathbf{v}_{i},\\mathbf{v}_{j}\\in V}\\bar{P}(\\mathbf{v}_{i},\\mathbf{v}_{j})=1}\\end{array}$ and equivalently the node distribution $\\bar{P}(\\mathbf{v}_{i})\\propto w_{i}$ , s.t. $\\textstyle\\sum_{\\mathrm{v}_{i}\\in V}{\\bar{P}}(\\mathbf{v}_{i})=1$ . W e can extend this representation to any vector dataset $\\mathcal{D}=\\left\\lbrace\\ensuremath{\\mathbf{x}}_{1},\\dots,\\ensuremath{\\mathbf{x}}_{n}\\right\\rbrace$ and interpret the dataset as a graph by using the data points $\\mathbf{X}_{i}$ as nodes and pairwise similarities (e.g., cosine similarities) as edge weights. ", "page_idx": 2}, {"type": "text", "text": "Discrete Hierarchical Clustering. We define a discrete hierarchical clustering $\\hat{\\mathcal{T}}$ of a graph $\\mathcal{G}$ as a rooted tree with $n$ leaves and $n^{\\prime}$ internal nodes. The leaves $V=\\{\\mathbf{v}_{1},\\mathbf{v}_{2},\\ldots,\\mathbf{v}_{n}\\}$ represent the nodes of $\\mathcal{G}$ , while the internal nodes $Z=\\{\\mathbf{z}_{1},\\mathbf{z}_{2},\\ldots,\\mathbf{z}_{n^{\\prime}}\\}$ represent clusters, with $\\mathbf{Z}_{n^{\\prime}}$ being the root node. Each internal node groups the data into disjoint sub-clusters, where edges reflect memberships of clusters. We can represent the hierarchy using two binary adjacency matrices $\\hat{A}\\in\\{0,1\\}^{n\\times n^{\\prime}}$ and $\\hat{B}\\in\\{0,1\\}^{n^{\\prime}\\times n^{\\prime}}$ , i.e., $\\hat{\\boldsymbol{\\mathcal{T}}}=(\\hat{A},\\hat{B})$ . While $\\hat{A}$ describes the edges from the leaves to the internal nodes, $\\hat{B}$ specifies the edges between the internal nodes. Since every node in\u2032 the hierarchy except the root\u2032 has exactly one outgoing edge, we\u2032 have the following constraints: $\\textstyle\\sum_{j}^{n^{\\prime}}{\\hat{A}}_{i,j}=1$ for $1\\leq i\\leq n$ , $\\textstyle\\sum_{\\hat{\\jmath}}^{n^{\\prime}}{\\hat{B}}_{i,j}=1$ for $1\\le i<n^{\\prime}$ , and $\\begin{array}{r}{\\sum_{j}^{n^{\\prime}}\\hat{B}_{n^{\\prime},j}=0}\\end{array}$ for the last row. Th us, except for the last row of $\\hat{B}$ , both matrices are row-stochastic. We denote the ancestors of $\\mathbf{V}$ as anc $({\\bf v})$ , and the lowest common ancestor (LCA) of the two leaves $\\mathbf{v}_{i}$ and $\\mathbf{v}_{j}$ in $\\hat{\\mathcal{T}}$ as $\\mathbf{v}_{i}\\wedge\\mathbf{v}_{j}$ . ", "page_idx": 2}, {"type": "text", "text": "Probabilistic Hierarchical Clustering. Z\u00fcgner et al. [41] recently proposed probabilistic hierarchies. The idea is to use a continuous relaxation of the binary adjacency matrices while keeping the rowstochasticity constraints. Thus, we end up with two matrices $\\dot{\\mathbf{A}}\\in[\\dot{0},1]^{n\\times n^{\\prime}}$ and $B\\in[0,\\bar{1}]^{\\bar{n^{\\prime}}\\times n^{\\prime}}$ . The entries represent parent probabilities, i.e., $A_{i,j}:=p(\\mathbf{z}_{j}\\mid\\mathbf{v}_{i})$ describes the probability of the internal node $\\mathbf{Z}_{j}$ being the parent of $\\mathbf{v}_{i}$ and $B_{i,j}:=p(\\mathbf{\\bar{z}}_{j}\\mid\\mathbf{z}_{i})$ the probability of the internal node $\\mathbf{Z}_{\\mathcal{j}}$ being the parent of $\\mathbf{Z}_{i}$ . Together, they define a probabilistic hierarchy $\\boldsymbol{\\mathcal{T}}=(A,B)$ . Given such a probabilistic hierarchy, one can easily obtain a discrete hierarchy by interpreting the corresponding rows of $\\pmb{A}$ and $_B$ as categorical distributions. We sample an outgoing edge for each leaf and internal node. Since $_B$ is restricted to be an upper triangular matrix, this tree-sampling procedure will result in a valid discrete hierarchy, denoted by $\\dot{\\mathcal{T}}=(\\hat{A},\\hat{B})\\sim P_{A,B}(\\mathcal{T})$ . Alternatively, instead of sampling a discrete hierarchy, one can take the most likely edge for each node. This can be efficiently done by selecting the entry with the highest probability in each row, resulting in the discrete matrices $\\hat{A}$ and $\\hat{B}$ . This approach serves as a greedy approximation to extract the most likely hierarchy from the probabilistic one. ", "page_idx": 2}, {"type": "text", "text": "4 Expected Probabilistic Hierarchical Clustering ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "4.1 Expected Metrics ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "Unlike flat clusterings, there has been a shortage of objective functions for hierarchical clusterings. Thus, many algorithms to derive hierarchies were developed without a precise objective. An objective function not only allows us to evaluate the quality of a hierarchy but also yields possibilities for optimization techniques. Recently, the two unsupervised functions Dasgupta cost (Das) [12] and Tree-Sampling Divergence (TSD) [8] were proposed, triggering the development of a new generation of hierarchical clustering algorithms. The Dasgupta cost is a well-established metric for graphs and vector data, while the TSD is a recent metric specifically tailored to graphs. In addition to being unsupervised, i.e., applicable in cases where the data is unlabeled, both metrics have intuitive motivations. The metrics can be written as: ", "page_idx": 2}, {"type": "equation", "text": "$$\n\\mathrm{Das}(\\hat{T})=\\sum_{\\mathbf{v}_{i},\\mathbf{v}_{j}\\in V}P(\\mathbf{v}_{i},\\mathbf{v}_{j})c(\\mathbf{v}_{i}\\wedge\\mathbf{v}_{j})\\qquad\\mathrm{and}\\qquad\\mathrm{TSD}(\\hat{T})=\\mathrm{KL}(p(\\mathbf{z})\\|q(\\mathbf{z})),\n$$", "text_format": "latex", "page_idx": 2}, {"type": "image", "img_path": "fMdrBucZnj/tmp/cfc158ef471a64e1379291ea31886946d35149054b1450966c9d99cb366915f4.jpg", "img_caption": ["Figure 1: Overview of our proposed EPH model. During training, EPH first samples discrete hierarchies using our differentiable hierarchy sampling (Sec. 4.3) and a subgraph using our subgraph sampling procedure (Sec. 4.4). The expected scores are then computed and averaged. Finally, the probabilistic hierarchy is updated via backpropagation. A formal description is given in App. C.7. "], "img_footnote": [], "page_idx": 3}, {"type": "text", "text": "where $c(\\mathbf{z})$ is the number of leaves whose ancestor is ${\\bf Z}$ , i.e., $\\begin{array}{r c l}{c(\\mathrm{z})}&{=}&{\\sum_{\\mathrm{v}_{i}\\in V}\\mathbf{1}_{[\\mathrm{z}\\in\\mathrm{anc(v_{i})}]}}\\end{array}$ , and $p(\\mathbf{z})$ and $q(\\mathbf{z})$ are two distributions induced by the edge and node distributions, i.e., $\\begin{array}{r}{p(\\mathbf{z})=\\sum_{\\mathbf{\\nu}_{i},\\mathbf{v}_{j}}\\mathbf{1}_{[\\mathbf{z}=\\mathbf{v_{i}}\\land\\mathbf{v_{j}}]}P(\\mathbf{v}_{i},\\mathbf{v}_{j})}\\end{array}$ and $\\begin{array}{r}{q(\\mathbf{z})=\\sum_{\\mathrm{v}_{i},\\mathrm{v}_{j}}\\mathbf{1}_{[\\mathrm{z}=\\mathrm{v}_{i}\\wedge\\mathrm{v}_{j}]}P(\\bar{\\mathrm{v}}_{i})P(\\mathrm{v}_{j})}\\end{array}$ . Dasgupta favors similar leaves t o have their lowest common ancestor  low in the hierarchy [12]. TSD quantifies the ability to reconstruct the graph from the hierarchy in terms of information loss [8]. Hence, any hierarchy achieving a good score provides a good compression of the original graph. In practice, both metrics are good indicators of meaningful hierarchies [12, 8, 7]. Recently, Z\u00fcgner et al. [41] proposed the Flexible Probabilistic Hierarchy (FPH) method. FPH substitutes the indicator functions with their corresponding probabilities under the tree-sampling procedure (see App. A.1), obtaining cost functions for probabilistic hierarchies called Soft-Das and Soft-TSD. These two metrics correspond to the scores of the expected hierarchies under the tree-sampling procedure. In contrast, we propose to optimize the expected metrics in this work. Intuitively, this corresponds to moving the expectation from inside the metric functions to outside, reflecting the natural way of performing Monte-Carlo approximation via (tree-) sampling. More specifically, our objectives are: ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\operatorname*{min}_{A,B}\\mathbb{E}_{\\hat{T}}\\big[\\mathrm{Das}(\\hat{T})\\big]\\textrm{s t}\\hat{T}\\sim P_{A,B}(T)\\quad\\textrm{a n d}\\quad\\operatorname*{max}_{A,B}\\mathbb{E}_{\\hat{T}}\\big[\\mathrm{TSD}(\\hat{T})\\big]\\textrm{s t}\\hat{T}\\sim P_{A,B}(T),\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "which we denote as Exp-Das and Exp-TSD. Note that we optimize over $\\pmb{A}$ and $_B$ , which parametrize a probabilistic hierarchy, while the edge weights are given by the dataset and used to compute the node and edge distribution. We show in Sec. 4.2 that the optimal values of the expected scores share the same intuitive meaning as their discrete counterparts. While the probabilities used in the FPH computation are consistent, their relaxed scores are not consistent with the expected scores under the tree-sampling procedure. In Fig. 2, we show a simple case where Soft-Das does not align with the global optimal value, whereas Exp-Das does. ", "page_idx": 3}, {"type": "text", "text": "Note that while the Dasgupta cost favors binary branches [12], EPH and the probabilistic hierarchies are not limited to these. While binary hierarchies offer fine-grained clustering, non-binary hierarchies provide more flexibility by allowing nodes to have more than two children, which often aligns better with real-world clustering tasks. ", "page_idx": 3}, {"type": "text", "text": "4.2 Theoretical Analysis of EPH and FPH ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "The main motivation to use the expected metrics is the property that their global optimal value, i.e., the score obtained by the globally optimal hierarchy (the optimizer), is equal to their discrete counterparts, as we show in Prop. 4.1. ", "page_idx": 3}, {"type": "image", "img_path": "fMdrBucZnj/tmp/dc49743d32b6e500207ac7c1e3767e1400eaffdac0c740ac466a72f471bfc11e.jpg", "img_caption": [], "img_footnote": [], "page_idx": 4}, {"type": "text", "text": "Figure 2: An example where FPH fails to infer a minimizing hierarchy. A hierarchy minimizing the Dasgupta cost and the inferred hierarchies by FPH and EPH on the unweighted $K_{4}$ graph, i.e., every normalized edge weight is equal to $\\frac{1}{6}$ . While FPH achieves a Dasgupta cost of 4.0 after discretization, the continuous hierarchy has a Soft-Das score below 3.0. On the other hand, EPH finds a minimizing hierarchy with a cost of $\\textstyle{\\frac{10}{3}}$ . A weighted example is shown in Fig. 8. ", "page_idx": 4}, {"type": "text", "text": "Proposition 4.1. Let $\\pmb{A}$ and $_B$ be transition matrices describing a probabilistic hierarchy. Then, the following equalities hold: ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\operatorname*{min}_{A,B}\\mathbb{E}_{\\hat{T}\\sim P_{A,B}(T)}\\left[\\mathrm{Das}(\\hat{T})\\right]=\\operatorname*{min}_{\\hat{T}}\\mathrm{Das}(\\hat{T})\\quad\\mathrm{and}\\quad\\operatorname*{max}_{A,B}\\mathbb{E}_{\\hat{T}\\sim P_{A,B}(T)}\\left[\\mathrm{TSD}(\\hat{T})\\right]=\\operatorname*{max}_{\\hat{T}}\\mathrm{TSD}(\\hat{T}).\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "(See proof in App. A.5) ", "page_idx": 4}, {"type": "text", "text": "Consequently, optimizing our cost function aims to find the optimal discrete hierarchy. Furthermore, we prove in Prop. 4.2 that Soft-Das is a lower bound of Exp-Das, therefore its minimum is a lower bound of the optimal discrete Dasgupta cost. ", "page_idx": 4}, {"type": "text", "text": "Proposition 4.2. Let A and $_B$ be transition matrices describing a probabilistic hierarchy. Then, Soft-Das will be lower than or equal to the expected Dasgupta cost under the tree-sampling procedure: ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\mathrm{Soft-Das}(\\mathcal{T})\\leq\\mathbb{E}_{\\hat{T}\\sim P_{A,B}(\\mathcal{T})}\\big[\\mathrm{Das}(\\hat{\\mathcal{T}})\\big].\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "(See proof in App. A.4) ", "page_idx": 4}, {"type": "text", "text": "In Fig. 2, we provide a specific example illustrating a case where the minimizer of Soft-Das is continuous, and FPH fails to find the optimal hierarchy, i.e., obtaining a minimal Dasgupta cost. We know an integral solution exists for EPH since Exp-Das and Exp-TSD are convex combinations of their discrete counterparts. Furthermore, Exp-Das is neither convex nor concave, as we show in App. A.6. In Tab. 1, we provide an overview of properties of the cost functions of FPH and EPH. ", "page_idx": 4}, {"type": "table", "img_path": "fMdrBucZnj/tmp/8c0a6eaebebf08b727c9e807743364d46689fe95e23a55c66af5e8930f42ae54.jpg", "table_caption": ["Table 1: Properties of Soft-Das, Exp-Das, Soft-TSD, and Exp-TSD. "], "table_footnote": [], "page_idx": 4}, {"type": "text", "text": "4.3 Unbiased Computation of Expected Scores via Differentiable Sampling ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "In order to compute the expected scores, one could attempt to use a closed-form expression. To derive these for Exp-Das and Exp-TSD, however, we would need to calculate the probability $p\\left(\\mathbf{z}=\\mathbf{v}_{i}\\land\\mathbf{v}_{j},\\mathbf{z}\\in\\operatorname{anc}(\\mathbf{v})\\right)$ for which no known solution exists, and the expectation of a logarithm, respectively (see Eq. 13 and Eq. 14). An alternative to the closed-form solution is to approximate the expectations via the Monte Carlo method. We propose to approximate Exp-Das and Exp-TSD with $N$ differentiably sampled hierarchies $\\{\\hat{\\mathcal{T}}^{(1)},...,\\hat{\\mathcal{T}}^{(N)}\\}$ (see \u201cLoss computation\u201d in Fig. 1): ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\mathrm{Exp-Score}({\\mathcal T})\\approx\\frac{1}{N}\\sum_{i=1}^{N}\\mathrm{Score}({\\hat{\\mathcal T}}^{(i)}).\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "However, differentiable sampling of discrete structures like hierarchies is often complex. To this end, our differentiable hierarchy sampling algorithm consists of three steps integrating the tree-sampling procedure and the straight-through Gumbel-Softmax estimator [20]: (1) We sample the parents of the leaf nodes by interpreting the columns of $\\pmb{A}$ as parameters of straight-through Gumbel-Softmax estimators. (2) We sample the parents of the internal nodes by interpreting the columns of $_B$ as parameters of straight-through Gumbel-Softmax estimators. This procedure is differentiable \u2014 each step is differentiable \u2014 and expressive \u2014 it can sample any hierarchy with $n$ leaves and $n^{\\prime}$ internal nodes. (3) We use the Monte Carlo method to approximate the expectation by computing the arithmetic mean of the scores of the sampled hierarchies. We reuse the differentiable computation of Soft-Das and Soft-TSD, which match the discrete scores for discrete hierarchies while providing gradients w.r.t. $\\pmb{A}$ and $_B$ (see Fig. 1 for an overview). ", "page_idx": 5}, {"type": "text", "text": "Complexity. Since we sample $N$ hierarchies from $n^{\\prime}+n-1$ many categorical distributions with $\\mathcal{O}(n^{\\prime})$ classes, the sampling process can be done with a complexity of $\\mathcal{O}(N^{\\ast}{\\times}n\\times n^{\\prime}\\!+\\!N\\times n^{\\prime2})$ . The dominating term is the computation of the Das and TSD scores with a complexity of $O(N\\times m\\times n^{\\prime2})$ for graph datasets and $O(N\\times n^{2}\\times n^{\\prime2})$ for vector datasets [41]. This is often efficient as we typically have $n^{\\prime}\\ll n$ and for graphs $m\\ll n^{2}$ . In Sec. 4.4, we propose a subgraph sampling approach to reduce the complexity to $\\mathcal{O}(N\\times M\\times n^{\\prime2}+n^{2})$ for large vector datasets, where $M<n^{2}$ . ", "page_idx": 5}, {"type": "text", "text": "4.4 Scalable Expected Dasgupta Cost Computation via Subgraph Sampling ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "As discussed in the complexity analysis, the limiting factor is ${\\mathcal{O}}(n^{2}\\times n^{\\prime2})$ , corresponding to the evaluation of the Dasgupta cost, which becomes prohibitive for large datasets. To reduce the complexity, we propose an unbiased subgraph sampling approach. First, we note that we can interpret the normalized similarities $P(\\mathbf{v}_{i},\\mathbf{v}_{j})$ as a probability mass function of a categorical distribution. This interpretation allows us to rewrite the Dasgupta cost as an expectation and approximate it via a sampling procedure. More specifically, ", "page_idx": 5}, {"type": "equation", "text": "$$\n\\mathrm{Das}(\\hat{\\mathcal{T}})=\\mathbb{E}_{(\\mathbf{v}_{i},\\mathbf{v}_{j})\\sim P(\\mathbf{v}_{i},\\mathbf{v}_{j})}\\left[c\\big(\\mathbf{v}_{i}\\wedge\\mathbf{v}_{j}\\big)\\right]\\approx\\frac{1}{M}\\sum_{k=1}^{M}c\\big(\\mathbf{v}_{i}^{(k)}\\wedge\\mathbf{v}_{j}^{(k)}\\big),\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "where $\\{(\\mathbf{v}_{i}^{(1)},\\mathbf{v}_{j}^{(1)}),\\dots,(\\mathbf{v}_{i}^{(M)},\\mathbf{v}_{j}^{(M)})\\}$ are $M$ edges sampled from the edge distribution $P(\\mathbf{v}_{i},\\mathbf{v}_{j})$ which can be done in $O(M+n^{2})$ [24]. We refer to this sampling approach as subgraph sampling (see Fig. 1). We can approximate the expected Dasgupta cost using the same procedure. In contrast to ExpDas, Exp-TSD cannot be easily viewed as an expectation of edges, thus making the approximation via subgraph sampling impractical. However, since TSD is a metric originally designed for graphs, which are generally sparse, it would yield little benefits. ", "page_idx": 5}, {"type": "text", "text": "Note that we end up with two different sampling procedures. First, we have the differentiable hierarchy sampling (see Eq. 7). This is necessary to approximate the expectations. Since we do not have a closed-form expression of Exp-Das and Exp-TSD, we sample discrete hierarchies from the probabilistic ones and average the scores. Secondly, we have the subgraph sampling (see Eq. 8), which interprets the Dasgupta cost as an expectation. This is done to reduce the computational overhead for vector datasets since the number of pairwise similarities grows quadratically in the number of data points. This estimation is unbiased and introduces an additional parameter, i.e., the number of sampled edges, which allows a trade-off between computational cost and quality. By inserting the probabilistic edge sampling approach into the tree sampling, we estimate Exp-Das to scale it to large vector datasets. An overview of our model is shown in Fig. 1, and a formal description is given in App. C.7. ", "page_idx": 5}, {"type": "text", "text": "In contrast to other approaches, the loss function of EPH is consistent with the discrete scores, meaning that probabilistic hierarchies with a better training score encode better discrete hierarchies. Following from Prop. 4.1, we know that any discrete hierarchy sampled from the optimal probabilistic hierarchy is an optimal discrete hierarchy. While global optimality is not guaranteed, the training loss provides a reliable indicator of the discrete evaluation performance since the loss functions, Exp-Das and Exp-TSD, are computed on discrete hierarchies. ", "page_idx": 5}, {"type": "text", "text": "5 Experiments ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "5.1 Experimental Setup ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "Datasets. We evaluate our method on both graph and vector datasets. Graph datasets: We use the datasets Polblogs [1], Brain [2], Citeseer [34], Genes [11], Cora-ML [25, 5], OpenFlight [29], WikiPhysics [3], and DBLP [38]. To preprocess the graph, we first collect the largest connected component. Secondly, every edge is made bidirectional and unweighted. An overview of the graphs is shown in Tab. 7 in App. B.1. Vector datasets: We test our method on vector data for the Dasgupta cost. Here, we selected the seven datasets Zoo, Iris, Glass, Digits, Segmentation, Spambase, and Letter from the UCI Machine Learning repository [15]. Furthermore, we also use Cifar-100 [23]. Digits and Cifar-100 are image datasets, the remaining are vector data. While we only flatten the images of Digits, we preprocess Cifar-100 using the ResNet-101 BiT-M-R101x1 by Kolesnikov et al. [22], which was pretrained on ImageNet-21k [13]. More specifically, we use the 2048 dimensional activations of the final layer for each image in Cifar-100 as feature vectors. Furthermore, we normalize all features to have a mean of zero and a standard deviation of one. We compute cosine similarities between all pairs of data points using their normalized features. This results in dense similarity matrices. Finally, we remove the self-loops. Note that in contrast to the graph datasets, the vector data similarities are weighted. An overview is shown in Tab. 8 in App. B.1. Since we are in an unsupervised setting, we have no train/test split, i.e., we train and evaluate on the whole graph. ", "page_idx": 6}, {"type": "text", "text": "Baselines. We compare our model against both discrete and continuous approaches. For discrete approaches, we use the single, average, complete [18], and ward linkage [37] algorithms, respectively referred to as SL, AL, CL, and WL. We do not report the results of SL and CL on the graph datasets that do not have edge weights since these methods are not applicable to unweighted graphs. In addition to the linkage algorithms, we also compare to the recursive sparsest cut (RSC) [12] and the Louvain method (Louv.) [4]. For continuous approaches, we use the gradient-based optimization approaches Ultrametric Fitting (UF) [10], Hyperbolical Hierarchical Clustering (HypHC) [7], gradient-based Hyperbolic Hierarchical Clustering $(\\mathbf{g}\\mathbf{H}\\mathbf{H}\\mathbf{C})$ [28], and Flexible Probabilistic Hierarchy (FPH) [41]. While the linkage algorithms derive a hierarchy based on heuristics or local objectives, UF, HypHC, $\\mathrm{gHHC}$ , and FPH aim to optimize a relaxed Dasgupta cost or TSD score. We set a time limit of 120 hours for all the methods and provided a budget of 512GB of memory for each experiment. ", "page_idx": 6}, {"type": "text", "text": "Practical Considerations. We repeat the randomized methods with five random seeds and report the best score of the discrete hierarchies. We use the same experimental setup as Z\u00fcgner et al. [41], i.e., we use $n^{\\prime}=512$ internal nodes, compress full hierarchies using the scheme presented by Charpentier and Bonald [8], and use DeepWalk embeddings [32] on the graphs for methods that require features. We train EPH using PAdamax (projected Adamax [21]), reduce the learning rate for $_B$ by a factor of 0.1 every 1000 epochs, and reset the probabilistic hierarchy to the so-far best discrete hierarchy. To approximate the expectation of EPH, we use 20 samples, except for Spambase, Letter, and Cifar-100, where we use 10, 1, and 1, respectively, to reduce the runtime. On the datase\u221ats Digits, Segmentation, Spambase, Letter, and Cifar-100, we train EPH and FPH by sampling $n{\\sqrt{n}}$ edges. For the remaining datasets and during all validation steps, we use the whole graph. Both EPH and FPH are initialized using the average linkage algorithm. We train FPH with its original setting and our proposed scheduler and report the minimum of both for each dataset. For the remaining methods, we use the recommended hyperparameters. An overview of the hyperparameters is shown in Tab. 10, and an ablation study in App. C.4. Finally, all methods are evaluated on discrete hierarchies. For EPH, we take the most likely edge for each node as explained in Sec. 3. ", "page_idx": 6}, {"type": "text", "text": "5.2 Results ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "Graph Dataset Results. We report the discrete Dasgupta costs and TSD scores for the graph datasets in Tab. 2. EPH achieves best scores across 13/16 settings and second-best otherwise. In particular, EPH, which optimizes Exp-Das, consistently achieves a better Dasgupta cost than FPH, which optimizes Soft-Das. This observation aligns with the theoretical advantages of Exp-Das compared to Soft-Das (see Sec. 4.2). EPH and FPH, which both use the tree-sampling probabilistic framework, consistently achieve the best results. This underscores the effectiveness of tree sampling for hierarchical clustering. ", "page_idx": 6}, {"type": "image", "img_path": "fMdrBucZnj/tmp/278a564bae84b97255f629d7abc2527668e58226196e9b00f2f80aa38d9500bc.jpg", "img_caption": ["Figure 3: Hyperparameter study. Normalized Dasgupta costs for different numbers of sampled hierarchies (left) and different number of sampled edges (right) after the EPH training, including the average linkage algorithm (AL) and a training on the full graph (FG). The scores are normalized such that each dataset has a mean of zero and a standard deviation of one. "], "img_footnote": [], "page_idx": 7}, {"type": "table", "img_path": "fMdrBucZnj/tmp/5f0999753c45125259d8012e1ae13560a5669f1f1a2fad65c62f9127bee9eb27.jpg", "table_caption": ["Table 2: Results for the graph datasets. Best scores in bold, second best underlined. "], "table_footnote": [], "page_idx": 7}, {"type": "text", "text": "Furthermore, the performance of the discrete approaches, i.e., the linkage algorithms WL and AL, the Louvain method, and RSC, is competitive with the other continuous methods, even though they use heuristics or local objectives to infer the hierarchies. The inferior performance of gHHC and HypHC can be intuitively explained by the fact that these methods were originally designed for vector datasets. WL, UF, and HypHC could not scale to DBLP within the memory budget, as they require the computation of a dense $n^{2}$ similarity matrix, leading to out-of-memory (OOM) issues. ", "page_idx": 7}, {"type": "text", "text": "Vector Dataset Results. We report the discrete Dasgupta costs of several methods on the vector datasets in Tab. 3. Consistent with the results on the graph datasets, EPH outperforms all baselines and achieves the best scores across 7/8 datasets. These results demonstrate the capacity of EPH to not only cluster graphs but also adapt to vector datasets. Further, EPH consistently outperforms FPH, ", "page_idx": 7}, {"type": "table", "img_path": "fMdrBucZnj/tmp/2b3b1c0e9ef4e607f9cab1e9ec6603fff5f1a3873b898de1381105d7d58b22db.jpg", "table_caption": ["Table 3: Dasgupta costs (\u2193) for the vector datasets. Best scores in bold, second best underlined. "], "table_footnote": [], "page_idx": 7}, {"type": "text", "text": "again emphasizing the benefti of optimizing expected scores over soft scores. In contrast with graph datasets, HypHC performs competitively on vector datasets. This is reasonable since this method was originally designed for vector datasets. FPH performs slightly worse than HypHC on most datasets and is only better on Iris. ", "page_idx": 7}, {"type": "text", "text": "Hyperparameter Study. We show in Fig. 3 (left) the effect of the number of sampled hierarchies on the EPH performances. On the one hand, we observe that a large number of sampled hierarchies (i.e., $N\\,\\geq\\,20\\,\\$ ) generally yields better results than a small number of sampled hierarchies (i.e., $N\\,\\leq\\,10\\,,$ ) except for Citeseer. Intuitively, a higher number of sampled hierarchies should lead to a more accurate expected score approximation. On the other hand, a very large number for sampled hierarchies (i.e., $N\\ge100]$ ) might not lead to significant improvements while requiring more computational resources. Intuitively, the randomness induced by a lower number of sampled hierarchies could be beneficial to escape local optima. In general, we found that 20 samples led to satisfactory results for all datasets, thus achieving a good trade-off between approximation accuracy, optimization noise, and computational requirements. ", "page_idx": 7}, {"type": "image", "img_path": "fMdrBucZnj/tmp/8f854b07a77c3fc532fdaf0e71f4afb411da468d5e6dd805d5afac452033b22d.jpg", "img_caption": ["Figure 4: Ground truth clusters and dendrograms compared to the inferred ones for the HSBMs. "], "img_footnote": [], "page_idx": 8}, {"type": "table", "img_path": "fMdrBucZnj/tmp/29b5ab6a2ecb781a33d05bdd906f70b550dc265951829ca8e4c26d97ab771842.jpg", "table_caption": ["Table 4: Results of EPH for the HSBMs with $n^{\\prime}=\\#$ Cluster. "], "table_footnote": [], "page_idx": 8}, {"type": "text", "text": "We show in Fig. 3 (right) the effect of the number of sampled edges on the EPH performances on ve\u221actor datasets. Using more edges consistently leads to better results. In \u221aparticular, going from $n$ to $n{\\sqrt{n}}$ shows a significant performance improvement while going from $n{\\bar{\\sqrt{n}}}$ to $n^{2}$ yields only minor improvements. Hence, controlling the amount of sampled edges allows us to scale our method to large datasets while maintaining high performance. On the s\u221amall datasets $Z_{00}$ , Iris, and Glass, we use the whole graph, while for the other datasets, we sample $n{\\sqrt{n}}$ edges as a trade-off between runtime and quality of the hierarchical clustering. We provide further experiments in Sec. C.4, including a minimized version of EPH outperforming FPH in terms of runtime and results. ", "page_idx": 8}, {"type": "text", "text": "External Evaluation. As the Dasgupta cost and Tree-Sampling Divergence are internal metrics and do not necessarily measure how closely a derived hierarchy aligns with an external ground truth, we complement our unsupervised quantitative evaluation with an external evaluation. Given that ground-truth hierarchies are typically unavailable in real-world data, we evaluate EPH on synthetic graph datasets with known ground-truth hierarchies. Additionally, we analyze to what extent the inferred hierarchies preserve the flat class labels for the vector datasets in Sec. C.3 in the appendix. ", "page_idx": 8}, {"type": "table", "img_path": "fMdrBucZnj/tmp/bf2a364196b8a7683387c2d12fddbce20ecf3e1efbc1f859f595f759eefe3376.jpg", "table_caption": ["Table 5: Cophenetic correlations $(\\uparrow)$ of EPH for different distances on the HSBMs with $n^{\\prime}=\\#\\mathfrak{\\epsilon}$ Cluster. ", "Cophenetic Correlation (\u2191) "], "table_footnote": [], "page_idx": 8}, {"type": "text", "text": "We augment the graph datasets with two hierarchical stochastic block models (HSBMs), which enables us to compare the inferred hierarchy with the ground truth. As the HSBM graphs are generated in a stochastic process, the ground-truth hierarchy is not necessarily optimal in terms of the Dasgupta cost or Tree-Sampling ", "page_idx": 8}, {"type": "text", "text": "Divergence. Furthermore, we compute the normalized mutual information (NMI) across the different levels of the hierarchies, and the cophenetic correlations for the shortest path distance (SPD) and the Euclidean distance of DeepWalk embeddings (see Tab. 4 and Tab. 5). We observe that EPH recovers the first three levels of the ground-truth hierarchy almost perfectly. Moreover, the inferred hierarchies by EPH obtain even better scores than the ground-truth hierarchies on the HSBMs, underlining the remarkable capacity of EPH to optimize the Dasgupta and TSD scores. Additionally, the TSD objective proves to be a more suitable metric for recovering the ground-truth levels of the HSBM in terms of NMI. The cophenetic correlations observed between Exp-Das and Exp-TSD are notably high and closely align with the ground truth, with Exp-TSD even surpassing the ground truth on DeepWalk distances. We attribute this to the fact that a minimal Dasgupta cost favors binary branches, which does not reflect the hierarchies of the HSBMs. Our visual analysis of the graphs and hierarchies (see Fig. 4) confirms this observation. Additional results for FPH are provided in App. C.1. ", "page_idx": 8}, {"type": "text", "text": "", "page_idx": 9}, {"type": "text", "text": "Qualitative Evaluation. We visualize the largest cluster inferred on Cifar-100 using EPH. More specifically, we select the internal nodes with the most directly connected leaves. Additionally, we sort the images by their probability, i.e., their entry in the matrix A. We show the 16 images with the highest probability and the 16 with the lowest probability for the largest cluster in Fig. 5. We observe that the images with high probabilities are all similar and related to insects. This shows that EPH is ", "page_idx": 9}, {"type": "image", "img_path": "fMdrBucZnj/tmp/393bb3db8ff5ad87a90b58d06e043fb473054f94a99ff34c64db2884c6f05088.jpg", "img_caption": [], "img_footnote": [], "page_idx": 9}, {"type": "text", "text": "able to group similar images together. In contrast, the last images with the lowest probability do not fti into the group. This demonstrates the capacity of EPH to measure the uncertainty in the cluster assignments. We provide additional results with the same behavior for other clusters in App. C.2 (see Fig. 9, Fig. 10, and Fig. 11). Furthermore, we visualize the graph and inferred hierarchies of EPH for OpenFlight in Fig. 12 in the appendix. Both minimizing Exp-Das and Exp-TSD generate reasonable clusters and successfully distinguish different world regions. Finally, we visualize the ground truth classes and clusters of selected vector datasets in Fig. 13. ", "page_idx": 9}, {"type": "text", "text": "6 Discussion ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "Limitations. While the Gumbel-Softmax estimators of the expectations are unbiased in the forward pass, the estimation of the gradients is not [31] and thus impacts the EPH optimization. Furthermore, even though the global optimal values of the expected and discrete scores match, EPH does not guarantee convergence into a global optimum when optimizing using gradient descent methods. ", "page_idx": 9}, {"type": "text", "text": "Conclusion. In this work, we propose EPH, a novel end-to-end learnable approach to infer hierarchies in data. EPH operates on probabilistic hierarchies and directly optimizes the expected Dasgupta cost and Tree-Sampling Divergence using differentiable hierarchy sampling. We show that the global optima of the expected scores are equal to their discrete counterparts. Furthermore, we present an unbiased subgraph sampling approach to scale EPH to large datasets. We demonstrate the capacity of our model by evaluating it on several synthetic and real-world datasets. EPH outperforms traditional and recent state-of-the-art baselines. ", "page_idx": 9}, {"type": "text", "text": "References ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "[1] Lada A Adamic and Natalie Glance. The political blogosphere and the 2004 us election: divided they blog. In Proceedings of the 3rd international workshop on Link discovery, pages 36\u201343, 2005.   \n[2] Katrin Amunts, Claude Lepage, Louis Borgeat, Hartmut Mohlberg, Timo Dickscheid, Marc\u00c9tienne Rousseau, Sebastian Bludau, Pierre-Louis Bazin, Lindsay B Lewis, Ana-Maria OrosPeusquens, et al. Bigbrain: an ultrahigh-resolution 3d human brain model. Science, 340(6139): 1472\u20131475, 2013.   \n[3] Nicolas Aspert, Volodymyr Miz, Benjamin Ricaud, and Pierre Vandergheynst. A graphstructured dataset for wikipedia research. In Companion Proceedings of The 2019 World Wide Web Conference, pages 1188\u20131193, 2019.   \n[4] Vincent D Blondel, Jean-Loup Guillaume, Renaud Lambiotte, and Etienne Lefebvre. Fast unfolding of communities in large networks. Journal of statistical mechanics: theory and experiment, 2008(10):P10008, 2008.   \n[5] Aleksandar Bojchevski and Stephan G\u00fcnnemann. Bayesian robust attributed graph clustering: Joint learning of partial anomalies and group structure. In Proceedings of the AAAI Conference on Artificial Intelligence, volume 32, 2018.   \n[6] Aleksandar Bojchevski, Oleksandr Shchur, Daniel Z\u00fcgner, and Stephan G\u00fcnnemann. Netgan: Generating graphs via random walks. In International conference on machine learning, pages 610\u2013619. PMLR, 2018.   \n[7] Ines Chami, Albert Gu, Vaggos Chatziafratis, and Christopher R\u00e9. From trees to continuous embeddings and back: Hyperbolic hierarchical clustering. Advances in Neural Information Processing Systems, 33:15065\u201315076, 2020.   \n[8] Bertrand Charpentier and Thomas Bonald. Tree sampling divergence: an information-theoretic metric for hierarchical graph clustering. In IJCAI-19, 2019.   \n[9] Bertrand Charpentier, Simon Kibler, and Stephan G\u00fcnnemann. Differentiable dag sampling. arXiv preprint arXiv:2203.08509, 2022.   \n[10] Giovanni Chierchia and Benjamin Perret. Ultrametric ftiting by gradient descent. Advances in neural information processing systems, 32, 2019.   \n[11] Ara Cho, Junha Shin, Sohyun Hwang, Chanyoung Kim, Hongseok Shim, Hyojin Kim, Hanhae Kim, and Insuk Lee. Wormnet v3: a network-assisted hypothesis-generating server for caenorhabditis elegans. Nucleic acids research, 42(W1):W76\u2013W82, 2014.   \n[12] Sanjoy Dasgupta. A cost function for similarity-based hierarchical clustering. In Proceedings of the forty-eighth annual ACM symposium on Theory of Computing, pages 118\u2013127, 2016.   \n[13] Jia Deng, Wei Dong, Richard Socher, Li-Jia Li, Kai Li, and Li Fei-Fei. Imagenet: A largescale hierarchical image database. In 2009 IEEE conference on computer vision and pattern recognition, pages 248\u2013255. Ieee, 2009.   \n[14] Laxman Dhulipala, David Eisenstat, Jakub Lacki, Vahab Mirrokni, and Jessica Shi. Hierarchical agglomerative graph clustering in poly-logarithmic depth. Advances in Neural Information Processing Systems, 35:22925\u201322940, 2022.   \n[15] Dheeru Dua and Casey Graff. UCI machine learning repository, 2017. URL http://archive. ics.uci.edu/ml.   \n[16] Michael B Eisen, Paul T Spellman, Patrick O Brown, and David Botstein. Cluster analysis and display of genome-wide expression patterns. Proceedings of the National Academy of Sciences, 95(25):14863\u201314868, 1998.   \n[17] Joseph Felsenstein. Inferring phylogenies, volume 2. Sinauer associates Sunderland, MA, 2004.   \n[18] Trevor Hastie, Robert Tibshirani, Jerome H Friedman, and Jerome H Friedman. The elements of statistical learning: data mining, inference, and prediction, volume 2. Springer, 2009.   \n[19] Katherine A Heller and Zoubin Ghahramani. Bayesian hierarchical clustering. In Proceedings of the 22nd international conference on Machine learning, pages 297\u2013304, 2005.   \n[20] Eric Jang, Shixiang Gu, and Ben Poole. Categorical reparameterization with gumbel-softmax. arXiv preprint arXiv:1611.01144, 2016.   \n[21] Diederik P Kingma and Jimmy Ba. Adam: A method for stochastic optimization. arXiv preprint arXiv:1412.6980, 2014.   \n[22] Alexander Kolesnikov, Lucas Beyer, Xiaohua Zhai, Joan Puigcerver, Jessica Yung, Sylvain Gelly, and Neil Houlsby. Big transfer (bit): General visual representation learning. In European conference on computer vision, pages 491\u2013507. Springer, 2020.   \n[23] Alex Krizhevsky, Geoffrey Hinton, et al. Learning multiple layers of features from tiny images. 2009.   \n[24] Richard A. Kronmal and Arthur V. Peterson. On the alias method for generating random variables from a discrete distribution. The American Statistician, 33(4):214\u2013218, 2022/09/29/ 1979. ISSN 00031305. doi: 10.2307/2683739. Full publication date: Nov., 1979. ", "page_idx": 9}, {"type": "text", "text": "", "page_idx": 10}, {"type": "text", "text": "[26] Gonzalo Mena, David Belanger, Scott Linderman, and Jasper Snoek. Learning latent permutations with gumbel-sinkhorn networks. arXiv preprint arXiv:1802.08665, 2018. ", "page_idx": 11}, {"type": "text", "text": "[27] Nicholas Monath, Ari Kobren, Akshay Krishnamurthy, and Andrew McCallum. Gradient-based hierarchical clustering. In 31st Conference on neural information processing systems (NIPS 2017), Long Beach, CA, USA, 2017. ", "page_idx": 11}, {"type": "text", "text": "[28] Nicholas Monath, Manzil Zaheer, Daniel Silva, Andrew McCallum, and Amr Ahmed. Gradientbased hierarchical clustering using continuous representations of trees in hyperbolic space. In Proceedings of the 25th ACM SIGKDD International Conference on Knowledge Discovery & Data Mining, pages 714\u2013722, 2019. ", "page_idx": 11}, {"type": "text", "text": "[29] Jani Patokallio. Openflights. URL https://openflights.org/. ", "page_idx": 11}, {"type": "text", "text": "[30] Max Paulus, Dami Choi, Daniel Tarlow, Andreas Krause, and Chris J Maddison. Gradient estimation with stochastic softmax tricks. Advances in Neural Information Processing Systems, 33:5691\u20135704, 2020.   \n[31] Max B Paulus, Chris J. Maddison, and Andreas Krause. Rao-blackwellizing the straight-through gumbel-softmax gradient estimator. In International Conference on Learning Representations, 2021.   \n[32] Bryan Perozzi, Rami Al-Rfou, and Steven Skiena. Deepwalk: Online learning of social representations. In Proceedings of the 20th ACM SIGKDD international conference on Knowledge discovery and data mining, pages 701\u2013710, 2014.   \n[33] Erzs\u00e9bet Ravasz and Albert-L\u00e1szl\u00f3 Barab\u00e1si. Hierarchical organization in complex networks. Physical review E, 67(2):026112, 2003.   \n[34] Prithviraj Sen, Galileo Namata, Mustafa Bilgic, Lise Getoor, Brian Galligher, and Tina EliassiRad. Collective classification in network data. AI magazine, 29(3):93\u201393, 2008.   \n[35] Michael Steinbach, George Karypis, and Vipin Kumar. A comparison of document clustering techniques. 2000.   \n[36] Laurens Van der Maaten and Geoffrey Hinton. Visualizing data using t-sne. Journal of machine learning research, 9(11), 2008.   \n[37] Joe H Ward Jr. Hierarchical grouping to optimize an objective function. Journal of the American statistical association, 58(301):236\u2013244, 1963.   \n[38] Jaewon Yang and Jure Leskovec. Defining and evaluating network communities based on ground-truth. Knowledge and Information Systems, 42(1):181\u2013213, 2015.   \n[39] Yuchen Zhang, Amr Ahmed, Vanja Josifovski, and Alexander Smola. Taxonomy discovery for personalized recommendation. In Proceedings of the 7th ACM international conference on Web search and data mining, pages 243\u2013252, 2014.   \n[40] Sheng Zhou, Hongjia Xu, Zhuonan Zheng, Jiawei Chen, Jiajun Bu, Jia Wu, Xin Wang, Wenwu Zhu, Martin Ester, et al. A comprehensive survey on deep clustering: Taxonomy, challenges, and future directions. arXiv preprint arXiv:2206.07579, 2022.   \n[41] Daniel Z\u00fcgner, Bertrand Charpentier, Morgane Ayle, Sascha Geringer, and Stephan G\u00fcnnemann. End-to-end learning of probabilistic hierarchies on graphs. In International Conference on Learning Representations, 2022. ", "page_idx": 11}, {"type": "text", "text": "A Appendix ", "text_level": 1, "page_idx": 12}, {"type": "text", "text": "A.1 Equations of Soft-Das and Soft-TSD ", "text_level": 1, "page_idx": 12}, {"type": "text", "text": "In the following, we show the equations of Soft-Das and Soft-TSD. ", "page_idx": 12}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathrm{Soft.}\\mathrm{Das}(\\mathcal{T})=\\displaystyle\\sum_{\\mathrm{v_{i},v_{j}\\in V}}P(\\mathrm{v}_{i},\\mathrm{v}_{j})\\sum_{z\\in\\mathcal{Z}}\\sum_{v\\in V}p\\left(z=\\mathrm{v}_{i}\\wedge\\mathrm{v}_{j}\\right)p\\left(z\\in\\mathrm{anc}(\\mathrm{v})\\right)}\\\\ &{\\mathrm{Soft.}\\mathrm{TSD}(\\mathcal{T})=\\displaystyle\\sum_{z\\in\\mathcal{Z}}p(z)\\log\\frac{p(z)}{q(z)}}\\\\ &{\\quad\\mathrm{where}\\ p(z)=\\displaystyle\\sum_{\\mathrm{v_{i},v_{j}\\in V}}P(\\mathrm{v}_{i},\\mathrm{v}_{j})p\\left(\\mathrm{z}=\\mathrm{v}_{i}\\wedge\\mathrm{v}_{j}\\right)}\\\\ &{\\quad\\quad\\quad q(z)=\\displaystyle\\sum_{\\mathrm{v_{i},v_{j}\\in V}}P(\\mathrm{v}_{i})P(\\mathrm{v}_{j})p\\left(\\mathrm{z}=\\mathrm{v}_{i}\\wedge\\mathrm{v}_{j}\\right)}\\end{array}\n$$", "text_format": "latex", "page_idx": 12}, {"type": "text", "text": "A.2 Closed Form Solutions of Exp-Das and Exp-TSD ", "text_level": 1, "page_idx": 12}, {"type": "text", "text": "To compute closed-form solutions of the expectations, the following equations need to be solved: ", "page_idx": 12}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathrm{Exp-Das}(\\mathcal{T})=\\displaystyle\\sum_{\\mathbf{v}_{i},\\mathbf{v}_{j}\\in V}P(\\mathbf{v}_{i},\\mathbf{v}_{j})\\sum_{z\\in Z}\\sum_{v\\in V}p\\left(\\mathbf{z}=\\mathbf{v}_{i}\\wedge\\mathbf{v}_{j},\\mathbf{z}\\in\\mathrm{anc}(\\mathbf{v})\\right)}\\\\ &{\\mathrm{Exp-TSD}(\\mathcal{T})=\\displaystyle\\sum_{z\\in Z}\\mathbb{E}_{\\hat{T}\\sim P_{A,B}(\\mathcal{T}=(A,B))}\\left[p(\\mathbf{z})\\log\\frac{p(\\mathbf{z})}{q(\\mathbf{z})}\\right].}\\end{array}\n$$", "text_format": "latex", "page_idx": 12}, {"type": "text", "text": "A.3 Relation between Joint and Independent LCA and Ancestor Probabilities ", "text_level": 1, "page_idx": 12}, {"type": "text", "text": "While the LCA probabilities are crucial to compute Soft-Das, Exp-Das requires the joint LCA and ancestor probabilities, i.e., $p(\\mathbf{z}_{k}=\\mathbf{v}_{i}\\land\\mathbf{v}_{j},\\mathbf{v}\\in\\operatorname{anc}(\\mathbf{z}_{k}))$ , for the leaves $\\mathbf{v}_{i}$ , $\\mathbf{v}_{j}$ and $\\mathbf{V}$ and the internal node ${\\mathbf{Z}}_{k}$ . In Prop. A.1, we show that the joint probabilities are an upper bound of the product of the single terms. ", "page_idx": 12}, {"type": "image", "img_path": "fMdrBucZnj/tmp/28ff86b518a8cba05420c8685eb4d1e58eaf2e1b52a1f0f17137e20c3de7d0d6.jpg", "img_caption": [], "img_footnote": [], "page_idx": 12}, {"type": "text", "text": "Figure 6: The different cases of the event $p\\left(\\mathbf{z}_{k}=\\mathbf{v}_{1}\\land\\mathbf{v}_{2}\\mid\\mathbf{z}_{k}\\in\\operatorname{anc}(\\mathbf{v})\\right)$ . While the LCA of $\\mathbf{v}_{1}$ and $\\mathbf{V}_{2}$ is $\\mathbf{Z}_{k}$ in every case, the LCA of $\\mathbf{V}_{1}$ and $\\mathbf{V}$ and the LCA of $\\mathbf{V}_{2}$ and $\\mathbf{V}$ are different. We have three cases: either the paths from $\\mathbf{V}_{1}$ or $\\mathbf{V}_{2}$ and v meet before $\\mathbf{Z}_{k}$ at node $\\mathbf{Z}_{k^{\\prime}}$ (shown in (a) and (b)), or all paths meet for the first time at ${\\mathbf{Z}}_{k}$ (shown in fig. (c)). ", "page_idx": 12}, {"type": "text", "text": "Proposition A.1. Let p describe the probability under the tree-sampling procedure, $\\mathbf{Z}_{k}$ an internal node, $\\mathbf{v}_{1},\\;\\mathbf{v}_{2}$ , and v leaves. Then, the following inequality holds: ", "page_idx": 12}, {"type": "equation", "text": "$$\np(\\mathbf{z}_{k}=\\mathbf{v}_{1}\\land\\mathbf{v}_{2})p(\\mathbf{z}_{k}\\in\\operatorname{anc}(\\mathbf{v}))\\leq p\\left(\\mathbf{z}_{k}=\\mathbf{v}_{1}\\land\\mathbf{v}_{2},\\mathbf{z}_{k}\\in\\operatorname{anc}(\\mathbf{v})\\right)\n$$", "text_format": "latex", "page_idx": 12}, {"type": "text", "text": "Proof. First, we observe that the right-hand side of the inequality can be rewritten as: ", "page_idx": 12}, {"type": "equation", "text": "$$\n\\begin{array}{r}{p\\left(\\mathbf{z}_{k}=\\mathbf{v}_{1}\\wedge\\mathbf{v}_{2},\\mathbf{z}_{k}\\in\\operatorname{anc}(\\mathbf{v})\\right)=p\\left(\\mathbf{z}_{k}=\\mathbf{v}_{1}\\wedge\\mathbf{v}_{2}\\mid\\mathbf{z}_{k}\\in\\operatorname{anc}(\\mathbf{v})\\right)p\\big(\\mathbf{z}_{k}\\in\\operatorname{anc}(\\mathbf{v})\\big).}\\end{array}\n$$", "text_format": "latex", "page_idx": 12}, {"type": "text", "text": "To prove the non-trivial case $p\\left(\\mathbf{z}_{k}\\in\\operatorname{anc}(\\mathbf{v})\\right)\\neq0$ , we need to show that the following holds: ", "page_idx": 13}, {"type": "equation", "text": "$$\np\\left(\\mathbf{z}_{k}=\\mathbf{v}_{1}\\land\\mathbf{v}_{2}\\right)\\leq p\\left(\\mathbf{z}_{k}=\\mathbf{v}_{1}\\land\\mathbf{v}_{2}\\mid\\mathbf{z}_{k}\\in\\operatorname{anc}(\\mathbf{v})\\right).\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "Let $r_{\\mathrm{v}_{i}}^{\\mathrm{z}_{j}}=(\\mathrm{v}_{i},\\ldots,z_{j})$ denote a path from a leaf $\\mathbf{v}_{i}$ to an internal node $\\mathbf{Z}_{\\mathcal{j}}$ and let $\\mathbf{Z}_{n^{\\prime}}$ be the root node. Recalling from [41] that the paired path probability under the tree-sampling procedure is ", "page_idx": 13}, {"type": "equation", "text": "$$\np((r_{\\mathrm{v}_{1}}^{\\mathrm{z}_{n^{\\prime}}},r_{\\mathrm{v}_{2}}^{\\mathrm{z}_{n^{\\prime}}}))=p(r_{\\mathrm{v}_{1}}^{\\mathrm{z}_{k}})p(r_{\\mathrm{v}_{2}}^{\\mathrm{z}_{k}})p(r_{\\mathrm{z}_{k}}^{\\mathrm{z}_{n^{\\prime}}}),\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "with $\\mathbf{z}_{k}=\\mathbf{v}_{1}\\wedge\\mathbf{v}_{2}$ , we can rewrite the LCA probabilities as ", "page_idx": 13}, {"type": "equation", "text": "$$\np\\left(\\mathbf{z}_{k}=\\mathbf{v}_{1}\\wedge\\mathbf{v}_{2}\\right)=\\sum_{(r_{\\mathrm{v}_{1}}^{\\mathrm{z}_{k}},r_{\\mathrm{v}_{2}}^{\\mathrm{z}_{k}}):\\mathbf{z}_{k}=\\mathbf{v}_{1}\\wedge\\mathbf{v}_{2}}p(r_{\\mathrm{v}_{1}}^{\\mathrm{z}_{k}})p(r_{\\mathrm{v}_{2}}^{\\mathrm{z}_{k}}).\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "Adding the condition $\\mathbf{z}_{k}\\in\\mathrm{anc}(\\mathbf{v})$ means there exists a path from the leaf v to the internal node ${\\mathbf{Z}}_{k}$ . There are three different cases: first, the path meets $r_{\\mathrm{v_{1}}}^{\\mathrm{z}_{k}}$ and $r_{\\mathrm{v_{2}}}^{\\mathrm{z}_{k}}$ at ${\\mathbf{Z}}_{k}$ for the first time, or the path meets the path $r_{\\mathrm{v_{1}}}^{\\mathrm{z}_{k}}$ or $r_{\\mathrm{v_{2}}}^{\\mathrm{z}_{k}}$ in a lower node $\\mathbf{Z}_{k^{\\prime}}$ , with $k^{\\prime}<k$ . The cases are shown in Fig. 6. In the first case, all three paths are independent. Thus, the LCA probabilities do not change. In the other two cases, they are only independent up to the node $\\mathbf{Z}_{k^{\\prime}}$ . The probability for the path $r_{z_{k^{\\prime}}}^{z_{k}}$ is equal to 1 since we know that $\\mathbf{Z}_{k}\\in$ anc(v). More formally, the conditional probability is ", "page_idx": 13}, {"type": "equation", "text": "$$\np\\left(\\mathbf{z}_{k}=\\mathbf{v}_{1}\\wedge\\mathbf{v}_{2}\\;|\\;\\mathbf{z}_{k}\\in\\operatorname{anc}(\\mathbf{v})\\right)=\\sum_{(r_{{\\mathrm{v}_{1}}}^{z_{k}},r_{{\\mathrm{v}_{2}}}^{z_{k}}):z_{k}=\\mathbf{v}_{1}\\wedge\\mathbf{v}_{2}}p(r_{{\\mathrm{v}_{1}}}^{z_{k}}\\;|\\;\\mathbf{z}_{k}\\in\\operatorname{anc}(\\mathbf{v}))p(r_{{\\mathrm{v}_{2}}}^{z_{k}}\\;|\\;\\mathbf{z}_{k}\\in\\operatorname{anc}(\\mathbf{v})).\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "Assuming that the path from $\\mathbf{V}$ to $\\mathbf{Z}_{k}$ meets the path from $\\mathbf{V}_{1}$ to $\\mathbf{Z}_{k}$ in the node $\\mathbf{Z}_{k^{\\prime}}$ with $k^{\\prime}\\leq k$ , we have ", "page_idx": 13}, {"type": "equation", "text": "$$\np(r_{\\mathrm{v}_{1}}^{z_{k}}\\mid\\mathsf{z}_{k}\\in\\mathrm{anc}(\\mathsf{v}))p(r_{\\mathrm{v}_{2}}^{z_{k}}\\mid\\mathsf{z}_{k}\\in\\mathrm{anc}(\\mathsf{v}))=p(r_{\\mathrm{v}_{1}}^{z_{k}^{\\prime}})p(r_{\\mathrm{v}_{2}}^{z_{k}})\\geq p(r_{\\mathrm{v}_{1}}^{z_{k}})p(r_{\\mathrm{v}_{2}}^{z_{k}}).\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "The last inequality follows since rv1k is a subpath of $r_{\\mathrm{v_{1}}}^{\\mathrm{z}_{k}}$ and therefore has a higher probability. This concludes the proof. \u53e3 ", "page_idx": 13}, {"type": "text", "text": "A.4 Proof of Proposition 4.2 ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "In the following, we provide the proof of the inequality shown in Prop. 4.2. ", "page_idx": 13}, {"type": "text", "text": "Proof. To prove it, we first write out the definitions of Soft-Das and the expected Dasgupta cost. ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\mathrm{Soft-Das}({\\mathcal T})=\\sum_{\\mathrm{v_{1},v_{2}}}P(\\mathrm{v_{1},v_{2}})\\sum_{z}\\sum_{\\mathrm{v}}P(\\mathrm{z=v_{1}}\\land\\mathrm{v_{2}})P(\\mathrm{z\\inanc(v)})\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "and ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{E}_{\\hat{T}\\sim P_{A,B}(T)}\\left[\\mathrm{Das}(\\hat{T})\\right]=\\mathbb{E}_{\\hat{T}\\sim P_{A,B}(T)}\\left[\\displaystyle\\sum_{v_{1},v_{2}}P(v_{1},v_{2})\\sum_{z}\\sum_{v}\\mathbb{I}_{[z=v_{1}\\wedge v_{2}]}\\mathbb{I}_{[z\\in\\mathrm{anc}(v)]}\\right]}\\\\ &{\\qquad\\qquad\\qquad\\qquad\\qquad=\\mathbb{E}_{\\hat{T}\\sim P_{A,B}(T)}\\left[\\displaystyle\\sum_{v_{1},v_{2}}P(v_{1},v_{2})\\sum_{z}\\sum_{v}\\mathbb{I}_{[z=v_{1}\\wedge v_{2},z\\in\\mathrm{anc}(v)]}\\right]}\\\\ &{\\qquad\\qquad\\qquad\\qquad=\\displaystyle\\sum_{v_{1},v_{2}}P(v_{1},v_{2})\\sum_{z}\\sum_{v}\\mathbb{E}_{\\hat{T}\\sim P_{A,B}(T)}\\left[\\mathbb{I}_{[z=v_{1}\\wedge v_{2},z\\in\\mathrm{anc}(v)]}\\right]}\\\\ &{\\qquad\\qquad\\qquad=\\displaystyle\\sum_{v_{1},v_{2}}P(\\mathbf{v}_{1},\\mathbf{v}_{2})\\sum_{z}\\sum_{v}P(z=\\mathbf{v}_{1}\\wedge\\mathbf{v}_{2},z\\in\\mathrm{anc}(v))}\\end{array}\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "The proof follows by using Prop. A.1. ", "page_idx": 13}, {"type": "text", "text": "A.5 Proof of Proposition 4.1 ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "Here we provide the proof of Prop. 4.1. ", "page_idx": 13}, {"type": "text", "text": "Proof. To prove the left-hand side, we first observe that the expected Dasgupta cost can be rewritten as a convex combination of the Dasgupta costs of all possible hierarchies under the tree-sampling procedure. More formally, ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\mathbb{E}_{\\hat{T}\\sim P_{A,B}(T)}\\left[\\operatorname{Das}(\\hat{T})\\right]=\\sum_{\\hat{T}\\in\\mathcal{H}(n,n^{\\prime})}P_{A,B}(\\hat{T})\\mathrm{Das}(\\hat{T})\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "where $\\mathcal{H}(n,n^{\\prime})$ describes the set of all valid hierarchies with $n$ leaves and $n^{\\prime}$ internal nodes. Thus, the minimizer of the expected Dasgupta cost is a convex combination of all minimizing hierarchies, with the minimum being equal to the optimal Dasgupta cost. The equation on the right-hand side for TSD can be proved equivalently. \u53e3 ", "page_idx": 14}, {"type": "text", "text": "Note that since the expectation operator is convex, any discrete optimizer (i.e., discrete hierarchies achieving the optimum value) of the discrete scores will be an optimizer of the expected scores and vice-versa. In this case, discrete hierarchies are represented by deterministic $\\pmb{A}$ , $_B$ matrices. Only probabilistic hierarchies, which are optimizers of the expected scores, described by non-discrete $\\pmb{A}$ and $_B$ matrices, are not optimizers of the discrete scores. This is expected since those probabilistic hierarchies do not belong to the valid input domain of the discrete scores. In addition, any sample we draw from these probabilistic optimizers is also a discrete optimizer of Dasgupta or TSD because of the convexity of the expectation operator. ", "page_idx": 14}, {"type": "text", "text": "A.6 Non-Convexity and Non-Concavity of Exp-Das ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "Minimizing a convex function using gradient descent is easier than a concave one. Minimizing a concave function heavily depends on the initialization in a constrained setting. $\\mathrm{Exp-Das}({\\mathcal{T}}=(A,B))$ is neither convex nor concave with respect to $\\pmb{A}$ and $_B$ . For both, a counter-example exists. This implies that we can not tell whether Exp-Das converges into a local or global minimum when training. To show that Exp-Das is not concave, it is sufficient to find two hierarchies $\\mathcal{T}_{1}\\,=\\,(A_{1},B_{1})$ and $\\mathcal{T}_{2}=(A_{2},B_{2})$ such that: ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\frac12\\mathrm{Exp-Das}({\\mathcal T}_{1})+\\frac12\\mathrm{Exp-Das}({\\mathcal T}_{2})\\geq\\mathrm{Exp-Das}\\left(\\frac12({\\mathcal T}_{1}+{\\mathcal T}_{2})\\right),\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "and equivalently to show that it is not convex: ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\frac12\\mathrm{Exp-Das}({\\mathcal T}_{1})+\\frac12\\mathrm{Exp-Das}({\\mathcal T}_{2})\\leq\\mathrm{Exp-Das}\\left(\\frac12({\\mathcal T}_{1}+{\\mathcal T}_{2})\\right),\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "where $\\mathcal{T}_{1}+\\mathcal{T}_{2}=(A_{1}+A_{2},B_{1}+B_{2})$ . In Fig. 7, we show these two examples. In (a) and (b), we show two hierarchies, and in (c), a linear interpolation of these two. The graph in (d) satisfies Eq. 28, while the graph in (e) satisfies Eq. 29. We report the Dasgupta costs for all hierarchy and graph combinations in Tab. 6. ", "page_idx": 14}, {"type": "text", "text": "Table 6: Dasgupta costs for all combinations of hierarchies and graphs from Fig. 7. ", "page_idx": 14}, {"type": "table", "img_path": "fMdrBucZnj/tmp/326c4bb13e025128c85a4706ee4b3aae403f47b06245121a3429d85ea25190eb.jpg", "table_caption": [], "table_footnote": [], "page_idx": 14}, {"type": "text", "text": "A.7 Weighted Failing Soft-Das Example ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "In addition to the example in Fig. 2, we show a weighted graph where FPH fails to find the minimizing hierarchy in Fig. 8. ", "page_idx": 14}, {"type": "image", "img_path": "fMdrBucZnj/tmp/1ce9552f22caf5ba94705d5b2724738f9254df6150a0e51838bac6edf020c6bc.jpg", "img_caption": [], "img_footnote": [], "page_idx": 15}, {"type": "text", "text": "Figure 7: Three hierarchies and two graphs that show that Exp-Das is neither convex nor concave with respect to $\\pmb{A}$ and $_B$ . The hierarchy in (c) is a linear interpolation of the hierarchies in (a) and (b). The graphs in (d) and (e) are counter-examples, with convex and concave behavior, respectively. ", "page_idx": 15}, {"type": "image", "img_path": "fMdrBucZnj/tmp/a9d124e20412e854b5026c15791c6ea86b68bf0b1ffd222f1714f17eb824fdc3.jpg", "img_caption": ["Figure 8: An example of a weighted $K_{4}$ graph where FPH fails to infer a minimizing hierarchy. While FPH achieves a Dasgupta cost of $\\frac{23}{7}$ after discretization, the continuous hierarchy has a Soft-Das score below 3.0. On the other hand, EPH finds a minimizing hierarchy with a cost of 3.0. "], "img_footnote": [], "page_idx": 15}, {"type": "text", "text": "B Experiments Information ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "B.1 Datasets ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "An overview of the graph and vector datasets is given in Tab. 7 and Tab. 8. The details of the HSBMs are shown in Tab. 9. ", "page_idx": 16}, {"type": "table", "img_path": "fMdrBucZnj/tmp/c8cac0798291af78e14440526715d687a39c70ba80043c0990d5f0da9a8c825b.jpg", "table_caption": ["Table 7: Overview of the graph datasets. "], "table_footnote": [], "page_idx": 16}, {"type": "table", "img_path": "fMdrBucZnj/tmp/8ad3c0483407f830f0e5070321ef50d790bb6d41d96b59117b1f6707d2bbf6a4.jpg", "table_caption": ["Table 8: Overview of the vector datasets. "], "table_footnote": [], "page_idx": 16}, {"type": "table", "img_path": "fMdrBucZnj/tmp/a957d26b137ad4020b08c9fae581fa0f612b334666996fa80bdbf94b0ca486da.jpg", "table_caption": ["Table 9: Overview of the HSBMs. "], "table_footnote": [], "page_idx": 16}, {"type": "text", "text": "B.2 Hyperparameters ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "We show an overview of the hyperparameters we used in Tab. 10. Furthermore, we compare the original FPH results with the tuned results, i.e., the minimum of the original, and using the aforementioned scheduler in Tab. 11. ", "page_idx": 17}, {"type": "table", "img_path": "fMdrBucZnj/tmp/872ca595316cf67a3b4123b314ee7110438d4424c6b8ab2270cab5f02e308bfd.jpg", "table_caption": ["Table 10: Overview of the Hyperparameters. "], "table_footnote": [], "page_idx": 17}, {"type": "text", "text": "Table 11: Dasgupta costs of the original FPH (orig.) and with our modifications (tuned). Improvements are highlighted in bold. ", "page_idx": 17}, {"type": "table", "img_path": "fMdrBucZnj/tmp/701d896fc37f1e611850f42f9d9e6b4b7f5c981120fadc5503eea176ca47f2f0.jpg", "table_caption": [], "table_footnote": [], "page_idx": 17}, {"type": "text", "text": "C Additional Results ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "C.1 HSBM Results for FPH ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "We show the results for FPH on the HSBM graphs in Tab 12. ", "page_idx": 18}, {"type": "table", "img_path": "fMdrBucZnj/tmp/76c69a9ca2585f73c8abb4fdf2533b369df8c99d637f4c44be0c05859f5ba2a0.jpg", "table_caption": ["Table 12: Results of FPH for the HSBMs with $n^{\\prime}{=}\\#$ Cluster. "], "table_footnote": [], "page_idx": 18}, {"type": "text", "text": "C.2 Additional Visualizations ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "We show the largest clusters for the Digits and Cifar100 datasets in Fig. 9, Fig. 10, and Fig. 11. We observe that EPH provides qualitatively reasonable clusters and groups similar images. ", "page_idx": 18}, {"type": "image", "img_path": "fMdrBucZnj/tmp/ea84348251029e8e731bfe6d56ff9d3f23a6909523bba48e39d7759092d3bb45.jpg", "img_caption": ["Figure 9: Largest derived clusters on Digits. On the left in each subplot the 16 images with the highest probability, on the right the 16 images with the lowest probability. "], "img_footnote": [], "page_idx": 18}, {"type": "image", "img_path": "fMdrBucZnj/tmp/00466400b0bbd54b11ef63f615113b703037a4b37be54e16b58e12b6b9dcc97b.jpg", "img_caption": ["Figure 10: Second largest derived cluster on Cifar-100. "], "img_footnote": [], "page_idx": 18}, {"type": "text", "text": "Additionally, we provide a visualization of the OpenFlight dataset in Fig. 12, showing that both Exp-Das and Exp-TSD yield meaningful hierarchies and clusters. Finally, we apply t-SNE [36] to selected datasets and compare the ground-truth labels with clusters inferred by EPH in Fig. 13. ", "page_idx": 18}, {"type": "image", "img_path": "fMdrBucZnj/tmp/f5e225a95e36c93b17803f948a71476994fce2edd6e28d68b1a86ee21b957b4f.jpg", "img_caption": ["Figure 11: Third largest derived cluster on Cifar-100. "], "img_footnote": [], "page_idx": 19}, {"type": "image", "img_path": "fMdrBucZnj/tmp/6a6438f7b254d9b97291b2daccd04ab4a0cd1e0984e1bebb403e871e004f9361.jpg", "img_caption": ["(b) TSD - 64 clusters "], "img_footnote": [], "page_idx": 19}, {"type": "text", "text": "Figure 12: Inferred clusters inferred by EPH optimizing Exp-Das and Exp-TSD. 64 clusters are highlighted in the graphs and dendrograms. ", "page_idx": 19}, {"type": "text", "text": "C.3 Additional External Evaluation ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "In addition to the unsupervised metrics, we investigate whether the inferred hierarchies on the vector datasets preserve the flat ground truth class labels. To do this, we flatten the derived hierarchies and compare inferred clusters with the available ground-truth labels by applying the Hungarian algorithm to align the cluster assignments with the labels, as explained by Zhou et al. [40]. Using this procedure, we compute the accuracies, shown in Tab. 13. While the linkage algorithms were inferior to the continuous optimization algorithms in terms of Dasgupta cost, they dominate here. EPH, trained on Exp-Das, yields the best accuracies only on Iris and Spambase. As the linkage algorithms and Louvain generate hierarchies using heuristics while the continuous methods aim to minimize the Dasgupta cost, the results are not surprising since the Dasgupta cost and other metrics do not necessarily go hand in hand. ", "page_idx": 19}, {"type": "text", "text": "C.4 Ablation ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "For our ablation study, we use a simplified optimization scheme. More specifically, we use a fixed learning rate of 0.05 and only train for 1000 epochs. ", "page_idx": 19}, {"type": "image", "img_path": "fMdrBucZnj/tmp/f981e75fb4bcc465a66029435331832f4c18766c3f1516e7978ea6d208a10931.jpg", "img_caption": ["Figure 13: Ground truth clusters (left) compared to inferred flattened clusters (middle) and dendrograms (right) of EPH for the datasets Zoo, Iris, Digits, Segmentation, and Spambase with $n^{\\prime}=\\operatorname*{min}\\{n-1,512\\}$ internal nodes after applying the t-SNE algorithm. "], "img_footnote": [], "page_idx": 20}, {"type": "image", "img_path": "fMdrBucZnj/tmp/9789524bb11973b3cb526df97da9bcaf530b0895952c9df0a5fa99597edcb889.jpg", "img_caption": ["Figure 14: Linear interpolation of Soft-Das and Exp-Das scores from the average linkage hierarchy to the hierarchy inferred by Exp-Das. "], "img_footnote": [], "page_idx": 21}, {"type": "table", "img_path": "fMdrBucZnj/tmp/73204af650c6259775712905e97ea64b1bd65e747bc58ca2f245d4e35e801450.jpg", "table_caption": ["Table 13: Accuracies for the vector datasets. Best scores in bold, second best underlined. "], "table_footnote": [], "page_idx": 21}, {"type": "text", "text": "Constrained vs. Unconstrained Optimization. We require the rows of the matrices $\\pmb{A}$ and $_B$ to be row-stochastic. There are several possibilities to enforce this. Either we can perform constrained optimization using projections onto the probabilistic simplex or perform a softmax operation over the rows. In Tab. 14, we compare the Dasgupta costs on the graph datasets for several graph datasets. We can observe that the constrained optimization,i.e., using projections after each step, yields better ", "page_idx": 21}, {"type": "text", "text": "Table 14: Dasgupta costs for constrained and unconstrained optimization on several graph datasets with $n^{\\prime}=512$ internal nodes. ", "page_idx": 21}, {"type": "table", "img_path": "fMdrBucZnj/tmp/44b84e53550ec153ed2f121604da88a4095fe627507d2a8b34582ed7f0c1b8fd.jpg", "table_caption": [], "table_footnote": [], "page_idx": 21}, {"type": "text", "text": "results than the unconstrained optimization on every graph. This aligns with the findings of Z\u00fcgner et al. [41]. Therefore, we recommend using constrained optimization. ", "page_idx": 21}, {"type": "text", "text": "Initialization. The initialization of a model can play a crucial role. Z\u00fcgner et al. [41] found that using the AL algorithm as initialization yields substantial improvements. Therefore, we compare both initializations and additionally test using their algorithm FPH as initialization. We show the Dasgupta costs for several graph datasets in Tab. 15. As expected, using the AL algorithm or FPH ", "page_idx": 21}, {"type": "text", "text": "Table 15: Dasgupta costs for different initializations on several graph datasets with $n^{\\prime}=512$ internal nodes. In the first three rows the initial Dasgupta costs and in the last three rows the Dasgupta costs after the training. Best scores in bold, second best underlined. ", "page_idx": 21}, {"type": "table", "img_path": "fMdrBucZnj/tmp/e846760646ee8d7a2552faef9133a609aad11fe6d6d4188be1d8474ea59f4b61.jpg", "table_caption": [], "table_footnote": [], "page_idx": 21}, {"type": "text", "text": "as initialization yields significant improvements over a random initialization. Even though the FPH initialization starts with a better hierarchy, the resulting hierarchies are inferior to the AL initialization. This could be caused by local minima, in which the model gets stuck. We recommend using AL as initialization since it performs best on most datasets and has a lower computational cost than FPH. ", "page_idx": 22}, {"type": "text", "text": "Direct vs. Embedding Parametrization. Additionally to the direct parametrization of the matrices $\\pmb{A}$ and $_B$ , we test an embedding parametrization for each node in the hierarchy. More specifically, we use $d$ -dimensional embeddings for the leaves and internal nodes. We perform a softmax operation with an additional learnable temperature parameter $t_{i}$ to infer $\\pmb{A}$ and $_B$ over the cosine similarities between the embeddings. The main advantage of the embedding approach is that, in addition the hierarchical clustering, we gain node embeddings that can be used for downstream tasks such as classification or regression. We test the embedding parametrization with $d=128$ on several graph datasets. Once we let $t_{i}$ be learnable, and once we freeze it to $t_{i}=1$ . We compare the results to the constrained optimization. While we train the direct parametrization for 1000 epochs, the embedding approach is trained for 20000 epochs. This is done to ensure convergence since it is randomly initialized. We show the results in Tab. 16. First, we observe that not using a temperature parameter yields substantially worse ", "page_idx": 22}, {"type": "text", "text": "Table 16: Dasgupta costs for the direct and embedding parametrization on several graph datasets with $n^{\\prime}=512$ internal nodes. Best scores in bold, second best underlined. ", "page_idx": 22}, {"type": "table", "img_path": "fMdrBucZnj/tmp/d9c9aef0413488f74096bfbd6db12e2124e2eab81bdd6c8e431dc6b35005db2c.jpg", "table_caption": [], "table_footnote": [], "page_idx": 22}, {"type": "text", "text": "results. Furthermore, the embedding parametrization is inferior to the direct parametrization, even though it was trained for 20000 epochs, while the constrained optimization was only trained for 1000. Only on the dataset PolBlogs the embedding approach is slightly better than the direct parametrization. We attribute the inferior performance to the random initialization and the fact that we have to use a softmax operation instead of projections. Our results are in line with the ablation study of Z\u00fcgner et al. [41]. They also parametrized their model using embeddings and used the softmax function on the negative Euclidean distances to infer the matrices $\\pmb{A}$ and $_B$ . Since the embedding approach yields worse results with longer training times, we recommend using the direct parametrization. ", "page_idx": 22}, {"type": "text", "text": "Number of Internal Nodes. As in many real-world problems, we do not know the number of internal nodes $n^{\\prime}$ beforehand in our experiments. While increasing $n^{\\prime}$ generally leads to more refined and expressive hierarchies, it reduces interpretability and comes with a higher computational cost. To select the hyperparameter $n^{\\prime}$ , we test various choices on several datasets. We show the corresponding Dasgupta costs and TSD scores in Fig. 15 and Fig. 16. We found that $n^{\\prime}=512$ is sufficient to capture most information. In practice, we recommend using the Elbow method. ", "page_idx": 22}, {"type": "image", "img_path": "fMdrBucZnj/tmp/d0fdb214cf1bf5de4fdd6b81c3b087c93587e4b420ce692f3758bf67dedcf6a1.jpg", "img_caption": ["Figure 15: Dasgupta costs for different numbers of internal nodes. "], "img_footnote": [], "page_idx": 22}, {"type": "image", "img_path": "fMdrBucZnj/tmp/15f1fe4de9219e77861938e261bfdb0278b0aaec1a27f31bd7f17d1a1dec67b6.jpg", "img_caption": ["Figure 16: TSD scores for different numbers of internal nodes. "], "img_footnote": [], "page_idx": 22}, {"type": "text", "text": "Number of Sampled Hierarchies. Another crucial hyperparameter for EPH is the number of sampled hierarchies. Additionally to Fig. 3, we provide the raw Dasgupta costs and standard errors after the training in Fig. 17. Furthermore, we show the influence of the number of samples to approximate the expected Dasgupta cost on randomly initialized hierarchies in Fig. 18. ", "page_idx": 23}, {"type": "image", "img_path": "fMdrBucZnj/tmp/4e9755dce7e38212083ce25eb6759ddbac9ae48ca6f11a6ebe0160104b16249f.jpg", "img_caption": ["Figure 17: Dasgupta costs and standard error for different numbers of sampled hierarchies after the EPH training. "], "img_footnote": [], "page_idx": 23}, {"type": "image", "img_path": "fMdrBucZnj/tmp/366f228ca87104d1d69c8af5ce1f302cc2d415622b362e0332056eaed04c4d8e.jpg", "img_caption": [], "img_footnote": [], "page_idx": 23}, {"type": "text", "text": "Figure 18: Approximated Expected Dasgupta costs for different numbers of sampled hierarchies for randomly initialized probabilistic hierarchies. ", "page_idx": 23}, {"type": "text", "text": "Minimized Version. To reduce EPH\u2019s runtime, we introduce a minimized version of our algorithm that samples a single hierarchy and omits validation steps. The final hierarchy is selected on the training loss, enabled by the alignment between expected and discrete scores. We compare this minimized version to the original and FPH on the graph datasets in Tab. 17, with all methods trained using the original setup described in Sec. 5. ", "page_idx": 23}, {"type": "table", "img_path": "fMdrBucZnj/tmp/b5696b5efdf50067dcdaff8903b55abdcc83d1e0856656a4c54fd46fa568133d.jpg", "table_caption": ["Table 17: Results of the minimized version of EPH for the graph datasets. Best scores in bold, second best underlined. "], "table_footnote": [], "page_idx": 23}, {"type": "text", "text": "Our minimized version outperforms FPH in 14 out of 16 cases while achieving a shorter runtime, as shown in Tab. 20. ", "page_idx": 23}, {"type": "text", "text": "C.5 Standard Deviations ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "We show the standard deviations of the randomized models on the graph datasets in Tab. 18 and for the vector datasets in Tab. 19. ", "page_idx": 23}, {"type": "text", "text": "C.6 Runtimes ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "We report the runtimes for EPH and the baselines in Tab. 20 and Tab. 21. While HypHC, FPH, and EPH are executed on a GPU (NVIDIA A100), the remaining methods do not support or do not require GPU acceleration. Since gHHC has a lower computational runtime than the other randomized methods, we run it with 50 random seeds instead of 5. ", "page_idx": 23}, {"type": "table", "img_path": "fMdrBucZnj/tmp/719dbc619b5e22b7563e79e95a9dc024fe7b8adc65edd3e6c5325779d74ae4b9.jpg", "table_caption": ["Table 18: Standard Deviations for the graph datasets. "], "table_footnote": [], "page_idx": 24}, {"type": "table", "img_path": "fMdrBucZnj/tmp/ff7655f945426bc6086eb90bb8b9ed928c6721cf42265113da9dfba84c1d3461.jpg", "table_caption": ["Table 19: Standard Deviations for the vector datasets. "], "table_footnote": [], "page_idx": 24}, {"type": "text", "text": "C.7 Pseudocodes ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "In the following, we provide a formal description of our EPH algorithm, the subgraph sampling, and how we normalize graphs. ", "page_idx": 24}, {"type": "table", "img_path": "fMdrBucZnj/tmp/e3a0efa8da1dec5cacb7964309db8dd258e287599c5ec58357f33b574f03b61b.jpg", "table_caption": [], "table_footnote": [], "page_idx": 24}, {"type": "table", "img_path": "fMdrBucZnj/tmp/efae23792e6530549eb70f3f3f056ab9bd00c0bc733e14a09057bdde7b098aa5.jpg", "table_caption": [], "table_footnote": [], "page_idx": 24}, {"type": "table", "img_path": "fMdrBucZnj/tmp/634b7944540cce885ec9b517577b1cf9eea655eaff1b28d2d8a32c684a7987c5.jpg", "table_caption": [], "table_footnote": [], "page_idx": 24}, {"type": "table", "img_path": "fMdrBucZnj/tmp/d4602b2a0c9c239252d01198c63a15abe602e23fe54aed898138a00b974fd68f.jpg", "table_caption": ["Table 20: Runtime in seconds for the graph datasets with $n^{\\prime}=512$ internal nodes. "], "table_footnote": [], "page_idx": 25}, {"type": "table", "img_path": "fMdrBucZnj/tmp/0f5e03dfd68e5a9ca0acae1c97da597dc594057e9d8355e184560eb7e9df9c50.jpg", "table_caption": ["Table 21: Runtime in seconds for the vector datasets with $n^{\\prime}=\\operatorname*{min}\\{n-1,512\\}$ internal nodes. "], "table_footnote": [], "page_idx": 25}, {"type": "text", "text": "NeurIPS Paper Checklist ", "text_level": 1, "page_idx": 26}, {"type": "text", "text": "1. Claims ", "text_level": 1, "page_idx": 26}, {"type": "text", "text": "Question: Do the main claims made in the abstract and introduction accurately reflect the paper\u2019s contributions and scope? ", "page_idx": 26}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 26}, {"type": "text", "text": "Justification: The abstract accurately describes the contributions and claims of the paper. The methodology is explained in Sec. 4, and theoretical properties and methodology are shown and discussed in Sec. 4.2. Our subgraph sampling approach is discussed in Sec. 4.4. The results on the graph and vector datasets are presented in Sec. 5. ", "page_idx": 26}, {"type": "text", "text": "Guidelines: ", "page_idx": 26}, {"type": "text", "text": "\u2022 The answer NA means that the abstract and introduction do not include the claims made in the paper.   \n\u2022 The abstract and/or introduction should clearly state the claims made, including the contributions made in the paper and important assumptions and limitations. A No or NA answer to this question will not be perceived well by the reviewers.   \n\u2022 The claims made should match theoretical and experimental results, and reflect how much the results can be expected to generalize to other settings.   \n\u2022 It is fine to include aspirational goals as motivation as long as it is clear that these goals are not attained by the paper. ", "page_idx": 26}, {"type": "text", "text": "2. Limitations ", "text_level": 1, "page_idx": 26}, {"type": "text", "text": "Question: Does the paper discuss the limitations of the work performed by the authors? ", "page_idx": 26}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 26}, {"type": "text", "text": "Justification: The limitations are discussed in Sec. 6. ", "page_idx": 26}, {"type": "text", "text": "Guidelines: ", "text_level": 1, "page_idx": 26}, {"type": "text", "text": "\u2022 The answer NA means that the paper has no limitation while the answer No means that the paper has limitations, but those are not discussed in the paper.   \n\u2022 The authors are encouraged to create a separate \"Limitations\" section in their paper.   \n\u2022 The paper should point out any strong assumptions and how robust the results are to violations of these assumptions (e.g., independence assumptions, noiseless settings, model well-specification, asymptotic approximations only holding locally). The authors should reflect on how these assumptions might be violated in practice and what the implications would be.   \n\u2022 The authors should reflect on the scope of the claims made, e.g., if the approach was only tested on a few datasets or with a few runs. In general, empirical results often depend on implicit assumptions, which should be articulated.   \n\u2022 The authors should reflect on the factors that influence the performance of the approach. For example, a facial recognition algorithm may perform poorly when image resolution is low or images are taken in low lighting. Or a speech-to-text system might not be used reliably to provide closed captions for online lectures because it fails to handle technical jargon.   \n\u2022 The authors should discuss the computational efficiency of the proposed algorithms and how they scale with dataset size.   \n\u2022 If applicable, the authors should discuss possible limitations of their approach to address problems of privacy and fairness.   \n\u2022 While the authors might fear that complete honesty about limitations might be used by reviewers as grounds for rejection, a worse outcome might be that reviewers discover limitations that aren\u2019t acknowledged in the paper. The authors should use their best judgment and recognize that individual actions in favor of transparency play an important role in developing norms that preserve the integrity of the community. Reviewers will be specifically instructed to not penalize honesty concerning limitations. ", "page_idx": 26}, {"type": "text", "text": "3. Theory Assumptions and Proofs ", "text_level": 1, "page_idx": 26}, {"type": "text", "text": "Question: For each theoretical result, does the paper provide the full set of assumptions and a complete (and correct) proof? ", "page_idx": 26}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 27}, {"type": "text", "text": "Justification: All theoretical results include assumptions and proofs and are presented in App. A. ", "page_idx": 27}, {"type": "text", "text": "Guidelines: ", "page_idx": 27}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include theoretical results.   \n\u2022 All the theorems, formulas, and proofs in the paper should be numbered and crossreferenced.   \n\u2022 All assumptions should be clearly stated or referenced in the statement of any theorems.   \n\u2022 The proofs can either appear in the main paper or the supplemental material, but if they appear in the supplemental material, the authors are encouraged to provide a short proof sketch to provide intuition.   \n\u2022 Inversely, any informal proof provided in the core of the paper should be complemented by formal proofs provided in appendix or supplemental material.   \n\u2022 Theorems and Lemmas that the proof relies upon should be properly referenced. ", "page_idx": 27}, {"type": "text", "text": "4. Experimental Result Reproducibility ", "text_level": 1, "page_idx": 27}, {"type": "text", "text": "Question: Does the paper fully disclose all the information needed to reproduce the main experimental results of the paper to the extent that it affects the main claims and/or conclusions of the paper (regardless of whether the code and data are provided or not)? ", "page_idx": 27}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 27}, {"type": "text", "text": "Justification: All training details and hyperparameters are disclosed. We provide all hyperparameters in Tab. 10, pseudeocodes in Alg. 1 and Alg. 3, and explain the experimental setup in Sec. 5.1. ", "page_idx": 27}, {"type": "text", "text": "Guidelines: ", "page_idx": 27}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 If the paper includes experiments, a No answer to this question will not be perceived well by the reviewers: Making the paper reproducible is important, regardless of whether the code and data are provided or not.   \n\u2022 If the contribution is a dataset and/or model, the authors should describe the steps taken to make their results reproducible or verifiable.   \n\u2022 Depending on the contribution, reproducibility can be accomplished in various ways. For example, if the contribution is a novel architecture, describing the architecture fully might suffice, or if the contribution is a specific model and empirical evaluation, it may be necessary to either make it possible for others to replicate the model with the same dataset, or provide access to the model. In general. releasing code and data is often one good way to accomplish this, but reproducibility can also be provided via detailed instructions for how to replicate the results, access to a hosted model (e.g., in the case of a large language model), releasing of a model checkpoint, or other means that are appropriate to the research performed.   \n\u2022 While NeurIPS does not require releasing code, the conference does require all submissions to provide some reasonable avenue for reproducibility, which may depend on the nature of the contribution. For example (a) If the contribution is primarily a new algorithm, the paper should make it clear how to reproduce that algorithm. (b) If the contribution is primarily a new model architecture, the paper should describe the architecture clearly and fully. (c) If the contribution is a new model (e.g., a large language model), then there should either be a way to access this model for reproducing the results or a way to reproduce the model (e.g., with an open-source dataset or instructions for how to construct the dataset). (d) We recognize that reproducibility may be tricky in some cases, in which case authors are welcome to describe the particular way they provide for reproducibility. In the case of closed-source models, it may be that access to the model is limited in some way (e.g., to registered users), but it should be possible for other researchers to have some path to reproducing or verifying the results. ", "page_idx": 27}, {"type": "text", "text": "5. Open access to data and code ", "text_level": 1, "page_idx": 28}, {"type": "text", "text": "Question: Does the paper provide open access to the data and code, with sufficient instructions to faithfully reproduce the main experimental results, as described in supplemental material? ", "page_idx": 28}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 28}, {"type": "text", "text": "Justification: The project page of EPH is attached and the datasets (except the synthetic HSBMs) are publicly available. The baselines are not attached since these are all publicly available. Furthermore, the submitted code includes information about the environment used for the experiments. ", "page_idx": 28}, {"type": "text", "text": "Guidelines: ", "page_idx": 28}, {"type": "text", "text": "\u2022 The answer NA means that paper does not include experiments requiring code.   \n\u2022 Please see the NeurIPS code and data submission guidelines (https://nips.cc/ public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 While we encourage the release of code and data, we understand that this might not be possible, so \u201cNo\u201d is an acceptable answer. Papers cannot be rejected simply for not including code, unless this is central to the contribution (e.g., for a new open-source benchmark).   \n\u2022 The instructions should contain the exact command and environment needed to run to reproduce the results. See the NeurIPS code and data submission guidelines (https: //nips.cc/public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 The authors should provide instructions on data access and preparation, including how to access the raw data, preprocessed data, intermediate data, and generated data, etc.   \n\u2022 The authors should provide scripts to reproduce all experimental results for the new proposed method and baselines. If only a subset of experiments are reproducible, they should state which ones are omitted from the script and why.   \n\u2022 At submission time, to preserve anonymity, the authors should release anonymized versions (if applicable).   \n\u2022 Providing as much information as possible in supplemental material (appended to the paper) is recommended, but including URLs to data and code is permitted. ", "page_idx": 28}, {"type": "text", "text": "6. Experimental Setting/Details ", "text_level": 1, "page_idx": 28}, {"type": "text", "text": "Question: Does the paper specify all the training and test details (e.g., data splits, hyperparameters, how they were chosen, type of optimizer, etc.) necessary to understand the results? ", "page_idx": 28}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 28}, {"type": "text", "text": "Justification: Experimental details are provided in Sec. 5.1 and Tab. 10. ", "page_idx": 28}, {"type": "text", "text": "Guidelines: ", "page_idx": 28}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments. \u2022 The experimental setting should be presented in the core of the paper to a level of detail that is necessary to appreciate the results and make sense of them. \u2022 The full details can be provided either with the code, in appendix, or as supplemental material. ", "page_idx": 28}, {"type": "text", "text": "7. Experiment Statistical Significance ", "text_level": 1, "page_idx": 28}, {"type": "text", "text": "Question: Does the paper report error bars suitably and correctly defined or other appropriate information about the statistical significance of the experiments? ", "page_idx": 28}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 28}, {"type": "text", "text": "Justification: Standard deviations of our experiments are provided in Tab. 18 and Tab. 19. Guidelines: ", "page_idx": 28}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments. \u2022 The authors should answer \"Yes\" if the results are accompanied by error bars, confidence intervals, or statistical significance tests, at least for the experiments that support the main claims of the paper. ", "page_idx": 28}, {"type": "text", "text": "\u2022 The factors of variability that the error bars are capturing should be clearly stated (for example, train/test split, initialization, random drawing of some parameter, or overall run with given experimental conditions).   \n\u2022 The method for calculating the error bars should be explained (closed form formula, call to a library function, bootstrap, etc.)   \n\u2022 The assumptions made should be given (e.g., Normally distributed errors).   \n\u2022 It should be clear whether the error bar is the standard deviation or the standard error of the mean.   \n\u2022 It is OK to report 1-sigma error bars, but one should state it. The authors should preferably report a 2-sigma error bar than state that they have a $96\\%$ CI, if the hypothesis of Normality of errors is not verified.   \n\u2022 For asymmetric distributions, the authors should be careful not to show in tables or figures symmetric error bars that would yield results that are out of range (e.g. negative error rates).   \n\u2022 If error bars are reported in tables or plots, The authors should explain in the text how they were calculated and reference the corresponding figures or tables in the text. ", "page_idx": 29}, {"type": "text", "text": "8. Experiments Compute Resources ", "text_level": 1, "page_idx": 29}, {"type": "text", "text": "Question: For each experiment, does the paper provide sufficient information on the computer resources (type of compute workers, memory, time of execution) needed to reproduce the experiments? ", "page_idx": 29}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 29}, {"type": "text", "text": "Justification: Machine and runtimes are stated in Sec. C.6. ", "page_idx": 29}, {"type": "text", "text": "Guidelines: ", "page_idx": 29}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The paper should indicate the type of compute workers CPU or GPU, internal cluster, or cloud provider, including relevant memory and storage.   \n\u2022 The paper should provide the amount of compute required for each of the individual experimental runs as well as estimate the total compute.   \n\u2022 The paper should disclose whether the full research project required more compute than the experiments reported in the paper (e.g., preliminary or failed experiments that didn\u2019t make it into the paper). ", "page_idx": 29}, {"type": "text", "text": "9. Code Of Ethics ", "text_level": 1, "page_idx": 29}, {"type": "text", "text": "Question: Does the research conducted in the paper conform, in every respect, with the NeurIPS Code of Ethics https://neurips.cc/public/EthicsGuidelines? ", "page_idx": 29}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 29}, {"type": "text", "text": "Justification: The authors have reviewed the NeurIPS Code of Ethics and ensured that the paper is conform with the code. ", "page_idx": 29}, {"type": "text", "text": "Guidelines: ", "page_idx": 29}, {"type": "text", "text": "\u2022 The answer NA means that the authors have not reviewed the NeurIPS Code of Ethics.   \n\u2022 If the authors answer No, they should explain the special circumstances that require a deviation from the Code of Ethics.   \n\u2022 The authors should make sure to preserve anonymity (e.g., if there is a special consideration due to laws or regulations in their jurisdiction). ", "page_idx": 29}, {"type": "text", "text": "10. Broader Impacts ", "text_level": 1, "page_idx": 29}, {"type": "text", "text": "Question: Does the paper discuss both potential positive societal impacts and negative societal impacts of the work performed? ", "page_idx": 29}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 29}, {"type": "text", "text": "Justification: This paper proposes a hierarchical clustering algorithm for graphs and vector data. There are no no broader societal impacts. ", "page_idx": 29}, {"type": "text", "text": "Guidelines: ", "page_idx": 29}, {"type": "text", "text": "\u2022 The answer NA means that there is no societal impact of the work performed. ", "page_idx": 29}, {"type": "text", "text": "\u2022 If the authors answer NA or No, they should explain why their work has no societal impact or why the paper does not address societal impact.   \n\u2022 Examples of negative societal impacts include potential malicious or unintended uses (e.g., disinformation, generating fake profiles, surveillance), fairness considerations (e.g., deployment of technologies that could make decisions that unfairly impact specific groups), privacy considerations, and security considerations.   \n\u2022 The conference expects that many papers will be foundational research and not tied to particular applications, let alone deployments. However, if there is a direct path to any negative applications, the authors should point it out. For example, it is legitimate to point out that an improvement in the quality of generative models could be used to generate deepfakes for disinformation. On the other hand, it is not needed to point out that a generic algorithm for optimizing neural networks could enable people to train models that generate Deepfakes faster.   \n\u2022 The authors should consider possible harms that could arise when the technology is being used as intended and functioning correctly, harms that could arise when the technology is being used as intended but gives incorrect results, and harms following from (intentional or unintentional) misuse of the technology.   \n\u2022 If there are negative societal impacts, the authors could also discuss possible mitigation strategies (e.g., gated release of models, providing defenses in addition to attacks, mechanisms for monitoring misuse, mechanisms to monitor how a system learns from feedback over time, improving the efficiency and accessibility of ML). ", "page_idx": 30}, {"type": "text", "text": "11. Safeguards ", "text_level": 1, "page_idx": 30}, {"type": "text", "text": "Question: Does the paper describe safeguards that have been put in place for responsible release of data or models that have a high risk for misuse (e.g., pretrained language models, image generators, or scraped datasets)? ", "page_idx": 30}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 30}, {"type": "text", "text": "Justification: The proposed models do not pose a risk for misuse. Guidelines: ", "page_idx": 30}, {"type": "text", "text": "\u2022 The answer NA means that the paper poses no such risks.   \n\u2022 Released models that have a high risk for misuse or dual-use should be released with necessary safeguards to allow for controlled use of the model, for example by requiring that users adhere to usage guidelines or restrictions to access the model or implementing safety filters.   \n\u2022 Datasets that have been scraped from the Internet could pose safety risks. The authors should describe how they avoided releasing unsafe images.   \n\u2022 We recognize that providing effective safeguards is challenging, and many papers do not require this, but we encourage authors to take this into account and make a best faith effort. ", "page_idx": 30}, {"type": "text", "text": "12. Licenses for existing assets ", "text_level": 1, "page_idx": 30}, {"type": "text", "text": "Question: Are the creators or original owners of assets (e.g., code, data, models), used in the paper, properly credited and are the license and terms of use explicitly mentioned and properly respected? ", "page_idx": 30}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 30}, {"type": "text", "text": "Justification: The licenses of the used datasets are shown in Tab. 7 and Tab. 8. Furthermore, all baselines and methods are cited accordingly. ", "page_idx": 30}, {"type": "text", "text": "Guidelines: ", "page_idx": 30}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not use existing assets.   \n\u2022 The authors should cite the original paper that produced the code package or dataset.   \n\u2022 The authors should state which version of the asset is used and, if possible, include a URL.   \n\u2022 The name of the license (e.g., CC-BY 4.0) should be included for each asset.   \n\u2022 For scraped data from a particular source (e.g., website), the copyright and terms of service of that source should be provided.   \n\u2022 If assets are released, the license, copyright information, and terms of use in the package should be provided. For popular datasets, paperswithcode.com/datasets has curated licenses for some datasets. Their licensing guide can help determine the license of a dataset.   \n\u2022 For existing datasets that are re-packaged, both the original license and the license of the derived asset (if it has changed) should be provided.   \n\u2022 If this information is not available online, the authors are encouraged to reach out to the asset\u2019s creators. ", "page_idx": 30}, {"type": "text", "text": "", "page_idx": 31}, {"type": "text", "text": "13. New Assets ", "text_level": 1, "page_idx": 31}, {"type": "text", "text": "Question: Are new assets introduced in the paper well documented and is the documentation provided alongside the assets? ", "page_idx": 31}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 31}, {"type": "text", "text": "Justification: All hyperparameters are shown in Tab. 10, pseudeocodes in Alg. 1 and Alg. 3, and the experimental setup is explained in Sec. 5.1 ", "page_idx": 31}, {"type": "text", "text": "Guidelines: ", "page_idx": 31}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not release new assets.   \n\u2022 Researchers should communicate the details of the dataset/code/model as part of their submissions via structured templates. This includes details about training, license, limitations, etc.   \n\u2022 The paper should discuss whether and how consent was obtained from people whose asset is used.   \n\u2022 At submission time, remember to anonymize your assets (if applicable). You can either create an anonymized URL or include an anonymized zip file. ", "page_idx": 31}, {"type": "text", "text": "14. Crowdsourcing and Research with Human Subjects ", "text_level": 1, "page_idx": 31}, {"type": "text", "text": "Question: For crowdsourcing experiments and research with human subjects, does the paper include the full text of instructions given to participants and screenshots, if applicable, as well as details about compensation (if any)? ", "page_idx": 31}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 31}, {"type": "text", "text": "Justification: ", "page_idx": 31}, {"type": "text", "text": "Guidelines: ", "page_idx": 31}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Including this information in the supplemental material is fine, but if the main contribution of the paper involves human subjects, then as much detail as possible should be included in the main paper.   \n\u2022 According to the NeurIPS Code of Ethics, workers involved in data collection, curation, or other labor should be paid at least the minimum wage in the country of the data collector. ", "page_idx": 31}, {"type": "text", "text": "15. Institutional Review Board (IRB) Approvals or Equivalent for Research with Human Subjects ", "page_idx": 31}, {"type": "text", "text": "Question: Does the paper describe potential risks incurred by study participants, whether such risks were disclosed to the subjects, and whether Institutional Review Board (IRB) approvals (or an equivalent approval/review based on the requirements of your country or institution) were obtained? ", "page_idx": 31}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 31}, {"type": "text", "text": "Justification: ", "page_idx": 31}, {"type": "text", "text": "Guidelines: ", "page_idx": 31}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Depending on the country in which research is conducted, IRB approval (or equivalent) may be required for any human subjects research. If you obtained IRB approval, you should clearly state this in the paper.   \n\u2022 We recognize that the procedures for this may vary significantly between institutions and locations, and we expect authors to adhere to the NeurIPS Code of Ethics and the guidelines for their institution.   \n\u2022 For initial submissions, do not include any information that would break anonymity (if applicable), such as the institution conducting the review. ", "page_idx": 31}, {"type": "text", "text": "", "page_idx": 32}]