[{"type": "text", "text": "Efficient Graph Matching for Correlated Stochastic Block Models ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Shuwen Chai ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Northwestern University Evanston, IL 60208 shuwenchai2027@u.northwestern.edu ", "page_idx": 0}, {"type": "text", "text": "Mikl\u00f3s Z. R\u00e1cz Northwestern University Evanston, IL 60208 miklos.racz@northwestern.edu ", "page_idx": 0}, {"type": "text", "text": "Abstract ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "We study learning problems on correlated stochastic block models with two balanced communities. Our main result gives the first efficient algorithm for graph matching in this setting. In the most interesting regime where the average degree is logarithmic in the number of vertices, this algorithm correctly matches all but a vanishing fraction of vertices with high probability, whenever the edge correlation parameter $s$ satisfies $s^{2}>\\alpha\\approx0.33\\bar{8}$ , where $\\alpha$ is Otter\u2019s tree-counting constant. Moreover, we extend this to an efficient algorithm for exact graph matching whenever this is information-theoretically possible, positively resolving an open problem of R\u00e1cz and Sridhar (NeurIPS 2021). Our algorithm generalizes the recent breakthrough work of Mao, Wu, Xu, and Yu (STOC 2023), which is based on centered subgraph counts of a large family of trees termed chandeliers. A major technical challenge that we overcome is dealing with the additional estimation errors that are necessarily present due to the fact that, in relevant parameter regimes, the latent community partition cannot be exactly recovered from a single graph. As an application of our results, we give an efficient algorithm for exact community recovery using multiple correlated graphs in parameter regimes where it is information-theoretically impossible to do so using just a single graph. ", "page_idx": 0}, {"type": "text", "text": "1 Introduction ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "The proliferation of network data has highlighted the ubiquity and importance of graph matching in machine learning, with applications in a variety of domains, including social networks [52, 57], computational biology [61], and computer vision [13, 37]. While the graph matching task\u2014recovering the latent node alignment between two networks\u2014is known to be NP-hard to solve or even approximate in general [39, 53], in practice it is often possible to solve it well, such as in the works cited above. This has motivated an exciting recent line of work studying average-case graph matching [14, 15, 65, 16, 23, 28, 24, 50, 5, 21, 22, 40, 41, 42, 17, 20, 18], focusing on correlated Erd\u02ddos\u2013 R\u00e9nyi random graphs [57]. These papers culminated in recent breakthrough works which developed efficient graph matching algorithms in the constant noise regime [41, 42]. ", "page_idx": 0}, {"type": "text", "text": "However, real-world networks are not modeled well by Erdo\u02dds\u2013R\u00e9nyi random graphs, which in turn has motivated a growing line of recent work studying graph matching beyond Erdo\u02dds\u2013R\u00e9nyi [8, 33, 11, 55, 59, 70, 58, 25, 63, 60, 19, 67, 66, 10]. In particular, an important problem in this vein is to study graph matching in correlated stochastic block models (correlated SBMs) [36, 55, 35] (see Section 2 for definitions), since community structure is prevalent in many networks and the community recovery problem is a fundamental inference task that is often a starting point for deeper analyses. Recent work of R\u00e1cz and Sridhar [58] determined the fundamental information-theoretic limits for exact graph matching in correlated SBMs; however, the underlying algorithm used to achieve this limit is inefficient (that is, not polynomial time). R\u00e1cz and Sridhar [58] posed the open problem of finding an efficient algorithm for (exact) graph matching whenever this is information-theoretically feasible. ", "page_idx": 0}, {"type": "text", "text": "Our main contribution positively resolves this open problem of R\u00e1cz and Sridhar [58], giving the first efficient algorithm for graph matching for correlated SBMs with two balanced communities, under a condition on the correlation strength that is conjectured to be necessary. Specifically, we give an efficient algorithm that, in the most interesting regime where the average degree is logarithmic in the number of vertices, achieves almost exact recovery of the latent matching, whenever the edge correlation parameter $s$ satisfies $s^{2}>\\alpha\\approx0.338$ , where $\\alpha$ is Otter\u2019s tree-counting constant. Moreover, we extend this to an efficient algorithm for exact graph matching whenever this is information-theoretically possible. See Section 3 and Theorem 1 for details. ", "page_idx": 1}, {"type": "text", "text": "In addition, our results on graph matching directly imply novel efficient algorithms and results for community recovery. Specifically, combining\u2014in a black-box fashion\u2014our (exact) graph matching algorithm with existing community recovery algorithms, we give an efficient algorithm for exact community recovery using multiple correlated graphs in parameter regimes where it is informationtheoretically impossible to do so using just a single graph. See Section 3 and Theorem 2 for details. ", "page_idx": 1}, {"type": "text", "text": "Our algorithm generalizes the recent breakthrough work of Mao, Wu, Xu, and Yu [42], which is based on centered subgraph counts of a large family of trees termed chandeliers, to the setting of correlated SBMs. A major technical challenge that we overcome is dealing with the additional estimation errors that are necessarily present due to the fact that, in relevant parameter regimes, the latent community partition cannot be exactly recovered from a single graph, and thus the edge-indicator variables in the centered subgraph counts cannot be precisely centered. Our technical contributions highlight the interplay between graph matching and community recovery in ways that are complementary to the recent work of Gaudio, R\u00e1cz, and Sridhar [25]. ", "page_idx": 1}, {"type": "text", "text": "2 Models and problems ", "text_level": 1, "page_idx": 1}, {"type": "text", "text": "In this section we describe the setting of the paper by introducing the stochastic block model (SBM), correlated SBMs, and the community recovery and graph matching tasks. ", "page_idx": 1}, {"type": "text", "text": "The stochastic block model (SBM) is the canonical probabilistic generative model for a network with latent community structure. The SBM was first introduced by Holland, Laskey, and Leinhardt [30] and has been widely studied over the past decades [1]. In general, a SBM may consist of a number of communities, with distinct vertices connected randomly with a probability that depends on their community memberships. ", "page_idx": 1}, {"type": "text", "text": "In this work, we focus on the simplest setting of the balanced two-community SBM. Given $n\\in\\mathbb{Z}_{+}$ and $p,q\\in[0,1]$ , we construct $G\\stackrel{^{\\cdot}}{\\sim}\\mathrm{SBM}(n,\\stackrel{^{\\cdot}}{p},q)$ as follows. The graph $G$ has $n$ vertices, with vertex labels given by $V=[n]:=\\{1,2,\\dots,n\\}$ . Let $\\pmb{\\sigma}_{\\ast}=\\{\\pmb{\\sigma}_{\\ast}(i)\\}_{i=1}^{n}$ be the vector of community labels, where each entry $\\pmb{\\sigma}_{\\ast}(i)\\in\\{-1,+1\\}$ is drawn independently and uniformly at random. Then, given the community labels $\\pmb{\\sigma}_{*}$ , for any pair of vertices $i\\neq j\\in[n]$ , edge $(i,j)$ is in $G$ with probability $p\\mathbf{1}_{\\{\\pmb{\\sigma}_{*}(i)=\\pmb{\\sigma}_{*}(j)\\}}+q\\mathbf{1}_{\\{\\pmb{\\sigma}_{*}(i)\\neq\\pmb{\\sigma}_{*}(j)\\}}$ . That is, two different vertices are connected with probability $p$ if they are from the same community and connected with probability $q$ otherwise. ", "page_idx": 1}, {"type": "text", "text": "Correlated SBMs are multiple SBMs where the corresponding edge variables are correlated [36, 55, 35]. Specifically, we construct two correlated SBMs $(G_{1},G_{2})\\,\\sim\\,\\mathrm{CSBM}(n,p,q,s)$ using a natural subsampling procedure as follows. Let $G\\sim\\operatorname{SBM}(n,p,q)$ be a parent graph with community labels $\\pmb{\\sigma}_{*}$ . Next, given $G$ , we construct $G_{1}$ by random sampling of the edges: each edge of $G$ is included in $G_{1}$ with probability $s$ , independently of everything else, and non-edges of $G$ remain non-edges of $G_{1}$ . We then do the edge sampling independently again to obtain $G_{2}^{\\prime}$ in the same way. The child graphs $G_{1}$ and $G_{2}^{\\prime}$ inherit both the vertex labels (given by $[n],$ ) and the community labels $\\pmb{\\sigma}_{*}$ from the parent graph $G$ . Finally, let $\\pi_{*}$ be a uniformly random permutation of $[n]:=\\{1,2,\\ldots,n\\}$ and generate $G_{2}$ by relabeling the vertices of $G_{2}^{\\prime}$ according to $\\pi_{*}$ (e.g., vertex $i$ in $G_{2}^{\\prime}$ is relabeled as $\\pi_{*}(i)$ in $G_{2}$ ). This last step reflects the fact that in practice often the correspondence between the two vertex sets is unknown. We denote the adjacency matrices of $G_{1}$ and $G_{2}$ as $A$ and $B$ , respectively, and note that the community labels of the two graphs are $\\pmb{\\sigma}_{*}^{A}:=\\pmb{\\sigma}_{*}$ and $\\pmb{\\sigma}_{*}^{B}:=\\pmb{\\sigma}_{*}\\circ\\pmb{\\pi}_{*}^{-1}$ , respectively. See Figure 1 for an illustration. ", "page_idx": 1}, {"type": "text", "text": "Marginally, $G_{1}$ and $G_{2}$ are identically distributed SBMs: we have $G_{1},G_{2}\\;\\sim\\;\\mathrm{SBM}(n,p s,q s)$ . Moreover, $G_{1}$ and $G_{2}$ are correlated. Specifically, for every pair of distinct vertices $\\{i,j\\}$ , the edgeindicator random variables $A_{i,j}$ and $B_{\\pi_{*}(i),\\pi_{*}(j)}$ are correlated Bernoulli random variables. A simple calculation shows that if $\\pmb{\\sigma}_{*}(i)=\\pmb{\\sigma}_{*}(j)$ , then the correlation coefficient of $A_{i,j}$ and $B_{\\pi_{*}(i),\\pi_{*}(j)}$ is eOquura fl otco $\\begin{array}{r}{\\rho_{+}:=s\\frac{1-p}{1-p s}}\\end{array}$ ,h ew shperaersaes  isfe $\\pmb{\\sigma}_{*}(i)\\neq\\pmb{\\sigma}_{*}(j)$ i(s acs )n,  cino ewffhiciicehn ct aiss $\\rho_{-}:=s\\frac{1\\!-\\!q}{1\\!-\\!q s}$ $p,q=o(1)$ $n\\to\\infty$ $\\rho_{+}$ $\\rho_{-}$ are asymptotically $(1-o(1))s$ , and hence we can regard $s$ as the edge correlation parameter. ", "page_idx": 1}, {"type": "image", "img_path": "nBhfIcDnRP/tmp/3c6ca061e3560a612aeb9011652196278279458cd35c8f63cb0681dffe8aa6b7.jpg", "img_caption": ["Figure 1: Schematic illustrating two-community correlated SBMs; see the text for details. (Figure reproduced from [58] with permission.) "], "img_footnote": [], "page_idx": 2}, {"type": "text", "text": "", "page_idx": 2}, {"type": "text", "text": "Community recovery. The goal of community recovery is to recover the latent community labels $\\pmb{\\sigma}_{*}$ given some (graph) data, such as a SBM $G$ or correlated SBMs $\\left(G_{1},G_{2}\\right)$ . There are various notions of community recovery, depending on how close an estimate is to the ground truth $\\pmb{\\sigma}_{*}$ . In this work, we focus on exact community recovery, defined as follows: an estimator $\\widehat{\\pmb{\\sigma}}$ achieves exact community recovery if $\\begin{array}{r}{\\operatorname*{lim}_{n\\to\\infty}\\mathbb{P}(|\\frac{1}{n}\\sum_{i=1}^{n}\\widehat{\\pmb{\\sigma}}(i)\\pmb{\\sigma}_{*}(i)|=1)=1}\\end{array}$ . The absolute va l ue is present in the previous expression since we can only ho pe to recover the community labels up to a global sign filp; in other words, our goal is to recover the partition of the graph into two communities. A slightly weaker notion, which also appears throughout our work, is almost exact community recovery, which holds if $\\begin{array}{r}{\\operatorname*{lim}_{n\\rightarrow\\infty}\\mathbb{P}(|\\frac{1}{n}\\sum_{i=1}^{n}\\mathbf{\\hat{\\sigma}}(i)\\sigma_{*}(i)|^{\\overline{{\\ }}}{=}1-o(1))=1}\\end{array}$ ; in other words, this notion tolerates a vanishing fraction of errors. Fu rther weaker notions include partial recovery and weak recovery; since these are not the focus here, we refer to [1] for details. ", "page_idx": 2}, {"type": "text", "text": "Different parameter regimes give rise to different challenges and different notions of recovery become most relevant. In the constant average degree regime, that is, when $\\textstyle p\\,=\\,{\\frac{a}{n}}$ and $\\textstyle q\\,=\\,{\\frac{b}{n}}$ for some constants $a$ and $b$ , it is impossible to recovery the communities exactly. Prior works [47, 49, 44] have characterized the information-theoretic threshold and developed efficient algorithms for partial recovery in this regime. On the other hand, if the vertices have polynomially growing degrees, that is, when $\\dot{p^{\\mathrm{~\\,~}}}\\!=n^{-a+o(\\overline{{1}})}$ and $q=n^{-b+o(1)}$ for some constants $a,b\\in[0,1)$ , then community recovery is easy as long as $\\operatorname*{lim}\\operatorname*{inf}_{n\\to\\infty}|p_{n}/q_{n}-1|>0$ (see [48]). ", "page_idx": 2}, {"type": "text", "text": "In this work, we focus on the \u201cbottleneck regime\u201d of logarithmic average degree, which is the bare minimum for the graph to be connected, and which is when exact community recovery is most interesting. In most of the paper we assume that $p\\,=\\,a{\\frac{\\log n}{n}}$ logn n and q = b l ogn n for some positive constants $a,b$ . For an SBM with two balanced communities and these parameters, there is a sharp information-theoretic threshold for exact community recovery, which is given by $D_{+}(a,b)=1$ , where $D_{+}(a,b):=(\\sqrt{a}-\\sqrt{b})^{2}/2$ (see [48, 2, 4, 1]). This quantity is known as the Chernoff\u2013Hellinger divergence in the general $k$ -community SBM setting with linear size communities [4] and simplifies to the above form in our setting. In other words, when $D_{+}(a,b)>1$ , there exists an estimator $\\widehat{\\pmb{\\sigma}}$ that is computable in polynomial-time and which achieves exact community recovery with high probability. On the other hand, when $D_{+}(a,b)<1$ , exact community recovery is impossible, in the sense that for all estimators\u03c3 we have that limn\u2192\u221eP(| n1 $\\begin{array}{r}{\\operatorname*{lim}_{n\\to\\infty}\\mathbb{P}(|\\frac{1}{n}\\sum_{i=1}^{n}\\widehat{\\pmb{\\sigma}}(i)\\pmb{\\sigma}_{\\ast}(i)|\\stackrel{\\cdot}{=}1)\\stackrel{\\cdot}{=}0.}\\end{array}$ . Moreover, when it is possible to achiev e  exact community recovery on a sing l e graph, several polynomial-time algorithms have been studied by previous works (e.g., [48, 2]). ", "page_idx": 2}, {"type": "text", "text": "Community recovery and graph matching. What are the information-theoretic limits for exact community recovery given two correlated SBMs $\\begin{array}{r}{(G_{1},G_{2})\\,\\sim\\,\\mathrm{CSBM}(n,a\\frac{\\log n}{n},b\\frac{\\log n}{n},s)^{\\frac{\\log n}{2}}}\\end{array}$ This question was initiated and partially solved by R\u00e1cz and Sridhar [58], and subsequently fully solved by Gaudio, R\u00e1cz, and Sridhar [26]. Without yet going into the details, these works highlight the importance of graph matching, that is, the task of recovering the latent matching $\\pi_{*}$ given the two correlated graphs $\\left(G_{1},G_{2}\\right)$ . In brief, when $\\pi_{*}$ can be perfectly recovered from $\\left(G_{1},G_{2}\\right)$ , then one can take the union graph $G_{1}\\lor_{\\pi_{*}}G_{2}$ of $G_{1}$ and $G_{2}$ , which is also an SBM, but with a larger edge density, which makes community recovery easier. This shows that exact community recovery is possible from $\\left(G_{1},G_{2}\\right)$ even in parameter regimes where this is impossible from just a single graph $G_{1}$ (see [58]). ", "page_idx": 2}, {"type": "text", "text": "", "page_idx": 3}, {"type": "text", "text": "Graph matching. Motivated by the above discussion, we now discuss average-case graph matching and notions of recovery. In general, suppose that $\\left(G_{1},G_{2}\\right)$ are two correlated random graphs with $n$ vertices each and that $\\pi_{*}$ is the underlying latent vertex matching. The goal of graph matching is to output an estimator $\\widehat{\\pi}=\\widehat{\\pi}(G_{1},G_{2})$ that is close to $\\pi_{*}$ . There are various notions of recovery depending on how close $\\widehat{\\pi}$ is to $\\pi_{*}$ ; the two most relevant notions are the following. We say that an estimator $\\widehat{\\pi}$ achieves exa  ct graph matching if $\\begin{array}{r}{\\operatorname*{lim}_{n\\to\\infty}\\mathbb{P}(\\widehat{\\pi}=\\pi_{*})=1}\\end{array}$ . We say that an estimator achieves almost exact graph matching if with high probability there exists a subset $I\\subseteq[n]$ with $|I|=(1-o(1))n$ such that $\\widehat{\\pi}|_{I}=\\pi_{*}|_{I}$ , where $\\pi|_{I}$ denotes the restriction of $\\pi$ to $I$ . In words, almost exact graph matching allows the estimator to make a vanishing fraction of errors. ", "page_idx": 3}, {"type": "text", "text": "The graph matching problem has been widely studied, with applications to computer vision [13, 37], computational biology [61], and social networks [57]. In particular, de-anonymizing social networks is possible with graph matching algorithms, which implies that anonymity is not equivalent to privacy [52]. That said, studying the limits of graph matching algorithms\u2014including potential information-computation gaps, as we shall discuss\u2014can help guide data regulators on when to take more actions with regards to data protection, in addition to anonymity. ", "page_idx": 3}, {"type": "text", "text": "As discussed in the introductory paragraphs, there has been a large body of recent work on averagecase graph matching, both studying correlated Erd\u02ddos\u2013R\u00e9nyi random graphs [57, 14, 15, 65, 16, 23, 28, 24, 50, 5, 21, 22, 40, 41, 42, 17, 20, 18] and more general models of correlated random graphs [8, 33, 11, 55, 59, 70, 58, 25, 63, 60, 19, 67, 66, 10]. In particular, R\u00e1cz and Sridhar [58] determined the fundamental information-theoretic limits for exact graph matching in correlated SBMs: in the logarithmic average degree regime discussed above, this threshold is $s^{\\bar{2}}{\\frac{a+b}{2}}=1$ . However, this result is information-theoretic, and the authors posed the open problem of finding an efficient algorithm for exact graph matching, whenever this is information-theoretically possible. ", "page_idx": 3}, {"type": "text", "text": "Our main contribution positively resolves this open problem, giving the first efficient algorithm for graph matching for correlated SBMs with two balanced communities. Our algorithm generalizes the recent breakthrough work of Mao, Wu, Xu, and Yu [42] that developed an efficient graph matching algorithm for correlated Erd\u02ddos\u2013R\u00e9nyi graphs. As an application, our results imply novel efficient algorithms and results for community recovery. We now turn to describing our results. ", "page_idx": 3}, {"type": "text", "text": "3 Main results: graph matching ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "Our main theorem for graph matching on correlated SBMs is that there exists a polynomial-time algorithm that can achieve exact matching if $s^{2}>\\alpha$ , where $\\alpha$ is Otter\u2019s tree counting constant1 [56]. ", "page_idx": 3}, {"type": "text", "text": "Theorem 1. Fix constants $a\\neq b>0$ and $s\\in[0,1]$ . Let $(G_{1},G_{2})\\sim\\mathrm{CSBM}(n,a\\frac{\\log n}{n},b\\frac{\\log n}{n},s)$ For any $\\varepsilon>0$ , if ${\\ '}_{s}2\\geq\\alpha+\\varepsilon_{s}$ , then the following holds. ", "page_idx": 3}, {"type": "text", "text": "(a) (Almost exact matching) There exists a polynomial-time algorithm that outputs a subset $I\\in[n]$ and a mapping $\\widehat{\\pi}:I\\rightarrow[n]$ such that $\\widehat{\\pi}=\\pi_{*}|_{I}$ and $|I|=(1-o(1))n$ with high probability. ", "page_idx": 3}, {"type": "text", "text": "(b) (Exact matching) $I f,$ , in addition, $s^{2}(a+b)/2>1,$ , then there exists a polynomial-time algorithm that ouputs a mapping $\\widehat{\\pi}$ such that $\\begin{array}{r}{\\operatorname*{lim}_{n\\to\\infty}\\mathbb{P}(\\widehat{\\pi}=\\pi_{*})=1}\\end{array}$ . ", "page_idx": 3}, {"type": "text", "text": "Several remarks are now in order about the tightness of the main result, an overview of the chandelier counting algorithm when $a=b$ , and the main challenge of our analysis. ", "page_idx": 3}, {"type": "text", "text": "Tightness. This result is tight whenever $s^{2}>\\alpha$ , because $s^{2}(a\\!+\\!b)/2=1$ is the information-theoretic threshold of exact graph matching given two correlated SBMs $\\left(G_{1},G_{2}\\right)$ [58]. When $s^{2}<\\alpha$ , it is conjectured that an information-computation gap exists for the correlated Erdo\u02dds\u2013R\u00e9nyi graphs [42]. Specifically, by assuming that $a=b$ , it is information-theoretically possible to match correlated Erdo\u02dds\u2013R\u00e9nyi graphs exactly if $s^{2}a>1$ [14, 15, 65]. However, it is believed hard to find a polynomialtime algorithm to do this. In our model with SBMs, which is an extension from Erdo\u02dds\u2013R\u00e9nyi graphs, it is also likely hard to find a polynomial-time algorithm when $s^{2}<\\alpha$ . ", "page_idx": 3}, {"type": "image", "img_path": "nBhfIcDnRP/tmp/a32215668e6d6f8585d4ea2de75fa1762809d01b18c3025bf01feea246ec35bc.jpg", "img_caption": ["Figure 2: Phase diagram for graph matching on $\\begin{array}{r}{(G_{1},G_{2})\\sim\\mathrm{CSBM}(n,\\frac{a\\log n}{n},\\frac{b\\log n}{n},s)}\\end{array}$ . The red diagonal line depicts $a=b$ , which is an Erdo\u02dds\u2013R\u00e9nyi graph. Black regions: exact graph matching is possible and can be done efficiently for each community separately by applying the graph matching algorithm for correlated Erd\u02ddos\u2013R\u00e9nyi graphs; Green regions: exact graph matching is possible and can be done efficiently; Light green regions: exact graph matching is impossible, but almost exact graph matching is possible and can be done efficiently; Cyan regions: exact graph matching is possible and can be done efficiently by first recovering the community labels almost exactly; Yellow regions: exact graph matching is impossible but almost exact graph matching can be done efficiently by first recovering the community labels almost exactly. "], "img_footnote": [], "page_idx": 4}, {"type": "text", "text": "Signed chandelier counts. Our theorem extends from the main theorem in Mao et al. [42], which proposed a polynomial-time algorithm that matches the correlated Erdo\u02dds\u2013R\u00e9nyi graphs exactly. The algorithm has two main steps: First, construct signature vectors $s_{i}$ and $\\pmb{t}_{j}$ for vertices $i\\,\\in\\,[n]$ in $G_{1}$ and $j\\in[n]$ in $G_{2}$ by the signed subgraph counts of a specially designed graph class\u2014termed Chandeliers\u2014and calculate the weighted inner product of pairs of signature vectors $\\langle s_{i},t_{j}\\rangle$ and match vertices if the inner product value is large enough; Second, use a seeded graph matching algorithm to boost the almost exact graph matching algorithm to exact graph matching. It is natural to adapt this algorithm from correlated Erdo\u02dds\u2013R\u00e9nyi graphs to correlated SBMs but the details present non-trivial challenges, as we explain below. ", "page_idx": 4}, {"type": "text", "text": "Main challenge. The main challenge on correlated SBMs is that signed subgraph counts is no longer a free lunch. Signed subgraph counts is counting the subgraphs on a centralized adjacency matrix, which is first proposed by Bubeck et al. [9] and later commonly used to control the variance of counting statistics. The success of the chandelier counting method relies on the sufficient separation of the two inner product distributions of true and false vertex correspondence. We want to find a way that keeps doing the adjacency matrices centralization possible. Recall that we explore the graph matching motivated by community recovery. Interestingly, the solution to this centralization problem is now the other way around\u2014using a rough community label estimate to help the graph matching. Our main technical contributions are first showing that when there are no error occurs in the community label estimate, the signed chandelier counting can be generalized to correlated SBMs and then show that when the exact community recovery is not possible, the errors introduced in the community label estimation, which is polynomial in $n$ , are actually tolerable for the whole algorithm. ", "page_idx": 4}, {"type": "text", "text": "The analysis falls in two cases. If $s D_{+}(a,b)>1$ , then we can achieve exact community recovery on each of the graphs by applying the community recovery algorithm from [48]. In addition, if $s^{2}{\\frac{a}{2}}>1$ , 2 then it suffices to look at each community individually. This is easy and follows in a black-box fashion from [42] (See Section 7). However, on the other side, $s^{2}\\frac{a}{2}<1$ , one still needs to use information the community information. Therefore, we need to go through the whole algorithm analysis again in this case. Note that the analysis would work for both regimes with no constraint on $s^{2}{\\frac{a}{2}}<1$ . We plot the black-box regime in black and the non-black-box regime in green in Figure 2. ", "page_idx": 4}, {"type": "text", "text": "The second case is even trickier. If $s D_{+}(a,b)<1$ , by the same algorithm, we can only obtain almost exact correct community labels ${\\widehat{\\pmb{\\sigma}}}_{A}$ and $\\widehat{\\pmb{\\sigma}}_{B}$ on graph $G_{1}$ and $G_{2}$ , respectively. We perform adjacency matrix centralization based on ${\\widehat{\\pmb{\\sigma}}}_{A}$ and $\\widehat{\\pmb{\\sigma}}_{B}$ and show that the error introduced in this step is negligible in the sense that the inner-product scores remains sufficiently distinguishable between true pairs $(j=\\pi_{*}(i))$ and fake pairs $\\bar{(j)}\\neq\\pi_{*}(i))$ . ", "page_idx": 4}, {"type": "image", "img_path": "nBhfIcDnRP/tmp/50cb7ca3d77d0d3396d860f0a727e63e9b692c5a72ac8200b5daef89995bf817.jpg", "img_caption": ["Figure 3: Phase diagram for exact community recovery with fixed $s$ on correlated SBMs. Green regions: exact community recovery is possible from $G_{1}$ alone and can be done efficiently; Lightgreen regions: exact community recovery is possible from $\\left(G_{1},G_{2}\\right)$ but impossible from $G_{1}$ alone, exact graph matching can be done efficiently and therefore exact community recovery can be done efficiently; Violet regions: exact community recovery is impossible from $G_{1}$ alone, impossible from $\\left(G_{1},G_{2}\\right)$ if $\\begin{array}{r}{s^{2}(\\frac{a+b}{2})+s(1-s)D_{+}(a,b)<1}\\end{array}$ and possible if $\\begin{array}{r}{s^{2}(\\frac{a+b}{2})+s(1-s)D_{+}(a,b)>1}\\end{array}$ [25]. It is unknown whether there exists an efficient algorithm for exact community recovery in this regime. "], "img_footnote": [], "page_idx": 5}, {"type": "text", "text": "", "page_idx": 5}, {"type": "text", "text": "4 Application: community recovery ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "Once matching up the vertices on two correlated graphs, we can combine the information of them onto a union graph and then immediately have an application on community recovery. Our result for community detection is that there exists a polynomial-time algorithm for exact community recovery on correlated SBMs when the squared edge correlation parameter satisfies s2 > \u03b1. ", "page_idx": 5}, {"type": "text", "text": "Theorem 2. Fix constants $a\\neq b>0$ and $s\\in[0,1]$ . Let $(G_{1},G_{2})\\sim\\mathrm{CSBM}(n,a\\frac{\\log n}{n},b\\frac{\\log n}{n},s).$ For any $\\varepsilon>0$ , $i f$ ", "page_idx": 5}, {"type": "equation", "text": "$$\ns^{2}\\geq\\alpha+\\varepsilon\\quad a n d\\quad(1-(1-s)^{2})D_{+}(a,b)>1,\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "then, there exists an estimator $\\widehat{\\pmb{\\sigma}}=\\widehat{\\pmb{\\sigma}}(G_{1},G_{2})$ that can be computed in polynomial-time such that $\\begin{array}{r}{\\operatorname*{lim}_{n\\to\\infty}\\mathbb{P}(|\\frac{1}{n}\\sum_{i=1}^{n}\\widehat{\\pmb{\\sigma}}(i)\\pmb{\\sigma}_{*}(i)|=1)=1.}\\end{array}$ . ", "page_idx": 5}, {"type": "text", "text": "Theorem 2 is a direct application of our Theorem 1. The proof mainly follows the Theorem 3.3 in [58], which gives exact community recovery on the union graph of $G_{1}$ and $G_{2}$ regarding to the permutation $\\widehat{\\pi}$ , $G_{1}\\lor\\widehat{\\pi}\\;{\\cal G}_{2}$ . The key difference is that we substitute the maximum a posterior estimator used in the first step with the $\\widehat{\\pi}(\\dot{G}_{1},G_{2})$ output by the algorithm used to prove Theorem 1. Figure 3 is a summary of the phase diagram for community recovery determined by this work along with previous works [58, 25], focusing on the exact community recovery and efficiency. ", "page_idx": 5}, {"type": "text", "text": "Remark 1. Consider $a$ more general correlated SBMs with $K$ correlated graphs $\\begin{array}{r}{(G_{1},G_{2},\\ldots,G_{K})\\sim\\mathrm{CSBM}(n,a\\frac{\\log n}{n},b\\frac{\\log n}{n},s,K)}\\end{array}$ . Theorem 1 also implies an efficient algorithm for exact community recovery above the exact graph matching threshold for $K$ correlated SBMs when $\\begin{array}{r}{D_{+}(a,b)>\\frac{1}{1-(1-s)^{K}}}\\end{array}$ (Theorem 3.6 in $[58])$ ). ", "page_idx": 5}, {"type": "text", "text": "5 Algorithm and the overview of the proofs ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "In this section, we define a few key concepts, give a brief overview of the algorithm, and briefly discuss the proof of Theorem 1 and challenges. See Appendix C for a full version. ", "page_idx": 5}, {"type": "text", "text": "Chandelier. An $(L,M,K,R,D)$ -chandelier is a rooted tree with $L$ branches, each of which consists of a path with $M$ edges ( $M$ -wire), followed by a rooted tree with $K$ edges $K$ -bulb); the $K$ -bulbs are non-isomorphic to each other, each of them has at most $R$ automorphisms, and the maximum degree is at most $D$ . For each chandelier $H$ , let $\\kappa(H)$ denote the set of bulbs of $H$ . ", "page_idx": 5}, {"type": "text", "text": "For a rooted tree $T$ , let $\\operatorname{aut}(H)$ denote the number of rooted automorphisms of $T$ throughout this paper. We abbreviate rooted automorphism as automorphism when it is clear that we are applying it to a chandelier. The number of automorphisms of $H$ is determined by the automorphisms of its bulbs. ", "page_idx": 6}, {"type": "text", "text": "Let $\\tau$ denote the family of non-isomorphic $(L,M,K,R,D)\\cdot$ \u2013chandelier. The family size of chandelier is $|\\mathcal{T}|=(|\\mathcal{T}|)$ , where $\\mathcal{I}\\equiv\\mathcal{I}(\\boldsymbol{K},\\boldsymbol{R},\\boldsymbol{D})$ denotes the collection of unlabeled rooted trees with $K$ edges, at most $R$ automorphisms, and maximum degree $D$ . Otter [56] showed that the number of unlabeled rooted trees with $K$ edges (and no constraint on the automorphisms and vertex degrees) is $|{\\mathcal{I}}(K,\\infty,\\infty)|=(\\alpha+o(1))^{-K}$ , where $\\alpha\\approx0.338$ . We show that under proper choices of $R$ and $D$ , we have $|{\\mathcal{I}}(K,R,D)|=(\\alpha+o(1))^{-K}$ in Section C. ", "page_idx": 6}, {"type": "text", "text": "Algorithm overview. Given $(G_{1},G_{2})\\sim\\mathrm{CSBM}(n,p,q,s)$ . Our algorithm contains mainly three steps. Firstly, we apply the Algorithm 3 (discussed in Section D.3) by Mossel, Neeman, and Sly [48] to obtain almost exact community label estimates for each single graph. Secondly, we calculate the signed chandelier counting [42] based similarity score to give an almost exact graph matching (Algorithm 1 and Algorithm 4). Lastly, we boost the almost exact matching to exact matching by extending the seeded graph matching algorithm [42] on Erdo\u02dds\u2013R\u00e9nyi graphs to SBMs (Algorithm 2). ", "page_idx": 6}, {"type": "text", "text": "Subgraph counts. For an arbitrary weighted adjacency matrix $M$ of some adjacency matrix $A$ , vertex $i\\bar{\\in}\\,[n]$ , and a rooted graph $H$ , we define the weighted subgraph counts on $M$ as ", "page_idx": 6}, {"type": "equation", "text": "$$\nW_{i,H}(M):=\\sum_{S(i)\\cong H}M_{S},\\;\\mathrm{where\\;}M_{S}:=\\prod_{e\\in E(S)}M_{e},\n$$", "text_format": "latex", "page_idx": 6}, {"type": "text", "text": "where $S(i)$ enumerates through all subgraphs on the complete graph $K_{n}$ , rooted at $i$ and are isomorphic to $H$ . When $M$ is the adjacency matrix itself, $W_{i,H}(M)$ is the usual subgraph count, representing the number of subgraphs rooted at $i$ in $M$ that are isomorphic to $H$ . When $M$ is the centralized adjacency matrix $\\overline{{A}}:=A-\\mathbb{E}[A]$ , we call $W_{i,H}(M)$ a signed subgraph count following [9]. However, we do not have access to $\\mathbb{E}[A]$ in many cases. Specifically for SBM, we can estimate $\\mathbb{E}[A]$ through estimating the community labels. We define the approximately centralized adjacency matrix regarding to community label estimate $\\widehat{\\pmb{\\sigma}}$ , denoted as $\\overline{{A}}^{\\widehat{\\sigma}}$ , entry-wise as $\\overline{{A}}_{i,j}^{\\widehat{\\pmb{\\sigma}}}=A_{i,j}-p\\mathbf{1}_{\\widehat{\\pmb{\\sigma}}[i]=\\widehat{\\pmb{\\sigma}}[j]}-q\\mathbf{1}_{\\widehat{\\pmb{\\sigma}}[i]\\neq\\widehat{\\pmb{\\sigma}}[j]}$ . Given a family $\\mathcal{H}$ of non-isomorphic rooted graphs, we define the subgraph count signature of vertex $i$ as $W_{i}^{\\mathcal{H}}(M)\\overset{\\cdot}{:=}(W_{i,H}(M))_{H\\in\\mathcal{H}}$ . ", "page_idx": 6}, {"type": "text", "text": "", "page_idx": 6}, {"type": "text", "text": "Similarity score. Given a pair of correlated SBMs $(G_{1},G_{2})$ , we define the similarity score between vertex $i$ on graph $G_{1}$ and vertex $j$ on graph $G_{2}$ as a weighted inner product between two signatures: ", "page_idx": 6}, {"type": "equation", "text": "$$\n\\Phi_{i j}:=\\langle W_{i}^{T}(\\overline{{A}}),W_{j}^{T}(\\overline{{B}})\\rangle:=\\sum_{H\\in\\mathcal{T}}\\mathrm{aut}(H)W_{i,H}(\\overline{{A}})W_{j,H}(\\overline{{B}}).\n$$", "text_format": "latex", "page_idx": 6}, {"type": "text", "text": "When we do not have access to $\\overline{{A}}$ and $\\overline{B}$ , we use the approximately centralized adjacency matrices A and B . We define the similarity score in a slightly different notation: ", "page_idx": 6}, {"type": "equation", "text": "$$\n\\Phi_{i j}^{\\widehat{\\sigma}}:=\\langle W_{i}^{\\mathcal{T}}(\\overline{{A}}^{\\widehat{\\sigma}_{A}}),W_{j}^{\\mathcal{T}}(\\overline{{B}}^{\\widehat{\\sigma}_{B}})\\rangle=\\sum_{H\\in\\mathcal{T}}\\operatorname{aut}(H)W_{i,H}(\\overline{{A}}^{\\widehat{\\sigma}_{A}})W_{j,H}(\\overline{{B}}^{\\widehat{\\sigma}_{B}}).\n$$", "text_format": "latex", "page_idx": 6}, {"type": "text", "text": "Almost exact graph matching. The first part in the analysis is to show that by calculating this similarity score, with an appropriate thresholding strategy, we can match up $(1\\stackrel{\\cdot}{-}o(1))n$ vertices correctly (Theorem 3). The high-level idea is to show that the similarity score distributions are well-separated between true pairs and fake pairs. We expect the similarity score having the following properties, under event $\\begin{array}{r}{\\mathcal{H}:=\\{\\frac{n}{2}-n^{\\frac{3}{4}}\\leq\\bar{|V^{+}|},|V^{-}|\\leq\\frac{n}{2}+n^{\\frac{3}{4}}\\}}\\end{array}$ (to be discussed in Section D.2): ", "page_idx": 6}, {"type": "text", "text": "\u2022 For true pairs $j=\\pi(i)$ : ", "page_idx": 6}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\mathbb{E}[\\Phi_{i\\pi_{*}(i)}^{\\widehat{\\sigma}}\\mathbf{1}_{\\mathcal{H}}]>0,\\quad\\mathrm{Var}[\\Phi_{i j}^{\\widehat{\\sigma}}\\mathbf{1}_{\\mathcal{H}}]=o\\left(\\mathbb{E}[\\Phi_{i\\pi_{*}(i)}^{\\widehat{\\sigma}}\\mathbf{1}_{\\mathcal{H}}]^{2}\\right),}\\end{array}\n$$", "text_format": "latex", "page_idx": 6}, {"type": "text", "text": "\u2022 For fake pairs $j\\neq\\pi(i)$ : ", "page_idx": 6}, {"type": "equation", "text": "$$\n\\mathbb{E}[\\Phi_{i j}^{\\widehat{\\sigma}}\\mathbf{1}_{\\mathcal{H}}]=o\\left(\\mathbb{E}[\\Phi_{i\\pi_{*}(i)}^{\\widehat{\\sigma}}\\mathbf{1}_{\\mathcal{H}}]\\right),\\quad\\mathrm{Var}[\\Phi_{i j}^{\\widehat{\\sigma}}\\mathbf{1}_{\\mathcal{H}}]=o\\left(\\frac{\\mathbb{E}[\\Phi_{i\\pi_{*}(i)}^{\\widehat{\\sigma}}\\mathbf{1}_{\\mathcal{H}}]^{2}}{n^{2}}\\right).\n$$", "text_format": "latex", "page_idx": 6}, {"type": "text", "text": "Precisely forming bounds for these moments constitutes the main bulk of the paper. We provide results from Proposition 1 to Proposition 6. Followed by these moment bounds, we have Theorem 3. ", "page_idx": 7}, {"type": "text", "text": "Theorem 3. Fix $a~\\neq~b~>~0$ and $s~\\in~[0,1]$ . Let $p\\ =\\ a\\frac{\\log n}{n},q\\ =\\ b\\frac{\\log n}{n}$ and $(G_{1},G_{2})~\\sim$ $\\mathrm{CSBM}(n,p,q,s)$ . For any $\\varepsilon\\ \\geq\\ 0,$ , suppose $s^{2}\\ \\geq\\ \\alpha\\,+\\,\\varepsilon$ . There exists positive constants $C_{1},C_{2},C_{3},C_{4},C_{5}>0$ such that the following holds. Pick $K,M,L,N,D$ as ", "page_idx": 7}, {"type": "equation", "text": "$$\nL=\\frac{C_{1}}{\\varepsilon},\\quad K=C_{2}\\log n,\\quad M=\\frac{C_{3}K}{\\log(n s(p\\wedge q))},\\quad R=\\exp(C_{4}K),\\quad D=C_{5}\\frac{\\log n}{(\\log\\log n)^{2}}.\n$$", "text_format": "latex", "page_idx": 7}, {"type": "text", "text": "Pick an arbitrary c \u2208(0, 1) and set \u00b5 = |T |nN\u03c1N\u03c3e2fNf , where \u03c3e2ff := (\u03c32++2\u03c32\u2212). Then, Algorithm 1 outputs a set with size and a mapping such that with high probability. ", "page_idx": 7}, {"type": "text", "text": "Proof challenge. In regime $s D_{+}(a,b)>1$ , the probability of existing one vertex being classified incorrectly is vanishing for Algorithm 3. Therefore, with high probability, $\\overline{{{A}}}^{\\widehat{\\pmb{\\sigma}}_{A}}=\\overline{{{A}}}$ . If $s D_{+}(a,b)<$ 1, then the recovered $\\widehat{\\pmb{\\sigma}}$ contains errors (polynomial in $n$ ), which will cause some edges being centralized incorrectly and thereby affect the moments calculation. ", "page_idx": 7}, {"type": "text", "text": "This phenomenon poses a challenge to the algorithm analysis. We highlight some key points in the context of second moment calculation. For simplicity, we ignore event $\\mathcal{H}$ here. From definition, ", "page_idx": 7}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathrm{Var}[\\Phi_{i j}^{\\widehat{\\sigma}}]=\\displaystyle\\sum_{H,I\\in\\mathcal{T}}\\mathrm{aut}(H)\\mathrm{aut}(I)\\sum_{S_{1}(i),S_{2}(j)\\cong H}\\displaystyle\\sum_{T_{1}(i),T_{2}(j)\\cong I}\\left(\\mathbb{E}_{\\sigma_{\\star}}\\left[\\mathbb{E}[\\overline{{A}}_{S_{1}}^{\\widehat{\\sigma}_{A}}\\overline{{B}}_{S_{2}}^{\\widehat{\\sigma}_{B}}\\overline{{A}}_{T_{1}}^{\\widehat{\\sigma}_{A}}\\overline{{B}}_{T_{2}}^{\\widehat{\\sigma}_{B}}\\ |\\ \\sigma_{*}]\\right]\\right.}\\\\ &{\\left.\\qquad\\qquad\\qquad-\\left.\\mathbb{E}_{\\sigma_{\\star}}\\left[\\mathbb{E}[\\overline{{A}}_{S_{1}}^{\\widehat{\\sigma}_{A}}\\overline{{B}}_{S_{2}}^{\\widehat{\\sigma}_{B}}\\ |\\ \\sigma_{*}]\\right]\\mathbb{E}_{\\sigma_{\\star}}\\left[\\mathbb{E}[\\overline{{A}}_{T_{1}}^{\\widehat{\\sigma}_{A}}\\overline{{B}}_{T_{2}}^{\\widehat{\\sigma}_{B}}\\ |\\ \\sigma_{*}]\\right]\\right).}\\end{array}\n$$", "text_format": "latex", "page_idx": 7}, {"type": "text", "text": "Let us define the union graph $U:=S_{1}\\cup S_{2}\\cup T_{1}\\cup T_{1}{}^{3}$ . If $s D_{+}(a,b)>1$ , we view $\\overline{{A}}^{\\widehat{\\sigma}}$ and $\\overline{{B}}^{\\widehat{\\sigma}}$ as $\\overline{{A}}$ and $\\overline{B}$ , respectively. $\\mathbb{E}[\\overline{{A}}_{S_{1}}\\overline{{B}}_{S_{2}}\\overline{{A}}_{T_{1}}\\overline{{A}}_{T_{2}}\\ |\\ \\pmb{\\sigma}_{*}]\\neq0$ only if there exists no edge $e\\in E(U)$ such that it occurs only once among $(S_{1},S_{2},T_{1},T_{2})$ . This is because different edges are independent and centralized conditioned on $\\pmb{\\sigma}_{*}$ . ", "page_idx": 7}, {"type": "text", "text": "However, in regime $s D_{+}(a,b)\\;<\\;1$ , $\\mathbb{E}[\\overline{{A}}_{S_{1}}^{\\widehat{\\pmb{\\sigma}}_{A}}\\overline{{B}}_{S_{2}}^{\\widehat{\\pmb{\\sigma}}_{B}}\\overline{{A}}_{T_{1}}^{\\widehat{\\pmb{\\sigma}}_{A}}\\overline{{B}}_{T_{2}}^{\\widehat{\\pmb{\\sigma}}_{B}}\\textbf{|}\\,\\pmb{\\sigma}_{*}]\\ \\neq\\ 0$ even when edges are not occurring multiple times as we have the expectation of $\\overline{{A}}_{e}^{\\widehat{\\sigma}_{A}}$ can be non-zero when conditioning on $\\pmb{\\sigma}_{*}$ and an estimate ${\\widehat{\\pmb{\\sigma}}}_{A}$ that disagrees with $\\pmb{\\sigma}_{*}$ on the edge type (i.e., for $e=(u,v),\\pmb{\\sigma}_{\\ast}(u)\\pmb{\\sigma}_{\\ast}(\\bar{v})\\neq$ ${\\widehat{\\pmb{\\sigma}}}_{A}(u){\\widehat{\\pmb{\\sigma}}}_{A}(v))$ . Thi s not only causes this cross-moments calculation being more complicated, but significantly increasing the possibility of the combinations between $S_{1},S_{2},T_{1}$ , and $T_{2}$ . ", "page_idx": 7}, {"type": "text", "text": "The most important high-level idea to properly bound the moments is: the cross-moment conditioning on a specific $\\widehat{\\pmb{\\sigma}}=(\\widehat{\\pmb{\\sigma}}_{A},\\widehat{\\pmb{\\sigma}}_{B})$ would be non-trivial if and only if all edges occurring only once are centralized incorrectly. Assuming there are $z$ edges occurring once, we show that the probability that $\\widehat{\\pmb{\\sigma}}$ satisfying this property is no greater than n\u2212 $n^{-\\frac{z(s D_{+}(a,b)^{-}\\varepsilon\\log(a/b)/2)}{D}}$ for any $\\varepsilon>0$ , by using the  d efinition of $\\tau$ and Lemma 8 later in Section K and Section L. It turns out that we require $\\begin{array}{r}{n^{-\\frac{z\\left(s D+\\left(a,b\\right)-\\varepsilon\\log\\left(a/b\\right)/2\\right)}{D}}}\\end{array}$ to be $O\\big(\\frac{1}{\\log^{C}n}\\big)$ for some positive constant $C$ so that (1) and (2) are satisfied. ", "page_idx": 7}, {"type": "text", "text": "Efficient algorithm. Calculating $\\Phi_{i j}^{\\widehat{\\sigma}}$ exactly (Algorithm 1) takes quasi-polynomial time as searching for all $S\\cong H$ has time complexity $\\bar{n}^{\\Theta(N)}$ . Algorithm 4 in Section F computes an approximated score in polynomial time. Specifically, we follow the color coding-based similarity score approximation from [42]. The basic idea is coloring the stochastic block model using $N+1$ colors uniformly at random. Then, we only do signed counts on vertex sets that are colorful with $N+1$ distinct colors. We show that this is an unbiased estimator of $\\Phi_{i j}^{\\widehat{\\sigma}}$ and only potentially increase the variance by an additional constant factor in Section F. The result is stated as in Theorem 4. ", "page_idx": 7}, {"type": "text", "text": "Theorem 4. Theorem 3 continues to hold with the color-coding sampled estimation $\\widetilde{\\Phi}_{i j}^{\\widehat{\\sigma}}$ in place of $\\Phi_{i j}^{\\widehat{\\sigma}}$ . Moreover, by Algorithm 4, $\\{\\widetilde{\\Phi}_{i j}^{\\widehat{\\sigma}}\\}_{i,j\\in[n]}$ can be computed in $O(n^{C})$ for some constant $C\\equiv C(\\varepsilon)$ depending only on $\\varepsilon$ , where $\\varepsilon$ is from (3). ", "page_idx": 7}, {"type": "text", "text": "Exact graph matching. The final step of the algorithm is boosting the almost exact matching to a exact matching. The key idea is exploring the number of common neighbors. ", "page_idx": 8}, {"type": "text", "text": "Define $h(x)=x\\log x-x+1$ . Denote $\\mathrm{N}_{\\pi}(i,j)$ as the number of common neighbors of $i$ and $j$ under correspondence $\\pi$ . The idea is that if $i$ and $j$ form a true correspondence, then, with high probability $\\begin{array}{r}{\\bar{\\mathrm{N}}_{\\widetilde{\\pi}}(i,j)\\ge\\gamma\\frac{p^{2}+q^{2}}{2}s^{2}(n+2n^{\\frac{3}{4}})}\\end{array}$ , under the nice event $\\mathcal{H}$ . Therefore, we match up $i$ and $j$ if they have m ore common neighbors than this threshold. We give the following guarantee. ", "page_idx": 8}, {"type": "text", "text": "Theorem 5. Fix $a~\\neq~b~>~0$ and $s~\\in~[0,1]$ . Let $p\\ =\\ a\\frac{\\log n}{n},q\\ =\\ b\\frac{\\log n}{n}$ and $(G_{1},G_{2})~\\sim$ . Suppose $\\begin{array}{r}{s^{2}(\\frac{a+b}{2})\\,\\geq\\,1+\\varepsilon}\\end{array}$ and $s^{2}\\,\\geq\\,\\alpha+\\varepsilon$ , for some $\\varepsilon\\ >\\ 0$ . Let $\\gamma$ be the unique solution in (1, \u221e) to h(\u03b3) = (n3\u2212 l2o)gp nqs2 . Then, the seeded matching Algorithm 2 with input $\\widehat{\\pi}$ and an index set $I\\subset[n],|I|=_{.}(1-o(1))n\\geq(1-\\varepsilon/16)n$ such that $\\widehat{\\pi}|_{I}=\\pi_{*}$ outputs an exact   matching $\\widetilde{\\pi}=\\pi_{*}$ in $O(\\bar{n}^{3}(p+q)^{2})$ time with probability $1-o(1)$ . ", "page_idx": 8}, {"type": "text", "text": "Putting these pieces together implies Theorem 1. From Theorem 4, we know that for $(G_{1},G_{2})\\sim$ $\\mathrm{CSBM}(n,a\\frac{\\log n}{n},b\\frac{\\log n}{n},s),$ , $a\\neq b$ , if $s^{2}\\geq\\alpha\\!+\\!\\varepsilon$ for some $\\varepsilon>0$ then there we can match $(1\\!-\\!o(1))n$ vertices correctly and efficiently with high probability. Take the returned $\\widehat{\\pi}$ from Algorithm 4 as input of Algorithm 2, then Theorem 5 guarantees that the final output $\\widetilde{\\pi}=\\pi_{*}$ with high probability. ", "page_idx": 8}, {"type": "text", "text": "6 Related work ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "Graph Matching. Correlated Erdo\u02dds\u2013R\u00e9nyi graphs were first studied in [57] for social network deanonymization. The information-theoretic threshold for partial matching was determined by [24, 28] and the information-theoretic threshold for exact graph matching was determined by [14, 15, 65]. ", "page_idx": 8}, {"type": "text", "text": "Mao et al. [41] proposed the first efficient algorithm that achieves exact graph matching for correlated Erdo\u02dds\u2013R\u00e9nyi graphs with average degree $(\\stackrel{\\cdot}{1}+\\varepsilon)\\log n\\leq n q\\leq n^{\\frac{1}{\\Theta(\\log\\log n)}}$ and constant noise. This algorithm only requires a constant edge correlation (sufficiently close to 1) rather than converging to 1, which represents a perfect correlation. Mao et al. [42] followed up with an improved efficient algorithm that achieves exact graph matching for any correlation $\\rho$ satisfying $\\rho^{2}>{\\dot{\\alpha}}$ when $n q(q+$ $\\rho(1-q))\\geq(1+\\varepsilon)\\log n$ . It is conjectured that for random graphs of logarithmic average degree, $\\rho^{2}=\\alpha$ is the computational threshold [42]. Muratori and Semerjian [51] added a small constant constraint on the maximum vertex degree of a chandelier to improve the runtime, at the expense of having a slightly larger constant $\\widehat{\\alpha}$ as the minimum squared correlation requirement. ", "page_idx": 8}, {"type": "text", "text": "In the denser regime where $p\\;=\\;n^{-a+o(1)}$ , $a~\\in~(0,1]$ , Ding and Du [17] established a sharp information-theoretic threshold for matching a positive fraction of vertices. Ding and Li [20] also developed an efficient algorithm for exact graph matching whenever the edge correlation is nonvanishing, which goes beyond the Otter\u2019s tree counting constant. ", "page_idx": 8}, {"type": "text", "text": "Several recent works also go beyond correlated Erd\u02ddos\u2013R\u00e9nyi graphs. Wang et al. [64] studied the exact graph matching with additional attribute information on vanishing edge correlation. ", "page_idx": 8}, {"type": "text", "text": "Closely related to our work, Yang et al. [67] adopted the binary tree counting algorithm [41] to give an efficient graph matching algorithm for correlated SBMs. However, [67] makes several significant assumptions (which we do not). For one, the algorithm in [67] assumes that the community labels are known. This is a strong assumption which may be unrealistic in practice; moreover, this precludes using graph matching as a tool for improved community recovery. In contrast, we do not assume that community labels are known; in fact, a significant part of our technical work is devoted to dealing with the errors arising from estimating the community labels. Moreover, our graph matching algorithm can be directly applied to improve community recovery, as discussed in Theorem 2 and Section 3. In addition, [67] makes strong assumptions on the parameters, assuming that (1) the average degree is at least $(\\log n)^{1.1}$ , (2) the SBM has at least 3 communities, and (3) the correlation parameter satisfies $s>1-\\varepsilon_{0}$ for some unspecified (small) $\\varepsilon_{0}$ . In contrast, our results hold in the most interesting regime of logarithmic average degree and the most natural setting of two balanced communities; moreover, our assumption on $s$ is also weaker. ", "page_idx": 8}, {"type": "text", "text": "Community recovery with side information Beyond correlated SBMs, there are some other models utilizing side information, from multiple networks [29, 62, 34, 31, 68, 71], additional covariates [7], or both [45, 38]. Multi-layer SBM is first mentioned in [30], which is generated as following: ", "page_idx": 8}, {"type": "text", "text": "first, generate the community labels for all vertices and fix them for all layers; second, form edges on each layer based on the community labels. Typically, different layers in a multi-layer SBM are conditionally independent given the shared community labels. In addition, several works [45, 38] also encode community membership correlated covariates onto each node. Aside from the multi-layer SBM, Braun and Sugiyama [7] recently studied community detection on a novel variation of SBM whose edges are attached with vectorial covariates. ", "page_idx": 9}, {"type": "text", "text": "7 Discussion and future work ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "Our main contribution in this paper is to give the first efficient algorithm for exact graph matching for correlated SBMs with two balanced communities, as well as a rigorous proof of its correctness (Theorem 1). We also discuss novel applications to community recovery (Theorem 2). At the same time, our work raises many interesting questions for future research, which we discuss here. ", "page_idx": 9}, {"type": "text", "text": "Optimal runtime. While our graph matching algorithm is efficient, it would be desirable to understand the optimal running time that can be achieved. Mao, Rudelson, and Tikhomirov [41] gave an efficient algorithm for matching correlated Erd\u02ddos\u2013R\u00e9nyi graphs with runtime $n^{2+o(1)}$ ; the main drawback is that this algorithm requires the correlation parameter to satisfy $s>1-\\varepsilon_{0}$ for some unspecified (small) $\\varepsilon_{0}\\,>\\,0$ . Nonetheless, it would be interesting to generalize this algorithm to correlated SBMs and the techniques developed in our work may be useful to do so. In very recent (and concurrent) work, Muratori and Semerjian [51] gave faster algorithms for matching correlated Erd\u02ddos\u2013R\u00e9nyi graphs by introducing a constraint on the maximum degree of a chandelier, at the expense of strengthening the condition $s^{2}>\\alpha$ to $s^{2}>\\widehat{\\alpha}$ for some $\\widehat{\\alpha}>\\alpha$ . Exploring the connections between our work and theirs, and generalizing their ideas to correlated SBMs, are of interest. ", "page_idx": 9}, {"type": "text", "text": "Information-computation gap. An important assumption throughout this work is that the correlation parameter satisfies $s^{2}>\\alpha$ . We believe that this is inherently necessary and that there is no efficient algorithm (in the logarithmic average degree regime) when $s^{2}<\\alpha$ . At the same time, exact graph matching is information-theoretically possible whenever $s^{2}(a+b)/2>1$ , so there is a conjectured information-computation gap. This mirrors the conjecture in [42] for Erd\u02ddos\u2013R\u00e9nyi graphs; see also [18] for the low-degree hardness results on the correlation detection and [10] for the very recent low-degree hardness results on testing a pair of correlated stochastic block models against a pair of independent Erdo\u02dds\u2013R\u00e9nyi graphs. ", "page_idx": 9}, {"type": "text", "text": "Efficient exact community recovery when exact graph matching is not possible. Gaudio, R\u00e1cz, and Sridhar [25] determined the information-theoretic threshold for exact community recovery on correlated SBMs, in particular showing that there is a regime when this is possible even though (1) this is impossible with a single graph and also (2) exact graph matching is impossible. It remains unknown whether this can be done efficiently in this regime. We believe that this is possible, and our work is an important starting point for this question, yet additional ideas are needed to understand the subtle interplay between graph matching and community recovery in this regime. ", "page_idx": 9}, {"type": "text", "text": "Sparser and denser regimes. Our work focuses on the most interesting regime where the average degree is logarithmic in $n$ ; it is worth understanding other regimes too. In particular, the chandelier counting algorithm by Mao et al. [42] gives almost exact graph matching whenever the average degree diverges. In our Theorem 1 we require that the average degree diverges logarithmically for the corresponding result, so that the error rate for community recovery estimate is polynomially small in $n$ . It would be interesting to overcome this technical barrier and extend the analysis to this sparser regime. Denser regimes are easier to understand. A close inspection of our analysis shows that it also works when the average degree diverges as a (small) polynomial in $n$ ; in even denser regimes, the community partition can be recovered exactly and efficiently whenever $\\operatorname*{lim}\\operatorname*{inf}_{n\\to\\infty}|p_{n}/q_{n}^{-}-1|>0$ (see [48]) and then the graph matching algorithm in [42] can be applied in a black-box fashion. ", "page_idx": 9}, {"type": "text", "text": "General block models. We focused here on the simplest case of SBMs with two balanced communities. It is of great interest to develop efficient graph matching algorithms in the general block model with $k$ communities, whenever this is possible. Recently, Yang and Chung [66] determined the information-theoretic threshold for exact graph matching in the $k$ -community symmetric SBM, extending the results of R\u00e1cz and Sridhar [58]. We conjecture that substituting the community recovery algorithm used in our work with the degree-profliing algorithm by Abbe and Sandon [4] gives an efficient algorithm for graph matching in this more general setting, assuming again that $s^{2}>\\alpha$ . ", "page_idx": 9}, {"type": "text", "text": "Acknowledgements ", "text_level": 1, "page_idx": 10}, {"type": "text", "text": "We thank Julia Gaudio, Anirudh Sridhar, Yihong Wu, and Jiaming Xu for helpful discussions. We also thank anonymous reviewers for constructive feedback. S.C. was supported in part by the Institute for Data, Econometrics, Algorithms, and Learning (IDEAL), funded through the National Science Foundation TRIPODS Phase II program (NSF grant ECCS 2216970). ", "page_idx": 10}, {"type": "text", "text": "References ", "text_level": 1, "page_idx": 10}, {"type": "text", "text": "[1] Emmanuel Abbe. Community Detection and Stochastic Block Models: Recent Developments. Journal of Machine Learning Research, 18(177):1\u201386, 2018.   \n[2] Emmanuel Abbe, Afonso S. Bandeira, and Georgina Hall. Exact Recovery in the Stochastic Block Model. IEEE Transactions on Information Theory, 62(1):471\u2013487, 2016.   \n[3] Emmanuel Abbe, Jianqing Fan, Kaizheng Wang, and Yiqiao Zhong. Entrywise eigenvector analysis of random matrices with low expected rank. The Annals of Statistics, 48(3):1452\u20131474, 2020.   \n[4] Emmanuel Abbe and Colin Sandon. Community detection in general stochastic block models: Fundamental limits and efficient algorithms for recovery. In 2015 IEEE 56th Annual Symposium on Foundations of Computer Science (FOCS), pages 670\u2013688. IEEE, 2015.   \n[5] Boaz Barak, Chi-Ning Chou, Zhixian Lei, Tselil Schramm, and Yueqi Sheng. (Nearly) Efficient Algorithms for the Graph Matching Problem on Correlated Random Graphs. In Advances in Neural Information Processing Systems (NeurIPS), volume 32, pages 9190\u20139198, 2019.   \n[6] Terry Beyer and Sandra Mitchell Hedetniemi. Constant Time Generation of Rooted Trees. SIAM Journal on Computing, 9(4):706\u2013712, 1980.   \n[7] Guillaume Braun and Masashi Sugiyama. VEC-SBM: Optimal Community Detection with Vectorial Edges Covariates. In Proceedings of The 27th International Conference on Artificial Intelligence and Statistics (AISTATS), volume 238 of Proceedings of Machine Learning Research (PMLR), pages 532\u2013540, 2024.   \n[8] Karl Bringmann, Tobias Friedrich, and Anton Krohmer. De-anonymization of Heterogeneous Random Graphs in Quasilinear Time. In Proceedings of the 22nd Annual European Symposium on Algorithms (ESA), pages 197\u2013208, 2014. [9] S\u00e9bastien Bubeck, Jian Ding, Ronen Eldan, and Mikl\u00f3s Z R\u00e1cz. Testing for high-dimensional geometry in random graphs. Random Structures & Algorithms, 49(3):503\u2013532, 2016.   \n[10] Guanyi Chen, Jian Ding, Shuyang Gong, and Zhangsong Li. A computational transition for detecting correlated stochastic block models by low-degree polynomials. Preprint available at https://arxiv.org/abs/2409.00966, 2024.   \n[11] Carla-Fabiana Chiasserini, Michele Garetto, and Emilio Leonardi. Social Network DeAnonymization Under Scale-Free User Relations. IEEE/ACM Transactions on Networking, 24(6):3756\u20133769, 2016.   \n[12] Charles J. Colbourn and Kellogg S. Booth. Linear Time Automorphism Algorithms for Trees, Interval Graphs, and Planar Graphs. SIAM Journal on Computing, 10(1):203\u2013225, 1981.   \n[13] Donatello Conte, Pasquale Foggia, Carlo Sansone, and Mario Vento. Thirty years of graph matching in pattern recognition. International Journal of Pattern Recognition and Artificial Intelligence, 18(03):265\u2013298, 2004.   \n[14] Daniel Cullina and Negar Kiyavash. Improved Achievability and Converse Bounds for Erdo\u02ddsR\u00e9nyi Graph Matching. In ACM SIGMETRICS, volume 44, pages 63\u201372, 2016.   \n[15] Daniel Cullina and Negar Kiyavash. Exact alignment recovery for correlated Erd\u02ddos-R\u00e9nyi graphs. Preprint available at https://arxiv.org/abs/1711.06783, 2018.   \n[16] Daniel Cullina, Negar Kiyavash, Prateek Mittal, and H. Vincent Poor. Partial Recovery of Erd\u02ddos-R\u00e9nyi Graph Alignment via $k$ -Core Alignment. In ACM SIGMETRICS Performance Evaluation Review, volume 48, pages 99\u2013100. ACM, 2020.   \n[17] Jian Ding and Hang Du. Matching recovery threshold for correlated random graphs. The Annals of Statistics, 51(4):1718\u20131743, 2023.   \n[18] Jian Ding, Hang Du, and Zhangsong Li. Low-Degree Hardness of Detection for Correlated Erdo\u02dds-R\u00e9nyi Graphs. Preprint available at https://arxiv.org/abs/2311.15931, 2023.   \n[19] Jian Ding, Yumou Fei, and Yuanzheng Wang. Efficiently matching random inhomogeneous graphs via degree profiles. Preprint available at https://arxiv.org/abs/2310.10441, 2023.   \n[20] Jian Ding and Zhangsong Li. A polynomial-time iterative algorithm for random graph matching with non-vanishing correlation. Preprint available at https://arxiv.org/abs/2306.00266, 2023.   \n[21] Jian Ding, Zongming Ma, Yihong Wu, and Jiaming Xu. Efficient random graph matching via degree profiles. Probability Theory and Related Fields, 179(1):29\u2013115, 2021.   \n[22] Zhou Fan, Cheng Mao, Yihong Wu, and Jiaming Xu. Spectral Graph Matching and Regularized Quadratic Relaxations: Algorithm and Theory. In Proceedings of the 37th International Conference on Machine Learning (ICML), volume 119 of Proceedings of Machine Learning Research (PMLR), pages 2985\u20132995, 2020.   \n[23] Luca Ganassali and Laurent Massouli\u00e9. From tree matching to sparse graph alignment. In Proceedings of the 33rd Conference on Learning Theory (COLT), volume 125 of Proceedings of Machine Learning Research (PMLR), pages 1633\u20131665, 2020.   \n[24] Luca Ganassali, Laurent Massouli\u00e9, and Marc Lelarge. Impossibility of Partial Recovery in the Graph Alignment Problem. In Proceedings of the 34th Conference on Learning Theory (COLT), volume 134 of Proceedings of Machine Learning Research (PMLR), pages 2080\u20132102, 2021.   \n[25] Julia Gaudio, Mikl\u00f3s Z. R\u00e1cz, and Anirudh Sridhar. Exact Community Recovery in Correlated Stochastic Block Models. In Proceedings of the 35th Conference on Learning Theory (COLT), volume 178 of Proceedings of Machine Learning Research (PMLR), pages 2183\u20132241, 2022.   \n[26] Julia Gaudio, Mikl\u00f3s Z. R\u00e1cz, and Anirudh Sridhar. Exact community recovery in correlated stochastic block models. In Proceedings of Thirty Fifth Conference on Learning Theory (COLT), volume 178 of Proceedings of Machine Learning Research, pages 2183\u20132241. PMLR, 02\u201305 Jul 2022.   \n[27] William M.Y. Goh and Eric Schmutz. Unlabeled Trees: Distribution of the Maximum Degree. Random Structures & Algorithms, 5(3):411\u2013440, 1994.   \n[28] Georgina Hall and Laurent Massouli\u00e9. Partial recovery in the graph alignment problem. Operations Research, 71(1):259\u2013272, 2023.   \n[29] Qiuyi Han, Kevin Xu, and Edoardo Airoldi. Consistent estimation of dynamic and multilayer block models. In International Conference on Machine Learning (ICML), volume 37 of Proceedings of Machine Learning Research (PMLR), pages 1511\u20131520, 2015.   \n[30] Paul W. Holland, Kathryn Blackmond Laskey, and Samuel Leinhardt. Stochastic blockmodels: First steps. Social Networks, 5(2):109\u2013137, 1983.   \n[31] Yaofang Hu and Wanjie Wang. Network-adjusted covariates for community detection. Biometrika, page asae011, 2024.   \n[32] Svante Janson, Tomasz \u0141uczak, and Andrzej Rucinski. Random Graphs. John Wiley & Sons, 2000.   \n[33] Nitish Korula and Silvio Lattanzi. An efficient reconciliation algorithm for social networks. Proceedings of the VLDB Endowment, 7(5):377\u2013388, 2014.   \n[34] Jing Lei, Kehui Chen, and Brian Lynch. Consistent community detection in multi-layer network data. Biometrika, 107(1):61\u201373, 2020.   \n[35] Vince Lyzinski. Information Recovery in Shuffled Graphs via Graph Matching. IEEE Transactions on Information Theory, 64(5):3254\u20133273, 2018.   \n[36] Vince Lyzinski, Daniel L. Sussman, Donniell E. Fishkind, Henry Pao, Li Chen, Joshua T. Vogelstein, Youngser Park, and Carey E. Priebe. Spectral clustering for divide-and-conquer graph matching. Parallel Computing, 47:70\u201387, 2015.   \n[37] Jiayi Ma, Xingyu Jiang, Aoxiang Fan, Junjun Jiang, and Junchi Yan. Image Matching from Handcrafted to Deep Features: A Survey. International Journal of Computer Vision, 129:23\u201379, 2021.   \n[38] Zongming Ma and Sagnik Nandy. Community Detection with Contextual Multilayer Networks. IEEE Transactions on Information Theory, 69(5):3203\u20133239, 2023.   \n[39] Konstantin Makarychev, Rajsekar Manokaran, and Maxim Sviridenko. Maximum Quadratic Assignment Problem: Reduction from Maximum Label Cover and LP-Based Approximation Algorithm. In International Colloquium on Automata, Languages, and Programming (ICALP), pages 594\u2013604. Springer, 2010.   \n[40] Cheng Mao, Mark Rudelson, and Konstantin Tikhomirov. Random Graph Matching with Improved Noise Robustness. In Proceedings of the 34th Conference on Learning Theory (COLT), volume 134 of Proceedings of Machine Learning Research (PMLR), pages 3296\u20133329, 2021.   \n[41] Cheng Mao, Mark Rudelson, and Konstantin Tikhomirov. Exact matching of random graphs with constant correlation. Probability Theory and Related Fields, 186:327\u2013389, 2023.   \n[42] Cheng Mao, Yihong Wu, Jiaming Xu, and Sophie H. Yu. Random Graph Matching at Otter\u2019s Threshold via Counting Chandeliers. In Proceedings of the 55th Annual ACM Symposium on Theory of Computing (STOC), pages 1345\u20131356, 2023.   \n[43] Cheng Mao, Yihong Wu, Jiaming Xu, and Sophie H. Yu. Testing network correlation efficiently via counting trees. The Annals of Statistics, to appear, ${2024+}$ .   \n[44] Laurent Massouli\u00e9. Community detection thresholds and the weak Ramanujan property. In Proceedings of the 46th Annual ACM Symposium on Theory of Computing (STOC), pages 694\u2013703. ACM, 2014.   \n[45] Vaishakhi Mayya and Galen Reeves. Mutual Information in Community Detection with Covariate Information and Correlated Networks. In 2019 57th Annual Allerton Conference on Communication, Control, and Computing (Allerton), pages 602\u2013607. IEEE, 2019.   \n[46] Michael Mitzenmacher and Eli Upfal. Probability and Computing: Randomized Algorithms and Probabilistic Analysis. Cambridge University Press, 2005.   \n[47] Elchanan Mossel, Joe Neeman, and Allan Sly. Stochastic block models and reconstruction. arXiv preprint arXiv:1202.1499, 2012.   \n[48] Elchanan Mossel, Joe Neeman, and Allan Sly. Consistency thresholds for the planted bisection model. Electronic Journal of Probability, 21(none):1 \u2013 24, 2016.   \n[49] Elchanan Mossel, Joe Neeman, and Allan Sly. A proof of the block model threshold conjecture. Combinatorica, 38(3):665\u2013708, 2018.   \n[50] Elchanan Mossel and Jiaming Xu. Seeded graph matching via large neighborhood statistics. Random Structures & Algorithms, 57(3):570\u2013611, 2020.   \n[51] Andrea Muratori and Guilhem Semerjian. Faster algorithms for the alignment of sparse correlated Erd\u02ddos\u2013R\u00e9nyi random graphs. Preprint available at https://arxiv.org/abs/ 2405.08421, 2024.   \n[52] Arvind Narayanan and Vitaly Shmatikov. De-anonymizing Social Networks. In Proceedings of the 30th IEEE Symposium on Security and Privacy, pages 173\u2013187. IEEE Computer Society, 2009.   \n[53] Ryan O\u2019Donnell, John Wright, Chenggang Wu, and Yuan Zhou. Hardness of Robust Graph Isomorphism, Lasserre Gaps, and Asymmetry of Random Graphs. In Proceedings of the Twenty-Fifth Annual ACM-SIAM Symposium on Discrete Algorithms (SODA), pages 1659\u20131677. SIAM, 2014.   \n[54] Christoffer Olsson and Stephan Wagner. Automorphisms of Random Trees. In 33rd International Conference on Probabilistic, Combinatorial and Asymptotic Methods for the Analysis of Algorithms (AofA 2022), volume 225 of Leibniz International Proceedings in Informatics (LIPIcs), pages 16:1\u201316:16. Schloss Dagstuhl-Leibniz-Zentrum f\u00fcr Informatik, 2022.   \n[55] Efe Onaran, Siddharth Garg, and Elza Erkip. Optimal de-anonymization in random graphs with community structure. In 2016 50th Asilomar Conference on Signals, Systems and Computers, pages 709\u2013713. IEEE, 2016.   \n[56] Richard Otter. The Number of Trees. Annals of Mathematics, 49(3):583\u2013599, 1948.   \n[57] Pedram Pedarsani and Matthias Grossglauser. On the privacy of anonymized networks. In Proceedings of the 17th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining (KDD), pages 1235\u20131243, 2011.   \n[58] Mikl\u00f3s Z. R\u00e1cz and Anirudh Sridhar. Correlated Stochastic Block Models: Exact Graph Matching with Applications to Recovering Communities. In Advances in Neural Information Processing Systems (NeurIPS), volume 34, pages 22259\u201322273, 2021.   \n[59] Mikl\u00f3s Z. R\u00e1cz and Anirudh Sridhar. Correlated randomly growing graphs. The Annals of Applied Probability, 32(2):1058\u20131111, 2022.   \n[60] Mikl\u00f3s Z. R\u00e1cz and Anirudh Sridhar. Matching Correlated Inhomogeneous Random Graphs using the $k$ -core Estimator. In 2023 IEEE International Symposium on Information Theory (ISIT), pages 2499\u20132504, 2023.   \n[61] Rohit Singh, Jinbo Xu, and Bonnie Berger. Global alignment of multiple protein interaction networks with application to functional orthology detection. Proceedings of the National Academy of Sciences, 105(35):12763\u201312768, 2008.   \n[62] Toni Vall\u00e8s-Catal\u00e0, Francesco A. Massucci, Roger Guimer\u00e0, and Marta Sales-Pardo. Multilayer Stochastic Block Models Reveal the Multilayer Structure of Complex Networks. Physical Review X, 6(1):011036, 2016.   \n[63] Haoyu Wang, Yihong Wu, Jiaming Xu, and Israel Yolou. Random Graph Matching in Geometric Models: the Case of Complete Graphs. In Proceedings of the 35th Conference on Learning Theory (COLT), volume 178 of Proceedings of Machine Learning Research (PMLR), pages 3441\u20133488, 2022.   \n[64] Ziao Wang, Weina Wang, and Lele Wang. Efficient Algorithms for Attributed Graph Alignment with Vanishing Edge Correlation. In Proceedings of the 37th Conference on Learning Theory (COLT), volume 247 of Proceedings of Machine Learning Research (PMLR), pages 4889\u20134890, 2024.   \n[65] Yihong Wu, Jiaming Xu, and Sophie H. Yu. Settling the Sharp Reconstruction Thresholds of Random Graph Matching. IEEE Transactions on Information Theory, 68(8):5391\u20135417, 2022.   \n[66] Joonhyuk Yang and Hye Won Chung. Graph Matching in Correlated Stochastic Block Models for Improved Graph Clustering. In Proceedings of the 2023 59th Annual Allerton Conference on Communication, Control, and Computing (Allerton), pages 1\u20138. IEEE, 2023.   \n[67] Joonhyuk Yang, Dongpil Shin, and Hye Won Chung. Efficient Algorithms for Exact Graph Matching on Correlated Stochastic Block Models with Constant Correlation. In Proceedings of the 40th International Conference on Machine Learning (ICML), volume 202 of Proceedings of Machine Learning Research (PMLR), pages 39416\u201339452, 2023.   \n[68] Xiaodong Yang, Buyu Lin, and Subhabrata Sen. Fundamental limits of community detection from multi-view data: multi-layer, dynamic and partially labeled block models. Preprint available at https://arxiv.org/abs/2401.08167, 2024.   \n[69] Lyudmila Yartseva and Matthias Grossglauser. On the Performance of Percolation Graph Matching. In Proceedings of the First ACM Conference on Online Social Networks (COSN), pages 119\u2013130, 2013.   \n[70] Liren Yu, Jiaming Xu, and Xiaojun Lin. The Power of $D$ -hops in Matching Power-Law Graphs. Proceedings of the ACM on Measurement and Analysis of Computing Systems, 5(2):1\u201343, 2021.   \n[71] Jingnan Zhang, Junhui Wang, and Xueqin Wang. Consistent Community Detection in InterLayer Dependent Multi-Layer Networks. Journal of the American Statistical Association, pages 1\u201311, 2024. ", "page_idx": 10}, {"type": "text", "text": "", "page_idx": 11}, {"type": "text", "text": "", "page_idx": 12}, {"type": "text", "text": "", "page_idx": 13}, {"type": "text", "text": "", "page_idx": 14}, {"type": "text", "text": "A Organization ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "The rest of this paper is organized as follows. In Section B, we give some notations used throughout. In Section C, we define the similarity score of a pair of vertices and give the formal proof of Theorem 1 based on Theorem 3 (Almost exact graph matching), Theorem 4 (Efficient algorithm for almost exact graph matching), and Theorem 5 (Exact graph matching by seeded graph matching). In Section D, we talk about some preliminaries: tail bounds, nice events, a tree node assigning sub-problem, an automorphism inequality for trees, and the calculation for cross-moments. These results will be repeatedly used in the following sections. In Section E, Section F, and Section G, we present the proofs for Theorem 3, Theorem 4, and Theorem 5, respectively. Section F and Section G are self-contained, while Section E contains several propositions whose proofs are deferred and which make up the remainder of the paper. ", "page_idx": 15}, {"type": "text", "text": "In Section E, we introduce six additional Propositions to show that under two different cases\u2014 namely, $s D_{+}(a,b)\\;\\geq\\;1$ and $s D_{+}(a.b)\\,<\\,1$ \u2014the mean and variance of the similarity score are properly controlled. Specifically, if $s D_{+}(a,b)\\geq1$ , then Proposition 1 gives the mean calculation of the similarity score, while Proposition 2 and Proposition 3 are about the variance calculation of the similarity score for true pairs and fake pairs of vertices. If $s D_{+}(a,b)<1$ , then Proposition 4 gives the mean calculation of the similarity score, while Proposition 5 and Proposition 6 are about the variance calculation of the similarity score for true pairs and fake pairs of vertices. The proofs of Proposition 1, Proposition 2, Proposition 3, Proposition 4, Proposition 5, and Proposition 6 are presented in Section H, Section I, Section J, Section K, Section L, and Section M, respectively. ", "page_idx": 15}, {"type": "text", "text": "B Notation ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "For any graph $G=(V,E)$ , we denote $E(G)$ as the edge set and $V(G)$ as the vertex set. We let $e(G):=|E(G)|$ denote the number of edges of graph $G$ and $v(G):={\\big|}V(G){\\big|}$ denote the number of vertices in graph $G$ . We define the excess of graph $G$ as $e(G)-v(G)$ , the difference between the number of edges and the number of vertices of $G$ . ", "page_idx": 15}, {"type": "text", "text": "Consider an arbitrary graph where vertices are equipped with two possible community labels $\\{+1,-1\\}$ , we denote $V^{+}$ as the set of vertices with community label $+1$ , $V^{-}$ as the set of vertices with community label $-1$ , $\\mathcal{N}(v)$ as the set vertices that are neighbors of $v$ . ", "page_idx": 15}, {"type": "text", "text": "Let $\\pi$ be a permutation on $[n]$ , $(G_{1},G_{2})\\sim\\mathrm{CSBM}(n,p,q,s)$ . Let $A$ (resp. $B$ ) be the adjacency matrix of $G_{1}$ (resp. $G_{2}$ ). Let ${\\overline{{A}}}:=A-\\mathbb{E}[A]$ (resp. $\\overline{B}$ ) be the centralized adjacency matrix. We further define the approximately centralized adjacency matrix with respect to community label estimate $\\widehat{\\pmb{\\sigma}}$ as $\\overline{{A}}^{\\widehat{\\pmb{\\sigma}}_{A}}:=\\overline{{A}}-E_{A}$ , where $E_{A}$ is an $n\\times n$ matrix whose $(i,j)$ -th entry is $p$ if $\\widehat{\\pmb{\\sigma}}(i)=\\widehat{\\pmb{\\sigma}}(j)$ and $q$ otherwise.4 ", "page_idx": 15}, {"type": "text", "text": "We denote $G_{1}\\lor_{\\pi}G_{2}$ as the union graph with respect to $\\pi$ , such that $(i,j)\\in E(G_{1}\\vee_{\\pi}G_{2})$ if and only if $(i,j)\\in E(G_{1})$ or $(\\pi(i),\\pi(j))\\overset{\\cdot}{\\in}E(G_{2})$ . We denote $G_{1}\\wedge_{\\pi}G_{2}$ as the intersection graph with respect to $\\pi$ , such that $(i,j)\\in E(G_{1}\\land_{\\pi}G_{2})$ if and only if $(i,j)\\in E(G_{1})$ and $(\\pi(i),\\pi(j))\\in E(G_{2})$ . ", "page_idx": 15}, {"type": "text", "text": "We denote the variance of in-community edges $\\sigma_{+}^{2}:=s p(1\\!-\\!s p)$ and the variance of cross-community edges as $\\sigma_{-}^{2}:=s q(1-s q)$ . Denote the correlation for in-community edges and cross-community edges as $\\rho_{+}$ and $\\rho_{-}$ , respectively. In addition, we define $\\begin{array}{r}{\\rho:=\\frac{\\rho++\\rho_{-}}{2}}\\end{array}$ . Consider the average degree being logarithmic in the number of vertices, then for some constants $\\begin{array}{r}{a,b>0,p=\\frac{a\\log n}{n},q=\\frac{b\\log n}{n}}\\end{array}$ n $\\begin{array}{r}{\\rho=(1+\\Theta(\\frac{\\log n}{n}))\\rho_{+}=(1+\\Theta(\\frac{\\log n}{n}))\\rho_{-}=(1+\\Theta(\\frac{\\log n}{n}))s.}\\end{array}$ 5 ", "page_idx": 15}, {"type": "text", "text": "Throughout the paper, we use standard asymptotic notation $O(\\cdot),\\Omega(\\cdot),\\Theta(\\cdot),o(\\cdot),\\omega(\\cdot)$ . Any limitation is for $n\\to\\infty$ without special explanations. For real numbers $x,y$ , we define $x\\vee y:=\\operatorname*{max}\\{x,y\\}$ and $x\\wedge y:=\\operatorname*{min}\\{x,y\\}$ . In this paper, log is natural logarithmic function (with base $e$ ). Further notation is introduced in the following section which details the algorithms. ", "page_idx": 15}, {"type": "text", "text": "C Proof overview and proof of Theorem 1 ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "C.1 Chandelier ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "A line of works convert the graph matching problem from quadratic assumption to linear assignment by creating a signature vector $s_{i}$ for each vertex $i\\,\\in\\,[n]$ , followed by calculating the similarity score $\\Phi_{i j}=\\langle\\pmb{s}_{i}^{(1)},\\pmb{s}_{j}^{(2)}\\rangle$ of all possible pairs of signatures on two graphs. Recently, Mao et al. [42] proposed a special tree family $\\tau$ , chandelier, that shows a result of efficient graph matching under constant correlation. ", "page_idx": 16}, {"type": "text", "text": "Definition 1 $((L,M,K,R)$ \u2013chandelier[42]). A $\\boldsymbol{\\imath}\\left(L,M,K,R\\right)$ -chandelier is a rooted tree with $L$ branches, each of which consists of a path with $M$ edges ( $M$ -wire), followed by a rooted tree with $K$ edges ( $\\mathcal{K}$ -bulb); the $K$ -bulbs are non-isomorphic to each other and each of them has at most $R$ automorphisms. ", "page_idx": 16}, {"type": "text", "text": "In this paper, we give an alternative definition of chandelier with five tuple. The first four parameters remain the same as $(L,M,K,R)$ \u2013chandelier. The last parameter $D$ stands for the maximum degree of vertices on this chandelier. We explain the necessity of controlling $D$ in the proof challenge. ", "page_idx": 16}, {"type": "text", "text": "Definition 2 $((L,M,K,R,D).$ \u2013chandelier). An $(L,M,K,R,D)$ -chandelier is a rooted tree with $L$ branches, each of which consists of a path with $M$ edges $M$ -wire), followed by a rooted tree with $K$ edges $\\mathcal{K}$ -bulb); the $K$ -bulbs are non-isomorphic to each other, each of them has at most $R$ automorphisms, and the degree of each vertex is at most $D$ . ", "page_idx": 16}, {"type": "text", "text": "For each chandelier $H$ , let $\\kappa(H)$ denote the set of bulbs of $H$ . For a rooted tree $T$ , let $\\operatorname{aut}(H)$ denote the number of rooted automorphisms of $T$ throughout this paper. We abbreviate rooted automorphism as automorphism when it is clear that we are applying it to a chandelier. The number of automorphisms of $H$ is determined by the automorphisms of its bulbs. Because all bulbs are non-isomorphic to each other, ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\operatorname{aut}(H)=\\prod_{B\\in K(H)}\\operatorname{aut}(B).\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "Let $\\tau$ denote the family of non-isomorphic $(L,M,K,R,D)\\cdot$ \u2013chandelier. The family size of chandelier is $|\\mathcal{T}|=\\binom{|\\mathcal{T}|}{L}$ , where $\\mathcal{I}\\equiv\\mathcal{I}(\\boldsymbol{K},\\boldsymbol{R},\\boldsymbol{D})$ denotes the collection of unlabeled rooted trees with $K$ edges, at most $R$ automorphisms, and maximum degree $D$ . ", "page_idx": 16}, {"type": "text", "text": "Otter [56] showed that the number of unlabeled rooted trees with $K$ edges (and no constraint on the automorphisms and vertex degrees) is $|{\\mathcal{I}}(K,\\infty,\\infty)|=(\\alpha+o(1))^{-K}$ , where $\\alpha\\approx0.338$ . We show that under proper choices of $R$ and $D$ , we have $|\\mathcal{\\dot{I}}(K,R,D)|=(\\alpha+o(1))^{-K}$ through the following two Lemmas. ", "page_idx": 16}, {"type": "text", "text": "Lemma 1. Let K be the number of vertices on a unlabeled rooted tree, C\u2032 > log(11/\u03b1) $\\begin{array}{r}{C^{\\prime}>\\frac{1}{\\log(1/\\alpha)}\\approx0.9227,}\\end{array}$ , $D\\geq C^{\\prime}\\log K$ . As $K\\rightarrow\\infty$ , ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\frac{|\\mathcal{I}(K,\\infty,D)|}{|\\mathcal{I}(K,\\infty,\\infty)|}=1-o(1).\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "Proof. Otter [56] characterized that $\\begin{array}{r}{\\frac{|{\\mathcal I}(K,\\infty,D)|}{|{\\mathcal I}(K,\\infty,\\infty)|}\\asymp\\frac{\\alpha_{D}^{-n}}{\\alpha^{-n}}}\\end{array}$ , where $\\alpha_{D}$ is the radius of convergence for the generating function of the number of unlabeled rooted trees whose maximum vertex degree less than or equal to $D$ . Goh and Schumutz [27] (Theorem 7) showed the following property: as $D\\,\\rightarrow\\,\\infty$ , for some constant $C\\ >\\ 0$ , $\\alpha_{D}\\;=\\;\\bar{\\alpha}+C\\alpha^{D}+\\dot{o}(\\alpha^{D})$ . Immediately we can see that $\\begin{array}{r}{\\frac{|\\mathcal{I}(K,\\infty,D)|}{|\\mathcal{I}(K,\\infty,\\infty)|}\\,=\\,(1+O(\\alpha^{D}))^{-K}\\,=\\,1-o(1)}\\end{array}$ if $K\\alpha^{D}\\,\\rightarrow\\,0$ . Let $\\begin{array}{r}{C^{\\prime}\\,>\\,\\frac{1}{\\log(1/\\alpha)}}\\end{array}$ , choosing $D\\geq C^{\\prime}\\log K$ satisfies $K\\alpha^{D}\\rightarrow0$ . \u53e3 ", "page_idx": 16}, {"type": "text", "text": "Lemma 2. Let $K$ be the number of vertices on a unlabeled rooted tree, $C$ be a constant and choose $R=\\exp(C K)$ . For sufficiently large $C$ and $K\\rightarrow\\infty$ , ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\frac{|\\mathcal{I}(K,R,\\infty)|}{|\\mathcal{I}(K,\\infty,\\infty)|}=1-o(1).\n$$", "text_format": "latex", "page_idx": 16}, {"type": "image", "img_path": "nBhfIcDnRP/tmp/9f40f48cd12e4f598a8d41b356a78dca8287245fd7688bcf2e227ce3c515d57a.jpg", "img_caption": ["Figure 4: A chandelier. "], "img_footnote": [], "page_idx": 17}, {"type": "text", "text": "Proof. Olsson and Wagner [54] (Theorem 2) showed a central limit theorem result for the number of automorphism on unlabeled rooted trees: \u221a1K (log aut(HK) \u2212\u00b5K) \u2192N(0, \u03c32) as K \u2192\u221e, where $H_{K}$ is a uniform random unlabeled rooted tree with $K$ edges and $\\mu\\approx0.137$ , $\\sigma^{2}\\approx0.197$ . This implies that for some constant $C>\\mu$ and $R=\\exp(C K)$ , $\\operatorname{aut}(H_{K})<R$ with high probability. ", "page_idx": 17}, {"type": "text", "text": "Putting together Lemma 1 and Lemma 2, and choosing $R$ and $D$ as specified, we have that $|\\mathcal{I}(K;R,\\bar{D})|\\,=\\,(\\underline{{{1}}}\\,-\\,o(1))|\\mathcal{I}(K,\\infty,\\infty)|\\,=\\,(\\alpha+o(1))^{\\overleftarrow{}K}$ . Let $\\beta$ denote a universal constant such that $|{\\mathcal{I}}|\\leq\\beta^{K}$ . We take $\\beta=\\alpha^{-1}$ . ", "page_idx": 17}, {"type": "text", "text": "C.2 Algorithm overview ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "Given $(G_{1},G_{2})\\sim\\mathrm{CSBM}(n,p,q,s)$ . Our algorithm contains mainly three steps. Firstly, we apply the algorithm by Mossel, Neeman, and Sly [48] to obtain almost exact community label estimates for each single graph. Secondly, we calculate the signed chandelier counting [42] based similarity score to give an almost exact graph matching. Lastly, we boost the almost exact matching to exact matching by extending the seeded graph matching algorithm [42] on Erd\u02ddos\u2013R\u00e9nyi graphs to stochastic block models. ", "page_idx": 17}, {"type": "text", "text": "Almost exact community recovery. Obtaining community label estimates for both graph $G_{1}$ and $G_{2}$ is the first step of our algorithm. This is necessary for centralizing the adjacency matrices for the signed subgraph counts afterwards. We expect the following properties from the community recovery algorithm: ", "page_idx": 17}, {"type": "text", "text": "(a) gives almost exact recovery (down to the information-theoretic threshold, which is $s^{2}(a+b)=1$ in the correlated SBMs with two balanced communities [58]);   \n(b) gives an error rate for each vertex of inverse-polynomial;   \n(c) gives error rates on different vertices that are approximately independent. ", "page_idx": 17}, {"type": "text", "text": "The community recovery algorithm in [48] (described as Algorithm 3) has been shown with property (a) by [48] and property (b) by [25] with an error rate of $\\bar{n}^{-s D+(a,b)}$ . In this paper, we show that property (c) is satisfied (See Lemma 8). ", "page_idx": 17}, {"type": "text", "text": "Subgraph counts. For an arbitrary weighted adjacency matrix $M$ of some adjacency matrix $A$ , vertex $i\\in[n]$ , and a rooted graph $H$ , we define the weighted subgraph counts on $M$ as ", "page_idx": 17}, {"type": "equation", "text": "$$\nW_{i,H}(M):=\\sum_{S(i)\\cong H}M_{S},\\;\\mathrm{where\\;}M_{S}:=\\prod_{e\\in E(S)}M_{e},\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "where $S(i)$ enumerates through all subgraphs on the complete graph $K_{n}$ , rooted at $i$ and are isomorphic to $H$ . ", "page_idx": 17}, {"type": "text", "text": "When $M$ is the adjacency matrix itself, $W_{i,H}(M)$ is the usual subgraph count, representing the number of subgraphs rooted at $i$ in $M$ that are isomorphic to $H$ . When $M$ is the centralized adjacency matrix ${\\overline{{A}}}:=A-\\mathbb{E}[A]$ , we call $W_{i,H}(M)$ a signed subgraph count following [9]. However, we do not have access to $\\mathbb{E}[A]$ in many cases. Specifically for SBM, we can estimate $\\mathbb{E}[A]$ through estimating the community labels. We define the approximately centralized adjacency matrix regarding to community label estimate $\\widehat{\\pmb{\\sigma}}$ , denoted as $\\overline{{A}}^{\\widehat{\\sigma}}$ , entry-wise as $\\overline{{A}}_{i,j}^{\\widehat{\\pmb{\\sigma}}}=A_{i,j}-p\\mathbf{1}_{\\widehat{\\pmb{\\sigma}}[i]=\\widehat{\\pmb{\\sigma}}[j]}-q\\mathbf{1}_{\\widehat{\\pmb{\\sigma}}[i]\\neq\\widehat{\\pmb{\\sigma}}[j]}$ ", "page_idx": 17}, {"type": "text", "text": "Using $\\overline{{A}}^{\\widehat{\\sigma}}$ in (7) yields the weighted subgraph counts for approximately centralized adjacency matrix.   \nWe also refer to this as a signed subgraph count, though errors may exist. ", "page_idx": 18}, {"type": "text", "text": "Given a family $\\mathcal{H}$ of non-isomorphic rooted graphs, we define the subgraph count signature of vertex $i$ as ", "page_idx": 18}, {"type": "equation", "text": "$$\nW_{i}^{\\mathcal{H}}(M):=(W_{i,H}(M))_{H\\in\\mathcal{H}}.\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "Similarity score. Given a pair of correlated SBMs $(G_{1},G_{2})$ , we define the similarity score between vertex $i$ on graph $G_{1}$ and vertex $j$ on graph $G_{2}$ as a weighted inner product between two signatures: ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\Phi_{i j}:=\\langle W_{i}^{T}(\\overline{{A}}),W_{j}^{T}(\\overline{{B}})\\rangle:=\\sum_{H\\in\\mathcal{T}}\\mathrm{aut}(H)W_{i,H}(\\overline{{A}})W_{j,H}(\\overline{{B}}),\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "where $\\tau$ is the family of chandelier. ", "page_idx": 18}, {"type": "text", "text": "When we do not have access to the centralized adjacency matrices $\\overline{{A}}$ and $\\overline{B}$ , we use community label estimates ${\\widehat{\\pmb{\\sigma}}}_{A}$ and $\\widehat{\\pmb{\\sigma}}_{B}$ for $G_{1}$ and $G_{2}$ correspondingly. We define the similarity score with a slightly different  notation: ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\Phi_{i j}^{\\widehat{\\sigma}}:=\\langle W_{i}^{\\mathcal{T}}(\\overline{{A}}^{\\widehat{\\sigma}_{A}}),W_{j}^{\\mathcal{T}}(\\overline{{B}}^{\\widehat{\\sigma}_{B}})\\rangle=\\sum_{H\\in\\mathcal{T}}\\operatorname{aut}(H)W_{i,H}(\\overline{{A}}^{\\widehat{\\sigma}_{A}})W_{j,H}(\\overline{{B}}^{\\widehat{\\sigma}_{B}}).\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "Almost exact graph matching. The first part in the analysis is to show that by calculating this similarity score, with an appropriate thresholding strategy, we can match up $(1\\stackrel{\\cdot}{-}o(1))n$ vertices correctly (Theorem 3). The high-level idea is to show that the similarity score distributions are well-separated between true pairs and fake pairs. We expect the similarity score having the following properties, under event $\\mathcal{H}$ : ", "page_idx": 18}, {"type": "text", "text": "\u2022 For true pairs $j=\\pi(i)$ : ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\mathbb{E}[\\Phi_{i\\pi_{*}(i)}^{\\widehat{\\sigma}}\\mathbf{1}_{\\mathcal{H}}]>0,\\quad\\mathrm{Var}[\\Phi_{i j}^{\\widehat{\\sigma}}\\mathbf{1}_{\\mathcal{H}}]=o\\left(\\mathbb{E}[\\Phi_{i\\pi_{*}(i)}^{\\widehat{\\sigma}}\\mathbf{1}_{\\mathcal{H}}]^{2}\\right),}\\end{array}\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "\u2022 For fake pairs $j\\neq\\pi(i)$ : ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\mathbb{E}[\\Phi_{i j}^{\\widehat{\\sigma}}\\mathbf{1}_{\\mathcal{H}}]=o\\left(\\mathbb{E}[\\Phi_{i\\pi_{*}(i)}^{\\widehat{\\sigma}}\\mathbf{1}_{\\mathcal{H}}]\\right),\\quad\\mathrm{Var}[\\Phi_{i j}^{\\widehat{\\sigma}}\\mathbf{1}_{\\mathcal{H}}]=o\\left(\\frac{\\mathbb{E}[\\Phi_{i\\pi_{*}(i)}^{\\widehat{\\sigma}}\\mathbf{1}_{\\mathcal{H}}]^{2}}{n^{2}}\\right).\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "Precisely forming bounds for these moments constitutes the main bulk of the paper. Aside from proving the desired properties of the first and second order moments, we follow the color codingbased similarity score estimation idea from [42] to analyze an efficient algorithm. The basic idea is to color the vertices of SBMs using $N+1$ colors uniformly at random. Then, we only do signed counts on vertex sets that are colorful with $N+1$ colors. We show that this is an unbiased estimator and only potentially increase the variance by an additional constant factor in Section F. The result is stated formally as in Theorem 4. ", "page_idx": 18}, {"type": "text", "text": "Algorithm 1 Almost Exact Graph Matching for CSBM ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Input: Adjacency matrices $A$ and $B$ for $(G_{1},G_{2})\\sim\\mathrm{CSBM}(n,a\\frac{\\log n}{n},b\\frac{\\log n}{n},s)$ , a constant $c$ , and mean value $\\mu$ .   \nOutput: A mapping $\\widehat{\\pi}:I\\to[n]$ .   \n1: Run community recovery Algorithm 3 [48] on $A$ and $B$ separately and get label vector $\\widehat{\\pmb{\\sigma}}_{A},\\widehat{\\pmb{\\sigma}}_{B}$ . 2: For each pair of vertex i in A A and vertex $j$ in $\\overline{{B}}^{\\widehat{\\pmb{\\sigma}}_{B}}$ , compute their similarity score as in [42]: ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\Phi_{i j}^{\\widehat{\\sigma}}=\\langle W_{i}^{\\mathcal{T}}(\\overline{{A}}^{\\widehat{\\sigma}_{A}}),W_{j}^{\\mathcal{T}}(\\overline{{B}}^{\\widehat{\\sigma}_{B}})\\rangle=\\sum_{H\\in\\mathcal{T}}\\mathrm{aut}(H)W_{i,H}(\\overline{{A}}^{\\widehat{\\sigma}_{A}})W_{j,H}(\\overline{{B}}^{\\widehat{\\sigma}_{B}}).\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "3: Let $\\tau=c\\mu$ , output $I:=\\{i|i\\in[n],\\exists j\\in[n].$ s.t. $\\Phi_{i j}^{\\tau}\\ge\\tau$ , and $\\forall k\\in[n]\\backslash\\{j\\},\\Phi_{i k}^{T}<\\tau\\}.$ . ", "page_idx": 18}, {"type": "text", "text": "Proof challenge. In regime $s D_{+}(a,b)>1$ , the probability of existing one vertex being classified incorrectly is vanishing. Therefore, with high probability, ${\\overline{{A}}}^{\\widehat{\\pmb{\\sigma}}_{A}}\\,=\\,{\\overline{{A}}}$ . If $s D_{+}(a,b)\\;<\\;1$ , then the recovered $\\widehat{\\pmb{\\sigma}}$ contains errors (polynomial in $n$ ), which will cause some edges being centralized incorrectly an d thereby affect the moments calculation. For example, let $i,j\\in[n]$ be two vertices on $G_{1}$ who has the same community label $\\pmb{\\sigma}_{*}(i)=\\pmb{\\sigma}_{*}(j)$ . If only one of $i,j$ is labeled incorrectly by Algorithm 3, then the expectation of $\\overline{{A}}_{i,j}^{\\widehat{\\sigma}_{A}}$ conditioned on $\\pmb{\\sigma}_{*}$ and $\\widehat{\\pmb{\\sigma}}$ is $p-q$ . ", "page_idx": 18}, {"type": "text", "text": "", "page_idx": 19}, {"type": "text", "text": "This phenomenon poses a challenge to the algorithm analysis. We highlight some key points in the context of second moment calculation. For simplicity, we ignore event $\\mathcal{H}$ here. ", "page_idx": 19}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathrm{Var}[\\Phi_{i j}^{\\widehat{\\sigma}}]=\\displaystyle\\sum_{H,I\\in\\mathcal{T}}\\mathrm{aut}(H)\\mathrm{aut}(I)\\sum_{S_{1}(i),S_{2}(j)\\cong H\\,T_{1}(i),T_{2}(j)\\cong I}\\left(\\mathbb{E}_{\\sigma_{\\star}}\\left[\\mathbb{E}[\\overline{{A}}_{S_{1}}^{\\widehat{\\sigma}_{A}}\\overline{{B}}_{S_{2}}^{\\widehat{\\sigma}_{B}}\\overline{{A}}_{T_{1}}^{\\widehat{\\sigma}_{A}}\\overline{{B}}_{T_{2}}^{\\widehat{\\sigma}_{B}}\\ |\\ \\sigma_{*}]\\right]\\right.}\\\\ &{\\qquad\\qquad\\qquad\\left.-\\,\\mathbb{E}_{\\sigma_{\\star}}\\left[\\mathbb{E}[\\overline{{A}}_{S_{1}}^{\\widehat{\\sigma}_{A}}\\overline{{B}}_{S_{2}}^{\\widehat{\\sigma}_{B}}\\ |\\ \\sigma_{*}]\\right]\\mathbb{E}_{\\sigma_{\\star}}\\left[\\mathbb{E}[\\overline{{A}}_{T_{1}}^{\\widehat{\\sigma}_{A}}\\overline{{B}}_{T_{2}}^{\\widehat{\\sigma}_{B}}\\ |\\ \\sigma_{*}]\\right]\\right).}\\end{array}\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "Let us define the union graph $U:=S_{1}\\cup S_{2}\\cup T_{1}\\cup T_{1}{}^{6}$ . If $s D_{+}(a,b)>1$ , we view $\\overline{{A}}^{\\widehat{\\sigma}}$ and $\\overline{{B}}^{\\widehat{\\sigma}}$ as $\\overline{{A}}$ and $\\overline{B}$ , respectively. E[AS1BS2AT1AT2 | \u03c3\u2217] \u0338= 0 $\\mathbb{E}[\\overline{{A}}_{S_{1}}\\overline{{B}}_{S_{2}}\\overline{{A}}_{T_{1}}\\overline{{A}}_{T_{2}}\\ |\\ \\pmb{\\sigma}_{*}]\\neq0$ only if there exists no edge e \u2208E(U) $e\\in E(U)$ such that it occurs only once among $(S_{1},S_{2},T_{1},T_{2})$ . This is because different edges are independent and centralized conditioned on $\\pmb{\\sigma}_{*}$ . Without loss of generality, we assume there exists an edge $e\\in E(A)$ occur only on $S_{1}$ , thus $\\mathbb{E}[\\overline{{A}}_{e}\\mid\\pmb{\\sigma}_{*}]=0$ and also $\\mathbb{E}[\\overline{{A}}_{S_{1}}\\overline{{B}}_{S_{2}}\\overline{{A}}_{T_{1}}\\overline{{A}}_{T_{2}}\\mid\\pmb{\\sigma}_{*}]=0.$ . ", "page_idx": 19}, {"type": "text", "text": "However, in regime $s D_{+}(a,b)\\;<\\;1$ , $\\mathbb{E}[\\overline{{A}}_{S_{1}}^{\\widehat{\\pmb{\\sigma}}_{A}}\\overline{{B}}_{S_{2}}^{\\widehat{\\pmb{\\sigma}}_{B}}\\overline{{A}}_{T_{1}}^{\\widehat{\\pmb{\\sigma}}_{A}}\\overline{{B}}_{T_{2}}^{\\widehat{\\pmb{\\sigma}}_{B}}\\ |\\ \\pmb{\\sigma}_{*}]\\ \\neq\\ 0$ even when edges are not occurring multiple times as we have the expectation of $\\overline{{A}}_{e}^{\\widehat{\\pmb{\\sigma}}_{A}}$ can be non-zero when conditioning on $\\pmb{\\sigma}_{*}$ and an estimate ${\\widehat{\\pmb{\\sigma}}}_{A}$ that disagrees with $\\pmb{\\sigma}_{*}$ on the edge type (i.e., for $e=(u,v),\\pmb{\\sigma}_{\\ast}(u)\\pmb{\\sigma}_{\\ast}(v)\\neq$ ${\\widehat{\\pmb{\\sigma}}}_{A}(u){\\widehat{\\pmb{\\sigma}}}_{A}(v))$ . This not only causes this cross-moments calculation being more complicated, but significantly increasing the possibility of the combinations between $S_{1},S_{2},T_{1}$ , and $T_{2}$ . The maximum vertex in the union graph grows from $2N$ to $4N$ , squaring up the trivial bound on the number of subgraphs on the complete graph $K_{n}$ that is isomorphic to $U$ . ", "page_idx": 19}, {"type": "text", "text": "The most important high-level idea to properly bound the moments is: the cross-moment conditioning on a specific $\\widehat{\\pmb{\\sigma}}\\,=\\,(\\widehat{\\pmb{\\sigma}}_{A},\\widehat{\\pmb{\\sigma}}_{B})$ would be non-trivial if and only if all edges occurring only once are centralize d  incorr ect ly . This is because, conditioning on $\\widehat{\\pmb{\\sigma}}$ satisfying the above property, the expectation of $\\overline{{A}}_{e}$ takes either $p-q$ or $q-p$ for all $e\\in E(U)$ t hat occurs only once. Assuming there are $z$ edges occurring once, we show that the probability that $\\widehat{\\pmb{\\sigma}}$ satisfying this property is no greater than n\u2212 $n^{-\\frac{\\check{z}(s D_{+}(a,b)-\\varepsilon\\log(a/b)/2)}{D}}$ for any $\\varepsilon>0$ . Intuitively, this is saying that to incorrectly centralize $z$ edges at the same time, we expect the Algorithm 3 to label at least $\\bar{\\lceil\\frac{z}{D}\\rceil}$ vertices incorrectly. It turns out that we require n $\\begin{array}{r}{n^{-\\frac{z(s D+(a,b)-\\varepsilon\\log(a/b)/2)}{D}}}\\end{array}$ to be $O\\big(\\frac{1}{\\log^{C}n}\\big)$ for some positive constant $C$ so that (1) and (2) are satisfied. ", "page_idx": 19}, {"type": "text", "text": "Theorem 3. Fix $a~\\neq~b~>~0$ and $s~\\in~[0,1]$ . Let $p\\ =\\ a\\frac{\\log n}{n},q\\ =\\ b\\frac{\\log n}{n}$ b log n and (G1, G2) \u223c $\\mathrm{CSBM}(n,p,q,s)$ . For any $\\varepsilon\\ \\geq\\ 0$ , suppose $s^{2}\\ \\geq\\ \\alpha\\,+\\,\\varepsilon$ . There exists positive constants $C_{1},C_{2},C_{3},C_{4},C_{5}>0$ such that the following holds. Pick $K,M,L,N,D$ as ", "page_idx": 19}, {"type": "equation", "text": "$$\nL=\\frac{C_{1}}{\\varepsilon},\\quad K=C_{2}\\log n,\\quad M=\\frac{C_{3}K}{\\log(n s(p\\wedge q))},\\quad R=\\exp(C_{4}K),\\quad D=C_{5}\\frac{\\log n}{(\\log\\log n)^{2}}.\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "Pick an arbitrary c \u2208(0, 1) and set \u00b5 = |T |nN\u03c1N\u03c3e2fNf , where \u03c3e2ff := (\u03c32++2\u03c32\u2212) . Then, Algorithm $^{\\,l}$ with high probability. ", "page_idx": 19}, {"type": "text", "text": "Algorithm 1 takes quasi-polynomial time. Algorithm 4 in Section F computes an approximated score in polynomial time and satisfies the following Theorem. ", "page_idx": 19}, {"type": "text", "text": "Theorem 4. Theorem 3 continues to hold with the color-coding sampled estimation $\\widetilde{\\Phi}_{i j}^{\\widehat{\\sigma}}$ in place of $\\Phi_{i j}^{\\widehat{\\sigma}}$ . Moreover, by Algorithm 4, $\\{\\widetilde{\\Phi}_{i j}^{\\widehat{\\sigma}}\\}_{i,j\\in[n]}$ can be computed in $O(n^{C})$ for some constant $C\\equiv C(\\varepsilon)$ depending only on $\\varepsilon$ , where $\\varepsilon$ is from (3). ", "page_idx": 19}, {"type": "text", "text": "Exact graph matching. The final step of the algorithm is boosting the almost exact matching to a exact matching. The key idea is exploring the number of common neighbors for two unmatched vertices with regard to the current matching. ", "page_idx": 19}, {"type": "text", "text": "Define $h(x)=x\\log x-x+1$ . Denote $\\mathrm{N}_{\\pi}(i,j)$ as the number of common neighbors of $i$ and $j$ under correspondence $\\pi$ . In another word, $\\mathrm{N}_{\\pi}(i,j)$ is the number of vertex $v\\in I$ such that $v$ is a neighbor of $i$ in $A$ and $\\pi(v)$ is a neighbor of $j$ in $B$ . The high-level idea is that if $i$ and $j$ form a true cTohrerreesfpoorne,d ewnec em, atthcehn ,u pw ha nhdi ifp rtohbeay bhilaitvye $\\begin{array}{r}{\\mathrm{{N}}_{\\widetilde{\\pi}}(i,j)\\ge\\gamma\\frac{p^{2}+q^{2}}{2}s^{2}(n+2n^{\\frac{3}{4}})}\\end{array}$ ,i su tnhdreers hthole dn. iIcne  aedvdeintti $\\mathcal{H}$ $i$ $j$ we can show that all the remaining vertices will be matched up with high probability. Formally, we summarize the algorithm as Algorithm 2 and the guarantee as Theorem 5. ", "page_idx": 20}, {"type": "text", "text": "Theorem 5. Fix $a~\\neq~b~>~0$ and $s~\\in~[0,1]$ . Let $p\\ =\\ a\\frac{\\log n}{n},q\\ =\\ b\\frac{\\log n}{n}$ and $(G_{1},G_{2})~\\sim$ $\\mathrm{CSBM}(n,p,q,s)$ . Suppose ", "page_idx": 20}, {"type": "equation", "text": "$$\ns^{2}(\\frac{a+b}{2})\\geq1+\\varepsilon\\quad a n d\\quad s^{2}\\geq\\alpha+\\varepsilon,\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "for some $\\varepsilon\\,>\\,0$ . Let $\\gamma$ be the unique solution in $(1,\\infty)$ to $\\begin{array}{r}{h(\\gamma)\\,=\\,\\frac{3\\log n}{(n-2)p q s^{2}}}\\end{array}$ . Then, the seeded matching Algorithm 2 with input $\\widehat{\\pi}$ and an index set $I\\subset[n],|I|=(1-o(1))n\\geq(1-\\varepsilon/16)n$ such that $\\widehat{\\pi}|_{I}=\\pi_{*}$ outputs an exact m  atching $\\widetilde{\\pi}=\\pi_{*}$ in $O(n^{\\bar{3}}(p+q)^{2})$ time with probability $1-o(1)$ . ", "page_idx": 20}, {"type": "text", "text": "Algorithm 2 Seeded Graph Matching [42] ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Isonpmue . mAa trmicaepsp $A$ ga $B$ $\\begin{array}{r}{(G_{1},G_{2})\\sim\\mathrm{CSBM}(n,p,q,s),p=a\\frac{\\log n}{n},q=b\\frac{\\log n}{n}}\\end{array}$ logn n , q = b logn n for $a>0,b>0$ ${\\widehat{\\pi}}:I\\to[n]$ $|I|=(1-o(1))n$ $p,q,s$ \u03b3 \u2208(1, \u221e) such that h(\u03b3) =(n3\u2212 l2o)gp nqs2 . ", "page_idx": 20}, {"type": "text", "text": "1: Let $J=I$ , and $\\widetilde{\\pi}=\\widehat{\\pi}$ .   \n2: while there exi st s $i\\not\\in J$ and $j\\notin\\widetilde{\\pi}(J)$ such that $\\begin{array}{r}{\\mathrm{{N}}_{\\widetilde{\\pi}}(i,j)\\geq\\gamma\\frac{p^{2}+q^{2}}{2}s^{2}(n+2n^{\\frac{3}{4}})\\,\\mathbf{d}}\\end{array}$ o   \n3: Add to and let $\\widetilde{\\pi}(i)=j$ .   \n4: end while ", "page_idx": 20}, {"type": "text", "text": "Output: $\\widetilde{\\pi}$ . ", "page_idx": 20}, {"type": "text", "text": "C.3 Putting things together: proof of Theorem 1 ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "The proof of Theorem 1 follows from Theorem 4 and Theorem 5. ", "page_idx": 20}, {"type": "text", "text": "Proof of Theorem 1. From Theorem 4, we know that for $(G_{1},G_{2})\\sim\\mathrm{CSBM}(n,a\\frac{\\log n}{n},b\\frac{\\log n}{n},s),$ $a\\neq b$ , if $s^{2}\\geq\\alpha+\\varepsilon$ for some $\\varepsilon>0$ then there we can match $(1-o(1))n$ vertices correctly and efficiently with high probability. ", "page_idx": 20}, {"type": "text", "text": "Take the returned $\\widehat{\\pi}$ from Algorithm 4 as input of Algorithm 2, then Theorem 5 guarantees that the final output $\\widetilde{\\pi}=\\pi_{*}$ with probability $1-o(1)$ . This completes the proof of Theorem 1. \u53e3 ", "page_idx": 20}, {"type": "text", "text": "D Preliminaries ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "D.1 Tail bounds ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Lemma 3 (Chernoff Bound, Theorem 2.1 of [32]). Let $X\\sim\\operatorname{Binom}(n,p)$ be a binomial random variable. Then, for all $t\\geq0$ , ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{P}(X\\geq\\mathbb{E}X+t)\\leq\\exp\\left(-\\frac{t^{2}}{2(\\mathbb{E}X+t/3)}\\right),}\\\\ &{\\mathbb{P}(X\\leq\\mathbb{E}X-t)\\leq\\exp\\left(-\\frac{t^{2}}{2\\mathbb{E}X}\\right).}\\end{array}\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "Lemma 4 (Multiplicative Chernoff Bound, Theorem 4.4 and Theorem 4.5 of [46]). Let $\\textit{X}\\sim$ $\\mathrm{Binom}(n,p)$ be a binomial random variable, denote $\\mu=n p$ as the mean. Let $h(x)=x\\log x-x\\!+\\!1$ . Then, for all $\\gamma\\in(1,\\infty)$ , ", "page_idx": 20}, {"type": "text", "text": "Fo $\\cdot\\,\\gamma\\in(0,1),$ , ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{P}(X\\geq\\gamma\\mu)\\leq\\exp(-\\mu h(\\gamma)).}\\\\ &{}\\\\ &{\\mathbb{P}(X\\leq\\gamma\\mu)\\leq\\exp(-\\mu h(\\gamma)).}\\end{array}\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "bLee imndmeap e5.n d[e4n8t,.  2If5 $a<b$ . $Y\\sim\\operatorname{Binom}(m_{+},{\\frac{a\\log n}{n}})$ and $Z\\sim\\operatorname{Binom}(m_{-},{\\frac{b\\log n}{n}})$ $m_{+}=(1+o(1))\\frac{n}{2}$ $m_{-}=(1+o(1))\\frac{n}{2}$ ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\mathbb{P}(Y<Z)=n^{-D_{+}(a,b)+o(1)}.\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "For any $\\varepsilon>0$ , ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\mathbb{P}(Y-Z\\leq\\varepsilon\\log n)\\leq n^{-(D_{+}(a,b)-\\frac{\\varepsilon\\log(a/b)}{2})+o(1)}.\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "This result has been proved in Lemma 8 in [3] and Lemma 3.3 in [25]. ", "page_idx": 21}, {"type": "text", "text": "D.2 Nice events ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "When $\\begin{array}{r}{(G_{1},G_{2})\\sim\\mathrm{CSBM}(n,\\frac{a\\log n}{n},\\frac{b\\log n}{n},s)}\\end{array}$ , there are some events that happen with high probability and our following analysis intuitively relies on the happening of these nice events. ", "page_idx": 21}, {"type": "text", "text": "\u2022 (Balanced Communities) We denote $\\begin{array}{r}{\\mathcal{H}:=\\{\\frac{n}{2}-n^{\\frac{3}{4}}\\,\\leq\\,|V^{+}|,|V^{-}|\\,\\leq\\,\\frac{n}{2}+n^{\\frac{3}{4}}\\}}\\end{array}$ . We observe that $\\begin{array}{r}{|V^{+}|\\sim\\mathrm{Binom}(n,\\frac{1}{2})}\\end{array}$ and $|V^{-}|=n-|V^{+}|$ . By Chernoff bound, ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\mathbb{P}(\\mathcal{H}^{c})=\\mathbb{P}(|V^{+}|\\ge\\frac{n}{2}+n^{\\frac{3}{4}})-\\mathbb{P}(|V^{+}|\\le\\frac{n}{2}-n^{\\frac{3}{4}})\\le\\frac{1}{e^{(1-o(1))\\sqrt{n}}}.\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "\u2022 (Reasonable Large Neighborhood) Let $\\gamma=\\operatorname*{max}(a,b)$ , we also denote that ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\mathcal{F}=\\{\\forall v\\in[n],|\\mathcal{N}(v)|\\leq100\\operatorname*{max}(1,\\gamma)\\log^{3}n\\}.\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "Lemma 6. As $n\\rightarrow\\infty,$ , we have ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\mathbb{P}(\\mathcal{F})\\geq1-n^{-O(\\log^{2}n)}.\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "Proof. Let $X\\sim\\operatorname{Binom}(n,\\gamma{\\frac{\\log n}{n}})$ \u03b3 logn n ). Fix i \u2208[n], conditioned on any \u03c3\u2217, |N(i)| is stochastically dominated by $X$ . Therefore, ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{P}(|{\\cal N}(i)|\\geq\\gamma\\log^{3}n\\mid\\sigma_{*})\\leq\\mathbb{P}(X\\geq\\gamma\\log^{3}n)\\leq\\exp\\left(-\\frac{(\\gamma\\log^{3}n)^{2}}{2\\gamma\\log n+2/3\\gamma\\log^{3}n}\\right)}\\\\ &{\\qquad\\qquad\\qquad\\qquad\\leq\\exp(-\\gamma\\log^{3}n)=n^{-\\gamma\\log^{2}n},}\\end{array}\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "where the second line uses Bernstein\u2019s inequality and the third line holds for any $n$ such that $\\log^{2}n>6$ . From an union bound, we have ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\mathbb{P}(\\mathcal{F})=\\mathbb{E}[\\mathbb{P}(\\mathcal{F}|\\pmb{\\sigma}_{*})]\\ge1-n^{-O(\\log^{2}n)}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "D.3 Community recovery ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "We make a slight change on the choice of the partition number of the community detection algorithm proposed by Mossel, Neeman, and Sly [48]. This algorithm gives almost exact recovery with $\\bar{n}^{1-s D+(a,b)+\\varepsilon|\\log(a/b)|}$ vertices labeled incorrectly. After community recovery, we need to match the two communities in $G_{1}$ and $G_{2}$ by applying the community matching Algorithm 3. ", "page_idx": 21}, {"type": "text", "text": "Consider $\\begin{array}{r}{G\\sim\\mathrm{SBM}(n,\\frac{a\\log n}{n},\\frac{b\\log n}{n_{-}})}\\end{array}$ . Define $\\gamma=\\operatorname*{max}\\{a,b\\}$ . For any vertex $v\\in[n]$ , we define the signed neighbor counts of $v$ in $G$ as ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\mathrm{maj}_{G}(v)=\\pmb{\\sigma}_{\\ast}(v)\\sum_{u\\in\\mathcal{N}(v)}\\pmb{\\sigma}_{\\ast}(u).\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "For any $\\varepsilon>0$ , define a set of vertices: ", "page_idx": 21}, {"type": "equation", "text": "$$\nI_{\\varepsilon}(G):=\\{v\\in[n]:\\operatorname{maj}_{G}(v)\\leq\\varepsilon\\log n\\;\\mathrm{or}\\;|{\\mathcal N}(v)|\\geq\\gamma\\log^{3}n\\}.\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "Previous results (Lemma 5.1 [25], Proposition 4.3 [48]) have shown that Algorithm 3\u2019s correctness on $[n]\\setminus I_{\\varepsilon}(G)$ with a different choice of $m$ and the lower bound of $\\left|\\mathcal{N}(v)\\right|$ in the bad vertices set $I_{\\varepsilon}(G)$ . In our work, we first demonstrates that Algorithm 3 on input $\\left(G,a,b,\\varepsilon\\right)$ correctly classifies all vertices in $[n]\\setminus I_{\\varepsilon}(G)$ . ", "page_idx": 21}, {"type": "text", "text": "Input: Adjacency matrix $A$ on $n$ vertices; parameters $a,b,\\varepsilon>0$ .   \nOutput: A community label estimate $\\widehat{\\pmb{\\sigma}}\\in\\dot{\\{-1,+1\\}}^{n}$ .   \n1: Choose a positive integer $m$ satisfying $(\\log(\\varepsilon m(2\\operatorname*{max}(a,b)\\log^{2}n)^{-1})-1)\\varepsilon/2>1$ . Initialize two empty sets, $W_{+}$ and $W_{-}$ .   \n2: Using the spectral method of [3] to find a community partition of $[n]$ , denoted as $(U_{+},U_{-})$ .   \n3: Partition $[n]$ into $\\{U_{1},\\dotsc,U_{m}\\}$ uniformly at random.   \n4: for $i\\in[\\bar{m}]$ do   \n5: Using the spectral method of [3] to find a community partition $(U_{i,+},U_{i,-})$ of $G\\{[n]\\setminus U_{i}\\}$ . If $|U_{i,+}\\Delta U_{+}|\\geq n/2$ , then swap $U_{i,+}$ and $U_{i,-}$ .   \n6: For $v\\in U_{i}$ , insert $v$ into $W_{+}$ or $W_{-}$ according to its neighborhood majority (resp., minority) in $U_{i,+}\\cup U_{i,-}$ if $a>b$ (resp. $a<b$ ).   \n7: end for ", "page_idx": 22}, {"type": "text", "text": "", "page_idx": 22}, {"type": "text", "text": "8: For $i\\in W_{+}$ , set $\\widehat{\\pmb{\\sigma}}(i)=1$ , and for $i\\in W_{-}$ , set $\\widehat{\\pmb{\\sigma}}(i)=-1$ . Return $\\widehat{\\pmb{\\sigma}}$ . ", "page_idx": 22}, {"type": "text", "text": "Lemma 7. Algorithm 3 on input $(n,a,b,s)$ classifies all vertices in $[n]\\setminus I_{\\varepsilon}(G)$ correctly with high probability. ", "page_idx": 22}, {"type": "text", "text": "The proof directly follows from the proof of Proposition 5.1 in [25], with two remarks. First, although the maximum size of neighbors $|\\bar{\\mathcal{N}}(i)|$ we consider here is enlarged from $100\\operatorname*{max}\\{1,\\gamma\\}\\log n$ to $\\gamma\\log^{3}n$ , we adjust the condition of $m$ accordingly such that the tail bound holds. Secondly, we need to justify that with high probability, all partitions done by the spectral method are still almost exactly correct under the new choice of $m$ , which is no longer a constant independent of $n$ . Theorem 3.2 of [3] showed that the vanilla spectral method achieved optimal error rate, in the sense that $\\begin{array}{r}{\\mathbb{E}\\big[\\frac{1}{n}\\sum_{i=1}^{n}1_{\\{\\sigma_{*}(i)\\neq\\widehat\\sigma(i)\\}}\\big]\\,\\leq\\,n^{-(1+o(1))D+(a,b)}}\\end{array}$ . This implies that with probability $1-n^{-(1+o(1))D_{+}\\ddot{(}a,b)}$ , the spectral  method labels all but $o(n)$ vertices correctly. Furthermore, for all $i\\in[n]$ , $U_{i,+}$ matches with $\\bar{V}^{+}\\setminus U_{i}$ and $U_{i,-}$ matches with $V^{-}\\setminus U_{i}$ on all but $o(n)$ vertices after step (5) with high probability. ", "page_idx": 22}, {"type": "text", "text": "In this work, we further determine the probability of a set of vertices being in the set $I_{\\varepsilon}(G)$ , which is a generalization of the result on the $\\mathbb{P}(v\\in I_{\\varepsilon})$ for an arbitrary $v\\in[n]$ (Lemma 5.3 of [25]). ", "page_idx": 22}, {"type": "text", "text": "vLeertmexm sae t8 $S\\in[n]$ . a random graph $\\begin{array}{r}{G\\sim\\mathrm{SBM}(n,\\frac{s a\\log n}{n},\\frac{s b\\log n}{n})}\\end{array}$ and a fixed subgraph induced by ", "page_idx": 22}, {"type": "equation", "text": "$$\n\\mathbb{P}(\\{\\forall i\\in V(S),i\\in I_{\\varepsilon}\\}\\cap\\mathcal{H})=O(n^{-|S|(s D_{+}(a,b)-\\varepsilon(1+\\delta)|\\log(a/b)|)}+n^{-\\varepsilon\\delta(1-o(1))\\log n}).\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "$I f\\left|S\\right|=o(\\log n)$ , then for any $\\varepsilon>0,\\delta>0,$ , ", "page_idx": 22}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\mathbb{P}(\\{\\forall i\\in V(S),i\\in I_{\\varepsilon}\\}\\cap\\mathcal{H})=O(n^{-|S|(s D_{+}(a,b)-\\varepsilon(1+\\delta)|\\log(a/b)|)}).}\\end{array}\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "Proof. The main idea is considering the intersection of the interested event $\\{\\forall i\\in S,i\\in I_{\\varepsilon}\\}\\cap\\mathcal{H}$ with $\\mathcal{G}=\\{\\forall i\\in S,|\\mathcal{N}_{S}(i)|\\leq\\varepsilon\\delta\\log\\bar{n}\\}$ , where $\\mathcal{N}_{S}(v)$ denotes the set of neighbors of $v$ restricted on the vertex set $S$ . ", "page_idx": 22}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\mathbb{P}\\big(\\{\\forall i\\in S,i\\in I_{\\varepsilon}\\}\\cap\\mathcal{H}\\big)\\le\\mathbb{P}\\big(\\{\\forall i\\in S,i\\in I_{\\varepsilon}\\}\\cap\\mathcal{H}\\cap\\mathcal{F}\\cap\\mathcal{G}\\big)+\\mathbb{P}\\big(\\mathcal{G}^{c}\\big)+\\mathbb{P}\\big(\\mathcal{F}^{c}\\big).}\\end{array}\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "Firstly, we give the upper bound of $\\mathbb{P}(\\mathcal{G}^{c}\\mid\\pmb{\\sigma}_{*})\\mathbf{1}_{\\mathcal{H}}$ . Assume that $|S|\\,\\geq\\,\\varepsilon\\delta\\log n$ without loss of generality. By using an union bound, ", "page_idx": 22}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{P}(\\mathcal{G})\\leq|S|\\times\\mathbb{E}[\\mathbb{P}(|\\mathcal{N}_{S}(i)|>\\varepsilon\\delta\\log n\\mid\\sigma_{*})]}\\\\ &{\\qquad=|S|\\times\\displaystyle\\sum_{k=\\delta\\log n}^{|S|}\\binom{|S|}{\\varepsilon\\delta\\log n}(\\frac{a\\log n}{n})^{\\varepsilon\\delta\\log n}(1-\\frac{b\\log n}{n})^{|S|-\\varepsilon\\delta\\log n}}\\\\ &{\\qquad=n^{\\frac{\\log\\log n}{\\log n}}(\\frac{C a\\log^{2}n}{n})^{\\varepsilon\\delta\\log n}=O(n^{-\\varepsilon\\delta(1-o(1))\\log n}),}\\end{array}\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "where the second equation holds from the assumption of $|S|=O(\\log n)$ . ", "page_idx": 23}, {"type": "text", "text": "Secondly, we study this event $E=\\left\\{\\forall i\\in S,i\\in I_{\\varepsilon}\\right\\}\\cap\\mathcal{H}\\cap\\mathcal{F}$ . ", "page_idx": 23}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{P}(E)=\\mathbb{E}[\\mathbb{P}(\\{\\forall v\\in S,\\operatorname*{maj}_{G}(v)\\le\\varepsilon\\log n\\}\\mid\\sigma_{*})\\mathbf{1}_{\\mathcal{H}}]}\\\\ &{\\qquad=\\mathbb{E}[\\mathbb{P}(\\{\\forall v\\in S,\\operatorname*{maj}_{G[[n]\\backslash S]}(v)+\\operatorname*{maj}_{G[S]}(v)\\le\\varepsilon\\log n\\}\\mid\\sigma_{*})\\mathbf{1}_{\\mathcal{H}}]}\\\\ &{\\qquad\\le\\mathbb{E}[\\mathbb{P}(\\{\\forall v\\in S,\\operatorname*{maj}_{G[[n]\\backslash S]}(v)\\le\\varepsilon(1+\\delta)\\log n\\}\\mid\\sigma_{*})\\mathbf{1}_{\\mathcal{H}}].}\\end{array}\n$$", "text_format": "latex", "page_idx": 23}, {"type": "text", "text": "For any $v\\in S,\\operatorname*{maj}_{G[[n]\\backslash S]}(v)$ is the difference of two independent binomial random variables $Y_{v}$ and $Z_{v}$ , where $Y_{v}\\sim\\mathrm{Binom}(|V_{G[[n]\\backslash S]}^{\\sigma_{*}(v)}|,s a\\frac{\\log n}{n}),Z_{v}\\sim\\mathrm{Binom}(|V_{G[[n]\\backslash S]}^{-\\sigma_{*}(v)}|,s b\\frac{\\log n}{n})$ . With $\\mathcal{H}$ happening, we have |V G\u03c3[\u2217[n(]v)S] $V_{G[[n]\\backslash S]}^{\\sigma_{*}(v)}|=(1-o(1))\\frac{n}{2},|V_{G[[n]\\backslash S]}^{-\\sigma_{*}(v)}|=(1-o(1))\\frac{n}{2}.$ S\\ince $Y_{v}$ and $Z_{v}$ do not take into account $v\\in S$ , they are independent for all $v\\in S$ . Therefore, ", "page_idx": 23}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{P}(E)=\\mathbb{E}[\\Pi_{v\\in S}\\mathbb{P}(\\{Y_{v}-Z_{v}\\le\\varepsilon(1+\\delta)\\log n\\}\\mid\\sigma_{*})\\mathbf{1}_{\\mathcal{H}}]}\\\\ &{\\quad\\quad\\le(n^{-(s D_{+}(a,b)-\\frac{\\varepsilon(1+\\delta)\\mid\\log(a/b)\\mid}{2})+o(1)})^{|S|}}\\\\ &{\\quad\\quad\\le n^{-|S|(s D_{+}(a,b)-\\varepsilon(1+\\delta)\\mid\\log(a/b)\\mid)},}\\end{array}\n$$", "text_format": "latex", "page_idx": 23}, {"type": "text", "text": "where the second line holds by Lemma 5 and the last line holds for sufficiently large $n$ . We conclude with by Lemma 6, Inequality (14), and Inequality (15) into Inequality (13). ", "page_idx": 23}, {"type": "text", "text": "Remark 2. For arbitrary $\\varepsilon>0$ , we can find $\\varepsilon^{\\prime}>0$ and $\\delta>0$ such that $\\varepsilon^{\\prime}(1+\\delta)=\\varepsilon$ . For the sake of convenience, we also denote $D_{+}(a,b,s,\\varepsilon)$ as $s D_{+}(a,b)-\\varepsilon|\\log(a/b)|$ and this is equivalent as the $(\\varepsilon,\\delta)$ -parameterization in Lemma 8. We mainly use the $s D_{+}(a,b,s,\\varepsilon)$ notation in the analysis throughout this paper. ", "page_idx": 23}, {"type": "text", "text": "D.4 Tree node assigning ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Before getting to the first moment calculation of the similarity score, we introduce a sub-problem, named in-community edge counting for node assignment on trees. ", "page_idx": 23}, {"type": "text", "text": "Assume that we have a random graph $G$ with $n$ vertices, which are labeled by a community label vector $\\pmb{\\sigma}$ . We are also given a rooted tree $T(i)$ with $N$ vertices other than the root, where $i$ specifies the root node of $T$ on $G$ . Planting $T(i)$ onto $G$ has at least $\\binom{n}{N}$ possible positions. If $G$ is a stochastic block model, different planted positions of $T$ would contain different numbers of in-community edges. We are interested in the distribution of the number of in-community edges when planting $T(\\dot{i})$ onto $G$ uniformly at random. ", "page_idx": 23}, {"type": "text", "text": "Lemma 9. Let $K_{n}$ be the complete graph of a stochastic block model $G$ on n vertices. Let $\\sigma_{*}=$ $\\{\\pmb{\\sigma}_{*}(i)\\}_{i=1}^{n},\\pmb{\\sigma}_{*}(i)\\;\\in\\;\\{-1,+1\\}$ drawn independently and uniformly at random as the vector of community labels. Let $v\\in[n]$ be an arbitrary node of $K_{n}$ . Let $T$ be an arbitrary rooted tree with $N$ vertices other than the root. Consider a uniformly random injective function $\\bar{\\tau}:V(T)\\to V(K_{n})$ such that root $r(T)$ is mapped to $v$ in $V(K_{n})$ . Define $X$ as the random variable representing the number of in-community edges in the tree $T$ under random $\\tau$ . Then, ", "page_idx": 23}, {"type": "equation", "text": "$$\nB i n(N,\\frac{1}{2}-2n^{-\\frac{1}{4}})\\prec X\\mid\\mathcal{H}\\prec B i n(N,\\frac{1}{2}+2n^{-\\frac{1}{4}}).\n$$", "text_format": "latex", "page_idx": 23}, {"type": "text", "text": "Proof. There are $N$ edges on the tree $T$ . For any $(u,v)\\,\\in\\,V(K_{n})\\,\\times\\,V(K_{n})$ , we denote $X_{(u,v)}$ as the indicator random variable of event $\\mathcal{E}=\\{u$ and $v$ are from the same community}. Since $\\begin{array}{r}{\\frac12-2n^{-\\frac14}\\le\\mathbb P({\\mathcal E}\\mid{\\mathcal H})\\le\\frac12+2n^{-\\frac14},X_{(u,v)}\\mid{\\mathcal H}}\\end{array}$ stochastically dominates Bernoulli $\\left({\\frac{1}{2}}-2n^{-{\\frac{1}{4}}}\\right)$ and is stochastically dominated by Bernoulli $\\textstyle{\\left({\\frac{1}{2}}+2n^{-{\\frac{1}{4}}}\\right)}$ . Thus, the summation over all edges on tree $\\begin{array}{r}{T,\\,X\\mid\\mathcal{H}=\\sum_{(u,v)\\in E(T)}X_{(u,v)}\\mid\\mathcal{H}}\\end{array}$ , stochastically dominates $\\mathrm{Binom}(n,{\\frac{1}{2}}-2n^{-{\\frac{1}{4}}})$ and is stochastically dominated by $\\mathrm{Binom}(n,{\\frac{1}{2}}+2n^{-{\\frac{1}{4}}})$ . \u53e3 ", "page_idx": 23}, {"type": "text", "text": "Remark 3. If $N=o(n^{\\frac{1}{4}})$ , Lemma $^{\\,g}$ implies that with some non-negative integer $N_{1}\\leq N$ , $\\mathbb{P}(\\left\\{X=\\right.$ $\\begin{array}{r}{N_{1}\\}\\cap\\mathcal{H})=(1+o(1))\\binom{N}{N_{1}}\\binom{1}{2}^{N}}\\end{array}$ . Because $\\mathbb{P}(\\{X=N_{1}\\}\\cap\\mathcal{H})=(1-o(1))\\mathbb{P}(X=N_{1}\\mid\\mathcal{H})$ , it suffices to show both the upper and lower bound on $\\mathbb{P}(X=N_{1}\\mid\\mathcal{H})$ . ", "page_idx": 23}, {"type": "text", "text": "", "page_idx": 24}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{P}(X=N_{1}\\mid\\mathcal{H})=\\mathbb{P}(X\\geq N_{1}\\mid\\mathcal{H})-\\mathbb{P}(X\\geq N_{1}+1\\mid\\mathcal{H})}\\\\ &{\\quad\\leq\\displaystyle\\sum_{t\\geq N_{1}}\\binom{N}{t}(\\frac{1}{2}+2n^{-\\frac{1}{4}})^{t}(\\frac{1}{2}-2n^{-\\frac{1}{4}})^{N-t}-\\displaystyle\\sum_{t\\geq N_{1}+1}\\binom{N}{t}(\\frac{1}{2}-2n^{-\\frac{1}{4}})^{t}(\\frac{1}{2}+2n^{-\\frac{1}{4}})^{N-t}}\\\\ &{\\quad\\leq(1+o(1))\\binom{N}{N_{1}}(\\frac{1}{2})^{N}+\\displaystyle\\sum_{t\\geq(N-N_{1})\\vee(N_{1}+1)}\\binom{N}{t}(\\frac{1}{2})^{N}f(n,N,t),}\\end{array}\n$$", "text_format": "latex", "page_idx": 24}, {"type": "text", "text": "where $f(n,N,t)=(1+4n^{-\\frac{1}{4}})^{t}(1-4n^{-\\frac{1}{4}})^{N-t}-(1-4n^{-\\frac{1}{4}})^{t}(1+4n^{-\\frac{1}{4}})^{N-t}$ . The first inequality holds because of the stochastic dominance in Lemma 9. The second inequality holds because $\\begin{array}{r}{\\binom{N}{N-t}f(n,N,N-t)=\\binom{N}{t}f(n,N,t)}\\end{array}$ and thus cancels out every term in the summation indexed from $t=N_{1}+1$ to $t=N-(N_{1}+1)$ . For $t\\geq(N-N_{1})\\vee(N_{1}+1)$ , we know that $\\binom{N}{t}<\\binom{N}{N_{1}}$ . Also, $\\begin{array}{r}{f(n,N,t)\\leq(1+4n^{-\\frac{1}{4}})^{N}-(1-4n^{-\\frac{1}{4}})^{N}<O(n^{-\\frac{1}{4}}N)=o(\\frac{1}{N})}\\end{array}$ from our assumption on $N$ . Therefore, summing over $t\\geq\\left(N-N_{1}\\right)\\wedge\\left(N_{1}+1\\right)$ , we have ", "page_idx": 24}, {"type": "equation", "text": "$$\n\\mathbb{P}(X=N_{1}\\mid\\mathcal{H})\\le(1+o(1))\\binom{N}{N_{1}}(\\frac{1}{2})^{N}.\n$$", "text_format": "latex", "page_idx": 24}, {"type": "text", "text": "From the other direction of stochastic dominance, we have $\\mathbb{P}(X\\,=\\,N_{1}\\,\\mid\\,\\mathcal{H})\\,=\\,\\mathbb{P}(X\\,\\geq\\,N_{1}\\,\\mid\\,$ $\\begin{array}{r}{\\mathcal{H})-\\mathbb{P}(X\\geq N_{1}+1\\mid\\mathcal{H})\\geq(1-o(1))\\binom{N}{N_{1}}\\binom{1}{2}^{N}}\\end{array}$ . ", "page_idx": 24}, {"type": "text", "text": "Lemma 10. Let $K_{n}$ be the complete graph of a stochastic block model $G$ on $n$ vertices. Let $\\pmb{\\sigma}_{\\ast}=\\{\\pmb{\\sigma}_{\\ast}(i)\\}_{i=1}^{n},\\pmb{\\sigma}_{\\ast}(i)\\in\\{-1,+1\\}$ drawn independently and uniformly at random as the vector of community labels. Let $v\\in[n]$ be an arbitrary node of $G$ . Let $\\{T\\}_{i=1}^{t}$ be a sequence of arbitrary rooted tree with $N$ vertices other than the root. Consider a uniformly random injective function $\\tau:V(T)\\to V(K_{n})$ such that root $r(T_{1})$ of the first tree is mapped to v in $V(K_{n})$ . Also, the root of $i$ -th tree is mapped to $\\tau(r(T_{i}))=\\tau(u)$ for a fixed vertex on previous trees $u\\in\\cup_{t=1}^{i-1}V(T_{t})$ or a fixed vertex on $K_{n}$ . Define $X$ as the random variable representing the number of in-community edges in all the trees under random $\\tau$ . Then, ", "page_idx": 24}, {"type": "equation", "text": "$$\nB i n(N,\\frac{1}{2}-2n^{-\\frac{1}{4}})\\prec X\\mid\\mathcal{H}\\prec B i n(N,\\frac{1}{2}+2n^{-\\frac{1}{4}}).\n$$", "text_format": "latex", "page_idx": 24}, {"type": "text", "text": "Proof. Define $X_{i}$ as the random variable for number of in-community edges on Tree $T_{i}$ with random embedding $\\tau$ . The following holds immediately from Lemma 9, ", "page_idx": 24}, {"type": "equation", "text": "$$\n\\mathrm{Bin}(N_{T_{i}},\\frac{1}{2}-2n^{-\\frac{1}{4}})\\prec X_{i}\\mid\\mathcal{H}\\prec\\mathrm{Bin}(N_{T_{i}},\\frac{1}{2}+2n^{-\\frac{1}{4}}).\n$$", "text_format": "latex", "page_idx": 24}, {"type": "text", "text": "Since $\\begin{array}{r}{X\\mid\\mathcal{H}=\\sum_{i}X_{i}\\mid\\mathcal{H}.}\\end{array}$ , ", "page_idx": 24}, {"type": "equation", "text": "$$\n\\sin(N,\\frac{1}{2}-2n^{-\\frac{1}{4}})\\prec X\\mid\\mathcal{H}\\prec\\mathrm{Bin}(N,\\frac{1}{2}+2n^{-\\frac{1}{4}}).\n$$", "text_format": "latex", "page_idx": 24}, {"type": "text", "text": "To present the following Lemma 11, we need to introduce a few more definitions: decorated union graph and decorated edges, which will be explained in more details in the context of chandelier in Section I. ", "page_idx": 24}, {"type": "text", "text": "Decorated Union Graph. Let $S_{1},S_{2},T_{1},T_{2}$ be four rooted graphs. The union graph is defined as $U:=S_{1}\\cup S_{2}\\cup T_{1}\\cup T_{2}$ . We define the decorated union graph as a two-tuple $\\dot{\\boldsymbol{U}}:=(U,D_{U})$ , which is $U$ associating with a decoration set. For each edge, ", "page_idx": 24}, {"type": "equation", "text": "$$\nD_{U}(e)=\\left\\{\\!\\!\\!\\begin{array}{l l}{\\mathrm{The~subset~of~}\\{S_{1},S_{2},T_{1},T_{2}\\}\\mathrm{~where~}e\\mathrm{occurs},}&{\\mathrm{if~}e\\in E(U),}\\\\ {\\varnothing,}&{\\mathrm{otherwise}.}\\end{array}\\right.\n$$", "text_format": "latex", "page_idx": 24}, {"type": "text", "text": "We call an edge $e\\in E(U)$ is $t$ -decorated if $|D_{U}(e)|=t$ for $t\\in\\{0,1,2,3,4\\}$ . Decorated union graph $\\dot{U}$ has one-to-one correspondence with $(S_{1},S_{2},T_{1},T_{2})$ as we can uniquely determine $\\dot{U}$ given $(S_{1},S_{2},T_{1},T_{2})$ and uniquely recover $(S_{1},S_{2},T_{1},T_{2})$ given $\\dot{U}$ . ", "page_idx": 24}, {"type": "text", "text": "Lemma 11 (Asymptotic independence of the counts of $i$ -decorated in-community edges). Let $K_{n}$ be the complete graph of a stochastic block model $G$ on $n$ vertices. Consider a connected decorated union graph $\\dot{U}_{P}$ with $d_{1}$ 1-decorated edges, $d_{2}$ 2-decorated edges, $d_{3}$ 3-decorated edges, and $d_{4}$ 4-decorated edges, rooted at v on the complete graph $K_{n}$ . Consider a uniformly random injective function $\\tau:V\\bar{(}T)\\to V(K_{n})$ such that root $r(T)$ is mapped to $v$ in $V(K_{n})$ . Define $X^{(i)}$ as the random variable representing the number of $i$ -decorated in-community edges in $\\dot{U}_{P}$ . Assume that $|V(\\dot{U}_{P})|=O(\\log n)$ and $\\dot{U}_{P}$ has excess $k$ . If $k=-1$ , then, ", "page_idx": 25}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{P}(X^{(1)}=M_{1},X^{(2)}=M_{2},X^{(3)}=M_{3},X^{(4)}=M_{4}\\mid\\mathcal{H})}\\\\ &{\\qquad=(1\\pm o(1))\\mathbb{P}(X^{(1)}=M_{1}\\mid\\mathcal{H})\\mathbb{P}(X^{(2)}=M_{2}\\mid\\mathcal{H})\\mathbb{P}(X^{(3)}=M_{3}\\mid\\mathcal{H})\\mathbb{P}(X^{(4)}=M_{4}\\mid\\mathcal{H})}\\\\ &{\\qquad=(1+o(1))\\binom{d_{1}}{M_{1}}\\binom{d_{2}}{M_{2}}\\binom{d_{3}}{M_{3}}\\binom{d_{4}}{M_{4}}\\frac{1}{2^{d_{1}+d_{2}+d_{3}+d_{4}}}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 25}, {"type": "text", "text": "Proof. From the assumption $k=-1$ we have $\\dot{U}_{P}$ is a tree. We can decompose $U_{P}$ to a sequence of trees as follows: Traverse $U_{P}$ in BFS order and include each maximal connected component with all edges $i$ -decorated as a subtree. ", "page_idx": 25}, {"type": "text", "text": "In addition, we break this sequence of tree into four sequences based on the decoration number: $\\{T_{j}^{(1)}\\}_{j=1}^{c},\\{T_{j}^{(2)}\\}_{j=1}^{d},\\{T_{j}^{(3)}\\}_{j=1}^{e},\\{T_{j}^{(4)}\\}_{j=1}^{f}.$ In the random mapping, the root of each tree should be mapped to either $v$ or a non-root vertex on the other tree. Let $X_{j}^{(i)}$ be the random variable for the number of in-community edges for the $j$ -th tree of $i$ -decoration. $X_{j}^{(i)}\\mid\\mathcal{H}$ satisfies the following stochastic dominance: ", "page_idx": 25}, {"type": "equation", "text": "$$\n\\mathrm{Bin}(|V(T_{j}^{(i)})|,\\frac{1}{2}-2n^{-\\frac{1}{4}})\\prec X_{j}^{(i)}\\mid\\mathcal{H}\\prec\\mathrm{Bin}(|V(T_{j}^{(i)})|,\\frac{1}{2}+2n^{-\\frac{1}{4}}).\n$$", "text_format": "latex", "page_idx": 25}, {"type": "text", "text": "Thus, their summation satisfies the following stochastic dominance: ", "page_idx": 25}, {"type": "equation", "text": "$$\n\\mathrm{Bin}(d_{i},\\frac{1}{2}-2n^{-\\frac{1}{4}})\\prec X^{(i)}\\mid\\mathcal{H}\\prec\\mathrm{Bin}(d_{i},\\frac{1}{2}+2n^{-\\frac{1}{4}}),i=1,2,3,4.\n$$", "text_format": "latex", "page_idx": 25}, {"type": "text", "text": "As each of the series of trees occupy $O(\\log n)$ vertices, every $X^{(i)}$ conditioned on other $X^{(i^{\\prime})},i^{\\prime}\\neq i$ still satisfies the stochastic dominance: ", "page_idx": 25}, {"type": "equation", "text": "$$\n\\sin(d_{i},\\frac{1}{2}-2n^{-\\frac{1}{4}})\\prec X^{(i)}|X^{(i^{\\prime})},\\mathcal{H}\\prec\\mathtt{B i n}(d_{i},\\frac{1}{2}+2n^{-\\frac{1}{4}}).\n$$", "text_format": "latex", "page_idx": 25}, {"type": "text", "text": "Specifically, following Remark 3, $\\begin{array}{r}{\\mathbb{P}(X^{(4)}=M_{4}\\mid\\mathcal{H})=(1+o(1))\\binom{d_{4}}{M_{4}}\\frac{1}{2^{d_{4}}}}\\end{array}$ , $\\mathbb{P}(X^{(3)}=M_{3}|X^{(4)}=$ $\\begin{array}{r}{M_{4},\\mathcal{H})=(1+o(1))\\binom{d_{3}}{M_{3}}\\frac{1}{2^{d_{3}}}}\\end{array}$ , $\\mathbb{P}(X^{(2)}=M_{2}|X^{(3)}=M_{3},X^{(4)}=M_{4},\\mathcal{H})=(1$ + o(1)) Md22 2d12 , and $\\begin{array}{r}{\\mathbb{P}(X^{(1)}=M_{1}|X^{(2)}=M_{2},X^{(3)}=M_{3},X^{(4)}=M_{4},\\mathcal{H})=(1+o(1))\\big(\\O_{M_{1}}^{d_{1}}\\big)\\frac{1}{2^{d_{1}}}.}\\end{array}$ . Collectively, these form the asymptotic independence of $X^{(i)}$ : ", "page_idx": 25}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{P}(X^{(1)}=M_{1},X^{(2)}=M_{2},X^{(3)}=M_{3},X^{(4)}=M_{4}\\mid\\mathcal{H})}\\\\ &{\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad=(1+o(1))\\binom{d_{1}}{M_{1}}\\binom{d_{2}}{M_{2}}\\binom{d_{3}}{M_{3}}\\binom{d_{4}}{M_{4}}\\frac{1}{2^{d_{1}+d_{2}+d_{3}+d_{4}}}.\\quad\\sqcup}\\end{array}\n$$", "text_format": "latex", "page_idx": 25}, {"type": "text", "text": "Lemma 11 discusses the case of $k=-1$ . We do not expect the same property holds for $k\\geq0$ but we have an auxiliary result as in the following Corollary 1. ", "page_idx": 25}, {"type": "text", "text": "Corollary 1. (If $k\\geq0,$ , then $\\dot{U}_{P}$ contains cycles.) By definition, $\\dot{U}_{P}$ can be decomposed into a tree $T_{P}$ with $v_{P}$ vertice s\u2265 other than the root and additional $k+1$ distinct edges $E_{k+1}=\\{(u_{j},v_{j})\\}_{i=j}^{k+1}$ fixed. By edges\u2019 decorations, $E_{k+1}=E^{(1)}\\cup E^{(2)}\\cup E^{(3)}\\cup E^{(4)}$ . Let $X^{(i)}$ still be the random variable representing the number of $i$ -decorated in-community edges on $\\dot{U}_{N}$ . If $k\\geq0$ , let $X^{(i,a)}$ be the counts of $i$ -decorated in-community edges on $T_{N}$ and $X^{(i,b)}$ be the counts of $i$ -decorated in-community edges on $\\{e_{i}\\}_{i=1}^{k+1}$ . From construction, we know $X^{(i)}=X^{(i,a)}+X^{(i,b)}$ . Correspondingly, there are $A_{i}$ i-decorated edges on tree, $B_{i}=|E^{(i)}|.$ , and $d_{i}=A_{i}+B_{i}$ , which are all fixed from $\\dot{U}_{P}$ . ", "page_idx": 25}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{h e n,\\,\\mathbb{P}(X^{(1,a)}=a_{1},X^{(2,a)}=a_{2},X^{(3,a)}=a_{3},X^{(4,a)}=a_{4},X^{(2,b)}=b_{2},X^{(1,b)}=b_{1},X^{(3,b)}=b_{2},}\\\\ &{_{3},X^{(4,b)}=b_{4}\\mid\\mathcal{H})\\le(1+o(1))\\binom{A_{1}}{a_{1}}\\binom{A_{2}}{a_{2}}\\binom{A_{3}}{a_{3}}\\binom{A_{4}}{a_{4}}\\frac{1}{2^{A_{1}+A_{2}+A_{3}+A_{4}}}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 25}, {"type": "text", "text": "The proof follows straightforwardly from the proof of Lemma 11. ", "page_idx": 25}, {"type": "image", "img_path": "nBhfIcDnRP/tmp/08cf43df8583c553466709647ab423e2be804bb5158e5526794b70a24b173a9a.jpg", "img_caption": [], "img_footnote": [], "page_idx": 26}, {"type": "text", "text": "Figure 5: Decomposition of a decorated tree into three sequences of trees. Edges that are 2, 3, 4-decorated are painted as red, green, and blue color correspondingly. Roots of each subtree is marked by larger node and annotated as $r(T_{j}^{(i)})$ , where $i$ is the decoration counts and $j$ is the order in its sequence. ", "page_idx": 26}, {"type": "text", "text": "D.5 Inequalities concerning automorphisms ", "text_level": 1, "page_idx": 26}, {"type": "text", "text": "In this subsection, we study how adding edges can change the number of rooted automorphisms of a rooted tree. With a slight abuse of notation, we denote by aut $(T)$ the number of rooted automorphisms (i.e., automorphisms which fix the root) of a rooted tree $T$ . We start by quantifying the effect of adding an additional edge. ", "page_idx": 26}, {"type": "text", "text": "Lemma 12. Let $T=(V,E,r)$ be a rooted tree with root $r$ . Let $T^{\\prime}:=(V\\cup\\{u\\},E\\cup\\{(u,v)\\},r)$ be the rooted tree obtained from $T$ by adding $a$ vertex $u$ and the edge $(u,v)$ , where $v\\in V$ . The following bounds hold: ", "page_idx": 26}, {"type": "equation", "text": "$$\n\\operatorname{aut}(T)\\times{\\frac{1}{|V|-1}}\\leq\\operatorname{aut}(T^{\\prime})\\leq\\operatorname{aut}(T)\\times|V|,\n$$", "text_format": "latex", "page_idx": 26}, {"type": "text", "text": "where $|V|$ is the number of vertices in $T$ . ", "page_idx": 26}, {"type": "text", "text": "Proof. Since $T$ is a rooted tree, there is a natural notion of a parent vertex for every vertex other than the root. Namely, the parent of a vertex $v\\neq r$ is the neighbor of $v$ which is closest to the root $r$ . We also define the subtree rooted at $v$ to be the subtree of $T$ induced by all vertices whose shortest path to $r$ goes through $v$ , rooted at $v$ . ", "page_idx": 26}, {"type": "text", "text": "We partition $V$ into equivalence classes according to the following rule: $v_{1}$ and $v_{2}$ are in the same equivalence class if and only if they share the same parent and the subtrees rooted at $v_{1}$ and $v_{2}$ are isomorphic. We denote the resulting partition as $\\{V_{i}\\}_{i\\in\\mathbb{Z}}$ and refer to the equivalence classes as orbits. Note that the root $r$ is always in a single-element orbit and thus the size of each orbit is at most $|V|-1$ . ", "page_idx": 26}, {"type": "text", "text": "Observe that a permutation of the vertices is a rooted automorphism precisely when it maps each vertex to a vertex in its orbit. Thus we have that ", "page_idx": 26}, {"type": "equation", "text": "$$\n\\mathrm{aut}(T)=\\prod_{i\\in\\mathcal{I}}|V_{i}|!.\n$$", "text_format": "latex", "page_idx": 26}, {"type": "text", "text": "Now consider $T^{\\prime}$ , which adds a new vertex $u$ to $T$ with an edge connecting $u$ to a vertex in $T$ . By (17), in order to understand $\\mathrm{aut}(T^{\\prime})$ , we need to understand how the orbits and their sizes change due to the addition of the new vertex and edge. The new vertex $u$ will either join an existing orbit or form its own one. The parent of $u$ may change orbits, so might the parent of its parent, etc. In other words, the vertices on the path from $u$ to the root $r$ might change their orbit, but vertices not on this path will not. In the following, we argue iteratively based on the depth of $u$ in $T^{\\prime}$ (i.e., its distance from the root). When considering the upper bound, we will ignore the possible size decrease of orbits. When considering the lower bound, we will ignore the possible size increase of orbits. ", "page_idx": 26}, {"type": "text", "text": "Assume first that the new vertex $u$ is attached to the root $r$ . If there are no leaves except for $u$ connecting to $r$ , then $u$ forms a new orbit $V_{|\\mathcal{Z}|+1}$ whose size is 1, which does not change the number of rooted automorphisms. Otherwise, without loss of generality, assume that orbit $V_{1}$ is the set that contains all leaves connected to $r$ . Then $u$ will join this orbit, so the set of orbits of $T^{\\prime}$ is given by V1 \u222a{u} and {Vi}|iI=|2 . Thus, we have that $\\mathrm{aut}(T^{\\prime})=\\mathrm{aut}(T)(|V_{1}|+1)$ , so in particular ", "page_idx": 27}, {"type": "equation", "text": "$$\n\\mathrm{aut}(T)\\leq\\mathrm{aut}(T^{\\prime})=\\mathrm{aut}(T)(\\left|V_{1}\\right|+1)\\leq\\mathrm{aut}(T)\\times\\left|V\\right|.\n$$", "text_format": "latex", "page_idx": 27}, {"type": "text", "text": "Now suppose that $u$ has depth 2 in $T^{\\prime}$ , and let $\\boldsymbol{v}^{(1)}$ denote the parent of $u$ in $T^{\\prime}$ . Without loss of generality, assume that $\\boldsymbol{v}^{(1)}\\in V_{1}$ . There are again two cases depending on whether or not there are leaves attached to $\\boldsymbol{v}^{(1)}$ in $T$ . Suppose first that there are not any leaves attached to $\\boldsymbol{v}^{(1)}$ in $T$ . Then $u$ has its own orbit (of size 1) in $T^{\\prime}$ . The orbit of $\\boldsymbol{v}^{(1)}$ changes from $V_{1}$ in $T$ to either a new orbit or some existing orbit $V_{j_{1}}$ in $T^{\\prime}$ (for some $2\\,\\leq\\,j_{1}\\,\\leq\\,|{\\mathcal{Z}}|)$ . In the former case we have that $\\mathrm{aut}(T^{\\prime})=\\mathrm{aut}(T)/|\\bar{V}_{1}|$ , while in the latter case we have that ", "page_idx": 27}, {"type": "equation", "text": "$$\n\\mathrm{aut}(T^{\\prime})=\\mathrm{aut}(T)\\times\\frac{|V_{j_{1}}|+1}{|V_{1}|}.\n$$", "text_format": "latex", "page_idx": 27}, {"type": "text", "text": "The desired inequalities thus follow since each orbit has size at most $|V|-1$ . Now suppose that there are leaves attached to $\\boldsymbol{v}^{(1)}$ in $T$ and let $V_{2}$ denote the equivalence class of these vertices. Then, $u$ joins the orbit $V_{2}$ in $T^{\\prime}$ . The orbit of $\\boldsymbol{v}^{(1)}$ again changes from $V_{1}$ in $T$ to either a new orbit or some existing orbit $V_{j_{1}}$ in $T^{\\prime}$ (for some $3\\,\\leq\\,j_{1}\\,\\leq\\,|{\\mathcal{Z}}|)$ . In the former case we have that $\\mathrm{aut}(T^{\\prime})=\\mathrm{aut}(T)\\times(|V_{2}|+\\bar{1})/|V_{1}|$ , while in the latter case we have that ", "page_idx": 27}, {"type": "equation", "text": "$$\n\\operatorname{aut}(T^{\\prime})=\\operatorname{aut}(T)\\times{\\frac{(|V_{2}|+1)(|V_{j_{1}}|+1)}{|V_{1}|}}.\n$$", "text_format": "latex", "page_idx": 27}, {"type": "text", "text": "The lower bound follows since $|V_{1}|\\leq|V|-1$ . For the upper bound in the latter case, note that by the definition of orbits, in $T^{\\prime}$ there are $|V_{j_{1}}|+1$ nodes at depth 1 who each have $|V_{2}|+1$ children that are leaves. This implies that $T^{\\prime}$ has at least $(|V_{2}|+1)(|V_{j_{1}}|+1)$ non-root vertices, so $(|V_{2}|+1)(|V_{j_{1}}|+1)\\le(|V|+\\bar{1})-1=|V|$ . ", "page_idx": 27}, {"type": "text", "text": "The general case when $u$ has depth $\\ell$ in $T^{\\prime}$ is analogous. Let $\\boldsymbol{v}^{(\\ell-1)}$ denote the parent of $u$ in $T^{\\prime}$ , let $\\boldsymbol{v}^{(\\ell-\\bar{2})}$ denote the parent of $\\boldsymbol{v}^{(\\ell-\\bar{1})}$ , etc. Without loss of generality, let $V_{i}$ denote the orbit of $\\boldsymbol{v}^{(i)}$ in $T$ for $i\\in[\\ell-1]$ . Suppose that $\\boldsymbol{v}^{(\\ell-1)}$ has children that are leaves in $T$ (the other case, when it does not, is similar and simpler), and let $V_{\\ell}$ denote the equivalence class of these vertices. Then, using similar observations as above, we obtain the following upper and lower bounds on aut $(T^{\\prime})$ : ", "page_idx": 27}, {"type": "equation", "text": "$$\n\\mathrm{aut}(T)\\times\\frac{1}{\\prod_{i=1}^{\\ell-1}|V_{i}|}\\leq\\mathrm{aut}(T^{\\prime})\\leq\\mathrm{aut}(T)\\times(|V_{\\ell}|+1)\\times\\prod_{i=1}^{\\ell-1}\\left(|V_{j_{i}}|+1\\right).\n$$", "text_format": "latex", "page_idx": 27}, {"type": "text", "text": "Here, for every $i\\in[\\ell-1]$ , either $j_{i}\\,\\in\\,[\\ell+1,|{\\mathcal{Z}}|]$ (which corresponds to $\\boldsymbol{v}^{(i)}$ changing from $V_{i}$ in $T$ to some existing orbit $V_{j_{i}}$ in $T^{\\prime}$ ) or $|V_{j_{i}}|\\,=\\,0$ (which corresponds to $\\boldsymbol{v}^{(i)}$ changing from $V_{i}$ in $T$ to a new orbit in $T^{\\prime}$ ). To conclude the lower bound, observe (using the definition of orbits) that $T$ contains a subtree consisting of the root and $\\textstyle\\prod_{i=1}^{\\ell-1}|V_{i}|$ additional vertices, so $\\prod_{i=1}^{\\ell-1}\\left|V_{i}\\right|\\leq$ $|V|-1$ . For the upper bound, observe similarly that $T^{\\prime}$ contains a subtree consisting of the root and $\\begin{array}{r}{\\left(|V_{\\ell}|+1\\right)\\times\\prod_{i=1}^{\\ell-1}\\left(|V_{j_{i}}|+1\\right)}\\end{array}$ additional vertices, so $\\begin{array}{r}{(|V_{\\ell}|+1)\\times\\prod_{i=1}^{\\ell-1}\\left(|V_{j_{i}}|+1\\right)\\leq|V|.}\\end{array}$ . \u518f\u53e3 ", "page_idx": 27}, {"type": "text", "text": "Lemma 12 is tight. Let $T$ be a star rooted at its center (i.e., a tree where all vertices except the root are connected to the root). Then all permutations of the vertices that fix the root are rooted automorphisms, so $\\mathrm{aut}(T)=(|V(T)|-1)!$ . Now let $T^{\\prime}$ be a tree obtained from $T$ by adding an additional child to the root (see Figure 6, tree in the middle). Then $\\mathrm{aut}(T^{\\prime})=(|V(T)|)!=\\mathrm{aut}(T)\\times|V(T)|$ . This shows that the upper bound in Lemma 12 is tight. Now let $T^{\\prime\\prime}$ be a tree obtained from $T$ by adding a child to one of the leaves of $T$ (see Figure 6, tree on the right). The rooted automorphisms of $T^{\\prime\\prime}$ are precisely the permutations of the vertices that permute the neighbors of the root which are leaves, so $\\mathrm{aut}(T^{\\prime\\prime})=(\\bar{|}V(T)|-2)!=\\mathrm{aut}(T)/(|V(T)|-1)$ . This shows that the lower bound in Lemma 12 is tight. ", "page_idx": 27}, {"type": "text", "text": "From Lemma 12, we can derive the following corollary by an iterative argument. ", "page_idx": 27}, {"type": "image", "img_path": "nBhfIcDnRP/tmp/b6a6a50a28d2feca52bcae8147af9c3c494c902a72f0ad5ee7f819893eb418b0.jpg", "img_caption": [], "img_footnote": [], "page_idx": 28}, {"type": "text", "text": "Figure 6: Left: The simplest example of two rooted trees $T_{1}$ and $T_{2}$ satisfying $\\sqrt{\\mathrm{aut}(T_{1})\\mathrm{aut}(T_{2})}>$ $\\operatorname{aut}(T_{1}\\cup T_{2})$ ; here $T_{1}$ is induced by the blue and green edges, $T_{2}$ is induced by the blue and red edges, and both trees are rooted at the vertex at the top. Middle: Example that shows that the upper bound in Lemma 12 is tight, where blue lines and black vertices represent $T$ , and the red vertex is additionally added with an edge attaching it to the root. Right: Example that shows that the lower bound in Lemma 12 is tight. ", "page_idx": 28}, {"type": "text", "text": "Corollary 2. Let $T_{1}=(V_{1},E_{1},r)$ and $T_{2}=(V_{2},E_{2},r)$ be two trees rooted at the same vertex $r$ . Define the union $T_{1}\\cup T_{2}:=(V_{1}\\cup V_{2},E_{1}\\cup E_{2},r)$ by taking the union of the two vertex sets (both of which contain $r$ ) and the union of the two edge sets, with multiple edges ignored (i.e., if an edge appears in both $E_{1}$ and $E_{2}$ , then it appears in $E_{1}\\cup E_{2}$ exactly once). Suppose that $T_{1}\\cup T_{2}$ is also $a$ tree. Let $d:=|E_{1}\\triangle E_{2}|$ denote the size of the symmetric difference of the edge sets. Then ", "page_idx": 28}, {"type": "equation", "text": "$$\n\\sqrt{\\mathrm{aut}(T_{1})\\mathrm{aut}(T_{2})}\\leq\\mathrm{aut}(T_{1}\\cup T_{2})\\times(2\\operatorname*{max}\\{|V_{1}|,|V_{2}|\\})^{d}.\n$$", "text_format": "latex", "page_idx": 28}, {"type": "text", "text": "Proof. By the assumptions on $T_{1}$ and $T_{2}$ , the union $T_{1}\\cup T_{2}$ has $\\left(|V_{1}|+|V_{2}|+d\\right)/2-1$ edges. There are two natural ways that we can think of $T_{1}\\cup T_{2}$ . First, we can start from $T_{1}$ and add $\\big(|V_{2}|-|V_{1}|+d\\big)/2$ new vertices\u2014those that are in $V_{2}$ but not in $V_{1}$ \u2014one at a time, together with a new edge for each new added vertex, connecting it to an existing vertex, to obtain $T_{1}\\cup T_{2}$ . With this perspective, applying the lower bound in (16) from Lemma 12 across each of the $\\big(|V_{2}|-|V_{1}|+d\\big)/2$ steps, we obtain that ", "page_idx": 28}, {"type": "equation", "text": "$$\n\\operatorname{aut}(T_{1})\\leq\\operatorname{aut}(T_{1}\\cup T_{2})\\prod_{k=|V_{1}|-1}^{(|V_{1}|+|V_{2}|+d)/2-2}k.\n$$", "text_format": "latex", "page_idx": 28}, {"type": "text", "text": "On the other hand, we can equally well start from $T_{2}$ and add $\\big(|V_{1}|-|V_{2}|+d\\big)/2$ new edges and vertices to obtain $T_{1}\\cup T_{2}$ . Thus, analogously, (19) also holds with $\\mathrm{aut}(T_{1})$ on the left hand side replaced with aut $\\left(T_{2}\\right)$ , and $|V_{1}|-1$ on the right hand side (the minimum value of $k$ in the product) replaced with $|V_{2}|-1$ . ", "page_idx": 28}, {"type": "text", "text": "Combining these two inequalities, we obtain that ", "page_idx": 28}, {"type": "equation", "text": "$$\n\\sqrt{\\mathrm{aut}(T_{1})\\mathrm{aut}(T_{2})}\\le\\mathrm{aut}(T_{1}\\cup T_{2})\\times\\prod_{k=\\operatorname*{min}\\{|V_{1}|,|V_{2}|\\}-1}^{(|V_{1}|+|V_{2}|+d)/2-2}k.\n$$", "text_format": "latex", "page_idx": 28}, {"type": "text", "text": "Since $d\\leq2(\\operatorname*{max}\\{|V_{1},V_{2}|\\}-1)$ , it follows that $(|V_{1}|+|V_{2}|+d)/2-2\\leq2\\operatorname*{max}\\{|V_{1}|,|V_{2}|\\}$ , so all factors in the product above are at most $2\\operatorname*{max}\\{|V_{1}|,|V_{2}|\\}$ . Note also that $d\\geq\\operatorname*{max}\\{|V_{1},V_{2}|\\}-$ $\\operatorname*{min}\\{|V_{1},V_{2}|\\}$ , so the number of factors in the product above is $(\\operatorname*{max}\\{|V_{1},V_{2}|\\}-\\operatorname*{min}\\{|V_{1},V_{2}|\\}+$ $d)/2\\leq d$ . Putting these observations together we see that (18) holds. \u53e3 ", "page_idx": 28}, {"type": "text", "text": "Remark 4. The leftmost example in Figure $^{6}$ provides an example showing that the right hand side of (18) would no longer be an upper bound without the factor $(2\\operatorname*{max}\\{|V_{1}|,|V_{2}|\\})^{d}$ . ", "page_idx": 28}, {"type": "text", "text": "D.6 Auxiliary result: bounds on the cross-moments ", "text_level": 1, "page_idx": 28}, {"type": "text", "text": "In this section, we summarize the upper bound on cross-moments. In Lemma 13, we work on the regime $s D_{+}(a,b)>1$ where we can recover the community label exactly first. In Lemma 14, we work on the regime $s D_{+}(a,b)<1$ where we we have a inverse polynomial fraction of vertices being labeled incorrectly. ", "page_idx": 28}, {"type": "text", "text": "Lemma 13. Let $\\begin{array}{r}{(G_{1},G_{2})\\;\\sim\\;\\mathrm{CSBM}(n,p,q,s),p\\ =\\ \\frac{a\\log n}{n},q\\ =\\ \\frac{b\\log n}{n}}\\end{array}$ b long n. Denote A, B as the centralized adjacency matrices of $G_{1}$ and $G_{2}$ correspondingly. Let e $:=(u,v)\\in[n]\\times[n]$ be an arbitrary edge. Define the edge type indicator $c(e)=+\\,i f e$ is an in-community edge and $c(e)=-$ if e is a cross-community edge under $\\pmb{\\sigma}_{*}$ . The following holds for $0\\leq\\ell,m\\leq2,2\\leq\\ell+m\\leq4$ , and any \u03c3\u2217, ", "page_idx": 29}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\beta_{\\ell,m}(e):=\\sigma_{c(e)}^{-(\\ell+m)}\\mathbb{E}[\\overline{{A}}_{e}^{\\ell}\\overline{{B}}_{e}^{m}\\mid\\sigma_{*}]\\leq\\left\\{\\begin{array}{l l}{1}&{(\\ell,m)=(2,0),(0,2)}\\\\ {(1+\\Theta(\\frac{\\log n}{n}))\\rho}&{(\\ell,m)=(1,1)}\\\\ {\\frac{1}{\\sqrt{s(p\\wedge q)}}}&{(\\ell,m)=(2,1),(1,2)}\\\\ {\\frac{1}{s(p\\wedge q)}}&{(\\ell,m)=(2,2).}\\end{array}\\right.}\\end{array}\n$$", "text_format": "latex", "page_idx": 29}, {"type": "text", "text": "Proof. Conditioning on a specific true community label vector that satisfies the balanced community event $\\mathcal{H}$ , we can apply Lemma 5 from [43] for each case of $c(e)=+$ and $c(e)=-$ . Then, the upper bound are different in terms of $p,q$ and $\\rho_{+},\\rho_{-}$ . When $(\\ell,m)=(1,1)$ , $\\beta_{\\ell,m}\\leq\\operatorname*{max}\\{|\\rho_{+}|,|\\rho_{-}|\\}\\leq$ $\\textstyle(1+\\Theta({\\frac{\\log n}{n}}))\\rho$ . When $(\\ell,m)\\,=\\,(2,1)$ or $(1,2)$ , if $c(e)\\,=\\,+$ , then we have $\\begin{array}{r l r}{\\beta_{\\ell,m}\\,\\le\\,\\frac{1}{\\sqrt{s p}}}\\end{array}$ , else we have \u03b2\u2113,m \u2264 \u221a1sq. Therefore, \u03b2\u2113,m \u2264 \u221as(1p q). The same argument holds for the case when $(\\ell,m)=(2,2)$ . \u53e3 ", "page_idx": 29}, {"type": "text", "text": "Lemma 14. Let $\\begin{array}{r}{(G_{1},G_{2})\\sim\\mathrm{CSBM}(n,p,q,s),p=\\frac{a\\log n}{n},q=\\frac{b\\log n}{n}}\\end{array}$ . Denote $\\overline{{A}}^{\\widehat{\\pmb{\\sigma}}_{A}},\\overline{{B}}^{\\widehat{\\pmb{\\sigma}}_{B}}$ as the approximately centralized adjacency matrices of $G_{1}$ and $G_{2}$ correspondingly. Let $e:=(u,v)\\in$ $[n]\\times[n]$ be an arbitrary edge. Define the edge type indicator $c(e)=+\\,i f\\cdot$ e is an in-community edge and $c(e)=-\\,i f e$ is a cross-community edge under $\\pmb{\\sigma}_{*}$ . Define $\\Delta:=|s p-s q|$ . The following holds for $0\\leq\\ell,m\\leq2,1\\leq\\ell+m\\leq4,$ , and any $\\pmb{\\sigma}_{*},\\pmb{\\widehat{\\sigma}}=(\\widehat{\\pmb{\\sigma}}_{A},\\widehat{\\pmb{\\sigma}}_{B})$ , ", "page_idx": 29}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\gamma_{\\ell,m}(e):=\\sigma_{c(e)}^{-(\\ell+m)}\\mathbb{E}[\\widehat{A}_{e}^{\\widehat{\\sigma}_{A},\\ell}\\overline{{B}}_{e}^{\\widehat{\\sigma}_{B},m}\\mid\\sigma_{*},\\widehat{\\sigma}]\\leq\\left\\{\\begin{array}{l l}{\\Theta(\\sqrt{\\Delta})}&{(\\ell,m)=(0,1),(1,0)}\\\\ {1+\\Theta(\\frac{\\log n}{n})}&{(\\ell,m)=(2,0),(0,2)}\\\\ {\\rho(1+\\Theta(\\frac{\\log n}{n}))}&{(\\ell,m)=(1,1)}\\\\ {\\overline{{\\sqrt{s(p\\star q)}}}(1+\\Theta(\\frac{\\log n}{n}))}&{(\\ell,m)=(2,1),(1,2)}\\\\ {\\frac{1}{s(p\\star q)}(1+\\Theta(\\frac{\\log n}{n}))}&{(\\ell,m)=(2,2).}\\end{array}\\right.}\\end{array}\n$$", "text_format": "latex", "page_idx": 29}, {"type": "text", "text": "Proof. Denote the two vertices on $e$ as $u$ and $v$ . We denote $p^{\\prime}:=s p$ and $q^{\\prime}:=s q$ . ", "page_idx": 29}, {"type": "text", "text": "(a) $\\ell+m=1$ . Without loss of generality, we consider $\\ell=1$ and $m=0$ . ", "page_idx": 29}, {"type": "equation", "text": "$$\n\\mathbb{E}[\\overline{{A}}_{e}^{\\widehat{\\sigma}_{A},1}\\mid\\sigma_{*},\\widehat{\\sigma}]=\\left\\{0,\\begin{array}{l l}{\\!\\!\\!\\sigma_{*}(u)\\sigma_{*}(v)=\\widehat{\\sigma}_{A}(u)\\widehat{\\sigma}_{A}(v),}\\\\ {\\!\\!\\!\\sigma_{*}(u)\\sigma_{*}(v)\\neq\\widehat{\\sigma}_{A}(u)\\widehat{\\sigma}_{A}(v).}\\end{array}\\right.\n$$", "text_format": "latex", "page_idx": 29}, {"type": "text", "text": "When $\\mathbb{E}[\\overline{{A}}_{e}^{\\widehat{\\pmb{\\sigma}}_{A},1}\\mid\\pmb{\\sigma}_{*},\\widehat{\\pmb{\\sigma}}]$ is non-zero, $\\sigma_{c(e)}^{-1}\\mathbb{E}[\\overline{{A}}_{e}^{\\widehat{\\pmb{\\sigma}}_{A},1}\\mid\\pmb{\\sigma}_{*},\\widehat{\\pmb{\\sigma}}]=\\Theta(\\sqrt{\\Delta}).$ ", "page_idx": 29}, {"type": "text", "text": "(b) $\\ell+m=2$ . We first consider the case of $\\ell=2$ or $m=2$ . ", "page_idx": 29}, {"type": "text", "text": "We explicitly calculate the expectation on the following two cases. If $\\pmb{\\sigma}_{\\ast}(u)\\pmb{\\sigma}_{\\ast}(v)=\\widehat{\\pmb{\\sigma}}(u)\\widehat{\\pmb{\\sigma}}(v)$ , then $\\mathbb{E}[\\overline{{A}}_{e}^{\\widehat{\\pmb{\\sigma}}_{A},2}\\mid\\pmb{\\sigma}_{*},\\widehat{\\pmb{\\sigma}}]=p^{\\prime}(1-p^{\\prime})=\\sigma_{c(e)}^{2}$ . If $\\pmb{\\sigma}_{\\ast}(u)\\pmb{\\sigma}_{\\ast}(v)\\neq\\widehat{\\pmb{\\sigma}}(u)\\widehat{\\pmb{\\sigma}}(v)$ , then $\\mathbb{E}[\\overline{{A}}_{e}^{\\widehat{\\pmb{\\sigma}}_{A},2}\\mid\\pmb{\\sigma}_{*},\\widehat{\\pmb{\\sigma}}]=$ $p^{\\prime}-2p^{\\prime}q^{\\prime}+q^{\\prime2}=\\sigma_{c(e)}^{2}+\\Delta^{2}$ . ", "page_idx": 29}, {"type": "text", "text": "In summary, we have ", "page_idx": 29}, {"type": "equation", "text": "$$\n\\mathbb{E}[\\overline{{A}}_{e}^{\\widehat{\\sigma}_{A},2}\\mid\\sigma_{*},\\widehat{\\sigma}]=\\mathbb{E}[\\overline{{B}}_{e}^{\\widehat{\\sigma}_{B},2}\\mid\\sigma_{*},\\widehat{\\sigma}]\\le\\sigma_{c(e)}^{2}+\\Delta^{2}=\\sigma_{c(e)}^{2}(1+\\Theta(\\frac{\\log n}{n})).\n$$", "text_format": "latex", "page_idx": 29}, {"type": "text", "text": "We next consider the case of $\\ell\\,=\\,m\\,=\\,1$ . If $\\pmb{\\sigma}_{\\ast}(u)\\pmb{\\sigma}_{\\ast}(v)\\,=\\,\\widehat{\\pmb{\\sigma}}(u)\\widehat{\\pmb{\\sigma}}(v)$ , then $\\mathbb{E}[\\overline{{A}}_{e}^{\\widehat{\\pmb{\\sigma}}_{A},1}\\overline{{B}}_{e}^{\\widehat{\\pmb{\\sigma}}_{B},1}\\ \\ \\vert$ $\\pmb{\\sigma}_{*},\\widehat{\\pmb{\\sigma}}]=\\rho_{c(e)}\\sigma_{c(e)}^{2}$ . If $\\pmb{\\sigma}_{\\ast}(u)\\pmb{\\sigma}_{\\ast}(v)\\neq\\widehat{\\pmb{\\sigma}}(u)\\widehat{\\pmb{\\sigma}}(v)$ , then $\\mathbb{E}[\\overline{{A}}_{e}^{\\widehat{\\sigma}_{A},1}\\overline{{B}}_{e}^{\\widehat{\\sigma}_{B},1}\\mid\\sigma_{*},\\widehat{\\pmb{\\sigma}}]=\\rho_{c(e)}\\sigma_{c(e)}^{2}+\\Delta^{2}$ . In summary, we have ", "page_idx": 29}, {"type": "equation", "text": "$$\n\\mathbb{E}[\\overline{{A}}_{e}^{\\widehat{\\sigma}_{A},1}\\overline{{B}}_{e}^{\\widehat{\\sigma}_{B},1}\\mid\\sigma_{*},\\widehat{\\sigma}]\\leq\\rho_{c(e)}\\sigma_{c(e)}^{2}+\\Delta^{2}=\\rho\\sigma_{c(e)}^{2}(1+\\Theta(\\frac{\\log n}{n}))\n$$", "text_format": "latex", "page_idx": 29}, {"type": "text", "text": "(c) $\\ell+m=3\\,$ . With loss of generality, we assume that this edge connects two vertices from different communities. Conditioned on correct centralization, we can compute ", "page_idx": 30}, {"type": "equation", "text": "$$\n\\mathbb{E}[\\overline{{A}}_{e}^{\\widehat{\\sigma}_{A},2}\\overline{{B}}_{e}^{\\widehat{\\sigma}_{B},1}\\mid\\sigma_{*},\\widehat{\\sigma}]=\\mathbb{E}[\\overline{{A}}_{e}^{2}\\overline{{B}}_{e}\\mid\\sigma_{*}]=q s^{2}(1-q)(1-2q s)=\\sigma_{-}^{3}\\frac{\\rho_{-}(1-2q^{\\prime})}{\\sqrt{q^{\\prime}(1-q^{\\prime})}}\\leq\\sigma_{-}^{3}\\frac{1}{\\sqrt{q^{\\prime}}},\n$$", "text_format": "latex", "page_idx": 30}, {"type": "text", "text": "which is the same as in Lemma 13. If the centralization is incorrect for both graphs, the expectation changes to the following: ", "page_idx": 30}, {"type": "equation", "text": "$$\n\\mathbb{E}[\\overline{{A}}_{e}^{\\widehat{\\sigma}_{A},2}\\overline{{B}}_{e}^{\\widehat{\\sigma}_{B},1}\\mid\\sigma_{*},\\widehat{\\sigma}]=q^{\\prime}s-p^{\\prime}q^{\\prime}-2p^{\\prime}q^{\\prime}s+3p^{\\prime2}q^{\\prime}-p^{\\prime3}.\n$$", "text_format": "latex", "page_idx": 30}, {"type": "text", "text": "From observation, we see that the dominant part in both cases are the same, which is $q^{\\prime}s=\\Theta(\\frac{\\log n}{n})$ . Then, we can show that the difference between two quantities are minor: ", "page_idx": 30}, {"type": "equation", "text": "$$\n\\frac{\\mathbb E[\\overline{A}_{e}^{\\mathcal{\\vec{C}}_{A},2}\\overline{B}_{e}^{\\mathcal{\\vec{C}}_{B},1}\\mid\\sigma_{*},\\widehat{\\sigma}]-\\mathbb E[\\overline{A}_{e}^{2}\\overline{B}_{e}\\mid\\sigma_{*}]}{\\sigma_{-}^{3}}=\\frac{(p^{\\prime}-q^{\\prime})(p^{\\prime2}-2p^{\\prime}q^{\\prime}-2q^{\\prime2}+q^{\\prime}+2q^{\\prime}s)}{q^{\\prime}(1-q^{\\prime})\\sqrt{q^{\\prime}(1-q^{\\prime})}}=\\Theta(\\sqrt{q^{\\prime}}).\n$$", "text_format": "latex", "page_idx": 30}, {"type": "text", "text": "The above (20) also holds for the case when $e$ is classified correctly in $A$ or $B$ only. ", "page_idx": 30}, {"type": "text", "text": "By also considering the other case, that is, this edge is connects two vertices from the same community but wrongly centralized according to $\\widehat{\\pmb{\\sigma}}$ , we conclude with ", "page_idx": 30}, {"type": "equation", "text": "$$\n\\mathbb{E}\\big[\\overline{{A}}_{e}^{\\widehat{\\sigma}_{A},2}\\overline{{B}}_{e}^{\\widehat{\\sigma}_{B},1}\\mid\\sigma_{*},\\widehat{\\sigma}\\big]\\leq\\sigma_{c(e)}^{3}\\frac{1}{\\sqrt{s(p\\wedge q)}}(1+\\Theta(s(p\\wedge q)))=\\sigma_{c(e)}^{3}\\frac{1}{\\sqrt{s(p\\wedge q)}}(1+\\Theta(\\frac{\\log n}{n}))\n$$", "text_format": "latex", "page_idx": 30}, {"type": "text", "text": "(d) $\\ell+m=4$ . With loss of generality, we assume that this edge connects two vertices from different communities. For the correct centralization, the moment stays the same as in Lemma 13, ", "page_idx": 30}, {"type": "equation", "text": "$$\n\\frac{^{\\cdot}[\\overline{{A}}_{e}^{2}\\overline{{B}}_{e}^{2}\\mid\\sigma_{*}]=q^{\\prime}s-4q^{\\prime2}s+4q^{\\prime3}s+2q^{\\prime3}-3q^{\\prime4}=q^{\\prime2}(1-q^{\\prime})^{2}+q^{\\prime}(1-q^{\\prime})\\rho_{-}(1-2q^{\\prime})^{2}\\leq\\sigma_{-}^{4}\\frac{1}{q^{\\prime}},\n$$", "text_format": "latex", "page_idx": 30}, {"type": "text", "text": "If the centralization is incorrect for both graphs, we have ", "page_idx": 30}, {"type": "equation", "text": "$$\n\\mathbb{E}[\\overline{{A}}_{e}^{\\widehat{\\sigma}_{A},2}\\overline{{B}}_{e}^{\\widehat{\\sigma}_{B},2}\\mid\\sigma_{*},\\widehat{\\sigma}]=q^{\\prime}s-4p^{\\prime}q^{\\prime}s+4p^{\\prime2}q^{\\prime}s+2p^{\\prime2}q^{\\prime}-4p^{\\prime3}q^{\\prime}+p^{\\prime4},\n$$", "text_format": "latex", "page_idx": 30}, {"type": "text", "text": "and we can show that the error has the following order ", "page_idx": 30}, {"type": "equation", "text": "$$\n\\mathbb{E}[\\overline{{A}}_{e}^{\\widehat{\\sigma}_{A},2}\\overline{{B}}_{e}^{\\widehat{\\sigma}_{B},2}\\mid\\sigma_{*},\\widehat{\\sigma}]-\\mathbb{E}[\\overline{{A}}_{e}^{\\widehat{\\sigma}_{A},2}\\overline{{B}}_{e}^{\\widehat{\\sigma}_{B},2}\\mid\\sigma_{*}]\\leq\\Theta((\\frac{\\log n}{n})^{2})=\\Theta(\\sigma_{c(e)}^{4}).\n$$", "text_format": "latex", "page_idx": 30}, {"type": "text", "text": "When the centralization is incorrect for only one graph, (21) still holds. ", "page_idx": 30}, {"type": "text", "text": "By also considering the other case, that is, this edge is connects two vertices from the same community but wrongly centralized according to $\\widehat{\\pmb{\\sigma}}$ , we conclude with ", "page_idx": 30}, {"type": "equation", "text": "$$\n\\mathbb{E}[\\overline{{A}}_{e}^{\\widehat{\\sigma}_{A},2}\\overline{{B}}_{e}^{\\widehat{\\sigma}_{B},2}\\mid\\sigma_{*},\\widehat{\\sigma}]\\leq\\Theta(\\sigma_{c(e)}^{4})+\\sigma_{c(e)}^{4}\\frac{1}{s(p\\wedge q)}\\leq\\sigma_{c(e)}^{4}\\frac{1}{s(p\\wedge q)}(1+\\Theta(\\frac{\\log n}{n})).\n$$", "text_format": "latex", "page_idx": 30}, {"type": "text", "text": "E Proof of Theorem 3: almost exact graph matching ", "text_level": 1, "page_idx": 30}, {"type": "text", "text": "Fix constants $a\\neq b>0,s\\in[0,1]$ . Throughout the paper, we refer to $s D_{+}(a,b)>1$ as Regime I and $s D_{+}(a,b)<1$ as Regime II. We define $\\mu:=|T|n^{N}\\rho^{N}\\sigma_{\\mathrm{eff}}^{2N}$ , where $\\begin{array}{r}{\\sigma_{\\mathrm{eff}}^{2}=\\frac{\\sigma_{+}^{2}+\\sigma_{-}^{2}}{2}}\\end{array}$ . Depending on the different parameter regimes, the analysis is different. We first present the first and second moment bounds for both regimes and then prove Theorem 3. ", "page_idx": 30}, {"type": "text", "text": "E.1 Regime I: Exact community recovery is possible for a single graph ", "text_level": 1, "page_idx": 30}, {"type": "text", "text": "Proposition 1 (Mean calculation, $s D_{+}(a,b)\\geq1;$ ). Given $\\begin{array}{r}{(G_{1},G_{2})\\sim\\mathrm{CSBM}(n,\\frac{a\\log n}{n},\\frac{b\\log n}{n},s),}\\end{array}$ the similarity score satisfies, ", "page_idx": 30}, {"type": "equation", "text": "$$\n\\mathbb{E}[\\Phi_{i j}\\mathbf{1}_{\\mathcal{H}}]=\\left\\{{(1+o(1))\\mu,\\begin{array}{l l}{i f\\pi_{*}(i)=j,}\\\\ {i f\\pi_{*}(i)\\neq j.}\\end{array}}\\right.\n$$", "text_format": "latex", "page_idx": 30}, {"type": "text", "text": "Proposition 2 (Variance calculation\u2013True pairs, $s D_{+}(a,b)\\,>\\,1)$ . Suppose that $j\\,=\\,\\pi_{*}(i)$ , that $s\\bar{D_{+}}(a,b)>1$ , and that ", "page_idx": 31}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{\\quad}&{\\frac{14L^{2}}{\\rho^{2(K+M)}(|{\\mathcal I}|)}\\leq\\frac{1}{2},\\;\\;\\;\\frac{22R^{4}(2N+1)(11\\beta)^{2(K+M)}}{n}\\leq\\frac{1}{2},}\\\\ &{\\frac{4R^{\\frac{4}{M}}(11\\beta)^{\\frac{4K+4M}{M}}}{n s(p\\wedge q)}\\leq\\frac{1}{2},\\;\\;\\;\\frac{1+2L^{2}}{n s(p\\wedge q)}\\leq\\frac{1}{4}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 31}, {"type": "text", "text": "Then, for any $i\\in[n]$ , we have ", "page_idx": 31}, {"type": "equation", "text": "$$\n\\frac{\\mathrm{Var}[\\Phi_{i j}{\\bf1}_{\\mathcal{H}}]}{\\mathbb{E}[\\Phi_{i\\pi_{*}(i)}{\\bf1}_{\\mathcal{H}}]^{2}}=O\\left(\\frac{L^{2}}{\\rho^{2}n s(p\\wedge q)}+\\frac{L^{2}}{\\rho^{2(K+M)}|\\mathcal{I}|}\\right).\n$$", "text_format": "latex", "page_idx": 31}, {"type": "text", "text": "Proposition 3 (Variance calculation\u2013Fake pairs, $s D_{+}(a,b)\\,>\\,1)$ ). Suppose that $j\\ne\\,\\pi_{*}(i)$ , that $s D_{+}(a,b)>1$ , and that ", "page_idx": 31}, {"type": "equation", "text": "$$\n4^{L+4}L^{2L\\wedge(4K+2)}(11\\beta)^{8(K+M)}R^{4}(2N+1)^{3}\\leq\\frac{n}{2},\\quad\\frac{4R^{\\frac{2}{M}}(11\\beta)^{\\frac{4(K+M)}{M}}}{n s(p\\wedge q)}\\leq\\frac{1}{2}.\n$$", "text_format": "latex", "page_idx": 31}, {"type": "text", "text": "Then, for any $i\\in[n],$ , we have ", "page_idx": 31}, {"type": "equation", "text": "$$\n\\frac{\\mathrm{Var}[\\Phi_{i j}{\\bf1}_{\\mathcal{H}}]}{\\mathbb{E}[\\Phi_{i\\pi_{*}(i)}{\\bf1}_{\\mathcal{H}}]^{2}}=O(\\frac{1}{|{\\mathcal{T}}|\\rho^{2N}}).\n$$", "text_format": "latex", "page_idx": 31}, {"type": "text", "text": "E.2 Regime II: Exact community recovery is impossible for a single graph ", "text_level": 1, "page_idx": 31}, {"type": "text", "text": "Before getting into the details of proof, let us first give more intuition on the approximately centralized adjacency matrix. ", "page_idx": 31}, {"type": "text", "text": "In this regime, for each element in the adjacency matrix, there are four cases: (1) Correct centralization for in-community edges; (2) Incorrect centralization for in-community edges; (3) Correct centralization for cross-community edges; (4) Incorrect centralization for cross-community edges. Figure 7 gives an example of how the graphon for balanced 2-community SBM changes under community label misclassifications. ", "page_idx": 31}, {"type": "image", "img_path": "nBhfIcDnRP/tmp/738158c89601520ce8f45f468a8e366ac9df0901cab0a221f50a69999269d2bd.jpg", "img_caption": [], "img_footnote": [], "page_idx": 31}, {"type": "image", "img_path": "nBhfIcDnRP/tmp/b6668614a8fa4f03d2642a20efd11506adaed8a71f471d2e4f1ed816422ef9d0.jpg", "img_caption": ["(b) Regime II: exact recovery is impossible. "], "img_footnote": [], "page_idx": 31}, {"type": "text", "text": "Figure 7: Illustration on the impact of incorrect community labels on adjacency matrix centralization with $G\\sim\\operatorname{SBM}(n,0.3,0.1)$ . Centralized adjacency matrix $\\overline{{A}}^{\\widehat{\\pmb{\\sigma}}_{A}}=\\dot{A}-\\mathbb{E}[\\dot{A}]$ , where matrix $\\mathbb{E}[A]$ takes the value of discretized graphon as above. ", "page_idx": 31}, {"type": "text", "text": "Proposition 4 (Mean calculation, $s D_{+}(a,b)\\,<\\,1)$ . Let $\\begin{array}{r}{(G_{1},G_{2})\\sim\\mathrm{CSBM}(n,\\frac{a\\log n}{n},\\frac{b\\log n}{n},s).}\\end{array}$ Given -Chandelier class . Assume that . n $(K,L,M,R,D)$ $\\tau$ $D=o\\big(\\frac{\\log n}{\\log\\log n}\\big)$ ", "page_idx": 31}, {"type": "text", "text": "For all $i\\in[n]$ with $j=\\pi_{*}(i)$ , we have ", "page_idx": 31}, {"type": "equation", "text": "$$\n\\mathbb{E}[\\Phi_{i\\pi_{*}(i)}^{\\widehat{\\sigma}}\\mathbf{1}_{\\mathcal{H}}]=(1+o(1))\\mu.\n$$", "text_format": "latex", "page_idx": 31}, {"type": "text", "text": "For all $i\\in[n]$ with $j\\neq\\pi_{*}(i)$ , we have ", "page_idx": 32}, {"type": "equation", "text": "$$\n\\mathbb{E}[\\Phi_{i j}^{\\widehat{\\sigma}}\\mathbf{1}_{\\mathcal{H}}]=o(\\mu).\n$$", "text_format": "latex", "page_idx": 32}, {"type": "text", "text": "Proposition 5 (Variance calculation\u2013True pairs, $s D_{+}(a,b)\\ <\\ 1)$ . Suppose that $j~=~\\pi_{*}(i)$ , $s\\bar{D_{+}}(a,b)<1$ , $L=o(n)$ , and that for some $c>0$ , ", "page_idx": 32}, {"type": "equation", "text": "$$\n\\begin{array}{r l r}&{\\quad\\frac{4R^{\\frac{2}{M}}(15\\beta)^{2\\frac{K+M}{M}}}{n s(p\\wedge q)}\\leq\\frac{1}{2},}&{\\frac{30R^{4}(2N+1)^{2}(15\\beta)^{4(K+M)}}{n}\\leq\\frac{1}{2},}&\\\\ &{\\frac{s D_{+}(a,b)}{D}\\geq\\frac{(\\log\\log n)^{2}}{\\log n},}&{2N L(4L M)^{6L}\\leq\\log^{c}n.}&\\end{array}\n$$", "text_format": "latex", "page_idx": 32}, {"type": "text", "text": "Then, for any $i\\in[n]$ , we have ", "page_idx": 32}, {"type": "equation", "text": "$$\n\\frac{\\mathrm{Var}[\\Phi_{i j}^{\\widehat{\\sigma}}\\mathbf{1}_{\\mathcal{H}}]}{\\mathbb{E}[\\Phi_{i\\pi_{*}(i)}^{\\widehat{\\sigma}}\\mathbf{1}_{\\mathcal{H}}]^{2}}=O\\left(\\frac{L^{2}}{\\rho^{2}n s(p\\wedge q)}+\\frac{L^{2}}{\\rho^{2(K+M)}|\\mathcal{I}|}\\right).\n$$", "text_format": "latex", "page_idx": 32}, {"type": "text", "text": "Proposition 6 (Variance calculation\u2013Fake pairs, $s D_{+}(a,b)\\ <\\ 1)$ . Suppose that $j\\ \\neq\\ \\pi_{*}(i)$ , $s D_{+}(a,b)<1$ , $N=\\Theta(\\log n)$ , $\\begin{array}{r}{D=o\\big(\\frac{\\log n}{\\log\\log n}\\big)}\\end{array}$ , and that ", "page_idx": 32}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\frac{4R^{\\frac{2}{M}}(15\\beta)^{2\\frac{K+M}{M}}}{n s(p\\wedge q)}\\leq\\frac{1}{2},\\quad\\frac{s D_{+}(a,b)}{D}\\geq\\frac{(\\log\\log n)^{2}}{\\log n},}\\\\ &{\\left(\\frac{(15\\beta)^{2(K+M)}30R^{4}(4n+1)^{2}}{n}\\right)(2\\beta)^{8(K+M)}(4L M)^{4L}(4L)!\\leq\\frac{1}{2},}\\end{array}\n$$", "text_format": "latex", "page_idx": 32}, {"type": "text", "text": "Then, for any $i\\in[n],$ , we have ", "page_idx": 32}, {"type": "equation", "text": "$$\n\\frac{\\mathrm{Var}[\\Phi_{i j}^{\\widehat{\\sigma}}\\mathbf{1}_{\\mathcal{H}}]}{\\mathbb{E}[\\Phi_{i\\pi_{*}(i)}^{\\widehat{\\sigma}}\\mathbf{1}_{\\mathcal{H}}]}=O(\\frac{1}{|T|\\rho^{2N}}).\n$$", "text_format": "latex", "page_idx": 32}, {"type": "text", "text": "E.3 Putting things together: proof of Theorem 3 ", "text_level": 1, "page_idx": 32}, {"type": "text", "text": "Proof of Proposition 3. Firstly, with the following conditions, (22) (23) (24) (25) are implied: ", "page_idx": 32}, {"type": "equation", "text": "$$\n\\begin{array}{l l}{{L\\leq\\displaystyle\\frac{c_{1}\\log n}{\\log\\log n}\\wedge c_{6}\\sqrt{n s(p\\wedge q)},}}&{{\\displaystyle\\frac{c_{2}}{\\log(n s(p\\wedge q))}\\leq\\frac{M}{K}\\leq\\frac{\\log\\frac{\\rho^{2}}{\\alpha}}{2\\log\\frac{1}{\\rho^{2}}},}}&{{K L\\geq\\displaystyle\\frac{c_{3}\\log n}{\\log\\frac{\\rho^{2}}{\\alpha}},}}\\\\ {{K+M\\leq c_{4}\\log n,}}&{{R=\\exp(c_{5}K),\\quad D\\leq c_{7}\\displaystyle\\frac{\\log n}{(\\log\\log n)^{2}}.}}\\end{array}\n$$", "text_format": "latex", "page_idx": 32}, {"type": "text", "text": "for some absolute constants $c_{1},c_{2},\\ldots,c_{7}>0$ . ", "page_idx": 32}, {"type": "text", "text": "Furthermore, with growing $n s(p/\\neg q)$ , we have for $j=\\pi_{*}(i)$ , $\\begin{array}{r}{\\frac{\\operatorname{Var}[\\Phi_{i j}\\mathbf{1}_{\\mathcal{H}}]}{\\mathbb{E}[\\Phi_{i\\pi_{*}(i)}\\mathbf{1}_{\\mathcal{H}}]^{2}}=o(1)}\\end{array}$ when $s D_{+}(a,b)>$ 1 and E[\u03a6i\u03c0\u2217(iij)1HH]2 $\\begin{array}{r}{\\frac{\\operatorname{Var}[\\Phi_{i j}\\,\\mathbf{1}_{\\mathcal{H}}]}{\\mathbb{E}[\\Phi_{i\\pi_{*}(i)}\\,\\mathbf{1}_{\\mathcal{H}}]^{2}}\\,=\\,o(1)}\\end{array}$ when $s D_{+}(a,b)\\,<\\,1$ . For any $\\varepsilon\\,>\\,0$ there exists $\\varepsilon^{\\prime}\\;>\\;0$ such that s2 \u2265\u03b1 + \u03b5 \u21d4\u03c12 \u2265\u03b1 + \u03b5\u2032. We have for j \u0338= \u03c0\u2217(i),E[V\u03a6air\u03c0[\u2217\u03a6(iij)11HH]]2 $\\begin{array}{r}{\\frac{\\operatorname{Var}[\\Phi_{i j}\\mathbf{1}_{\\mathcal{H}}]}{\\mathbb{E}[\\Phi_{i\\pi_{*}(i)}\\mathbf{1}_{\\mathcal{H}}]^{2}}=o\\big(\\frac{1}{n^{2}}\\big)}\\end{array}$ when $s D_{+}(a,b)>1$ and $\\begin{array}{r}{\\frac{\\operatorname{Var}[\\Phi_{i j}\\mathbf{1}_{\\mathcal{H}}]}{\\mathbb{E}[\\Phi_{i\\pi_{*}(i)}\\mathbf{1}_{\\mathcal{H}}]^{2}}=o\\big(\\frac{1}{n^{2}}\\big)}\\end{array}$ when $s D_{+}(a,b)<1$ . ", "page_idx": 32}, {"type": "text", "text": "Next, we claim that almost exact recovery is achievable by counting chandeliers. Let $\\tau=c\\mu$ , for arbitrary $c\\in(0,1)$ , where $\\mu=\\mathbb{E}[\\Phi_{i\\pi_{*}(i)}\\mathbf{1}_{\\mathcal{H}}]$ . By Chebyshev\u2019s inequality, the probability that the similarity score of a fake pair $(j\\neq\\pi_{*}(i))$ of vertices exceeding $\\tau$ , is upper bounded as ", "page_idx": 32}, {"type": "equation", "text": "$$\n\\begin{array}{r l r}&{\\mathbb{P}\\big(\\Phi_{i j}\\mathbf{1}_{\\mathcal{H}}\\geq\\tau\\big)\\leq\\mathbb{P}\\big(\\vert\\Phi_{i j}\\mathbf{1}_{\\mathcal{H}}-\\mathbb{E}\\big[\\Phi_{i j}\\mathbf{1}_{\\mathcal{H}}\\big]\\big\\vert\\geq c\\mathbb{E}\\big[\\Phi_{i j}\\mathbf{1}_{\\mathcal{H}}\\big]\\big)\\leq\\frac{\\mathrm{Var}[\\Phi_{i j}\\mathbf{1}_{\\mathcal{H}}]}{c^{2}\\mathbb{E}[\\Phi_{i i}\\mathbf{1}_{\\mathcal{H}}]^{2}}}&\\\\ &{}&{=O\\left(\\frac{1}{|\\mathcal{T}|\\rho^{2N}}\\right)=o(\\frac{1}{n^{2}}).}\\end{array}\n$$", "text_format": "latex", "page_idx": 32}, {"type": "text", "text": "Next, by the definition of $\\mathcal{H}$ , we have ", "page_idx": 32}, {"type": "equation", "text": "$$\n\\mathbb{P}(\\Phi_{i j}\\geq\\tau)\\leq\\mathbb{P}(\\Phi_{i j}\\mathbf{1}_{\\mathcal{H}}\\leq c)+\\mathbb{P}(\\mathcal{H}^{c})=o(\\frac{1}{n^{2}}).\n$$", "text_format": "latex", "page_idx": 32}, {"type": "text", "text": "Applying union bound over all $i\\neq j\\in[n]$ , we have ${\\mathbb P}\\{\\exists i\\neq j,\\Phi_{i j}\\,\\geq\\,\\tau\\}\\,=\\,o(1)$ . Thus, for all possible pairs of vertices $(i,j)\\in[n]\\times[n]$ , $\\Phi_{i j}<\\tau$ with high probability. ", "page_idx": 33}, {"type": "text", "text": "We next study the probability that the similarity score of a true pair of vertices falling below the threshold $\\tau$ . We even consider a larger set containing $F:=\\{i\\in[\\bar{n}]:\\Phi_{i\\pi_{*}(i)}<\\tau\\}$ , ", "page_idx": 33}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{P}\\big(|\\Phi_{i\\pi_{*}(i)}\\mathbf{1}_{\\mathcal{H}}-\\mu|>(1-c)\\mu\\big)\\leq\\displaystyle\\frac{\\mathrm{Var}[\\Phi_{i\\pi_{*}(i)}\\mathbf{1}_{\\mathcal{H}}]}{(1-c)^{2}\\mathbb{E}[\\Phi_{i\\pi_{*}(i)}\\mathbf{1}_{\\mathcal{H}}]^{2}}}\\\\ &{\\qquad\\qquad\\qquad\\qquad\\qquad=O\\left(\\frac{L^{2}}{\\rho^{2}n s(p\\wedge q)}+\\frac{L^{2}}{\\rho^{2(K+M)}|\\mathcal{T}|}\\right)=:\\gamma=o(1).}\\end{array}\n$$", "text_format": "latex", "page_idx": 33}, {"type": "text", "text": "Therefore, $\\mathbb{E}[|F|]\\leq n\\gamma$ . Denote $I\\in[n]$ the vertex set this algorithm matches. For every vertex not in the set $F$ , it is guaranteed to be matched up correctly, so ", "page_idx": 33}, {"type": "equation", "text": "$$\n\\mathbb{E}[|I|]\\geq n-\\mathbb{E}[|F|]=n(1-\\gamma).\n$$", "text_format": "latex", "page_idx": 33}, {"type": "text", "text": "By Markov\u2019s inequality, ", "page_idx": 33}, {"type": "equation", "text": "$$\n\\mathbb{P}(|F|>=\\sqrt{\\gamma}n)\\leq\\frac{\\gamma n}{\\sqrt{\\gamma}n}=\\sqrt{\\gamma}=o(1).\n$$", "text_format": "latex", "page_idx": 33}, {"type": "text", "text": "Therefore, Algorithm 1 matches $|I|\\geq(1-\\sqrt{\\gamma})n$ vertices correctly with high probability. ", "page_idx": 33}, {"type": "text", "text": "In Regime II, with Proposition 4, Proposition 5, and Proposition 6, the same argument follows. These two regimes together complete the proof. ", "page_idx": 33}, {"type": "text", "text": "F Proof of Theorem 4: Efficient algorithm for almost exact graph matching ", "text_level": 1, "page_idx": 33}, {"type": "text", "text": "F.1 Algorithm\u2013Color coding based similarity score estimation ", "text_level": 1, "page_idx": 33}, {"type": "text", "text": "In this section, we re-state and modify the efficient graph matching algorithm for correlated Erd\u02ddos\u2013 R\u00e9nyi graphs discussed in Section 5 of [42], and then analyze it for correlated SBMs. ", "page_idx": 33}, {"type": "text", "text": "Let $\\left(G_{1},G_{2}\\right)$ be a pair of correlated SBMs with adjacency matrices $A$ and $B$ . Let $H$ be a rooted connected graph with $N+1$ vertices. We now want to approximately count the signed subgraphs rooted at $i\\in[n]$ on the centralized adjacency matrices. In general, we do not have access to the centralized adjacency matrices $\\overline{{A}}$ and $\\overline{B}$ , we would use community label estimates ${\\widehat{\\pmb{\\sigma}}}_{A}$ and $\\widehat{\\pmb{\\sigma}}_{B}$ from Algorithm 3 to approximately centralize the adjacency matrices as A\u03c3 A and B\u03c3 B ", "page_idx": 33}, {"type": "text", "text": "First, we generate a random coloring $\\mu:[n]\\to[N+1]$ , which is assigning every node on $\\overline{{A}}$ to one of $N+1$ \u2014the same as the number of vertices on a chandelier\u2014colors independently and uniformly at random. For any vertex set $V\\subset[n]$ , we define $\\chi_{\\mu}(V)=\\mathbf{1}_{\\{\\forall x,y\\in V,x\\neq y:\\mu(x)\\neq\\mu(y)\\}}$ . We call the vertex set $V$ being colorful if $\\chi_{\\mu}(V)=1$ . We denote $\\begin{array}{r}{r:=\\mathbb{P}(\\chi_{\\mu}(V)=1)=\\frac{(N+1)!}{(N+1)^{N+1}}}\\end{array}$ (N+1)N+1 . We define the approximate signed rooted subgraph count as ", "page_idx": 33}, {"type": "equation", "text": "$$\nX_{i,H}\\big(\\overline{{A}}^{\\widehat{\\sigma}_{A}},\\mu\\big):=\\sum_{S(i)\\cong H}\\chi_{\\mu}(V(S))\\Pi_{e\\in E(S)}\\overline{{A}}_{e}^{\\widehat{\\sigma}_{A}}.\n$$", "text_format": "latex", "page_idx": 33}, {"type": "text", "text": "Observe that $\\mathbb{E}[X_{i,H}(\\overline{{A}}^{\\widehat{\\pmb{\\sigma}}_{A}},\\mu)]=r W_{i,H}(\\overline{{A}}^{\\widehat{\\pmb{\\sigma}}_{A}})$ , where $W_{i,H}(\\overline{{\\boldsymbol{A}}}^{\\widehat{\\boldsymbol{\\sigma}}_{A}})$ is the ground truth of signed counts as defined in Section C. In another word, $X_{i,H}(\\overline{{A}}^{\\widehat{\\sigma}_{A}},\\mu)/r$ is an unbiased estimator of $W_{i,H}(\\overline{{A}}^{\\widehat{\\pmb{\\sigma}}_{A}})$ . ", "page_idx": 33}, {"type": "text", "text": "Let $t:=\\lceil1/r\\rceil$ , we repeat the random coloring for $t$ times and then average over the estimates before taking the inner product of two signed counts vectors. Formally, we generate $2t$ independent colorings independently and uniformly at random, denoted as $\\{\\mu_{a}\\}_{a=1}^{t}$ and $\\left\\{\\nu_{b}\\right\\}_{b=1}^{t}$ . For vertex $i$ in $G_{1}$ and vertex $j$ in $G_{2}$ , we define the approximate similarity score as follows ", "page_idx": 33}, {"type": "equation", "text": "$$\n\\widetilde{\\Phi}_{i j}^{\\widehat{\\sigma}}:=\\frac{1}{r^{2}}\\sum_{H\\in\\mathcal{T}}\\mathrm{aut}(H)\\left(\\frac{1}{t}\\sum_{a=1}^{t}X_{i,H}(\\overline{{A}}^{\\widehat{\\sigma}_{A}},\\mu_{a})\\right)\\left(\\frac{1}{t}\\sum_{b=1}^{t}X_{j,H}(\\overline{{B}}^{\\widehat{\\sigma}_{B}},\\nu_{b})\\right).\n$$", "text_format": "latex", "page_idx": 33}, {"type": "text", "text": "We have $\\mathbb{E}[\\widetilde{\\Phi}_{i j}^{\\widehat{\\pmb{\\sigma}}}|\\overline{{\\cal A}}^{\\widehat{\\pmb{\\sigma}}_{A}},\\overline{{\\cal B}}^{\\widehat{\\pmb{\\sigma}}_{B}}]=\\Phi_{i j}^{\\widehat{\\pmb{\\sigma}}}$ and also $\\mathbb{E}[\\widetilde{\\Phi}_{i j}^{\\pmb{\\sigma}}\\mathbf{1}_{\\mathcal{H}}|\\overline{{A}}^{\\widehat{\\pmb{\\sigma}}_{A}},\\overline{{B}}^{\\widehat{\\pmb{\\sigma}}_{B}},\\pmb{\\sigma}_{\\ast}]=\\Phi_{i j}^{\\widehat{\\pmb{\\sigma}}}\\mathbf{1}_{\\mathcal{H}}$ also holds as ${\\bf1}_{\\mathcal{H}}$ is a deterministic function on $\\pmb{\\sigma}_{*}$ . We summarize the algorithm as Algorithm 4. There are two additional steps than Algorithm 2 in [42]: First, in the construction of the chandelier class in this work, we need to fliter out instances with maximum degree greater than a threshold $D$ , which takes $O(K)$ time for each tree; Second, we need to obtain the community label estimates before estimating the signed subgraph counts. ", "page_idx": 34}, {"type": "text", "text": "Algorithm 4 Efficient Almost Exact Graph Matching Algorithm ", "text_level": 1, "page_idx": 34}, {"type": "text", "text": "Input: Adjacency matrices $A$ and $B$ on $n$ vertices for correlated stochastic block models $(G_{1},G_{2})$ . ", "page_idx": 34}, {"type": "text", "text": "Step 1 - Construct the chandelier class ", "text_level": 1, "page_idx": 34}, {"type": "text", "text": "1: (Rooted tree generation [6]) List all non-isomorphic rooted trees with $K$ edges.   \n2: (Automorphism constraint [12]) Compute $\\operatorname{aut}(H)$ for each rooted tree using the automorphism algorithm for trees.   \n3: (Maximum degree constraint) Compute maximum degree of vertices.   \n4: (Chandelier class) Return $\\mathcal{I}$ as the subset of rooted trees whose number of automorphisms is at most $R$ and maximum degree is at most $D$ . Construct $(K,L,M,R,D)$ -Chandelier class $\\tau$ . ", "page_idx": 34}, {"type": "text", "text": "Step 2 - Estimation of similarity score ", "text_level": 1, "page_idx": 34}, {"type": "text", "text": "(Random Coloring) Generate i.i.d. uniformly random colorings $\\{\\mu_{a}\\}_{a=1}^{t}$ and $\\{\\nu_{b}\\}_{b=1}^{t}$ , each maps   \nfrom $[n]$ to $[N+1]$ .   \n(Community recovery) Obtaining ${\\widehat{\\pmb{\\sigma}}}_{A}$ and $\\widehat{\\pmb{\\sigma}}_{B}$ for $A$ and $B$ independently by Algorithm 3.   \nfor all $(i,j)\\in[n]\\times[n]$ do for all $H\\in{\\mathcal{T}}$ do (Signed counts estimation [43]) Compute $\\{X_{i,H}(\\overline{{A}}^{\\widehat{\\sigma}_{A}},\\mu_{a})\\}_{a=1}^{t}$ and $\\{X_{j,H}(\\overline{{B}}^{\\widehat{\\pmb{\\sigma}_{B}}},\\nu_{b})\\}_{b=1}^{t}$ . end for   \nend for ", "page_idx": 34}, {"type": "text", "text": "Output: The approximate similarity scores $\\{\\widetilde{\\Phi}_{i j}\\}_{i,j\\in[n]}$ . ", "page_idx": 34}, {"type": "text", "text": "When we can obtain the correct centralized adjacency matrices $\\overline{{A}}$ and $\\overline{B}$ , we replace $\\overline{{{A}}}^{\\widehat{\\pmb{\\sigma}}_{A}}$ (resp. $\\overline{{B}}^{\\widehat{\\pmb{\\sigma}}_{B}}.$ ) with $\\overline{{A}}$ (resp. $\\overline{{B}}_{.}$ ), and everything defined above is still valid. In that case, we denote the approximate similarity score as\u03a6  rather than\u03a6 \u03c3 . ", "page_idx": 34}, {"type": "text", "text": "F.2 Analysis ", "text_level": 1, "page_idx": 34}, {"type": "text", "text": "The analysis is similar to that in Section 5.1 of [42], while we split the analysis into two regimes. ", "page_idx": 34}, {"type": "text", "text": "Under Regime $[\\,(s D_{+}(a,b)>1)$ , we can recover the community labels on $G_{1}$ and $G_{2}$ exactly correct with high probability. We define $\\Gamma_{i j}$ as an upper bound of $\\mathrm{Var}[\\Phi_{i j}]$ as follows: ", "page_idx": 34}, {"type": "equation", "text": "$$\n\\mathrm{Var}[\\Phi_{i j}\\mathbf{1}_{\\mathcal{H}}]\\leq\\sum_{H,I\\in\\mathcal{T}}\\mathrm{aut}(H)\\mathrm{aut}(I)\\sum_{S_{1}(i),S_{2}(j)\\cong H}\\sum_{T_{1}(i),T_{2}(j)\\cong I}|\\mathbb{E}[\\overline{{A}}_{S_{1}}\\overline{{B}}_{S_{2}}\\overline{{A}}_{T_{1}}\\overline{{B}}_{T_{2}}\\mathbf{1}_{\\mathcal{H}}]|\n$$", "text_format": "latex", "page_idx": 34}, {"type": "equation", "text": "$$\n\\mathbf{1}_{\\left\\{S_{1}\\neq S_{2}\\mathrm{~or~}T_{1}\\neq T_{2}\\mathrm{~or~}V(S_{1})\\cap V(T_{1})\\neq\\{i\\}\\right\\}}\\mathbf{1}_{\\left\\{S_{1}\\triangle T_{1}\\subset S_{2}\\cup T_{2},S_{2}\\triangle T_{2}\\subset S_{1}\\cup T_{1}\\right\\}}=:\\Gamma_{i j}.\n$$", "text_format": "latex", "page_idx": 34}, {"type": "text", "text": "If ${\\bf1}_{\\{S_{1}\\triangle T_{1}\\subset S_{2}\\cup T_{2},S_{2}\\triangle T_{2}\\subset S_{1}\\cup T_{1}\\}}\\:=\\:0$ , then there exists some edge occurring only once among $S_{1}$ , $S_{2}$ , $T_{1}$ , and $T_{2}$ , and so $|\\mathbb{E}[\\overline{{A}}_{S_{1}}\\overline{{B}}_{S_{2}}\\overline{{A}}_{T_{1}}\\overline{{B}}_{T_{2}}{\\bf1}_{\\mathcal{H}}]|~~=~~0$ . Therefore, we only look at the cases where every edge occurs at least two times among these four chandeliers. If ${\\mathbf{1}}_{\\{S_{1}\\neq S_{2}}}$ or $T_{1}\\neq T_{2}$ or $\\underline{{{V}}}(S_{1})\\cap V(T_{1})\\not=\\{i\\}\\}\\:=\\:0$ , then $S_{1}\\,=\\,S_{2}$ , $T_{1}\\,=\\,T_{2}$ , and $S_{1}$ has no common vertex with $T_{1}$ except for the root. In this case, $S_{1}$ and $T_{1}$ , and $S_{2}$ and $T_{2}$ have no common edges, so the covariance between $\\overline{{A}}_{S_{1}}\\overline{{B}}_{T_{1}}$ and $\\overline{{A}}_{S_{2}}\\overline{{B}}_{T_{2}}$ is always zero. ", "page_idx": 34}, {"type": "text", "text": "For Regime II $(s D_{+}(a,b)<1)$ , where we cannot recover the correct centralized adjacency matrices with high probability. Alternatively, we define $\\Gamma_{i j}^{\\prime}$ as: ", "page_idx": 34}, {"type": "equation", "text": "$$\n\\Gamma_{i j}^{\\prime}:=\\sum_{H,I\\in\\mathcal{T}}\\mathrm{aut}(H)\\mathrm{aut}(I)\\sum_{S_{1},S_{2}\\cong H,T_{1},T_{2}\\cong I}\\mathbb{E}[\\overline{{A}}_{S_{1}}^{\\widehat\\sigma_{A}}\\overline{{B}}_{S_{2}}^{\\widehat\\sigma_{B}}\\overline{{A}}_{T_{1}}^{\\widehat\\sigma_{A}}\\overline{{B}}_{T_{2}}^{\\widehat\\sigma_{B}}{\\mathbf{1}}_{\\mathcal{H}}].\n$$", "text_format": "latex", "page_idx": 34}, {"type": "text", "text": "From the definition of variance, ", "page_idx": 34}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\mathrm{Var}[\\Phi_{i j}^{\\widehat{\\sigma}}\\mathbf{1}_{\\mathcal{H}}]\\leq\\Gamma_{i j}^{\\prime}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 34}, {"type": "text", "text": "Lemma 15. Fix constants $a\\neq b>0,s\\in[0,1].$ . Let $\\begin{array}{r}{(G_{1},G_{2})\\sim\\mathrm{CSBM}(n,\\frac{a\\log n}{n},\\frac{b\\log n}{n},s)}\\end{array}$ a log n, b log n, s). The variance of estimation error has the following upper bound: ", "page_idx": 35}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\mathrm{Var}[(\\widetilde{\\Phi}_{i j}-\\Phi_{i j})\\mathbf{1}_{\\mathcal{H}}]\\leq3\\Gamma_{i j},\\qquad\\qquad\\mathrm{Var}[(\\widetilde{\\Phi}_{i j}^{\\widehat{\\sigma}}-\\Phi_{i j}^{\\widehat{\\sigma}})\\mathbf{1}_{\\mathcal{H}}]\\leq3\\Gamma_{i j}^{\\prime},}\\end{array}\n$$", "text_format": "latex", "page_idx": 35}, {"type": "text", "text": "where $\\Gamma_{i j}$ is defined in (28) and $\\Gamma_{i j}^{\\prime}$ is defined in (29). ", "page_idx": 35}, {"type": "text", "text": "Proof. Regime I: Assume that $s D_{+}(a,b)>1$ . Define ", "page_idx": 35}, {"type": "equation", "text": "$$\nY_{i j}(\\mu,\\nu):=\\sum_{H\\in\\mathcal{T}}\\mathrm{aut}(H)X_{i,H}(\\overline{{A}},\\mu)X_{j,H}(\\overline{{B}},\\nu),\n$$", "text_format": "latex", "page_idx": 35}, {"type": "text", "text": "where $\\mu,\\nu$ are two $(N+1)$ -coloring of the vertices in $[n]$ . Then, we can represent the approximate similarity score as ", "page_idx": 35}, {"type": "equation", "text": "$$\n\\widetilde{\\Phi}_{i j}=\\frac{1}{r^{2}t^{2}}\\sum_{c=1}^{t}\\sum_{d=1}^{t}Y_{i j}\\big(\\mu_{c},\\nu_{d}\\big).\n$$", "text_format": "latex", "page_idx": 35}, {"type": "text", "text": "For any $\\mu_{c},\\nu_{d},1\\leq c,d\\leq t,Y_{i j}(\\mu_{c},\\nu_{d})/r^{2}$ is an unbiased estimator of $\\Phi_{i j}$ given ${\\overline{{A}}},{\\overline{{B}}}$ as ", "page_idx": 35}, {"type": "equation", "text": "$$\n\\mathbb{E}[Y_{i j}(\\mu_{c},\\nu_{d})\\mathbf{1}_{\\mathcal{H}}|\\overline{{A}},\\overline{{B}},\\sigma_{*}]=r^{2}\\sum_{H\\in{\\mathcal{T}}}\\operatorname{aut}(H)W_{i,H}(\\overline{{A}})W_{j,H}(\\overline{{B}})\\mathbf{1}_{\\mathcal{H}}=r^{2}\\Phi_{i j}\\mathbf{1}_{\\mathcal{H}}.\n$$", "text_format": "latex", "page_idx": 35}, {"type": "text", "text": "Note that $X_{i,H}(\\overline{{A}},\\mu)$ and $X_{j,H}(\\overline{{B}},\\nu)$ are independent conditioned on ${\\overline{{A}}},{\\overline{{B}}}$ . Moreover, note that $\\{Y_{i j}(\\mu_{c},\\nu_{d})\\}_{1\\leq c,d\\leq t}$ are identically distributed. Hence, we have ", "page_idx": 35}, {"type": "equation", "text": "$$\n\\mathbb{E}[\\widetilde{\\Phi}_{i j}\\mathbf{1}_{\\mathcal{H}}]=\\mathbb{E}[\\mathbb{E}_{\\mu,\\nu}[\\frac{1}{r^{2}t^{2}}\\sum_{c=1}^{t}\\sum_{d=1}^{t}Y_{i j}(\\mu_{c},\\nu_{d})\\mathbf{1}_{\\mathcal{H}}|\\overline{{A}},\\overline{{B}},\\sigma_{\\ast}]]=\\mathbb{E}[\\Phi_{i j}\\mathbf{1}_{\\mathcal{H}}].\n$$", "text_format": "latex", "page_idx": 35}, {"type": "text", "text": "Next, we bound the variance of $\\widetilde{\\Phi}_{i j}$ . In particular, we can get ", "page_idx": 35}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathrm{Var}[(\\widetilde{\\Phi}_{i j}-\\Phi_{i j}){\\bf1}_{\\mathcal{H}}]=\\mathrm{Var}(\\mathbb{E}[(\\widetilde{\\Phi}_{i j}-\\Phi_{i j}){\\bf1}_{\\mathcal{H}}|\\overline{{A}},\\overline{{B}},\\sigma_{*}])+\\mathbb{E}[\\mathrm{Var}((\\widetilde{\\Phi}_{i j}-\\Phi_{i j}){\\bf1}_{\\mathcal{H}}|\\overline{{A}},\\overline{{B}},\\sigma_{*})]}\\\\ &{\\quad\\quad\\quad\\quad\\quad\\quad=\\mathbb{E}[\\mathrm{Var}(\\widetilde{\\Phi}_{i j}|\\overline{{A}},\\overline{{B}},\\sigma_{*}){\\bf1}_{\\mathcal{H}}],}\\end{array}\n$$", "text_format": "latex", "page_idx": 35}, {"type": "text", "text": "because $\\Phi_{i j}$ and ${\\bf1}_{\\mathcal{H}}$ are fixed conditional on $\\overline{{A}},\\overline{{B}},\\pmb{\\sigma}_{\\ast}$ . Furthermore, conditioned on $\\overline{{A}}$ and $\\overline{B}$ , for any $1\\leq c,\\bar{d},e,f\\leq t,Y_{i j}(\\mu_{c},\\nu_{d})$ are independent with $Y_{i j}(\\mu_{e},\\nu_{f})$ if and only if $c\\neq e$ and $d\\neq f$ . ", "page_idx": 35}, {"type": "equation", "text": "$$\n\\mathrm{Var}[(\\widetilde{\\Phi}_{i j}-\\Phi_{i j}){\\bf1}_{\\mathcal{H}}]\\leq\\frac{1}{r^{4}t^{4}}\\sum_{c=1}^{t}\\sum_{d=1}^{t}\\sum_{e=1}^{t}\\sum_{f=1}^{t}\\mathbb{E}[\\mathrm{Cov}(Y_{i j}(\\mu_{c},\\nu_{d}),Y_{i j}(\\mu_{e},\\nu_{f}))|\\overline{{A}},\\overline{{B}},\\sigma_{\\ast}){\\bf1}_{\\mathcal{H}}].\n$$", "text_format": "latex", "page_idx": 35}, {"type": "text", "text": "Applying Lemma 16, we have ", "page_idx": 35}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathrm{Var}[(\\widetilde{\\Phi}_{i j}-\\Phi_{i j}){\\bf1}_{\\mathcal{H}}]\\le\\frac{1}{r^{4}t^{4}}\\displaystyle\\sum_{c=1}^{t}\\sum_{d=1}^{t}\\sum_{e=1}^{t}\\sum_{f=1}^{t}(r^{2+1}\\{c\\neq e\\}^{+1}\\{d\\neq f\\}-r^{4})\\Gamma_{i j}}\\\\ &{\\qquad\\qquad\\qquad\\qquad=\\displaystyle\\frac{1}{r^{2}t^{2}}\\left(t^{2}r^{2}+2t^{3}r^{3}-(t^{2}+2t^{3})r^{4}\\right)\\Gamma_{i j}}\\\\ &{\\qquad\\qquad\\qquad\\qquad\\leq3\\Gamma_{i j},}\\end{array}\n$$", "text_format": "latex", "page_idx": 35}, {"type": "text", "text": "where the last inequality holds because $t=\\lceil1/r\\rceil,t r\\geq1$ . ", "page_idx": 35}, {"type": "text", "text": "Regime II: Assume that $s D_{+}(a,b)<1$ . With community label estimates ${\\widehat{\\pmb{\\sigma}}}_{A}$ and $\\widehat{\\pmb{\\sigma}}_{B}$ , we define ", "page_idx": 35}, {"type": "equation", "text": "$$\nY_{i j}^{\\widehat{\\sigma}}(\\mu,\\nu):=\\sum_{H\\in{\\mathcal{T}}}\\operatorname{aut}(H)X_{i,H}(\\overline{{A}}^{\\widehat{\\sigma}_{A}},\\mu)X_{j,H}(\\overline{{B}}^{\\widehat{\\sigma}_{B}},\\nu),\n$$", "text_format": "latex", "page_idx": 35}, {"type": "text", "text": "where $\\mu,\\nu$ are two $(N+1)\\cdot$ \u2013coloring of the vertices in $[n]$ . The proof for Regime I still holds in this case by replacing $\\overline{{A}},\\overline{{B}},Y_{i j},\\Phi_{i j},\\widetilde{\\Phi}_{i j}$ and $\\Gamma_{i j}$ with $\\overline{{A}}^{\\widehat{\\pmb{\\sigma}}_{A}},\\overline{{B}}^{\\widehat{\\pmb{\\sigma}}_{B}},Y_{i j}^{\\widehat{\\pmb{\\sigma}}},\\Phi_{i j}^{\\widehat{\\pmb{\\sigma}}},\\widetilde{\\Phi}_{i j}^{\\widehat{\\pmb{\\sigma}}}$ and $\\Gamma_{i j}^{\\prime}$ correspondingly. ", "page_idx": 35}, {"type": "text", "text": "Lemma 16 (Extension of Lemma 12 in [42] to correlated SBMs). Fix constants $a\\neq b>0,s\\in$ $[0,1]$ $(G_{1},G_{2})\\sim\\mathrm{CSBM}(n,a\\frac{\\log n}{n},b\\frac{\\log n}{n},s)$ . Fix any $1\\leq c,d,e,f\\leq t$ , and $i,j\\,\\in\\,[n]$ . If $s D_{+}(a,b)>1$ , then ", "page_idx": 36}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\mathbb{E}[\\mathrm{Cov}(Y_{i j}(\\mu_{c},\\nu_{d}),Y_{i j}(\\mu_{e},\\nu_{f})|\\overline{{A}},\\overline{{B}},\\sigma_{\\ast})\\mathbf{1}_{\\mathcal{H}}]\\leq(r^{2+\\mathbf{1}}\\{{a\\neq f}\\}^{+\\mathbf{1}}\\{{c\\neq e}\\}-r^{4})\\Gamma_{i j}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 36}, {"type": "text", "text": "If $\\dot{\\bf\\Phi}_{s D_{+}(a,b)}<1$ , then ", "page_idx": 36}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\mathbb{E}[\\mathrm{Cov}(Y_{i j}(\\mu_{c},\\nu_{d}),Y_{i j}(\\mu_{e},\\nu_{f})|\\overline{{A}}^{\\widehat{\\sigma}_{A}},\\overline{{B}}^{\\widehat{\\sigma}_{B}},\\sigma_{*})\\mathbf{1}_{\\mathcal{H}}]\\leq(r^{2+\\mathbf{1}_{\\{d\\neq f\\}}+\\mathbf{1}_{\\{c\\neq e\\}}}-r^{4})\\Gamma_{i j}^{\\prime}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 36}, {"type": "text", "text": "Proof. We first prove (33) and then explain why it implies (32). ", "page_idx": 36}, {"type": "text", "text": "For two independent $(N+1)$ \u2013colorings $\\mu$ and $\\nu$ of the vertices in $[n]$ . From the definition of $Y_{i j}^{\\widehat{\\pmb{\\sigma}}}(\\mu,\\nu)$ (31), $\\mathbb{E}[Y_{i j}^{\\widehat{\\pmb{\\sigma}}}(\\mu,\\nu)|\\overline{{\\cal A}}^{\\widehat{\\pmb{\\sigma}}_{A}},\\overline{{\\cal B}}^{\\widehat{\\pmb{\\sigma}}_{B}},\\pmb{\\sigma}_{\\ast}]=r^{2}\\Phi_{i j}^{\\widehat{\\pmb{\\sigma}}}$ . Then, ", "page_idx": 36}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathrm{Cov}(Y_{i j}^{\\widehat{\\sigma}}(\\mu_{c},\\nu_{d}),Y_{i j}^{\\widehat{\\sigma}}(\\mu_{e},\\nu_{f})|\\overline{{A}}^{\\widehat{\\sigma}_{A}},\\overline{{B}}^{\\widehat{\\sigma}_{B}},\\sigma_{*})}\\\\ &{\\qquad\\qquad\\qquad=\\mathbb{E}[Y_{i j}^{\\widehat{\\sigma}}(\\mu_{c},\\nu_{d})Y_{i j}^{\\widehat{\\sigma}}(\\mu_{e},\\nu_{f})|\\overline{{A}}^{\\widehat{\\sigma}_{A}},\\overline{{B}}^{\\widehat{\\sigma}_{B}},\\sigma_{*}]-r^{4}(\\Phi_{i j}^{\\widehat{\\sigma}})^{2}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 36}, {"type": "text", "text": "From the definition of $Y_{i j}^{\\widehat{\\pmb{\\sigma}}}(\\mu,\\nu)$ in (31) again, ", "page_idx": 36}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{E}[Y_{i j}(\\mu_{c},\\nu_{d})Y_{i j}(\\mu_{e},\\nu_{f})|\\overline{{A}}^{\\widehat{\\sigma}_{A}},\\overline{{B}}^{\\widehat{\\sigma}_{B}},\\sigma_{*}]}\\\\ &{\\qquad\\qquad\\qquad\\qquad\\qquad=\\mathbb{E}[\\displaystyle\\sum_{H\\in{\\mathcal T}}\\mathrm{aut}(H)X_{i,H}(\\overline{{A}}^{\\widehat{\\sigma}_{A}},\\mu_{c})X_{j,H}(\\overline{{B}}^{\\widehat{\\sigma}},\\nu_{d})}\\\\ &{\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\times\\displaystyle\\sum_{I\\in{\\mathcal T}}\\mathrm{aut}(H)X_{i,I}(\\overline{{A}}^{\\widehat{\\sigma}_{A}},\\mu_{e})X_{j,I}(\\overline{{B}}^{\\widehat{\\sigma}_{B}},\\nu_{f})|\\overline{{A}}^{\\widehat{\\sigma}_{A}},\\overline{{B}}^{\\widehat{\\sigma}_{B}},\\sigma_{*}].}\\end{array}\n$$", "text_format": "latex", "page_idx": 36}, {"type": "text", "text": "From (27) and the independence of colorings, ", "page_idx": 36}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{E}[Y_{i j}(\\mu_{c},\\nu_{d})Y_{i j}(\\mu_{e},\\nu_{f j})|\\widehat{A}^{\\widehat{\\sigma}_{A}},\\widehat{B}^{\\widehat{\\sigma}_{B}},\\sigma_{*}]}\\\\ &{\\quad\\quad\\quad\\quad\\quad=\\mathbb{E}\\Bigg[\\underset{H,I\\in\\mathcal{T}}{\\sum}\\mathrm{aut}(H)\\mathrm{aut}(I)\\underset{S_{1}(i),S_{2}(j)\\cong H}{\\sum}\\underset{T_{1}(i),T_{2}(j)\\cong I}{\\sum}\\chi_{\\mu_{c}}(V(S_{1}))\\overline{{A}}_{S_{1}}^{\\widehat{\\sigma}_{A}}}\\\\ &{\\quad\\quad\\quad\\quad\\quad\\times\\chi_{\\nu_{d}}(V(S_{2}))\\overline{{B}}_{S_{2}}^{\\widehat{\\sigma}_{B}}\\times\\chi_{\\mu_{c}}(V(T_{1}))\\overline{{A}}_{T_{1}}^{\\widehat{\\sigma}_{A}}\\times\\chi_{\\nu_{f}}(V(T_{2}))\\overline{{B}}_{T_{2}}^{\\widehat{\\sigma}_{B}}\\left|\\widehat{A}^{\\widehat{\\sigma}_{A}},\\overline{{B}}^{\\widehat{\\sigma}_{B}},\\sigma_{*}\\right|}\\\\ &{\\quad\\quad\\quad\\quad=\\underset{H,I\\in\\mathcal{T}}{\\sum}\\mathrm{aut}(H)\\mathrm{aut}(I)\\underset{S_{1}(i),S_{2}(j)\\cong H}{\\sum}\\underset{T_{1}(i),T_{2}(j)\\cong I}{\\sum}\\mathbb{E}[\\chi_{\\mu_{c}}(V(S_{1}))\\chi_{\\mu_{c}}(V(T_{1}))]}\\\\ &{\\quad\\quad\\quad\\quad\\times\\mathbb{E}[\\chi_{\\nu_{d}}(V(S_{2}))\\chi_{\\nu_{f}}(V(T_{2}))|\\overline{{A}}_{S_{1}}^{\\widehat{\\sigma}_{A}}\\overline{{B}}_{S_{2}}^{\\widehat{\\sigma}_{B}}\\overline{{A}}_{T_{1}}^{\\widehat{\\sigma}_{B}}\\qquad\\qquad\\qquad\\quad(\\mathrm{c.}}\\end{array}\n$$", "text_format": "latex", "page_idx": 36}, {"type": "text", "text": "From (34), (35), and (10), ", "page_idx": 36}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{E}[\\mathrm{Cov}(Y_{i j}(\\mu_{c},\\nu_{d}),Y_{i j}(\\mu_{e},\\nu_{f})|\\overline{{A}}^{\\widehat{\\sigma}_{A}},\\overline{{B}}^{\\widehat{\\sigma}_{B}},\\sigma_{\\ast}){\\mathbf1}_{\\mathcal{H}}]}\\\\ &{\\qquad\\qquad\\qquad=\\displaystyle\\sum_{H,I\\in\\mathcal{T}}\\mathrm{aut}(H)\\mathrm{aut}(I)\\sum_{S_{1}(i),S_{2}(j)\\cong H\\,T_{1}(i),T_{2}(j)\\cong I}\\mathbb{E}[\\overline{{A}}_{S_{1}}^{\\widehat{\\sigma}_{A}}\\overline{{B}}_{S_{2}}^{\\widehat{\\sigma}_{B}}\\overline{{A}}_{T_{1}}^{\\widehat{\\sigma}_{A}}\\overline{{B}}_{T_{2}}^{\\widehat{\\sigma}_{B}}{\\mathbf1}_{\\mathcal{H}}]}\\\\ &{\\qquad\\qquad\\qquad\\qquad\\times\\,\\bigg(\\mathbb{E}[\\chi_{\\mu_{c}}(V(S_{1}))\\chi_{\\mu_{c}}(V(T_{1}))]\\mathbb{E}[\\chi_{\\nu_{d}}(V(S_{2}))\\chi_{\\nu_{f}}(V(T_{2}))]-r^{4}\\bigg).}\\end{array}\n$$", "text_format": "latex", "page_idx": 36}, {"type": "text", "text": "Observe that $\\begin{array}{r l r}{\\mathbb{E}[\\chi_{\\mu_{c}}(V(S_{1}))\\chi_{\\mu_{e}}(V(T_{1}))]}&{\\leq}&{r^{1+1}\\{\\circ\\neq\\epsilon\\}\\;\\;\\mathrm{~and~}\\;\\mathbb{E}[\\chi_{\\nu_{d}}(V(S_{2}))\\chi_{\\nu_{f}}(V(T_{2}))]\\;\\;\\leq\\;}\\end{array}$ r1+1{d\u0338=f}, ", "page_idx": 36}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{E}[\\mathrm{Cov}(Y_{i j}(\\mu_{c},\\nu_{d}),Y_{i j}(\\mu_{e},\\nu_{f})|\\overline{{A}}^{\\widehat{\\sigma}_{A}},\\overline{{B}}^{\\widehat{\\sigma}_{B}},\\sigma_{*})\\mathbf{1}_{\\mathcal{H}}]}\\\\ &{\\leq\\displaystyle\\sum_{H,I\\in\\mathcal{T}}\\operatorname{aut}(H)\\operatorname{aut}(I)\\sum_{S_{1}(i),S_{2}(j)\\cong H}\\sum_{T_{1}(i),T_{2}(j)\\cong I}\\mathbb{E}[\\overline{{A}}_{S_{1}}^{\\widehat{\\sigma}_{A}}\\overline{{B}}_{S_{2}}^{\\widehat{\\sigma}_{B}}\\overline{{A}}_{T_{1}}^{\\widehat{\\sigma}_{A}}\\overline{{B}}_{T_{2}}^{\\widehat{\\sigma}_{B}}\\mathbf{1}_{\\mathcal{H}}](r^{2+1}\\{a\\neq j\\}^{+1}\\{c\\neq c\\}-r^{4})}\\\\ &{=\\Gamma_{i j}^{\\prime}(r^{2+1}\\{a\\neq f\\}^{+1}\\{\\ c\\neq c\\}-r^{4}),}\\end{array}\n$$", "text_format": "latex", "page_idx": 36}, {"type": "text", "text": "and this completes the proof for Regime II. ", "page_idx": 37}, {"type": "text", "text": "In Regime I, $\\mathbb{E}[\\overline{{A}}_{S_{1}}\\overline{{B}}_{S_{2}}\\overline{{A}}_{T_{1}}\\overline{{B}}_{T_{2}}\\mathbf{1}_{\\mathcal{H}}]\\neq0$ only if $\\{S_{1}\\triangle T_{1}\\subset S_{2}\\cup T_{2},S_{2}\\triangle T_{2}\\subset S_{1}\\cup T_{1}\\}$ happens. In addition, if $S_{1}=S_{2}$ , $T_{1}=T_{2}$ , and $V(S_{1})\\cap V(T_{1})=\\{i\\}$ , then $\\mathbb{E}[\\chi_{\\mu_{c}}(V(S_{1}))\\chi_{\\mu_{e}}(V(T_{1}))]=$ $\\mathbb{E}[\\chi_{\\nu_{d}}(V(S_{2}))\\chi_{\\nu_{f}}(V(T_{2}))]=r^{2}$ , because $S_{1}$ (resp. $S_{2}$ ) shares no common edges with $T_{1}$ (resp. $T_{2}$ ) Therefore, ", "page_idx": 37}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{~\\mathbb{E}[\\mathrm{Cov}(Y_{i j}(\\mu_{c},\\nu_{d}),Y_{i j}(\\mu_{e},\\nu_{f})|\\overline{{A}},\\overline{{B}},\\sigma_{*})\\mathbf{1}_{\\mathcal{H}}]}\\\\ &{\\le\\displaystyle\\sum_{H,I\\in\\mathcal{T}}\\mathrm{aut}(H)\\mathrm{aut}(I)\\sum_{S_{1}(i),S_{2}(j)\\cong H}\\sum_{T_{1}(i),T_{2}(j)\\cong I}\\mathbb{E}[\\overline{{A}}_{S_{1}}\\overline{{B}}_{S_{2}}\\overline{{A}}_{T_{1}}\\overline{{B}}_{T_{2}}\\mathbf{1}_{\\mathcal{H}}](r^{2+1}\\{d\\neq f\\}^{+1}\\{c\\neq c\\}-r^{4})}\\\\ &{=\\displaystyle\\sum_{H,I\\in\\mathcal{T}}\\mathrm{aut}(H)\\mathrm{aut}(I)\\sum_{S_{1}(i),S_{2}(j)\\cong H}\\sum_{T_{1}(i),T_{2}(j)\\cong I}\\mathbb{E}[\\overline{{A}}_{S_{1}}\\overline{{B}}_{S_{2}}\\overline{{A}}_{T_{1}}\\overline{{B}}_{T_{2}}\\mathbf{1}_{\\mathcal{H}}](r^{2+1}\\{d\\neq f\\}^{+1}\\{c\\neq c\\}-r^{4})}\\\\ &{~~\\times\\mathbf{1}\\{S_{1\\neq\\mathcal{S}_{2}\\circ T_{1}\\neq T_{2}\\mathrm{~or}}(S_{1})\\cap V({\\mathbf{1}})\\}\\mathbb{E}\\{s_{1}\\Delta T_{1}\\subset S_{1}\\varsigma T_{2},S_{2}\\triangle T_{2}\\subset S_{1}\\cup T_{1}\\}}\\\\ &{=\\Gamma_{i j}(r^{2+1}\\{d\\neq f\\}^{+1}\\{c\\neq c\\}-r^{4}),}\\end{array}\n$$", "text_format": "latex", "page_idx": 37}, {"type": "text", "text": "where the first line follows from the proof in Regime $\\mathrm{II}$ and the last line applies the definition of $\\Gamma_{i j}$ (28). \u53e3 ", "page_idx": 37}, {"type": "text", "text": "Now, we are ready to prove Theorem 4. ", "page_idx": 37}, {"type": "text", "text": "Proof of Theorem 4: For the first part of this proof, our goal is to show that the estimated score preserves the asymptotic upper bound onE[V\u03a6air\u03c0[\u2217\u03a6(iij)11HH]]2 for Regime I and $\\frac{\\mathrm{Var}[\\Phi_{i j}^{\\widehat{\\sigma}}\\mathbf{1}_{\\mathcal{H}}]}{\\mathbb{E}[\\Phi_{i\\pi_{*}(i)}^{\\widehat{\\sigma}}\\mathbf{1}_{\\mathcal{H}}]^{2}}$ for Regime II. For Regime $\\;(s D_{+}(a,b)>1)$ , we have ", "page_idx": 37}, {"type": "equation", "text": "$$\n\\begin{array}{r l r}{\\lefteqn{\\frac{\\mathrm{Var}[\\widetilde{\\Phi}_{i j}\\mathbf{1}_{\\mathcal{H}}]}{\\mathbb{E}\\big[\\widetilde{\\Phi}_{i\\pi_{*}(i)}\\mathbf{1}_{\\mathcal{H}}\\big]^{2}}=\\frac{\\mathrm{Var}[\\widetilde{\\Phi}_{i j}\\mathbf{1}_{\\mathcal{H}}]}{\\mathbb{E}\\big[\\Phi_{i\\pi_{*}(i)}\\mathbf{1}_{\\mathcal{H}}\\big]^{2}}}}\\\\ &{}&{=\\frac{1}{\\mathbb{E}\\big[\\Phi_{i\\pi_{*}(i)}\\mathbf{1}_{\\mathcal{H}}\\big]^{2}}\\left[\\mathrm{Var}[\\Phi_{i j}\\mathbf{1}_{\\mathcal{H}}]+\\mathrm{Var}[(\\widetilde{\\Phi}_{i j}-\\Phi_{i j})\\mathbf{1}_{\\mathcal{H}}]+2\\,\\mathrm{Cov}\\big((\\widetilde{\\Phi}_{i j}-\\Phi_{i j})\\mathbf{1}_{\\mathcal{H}},\\Phi_{i j}\\mathbf{1}_{\\mathcal{H}}\\big)\\right],}\\end{array}\n$$", "text_format": "latex", "page_idx": 37}, {"type": "text", "text": "where the first equality is from the fact that $\\widetilde{\\Phi}_{i j}\\mathbf{1}_{\\mathcal{H}}$ is an unbiased estimator of $\\Phi_{i j}\\mathbf{1}_{\\mathcal{H}}$ conditioned on ${\\overline{{A}}},{\\overline{{B}}}$ , and $\\pmb{\\sigma}_{*}$ . Further, ", "page_idx": 37}, {"type": "equation", "text": "$$\n\\frac{\\mathrm{Var}[\\widetilde{\\Phi}_{i j}{\\bf1}_{\\mathcal{H}}]}{\\mathbb{E}[\\widetilde{\\Phi}_{i\\pi_{*}(i)}{\\bf1}_{\\mathcal{H}}]^{2}}\\le\\frac{1}{\\mathbb{E}[\\Phi_{i\\pi_{*}(i)}{\\bf1}_{\\mathcal{H}}]^{2}}\\left[\\Gamma_{i j}+3\\Gamma_{i j}+2\\mathbb{E}[(\\widetilde{\\Phi}_{i j}-\\Phi_{i j})\\Phi_{i j}{\\bf1}_{\\mathcal{H}}]\\right]\\le4\\frac{\\Gamma_{i j}}{\\mathbb{E}[\\Phi_{i\\pi_{*}(i)}{\\bf1}_{\\mathcal{H}}]^{2}},\n$$", "text_format": "latex", "page_idx": 37}, {"type": "text", "text": "where the first inequality holds from (28), Lemma 15, and $\\mathbb{E}[(\\widetilde{\\Phi}_{i j}-\\Phi_{i j})\\mathbf{1}_{\\mathcal{H}}]=0$ , and the second inequality holds because $\\begin{array}{r}{\\mathbb{E}[((\\widetilde{\\Phi}_{i j}-\\Phi_{i j})\\Phi_{i j}\\mathbf{1}_{\\mathcal{H}})]=\\mathbb{E}[\\mathbb{E}[(\\widetilde{\\Phi}_{i j}-\\Phi_{i j})|\\overline{{A}},\\overline{{B}},\\sigma_{*}]\\Phi_{i j}\\mathbf{1}_{\\mathcal{H}}]=0.}\\end{array}$ . ", "page_idx": 37}, {"type": "text", "text": "The proof of Proposition 2 and Proposition 3 are based on analyzing $\\Gamma_{i j}$ and thus the upper bounds onE[\u03a6i\u03c0\u2217(i)1H]2 all hold for $\\frac{\\Gamma_{i j}}{\\mathbb{E}[\\Phi_{i\\pi*(i)}\\mathbf{1}_{\\mathcal{H}}]^{2}}$ . Therefore, we conclude that for all $i\\in[n]$ , if (22) holds, then ", "page_idx": 37}, {"type": "equation", "text": "$$\n\\frac{\\mathrm{Var}[\\widetilde{\\Phi}_{i\\pi_{*}(i)}{\\bf1}_{\\mathcal{H}}]}{\\mathbb{E}[\\widetilde{\\Phi}_{i\\pi_{*}(i)}{\\bf1}_{\\mathcal{H}}]^{2}}=O\\left(\\frac{L^{2}}{\\rho^{2}n s(p\\wedge q)}+\\frac{L^{2}}{\\rho^{2(K+M)}|\\mathcal{I}|}\\right);\n$$", "text_format": "latex", "page_idx": 37}, {"type": "text", "text": "and that for all $i,j\\in[n],j\\neq\\pi_{*}(i)$ , if (23) holds, then ", "page_idx": 37}, {"type": "equation", "text": "$$\n\\frac{\\mathrm{Var}[\\widetilde{\\Phi}_{i j}{\\bf1}_{\\mathcal{H}}]}{\\mathbb{E}[\\widetilde{\\Phi}_{i\\pi_{*}(i)}{\\bf1}_{\\mathcal{H}}]^{2}}=O\\left(\\frac{1}{|{\\mathcal{T}}|\\rho^{2N}}\\right).\n$$", "text_format": "latex", "page_idx": 37}, {"type": "text", "text": "For Regime II $(s D_{+}(a,b)<1)$ , from (29) and Lemma 15, ", "page_idx": 37}, {"type": "equation", "text": "$$\n\\frac{\\mathrm{Var}[\\widetilde{\\Phi}_{i j}^{\\hat{\\sigma}}\\mathbf{1}_{\\mathcal{H}}]}{\\mathbb{E}[\\widetilde{\\Phi}_{i j}^{\\hat{\\sigma}}\\mathbf{1}_{\\mathcal{H}}]^{2}}\\le\\frac{1}{\\mathbb{E}[\\Phi_{i\\pi_{*}(i)}^{\\hat{\\sigma}}\\mathbf{1}_{\\mathcal{H}}]^{2}}\\left[\\Gamma_{i j}^{\\prime}+3\\Gamma_{i j}^{\\prime}+2\\mathbb{E}[(\\widetilde{\\Phi}_{i j}^{\\hat{\\sigma}}-\\Phi_{i j}^{\\hat{\\sigma}})\\Phi_{i j}^{\\hat{\\sigma}}\\mathbf{1}_{\\mathcal{H}}])\\right]\\le4\\frac{\\Gamma_{i j}^{\\prime}}{\\mathbb{E}[\\Phi_{i\\pi_{*}(i)}^{\\hat{\\sigma}}\\mathbf{1}_{\\mathcal{H}}]^{2}},\n$$", "text_format": "latex", "page_idx": 37}, {"type": "text", "text": "The proof of Proposition 5 and Proposition 6 are based on analyzing $\\Gamma_{i j}^{\\prime}$ and thus the upper bounds on $\\frac{\\mathrm{Var}[\\Phi_{i j}^{\\widehat{\\sigma}}\\mathbf{1}_{\\mathcal{H}}]}{\\mathbb{E}[\\Phi_{i\\pi_{*}(i)}^{\\widehat{\\sigma}}\\mathbf{1}_{\\mathcal{H}}]^{2}}$ all hold for $\\frac{\\Gamma_{i j}^{\\prime}}{\\mathbb{E}[\\Phi_{i\\pi_{*}(i)}^{\\widehat{\\sigma}}\\mathbf{1}_{\\mathcal{H}}]^{2}}$ . Therefore, we conclude that for all $i\\in[n]$ , if (24) holds, then ", "page_idx": 38}, {"type": "equation", "text": "$$\n\\frac{\\mathrm{Var}[\\widetilde{\\Phi}_{i\\pi_{*}(i)}^{\\widehat{\\sigma}}\\mathbf{1}\\varkappa]}{\\mathbb{E}[\\widetilde{\\Phi}_{i\\pi_{*}(i)}^{\\widehat{\\sigma}}\\mathbf{1}\\varkappa]^{2}}=O\\left(\\frac{L^{2}}{\\rho^{2}n s(p\\wedge q)}+\\frac{L^{2}}{\\rho^{2(K+M)}|\\mathcal{I}|}\\right);\n$$", "text_format": "latex", "page_idx": 38}, {"type": "text", "text": "and that for all $i,j\\in[n],j\\neq\\pi_{*}(i)$ , if (25) holds, then ", "page_idx": 38}, {"type": "equation", "text": "$$\n\\frac{\\mathrm{Var}[\\widetilde{\\Phi}_{i j}^{\\widehat{\\sigma}}\\mathbf{1}_{\\mathcal{H}}]}{\\mathbb{E}[\\widetilde{\\Phi}_{i\\pi_{*}(i)}^{\\widehat{\\sigma}}\\mathbf{1}_{\\mathcal{H}}]^{2}}=O\\left(\\frac{1}{|\\mathcal{T}|\\rho^{2N}}\\right).\n$$", "text_format": "latex", "page_idx": 38}, {"type": "text", "text": "For the second part of this proof, we are going to show the time complexity of Algorithm 4. ", "page_idx": 38}, {"type": "text", "text": "First, we know that step 1-1 costs time $O(\\beta^{K})$ by the algorithm in [6], step 1-2 takes time $O(K)$ by the algorithm in [12], and step 1-3 takes time $O(K)$ by enumerating through all edges. In summary, he total time complexity to generate $\\mathcal{I}$ is $O(K^{2}\\alpha^{K})$ . Afterwards, it takes $\\bar{O}(|\\mathcal{T}|)$ time to complete step 1-4, the generation of chandelier class. ", "page_idx": 38}, {"type": "text", "text": "The signed counts estimation step takes $O(|\\mathcal{T}|N3^{N}n^{2})$ times as shown in the proof of Proposition 5 in [42]. Then, the total time complexity is ", "page_idx": 38}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{O\\left(K^{2}\\beta^{K}+|\\mathcal{T}|(1+N(3\\mathbf{e})^{N}n^{2})\\right)=O\\left(\\left(\\overset{|\\mathcal{T}|}{L}\\right)N(3\\mathbf{e})^{N}n^{2}\\right)}\\\\ &{\\qquad\\qquad\\qquad\\qquad\\qquad=O\\left(\\beta^{K L}(3\\mathbf{e})^{N}n^{2}\\right)=O\\left((3\\mathbf{e}\\beta)^{N}n^{2}\\right).}\\end{array}\n$$", "text_format": "latex", "page_idx": 38}, {"type": "text", "text": "Under condition (3) and for large enough $\\log(n s(p\\wedge q))\\geq\\log(2)$ , we have ", "page_idx": 38}, {"type": "equation", "text": "$$\nN=(K+M)L=\\frac{C^{\\prime}\\log n}{\\varepsilon}(1+\\frac{C^{\\prime\\prime}}{\\log(n s(p\\wedge q))})\\leq\\frac{C^{\\prime}(1+\\frac{C^{\\prime\\prime}}{\\log2})}{\\varepsilon}\\log n,\n$$", "text_format": "latex", "page_idx": 38}, {"type": "text", "text": "for some constants $C^{\\prime}$ and $C^{\\prime\\prime}$ . Hence, there exists some constant $C$ depending only on $\\varepsilon$ such that the total time complexity of Algorithm 4 is $O(n^{C})$ . ", "page_idx": 38}, {"type": "text", "text": "G Proof of Theorem 5 (Exact graph matching by seeded graph matching) ", "text_level": 1, "page_idx": 38}, {"type": "text", "text": "For a pair of correlated SBMs $(G_{1},G_{2})\\sim\\mathrm{CSBM}(n,p,q,s)$ , where $\\textstyle p\\,=\\,{\\frac{a\\log n}{n}}$ and $q\\,=\\,{\\frac{b\\log n}{n}}$ , Algorithm 4 efficiently matches $(1-o(1))n$ vertices correctly with high probability. Our next step is to finish the matching on those remaining vertices. ", "page_idx": 38}, {"type": "text", "text": "To do this, we use the seeded graph matching algorithm7 (Algorithm 2): Starting with an initial partial matching on at least $(1-\\varepsilon/16)n$ vertices which is correct on whatever it matches, we form new matches between vertex $i$ in $G_{1}$ and vertex $j$ in $G_{2}$ if the common neighbors of those two vertices under the current partial matching sufficiently large. We then update the partial matching and repeat this rule until we get a complete matching, which will be shown happens with high probability. Define $h(x)=x\\log x-x+1$ . The sufficiently large common neighbors threshold is set as $\\gamma^{\\frac{p^{2}+q^{2}}{2}}s^{2}(n+2n^{\\frac{3}{4}})$ , where $\\gamma\\in(1,\\infty)$ such that $\\begin{array}{r}{h(\\gamma)=\\frac{3\\log n}{(n-2)p q s^{2}}}\\end{array}$ . ", "page_idx": 38}, {"type": "text", "text": "Denote $\\mathrm{N}_{\\pi}(i,j)$ as the number of common neighbors of $i$ and $j$ under correspondence $\\pi$ . In another word, $\\mathrm{N}_{\\pi}(i,j)$ is the number of vertex $v\\in I$ such that $v$ is a neighbor of $i$ in $A$ and $\\pi(v)$ is a neighbor of $j$ in $B$ . If $\\pi=\\pi_{*}$ , we also write it as $\\operatorname{N}(i,j)$ . ", "page_idx": 38}, {"type": "text", "text": "The following lemma for SBM is an analogy to Lemma 13 in [42], which studied the property of Erdo\u02dds\u2013R\u00e9nyi graph. ", "page_idx": 38}, {"type": "text", "text": "$\\varepsilon\\,>\\,0$ $a,b\\,>\\,0$ such that $\\textstyle{\\frac{a+b}{2}}\\geq1+\\varepsilon$ t $\\begin{array}{r}{p\\,=\\,a\\frac{\\log n}{n},q\\,=\\,b\\frac{\\log n}{n}}\\end{array}$ and $G\\sim{\\mathrm{SBM}}(n,p,q)$ . Let $I\\subset[n]$ be a subset of vertices, $e_{G}(I,I^{c})$ denotes the number of edges between vertices in $I$ and vertices in $I^{c}\\,=\\,[n]\\,\\backslash\\,I$ . With probability $1\\,-\\,n^{-\\,{\\frac{\\varepsilon}{8}}}$ , for any $I$ such that $\\begin{array}{r}{|I|\\;\\leq\\;\\frac{\\varepsilon}{16}n,\\;e_{G}(I,I^{c})\\;\\geq\\;\\eta|I||I^{c}|p\\,\\land\\,q}\\end{array}$ , where $\\eta$ is the unique solution in $(0,1)$ such that $\\begin{array}{r}{h(\\eta)=\\frac{(1+\\frac{\\varepsilon}{8})\\log n}{(p+q)(\\frac{n}{2}-n^{3/4}-\\frac{\\varepsilon}{16}n)}}\\end{array}$ . In particular, ", "page_idx": 38}, {"type": "text", "text": "", "page_idx": 39}, {"type": "equation", "text": "$$\n\\eta\\geq1-\\sqrt{\\frac{1+\\frac{\\varepsilon}{8}}{(1+\\varepsilon)(1-\\frac{\\varepsilon}{7})}}.\n$$", "text_format": "latex", "page_idx": 39}, {"type": "text", "text": "Proof. If $I=\\emptyset$ , $e_{G}(I,I^{c})\\ge\\eta|I||I^{c}|\\frac{p+q}{2}$ holds trivially. Let $I$ be an non-empty set with $1\\leq|I|\\leq$ ${\\textstyle{\\frac{\\varepsilon}{16}}}n$ . We denote $k$ as $|I|$ . The number of edges between $I$ and $I^{c}$ is the summation of $k(n-k)$ independent Bernoulli trails. For arbitrary vertex $i\\in I$ and vertex $j\\in I^{c}$ , if they have the same community label, then the Bernoulli trail between them has mean $p$ . Otherwise,t he Bernoulli trail has mean $q$ . We assume that there are $N_{1}$ trails with mean $p$ and $N_{2}$ trails with mean $q$ , where $N_{1}+N_{2}=$ $k(n-k)$ . We can write out the distribution as $e_{G}(I,I^{c})\\sim\\mathrm{Binom}(N_{1},p)+\\mathrm{Binom}(N_{2},q).$ . ", "page_idx": 39}, {"type": "text", "text": "Under the balanced community event $\\mathcal{H}$ , $\\begin{array}{r}{\\frac{n}{2}-n^{3/4}\\leq|V^{+}|,|V^{-}|\\leq\\frac{n}{2}+n^{3/4}}\\end{array}$ . Assume that there are $k_{+}$ vertices in $I$ with label $+1$ and the remaining $k_{-}$ vertices with label $-1$ . ", "page_idx": 39}, {"type": "equation", "text": "$$\n\\frac{N_{1}}{k}=\\frac{1}{k}\\Big(k_{+}(|V^{+}|-k_{+})+k_{-}(|V^{-}|-k_{-})\\Big)\\geq\\frac{n}{2}-n^{3/4}-\\frac{k_{+}^{2}+k_{-}^{2}}{k}\\geq\\frac{n}{2}-n^{3/4}-\\frac{\\varepsilon}{16}n,\n$$", "text_format": "latex", "page_idx": 39}, {"type": "equation", "text": "$$\n\\frac{N_{2}}{k}=\\frac{1}{k}\\Big(k_{-}\\big(|V^{+}|-k_{+}\\big)+k_{+}\\big(|V^{-}|-k_{-}\\big)\\Big)\\geq\\frac{n}{2}-n^{3/4}-\\frac{2k_{1}k_{2}}{k}\\geq\\frac{n}{2}-n^{3/4}-\\frac{\\varepsilon}{32}n.\n$$", "text_format": "latex", "page_idx": 39}, {"type": "text", "text": "We are interested in the probability of $e_{G}(I,I^{c})$ being less than $n|I||I^{c}|p\\wedge q$ : ", "page_idx": 39}, {"type": "equation", "text": "$$\n\\mathbb{P}(e_{G}(I,I^{c})\\leq\\eta k(n-k)p\\wedge q)\\leq\\mathbb{P}(e_{G}(I,I^{c})\\leq\\eta(N_{1}p+N_{2}q))\\leq\\exp(-(N_{1}p+N_{2}q)h(\\eta)).\n$$", "text_format": "latex", "page_idx": 39}, {"type": "text", "text": "where the first inequality holds because $N_{1}+N_{2}\\,=\\,k(n-k)$ and $p\\wedge q\\leq p,q$ and the second inequality holds because of the multiplicative Chernoff bound (Lemma 4). ", "page_idx": 39}, {"type": "text", "text": "Let $\\begin{array}{r}{h(\\eta)=\\frac{(1+\\frac{\\varepsilon}{8})\\log n}{(p+q)(\\frac{n}{2}-n^{3/4}-\\frac{\\varepsilon}{16}n)}}\\end{array}$ (p+q)( 2n \u22128 n3/4\u22121\u03b56 n), we can show that ", "page_idx": 39}, {"type": "equation", "text": "$$\n\\frac{\\mathfrak{c}(1+\\frac{\\varepsilon}{8})\\log n}{N_{1}p+N_{2}q}<\\frac{(1+\\frac{\\varepsilon}{8})\\log n}{(p+q)(\\frac{n}{2}-n^{3/4}-\\frac{\\varepsilon}{16}n)}\\le\\frac{1+\\frac{\\varepsilon}{8}}{(1+\\varepsilon)(1-2n^{-1/4}-\\frac{\\varepsilon}{8})}<\\frac{1+\\frac{\\varepsilon}{8}}{(1+\\varepsilon)(1-\\frac{\\varepsilon}{7})}<1,\n$$", "text_format": "latex", "page_idx": 39}, {"type": "text", "text": "where the first inequality holds because of (36) and (37), the second inequality holds because $\\begin{array}{r}{\\frac{a+b}{2.}\\geq1+\\varepsilon}\\end{array}$ and the third inequality holds for sufficiently large $n$ . Since $h(\\eta)\\in(0,1)$ , there is an unique solution of $\\eta\\in(0,1)$ due to the monotocity (decreasing) of the function $h(\\cdot)$ . ", "page_idx": 39}, {"type": "text", "text": "Applying the fact that $(N_{1}p+N_{2}q)h(\\eta)>(1+\\textstyle\\frac{\\varepsilon}{8})\\log n$ (38) and using an union bound over all subsets $\\bar{I}\\subset[n]$ with size $\\begin{array}{r}{1\\leq|I|\\leq\\frac{\\varepsilon}{16}}\\end{array}$ , we have ", "page_idx": 39}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{P}(\\exists I\\subset[n]\\mathrm{~s.t.~}1\\le|I|\\le\\displaystyle\\frac{\\varepsilon}{16},e_{G}(I,I^{c})\\le\\eta|I|(n-|I|)p\\land q)}\\\\ &{\\qquad\\qquad\\qquad\\qquad\\le\\displaystyle\\sum_{k=1}^{\\frac{\\varepsilon}{16}}n^{k}\\mathbb{P}(e_{G}(I,I^{c})\\le\\eta k(n-k)p\\land q)\\le\\displaystyle\\sum_{k=1}^{\\frac{\\varepsilon}{16}}n^{k-k(1+\\frac{\\varepsilon}{8})}=O(n^{-\\frac{\\varepsilon}{8}}).}\\end{array}\n$$", "text_format": "latex", "page_idx": 39}, {"type": "text", "text": "Because h(x) \u2265(x\u221221)2for x \u2208(0, 1), we have \u03b7 \u22651 \u2212 2h(\u03b7) > 1 \u2212 (1+\u03b51)+( 1\u03b58 \u03b5 ). ", "page_idx": 39}, {"type": "text", "text": "Now, we are ready to prove Theorem 5. ", "page_idx": 39}, {"type": "text", "text": "Proof of Theorem 5. Firstly, we study the size of common neighbors. For an arbitrary vertex $u\\in[n]$ in $G_{1}$ and $v\\in[n]$ in $G_{2}$ such that $v$ is not the true correspondence of $u$ , we study the number of common neighbors $\\mathrm{N}(u,v)$ in the intersection graph corresponding to the true permutation. ", "page_idx": 39}, {"type": "text", "text": "Case a: These two vertices come from different communities. If $v\\neq\\pi_{*}(u),\\pmb{\\sigma}(u)\\pmb{\\sigma}(v)=-1$ , then we have $\\mathrm{N}(u,v)\\sim\\mathrm{Binom}(n-2,\\dot{p}q s^{2})$ . By the multiplicative Chernoff bound (Lemma 4) for Binomial distributions, for $\\gamma\\in(1,\\infty)$ , we have ", "page_idx": 39}, {"type": "equation", "text": "$$\n\\mathbb{P}(\\mathrm{N}(u,v)\\ge\\gamma\\frac{p^{2}+q^{2}}{2}s^{2}(n+2n^{\\frac34}))<\\mathbb{P}(\\mathrm{N}(u,v)\\ge\\gamma(n-2)p q s^{2})\\le e^{-(n-2)p q s^{2}h(\\gamma)}=n^{-3},\n$$", "text_format": "latex", "page_idx": 39}, {"type": "text", "text": "$\\begin{array}{r}{h(\\gamma)=\\frac{3\\log n}{(n-2)p q s^{2}}>1,\\gamma\\in(1,\\infty)}\\end{array}$ . The first inequality holds because $\\begin{array}{r}{\\frac{p^{2}+q^{2}}{2}(n+2n^{\\frac{3}{4}})>}\\end{array}$ $(n-2)p q$ . ", "page_idx": 40}, {"type": "text", "text": "By a union bound over all $u,v$ such that $v\\neq\\pi_{*}(u),\\pmb{\\sigma}(u)\\pmb{\\sigma}(v)=-1$ , we have ", "page_idx": 40}, {"type": "equation", "text": "$$\n{\\mathbb P}\\{\\exists v\\neq\\pi_{*}(u),\\sigma(u)\\sigma(v)=-1,\\mathrm{~s.t.~}{\\mathbb N}(u,v)\\geq\\gamma\\frac{p^{2}+q^{2}}{2}s^{2}n(1+2n^{-\\frac{1}{4}})\\}=O(\\frac{1}{n}).\n$$", "text_format": "latex", "page_idx": 40}, {"type": "text", "text": "Case $^b$ : These two vertices come from the same community. If $v\\neq\\pi_{*}(u),\\pmb{\\sigma}(u)\\pmb{\\sigma}(v)=1$ , then we have $\\mathrm{N}(u,v)\\sim\\mathrm{Binom}(|V^{\\sigma(v)}|-2,p^{2}s^{2})+\\mathrm{Binom}(|V^{-\\sigma(v)}|,q^{2}s^{2})$ because there are $\\left|V^{\\pmb{\\sigma}(v)}\\right|-2$ vertices left from the same community as $u,v$ and $\\left|V^{-\\sigma(v)}\\right|$ vertices from the different community. Denote $n_{1}$ as $|V^{\\pmb{\\sigma}(v)}|-2$ and $n_{2}$ as $\\left|V^{-\\sigma(v)}\\right|$ , $n_{1}+n_{2}=n-2$ . ", "page_idx": 40}, {"type": "equation", "text": "$$\n\\begin{array}{r l r}{\\mathbb{P}\\{\\mathrm{N}(u,v)\\ge\\gamma\\frac{p^{2}+q^{2}}{2}s^{2}(n+2n^{\\frac34})\\}<\\mathbb{P}\\{\\mathrm{N}(u,v)\\ge\\gamma(n_{1}p^{2}+n_{2}q^{2})s^{2}\\}}&{}&\\\\ {\\qquad\\qquad\\qquad\\qquad\\qquad\\le\\exp(-(n_{1}p^{2}+n_{2}q^{2})s^{2}h(\\gamma))<n^{-3}.}&{}&\\end{array}\n$$", "text_format": "latex", "page_idx": 40}, {"type": "text", "text": "The first inequality holds becaus e p22+q2(n+2n34 ) > n1p2 +n2q2. The last inequality holds because $\\begin{array}{r}{\\frac{3\\log n}{(n-2)p q}>\\frac{3\\log n}{\\frac{p^{2}+q^{2}}{2}n(1-2n^{-\\frac{1}{4}})}>\\frac{3\\log n}{n_{1}p^{2}+n_{2}q^{2}}}\\end{array}$ for sufficiently large $n$ . ", "page_idx": 40}, {"type": "text", "text": "Then, with an union bound over all $u,v$ such that $v\\neq\\pi_{*}(u),\\pmb{\\sigma}(u)\\pmb{\\sigma}(v)=1$ , we have ", "page_idx": 40}, {"type": "equation", "text": "$$\n\\mathbb{P}\\{\\exists v\\neq\\pi_{*}(u),\\sigma(u)\\sigma(v)=1,\\mathrm{~s.t.~N}(u,v)\\ge\\gamma\\frac{p^{2}+q^{2}}{2}s^{2}n(1+2n^{-\\frac{1}{4}})\\}=O(\\frac{1}{n}).\n$$", "text_format": "latex", "page_idx": 40}, {"type": "text", "text": "Combining the above two cases, we have ", "page_idx": 40}, {"type": "equation", "text": "$$\n{\\mathbb P}\\{\\exists v\\neq\\pi_{*}(u),\\mathrm N(u,v)\\ge\\gamma\\frac{p^{2}+q^{2}}{2}s^{2}n(1+2n^{-\\frac14})\\}=o(1).\n$$", "text_format": "latex", "page_idx": 40}, {"type": "text", "text": "Secondly, we show that the algorithm is working properly. From (39), we assume that for all $\\begin{array}{r}{v\\neq\\pi_{*}(u),\\mathrm{N}(u,v)<\\gamma\\frac{p^{2}+q^{2}}{2}s^{2}(n+2n^{\\frac{3}{4}})}\\end{array}$ . We want to show $\\widetilde{\\pi}=\\pi_{*}|_{J}$ in every step of Algorithm 2 by induction. This is true for the initialization of $\\widetilde{\\pi}$ as a base case, from our assumption for Theorem 5. Suppose that this is true for $t$ -th round of the algorithm, then at the $(t+1)$ -th round, we have that for all $v\\neq\\pi_{*}(u)$ , ", "page_idx": 40}, {"type": "equation", "text": "$$\n\\mathrm{N}_{\\widetilde{\\pi}}(u,v)\\le\\mathrm{N}(u,v)<\\gamma\\frac{p^{2}+q^{2}}{2}s^{2}\\big(n+2n^{\\frac{3}{4}}\\big).\n$$", "text_format": "latex", "page_idx": 40}, {"type": "text", "text": "Therefore, as the $(t+1)$ -th round, the algorithm will still not add an fake correspondence. Either the algorithm terminates, or a new vertex $i$ is added to $J$ such that $\\widetilde{\\pi}(i)=i$ , which preserves the property $\\approx\\pi_{*}|_{J}$ . ", "page_idx": 40}, {"type": "text", "text": "Next, we show that Algorithm 2 always ends with $J\\,=\\,[n]$ by contradiction. Assume that the algorithm terminates with $|J|<n$ , then $J^{c}\\neq\\emptyset$ . Then, by definition, for al $i\\in J^{c}$ , $\\begin{array}{r}{\\mathrm{N}_{\\widetilde{\\pi}}(i,\\pi_{*}(i))<}\\end{array}$ $\\gamma\\frac{p^{2}\\!+\\!q^{2}}{2}(n+2n^{\\frac{3}{4}})$ . Therefore, ", "page_idx": 40}, {"type": "equation", "text": "$$\ne_{G_{1}\\wedge_{\\pi_{*}}G_{2}}(J,J^{c})=\\sum_{i\\in J^{c}}\\mathrm{N}_{\\widetilde{\\pi}(i,\\pi_{*}(i))}\\leq|J^{c}|\\gamma\\frac{p^{2}+q^{2}}{2}s^{2}(n+2n^{\\frac{3}{4}}).\n$$", "text_format": "latex", "page_idx": 40}, {"type": "text", "text": "On the other side, $G_{1}\\wedge_{\\pi_{*}}G_{2}\\sim\\mathrm{SBM}(n,s^{2}p,s^{2}q)$ . If $\\begin{array}{r}{s^{2}\\frac{p+q}{2}\\geq(1+\\varepsilon)\\frac{\\log n}{n}}\\end{array}$ , then from Lemma 17 (in view of $J^{c}$ as $I$ ), with probability of $1-O(n^{-{\\frac{\\varepsilon}{8}}})$ , ", "page_idx": 40}, {"type": "equation", "text": "$$\ne_{G_{1}\\wedge_{\\pi_{*}}G_{2}}(J,J^{c})\\geq\\eta|J||J^{c}|s^{2}\\frac{p+q}{2}\\geq\\eta(1-\\frac{\\varepsilon}{16})n|J^{c}|s^{2}(p\\wedge q).\n$$", "text_format": "latex", "page_idx": 40}, {"type": "text", "text": "To reach a contradiction between (40) and (41), the remaining is to prove that ", "page_idx": 40}, {"type": "equation", "text": "$$\n\\gamma\\leq\\frac{\\eta(1-\\frac{\\varepsilon}{16})n s(p\\wedge q)}{\\frac{p^{2}+q^{2}}{2}(n+2n^{\\frac{3}{4}})}.\n$$", "text_format": "latex", "page_idx": 40}, {"type": "text", "text": "We observe that $\\begin{array}{r}{h(\\gamma)=\\frac{3\\log n}{(n-2)p q s^{2}}=\\Theta(1)}\\end{array}$ = \u0398(1), while \u03b7(21\u221212\u03b56 )ns(p\u22273q) $\\begin{array}{r}{\\frac{\\eta(1-\\frac{\\varepsilon}{16})n s(p\\wedge q)}{\\frac{p^{2}+q^{2}}{2}(n+2n^{\\frac{3}{4}})}=\\Theta(\\frac{n}{\\log n})}\\end{array}$ . Therefore (42) holds for sufficiently large $n$ . ", "page_idx": 41}, {"type": "text", "text": "Finally, we analyze the time complexity of Algorithm 2. For each $u\\,\\in\\,[n]$ to be added into the seeded set $I$ , we update the number of common neighbors $\\mathrm{N}_{\\widetilde{\\pi}}(i,j)$ for all $i,j\\in I$ . This step takes $O(\\deg_{G_{1}}(u)\\deg_{G_{2}}(u))$ , where $\\deg_{G}(u)$ denotes the degree o f $u$ in graph $G$ . With probability $1\\textstyle-o\\big(\\frac{1}{n^{2}}\\big)$ , $\\deg_{G_{1}}(u)\\,=\\,O(n(p+q))$ . By summing up for all possible $u$ to be added, the time complexity of Algorithm 2 is $O(n^{3}(p+q)^{2})$ . \u53e3 ", "page_idx": 41}, {"type": "text", "text": "H Proof of Proposition 1 ", "text_level": 1, "page_idx": 41}, {"type": "text", "text": "In this section, we calculate the expectation of similarity score for correlated SBM. Recall that we have defined $\\sigma_{+}^{2}:=s p(1-s p),\\sigma_{-}^{2}:=s q(1-s q)$ and that $\\begin{array}{r}{\\sigma_{\\mathrm{eff}}^{2}:=\\big(\\frac{\\sigma_{+}^{2}+\\sigma_{-}^{2}}{2}\\big)}\\end{array}$ throughout this paper. ", "page_idx": 41}, {"type": "text", "text": "Proof of Proposition $^{\\,l}$ . By definition of the similarity score, ", "page_idx": 41}, {"type": "equation", "text": "$$\n\\mathbb{E}[\\Phi_{i j}\\mathbf{1}_{\\mathcal{H}}]=\\sum_{H\\in\\mathcal{T}}\\mathrm{aut}(H)\\sum_{S(i)\\cong H}\\sum_{S(j)\\cong H}\\mathbb{E}\\left[\\overline{{A}}_{S(i)}\\overline{{B}}_{S(j)}\\mathbf{1}_{\\mathcal{H}}\\right].\n$$", "text_format": "latex", "page_idx": 41}, {"type": "text", "text": "The expectation is zero if $S(i)=S(j)$ , which implies considering $\\pi_{*}(i)=j$ suffices: ", "page_idx": 41}, {"type": "equation", "text": "$$\n\\mathbb{E}[\\Phi_{i j}\\mathbf{1}_{\\mathcal{H}}]=(1+o(1))\\sum_{H\\in\\mathcal{T}}\\mathrm{aut}(H)\\sum_{S(i)\\cong H}\\mathbb{E}\\left[\\overline{{A}}_{S(i)}\\overline{{B}}_{S(\\pi_{*}(i))}\\mid\\mathcal{H}\\right].\n$$", "text_format": "latex", "page_idx": 41}, {"type": "text", "text": "Define $X_{1}$ as the random variable for the number of in-community edges of $S(i)$ , which takes possible value from 0 to $N$ . Define $|\\{S(i):S(i)\\cong H\\}|$ as the total number of $S$ rooted at $i$ and isomorphic to $H$ , we have ", "page_idx": 41}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{E}\\big[\\Phi_{i\\pi_{*}(i)}\\mathbf{1}_{\\mathcal{H}}\\big]=(1+o(1))\\displaystyle\\sum_{H\\in\\mathcal{T}}\\mathrm{aut}(H)|\\{S(i):S(i)\\cong H\\}|\\mathbb{E}\\left[\\mathbb{E}\\left[\\overline{{A}}_{S(i)}\\overline{{B}}_{S(\\pi_{*}(i))}\\mid X_{1},\\mathcal{H}\\right]\\right]}\\\\ &{\\qquad\\qquad\\qquad\\leq(1+o(1))\\displaystyle\\sum_{H\\in\\mathcal{T}}n^{N}\\displaystyle\\sum_{N_{1}=0}^{N}\\mathbb{P}(X_{1}=N_{1}\\mid\\mathcal{H})\\rho^{N}\\sigma_{+}^{2N_{1}}\\sigma_{-}^{2N_{1}}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 41}, {"type": "text", "text": "The second inequality holds by $\\begin{array}{r}{|\\{S(i):S(i)\\cong H\\}|=\\frac{{\\binom{n}{N}}N!}{\\mathrm{aut}(H)}=(1+o(1))\\frac{n^{N}}{\\mathrm{aut}(H)}}\\end{array}$ )aunt(H) since Nn N! iEs  tAheS (ni $\\begin{array}{r}{\\overline{{B}}_{S(\\pi_{*}(i))}\\big\\vert\\{X_{1}=N_{1}\\}\\cap\\mathcal{H}\\big]=\\rho_{+}^{N_{1}}\\rho_{-}^{\\overline{{N}}-N_{1}}\\sigma_{+}^{2N_{1}}\\sigma_{-}^{2(N-N_{1})}=(1+o(1))\\rho^{\\overline{{\\sigma}}_{+}^{2}\\hat{N}_{1}}\\sigma_{-}^{2(N-N_{1})}.}\\end{array}$ Then, according to Lemma 9 and the binomial theorem, we have $\\mathbb{P}(X_{1}\\;=\\;N_{1}\\;\\;|\\;\\;\\mathcal{H})\\;=\\;(1\\;+\\;$ $o(1))\\big(\\O_{N_{1}}^{N}\\big)2^{-N}$ . Therefore, ", "page_idx": 41}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{E}[\\Phi_{i\\pi_{*}(i)}\\mathbf{1}_{\\mathcal{H}}]=(1+o(1))|\\mathcal{T}|n^{N}\\rho^{N}\\displaystyle\\sum_{N_{1}=0}^{N}\\binom{N}{N_{1}}\\frac{1}{2^{N}}\\sigma_{+}^{2N_{1}}\\sigma_{-}^{2N-2N_{1}}}\\\\ &{\\qquad\\qquad\\qquad=(1+o(1))|\\mathcal{T}|n^{N}\\rho^{N}(\\frac{\\sigma_{+}^{2}+\\sigma_{-}^{2}}{2})^{N}=(1+o(1))|\\mathcal{T}|n^{N}\\rho^{N}\\sigma_{\\mathrm{eff}}^{2N}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 41}, {"type": "text", "text": "I Proof of Proposition 2 ", "text_level": 1, "page_idx": 41}, {"type": "text", "text": "I.1 Decorated union graph and union graph partition ", "text_level": 1, "page_idx": 41}, {"type": "text", "text": "The analysis of the first moment involves two chandeliers, while the second moment analysis requires four chandeliers. Before delving into the analysis, we introduce the notation for the decorated union graph and establish a rule for union graph partition. We adopt some notations and definitions from [42] and further introduce concepts that are particularly useful for correlated stochastic block models. ", "page_idx": 41}, {"type": "text", "text": "\u2022 (Decorated Graph) For any graph $G$ , define $\\dot{G}$ as a decorated graph $\\dot{G}:=(G,D_{G})$ , where $D_{G}$ is a decoration mapping from the edge set to a decoration set. Define the edge set of decorated graph $E(\\dot{G}):=\\bar{E}(G)$ and the vertex set of decorated graph $V(\\dot{G}):=\\bar{V}(G)$ . \u2022 (Decorated Union Graph) For any pair of chandeliers $H,I\\in{\\mathcal{T}}$ , let $S_{1}(i),S_{2}(j)\\cong H$ and $T_{1}(i),T_{2}(j)\\cong I$ . The union graph is defined as $U=S_{1}\\cup S_{2}\\cup T_{1}\\cup T_{2}$ . Now, let us define the proper decoration for $\\dot{U}$ : ", "page_idx": 42}, {"type": "equation", "text": "$$\nD_{U}(e)=\\left\\{\\begin{array}{l l}{\\mathrm{The~subset~of~}\\{S_{1},S_{2},T_{1},T_{2}\\}\\mathrm{~where~}e\\mathrm{~occurs,}}&{\\mathrm{if~}e\\in E(U),}\\\\ {\\varnothing,}&{\\mathrm{if~}e\\notin E(U).}\\end{array}\\right.\n$$", "text_format": "latex", "page_idx": 42}, {"type": "text", "text": "We call an edge $e\\in E(U)$ t-decorated if $|D_{U}(e)|=t$ , $t\\in\\{0,1,2,3,4\\}$ . ", "page_idx": 42}, {"type": "text", "text": "\u2022 (Decorated Set Operation) Assume that $\\dot{U}\\,=\\,(U,D_{U})$ and $\\dot{U}^{\\prime}\\,=\\,(U^{\\prime},D_{U^{\\prime}})$ are two decorated graphs. We define the union, intersection, and difference operations, from which the complement and symmetric difference naturally follow. ", "page_idx": 42}, {"type": "text", "text": "\u2013 Union. $\\dot{U}\\cup\\dot{U}^{\\prime}:=(U\\cup U^{\\prime},D_{U^{\\prime\\prime}}:D_{U^{\\prime\\prime}}(e)=D_{U}(e)\\cup D_{U^{\\prime}}(e)).$   \n\u2013 Intersection. U\u02d9 $\\mathrm{~\\bar{~}{\\cap~}}U^{\\prime}:=(U\\cap U^{\\prime},D_{U^{\\prime\\prime}}:D_{U^{\\prime\\prime}}(e)=D_{U}(e)\\cap D_{U}$ \u2032(e)).   \n\u2013 Difference. $\\dot{\\gamma}\\,\\backslash\\,\\dot{U}^{\\prime}:=(U\\setminus U^{\\prime},D_{U^{\\prime\\prime}}:D_{U^{\\prime\\prime}}(e)=D_{U}(e)\\setminus D_{U^{\\prime}}(e)).$ ", "page_idx": 42}, {"type": "text", "text": "\u2022 (Union Graph Partition) Assume that $i$ is the root of union graph. Consider the graph $U$ with edge $(i,a)$ removed for all neighbors $a$ of $i$ . Let $\\dot{\\mathcal{C}}(i,a)$ be the connected component therein that contains $a$ . Let $\\dot{\\mathcal{G}}(\\boldsymbol{i},\\boldsymbol{a})$ be the graph union of $\\dot{\\mathcal{C}}(i,a)$ and the edge $(i,a)$ . Then, we divide the set of root neighbors $\\mathcal{N}(i)$ into the following sets depending on whether $\\dot{\\mathcal{G}}(\\boldsymbol{i},\\boldsymbol{a})$ is a tree: $\\mathcal{N}_{T}=\\{a:(i,a)\\in E(U),\\dot{\\mathcal{G}}(i,a)$ is a tree}, $\\mathcal{N}_{N}=\\{a:(i,a)\\in$ $E(\\dot{U})\\}\\setminus N_{T}$ . Furthermore, we breakdown $\\mathcal{N}_{T}$ into two sets depending on whether there are at least $M$ edges 3-decorated: $\\begin{array}{r}{\\ensuremath{\\mathcal{N}}_{M}=\\{a\\in\\ensuremath{\\mathcal{N}}_{T},|\\{e\\in E(\\dot{\\mathcal{G}}(i,a)):|D_{U}(e)|\\geq3\\}|\\geq M\\}.}\\end{array}$ $\\mathcal{N}_{L}=\\mathcal{N}_{T}\\setminus\\bar{\\mathcal{N}}_{M},$ . ", "page_idx": 42}, {"type": "text", "text": "Next, we define the decomposition of decorated union graph $\\dot{U}$ : ", "page_idx": 42}, {"type": "equation", "text": "$$\n\\dot{U}_{L}:=\\bigcup_{a\\in\\mathcal{N}_{L}}\\dot{\\mathcal{G}}(i,a),\\quad\\dot{U}_{M}:=\\bigcup_{a\\in\\mathcal{N}_{M}}\\dot{\\mathcal{G}}(i,a),\\quad\\dot{U}_{N}:=\\dot{U}\\setminus(\\dot{U}_{L}\\cup\\dot{U}_{M}).\n$$", "text_format": "latex", "page_idx": 42}, {"type": "text", "text": "If any of these become an empty set, we define it as the graph consisting of the single vertex $i$ . To provide an intuitive understanding: $\\dot{U}_{N}$ contains those chandelier branches that form cycles in the union graph, while $\\dot{U}_{L}$ and $\\dot{U}_{M}$ are the collection of those chandelier branches that do not tangle with other branches from bottom and remain a part of tree rooted at $i$ (or $j)$ in the union graph. As a characteristic of trees, the decorations on edges within $\\dot{U}_{M}$ and $\\dot{U}_{N}$ are monotonically decreasing, meaning that the decoration set of an edge at depth $d\\geq1$ is always a subset of the decoration set of the preceding edge at depth $d-1$ that connects to it. For each node $v\\in\\dot{U}_{M}$ that is connected to the root, the connected component $\\dot{\\mathcal{G}}(\\boldsymbol{i},\\boldsymbol{a})$ should have at list $M$ vertices that are at least 3-decorated. $\\dot{U}_{L}$ is the union of all connected components remained that are trees. The definition of $\\dot{U}_{L}$ implies that the branches cannot be fully 3-decorated, otherwise this branch would fall in $\\dot{U}_{M}$ . ", "page_idx": 42}, {"type": "text", "text": "For every union graph, we can decompose the decorated union graph based on its decoration sets. Specifically, we want to keep track of how many times each vertex appears on the chandeliers that are rooted at $i$ and the chandeliers that are rooted at $j$ . We present the definition as follows. ", "page_idx": 42}, {"type": "text", "text": "Definition 3 (Decorated union graph decomposition by decorations). ", "page_idx": 42}, {"type": "equation", "text": "$$\n\\begin{array}{r}{K_{\\ell m}:=(V(U),\\{e\\in E(U):\\ell={\\bf1}_{\\{e\\in S_{1}\\}}+{\\bf1}_{\\{e\\in T_{1}\\}},k={\\bf1}_{\\{e\\in S_{2}\\}}+{\\bf1}_{\\{e\\in T_{2}\\}}\\}).}\\end{array}\n$$", "text_format": "latex", "page_idx": 42}, {"type": "text", "text": "Definition 4 (Edge counts on 3 and 4-decorated edges). Based on the definition of union graph partition and $K_{\\ell m}$ , we further define ", "page_idx": 42}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{e_{L}:=\\displaystyle\\frac{1}{2}[e((K_{22}\\cup K_{21})\\cap U_{L})+e((K_{22}\\cup K_{12})\\cap U_{L})],}\\\\ &{e_{M}:=\\displaystyle\\frac{1}{2}[e((K_{22}\\cup K_{21})\\cap U_{M})+e((K_{22}\\cup K_{12})\\cap U_{M})],}\\\\ &{e_{N}:=\\displaystyle\\frac{1}{2}[e((K_{22}\\cup K_{21})\\cap U_{N})+e((K_{22}\\cup K_{12})\\cap U_{N})],}\\end{array}\n$$", "text_format": "latex", "page_idx": 42}, {"type": "text", "text": "where $2e_{L}$ (resp. $2e_{M},\\,2e_{N},$ is the counts of 3-decorated edges and two times the 4-decorated edges on $U_{L}$ (resp. $U_{M},\\,U_{N})$ . ", "page_idx": 43}, {"type": "text", "text": "We use $\\mathcal{U}_{L}(v_{L},e_{L},\\ell)$ to denote the collection of all possible $\\dot{U}_{L}$ with $v_{L}$ vertices except for $i$ and $j$ , $e_{L}$ counts of special edges as defined, and $\\ell$ edges in $K_{11}\\cap\\dot{U}_{L}$ . $\\mathcal{U}_{M}(v_{M},e_{M})$ denotes the family of all possible $\\dot{U}_{M}$ with $v_{M}$ vertices except for $i$ and $j$ and $e_{L}$ counts of special edges as defined. $\\mathcal{U}_{N}(v_{N},e_{N},k)$ denotes the family of all possible $\\dot{U}_{N}$ with $v_{N}$ vertices except for $i$ and $j,e_{N}$ counts of special edges as defined, and excess $k$ . ", "page_idx": 43}, {"type": "text", "text": "We further define the weights for of decorated graphs $\\dot{U}_{L}$ , $\\dot{U}_{M}$ , and $\\dot{U}_{N}$ . ", "page_idx": 43}, {"type": "text", "text": "Definition 5. Let $\\dot{G}$ be an arbitrary $\\dot{U}_{L}$ , $\\dot{U}_{M}$ , or $\\dot{U}_{N}$ , we define the weight of $\\dot{G}$ with regard to $a$ chandelier $S$ as ", "page_idx": 43}, {"type": "equation", "text": "$$\nw_{S}(\\dot{G}):=\\prod_{B\\in\\mathcal{K}(S),B\\subset G}\\mathrm{aut}(B)^{\\frac{1}{2}}.\n$$", "text_format": "latex", "page_idx": 43}, {"type": "text", "text": "We set $w_{S}(\\dot{G})=1\\;i f\\dot{G}$ contains no bulbs in $\\kappa(S)$ . We define the weight of $\\dot{G}$ as the multiplication of its weights over $S_{1},S_{2},T_{1},T_{2}$ : ", "page_idx": 43}, {"type": "equation", "text": "$$\nw(\\dot{G}):=w_{S_{1}}(\\dot{G})w_{S_{2}}(\\dot{G})w_{T_{1}}(\\dot{G})w_{T_{2}}(\\dot{G}).\n$$", "text_format": "latex", "page_idx": 43}, {"type": "text", "text": "We have the following observation with regard to the concepts introduced above: ", "page_idx": 43}, {"type": "text", "text": "\u2022 (Counting edges) $2(v_{L}+v_{M}+v_{N}+k+1+{\\bf1}_{\\{i\\neq j\\}})+2(e_{L}+e_{M}+e_{N})=4N,$ . This holds because $2(v_{L}+v_{M}+v_{N}+k+1+\\mathbf{1}_{\\{i\\neq j\\}})$ counts all the edges on union graph twice and $2(e_{L}+e_{M}+e_{N})$ makes up for an additional count for 3-decorated edges and two counts for 4-decorated edges. ", "page_idx": 43}, {"type": "text", "text": "\u2022 (Automorphism as decorated graph weights) From the definition of $\\operatorname{aut}(\\cdot)$ and chandelier, ", "page_idx": 43}, {"type": "equation", "text": "$$\n(\\mathrm{aut}(S_{1})\\mathrm{aut}(S_{2})\\mathrm{aut}(T_{1})\\mathrm{aut}(T_{2}))^{\\frac{1}{2}}=w(\\dot{U}_{L})w(\\dot{U}_{M})w(\\dot{U}_{N}).\n$$", "text_format": "latex", "page_idx": 43}, {"type": "text", "text": "\u2022 (Trivial upper bound on the decorated graph weights) Since $\\mathrm{aut}(B)$ is upper bounded by $R$ for arbitrary bulb $\\boldsymbol{\\mathrm{\\Delta}}\\boldsymbol{\\mathrm{\\Omega}}^{\\beta}$ , this inequality follows from the definition of decorated union graph weights ", "page_idx": 43}, {"type": "equation", "text": "$$\nw(\\dot{U}_{L})\\leq(\\sqrt{R}^{|{\\mathcal N}_{L}|})^{4}=R^{2|{\\mathcal N}_{L}|}.\n$$", "text_format": "latex", "page_idx": 43}, {"type": "text", "text": "The same holds for $\\dot{U}_{M}$ and $\\dot{U}_{N}$ . ", "page_idx": 43}, {"type": "text", "text": "Specific to the moment calculation for correlated stochastic block models, we present the following two definitions. ", "page_idx": 43}, {"type": "text", "text": "Definition 6 $(g_{\\dot{U}}(\\sigma_{+},\\sigma_{-}))$ . Fix chandeliers $(S_{1},S_{2},T_{1},T_{2})$ on the complete graph, conditioned on the ground-truth labels of correlated SBMs, we define a function as follows: ", "page_idx": 43}, {"type": "equation", "text": "$$\ng_{\\dot{U}}(\\sigma_{+},\\sigma_{-}):=\\sigma_{+}^{h(S_{1})+h(S_{2})+h(T_{1})+h(T_{2})}\\sigma_{-}^{\\overline{{h}}(S_{1})+\\overline{{h}}(S_{2})+\\overline{{h}}(T_{1})+\\overline{{h}}(T_{2})},\n$$", "text_format": "latex", "page_idx": 43}, {"type": "text", "text": "where $h(\\cdot)$ is the counts of edges connecting two points from the same community, $\\overline{{h}}(\\cdot)$ is the counts of edges connecting two points from different communities on the complete graph $K_{n}$ . ", "page_idx": 43}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\mathrm{\\bf~Definition~}7\\mathrm{\\bf~(Extension~of~}\\sigma_{\\mathrm{eff}}^{2}\\mathrm{)}\\mathrm{,~}\\;W e\\;d e f i n e\\;\\gamma_{2}:=\\left(\\frac{\\sigma_{+}^{4}+\\sigma_{-}^{4}}{2}\\right)/\\sigma_{\\mathrm{eff}}^{4}\\;a n d\\;\\gamma_{1}:=\\left(\\frac{\\sigma_{+}^{3}+\\sigma_{-}^{3}}{2}\\right)/\\sigma_{\\mathrm{eff}}^{2}\\;,}\\\\ {\\left(\\frac{\\sigma_{+}^{4}+\\sigma_{-}^{4}}{2}\\right)^{k}=(1+o(1))\\left(\\frac{\\sigma_{+}^{2}+\\sigma_{-}^{2}}{2}\\right)^{2k}\\gamma_{2}^{k}\\;a n d\\;\\left(\\frac{\\sigma_{+}^{3}+\\sigma_{-}^{3}}{2}\\right)^{k}=(1+o(1))\\left(\\frac{\\sigma_{+}^{2}+\\sigma_{-}^{2}}{2}\\right)^{\\frac{3k}{2}}\\gamma_{1}^{k}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 43}, {"type": "text", "text": "Remark 5. We observe that $\\gamma_{2}\\,<\\,2$ and $\\gamma_{1}\\leq\\gamma_{2}$ . The first holds simply because $\\sigma_{+}^{4}+\\sigma_{-}^{4}\\,\\geq$ $2\\sigma_{+}^{2}\\sigma_{-}^{2}$ . By Cauchy\u2013Schwarz inequality, for an arbitrary random variable $X$ , $\\mathbb{E}[X^{3}]\\mathbb{E}[X^{2}]^{2}\\leq$ $\\mathbb{E}[X^{4}]\\mathbb{E}[X^{2}]^{3/2}$ . Let $X$ takes $\\sigma_{+}^{2}$ and $\\sigma_{-}^{2}$ uniformly at random, then $\\begin{array}{r}{\\frac{\\mathbb{E}[X^{3}]}{\\mathbb{E}[X^{2}]^{3/2}}\\,\\leq\\,\\frac{\\mathbb{E}[X^{4}]}{\\mathbb{E}[X^{2}]^{2}}}\\end{array}$ and thus \u03b31 \u2264\u03b32 is implied. ", "page_idx": 43}, {"type": "text", "text": "I.2 Proof of the Proposition ", "text_level": 1, "page_idx": 44}, {"type": "text", "text": "In regime $s D_{+}(a,b)>1$ , we can recover the correct community label with high probability [2, 48, 1]. Therefore we can effectively work on the correct centralized adjacency matrices. Recall that $\\mathcal{H}=$ $\\begin{array}{r}{\\{\\frac{n}{2}-n^{\\frac{3}{4}}\\leq|V^{+}|,|V^{-}|\\leq\\frac{\\bar{n}}{2}+n^{\\frac{3}{4}}\\}}\\end{array}$ , as defined in Section D. ", "page_idx": 44}, {"type": "text", "text": "Proof of Proposition 2. From the definition of variance, ", "page_idx": 44}, {"type": "equation", "text": "$$\n\\operatorname{Var}[\\Phi_{i j}\\mathbf{1}_{\\mathcal{H}}]=\\sum_{H,I\\in\\mathcal{T}}\\mathrm{aut}(H)\\mathrm{aut}(I)\\sum_{S_{1},S_{2}\\cong H,T_{1},T_{2}\\cong I}\\operatorname{Cov}(\\overline{{A}}_{S_{1}}\\overline{{B}}_{S_{2}}\\mathbf{1}_{\\mathcal{H}},\\overline{{A}}_{T_{1}}\\overline{{B}}_{T_{2}}\\mathbf{1}_{\\mathcal{H}}).\n$$", "text_format": "latex", "page_idx": 44}, {"type": "text", "text": "If $S_{1}=S_{2},T_{1}=T_{2}$ , and $V(S_{1})\\cap V(T_{1})=\\{i\\}$ , the covariance becomes zero. Also, we know from Proposition 1 that $\\mathbb{E}[\\overline{{A}}_{S_{1}}\\overline{{B}}_{S_{2}}]\\mathbb{E}[\\overline{{A}}_{T_{1}}\\overline{{B}}_{T_{2}}]$ is either 0 or $(1+o(1))(\\rho\\sigma_{\\mathrm{eff}})^{2N}$ . Thus, ", "page_idx": 44}, {"type": "equation", "text": "$$\n\\mathrm{Var}[\\Phi_{i j}{\\bf1}_{\\mathcal{H}}]\\leq\\sum_{H,I\\in\\mathcal{T}}\\mathrm{aut}(H)\\mathrm{aut}(I)\\sum_{S_{1},S_{2}\\cong H,T_{1},T_{2}\\cong I}\\mathbb{E}[\\overline{{A}}_{S_{1}}\\overline{{B}}_{S_{2}}\\overline{{A}}_{T_{1}}\\overline{{B}}_{T_{2}}{\\bf1}_{\\mathcal{H}}].\n$$", "text_format": "latex", "page_idx": 44}, {"type": "text", "text": "$\\mathbb{E}[\\overline{{A}}_{S_{1}}\\overline{{B}}_{S_{2}}\\overline{{A}}_{T_{1}}\\overline{{B}}_{T_{2}}]$ is non-zero if and only if each edge $e\\in U$ is at least 2-decorated. Let ${\\mathcal{W}}_{i j}$ denote the collection of decorated union graph $U_{D}$ , where $S_{1}(i),S_{2}(j)\\cong H,T_{1}(i),T_{2}(j)\\cong I$ for some $H,I\\in{\\mathcal{T}}$ , such that each edge is at least 2-decorated and satisfies $S_{1}\\neq S_{2}$ or $T_{1}\\neq T_{2}$ or $V(S_{1})\\cap V(T_{1})\\neq\\{i\\}$ . ", "page_idx": 44}, {"type": "equation", "text": "$$\n\\mathrm{Var}[\\Phi_{i j}{\\bf1}_{\\mathcal{H}}]\\leq\\sum_{\\dot{U}\\in\\mathcal{W}_{i j}}(\\mathrm{aut}(S_{1})\\mathrm{aut}(S_{2})\\mathrm{aut}(T_{1})\\mathrm{aut}(T_{2}))^{\\frac{1}{2}}\\mathbb{E}[\\overline{{A}}_{S_{1}}\\overline{{B}}_{S_{2}}\\overline{{A}}_{T_{1}}\\overline{{B}}_{T_{2}}{\\bf1}_{\\mathcal{H}}].\n$$", "text_format": "latex", "page_idx": 44}, {"type": "text", "text": "Conditioned on the ground-truth labeling $\\pmb{\\sigma}_{*}$ ", "page_idx": 44}, {"type": "equation", "text": "$$\ng_{\\dot{U}}(\\sigma_{+},\\sigma_{-})=\\prod_{2\\leq\\ell+m\\leq4\\;(u,v)\\in K_{\\ell m}}\\sigma_{c(u,v)}^{(\\ell+m)},\n$$", "text_format": "latex", "page_idx": 44}, {"type": "text", "text": "where $c(u,v)=+$ if ${\\pmb\\sigma}_{*}(u)={\\pmb\\sigma}_{*}(v)$ and $c(u,v)=-$ if ${\\pmb\\sigma}_{*}(u)\\neq{\\pmb\\sigma}_{*}(v)$ . ", "page_idx": 44}, {"type": "text", "text": "Conditioned on $\\sigma_{*},\\mathcal{H}$ is determined, ", "page_idx": 44}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\mathbb{E}[\\overline{{A}}_{S_{1}}\\overline{{B}}_{S_{2}}\\overline{{A}}_{T_{1}}\\overline{{B}}_{T_{2}}{\\bf1}_{\\mathcal{H}}]=\\mathbb{E}\\left[\\mathbb{E}[\\overline{{A}}_{S_{1}}\\overline{{B}}_{S_{2}}\\overline{{A}}_{T_{1}}\\overline{{B}}_{T_{2}}\\mid\\pmb{\\sigma}_{*}]{\\bf1}_{\\mathcal{H}}\\right].}\\end{array}\n$$", "text_format": "latex", "page_idx": 44}, {"type": "text", "text": "Conditioned on $\\pmb{\\sigma}_{*}$ $\\cdot_{*},\\,g_{\\dot{U}}(\\sigma_{+},\\sigma_{-})$ is fixed, so as $g_{\\dot{U}}^{-1}(\\sigma_{+},\\sigma_{-})$ . ", "page_idx": 44}, {"type": "equation", "text": "$$\ng_{\\bar{U}}\\!\\left(\\sigma_{+},\\sigma_{-}\\right)^{-1}\\!\\mathbb{E}\\!\\left[\\overline{{A}}_{S_{1}}\\overline{{B}}_{S_{2}}\\overline{{A}}_{T_{1}}\\overline{{B}}_{T_{2}}\\mid\\sigma_{*}\\right]=\\prod_{\\substack{2\\leq\\ell+m\\leq4\\,\\left(u,v\\right)\\in K_{\\ell m}}}\\sigma_{c\\left(u,v\\right)}^{-(\\ell+m)}\\mathbb{E}\\!\\left[\\overline{{A}}_{u v}^{\\ell}\\overline{{B}}_{u v}^{m}\\mid\\sigma_{*}\\right].\n$$", "text_format": "latex", "page_idx": 44}, {"type": "text", "text": "We define $\\beta_{\\ell m}(e)$ as \u03c3c\u2212((u\u2113,v+)m)E[A\u2113uvBumv | \u03c3\u2217], for e = (u, v) \u2208K\u2113,m. Thus, ", "page_idx": 44}, {"type": "equation", "text": "$$\ng_{\\bar{U}}(\\sigma_{+},\\sigma_{-})^{-1}{\\mathbb E}[\\overline{{A}}_{S_{1}}\\overline{{B}}_{S_{2}}\\overline{{A}}_{T_{1}}\\overline{{B}}_{T_{2}}\\mid\\sigma_{*}]=g_{\\bar{U}}(\\sigma_{+},\\sigma_{-})^{-1}\\prod_{\\substack{2\\leq\\ell+m\\leq4\\,(u,v)\\in K_{\\ell m}}}\\beta_{\\ell m}(e).\n$$", "text_format": "latex", "page_idx": 44}, {"type": "text", "text": "Then, we apply Lemma 13 to bound each $\\beta_{\\ell m}(e)$ . Since the upper bound of $\\beta_{\\ell m}(e)$ only depends on $\\ell$ and $m$ , we have the following: ", "page_idx": 44}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{g_{\\bar{U}}(\\sigma_{+},\\sigma_{-})^{-1}\\mathbb{E}[\\overline{{A}}_{S_{1}}\\overline{{B}}_{S_{2}}\\overline{{A}}_{T_{1}}\\overline{{B}}_{T_{2}}\\mid\\sigma_{*}]\\leq\\mid\\operatorname*{max}\\{\\rho_{+},\\rho_{-}\\}|^{e(K_{11})}\\frac{\\left(s p\\wedge s q\\right)^{-e(K_{22})}}{\\sqrt{\\left(s p\\wedge s q\\right)^{\\left(e(K_{21})+e(K_{12})\\right)}}}}\\\\ &{\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\left(1+o(1)\\right)\\rho^{e(K_{11})}\\big(s p\\wedge s q\\big)^{-2N+e(U)},}\\end{array}\n$$", "text_format": "latex", "page_idx": 44}, {"type": "text", "text": "where the last equality holds because 2 $\\left[\\frac{1}{2}(e(K_{12})+e(K_{21}))+e(K_{22})\\right]=(2-2)e(K_{20})+(2-1)e(K_{12})$ $2)e(K_{02})+(3-2)e(K_{12})+(3-2)e(K_{21})+(4-2)e(K_{22})=4N-e(U)$ . From (54) and (55), and the fact that $\\mathcal{H}$ happens with high probability, we have ", "page_idx": 44}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\mathbb E\\!\\left[\\overline{A}_{S_{1}}\\overline{B}_{S_{2}}\\overline{A}_{T_{1}}\\overline{B}_{T_{2}}{\\mathbf1}_{\\mathcal{H}}\\right]=(1+o(1))\\rho^{e(K_{11})}(s p\\wedge s q)^{-2N+e(U)}\\mathbb E\\left[g_{\\hat{U}}(\\sigma_{+},\\sigma_{-})\\mid\\mathcal{H}\\right].}\\end{array}\n$$", "text_format": "latex", "page_idx": 44}, {"type": "text", "text": "It remains to compute $\\mathbb{E}\\left[g_{\\dot{U}}(\\sigma_{+},\\sigma_{-})\\mid\\mathcal{H}\\right]$ . Here, $\\dot{U}$ is fixed and we assume that there are $d_{2}$ 2- decorated edges, $d_{3}$ 3-decorated edges, and $d_{4}$ 4-decorated edges without loss of generality. Let $X^{(2)},X^{(3)}$ , and $X^{(4)}$ be the number of in-community edges for 2, 3, and 4-decorated edges on the complete graph respectively. In $\\dot{U}$ is a tree, we can apply Lemma 10 to determine the distribution of $X^{(2)},X^{(3)}$ , and $X^{\\bar{(4)}}$ . ", "page_idx": 45}, {"type": "text", "text": "Generally, $\\dot{U}$ contains cycles. $\\dot{U}$ can be decomposed into a tree with an additional set of edges connecting vertices on the tree. We assume that there are $A_{i}$ $i$ -decorated edges on the tree and $B_{i}$ $i$ -decorated edges in the additional edge set of size $e(\\dot{U})-v(\\dot{U})+1$ , for $i\\in\\{2,3,4\\}$ . We apply the Corollary 1 and have that $\\mathbb{P}(X^{(2,a)}\\,=\\,a_{2},X^{(3,a)}\\,=\\,a_{3},X^{(4,a)}\\,=\\,a_{4},X^{(2,b)}\\,=\\,b_{2},X^{(3,b)}\\,=$ $b_{3},X^{(4,b)}\\;=\\;b_{4}\\;\\mid\\;{\\mathcal{H}})\\;\\le\\;(1\\,+\\,o(1))\\binom{A_{2}}{a_{2}}\\binom{A_{3}}{a_{3}}\\binom{A_{4}}{a_{4}}\\frac{1}{2^{A_{2}+A_{3}+A_{4}}}$ , where $X^{(i,a)}$ is the number of $i$ - decorated in-community edges on the tree-part of $\\dot{U}$ and $X^{(i,b)}$ is the number of $i$ -decorated incommunity edges among the additional edge set. ", "page_idx": 45}, {"type": "text", "text": "$A_{i}$ and $B_{i}$ are fixed but summed up to $d_{i}$ for each $\\dot{U}$ . $a_{i}\\left(b_{i}\\right)$ takes possible values from 0 to $A_{i}\\left(B_{i}\\right)$ , for $i\\in$ [4]. The number of $i$ -decorated in-community edges is $a_{i}+b_{i}$ , and the number of $i$ -decorated cross-community edges is $d_{i}-a_{i}-b_{i}=(A_{i}-a_{i})+(B_{i}-b_{i})$ . ", "page_idx": 45}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{\\mathbb{E}\\left[g_{\\zeta}(\\sigma_{+},\\sigma_{-})\\ |\\ \\mathcal{H}\\right]=\\displaystyle\\sum_{a_{2}=\\ a_{3}}^{A_{2}}\\sum_{a_{4}}^{A_{3}}\\sum_{b_{4}}^{B_{2}}\\sum_{b_{3}}^{B_{3}}\\sum_{b_{4}}^{2(a_{2}+b_{2})}\\sigma_{-}^{2(a_{2}-a_{2}-b_{2})}\\sigma_{+}^{3(a_{3}+b_{3})}\\sigma_{-}^{3(a_{3}-a_{3}-b_{3})}}&{}\\\\ {\\times\\sigma_{+}^{4(a_{4}+b_{4})}\\sigma_{-}^{4(d_{4}-a_{4}-b_{4})}\\left(\\ A_{2}\\right)\\left(A_{3}\\right)\\left(A_{4}\\right)\\frac{1}{2^{4/2}+\\lambda_{3}+A_{4}}}&{}\\\\ {=\\left(\\frac{\\sigma_{+}^{2}+\\sigma_{-}^{2}}{2}\\right)^{A_{2}}\\left(\\frac{\\sigma_{+}^{3}+\\sigma_{-}^{3}}{2}\\right)^{A_{3}}\\left(\\frac{\\sigma_{+}^{4}+\\sigma_{-}^{4}}{2}\\right)^{A_{4}}}&{}\\\\ {\\times\\displaystyle\\sum_{b_{2}=0}^{B_{2}}\\sigma_{+}^{2b_{2}}\\sigma_{-}^{2}\\frac{(B_{2}-b_{2})}{\\nu_{b3}-a_{3}}\\sigma_{+}^{3_{3}}\\sigma_{-}^{3(B_{3}-b_{3})}\\sum_{b_{4}=0}^{B_{4}}\\sigma_{+}^{4b_{4}}\\sigma_{-}^{4(B_{4}-b_{4})}}&{}\\\\ {\\leq\\left(\\frac{\\sigma_{+}^{2}+\\sigma_{-}^{2}}{2}\\right)^{d_{2}}\\left(\\frac{\\sigma_{+}^{3}+\\sigma_{-}^{3}}{2}\\right)^{d_{3}}\\left(\\frac{\\sigma_{+}^{4}+\\sigma_{+}^{4}}{2}\\right)^{d_{4}}2^{k+1},\\qquad\\qquad\\mathrm{()}}\\end{array}\n$$", "text_format": "latex", "page_idx": 45}, {"type": "text", "text": "where the last inequality holds because we can upper bound by multiplying a binomial coefficient $\\binom{B_{2}}{b_{2}}\\left(\\!\\!\\begin{array}{c}{{B_{3}}}\\\\ {{b_{3}}}\\end{array}\\!\\!\\right)\\binom{B_{4}}{b_{4}}$ and that $B_{2}+B_{3}+B_{4}=k+1$ . By the definition of $\\gamma_{2}$ and $\\gamma_{1}$ , ", "page_idx": 45}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\mathbb{E}\\left[g_{\\dot{U}}(\\sigma_{+},\\sigma_{-})\\mid\\mathcal{H}\\right]\\leq\\sigma_{\\mathrm{eff}}^{2d_{2}+3d_{3}+4d_{4}}\\gamma_{1}^{d_{3}}\\gamma_{2}^{d_{4}}2^{k+1}\\leq\\sigma_{\\mathrm{eff}}^{4N}\\gamma_{2}^{2(e_{L}+e_{M}+e_{N})}2^{k+1}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 45}, {"type": "text", "text": "The last inequality holds because $\\gamma_{1}<\\gamma_{2}$ and $d_{3}+d_{4}=e(K_{12})+e(K_{21})+e(K_{22})\\,\\le\\,2(e_{L}+$ $e_{M}+e_{N})$ . ", "page_idx": 45}, {"type": "text", "text": "Denote $\\mathcal{W}_{i j}(v,k)$ as the subset of ${\\mathcal{W}}_{i j}$ that contains all the elements that have exactly $v$ vertices except for $i$ and $j$ and excess $k$ . By applying the definition of union graph partitions, decorated graph weights, and (53), ", "page_idx": 45}, {"type": "equation", "text": "$$\n\\begin{array}{r l r}{\\lefteqn{\\mathrm{Var}[\\Phi_{i j}\\mathbf{1}_{\\mathcal{H}}]\\leq(1+o(1))\\sum_{k\\geq-1}\\sum_{v}(s p\\wedge s q)^{-2N+v+k+1}\\sum_{\\tilde{v}\\in\\mathcal{W}_{i j}(v,k)}\\rho^{e(K_{11})}w(\\dot{U}_{L})w(\\dot{U}_{M})w(\\dot{U}_{N})}}\\\\ &{}&{\\times\\,\\sigma_{\\mathrm{eff}}^{4N}\\gamma_{2}^{2(e_{L}+e_{M}+e_{L})}2^{k+1},}&{(59)}\\end{array}\n$$", "text_format": "latex", "page_idx": 45}, {"type": "text", "text": "For the $\\dot{U}_{L},\\dot{U}_{M},\\dot{U}_{N}$ partition, we define ", "page_idx": 45}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{P_{L}(v_{L},e_{L},\\ell):=\\displaystyle\\sum_{\\dot{U}_{L}\\in\\mathcal{U}_{L}(v_{L},e_{L},\\ell)}w(\\dot{U}_{L}),}\\\\ &{P_{M}(v_{M},e_{M}):=\\displaystyle\\sum_{\\dot{U}_{M}\\in\\mathcal{U}_{L}(v_{M},e_{M})}w(\\dot{U}_{M}),}\\\\ &{P_{N}(v_{N},e_{N},k):=\\displaystyle\\sum_{\\dot{U}_{N}\\in\\mathcal{U}_{N}(v_{N},e_{N})}w(\\dot{U}_{N}).}\\end{array}\n$$", "text_format": "latex", "page_idx": 45}, {"type": "text", "text": "Then, we can write out the upper bound as ", "page_idx": 46}, {"type": "equation", "text": "$$\n\\begin{array}{r l r}{\\lefteqn{\\mathrm{Var}[\\Phi_{i j}\\mathbf{1}_{\\mathcal{H}}]\\lesssim\\sum_{k}\\sum_{v}(s p\\wedge s q)^{-2N+v+k+1}\\sum_{v_{L},v_{M},v_{N}\\geq0}\\sum_{e_{L},e_{M},e_{N},\\ell\\geq0}\\sigma_{\\mathrm{eff}}^{4N}\\gamma_{2}^{2(e_{L}+e_{M}+e_{L})}2^{k+1}}}\\\\ &{}&{\\times\\,\\rho^{\\ell}P_{L}(v_{L},e_{L},\\ell)P_{M}(v_{M},e_{M})P_{N}(v_{N},e_{N},k).}\\end{array}\n$$", "text_format": "latex", "page_idx": 46}, {"type": "text", "text": "Applying Proposition 1, Lemma 18, Lemma 19, and Lemma 20, we can upper bound the variance by: ", "page_idx": 46}, {"type": "equation", "text": "$$\n\\begin{array}{r l r}{\\lefteqn{\\mathrm{Var}[\\Phi_{i j}\\mathbf{1}_{\\mathcal{H}}]\\lesssim\\sum_{k}\\sum_{v}(s p\\wedge s q)^{-2N+v+k+1}\\sum_{v_{i}\\ge0}\\sum_{e_{i},\\ell\\ge0}\\rho^{\\ell}(11\\beta n)^{v_{M}}R^{\\frac{4c_{M}}{M}}\\mathbf{1}_{\\left\\{v_{M}\\le e_{M}\\frac{4K+4M}{M}\\right\\}}}}\\\\ &{}&{\\quad\\times\\,\\sigma_{\\mathrm{eff}}^{4N}\\gamma_{2}^{2(e_{L}+e_{M}+e_{L})}\\times2n^{v_{L}}(1+2L^{2})^{e_{L}}f_{\\tilde{t},t}\\mathbf{1}_{\\left\\{K+M\\mid e_{L}+v_{L}\\right\\}}\\mathbf{1}_{\\left\\{v_{L}+e_{L}\\le2N\\right\\}}}\\\\ &{}&{\\quad\\times\\,n^{v_{N}}(11\\beta)^{v_{N}}(22R^{4}(v_{N}+1)^{2})^{k+1}\\mathbf{1}_{\\left\\{v_{N}\\le2(K+M)(k+1)\\right\\}}}\\end{array}\n$$", "text_format": "latex", "page_idx": 46}, {"type": "text", "text": "Note that $v_{M}\\,\\leq\\,e_{M}\\frac{4K\\!+\\!4M}{M}$ , we have $\\begin{array}{r}{\\sum_{v_{M}\\geq0}(11\\beta)^{v_{M}}\\le2(11\\beta)^{e_{M}}{\\frac{4K+4M}{M}}}\\end{array}$ . Also, we know that $v_{N}\\leq2N,v_{N}\\leq2(K+M)(k+1)$ . Then, $\\begin{array}{r}{\\bar{\\sum}_{v_{N}\\geq0}(11\\beta)^{v_{M}}\\leq2(11\\beta)^{2(K+M)(k+1)}}\\end{array}$ . Thus, ", "page_idx": 46}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathrm{Var}[\\Phi_{i j}\\mathbf{1}_{\\mathcal{H}}]\\lesssim\\underset{k,v}{\\sum_{\\iota}}(s p\\wedge s q)^{-2N+v+k+1}\\underset{e_{L}+e_{M}+e_{N}=2N-(v+k+1)}{\\sum_{\\iota}}2^{3}n^{v}\\,\\Big(R^{\\frac{4}{M}}\\big(11\\beta\\big)^{\\frac{4K+4M}{M}}\\Big)^{\\epsilon_{M}}}\\\\ &{\\qquad\\qquad\\quad\\times\\,\\big(22R^{4}(2N+1)(11\\beta)^{2(K+M)}\\big)^{k+1}\\big(1+2L^{2}\\big)^{\\epsilon_{L}}\\sigma_{\\mathrm{eff}}^{4N}\\,\\gamma_{2}^{2(e_{L}+e_{M}+e_{L})}}\\\\ &{\\qquad\\qquad\\quad\\times\\,\\underset{v_{L}\\geq0,l\\geq0}{\\sum_{\\iota}}\\Big(\\rho^{\\ell}f_{\\tilde{t}_{\\ell},\\mathbf{1}}\\mathbf{1}_{\\{K+M\\vert e_{L}+v_{L}\\}}\\mathbf{1}_{\\left\\{v_{L}+e_{L}\\leq2N\\right\\}}\\Big)\\,.}\\end{array}\n$$", "text_format": "latex", "page_idx": 46}, {"type": "text", "text": "Regarding to the Lemma 4 in [42], if \u03c12(K+M1)2(L|J |\u22122L) \u226412, then ", "page_idx": 46}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathrm{Var}[\\Phi_{i j}\\mathbf{1}_{\\mathcal{H}}]\\lesssim\\underset{k,\\nu}{\\sum_{\\substack{(s p)\\,(s\\,s\\,q)}^{\\alpha}>2^{N+v+k+1}}}\\underset{v_{L}+v_{M}+v_{N}+e_{L}+e_{M}+e_{N}=2N}{\\sum\\sum}2^{3}n^{v}\\left(R^{\\frac{4}{M}}(11\\beta)^{\\frac{4K+4M}{M}}\\right)^{e_{M}}}\\\\ &{\\qquad\\qquad\\qquad(22R^{4}(2N+1)(11\\beta)^{2(K+M)})^{k+1}(1+2L^{2})^{e_{L}}\\sigma_{\\mathrm{eff}}^{4N}\\gamma_{2}^{2(e_{L}+e_{M}+e_{N})}}\\\\ &{\\qquad\\qquad8\\rho^{2N}\\left(\\rho^{-2e_{L}}\\mathbf{1}_{e_{L}\\not=0}+\\frac{12L^{2}}{\\rho^{2(K+M)}|\\mathcal{I}|}\\mathbf{1}_{e_{L}=0}\\right)|\\mathcal{T}|^{2}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 46}, {"type": "text", "text": "Note that \u03c12(K+M1)2(L|2J |\u22122L) \u2264 12 is guaranteed by the first condition in (22) \u03c12(K1+4ML)(|J |) \u2264 12 for large enough $n$ . ", "page_idx": 46}, {"type": "text", "text": "In the following step, we divide $\\mathrm{Var}[\\Phi_{i j}{\\bf1}_{\\mathcal{H}}]$ by $\\mathbb{E}[\\Phi_{i\\pi_{*}(i)}\\mathbf{1}_{\\mathcal{H}}]^{2}$ and use the fact that $e_{N}=2N-(v+$ $k+1+e_{L}+e_{M})$ : ", "page_idx": 46}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\frac{\\mathrm{Var}[\\Phi_{i j}\\mathbf{1}_{H}]}{\\mathbb{E}[\\Phi_{i\\tau_{*}(i)}\\mathbf{1}_{H}]^{2}}\\leq(1+o(1))2^{6}\\sigma_{\\mathrm{eff}}^{4N-4N}\\sum_{k\\geq-1}\\left(\\frac{22R^{4}(2N+1)(11)\\beta^{2(K+M)}}{n}\\right)^{k+1}}\\\\ &{\\qquad\\qquad\\qquad\\sum_{\\epsilon\\in\\mathcal{B}}\\left(\\gamma_{2}^{2}\\frac{R^{\\frac{4}{2}}(11\\beta)^{\\frac{4K+4M}{M}}}{n s(p\\wedge q)}\\right)^{\\epsilon_{M}}}\\\\ &{\\qquad\\qquad\\qquad\\sum_{\\epsilon\\in\\mathcal{B}}\\left(\\gamma_{2}^{2}\\frac{1+2L^{2}}{n s(p\\wedge q)}\\right)^{\\epsilon_{L}}\\left(\\rho^{-2\\epsilon_{L}}\\mathbf{1}_{\\{\\epsilon_{L}>0\\}}+\\frac{12L^{2}}{\\rho^{2(K+M)}|\\mathcal{I}|}\\mathbf{1}_{\\{\\epsilon_{L}=0\\}}\\right)}\\\\ &{\\qquad\\qquad\\underset{\\epsilon\\in\\mathcal{B}}{\\sum N}\\left(\\gamma_{2}^{2}(\\frac{n}{s p\\wedge s q})\\right)^{2N-(v+k+1+e_{L}+\\epsilon_{M})}\\mathbf{1}_{\\{\\epsilon_{L}+e_{M}\\leq2N-(\\epsilon+k+1)\\}}}\\end{array}\n$$", "text_format": "latex", "page_idx": 46}, {"type": "text", "text": "In view of $\\gamma_{2}<2$ , the last three conditions in (22) guarantee that ", "page_idx": 46}, {"type": "equation", "text": "$$\n\\begin{array}{l}{\\displaystyle\\sum_{k\\geq-1}\\left(\\frac{22R^{4}(2N+1)(11\\beta)^{2(K+M)}}{n}\\right)^{k+1}\\leq2,}\\\\ {\\displaystyle\\sum_{e_{M}\\geq0}\\left(\\gamma_{2}^{2}\\frac{R^{\\frac{4}{M}}\\left(11\\beta\\right)^{\\frac{4K+4M}{M}}}{n s\\left(p\\wedge q\\right)}\\right)^{e_{M}}\\leq2,}&{\\displaystyle\\sum_{e_{L}\\geq0}\\left(\\gamma_{2}^{2}\\frac{1+2L^{2}}{n s\\left(p\\wedge q\\right)}\\right)^{e_{L}}\\leq2.}\\end{array}\n$$", "text_format": "latex", "page_idx": 46}, {"type": "text", "text": "Also, for sufficiently large n,ns(\u03b3p2q) $\\begin{array}{r}{\\frac{\\gamma_{2}^{2}}{n s(p\\wedge q)}\\leq\\frac{1}{2}}\\end{array}$ 1, such that ", "page_idx": 47}, {"type": "equation", "text": "$$\n\\sum_{v=0}^{2N-k-1}(\\frac{\\gamma_{2}^{2}}{n s(p\\wedge q)})^{2N-(v+k+1+e_{L}+e_{M})}\\leq2.\n$$", "text_format": "latex", "page_idx": 47}, {"type": "text", "text": "In conclusion, ", "page_idx": 47}, {"type": "equation", "text": "$$\n\\frac{\\mathrm{Var}[\\Phi_{i j}\\mathbf{1}_{\\mathcal{H}}]}{\\mathbb{E}[\\Phi_{i\\pi_{*}(i)}\\mathbf{1}_{\\mathcal{H}}]^{2}}\\le O\\left(\\frac{\\gamma_{2}^{2}(2+4L^{2})}{\\rho^{2}n s(p\\wedge q)}+\\frac{12L^{2}}{\\rho^{2(K+M)}|\\mathcal{I}|}\\right)=O\\left(\\frac{L^{2}}{\\rho^{2}n s(p\\wedge q)}+\\frac{L^{2}}{\\rho^{2(K+M)}|\\mathcal{I}|}\\right).\n$$", "text_format": "latex", "page_idx": 47}, {"type": "text", "text": "I.3 Proof of auxiliary Lemmas ", "text_level": 1, "page_idx": 47}, {"type": "text", "text": "To complete the proof of Proposition 2, it remains to prove Lemma 18, Lemma 19, and Lemma 20.   \nIn this case, those upper bounds have been shown in [42]. We briefly re-state the proof idea. ", "page_idx": 47}, {"type": "text", "text": "Lemma 18 (Upper bound of $P_{L}(v_{L},e_{L},\\ell)$ (True pairs: $j=\\pi_{*}(i),s D_{+}(a,b)>1)\\nonumber$ ). ", "page_idx": 47}, {"type": "equation", "text": "$$\nP_{L}(v_{L},e_{L},\\ell)\\leq(1+o(1))2n^{v_{L}}(1+2L^{2})^{e_{L}}f_{\\tilde{t},t}{\\mathbf{1}}_{\\{K+M|e_{L}+v_{L}\\}}{\\mathbf{1}}_{\\{v_{L}+e_{L}\\leq2N\\}}.\n$$", "text_format": "latex", "page_idx": 47}, {"type": "text", "text": "Proof of Lemma 18. Firstly, we define unlabeled union graph class $\\widetilde{\\mathcal{U}}(v_{L},e_{L},\\ell)$ and set of labeled union graphs isomorphic to $\\dot{U}_{L}\\in\\widetilde{\\mathcal{U}}(v_{L},e_{L},\\ell)$ as $\\dot{H}(\\dot{U}_{L})$ . ", "page_idx": 47}, {"type": "equation", "text": "$$\nP_{L}(v_{L},e_{L},\\ell)=\\sum_{\\dot{U}_{L}\\in\\mathcal{U}_{L}(v_{L},e_{L},\\ell)}w(\\dot{U}_{L})=\\sum_{\\dot{U}_{L}\\in\\widetilde{\\mathcal{U}}_{L}(v_{L},e_{L},\\ell)}w(\\dot{U}_{L})|H(\\dot{U}_{L})|.\n$$", "text_format": "latex", "page_idx": 47}, {"type": "text", "text": "The number of ways to label $\\dot{U}_{L}$ is $\\begin{array}{r}{|H(\\dot{U}_{L})|\\leq\\binom{n}{v_{L}}\\frac{v_{L}!}{\\mathrm{aut}(\\dot{U}_{L})}\\leq\\frac{n^{v_{L}}}{\\mathrm{aut}(\\dot{U}_{L})}}\\end{array}$ \u2264aunt(v U\u02d9LL), vnL vL! \u2264nvL. In addition, $w(\\dot{U}_{L})\\leq\\mathrm{aut}(\\dot{U}_{L})$ . This is true because every bulbs are exactly 2-decorated so for the union graph, the automorphism number coming from the orbits in this bulb is the same as the weights of this bulb. However, there can be other orbits outside the bulbs, for example, some bulbs are isomorphic so the vertices on the wires can be in the same orbit, thereby increasing the automorphism number. ", "page_idx": 47}, {"type": "text", "text": "From Lemma 7 in [42], we know that ", "page_idx": 47}, {"type": "equation", "text": "$$\n|\\widetilde{\\mathcal{U}}_{L}(v_{L},e_{L},l)|\\leq2(1+2L^{2})^{e_{L}}f_{\\widetilde{t},t}\\mathbf{1}_{\\left\\{K+M|e_{L}+v_{L}\\right\\}}\\mathbf{1}_{\\left\\{v_{L}+e_{L}\\leq2N\\right\\}},\n$$", "text_format": "latex", "page_idx": 47}, {"type": "text", "text": "where $f_{\\widetilde{t},t}$ counts the possible structures of chandeliers before merging edges to form a union graph and $\\widetilde{t}$ is depending on $\\ell$ . ", "page_idx": 47}, {"type": "text", "text": "Combining these pieces together, we derived the upper bound: ", "page_idx": 47}, {"type": "equation", "text": "$$\nP_{L}(v_{L},e_{L},\\ell)\\leq2n^{v_{L}}(1+2L^{2})^{e_{L}}f_{\\tilde{t},t}{\\mathbf{1}}_{\\{K+M|e_{L}+v_{L}\\}}{\\mathbf{1}}_{\\{v_{L}+e_{L}\\leq2N\\}}.\n$$", "text_format": "latex", "page_idx": 47}, {"type": "text", "text": "See Lemma 3 in [42] for more detailed discussion on $t,\\widetilde{t}$ and $f_{\\widetilde{t},t}$ ", "page_idx": 47}, {"type": "text", "text": "Lemma 19 (Upper bound of $P_{M}(v_{M},e_{M})$ (True pairs: $j=\\pi_{*}(i),s D_{+}(a,b)>1))$ . ", "page_idx": 47}, {"type": "equation", "text": "$$\n\\begin{array}{r}{P_{M}(v_{M},e_{M})\\le(11\\beta n)^{v_{M}}R^{\\frac{4e_{M}}{M}}\\sigma_{\\mathrm{eff}}^{2v_{M}+2e_{M}}\\gamma_{2}^{e_{M}}\\mathbf{1}_{\\left\\{v_{M}\\le e_{M}\\frac{4K+4M}{M}\\right\\}}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 47}, {"type": "text", "text": "Proof. We have $|{\\cal N}_{M}|{\\cal M}\\le2e_{M}$ because each connected component $\\dot{\\mathcal{G}}(\\boldsymbol{i},\\boldsymbol{a})$ contains at least $M$ edges that are 3 or 4-decorated and $\\mathcal{N}_{M}$ is the number of neighbors $a$ in this set. This gives the constraint on $\\begin{array}{r}{v_{M}\\,\\leq\\,\\frac{2e_{M}}{M}(2K+2M)}\\end{array}$ and from the definition of $\\begin{array}{r}{\\prime(\\cdot),\\,w(\\dot{U}_{M})\\le R^{2|{\\mathcal N}_{M}|}\\le R^{\\frac{4\\epsilon_{M}}{M}}}\\end{array}$ . Define $\\widetilde{\\mathcal{U}}_{M}(v_{M},e_{M})$ as the unlabeled union graph class and $\\dot{H}(\\dot{U}_{M})$ as the set of labeled $\\dot{U}_{M}$ for $\\dot{U}_{M}\\in\\tilde{\\mathcal{U}}_{M}(v_{M},e_{M})$ . ", "page_idx": 47}, {"type": "equation", "text": "$$\nP_{M}(v_{M},e_{M})=\\sum_{\\dot{U}_{M}\\in\\mathcal{U}_{M}(v_{M},e_{M})}w(\\dot{U}_{M})\\le R^{\\frac{4e_{M}}{M}}\\sum_{\\dot{U}_{M}\\in\\widetilde{\\mathcal{U}}_{M}(v_{M},e_{M})}|H(\\dot{U}_{M})|.\n$$", "text_format": "latex", "page_idx": 47}, {"type": "text", "text": "We have $|H(\\dot{U}_{M})|\\,\\leq\\,(n)^{v_{M}}$ . There are at most $\\beta^{v_{M}}$ rooted unlabeled undercoated trees, where \u03b2 =(1+o(1))\u03b1 [56] and at most $11^{v_{M}}$ decorations for each tree. Thus, $|\\widetilde{\\mathcal{U}}_{M}(v_{M},e_{M})|\\le(11\\beta)^{v_{M}}$ . Finally, we obtain that ", "page_idx": 47}, {"type": "equation", "text": "$$\n\\begin{array}{r}{P_{M}(v_{M},e_{M})\\le(11\\beta n)^{v_{M}}R^{\\frac{4e_{M}}{M}}{\\bf1}_{\\left\\{v_{M}\\leq(2K+2M)\\frac{2e_{M}}{M}\\right\\}}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 47}, {"type": "text", "text": "Lemma 20 (Upper bound of $P_{N}(v_{N},e_{N},k)$ (True pairs: $j=\\pi_{*}(i),s D_{+}(a,b)>1)$ ). ", "page_idx": 48}, {"type": "equation", "text": "$$\nP_{N}(v_{N},e_{N},k)\\leq n^{v_{N}}(11\\beta)^{v_{N}}(11R^{4}(v_{N}+1)^{2})^{k+1}\\mathbf{1}_{\\left\\{v_{N}\\leq2(K+M)(2k+2)\\right\\}}.\n$$", "text_format": "latex", "page_idx": 48}, {"type": "text", "text": "Proof. From Lemma 2 in [42], we know that $|{\\mathcal N}_{N}|\\le2k+2$ and thus $w(\\dot{U}_{N})\\leq R^{|{\\mathcal{N}}_{N}|}\\leq R^{4(K+1)}$ . Briefly, this is because the excess is $k$ and whenever two branches tangle with each other, the excess of this graph increases by one. To maximally involving branches in this $k+1$ times of branch tangles, we never re-tangle a branch after it has tangled with the other branch. In this way, we see that there are at most $2(k+1)$ branches in $\\dot{U}_{N}$ . This immediately gives the condition of $v_{N}\\leq(2k+2)(M+K)$ . Define $\\widetilde{\\mathcal{U}}_{N}(v_{N},e_{N},k)$ as the unlabeled union graph class and $\\dot{H}(\\dot{U}_{N})$ as the set of labeled $\\dot{U}_{N}$ for $\\dot{U}_{N}\\in\\tilde{\\mathcal{U}}_{N}(v_{N},e_{N},k)$ . ", "page_idx": 48}, {"type": "equation", "text": "$$\nP_{N}(v_{N},e_{N},k)=\\sum_{\\dot{U}_{N}\\in\\mathcal{U}_{N}(v_{N},e_{N},k)}w(\\dot{U}_{N})\\le R^{4(k+1)}\\sum_{\\dot{U}_{N}\\in\\widetilde{\\mathcal{U}}_{N}(v_{N},e_{N},k)}|H(\\dot{U}_{N})|.\n$$", "text_format": "latex", "page_idx": 48}, {"type": "text", "text": "$\\dot{U}_{L}$ consists of a tree with $v_{N}$ vertices and additional $k+1$ edges connecting vertices on the tree.   \nWhat\u2019s more, each edge can be associated with at most 11 possible decoration sets. ", "page_idx": 48}, {"type": "equation", "text": "$$\n|\\widetilde{\\mathcal{U}}_{N}(v_{N},e_{N},k)|\\leq\\beta^{v_{N}}\\binom{\\binom{v_{N}+1}{2}}{k+1}11^{v_{N}+k+1}\\leq(11\\beta)^{v_{N}}(11(v_{N}+1)^{2})^{(k+1)}.\n$$", "text_format": "latex", "page_idx": 48}, {"type": "text", "text": "Therefore, ", "page_idx": 48}, {"type": "equation", "text": "$$\nP_{N}(v_{N},e_{N},k)\\leq n^{v_{N}}(11\\beta)^{v_{N}}(11R^{4}(v_{N}+1)^{2})^{k+1}\\mathbf{1}_{\\left\\{v_{N}\\leq2(K+M)(2k+2)\\right\\}}.\n$$", "text_format": "latex", "page_idx": 48}, {"type": "text", "text": "J Proof of Proposition 3 ", "text_level": 1, "page_idx": 48}, {"type": "text", "text": "In this section, we show the Proposition 3 to complete the analysis on variance of similarity score. In this case, as $j\\neq\\pi_{*}(i)$ , the decorated union graph structure is different from the case when $j=\\pi_{*}(i)$ because the roots of $S_{1}$ and $S_{2}$ are different on the complete graph. ", "page_idx": 48}, {"type": "text", "text": "J.1 Graph partition ", "text_level": 1, "page_idx": 48}, {"type": "text", "text": "The definitions in Section I still apply, except that we need to re-define the union graph partition. ", "page_idx": 48}, {"type": "text", "text": "\u2022 (Union graph partition) We first decompose $\\dot{U}$ into three edge-disjoint subgraphs. Specifically, for any neighbor $a$ of $i$ in $\\dot{U}$ , consider the graph $\\dot{U}$ with the edge $(i,a)$ removed and let $\\dot{\\mathcal{C}}(i,a)$ be the connected component that contains $a$ . Denote $\\dot{\\mathcal{G}}(\\boldsymbol{i},\\boldsymbol{a})$ as the union of $\\dot{\\mathcal{C}}(i,a)$ and the edge $(i,a)$ . Let ", "page_idx": 48}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\mathcal{N}_{T}(i)=\\{a:D_{U}((i,a))\\cap\\{S_{1},T_{1}\\}\\neq\\emptyset,\\dot{\\mathcal{G}}(i,a)\\,\\mathrm{in}\\}}\\\\ {\\mathcal{N}_{N}(i)=\\{a:D_{U}((i,a))\\cap\\{S_{1},T_{1}\\}\\neq\\emptyset\\}\\setminus\\mathcal{N}_{T}(i)}\\end{array}\n$$", "text_format": "latex", "page_idx": 48}, {"type": "text", "text": "Symmetrically, let ", "page_idx": 48}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathcal{N}_{T}(j)=\\{a:D_{U}((j,a))\\cap\\{S_{2},T_{2}\\}\\neq\\emptyset,\\dot{\\mathcal{G}}(j,a)\\mathrm{~is~a~tree~not~containing~}i\\},}\\\\ &{\\mathcal{N}_{N}(j)=\\{a:D_{U}((j,a))\\cap\\{S_{2},T_{2}\\}\\neq\\emptyset\\}\\setminus\\mathcal{N}_{T}(j).}\\end{array}\n$$", "text_format": "latex", "page_idx": 48}, {"type": "text", "text": "Next, we further decompose $\\dot{U}_{T}(i)$ into two edge-disjoint subtrees and similarly for $\\dot{U}_{T}(j)$ . In particular, define ", "page_idx": 48}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{N_{M}(i)=\\{a\\in\\ensuremath{\\mathcal{N}}_{T}(i):|\\{e\\in E(\\dot{\\mathcal{G}}(i,a)):|D_{e}|\\geq3\\}|\\geq M\\},}\\\\ &{N_{L}(i)=\\ensuremath{\\mathcal{N}}_{T}(i)\\setminus\\ensuremath{\\mathcal{N}}_{M}(i).}\\end{array}\n$$", "text_format": "latex", "page_idx": 48}, {"type": "text", "text": "Then, we decompose $\\dot{U}$ according to the node set $\\mathcal{N}$ into two tree-parts on root $i$ (resp. $j$ ): ", "page_idx": 48}, {"type": "equation", "text": "$$\n\\dot{U}_{L}(i):=\\bigcup_{a\\in\\mathcal{N}_{L}(i)}\\dot{\\mathcal{G}}(i,a),\\quad\\dot{U}_{M}(i):=\\bigcup_{a\\in\\mathcal{N}_{M}(i)}\\dot{\\mathcal{G}}(i,a).\n$$", "text_format": "latex", "page_idx": 48}, {"type": "text", "text": "and the non-tree part ", "page_idx": 49}, {"type": "equation", "text": "$$\n\\dot{U}_{N}:=\\dot{U}\\setminus(\\dot{U}_{L}(i)\\cup\\dot{U}_{M}(i)\\cup\\dot{U}_{L}(j)\\cup\\dot{U}_{M}(j)).\n$$", "text_format": "latex", "page_idx": 49}, {"type": "text", "text": "For convenience, we denote ", "page_idx": 49}, {"type": "equation", "text": "$$\n\\dot{U}_{L}:=\\dot{U}_{L}(i)\\cup\\dot{U}_{L}(j),\\quad\\dot{U}_{M}:=\\dot{U}_{M}(i)\\cup\\dot{U}_{M}(j).\n$$", "text_format": "latex", "page_idx": 49}, {"type": "text", "text": "We again assign weights to each of these decorated union graph partitions. ", "page_idx": 49}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{w(\\dot{U}_{L}):=w_{S_{1}}(\\dot{U}_{L}(i))w_{T_{1}}(\\dot{U}_{L}(i))w_{S_{2}}(\\dot{U}_{L}(j))w_{T_{2}}(\\dot{U}_{L}(j)),}\\\\ &{w(\\dot{U}_{M}):=w_{S_{1}}(\\dot{U}_{M}(i))w_{T_{1}}(\\dot{U}_{M}(i))w_{S_{2}}(\\dot{U}_{M}(j))w_{T_{2}}(\\dot{U}_{M}(j)),}\\\\ &{w(\\dot{U}_{N}):=w_{S_{1}}(\\dot{U}\\setminus\\dot{U}_{T}(i))w_{T_{1}}(\\dot{U}\\setminus\\dot{U}_{T}(i))w_{S_{2}}(\\dot{U}\\setminus\\dot{U}_{T}(j))w_{T_{2}}(\\dot{U}\\setminus\\dot{U}_{T}(j)).}\\end{array}\n$$", "text_format": "latex", "page_idx": 49}, {"type": "text", "text": "J.2 Proof of the Proposition ", "text_level": 1, "page_idx": 49}, {"type": "text", "text": "Proof of Proposition 3. In the case of $j\\neq\\pi_{*}(i)$ , the excess $k$ of the union graph starts from $-2$ This is because the minimum number of edges of a decorated union graph for $j\\neq\\pi_{*}(i)$ with $v$ vertices except for $i$ and $j$ is $v$ , when $S_{1},T_{1}$ and $S_{2},T_{2}$ form two disjoint trees rooted at $i$ and $j$ respectively. Therefore, $k\\geq v-v(\\dot{U})=-2$ . ", "page_idx": 49}, {"type": "text", "text": "The proof of Proposition 2 in Section I holds for $j\\neq\\pi_{*}(i)$ until (59), which holds with placing $k+1$ with $k+2$ . This is because the decorated union graph can be viewed as two disjoint trees with $v+2$ vertices plus $k+2$ edges connecting vertices on these two trees. We have, ", "page_idx": 49}, {"type": "equation", "text": "$$\n\\mathrm{Var}[\\Phi_{i j}\\mathbf{1}_{\\mathcal{H}}]\\leq(1+o(1))\\sum_{k\\geq-2}\\sum_{v=0}^{2N-k-2}(s p\\wedge s q)^{-2N+v+k+2}\\sum_{\\dot{U}\\in\\mathcal{W}_{i j}(v,k)}\\rho^{e(K_{11})}\\mathrm{aut}(H)\\mathrm{aut}(I)\n$$", "text_format": "latex", "page_idx": 49}, {"type": "equation", "text": "$\\begin{array}{r}{P_{i j}(v,k):=\\sum_{\\dot{U}\\in\\mathcal{W}_{i j}(v,k)}\\rho^{e(K_{11})}\\mathrm{aut}(H)\\mathrm{aut}(I)\\gamma_{2}^{e(K_{12})+e(K_{21})+e(K_{22})}.}\\end{array}$ ", "text_format": "latex", "page_idx": 49}, {"type": "equation", "text": "$$\n\\mathrm{Var}[\\Phi_{i j}\\mathbf{1}_{\\mathcal{H}}]\\leq(1+o(1))\\sum_{k\\geq-2}\\sum_{v=0}^{2N-k-2}(s p\\wedge s q)^{-2N+v+k+2}\\sigma_{\\mathrm{eff}}^{4N}2^{k+2}P_{i j}(v,k)\n$$", "text_format": "latex", "page_idx": 49}, {"type": "text", "text": "Case a: $k=-2$ . We first consider the special case when $k=-2$ . When $k=-2$ , there are two disjoint trees in the decorated union graph. Then, it must be the case of $S_{1}=T_{1},S_{2}=T_{2},v=2N$ , and $H=I$ . Therefore, $e(K_{12})=e(\\bar{K}_{21})=e(K_{22})=0$ . We have, ", "page_idx": 49}, {"type": "equation", "text": "$$\nP_{i j}(2N,-2)\\le\\sum_{H\\in{\\cal{T}}}\\mathrm{aut}(H)^{2}|S_{1}(i):S_{1}\\cong H||S_{2}(j):S_{2}\\cong H|=|{\\cal{T}}|n^{2N}.\n$$", "text_format": "latex", "page_idx": 49}, {"type": "text", "text": "Under this parameterization, $-2N+v+k+2$ is also zero, we have ", "page_idx": 49}, {"type": "equation", "text": "$$\n/\\mathrm{ar}[\\Phi_{i j}\\mathbf{1}_{\\mathcal{H}}]\\le(1+o(1))\\left(|\\mathcal{T}|n^{2N}\\sigma_{\\mathrm{eff}}^{4N}+\\sum_{k>-2}\\sum_{v=0}^{2N-k-2}(s p\\wedge s q)^{-2N+v+k+2}\\sigma_{\\mathrm{eff}}^{4N}2^{k+2}P_{i j}(v,k)\\right).\n$$", "text_format": "latex", "page_idx": 49}, {"type": "text", "text": "It turns out that the summation over $k>-2$ would have the same order as the first special case. ", "page_idx": 49}, {"type": "text", "text": "Case b: $k>-2$ . We enumerate through three parts of the union graph. Recall that $e(K_{12})+$ $e(K_{21})+e(K_{22})\\leq2(e_{L}+e_{M}+e_{N})=\\bar{4}N-2\\bar{(}v+k+2)$ , therefore ", "page_idx": 49}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{P_{i j}(v,k)\\le\\displaystyle\\sum_{e_{M}}\\sum_{v_{L},v_{M},v_{N}}\\sum_{\\bar{U}\\in\\mathcal{W}(v,k)}w(\\dot{U}_{L})w(\\dot{U}_{M})w(\\dot{U}_{N})\\gamma_{2}^{e(K_{12})+e(K_{21})+e(K_{22})}}\\\\ &{\\qquad\\qquad\\le\\displaystyle\\sum_{e_{M}}\\gamma_{2}^{4N-2(v+k+2)}\\sum_{v_{L},v_{M},v_{N}}P_{L}(v_{L})P_{M}(v_{M},e_{M})P_{N}(v_{N},k),}\\end{array}\n$$", "text_format": "latex", "page_idx": 49}, {"type": "text", "text": "where $P_{M}(v_{M},e_{M})$ is defined as before, while we let $P_{L}(v_{L})$ and $P_{N}(v_{N},k)$ have no constraints on the number of 3 and 4-decorated edges for $\\dot{U}_{L}$ and $\\dot{U}_{N}$ . ", "page_idx": 49}, {"type": "text", "text": "We can plug those upper bounds from Lemma 21, Lemma 22, and Lemma 23 into (69): ", "page_idx": 50}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{P_{i j}(v,k)\\le\\displaystyle\\sum_{e_{M}}R^{2\\frac{e_{M}}{M}}n^{v}|T|4^{L}L^{2L\\wedge(4K+2)}(6\\beta)^{4(K+M)-2}{\\bf1}_{\\{e_{M}\\le2N-(v+k+2)\\}}}\\\\ &{\\qquad\\qquad\\times\\displaystyle\\sum_{v_{L}+v_{M}+v_{N}=v}v_{M}(11\\beta)^{v_{M}}\\beta(11\\beta)^{v_{N}}(22R^{4}(v_{N}+2)^{2})^{k+2}\\sigma_{\\mathrm{eff}}^{4N}\\gamma_{2}^{4N-2(v+k+2)}}\\\\ &{\\qquad\\qquad\\times\\mathbf{1}_{\\{v_{M}\\le2(K+M)\\frac{2e_{M}}{M}\\}}\\mathbf{1}_{\\{v_{N}\\le4(K+M)(k+2)\\}}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 50}, {"type": "text", "text": "Note that $v_{M},v_{N}\\,\\leq\\,v\\,\\leq\\,2N-k-2\\,\\leq\\,2N+1$ as $k\\ge-1$ . Therefore $v_{M}(v_{N}+2)^{2(k+2)}\\ \\leq$ $(2N\\!+\\!1)^{3(k\\!+\\!2)}$ . Applying $e_{M}\\leq2N\\!-\\!(v\\!+\\!k\\!+\\!2),v_{N}\\leq4(K\\!+\\!M)(k\\!+\\!2)$ and $\\begin{array}{r}{v_{M}\\le2(K\\!+\\!M)\\frac{e_{M}}{M}}\\end{array}$ we can get the following upper bound: ", "page_idx": 50}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\frac{\\mathrm{Var}[\\Phi_{i j}\\mathbf{1}_{\\mathcal{H}}]}{\\mathbb{E}[\\Phi_{i\\pi_{*}(i)}\\mathbf{1}_{\\mathcal{H}}]^{2}}\\le(1+o(1))\\frac{1}{|T|\\rho^{2N}}+(1+o(1))\\frac{1}{|T|\\rho^{2N}}\\Bigg\\{4^{L}L^{2L\\wedge(4K+2)}(6\\beta)^{4K+4M}}\\\\ &{\\qquad\\qquad\\qquad\\quad\\times\\displaystyle\\sum_{k\\geq-1}\\left(\\frac{(11\\beta)^{4(K+M)}22R^{4}(2N+1)^{3}}{n}\\right)^{k+2}}\\\\ &{\\qquad\\qquad\\qquad\\quad\\times\\displaystyle\\sum_{v=0}^{2N-k-2}\\left(\\gamma_{2}^{2}\\frac{R^{\\frac{2}{M}}(11\\beta)^{\\frac{4(K+M)}{M}}}{n s(p\\wedge q)}\\right)^{2N-(v+k+2)}\\Bigg\\}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 50}, {"type": "text", "text": "From the first condition in (23), because $\\gamma_{2}<2$ , we have ", "page_idx": 50}, {"type": "equation", "text": "$$\n\\sum_{v=0}^{2N-k-2}\\left(\\gamma_{2}^{2}\\frac{R^{\\frac{2}{M}}(11\\beta)^{\\frac{4(K+M)}{M}}}{n s(p\\wedge q)}\\right)^{2N-(v+k+2)}\\leq2.\n$$", "text_format": "latex", "page_idx": 50}, {"type": "text", "text": "From the second condition in (23), we have $\\begin{array}{r}{\\frac{(11\\beta)^{4(K+M)}22R^{4}(2N+1)^{3}}{n}\\leq\\frac{1}{2}}\\end{array}$ , therefore, ", "page_idx": 50}, {"type": "equation", "text": "$$\n\\sum_{k\\geq-1}\\left(\\frac{(11\\beta)^{4(K+M)}22R^{4}(2N+1)^{3}}{n}\\right)^{k+2}\\leq2\\left(\\frac{(11\\beta)^{4(K+M)}22R^{4}(2N+1)^{3}}{n}\\right).\n$$", "text_format": "latex", "page_idx": 50}, {"type": "text", "text": "From the second condition in (23), we know that ", "page_idx": 50}, {"type": "equation", "text": "$$\n4^{L}L^{2L\\wedge(4K+2)}(6\\beta)^{4K+4M}2^{2}\\left(\\frac{(11\\beta)^{4(K+M)}22R^{4}(2N+1)^{3}}{n}\\right)\\leq\\frac{1}{2}.\n$$", "text_format": "latex", "page_idx": 50}, {"type": "text", "text": "In summary, ", "page_idx": 50}, {"type": "equation", "text": "$$\n\\frac{\\mathrm{Var}[\\Phi_{i j}{\\bf1}_{\\mathcal{H}}]}{\\mathbb{E}[\\Phi_{i\\pi_{*}(i)}{\\bf1}_{\\mathcal{H}}]^{2}}=O(\\frac{1}{|{\\mathcal{T}}|\\rho^{2N}}).\n$$", "text_format": "latex", "page_idx": 50}, {"type": "text", "text": "J.3 Proof of auxiliary Lemmas ", "text_level": 1, "page_idx": 50}, {"type": "text", "text": "The following Lemma 21, Lemma 22, and Lemma 23, have been shown by Mao et al. [42]. We briefly re-state those results for completeness. ", "page_idx": 50}, {"type": "text", "text": "Lemma 21 (Upper bound of $P_{L}(v_{L})$ (Fake pairs: $j\\neq\\pi_{*}(i),s D_{+}(a,b)>1)\\rangle$ ). ", "page_idx": 50}, {"type": "equation", "text": "$$\nP_{L}(v_{L})\\leq n^{v_{L}}|\\mathcal{T}|4^{L}L^{2L\\wedge(4K+2)}(6\\beta)^{4(K+M)-2}.\n$$", "text_format": "latex", "page_idx": 50}, {"type": "text", "text": "Proof. Firstly, we introduce unlabeled union graph sets $\\tilde{\\mathcal{U}}(v_{L},e_{L})$ and the set of labeled isomorphic members as $\\dot{H}(\\dot{U}_{L})$ , for $\\dot{U}_{L}\\in\\mathcal{U}(v_{L},e_{L},l)$ . From definition (60), ", "page_idx": 50}, {"type": "equation", "text": "$$\nP_{L}(v_{L})=\\sum_{\\dot{U}_{L}\\in\\mathcal{U}_{L}(v_{L})}w(\\dot{U}_{L})=\\sum_{\\dot{U}_{L}\\in\\widetilde{\\mathcal{U}}_{L}(v_{L})}w(\\dot{U}_{L})|H(\\dot{U}_{L})|.\n$$", "text_format": "latex", "page_idx": 50}, {"type": "text", "text": "As we have repeatedly seen, $\\begin{array}{r}{|H(\\dot{U}_{L})|\\,\\leq\\,\\frac{n^{v_{L}}}{\\mathrm{aut}(\\dot{U}_{L})}}\\end{array}$ . From the Lemma 10 and Claim 5-(v) in [42] we have the following takeaways: (1) $|\\widetilde{\\mathcal{U}}_{L}(v_{L})|\\le|{\\mathcal{T}}||4^{L}L^{2L\\wedge(4K+2)}(6\\beta)^{4(K+M)-2}$ ; (2) $w(\\dot{U}_{L})\\leq$ $\\mathrm{aut}(\\dot{U}_{L}(i))\\mathrm{aut}(\\dot{U}_{L}(j))=\\mathrm{aut}(\\dot{U}_{L})$ . Putting pieces together, we complete the proof. \u53e3 ", "page_idx": 50}, {"type": "text", "text": "Lemma 22 (Upper bound of $P_{M}(v_{M},e_{M})$ (Fake pairs: $j\\neq\\pi_{*}(i))$ )). ", "page_idx": 51}, {"type": "equation", "text": "$$\n\\begin{array}{r}{P_{M}(v_{M},e_{M})\\le v_{M}R^{\\frac{2e_{M}}{M}}n^{v_{M}}(11\\beta)^{v_{M}}\\mathbf{1}_{\\left\\{e_{M}\\leq2N-(v+k+2)\\right\\}}\\mathbf{1}_{\\left\\{v_{M}\\leq2(K+M)^{\\frac{2e_{M}}{M}}\\right\\}}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 51}, {"type": "text", "text": "Proof. Define $\\widetilde{\\mathcal{U}}_{N}(v_{M},e_{M})$ as the collection of unlabeled decorated union graphs and $|H(\\dot{U}_{M})|$ be the set of labeled isomorphic members for each $\\dot{U}_{M}\\in\\widetilde{\\mathcal{U}}_{N}(v_{M},e_{M})$ . ", "page_idx": 51}, {"type": "text", "text": "In $\\dot{U}_{M}$ , there are $2e_{M}$ edges that are 3 or 4-decorated. Since for each branch connecting to the root, there are at least $M$ edges on it being at least 3-decorated, $\\begin{array}{r}{|{\\mathcal{N}}_{M}(i)|+|{\\mathcal{N}}_{M}(j)|\\leq2\\frac{e_{M}{\\bar{\\mathcal{A}}}}{M}}\\end{array}$ . Thus, this directly gives $w(\\dot{U}_{M})\\leq R^{\\frac{1}{2}\\times2(|N_{M}(i)|+|N_{M}(j)|)}\\leq R^{2\\frac{e_{M}}{M}}$ and ", "page_idx": 51}, {"type": "equation", "text": "$$\nP_{M}(v_{M},e_{M})=\\sum_{\\dot{U}_{M}\\in\\mathcal{U}_{M}(v_{M},e_{M})}w(\\dot{U}_{M})\\le R^{2\\frac{\\epsilon_{M}}{M}}\\sum_{\\dot{U}_{M}\\in\\widetilde{\\mathcal{U}}_{M}(v_{M},e_{M})}|H(\\dot{U}_{M})|.\n$$", "text_format": "latex", "page_idx": 51}, {"type": "text", "text": "Since $\\dot{U}_{M}(i)$ and $\\dot{U}_{M}(j)$ are two vertex-disjoint trees with $v_{M}$ edges. There are at most $v_{M}\\beta^{v M}$ unlabeled non-decorated because we can allocate $v_{M}$ edges to 2 trees in at most $v_{M}$ ways and under each way the number of rooted unlabeled trees are bounded by $\\beta^{v_{M}}$ . There are at most $11^{v_{M}}$ ways of decorating each edge. Therefore, $|\\widetilde{\\mathcal{U}}_{M}(v_{M},e_{M})|\\,\\le\\,v_{M}(11\\beta)^{v_{M}}$ . In addition, the number of labeled isomorphic members $|H(\\dot{U}_{M})|\\leq n^{v_{M}}$ and the number of 3-decorated edges plus two times of 4-decorated edges, $e_{M}$ , is upper bounded by $4N-2(v+k+2)$ . Putting things together, ", "page_idx": 51}, {"type": "equation", "text": "$$\n\\begin{array}{r}{P_{M}(v_{M},e_{M})\\leq v_{M}R^{\\frac{2e_{M}}{M}}n^{v_{M}}(11\\beta)^{v_{M}}\\mathbf{1}_{\\left\\{e_{M}\\leq2N-(v+k+2)\\right\\}}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 51}, {"type": "text", "text": "Lastly, because each connected component $\\dot{\\mathcal{C}}(i,a)$ contains at most $2(K+M)\\,-\\,1$ edges, for all $\\bar{a_{\\mathrm{~\\scriptsize~\\textcent~}}}\\sqrt{\\!\\!\\!\\sim\\!\\!\\!\\omega_{T}(i)}$ (same holds for $a\\in\\bar{\\mathcal{N}}_{T}(j))$ . This is because there are at most four wires, each from $S_{1},T_{1},S_{2},T_{2}$ go through vertex $a$ and every edge is at least 2-decorated. Therefore, $v_{M}\\,\\leq$ (K + M) 2eMM . \u53e3 ", "page_idx": 51}, {"type": "text", "text": "Lemma 23 (Upper bound of $P_{N}(v_{N},k)$ (Fake pairs: $j\\neq\\pi_{*}(i))$ )). ", "page_idx": 51}, {"type": "equation", "text": "$$\nP_{N}(v_{N},k)\\leq n^{v_{N}}\\beta(11\\beta)^{v_{N}}(11R^{4}(v_{N}+2)^{2})^{k+2}\\mathbf{1}_{\\left\\{v_{N}\\leq4(K+M)(k+2)\\right\\}}.\n$$", "text_format": "latex", "page_idx": 51}, {"type": "text", "text": "Proof. From the Lemma 9 in [42] we know that $\\lvert N_{N}(i)\\rvert+\\lvert N_{N}(j)\\rvert\\,\\le\\,4(k+2)$ . The intuition behind this bound is that $\\dot{U}_{N}$ can be viewed as a bunch of branches (wires plus bulbs) coming from two different roots $i,j$ tangled together. Whenever two branches intersect with each other, the excess grow by one. Since the excess of decorated union graph is $k$ and the starting point is two separate trees (with excess $-2_{,}$ ), there must be $k+2$ times of intersection between different branches. Each time of intersection involves at most four branches. ", "page_idx": 51}, {"type": "text", "text": "Thus $w(\\dot{U}_{N})\\leq R^{|N_{N}(i)|+|N_{N}(j)|}\\leq R^{4(k+2)}$ . As usual, we define $\\widetilde{\\mathcal{U}}_{N}(v_{N},k)$ as the collection of unlabeled decorated union graphs and $\\lvert H(\\dot{U}_{L})\\rvert$ be the set of labeled isomorphic members for each $\\dot{U}_{L}\\in\\widetilde{\\mathcal{U}}_{N}(v_{N},k)$ . ", "page_idx": 51}, {"type": "equation", "text": "$$\nP_{N}(v_{N},k)=\\sum_{\\dot{U}_{N}\\in\\mathcal{U}_{N}(v_{N},k)}w(\\dot{U}_{N})\\le R^{4(k+2)}\\sum_{\\dot{U}_{N}\\in\\widetilde{\\mathcal{U}}_{N}(v_{N},k)}|H(\\dot{U}_{L})|.\n$$", "text_format": "latex", "page_idx": 51}, {"type": "text", "text": "By $\\begin{array}{r}{|H(\\dot{U}_{N})|\\leq\\binom{n}{v_{N}}\\frac{v_{N}!}{\\mathrm{aut}(\\dot{U}_{N})}\\leq n^{v_{N}}}\\end{array}$ , we have: ", "page_idx": 51}, {"type": "equation", "text": "$$\n{\\cal P}_{N}(v_{N},k)\\le{\\cal R}^{4(k+2)}|\\widetilde{\\mathcal{U}}_{N}(v_{N},k)|.\n$$", "text_format": "latex", "page_idx": 51}, {"type": "text", "text": "In this part, the total number of unlabeled non-decorated graphs $\\dot{U}_{N}$ with $v_{N}+2$ vertices and excess k is bounded by \u03b2vN+ 1 (vkN2+ +1 2) \u2264\u03b2vN+1(vN + 2)2(k+1). This is because for a unlabeled connected graph with $v_{N}+2$ vertices, we can construct a spanning tree with $v_{N}+1$ vertices first and than add additional $k+1$ edges connecting some of the $v_{N}+2$ vertices. We can also bound the number of unlabeled $\\dot{U}_{N}$ as $v_{N}\\vec{\\beta}^{v_{N}}\\bigl(\\stackrel{(v_{N}+2)}{\\l_{k+2}}\\bigr)_{\\l}$ , which is constructing two trees rooted at $i$ and $j$ , with a total of $v_{N}$ ways of vertex number allocation, and then adding an additional $k+2$ edges. The latter bound is looser. Also, there are at most $11^{v_{N}+k+2}$ ways of decoration. Thus, ", "page_idx": 51}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\widetilde{\\mathcal{U}}_{N}(v_{N},k)|\\le\\beta^{v_{N}+1}(v_{N}+2)^{2(k+1)}11^{v_{N}+k+2}\\le\\beta^{v_{N}+1}(v_{N}+2)^{2(k+2)}11^{v_{N}+k+2}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 51}, {"type": "text", "text": "Lastly, $v_{N}$ is upper bounded by $(K+M)(|\\mathcal{N}_{N}(i)|+|\\mathcal{N}_{N}(j)|)$ by Claim 4 in [42]. ", "page_idx": 51}, {"type": "text", "text": "K Proof of Proposition 4 ", "text_level": 1, "page_idx": 52}, {"type": "text", "text": "In this section, we prove Proposition 4, which extends the Proposition 1 to the case when we can only perform almost exact community recovery with a single graph. We denote $\\widehat{\\pmb{\\sigma}}:=(\\widehat{\\pmb{\\sigma}}_{A},\\widehat{\\pmb{\\sigma}}_{B})$ , which is the combination of the community label estimates for both graphs. ", "page_idx": 52}, {"type": "text", "text": "Proof of Proposition 4. By definition of the similarity score and $\\mathcal{H}$ , ", "page_idx": 52}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{E}[\\Phi_{i j}^{\\widehat\\sigma}\\mathbf{1}_{\\mathcal{H}}]=\\displaystyle\\sum_{H\\in\\mathcal{T}}\\mathrm{aut}(H)\\displaystyle\\sum_{S(i)\\cong H}\\displaystyle\\sum_{T(j)\\cong H}\\mathbb{E}[\\overline{{A}}_{S}^{\\widehat\\sigma_{A}}\\overline{{B}}_{T}^{\\widehat\\sigma_{B}}\\mathbf{1}_{\\mathcal{H}}]}\\\\ &{\\qquad\\qquad=(1+o(1))\\displaystyle\\sum_{H\\in\\mathcal{T}}\\mathrm{aut}(H)\\displaystyle\\sum_{S(i)\\cong H}\\sum_{T(j)\\cong H}\\mathbb{E}\\left[\\mathbb{E}[\\overline{{A}}_{S}^{\\widehat\\sigma_{A}}\\overline{{B}}_{T}^{\\widehat\\sigma_{B}}\\mid\\sigma_{*},\\widehat\\sigma]\\mathbf{1}_{\\mathcal{H}}\\right].}\\end{array}\n$$", "text_format": "latex", "page_idx": 52}, {"type": "text", "text": "Define $\\mathcal{C}$ as the edge collection of the intersection graph of $S$ and $T\\colon{\\mathcal{C}}:=E(S)\\cap E(T)$ . ", "page_idx": 52}, {"type": "equation", "text": "$$\n\\sim\\sum_{H\\in\\mathcal{T}}\\underset{\\substack{c(H)\\,\\sum_{\\substack{\\ell(j)\\cong H}\\,T(j)\\cong H}}}{\\sum}\\mathbb{E}\\left[\\mathbb{E}[\\prod_{e\\in\\mathcal{T}}\\overline{{A}}_{e}^{\\hat{\\sigma}_{A}}\\overline{{B}}_{e}^{\\hat{\\sigma}_{B}}\\prod_{\\substack{e^{\\prime}\\in E(S)\\backslash\\mathcal{C}}}\\overline{{A}}_{e^{\\prime}}^{\\hat{\\sigma}_{A}}\\prod_{\\substack{e^{\\prime\\prime}\\in E(T)\\backslash\\mathcal{C}}}\\overline{{B}}_{e^{\\prime}}^{\\hat{\\sigma}_{B}}\\mid\\sigma_{*},\\widehat{\\sigma}]\\mathbf{1}_{\\mathcal{H}}\\right]\n$$", "text_format": "latex", "page_idx": 52}, {"type": "text", "text": "We perform case studies for $\\mathbb{E}[\\Phi_{i j}^{\\hat{\\sigma}}\\mathbf{1}_{\\mathcal{H}}]$ based on the structure of $S,T$ as a union graph and then later sum each case up. ", "page_idx": 52}, {"type": "text", "text": "(a) $S=T$ , that is, all edges appear in pairs (this case is only possible for $i=j$ ). There are $(1\\!+o(1)){{n}^{N}}/{\\mathrm{aut}(H)}$ labeled union graphs of $S_{1}$ and $T_{1}$ satisfying this condition. In this case, every edge is 2-decorated and it no longer matters whether $\\widehat{\\pmb{\\sigma}}$ gives a correct output or not, as we can show the following upper bound. ", "page_idx": 52}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{E}[\\Phi_{i j}^{\\widehat\\sigma}\\mathbf{1}_{\\mathcal{H}}]^{(A)}=(1+o(1))\\displaystyle\\sum_{H\\in\\mathcal{T}}\\mathrm{aut}(H)\\frac{n^{N}}{\\mathrm{aut}(H)}\\mathbb{E}\\left[\\prod_{e\\in\\mathcal{E}}\\mathbb{E}[\\overline{{A}}_{e}^{\\widehat\\sigma_{A}^{\\widehat\\sigma}\\widehat{B}_{e}^{n}}\\mid\\sigma_{*},\\widehat\\sigma]\\mathbf{1}_{\\mathcal{H}}\\right]}\\\\ &{\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ }\\ \\ \\ \\ \\ \\ \\ }\\\\ &{\\leq(1+o(1))\\vert7\\vert n^{N}\\displaystyle\\sum_{N_{+}}\\mathbb{\\mathbb{P}}(\\zeta=N_{+})\\sum_{N^{\\prime}}\\mathbb{P}(\\eta_{c+}=N_{c+},\\eta_{c-}=N_{c-}\\vert\\zeta=N_{+})}\\\\ &{\\quad\\ \\ \\ \\ \\ \\ \\ \\times(\\rho_{+}\\sigma_{+}^{2})^{N_{c+}}(\\rho_{-}\\sigma_{-}^{2})^{N_{c-}}(\\rho_{+}\\sigma_{+}^{2}+\\Delta^{2})^{N_{+}-N_{c+}}(\\rho_{-}\\sigma_{-}^{2}+\\Delta^{2})^{N-N_{+}-N_{c-}}}\\\\ &{\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ }\\ N_{+}}\\\\ &{\\leq(1+o(1))\\vert7\\vert n^{N}\\displaystyle\\sum_{N_{+}=0}^{N}\\binom{N}{N-1}\\frac{1}{2^{N}}(\\rho\\sigma_{+}^{2}+\\Delta^{2})^{N_{+}}(\\rho\\sigma_{-}^{2}+\\Delta^{2})^{N-N_{+}}}\\\\ &{=(\n$$", "text_format": "latex", "page_idx": 52}, {"type": "text", "text": "where $\\zeta$ is the number of in-community edges out of the $N$ edges in $S$ , $\\eta_{c+}$ is the number of incommunity edges that are centralized incorrectly, $\\eta_{c-}$ is the number of cross-community edges that are centralized incorrectly, and $\\Delta:=|p-q|$ . (i) The first equality holds by definition and counting cases. (ii) The second inequality holds because there are $N_{c+}(N_{c-})$ in(cross)-community edges centralized correctly, each of which contributes the same as $\\mathbb{E}[\\overline{{A}}_{e}\\overline{{B}}_{e}\\mid\\pmb{\\sigma}_{*}]=(1+o(1))\\rho_{+}\\sigma_{+}^{2}(\\rho_{-}\\sigma_{-}^{2})$ (Lemma 13). For the remaining edges, $N_{+}-N_{c+}$ $(N-N_{+}\\,-N_{c-})$ of them has $\\mathbb{E}[\\overline{{A}}_{e}^{\\widehat{\\pmb{\\sigma}}_{A}}\\overline{{B}}_{e}^{\\widehat{\\pmb{\\sigma}}_{B}}\\ |$ $\\sigma_{*},\\widehat{\\sigma}]=(1+o(1))(\\rho_{+}\\sigma_{+}^{2})+\\mathbb{E}[\\overline{{A}}_{e}^{\\widehat{\\sigma}_{A}}\\mid\\sigma_{*},\\widehat{\\sigma}]\\mathbb{E}[\\overline{{B}}_{e}^{\\widehat{\\sigma}_{B}}\\mid\\sigma_{*},\\widehat{\\sigma}]\\leq(1+o(1))(\\rho_{+}\\sigma_{+}^{2}+\\Delta^{2})$ . (iii) The third inequality holds because $\\Delta^{2}\\,>\\,0$ , Lemma 9 gives the distribution of $\\zeta$ , and $\\rho\\,=\\,(1+$ $\\Theta(\\frac{\\log n}{n}))\\rho_{+},\\rho=(1+\\Theta(\\frac{\\log n}{n}))\\rho_{-}$ . (iv) The last equality holds from the binomial theorem. ", "page_idx": 52}, {"type": "text", "text": "Observe that $\\begin{array}{r}{\\Delta^{2}=\\big(1+\\Theta\\big(\\frac{\\log n}{n}\\big)\\big)\\big(\\rho\\sigma_{\\mathrm{eff}}^{2}\\big)}\\end{array}$ . Assume that $N=O(\\log n)$ , ", "page_idx": 52}, {"type": "equation", "text": "$$\n\\mathbb{E}[\\Phi_{i j}^{\\widehat{\\sigma}}\\mathbf{1}_{\\mathcal{H}}]^{(A)}=(1+o(1))|\\mathcal{T}|n^{N}(\\rho\\sigma_{\\mathrm{eff}})^{N}.\n$$", "text_format": "latex", "page_idx": 52}, {"type": "image", "img_path": "nBhfIcDnRP/tmp/6a2cdfad022e05f15f1283a514217565e3a61455f7587143f3f41a396df8f284.jpg", "img_caption": [], "img_footnote": [], "page_idx": 53}, {"type": "text", "text": "Figure 8: Left: One possible labeling such that all edges are centralized incorrectly, with the colored vertices indicating those that are labeled incorrectly and the black vertices indicating those that are labeled correctly. Right: Another possible labeling such that all edges are centralized incorrectly. ", "page_idx": 53}, {"type": "text", "text": "(b) $S$ and $T$ have no common edges, that is, $E(S)\\cap E(T)=\\emptyset.$ . We can use the trivial bound on the labeled $S$ and $T$ as ${\\frac{n^{2N}}{\\mathrm{aut}(H)^{2}}}$ . ", "page_idx": 53}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{E}[\\Phi_{i j}^{\\widehat\\sigma}\\mathbf{1}_{\\mathcal{H}}]^{(B)}}\\\\ &{\\quad\\sim\\displaystyle\\sum_{H\\in\\mathcal{T}}\\operatorname{aut}(H)\\sum_{S(i)\\cong H}\\sum_{T(j)\\cong H:\\mathcal{C}=\\emptyset}\\mathbb{E}\\left[\\displaystyle\\prod_{e^{\\prime}\\in E(S)}\\mathbb{E}[\\overline{{A}}_{e^{\\prime}}^{\\widehat\\sigma_{A}}\\mid\\sigma_{*},\\widehat\\sigma]\\prod_{e^{\\prime\\prime}\\in E(T)}\\mathbb{E}[\\overline{{B}}_{e^{\\prime}}^{\\widehat\\sigma_{B}}\\mid\\sigma_{*},\\widehat\\sigma]\\mathbf{1}_{\\mathcal{H}}\\right]}\\\\ &{\\quad\\lesssim|\\mathcal{T}|\\frac{n^{2N}}{\\operatorname{aut}(H)}\\mathbb{P}(E)\\Delta^{2N},}\\end{array}\n$$", "text_format": "latex", "page_idx": 53}, {"type": "text", "text": "where $E$ denotes the event $\\begin{array}{r}{\\{\\widehat{\\pmb{\\sigma}}:\\prod_{e\\in E(S)}\\mathbb{E}[\\overline{{A}}_{e}^{\\widehat{\\pmb{\\sigma}}_{A}}]\\prod_{e\\in E(T)}\\mathbb{E}[\\overline{{B}}_{e}^{\\widehat{\\pmb{\\sigma}}_{B}}]=\\Theta(\\Delta^{e(S)+e(T)})\\}\\cap\\mathcal{H}}\\end{array}$ , that is, every edge is centralized correctly and $\\mathcal{H}$ happens. This inequality is true because conditioned on $\\mathcal{H}$ and $\\widehat{\\pmb{\\sigma}}$ being correct, $\\mathbb{E}[\\overline{{A}}_{e}^{\\widehat{\\sigma}_{A}}\\mid\\sigma_{*},\\widehat{\\sigma}]\\mathbf{1}_{\\mathcal{H}}=o\\big(n^{-D_{+}(a,b,s,\\varepsilon)}\\big)$ , the upper bound of the probability that one vertex on this edge being labeled incorrectly. ", "page_idx": 53}, {"type": "text", "text": "We further denote $E^{\\prime}$ as $\\begin{array}{r}{\\{\\widehat{\\pmb{\\sigma}}_{A}:\\prod_{e\\in E(S)}\\mathbb{E}[\\overline{{\\boldsymbol{A}}}_{e}^{\\widehat{\\pmb{\\sigma}}_{A}}]=\\Theta(\\Delta^{e(S)})\\}\\cap\\mathcal{H}.}\\end{array}$ . It is obvious that $\\mathbb{P}(E)\\le\\mathbb{P}(E^{\\prime})$ Then, we need to upper bound the probability of ${\\widehat{\\pmb{\\sigma}}}_{A}$ giving incorrect centralization for all edges in $S\\cup T$ . ", "page_idx": 53}, {"type": "text", "text": "We observe that there are only two situations, that is, no vertices in $S$ that has a neighbor with the same label correctness as itself. See Figure 8 for an illustration. We denote those two possible outcomes constraint on $S\\cup T$ as $\\widehat{\\pmb{\\sigma}}_{1}$ and $\\widehat{\\pmb{\\sigma}}_{2}$ . $\\begin{array}{r}{\\mathbb{P}(E^{\\prime})=\\mathbb{P}(\\{\\widehat{\\pmb{\\sigma}}_{A}=\\widehat{\\pmb{\\sigma}}_{1}\\}\\cap\\mathcal{H})+\\mathbb{P}(\\{\\widehat{\\pmb{\\sigma}}_{A}=\\widehat{\\pmb{\\sigma}_{2}}\\}\\cap\\mathcal{H})}\\end{array}$ . ", "page_idx": 53}, {"type": "text", "text": "By the label correctness, we separate $V(S)$ into two disjoint sets: $V(S)_{c}^{\\hat{\\pmb{\\sigma}}}$ for the correctly labeled vertices and $V(S)_{i c}^{\\widehat{\\pmb{\\sigma}}}$ for the incorrectly labeled vertices. The deterministic relationship between $\\widehat{\\pmb{\\sigma}}_{1}$ and $\\widehat{\\pmb{\\sigma}}_{2}$ is: $V(S)_{i c}^{\\widehat{\\pmb{\\sigma}}_{1}}=V(S)_{c}^{\\widehat{\\pmb{\\sigma}}_{2}}$ . without loss of generality, we assume $|V(S)_{c}^{\\widehat{\\pmb{\\sigma}}_{1}}|\\,>\\,|V(S)_{i c}^{\\widehat{\\pmb{\\sigma}}_{1}}|$ . O bserve   that event $\\{\\widehat{\\pmb{\\sigma}}_{A}=\\widehat{\\pmb{\\sigma}}_{1}\\}$ (resp. $\\{\\widehat{\\pmb{\\sigma}}_{A}=\\widehat{\\pmb{\\sigma}}_{2}\\}$ ) is equivalent as saying the set of vertices on odd (resp. even) levels are  labe le d incorrectl y (fall i ng in the bad vertex set $I_{\\varepsilon}$ as defined in Section D). ", "page_idx": 53}, {"type": "text", "text": "Denote $p_{a,b,s,\\varepsilon,\\delta,V}:=n^{-V\\times D_{+}(a,b,s,\\varepsilon)}+n^{-\\varepsilon\\delta(1-o(1))\\log n}$ . We can apply Lemma 8, ", "page_idx": 53}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{P}\\big(\\{\\widehat{\\sigma}_{A}=\\widehat{\\sigma}_{1}\\}\\cap\\mathcal{H}\\big)\\leq\\big(1-p_{a,b,s,\\varepsilon,\\delta,|V(S)_{c}^{\\widehat{\\sigma}_{1}}|}\\big)\\big(p_{a,b,s,\\varepsilon,\\delta,|V(S)_{i c}^{\\widehat{\\sigma}_{1}}|}\\big),}\\\\ &{\\mathbb{P}\\big(\\{\\widehat{\\sigma}_{A}=\\widehat{\\sigma}_{2}\\}\\cap\\mathcal{H}\\big)\\leq\\big(1-p_{a,b,s,\\varepsilon,\\delta,|V(S)_{i c}^{\\widehat{\\sigma}_{1}}|}\\big)\\big(p_{a,b,s,\\varepsilon,\\delta,|V(S)_{c}^{\\widehat{\\sigma}_{1}}|}\\big),}\\\\ &{\\mathbb{P}(E^{\\prime})\\leq2\\big(1-p_{a,b,s,\\varepsilon,\\delta,|V(S)_{c}^{\\widehat{\\sigma}_{1}}|}\\big)\\big(p_{a,b,s,\\varepsilon,\\delta,|V(S)_{i c}^{\\widehat{\\sigma}_{1}}|}\\big).}\\end{array}\n$$", "text_format": "latex", "page_idx": 53}, {"type": "text", "text": "Consider each chandelier has $L$ branches and each has a $M$ -wire (Assume that $\\begin{array}{r}{M=\\Theta(\\frac{\\log n}{\\log l o g n})}\\end{array}$ in condition (3)). Even if we don\u2019t know the structure of bulbs, we have |V (S)i\u03c3 c1 | = \u2126(lolgo lgo gn n), because at least half of the vertices on wires should be labeled incorrectly. ", "page_idx": 53}, {"type": "text", "text": "For some constant c1 > 0 such that |V (S)i\u03c3 c1 | \u2265c1lolgo lgo gn n, ", "page_idx": 53}, {"type": "equation", "text": "$$\n\\mathbb{P}(E)\\leq\\mathbb{P}(E^{\\prime})\\leq O(p_{a,b,s,\\varepsilon,\\delta,|V(S)_{i c}^{\\hat{\\sigma}_{1}}|})\\leq O(n^{-D_{+}(a,b,s,\\varepsilon)c_{1}\\frac{\\log n}{\\log\\log n}}).\n$$", "text_format": "latex", "page_idx": 53}, {"type": "text", "text": "By substituting $\\mathbb{P}(E)$ and $\\Delta^{2N}$ into (70), we have ", "page_idx": 54}, {"type": "equation", "text": "$$\n\\mathbb{E}[\\Phi_{i j}^{\\widehat\\sigma}\\mathbf{1}_{\\mathcal{H}}]^{(B)}\\leq O\\left(|\\mathcal{T}|\\frac{n^{2N}}{\\mathrm{aut}(H)}n^{-[D+(a,b,s,\\varepsilon)]c_{1}\\frac{\\log n}{\\log\\log n}}(\\rho\\sigma_{\\mathrm{eff}}^{2})^{2N}(\\nu)^{2N}\\right).\n$$", "text_format": "latex", "page_idx": 54}, {"type": "text", "text": "Recall that $\\mu=|\\mathcal{T}|n^{N}(\\rho\\sigma_{\\mathrm{eff}}^{2})^{N}$ . Denote (\u03c1\u03c3\u2206e2f2f)2 (= (1 + o(1)) 2\u03c1((aa\u2212+bb))). For some constant c2 > 0 such that \u03c1\u03c3e2ff \u2264c2logn n , ", "page_idx": 54}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{E}[\\Phi_{i j}^{\\widehat\\sigma}\\mathbf{1}_{\\mathcal{H}}]^{(B)}\\leq O\\left(\\mu c_{2}^{N}\\nu^{2N}(\\frac{\\log n}{n})^{N}n^{N}n^{-D_{+}(a,b,s,\\varepsilon)c_{1}}\\frac{\\log n}{\\log\\log n}\\right)}\\\\ &{\\qquad\\qquad\\qquad=O\\left(\\mu c_{2}^{N}\\nu^{2N}\\frac{(\\log n)^{N}}{n^{c_{1}D_{+}(a,b,s,\\varepsilon)}\\frac{\\log n}{\\log\\log n}}\\right).}\\end{array}\n$$", "text_format": "latex", "page_idx": 54}, {"type": "text", "text": "For some constant $c_{3}>0$ such that $N=c_{3}\\log n$ , as in assumption (3), ", "page_idx": 54}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{=O\\left(\\mu(\\frac{(c_{2}\\nu^{2}\\log n)^{c_{3}\\log\\log n}}{n^{c_{1}D_{+}(a,b,s,\\varepsilon)}})^{\\frac{\\log n}{\\log\\log n}}\\right)}\\\\ &{=o(\\mu/n^{2}).}\\end{array}\n$$", "text_format": "latex", "page_idx": 54}, {"type": "text", "text": "(c) $S$ and $T$ have some common edges, that is, $E(S)\\cap E(T)\\neq\\emptyset.$ . There are at most $[n^{2N}-$ $n^{\\dot{N}}(n-N)^{N}]/\\mathrm{{aut}}(H)^{2}=o(n^{N})n^{\\check{N_{\\big/}}}\\mathrm{{a}u t}(H)^{2}$ cases in the enumeration of $S$ and $T$ . ", "page_idx": 54}, {"type": "equation", "text": "$$\n\\mathbb{E}[\\Phi_{i j}^{\\widehat\\sigma}\\mathbf{1}_{\\mathcal{H}}]^{(C)}\\lesssim\\sum_{H\\in\\mathcal{T}}\\operatorname{aut}(H)\\sum_{M=1}^{N-1}\\sum_{\\substack{S(i)\\cong H,T(j)\\cong H;C\\neq\\emptyset,X_{d}=M}}(\\rho\\sigma_{\\mathrm{eff}}^{2}+\\Delta^{2})^{N-M}\\Delta^{2M}\\mathbb{P}(E^{\\prime\\prime}),\n$$", "text_format": "latex", "page_idx": 54}, {"type": "text", "text": "where we denote by $E^{\\prime\\prime}$ the event ", "page_idx": 54}, {"type": "equation", "text": "$$\n\\{\\widehat{\\sigma}:\\prod_{e^{\\prime}\\in E(S)\\backslash c}\\mathbb{E}[\\overline{{A}}_{e^{\\prime}}^{\\widehat{\\sigma}_{A}}]\\prod_{e^{\\prime\\prime}\\in E(T)\\backslash c}\\mathbb{E}[\\overline{{B}}_{e^{\\prime}}^{\\widehat{\\sigma}_{B}}]=\\Theta(\\Delta)^{\\vert E(S)\\backslash c\\vert+\\vert E(T)\\backslash c\\vert}\\}\\cap\\mathcal{H}.\n$$", "text_format": "latex", "page_idx": 54}, {"type": "text", "text": "Let $X_{d}$ denote the number of different edges between $S$ and $T$ under the true permutation. The structures of $S$ and $T$ such that $\\{X_{d}~=~M\\}$ happens, $\\textstyle\\sum_{S(i)\\cong H}\\sum_{T(j)\\cong H}\\mathbf{1}_{\\{X_{d}=M\\}}^{\\overline{{\\mathbf{\\}}}}$ , is upper bounded byaunt(H) \u00d7a ${\\frac{n^{N}}{\\mathrm{aut}(H)}}\\,\\times\\,{\\frac{n^{M}}{\\mathrm{aut}(H)}}$ as changing $M$ edges from $S$ to $T$ allows changing at most $M$ vertices for a tree. Then, we have ", "page_idx": 54}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{E}[\\Phi_{i j}^{\\widehat{\\sigma}}\\mathbf{1}_{\\mathcal{H}}]^{(C)}\\lesssim|\\mathcal{T}|n^{N}\\displaystyle\\sum_{M=1}^{N-1}(\\rho\\sigma_{\\mathrm{eff}}^{2}+\\Delta^{2})^{N-M}n^{M}\\Delta^{2M}\\mathbb{P}(E^{\\prime\\prime})}\\\\ &{\\phantom{\\sum}\\lesssim|\\mathcal{T}|n^{N}\\displaystyle\\sum_{M=1}^{N-1}(\\rho\\sigma_{\\mathrm{eff}}^{2})^{N-M}n^{M}(\\rho\\sigma_{\\mathrm{eff}}^{2})^{2M}(\\frac{2(a-b)}{\\rho(a+b)})^{2M}\\mathbb{P}(E^{\\prime\\prime})}\\\\ &{\\phantom{\\sum}=(1+o(1))\\mu\\displaystyle\\sum_{M=1}^{N-1}(n\\rho\\sigma_{\\mathrm{eff}}^{2})^{M}\\nu^{2M}\\mathbb{P}(E^{\\prime\\prime}).}\\end{array}\n$$", "text_format": "latex", "page_idx": 54}, {"type": "text", "text": "We observe the following: ", "page_idx": 54}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\mathbb{P}(E^{\\prime\\prime})\\leq n^{-D_{+}(a,b,s,\\varepsilon)(2M/2D)}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 54}, {"type": "text", "text": "This inequality holds because there are $2M$ edges centralized incorrectly (required from event $E^{\\prime\\prime}$ ) in $S$ and $T$ and each incorrect labeling of a vertex can lead to incorrect centralization on at most $D$ edges. Therefore, at least $2M/2D$ vertices should be wrongly labeled for $E^{\\prime\\prime}$ to happen. ", "page_idx": 54}, {"type": "text", "text": "Substitute $\\mathbb{P}(E^{\\prime\\prime})$ into (71). Assuming that $\\begin{array}{r}{D=o\\big(\\frac{\\log n}{\\log\\log n}\\big)}\\end{array}$ (3), ", "page_idx": 54}, {"type": "equation", "text": "$$\n\\mathbb{E}[\\Phi_{i j}^{\\widehat\\sigma}\\mathbf{1}_{\\mathcal{H}}]^{(C)}\\lesssim\\mu\\sum_{M=1}^{N-1}(\\frac{n\\rho\\sigma_{\\mathrm{eff}}^{2}\\nu^{2}}{n^{\\frac{1}{D}{D}_{+}(a,b,s,\\varepsilon)}})^{M}\\lesssim\\mu\\sum_{M=1}^{N-1}(\\frac{\\nu^{2}c_{1}\\log n}{n^{\\frac{1}{D}{D}_{+}(a,b,s,\\varepsilon)}})^{M}=o(\\mu).\n$$", "text_format": "latex", "page_idx": 54}, {"type": "text", "text": "In summary, ", "page_idx": 54}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\mathbb{E}[\\Phi_{i j}^{\\widehat\\sigma}\\mathbf{1}_{\\mathcal{H}}]=\\left\\{\\mathop{\\mathbb{E}}[\\Phi_{i j}^{\\widehat\\sigma}\\mathbf{1}_{\\mathcal{H}}]^{(A)}+\\mathbb{E}[\\Phi_{i j}^{\\widehat\\sigma}\\mathbf{1}_{\\mathcal{H}}]^{(B)}+\\mathbb{E}[\\Phi_{i j}^{\\widehat\\sigma}\\mathbf{1}_{\\mathcal{H}}]^{(C)}=(1+o(1))\\mu\\right.\\left.\\mathrm{~if~}j=\\pi_{*}(i),}\\\\ {\\mathbb{E}[\\Phi_{i j}^{\\widehat\\sigma}\\mathbf{1}_{\\mathcal{H}}]^{(B)}+\\mathbb{E}[\\Phi_{i j}^{\\widehat\\sigma}\\mathbf{1}_{\\mathcal{H}}]^{(C)}=o(\\mu)\\right.\\qquad\\qquad\\qquad\\qquad\\left.\\mathrm{~if~}j\\neq\\pi_{*}(i).}\\end{array}\n$$", "text_format": "latex", "page_idx": 54}, {"type": "text", "text": "Remark 6. (Denser regime) If we are not restricting the sparse regime $\\textstyle p={\\frac{a\\log n}{n}}$ a log nand q = $q={\\frac{b\\log n}{n}}$ b log n, we are interested in what general $p,q$ conditions are for Lemma $^{4}$ to hold. Assume that $p\\vee q=O(n^{-c(n)})$ , then the geometric series  NM\u2212=11nD1 nD\u03c1+\u03c3e(faf,\u03bdb,s,\u03b5) converges if and only if c(n) > 1 \u2212D+(aD,b,s,\u03b5). ", "page_idx": 55}, {"type": "text", "text": "L Proof of Proposition 5 ", "text_level": 1, "page_idx": 55}, {"type": "text", "text": "L.1 Proof of the Proposition ", "text_level": 1, "page_idx": 55}, {"type": "text", "text": "In this section, we analyze the second moment of similarity score. We expect the variance of $\\Phi_{i j}$ to be infinitely small in comparison with the squared expectation of true pair\u2019s similarity score. ", "page_idx": 55}, {"type": "text", "text": "Proof of Proposition 5. Recall that $S_{1},T_{1}$ are rooted on $i$ and $S_{2},T_{2}$ are rooted on $j$ . ", "page_idx": 55}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathrm{Var}[\\Phi_{i j}^{\\widehat\\sigma}\\mathbf{1}_{\\mathcal{H}}]=\\displaystyle\\sum_{H,I\\in\\mathcal{T}}\\mathrm{aut}(H)\\mathrm{aut}(I)\\sum_{S_{1},S_{2}\\cong H,T_{1},T_{2}\\cong I}\\mathrm{Cov}(\\overline{{A}}_{S_{1}}^{\\widehat\\sigma_{A}}\\overline{{B}}_{S_{2}}^{\\widehat\\sigma_{B}}\\mathbf{1}_{\\mathcal{H}},\\overline{{A}}_{T_{1}}^{\\widehat\\sigma_{A}}\\overline{{B}}_{T_{2}}^{\\widehat\\sigma_{B}}\\mathbf{1}_{\\mathcal{H}})}\\\\ &{\\qquad\\qquad=\\displaystyle\\sum_{H,I\\in\\mathcal{T}}\\mathrm{aut}(H)\\mathrm{aut}(I)\\sum_{S_{1},S_{2}\\cong H,T_{1},T_{2}\\cong I}\\mathbb{E}[\\overline{{A}}_{S_{1}}^{\\widehat\\sigma_{A}}\\overline{{B}}_{S_{2}}^{\\widehat\\sigma_{B}}\\overline{{A}}_{T_{1}}^{\\widehat\\sigma_{A}}\\overline{{B}}_{T_{2}}^{\\widehat\\sigma_{B}}\\mathbf{1}_{\\mathcal{H}}]-}\\end{array}\n$$", "text_format": "latex", "page_idx": 55}, {"type": "text", "text": "(a) Analyzing $V_{2}$ . We first give the upper bound of the latter part. When analyzing with correct centralization, we ignore this part as it is non-negative in the correct centralization case. However, in this case, it is possible to be negative because there can be odd number of edges occurring once and also being incorrectly centralized. ", "page_idx": 55}, {"type": "text", "text": "After factorizing $V_{2}$ , ", "page_idx": 55}, {"type": "equation", "text": "$$\nV_{2}=\\left(\\sum_{H\\in\\mathcal{T}}\\mathrm{aut}(H)\\sum_{S_{1},S_{2}\\cong H}\\mathbb{E}[\\overline{{A}}_{S_{1}}^{\\widehat{\\sigma}_{A}}\\overline{{B}}_{S_{2}}^{\\widehat{\\sigma}_{B}}\\mathbf{1}_{\\mathcal{H}}]\\right)\\left(\\sum_{I\\in\\mathcal{T}}\\mathrm{aut}(I)\\sum_{T_{1},T_{2}\\cong I}\\mathbb{E}[\\overline{{A}}_{T_{1}}^{\\widehat{\\sigma}_{A}}\\overline{{B}}_{T_{2}}^{\\widehat{\\sigma}_{B}}\\mathbf{1}_{\\mathcal{H}}]\\right),\n$$", "text_format": "latex", "page_idx": 55}, {"type": "text", "text": "we can see that $V_{2}\\geq0$ , and thus we have $\\mathrm{Var}[\\Phi_{i j}^{\\widehat{\\sigma}}\\mathbf{1}_{\\mathcal{H}}]\\leq V_{1}$ for $j=\\pi_{*}(i)$ . ", "page_idx": 55}, {"type": "text", "text": "(b) Analyzing $V_{11}$ . The main challenge here is that we do not have the condition that every edge occurs at least twice in the union graph as in the analysis of Regime I. However, we can put union graphs into two categories based on whether every edge is at least 2-decorated or not. We keep the notation of ${\\mathcal{W}}_{i j}$ as the collection of decorated union graphs U\u02d9 that are at least 2-decorated and we decompose (72) as follows ", "page_idx": 55}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{V_{1}=\\displaystyle\\sum_{H,I\\in\\mathcal{T}}\\mathrm{aut}(H)\\mathrm{aut}(I)\\sum_{\\substack{S_{1},S_{2}\\cong H,T_{1},T_{2}\\cong I}}\\mathbb{E}[\\overline{{A}}_{S_{1}}^{\\hat{\\sigma}_{A}}\\overline{{B}}_{S_{2}}^{\\hat{\\sigma}_{B}}\\overline{{A}}_{T_{1}}^{\\hat{\\sigma}_{A}}\\overline{{B}}_{T_{2}}^{\\hat{\\sigma}_{B}}\\mathbf{1}_{\\mathcal{H}}]}\\\\ &{\\quad=\\underbrace{\\sum_{\\substack{\\dot{U}\\in\\mathcal{W}_{i j}}}(\\mathrm{aut}(S_{1})\\mathrm{aut}(S_{2})\\mathrm{aut}(T_{1})\\mathrm{aut}(T_{2}))^{\\frac{1}{2}}\\mathbb{E}[\\overline{{A}}_{S_{1}}^{\\hat{\\sigma}_{A}}\\overline{{B}}_{S_{2}}^{\\hat{\\sigma}_{B}}\\overline{{A}}_{T_{1}}^{\\hat{\\sigma}_{A}}\\overline{{B}}_{T_{2}}^{\\hat{\\sigma}_{B}}\\mathbf{1}_{\\mathcal{H}}]}_{V_{11}}+}\\\\ &{\\quad\\quad+\\displaystyle\\sum_{\\substack{\\dot{U}\\notin\\mathcal{W}_{i j}}}(\\mathrm{aut}(S_{1})\\mathrm{aut}(S_{2})\\mathrm{aut}(T_{1})\\mathrm{aut}(T_{2}))^{\\frac{1}{2}}\\mathbb{E}[\\overline{{A}}_{S_{1}}^{\\hat{\\sigma}_{A}}\\overline{{B}}_{S_{2}}^{\\hat{\\sigma}_{B}}\\overline{{A}}_{T_{1}}^{\\hat{\\sigma}_{A}}\\overline{{B}}_{T_{2}}^{\\hat{\\sigma}_{B}}\\mathbf{1}_{\\mathcal{H}}]\\,.}\\end{array}\n$$", "text_format": "latex", "page_idx": 55}, {"type": "text", "text": "We first show that $\\begin{array}{r}{V_{11}/\\mu^{2}=O\\left(\\frac{L^{2}}{\\rho^{2}n s(p\\wedge q)}+\\frac{L^{2}}{\\rho^{2(K+M)}|\\mathcal{I}|}\\right)}\\end{array}$ ", "page_idx": 55}, {"type": "text", "text": "The incorrect centralization affects the upper bound of moments as the following: ", "page_idx": 56}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{E}\\big[\\overline{{A}}_{S_{1}}^{\\bar{\\sigma}_{A},\\bar{\\sigma}_{\\bar{\\sigma}_{2}}}\\overline{{A}}_{T_{1}}^{\\bar{\\sigma}_{B}}\\overline{{B}}_{T_{2}}^{\\bar{\\sigma}_{B}}\\mathbf{1}_{H}\\big]}\\\\ &{\\qquad=\\mathbb{E}\\left[g_{\\bar{\\sigma}}(\\sigma_{+},\\sigma_{-})\\prod_{\\substack{2\\leq\\ell+m\\leq4}}\\prod_{\\substack{u,v\\in[\\kappa_{\\ell m}]\\in K_{\\ell m}}}\\sigma_{c(u,v)}^{-(\\ell+m)}\\mathbb{E}\\big[\\overline{{A}}_{u v}^{\\bar{\\sigma}_{A},\\ell}\\overline{{B}}_{u v}^{\\bar{\\sigma}_{B},m}\\mid\\sigma_{*},\\widehat{\\sigma}\\big|\\mathbf{1}_{H}\\big]\\right.}\\\\ &{\\qquad=\\mathbb{E}\\left[g_{\\bar{\\sigma}}(\\sigma_{+},\\sigma_{-})\\prod_{\\substack{2\\leq\\ell+m\\leq4}}\\beta_{\\L{l},m}^{e(K_{\\ell m})}\\mathbf{1}_{H}\\right]}\\\\ &{\\qquad\\qquad\\left.\\leq\\rho^{e(K_{11})}(s p\\wedge s q)^{-2N+\\epsilon(U)}\\sigma_{\\mathrm{eff}}^{4N}(1+O(\\frac{\\log n}{n}))^{e(U)}\\right.}\\\\ &{\\qquad\\qquad\\left.\\leq\\rho^{e(K_{11})}(s p\\wedge s q)^{-2N+\\epsilon(U)}\\sigma_{\\mathrm{eff}}^{4N}(1+O(\\frac{\\log n}{n}))^{4N}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 56}, {"type": "text", "text": "The first two equalities follow from definitions. The third inequality holds because of the upper bounds of \u03b2\u2113e,(mK \u2113m)from Lemma 14 holds for all\u03c3. ", "page_idx": 56}, {"type": "text", "text": "Then, the structures of the union graph, alone with the assigned weights are bounded the same as in Section I. This implies that $\\begin{array}{r}{\\frac{V_{11}}{\\mathbb{E}[\\Phi_{i\\pi_{*}(i)}\\mathbf{1}_{\\mathcal{H}}]^{2}}\\leq O\\left(\\frac{L^{2}}{\\rho^{2}n s(p\\wedge q)}+\\frac{L^{2}}{\\rho^{2(K+M)}|\\mathcal{I}|}\\right)}\\end{array}$ under the same condition as (22). ", "page_idx": 56}, {"type": "text", "text": "(c) Analyzing $V_{12}$ . To conclude $\\begin{array}{r}{\\frac{\\mathrm{Var}[\\Phi_{i j}^{\\widehat\\sigma}\\mathbf{1}\\!\\cdot\\!\\boldsymbol\\eta]}{\\mathbb{E}[\\Phi_{i\\pi_{*}(i)}\\mathbf{1}\\!\\cdot\\!\\boldsymbol\\eta]^{2}}\\,\\leq\\,\\frac{V_{11}+V_{12}+V_{2}}{\\mathbb{E}[\\Phi_{i\\pi_{*}(i)}\\mathbf{1}\\!\\cdot\\!\\boldsymbol\\eta]^{2}}\\,=\\,O\\left(\\frac{L^{2}}{\\rho^{2}n s(p\\!\\wedge\\!q)}+\\frac{L^{2}}{\\rho^{2(K+M)}|\\mathcal{T}|}\\right)\\!,}\\end{array}$ it remains to show $\\begin{array}{r}{V_{12}\\,=\\,o\\left(\\frac{L^{2}}{\\rho^{2}n s(p\\wedge q)}+\\frac{L^{2}}{\\rho^{2(K+M)}|\\mathcal{T}|}\\right)}\\end{array}$ . Lemma 24 gives a even stronger result, because as assumed in Proposition 5, L = o(log n)), giving\u03c12nsL(2p\u2227q) $\\begin{array}{r}{\\frac{L^{2}}{\\rho^{2}n s(p\\wedge q)}+\\frac{L^{2}}{\\rho^{2(K+M)}|\\mathcal{I}|}\\gg n^{-\\varepsilon^{\\prime}}}\\end{array}$ $\\varepsilon^{\\prime}>0$ . \u53e3 ", "page_idx": 56}, {"type": "text", "text": "Lemma 24. Under the same conditions as Proposition $^{5}$ , for some $\\varepsilon^{\\prime}>0$ , ", "page_idx": 56}, {"type": "equation", "text": "$$\n\\frac{V_{12}}{\\mathbb{E}[\\Phi_{i\\pi_{*}(i)}\\mathbf{1}_{\\mathcal{H}}]^{2}}=o(n^{-\\varepsilon^{\\prime}}).\n$$", "text_format": "latex", "page_idx": 56}, {"type": "text", "text": "Proof. For the expectation inside $V_{1}$ part, it can be separated as eight sets $K_{\\ell m}$ : ", "page_idx": 56}, {"type": "equation", "text": "$$\n\\mathbb{E}\\big[\\overline{{A}}_{S_{1}}^{\\widehat{\\sigma}_{A}}\\overline{{B}}_{S_{2}}^{\\widehat{\\sigma}_{B}}\\overline{{A}}_{T_{1}}^{\\widehat{\\sigma}_{A}}\\overline{{B}}_{T_{2}}^{\\widehat{\\sigma}_{B}}\\mathbf{1}_{\\mathcal{H}}\\big]=\\mathbb{E}\\left[g_{\\widehat{U}}g_{\\widehat{U}}^{-1}\\mathbb{E}\\big[\\prod_{\\ell\\in[2],m\\in[2],\\ell+m\\ge1}\\prod_{\\ell\\in K_{\\ell m}}\\overline{{A}}_{e}^{\\widehat{\\sigma}_{A},\\ell}\\overline{{B}}_{e}^{\\widehat{\\sigma}_{B},m}\\mid\\sigma_{*},\\widehat{\\sigma}\\big]\\mathbf{1}_{\\mathcal{H}}\\right],\n$$", "text_format": "latex", "page_idx": 56}, {"type": "text", "text": "where $g_{\\dot{U}}$ is the abbreviation for $g_{\\dot{U}}(\\sigma_{+},\\sigma_{-})$ . ", "page_idx": 56}, {"type": "text", "text": "Conditioned on $\\pmb{\\sigma}$ and $\\widehat{\\pmb{\\sigma}}$ , approximately centered edges are still independent with each other, ", "page_idx": 56}, {"type": "equation", "text": "$$\n\\mathbb{E}\\big[\\overline{{A}}_{S_{1}}^{\\widehat{\\sigma}_{A}}\\overline{{B}}_{S_{2}}^{\\widehat{\\sigma}_{B}}\\overline{{A}}_{T_{1}}^{\\widehat{\\sigma}_{A}}\\overline{{B}}_{T_{2}}^{\\widehat{\\sigma}_{B}}\\mathbf{1}_{\\mathcal{H}}\\big]=\\mathbb{E}\\left[g_{\\widehat{U}}g_{\\widehat{U}}^{-1}\\prod_{\\ell\\in[2],m\\in[2],\\ell+m\\ge1}\\prod_{\\ell\\in K_{\\ell m}}\\mathbb{E}\\big[\\overline{{A}}_{e}^{\\widehat{\\sigma}_{A},\\ell}\\overline{{B}}_{e}^{\\widehat{\\sigma}_{B},m}\\mid\\sigma_{*},\\widehat{\\sigma}\\big]\\mathbf{1}_{\\mathcal{H}}\\right],\n$$", "text_format": "latex", "page_idx": 56}, {"type": "text", "text": "Lemma 14 gives the upper bound over \u03b7\u2113,m := \u03c3c\u2212((e\u2113)+ $\\eta_{\\ell,m}\\;:=\\;\\sigma_{c(e)}^{-(\\ell+m)}\\mathbb{E}\\!\\left[\\overline{{A}}_{e}^{\\widehat{\\sigma}_{A},\\ell}\\overline{{B}}_{e}^{\\widehat{\\sigma}_{B},m}\\;\\mid\\;\\sigma_{*},\\widehat{\\sigma}\\right]$ and thus by enumerating through the products, we have ", "page_idx": 56}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{g_{\\hat{U}}^{-1}\\displaystyle\\prod_{\\ell\\in[2],m\\in[2],\\ell+m\\geq1}\\prod_{e\\in K_{\\ell m}}\\mathbb{E}[\\overline{{A}}_{e}^{\\hat{\\sigma}_{A},\\ell}\\overline{{B}}_{e}^{\\hat{\\sigma}_{B},m}\\;|\\;\\sigma_{*},\\widehat{\\sigma}]}\\\\ &{\\qquad\\qquad\\qquad\\leq(1+\\Theta(\\frac{\\log n}{n}))^{4N}\\rho^{e(K_{11})}\\big(s p\\wedge s q\\big)^{-\\frac12(e(K_{12})+e(K_{21}))-e(K_{22})}\\mathbb{P}(\\xi)\\Delta^{z/2},}\\\\ &{\\qquad\\qquad\\qquad\\leq(1+o(1))\\rho^{e(K_{11})}\\big(s p\\wedge s q\\big)^{v+k+1-2N}\\mathbb{P}(\\xi)(\\frac{|a-b|}{a\\wedge b})^{z/2},}\\end{array}\n$$", "text_format": "latex", "page_idx": 56}, {"type": "text", "text": "where $\\mathcal{E}:=\\left\\{\\begin{array}{r l}\\end{array}\\right.$ Every 1-decorated edges are centralized incorrectly} $\\cap\\,\\mathcal{H}$ and $z$ is the number of 1- decorated edges, namely, $z:=e(K_{01})+e(K_{10})$ . The second inequality holds because $-\\textstyle{\\frac{1}{2}}(e(K_{12})+$ $e(K_{21}))-e\\bar{(}K_{22})=(\\stackrel{.}{v}+k+\\mathord{\\mathrm{i}})-2N-z/2$ . ", "page_idx": 57}, {"type": "text", "text": "According to Lemma 8 and the assumption that the maximum degree of chandelier is no greater than $D$ , we have for any $\\varepsilon>0$ , ", "page_idx": 57}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\mathbb{P}(\\mathcal{E})\\le n^{-D_{+}(a,b,s,\\varepsilon)\\frac{z}{D}}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 57}, {"type": "text", "text": "Putting things together, ", "page_idx": 57}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\frac{\\cdot}{\\vert\\overline{{A}}_{S_{1}}^{\\hat{\\sigma}_{A}}\\overline{{B}}_{S_{2}}^{\\hat{\\sigma}_{B}}\\overline{{A}}_{T_{1}}^{\\hat{\\sigma}_{A}}\\overline{{B}}_{T_{2}}^{\\hat{\\sigma}_{B}}\\mathbf{1}_{\\mathcal{H}}\\vert\\leq(1+o(1))n^{-D_{+}(a,b,s,\\varepsilon)}\\frac{\\bar{\\sigma}}{D}\\left(s p\\wedge s q\\right)^{v+k+1-2N}\\rho^{e(K_{11})}\\mathbb{E}[g_{\\hat{U}}(\\sigma_{+},\\sigma_{-})\\mid\\mathcal{H}].}\\end{array}\n$$", "text_format": "latex", "page_idx": 57}, {"type": "text", "text": "It remains to calculate $\\mathbb{E}[g_{\\dot{U}}(\\sigma_{+},\\sigma_{-})\\mid\\mathcal{H}]$ . ", "page_idx": 57}, {"type": "text", "text": "Similar as in the calculation in Section I, where we only consider $\\dot{U}$ being at least 2-decorated. Here, we need to generalize it into the case when $\\dot{U}$ has 1-decorated edges. $\\bar{U}$ can be decomposed into a tree with an additional set of edges connecting vertices on the tree. We assume that there are $A_{i}$ $i$ -decorated edges on the tree and $B_{i}$ $i$ -decorated edges in the additional edge set of size $e(\\dot{U})-v(\\dot{U})+1$ , for $i\\in$ [4]. We apply the Corollary 1 and have that $\\mathbb{P}(X^{(1,a)}=a_{1},X^{(2,a)}=$ a $\\mathrm{\\boldmath~\\mu~}_{2,}X^{(3,a)}~=~a_{3},X^{(4,a)}~=~\\stackrel{\\cdot}{a}_{4},X^{(1,b)}~=~b_{1},X^{(2,b)}~=~b_{2},X^{(3,b)}~=~b_{3},X^{(4,b)}~=~b_{4}~\\mid~\\mathcal{H})~\\le~b_{5},X^{(3,b)}~=~b_{6},X^{(4,b)}~=~b_{7}.$ $\\begin{array}{r}{\\left(1\\!+\\!o(1)\\right)\\!\\binom{A_{1}}{a_{1}}\\binom{A_{2}}{a_{2}}\\binom{A_{3}}{a_{3}}\\binom{A_{4}}{a_{4}}\\frac{1}{2^{A_{1}+A_{2}+A_{3}+A_{4}}}}\\end{array}$ , where $X^{(i,a)}$ is the number of $i$ -decorated in-community edges on the tree-part of $\\dot{U}$ and $X^{(i,b)}$ is the number of $i$ -decorated in-community edges among the additional edge set. ", "page_idx": 57}, {"type": "text", "text": "$A_{i}$ and $B_{i}$ are fixed but summed up to $d_{i}$ for each U\u02d9. $a_{i}\\left(b_{i}\\right)$ takes possible values from 0 to $A_{i}\\left(B_{i}\\right)$ , for $i\\in$ [4]. The number of $i$ -decorated in-community edges is $a_{i}+b_{i}$ , and the number of $i$ -decorated cross-community edges is $d_{i}-a_{i}-b_{i}=(A_{i}-a_{i}\\overset{.}{)}+\\overset{.}{(}B_{i}-b_{i})$ . ", "page_idx": 57}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\quad_{N U V}\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\! \n$$", "text_format": "latex", "page_idx": 57}, {"type": "text", "text": "where the last inequality holds because the upper bound holds with multiplying a binomial coefficient $\\binom{B_{1}}{b_{1}}\\binom{B_{2}}{b_{2}}\\binom{B_{3}}{b_{3}}\\binom{B_{4}}{b_{4}}$ and that $\\textstyle\\sum_{i}B_{i}=k+1$ . By the definition of $\\gamma_{2}$ and $\\gamma_{1}$ , ", "page_idx": 57}, {"type": "equation", "text": "$$\n\\mathbb{E}\\left[g_{\\hat{U}}(\\sigma_{+},\\sigma_{-})\\mid\\mathcal{H}\\right]\\leq\\left(1+o(1)\\right)\\left(\\frac{\\sigma_{+}+\\sigma_{-}}{2}\\right)^{d_{1}}\\sigma_{\\mathrm{eff}}^{2d_{2}+3d_{3}+4d_{4}}\\gamma_{1}^{d_{3}}\\gamma_{2}^{d_{4}}2^{k+1}.\n$$", "text_format": "latex", "page_idx": 57}, {"type": "text", "text": "Define $\\gamma_{0}:=(\\frac{\\sigma_{+}\\!+\\!\\sigma_{-}}{2})/\\sigma_{\\mathrm{eff}}$ and we can see that $\\gamma_{0}<1$ . So, we can upper bound $(\\frac{\\sigma_{+}+\\sigma_{-}}{2})^{d_{1}}$ as $\\sigma_{\\mathrm{eff}}^{d_{1}}$ Because $\\gamma_{1}<\\gamma_{2}$ and $d_{3}+d_{4}=e(K_{12})+e(K_{21})+e(K_{22})$ ", "page_idx": 57}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\mathbb{E}\\left[g_{\\dot{U}}(\\sigma_{+},\\sigma_{-})\\mid\\mathcal{H}\\right]\\leq(1+o(1))\\sigma_{\\mathrm{eff}}^{4N}\\gamma_{2}^{e(K_{12})+e(K_{21})+e(K_{22})}2^{k+1}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 57}, {"type": "text", "text": "In summary, ", "page_idx": 57}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb E[\\overline{A}_{S_{1}}\\overline{B}_{S_{2}}\\overline{A}_{T_{1}}\\overline{B}_{T_{2}}{\\mathbf1}_{\\mathcal{H}}]\\le(1+o(1))n^{-D_{+}(a,b,s,\\varepsilon)\\frac{z}D}\\bigl(s p\\wedge s q\\bigr)^{v+k+1-2N}\\rho^{e(K_{11})}}\\\\ &{\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\times\\,\\sigma_{\\mathrm{eff}}^{4N}\\gamma_{2}^{e(K_{12})+e(K_{21})+e(K_{22})}2^{k+1}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 57}, {"type": "text", "text": "After plugging the upper bound on cross-moments to the ratio, it remains to bound the number of different union graph structures and their corresponding weights. In parallel to ${\\mathcal{W}}_{i j}$ , we define ${\\mathbf{}}S_{i j}$ as the collection of decorated union graphs that have at least one 1-decorated edge. $S_{i j}(v,k)$ denotes those with $v+1+\\mathbf{1}_{j\\neq\\pi_{*}i}$ vertices and excess $k$ . ", "page_idx": 58}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\frac{V_{12}}{\\mathbb{E}[\\Phi_{i\\pi_{*}(i)}\\mathbf{1}_{\\mathcal{H}}]^{2}}}\\\\ &{\\leq\\frac{\\sum_{v+k+1=0}^{4N}\\sum_{\\dot{U}\\in\\mathcal{S}_{i j}(v,k)}\\mathrm{aut}(H)\\mathrm{aut}(I)\\rho^{e(K_{11})}\\left(s p\\wedge s q\\right)^{v+k+1-2N}\\gamma_{2}^{e(K_{12})+e(K_{21})+e(K_{22})}2^{k+1}}{(1+o(1))n^{2N}\\rho^{2N}|T|^{2}n^{z{D}_{+}(a,b,s,\\varepsilon)/D}}}\\end{array}\n$$", "text_format": "latex", "page_idx": 58}, {"type": "text", "text": "We define the $(\\dot{U}_{L},\\dot{U}_{M},\\dot{U}_{N})$ partition of decorated union graph as (44) in Section I. We define $\\mathcal{U}_{L}(v_{L},z,\\ell)$ as the collection of $\\dot{U}_{L}$ that has $v_{L}$ vertices, $\\ell$ edges belonging to set $e(K_{11})$ , and no more than $z\\textsuperscript{1}$ -decorated edges. We define $\\mathcal{U}_{M}(v_{M})$ as the collection of $\\dot{U}_{M}$ that has $v_{M}$ vertices. We define $\\mathcal{U}_{N}(v_{N},k)$ as the collection of $\\dot{U}_{N}$ that has $v_{N}$ vertices and excess $k$ . We also keep the notation of $\\widetilde{\\mathcal{U}}$ as the corresponding unlabeled decorated union graph sets. In addition, ", "page_idx": 58}, {"type": "equation", "text": "$$\n\\begin{array}{l}{{\\displaystyle P_{L}(v_{L},z,\\ell):=\\sum_{\\dot{U}_{L}\\in\\mathcal{U}_{L}(v_{L},z,\\ell)}w(\\dot{U}_{L})},}\\\\ {{\\displaystyle P_{M}(v_{M}):=\\sum_{\\dot{U}_{L}\\in\\mathcal{U}_{L}(v_{M})}w(\\dot{U}_{M})},}\\\\ {{\\displaystyle P_{N}(v_{N},k):=\\sum_{\\dot{U}_{L}\\in\\mathcal{U}_{L}(v_{N},k)}w(\\dot{U}_{N})}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 58}, {"type": "text", "text": "From the above partition, ", "page_idx": 58}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\frac{V_{12}}{\\mathbb{E}[\\Phi_{i\\pi_{*}(i)}\\mathbf{1}\\mu]^{2}}}\\\\ &{\\leq\\frac{\\sum_{v=N}^{4N}\\sum_{k+1=0}^{4N-v}(s p\\wedge s q)^{v+k+1-2N}2^{k+1}\\sum_{z}\\sum_{v_{L},v_{M},v_{N}}\\sum_{\\ell}\\rho^{\\ell}P_{L}(v_{L},z,\\ell)P_{M}(v_{M})P_{L}(v_{N},k)}{(1+o(1))n^{2N}\\rho^{2N}|T|^{2}n^{z D_{+}(a,b,s,\\varepsilon)/D}\\gamma_{2}^{2(v+k+2)-4N}}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 58}, {"type": "text", "text": "We show upper bounds for $P_{L}(v_{L},z,\\ell)$ in Lemma 25, which is ", "page_idx": 58}, {"type": "equation", "text": "$$\n\\sum_{\\ell=0}^{2N}\\rho^{\\ell}P_{L}(v_{L},z,\\ell)\\le(4N)^{2z+1}n^{v_{L}}L(4L M)^{6L}|\\mathcal{T}|^{2}\\rho^{2N}\\rho^{-\\frac{z}{2}}.\n$$", "text_format": "latex", "page_idx": 58}, {"type": "text", "text": "The upper bounds for $P_{M}$ and $P_{N}$ trivially follows from Lemma 19 and Lemma 20, with a replacement of 11 to 15 as the possible decorations of each vertex increase by 4 for 1-decoration and a different maximum value of $e_{M}$ , parameterized by $v,k,z$ . ", "page_idx": 58}, {"type": "equation", "text": "$$\n\\begin{array}{r}{P_{M}(v_{M})\\le R^{\\frac{2e_{M}}{M}}n^{v_{M}}(15\\beta)^{(K+M)\\frac{2e_{M}}{M}}\\mathbf{1}_{\\left\\{e_{M}\\le2N-(v+k+2)+z/2\\right\\}}\\qquad}\\\\ {P_{N}(v_{N},k)\\le n^{v_{N}}(15\\beta)^{v_{N}}(15R^{4}(v_{N}+1)^{2})^{k+1}\\mathbf{1}_{\\left\\{v_{N}\\le2(K+M)(2k+2)\\right\\}}.\\qquad}\\end{array}\n$$", "text_format": "latex", "page_idx": 58}, {"type": "text", "text": "Putting all the pieces together, we have ", "page_idx": 58}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{\\frac{V_{12}}{\\mathbb{E}[\\Phi_{i\\pi_{*}(i)}\\mathbf{1}\\mathcal{H}]^{2}}\\leq\\displaystyle\\sum_{k\\geq-1}\\left(\\frac{30R^{4}(2N+1)^{2}(15\\beta)^{4(K+M)}}{n}\\right)^{k+1}}&{}\\\\ &{\\quad\\times\\displaystyle\\sum_{v=N}^{4N-k-1}\\left(\\frac{R^{\\frac{2}{M}}(15\\beta)^{2\\frac{K+M}{M}}}{n s(p\\wedge q)}\\gamma_{2}^{2}\\right)^{2N-v-k-1}}\\\\ &{\\quad\\times\\displaystyle\\sum_{z=1\\vee(2(v+k+1)-4N)}^{4N}\\left(\\frac{(4N)^{2}R^{\\frac{1}{M}}(15\\beta)^{\\frac{K+M}{M}}}{\\sqrt{\\rho}n^{\\frac{D_{+}(a,b,s)}{D}}}\\right)^{z}\\times2N L(4L M)^{6L}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 58}, {"type": "text", "text": "From condition (24), $2N L(4L M)^{6L}\\leq\\log^{3}n$ . Also, since with (24) and $\\gamma_{2}<2$ , ", "page_idx": 59}, {"type": "equation", "text": "$$\n\\frac{R^{\\frac{2}{M}}(15\\beta)^{2\\frac{K+M}{M}}}{n s(p\\wedge q)}\\gamma_{2}^{2}\\leq\\frac12,\\quad\\frac{15R^{4}(2N+1)^{2}(15\\beta)^{4(K+M)}}{n}\\leq\\frac12.\n$$", "text_format": "latex", "page_idx": 59}, {"type": "text", "text": "For $v\\leq2N-k-1$ , we have ", "page_idx": 59}, {"type": "equation", "text": "$$\n\\sum_{v=N}^{2N-k-1}\\left(\\frac{R^{\\frac{2}{M}}(15\\beta)^{2\\frac{K+M}{M}}}{n s(p\\wedge q)}\\gamma_{2}^{2}\\right)^{2N-v-k-1}\\leq2.\n$$", "text_format": "latex", "page_idx": 59}, {"type": "text", "text": "For the first summation, we always have ", "page_idx": 59}, {"type": "equation", "text": "$$\n\\sum_{k\\geq-1}\\left(\\frac{30R^{4}(2N+1)^{2}(15\\beta)^{4(K+M)}}{n}\\right)^{k+1}\\leq2.\n$$", "text_format": "latex", "page_idx": 59}, {"type": "text", "text": "For the last summation with those additional terms, from condition (24), we have ", "page_idx": 59}, {"type": "equation", "text": "$$\n\\sum_{z=1}^{4N}\\left(\\frac{(4N)^{2}R^{\\frac{1}{M}}(15\\beta)^{\\frac{K+M}{M}}}{\\sqrt{\\rho}n^{\\frac{D_{+}(a,b,s,\\varepsilon)}{D}}}\\right)^{z}\\times2N L(4L M)^{6L}=o(n^{-\\varepsilon^{\\prime}}),\n$$", "text_format": "latex", "page_idx": 59}, {"type": "text", "text": "for some $\\varepsilon^{\\prime}>0$ because $n^{D+(a,b,s,\\varepsilon)/D}$ is the only term being polynomial. ", "page_idx": 59}, {"type": "text", "text": "If $v>2N-k-1$ , then we know that $z>2(v+k+1-2N)$ . The summation over $v$ and $z$ together is upper bounded by ", "page_idx": 59}, {"type": "equation", "text": "$$\n\\sum_{v=2N-k}^{4N-k-1}\\left(\\frac{R^{\\frac{2}{M}}(15\\beta)^{2\\frac{K+M}{M}}}{n s(p\\wedge q)}\\gamma_{2}^{2}\\times\\frac{(4N)^{2}R^{\\frac{1}{M}}(15\\beta)^{\\frac{K+M}{M}}}{\\sqrt{\\rho}n^{\\frac{D_{+}(a,b,s,\\epsilon)}{D}}}\\right)^{v+k+1-2N}2N L(4L M)^{6L}=o(n^{-\\varepsilon^{\\prime}}),\n$$", "text_format": "latex", "page_idx": 59}, {"type": "text", "text": "because, again $n^{D+(a,b,s,\\varepsilon)/D}$ is the only term being polynomial. ", "page_idx": 59}, {"type": "text", "text": "In summary, we have $\\begin{array}{r}{\\frac{V_{12}}{\\mathbb{E}[\\Phi_{i\\pi_{*}(i)}\\mathbf{1}_{\\mathcal{H}}]^{2}}=o\\big(n^{-\\varepsilon^{\\prime}}\\big)}\\end{array}$ for some $\\varepsilon^{\\prime}>0$ , which completes the proof. ", "page_idx": 59}, {"type": "text", "text": "L.2 Proof of auxiliary Lemmas ", "text_level": 1, "page_idx": 59}, {"type": "text", "text": "Lemma 25. For true pairs, ", "text_level": 1, "page_idx": 59}, {"type": "equation", "text": "$$\n\\sum_{\\ell=0}^{2N}\\rho^{\\ell}P_{L}(v_{L},z,\\ell)\\le(4N)^{2z+1}n^{v_{L}}L(4L M)^{6L}|\\mathcal{T}|^{2}\\rho^{2N}\\rho^{-\\frac{z}{2}}.\n$$", "text_format": "latex", "page_idx": 59}, {"type": "text", "text": "Proof. We define the unlabeled union graph sets corresponding to $\\mathcal{U}(v_{L},z,\\ell)$ as $\\tilde{\\mathcal{U}}(v_{L},z,\\ell)$ . From definition (60), ", "page_idx": 59}, {"type": "text", "text": "From the definition (75) and Claim 1, ", "page_idx": 59}, {"type": "equation", "text": "$$\n\\sum_{\\ell=0}^{2N}\\rho^{\\ell}P_{L}(v_{L},z,\\ell)\\le\\sum_{\\ell=0}^{2N}\\rho^{\\ell}\\sum_{\\dot{U}_{L}\\in\\widetilde{\\mathcal{U}}_{L}(v_{L},z,\\ell)}\\frac{n^{v_{L}}w(\\dot{U}_{L})}{\\mathrm{aut}(\\dot{U}_{L})}\\le\\sum_{\\ell=0}^{2N}n^{v_{L}}\\rho^{\\ell}|\\widetilde{\\mathcal{U}}_{L}(v_{L},z,\\ell)|(2K)^{z}.\n$$", "text_format": "latex", "page_idx": 59}, {"type": "text", "text": "Recall that $e_{L}\\,=\\,{\\textstyle\\frac{1}{2}}(e(K_{12}\\cup K_{22}\\cap\\dot{U}_{L})+e(K_{21}\\cup K_{22}\\cap\\dot{U}_{L}))$ . The total number of edges on $S_{1},T_{1},S_{2}$ and $T_{2}$ involved in $\\dot{U}_{L}$ is $\\left(2(v_{L}\\!+\\!e_{L})-z\\right)$ and thus the total number of bulbs on $S_{1},T_{1},S_{2}$ and $T_{2}$ involved in $\\dot{U}_{L}$ is $\\begin{array}{r}{b:=\\frac{2(v_{L}+e_{L})-z}{K+M}<4L}\\end{array}$ . Those $b$ bulbs can be partly or fully overlapped (namely, tangled) with another stay on their own. From the definition of $\\dot{U}_{L}$ (44), it is impossible to have three or more bulbs tangling with each other. If two bulbs are tangling with each other, we put them into a pair. If a bunch of bulbs are all not tangling with any other bulbs, we pair them up arbitrarily. We denote $t_{1}$ as the number of pairs of bulbs that have decorations being a subset of $\\{S_{1},S_{2}\\}$ or $\\{T_{1},T_{2}\\}$ . For all 2-decorated edges among these pairs, they are in $K_{11}$ . Since $\\dot{U}_{L}$ has at most $z\\;1\\cdot$ -decorated edges, we have ", "page_idx": 59}, {"type": "equation", "text": "$$\n\\ell\\geq t_{1}K-z/2.\n$$", "text_format": "latex", "page_idx": 59}, {"type": "text", "text": "Next, we introduce three types of bulbs. The first type is called effective non-isomorphic bulbs, which is a selection of bulbs that are not isomorphic to each other and always pair with a bulb that are not of the same type. The selection is not unique and we take the largest possible set of bulbs satisfying those rules as the set of effective non-isomorphic bulbs. Fixed the effective bulb set, for bulbs that are isomorphic to those effective non-isomorphic bulbs, we name them as shadow effective bulbs. For the remaining bulbs, we name them as non-effective bulbs. We have the following Claim 2: ", "page_idx": 60}, {"type": "equation", "text": "$$\n\\frac{t_{1}}{2}\\leq a\\leq L+\\frac{t_{1}}{2}.\n$$", "text_format": "latex", "page_idx": 60}, {"type": "text", "text": "From definition, there is at most one non-effective bulb and at most one effective non-isomorphic bulb in each pair of bulbs, while two shadow bulbs can pair up. ", "page_idx": 60}, {"type": "text", "text": "We call those effective non-isomorphic bulbs as effective because when enumerating through the chandelier structures, we let them having the priority of taking any possible structure from $\\mathcal{I}$ and serving the base of that pair. Shadow effective bulbs are named so because they mirror the structure of effective non-isomorphic bulbs and thus will not increase the union graph richness too much. For non-effective bulbs, we let them take any possible structures with the constrain that there are at most $z\\,1$ -decorated edges in $\\dot{U}_{L}$ . ", "page_idx": 60}, {"type": "text", "text": "We denote the number of effective non-isomorphic bulbs as $a$ . For all pairs, we upper bound the number of different non-isomorphic tangled bulbs as following combinatorial factor ", "page_idx": 60}, {"type": "equation", "text": "$$\n\\binom{|\\mathcal{T}|}{a}\\binom{b}{a}\\binom{2N}{z/2}(4N)^{\\frac{z}{2}},\n$$", "text_format": "latex", "page_idx": 60}, {"type": "text", "text": "where $\\binom{|\\mathcal{I}|}{a}$ comes from the structure of $a$ effective non-isomorphic bulbs, $\\textstyle{\\binom{b}{a}}$ is the upper bound of choosing a effective non-isomorphic bulbs from b bulbs, z2/N2 is the upper bound on the selection of which edges on effective non-isomorphic bulbs and shadow effective bulbs are overlapped as there are at most $2K\\left(<2N\\right)$ 2-decorated edges on bulbs if all bulbs are perfectly overlapping with one another, and $(4N)^{\\frac{z}{2}}$ bounds the placement of those remaining 1-decorated edges from the non-effective bulbs as each of them has at most $4N$ possible vertices to attach to on the union graph. ", "page_idx": 60}, {"type": "text", "text": "Since wires cannot tangle with bulbs (otherwise, it is not a tree), we bound the possible structures separately. There can be at most 4 wires tangling with each other, from top to bottom. We apply a very loose bound even without using this fact, which is $(b-1)!M^{b-1}$ . This is because there are at most $b$ wires and we determine the structure of wires on the union graph one by one. When the $t$ -th wire comes in, it can determine which of the $t-1$ wires to tangle with and the length of overlap, from 0 to $M$ . ", "page_idx": 60}, {"type": "text", "text": "Putting together (79) and (80) with the combinatorial observations, we have ", "page_idx": 60}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\rho^{\\ell}|\\widetilde{\\mathcal{U}}_{L}(v_{L},z,\\ell)|\\leq\\displaystyle\\sum_{a=0}^{2L}\\displaystyle\\sum_{b=2a}^{4L}\\sum_{t_{1}=0}^{a}\\rho^{t_{1}K-\\frac{z}{2}}\\mathbf{1}_{\\left\\{a\\leq L+\\frac{t_{1}}{2}\\right\\}}|\\mathcal{T}|^{a}\\binom{b}{a}(2\\binom{b}{a})^{3z/2}(b-1)!M}\\\\ &{\\qquad\\qquad\\qquad\\leq|\\mathcal{T}|(4N)^{\\varepsilon}\\rho^{-\\frac{z}{2}}\\displaystyle\\sum_{t_{1}=0}^{2L}(|\\mathcal{I}|^{\\frac{t_{1}}{2}}\\rho^{t_{1}K})\\displaystyle\\sum_{a=0}^{2L}\\sum_{b=2a}^{4L}\\binom{b}{a}(b-1)!M^{b-1}}\\\\ &{\\qquad\\qquad\\leq(4L M)^{6L}|\\mathcal{T}|(4N)^{z}\\rho^{-\\frac{z}{2}}\\displaystyle\\sum_{t_{1}=0}^{2L}(|\\mathcal{T}|\\rho^{2K})^{\\frac{t_{1}}{2}}}\\\\ &{\\qquad\\qquad\\leq L(4L M)^{6L}|\\mathcal{T}|^{2}\\rho^{2N}(4N)^{z}\\rho^{-\\frac{z}{2}}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 60}, {"type": "text", "text": "In the second inequality, we loose the upper bound of $t_{1}$ from $a$ to $2L$ and change the order of summation. In the third inequality, we bound the summation over $a$ and $b$ . Lastly, $\\begin{array}{r}{\\sum_{t_{1}=0}^{2L}(|\\mathcal{I}|\\rho^{2K})^{\\frac{t_{1}}{2}}\\leq L(|\\mathcal{I}|\\rho^{2K})^{L}=\\bar{L}|\\mathcal{T}|\\dot{\\rho}^{2N}.}\\end{array}$ . ", "page_idx": 60}, {"type": "text", "text": "Plugging (81) back to (78), after a summation over $\\ell$ , we complete the proof. ", "page_idx": 60}, {"type": "text", "text": "Claim 1. Assume that $j=\\pi_{*}(i)$ . For any arbitrary $\\dot{U}_{L}\\in\\mathcal{U}_{L}(v_{L},z,\\ell),$ , we have ", "page_idx": 60}, {"type": "equation", "text": "$$\nw(\\dot{U}_{L})\\leq\\mathrm{aut}(\\dot{U}_{L})(2K)^{z}.\n$$", "text_format": "latex", "page_idx": 60}, {"type": "text", "text": "Proof. Denote all bulbs contained in $\\dot{U}_{L}$ as $B_{1},B_{2},\\dots,B_{w}$ . (1) Some of them can be fully overlapped to form a 2-decorated bulbs in the union graph. (2) Some of them can be partly overlapped. (3) And the remaining of them are fully 1-decorated. There cannot be three or more bulbs overlapping with each other thanks to the definition of $\\dot{U}_{L}$ (65). ", "page_idx": 61}, {"type": "text", "text": "Each bulb $B_{i}$ contributes to the $w(\\dot{U}_{L})$ by $\\operatorname{aut}({\\boldsymbol{B}}_{i})$ independently from definition (66) and (50). For any vertex on the bulbs, it will not be at the same orbit as any vertex on the wire, so studying the automorphism of the overlapped bulbs gives a lower bound on the automorphism of the whole decorated graph. Since each bulb occurs in at most one overlapped bulb, to prove the claim, it suffices to examine the relationship between weights and automorphism for each of the three cases aforementioned. ", "page_idx": 61}, {"type": "text", "text": "For $i,j\\in[w]$ , if bulbs $B_{i}$ is partly overlapping with $B_{j}$ . From Corollary 2, $\\sqrt{\\mathrm{aut}(\\beta_{i})\\mathrm{aut}(B_{j})}\\le$ $\\mathrm{aut}(\\mathcal{B}_{i}\\cup\\mathcal{B}_{j})(2K)^{|E(\\mathcal{B}_{i})\\triangle E(\\mathcal{B}_{j})|}$ . If $B_{i}$ is fully overlapping with $B_{j}$ , then $\\sqrt{\\mathrm{aut}(\\mathcal{B}_{i})\\mathrm{aut}(\\mathcal{B}_{j})}\\,=$ $\\operatorname{aut}(B_{i}\\cup B_{j})$ . If $B_{i}$ is fully 1-decorated, then ${\\sqrt{\\mathrm{aut}(B_{i})}}\\leq\\mathrm{aut}(B_{i})$ . ", "page_idx": 61}, {"type": "text", "text": "Denote $I_{1}$ and $I_{2}$ as the collections of index pairs that the corresponding bulbs fall in case (1) or (2). Denote $I_{3}$ as the collection of indices corresponding to the bulbs falling in case (3). Therefore, ", "page_idx": 61}, {"type": "equation", "text": "$$\n\\begin{array}{l}{{w(\\Dot{U}_{L})\\leq\\displaystyle\\prod_{(i,j)\\in I_{1}}\\operatorname{aut}(\\mathcal{B}_{i}\\cup\\mathcal{B}_{j})(2K)^{|E(\\mathcal{B}_{i})\\bigtriangleup E(\\mathcal{B}_{j})|}\\prod_{(i,j)\\in I_{2}}\\operatorname{aut}(\\mathcal{B}_{i}\\cup\\mathcal{B}_{j})\\prod_{i\\in I_{3}}\\operatorname{aut}(\\mathcal{B}_{i})}}\\\\ {{\\leq\\operatorname{aut}(\\Dot{U}_{L})(2K)^{\\sum_{(i,j)\\in I}|E(\\mathcal{B}_{i})\\bigtriangleup E(\\mathcal{B}_{j})|}.}}\\end{array}\n$$", "text_format": "latex", "page_idx": 61}, {"type": "text", "text": "The union graph has at least $\\begin{array}{r}{2\\,\\times\\,\\sum_{(i,j)\\in I}|E(\\mathcal{B}_{i})\\triangle E(\\mathcal{B}_{j})|}\\end{array}$ 1-decorated edges and we know that $\\dot{U}_{L}$ has at most $z\\textsuperscript{1}$ -decorated edges. Therefore, $\\begin{array}{r}{\\sum_{(i,j)\\in I}|E(\\mathcal{B}_{i})\\triangle E(\\mathcal{B}_{j})|\\le z}\\end{array}$ . Substituting this into (82) completes the proof. \u53e3 ", "page_idx": 61}, {"type": "text", "text": "Claim 2. Let a be the number of effective non-isomorphic bulbs and $t_{1}$ be the number of pairs of tangled bulbs that are decorated by a subset of either $\\{S_{1},S_{2}\\}$ or $\\{T_{1},T_{2}\\}$ . We have ", "page_idx": 61}, {"type": "equation", "text": "$$\n\\frac{t_{1}}{2}\\leq a\\leq L+\\frac{t_{1}}{2}.\n$$", "text_format": "latex", "page_idx": 61}, {"type": "text", "text": "Proof. For an arbitrary bulb, it occurs at most one time in $S_{1},S_{2},T_{1},T_{2}$ each and they are paired up into two sets, $\\begin{array}{r}{a\\geq\\frac{t_{1}}{2}}\\end{array}$ . Assume that there are $t^{\\prime}$ non-isomorphic bulbs among the $t_{1}$ pairs, they can all be assigned as effective non-isomorphic bulbs. Then, without loss of generality, $S_{1},S_{2}$ have at most $L-\\frac{t^{\\prime}}{2}$ bulbs unspecified. By assumption, they cannot pair up with each other, so every one bulb from $S_{1},\\bar{S_{2}}$ remaining will pair up with another bulb from $T_{1},T_{2}$ . Therefore, the remaining bulbs have at most $L-\\frac{t^{\\prime}}{2}$ effective non-isomorphic bulbs. ", "page_idx": 61}, {"type": "text", "text": "M Proof of Proposition 6 ", "text_level": 1, "page_idx": 61}, {"type": "text", "text": "M.1 Proof of the Proposition ", "text_level": 1, "page_idx": 61}, {"type": "text", "text": "Proof of Proposition $\\theta.$ . Recall that $S_{1}$ and $T_{1}$ are rooted on $i$ , $S_{2}$ and $T_{2}$ are rooted on $j$ . The minimum value of $k$ is $-2$ when the union graph consists of two disconnected trees, $S_{1}\\cup T_{1}$ and $S_{2}\\cup T_{2}$ . We use the same notation for different parts of the variance as in Section $\\mathrm{L}$ . ", "page_idx": 61}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathrm{Var}[\\widehat{\\mathfrak{p}}_{i j}^{\\mathcal{O}}\\mathbf{1}_{M}]=\\displaystyle\\sum_{H,I\\in\\mathcal{T}}\\mathrm{aut}(H)\\mathrm{aut}(I)}\\\\ &{\\qquad\\qquad=\\underbrace{H_{I}\\epsilon}_{\\textnormal{S i c},(M+\\mathcal{O}_{2})\\mathrm{aut}(\\mathcal{I}_{1}),\\mathrm{aut}(\\mathcal{I}_{2})}\\times_{\\mathbb{I}}\\!\\!\\!\\sum_{\\substack{k=1}}^{\\infty}\\!\\!\\!\\!\\frac{\\mathrm{Cov}(\\overline{{A}}_{S_{1}}^{\\mathcal{O}_{A}}\\overline{{B}}_{S_{2}}^{\\mathcal{O}_{B}}\\mathbf{1}_{M},\\overline{{A}}_{T_{1}}^{\\mathcal{O}_{A}}\\overline{{B}}_{T_{2}}^{\\mathcal{O}_{B}}\\mathbf{1}_{H})}{H(\\overline{{A}}_{S_{1}}^{\\mathcal{O}_{A}}\\overline{{B}}_{S_{2}}^{\\mathcal{O}_{B}}\\mathbf{1}_{H})}}\\\\ &{\\qquad\\qquad=\\underbrace{\\mathrm{Cov}(S_{1})\\mathrm{aut}(S_{2})\\mathrm{aut}(T_{1})\\mathrm{aut}(T_{2})}_{S_{1},S_{2}\\mathrm{aut}(S_{2})\\mathrm{aut}(S_{2}),\\mathrm{aut}(T_{1})}\\}\\mathbb{E}[\\overline{{A}}_{S_{1}}^{\\mathcal{O}_{A}}\\overline{{B}}_{S_{2}}^{\\mathcal{O}_{B}}\\overline{{A}}_{T_{1}}^{\\mathcal{O}_{A}}\\overline{{B}}_{T_{2}}^{\\mathcal{O}_{B}}\\mathbf{1}_{H}]}_{V_{11}}}\\\\ &{\\qquad+\\underbrace{\\mathrm{Var}(\\mathrm{aut}(S_{1})\\mathrm{aut}(S_{2})\\mathrm{aut}(T_{1})\\mathrm{aut}(T_{2}))^{\\frac{1}{2}}\\mathbb{E}[\\overline{{A}}_{S_{1}}^{\\mathcal{O}_{A}}\\overline{{B}}_{S_{2}}^{\\mathcal{O}_{B}}\\overline{{A}}_{T_{1}}^{\\mathcal{O}_{A}}\\overline{{B}}_{T_{2}}^{\\mathcal{O}_{B}}\\mathbf{1}_{H}]\n$$", "text_format": "latex", "page_idx": 62}, {"type": "text", "text": "Since $V_{2}\\ge0$ , it suffices to bound the first two summations. The same argument in Section $\\mathrm{L}$ to bound the $V_{11}$ for true pairs works for this case with an additional fluctuation coming from using Lemma 14 to bound the cross moments rather than Lemma 13. We have ", "page_idx": 62}, {"type": "equation", "text": "$$\nV_{11}/\\mu^{2}\\le(1+\\Theta(\\frac{\\log n}{n}))^{4N}\\frac{\\mathrm{Var}[\\Phi_{i j}^{\\widehat\\sigma}\\mathbf{1}_{\\mathcal{H}}]}{\\mu^{2}}|_{s D_{+}(a,b)>1}=O(\\frac{1}{|\\mathcal{T}|\\rho^{2N}})\n$$", "text_format": "latex", "page_idx": 62}, {"type": "text", "text": "under conditions (23). The additional fluctuation comes from the cross moment bounds. ", "page_idx": 62}, {"type": "text", "text": "Lemma 26 shows that V12/\u00b52 = o(|T |1\u03c12N ). In summary, we haveE[V\u03a6air\u03c0[\u2217\u03a6(i ij)11HH]]2 $\\begin{array}{r}{\\frac{\\mathrm{Var}[\\Phi_{i j}^{\\widehat{\\sigma}}\\mathbf{1}_{\\mathcal{H}}]}{\\mathbb{E}[\\Phi_{i\\pi_{*}(i)\\mathbf{1}_{\\mathcal{H}}}]^{2}}=O(\\frac{1}{|\\mathcal{T}|\\rho^{2N}})}\\end{array}$ . ", "page_idx": 62}, {"type": "text", "text": "Lemma 26. Under the same conditions as Proposition $^{6}$ , ", "page_idx": 62}, {"type": "equation", "text": "$$\n\\frac{V_{12}}{\\mu^{2}}=o(\\frac{1}{|\\mathcal{T}|\\rho^{2N}}).\n$$", "text_format": "latex", "page_idx": 62}, {"type": "text", "text": "Proof. First, we apply the upper bound on $\\mathbb{E}[\\overline{{A}}_{S_{1}}^{\\widehat{\\pmb{\\sigma}}_{A}}\\overline{{B}}_{S_{2}}^{\\widehat{\\pmb{\\sigma}}_{B}}\\overline{{A}}_{T_{1}}^{\\widehat{\\pmb{\\sigma}}_{A}}\\overline{{B}}_{T_{2}}^{\\widehat{\\pmb{\\sigma}}_{B}}\\mathbf{1}_{\\mathcal{H}}]$ as derived in (74), with replacing $k+1$ to $k+2$ everywhere as from definition $v$ is the number of vertices except for $i$ and $j$ . When $j\\neq\\pi_{*}(i)$ , the minimum value of $j$ starts from $-2$ when the union graph consists of two disjoint trees. ", "page_idx": 62}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{E}[\\overline{{A}}_{S_{1}}^{\\hat{\\sigma}_{A}}\\overline{{B}}_{S_{2}}^{\\hat{\\sigma}_{B}}\\overline{{A}}_{T_{1}}^{\\hat{\\sigma}_{A}}\\overline{{B}}_{T_{2}}^{\\hat{\\sigma}_{B}}\\mathbf{1}_{\\mathcal{H}}]\\leq(1+o(1))n^{-D_{+}(a,b,s,\\varepsilon)}\\frac{\\varepsilon}{D}\\big(s p\\wedge s q\\big)^{v+k+2-2N}\\rho^{e(K_{11})}}\\\\ &{\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\times\\,\\sigma_{\\mathrm{eff}}^{4N}\\gamma_{2}^{e(K_{12})+e(K_{21})+e(K_{22})}2^{k+2}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 62}, {"type": "text", "text": "After plugging the upper bound on cross-moments to the ratio, it remains to bound the number of different union graph structures and their corresponding weights. ", "page_idx": 62}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\frac{V_{12}}{\\mathbb{E}[\\Phi_{i\\pi_{*}(i)}\\mathbf{1}\\varkappa]^{2}}}\\\\ &{\\leq\\frac{\\sum_{v+k+2=0}^{4N}\\sum_{\\dot{U}\\in\\mathcal{S}_{i j}(v,k)}\\mathrm{aut}(H)\\mathrm{aut}(I)\\rho^{e(K_{11})}\\left(s p\\wedge s q\\right)^{v+k+2-2N}\\gamma_{2}^{e(K_{12})+e(K_{21})+e(K_{22})}2^{k+2}}{(1+o(1))n^{2N}\\rho^{2N}|T|^{2}n^{z D_{+}(a,b,s,\\varepsilon)/D}}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 62}, {"type": "text", "text": "(a) Case $k=-2$ . We first consider the special case when $k=-2$ . When $k=-2$ , there are two disjoint trees in the decorated union graph and all edges are decorated by a subset of either $\\{S_{1},T_{1}\\}$ or $\\left\\{S_{2},T_{2}\\right\\}$ . Then, $e(K_{11})=e(K_{12})=e(K_{21})=\\bar{e}(K_{22})=0$ . Also $v\\geq2N$ , ", "page_idx": 62}, {"type": "equation", "text": "$$\nV_{12}=\\sigma_{\\mathrm{eff}}^{4N}\\sum_{\\dot{U}\\in S_{i j}(v\\ge2N)}\\mathrm{aut}(H)\\mathrm{aut}(I)n^{-\\frac{z D_{+}(a,b,s,\\varepsilon)}{D}}\\le2\\sigma_{\\mathrm{eff}}^{4N}F_{i j},\n$$", "text_format": "latex", "page_idx": 62}, {"type": "text", "text": "where ", "page_idx": 62}, {"type": "equation", "text": "$$\nF_{i j}:=\\sum_{H\\in{\\cal{T}}}\\sum_{I\\in{\\cal{T}}:\\mathrm{aut}(I)\\leq\\mathrm{aut}(H)}\\mathrm{aut}(H)^{2}\\sum_{{\\dot{U}}\\in S_{i j}(v\\geq2N,H,I)}n^{-{\\frac{z D_{+}(a,b,s,{\\varepsilon})}{D}}},\n$$", "text_format": "latex", "page_idx": 62}, {"type": "text", "text": "and $S_{i j}(v\\geq2N,H,I)$ is the collection of decorated union graphs that have at least $2N+2$ vertices, excess $-2$ , at least 1 edge 1-decorated, and that $S_{1},S_{2}\\cong H,T_{1},T_{2}\\cong I$ . ", "page_idx": 63}, {"type": "text", "text": "For a specific decorated graph $\\dot{U}$ , we denote $t_{1}$ (resp. $t_{2}$ ) as the number of different edges vetween $S_{1}$ and $T_{2}$ (resp. $S_{2}$ and $T_{2}$ ). There are $z=2(t_{1}+t_{2})$ 1-decorated edges and the remaining edges are in set $K_{02}$ or $K_{20}$ . We write out $F_{i j}$ under the summation over $t_{1}$ and $t_{2}$ . ", "page_idx": 63}, {"type": "equation", "text": "$$\n\\begin{array}{c}{F_{i j}=\\displaystyle\\sum_{H\\in\\mathcal{T}}\\displaystyle\\sum_{S_{1},S_{2}\\cong H\\ni I\\in\\mathcal{T},\\mathrm{aut}(H)>\\mathrm{aut}(I),T_{1},T_{2}\\cong I}\\displaystyle\\sum_{t_{1}=0}^{N}\\sum_{t_{2}=0}^{N}n^{-\\frac{z D_{+}(a,b,s,\\varepsilon)}{D}}\\mathbf{1}_{\\left\\{t_{1}+t_{2}\\geq1\\right\\}}}\\\\ {=\\displaystyle\\sum_{t_{1}+t_{2}\\geq1}\\sum_{H\\in\\mathcal{T}}|S(v\\geq2N,H,t_{1},t_{2})|n^{-\\frac{z D_{+}(a,b,s,\\varepsilon)}{D}},}\\end{array}\n$$", "text_format": "latex", "page_idx": 63}, {"type": "text", "text": "where $S(v\\geq2N,H,t_{1},t_{2})$ collects all the possible decorated union graph that have $S_{1},S_{2}\\cong H$ , $T_{1},T_{2}\\cong I$ for some $I\\in\\mathcal{T}$ such that $\\mathrm{aut}(\\bar{I})<\\mathrm{aut}(H)$ , and $S_{1}$ (resp. $S_{2}$ ) differ in $t_{1}$ (resp. $t_{2}$ ) edges with $T_{1}$ (resp. $T_{2}$ ). ", "page_idx": 63}, {"type": "text", "text": "Next, we bound $|S(v\\geq2N,H,t_{1},t_{2})|$ by the following way: First, enumerate through all $S_{1},S_{2}\\cong$ $H$ on the complete graph with all possible structure, this gives ${\\frac{n^{2N}}{\\mathrm{aut}(H)^{2}}}$ . Then, we choose which edges that are overlapped with $T_{1}$ on $S_{1}$ (resp. overlapped with $T_{2}$ on $S_{2}$ ). This is at most $\\binom{N}{t_{1}}\\left(\\binom{N}{t_{2}}\\leq$ $N^{t_{1}+t_{2}}$ . After this, we draw $t_{1}+t_{2}$ new vertices for $T_{1}$ and $T_{2}$ and allow them arbitrarily connecting edges among those N vertices on its chandelier, which is upper bounded by N2 t1+t2 ( ignoring $H$ ). Altogether, ", "page_idx": 63}, {"type": "equation", "text": "$$\n|S_{i j}(v\\ge2N,H,I)|\\le\\frac{n^{2N}}{\\mathrm{aut}(H)^{2}}\\left(\\frac{N^{3}}{n^{2D_{+}(a,b,s,\\varepsilon)/D}}\\right)^{t_{1}+t_{2}}.\n$$", "text_format": "latex", "page_idx": 63}, {"type": "text", "text": "Therefore, ", "page_idx": 63}, {"type": "equation", "text": "$$\nF_{i j}=n^{2N}|\\mathcal{T}|\\sum_{t_{1}+t_{2}\\geq1}\\left(\\frac{N^{3}}{n^{2D_{+}(a,b,s,\\varepsilon)/D}}\\right)^{t_{1}+t_{2}}.\n$$", "text_format": "latex", "page_idx": 63}, {"type": "text", "text": "As assumed in Proposition 6, N = \u0398(log n) and D = o(lolgo lgo gn n) . Therefore, ", "page_idx": 63}, {"type": "equation", "text": "$$\nV_{12}/\\mu^{2}=o\\bigl({\\frac{1}{|T|\\rho^{2N}}}\\bigr).\n$$", "text_format": "latex", "page_idx": 63}, {"type": "text", "text": "(b) Case $k\\,>\\,-2$ . In general, we define $\\dot{U}_{L},\\dot{U}_{M}$ , and $\\dot{U}_{N}$ partition the same as (64) and (65). We also define the weights of each part the same as (66), (67), and (68). We define $P_{L}(v_{L},z)=$ $\\scriptstyle\\sum_{\\dot{U}\\in\\mathcal{U}_{L}(v_{L},z)}w(\\dot{U})$ . The definition of $P_{M}(v_{M})$ and $P_{N}(v_{N},k)$ follow. All union graph class should not have more than $z\\,1\\cdot$ -decorated edges, but specifically we only need this constraint for $\\dot{U}_{L}$ . ", "page_idx": 63}, {"type": "equation", "text": "$e(K_{12})+e(K_{21})+e(K_{22})\\leq4N-2(v+k+1)+z,$ ", "text_format": "latex", "page_idx": 63}, {"type": "equation", "text": "$$\n\\begin{array}{r l r}{\\lefteqn{V_{12}|_{k>-2}\\leq\\sigma_{\\mathrm{eff}}^{4N}\\sum_{v=N}^{4N}\\sum_{k+2=1}^{4N-v}\\sum_{z=1}^{4N}\\gamma_{2}^{4N-2(v+k+2)}2^{k+2}(s p\\wedge s q)^{v-2N+k+2}}}\\\\ &{}&{\\qquad\\times\\sum_{v_{L},v_{M},v_{N}}P_{L}(v_{L},z)P_{M}(v_{M})P_{L}(v_{N},k)\\left(\\frac{\\gamma_{2}}{n^{D_{+}(a,b,s,\\varepsilon)/D}}\\right)^{z}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 63}, {"type": "text", "text": "We show the upper bound for $\\dot{U}_{L}$ part in Lemma 27. The upper bound for $P_{M}$ and $P_{N}$ trivially follows from Lemma 22 and Lemma 23 as they do not use any assumption on edges are all at least 2-decorated, except for the number 11, the possible ways of decoration. So, we change 11 to 15 and then every thing follows. When $z\\neq0$ , $e_{M}$ as defined before in an arbitrary $\\dot{U}_{M}$ has maximum value $2N-(\\bar{v+k+2})-z/2$ (same holds for $e_{N},e_{L}$ but we do not need to use them in our bound). In ", "page_idx": 63}, {"type": "text", "text": "summary, ", "page_idx": 64}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{P_{L}\\big(v_{L},z\\big)\\leq n^{v_{L}}\\lvert\\mathcal{T}\\rvert\\lvert\\beta^{4K}\\big(4L M\\big)^{4L}\\big(4L\\big)!(2\\beta)^{4(K+M)}\\left((4N)^{2}\\beta^{\\frac{K}{\\kappa+M}}\\right)^{z}}\\\\ &{\\quad P_{M}\\big(v_{M}\\big)\\leq R^{\\frac{2\\epsilon_{M}}{M}}n^{v_{M}}\\big(15\\beta\\big)^{(K+M)\\frac{2\\epsilon_{M}}{M}}\\mathbf{1}_{\\{e_{M}\\leq2N-(v+k+2)+z/2\\}}}\\\\ &{\\qquad\\qquad\\qquad\\leq n^{v_{M}}\\left(R^{\\frac{2}{M}}\\big(15\\beta\\big)^{\\frac{2(K+M)}{M}}\\right)^{2N-v-k-2}\\left(R^{\\frac{1}{M}}\\big(15\\beta\\big)^{\\frac{K+M}{M}}\\right)^{z}}\\\\ &{P_{N}\\big(v_{N},k\\big)\\leq n^{v_{N}}\\beta\\big(15\\beta\\big)^{(K+M)2(k+2)}\\big(15R^{4}\\big(v_{N}+2\\big)^{2}\\big)^{k+2}}\\\\ &{\\qquad\\qquad\\leq n^{v_{N}}\\beta\\left((15\\beta\\big)^{2(K+M)}15R^{4}\\big(4N+1\\big)^{2}\\right)^{k+2}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 64}, {"type": "text", "text": "The last inequality holds because $v_{N}\\leq v\\leq4N-(k+2)$ and $k\\ge-1$ . ", "page_idx": 64}, {"type": "text", "text": "Putting every pieces together, ", "page_idx": 64}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\frac{\\dot{V}_{12}|_{k>-2}}{\\mu^{2}}\\leq\\displaystyle\\sum_{k\\geq-1}\\left(\\frac{(15\\beta)^{2(K+M)}30R^{4}(4n+1)^{2}}{n}\\right)^{k+2\\,4N-k-2}\\left(\\frac{\\gamma_{2}^{2}(15\\beta)^{2\\frac{K+M}{M}}R^{\\frac{2}{M}}}{n s(p\\wedge q)}\\right)^{2N-v-k-2}}\\\\ &{\\qquad\\qquad\\times\\displaystyle\\sum_{z=1\\vee(2N-v-k-2)}^{4N}\\left(\\frac{\\gamma_{2}(4N)^{2}R^{\\frac{1}{M}}(15\\beta)^{\\frac{K+M}{M}}\\beta^{\\frac{K}{K+M}}}{n^{\\frac{D}{D}}}\\right)^{z}}\\\\ &{\\qquad\\qquad\\times\\,\\frac{\\beta^{4K+1}(2\\beta)^{4(K+M)}(4L M)^{4L}(4L)!}{|T|\\rho^{2N}}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 64}, {"type": "text", "text": "From the second condition in (25), we first look at the summation of $v$ from $N$ to $2N-k-2$ , ", "page_idx": 64}, {"type": "equation", "text": "$$\n\\sum_{z=1}^{4N}\\left(\\frac{\\gamma_{2}(4N)^{2}R^{\\frac{1}{M}}(15\\beta)^{\\frac{K+M}{M}}\\beta^{\\frac{K}{K+M}}}{n^{\\frac{D_{+}(a,b,s,\\varepsilon)}{D}}}\\right)^{z}=o(1).\n$$", "text_format": "latex", "page_idx": 64}, {"type": "text", "text": "From the first condition in (25), ", "page_idx": 64}, {"type": "equation", "text": "$$\n\\sum_{v=N}^{2N-k-2}\\left(\\frac{\\gamma_{2}^{2}(15\\beta)^{2\\frac{K+M}{M}}R^{\\frac{2}{M}}}{n s(p\\wedge q)}\\right)^{2N-v-k-2}\\leq2.\n$$", "text_format": "latex", "page_idx": 64}, {"type": "text", "text": "When $v>2N-k-2$ , the power $2N-v-k-2<0$ . Observe that $z\\ge2(v+k+2)-4N=$ $z-e(K_{12})-e(K_{21})-2e(K_{22})$ , we have the product of two summations upper bounded by ", "page_idx": 64}, {"type": "equation", "text": "$$\n\\sum_{v=2N-k-1}^{4N-k-2}\\left(\\frac{n s(p\\wedge q)}{\\gamma_{2}^{2}(15\\beta)^{2\\frac{K+M}{M}}R^{\\frac{2}{M}}}\\times\\frac{\\gamma_{2}(4N)^{2}R^{\\frac{1}{M}}(15\\beta)^{\\frac{K+M}{M}}\\beta^{\\frac{K}{K+M}}}{n^{\\frac{D}{D}+(a,b,s,\\epsilon)}}\\right)^{v+k+2-2N}.\n$$", "text_format": "latex", "page_idx": 64}, {"type": "text", "text": "This is clearly $o(1)$ because $N\\ =\\ \\Theta(\\log n)$ and from the first and second condition (25), $n^{D+(a,b,s,\\varepsilon)/D}$ is the only term being $\\log^{\\omega(1)}n$ . ", "page_idx": 64}, {"type": "text", "text": "From the third condition in (25), ", "page_idx": 64}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{\\lefteqn{\\sum_{k\\geq-1}\\left(\\frac{(15\\beta)^{2(K+M)}30R^{4}(4n+1)^{2}}{n}\\right)^{k+2}\\beta^{4K+1}(2\\beta)^{4(K+M)}(4L M)^{4L}(4L)!}}\\\\ &{\\leq2\\left(\\frac{(15\\beta)^{2(K+M)}30R^{4}(4n+1)^{2}}{n}\\right)\\beta^{4K+1}(2\\beta)^{4(K+M)}(4L M)^{4L}(4L)!\\leq1.}\\end{array}\n$$", "text_format": "latex", "page_idx": 64}, {"type": "text", "text": "Therefore, $\\begin{array}{r}{V_{12}/\\mu^{2}=o(\\frac{1}{|T|\\rho^{2N}})}\\end{array}$ . ", "page_idx": 64}, {"type": "text", "text": "M.2 Proof of auxiliary Lemmas ", "text_level": 1, "page_idx": 64}, {"type": "text", "text": "Lemma 27. For $j\\neq\\pi_{*}(i)$ , ", "page_idx": 64}, {"type": "equation", "text": "$$\nP_{L}(v_{L},z)\\leq n^{v_{L}}|\\mathcal{T}|\\beta^{4K}(4L M)^{4L}(4L)!(2\\beta)^{4(K+M)}\\left((4N)^{2}\\beta^{\\frac{K}{K+M}}\\right)^{z}.\n$$", "text_format": "latex", "page_idx": 64}, {"type": "text", "text": "Proof. We define the unlabeled union graph sets corresponding to $\\mathcal{U}(v_{L},z)$ as $\\tilde{\\mathcal{U}}(v_{L},z)$ . From the definition (75) and Claim 3, ", "page_idx": 65}, {"type": "equation", "text": "$$\nP_{L}(v_{L},z)\\leq\\sum_{\\dot{U}_{L}\\in\\tilde{\\mathcal{U}}_{L}(v_{L},z)}\\frac{n^{v_{L}}w(\\dot{U}_{L})}{\\mathrm{aut}(\\dot{U}_{L})}\\leq(2K)^{z}n^{v_{L}}|\\widetilde{\\mathcal{U}}_{L}(v_{L},z)|.\n$$", "text_format": "latex", "page_idx": 65}, {"type": "text", "text": "Recall that $\\dot{U}_{L}$ consists of two disjoint trees, one rooted at $i$ and the other one rooted at $j$ . We consider the branches of chandeliers without overlapping with each other. ", "page_idx": 65}, {"type": "text", "text": "Then, we specify two categories of branches. A branch is called an invader if it is rooted at $i$ (resp. $j)$ ) but in $\\overbar{U}_{L}(j)$ (resp. $\\dot{U}_{L}(i))$ . A branch that is not an invader is called a residence. We observe that there are at most $L+\\lfloor\\frac{z}{K+M}\\rfloor+4$ effective non-isomorphic bulbs among residents (defined in Section $\\mathrm{L}$ , the proof of Proposition 5) because of the followings: 1) If branches are perfectly matched and overlapped, there are at most $L$ pairs of them rooted at $i$ and another $L$ pairs rooted at $j$ . We define effective non-isomorphic bulbs the same as in Lemma 25. Here we have $L$ effective non-isomorphic bulbs because ${S_{1}}^{\\circ}\\cong\\,{S_{2}},{T_{1}}\\cong T_{2}$ . 2) $\\scriptstyle\\lfloor{\\frac{z}{K+M}}\\rfloor$ is the maximum number of fully 1-decorated branches in allowed $\\dot{U}_{L}$ , and 3) There are at most 4 invading branches, each of which can at most fully overlapping with one resident bulb, due to the fact that there cannot be two branches on the same chandelier passing through the same vertex. ", "page_idx": 65}, {"type": "text", "text": "The remaining is to bound $|\\widetilde{U}_{L}(v_{L},z)|$ . We observe that there are at most $4(K+M-1)$ edges from invading branches, which might be attaching to at most $4(K+M-1)$ resident branches. This is because an invader rooted at $j$ may only have its bulb overlapping with $\\dot{U}_{L}(i)$ . In this case, one invader can overlap with multiple resident branches in $\\dot{U}_{L}(i)$ . ", "page_idx": 65}, {"type": "equation", "text": "$$\n|\\widetilde{U}_{L}(v_{L},z)|\\leq\\binom{|\\mathcal{I}|}{L+\\lfloor\\frac{z}{K+M}\\rfloor+4}\\binom{2N}{z/2}(4N)^{\\frac{z}{2}}(4L M)^{4L}(2\\beta)^{4(K+M-1)}(4L)!,\n$$", "text_format": "latex", "page_idx": 65}, {"type": "text", "text": "where $\\binom{|\\mathcal{T}|}{L+\\lfloor\\frac{z}{K+M}\\rfloor+4}$ is the structures of all resident branches, $\\binom{2N}{z/2}$ is the upper bound of choosing which edges to be not overlapped on bulbs assume starting from perfect overlapped bulbs, $(4N)^{\\frac{z}{2}}$ is the bound for placing the remaining $z/2$ 1-decorated vertices, $(\\bar{4}L M)^{4L}$ is a trivial bound on how resident branches have their wires tangling with each other, $(\\beta)^{4(K+M-1)}$ is the structure of invading edges, and lastly $2^{(K+M-1)}(4L)!$ bounds the different interactions between invading edges and the resident branches. To understand the quantity $2^{(K+M-1)}(4L)!$ , this comes from the fact that each invading edge connected to the root can choose one out of at most $4L$ resident branch to attach, and that the following invading edges can choose to stay overlapping with the current resident branch of leave. ", "page_idx": 65}, {"type": "text", "text": "Plugging (87) back into (86) with basic binomial bounds and $|{\\mathcal{I}}|\\leq\\beta^{K}$ , we complete the proof. ", "page_idx": 65}, {"type": "text", "text": "Claim 3. Assume that $j\\neq\\pi_{*}(i)$ . For any $\\dot{U}_{L}\\in\\mathcal{U}_{L}(v_{L},z),$ , ", "page_idx": 65}, {"type": "equation", "text": "$$\nw(\\dot{U}_{L})\\leq\\mathrm{aut}(\\dot{U}_{L})(2K)^{z}.\n$$", "text_format": "latex", "page_idx": 65}, {"type": "text", "text": "Proof. Denote all bulbs contained in $\\dot{U}_{L}(i)$ (resp., $j)$ and are attached to wires rooted at $i$ (resp., $j$ ) as $B_{1},B_{2},\\dots,B_{w}$ . Denote all bulbs contained in $\\dot{U}_{L}(i)$ (resp., $j)$ and are attached to wires rooted at $j$ (resp., $i$ ) as $T_{1},T_{2},\\dots,T_{m}$ . For those branches rooted at $i$ (resp., $j),$ but connect to $j$ (resp., $i)$ ), although they can have their bulbs in $\\dot{U}_{L}(j)$ (resp., $\\dot{U}_{L}(i)_{,}^{\\prime}$ ), they contribute to the weight of non-tree part $\\dot{U}_{N}$ from definitions (66) and (68). ", "page_idx": 65}, {"type": "text", "text": "For an arbitrary bulb $B_{t}$ in $\\dot{U}_{L}(i)\\cup\\dot{U}_{L}(j)$ , we discuss the following three cases. Without loss of generality, we assume that $B_{t}$ is attached to a wire rooted at $i$ . ", "page_idx": 65}, {"type": "text", "text": "Firstly, if there exists another bulb $B_{r}$ such that $B_{r}$ and $B_{t}$ be two bulbs with wires rooted both at $i$ and overlapping with each other. Then, from Corollary 2, we have that $\\sqrt{\\mathrm{aut}(\\boldsymbol{B}_{r})\\mathrm{aut}(\\boldsymbol{B}_{t})}\\leq$ $\\begin{array}{r}{\\mathrm{aut}\\big(\\mathcal{B}_{r}\\cup\\mathcal{B}_{t}\\big)\\big(2K\\big)^{\\frac{E(\\mathcal{B}_{r})\\bigtriangleup E(\\mathcal{B}_{t})}{2}}}\\end{array}$ )E(Br)2\u25b3E(Bt), because each bulb has size K and the difference between two edge set is at most $K$ . Secondly, if $\\boldsymbol{{\\beta}}_{r}$ is full 1-decorated, then it contributes to $\\sqrt{\\mathrm{aut}(\\beta_{r})}$ to $w(\\dot{U}_{L})$ and $\\operatorname{aut}({\\boldsymbol{B}}_{t})$ to $\\operatorname{aut}(\\dot{U}_{L})$ . Thirdly, assume that there is another bulb $B_{t}$ attached to a wire rooted at $j$ partly overlapping with $B_{t}$ , then $\\sqrt{\\mathrm{aut}(\\mathcal{B}_{t})\\mathrm{aut}(T_{r})}\\leq\\mathrm{aut}(\\mathcal{B}_{t}\\cup T_{r})(2K)^{\\left|E\\left(\\mathcal{B}_{4}\\right)\\triangle E\\left(T_{r}\\right)\\right|}$ from Corollary 2. Note that in this case, full overlap is not possible because this invader branch spends at least one edge connecting from $j$ to $i$ . The third case can be considered as a generalized version of the first case. By a product over all overlapping bulbs, we have $w(\\dot{U}_{L})\\leq\\mathrm{aut}(\\dot{U}_{L})(2K)^{z}$ because the total number of edges in the difference sets of overlapping bulbs are upper bounded by $z$ , the number of 1-decorated edges, and the automorphism number of $\\dot{U}_{L}$ is greater than the product of automorphism number of all bulbs. \u53e3 ", "page_idx": 65}, {"type": "text", "text": "", "page_idx": 66}, {"type": "text", "text": "NeurIPS Paper Checklist ", "text_level": 1, "page_idx": 67}, {"type": "text", "text": "1. Claims ", "text_level": 1, "page_idx": 67}, {"type": "text", "text": "Question: Do the main claims made in the abstract and introduction accurately reflect the paper\u2019s contributions and scope? ", "page_idx": 67}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 67}, {"type": "text", "text": "Justification: As stated in the abstract and introduction, the main contribution of the paper is to give the first efficient algorithm for graph matching in the setting of correlated stochastic block models with two balanced communities. This is exactly the content of Theorem 1 in Section 3. The paper also claims, as an application, an efficient algorithm for exact community recovery given correlated stochastic block models. This is exactly the content of Theorem 2 in Section 4. These results, and their underlying assumptions, are discussed in detail in Sections 2, 3, 4, and 7. ", "page_idx": 67}, {"type": "text", "text": "Guidelines: ", "page_idx": 67}, {"type": "text", "text": "\u2022 The answer NA means that the abstract and introduction do not include the claims made in the paper.   \n\u2022 The abstract and/or introduction should clearly state the claims made, including the contributions made in the paper and important assumptions and limitations. A No or NA answer to this question will not be perceived well by the reviewers.   \n\u2022 The claims made should match theoretical and experimental results, and reflect how much the results can be expected to generalize to other settings.   \n\u2022 It is fine to include aspirational goals as motivation as long as it is clear that these goals are not attained by the paper. ", "page_idx": 67}, {"type": "text", "text": "2. Limitations ", "text_level": 1, "page_idx": 67}, {"type": "text", "text": "Question: Does the paper discuss the limitations of the work performed by the authors? Answer: [Yes] ", "page_idx": 67}, {"type": "text", "text": "Justification: We discuss the limitations of our work, and possible future work that may address these, in Section 7. ", "page_idx": 67}, {"type": "text", "text": "Guidelines: ", "text_level": 1, "page_idx": 67}, {"type": "text", "text": "\u2022 The answer NA means that the paper has no limitation while the answer No means that the paper has limitations, but those are not discussed in the paper.   \n\u2022 The authors are encouraged to create a separate \"Limitations\" section in their paper.   \n\u2022 The paper should point out any strong assumptions and how robust the results are to violations of these assumptions (e.g., independence assumptions, noiseless settings, model well-specification, asymptotic approximations only holding locally). The authors should reflect on how these assumptions might be violated in practice and what the implications would be.   \n\u2022 The authors should reflect on the scope of the claims made, e.g., if the approach was only tested on a few datasets or with a few runs. In general, empirical results often depend on implicit assumptions, which should be articulated.   \n\u2022 The authors should reflect on the factors that influence the performance of the approach. For example, a facial recognition algorithm may perform poorly when image resolution is low or images are taken in low lighting. Or a speech-to-text system might not be used reliably to provide closed captions for online lectures because it fails to handle technical jargon.   \n\u2022 The authors should discuss the computational efficiency of the proposed algorithms and how they scale with dataset size.   \n\u2022 If applicable, the authors should discuss possible limitations of their approach to address problems of privacy and fairness.   \n\u2022 While the authors might fear that complete honesty about limitations might be used by reviewers as grounds for rejection, a worse outcome might be that reviewers discover limitations that aren\u2019t acknowledged in the paper. The authors should use their best judgment and recognize that individual actions in favor of transparency play an important role in developing norms that preserve the integrity of the community. Reviewers will be specifically instructed to not penalize honesty concerning limitations. ", "page_idx": 67}, {"type": "text", "text": "3. Theory Assumptions and Proofs ", "text_level": 1, "page_idx": 68}, {"type": "text", "text": "Question: For each theoretical result, does the paper provide the full set of assumptions and a complete (and correct) proof? ", "page_idx": 68}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 68}, {"type": "text", "text": "Justification: We clearly define the model and questions that we study in Section 2, and we fully state our main theoretical results, including all assumptions, in Theorem 1 and Theorem 2. Theorem 2 follows directly from Theorem 1 and prior work, as explained in the main text. For Theorem 1, we provide a brief overview of the proof in Section 5, and we give the full proof in the Appendix. ", "page_idx": 68}, {"type": "text", "text": "Guidelines: ", "page_idx": 68}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include theoretical results.   \n\u2022 All the theorems, formulas, and proofs in the paper should be numbered and crossreferenced.   \n\u2022 All assumptions should be clearly stated or referenced in the statement of any theorems.   \n\u2022 The proofs can either appear in the main paper or the supplemental material, but if they appear in the supplemental material, the authors are encouraged to provide a short proof sketch to provide intuition.   \n\u2022 Inversely, any informal proof provided in the core of the paper should be complemented by formal proofs provided in appendix or supplemental material.   \n\u2022 Theorems and Lemmas that the proof relies upon should be properly referenced. ", "page_idx": 68}, {"type": "text", "text": "4. Experimental Result Reproducibility ", "text_level": 1, "page_idx": 68}, {"type": "text", "text": "Question: Does the paper fully disclose all the information needed to reproduce the main experimental results of the paper to the extent that it affects the main claims and/or conclusions of the paper (regardless of whether the code and data are provided or not)? ", "page_idx": 68}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 68}, {"type": "text", "text": "Justification: This paper does not include experimental results. Our main contribution is the theoretical analysis of a novel efficient graph matching algorithm for correlated SBMs. The algorithm itself is fully described and hence implementable. ", "page_idx": 68}, {"type": "text", "text": "Guidelines: ", "page_idx": 68}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 If the paper includes experiments, a No answer to this question will not be perceived well by the reviewers: Making the paper reproducible is important, regardless of whether the code and data are provided or not.   \n\u2022 If the contribution is a dataset and/or model, the authors should describe the steps taken to make their results reproducible or verifiable.   \n\u2022 Depending on the contribution, reproducibility can be accomplished in various ways. For example, if the contribution is a novel architecture, describing the architecture fully might suffice, or if the contribution is a specific model and empirical evaluation, it may be necessary to either make it possible for others to replicate the model with the same dataset, or provide access to the model. In general. releasing code and data is often one good way to accomplish this, but reproducibility can also be provided via detailed instructions for how to replicate the results, access to a hosted model (e.g., in the case of a large language model), releasing of a model checkpoint, or other means that are appropriate to the research performed.   \n\u2022 While NeurIPS does not require releasing code, the conference does require all submissions to provide some reasonable avenue for reproducibility, which may depend on the nature of the contribution. For example (a) If the contribution is primarily a new algorithm, the paper should make it clear how to reproduce that algorithm. (b) If the contribution is primarily a new model architecture, the paper should describe the architecture clearly and fully. (c) If the contribution is a new model (e.g., a large language model), then there should either be a way to access this model for reproducing the results or a way to reproduce the model (e.g., with an open-source dataset or instructions for how to construct the dataset). ", "page_idx": 68}, {"type": "text", "text": "(d) We recognize that reproducibility may be tricky in some cases, in which case authors are welcome to describe the particular way they provide for reproducibility. In the case of closed-source models, it may be that access to the model is limited in some way (e.g., to registered users), but it should be possible for other researchers to have some path to reproducing or verifying the results. ", "page_idx": 69}, {"type": "text", "text": "5. Open access to data and code ", "text_level": 1, "page_idx": 69}, {"type": "text", "text": "Question: Does the paper provide open access to the data and code, with sufficient instructions to faithfully reproduce the main experimental results, as described in supplemental material? ", "page_idx": 69}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 69}, {"type": "text", "text": "Justification: This paper does not include experiments. ", "page_idx": 69}, {"type": "text", "text": "Guidelines: ", "page_idx": 69}, {"type": "text", "text": "\u2022 The answer NA means that paper does not include experiments requiring code.   \n\u2022 Please see the NeurIPS code and data submission guidelines (https://nips.cc/ public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 While we encourage the release of code and data, we understand that this might not be possible, so \u201cNo\u201d is an acceptable answer. Papers cannot be rejected simply for not including code, unless this is central to the contribution (e.g., for a new open-source benchmark).   \n\u2022 The instructions should contain the exact command and environment needed to run to reproduce the results. See the NeurIPS code and data submission guidelines (https: //nips.cc/public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 The authors should provide instructions on data access and preparation, including how to access the raw data, preprocessed data, intermediate data, and generated data, etc.   \n\u2022 The authors should provide scripts to reproduce all experimental results for the new proposed method and baselines. If only a subset of experiments are reproducible, they should state which ones are omitted from the script and why.   \n\u2022 At submission time, to preserve anonymity, the authors should release anonymized versions (if applicable).   \n\u2022 Providing as much information as possible in supplemental material (appended to the paper) is recommended, but including URLs to data and code is permitted. ", "page_idx": 69}, {"type": "text", "text": "6. Experimental Setting/Details ", "text_level": 1, "page_idx": 69}, {"type": "text", "text": "Question: Does the paper specify all the training and test details (e.g., data splits, hyperparameters, how they were chosen, type of optimizer, etc.) necessary to understand the results?s ", "page_idx": 69}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 69}, {"type": "text", "text": "Justification: This paper does not include experiments. ", "page_idx": 69}, {"type": "text", "text": "Guidelines: ", "page_idx": 69}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments. \u2022 The experimental setting should be presented in the core of the paper to a level of detail that is necessary to appreciate the results and make sense of them. \u2022 The full details can be provided either with the code, in appendix, or as supplemental material. ", "page_idx": 69}, {"type": "text", "text": "7. Experiment Statistical Significance ", "text_level": 1, "page_idx": 69}, {"type": "text", "text": "Question: Does the paper report error bars suitably and correctly defined or other appropriate information about the statistical significance of the experiments? ", "page_idx": 69}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 69}, {"type": "text", "text": "Justification: This paper does not include experiments. ", "page_idx": 69}, {"type": "text", "text": "Guidelines: \u2022 The answer NA means that the paper does not include experiments. ", "page_idx": 69}, {"type": "text", "text": "\u2022 The authors should answer \"Yes\" if the results are accompanied by error bars, confidence intervals, or statistical significance tests, at least for the experiments that support the main claims of the paper.   \n\u2022 The factors of variability that the error bars are capturing should be clearly stated (for example, train/test split, initialization, random drawing of some parameter, or overall run with given experimental conditions).   \n\u2022 The method for calculating the error bars should be explained (closed form formula, call to a library function, bootstrap, etc.)   \n\u2022 The assumptions made should be given (e.g., Normally distributed errors).   \n\u2022 It should be clear whether the error bar is the standard deviation or the standard error of the mean.   \n\u2022 It is OK to report 1-sigma error bars, but one should state it. The authors should preferably report a 2-sigma error bar than state that they have a $96\\%$ CI, if the hypothesis of Normality of errors is not verified.   \n\u2022 For asymmetric distributions, the authors should be careful not to show in tables or figures symmetric error bars that would yield results that are out of range (e.g. negative error rates).   \n\u2022 If error bars are reported in tables or plots, The authors should explain in the text how they were calculated and reference the corresponding figures or tables in the text. ", "page_idx": 70}, {"type": "text", "text": "8. Experiments Compute Resources ", "text_level": 1, "page_idx": 70}, {"type": "text", "text": "Question: For each experiment, does the paper provide sufficient information on the computer resources (type of compute workers, memory, time of execution) needed to reproduce the experiments? ", "page_idx": 70}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 70}, {"type": "text", "text": "Justification: This paper does not include experiments. ", "page_idx": 70}, {"type": "text", "text": "Guidelines: ", "page_idx": 70}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The paper should indicate the type of compute workers CPU or GPU, internal cluster, or cloud provider, including relevant memory and storage.   \n\u2022 The paper should provide the amount of compute required for each of the individual experimental runs as well as estimate the total compute.   \n\u2022 The paper should disclose whether the full research project required more compute than the experiments reported in the paper (e.g., preliminary or failed experiments that didn\u2019t make it into the paper). ", "page_idx": 70}, {"type": "text", "text": "9. Code Of Ethics ", "text_level": 1, "page_idx": 70}, {"type": "text", "text": "Question: Does the research conducted in the paper conform, in every respect, with the NeurIPS Code of Ethics https://neurips.cc/public/EthicsGuidelines? ", "page_idx": 70}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 70}, {"type": "text", "text": "Justification: This research conforms with the NeurIPS Code of Ethics in every respect. Guidelines: ", "page_idx": 70}, {"type": "text", "text": "\u2022 The answer NA means that the authors have not reviewed the NeurIPS Code of Ethics.   \n\u2022 If the authors answer No, they should explain the special circumstances that require a deviation from the Code of Ethics.   \n\u2022 The authors should make sure to preserve anonymity (e.g., if there is a special consideration due to laws or regulations in their jurisdiction). ", "page_idx": 70}, {"type": "text", "text": "10. Broader Impacts ", "text_level": 1, "page_idx": 70}, {"type": "text", "text": "Question: Does the paper discuss both potential positive societal impacts and negative societal impacts of the work performed? ", "page_idx": 70}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 70}, {"type": "text", "text": "Justification: We discuss both the potential positive and negative societal impacts of this work, especially graph matching, in Section 2. ", "page_idx": 70}, {"type": "text", "text": "Guidelines: ", "page_idx": 71}, {"type": "text", "text": "\u2022 The answer NA means that there is no societal impact of the work performed.   \n\u2022 If the authors answer NA or No, they should explain why their work has no societal impact or why the paper does not address societal impact.   \n\u2022 Examples of negative societal impacts include potential malicious or unintended uses (e.g., disinformation, generating fake profiles, surveillance), fairness considerations (e.g., deployment of technologies that could make decisions that unfairly impact specific groups), privacy considerations, and security considerations.   \n\u2022 The conference expects that many papers will be foundational research and not tied to particular applications, let alone deployments. However, if there is a direct path to any negative applications, the authors should point it out. For example, it is legitimate to point out that an improvement in the quality of generative models could be used to generate deepfakes for disinformation. On the other hand, it is not needed to point out that a generic algorithm for optimizing neural networks could enable people to train models that generate Deepfakes faster.   \n\u2022 The authors should consider possible harms that could arise when the technology is being used as intended and functioning correctly, harms that could arise when the technology is being used as intended but gives incorrect results, and harms following from (intentional or unintentional) misuse of the technology.   \n\u2022 If there are negative societal impacts, the authors could also discuss possible mitigation strategies (e.g., gated release of models, providing defenses in addition to attacks, mechanisms for monitoring misuse, mechanisms to monitor how a system learns from feedback over time, improving the efficiency and accessibility of ML). ", "page_idx": 71}, {"type": "text", "text": "11. Safeguards ", "text_level": 1, "page_idx": 71}, {"type": "text", "text": "Question: Does the paper describe safeguards that have been put in place for responsible release of data or models that have a high risk for misuse (e.g., pretrained language models, image generators, or scraped datasets)? ", "page_idx": 71}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 71}, {"type": "text", "text": "Justification: The paper does not involve any data or models that have a high risk for misuse. Guidelines: ", "page_idx": 71}, {"type": "text", "text": "\u2022 The answer NA means that the paper poses no such risks.   \n\u2022 Released models that have a high risk for misuse or dual-use should be released with necessary safeguards to allow for controlled use of the model, for example by requiring that users adhere to usage guidelines or restrictions to access the model or implementing safety filters.   \n\u2022 Datasets that have been scraped from the Internet could pose safety risks. The authors should describe how they avoided releasing unsafe images.   \n\u2022 We recognize that providing effective safeguards is challenging, and many papers do not require this, but we encourage authors to take this into account and make a best faith effort. ", "page_idx": 71}, {"type": "text", "text": "12. Licenses for existing assets ", "text_level": 1, "page_idx": 71}, {"type": "text", "text": "Question: Are the creators or original owners of assets (e.g., code, data, models), used in the paper, properly credited and are the license and terms of use explicitly mentioned and properly respected? ", "page_idx": 71}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 71}, {"type": "text", "text": "Justification: Relevant prior work on models (all theoretical) is cited and discussed in detail throughout the paper, following the norms of the research literature. No code or data is used. Guidelines: ", "page_idx": 71}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not use existing assets.   \n\u2022 The authors should cite the original paper that produced the code package or dataset.   \n\u2022 The authors should state which version of the asset is used and, if possible, include a URL.   \n\u2022 The name of the license (e.g., CC-BY 4.0) should be included for each asset.   \n\u2022 For scraped data from a particular source (e.g., website), the copyright and terms of service of that source should be provided.   \n\u2022 If assets are released, the license, copyright information, and terms of use in the package should be provided. For popular datasets, paperswithcode.com/datasets has curated licenses for some datasets. Their licensing guide can help determine the license of a dataset.   \n\u2022 For existing datasets that are re-packaged, both the original license and the license of the derived asset (if it has changed) should be provided.   \n\u2022 If this information is not available online, the authors are encouraged to reach out to the asset\u2019s creators. ", "page_idx": 71}, {"type": "text", "text": "", "page_idx": 72}, {"type": "text", "text": "13. New Assets ", "text_level": 1, "page_idx": 72}, {"type": "text", "text": "Question: Are new assets introduced in the paper well documented and is the documentation provided alongside the assets? ", "page_idx": 72}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 72}, {"type": "text", "text": "Justification: The paper does not release any new assets. ", "page_idx": 72}, {"type": "text", "text": "Guidelines: ", "page_idx": 72}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not release new assets.   \n\u2022 Researchers should communicate the details of the dataset/code/model as part of their submissions via structured templates. This includes details about training, license, limitations, etc.   \n\u2022 The paper should discuss whether and how consent was obtained from people whose asset is used.   \n\u2022 At submission time, remember to anonymize your assets (if applicable). You can either create an anonymized URL or include an anonymized zip file. ", "page_idx": 72}, {"type": "text", "text": "14. Crowdsourcing and Research with Human Subjects ", "text_level": 1, "page_idx": 72}, {"type": "text", "text": "Question: For crowdsourcing experiments and research with human subjects, does the paper include the full text of instructions given to participants and screenshots, if applicable, as well as details about compensation (if any)? ", "page_idx": 72}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 72}, {"type": "text", "text": "Justification: This paper is a theoretical work and does not involve crowdsourcing nor research with human subjects. ", "page_idx": 72}, {"type": "text", "text": "Guidelines: ", "page_idx": 72}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Including this information in the supplemental material is fine, but if the main contribution of the paper involves human subjects, then as much detail as possible should be included in the main paper.   \n\u2022 According to the NeurIPS Code of Ethics, workers involved in data collection, curation, or other labor should be paid at least the minimum wage in the country of the data collector. ", "page_idx": 72}, {"type": "text", "text": "15. Institutional Review Board (IRB) Approvals or Equivalent for Research with Human Subjects ", "text_level": 1, "page_idx": 72}, {"type": "text", "text": "Question: Does the paper describe potential risks incurred by study participants, whether such risks were disclosed to the subjects, and whether Institutional Review Board (IRB) approvals (or an equivalent approval/review based on the requirements of your country or institution) were obtained? ", "page_idx": 72}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 72}, {"type": "text", "text": "Justification: This paper is a theoretical work and does not involve crowdsourcing nor research with human subjects. ", "page_idx": 72}, {"type": "text", "text": "Guidelines: ", "page_idx": 72}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects. ", "page_idx": 72}, {"type": "text", "text": "\u2022 Depending on the country in which research is conducted, IRB approval (or equivalent) may be required for any human subjects research. If you obtained IRB approval, you should clearly state this in the paper.   \n\u2022 We recognize that the procedures for this may vary significantly between institutions and locations, and we expect authors to adhere to the NeurIPS Code of Ethics and the guidelines for their institution.   \n\u2022 For initial submissions, do not include any information that would break anonymity (if applicable), such as the institution conducting the review. ", "page_idx": 73}]