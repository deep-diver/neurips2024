[{"type": "text", "text": "The Limits of Transfer Reinforcement Learning with Latent Low-rank Structure ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Tyler Sam Yudong Chen Christina Lee Yu Cornell University University of Wisconsin-Madison Cornell University tjs355@cornell.edu yudong.chen@wisc.edu cleeyu@cornell.edu ", "page_idx": 0}, {"type": "text", "text": "Abstract ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Many reinforcement learning (RL) algorithms are too costly to use in practice due to the large sizes $S,A$ of the problem\u2019s state and action space. To resolve this issue, we study transfer RL with latent low rank structure. We consider the problem of transferring a latent low rank representation when the source and target MDPs have transition kernels with Tucker rank $(S,d,A)$ , $(S,S,d),(d,S,A)$ , or $(d,d,d)$ . In each setting, we introduce the transfer-ability coefficient $\\alpha$ that measures the difficulty of representational transfer. Our algorithm learns latent representations in each source MDP and then exploits the linear structure to remove the dependence on $S,A$ , or $S A$ in the target MDP regret bound. We complement our positive results with information theoretic lower bounds that show our algorithms (excluding the $(d,d,d)$ setting) are minimax-optimal with respect to $\\alpha$ . ", "page_idx": 0}, {"type": "text", "text": "1 Introduction ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Recently, reinforcement learning (RL) algorithms have exhibited great success on a variety of problems, e.g., video games [31], robotics [21], etc, that require a series of decisions over time. These algorithms can be used on any problem that can be modeled as a Markov decision process (MDP) with state space cardinality $S$ , action space cardinality $A$ , and horizon $H$ . However, RL algorithms\u2019 practical application is constrained due to the large amounts of data and computational resources required to train models that outperform heuristic approaches. This limitation arises due to the inefficient scaling of RL algorithms with respect to the size of the state and action spaces. In an online setting where rewards are incurred during the process of learning, we may want to minimize the regret, or the difference between the reward of an optimal policy and the reward collected by the learner. In the finite-ho\u221arizon online episodic MDP setting with $K$ episodes, any algorithm must incur regret of at least $\\tilde{\\Omega}(\\sqrt{S A H^{3}K})$ [18]. This regret bound is often too large in practice as many problems modeled as MDPs have large state and action spaces. For example, in the Atari games [25], the state space is the set of all images as a vector of pixel values. ", "page_idx": 0}, {"type": "text", "text": "One way to remove the dependence on the state or action space in RL algorithms is to leverage existing data or models from similar problems through transfer learning. In the transfer learning setting for MDPs, the learner can interact with or query from multiple source MDPs, which the learner can utilize at low-cost to improve their performance in the target MDP [27]. The efficacy of the transfer learning approach depends both on the similarity between the source and the target MDPs, and how information is utilized when transferring knowledge between the source and target. ", "page_idx": 0}, {"type": "text", "text": "As feature learning in MDPs is difficult and expensive, reusing learned low rank representations can greatly improve the performance on new problems. Thus, in this work, we consider the setting when the source and target MDPs exhibit latent low rank structure, and the transfer RL task is to learn latent low rank representation of the state, action, or state-action pair from the source MDPs, and subsequently use it to improve learning on the target MDP. If the learned representations were perfect, then one could remove all dependence on the state space or action space in the learning task on the target MDP. This approach relies on a critical assumption that the transition kernels of the source and target MDPs have low Tucker rank when viewed as an $S$ -by- $S$ -by- $A$ tensor. ", "page_idx": 0}, {"type": "table", "img_path": "pK2qGRY2Hv/tmp/a5ed9a701797e37d51631be0d4100929a06740bcef4a40f47d04894e5c61163f.jpg", "table_caption": [], "table_footnote": ["Table 1: Theoretical guarantees of our algorithms alongside results from literature in the different Tucker rank settings. See Table 3 for the regret bounds of algorithms in each Tucker rank setting with known latent representations. "], "page_idx": 1}, {"type": "text", "text": "", "page_idx": 1}, {"type": "text", "text": "The work [4] studied this problem when the transition kernel is low rank along the first mode, i.e., with Tucker rank $(d,S,A)$ where $d<\\operatorname*{min}\\lbrace S,A\\rbrace$ ; this is also referred to as the Low Rank MDP model. We also consider this setting, as well as the complementary settings in which the transition kernel has low Tucker rank along the second or third mode, i.e., Tucker rank $(S,d,A)$ or $(S,S,d)$ . In addition, we study the $(d,d,d)$ Tucker rank setting, where we can further exploit the low rank structure to improve performance in the target problem. (As we elaborate later, up to a factor of $d$ , the $(d,d,d)$ setting subsumes the remaining settings with Tucker ranks $(d,d,A),(\\bar{S_{,}}\\,d,d)$ and $(d,S,d).$ .) ", "page_idx": 1}, {"type": "text", "text": "The different modes are not interchangeable algorithmically as there is a directionality due to the time of the transition between the current and future state. Additionally, the algorithm in [4] is not computationally tractable as it utilizes an optimization oracle which may not be practical. They assume that the latent representations are within a known finite function class. Our work proposes a computationally efficient algorithm that can handle latent low rank structure on the transition kernel along any of the three different modes. ", "page_idx": 1}, {"type": "text", "text": "As the success of a transfer learning approach depends on the similarity between the source and target problems, we introduce the transfer-ability coefficient $\\alpha$ , which quantifies the similarity between the source and target problems under our low rank assumptions. This coefficient, genearlizing the task-relatedness in [4], captures the unique challenge in the transfer reinforcement learning setting. ", "page_idx": 1}, {"type": "text", "text": "Our Contributions: We propose new computationally efficient transfer RL algorithms that admit the desired efficient regret bounds under all low Tucker rank settings $(S,d,A),(S,S,d),(d,S,A)$ , and $(d,d,d)$ . With enough samples from the source MDPs, we remove the dependence on $S,A$ , or $S A$ in the regret bound on the target MDP. In addition, we introduce the transfer-ability coefficient $\\alpha$ that measures the ease of transferring a latent representation from the source MDPs to target MDP. We establish information theoretic lower bounds showing that our algorithms are optimal with respect to $\\alpha$ (excluding the $(d,d,d)$ Tucker rank setting). In particular, in the $(d,S,A)$ Tucker rank setting, we achieve the optimal dependence of \u03b12while [4] is sub-optimal with a dependence on \u03b15. ", "page_idx": 1}, {"type": "text", "text": "Table 1 summarizes our main theoretical results, suppressing the dependence on common matrix estimation terms, and compares them with the results from [4].1 In the appendix, we further consider the setting where one has access to generative models in both the source and target problems, and show that the benefits of transfer learning go beyond alleviating exploration burden. ", "page_idx": 1}, {"type": "text", "text": "2 Related Work ", "text_level": 1, "page_idx": 1}, {"type": "text", "text": "RL in the $(d,S,A)$ Tucker rank Setting: There exists an extensive literature on Linear MDPs and Low-rank MDPs, which correspond to the $(d,S,A)$ Tucker rank setting. Linear MDPs assume that the dynamics are linear with respect to a known feature mapping $\\phi$ . This allows one to remove all dependence on the size of the state and action spaces and replace it with the rank $d$ of the late\u221ant space [17, 37, 36, 34]. The work [13] proposes an algorithm that admits a regret bound of $\\tilde{O}(\\sqrt{d^{2}\\bar{H}^{2}T})$ , matching the known lower bounds. Our algorithm in the target phase modifies existing linear MDP algorithms to take advantage of the knowledge learned in the source phase. Low Rank MDPs impose the same low-rank structure as linear MDPs but assume that $\\phi$ is unknown. To avoid dependence on the size of the state space, many works in this setting construct algorithms that utilize a computationally inefficient oracle to admit sample complexity or regret bounds that scale with the size of the action space and the log of the size of the function class the true low rank representation [3, 33, 26, 40]. [32] incurs sample complexity on $S A$ instead of the size of the function class to learn near-optimal policies in reward free low rank MDPs. ", "page_idx": 1}, {"type": "text", "text": "", "page_idx": 2}, {"type": "text", "text": "Transfer RL: As feature learning in low rank MDPs is difficult, [4, 10, 23, 15] study representational transfer in low rank MDPs. The work most closely related to ours is [4], which performs reward-free exploration in the source problem to learn a sufficient representation to use in the target problem in the $(d,S,A)$ Tucker rank setting. They propose a task relatedness coefficient that captures the existing representational transfer RL settings [10]. This coefficient is similar to our transfer-ability coefficient but differs as our low rank assumption is imposed on different modes of the probability transition tensor. Their algorithm admits a s\u221aource sample complexity bound of $\\tilde{O}(A^{4}\\alpha^{3}d^{5}H^{7}K^{2}T\\log(|\\Phi||\\Gamma|))$ with a target regret bound of $\\tilde{O}(\\sqrt{d^{3}\\alpha^{2}H^{4}T})$ . Other transfer RL works [10, 23] require reach-ability assumptions to learn the latent representations in the source phase. Similar to transfer RL, reward free RL studies the problem of giving the learner access to only the transition kernel in the first phase, and in the second phase the learner must output a good policy when given multiple reward functions [19, 39, 11, 32]. While reward free RL is similar to our setting, enabling the dynamics to differ between the source and target phase greatly increases the difficulty and changes the objective in the source problem, i.e., learning a good latent representation instead of collecting trajectories that sufficiently explore the state space. ", "page_idx": 2}, {"type": "text", "text": "RL in the $(S,d,A)$ or $(S,S,d)$ Tucker Rank Setting: The work [30] introduces the RL setting in which the transition kernel has Tucker rank $(S,d,A)$ or $(S,S,d)$ . Assuming access to a generative model, their algorithms learn near-optimal polices with sample complexities that scale with $S+A$ , thereby circumventing the $S A$ lower bound for tabular reinforcement learning [6]. The work [35] consider the same low Tucker rank assumption on the dynamics but in the offline RL setting. The works [38, 29, 28] empirically show the benefits of combining matrix/tensor estimation with RL algorithms on common stochastic control tasks. [16] consider the low-rank bandits setting and use a similar algorithm to ours by estimating the singular subspaces of the reward matrix to improve the regret bound\u2019s dependence on the dimension of the problem. ", "page_idx": 2}, {"type": "text", "text": "3 Preliminaries ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "We consider the transfer reinforcement learning setting introduced by [4], in which the learner interacts with $M$ finite-horizon source MDPs and one finite horizon episodic target MDP. All MDPs share the same discrete state space $\\boldsymbol{S}$ with cardinality $S$ , discrete action space $\\boldsymbol{\\mathcal{A}}$ with cardinality $A$ , and finite horizon $H\\in\\mathbb{Z}_{+}$ .2 Let $r=\\{r_{h}\\}_{h\\in[H]}$ be the deterministic unknown reward function of the target MDP, where $r_{h}:S\\times A\\to[0,1]$ . For $\\dot{m}\\in[M]$ , let $r_{m}=\\{r_{m,h}\\}_{h\\in[H]}$ be the deterministic unknown reward function for the $m$ th source MDP, where $r_{m,h}:S\\times A\\to[0,1]$ .3 Let $\\mathcal{P}=\\{P_{h}\\}$ be the transition kernel for the target MDP, where $P_{h}(s^{\\prime}|s,a)$ is the probability of transitioning to state $s^{\\prime}$ from state-action pair $(s,a)$ at time step $h$ . Similarly, for $m\\in[M]$ , ${\\mathcal{P}}_{m}$ is the transition kernel for $m$ th source MDP and defined in the same way as $\\mathcal{P}$ . An agent\u2019s policy has the form $\\pi=\\{\\pi_{h}\\}_{h\\in[H]},\\pi_{h}:{\\cal S}\\to\\Delta(A)$ , where $\\pi_{h}(a|s)$ is the probability that the agent chooses action $a$ at state $s$ and time step $h$ . ", "page_idx": 2}, {"type": "text", "text": "The value function and action-value $(Q)$ function of a policy $\\pi$ are the expected reward of following $\\pi$ given a starting state and starting action, respectively, beginning at time step $h$ . We define these as $\\begin{array}{r}{V_{h}^{\\pi}(s):=\\mathbb{E}\\Big[\\sum_{t=h}^{H}r_{t}\\big(s_{t},\\pi_{t}(s_{t})\\big)|s_{h}=s\\Big],\\quad Q_{h}^{\\pi}(s,a):=\\mathbb{E}\\Big[\\sum_{t=h}^{H}r_{t}(s_{t},a_{t})|s_{h}=s,a_{h}=a\\Big]}\\end{array}$ where $a_{t}\\sim\\pi_{t}(s_{t}),s_{t+1}\\sim P_{t}(\\cdot|s_{t},a_{t})$ . The optimal value function and action value function are $V_{h}^{*}(s):=\\operatorname*{sup}_{\\pi}\\bar{V}_{h}^{\\bar{\\pi}}(s)$ and $\\begin{array}{r}{Q_{h}^{*}(s,a):=\\operatorname*{sup}_{\\pi}Q_{h}^{\\pi}(s,a)}\\end{array}$ for all $(s,a,h)\\in\\mathcal{S}\\times\\mathcal{A}\\times[H]$ . They satisfy the Bellman equations $\\begin{array}{r}{V_{h}^{*}(s)=\\operatorname*{max}_{a\\in\\mathcal{A}}Q_{h}^{*}(s,a),Q_{h}^{*}(s,a)=r_{h}(s,a)+E_{s^{\\prime}\\sim P_{h}(\\cdot\\vert s,a)}[V_{h+1}^{*}(s^{\\prime})]}\\end{array}$ for all $(s,a,h)\\in S\\times A\\times[H]$ . We define an $\\epsilon$ -optimal policy $\\pi$ for $\\epsilon>0$ as any policy that satisfies $V_{h}^{*}(s)-V_{h}^{\\pi}(s)\\leq\\epsilon$ for all $\\dot{s}\\in\\mathcal{S},h\\in[H]$ . Similarly, $Q$ is $\\epsilon$ -optimal if $Q_{h}^{*}(s,a)-Q_{h}^{\\;\\;\\;}(s,a)<\\epsilon$ for all $(s,a,h)\\in S\\times A\\times[H]$ . Also, we use the shorthand $P_{h}V(s,a)=\\mathbb{E}_{s^{\\prime}\\sim P_{h}(\\cdot|s,a)}[V(s^{\\prime})]$ . ", "page_idx": 2}, {"type": "text", "text": "", "page_idx": 3}, {"type": "text", "text": "In the transfer RL problem, the learner first interacts with the $M$ source MDPs without access to the target MDP. In this phase, called the source phase, the learner is given access to a generative model in each of the source MDPs. The generative model takes in a state-action pair $(s,a)$ and time step $h$ and outputs $r_{h}(s,a)$ and an independent sample from $P_{h}(\\cdot|s,a)$ [20]. Access to a generative model in the source phase is necessary; in particular, it has been shown in [4, Theorem 4.1] that without access to a generative model in the source phase, one cannot learn a near-optimal policy in the target phase using the learned representation. Then, in the next phase, called the target phase, the learner loses access to the source MDPs and interacts only with the target MDP in a standard online model, without access to a generative model. The performance of the learner is evaluated by two metrics: i) the regret in the target MDP, i.e., $\\begin{array}{r}{R e g r e t(T)=\\sum_{k\\in[K]}V_{1}^{*}(s)-V_{1}^{\\pi^{k}}(s)}\\end{array}$ , where $\\pi^{k}$ is the learner\u2019s policy in episode $k$ , and ii) the number of samples taken in the source phase. ", "page_idx": 3}, {"type": "text", "text": "3.1 The Tucker Rank of a Tensor ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "For the reader\u2019s convenience, we first recall the standard definition of the Tucker rank of a tensor. ", "page_idx": 3}, {"type": "text", "text": "Definition 1 (Tucker Rank [24]). $A$ tensor $M\\ \\in\\ \\mathbb{R}^{n_{1}\\times n_{2}\\times n_{3}}$ has Tucker rank $(d_{1},d_{2},d_{3})$ if $(d_{1},d_{2},d_{3})$ is the smallest such that there exists a core tensor $X\\ \\in\\ \\mathbb{R}^{d_{1}\\times d_{2}\\times d_{3}}$ and matrices $G_{i}\\in\\mathbb{R}^{n_{i}\\times d_{i}}$ for $i\\in$ [3] with orthonormal columns such that ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\begin{array}{r}{M(a,b,c)=\\sum_{i\\in[d_{1}],j\\in[d_{2}],k\\in[d_{3}]}X(i,j,k)G_{1}(a,i)G_{2}(b,j)G_{3}(c,k).}\\end{array}\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "We note in passing that all our sample complexity and regret bounds in Table 1 remain valid when $d$ is an upper bound on the exact rank. In standard MDPs, the transition kernel can have Tucker rank $(S,S,A)$ as there is no low rank structure imposed on the tensor. In this work, we investigate the benefits of assuming that the transition kernel is low rank along each mode/dimension of the transition kernel, which corresponds to the $(S,d,A),(S,S,d)$ , and $(d,S,A)$ Tucker rank settings. To illustrate the difference in these three settings, we consider $d=1$ and present the corresponding structure of the transition kernel in Equations (1), (2), and (3), respectively: ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{\\operatorname{Tucker\\,rank}{(S,1,A)}\\colon\\quad}&{P(s^{\\prime}|s,a)=\\mu(s)\\phi(s^{\\prime},a),}\\\\ {\\operatorname{Tucker\\,rank}{(S,S,1)}\\colon\\quad}&{P(s^{\\prime}|s,a)=\\mu(a)\\phi(s^{\\prime},s),}\\\\ {\\operatorname{Tucker\\,rank}{(1,S,A)}\\colon\\quad}&{P(s^{\\prime}|s,a)=\\mu(s^{\\prime})\\phi(s,a),}\\end{array}\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "for some functions $\\mu,\\phi$ defined on the appropriate domains. Figure 1 pictorially displays the $(S,S,d)$ Tucker rank assumption on the transition kernel. While the three settings may seem similar, the $(S,d,A)$ and $(S,S,d)$ Tucker rank settings differ significantly from the $(d,S,A)$ Tucker rank setting (i.e., Low Rank MDP). In particular, the $(d,S,A)$ setting assumes low rank structure across time, i.e., the current state and action vs. the next state, while the other Tucker rank assumptions impose low rank structure between the current state and action. These differences are significant as each setting requires different algorithms in the target problem and construction for the lower bounds. ", "page_idx": 3}, {"type": "text", "text": "Additionally, we analyze the $(d,d,d)$ Tucker rank setting, where the transition kernel fully factorizes, in which case the next state, current state, and action all have separate low rank representations. This assumption allows us to further exploit the low rank structure to improve the regret bound in the target phase when compared to the $(S,d,A)$ and $(S,S,d)$ Tucker rank settings. Note that this $(d,d,d)$ Tucker rank assumption is equivalent to imposing low rank along any two modes of the transition kernel, up to factors of $d$ in the sample complexity and regret bounds. For example, for an $(S,d,d)$ Tucker rank transition kernel $P$ , one can factor the $S\\times d\\times d$ core tensor into a $S\\times d$ orthonormal matrix and $d^{2}\\times d\\times d$ core tensor, which implies $P$ has Tucker rank $(d^{2},d,d)$ . ", "page_idx": 3}, {"type": "text", "text": "While the sample complexity and regret bound of each algorithm differ in each Tucker rank setting, one should choose which algorithm to use based on the low rank structure inherent in their problem. For example, in the $(S,S,d)$ Tucker rank setting, one assumes that each action has a low rank representation. One potential application of this setting is a personal movie recommender system. Specifically, the states are user\u2019s different states of mind while each action chooses a movie from a large collection. As movies in the same genre evoke similar responses, each action can be mapped to a lower dimensional space with the axis being each genre. In contrast, each state of mind is distinct. In the $(S,d,A)$ Tucker rank setting, one assumes that the state one transitions from has a low rank representation. The $(d,d,d)$ Tucker rank setting combines the two previous assumptions and asserts that current states and actions have separate low dimensional representations while low rank MDPs with $(d,S,A)$ Tucker rank assume that each state-action pair has a joint low rank representation. For sake of brevity, we will only present our assumption and algorithm for the $(S,S,d)$ Tucker rank setting in the main body of this work and defer the other settings to the appendix. ", "page_idx": 3}, {"type": "image", "img_path": "pK2qGRY2Hv/tmp/a7cdccef36c12d1d62b2b0fac799a65f695729592e5928871d7bb2c020e09f5b.jpg", "img_caption": ["Figure 1: Transition kernel with Tucker rank $(\\bar{S bar{,}}\\bar{S},d)$ ", "Figure 2: A hard transfer learning example where one estimates $G_{T}$ with $G_{1}$ and $G_{2}$ "], "img_footnote": [], "page_idx": 4}, {"type": "text", "text": "", "page_idx": 4}, {"type": "text", "text": "3.2 Low Tucker Rank MDPs ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "We first define the incoherence $\\mu$ of a matrix, which is used in the regularity conditions of our Tucker rank assumption. ", "page_idx": 4}, {"type": "text", "text": "Definition 2 (Incoherence). Let $X\\in\\mathbb{R}^{m\\times n}$ have rank $d$ with singular value decomposition $X=$ $U\\Sigma V^{\\top}$ with $U\\,\\in\\,\\mathbb{R}^{m\\times d}$ , $V\\,\\in\\,\\mathbb{R}^{n\\times d}$ . Then, $X$ is $\\mu$ -incoherent if for all $i\\,\\in\\,[m],j\\,\\in\\,[n],$ , $\\parallel\\!U(i,:$ $)\\|_{2}\\leq\\sqrt{d\\mu/m}$ and $\\|V(j,:)\\|_{2}\\leq\\sqrt{d\\mu/n}$ . ", "page_idx": 4}, {"type": "text", "text": "A small $\\mu$ guarantees that the signal in $U$ and $V$ is sufficiently spread out among the rows in those matrices. The notion of incoherence is pervasive in the low-rank estimation literature [7, 8]. ", "page_idx": 4}, {"type": "text", "text": "Introduced in [30], we assume that reward functions are low rank and the transition kernels have low Tucker rank in each of the source and target MDPs. The main benefti of Assumption 1 is that for any value function $V$ , the Bellman update of any value function, $Q_{h}=r_{h}+P_{h}V$ , is a low rank matrix due to Proposition 4 [30]. ", "page_idx": 4}, {"type": "text", "text": "Assumption 1. In each of the $M$ source MDPs, the reward functions have rank $d_{\\cdot}$ , and the transition kernels have Tucker rank $(S,S,d)$ . The target MDP has reward function with rank $d^{\\prime}$ and transition kernels with Tucker rank $(S,S,d^{\\prime})$ where $d^{\\prime}\\leq d M$ . Thus, there exists $S\\times S\\times d$ tensors $U_{m,h}$ , $S\\times S\\times d^{\\prime}$ tensors $U_{h}$ s, $A\\times d$ $\\mu$ -incoherent matrices $G_{m,h}$ with orthonormal columns, $A\\times d^{\\prime}$ $\\mu$ -incoherent matrices $G_{h}$ with orthonormal columns, and $S\\times d$ matrices $W_{m,h}$ , $S\\times d^{\\prime}$ matrices $W_{h}$ such that ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\begin{array}{c l}{P_{m,h}(s^{\\prime}|s,a)=\\sum_{i\\in[d]}G_{m,h}(a,i)U_{m,h}(s^{\\prime},s,i),}&{r_{m,h}(s,a)=\\sum_{i\\in[d]}G_{m,h}(a,i)W_{m,h}(s,i),}\\\\ {P_{h}(s^{\\prime}|s,a)=\\sum_{i\\in[d^{\\prime}]}G_{h}(a,i)U_{h}(s^{\\prime},s,i),}&{r_{h}(s,a)=\\sum_{i\\in[d^{\\prime}]}G_{h}(a,i)W_{h}(s,i)}\\end{array}}\\end{array}\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "where $\\begin{array}{r}{\\|\\sum_{s^{\\prime}\\in S}g(s^{\\prime})U_{m,h}(s^{\\prime},s,:)\\|_{2},\\|\\sum_{s^{\\prime}\\in S}g(s^{\\prime})U_{h}(s^{\\prime},s,:)\\|_{2},\\|W_{h}(s)\\|_{2},\\|W_{m,h}(s)\\|_{2}}\\end{array}$ $\\sqrt{A/(d\\mu)}$ for all $s\\in{\\mathcal{S}},\\,a\\in{\\mathcal{A}},\\,h\\in[H]$ , and $m\\in[M]$ for any function $g:S\\rightarrow[0,1]$ . ", "page_idx": 4}, {"type": "text", "text": "The latent representations of the reward function and transition kernel are not unique under our assumption. Figure 1 visualizes the low rank structure Assumption 1 imposes on the transition kernel. While Assumption 1 states that the source MDPs and target MDPs have latent low rank structure, the assumption does not guarantee that low rank representations are similar. Additionally, we allow target MDP to be more complex than a single source MDP (at most Tucker rank $(S,S,d M)$ compared to Tucker rank $(S,S,d)$ , respectively). Thus, to allow for transfer learning, we assume that for each step $h\\in[H]$ , the space spanned by the target latent factors is a subset of the space spanned by the latent factors from all the source MDPs. ", "page_idx": 4}, {"type": "text", "text": "Assumption 2. Suppose Assumption 1 holds. The target MDP latent factors $G_{h}$ and source MDP latent factors $G_{m,h}$ satisfy for all $h\\in[H]$ $|,\\operatorname{Span}(\\{G_{h}(:,i)\\}_{i\\in[d^{\\prime}]})\\subseteq\\operatorname{Span}(\\{G_{m,h}(:,i)\\}_{i\\in[d],m\\in[M]})$ . ", "page_idx": 5}, {"type": "text", "text": "Under Assumption 2, it is possible that no single source MDP captures the target MDP, but the union of all source MDP does. It is also possible that the source MDPs span a strictly larger subspace than the target MDP. ", "page_idx": 5}, {"type": "text", "text": "Thanks to the above assumptions, by estimating the latent features $\\{G_{m,h}\\}$ of the source MDPs, we can construct an approximation of the target features $\\{G_{h}\\}$ without interacting with the target MDP, which is essential to transfer learning. Assumption 1 only upper bounds the rank of $Q_{m,h}^{*}$ by $d$ However, to learn each source latent factor, one needs to obtain a good estimate of a rank $d$ matrix with at least one large entry. Therefore, we assume that the optimal $Q$ -functions in each source MDP are full rank with the largest entry lower bounded by a constant. ", "page_idx": 5}, {"type": "text", "text": "Assumption 3. For each $m\\in[M],h\\in[H],$ , the optimal $Q$ -function of the $m$ -th source MDP at step $h$ satisfies rank $:(Q_{m,h}^{*})=d$ and $\\|Q_{m,h}^{*}\\|_{\\infty}\\geq C$ for some $C\\in\\mathbb{R}^{+}$ . ", "page_idx": 5}, {"type": "text", "text": "This assumption allows one to learn the near-optimal $Q$ -functions from noisy samples of the source MDPs. Assumption 3 and its variants are common in the literature of noisy low-rank estimation [2, 9]. Without the above assumption (the rank of $Q^{*}$ is strictly less than $d$ ), then one cannot learn every latent factor $G_{m,h}(:,i)$ since it may have a zero singular value, and thus using the approximate feature mapping would result in regret linear in $T$ . Similarly, $\\|Q^{*}\\|_{\\infty}\\geq C$ ensures that some entries of $Q^{*}$ are sufficiently large and prevents the noise from dominating the low rank signal that one learns in the source phase. ", "page_idx": 5}, {"type": "text", "text": "4 Transfer-ability ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "Our transfer-ability coefficient is motivated by the following observation. Under Assumption 2, we can construct each target latent factor $G_{h}$ with a linear combination of the source latent factors $G_{m,h}$ The magnitudes of the coefficients correspond to the difficulty in estimating the target latent factor because the estimation error of $G_{m,h}$ is amplified by its coefficient. Thus, when these coefficients are too large, transfer learning is essentially impossible; one example is when the source latent factors are almost identical or parallel to each other while the target latent factor is orthogonal to the source latent factors (see Figure 2). ", "page_idx": 5}, {"type": "text", "text": "However, these coefficients are not unique and are a function of the source and target latent factors. Furthermore, as the source MDPs latent factors of $Q_{m,h}^{*}$ and target latent factors $\\{G_{h}\\}$ are not unique, each choice of latent factor results in a different set of coefficients. Thus, we introduce $B_{h}$ as the set containing all such coefficients given the subspaces from the target and source MDPs. Let $\\mathcal{G}_{S,h}$ be the set of all $\\mathbb{R}^{S\\times d}$ orthonormal latent factor matrices with columns that span the column space of $Q_{m,h}^{*}$ for all $m\\in[M]$ , and let $\\mathcal{G}_{T,h}$ be the set of all $\\mathbb{R}^{S\\times d^{\\prime}}$ orthonormal latent factor matrices with columns that span the column space of $P_{h}(s^{\\prime})$ for all $s^{\\prime}\\in\\mathcal{S}$ . Then, we define the set $B_{h}(\\mathcal{G}_{T,h},\\mathcal{G}_{S,h})$ to contain all such coefficients, i.e., $B_{h}\\in\\mathbb{R}^{d^{\\prime},d,M}$ and $B_{h}\\in B_{h}(\\mathcal{G}_{T,h},\\mathcal{G}_{S,h})$ if there exists $G_{h}\\in\\mathcal{G}_{T,h},G_{m,h}\\in$ $\\mathcal{G}_{S,h}$ such that for all $\\begin{array}{r}{i\\in[d^{\\prime}],h\\in[H],G_{h}(\\cdot,i)=\\sum_{j\\in[d],m\\in[M]}B_{h}(i,j,m)G_{m,h}(\\cdot,j)}\\end{array}$ . Now, we define $\\alpha$ , which precisely measures the challenge involved in transferring the latent representation. ", "page_idx": 5}, {"type": "text", "text": "Definition 3 (Transfer-ability Coefficient). Given a transfer RL problem that satisfies Assumptions $^{\\,l}$ , 2, and 3, with the definition of $\\boldsymbol{B}_{h}$ above, we define \u03b1 as ", "page_idx": 5}, {"type": "equation", "text": "$$\n\\alpha:=\\operatorname*{max}_{h\\in[H]}\\operatorname*{min}_{\\substack{B\\in B_{h}\\left(\\mathcal{G}_{T,h},\\mathcal{G}_{S,h}\\right)\\,i\\in[d^{\\prime}],j\\in[d],m\\in[M]}}|B(i,j,m)|.\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "Note that the minimum is taken over all latent factor matrices. When there is only one source MDP, $\\alpha$ is small, i.e., less than or equal to one, because the columns of $G$ form an orthonormal basis of the space containing the target latent factor. In the best case, $\\alpha$ is $1/(d M)$ (see Appendix D). On the other hand, when there are multiple source MDPs, $\\alpha$ can be arbitrarily large as in Figure 2; in this case, the estimation error of $G_{1}$ and $G_{2}$ are amplified by $\\alpha$ when estimating $G_{T}$ using $G_{1}$ and $G_{2}$ . We remark that adding more source MDPs or increasing the rank of $Q_{m,h}^{*}$ will not increase $\\alpha$ as one can use the same set of coefficients without the additional source MDP or larger subspace of $Q_{m,h}^{*}$ . See Appendix D for more discussion on $\\alpha$ . ", "page_idx": 5}, {"type": "text", "text": "Our transfer-ability coefficient is similar to the quantity $\\alpha_{\\mathrm{max}}$ defined in [4]. While these terms both quantify the similarity between the source and target MDPs, in our setting, we allow for the source MDPs\u2019 state latent factors, $\\{G_{m,h}\\}$ , to differ from target MDP\u2019s state latent factors while [4] assumes that all MDPs share the same latent representation $\\phi$ . Our setting is more general than the one in [4] even when assuming the same Tucker rank assumption. ", "page_idx": 6}, {"type": "text", "text": "4.1 Information Theoretic Lower Bound ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "To formalize the importance of $\\alpha$ , we prove a lower bound that shows that a dependence on $\\alpha$ in the sample complexity of the source phase is necessary to benefti from transfer learning. Before proving our main result, we first present an intermediate lower bound to provide intuition on how $\\alpha$ measures the difficulty in transferring a learned representation. ", "page_idx": 6}, {"type": "text", "text": "Theorem 1. There exist two transfer $R L$ instances such that (i) they satisfy Assumptions 1 and 2, (ii) they cannot be distinguished without observing $\\Omega(\\alpha^{2})$ samples in the source phase, and (3) they have target action latent features that are orthogonal to each other. ", "page_idx": 6}, {"type": "text", "text": "Learning a latent representation $G$ that is orthogonal to the true representation is no better than randomly guessing a representation $G^{\\prime}$ in the source phase; using either $G$ or $G^{\\prime}$ in the target phase incurs regret linear in $T$ . Thus, Theorem 1 states that without observing $\\Omega(\\alpha^{2})$ samples in the source MDPs, one cannot learn a good policy in the target phase with $G$ or $G^{\\prime}$ , and one should disregard the information from the so\u221aurce MDPs and use a non-transfer learning RL algorithm to achieve regret bound that scales with $\\sqrt{T}$ . Therefore, $\\Omega(\\alpha^{2})$ samples are required to benefti from transfer learning. ", "page_idx": 6}, {"type": "text", "text": "To prove Theorem 1, we construct two $(S,S,1)$ transfer RL problems that satisfies Assumption 2 with similar source action latent representations $G_{m,h}^{i}\\in\\mathcal{G}$ but orthogonal target action latent representations $G_{T}^{i}$ for $i\\in\\{1,2\\}$ . To avoid learning the incorrect representation, one must identify the transfer RL problem by differentiating the $Q^{*}\\mathrm{s}$ . By construction, the $Q^{*}\\mathrm{s}$ for the two transfer RL problems differ by at most $1/\\alpha$ entrywise, so one must observe $\\Omega(\\alpha^{2})$ samples in the source problem from standard hypothesis testing lower bounds [5]. Observing less samples in the source problem results in an estimate orthogonal to the true target representation with constant probability. See Appendix E for the formal proof. One can easily prove a similar result in the $(S,d,A)$ and $(\\check{d},S,A)$ Tucker rank setting with similar constructions by switching the states and actions (see Appendices $\\boldsymbol{\\mathrm F}$ and G). ", "page_idx": 6}, {"type": "text", "text": "5 Algorithm ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "We now present our algorithm that achieves the optimal dependence on $\\alpha$ . In the source phase, our algorithm can use any algorithm that learns $\\epsilon_{}$ -optimal $Q$ functions on each source MDP. As the error bound on the estimated feature representation depends on the incoherence of $Q_{m,h}^{*}$ , we use LR-EVI, which combines empirical value iteration with low rank matrix estimation [30]. After obtaining estimates $\\bar{Q}_{m,h}$ of $Q_{m,h}^{*}$ , our algorithm computes the singular value decompositions (SVDs) of each $\\bar{Q}_{m,h}$ to construct the latent feature representation $\\tilde{G}$ by scaling and concatenating the singular vectors. Then, in the target phase, our algorithm deploys a modification of LSVI-UCB [17] adapted to our Tucker rank setting called LSVI-UCB-(S, S, d) using the $\\tilde{G}$ . For ease of notation, we define $T_{k,h}^{s}=\\{k^{\\prime}\\in[k]|s_{h}^{k}=s\\}$ , which is the set of episodes before $k$ , in which one was at $s$ at time step $h$ ", "page_idx": 6}, {"type": "text", "text": "", "page_idx": 6}, {"type": "table", "img_path": "pK2qGRY2Hv/tmp/5be12fd6b6b895fbe6aa42ef5cc7ea33724b27ff1e5e39d0b731feb026f2a2b4.jpg", "table_caption": [], "table_footnote": [], "page_idx": 6}, {"type": "text", "text": "LSVI-UCB-(S, S, d) uses the same mechanisms as LSVI-UCB, but we compute coefficients and Gram matrices for each action. Specifically, we update the weights $w_{h}^{s}$ with the solution to the ", "page_idx": 6}, {"type": "text", "text": "Algorithm 2 Target Phase: LSVI-UCB-(S, S, d) ", "page_idx": 7}, {"type": "text", "text": "Input: $\\lambda,\\beta_{k,h}^{s},\\hat{\\tilde{G}}$   \n1: for $k\\in[K]$ do   \n2: Receive initial state $s_{1}^{k}$ .   \n3: for $h=H,\\ldots,1$ do   \n4: for $s\\in S$ do   \n5: /\\* Compute Gram matrix $\\Lambda_{h}^{s}$ for each state s \\*/   \n6: $\\begin{array}{r}{\\Lambda_{h}^{s}\\gets\\sum_{t\\in T_{k-1,h}^{s}}\\hat{\\tilde{G}}_{h}(a_{h}^{t})\\hat{\\tilde{G}}_{h}(a_{h}^{t})^{\\top}+\\lambda\\mathbf{I}.}\\end{array}$ .   \n7: $/*$ Estimate $w_{h}^{s}$ via regularized least squares \\*/   \n8: $\\begin{array}{r}{\\mathrm{Set}\\,w_{h}^{s}\\gets(\\Lambda_{h}^{s})^{-1}\\sum_{t\\in T_{k-1,h}^{s}}\\hat{G}_{h}(a_{h}^{t})\\,\\Big[r_{h}(s,a_{h}^{t})+\\operatorname*{max}_{a^{\\prime}\\in A}Q_{h+1}(s_{h+1}^{t},a^{\\prime})\\Big].}\\end{array}$   \n9: /\\* Estimate $Q^{*}$ via the low rank structure with optimism \\*/   \n10: $\\mathrm{Set}\\,Q_{h}(\\cdot,\\cdot)\\gets\\operatorname*{min}\\Big(H,\\langle w_{h}^{\\cdot},\\hat{\\tilde{G}}_{h}(\\cdot)\\rangle+\\beta_{k,h}^{\\cdot}\\sqrt{\\hat{\\tilde{G}}_{h}(\\cdot)^{\\top}(\\Lambda_{h}^{\\cdot})^{-1}\\hat{\\tilde{G}}_{h}(\\cdot)}\\Big).$   \n11: for $h\\in[H]$ do   \n12: Take action $a_{h}^{k}\\leftarrow\\operatorname*{max}_{a\\in A}Q_{h}(s_{h}^{k},a)$ , and observe $s_{h+1}^{k}$ . ", "page_idx": 7}, {"type": "text", "text": "regularized least squares problem, ", "page_idx": 7}, {"type": "equation", "text": "$$\n\\begin{array}{r}{w_{h}^{s}\\gets\\arg\\operatorname*{min}_{w\\in\\mathbb{R}^{d}}\\sum_{t\\in T_{k,h}^{s}}(r_{h}(s,a_{h}^{t})+\\operatorname*{max}_{a^{\\prime}\\in A}Q_{h+1}(s_{h+1}^{t},a^{\\prime})-w^{\\top}\\tilde{G}_{h}(a_{h}^{t}))^{2}+\\lambda\\|w\\|_{2}^{2},}\\end{array}\n$$", "text_format": "latex", "page_idx": 7}, {"type": "text", "text": "using the reward when $s$ was observed and add an exploration bonus $\\beta_{k,h}^{s}\\sqrt{\\hat{\\tilde{G}}_{h}(a)^{\\top}(\\Lambda_{h}^{s})^{-1}\\hat{\\tilde{G}}_{h}(a)}$ to our estimate of $Q^{*}$ , which is common in linear MDP/bandits algorithms [17, 1]. Multiplying the latent factors by $\\sqrt{A/(d\\mu)}$ to construct G\u02dc ensures that the feature mapping and coefficients are of similar magnitude, which is crucial in adapting the mechanisms of LSVI-UCB to our setting. ", "page_idx": 7}, {"type": "text", "text": "While one may wonder w\u221ahy our modification of LSVI-UCB is necessary, Algorithm 2 improves the regret bound by a factor $\\sqrt{S}$ compared to using any linear MDP algorithm off the shelf; reducing our setting to a linear MDP results in using a feature mappin\u221ag with dimension $d S$ . Thus, using any linear MDP algorithm results in a target regret bound of $\\bar{\\tilde{O}}(\\bar{\\sqrt{d^{2}S^{2}H^{2}T}})$ [41]. However, our algorithm shaves off a factor of $\\sqrt{S}$ as our algorithm computes $S$ copies of $d\\times d$ dimensional gram matrices in contrast to the $d^{2}S^{2}$ dimensional gram matrices used in linear MDP algorithms. ", "page_idx": 7}, {"type": "text", "text": "6 Theoretical Results ", "text_level": 1, "page_idx": 7}, {"type": "text", "text": "In this section, we prove our main theoretical results that show with enough samples in the source problem, our algorithms admit regret bounds that are independent of $S,A$ , or both $S$ and $A$ in the target problem. We first state our main result in the $(S,S,d)$ Tucker rank setting. ", "page_idx": 7}, {"type": "text", "text": "Theorem 2. Suppose Assumptions 1, 2, and 3 hold, and set $\\delta\\,\\in\\,(0,1)$ . Furthermore, assume that, for any $\\epsilon\\in(0,\\sqrt{S H/T})$ , $Q_{m,h}=r_{m,h}+P_{m,h}V_{m,h+1}$ has rank $d$ and is $\\mu$ -incoherent with condition number $\\kappa$ for all $\\epsilon$ -optimal value functions $V_{h+1}$ . Let $\\lambda=1$ and $\\beta_{k,h}^{s}$ be a function of $d,H,|T_{k,h}^{s}|,|S|,M,T$ . Then, for $\\textstyle T\\geq{\\frac{S}{\\alpha^{2}}}$ , using at most $\\tilde{O}(d^{4}\\mu^{5}\\kappa^{4}(1+A/S)M^{2}H^{4}\\alpha^{2}T)$ samples in the source problems, our algorithm has regret $\\tilde{O}(\\sqrt{(d M H)^{3}S T})$ with probability at least $1-\\delta$ . ", "page_idx": 7}, {"type": "text", "text": "Theorem 2 states that using transfer learning improves the performance on the target problem by removing the regret bound\u2019s dependence on the action space. Thus, with enough samples from the source MDPs one can recover a regret bound in the target problem that matches the best regret bound for any algorithm in the $(S,S,d)$ Tucker rank setting with known latent feature representation $G$ concerning $S$ and $T$ . See Appendix E for the proof of Theorem 2. ", "page_idx": 7}, {"type": "text", "text": "For sake of brevity, we present our results in our other Tucker rank settings in Table 1 (see Appendices F, G, and $\\mathrm{H}$ for the formal statements and proofs). In each of our Tucker rank settings, our algorithms use transfer learning to remove the dependence on $S,A$ , or $S A$ in the target regret bound, which matches the dependence on $S$ and $A$ of the best regret bounds of algorithms with known latent representation. While the source sample complexities of Theorems 2 and 10 may seem to not scale linearly in $A$ and $S$ , respectively, we require the horizon in the target phase to be large enough, i.e., $T\\alpha^{2}(\\dot{S}/A+1)\\geq S+\\dot{A}$ and $\\dot{T}\\alpha^{2}(1+\\dot{A}/S)\\geq S+A$ , respectively, so that one observes at least $\\Omega(S+A)$ samples in the source phase. ", "page_idx": 7}, {"type": "text", "text": "", "page_idx": 8}, {"type": "text", "text": "While our dependence on $M$ in the target regret bound may seem sub optimal, our algorithm cannot distinguish which of the $d$ dimensions (out of $d M$ possible dimensions) match the ones in the target MDP without interacting with it. Thus, our algorithm must include all of them, which results in using at worst a $d M$ -dimensional feature representation. However, in the case when the feature representations from source MDPs lie in subspaces that intersect, we can apply a singular value thresholding procedure to remove the unneeded dimensions used in the feature representation at the cost of an increased sample complexity (by a factor of $A$ ) in the source phase (see Appendix C). ", "page_idx": 8}, {"type": "text", "text": "Comparison with [4]: In comparison to Theorem 3.1 from [4], our result, Theorem 14, has similar dependence on $A,d,H$ , and $T$ while our dependence on $\\alpha$ is optimal compared to their $\\alpha^{5}$ dependence 4. While our dependence on $M$ in the regret bound is worse, this is due to our transfer learning setting being more general; we only require that the space spanned by the target features be a subset of the space spanned by the source features instead of having the target features being a linear combination of the source features. Furthermore, our source sample complexity scales with the size of the state space instead of scaling logarithmically in the size of the given function class. ", "page_idx": 8}, {"type": "text", "text": "The proofs of 2, Theorem 10, 15, and 14 synthesize the theoretical guarantees of LR-EVI, singular vector perturbation bounds, and LSVI-UCB or our modification of LSVI-UCB. Given $N$ samples from the source MDPs, we first bound the error between the singular subspaces up to a rotation by $\\sqrt{d^{3}M(S+A)/N}$ (suppressing the dependence on common matrix estimation terms) to construct our feature mapping. Thus, with enough samples in the source MDPs, LR-EVI returns $Q$ functions with singular vectors that can be used to construct a sufficient feature representation; the additional regret incurred from using the approximate feature representation in LSVI-UCB or Algorithm 2 is dominated by the original regret of using the true representation. ", "page_idx": 8}, {"type": "text", "text": "6.1 Discussion of Optimality ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "In the $(S,d,A),(S,S,d),(d,S,A)$ , and $(d,d,d)$ Tucker rank settings, the source sample complexity\u2019s scalings concerning $S,A,H$ , and $T$ are reasonable when learning ${\\sqrt{A/T}},{\\sqrt{S/T}},{\\sqrt{1/T}}$ , and $\\sqrt{1/T}$ -optimal $Q$ functions, respectively, given the $Q$ learning lower bounds in [30]. Similarly, the dependence on $\\mu$ and $\\kappa$ are standard for RL algorithms incorporating matrix estimation. ", "page_idx": 8}, {"type": "text", "text": "In the $(S,d,A),(S,S,d)$ , and $(d,S,A)$ Tucker rank settings, our $\\alpha^{2}$ dependence in the source sample complexity is optimal due to our lower bounds. In the $(d,d,d)$ Tucker rank setting, our $\\alpha^{4}$ dependence is likely optimal when eliminating the dependence on $S$ and $A$ in the target problem; one must combine both sets of singular vectors together, $F:S\\to\\mathbb{R}^{d M}$ and $G:\\bar{\\mathcal{A}}\\bar{\\to}\\,\\mathbf{\\dot{R}}^{d M}$ , to create a feature mapping $\\phi:S\\times\\mathcal{A}\\to\\mathbb{R}^{d^{2}M^{2}}$ , which causes the $\\alpha^{4}$ dependence in our upper bound. However, if $\\alpha^{4}$ is too large, one can use the algorithms from the $(S,d,A)$ or $(S,S,d)$ Tucker rank settings to benefti from transfer learning. Proving an $\\alpha^{4}$ lower bound is an interesting open question. Additionally, the dependence on $d$ and $M$ in this setting is worse as our low rank latent representation of each state-action pair lies in a $d^{2}M^{2}$ dimensional space in contrast to a space with dimension $d M$ ", "page_idx": 8}, {"type": "text", "text": "The regret bounds of our algorithms used in the target phase, i.e., Algorithm 2, Algorithm 4, and LSVIUCB [17], in each Tucker rank setting are optimal with respect to $S,A$ , and $T$ . Since each Tucker rank setting captures tabular MDPs, we can construct lower bounds with a reduction from the bound in [18], e.g., in the $(S,S,d)$ setting, the regret i\u221as at least $\\tilde{\\Omega}(\\sqrt{d S H^{2}T})$ . However, our dependence on $d$ and $H$ are sub-optimal. The extra factor of $\\sqrt{H}$ is likely due to our use of Hoeffding\u2019s inequality instead of tracking the variance of the estimates to use Bernstein\u2019s inequality. Our dependence on $d$ is sub-optimal as LSVI-UCB is \u221asub-optimal with respect to $d$ ; for linear MDPs, LSVI-UCB $^{++}$ [13] admits a regret bound of $\\tilde{O}(\\sqrt{d^{2}H^{2}T})$ , which matches the lower bound from [41]. Thus, to obtain the optimal dependence on $d$ and $H$ , we would need to adapt LSVI-UCB $^{++}$ to our Tucker rank setting. ", "page_idx": 8}, {"type": "text", "text": "7 Conclusion ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "We study transfer RL, in which one transfers a latent representation between source MDPs and target MDP with Tucker rank $(S,S,d),(S,d,A),(d,S,A)$ or $(d,d,d)$ transition kernels. As [4] studied transfer RL in the $(d,S,A)$ Tucker rank setting, our study completes the analysis of representational transfer in RL assuming that one or more modes of the transition kernel is low rank. Furthermore, we propose the transfer-ability coefficient that quantifies the difficulty of transferring latent representations between the source and target problems with information theoretic lower bounds. We propose computationally simple algorithms that admit regret bounds that are independent of $S,A$ , or $S A$ depending on the Tucker rank setting given enough samples from the source MDPs. Furthermore, these regret bounds match the bounds of algorithms that are given the true latent representation. Our dependence on $d$ and $H$ is not optimal and can be improved by adapting the methods in [13] to our setting, which is an interesting open problem. Furthermore, proving theoretical guarantees of other forms of transfer RL is worthwhile and an interesting future direction. ", "page_idx": 9}, {"type": "text", "text": "Acknowledgements: Y. Chen is partially supported by NSF CCF-1704828 and NSF CCF-2233152. ", "page_idx": 9}, {"type": "text", "text": "References ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "[1] Yasin Abbasi-yadkori, D\u00e1vid P\u00e1l, and Csaba Szepesv\u00e1ri. Improved algorithms for linear stochastic bandits. In J. Shawe-Taylor, R. Zemel, P. Bartlett, F. Pereira, and K.Q. Weinberger, editors, Advances in Neural Information Processing Systems, volume 24. Curran Associates, Inc., 2011. [2] Emmanuel Abbe, Jianqing Fan, Kaizheng Wang, and Yiqiao Zhong. Entrywise eigenvector analysis of random matrices with low expected rank. https://arxiv.org/abs/1709.09565, 48, 09 2017. [3] Alekh Agarwal, Sham Kakade, Akshay Krishnamurthy, and Wen Sun. Flambe: Structural complexity and representation learning of low rank mdps. In H. Larochelle, M. Ranzato, R. Hadsell, M. F. Balcan, and H. Lin, editors, Advances in Neural Information Processing Systems, volume 33, pages 20095\u201320107. Curran Associates, Inc., 2020. [4] Alekh Agarwal, Yuda Song, Wen Sun, Kaiwen Wang, Mengdi Wang, and Xuezhou Zhang. Provable benefits of representational transfer in reinforcement learning, 2023. [5] Martin Anthony and Peter L. Bartlett. Neural Network Learning: Theoretical Foundations. Cambridge University Press, USA, 1st edition, 2009. [6] Mohammad Gheshlaghi Azar, R\u00e9mi Munos, and Hilbert J. Kappen. On the sample complexity of reinforcement learning with a generative model. In Proceedings of the 29th International Coference on International Conference on Machine Learning, ICML\u201912, page 1707\u20131714, Madison, WI, USA, 2012. Omnipress. [7] Emmanuel Candes and Benjamin Recht. Exact matrix completion via convex optimization. Communications of the ACM, 55(6):111\u2013119, 2012. [8] Emmanuel Candes and Justin Romberg. Sparsity and incoherence in compressive sampling. Inverse problems, 23(3):969, 2007. [9] Yuxin Chen, Yuejie Chi, Jianqing Fan, Cong Ma, and Yuling Yan. Noisy matrix completion: Understanding statistical guarantees for convex relaxation via nonconvex optimization. SIAM Journal on Optimization, 30:3098\u20133121, 01 2020.   \n[10] Yuan Cheng, Songtao Feng, Jing Yang, Hong Zhang, and Yingbin Liang. Provable benefit of multitask representation learning in reinforcement learning, 2022.   \n[11] Yuan Cheng, Ruiquan Huang, Jing Yang, and Yingbin Liang. Improved sample complexity for reward-free reinforcement learning under low-rank mdps, 2023.   \n[12] Jianqing Fan, Weichen Wang, and Yiqiao Zhong. An $\\ell_{\\infty}$ eigenvector perturbation bound and its application to robust covariance estimation, 2016.   \n[13] Jiafan He, Heyang Zhao, Dongruo Zhou, and Quanquan Gu. Nearly minimax optimal reinforcement learning for linear markov decision processes, 2023.   \n[14] Roger A. Horn and Charles R. Johnson. Matrix Analysis. Cambridge University Press, 1985.   \n[15] Haque Ishfaq, Thanh Nguyen-Tang, Songtao Feng, Raman Arora, Mengdi Wang, Ming Yin, and Doina Precup. Offline multitask representation learning for reinforcement learning, 2024.   \n[16] Yassir Jedra, William R\u00e9veillard, Stefan Stojanovic, and Alexandre Proutiere. Low-rank bandits via tight two-to-infinity singular subspace recovery, 2024.   \n[17] Chi Jin. Provably efficient reinforcement learning with linear function approximation. 2020.   \n[18] Chi Jin, Zeyuan Allen-Zhu, Sebastien Bubeck, and Michael I. Jordan. Is q-learning provably efficient?, 2018.   \n[19] Chi Jin, Akshay Krishnamurthy, Max Simchowitz, and Tiancheng Yu. Reward-free exploration for reinforcement learning. In ICML, 2020.   \n[20] Michael Kearns and Satinder Singh. Finite-sample convergence rates for q-learning and indirect algorithms. In M. Kearns, S. Solla, and D. Cohn, editors, Advances in Neural Information Processing Systems, volume 11. MIT Press, 1999.   \n[21] Jens Kober, J. Andrew Bagnell, and Jan Peters. Reinforcement learning in robotics: A survey. The International Journal of Robotics Research, 32(11):1238\u20131274, 2013.   \n[22] Tor Lattimore, Csaba Szepesvari, and Gellert Weisz. Learning with good feature representations in bandits and in rl with a generative model, 2020.   \n[23] Rui Lu, Gao Huang, and Simon S. Du. On the power of multitask representation learning in linear mdp, 2021.   \n[24] Osman Asif Malik and Stephen Becker. Low-rank tucker decomposition of large tensors using tensorsketch. In S. Bengio, H. Wallach, H. Larochelle, K. Grauman, N. Cesa-Bianchi, and R. Garnett, editors, Advances in Neural Information Processing Systems, volume 31. Curran Associates, Inc., 2018.   \n[25] Volodymyr Mnih, Koray Kavukcuoglu, David Silver, Alex Graves, Ioannis Antonoglou, Daan Wierstra, and Martin Riedmiller. Playing atari with deep reinforcement learning, 2013.   \n[26] Aditya Modi, Jinglin Chen, Akshay Krishnamurthy, Nan Jiang, and Alekh Agarwal. Model-free representation learning and exploration in low-rank mdps. CoRR, abs/2102.07035, 2021.   \n[27] Sinno Jialin Pan and Qiang Yang. A survey on transfer learning. IEEE Transactions on Knowledge and Data Engineering, 22(10):1345\u20131359, 2010.   \n[28] Sergio Rozada and Antonio G. Marques. Tensor and matrix low-rank value-function approximation in reinforcement learning, 2022.   \n[29] Sergio Rozada, Victor Tenorio, and Antonio G. Marques. Low-rank state-action value-function approximation. In 2021 29th European Signal Processing Conference (EUSIPCO), pages 1471\u20131475, 2021.   \n[30] Tyler Sam, Yudong Chen, and Christina Lee Yu. Overcoming the long horizon barrier for sample-efficient reinforcement learning with latent low-rank structure, 2023.   \n[31] Kun Shao, Zhentao Tang, Yuanheng Zhu, Nannan Li, and Dongbin Zhao. A survey of deep reinforcement learning in video games, 2019.   \n[32] Stefan Stojanovic, Yassir Jedra, and Alexandre Proutiere. Spectral entry-wise matrix estimation for low-rank reinforcement learning. In A. Oh, T. Naumann, A. Globerson, K. Saenko, M. Hardt, and S. Levine, editors, Advances in Neural Information Processing Systems, volume 36, pages 77056\u201377070. Curran Associates, Inc., 2023.   \n[33] Masatoshi Uehara, Xuezhou Zhang, and Wen Sun. Representation learning for online and offline rl in low-rank mdps, 2021.   \n[34] Bingyan Wang, Yuling Yan, and Jianqing Fan. Sample-efficient reinforcement learning for linearly-parameterized mdps with a generative model, 2021.   \n[35] Xumei Xi, Christina Lee Yu, and Yudong Chen. Matrix estimation for offline reinforcement learning with low-rank structure, 2023.   \n[36] Lin Yang and Mengdi Wang. Reinforcement learning in feature space: Matrix bandit, kernels, and regret bound. In Hal Daum\u00e9 III and Aarti Singh, editors, Proceedings of the 37th International Conference on Machine Learning, volume 119 of Proceedings of Machine Learning Research, pages 10746\u201310756. PMLR, 13\u201318 Jul 2020.   \n[37] Lin F. Yang and Mengdi Wang. Sample-optimal parametric q-learning using linearly additive features. In ICML, 2019.   \n[38] Yuzhe Yang, Guo Zhang, Zhi Xu, and Dina Katabi. Harnessing structures for value-based planning and reinforcement learning. In International Conference on Learning Representations, 2020.   \n[39] Xuezhou Zhang, Yuzhe ma, and Adish Singla. Task-agnostic exploration in reinforcement learning, 2020.   \n[40] Xuezhou Zhang, Yuda Song, Masatoshi Uehara, Mengdi Wang, Alekh Agarwal, and Wen Sun. Efficient reinforcement learning in block mdps: A model-free representation learning approach, 2022.   \n[41] Dongruo Zhou, Quanquan Gu, and Csaba Szepesvari. Nearly minimax optimal reinforcement learning for linear mixture markov decision processes, 2021. ", "page_idx": 9}, {"type": "text", "text": "", "page_idx": 10}, {"type": "text", "text": "", "page_idx": 11}, {"type": "text", "text": "Contents ", "text_level": 1, "page_idx": 12}, {"type": "text", "text": "1 Introduction 1 ", "page_idx": 12}, {"type": "text", "text": "2 Related Work 2 ", "page_idx": 12}, {"type": "text", "text": "3 Preliminaries 3   \n3.1 The Tucker Rank of a Tensor 4   \n3.2 Low Tucker Rank MDPs 5 ", "page_idx": 12}, {"type": "text", "text": "4 Transfer-ability 6 4.1 Information Theoretic Lower Bound ", "page_idx": 12}, {"type": "text", "text": "5 Algorithm ", "page_idx": 12}, {"type": "text", "text": "6 Theoretical Results 8   \n6.1 Discussion of Optimality 9 ", "page_idx": 12}, {"type": "text", "text": "7 Conclusion 10 ", "page_idx": 12}, {"type": "text", "text": "A Notation Table 14 ", "page_idx": 12}, {"type": "text", "text": "B Table of Regret Bounds with Known Latent Representations 15 ", "page_idx": 12}, {"type": "text", "text": "C Thresholding Procedure in the $(S,S,d)$ Tucker Rank Setting 15   \nC.1 Thresholding Procedure without Knowledge of $d^{\\prime\\prime}$ . . 15 ", "page_idx": 12}, {"type": "text", "text": "D Properties of the Transfer-ability Coefficient $\\alpha$ 16 ", "page_idx": 12}, {"type": "text", "text": "E Omitted Proofs in the $(S,S,d)$ Tucker Rank Setting 18   \nE.1 Proof of Theorem 1 . 19   \nE.2 Proof of Theorem 2 20   \nE.3 Proof of Theorem 3 21   \nF $(S,d,A)$ Tucker Rank Setting 24   \nF.1 Information Theoretic Lower Bound 25   \nF.2 Simulator to Simulator Transfer RL 29 ", "page_idx": 12}, {"type": "text", "text": "", "page_idx": 12}, {"type": "text", "text": "G $(d,S,A)$ Tucker Rank Setting 33 ", "page_idx": 12}, {"type": "text", "text": "H $(d,d,d)$ Tucker Rank Setting 39 ", "page_idx": 12}, {"type": "text", "text": "I $\\ell_{\\infty}$ eigen perturbation bound with non-uniform noise: rank- $r$ case 42 ", "page_idx": 12}, {"type": "text", "text": "A Notation Table ", "text_level": 1, "page_idx": 13}, {"type": "table", "img_path": "pK2qGRY2Hv/tmp/b5407d24a7f1df1f52755430a94020536196c45555a9904c44856a078865755a.jpg", "table_caption": ["Table 2: List of notation "], "table_footnote": [], "page_idx": 13}, {"type": "table", "img_path": "pK2qGRY2Hv/tmp/9c6cf0832aeb36ff543bf506f1124cf6370f84dca7b898ccd55f6d76fd04f257.jpg", "table_caption": ["B Table of Regret Bounds with Known Latent Representations "], "table_footnote": ["Table 3: Theoretical guarantees of our algorithms alongside results from literature in the different Tucker rank settings. To the best of our knowledge, there are no algorithms tailored to the $(d,d,d)$ Tucker rank setting. Instead, one should use a linear MDP algorithm. "], "page_idx": 14}, {"type": "text", "text": "Since each Tucker rank setting captures tabular MDPs, we can construct lower bounds \u221awith a reduction from the bound in [18]; in the $(S,d,A)$ Tucker \u221arank setting, the regret is at least $\\tilde{\\Omega}(\\sqrt{d A H^{2}T})$ , and in the $(S,S,d)$ setting, the regret is at least $\\tilde{\\Omega}(\\sqrt{d A H^{2}T})$ . As mentioned, our dependence on $d$ and $H$ are sub optimal because we modify LSVI-UCB [17], which has a sub-optimal dependence on $d$ and $H$ . Modifying the algorithm from [13] to achieve the optimal dependence on $d$ and $H$ in the $(S,S,d)$ and $(S,d,A)$ Tucker rank settings is an interesting problem for future research. ", "page_idx": 14}, {"type": "text", "text": "C Thresholding Procedure in the $(S,S,d)$ Tucker Rank Setting ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "When the feature representations of each source MDP lies in orthogonal $d$ -dimensional subspaces, we cannot discard any unique dimension of the $M$ subspaces as we cannot tell which of the $d_{\\cdot}$ -dimensions match the ones in the target MDP without interacting with it. However, when the feature mappings from the source MDPs lie in intersecting subspaces, i.e., ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\operatorname{rank}\\left({\\tilde{G}}_{h}\\right)=\\operatorname{rank}\\left({\\sqrt{\\frac{A}{d\\mu}}}\\left[G_{1,h}\\quad.\\dots\\quad G_{M,h}\\right]\\right)=d^{\\prime\\prime}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "for $d^{\\prime}\\;\\leq\\;d^{\\prime\\prime}\\;\\leq\\;d M$ (recall the target MDP has Tucker rank $(S,S,d^{\\prime}))$ , we use the following procedure: after computing $\\tilde{G}_{h}$ via concatenation of $\\hat{G}_{m,h}$ for all $m\\in[M]$ , we perform a singular value decomposition of $\\tilde{G}_{h}$ and threshold the singular values to keep only $d^{\\prime\\prime}$ dimensions. With this procedure, our regret bound now depends on $d^{\\prime\\bar{\\prime}}$ instead of $d M$ at the cost of an increased source sample complexity. We only present the theorem and proof in the $(S,S,d)$ Tucker rank setting, but our results and methods extend to the other Tucker rank settings. ", "page_idx": 14}, {"type": "text", "text": "Theorem 3. Suppose Assumptions $I,\\,2;$ , and $^3$ hold, and assume the source MDP latent factors span a $d^{\\prime\\prime}$ -dimensional space. Let $\\delta\\in(0,1)$ . Furthermore, assume that, for any $\\epsilon\\in(0,\\sqrt{S H/T})$ , $Q_{m,h}\\,=\\,r_{m,h}+P_{m,h}V_{m,h+1}$ has rank $d$ and is $\\mu$ -incoherent with condition number $\\kappa$ for all $\\epsilon$ - optimal value functions $V_{h+1}$ . Let $\\lambda=1$ and $\\beta_{k,h}^{s}$ be a function of $d,H,|T_{k,h}^{s}|,|S|,M,T$ . Then, for $\\textstyle T\\geq{\\frac{S}{\\alpha^{2}}}$ , using at most $\\tilde{O}(d^{7}\\mu^{5}\\kappa^{4}(A+A^{2})M^{3}H^{4}\\alpha^{2}T/(S d^{\\prime\\prime}))$ samples in the source problems, our algorithm has regret $\\tilde{O}(\\sqrt{(d^{\\prime\\prime}H)^{3}S T})$ with probability at least $1-\\delta$ . ", "page_idx": 14}, {"type": "text", "text": "The proof of Theorem 3 follows the proof of Theorem 2, except we require a larger source sample complexity to guarantee with high probability that the $d^{\\prime\\prime}\\!+\\!1$ -th singular value of the concatenated feature representation is sufficiently small. With this procedure, we ensure that our feature representation removes the unneeded dimensions. See Appendix E for proof of the above theorem. ", "page_idx": 14}, {"type": "text", "text": "C.1 Thresholding Procedure without Knowledge of $d^{\\prime\\prime}$ ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "While the above procedure requires knowledge of the dimension of the subspace spanned by the latent features of the source MDPs, one can also threshold small singular values of the concatenated feature mapping as the misspecification error will still be small. The specific procedure is as follows: ", "page_idx": 14}, {"type": "text", "text": "after performing the singular value decomposition on the concatenation of $\\hat{G}_{m,h}$ , we first find the smallest value of $t\\in[d M]$ that satisfies ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\sigma_{t+1}\\leq\\sqrt{\\frac{t H S d\\mu}{\\alpha^{2}T(d M-t)M^{2}A}},\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "and threshold $\\sigma_{t+1},\\dotsc,\\sigma_{d M}$ . Let ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\mathcal{T}=\\left\\{t\\in[d M]|\\sigma_{t+1}\\leq\\sqrt{\\frac{t H S d\\mu}{\\alpha^{2}T(d M-t)M^{2}A}}\\right\\}\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "be the set of $t$ that satisfies the inequality on the singular values. Then, with the specified procedure, our algorithm admits a target regret bound that depends on $t$ instead of $d M$ . Note that $t$ is minimally 1 and at most $d M$ . ", "page_idx": 15}, {"type": "text", "text": "Theorem 4. Suppose Assumptions $^{\\,I}$ , 2, and 3 hold. Let $\\delta\\in(0,1)$ and $t=\\mathrm{min}_{t^{\\prime}\\in\\mathcal{T}}\\,t^{\\prime}$ . Furthermore, assume that, for any $\\epsilon\\in(0,\\sqrt{S H/T})$ , $Q_{m,h}=r_{m,h}+P_{m,h}V_{m,h+1}$ has rank $d$ and is $\\mu$ -incoherent with condition number $\\kappa$ for all $\\epsilon$ -optimal value functions $V_{h+1}$ . Let $\\lambda=1$ and $\\beta_{k,h}^{s}$ be a function of $d,H,|T_{k,h}^{s}|,|S|,M,T$ . Then, for $\\textstyle T\\geq{\\frac{S}{\\alpha^{2}}}$ , using at most $\\tilde{O}(d^{5}\\mu^{5}\\kappa^{4}(1+A/S)M^{3}H^{4}\\alpha^{2}T)$ samples in the source problems, our algorithm has regret $\\tilde{O}(\\sqrt{(t H)^{3}S T})$ with probability at least $1-\\delta$ . ", "page_idx": 15}, {"type": "text", "text": "With an increase in a factor of $d M$ to the source sample complexity, we can potentially improve the regret bound of the target by decreasing the dimension of the feature representation from $d M$ to $t$ . See Appendix $\\boldsymbol{\\mathrm E}$ for the proof of the above theorem. ", "page_idx": 15}, {"type": "text", "text": "D Properties of the Transfer-ability Coefficient $\\alpha$ ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "In this section, we prove properties of $\\alpha$ and provide easy and hard instances. We first bound the values of $\\alpha$ . ", "page_idx": 15}, {"type": "text", "text": "Lemma 1. Let \u03b1 be defined according to Definition 4. Then, we have that $\\begin{array}{r}{\\frac{1}{d M}\\le\\alpha<\\infty}\\end{array}$ . ", "page_idx": 15}, {"type": "text", "text": "Proof. Since Assumption 6 holds and that the latent factors are normalized, it follows that for all $i\\in[d^{\\prime}]$ and any latent factor matrix, ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\begin{array}{r l r}{\\lefteqn{\\|F_{h}(\\cdot,i)\\|_{2}=\\|\\sum_{j\\in[d],m\\in[M]}B_{h}(i,j,m)F_{m,h}(\\cdot,j)\\|_{2}}}\\\\ &{}&{1\\leq\\underset{j\\in[d],m\\in[M]}{\\sum_{j\\in[d],m\\in[M]}}\\|B_{h}(i,j,m)F_{m,h}(\\cdot,j)\\|_{2}}\\\\ &{}&{\\leq\\underset{j\\in[d],m\\in[M]}{\\sum_{j\\in[d],m\\in[M]}}|B_{h}(i,j,m)|\\|F_{m,h}(\\cdot,j)\\|_{2}}\\\\ &{}&{=\\underset{j\\in[d],m\\in[M]}{\\sum_{j\\in[d],m\\in[M]}}|B_{h}(i,j,m)|.}\\end{array}\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "Given that $\\begin{array}{r l r}{1}&{{}\\leq}&{\\sum_{j\\in[d],m\\in[M]}|B_{h}(i,j,m)|}\\end{array}$ , it follows that the minimum of $\\mathrm{max}_{j\\in[d],m\\in[M]}\\,|B_{h}(i,j,m)|$ is attained when $\\begin{array}{r}{|B_{h}(i,j,m)|=\\frac{1}{d M}}\\end{array}$ . Thus, $\\alpha\\geq\\frac{1}{d M}$ ", "page_idx": 15}, {"type": "text", "text": "Let $\\gamma~\\in~(0,1)$ . Consider the construction where the target latent factor is $F_{T}~=~[1,0]$ and the source latent factors from source MDPs one and two are ", "page_idx": 15}, {"type": "equation", "text": "$$\nF_{1}=[1-\\gamma,\\gamma\\sqrt{2/\\gamma-1}],\\quad F_{2}=[1-\\gamma,-\\gamma\\sqrt{2/\\gamma-1}].\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "Clearly, the latent factors are orthonormal. Then, it follows that the only linear combination of $F_{1}$ and $F_{2}$ that results in $F$ is ", "page_idx": 15}, {"type": "equation", "text": "$$\nF_{T}=c F_{1}+c F_{2},\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "which implies that c =2\u221212\u03b3 . Thus, $\\begin{array}{r}{\\alpha=\\frac{1}{2-2\\gamma}}\\end{array}$ , and it follows that we can make $\\alpha$ arbitrarily large because for any positive constant $C$ , we can choose $\\gamma$ so that $\\alpha>C$ . \u53e3 ", "page_idx": 15}, {"type": "text", "text": "As the proof of Lemma 1 uses a construction in which $\\alpha$ can be arbitrarily large, we next provide simple constructions where $\\alpha$ is small. In the rank one case where all source latent factors equal the target latent factor, $\\alpha$ attains its minimum of $\\begin{array}{r}{\\alpha=\\frac{1}{M}}\\end{array}$ . Next, we consider the construction where ", "page_idx": 16}, {"type": "equation", "text": "$$\nF_{T}=\\left[{\\frac{1}{\\sqrt{d}}},\\cdot\\cdot\\cdot,{\\frac{1}{\\sqrt{d}}}\\right],\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "and there are $M$ source MDPs with the standard basis vectors in $\\mathbb{R}^{d}$ as the latent factors equally distributed among the $M$ rank one source MDPs. Thus, ", "page_idx": 16}, {"type": "equation", "text": "$$\nF_{T}=\\sum_{m\\in M}\\frac{\\sqrt{d}}{M}F_{m},\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "and $\\alpha=\\sqrt{d}/M$ . ", "page_idx": 16}, {"type": "text", "text": "We next present a transfer RL instance with large $\\alpha$ . Consider the following construction with the goal of trying to transfer the state latent factors. Without loss of generality, let the size of the state space and action space be $4n$ for some $n\\in\\mathbb{N}_{+}$ . Furthermore, we refer to the $i$ -th quarter of the states as $s_{i}$ for $i\\in[4]$ and the $i^{\\th}$ -th half of the actions as $a_{i}$ for $i\\in$ [2] because our construction is a block MDP with four latent states and two latent actions. Let $H=2$ . In each MDP, the transition kernel does not vary with $h$ while the reward function is time dependent. Assume that the transition kernels have Tucker rank $(S,d,A)$ (Assumption 5). For ease of notation, we refer to the $i$ -th row as any state in $s_{i}$ and the $i$ -th column as any state in $a_{i}$ . The target MDP\u2019s latent factors are ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\bar{c}_{h}=\\left[\\begin{array}{c c}{\\sqrt{1/(2n)}}&{0}\\\\ {\\sqrt{1/(2n)}}&{0}\\\\ {0}&{\\sqrt{1/(2n)}}\\\\ {0}&{\\sqrt{1/(2n)}}\\end{array}\\right],\\quad W_{1}=\\left[\\begin{array}{c c}{\\sqrt{1/(2n)}}&{\\sqrt{1/(8n)}}\\\\ {\\sqrt{1/(2n)}}&{\\sqrt{1/(8n)}}\\end{array}\\right],\\quad W_{2}=\\left[\\begin{array}{c c}{\\sqrt{1/(8n)}}&{0}\\\\ {\\sqrt{1/(8n)}}&{\\sqrt{1/(8n)}}\\end{array}\\right],\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "for all $h\\in[H]$ , and ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{U_{h}(s_{1}|a_{1})=U_{h}(s_{2}|a_{1})=[3\\sqrt{2}/(8\\sqrt{n}),\\sqrt{2}/(8\\sqrt{n})]}\\\\ &{U_{h}(s_{1}|a_{2})=U_{h}(s_{2}|a_{2})=[\\sqrt{2}/(8\\sqrt{n}),3\\sqrt{2}/(8\\sqrt{n})]}\\\\ &{U_{h}(s_{3}|a_{1})=U_{h}(s_{4}|a_{1})=[3\\sqrt{2}/(8\\sqrt{n}),\\sqrt{2}/(8\\sqrt{n})]}\\\\ &{U_{h}(s_{3}|a_{2})=U_{h}(s_{4}|a_{2})=[\\sqrt{2}/(8\\sqrt{n}),3\\sqrt{2}/(8\\sqrt{n})].}\\end{array}\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "Thus, the reward functions and transition kernels for the target MDP are ", "page_idx": 16}, {"type": "equation", "text": "$$\nr_{1}={\\left[\\begin{array}{l l}{{\\frac{1}{2n}}}&{{\\frac{1}{2n}}}\\\\ {{\\frac{1}{2n}}}&{{\\frac{1}{2n}}}\\\\ {{\\frac{1}{4n}}}&{{\\frac{1}{4n}}}\\\\ {{\\frac{1}{4n}}}&{{\\frac{1}{4n}}}\\end{array}\\right]}\\quad r_{2}={\\left[\\begin{array}{l l}{{\\frac{1}{4n}}}&{{\\frac{1}{4n}}}\\\\ {{\\frac{1}{4n}}}&{{\\frac{1}{4n}}}\\\\ {{\\frac{1}{2n}}}&{{\\frac{1}{2n}}}\\\\ {{\\frac{1}{2n}}}&{{\\frac{1}{2n}}}\\end{array}\\right]}\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "and the transition kernels are ", "page_idx": 16}, {"type": "equation", "text": "$$\nP_{h}(s_{1}|\\cdot,\\cdot)=P_{h}(s_{2}|\\cdot,\\cdot)=\\left[\\begin{array}{c c}{\\frac{3}{8n}}&{\\frac{1}{8n}}\\\\ {\\frac{3}{8n}}&{\\frac{1}{8n}}\\\\ {\\frac{1}{8n}}&{\\frac{3}{8n}}\\\\ {\\frac{1}{8n}}&{\\frac{3}{8n}}\\end{array}\\right]\\quad P_{h}(s_{3}|\\cdot,\\cdot)=P_{h}(s_{4}|\\cdot,\\cdot)=\\left[\\begin{array}{c c}{\\frac{1}{8n}}&{\\frac{3}{8n}}\\\\ {\\frac{1}{8n}}&{\\frac{3}{8n}}\\\\ {\\frac{3}{8n}}&{\\frac{1}{8n}}\\\\ {\\frac{3}{8n}}&{\\frac{1}{8n}}\\end{array}\\right]\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "for all $h\\in[H]$ . Using the Bellman equations, it follows that the optimal $Q$ function for the above MDP is ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\begin{array}{r}{Q_{1}^{*}=\\left[\\begin{array}{c c}{\\frac{13}{16n}}&{\\frac{15}{16n}}\\\\ {\\frac{13}{16n}}&{\\frac{15}{16n}}\\\\ {\\frac{11}{16n}}&{\\frac{9}{16n}}\\\\ {\\frac{11}{16n}}&{\\frac{9}{16n}}\\end{array}\\right],\\quad Q_{2}^{*}=\\left[\\begin{array}{c c}{\\frac{1}{4n}}&{\\frac{1}{4n}}\\\\ {\\frac{1}{4n}}&{\\frac{1}{4n}}\\\\ {\\frac{1}{2n}}&{\\frac{1}{2n}}\\\\ {\\frac{1}{2n}}&{\\frac{1}{2n}}\\end{array}\\right].}\\end{array}\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "and both $Q^{*}\\mathbf{s}$ have $F_{h}$ as orthonormal latent factors. Next, we present the orthonormal latent factors for the first source MDP ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\bar{\\tau}_{1,h}=\\left[\\begin{array}{c c}{1/\\sqrt{2n}}&{1/\\sqrt{4n}}\\\\ {-1/\\sqrt{2n}}&{1/\\sqrt{4n}}\\\\ {0}&{1/\\sqrt{4n}}\\\\ {0}&{1/\\sqrt{4n}}\\end{array}\\right],W_{1,1}=\\left[\\begin{array}{c c}{3/\\sqrt{4n}}&{3/\\sqrt{4n}}\\\\ {1/\\sqrt{4n}}&{1/\\sqrt{4n}}\\end{array}\\right],W_{1,2}=\\left[\\begin{array}{c c}{1/\\sqrt{4n}}&{1/\\sqrt{4n}}\\\\ {2/\\sqrt{4n}}&{2/\\sqrt{4n}}\\end{array}\\right].}\\end{array}\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "It follows that the reward functions are ", "page_idx": 17}, {"type": "equation", "text": "$$\n\\ldots,_{1}=\\left[\\begin{array}{c c}{(3+3\\sqrt{2})/(4n)}&{(1+\\sqrt{2})/(4n)}\\\\ {(3-3\\sqrt{2})/(4n)}&{(1-\\sqrt{2})/(4n)}\\\\ {3/(4n)}&{1/(4n)}\\\\ {3/(4n)}&{1/(4n)}\\end{array}\\right],r_{1,2}=\\left[\\begin{array}{c c}{(1+\\sqrt{2})/(4n)}&{(1+\\sqrt{2})/(2n)}\\\\ {(1-\\sqrt{2})/(4n)}&{(1-\\sqrt{2})/(2n)}\\\\ {1/(4n)}&{1/(2n)}\\\\ {1/(4n)}&{1/(2n)}\\end{array}\\right].\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "with $P_{1,h}(\\cdot|\\cdot,\\cdot)=1/(4n)$ . Since $P_{1,h}$ is the uniform transition kernel (which has the second column of $F_{1,h}$ as its latent factor), it follows that $P V_{1,2}^{*}(\\cdot,\\cdot)$ is a rank one matrix with every entry being the same positive constant. Thus, $Q_{1,1}^{*}=r_{1,1}+P_{1,1}V_{1,2}^{*}$ and $Q_{1,2}^{*}=r_{1,2}$ are rank two matrices with $F_{1,h}$ as latent factors. ", "page_idx": 17}, {"type": "text", "text": "The second source MDP has the following latent factors ", "page_idx": 17}, {"type": "equation", "text": "$$\n\\vec{z}_{2,h}=\\left[\\begin{array}{c c c}{\\frac{1}{c\\sqrt{2n}}+\\frac{1}{c\\beta\\sqrt{4n}}}&{1/\\sqrt{4n}}\\\\ {-\\frac{1}{c\\sqrt{2n}}+\\frac{1}{c\\sqrt{4n}}}&{1/\\sqrt{4n}}\\\\ {-1/(c\\beta\\sqrt{4n})}&{1/\\sqrt{4n}}\\\\ {-1/(c\\beta\\sqrt{4n})}&{1/\\sqrt{4n}}\\end{array}\\right],W_{2,1}=\\left[\\begin{array}{c c c}{1/\\sqrt{2n}}&{0}\\\\ {0}&{1/\\sqrt{2n}}\\end{array}\\right],W_{2,2}=\\left[\\begin{array}{c c c}{0}&{1/\\sqrt{2n}}&{0}\\\\ {1/\\sqrt{2n}}&{0}&{1/\\sqrt{4n}}\\\\ {1/\\sqrt{2n}}&{0}&{1/\\sqrt{4n}}\\end{array}\\right]\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "where $c\\,=\\,\\sqrt{1+1/\\beta^{2}}$ for all $\\textit{h}\\in[H]$ with $P_{2,h}(\\cdot|\\cdot,\\cdot)\\:=\\:1/(4n)$ . Since $P_{2,h}$ is the uniform transition kernel (which has the second column of $F_{2,h}$ as its latent factor), it follows that $P V_{2,2}^{*}(\\cdot,\\cdot)$ is a rank one matrix with every entry being the same positive constant. Thus, $Q_{2,1}^{*}=r_{2,1}+P_{2,1}V_{2,2}^{*}$ and $Q_{2,2}^{*}=r_{2,2}$ are rank two matrices with $F_{2,h}$ as latent factors. Now, we prove that $\\alpha\\in\\Omega(\\beta)$ . ", "page_idx": 17}, {"type": "text", "text": "Corollary 1. Consider the above construction that satisfies Assumptions 5 and 6. Then, $\\alpha$ defined in Definition $^{4}$ satisfies $\\alpha\\in\\Omega(\\beta)$ . ", "page_idx": 17}, {"type": "text", "text": "Proof. Consider the above construction with $\\beta>0$ . First, we show that when expressing the first column of $F_{h}$ as a linear combination of the columns of $F_{1,h}$ and $F_{2,h}$ , one coefficient is $\\bar{\\Omega}(\\beta)$ . ", "page_idx": 17}, {"type": "text", "text": "We first note that one must use the first column in $F_{2,h}$ or else the system of linear equations is inconsistent. Thus, we solve ", "page_idx": 17}, {"type": "equation", "text": "$$\na\\left[\\begin{array}{c}{1/\\sqrt{2n}}\\\\ {-1\\sqrt{2n}}\\\\ {0}\\\\ {0}\\end{array}\\right]+b\\left[\\begin{array}{c}{1/\\sqrt{4n}}\\\\ {1/\\sqrt{4n}}\\\\ {1/\\sqrt{4n}}\\\\ {1/\\sqrt{4n}}\\end{array}\\right]+d\\left[\\begin{array}{c}{\\frac{1}{c\\sqrt{2n}}+\\frac{1}{c\\beta\\sqrt{4n}}}\\\\ {-\\frac{1}{c\\sqrt{2n}}+\\frac{1}{c\\beta\\sqrt{4n}}}\\\\ {-1/(c\\beta\\sqrt{4n})}\\\\ {-1/(c\\beta\\sqrt{4n})}\\end{array}\\right]=\\left[\\begin{array}{c}{1/\\sqrt{22n}}\\\\ {1/\\sqrt{n}}\\\\ {0}\\\\ {0}\\end{array}\\right]\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "It follows that $d=b c\\beta$ . Thus, $b=1/\\sqrt{2}$ , and $d\\in\\Omega(\\beta)$ because $c\\geq1$ . ", "page_idx": 17}, {"type": "text", "text": "To show that $\\alpha\\,\\in\\,\\Omega(\\beta)$ , we assume for sake of contradiction that there exists some set of basis vectors $F_{1,h}^{\\prime}$ and $F_{2,h^{\\prime}}$ that span the subspace defined by $F_{1,h}$ and $F_{2,h}$ , respectively, such that we can express the any rotation of the first column of $F_{h}$ as a linear combination of the columns of $F_{1,h}^{\\prime}$ and $F_{2,h^{\\prime}}$ using coefficients $a,b,c,d$ such that $|a|,|b|,|c|,|d|\\in o(\\beta)$ . Since $F_{h},F_{1,h}$ , and $F_{2,h}$ are orthonormal latent factors, it follows that there exist rotation matrices $R,R_{1},R_{2}$ with $\\|R\\|_{\\infty},\\|R_{1}\\|_{\\infty},\\|R_{2}\\|_{\\infty}\\in O(1)$ such that $F_{1,h}^{\\prime}=R_{1}F_{1,h}$ and 2\u2032,h = R2F2,h. It follows that R\u22121 exists and has entries with constant magnitude. By construction we have ", "page_idx": 17}, {"type": "equation", "text": "$$\nF_{h}(:,0)=a R^{-1}R_{1}F_{1,h}(:,0)+b R^{-1}R_{1}F_{1,h}(:,1)+c R^{-1}R_{2}F_{2,h}(:,0)+d R^{-1}R_{2}F_{2,h}(:,1).\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "Since the entries of the rotation matrices and their inverse are bounded by a constant, the above equation states that we can represent the first column of $F_{h}$ as a linear combination of the columns of $F_{1,h}$ and $F_{2,h}$ using only constant coefficients. Thus, we reach a contradiction because we\u2019ve shown that one entry of $d R^{-1}R_{2}\\in\\Omega(\\beta)$ . Therefore, $\\alpha\\in\\Omega(\\beta)$ . \u53e3 ", "page_idx": 17}, {"type": "text", "text": "E Omitted Proofs in the $(S,S,d)$ Tucker Rank Setting ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "We first prove our lower bound. ", "page_idx": 17}, {"type": "text", "text": "E.1 Proof of Theorem 1 ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Proof. Suppose all source and target MDPs $(S,A,P,H,r)$ share the same state space, action space, and horizon $H=1$ and assume that $S=A=[2n]$ for some $n\\in\\mathbb{N}_{+}$ . For ease of notation, we let $s_{1}$ and $a_{1}$ refer to any state and action in $[n]$ , respectively, and $s_{2}$ and $a_{2}$ refer to any state and action in $\\{n+1,\\ldots2n\\}$ , respectively. We will present the latent factors and optimal $\\mathrm{^Q}$ functions as block vectors and matrices with $s_{1},s_{2},a_{1},a_{2}$ as the blocks containing $n$ entries. The initial state distribution in the target MDP is uniform over $\\boldsymbol{S}$ . We now present two transfer RL problems with similar $Q$ functions (with rows $s_{1},s_{2}$ and columns $a_{1},a_{2})$ that satisfy Assumptions 1 and 2 but have orthogonal target state latent factors. For ease of notation, the superscript $i$ of $Q_{m,h}^{*,i},Q_{h}^{*,i}$ denotes transfer RL problem for $i\\in\\{1,2\\}$ . Then, the optimal $Q$ functions for transfer RL problem one are ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{Q_{1,1}^{*,1}=n\\left[\\sqrt{1/n}\\right]\\left[\\sqrt{1/(2n)}\\quad\\sqrt{1/(2n)}\\right]=\\left[1/\\sqrt{2}\\quad1/\\sqrt{2}\\right],}\\\\ &{Q_{2,1}^{*,1}=n\\left[\\sqrt{1/n}\\right]\\left[\\sqrt{1/(2n)}\\quad\\sqrt{1/(2n)}\\right]=\\left[1/\\sqrt{2}\\quad0\\right],}\\\\ &{Q_{1}^{*,1}=n\\left[\\sqrt{1/(2n)}\\right]\\left[\\sqrt{1/(2n)}\\quad\\sqrt{1/(2n)}\\right]=\\left[1/2\\quad1/2\\right],}\\end{array}\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "and the optimal $Q$ functions for transfer RL problem two are ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\begin{array}{l}{{Q_{1,1}^{*,2}=n\\left[\\sqrt{1/n}\\right]\\left[\\sqrt{1/(2n)}\\quad\\sqrt{1/(2n)}\\right]=\\left[\\begin{array}{c c}{{1/\\sqrt{2}}}&{{1/\\sqrt{2}}}\\\\ {{0}}&{{0}}\\end{array}\\right],}}\\\\ {{Q_{2,1}^{*,2}=n\\left[\\sqrt{1/n}\\right]G^{\\prime}=\\left[\\phantom{-}\\!\\!\\!\\!\\!\\!\\!0\\!\\!\\!\\!}}&{{0}}\\\\ {{Q_{1}^{*,2}=n\\left[\\sqrt{1/(2n)}\\right]\\left[\\sqrt{1/\\alpha}\\right]\\left(c\\sqrt{2}\\right)\\quad(1-1/\\alpha)/(c\\sqrt{2})\\right],}}\\\\ {{Q_{1}^{*,2}=n\\left[\\!\\!\\!\\!\\!\\!}}&{{-\\sqrt{1/(2n)}\\right]\\left[\\sqrt{\\frac{1}{(2n)}}\\quad-\\sqrt{\\frac{1}{(2n)}}\\right]=\\left[\\!\\!\\!\\!\\!\\!-1/2\\!\\!\\!\\!\\!}}&{{1/2}}\\end{array}\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "where ", "page_idx": 18}, {"type": "equation", "text": "$$\nG^{\\prime}=\\left[(\\sqrt{1/(2n)}+\\sqrt{1/(2n\\alpha^{2})})/\\sqrt{1+1/\\alpha^{2}}\\quad(\\sqrt{1/(2n)}-\\sqrt{1/(2n\\alpha^{2}})/\\sqrt{1+1/\\alpha^{2}}\\right],\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "and $c=\\sqrt{1+1/\\alpha^{2}}$ . Note that $c\\in(1,2d M)$ because $\\alpha\\geq1/(d M)$ from Lemma 1 for $\\alpha>0$ . The incoherence $\\mu$ , rank $d$ , and condition number $\\kappa$ of the above $Q$ functions are $O(1)$ . Furthermore, the above construction satisfies Assumption 5 with Tucker rank $(S,S,1)$ and Assumption 6 because the source and target MDPs share the same action latent factor $\\left[{\\sqrt{1/(2n)}}\\quad{\\sqrt{1/(2n)}}\\right]$ in the first transfer RL problem while in the second transfer RL problem, ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\left[\\sqrt{1/(2n)}\\quad-\\sqrt{1/(2n)}\\right]=-\\alpha\\left[\\sqrt{1/(2n)}\\quad\\sqrt{1/(2n)}\\right]+\\alpha c G^{'}.\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "Note that $G^{1}=\\left[\\sqrt{1/(2n)}\\_{\\!\\!\\!\\phantom{1}}\\sqrt{1/(2n)}\\right]$ and $G^{2}=\\left[\\sqrt{1/(2n)}\\quad-\\sqrt{1/(2n)}\\right]$ , so the target latent factors of the different transfer RL problems are orthogonal to each other. ", "page_idx": 18}, {"type": "text", "text": "The learner is given either transfer RL problem one or two with equal probability with a generative model in the source problem. When interacting with the source MDPs, the learner specifies a stateaction pair $(s,a)$ and source MDP $m$ and observes a realization of a shifted and scaled Bernoulli random variable $X$ . The distribution of $X$ is that $X=1$ with probability $(Q_{m,1}^{*,i}(s,a)+1)/2$ and $X=-1$ with probability $(1-Q_{m,1}^{*,i}(s,a))/2)$ . Furthermore, the learner is given the knowledge that the state latent features lie in the function class $\\mathcal{G}=\\{G^{1},G^{2}\\}$ and must use the knowledge obtained from interacting with the source MDP to choose one to use in the target MDP, which is no harder than receiving no information about the function class. ", "page_idx": 18}, {"type": "text", "text": "To distinguish between the two transfer RL problems, one needs to differentiate between $Q_{2,1}^{*,1}$ and $Q_{2,1}^{*,2}$ . By construction, the magnitude of the largest entrywise difference between $Q_{2,1}^{*,1}$ and $Q_{2,1}^{*,2}$ is lower bounded by $\\Omega(1/\\alpha)$ . ", "page_idx": 18}, {"type": "text", "text": "If the learner observes $Z$ samples in the source MDPs, where $Z\\le{\\cal O}(\\alpha^{2})$ for some constant $C>0$ , then the probability of correctly identifying $G$ is upper bounded by 0.76 (Lemma 5.1 with $\\delta=0.24$ [5]). Thus, if the learner does not observe $\\Omega(\\alpha^{2})$ samples in the source phase, then the learner returns the incorrect feature mapping that is orthogonal to the true feature mapping with probability at least 0.24. \u53e3 ", "page_idx": 18}, {"type": "text", "text": "E.2 Proof of Theorem 2 ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "We first present the theoretical guarantees of LSVI-UCB-(S, S, d) and defer their proofs to Appendix J. ", "page_idx": 19}, {"type": "text", "text": "Theorem 5. Assume that Assumption 1 holds and the learner is given the true latent action representation $G=\\{G_{h}\\}_{h\\in[H]}$ . Then, there exists a constant $c>0$ such that for any $\\delta\\in(0,1)$ , if we set $\\lambda=1,\\beta_{k,h}^{s}=c d H\\sqrt{\\iota},\\iota=\\log(2d T S/\\delta)$ , then with probability at least $1-\\delta$ , the total regret of Algorithm 2 is $\\tilde{O}(\\sqrt{d^{3}S H^{3}T})$ . ", "page_idx": 19}, {"type": "text", "text": "Theorem 5 states that LSVI-UCB-(S, S, d) completely removes the regret bound\u2019s dependence on the size of the state space by utilizing the latent action representation $G$ . Similarly, the algorithm is robust to misspecification error. ", "page_idx": 19}, {"type": "text", "text": "Assumption 4 ( $\\xi$ -approximate $(S,S,d)$ Tucker rank MDP). Assume $\\xi\\,\\in\\,[0,1]$ . Then, an MDP $(S,{\\mathcal{A}},P,r,H)$ is a $\\xi$ -approximate $(S,S,d)$ Tucker rank MDP with given feature map $G$ if there exist $H$ unknown $S$ -by- $d$ matrices $W=\\{W_{h}\\}_{h\\in[H]}$ and $S$ -by- $S$ -by- $d$ tensors $U=\\{U_{h}\\}_{h\\in[H]}$ such that ", "page_idx": 19}, {"type": "equation", "text": "$$\n|r_{h}(s,a)-W_{h}(s)^{\\top}G_{h}(a)|\\leq\\xi,\n$$", "text_format": "latex", "page_idx": 19}, {"type": "equation", "text": "$$\n\\left|\\sum_{s^{\\prime}\\in S}(P_{h}(s^{\\prime}|s,a)-U_{h}(s^{\\prime},s)G_{h}(a)^{\\top})\\right|\\leq\\xi\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "for all $h\\,\\in\\,[H]$ where $\\begin{array}{r}{\\|W_{h}\\|_{2},\\|\\sum_{s^{\\prime}\\in S}g(s^{\\prime})U_{h}(s^{\\prime},a)\\|_{2}\\,\\le\\,\\sqrt{A/(d\\mu)}}\\end{array}$ for any function $g:S\\to$ $[0,1]$ . ", "page_idx": 19}, {"type": "text", "text": "Theorem 6. Under the Assumption 4, for any $\\delta\\in(0,1).$ , for $\\lambda=1,\\beta_{k,h}^{s}=O(H d\\sqrt{\\iota}+\\xi\\sqrt{k d}H)$ for $\\iota=\\log(2d T S/\\delta)$ , the regret of Algorithm 2 is ${\\tilde{O}}({\\sqrt{d^{3}H^{3}S T}}+\\xi d H T)$ with probability at least $1-\\delta$ . ", "page_idx": 19}, {"type": "text", "text": "We now prove Theorem 2. ", "page_idx": 19}, {"type": "text", "text": "Proof. Suppose the assumption stated in Theorem 2 hold. Then, from [30], running LR-EVI with a sample complexity of $C^{\\prime}d^{4}\\mu^{5}\\kappa^{4}(S+A)M H^{4}\\alpha^{2}T\\log(2S A d M H/\\delta)/S$ on each source MDP r\u221aesults in $\\bar{Q}_{m,h}$ \u221a functions with singular value decomposition $\\bar{Q}_{m,h}\\ =\\ \\hat{F}_{m,h}\\hat{\\Sigma}_{m,h}\\hat{G}_{m,h}$ that are $\\sqrt{H S}/(16\\alpha\\mu\\kappa\\sqrt{d M T})$ -optimal with probability at least $1-\\delta/2$ . ", "page_idx": 19}, {"type": "text", "text": "Since our estimates are $\\sqrt{H S}/(16\\alpha\\kappa\\sqrt{d M T})$ -optimal, it follows that $\\bar{\\gamma}<1/2$ in the singular vector perturbation bound, Corollary 3. Since $\\|Q_{m,h}^{*}\\|_{\\infty}\\geq C$ , from Corollary 3, it follows that there exists rotation matrices $R_{m,h}$ such that ", "page_idx": 19}, {"type": "equation", "text": "$$\n\\|({\\hat{G}}_{m,h}R_{m,h}-G_{m,h})(a)\\|_{2}\\leq{\\frac{d{\\sqrt{H\\mu S}}}{\\alpha{\\sqrt{A M T}}}}\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "for all $a\\ \\ \\in\\ \\ A$ where the optimal $Q$ function have singular value decomposition $Q_{m,h}^{*}\\;=\\;$ $F_{m,h}\\Sigma_{m,h}G_{m,h}^{\\top}$ . ", "page_idx": 19}, {"type": "text", "text": "Let $\\tilde{G}$ be the $A\\times d M$ matrix from joining all the source action latent factor matrices, and $\\hat{\\tilde{G}}_{h}$ be the $A\\times d M$ matrix from joining all $\\bar{G}_{m,h}$ . Let $R_{h}$ be the $d\\times d M$ matrix that joins $R_{m,h}$ for all $m\\in[M]$ . Then, from Assumption 2 and Definition 3, it follows that for all $(s^{\\prime},s,a)\\in S\\times S\\times A$ , that ", "page_idx": 19}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{r_{h}(s,a)=\\displaystyle\\sum_{i\\in[d]}W_{h}(s,i)G_{h}(a,i)}\\\\ &{\\qquad=\\displaystyle\\sum_{i\\in[d]}\\left(\\sum_{j\\in[d],m\\in[M]}B(i,j,m)G_{h,m}(a,j)\\right)W_{h}(s,i)}\\\\ &{\\qquad=\\displaystyle\\sum_{i,j\\in[d],m\\in[M]}B(i,j,m)G_{m,h}(a,j)W_{h}(s,i)}\\\\ &{\\qquad=\\displaystyle\\hat{W}_{h}^{\\prime}(s)G_{h}(a)^{\\top}}\\\\ &{\\qquad=\\displaystyle\\hat{W}_{h}^{\\prime}(s)G_{h}(a)^{\\top}}\\end{array}\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "and $P(s^{\\prime}|\\cdot,\\cdot)\\,=\\,\\tilde{G}_{h}U_{h}^{\\prime}(s^{\\prime})^{\\top}$ (with the same argument) for some $S\\,\\times\\,d M$ matrices $W_{h}^{\\prime},U_{h}^{\\prime}(s^{\\prime})$ with entries bounded by $\\alpha$ . Note that $W_{h}^{\\prime}$ and $\\bar{U}_{h}^{\\prime}(s^{\\prime})$ are matrices that join $W_{m,h}$ and $\\dot{U}_{m,h}(s^{\\prime})$ , respectively, with entries that at most $\\alpha$ times larger than the original entry. ", "page_idx": 20}, {"type": "text", "text": "Therefore, it follows for all $(s^{\\prime},s,a,h)\\in\\mathcal{S}\\times\\mathcal{S}\\times\\mathcal{A}\\times[H],$ ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{\\displaystyle r_{h}(s,a)-\\tilde{G}_{h}(a)R_{h}W_{h}^{\\prime}(s)^{\\top}|=|\\tilde{G}_{h}(a)W_{h}^{\\prime}(s)^{\\top}-\\hat{G}_{h}(a)R_{h}W_{h}^{\\prime}(s)^{\\top}|}\\\\ &{\\displaystyle=|(\\tilde{G}_{h}(a)-\\tilde{G}_{h}(a)R_{h})W_{h}^{\\prime}(s)|}\\\\ &{\\le\\alpha|\\displaystyle\\sum_{m\\in M}(G_{m,h}(a)-\\tilde{G}_{m,h}(a)R_{m,h})W_{m,h}(s)|}\\\\ &{\\displaystyle\\le\\alpha\\displaystyle\\sum_{m\\in M}\\|G_{m,h}(a)-\\hat{G}_{m,h}(a)R_{m,h}\\|_{2}\\|W_{m,h}(s)\\|_{2}}\\\\ &{\\le\\alpha\\sqrt{\\displaystyle\\frac{d}{d\\mu}}\\displaystyle\\sum_{m\\in M}\\|G_{m,h}(a)-\\hat{G}_{m,h}(a)R_{m,h}\\|_{2}}\\\\ &{\\le\\alpha\\sqrt{\\displaystyle\\frac{d R M\\delta}{d\\mu}}}\\\\ &{\\le\\sqrt{\\displaystyle\\frac{d R M K}{T}}}\\end{array}\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "from the Cauchy-Schwarz inequality and our singular vector perturbation bound. From the same logic, ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{\\lefteqn{\\sum_{s^{\\prime}\\in S}(P_{h}(s^{\\prime}|s,a)-U_{h}(s^{\\prime},s)G_{h}(a)^{\\top})\\Bigg|=|\\sum_{s^{\\prime}\\in S}\\bar{G}_{h}(a)U_{h}^{\\prime}(s^{\\prime},s)-\\hat{\\tilde{G}}_{h}(a)R_{h}U_{h}^{\\prime}(s^{\\prime},s)^{\\top}|}}\\\\ &{=|(\\tilde{G}_{h}(a)-\\hat{\\tilde{G}}_{h}(a)R_{h})\\sum_{s^{\\prime}\\in S}U_{h}^{\\prime}(s^{\\prime},s)^{\\top}|}\\\\ &{\\leq\\alpha|\\displaystyle\\sum_{m\\in M}(G_{m,h}(a)-\\hat{G}_{m,h}(a)R_{m,h})\\sum_{s^{\\prime}\\in S}U_{m,h}(s^{\\prime},s)|}\\\\ &{\\leq\\alpha\\displaystyle\\sum_{m\\in M}\\|(G_{m,h}(a)-\\hat{G}_{m,h}(a)R_{m,h})\\|_{2}\\|\\displaystyle\\sum_{s^{\\prime}\\in S}U_{m,h}(s^{\\prime},s)^{\\top}}\\\\ &{\\leq\\sqrt{\\frac{d H M S}{T}}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "Therefore, G\u02c6\u02dch(a) satisfies Assumption 4 with \u03be = dMTH . Then it follows that running LSVIUCB-TR using $\\hat{\\tilde{G}}_{h}(a)$ with $\\delta^{\\prime}=\\delta/2$ during the target phase of the algorithm admits a regret bound of ", "page_idx": 20}, {"type": "equation", "text": "$$\nR e g r e t(T)\\leq C^{\\circ}(\\sqrt{d^{3}M^{3}H^{3}S T}+d M H T\\sqrt{\\frac{d M H S}{T}})\\in\\tilde{O}(\\sqrt{d^{3}M^{3}H^{3}S T})\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "with probability at least $1-\\delta$ from a final union bound. Furthermore, the sample complexity in the source phase is ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\tilde{O}\\left(\\frac{d^{4}\\mu^{5}\\kappa^{4}(S+A)M^{2}H^{4}\\alpha^{2}T}{S}\\right),\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "which proves our result. ", "page_idx": 20}, {"type": "text", "text": "E.3 Proof of Theorem 3 ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Proof. Let the assumptions of Theorem 3 hold. Then, from [30], running LR-EVI with a sample complexity of $C^{\\prime}d^{7}\\mu^{5}\\kappa^{4}A(S+A)M^{2}H^{4}\\alpha^{2}T\\log(2S A d M H/\\delta)/(S d^{\\prime\\prime})$ on each source MDP r\u221aesults in $\\bar{Q}_{m,h}$ functio\u221ans with singular value decomposition $\\bar{Q}_{m,h}\\,=\\,\\hat{F}_{m,h}\\hat{\\Sigma}_{m,h}\\hat{G}_{m,h}$ that are $\\sqrt{H d^{\\prime\\prime}S}/(16\\alpha\\mu M\\kappa d^{2}\\sqrt{A T})$ -optimal with probability at least $1-\\delta/2$ . ", "page_idx": 20}, {"type": "text", "text": "Since our estimates are $\\sqrt{H d^{\\prime\\prime}S}/(16\\alpha\\mu M\\kappa d^{2}\\sqrt{A T})$ -optimal, it follows that $\\bar{\\gamma}<1/2$ in the singular vector perturbation bound, Corollary 3. Since $\\|Q_{m,h}^{*}\\|_{\\infty}\\geq C$ , from Corollary 3, it follows that there ", "page_idx": 20}, {"type": "text", "text": "exists rotation matrices $R_{m,h}$ such that ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\|({\\hat{G}}_{m,h}R_{m,h}-G_{m,h})(a)\\|_{2}\\leq{\\frac{{\\sqrt{H d^{\\prime\\prime}\\mu S}}}{\\alpha A M{\\sqrt{d T}}}}\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "for all $a\\ \\ \\in\\ \\ A$ where the optimal $Q$ function have singular value decomposition $Q_{m,h}^{*}\\;=\\;$ $F_{m,h}\\Sigma_{m,h}G_{m,h}^{\\top}$ . ", "page_idx": 21}, {"type": "text", "text": "Let $\\tilde{G}$ be the $A\\times d M$ matrix from joining all the source action latent factor matrices, and $\\hat{\\tilde{G}}_{h}$ be the $A\\times d M$ matrix from joining all $\\bar{G}_{m,h}$ . Let $R_{h}$ be the $d\\times d M$ matrix that joins $R_{m,h}$ for all $m\\in[M]$ . Then, from Assumption 2 and Definition 3, it follows that for all $(s^{\\prime},s,a)\\in\\mathcal{S}\\times\\mathcal{S}\\times A$ , that ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{r_{h}(s,a)=\\displaystyle\\sum_{i\\in[d]}W_{h}(s,i)G_{h}(a,i)}\\\\ &{\\qquad=\\displaystyle\\sum_{i\\in[d]}\\left(\\sum_{j\\in[d],m\\in[M]}B(i,j,m)G_{h,m}(a,j)\\right)W_{h}(s,i)}\\\\ &{\\qquad=\\displaystyle\\sum_{i,j\\in[d],m\\in[M]}B(i,j,m)G_{m,h}(a,j)W_{h}(s,i)}\\\\ &{\\qquad=\\displaystyle\\hat{W}_{h}^{\\prime}(s)G_{h}(a)^{\\top}}\\\\ &{\\qquad=\\displaystyle\\hat{W}_{h}^{\\prime}(s)G_{h}(a)^{\\top}}\\end{array}\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "and $P(s^{\\prime}|\\cdot,\\cdot)\\,=\\,\\tilde{G}_{h}U_{h}^{\\prime}(s^{\\prime})^{\\top}$ (with the same argument) for some $S\\,\\times\\,d M$ matrices $W_{h}^{\\prime}$ , $U_{h}^{\\prime}(s^{\\prime})$ with entries bounded by $\\alpha$ . Note that $W_{h}^{\\prime}$ and $\\bar{U}_{h}^{\\prime}(s^{\\prime})$ are matrices that join $W_{m,h}$ and $\\dot{U}_{m,h}(s^{\\prime})$ , respectively, with entries that at most $\\alpha$ times larger than the original entry. ", "page_idx": 21}, {"type": "text", "text": "Let $E=\\hat{\\tilde{G}}_{h}-\\tilde{G}_{h}$ , where $E=[E_{1}\\cdot\\cdot\\cdot E_{M}]$ . We next bound the $d^{\\prime\\prime}+1$ smallest singular value of $\\hat{\\tilde{G}}_{h}$ with our singular vector perturbation bound ( $\\|E\\|_{\\infty}\\leq\\|E\\|_{2,\\infty})$ . ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\sigma_{d^{\\prime\\prime}+1}(\\hat{\\tilde{G}}_{h})=\\sigma_{d^{\\prime\\prime}+1}(\\tilde{G}_{h})+\\|E\\|_{o p}\\leq\\sqrt{A d M}\\|E\\|_{\\infty}\\leq\\frac{\\sqrt{H d^{\\prime\\prime}\\mu S}}{\\alpha\\sqrt{A M T}}\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "With singular value decomposition $\\hat{\\tilde{G}}_{h}=X\\Sigma Y^{\\top}$ , let $G_{h}^{d^{\\prime\\prime}}$ be the thresholded feature representation estimate, i.e., $G_{h}^{d^{\\prime\\prime}}=X(:,:d^{\\prime\\prime})\\Sigma(:d^{\\prime\\prime},:d^{\\prime\\prime})Y(:,d^{\\prime\\prime})^{\\top}$ . Therefore, it follows for all $(s^{\\prime},s,a,h)\\in$ $S\\times S\\times A\\times[\\dot{H}]$ , ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{r_{h}(s,a)-G_{h}^{\\prime\\prime}(a)R_{h}W_{h}^{\\prime}(s,z^{\\prime\\prime})^{\\top}|}\\\\ &{\\qquad=|\\tilde{G}_{h}(a)W_{h}^{\\prime}(s)^{\\top}-G_{h}^{\\prime\\prime}(a)R_{h}W_{h}^{\\prime}(s,z^{\\prime\\prime})^{\\top}|}\\\\ &{\\qquad\\le|\\tilde{G}_{h}(a)W_{h}^{\\prime}(s)^{\\top}-\\tilde{G}_{h}(a)R_{h}W_{h}^{\\prime}(s)^{\\top}+|\\tilde{G}_{h}(a)R_{h}W_{h}^{\\prime}(s)^{\\top}-G_{h}^{\\prime\\prime}(a)R_{h}W_{h}^{\\prime}(s,z^{\\prime\\prime})^{\\top}|}\\\\ &{\\qquad\\le\\alpha\\Big|\\displaystyle\\sum_{m\\in\\mathcal{M}}\\displaystyle(G_{m,h}(a)-\\tilde{G}_{m,h}(a)R_{m,h}W_{m,h}(s)|+|\\tilde{G}_{h}(a,a^{\\prime\\prime}+1;\\mathcal{W}_{h}^{\\prime}(s,a^{\\prime\\prime}+1;\\mathcal{T}^{\\top}|}\\\\ &{\\qquad\\le\\alpha\\displaystyle\\sum_{m\\in\\mathcal{M}}\\|G_{m,h}(a)-\\tilde{G}_{m,h}(a)R_{m,h}\\|_{2}\\|W_{m,h}(s)\\|_{2}+\\alpha\\sigma_{i^{\\prime\\prime}+1}(\\tilde{G}_{h})\\sqrt{d M}\\displaystyle\\sum_{m\\in\\mathbb{K}}\\|\\mathcal{W}_{m,h}\\|_{2}}\\\\ &{\\qquad\\le\\alpha\\sqrt{\\displaystyle\\frac{d}{d\\mu}}\\displaystyle\\left(\\displaystyle\\sum_{m\\in\\mathcal{M}}\\|G_{m,h}(a)-\\tilde{G}_{m,h}(a)R_{m,h}\\|_{2}+\\sigma_{i^{\\prime\\prime}+1}(\\tilde{G}_{h})\\sqrt{d M}\\right)}\\\\ &{\\qquad\\le\\sqrt{\\displaystyle\\frac{d^{\\prime\\prime}H\\delta}{d\\mu}}\\displaystyle\\left(\\displaystyle\\sum_{m\\in\\mathcal{M}}\\|G_{m,h}(a)-\\tilde{G}_{m,h}(a)R_{m,h}\\|_{2}+\\sigma_{i^{\\prime\\prime}+1}(\\tilde{G}_{h})\\sqrt{d M}\\right)}\\\\ &{\\qquad\\le\\sqrt{\\displaystyle\\frac{d^{\\prime\\prime}H\\delta}{T}}}\\end{array}\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "from the Cauchy-Schwarz inequality and our singular vector perturbation bound. From the same logic, ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\left|\\sum_{s^{\\prime}\\in S}(P_{h}(s^{\\prime}|s,a)-U_{h}(s^{\\prime},s)G_{h}^{d^{\\prime\\prime}}(a)^{\\top})\\right|\\leq\\sqrt{\\frac{d^{\\prime\\prime}H S}{T}}.\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "Therefore, $G_{h}^{d^{\\prime\\prime}}(a)$ satisfies Assumption 4 with $\\begin{array}{r}{\\xi=\\sqrt{\\frac{d^{\\prime\\prime}H S}{T}}}\\end{array}$ . Then it follows that running LSVIUCB-TR using $G_{h}^{d^{\\prime\\prime}}(a)$ with $\\delta^{\\prime}=\\delta/2$ during the target phase of the algorithm admits a regret bound of ", "page_idx": 22}, {"type": "equation", "text": "$$\nR e g r e t(T)\\leq C^{\\circ}(\\sqrt{(d^{\\prime\\prime})^{3}H^{3}S T}+d^{\\prime\\prime}H T\\sqrt{\\frac{d^{\\prime\\prime}H S}{T}})\\in\\tilde{O}(\\sqrt{(d^{\\prime\\prime})^{3}H^{3}S T})\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "with probability at least $1-\\delta$ from a final union bound. Furthermore, the sample complexity in the source phase is ", "page_idx": 22}, {"type": "equation", "text": "$$\n\\tilde{O}\\left(\\frac{d^{7}\\mu^{5}\\kappa^{4}(A+A^{2})M^{3}H^{4}\\alpha^{2}T}{S d^{\\prime\\prime}}\\right),\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "which proves our result. ", "page_idx": 22}, {"type": "text", "text": "We now prove Theorem 4. ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Proof. Suppose the assumption stated in Theorem 4 hold. Then, from [30], running LR-EVI with a sample complexity of $C^{\\acute{\\prime}}d^{5}\\mu^{5}\\kappa^{4}(S+A)M^{2}H^{4}\\alpha^{2}T\\log(2S A d M H/\\delta)/S$ on each source MDP r\u221aesults in $\\bar{Q}_{m,h}$ \u221a functions with singular value decomposition $\\bar{Q}_{m,h}\\,=\\,\\hat{F}_{m,h}\\hat{\\Sigma}_{m,h}\\hat{G}_{m,h}$ that are $\\sqrt{H S}/(16\\alpha\\mu\\kappa\\sqrt{d^{2}M^{2}T})$ -optimal with probability at least $1-\\delta/2$ . ", "page_idx": 22}, {"type": "text", "text": "Since our estimates are $\\sqrt{H S}/(16\\alpha\\kappa\\sqrt{d^{2}M^{2}T})$ -optimal, it follows that $\\bar{\\gamma}<1/2$ in the singular vector perturbation bound, Corollary 3. Since $\\|Q_{m,h}^{*}\\|_{\\infty}\\geq C$ , from Corollary 3, it follows that there exists rotation matrices $R_{m,h}$ such that ", "page_idx": 22}, {"type": "equation", "text": "$$\n\\|(\\hat{G}_{m,h}R_{m,h}-G_{m,h})(a)\\|_{2}\\leq\\frac{\\sqrt{H d\\mu S}}{\\alpha\\sqrt{A M^{2}T}}\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "for all $a\\ \\ \\in\\ \\ A$ where the optimal $Q$ function have singular value decomposition $Q_{m,h}^{*}\\;=\\;$ Fm,h\u03a3m,hG\u22a4m,h. ", "page_idx": 22}, {"type": "text", "text": "Let $\\tilde{G}$ be the $A\\times d M$ matrix from joining all the source action latent factor matrices, and $\\hat{\\tilde{G}}_{h}$ be the $A\\times d M$ matrix from joining all $\\bar{G}_{m,\\bar{h}}$ . Let $R_{h}$ be the $d\\times d M$ matrix that joins $R_{m,h}$ for all $m\\in[M]$ . Then, from Assumption 2 and Definition 3, it follows that for all $(s^{\\prime},s,a)\\in S\\times S\\times A$ , that ", "page_idx": 22}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{r_{h}(s,a)=\\displaystyle\\sum_{i\\in[d]}W_{h}(s,i)G_{h}(a,i)}\\\\ &{\\qquad=\\displaystyle\\sum_{i\\in[d]}\\left(\\sum_{j\\in[d],m\\in[M]}B(i,j,m)G_{h,m}(a,j)\\right)W_{h}(s,i)}\\\\ &{\\qquad=\\displaystyle\\sum_{i,j\\in[d],m\\in[M]}B(i,j,m)G_{m,h}(a,j)W_{h}(s,i)}\\\\ &{\\qquad=\\displaystyle\\hat{W}_{h}^{\\prime}(s)G_{h}(a)^{\\top}}\\\\ &{\\qquad=\\displaystyle\\hat{W}_{h}^{\\prime}(s)G_{h}(a)^{\\top}}\\end{array}\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "and $P(s^{\\prime}|\\cdot,\\cdot)\\,=\\,\\tilde{G}_{h}U_{h}^{\\prime}(s^{\\prime})^{\\top}$ (with the same argument) for some $S\\,\\times\\,d M$ matrices $W_{h}^{\\prime},U_{h}^{\\prime}(s^{\\prime})$ with entries bounded by $\\alpha$ . Note that $W_{h}^{\\prime}$ and $\\bar{U}_{h}^{\\prime}(s^{\\prime})$ are matrices that join $W_{m,h}$ and $U_{m,h}(s^{\\prime})$ , respectively, with entries that at most $\\alpha$ times larger than the original entry. Let G\u02dct be the thresholded feature mapping, where $t$ is defined as $t=\\mathrm{min}_{t^{\\prime}\\in\\mathcal{T}}t^{\\prime}$ for ", "page_idx": 22}, {"type": "equation", "text": "$$\nT=\\left\\{t\\in[d M]|\\sigma_{t+1}\\leq\\sqrt{\\frac{t H S d\\mu}{\\alpha^{2}T(d M-t)M^{2}A}}\\right\\}.\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "Therefore, with the same logic as the previous proof, it follows for all $(s^{\\prime},s,a,h)\\in\\mathcal{S}\\times\\mathcal{S}\\times\\mathcal{A}\\times[H]$ , ", "page_idx": 23}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{r_{h}(s,a)-\\hat{G}^{t}(a)R_{h}W_{h}^{\\prime}(s)^{\\top}|=|\\tilde{G}_{h}(a)W_{h}^{\\prime}(s)^{\\top}-\\hat{G}^{t}R_{h}W_{h}^{\\prime}(s)^{\\top}|}\\\\ &{\\leq|(\\tilde{G}_{h}(a)-\\hat{G}_{h}(a)R_{h})W_{h}^{\\prime}(s)|+|\\hat{G}_{h}(a)R_{h}W_{h}^{\\prime}(s)^{\\top}-\\hat{G}_{h}^{t}(a)(R_{h}W_{h}^{\\prime}(s)^{\\top}}\\\\ &{\\leq\\sqrt{\\frac{H S}{T}}+|\\hat{G}_{h}(a,t+1:)(R_{h}W_{h}^{\\prime})(s,t+1:)^{\\top}|}\\\\ &{\\leq\\sqrt{\\frac{H S}{T}}+\\sigma_{t+1}\\alpha\\sqrt{d M-t}\\|W_{h}^{\\prime}\\|_{2}}\\\\ &{\\leq\\sqrt{\\frac{H S}{T}}+\\sqrt{\\frac{t H S}{T}}}\\\\ &{\\leq2\\sqrt{\\frac{t H S}{T}}}\\end{array}\n$$", "text_format": "latex", "page_idx": 23}, {"type": "text", "text": "where the second and third inequalities comes from the same logic used in the proofs of Theorems 2 and 4, and the fourth inequality comes from the definition of $t$ . From the same logic, ", "page_idx": 23}, {"type": "equation", "text": "$$\n\\left|\\sum_{s^{\\prime}\\in S}(P_{h}(s^{\\prime}|s,a)-U_{h}(s^{\\prime},s)\\hat{\\tilde{G}}^{t}(a)^{\\top})\\right|\\leq2\\sqrt{\\frac{t H S}{T}}.\n$$", "text_format": "latex", "page_idx": 23}, {"type": "text", "text": "Therefore, $\\hat{\\tilde{G}}_{h}(a)$ satisfies Assumption 4 with $\\begin{array}{r}{\\xi\\,=\\,\\sqrt{\\frac{t H S}{T}}}\\end{array}$ . Then it follows that running LSVIUCB-TR using $\\hat{\\tilde{G}}_{h}^{t}(a)$ with $\\delta^{\\prime}=\\delta/2$ during the target phase of the algorithm admits a regret bound of ", "page_idx": 23}, {"type": "equation", "text": "$$\nR e g r e t(T)\\le C^{\\circ}(\\sqrt{t^{3}H^{3}S T}+2t H T\\sqrt{\\frac{t H S}{T}})\\in\\tilde{O}(\\sqrt{t^{3}H^{3}S T})\n$$", "text_format": "latex", "page_idx": 23}, {"type": "text", "text": "with probability at least $1-\\delta$ from a final union bound. Furthermore, the sample complexity in the source phase is ", "page_idx": 23}, {"type": "equation", "text": "$$\n\\tilde{O}\\left(\\frac{d^{5}\\mu^{5}\\kappa^{4}(S+A)M^{3}H^{4}\\alpha^{2}T}{S}\\right),\n$$", "text_format": "latex", "page_idx": 23}, {"type": "text", "text": "which proves our result. ", "page_idx": 23}, {"type": "text", "text": "F $(S,d,A)$ Tucker Rank Setting ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "In this section, we present the assumptions, algorithm, and results for the $(S,d,A)$ Tucker rank setting. In this setting, we assume the following structure on the source and target MDPs. ", "page_idx": 23}, {"type": "text", "text": "Assumption 5. In each of the $M$ source MDPs, the reward functions have rank $d_{\\cdot}$ , and the transition kernels have Tucker rank $(S,d,A)$ . Let the target MDP\u2019s reward functions have rank $d^{\\prime}$ and transition kernels have Tucker rank $(S,d^{\\prime},A)$ where $d^{\\prime}\\leq d M$ . Thus, there exists $S\\times d\\times A$ tensors $U_{m,h}$ , $S\\times d^{\\prime}\\times A$ tensors $U_{h}$ , $S\\times d\\,\\mu$ -incoherent matrices $F_{m,h}$ , $S\\times d^{\\prime}\\;\\mu$ -incoherent matrices $F_{h}$ with orthonormal columns, and $A\\times d$ matrices $W_{m,h}$ , $A\\times d^{\\prime}$ matrices $W_{h}$ such that ", "page_idx": 23}, {"type": "equation", "text": "$$\n\\begin{array}{r}{P_{m,h}(s^{\\prime}|s,a)=\\sum_{i\\in[d]}F_{m,h}(s,i)U_{m,h}(s^{\\prime},a,i),\\quad r_{m,h}(s,a)=\\sum_{i\\in[d]}F_{m,h}(s,i)W_{m,h}(a,i)}\\end{array}\n$$", "text_format": "latex", "page_idx": 23}, {"type": "text", "text": "and ", "page_idx": 23}, {"type": "equation", "text": "$$\n\\begin{array}{r}{P_{h}(s^{\\prime}|s,a)=\\sum_{i\\in[d^{\\prime}]}F_{h}(s,i)U_{h}(s^{\\prime},a,i),\\quad r_{h}(s,a)=\\sum_{i\\in[d^{\\prime}]}F_{h}(s,i)W_{h}(a,i)}\\end{array}\n$$", "text_format": "latex", "page_idx": 23}, {"type": "text", "text": "where $\\begin{array}{r l}{\\|\\sum_{s^{\\prime}\\in\\mathcal{S}}g(s^{\\prime})U_{m,h}(s^{\\prime},:,a)\\|_{2},}&{{}\\|\\sum_{s^{\\prime}\\in\\mathcal{S}}g(s^{\\prime})U_{h}(s^{\\prime},:,a)\\|_{2},\\|W_{h}(a)\\|_{2},\\|W_{m,h}(a)\\|_{2}}\\end{array}$ \u2264 $\\sqrt{S/(d\\mu)}$ for all $s\\in S,\\,a\\in\\mathcal{A},\\,h\\in[H]$ , and $m\\in[M]$ for any function $g:S\\rightarrow[0,1]$ . ", "page_idx": 23}, {"type": "text", "text": "Similarly, to allow transfer of a latent representation between the source and target MDPs, we assume that the subspace spanned by the set of all source latent factors contains the space spanned by the set of target latent factors. ", "page_idx": 23}, {"type": "text", "text": "Assumption 6. Suppose Assumption 5 holds. The target MDP latent factors $F_{h}$ and source MDP latent factors $F_{m,h}$ satisfy for all $h\\in[H]$ $|,\\operatorname{Span}(\\{F_{h}(:,i)\\}_{i\\in[d^{\\prime}]})\\subseteq\\operatorname{Span}(\\{F_{m,h}(:,i)\\}_{i\\in[d],m\\in[M]})$ . ", "page_idx": 23}, {"type": "text", "text": "Before defining our transfer-ability coefficient, we first introduce the following notation. We define the set $\\mathbf{\\dot{\\mathcal{B}}}_{h}(F_{h},\\{F_{h,m}\\}_{m\\in M})$ to contain all coefficients of the linear combinations, i.e., $B_{h}\\ \\in\\ \\mathbb{R}^{d^{\\prime},d,M}$ and $B_{h}\\;\\;\\in\\;\\;\\mathcal{B}_{h}(F_{h},\\{F_{h,m}\\}_{m\\in M})$ if for all $i\\;\\;\\in\\;\\;[d^{\\prime}],h\\;\\;\\in\\;\\;[H].$ , $F_{h}(\\cdot,i)\\;\\;=$ $\\begin{array}{r}{\\sum_{j\\in[d],m\\in[M]}B_{h}(i,j,m)F_{m,h}(\\cdot,j)}\\end{array}$ . Furthermore, as the source MDPs latent factors of $Q_{m,h}^{*}$ are not unique, we define $\\alpha$ to measure the difficulty given the best set of latent factors from the source MDPs. Thus, $\\alpha$ precisely measures the challenge involved in transferring the latent representation. ", "page_idx": 24}, {"type": "text", "text": "Definition 4 (Transfer-ability Coefficient). Given a transfer RL problem that satisfies Assumptions $^{5}$ , $\\textit{6}$ , and 3, let $\\mathcal{F}$ be the set of all $\\mathbb{R}^{S\\times d}$ matrices with orthonormal columns that span the column space of $Q_{m,h}^{*}$ for all $m\\in[M],h\\in[H]$ . Then, we define $\\alpha$ as ", "page_idx": 24}, {"type": "equation", "text": "$$\n\\alpha:=\\operatorname*{max}_{h\\in[H]}\\operatorname*{min}_{F\\in\\mathcal{F}}\\operatorname*{min}_{B\\in\\mathcal{B}_{h}(F_{h},F)}\\operatorname*{max}_{i\\in[d^{\\prime}],j\\in[d],m\\in[M]}|B(i,j,m)|.\n$$", "text_format": "latex", "page_idx": 24}, {"type": "text", "text": "We now prove our lower bound in this Tucker rank setting. ", "page_idx": 24}, {"type": "text", "text": "F.1 Information Theoretic Lower Bound ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "To formalize the importance of $\\alpha$ in transfer learning, we prove a lower bound that shows that a dependence on $\\alpha$ in the sample complexity of the source phase is necessary to benefit from transfer learning. ", "page_idx": 24}, {"type": "text", "text": "Theorem 7. There exist two transfer $R L$ instances such that (i) they satisfy Assumptions 5 and 6, (ii) they cannot be distinguished without observing $\\Omega(\\alpha^{2})$ samples in the source phase, and (3) they have target state latent features that are orthogonal to each other. ", "page_idx": 24}, {"type": "text", "text": "Proof. Suppose all source and target MDPs $(S,A,P,H,r)$ share the same state space, action space, and horizon $H=1$ and assume that $S=A=[2n]$ for some $n\\in\\mathbb{N}_{+}$ . For ease of notation, we let $s_{1}$ and $a_{1}$ refer to any state and action in $[n]$ , respectively, and $s_{2}$ and $a_{2}$ refer to any state and action in $\\{n+1,\\ldots2n\\}$ , respectively. We will present the latent factors and optimal Q functions as block vectors and matrices with $s_{1},s_{2},a_{1},a_{2}$ as the blocks containing $n$ entries. The initial state distribution in the target MDP is uniform over $\\boldsymbol{S}$ . We now present two transfer RL problems with similar $Q$ functions (with rows $s_{1},s_{2}$ and columns $a_{1},a_{2})$ that satisfy Assumptions 5 and 6 but have orthogonal target state latent factors. For ease of notation, the superscript $i$ of $Q_{m,h}^{*,i},Q_{h}^{*,i}$ denotes transfer RL problem. Then, the optimal $Q$ functions for transfer RL problem one are ", "page_idx": 24}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathsf{\\Lambda}_{1,1}^{*,1}=n\\left[\\sqrt{1/(2n)}\\right]\\left[\\sqrt{1/n}\\quad0\\right]=\\left[1/\\sqrt{2}\\quad0\\right],\\quad Q_{2,1}^{*,1}=n\\left[\\sqrt{1/(2n)}\\right]\\left[0\\quad\\sqrt{1/n}\\right]=\\left[0\\quad1/\\sqrt{2}\\quad0\\right],}\\\\ &{\\mathsf{\\Lambda}_{1}^{*,1}=n\\left[\\sqrt{1/(2n)}\\right]\\left[\\sqrt{\\frac{1}{n}}\\quad-\\sqrt{\\frac{1}{n}}\\right]=\\left[1/2\\quad-1/2\\right],}\\end{array}\n$$", "text_format": "latex", "page_idx": 24}, {"type": "text", "text": "and the optimal $Q$ functions for transfer RL problem two are ", "page_idx": 24}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathsf{\\Lambda}_{1,1}^{*,2}=n\\left[\\sqrt{1/(2n)}\\right]\\left[\\sqrt{1/n}\\quad0\\right]=\\left[1/\\sqrt{2}\\quad0\\right]\\quad Q_{2,1}^{*,2}=n F^{\\prime}\\left[0\\quad\\sqrt{1/n}\\right]=\\left[0\\quad(1+1/\\alpha)/(c\\mathbf{v}-\\mathbf{v})\\right]\\,,}\\\\ &{\\mathsf{\\Lambda}_{1}^{*,2}=n\\left[\\sqrt{1/(2n)}\\right]\\left[\\sqrt{\\frac{1}{n}}\\quad-\\sqrt{\\frac{1}{n}}\\right]=\\left[1/2\\right.\\quad-1/2\\right],}\\end{array}\n$$", "text_format": "latex", "page_idx": 24}, {"type": "text", "text": "where ", "page_idx": 24}, {"type": "equation", "text": "$$\nF^{\\prime}=\\left[(\\sqrt{1/(2n)}+\\sqrt{1/(2n\\alpha^{2})}/\\sqrt{1+1/\\alpha^{2}}\\quad(\\sqrt{1/(2n)}-\\sqrt{1/(2n\\alpha^{2})}/\\sqrt{1+1/\\alpha^{2}}\\right]\n$$", "text_format": "latex", "page_idx": 24}, {"type": "text", "text": "and $c\\in(1,2d M)$ because $\\alpha\\geq1/(d M)$ from Lemma 1 for $\\alpha>0$ . The incoherence $\\mu$ , rank $d$ , and condition number $\\kappa$ of the above $Q$ functions are $O(1)$ . Furthermore, the above construction satisfies Assumption 5 with Tucker rank $(S,1,A)$ and Assumption 6 because the source and target MDPs share the same state latent factor $[\\sqrt{1/(2n)},\\sqrt{1/(2n)}]$ in the first transfer RL problem while in the second transfer RL problem, ", "page_idx": 24}, {"type": "equation", "text": "$$\n\\left[\\sqrt{1/(2n)}\\quad-\\sqrt{1/(2n)}\\right]=-\\alpha\\left[\\sqrt{1/(2n)}\\quad\\sqrt{1/(2n)}\\right]+\\alpha c F^{'\\top}.\n$$", "text_format": "latex", "page_idx": 24}, {"type": "text", "text": "Furthermore, note that the target latent factors, ", "page_idx": 24}, {"type": "equation", "text": "$$\nF^{1}=\\left[{\\sqrt[{1/(2n)}]{\\mathrm{~}}}\\,\\,{\\mathrm{and~}}F^{2}=\\left[{\\sqrt[{1/(2n)}}\\,\\right]\n$$", "text_format": "latex", "page_idx": 24}, {"type": "text", "text": "are orthogonal to each other. ", "page_idx": 25}, {"type": "text", "text": "The learner is given either transfer RL problem one or two with equal probability with a generative model in the source problem. When interacting with the source MDPs, the learner specifies a stateaction pair $(s,a)$ and source MDP $m$ and observes a realization of a shifted and scaled Bernoulli random variable $X$ . The distribution of $X$ is that $X=1$ with probability $(Q_{m,1}^{*,i}(s,a)+1)/2$ and $X=-1$ with probability $(1-Q_{m,1}^{*,i}(s,a))/2)$ . Furthermore, the learner is given the knowledge that the state latent features lie in the function class $\\mathcal{F}=\\{F^{1},F^{2}\\}$ and must use the knowledge obtained from interacting with the source MDP to choose one to use in the target MDP, which is no harder than receiving no information about the function class. ", "page_idx": 25}, {"type": "text", "text": "To distinguish between the two transfer RL problems, one needs to differentiate between $Q_{2,1}^{*,1}$ and $Q_{2,1}^{*,2}$ . By construction, the magnitude of the largest entrywise difference between $Q_{2,1}^{*,1}$ and $Q_{2,1}^{*,2}$ i lower bounded by $\\Omega(1/\\alpha)$ . ", "page_idx": 25}, {"type": "text", "text": "If the learner observes $Z$ samples in the source MDPs, where $Z\\le{\\cal O}(\\alpha^{2})$ for some constant $C>0$ , then the probability of correctly identifying $F$ is upper bounded by 0.76 (Lemma 5.1 with $\\delta=0.24$ [5]). Thus, if the learner does not observe $\\bar{\\Omega}(\\alpha^{2})$ samples in the source phase, then the learner returns the incorrect feature mapping that is orthogonal to the true feature mapping with probability at least 0.24. \u53e3 ", "page_idx": 25}, {"type": "text", "text": "Theorem 7 states that unless one incurs a sample complexity of $\\Omega(\\alpha^{2})$ in the source phase, the latent representation $F$ learned in the source phase is useless in the target phase as one would incur linear regret using $F$ . ", "page_idx": 25}, {"type": "text", "text": "Our algorithm in this setting is essentially the same as the one used in the $(S,S,d)$ Tucker rank setting except we construct our latent factors using the other set of singular vectors and compute Gram matrices and coefficients for each action instead of each state. ", "page_idx": 25}, {"type": "text", "text": "Algorithm 3 Source Phase   \nInput: $\\{N_{h}\\}_{h\\in[H]}$   \n1: for $m\\in[M]$ do   \n2: Run LR-EVI $(\\{N_{h}\\}_{h\\in[H]})$ on source MDP $m$ to obtain $\\bar{Q}_{m,h}$ .   \n3: Compute the singular value decomposition of $\\bar{Q}_{m,h}=\\hat{F}_{m,h}\\hat{\\Sigma}_{m,h}\\hat{G}_{m,h}^{\\top}$ .   \n4: Compute feature mapping $\\hat{\\tilde{F}}=\\hat{\\tilde{F}}_{h}\\}_{h\\in[H]}$ with $\\begin{array}{r}{\\hat{\\tilde{F}}_{h}=\\left\\{\\sqrt{\\frac{S}{d\\mu}}\\hat{F}_{m,h}(:,i)|i\\in[d],m\\in[M]\\right\\}}\\end{array}$ . ", "page_idx": 25}, {"type": "text", "text": "Algorithm 4 Target Phase: LSVI-UCB-(S, d, A) ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "Input: $\\lambda,\\beta_{k,h}^{a},\\hat{\\tilde{F}}$   \n1: for $k\\in[K]$ do   \n2: Receive initial state $s_{1}^{k}$ .   \n3: for $h=H,\\ldots,1$ do   \n4: for $a\\in{\\mathcal{A}}$ do   \n5: $\\begin{array}{r l}&{\\mathrm{\\boldmath~\\hat{~\\xet}~}_{h}^{\\star}\\leftarrow\\sum_{t\\in T_{k-1,h}^{a}}\\hat{\\tilde{F}}_{h}(s_{h}^{t})\\hat{\\tilde{F}}_{h}(s_{h}^{t})^{\\top}+\\lambda{\\mathbf{I}}.}\\\\ &{\\ \\ \\ \\times\\mathrm{Compute~\\ensuremath{\\operatorname{Gram}\\ m a t r i x}~\\ }_{h}^{\\Delta}\\ast/}\\\\ &{\\ \\ \\mathrm{Set}\\ \\boldsymbol{w}_{h}^{a}\\leftarrow(\\boldsymbol{\\Lambda}_{h}^{a})^{-1}\\sum_{t\\in T_{k-1,h}^{a}}\\hat{\\tilde{F}}_{h}(s_{h}^{t})\\ \\Big[{r}_{h}(s_{h}^{t},a)+\\operatorname*{max}_{a^{\\prime}\\in A}Q_{h+1}(s_{h+1}^{t},a^{\\prime})\\Big].}\\\\ &{\\ \\ \\ \\times\\mathrm{Estimate}\\ \\ \\boldsymbol{w}_{h}^{a}\\mathrm{\\boldmath~\\ensuremath{via}~\\ensuremath{\\ r e g u l a r i z e d~\\ensuremath{\\operatorname{1east}\\ s q u a r e s~\\ensuremath{\\ast\\!\\!}}~}}}\\\\ &{\\mathrm{\\boldmath~\\forall~\\ensuremath{\\mathcal{Q}h}(\\cdot,\\cdot)\\leftarrow\\operatorname*{min}\\Big(H,\\langle\\boldsymbol{w}_{h}^{\\cdot},\\hat{\\tilde{F}}_{h}(\\cdot)\\rangle+\\beta_{\\boldsymbol{k},h}^{\\cdot}\\sqrt{\\hat{F}_{h}(\\cdot)^{\\top}(\\boldsymbol{\\Lambda}_{h}^{\\cdot})^{-1}\\hat{\\tilde{F}}_{h}(\\cdot)}\\Big).}}\\\\ &{\\ \\ \\ \\mathrm{\\Estimate}\\ \\ \\boldsymbol{w}_{h}^{s}\\mathrm{\\boldmath~\\forall~\\!\\!\\hat{~}\\mathrm{1a}~\\ensuremath{\\ r e g u l a r i z e d~\\ensuremath{\\operatorname{1east}\\ s q u a r e s~\\ensuremath{\\ast\\!\\!}}~}}}\\end{array}$   \n6:   \n7:   \n8:   \n9: S   \n10: /   \n11: for $h\\in[H]$ do   \n12: Take action akh \u2190\u2212maxa\u2208A Qh(skh, a), and observe skh+1. ", "page_idx": 25}, {"type": "text", "text": "We first present the theoretical guarantees of LSVI-UCB-(S, d, A) and defer their proofs to Appendix J. ", "page_idx": 25}, {"type": "text", "text": "Before proving our main positive result in the $(S,d,A)$ Tucker rank setting, we first present the definitions and theorems of LSVI-UCB-(S, d, A) and defer their proofs to Appendix J. If one is given the true latent low-rank representation of each state, then LSVI-UCB-(S, d, A) admits the following regret bound. ", "page_idx": 26}, {"type": "text", "text": "Theorem 8. Assume that Assumption 5 holds and the learner is given the true latent state representation $F=\\{F_{h}\\}_{h\\in[H]}$ . Then, there exists a constant $c>0$ such that for any $\\delta\\in(0,1)$ , if we set $\\lambda=1,\\beta_{k,h}^{a}=c d H\\sqrt{\\iota},\\iota=\\log(2d T A/\\delta)$ , then with probability at least $1-\\delta$ , the total regret of LSVI-UCB-TR is $\\tilde{O}(\\sqrt{d^{3}A H^{3}T})$ . ", "page_idx": 26}, {"type": "text", "text": "Theorem 8 states that LSVI-UCB-TR completely removes the regret bound\u2019s dependence on the size of the state space by utilizing the latent state representation $F$ . To measure the algorithm\u2019s robustness with respect to misspecification error of the low-rank representation, we first define $\\xi$ -approximate $(S,d,A)$ Tucker rank MDPs (similarly to Assumption B from [17]). ", "page_idx": 26}, {"type": "text", "text": "Assumption 7 ( $\\xi$ -approximate $(S,d,A)$ Tucker rank MDP). Let $\\xi~\\in~[0,1]$ . Then, an MDP $(S,{\\mathcal{A}},P,r,H)$ is a $\\xi$ -approximate $(S,d,A)$ Tucker rank MDP with given feature map $F$ if there exist $H$ unknown $A$ -by- $d$ matrices $W=\\{W_{h}\\}_{h\\in[H]}$ and $S$ -by- $d$ -by- $A$ tensors $U=\\{U_{h}\\}_{h\\in[H]}$ such that ", "page_idx": 26}, {"type": "equation", "text": "$$\n|r_{h}(s,a)-F_{h}(s)^{\\top}W_{h}(a)|\\leq\\xi,\n$$", "text_format": "latex", "page_idx": 26}, {"type": "equation", "text": "$$\n\\left|\\sum_{s^{\\prime}\\in S}(P_{h}(s^{\\prime}|s,a)-F_{h}(s)^{\\top}U_{h}(s^{\\prime},a))\\right|\\leq\\xi\n$$", "text_format": "latex", "page_idx": 26}, {"type": "text", "text": "for all $h\\,\\in\\,[H]$ where $\\begin{array}{r}{\\|W_{h}\\|_{2},\\|\\sum_{s^{\\prime}\\in\\mathcal{S}}g(s^{\\prime})U_{h}(s^{\\prime},a)\\|_{2}\\,\\le\\,\\sqrt{S/(d\\mu)}}\\end{array}$ for any function $g:{\\mathcal{S}}\\rightarrow$ $[0,1]$ . ", "page_idx": 26}, {"type": "text", "text": "The following result shows that similar to LSVI-UCB, our algorithm is robust to the misspecified setting. ", "page_idx": 26}, {"type": "text", "text": "Theorem 9. Suppose that the learner is given a feature mapping $F^{\\prime}$ that satisfies Assumption 7. T\u221ahen, using $F=\\sqrt{S/(d\\mu)}F^{\\prime}$ as the feature mapping for any $\\delta\\in(0,1)$ and $\\lambda=1,\\beta_{k,h}^{a}=O(H d\\sqrt{\\iota}+$ $\\xi\\sqrt{d|T_{k,h}^{a}|}{\\cal H})$ for $\\iota=\\log(2d T A/\\delta)$ , the regret of LSVI-UCB-TR is $\\tilde{O}(\\sqrt{d^{3}H^{3}A T}+\\xi d H T)$ with probability at least $1-\\delta$ . ", "page_idx": 26}, {"type": "text", "text": "The above theorem states that the misspecification error adds a term that is linear in $T$ to the regret bound of LSVI-UCB-(S, d, A). Thus, if one\u2019s latent state representat\u221aion is close enough, i.e., $\\xi$ is so small that there exists some positive constant $c$ such that $\\xi d H T\\le c\\sqrt{d^{3}H^{3}A T}$ , then LSVI-UCB-(S, d, A) admits a regret bound that is independent of the state space, which is the motivation for our main result. We now present our main theorem. ", "page_idx": 26}, {"type": "text", "text": "Theorem 10. Suppose Assumptions 5, 6, and 3 hold, and set $\\delta\\,\\in\\,(0,1)$ . Furthermore, assume that, for any $\\epsilon\\in(0,\\sqrt{A H/T})$ , $Q_{m,h}=r_{m,h}+P_{m,h}V_{m,h+1}$ has rank $d$ and is $\\mu$ -incoherent with condition number $\\kappa$ for all $\\epsilon$ -optimal value functions $V_{h+1}$ . Also, let $\\lambda=1$ and $\\beta_{k,h}^{a}$ be a function of $d,H,|T_{k,h}^{a}|,|A|,M,T$ . Then, for $\\textstyle T\\geq{\\frac{A}{\\alpha^{2}}}$ , using at most $\\tilde{O}\\left(d^{4}\\mu^{5}\\kappa^{4}(S/A+1)M^{2}H^{4}\\alpha^{2}T\\right)$ samples in the source problems, our algorithm has regret at most $\\tilde{O}\\left(\\sqrt{(d M H)^{3}A T}\\right)$ with probability at least $1-\\delta$ . ", "page_idx": 26}, {"type": "text", "text": "Theorem 10 states that using transfer learning improves the performance on the target problem by removing the regret bound\u2019s dependence on the state space. Thus, with enough samples from the source MDPs one can recover a regret bound in the target problem that matches the best regret bound for any algorithm in the $(S,d,A)$ Tucker rank setting with known latent feature representation $F$ concerning $A$ and $T$ . We now prove Theorem 10. ", "page_idx": 26}, {"type": "text", "text": "Proof. Suppose the assumption stated in Theorem 10 hold. Then, from [30], running LR-EVI with a sample complexity of $\\bar{C^{\\prime}}d^{4}\\mu^{5}\\kappa^{4}(S+A)M H^{4}\\alpha^{2}T\\log(2S A d M H/\\delta)/A$ on each source MDP r\u221aesults in $\\bar{Q}_{m,h}$ \u221afunctions with singular value decomposition $\\bar{Q}_{m,h}\\,=\\,\\hat{F}_{m,h}\\hat{\\Sigma}_{m,h}\\hat{G}_{m,h}$ that are $\\sqrt{H A}/(16\\alpha\\mu\\kappa\\sqrt{d M T})$ -optimal with probability at least $1-\\delta/2$ . ", "page_idx": 26}, {"type": "text", "text": "Since our estimates are $\\sqrt{H A}/(16\\alpha\\sqrt{d M T})$ -optimal, it follows that $\\bar{\\gamma}<1/2$ in the singular vector perturbation bound, Corollary 3. Since $\\|Q_{m,h}^{*}\\|_{\\infty}\\geq C$ , from Corollary 3, it follows that there exists rotation matrices $R_{m,h}$ such that ", "page_idx": 27}, {"type": "equation", "text": "$$\n\\|({\\hat{F}}_{m,h}R_{m,h}-F_{m,h})(s)\\|_{2}\\leq{\\frac{d{\\sqrt{H\\mu A}}}{\\alpha{\\sqrt{S M T}}}}\n$$", "text_format": "latex", "page_idx": 27}, {"type": "text", "text": "for all $s\\ \\in\\ S$ where the optimal $Q$ function have singular value decomposition $Q_{m,h}^{*}\\;=\\;$ $F_{m,h}\\Sigma_{m,h}G_{m,h}^{\\top}$ . ", "page_idx": 27}, {"type": "text", "text": "Let $\\tilde{F}$ be the $S\\times d M$ matrix from joining all the source state latent factor matrices, and $\\hat{\\tilde{F}}_{h}$ be the $S\\times d M$ matrix from joining all $\\bar{F}_{m,h}$ . Let $R_{h}$ be the $d\\times d M$ matrix that joins $R_{m,h}$ for all $m\\in[M]$ . Then, from Assumption 6 and Definition 4, it follows that for all $(s^{\\prime},s,a)\\in\\mathcal{S}\\times\\mathcal{S}\\times\\mathcal{A}$ , that ", "page_idx": 27}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{r_{h}(s,a)=\\displaystyle\\sum_{i\\in[d]}F_{h}(s,i)W_{h}(a,i)}\\\\ &{\\qquad=\\displaystyle\\sum_{i\\in[d]}\\left(\\sum_{j\\in[d],m\\in[M]}B(i,j,m)F_{h,m}(s,j)\\right)W_{h}(a,i)}\\\\ &{\\qquad=\\displaystyle\\sum_{i,j\\in[d],m\\in[M]}B(i,j,m)F_{m,h}(s,j)W_{h}(a,i)}\\\\ &{\\qquad=\\tilde{F}_{h}(s)W_{h}^{\\prime}(a)^{\\top}}\\\\ &{\\qquad=\\tilde{F}_{h}(s)W_{h}^{\\prime}(a)^{\\top}}\\end{array}\n$$", "text_format": "latex", "page_idx": 27}, {"type": "text", "text": "and $P(s^{\\prime}|\\cdot,\\cdot)=\\tilde{F}_{h}U_{h}^{\\prime}(s^{\\prime})^{\\top}$ (with the same argument) for some $A\\times d M$ matrices $W_{h}^{\\prime},U_{h}^{\\prime}(s^{\\prime})$ . Note that $W_{h}^{\\prime}$ and $U_{h}^{\\prime}(s^{\\prime})$ are matrices that join $W_{m,h}$ and $U_{m,h}(s^{\\prime})$ , respectively, with entries that at most $\\alpha$ times larger than the original entry. ", "page_idx": 27}, {"type": "text", "text": "Therefore, it follows for all $(s^{\\prime},s,a,h)\\in\\mathcal{S}\\times\\mathcal{S}\\times\\mathcal{A}\\times[H],$ ", "page_idx": 27}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{\\lefteqn{\\gamma_{h}(s,a)-\\hat{F}_{h}(s)R_{h}W_{h}^{\\prime}(a)^{\\top}|=|\\tilde{F}_{h}(s)W_{h}^{\\prime}(a)^{\\top}-\\hat{F}_{h}(s)R_{h}W_{h}^{\\prime}(a)^{\\top}|}}\\\\ &{=|(\\tilde{F}_{h}(s)-\\hat{F}_{h}(s)R_{h})W_{h}^{\\prime}(a)|}\\\\ &{\\leq\\alpha|\\sum_{m\\in M}(F_{m,h}(s)-\\hat{F}_{m,h}(s)R_{m,h})W_{m,h}(a)|}\\\\ &{\\leq\\alpha\\displaystyle\\sum_{m\\in M}\\|F_{m,h}(s)-\\hat{F}_{m,h}(s)R_{m,h}\\|_{2}\\|W_{m,h}(a)\\|_{2}}\\\\ &{\\leq\\alpha\\sqrt{\\displaystyle\\frac{S}{d\\mu}}\\displaystyle\\sum_{m\\in M}\\|F_{m,h}(s)-\\hat{F}_{m,h}(s)R_{m,h}\\|_{2}}\\\\ &{\\leq\\alpha\\sqrt{\\displaystyle\\frac{d R M_{M}}{T}}\\displaystyle\\sum_{m\\in M}\\|F_{m,h}(s)-\\hat{F}_{m,h}(s)R_{m,h}\\|_{2}}\\\\ &{\\leq\\sqrt{\\displaystyle\\frac{d R M A}{T}}}\\end{array}\n$$", "text_format": "latex", "page_idx": 27}, {"type": "text", "text": "from the Cauchy-Schwarz inequality and our singular vector perturbation bound. From the same logic, ", "page_idx": 27}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{\\lefteqn{\\sum_{s^{\\prime}\\in S}(P_{h}(s^{\\prime}|s,a)-F_{h}(s)^{\\top}U_{h}(s^{\\prime},a))\\Bigg|=|\\tilde{F}_{h}(s)U_{h}^{\\prime}(s^{\\prime},a)-\\hat{\\tilde{F}}_{h}(s)R_{h}U_{h}^{\\prime}(s^{\\prime},a)^{\\top}|}}\\\\ &{=|(\\tilde{F}_{h}(s)-\\hat{\\tilde{F}}_{h}(s)R_{h})\\sum_{s^{\\prime}\\in S}U_{h}^{\\prime}(s^{\\prime},a)^{\\top}|}\\\\ &{\\leq\\alpha|\\displaystyle\\sum_{m\\in M}(F_{m,h}(s)-\\hat{F}_{m,h}(s)R_{m,h})\\sum_{s^{\\prime}\\in S}U_{m,h}(s^{\\prime},a)|}\\\\ &{\\leq\\alpha\\displaystyle\\sum_{m\\in M}\\|F_{m,h}(s)-\\hat{F}_{m,h}(s)R_{m,h}\\|_{2}\\|\\displaystyle\\sum_{s^{\\prime}\\in S}U_{m,h}(s^{\\prime},a)^{\\top}\\|_{2}}\\\\ &{\\leq\\sqrt{\\frac{d H M A}{T}}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 27}, {"type": "text", "text": "Therefore, F\u02c6\u02dch(s) satisfies Assumption 7 with \u03be = $\\begin{array}{r}{\\xi=\\sqrt{\\frac{d M H A}{T}}}\\end{array}$ dMTHA. Then it follows that running LSVIUCB-TR using $\\hat{\\tilde{F}}_{h}(s)$ with $\\delta^{\\prime}=\\delta/2$ during the target phase of the algorithm admits a regret bound of ", "page_idx": 28}, {"type": "equation", "text": "$$\nR e g r e t(T)\\leq C^{\\circ}(\\sqrt{d^{3}M^{3}H^{3}A T}+d M H\\sqrt{\\frac{d M H A}{T}})\\in\\tilde{O}(\\sqrt{d^{3}M^{3}H^{3}A T})\n$$", "text_format": "latex", "page_idx": 28}, {"type": "text", "text": "with probability at least $1-\\delta$ from a final union bound. Furthermore, the sample complexity in the source phase is ", "page_idx": 28}, {"type": "equation", "text": "$$\n\\tilde{O}\\left(\\frac{d^{4}\\mu^{5}\\kappa^{4}(S+A)M^{2}H^{4}\\alpha^{2}T}{A}\\right),\n$$", "text_format": "latex", "page_idx": 28}, {"type": "text", "text": "which proves our result. ", "page_idx": 28}, {"type": "text", "text": "F.2 Simulator to Simulator Transfer RL ", "text_level": 1, "page_idx": 28}, {"type": "text", "text": "In this section, we consider the same transfer reinforcement learning setting with the low Tucker rank assumptions except the learner is given access to the generative model in both the source and target problems. In this setting, we isolate the statistical difficulty of the transfer RL problem by removing the challenge of exploration. Thus, instead of regret, the goal in this setting is to learn an $\\epsilon$ -optimal $Q$ function in the target phase using as few samples in the source and target phases as possible. The main benefit of having access to a generative model in the target phase is that the learner can choose the best states to observe covariates from when performing the regression step at each time step. In this setting, our algorithm still uses LR-EVI in the source phase (Algorithm 3 and adapts the algorithm from [22] for the finite horizon setting in the target phase. Learning $Q^{*}$ over the support of an approximately optimal design $\\rho$ on our latent factors F\u02dc allows us to construct a good estimate of $Q^{*}$ over all state-action pairs. The optimal design problem that we solve in this algorithm is ", "page_idx": 28}, {"type": "equation", "text": "$$\nG(\\rho)=\\sum_{s\\in S}\\rho(s)\\hat{\\tilde{F}}(s)\\hat{\\tilde{F}}(s)^{\\top},\\quad g(\\rho)=\\operatorname*{max}_{s\\in S}\\|\\hat{\\tilde{F}}\\|_{G(\\rho)^{-1}}\n$$", "text_format": "latex", "page_idx": 28}, {"type": "text", "text": "where $\\rho$ is a probability distribution over $S$ . From Theorems 4.3 and 4.4 [22], one can compute a $\\rho$ such that $g(\\rho)\\leq2d$ , with the core set of states, or anchor states, $S^{\\#}=\\{s\\in S|\\rho(s)>0\\}$ having size at most $4d\\log(\\log(d))+16$ in a polynomial number of computations. This ensures that both the error amplification from using the low-rank structure and the number of states we need to observe $Q^{*}$ is not too large. Our algorithm is tailored to the $(S,d,A)$ Tucker rank setting but can easily be modified for the other Tucker rank settings. ", "page_idx": 28}, {"type": "text", "text": "Algorithm 5 Target Phase ", "text_level": 1, "page_idx": 28}, {"type": "text", "text": "Input: $\\{N_{h}^{t}\\}_{h\\in[H]},\\hat{\\tilde{F}}$ ", "text_level": 1, "page_idx": 28}, {"type": "text", "text": "1: for $h=H,\\ldots,1$ do ", "page_idx": 28}, {"type": "text", "text": "2: Compute $S_{h}^{\\#},\\rho_{h}$ according to the above optimal design problem with $\\hat{\\tilde{F}}_{h}$ ", "page_idx": 28}, {"type": "text", "text": "3: for $(s,a)\\in S_{h}^{\\#}\\times A$ do ", "page_idx": 28}, {"type": "text", "text": "4: Collect $N_{h}^{t}$ samples of the reward function and one-step transition to estimate $\\hat{Q}_{h}(s,a)$ with ", "page_idx": 28}, {"type": "equation", "text": "$$\n\\hat{Q}_{h}(s,a)=\\hat{r}_{h}(s,a)+\\mathbb{E}_{s^{\\prime}\\sim\\hat{P}_{h}(\\cdot|s,a)}[\\hat{V}_{h+1}(s^{\\prime})],\n$$", "text_format": "latex", "page_idx": 28}, {"type": "text", "text": "where $\\hat{r}_{h}(s,a)$ denotes the empirical average of the $N_{h}^{t}$ samples of the reward function, and $\\hat{P}_{h}(\\cdot|s,a)$ denotes the empirical distribution over the $N_{h}^{t}$ samples. ", "page_idx": 28}, {"type": "text", "text": "5: Use the linear structure to estimate $\\bar{Q}$ over all state-action pairs with ", "page_idx": 28}, {"type": "equation", "text": "$$\n\\hat{\\theta}_{a,h}=G(\\rho)^{-1}\\sum_{s\\in\\mathcal{S}_{h}^{\\#}}\\rho(s)\\hat{\\tilde{F}}_{h}(s)\\hat{Q}_{h}(s,a),\\quad\\bar{Q}_{h}(s,a)=\\hat{\\tilde{F}}_{h}(s)\\theta_{a,h}.\n$$", "text_format": "latex", "page_idx": 28}, {"type": "text", "text": "6: Compute the value function and policy using the $Q$ function, ", "page_idx": 28}, {"type": "equation", "text": "$$\n\\hat{V}_{h}(s)=\\operatorname*{max}_{a\\in\\mathcal{A}}\\bar{Q}_{h}(s,a),\\quad\\hat{\\pi}_{h}(s)=\\arg\\operatorname*{max}_{a\\in\\mathcal{A}}\\bar{Q}_{h}(s,a).\n$$", "text_format": "latex", "page_idx": 28}, {"type": "text", "text": "In the source phase, our algorithm learns estimates of $Q_{m,h}^{*}$ and then computes the singular value decomposition to construct approximate feature mappings using the singular subspaces with respect to the state. In step $(a)$ of the target phase, one first approximately solves the optimal design problem to compute the anchor states. After obtaining estimates of the $Q$ function on the anchor states, one uses the linear structure in step $(c)$ to estimate the full $Q$ function over all states with the least squares solution. The above algorithm admits the following sample complexities for learning an $\\epsilon$ -optimal $Q$ function in the target phase. ", "page_idx": 29}, {"type": "text", "text": "Theorem 11. Suppose Assumptions 5, 6, and $^3$ hold, and set $\\delta\\in(0,1)$ . Furthermore, assume that for any $\\epsilon>0$ , $Q_{m,h}=r_{m,h}+P_{m,h}V_{m,h+1}$ has rank $d$ and is $\\mu$ -incoherent with condition number $\\kappa$ for all $\\epsilon$ -optimal value functions $V_{h+1}$ . Then, for $\\epsilon\\leq\\alpha d^{2}$ , using at most ", "page_idx": 29}, {"type": "equation", "text": "$$\n\\tilde{O}\\left(\\frac{d^{7}\\mu^{3}\\kappa^{4}(S+A)H^{9}\\alpha^{2}M^{3}}{\\epsilon^{2}}\\right)\n$$", "text_format": "latex", "page_idx": 29}, {"type": "text", "text": "samples in the source problems, Algorithm 5 learns an $\\epsilon$ -optimal policy in the target MDP using at most ", "page_idx": 29}, {"type": "equation", "text": "$$\n\\tilde{O}\\left(\\frac{d^{2}M^{2}H^{5}A}{\\epsilon^{2}}\\right)\n$$", "text_format": "latex", "page_idx": 29}, {"type": "text", "text": "samples with probability at least $1-\\delta$ . ", "page_idx": 29}, {"type": "text", "text": "Theorem 11 states that with enough samples in the source phase, one can remove the dependence on the size of the state space in the target phase; in tabular finite-horizon MDPs with $(S,{\\bar{d}},A)$ Tucker rank transition kernels, one needs to observe at least $\\tilde{\\Omega}(d(S+A)H^{3}/\\epsilon^{2})$ samples from a generative model to learn an $\\epsilon_{}$ -optimal policy. Furthermore, the source sample complexity\u2019s dependence on $S,A$ , and $H$ are reasonable while the dependence on $\\alpha$ is optimal due to our lower bound. We can easily construct similar algorithms that admit the corresponding theoretical guarantees in the other Tucker rank settings. We now prove Theorem 11. ", "page_idx": 29}, {"type": "text", "text": "Proof. In the source phase, using ", "page_idx": 29}, {"type": "equation", "text": "$$\n\\tilde{O}\\left(\\frac{d^{6}\\mu^{3}\\kappa^{4}(S+A)H^{9}\\alpha^{2}M^{4}}{\\epsilon^{2}}\\right)\n$$", "text_format": "latex", "page_idx": 29}, {"type": "text", "text": "samples guarantees that we learn $\\epsilon/(128H^{2}\\alpha M^{3/2}\\kappa d^{2})$ -optimal $\\hat{Q}_{m,h}=\\hat{F}_{m,h}\\hat{\\Sigma}_{m,h}\\hat{G}_{m,h}^{\\top}$ functions for each source MDP with probability at least $1-\\delta/2$ . Since $\\alpha d^{2}\\geq\\epsilon$ by assumption, we have $\\bar{\\gamma}<1/2$ in the singular vector perturbation bound, Corollary 3. Since $\\|Q_{m,h}^{*}\\|_{\\infty}\\geq C$ , it follows from Corollary 3 that there exists rotation matrices $R_{m,h}$ such that ", "page_idx": 29}, {"type": "equation", "text": "$$\n\\|F_{m,h}-\\hat{F}_{m,h}R\\|_{2,\\infty}\\leq\\frac{\\epsilon\\sqrt{\\mu}}{8H^{2}\\alpha M^{3/2}\\sqrt{S}}\n$$", "text_format": "latex", "page_idx": 29}, {"type": "text", "text": "holds for all $m\\in[M],h\\in[H]$ with probability at least $1-\\delta/2$ . Let $\\tilde{F}$ be the $S\\times d M$ matrix from joining all the source state latent factor matrices, and $\\hat{\\tilde{F}}_{h}$ be the $S\\times d M$ matrix from joining all $\\bar{F}_{m,h}$ . Let $R_{h}$ be the $d\\times d M$ matrix that joins $R_{m,h}$ for all $m\\in[M]$ . Then, from Assumption 6 and Definition 4, it follows that for all $(s^{\\prime},s,a)\\in\\mathcal{S}\\times\\mathcal{S}\\times\\mathcal{A}$ , that ", "page_idx": 29}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{r_{h}(s,a)=\\displaystyle\\sum_{i\\in[d]}F_{h}(s,i)W_{h}(a,i)}\\\\ &{\\qquad=\\displaystyle\\sum_{i\\in[d]}\\left(\\sum_{j\\in[d],m\\in[M]}B(i,j,m)F_{h,m}(s,j)\\right)W_{h}(a,i)}\\\\ &{\\qquad=\\displaystyle\\sum_{i,j\\in[d],m\\in[M]}B(i,j,m)F_{m,h}(s,j)W_{h}(a,i)}\\\\ &{\\qquad=\\tilde{F}_{h}(s)W_{h}^{\\prime}(a)^{\\top}}\\\\ &{\\qquad=\\tilde{F}_{h}(s)W_{h}^{\\prime}(a)^{\\top}}\\end{array}\n$$", "text_format": "latex", "page_idx": 29}, {"type": "text", "text": "and $P(s^{\\prime}|\\cdot,\\cdot)=\\tilde{F}_{h}U_{h}^{\\prime}(s^{\\prime})^{\\top}$ (with the same argument) for some $A\\times d M$ matrices $W_{h}^{\\prime},U_{h}^{\\prime}(s^{\\prime})$ . Note that $W_{h}^{\\prime}$ and $U_{h}^{\\prime}(s^{\\prime})$ are matrices that join $W_{m,h}$ and $U_{m,h}(s^{\\prime})$ , respectively, with entries that at most ", "page_idx": 29}, {"type": "text", "text": "$\\alpha$ times larger than the original entry. Therefore, it follows for all $(s^{\\prime},s,a,h)\\in\\mathcal{S}\\times\\mathcal{S}\\times\\mathcal{A}\\times[H]$ , ", "page_idx": 30}, {"type": "equation", "text": "$$\n\\begin{array}{l l}{\\displaystyle|r_{h}(s,a)-\\hat{\\bar{F}}_{h}(s)R_{h}W_{h}^{\\prime}(a)^{\\top}|=\\big|\\bar{F}_{h}(s)W_{h}^{\\prime}(a)^{\\top}-\\hat{\\bar{F}}_{h}(s)R_{h}W_{h}^{\\prime}(a)^{\\top}|}\\\\ {\\displaystyle}&{\\displaystyle=\\big|(\\bar{F}_{h}(s)-\\hat{\\bar{F}}_{h}(s)R_{h})W_{h}^{\\prime}(a)\\big|}\\\\ &{\\displaystyle\\leq\\alpha\\big|\\sum_{m\\in M}\\big(F_{m,h}(s)-\\hat{F}_{m,h}(s)R_{m,h}\\big)W_{m,h}(a)\\big|}\\\\ {\\displaystyle}&{\\displaystyle\\leq\\alpha\\sum_{m\\in M}\\|F_{m,h}(s)-\\hat{F}_{m,h}(s)R_{m,h}\\|_{2}\\|W_{m,h}(a)\\|_{\\bar{z}}}\\\\ &{\\displaystyle\\leq\\alpha\\sqrt{\\frac{S}{d\\mu}}\\sum_{m\\in M}\\|F_{m,h}(s)-\\hat{F}_{m,h}(s)R_{m,h}\\|_{2}}\\\\ {\\displaystyle}&{\\displaystyle\\leq\\alpha\\sqrt{\\frac{S}{d\\mu}}\\sum_{m\\in M}\\|F_{m,h}(s)-\\hat{F}_{m,h}(s)R_{m,h}\\|_{2}}\\\\ {\\displaystyle}&{\\displaystyle\\leq\\frac{\\epsilon}{8\\sqrt{d M H}}}\\end{array}\n$$", "text_format": "latex", "page_idx": 30}, {"type": "text", "text": "from the Cauchy-Schwarz inequality and our singular vector perturbation bound. From the same logic, ", "page_idx": 30}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{\\lefteqn{\\textstyle P V(s,a)-[\\hat{F}_{h}R_{h}U_{h}^{\\prime}V](s,a)|=|\\sum_{\\substack{s^{\\prime}\\in S}}P_{h}(s^{\\prime}|s,a)V(s^{\\prime})-\\hat{F}_{h}(s)R_{h}U_{h}^{\\prime}(s^{\\prime},a)^{\\top}V(s^{\\prime})|}}\\\\ &{=|\\sum_{\\substack{s^{\\prime}\\in S}}\\hat{F}_{h}(s)U_{h}^{\\prime}(s^{\\prime},a)^{\\top}V(s^{\\prime})-\\hat{F}_{h}(s)R_{h}U_{h}^{\\prime}(s^{\\prime},a)^{\\top}V(s^{\\prime})|}\\\\ &{\\leq H|(\\hat{F}_{h}(s)-\\hat{F}_{h}(s)R)\\sum_{\\substack{s^{\\prime}\\in S}}U_{h}^{\\prime}(s^{\\prime},a)|}\\\\ &{\\leq H\\alpha\\sum_{\\substack{m\\in\\ M}}\\|F_{m,h}(s)-\\hat{F}_{m,h}(s)R\\|_{2}\\|\\sum_{\\substack{s^{\\prime}\\in S}}U_{m,h}(s^{\\prime},a)\\|_{2}}\\\\ &{\\leq\\frac{H\\alpha\\sqrt{S}}{\\sqrt{d}\\tilde{\\mu}}\\sum_{\\substack{m\\in\\ M}}\\|F_{m,h}(s)-\\hat{F}_{m,h}(s)R\\|_{2}}\\\\ &{\\leq\\frac{\\epsilon}{8\\sqrt{d}M H}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 30}, {"type": "text", "text": "From the above result, it follows that for any value function $V$ , the misspecification error of using the approximate feature mapping of the corresponding $Q$ function $Q^{\\prime}=r+P V$ satisfies ", "page_idx": 30}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{|Q_{h}^{\\prime}(s,a)-Q_{h,d}^{\\prime}(s,a)|\\leq|r_{h}(s,a)-\\hat{F}(s)R W(a)^{\\top}|+|P V(s,a)-[\\hat{F}_{h}R_{h}U_{h}^{\\prime}V](s,a)|}\\\\ &{\\qquad\\qquad\\qquad\\leq\\frac{\\epsilon}{8\\sqrt{d M}H^{2}}+\\frac{\\epsilon}{8\\sqrt{d M}H}\\leq\\frac{\\epsilon}{4H\\sqrt{d M}}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 30}, {"type": "text", "text": "To prove our main theorem, we first present the following helper lemma and defer the proof to later in this section. ", "page_idx": 30}, {"type": "text", "text": "Lemma 2. Suppose the setting of Theorem $_{l l}$ holds and that the misspecification error of the bellman update for any value function using an approximate feature mapping satisfies ", "page_idx": 30}, {"type": "equation", "text": "$$\n|Q_{h}^{\\prime}(s,a)-Q_{h,d}^{\\prime}(s,a)|\\leq{\\frac{\\epsilon}{4H{\\sqrt{d M}}}}.\n$$", "text_format": "latex", "page_idx": 30}, {"type": "text", "text": "Then, the learned $Q$ function from our algorithm at time step $h$ satisfies ", "page_idx": 30}, {"type": "equation", "text": "$$\n\\|\\bar{Q}_{h}-Q_{h}^{*}\\|_{\\infty},\\|\\bar{Q}_{h}-Q_{h}^{\\hat{\\pi}}\\|_{\\infty}\\leq\\frac{\\epsilon(H-h+1)}{H}\n$$", "text_format": "latex", "page_idx": 30}, {"type": "text", "text": "From a union bound and applying Lemma 2, it follows that Linear $Q$ -Learning learns an $\\epsilon$ -optimal policy with probability at least $1-\\delta$ . Therefore, the sample complexity of the algorithm is ", "page_idx": 30}, {"type": "equation", "text": "$$\n\\sum_{h\\in H}N_{h}|S_{h}^{\\#}|A\\leq\\tilde{O}\\left(\\frac{d^{2}M^{2}H^{5}A}{\\epsilon^{2}}\\right).\n$$", "text_format": "latex", "page_idx": 30}, {"type": "text", "text": "It follows from the triangle inequality that the learned policy is $2\\epsilon$ -optimal by replacing $2\\epsilon$ with $\\epsilon^{\\prime}$ ", "page_idx": 31}, {"type": "text", "text": "We now prove Lemma 2. ", "page_idx": 31}, {"type": "text", "text": "Proof. We proceed via induction. At time step $H$ (the base case), it follows from Hoeffding\u2019s inequality for $N_{H}=H^{4}d M C^{2}\\log(S A H/\\delta)/\\epsilon^{\\bar{2}}$ for some constant $C>0$ , ", "page_idx": 31}, {"type": "equation", "text": "$$\n|\\hat{Q}_{H}(s,a)-Q_{H}^{*}(s,a)|\\leq\\frac{\\epsilon}{4\\sqrt{d M}H}\n$$", "text_format": "latex", "page_idx": 31}, {"type": "text", "text": "for $(s,a)\\in S_{h}^{\\#}\\times A$ . From Proposition 4.5 from [22] and our assumption on the misspecification error of the approximate feature mapping, it follows that ", "page_idx": 31}, {"type": "equation", "text": "$$\n|\\bar{Q}_{H}(s,a)-Q_{H}^{*}(s,a)|\\leq\\frac{\\epsilon}{H}.\n$$", "text_format": "latex", "page_idx": 31}, {"type": "text", "text": "Since $Q_{H}^{\\hat{\\pi}}=Q_{H}^{*}$ , it follows that the base case holds. ", "page_idx": 31}, {"type": "text", "text": "Next, assume that ", "page_idx": 31}, {"type": "equation", "text": "$$\n\\|\\bar{Q}_{h+1}-Q_{h+1}^{*}\\|_{\\infty},\\|\\bar{Q}_{h+1}-Q_{h+1}^{\\hat{\\pi}}\\|_{\\infty}\\leq\\frac{\\epsilon(H-h)}{H}\n$$", "text_format": "latex", "page_idx": 31}, {"type": "text", "text": "holds with probability at least $1-(H-h)\\delta/(2H)$ . We define $Q_{h}^{\\prime}$ as $Q_{h}^{\\prime}\\,=\\,r_{h}+P_{h}{\\hat{V}}_{h+1}$ . Let $\\begin{array}{r}{Q_{h,d}^{\\prime}=F_{h}(W_{h}+\\sum_{s^{\\prime}\\in S}\\hat{V}_{h+1}(s^{\\prime})U_{h}(s^{\\prime}))}\\end{array}$ . Then, it follows that from Hoeffding\u2019s inequality for $N_{h}=H^{4}C^{2}d M\\log(S A H/\\delta)/\\epsilon^{2}$ for some constant $C>0$ , for all $(s,a)\\in S_{h}^{\\#}\\times A$ , in step (b) of our algorithm, ", "page_idx": 31}, {"type": "equation", "text": "$$\n|\\hat{Q}_{h}(s,a)-Q_{h}^{\\prime}(s,a)|\\leq\\frac{\\epsilon}{4H\\sqrt{d M}}.\n$$", "text_format": "latex", "page_idx": 31}, {"type": "text", "text": "From our assumption on the misspecification error of the approximate feature mapping, it follows that \u2225Q\u2032h \u2212Q\u2032h,d\u2225\u221e\u22644H\u221a\u03f5dM . Then, from Proposition 4.5 [22], we have ", "page_idx": 31}, {"type": "equation", "text": "$$\n|\\bar{Q}_{h}(s,a)-Q_{h,d}^{\\prime}(s,a)|\\leq\\frac{\\epsilon}{2H}+\\frac{\\epsilon}{2H}=\\frac{\\epsilon}{H}\n$$", "text_format": "latex", "page_idx": 31}, {"type": "text", "text": "for all $(s,a)\\in S\\times A$ . Since ", "page_idx": 31}, {"type": "equation", "text": "$$\n|Q_{h}^{*}(s,a)-Q_{h}^{\\prime}(s,a)|\\leq|\\sum_{s^{\\prime}\\in S}(V_{h+1}^{*}(s^{\\prime})-\\hat{V}_{h+1}(s^{\\prime}))P_{h}(s^{\\prime}|s,a)|\\leq\\frac{\\epsilon(H-h)}{H}\n$$", "text_format": "latex", "page_idx": 31}, {"type": "text", "text": "and ", "page_idx": 31}, {"type": "equation", "text": "$$\n|Q_{h}^{\\hat{\\pi}}(s,a)-Q_{h}^{\\prime}(s,a)|\\leq|\\sum_{s^{\\prime}\\in S}(V_{h+1}^{*}(s^{\\prime})-\\hat{V}_{h+1}(s^{\\prime}))P_{h}(s^{\\prime}|s,a)|\\leq\\frac{\\epsilon(H-h)}{H},\n$$", "text_format": "latex", "page_idx": 31}, {"type": "text", "text": "holds from the inductive hypothesis for all $(s,a)\\in S\\times A$ , it follows that ", "page_idx": 31}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{|\\bar{Q}_{h}(s,a)-Q_{h}^{*}(s,a)|\\leq|\\bar{Q}_{h}(s,a)-Q_{h}^{\\prime}(s,a)|+|Q_{h}^{\\prime}(s,a)-Q_{h}^{*}(s,a)|}\\\\ &{\\qquad\\qquad\\qquad\\leq\\displaystyle\\frac{\\epsilon}{H}+\\frac{\\epsilon(H-h)}{H}=\\frac{\\epsilon(H-h+1)}{H},}\\end{array}\n$$", "text_format": "latex", "page_idx": 31}, {"type": "text", "text": "and similarly, ", "page_idx": 31}, {"type": "equation", "text": "$$\n|Q_{h}^{\\hat{\\pi}}(s,a)-\\bar{Q}_{h}(s,a)|\\leq\\frac{\\epsilon(H-h+1)}{H}.\n$$", "text_format": "latex", "page_idx": 31}, {"type": "text", "text": "Thus, the inductive hypothesis holds as a union bound asserts that the above result holds with probability at least $1-\\bar{(}H-h+1)\\delta/(2H)$ . \u53e3 ", "page_idx": 31}, {"type": "text", "text": "G $(d,S,A)$ Tucker Rank Setting ", "text_level": 1, "page_idx": 32}, {"type": "text", "text": "In the low-rank MDP transfer RL setting, [4] provide an algorith\u221am that admits a source sample complexity of $\\tilde{O}(A\\alpha^{3}M T\\log(\\Phi))$ and target regret of $\\tilde{O}(\\bar{\\alpha}H^{2}d^{3/2}\\sqrt{T})$ with high probability in the transfer RL setting with low-rank MDPs. We first present the transfer learning assumptions in [4] needed to prove a lower bound in their setting. Low rank MDPs assume the following stucutre with shared latent representation $\\phi$ , ", "page_idx": 32}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{P_{m,h}(s^{\\prime}|s,a)=\\mu_{m,h}(s^{\\prime})^{\\top}\\phi_{h}(s,a),}\\\\ &{\\quad P_{h}(s^{\\prime}|s,a)=\\mu_{h}(s^{\\prime})^{\\top}\\phi_{h}(s,a),}\\end{array}\n$$", "text_format": "latex", "page_idx": 32}, {"type": "text", "text": "where $\\|\\phi_{h}(s,a)\\|_{2}\\,\\leq\\,1$ and $\\begin{array}{r}{\\|\\int\\mu(s)g(s)d x\\|_{2}\\,\\leq\\,\\sqrt{d}}\\end{array}$ for any function $g:S\\,\\rightarrow\\,[0,1]$ [3] for all $m\\in[M],h\\in[H]$ . To allow transfer learning to occur, [4] assume the following: ", "page_idx": 32}, {"type": "text", "text": "Assumption 8 (Assumption 2.2 [4]). For any $h\\in[H]$ and $s^{\\prime}\\in S$ , there exists $\\alpha_{m,h}(s^{\\prime})\\in\\mathbb{R}$ such that $\\begin{array}{r}{\\mu_{h}\\bar{(\\boldsymbol{s}^{\\prime})}=\\sum_{\\boldsymbol{m}\\in\\lbrack M\\rbrack}\\bar{\\alpha}_{\\boldsymbol{m},h}(\\boldsymbol{s}^{\\prime})\\mu_{\\boldsymbol{m},h}(\\boldsymbol{s}^{\\prime}),}\\end{array}$ , ", "page_idx": 32}, {"type": "text", "text": "and define the task-relatedness coefficient as $\\alpha=\\mathrm{max}_{m\\in[M],h\\in[H],s\\in S}\\,\\alpha_{m,h}(s)$ . They leave determining the optimal dependence on $\\alpha$ as an interesting open question. Similarly to our lower bound in Theorem 1, we prove that one must incur a source sample complexity of $\\Omega(\\alpha^{\\bar{2}})$ to benefti from using transfer learning. Note that in this version of transfer RL, there is no reward function in the source tasks. ", "page_idx": 32}, {"type": "text", "text": "Theorem 12. There exist two transfer RL instances such that (i) they satisfy Assumptions 9 and 8, (ii) they cannot be distinguished without observing $\\Omega(\\alpha^{2})$ samples in the source phase, and (3) they have target state-action latent features that are orthogonal to each other. ", "page_idx": 32}, {"type": "text", "text": "Proof. We consider two low-rank transfer RL problems, in which the source MDPs have similar transition kernels but differing $\\phi$ . All source and target MDPs $(S,{\\mathcal{A}},P,H,r)$ share the same state space, action space, and horizon $H=2$ with $M=2$ . The learner is given access to a generative model in the source problems. To introduce the MDPs (without loss of generality assume that $|S|,|A|$ are even), we first define the feature representations: the feature mapping $\\phi_{i}$ for transfer RL problem $i$ is ", "page_idx": 32}, {"type": "equation", "text": "$$\n\\phi_{1}(s_{1},a_{1})=\\phi_{1}(s_{2},a_{2})=[1,0]^{\\top},\\phi_{1}(s_{1},a_{2})=\\phi_{2}(s_{2},a_{1})=[0,1]^{\\top},\n$$", "text_format": "latex", "page_idx": 32}, {"type": "equation", "text": "$$\n\\phi_{2}(s_{1},a_{1})=\\phi_{2}(s_{2},a_{2})=\\left[0,1\\right]^{\\top},\\phi_{2}(s_{1},a_{2})=\\phi_{2}(s_{2},a_{1})=\\left[1,0\\right]^{\\top}\n$$", "text_format": "latex", "page_idx": 32}, {"type": "text", "text": "where $s_{1}$ refers to states $1,\\ldots,|S|/2$ , $s_{2}$ refers to states $|S|/2+1,\\ldots,|S|$ , and similarly for actions. We will present the transition kernels matrices with $s_{1},s_{2},a_{1},a_{2}$ as the blocks containing $|S|/2$ or $|A|/2$ entries. Clearly, the two feature representations are orthogonal to each other. Next, the ", "page_idx": 32}, {"type": "text", "text": "transition kernels $P_{m,1}^{i}$ for transfer RL problem $i$ and source MDP $m$ are ", "page_idx": 33}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{P_{1,1}^{\\prime\\prime}(n_{1}\\leftrightarrow,-1)=\\{1,2,12\\}\\,\\,-1,20\\Rightarrow(e_{1}\\leftrightarrow,-1)}\\\\ &{\\qquad\\qquad=\\left[1,12,11\\right]\\,\\,-1,20\\Rightarrow\\qquad}\\\\ &{P_{1,2}^{\\prime\\prime}(n_{2}\\leftrightarrow,-1)=\\{1,2,12\\}\\,\\,+1,20\\Rightarrow\\delta_{1}(e_{1}\\leftrightarrow,-1)}\\\\ &{\\qquad\\qquad=\\left[1,2,12\\right]\\,\\,-1,21\\Rightarrow\\,12\\Rightarrow\\qquad}\\\\ &{P_{2,2}^{\\prime\\prime}(n_{1}\\leftrightarrow,-1)=\\{1,2,12\\}\\,\\,-1,20\\Rightarrow\\delta_{2}(e_{2}\\leftrightarrow,-1)}\\\\ &{\\qquad\\qquad=\\left[1,2,12\\right]\\,\\,-1,20\\Rightarrow\\delta_{2}(e_{2}\\leftrightarrow,-1)}\\\\ &{P_{1,1}^{\\prime\\prime}(n_{1}\\leftrightarrow,-1)=\\{1,2,12\\}\\,\\,+1,20\\Rightarrow\\delta_{1}(e_{2}\\leftrightarrow,-1)}\\\\ &{P_{1,2}^{\\prime\\prime}(n_{1}\\leftrightarrow,-1)=\\{1,2,12\\}\\,\\,+1,20\\Rightarrow\\delta_{2}(e_{1}\\leftrightarrow,-1)}\\\\ &{P_{2,1}^{\\prime\\prime}(n_{1}\\leftrightarrow,-1)=\\{1,2,12\\}\\,\\,-1,20\\Rightarrow\\delta_{1}(e_{1}\\leftrightarrow,-1)=\\delta_{2}(e_{2}\\leftrightarrow,-1)}\\\\ &{\\qquad\\qquad=\\left[1,2,12\\right]\\,\\,-1,21\\Rightarrow\\delta_{1}(e_{1}\\leftrightarrow,-1)=\\delta_{2}(e_{1}\\leftrightarrow,-1)}\\\\ &{P_{2,2}^{\\prime\\prime}(n_{1}\\leftrightarrow,-1)=\\delta_{1}(e_{2}\\leftrightarrow,1)}\\\\ &{P_{2,3}^{\\prime\\prime}(n_{1}\\leftrightarrow,-1)=\\delta_{2}(e_{2}\\leftrightarrow,-1),}\\end{array}\n$$", "text_format": "latex", "page_idx": 33}, {"type": "text", "text": "where $\\mu_{T}(\\cdot)=[0,1]$ in both transfer RL problems. It follows that ", "page_idx": 33}, {"type": "equation", "text": "$$\n\\mu_{T}(s_{1})=\\alpha(\\mu_{1}^{2}(s_{1})-\\mu_{1}^{1}(s_{1}))=\\alpha(\\mu_{2}^{2}(s_{1})-\\mu_{2}^{1}(s_{1}))\n$$", "text_format": "latex", "page_idx": 33}, {"type": "text", "text": "and similar results hold for $s_{2}$ , so $\\alpha$ satisfies the definition of the task-relatedness coefficient. It follows that in both settings, $\\alpha_{\\mathrm{max}}=\\alpha$ . The target phase reward functions are defined as ", "page_idx": 33}, {"type": "equation", "text": "$$\n\\begin{array}{l c r}{{r_{1}^{1}(\\cdot,\\cdot)=r_{2}^{1}(\\cdot,\\cdot)=[1,0]\\phi_{1}(\\cdot,\\cdot)}}\\\\ {{r_{1}^{2}(\\cdot,\\cdot)=r_{2}^{2}(\\cdot,\\cdot)=[1,0]\\phi_{2}(\\cdot,\\cdot),}}\\end{array}\n$$", "text_format": "latex", "page_idx": 33}, {"type": "text", "text": "and the initial state distribution is uniform across all states. By construction, in transfer RL problem 1, the only state action pairs that receive reward are $(s_{1},a_{1}),(s_{2},a_{2})$ . In contrast, in transfer RL problem 2, the only state action pairs that receive reward are ${(s_{1},a_{1}),(s_{2},a_{1})}$ . ", "page_idx": 33}, {"type": "text", "text": "The learner is given either transfer RL problem one or two with equal probability with a generative model in the source problem. When interacting with the source MDPs, the learner specifies a state-action pair $(s,a)$ and source MDP $m$ and observes a transition from $P_{1,m}^{i}$ Furthermore, the learner is given the knowledge that the state latent features lie in the function class $\\Phi=\\{\\phi_{1},\\phi_{2}\\}$ and must use the knowledge obtained from interacting with the source MDP to choose one to use in the target MDP, which is no harder than receiving no information about the function class. ", "page_idx": 33}, {"type": "text", "text": "To distinguish between the two transfer RL problems, one needs to differentiate between $P_{1,1}^{1}$ and $P_{1,1}^{2}$ . By construction, the magnitude of the largest entrywise difference between $P_{1,1}^{1}$ and $P_{1,1}^{2}$ is lower bounded by $\\Omega(1/\\alpha^{2})$ . If the learner observes $Z$ transitions in the source MDPs, where $Z\\le{\\cal O}(\\alpha^{2})$ for some constant $C>0$ , then the probability of correctly identifying $\\phi$ is upper bounded by 0.76 [5]. Thus, if the learner does not observe $\\Omega(\\alpha^{2})$ samples in the source phase, then the learner returns the incorrect feature mapping that is orthogonal to the true feature mapping with probability at least 0.24. \u53e3 ", "page_idx": 33}, {"type": "text", "text": "Theorem 12 states that one must incur dependence on $\\alpha$ in the source sample complexity to benefit from transfer learning as using a feature mapping that is orthogonal to the true one results in regret linear in $T$ . ", "page_idx": 33}, {"type": "text", "text": "As the low rank MDP setting is analogous to our $(d,S,A)$ Tucker rank setting, we next present our assumptions in this setting, ", "page_idx": 33}, {"type": "text", "text": "Assumption 9. In each of the $M$ source MDPs, the reward functions have rank $d_{\\cdot}$ , and the transition kernels have Tucker rank $(d,S,A)$ . Let the target MDP\u2019s reward functions have rank $d^{\\prime}$ and transition kernels have Tucker rank $(d^{\\prime},S,A)$ where $d^{\\prime}\\leq d M$ . Thus, there exists $S\\times d$ tensors $U_{m,h}$ , $S\\times d^{\\prime}$ tensors $U_{h}$ , $S A\\times d$ matrices with orthonormal columns $\\phi_{m,h}$ , $S A\\times d^{\\prime}$ matrices with orthonormal columns $\\phi_{h}$ , and $d$ -dimensional vectors $W_{m,h}$ , and $d^{\\prime}$ -dimensional vectors $W_{h}$ such that ", "page_idx": 34}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{P_{m,h}(s^{\\prime}|s,a)=\\sum_{i\\in[d]}\\phi_{m,h}(s,a,i)U_{m,h}(s^{\\prime},i),}\\\\ &{\\quad r_{m,h}(s,a)=\\sum_{i\\in[d]}\\phi_{m,h}(s,a,i)W_{m,h}(i)\\quad}\\end{array}\n$$", "text_format": "latex", "page_idx": 34}, {"type": "text", "text": "and ", "page_idx": 34}, {"type": "equation", "text": "$$\n\\begin{array}{r l r}{\\lefteqn{P_{h}(s^{\\prime}|s,a)=\\sum_{i\\in[d^{\\prime}]}\\phi_{h}(s,a,i)U_{h}(s^{\\prime},i),}}\\\\ &{}&{r_{h}(s,a)=\\sum_{i\\in[d^{\\prime}]}\\phi_{h}(s,a,i)W_{h}(i)\\quad}\\end{array}\n$$", "text_format": "latex", "page_idx": 34}, {"type": "text", "text": "While [4] assume that the target latent representation is a linear combination of the source latent representation, we allow for a more general setting to enable transfer learning. Specifically, we assume that the space spanned by the target latent representations is a subset of the space spanned by the source latent representations. ", "page_idx": 34}, {"type": "text", "text": "Assumption 10. Suppose Assumption 9 holds. For latent factors $\\phi_{h}$ from the target MDP and $\\phi_{m,h}$ for the source MDPs, let $\\phi_{h}=\\{\\phi_{h},\\phi_{h,m}\\}_{m\\in[M]}$ . Then, there exists a non-empty set $B(\\phi_{h})$ such that the elements in $B(\\phi_{h})$ are $B_{h}\\in\\mathbb{R}^{d^{\\prime},d,M}$ such that ", "page_idx": 34}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\phi_{h}(s,i)=\\sum_{j\\in[d],m\\in[M]}B_{h}(i,j,m)\\phi_{m,h}(s,j)}\\end{array}\n$$", "text_format": "latex", "page_idx": 34}, {"type": "text", "text": "for all $i\\in[d^{\\prime}],s\\in S,h\\in[H]$ . ", "page_idx": 34}, {"type": "text", "text": "As in the previous Tucker rank settings, we present the transfer-ability coefficient to quantify the difficulty transfer learning. ", "page_idx": 34}, {"type": "text", "text": "Definition 5. Given a transfer RL problem that satisfies Assumptions 9 and $I O$ . Let $\\Phi$ be the set of all $\\mathbb{R}^{S A\\times d}$ latent factor matrices with orthonormal columns that span the column space of $P_{m,h}$ for all $m\\in[M],h\\in[H]$ . Then, we define $\\alpha$ as ", "page_idx": 34}, {"type": "equation", "text": "$$\n\\alpha:=\\operatorname*{min}_{\\phi\\in\\Phi}\\operatorname*{min}_{B\\in B(\\phi)\\;i\\in[d^{\\prime}],j\\in[d],m\\in[M]}|B(i,j,m)|.\n$$", "text_format": "latex", "page_idx": 34}, {"type": "text", "text": "[4] provide an alternate definition of $\\alpha$ , which also measures the difficulty of transfer RL, and leave determining the optimal dependence on $\\alpha$ as an interesting open question. Similarly to our lower bound in Theorem 1, we prove that one must incur a source sample complexity of $\\Omega(\\alpha^{2})$ to benefit from using transfer learning. Note that in this Tucker rank setting, there is no reward function in the source tasks. ", "page_idx": 34}, {"type": "text", "text": "Theorem 13. There exist two transfer RL instances such that $(i)$ they satisfy Assumptions 9 and 10, (ii) they cannot be distinguished without observing $\\Omega(\\alpha^{2})$ samples in the source phase, and (3) they have target state-action latent features that are orthogonal to each other. ", "page_idx": 34}, {"type": "text", "text": "Proof. Consider the construction where all source and target MDPs $(S,{\\mathcal{A}},P,1,r)$ share the same state space, action space, and horizon with $H=1$ . As the horizon is one, we use the construction used to prove Theorem 7. We consider two transfer RL problems $i,i^{\\prime}$ , in which the source MDPs have similar $Q_{1}^{*}$ , but with orthogonal target $\\phi_{T}$ . For ease of notation, we let $a_{1}$ refer to any action in $[n]$ , and $a_{2}$ refer to any action in $\\{n+1,\\ldots2n\\}$ , respectively. The initial state distribution in the target MDP is uniform over $\\boldsymbol{S}$ . We now present two transfer RL problems with similar $Q$ functions that satisfy Assumptions 5 and 6 but have orthogonal target state latent factors. For ease of notation, the superscript $i$ of $Q_{m,h}^{*,i},Q_{h}^{*,i}$ denotes transfer RL problem. Then, the optimal $Q$ functions (with columns representing $a_{1}$ and $a_{2}$ and the row being any state) for transfer RL problem one are ", "page_idx": 34}, {"type": "text", "text": "", "page_idx": 35}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{Q_{1,1}^{*,1}=W_{1,h}^{1}\\phi_{1,1}^{1}\\left[\\sqrt{n}\\right]\\left[\\sqrt{1/(2n)}}&{\\sqrt{1/(2n)}\\right]=\\left[1/\\sqrt{2}\\quad1/\\sqrt{2}\\right],}\\\\ {Q_{2,1}^{*,1}=W_{2,h}^{1}\\phi_{1,1}^{1}\\left[\\sqrt{n}\\right]\\left[\\sqrt{1/(2n)}\\quad\\sqrt{1/(2n)}\\right]=\\left[1/\\sqrt{2}\\quad1/\\sqrt{2}\\right],}\\\\ {Q_{1}^{*,1}=W_{h}\\phi_{1}^{1}=\\left[\\sqrt{n}\\right]\\left[\\sqrt{1/(2n)}\\quad\\sqrt{1/(2n)}\\right]=\\left[1/\\sqrt{2}\\quad1/\\sqrt{2}\\right]}\\end{array}\n$$", "text_format": "latex", "page_idx": 35}, {"type": "text", "text": "and for transfer RL problem two are ", "page_idx": 35}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{Q_{1,1}^{*,2}=W_{1,h}^{2}\\phi_{1,1}^{2}\\left[\\sqrt{n}\\right]\\left[\\sqrt{1/(2n)}\\quad\\sqrt{1/(2n)}\\right]=\\left[1/\\sqrt{2}\\quad1/\\sqrt{2}\\right],}\\\\ &{Q_{2,1}^{*,2}=W_{2,h}^{2}\\phi_{2,1}^{2}\\left[\\sqrt{n}\\right]G^{\\prime}=\\left[(1+1/\\alpha)/(c\\sqrt{2})\\quad(1-1/\\alpha)/(c\\sqrt{2})\\right],}\\\\ &{Q_{2}^{*,1}=W_{h}\\phi_{1}^{2}=\\left[\\sqrt{n}\\right]\\left[\\sqrt{1/(2n)}\\quad-\\sqrt{1/(2n)}\\right]=\\left[1/\\sqrt{2}\\quad-1/\\sqrt{2}\\right]}\\end{array}\n$$", "text_format": "latex", "page_idx": 35}, {"type": "text", "text": "and $c=\\sqrt{1+1/\\alpha^{2}}$ . Note that $c\\in(1,2d M)$ because $\\alpha\\geq1/(d M)$ from Lemma 1 for $\\alpha>0$ . The incoherence $\\mu$ , rank $d$ , and condition number $\\kappa$ of the above $Q$ functions are $O(1)$ . Furthermore, the above construction satisfies Assumption 9 with Tucker rank $(1,S,A)$ and Assumption 10 because the source and target MDPs share the same feature representation $\\phi_{1}^{1}=\\phi_{1,1}^{1}$ in the first transfer RL problem while in the second transfer RL problem, ", "page_idx": 35}, {"type": "equation", "text": "$$\n\\phi_{1}^{2}=-\\alpha\\phi_{2,1}^{2}+\\alpha\\phi_{2,1}^{2}.\n$$", "text_format": "latex", "page_idx": 35}, {"type": "text", "text": "Note that $\\phi_{1}^{1}$ and $\\phi_{2}^{2}$ are orthogonal to each other by construction. ", "page_idx": 35}, {"type": "text", "text": "The learner is given either transfer RL problem one or two with equal probability with a generative model in the source problem. When interacting with the source MDPs, the learner specifies a stateaction pair $(s,a)$ and source MDP $m$ and observes a realization of a shifted and scaled Bernoulli random variable $X$ . The distribution of $X$ is that $X=1$ with probability $(Q_{m,1}^{*,i}(s,a)+1)/2$ and $X=-1$ with probability $(1-Q_{m,1}^{*,i}(s,a))/2)$ . Furthermore, the learner is given the knowledge that the state latent features lie in the function class $\\Phi=\\{\\phi_{1},\\phi_{2}\\}$ and must use the knowledge obtained from interacting with the source MDP to choose one to use in the target MDP, which is no harder than receiving no information about the function class. ", "page_idx": 35}, {"type": "text", "text": "To distinguish between the two transfer RL problems, one needs to differentiate between $Q_{2,1}^{*,1}$ and $Q_{2,1}^{*,2}$ . By construction, the magnitude of the largest entrywise difference between $Q_{2,1}^{*,1}$ and $Q_{2,1}^{*,2}$ is lower bounded by $\\Omega(1/\\alpha)$ . ", "page_idx": 35}, {"type": "text", "text": "If the learner observes $Z$ samples in the source MDPs, where $Z\\le{\\cal O}(\\alpha^{2})$ for some constant $C>0$ , then the probability of correctly identifying $G$ is upper bounded by 0.76 (Lemma 5.1 with $\\delta=0.24$ [5]). Thus, if the learner does not observe $\\bar{\\Omega}(\\alpha^{2})$ samples in the source phase, then the learner returns the incorrect feature mapping that is orthogonal to the true feature mapping with probability at least 0.24. \u53e3 ", "page_idx": 35}, {"type": "text", "text": "Theorem 13 states that one must incur dependence on $\\alpha$ in the source sample complexity to benefit from transfer learning. With this lower bound, we\u2019ve shown in all three Tucker rank settings that $\\alpha$ determines the effectiveness of transfer learning under our transfer learning assumptions. We now present our algorithm that admits an efficient source sample complexity and target regret bound. ", "page_idx": 35}, {"type": "text", "text": "In contrast to our approaches in the other Tucker rank settings, one learns the latent representation in the source MDPs through the transition kernels. One potential issue arises when all entries of $P(\\cdot|\\cdot,a)$ are small; for example, each entry of the uniform transition kernel is $1/S$ , which is not lower bounded by a constant. Thus, we let $\\begin{array}{r}{D=\\operatorname*{min}_{m\\in[M],h\\in[H],a\\in\\mathcal{A}}\\|P_{m,h}(\\cdot|\\cdot,a)\\|_{\\infty}}\\end{array}$ , and the dependence on $D$ is unsurprising as one needs to ensure the noise is sufficiently small to learn the latent representations from $P_{m,h}$ . We now present and prove the main result in this Tucker rank setting. ", "page_idx": 35}, {"type": "text", "text": "Algorithm 6 Source Phase ", "text_level": 1, "page_idx": 36}, {"type": "text", "text": "Input: $N$ ", "text_level": 1, "page_idx": 36}, {"type": "text", "text": "1: for $(s,a)\\in\\mathcal{S}\\times\\mathcal{A},h\\in[H],m\\in[M]$ do   \n2: Collect $N$ transitions from source MDP $m$ at time step $h$ at state-action pair $(s,a)$ .   \n3: Use the samples to estimate the transition kernel with ", "page_idx": 36}, {"type": "equation", "text": "$$\n\\hat{P}_{m,h}(s^{\\prime}|s,a)=\\frac{1}{N}\\sum_{i\\in[N]}\\mathbf{1}_{X_{i,s,a}=s^{\\prime}},\n$$", "text_format": "latex", "page_idx": 36}, {"type": "text", "text": "where $X_{i,s,a}\\sim P_{m,h}(\\cdot|s,a)$ . ", "page_idx": 36}, {"type": "text", "text": "4: Compute the feature mapping $\\hat{\\phi}=\\{\\hat{\\phi}_{h}\\}_{h\\in[H]}$ with ", "page_idx": 36}, {"type": "equation", "text": "$$\n\\hat{\\phi}_{h}=\\left\\{\\frac{\\sqrt{S}}{d\\mu}\\hat{F}_{m,h}(:,i)\\hat{G}_{n,h}(:,j)|i,j\\in[d],m,n\\in[M]\\right\\}.\n$$", "text_format": "latex", "page_idx": 36}, {"type": "text", "text": "Algorithm 7 Target Phase: LSVI-UCB ", "text_level": 1, "page_idx": 36}, {"type": "text", "text": "Input: $\\lambda,\\beta_{k,h},\\hat{\\phi}$ 1: Run LSVI-UCB with $\\lambda,\\beta_{k,h}$ , and $\\hat{\\phi}$ . ", "page_idx": 36}, {"type": "text", "text": "Theorem 14. Suppose Assumptions $5,\\,6,$ , and $^3$ hold in the $(d,S,A)$ Tucker Rank setting, and set $\\delta\\ \\in\\ (0,1)$ . Furthermore, assume that for any $\\epsilon\\,\\,\\in\\,(0,\\sqrt{H/T})$ , $P_{m,h}(\\cdot|\\cdot,a)$ has rank $d$ and is $\\mu$ -incoherent with condition number $\\kappa$ for all $a\\in A$ . Let $\\begin{array}{r}{D=\\operatorname*{min}_{m\\in[M],h\\in[H],a\\in\\mathcal{A}}\\|P_{m,h}(\\cdot|\\cdot,a)\\|_{\\infty}}\\end{array}$ Then, for $T\\geq H/\\alpha^{2}$ , using at most ", "page_idx": 36}, {"type": "equation", "text": "$$\n\\tilde{\\cal O}\\left(\\frac{\\alpha^{2}d\\mu^{2}\\kappa^{2}M^{2}T S A}{{\\cal D}^{2}}\\right),\n$$", "text_format": "latex", "page_idx": 36}, {"type": "text", "text": "samples in the source problems, our algorithm has regret at most ", "page_idx": 36}, {"type": "equation", "text": "$$\n\\tilde{O}\\left(\\sqrt{(d M H)^{3}T}\\right)\n$$", "text_format": "latex", "page_idx": 36}, {"type": "text", "text": "with probability at least $1-\\delta$ for $\\lambda=1$ and $\\beta_{h,k}$ , which is a function of $d,H,T,M$ . ", "page_idx": 36}, {"type": "text", "text": "Proof. Suppose the setting of Theorem 14 holds. Recall that we let $\\begin{array}{r l}{D}&{{}=}\\end{array}$ $\\mathrm{min}_{m\\in[M],h\\in[H],a\\in\\cal A}\\:||P_{m,h}(\\bar{\\cdot}|\\cdot,a)||_{\\infty}$ . Then, observing $N$ transitions from each state-action pairs ensures that for each $(s^{\\prime},s,a)\\in\\mathcal{S}\\times\\mathcal{S}\\times A$ and for each source MDP at each time step, ", "page_idx": 36}, {"type": "equation", "text": "$$\n|P_{m,h}(s^{\\prime}|s,a)-\\hat{P}_{m,h}(s^{\\prime}|s,a)|\\leq\\frac{\\sqrt{H}}{\\alpha\\mu\\kappa D\\sqrt{d M T}}\n$$", "text_format": "latex", "page_idx": 36}, {"type": "text", "text": "with probability at least $1\\,-\\,\\delta/(2S^{2}A M H)$ where $\\begin{array}{r}{\\hat{P}_{m,h}(s^{\\prime}|s,a)\\;=\\;\\frac{1}{N}\\sum_{i\\in[N]}\\mathbf{1}_{X_{i}(s,a)=s^{\\prime}}}\\end{array}$ and $X_{i}\\sim P(\\cdot|s,a)$ for ", "page_idx": 36}, {"type": "equation", "text": "$$\nN=\\frac{\\alpha^{2}d\\mu^{2}\\kappa^{2}M T\\log(4S^{2}A M H/\\delta)}{2H D^{2}}.\n$$", "text_format": "latex", "page_idx": 36}, {"type": "text", "text": "Let $\\hat{P}_{m,h}(\\cdot|\\cdot,a)=\\hat{F}_{m,h}^{a}\\hat{\\Sigma}_{m,h}\\hat{G}_{m,h}{\\top}$ be the singular value decomposition of our estimate where $\\hat{F}$ corresponds to the state one transitions from. Since $T\\geq\\alpha^{2}/H$ , it follows that $\\bar{\\gamma}\\leq1/2$ . Thus, 3 states that there exists rotation matrices $R_{m,h,a}$ such that ", "page_idx": 36}, {"type": "equation", "text": "$$\n\\|(\\hat{F}_{m,h}^{a}R_{m,h,a}-F_{m,h}^{a})(s)\\|_{2}\\leq\\frac{d\\sqrt{H\\mu}}{\\alpha\\sqrt{M T S}},\n$$", "text_format": "latex", "page_idx": 36}, {"type": "text", "text": "for all $s\\ \\in\\ S$ where the the true transition kernel $P_{m,h}(\\cdot|\\cdot,a)$ has singular value decomposition $P_{m,h}(\\cdot|\\cdot,a)=F_{m,h}^{a}\\Sigma_{m,h}G_{m,h}^{\\top}$ ea ncda .n the more common Low rank MDP $\\phi_{m,h}(s,a)=F_{m,h}^{a}(s)$ $\\mu_{m,h}(s^{\\prime})=\\Sigma_{m,h}G_{m,h}^{\\top}$ ", "page_idx": 36}, {"type": "text", "text": "Let $\\tilde{F}$ be the $S A\\times d M$ matrix from joining all the source state latent factor matrices from $P(\\cdot|\\cdot,a)$ for each $a\\in A$ , and $\\hat{\\tilde{F}}_{h}$ be the $S A\\times d M$ matrix from joining all $\\bar{F}_{m,h}$ . Let $R_{h}$ be the $d\\times d M$ matrix that joins $R_{m,h}$ for all $m\\in[M]$ . Then, from Assumption 6 and Definition 4, it follows that for all $(s^{\\prime},s,a)\\in\\mathcal{S}\\times\\mathcal{S}\\times A$ , that ", "page_idx": 37}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{r_{h}(s,a)=\\displaystyle\\sum_{i\\in[d]}F_{h}^{a}(s,i)W_{h}(i)}\\\\ &{\\qquad=\\displaystyle\\sum_{i\\in[d]}\\left(\\sum_{j\\in[d],m\\in[M]}B(i,j,m)F_{h,m}^{a}(s,j)\\right)W_{h}(i)}\\\\ &{\\qquad=\\displaystyle\\sum_{i,j\\in[d],m\\in[M]}B(i,j,m)F_{m,h}^{a}(s,j)W_{h}(i)}\\\\ &{\\qquad=\\displaystyle\\tilde{F}_{h}^{a}(s)W_{h}^{'}\\Gamma}\\end{array}\n$$", "text_format": "latex", "page_idx": 37}, {"type": "text", "text": "and $P(s^{\\prime}|s,a)\\ =\\ \\tilde{F}_{h}^{a}(s)U_{h}^{\\prime}(s^{\\prime})^{\\top}$ (with the same argument) for some $d M$ -dimension vector $W_{h}^{\\prime}$ , $U_{h}^{\\prime}(s^{\\prime})$ . Note that $W_{h}^{\\prime}$ and $\\dot{U}_{h}^{\\prime}(s^{\\prime})$ are vectors that join $W_{m,h}$ and $U_{m,h}(s^{\\prime})$ , respectively, with entries that at most $\\alpha$ times larger than the original entry. ", "page_idx": 37}, {"type": "text", "text": "Therefore, it follows for all $(s^{\\prime},s,a,h)\\in\\mathcal{S}\\times\\mathcal{S}\\times\\mathcal{A}\\times[H],$ ", "page_idx": 37}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{\\left.r_{h}(s,a)-\\hat{F}_{h}^{\\alpha}(s)R_{h}W_{h}^{\\prime\\top}\\right|=\\left|\\bar{F}_{h}^{\\alpha}(s)W_{h}^{\\prime\\top}-\\hat{F}_{h}^{\\alpha}(s)R_{h}W_{h}^{\\prime\\top}\\right|}\\\\ &{=\\vert(\\bar{F}_{h}^{\\alpha}(s)-\\bar{F}_{h}^{\\alpha}(s)R_{h})W_{h}^{\\prime\\top}\\vert}\\\\ &{\\le\\alpha\\vert\\displaystyle\\sum_{m\\in M}(F_{m,h}^{\\alpha}(s)-\\hat{F}_{m,h}^{\\alpha}(s)R_{m,h})W_{m,h}\\vert}\\\\ &{\\le\\alpha\\displaystyle\\sum_{m\\in M}\\vert F_{m,h}^{\\alpha}(s)-\\hat{F}_{m,h}^{\\alpha}(s)R_{m,h}\\vert\\vert_{2}\\vert\\vert W_{m,h}\\vert\\vert_{2}}\\\\ &{\\le\\alpha\\sqrt{\\displaystyle\\frac{S}{d\\mu}}\\displaystyle\\sum_{m\\in M}\\vert\\vert F_{m,h}^{\\alpha}(s)-\\hat{F}_{m,h}^{\\alpha}(s)R_{m,h}\\vert\\vert_{2}}\\\\ &{\\le\\displaystyle\\sqrt{\\frac{d H M}{T}}}\\\\ &{\\le\\sqrt{\\displaystyle\\frac{d H M}{T}}}\\end{array}\n$$", "text_format": "latex", "page_idx": 37}, {"type": "text", "text": "from the Cauchy-Schwarz inequality and our singular vector perturbation bound. From the same logic, ", "page_idx": 37}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{\\lefteqn{\\sum_{s^{\\prime}\\in S}(P_{h}(s^{\\prime}|s,a)-\\hat{\\tilde{P}}_{h}^{a}(s)R_{h}U_{h}^{\\prime}(s^{\\prime})^{\\top}\\bigg|\\leq\\big|\\displaystyle{\\sum_{s^{\\prime}\\in S}P_{h}(s^{\\prime}|s,a)-\\hat{\\tilde{F}}_{h}^{a}(s)R_{h}U_{h}^{\\prime}(s^{\\prime})^{\\top}}\\big|}}\\\\ &{=\\prod_{s^{\\prime}\\in S}\\tilde{F}_{h}^{a}(s)U_{h}^{\\prime}(s^{\\prime})-\\hat{\\tilde{F}}_{h}^{a}(s)R_{h}U_{h}^{\\prime}(s^{\\prime})^{\\top}\\big|}\\\\ &{\\leq\\alpha\\big|\\displaystyle{\\sum_{m\\in M}(F_{m,h}^{a}(s)-\\hat{F}_{m,h}^{a}(s)R_{m,h})\\sum_{s^{\\prime}\\in S}U_{m,h}(s^{\\prime})}\\big|}\\\\ &{\\leq\\alpha\\displaystyle{\\sum_{m\\in M}\\|F_{m,h}^{a}(s)-\\hat{F}_{m,h}^{a}(s)R_{m,h}\\|_{2}}\\big|\\sum_{s^{\\prime}\\in S}U_{m,h}(s^{\\prime})^{\\top}\\big|_{2}}\\\\ &{\\leq\\sqrt{\\frac{d H M}{T}}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 37}, {"type": "text", "text": "Therefore, $\\hat{\\tilde{F}}_{h}^{a}(s)$ satisfies Assumption B in [17] with $\\begin{array}{r}{\\xi=\\sqrt{\\frac{d M H}{T}}}\\end{array}$ dMTH 5. Then it follows that running LSVI-UCB using $\\hat{\\tilde{F}}_{h}^{a}(s)$ with $\\delta^{\\prime}=\\delta/2$ during the target phase of the algorithm admits a regret bound ", "page_idx": 37}, {"type": "equation", "text": "$$\nR e g r e t(T)\\leq C^{\\circ}(\\sqrt{d^{3}M^{3}H^{3}T}+d M H\\sqrt{\\frac{d M H}{T}})\\in\\tilde{O}(\\sqrt{d^{3}M^{3}H^{3}T})\n$$", "text_format": "latex", "page_idx": 38}, {"type": "text", "text": "with probability at least $1-\\delta$ from a final union bound. Furthermore, the sample complexity in the source phase is ", "page_idx": 38}, {"type": "equation", "text": "$$\n\\tilde{\\cal O}\\left(\\frac{\\alpha^{2}d\\mu^{2}\\kappa^{2}M^{2}T S A}{{\\cal D}^{2}}\\right),\n$$", "text_format": "latex", "page_idx": 38}, {"type": "text", "text": "which proves our result. ", "page_idx": 38}, {"type": "text", "text": "H $(d,d,d)$ Tucker Rank Setting ", "text_level": 1, "page_idx": 38}, {"type": "text", "text": "In this section, we present the assumptions, algorithm, and proof for Theorem 15. In the $(d,d,d)$ Tucker rank setting, we assume the following low-rank structure on the MDPs. ", "page_idx": 38}, {"type": "text", "text": "Assumption 11. In each of the $M$ source $M D P s$ , the reward functions have rank $d,$ and the transition kernels have Tucker rank $(d,d,d)$ . The target $M D P\\,`$ reward functions have rank $d^{\\prime}$ and transition kernels have Tucker rank $(d,d^{\\prime},d^{\\prime})$ where $d^{\\prime}\\leq d M$ . Thus, there exists $d\\times d\\times d$ tensors $U_{m,h}$ , $d\\times d^{\\prime}\\times d^{\\prime}$ tensors $U_{h}$ , $S\\times d$ matrices $V_{m,h}$ , $S\\times d^{\\prime}$ matrices $V_{h}$ , $S\\times d$ matrices $F_{m,h}$ , $S\\times d^{\\prime}$ matrices $F_{h}$ , $A\\times d$ matrices $G_{m,h}.$ ,, and $A\\times d^{\\prime}$ matrices $G_{h}$ all with orthonormal columns, and sequences of non-increasing singular values $\\{\\sigma_{m,h}(i)\\geq\\mathbb{R}_{+}\\}_{i\\in[d]},\\{\\sigma_{h}(i)\\geq\\mathbb{R}_{+}\\}_{i\\in[d^{\\prime}]}$ such that ", "page_idx": 38}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{P_{m,h}(s^{\\prime}|s,a)=\\sum_{i\\in[d],j\\in[d^{\\prime}],k\\in[d]}U_{m,h}(i,j,k)V_{m,h}(s^{\\prime},i)F_{m,h}(s,j)G_{m,h}(a,k),}\\\\ &{\\quad r_{m,h}(s,a)=\\sum_{i\\in[d]}\\sigma_{m,h}(i)F_{m,h}(s,i)G_{m,h}(a,i)}\\end{array}\n$$", "text_format": "latex", "page_idx": 38}, {"type": "text", "text": "and ", "page_idx": 38}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{P_{h}(s^{\\prime}|s,a)=\\sum_{i\\in[d],j\\in[d^{\\prime}],k\\in[d^{\\prime}]}U_{h}(i,j,k)V_{h}(s^{\\prime},i)F_{h}(s,j)G_{h}(a,k),}\\\\ &{\\quad r_{h}(s,a)=\\sum_{i\\in[d^{\\prime}]}\\sigma_{h}(i)F_{h}(s,i)G_{h}(a,i)}\\end{array}\n$$", "text_format": "latex", "page_idx": 38}, {"type": "text", "text": "where ", "page_idx": 38}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\|\\sum_{i\\in[d],s^{\\prime}\\in S}g(s^{\\prime})U_{m,h}(i,:,:)V_{m,h}(s^{\\prime},i)\\|_{F},\\|\\sum_{s^{\\prime}\\in S,i\\in[d]}g(s^{\\prime})U_{h}(i,:,:)V_{m,h}(s^{\\prime},i)\\|_{F},}\\end{array}\n$$", "text_format": "latex", "page_idx": 38}, {"type": "text", "text": "$\\begin{array}{r l r}{\\lefteqn{)V_{h}(s^{\\prime},i)\\|_{F},\\sigma_{m,h}(i),\\sigma_{h}(i)}}&{\\leq}&{\\frac{\\sqrt{S A}}{d\\mu}}\\end{array}$ for all $s\\ \\in\\ S$ , a \u2208 A, $\\begin{array}{r l r}{h}&{{}\\in}&{[H],}\\end{array}$ , $m~\\in~[M]$ , and $i\\in[d]$ for any function $g:S\\rightarrow[0,1]$ . ", "page_idx": 38}, {"type": "text", "text": "To allow transfer learning to occur, we assume that the latent factors from the source MDPs span the space spanned by the target latent factors. ", "page_idx": 38}, {"type": "text", "text": "Assumption 12. For latent factors $F_{h}$ from the target MDP and $F_{m,h}$ for the source $M D P s$ , let $F=\\{F_{h},F_{h,m}\\}_{h\\in[H],m\\in[M]}$ . For latent factors $G_{h}$ from the target $M D P$ and $G_{m,h}$ for the source $M D P s$ , let $G=\\{G_{h},G_{h,m}\\}_{h\\in[H],m\\in[M]}$ . Then, there exists a non-empty set $B(F),{\\mathcal{C}}(G)$ such that the elements in $B(F)$ are $B\\in\\mathbb{R}^{d^{\\prime},d,M}$ and the elements in ${\\mathcal{C}}(G)$ are $C\\in\\mathbb{R}^{d^{\\prime},d,M}$ such that ", "page_idx": 38}, {"type": "equation", "text": "$$\n\\begin{array}{r}{F_{h}(s,i)=\\sum_{j\\in[d],m\\in[M]}B(i,j,m)F_{m,h}(s,j)}\\end{array}\n$$", "text_format": "latex", "page_idx": 38}, {"type": "text", "text": "and ", "page_idx": 38}, {"type": "equation", "text": "$$\n\\begin{array}{r}{G_{h}(a,i)=\\sum_{j\\in[d],m\\in[M]}C(i,j,m)G_{m,h}(a,j)}\\end{array}\n$$", "text_format": "latex", "page_idx": 38}, {"type": "text", "text": "for all $i\\in[d^{\\prime}],s\\in{\\mathcal{S}},a\\in{\\mathcal{A}}$ . ", "page_idx": 38}, {"type": "text", "text": "Similarly to the $(S,d,A)$ and $(S,S,d)$ Tucker rank settings, we introduce the transfer-ability coefficient that measures the difficulty of applying transfer learning. ", "page_idx": 38}, {"type": "text", "text": "Definition 6 (Transfer-ability Coefficient). Given a transfer RL problem that satisfies Assumptions $_{l l}$ , $^{12}$ , and $^3$ , let $\\mathcal{F}$ be the set of all $\\mathbb{R}^{S\\times d}$ latent factor matrices with orthonormal columns that span the column space of $Q_{m,h}^{*}$ for all $m\\in[M],h\\in[H]$ . Let $\\mathcal{G}$ be the set of all $\\mathbb{R}^{A\\times d}$ latent factor matrices with orthonormal columns that span the row space of $Q_{m,h}^{*}$ for all $m\\in[M],h\\in[H]$ . Then, we define \u03b1 as ", "page_idx": 38}, {"type": "equation", "text": "$$\n\\tau:=\\operatorname*{max}\\left(\\operatorname*{min}_{F\\in\\mathcal{F}}\\operatorname*{min}_{B\\in B(F)}\\operatorname*{max}_{i\\in[d^{\\prime}],j\\in[d],m\\in[M]}|B(i,j,m)|,\\operatorname*{min}_{G\\in\\mathcal{G}}\\operatorname*{min}_{C\\in\\mathcal{C}(F)}\\operatorname*{max}_{i\\in[d^{\\prime}],j\\in[d],m\\in[M]}|C(i,j,m)|\\right).\n$$", "text_format": "latex", "page_idx": 38}, {"type": "text", "text": "In contrast to the definition in the other Tucker rank settings, $\\alpha$ bounds the largest coefficient used in the linear combination of $F_{h}$ and $G_{h}$ . The algorithm that we use in this setting runs LR-EVI on each of the source MDPs, constructs a feature mapping $\\hat{\\phi}$ using the singular vectors from the singular value decomposition of $\\bar{Q}_{m,h}$ , and runs LSVI-UCB with $\\hat{\\phi}$ . Since we use both sets of singular vectors to construct $\\hat{\\phi}$ , our feature mapping has latent dimension $d^{2}M^{2}$ . ", "page_idx": 39}, {"type": "text", "text": "Algorithm 8 Source Phase ", "text_level": 1, "page_idx": 39}, {"type": "text", "text": "1: for $m\\in[M]$ do   \n2: Run LR-EVI $(\\{N_{h}\\}_{h\\in[H]})$ on source MDP $m$ to obtain $\\bar{Q}_{m,h}$ .   \n3: Compute the singular value decomposition of $\\bar{Q}_{m,h}=\\hat{F}_{m,h}\\hat{\\Sigma}_{m,h}\\hat{G}_{m,h}^{\\top}$ ", "page_idx": 39}, {"type": "text", "text": "4: Compute the feature mapping $\\hat{\\phi}=\\{\\hat{\\phi}_{h}\\}_{h\\in[H]}$ with ", "page_idx": 39}, {"type": "equation", "text": "$$\n\\hat{\\phi}_{h}=\\left\\{\\frac{\\sqrt{S A}}{d\\mu}\\hat{F}_{m,h}(:,i)\\hat{G}_{n,h}(:,j)|i,j\\in[d],m,n\\in[M]\\right\\}.\n$$", "text_format": "latex", "page_idx": 39}, {"type": "text", "text": "Algorithm 9 Target Phase: LSVI-UCB ", "text_level": 1, "page_idx": 39}, {"type": "text", "text": "Input: $\\lambda,\\beta_{k,h},\\hat{\\phi}$ 1: Run LSVI-UCB with $\\lambda,\\beta_{k,h}$ , and $\\hat{\\phi}$ . ", "page_idx": 39}, {"type": "text", "text": "The above algorithm admits the following result. ", "page_idx": 39}, {"type": "text", "text": "Theorem 15. Suppose Assumptions 11, $^{12}$ , and $^3$ hold in the $(d,d,d)$ Tucker Rank setting, and set $\\delta\\in(0,1)$ . Furthermore, assume that for any $\\epsilon\\,\\in\\,(0,\\sqrt{H/T})$ , $Q_{m,h}=r_{m,h}+P_{m,h}V_{m,h+1}$ has rank d and is $\\mu$ -incoherent with condition number $\\kappa$ for all $\\epsilon$ -optimal value functions $V_{h+1}$ . Then, assuming $T\\geq H/\\alpha^{2}$ , using at most ", "page_idx": 39}, {"type": "equation", "text": "$$\n\\tilde{O}\\left(d^{10}\\mu^{5}\\kappa^{4}(S+A)M^{2}H^{4}\\alpha^{4}T\\right)\n$$", "text_format": "latex", "page_idx": 39}, {"type": "text", "text": "samples in the source problems, our algorithm has regret at most ", "page_idx": 39}, {"type": "equation", "text": "$$\n\\tilde{O}\\left(\\sqrt{d^{6}M^{6}H^{3}T}\\right)\n$$", "text_format": "latex", "page_idx": 39}, {"type": "text", "text": "with probability at least $1-\\delta$ for $\\lambda=1$ and $\\beta_{h,k}$ , which is a function of $d,H,T,M$ . ", "page_idx": 39}, {"type": "text", "text": "We now prove Theorem 15 using a similar argument to the one used in the proof of Theorem 10 except we show that the target MDP with our feature mapping satisfies Assumption $\\mathbf{B}$ in [17] and apply LSVI-UCB. ", "page_idx": 39}, {"type": "text", "text": "Proof. Suppose the assumptions stated in Theorem 15 hold. Then, from Theorem 9[30], it follows that LR-EVI returns near-optimal $Q$ functions $\\bar{Q}_{m,h}$ functions with singular value decomposition $\\bar{Q}_{m,h}=\\hat{F}_{m,h}\\hat{\\Sigma}_{m,h}\\hat{G}_{m,h}$ that are $\\sqrt{H}/(\\kappa\\alpha^{2}M d^{4}\\mu\\sqrt{T})$ -optimal with probability at least $1-\\delta/2$ using ", "page_idx": 39}, {"type": "equation", "text": "$$\n\\tilde{O}\\left(d^{10}\\mu^{5}\\kappa^{4}(S+A)M H^{4}\\alpha^{4}T\\right)\n$$", "text_format": "latex", "page_idx": 39}, {"type": "text", "text": "samples on each source MDP. Since $T\\geq H/\\alpha^{4}$ , from $\\bar{\\gamma}\\leq\\frac12$ in Proposition 2. Thus, 3 states that there exists rotation matrices $R_{m,h,f},R_{m,h,g}$ such that ", "page_idx": 39}, {"type": "equation", "text": "$$\n(\\hat{F}_{m,h}R_{m,h,f}-F_{m,h})(s)\\|_{2}\\le\\frac{\\sqrt{H}}{\\alpha^{4}M d^{2}\\sqrt{T S\\mu}},\\quad\\|(\\hat{G}_{m,h}R_{m,h,g}-G_{m,h})(s)\\|_{2}\\le\\frac{\\sqrt{H}}{\\alpha^{4}M d^{2}\\sqrt{T A\\mu}}.\n$$", "text_format": "latex", "page_idx": 39}, {"type": "text", "text": "for all $s\\ \\in\\ S$ where the optimal $Q$ function have singular value decomposition $Q_{m,h}^{*}\\;=\\;$ $F_{m,h}\\Sigma_{m,h}G_{m,h}^{\\top}$ . ", "page_idx": 39}, {"type": "text", "text": "Then, from Assumption 6 and Definition 4, it follows that for all $(s^{\\prime},s,a)\\in\\mathcal{S}\\times\\mathcal{S}\\times\\mathcal{A}$ , that ", "page_idx": 40}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{r_{h}(s,a)=\\displaystyle\\sum_{i\\in[d]}\\sigma_{h}(i)F_{h}(s,i)G_{h}(a,i)}\\\\ &{\\qquad=\\displaystyle\\sum_{i\\in[d]}\\sigma_{h}(i)\\left(\\sum_{j\\in[d],m\\in[M]}B(i,j,m)F_{h,m}(s,j)\\right)\\left(\\sum_{l\\in[d],n\\in[M]}C(i,l,n)G_{h,n}(s,l)\\right)}\\\\ &{\\qquad=\\displaystyle\\sum_{j,l\\in[d],m,n\\in[M]}F_{m,h}(s,j)G_{n,h}(a,l)\\left(\\sum_{i\\in[d]}\\sigma_{h}(i)B(i,j,m)C(i,l,n)\\right)}\\\\ &{\\qquad=\\displaystyle\\theta_{h}\\phi(s,a)_{h}^{\\top}}\\end{array}\n$$", "text_format": "latex", "page_idx": 40}, {"type": "text", "text": "where $\\theta_{h}$ = $\\begin{array}{r}{\\{\\sum_{i\\in[d]}\\sigma_{h}(i)B(i,j,m)C(i,l,n)\\}_{j,l\\in[d],m,n\\in[M]}}\\end{array}$ and $\\phi_{h}\\qquad\\qquad=$ $\\{F_{m,h}(s,j)G_{n,h}(a,l)\\}_{j,l\\in[d],m,n\\in[M]}$ and $P(s^{\\prime}|\\cdot,\\cdot)\\;\\;=\\;\\;\\mu_{h}(s^{\\prime})\\phi_{h}^{\\top}$ (with the same argument) fo $\\begin{array}{r}{\\cdot\\mu_{h}(s^{\\prime})=\\{\\sum_{i,j,k\\in[d]}U_{h}(i,j,k)V_{h}(s^{\\prime},i)B(j,l,m)C(k,x,n)\\}_{l,x\\in[d],m,n\\in[M]}.}\\end{array}$ It follows that we can express $r_{h}=\\tilde{F}_{h}\\tilde{\\Sigma}_{h}\\tilde{G}_{h}^{\\top}$ where $\\tilde{F}_{h}$ be the $S\\times d^{2}M^{2}$ matrix from joining all $F_{m,h}$ dM times, $\\tilde{G}_{h}$ be the $A\\times d^{2}M^{2}$ matrix from joining all $G_{m,h}\\,d M$ times, and ${\\tilde{\\Sigma}}_{h}$ is the diagonal matrix with entries $\\theta_{h}(j,l,m,n)$ for all $j,l\\in[d],m,n\\in[M]$ . Note that the entries of ${\\tilde{\\Sigma}}_{h}$ and $\\mu_{h}$ are at most $d\\alpha^{2}$ larger than their original value. ", "page_idx": 40}, {"type": "text", "text": "Let $\\hat{\\tilde{F}}_{h}$ be the $S\\times d^{2}M^{2}$ matrix from joining all $\\bar{F}_{m,h}R_{m,h,f}\\;d M$ times, and $\\hat{\\tilde{G}}_{h}$ be the $A\\times d^{2}M^{2}$ matrix from joining all $\\bar{G}_{m,h}R_{m,h,g}\\;d M$ times. Let $\\tilde{\\theta}_{h}$ satisfy ", "page_idx": 40}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\tilde{\\theta}_{h}\\hat{\\phi}_{h}^{\\top}=\\hat{\\tilde{F}}_{h}\\tilde{\\Sigma}_{h}\\hat{\\tilde{G}}_{h}^{\\top}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 40}, {"type": "text", "text": "Therefore, it follows for all $(s^{\\prime},s,a,h)\\in\\mathcal{S}\\times\\mathcal{S}\\times\\mathcal{A}\\times[H]$ , ", "page_idx": 40}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{r_{h}(s,a)-\\bar{\\theta}_{h}\\dot{\\tilde{\\phi}}_{h}^{\\top}(s,a)=|\\tilde{l}_{h}\\dot{\\tilde{\\Sigma}}_{h}\\hat{G}_{h}^{\\top}(s,a)-\\ \\hat{F}_{h}\\dot{\\tilde{\\Sigma}}_{h}\\hat{G}_{h}^{\\top}(s,a)|}&{}\\\\ &{\\leq|\\tilde{l}_{h}\\dot{\\tilde{\\Sigma}}_{h}\\hat{G}_{h}^{\\top}(s,a)-\\ \\hat{F}_{h}\\dot{\\tilde{\\Sigma}}_{h}\\hat{G}_{h}^{\\top}(s,a)|+|\\hat{F}_{h}\\dot{\\tilde{\\Sigma}}_{h}\\hat{G}_{h}^{\\top}(s,a)-\\ \\hat{F}_{h}\\dot{\\tilde{\\Sigma}}_{h}\\hat{G}_{h}^{\\top}(s,a)|}\\\\ &{\\leq d M\\sum_{\\ s=1}^{N}M\\{F_{m,h}(s)-\\bar{F}_{m,h}(s)R_{m,h},f\\}|\\hat{\\Sigma}_{h}|_{\\{\\phi\\}}\\operatorname*{max}_{m,\\tilde{M}}\\sqrt{d}|G_{m,h}|\\mathrm{d}_{\\infty}}\\\\ &{\\quad+\\sqrt{d}\\operatorname*{max}_{m\\in\\bar{M}}|\\tilde{l}_{m,h}||_{s=1}\\!\\left\\{\\bar{\\Sigma}_{h}||_{\\phi_{h}}|(s)-\\hat{G}_{h,h}(s)R_{m,h}||_{s}\\right\\}\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!}\\\\ &{\\leq\\tilde{a}^{3/2}M\\sum_{s=1}^{N}{\\|F_{m,h}(s)-\\bar{F}_{m,h}(s)R_{m,h}(s)-\\hat{F}_{1}\\|_{\\tilde{\\Sigma}}}\\mathrm{I}|\\hat{\\Sigma}_{h}\\operatorname*{I}_{\\frac{\\mathrm{max}}{\\sqrt{\\tilde{S}}}}\\mathrm{I}|G_{m,h}|\\mathrm{d}_{\\infty}}\\\\ &{\\quad+\\operatorname*{max}_{m\\in\\bar{M}}\\left(\\lVert F_{m,h}\\mathbf{l}+\\rVert F_{m,h}R-\\hat{F}_{m,h}\\rVert_{s}\\right)\\!\\!\\left\\{\\hat{\\Sigma}_{h}\\right\\}|_{\\phi_{h}}|(s)-\\hat{G}_{m,h}(s)R_{m,h,\\phi}}\\\\ &{\\leq C\\tilde{a}^{3/2}M\\sqrt{\\frac{S}{\\tilde{\\Sigma \n$$", "text_format": "latex", "page_idx": 40}, {"type": "text", "text": "where the second inequality comes from the triangle inequality and Cauchy-Schwarz inequality, the third inequality comes from the triangle inequality, and the fourth inequality comes from the definition of incoherence, our bound on the entries of $\\tilde{\\Sigma}$ and the left term dominating the right term, and the final inequality is due to our singular vector perturbation bounds. Similarly, ", "page_idx": 40}, {"type": "equation", "text": "$$\n\\|P_{h}(\\cdot|s,a)-\\mu_{h}\\widetilde{(s^{\\prime})}\\hat{\\phi}_{h}(s,a)^{\\top}\\|_{T V}\\leq C\\frac{d M\\sqrt{H}}{\\sqrt{T}}\n$$", "text_format": "latex", "page_idx": 40}, {"type": "text", "text": "for some absolute constant $C>0$ where $\\mu_{h}\\widetilde{\\left(s^{\\prime}\\right)}$ satisfies $\\hat{\\tilde{F}}_{h}\\tilde{\\Sigma}_{h}(s^{\\prime})\\hat{\\tilde{G}}_{h}^{\\top}$ and $\\tilde{\\Sigma}_{h}(s^{\\prime})$ is the $d^{2}M^{2}\\times$ $d^{2}M^{2}$ diagonal matrix with entries $\\mu_{h}(s^{\\prime},l,k,m,n)$ with the same argument using the regularity condition on $\\mu_{h}$ . ", "page_idx": 40}, {"type": "text", "text": "Therefore, $\\hat{\\phi}$ satisfies Assumption $\\mathbf{B}$ in [17] with $\\xi=O(d M\\sqrt{H/T})$ . Running LSVI-UCB with $\\hat{\\phi}$ admits a regret bound of ", "page_idx": 41}, {"type": "equation", "text": "$$\nR e g r e t(T)\\leq C\\left(\\sqrt{d^{6}M^{6}H^{3}T\\iota^{2}}+\\frac{d^{3}M^{3}H^{3/2}T\\sqrt{\\iota}}{\\sqrt{T}}\\right)\\in\\tilde{O}\\left(d^{6}M^{6}H^{3}T\\right)\n$$", "text_format": "latex", "page_idx": 41}, {"type": "text", "text": "for some absolute constant $C>0$ with probability at least $1-\\delta$ from a final union bound. The sample complexity in the source phase is ", "page_idx": 41}, {"type": "equation", "text": "$$\n\\tilde{O}\\left(d^{10}\\mu^{5}\\kappa^{4}(S+A)M H^{4}\\alpha^{4}T\\right).\n$$", "text_format": "latex", "page_idx": 41}, {"type": "text", "text": "which completes the proof. ", "page_idx": 41}, {"type": "text", "text": "I $\\ell_{\\infty}$ eigen perturbation bound with non-uniform noise: rank- $r$ case ", "text_level": 1, "page_idx": 41}, {"type": "text", "text": "Suppose $A=A^{*}+D\\in\\mathbb{R}^{m\\times n}$ , where $A^{*}$ is the true rank- $^r$ matrix and $D$ is the noise matrix. Suppose $A^{*}$ has SVD $A^{*}\\,=\\,U^{*}\\Sigma^{*}V^{*\\top}$ , where $U^{*}\\ \\in^{m\\times r}$ , $V^{*}\\in\\b{\\in}^{n\\times r}$ are orthonormal matrices containing the left and right singular vectors, respectively, and $\\Sigma^{*}=\\mathrm{diag}(\\sigma_{1}^{*},\\dots,\\sigma_{r}^{*})$ is a diagonal matrix of the singular values. Similarly, suppose $A$ has SVD $\\boldsymbol{A}\\,=\\,U\\Sigma V^{\\top}+U^{\\prime}\\Sigma^{\\prime}V^{\\prime\\top}$ , where $U\\in^{m\\times r},V\\in^{n\\times\\bar{r}}$ and $\\Sigma=\\mathrm{diag}(\\sigma_{1},\\dots,\\sigma_{r})$ correspond to the top- $^r$ singular vectors/values, and $U^{\\prime}\\in^{m\\times(m-r)}$ , $V^{\\prime}\\in^{m\\times(n-r)}$ and $\\Sigma\\in^{(m-r)\\times(n-r)}$ correspond to the bottom singular vectors/values. ", "page_idx": 41}, {"type": "text", "text": "The following proposition is a generalization of the perturbation bound in [12] to the setting with non-uniform noise. ", "page_idx": 41}, {"type": "text", "text": "Proposition 2. Suppose $\\begin{array}{r}{\\overline{{\\gamma}}:=\\frac{\\|D\\|_{\\mathrm{op}}}{\\sigma_{r}^{*}}<\\frac{1}{2}}\\end{array}$ . There exist two orthonormal matrices $\\overline{{R}},\\underline{{R}}\\in^{r\\times r}$ such that ", "page_idx": 41}, {"type": "equation", "text": "$$\n\\begin{array}{r l r}&{}&{\\big\\|\\big(U-U^{*}\\overline{{R}}\\big)_{i-}\\big\\|_{2}\\leq\\|U_{i\\cdot}^{*}\\|_{2}\\cdot8\\overline{{\\gamma}}+\\|D_{i\\cdot}\\|_{2}\\cdot\\frac{1}{\\sigma_{r}^{*}\\big(1-\\overline{{\\gamma}}\\big)},\\qquad\\forall i\\in[m],}\\\\ &{}&{\\Big\\|(V-V^{*}\\underline{{R}})_{j\\cdot}\\Big\\|_{2}\\leq\\big\\|V_{j\\cdot}^{*}\\big\\|_{2}\\cdot8\\overline{{\\gamma}}+\\|D_{\\cdot j}\\|_{2}\\cdot\\frac{1}{\\sigma_{r}^{*}\\big(1-\\overline{{\\gamma}}\\big)},\\qquad\\forall j\\in[n].}\\end{array}\n$$", "text_format": "latex", "page_idx": 41}, {"type": "text", "text": "To prove Proposition 2, we need some notations. Let H := U \u22a4U \u2217\u2208r\u00d7r and its SVD be H = A\u039bB\u22a4, where $\\overline{{A}},\\overline{{B}}\\in^{r\\times r}$ are orthonormal, and $\\overline{{\\Lambda}}=\\mathrm{diag}(\\overline{{\\sigma}}_{1},\\ldots,\\overline{{\\sigma}}_{r})\\in^{r\\times r}$ is a diagonal matrix. Similarly, let $\\underline{H}\\,:=\\,V^{\\top}V^{*}\\,\\in^{r\\times r}$ and its SVD be $\\underline{{H}}\\,=\\,\\underline{{A}}\\Lambda B^{\\top}$ . Finally, define the orthonormal matrices $\\operatorname{sgn}({\\overline{{H}}}):={\\overline{{A B}}}^{\\top}$ and $\\operatorname{sgn}(\\underline{{H}}):=\\underline{{A}}\\underline{{B}}^{\\top}$ . (The function $\\operatorname{sgn}({\\mathord{\\cdot}})$ is called the matrix sign function.) ", "page_idx": 41}, {"type": "text", "text": "We need a technical lemma, which generalizes [2, Lemma 3] to the asymmetric case. ", "page_idx": 41}, {"type": "text", "text": "Lemma 3 (Properties of matrix sign function). We have $\\|\\overline{{H}}\\|_{\\mathrm{op}}\\,\\leq\\,1$ and $\\|\\underline{{H}}\\|_{\\mathrm{op}}\\,\\le\\,1$ . When $\\begin{array}{r}{\\overline{{\\gamma}}:=\\frac{\\|D\\|_{\\mathrm{op}}}{\\sigma_{r}^{*}}<\\frac{1}{2}}\\end{array}$ \u2225D\u03c3\u2217\u2225op < 21, we have ", "page_idx": 41}, {"type": "equation", "text": "$$\n\\begin{array}{r l r}&{}&{\\sqrt{\\left\\|\\overline{{H}}-\\mathrm{sgn}(\\overline{{H}})\\right\\|_{\\mathrm{op}}}\\leq\\left\\|{U U^{\\top}-U^{*}U^{*}}^{\\top}\\right\\|_{\\mathrm{op}}\\leq\\frac{\\operatorname*{max}\\left\\{\\left\\|U^{*}D\\right\\|_{\\mathrm{op}},\\left\\|D V^{*}\\right\\|_{\\mathrm{op}}\\right\\}}{\\left(1-\\overline{{\\gamma}}\\right)\\sigma_{r}^{*}}\\leq\\frac{\\overline{{\\gamma}}}{1-\\overline{{\\gamma}}},}\\\\ &{}&{\\sqrt{\\left\\|\\underline{{H}}-\\mathrm{sgn}(\\underline{{H}})\\right\\|_{\\mathrm{op}}}\\leq\\left\\|{V V^{\\top}-V^{*}V^{*}}^{\\top}\\right\\|_{\\mathrm{op}}\\leq\\frac{\\operatorname*{max}\\left\\{\\left\\|U^{*}D\\right\\|_{\\mathrm{op}},\\left\\|D V^{*}\\right\\|_{\\mathrm{op}}\\right\\}}{\\left(1-\\overline{{\\gamma}}\\right)\\sigma_{r}^{*}}\\leq\\frac{\\overline{{\\gamma}}}{1-\\overline{{\\gamma}}},}\\end{array}\n$$", "text_format": "latex", "page_idx": 41}, {"type": "text", "text": "and ", "page_idx": 41}, {"type": "equation", "text": "$$\n\\begin{array}{r l r}{\\left\\|\\Sigma\\underline{{H}}-\\overline{{H}}\\Sigma\\right\\|_{\\mathrm{op}}\\leq2\\left\\|D\\right\\|_{\\mathrm{op}},}&{}&{\\left\\|\\overline{{H}}^{\\top}\\Sigma-\\Sigma\\underline{{H}}^{\\top}\\right\\|_{\\mathrm{op}}\\leq2\\left\\|D\\right\\|_{\\mathrm{op}},}\\end{array}\n$$", "text_format": "latex", "page_idx": 41}, {"type": "text", "text": "and ", "page_idx": 41}, {"type": "equation", "text": "$$\n\\left\\|\\overline{{H}}^{-1}\\right\\|_{\\mathrm{op}}\\leq\\frac{(1-\\overline{\\gamma})^{2}}{(1-2\\overline{\\gamma})},\\qquad\\left\\|\\underline{{H}}^{-1}\\right\\|_{\\mathrm{op}}\\leq\\frac{(1-\\overline{\\gamma})^{2}}{(1-2\\overline{\\gamma})}.\n$$", "text_format": "latex", "page_idx": 41}, {"type": "text", "text": "Proof. We prove the bounds for $\\overline{H}$ . The proof for $\\underline{{H}}$ is identical. Clearly $\\|\\overline{{H}}\\|_{\\mathrm{op}}\\leq\\|U\\|_{\\mathrm{op}}\\,\\|U^{*}\\|_{\\mathrm{op}}=$ 1. ", "page_idx": 41}, {"type": "text", "text": "By Weyl\u2019s inequality, we have $|\\sigma_{i}^{*}-\\sigma_{i}|\\leq\\|D\\|_{\\infty}\\,,\\forall i\\in[m]$ , hence ", "page_idx": 42}, {"type": "equation", "text": "$$\n\\sigma_{r}^{*}-\\sigma_{r+1}\\geq\\sigma_{r}^{*}-\\|D\\|_{\\mathrm{op}}=(1-\\overline{{\\gamma}})\\sigma_{r}^{*}>\\frac{1}{2}\\sigma_{r}^{*}>0\n$$", "text_format": "latex", "page_idx": 42}, {"type": "text", "text": "by assumption. On the other hand, by standard perturbation theory, $1\\geq\\overline{{\\sigma}}_{1}\\geq\\cdot\\cdot\\geq\\overline{{\\sigma}}_{r}\\geq0$ are the cosines of the principal angles $0\\leq\\overline{{\\theta}}_{1}\\leq\\cdots\\leq\\overline{{\\theta}}_{r}\\leq\\pi/2$ between the column spaces of $U$ and $U^{*}$ , and $\\sin\\overline{{\\theta}}_{r}=\\left\\lVert U U^{\\top}-U^{*}U^{*\\top}\\right\\rVert_{\\mathrm{op}}$ . Hence $\\left\\|\\operatorname{sgn}(\\overline{{H}})-\\overline{{H}}\\right\\|_{\\operatorname{op}}=1-\\cos\\overline{{\\theta}}_{r}$ . By Wedin\u2019s $\\sin\\Theta$ Theorem, we have ", "page_idx": 42}, {"type": "equation", "text": "$$\n\\sin\\overline{{\\theta}}_{r}\\leq\\frac{\\operatorname*{max}\\left\\{\\left\\|U^{*}D\\right\\|_{\\mathrm{op}},\\left\\|D V^{*}\\right\\|_{\\mathrm{op}}\\right\\}}{\\sigma_{r}^{*}-\\sigma_{r+1}}\\leq\\frac{\\operatorname*{max}\\left\\{\\left\\|U^{*}D\\right\\|_{\\mathrm{op}},\\left\\|D V^{*}\\right\\|_{\\mathrm{op}}\\right\\}}{(1-\\overline{\\gamma})\\sigma_{r}^{*}}.\n$$", "text_format": "latex", "page_idx": 42}, {"type": "text", "text": "Since $\\cos\\overline{{\\theta}}_{r}\\ge\\cos^{2}\\overline{{\\theta}}_{r}=1-\\sin^{2}\\overline{{\\theta}}_{r}$ , we obtain ", "page_idx": 42}, {"type": "equation", "text": "$$\n\\sqrt{\\left\\|\\mathrm{sgn}(\\overline{{H}})-\\overline{{H}}\\right\\|_{\\mathrm{op}}}=\\sqrt{1-\\cos\\overline{{\\theta}}_{r}}\\leq\\sin\\overline{{\\theta}}_{r}\\leq\\frac{\\operatorname*{max}\\left\\{\\|U^{*}D\\|_{\\mathrm{op}},\\|D V^{*}\\|_{\\mathrm{op}}\\right\\}}{(1-\\overline{{\\gamma}})\\sigma_{r}^{*}}\\leq\\frac{\\|D\\|_{\\mathrm{op}}}{(1-\\overline{{\\gamma}})\\sigma_{r}^{*}}=\\frac{\\overline{{\\gamma}}}{1-\\overline{{\\gamma}}}\n$$", "text_format": "latex", "page_idx": 42}, {"type": "text", "text": "Note that ", "page_idx": 42}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{U^{\\top}D V^{*}=U^{\\top}(A-A^{*})V^{*}=\\Sigma V^{\\top}V^{*}-U^{\\top}U^{*}\\Sigma^{*}=\\Sigma\\underline{{H}}-\\overline{{H}}\\Sigma^{*},\\qquad\\mathrm{and}}\\end{array}\n$$", "text_format": "latex", "page_idx": 42}, {"type": "text", "text": "Hence ", "page_idx": 42}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\left\\|\\Sigma\\underline{{H}}-\\overline{{H}}\\Sigma\\right\\|_{\\mathrm{op}}\\leq\\left\\|\\Sigma\\underline{{H}}-\\overline{{H}}\\Sigma^{*}\\right\\|_{\\mathrm{op}}+\\left\\|\\overline{{H}}(\\Sigma^{*}-\\Sigma)\\right\\|_{\\mathrm{op}}}\\\\ &{\\qquad\\qquad\\qquad=\\left\\|U^{\\top}D V^{*}\\right\\|_{\\mathrm{op}}+\\left\\|\\overline{{H}}(\\Sigma^{*}-\\Sigma)\\right\\|_{\\mathrm{op}}}\\\\ &{\\qquad\\qquad\\qquad\\leq\\left\\|D\\right\\|_{\\mathrm{op}}+\\left\\|\\overline{{H}}\\right\\|_{\\mathrm{op}}\\left\\|\\Sigma^{*}-\\Sigma\\right\\|_{\\mathrm{op}}}\\\\ &{\\qquad\\qquad\\qquad\\leq2\\left\\|D\\right\\|_{\\mathrm{op}},}\\end{array}\n$$", "text_format": "latex", "page_idx": 42}, {"type": "text", "text": "where we use $\\|\\overline{{H}}\\|_{\\mathrm{op}}\\leq1$ and $\\|\\Sigma^{*}-\\Sigma\\|_{\\mathrm{op}}\\leq\\|D\\|_{\\mathrm{op}}$ . Similarly, ", "page_idx": 42}, {"type": "equation", "text": "$$\n\\begin{array}{r}{{U^{*}}^{\\top}D V={U^{*}}^{\\top}\\left(A-A^{*}\\right)V={U^{*}}^{\\top}U\\Sigma-\\Sigma^{*}{V^{*}}^{\\top}V^{\\top}=\\overline{{H}}^{\\top}\\Sigma-\\Sigma^{*}\\underline{{H}}^{\\top},}\\end{array}\n$$", "text_format": "latex", "page_idx": 42}, {"type": "text", "text": "so a similar argument as above gives $\\left\\|\\overline{{H}}^{\\top}\\Sigma-\\Sigma\\underline{{H}}^{\\top}\\right\\|_{\\mathrm{op}}\\leq2\\left\\|D\\right\\|_{\\mathrm{op}}.$ . ", "page_idx": 42}, {"type": "text", "text": "Finally, recall that $\\begin{array}{r}{\\left\\|\\overline{{H}}-\\mathrm{sgn}(\\overline{{H}})\\right\\|_{\\mathrm{op}}\\;\\leq\\;\\left(\\frac{\\overline{{\\gamma}}}{1-\\overline{{\\gamma}}}\\right)^{2}}\\end{array}$ and note the simple identity $X^{-1}\\mathrm{~-~}Y^{-1}\\mathrm{~=~}$ $X^{-1}(Y-X)Y^{-1}$ . It follows that ", "page_idx": 42}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\left\\|\\overline{H}^{-1}-\\mathrm{sgn}(\\overline{H})^{-1}\\right\\|_{\\mathrm{op}}\\leq\\left\\|\\overline{H}^{-1}\\right\\|_{\\mathrm{op}}\\left\\|\\overline{H}-\\mathrm{sgn}(\\overline{H})\\right\\|_{\\mathrm{op}}\\left\\|\\mathrm{sgn}(\\overline{H})^{-1}\\right\\|_{\\mathrm{op}}}\\\\ &{\\qquad\\qquad\\qquad\\qquad=\\left[\\sigma_{r}\\left(\\mathrm{sgn}(\\overline{H})+(\\overline{H}-\\mathrm{sgn}(\\overline{H}))\\right]^{-1}\\left\\|\\overline{H}-\\mathrm{sgn}(\\overline{H})\\right\\|_{\\mathrm{op}}\\right.}\\\\ &{\\qquad\\qquad\\qquad\\qquad\\left.\\leq\\frac{1}{1-\\left(\\frac{\\overline{\\gamma}}{1-\\overline{\\gamma}}\\right)^{2}}\\cdot\\left(\\frac{\\overline{\\gamma}}{1-\\overline{\\gamma}}\\right)^{2}=\\frac{\\overline{\\gamma}^{2}}{1-2\\overline{\\gamma}}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 42}, {"type": "text", "text": "It follows that ", "page_idx": 42}, {"type": "equation", "text": "$$\n\\left\\|H^{-1}\\right\\|_{\\mathrm{op}}\\leq\\left\\|\\operatorname{sgn}(\\overline{{H}})^{-1}\\right\\|_{\\mathrm{op}}+\\left\\|\\overline{{H}}^{-1}-\\operatorname{sgn}(\\overline{{H}})^{-1}\\right\\|_{\\mathrm{op}}\\leq1+\\frac{\\overline{{\\gamma}}^{2}}{1-2\\overline{{\\gamma}}}=\\frac{(1-\\overline{{\\gamma}})^{2}}{1-2\\overline{{\\gamma}}}.\n$$", "text_format": "latex", "page_idx": 42}, {"type": "text", "text": "This completes the proof of Lemma 3. ", "page_idx": 42}, {"type": "text", "text": "We are now ready to prove Proposition 2. We have ", "page_idx": 42}, {"type": "equation", "text": "$$\n\\begin{array}{r l r l}{U-U^{*}\\operatorname{sgn}(\\overline{{H}})^{\\top}=A V\\Sigma^{-1}-U^{*}\\operatorname{sgn}(\\overline{{H}})^{\\top}}&&{A=U\\Sigma V^{\\top}}\\\\ &{=(A^{*}+D)V\\Sigma^{-1}-U^{*}\\operatorname{sgn}(\\overline{{H}})^{\\top}}\\\\ &{=U^{*}\\Sigma^{*}V^{*\\top}V\\Sigma^{-1}-U^{*}\\operatorname{sgn}(\\overline{{H}})^{\\top}+D V\\Sigma^{-1}}&&{A^{*}=U^{*}\\Sigma^{*}V^{*\\top}}\\\\ &{=U^{*}\\Sigma^{*}\\underline{{H}}^{\\top}\\Sigma^{-1}-U^{*}\\operatorname{sgn}(\\overline{{H}})^{\\top}+D V\\Sigma^{-1}.}&&{\\underline{{H}}=V^{\\top}V^{*}}\\end{array}\n$$", "text_format": "latex", "page_idx": 42}, {"type": "text", "text": "But $\\Sigma^{*}\\underline{{H}}^{\\top}=(\\Sigma+\\Sigma^{*}-\\Sigma)\\underline{{H}}^{\\top}=\\overline{{H}}^{\\top}\\Sigma+\\left(\\Sigma\\underline{{H}}^{\\top}-\\overline{{H}}^{\\top}\\Sigma\\right)+(\\Sigma^{*}-\\Sigma)\\underline{{H}}^{\\top}$ . Hence ", "page_idx": 43}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\ddots\\mathrm{sgn}(\\overline{{H}})^{\\top}=U^{*}\\left[\\overline{{H}}^{\\top}\\Sigma+\\left(\\Sigma\\underline{{H}}^{\\top}-\\overline{{H}}^{\\top}\\Sigma\\right)+(\\Sigma^{*}-\\Sigma)\\underline{{H}}^{\\top}\\right]\\Sigma^{-1}-U^{*}\\mathrm{sgn}(\\overline{{H}})^{\\top}+D V\\Sigma^{-1}}\\\\ &{\\qquad\\qquad=U^{*}\\overline{{H}}^{\\top}+U^{*}\\left(\\Sigma\\underline{{H}}^{\\top}-\\overline{{H}}^{\\top}\\Sigma\\right)\\Sigma^{-1}+U^{*}\\left(\\Sigma^{*}-\\Sigma\\right)\\underline{{H}}^{\\top}\\Sigma^{-1}-U^{*}\\mathrm{sgn}(\\overline{{H}})^{\\top}+D V\\Sigma^{-1}}\\\\ &{\\qquad\\qquad=U^{*}\\left(\\overline{{H}}-\\mathrm{sgn}(\\overline{{H}})\\right)^{\\top}+U^{*}\\left(\\Sigma\\underline{{H}}^{\\top}-\\overline{{H}}^{\\top}\\Sigma\\right)\\Sigma^{-1}+U^{*}\\left(\\Sigma^{*}-\\Sigma\\right)\\underline{{H}}^{\\top}\\Sigma^{-1}+D V\\Sigma^{-1}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 43}, {"type": "text", "text": "For each $i\\in[m]$ , we can bound the $i$ -th row of $U-U^{*}\\operatorname{sgn}(\\overline{{H}})^{\\top}$ as ", "page_idx": 43}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\left|\\left(U-U^{*}\\operatorname{sgn}(\\overline{{H}})^{\\top}\\right)_{i}\\right|_{2}\\leq\\left\\|U_{i\\cdot}^{*}\\right\\|_{2}\\left(\\left\\|\\overline{{H}}-\\operatorname{sgn}(\\overline{{H}})\\right\\|_{\\infty}+\\left\\|\\Sigma\\underline{{H}}^{\\top}-\\overline{{H}}^{\\top}\\Sigma\\right\\|_{\\infty}\\left\\|\\Sigma^{-1}\\right\\|_{\\infty}+\\left\\|\\Sigma^{*}-\\Sigma\\right\\|_{\\infty}\\right.}\\\\ &{\\qquad\\qquad\\qquad\\left.+\\left\\|D_{i\\cdot}\\right\\|_{2}\\left\\|V\\right\\|_{\\infty}\\left\\|\\Sigma^{-1}\\right\\|_{\\infty}}\\\\ &{\\qquad\\qquad\\overset{(i)}{\\leq}\\left\\|U_{i\\cdot}^{*}\\right\\|_{2}\\left(\\left(\\frac{\\overline{{\\gamma}}}{1-\\overline{{\\gamma}}}\\right)^{2}+2\\left\\|D\\right\\|_{\\infty}\\cdot\\frac{1}{\\sigma_{r}^{*}(1-\\overline{{\\gamma}})}+\\left\\|D\\right\\|_{\\infty}\\cdot1\\cdot\\frac{1}{\\sigma_{r}^{*}(1-\\overline{{\\gamma}})}\\right)\\cdot}\\\\ &{\\qquad=\\left\\|U_{i\\cdot}^{*}\\right\\|_{2}\\left(\\left(\\frac{\\overline{{\\gamma}}}{1-\\overline{{\\gamma}}}\\right)^{2}+\\frac{3\\overline{{\\gamma}}}{1-\\overline{{\\gamma}}}\\right)+\\left\\|D_{i\\cdot}\\right\\|_{2}\\cdot\\frac{1}{\\sigma_{r}^{*}(1-\\overline{{\\gamma}})}}\\\\ &{\\qquad\\overset{(i i)}{\\leq}\\left\\|U_{i\\cdot}^{*}\\right\\|_{2}\\cdot8\\overline{{\\gamma}}+\\left\\|D_{i\\cdot}\\right\\|_{2}\\cdot\\frac{1}{\\sigma_{r}^{*}(1-\\overline{{\\gamma}})},}\\end{array}\n$$", "text_format": "latex", "page_idx": 43}, {"type": "text", "text": "where step (i) follows from Lemma 3 and the bound ", "page_idx": 43}, {"type": "equation", "text": "$$\n\\left\\|\\Sigma^{-1}\\right\\|_{\\mathrm{op}}=\\frac{1}{\\sigma_{r}}\\leq\\frac{1}{\\sigma_{r}^{*}-\\left\\|D\\right\\|_{\\mathrm{op}}}=\\frac{1}{\\sigma_{r}^{*}(1-\\overline{\\gamma})},\n$$", "text_format": "latex", "page_idx": 43}, {"type": "text", "text": "and step (ii) holds since $\\overline{\\gamma}\\leq\\frac12$ . Setting ${\\overline{{R}}}=\\mathrm{sgn}({\\overline{{H}}})^{\\top}$ proves the first inequality in Proposition 2. ", "page_idx": 43}, {"type": "text", "text": "The second inequality in Proposition 2 can be established by a similar argument. ", "page_idx": 43}, {"type": "text", "text": "Corollary 3. Suppose the setting of Proposition 2 holds. Furthermore, assume that $A^{*}$ is $\\mu$ - incoherent with condition number $\\kappa$ and $\\|A^{*}\\|_{\\infty}\\geq C$ for some constant $C>0$ . Then, there exist two orthonormal matrices $\\overline{R},\\underline{R}\\in^{r\\times r}$ such that ", "page_idx": 43}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{\\displaystyle\\left\\|\\left(U-U^{*}\\overline{{R}}\\right)_{i\\cdot}\\right\\|_{2}\\leq\\frac{16\\kappa(\\mu d)^{3/2}\\|D\\|_{\\infty}}{C\\sqrt{m}},}&{\\quad\\forall i\\in[m],}\\\\ {\\displaystyle\\left\\|\\left(V-V^{*}\\underline{{R}}\\right)_{j\\cdot}\\right\\|_{2}\\leq\\frac{16\\kappa(\\mu d)^{3/2}\\|D\\|_{\\infty}}{C\\sqrt{n}},}&{\\quad\\forall j\\in[n].}\\end{array}\n$$", "text_format": "latex", "page_idx": 43}, {"type": "text", "text": "Proof. From the definition of the $\\ell_{\\infty}$ norm, there exists $(i,j)\\in[m]\\times[m]$ such that $\\|A^{*}\\|_{\\infty}=|A_{i,j}|$ . Then, it follows that ", "page_idx": 43}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\|A^{*}\\|_{\\infty}=|A_{i,j}|=|(U^{*}\\Sigma^{*}V^{*\\top})_{i,j}|}\\\\ &{\\qquad\\quad\\leq\\|\\Sigma^{*}\\|_{o p}\\|U_{i}^{*}\\|_{2}\\|V_{j}^{*}\\|_{2}}\\\\ &{\\qquad\\quad\\leq\\frac{\\sigma_{1}\\mu d}{\\sqrt{m n}}}\\\\ &{\\qquad\\quad\\leq\\frac{\\kappa\\sigma_{d}\\mu d}{\\sqrt{m n}}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 43}, {"type": "text", "text": "Furthermore, we note that $\\|D\\|_{o p}\\leq\\|D\\|_{\\infty}\\sqrt{m n}$ . Thus, the result follows from Proposition 2 and using the definition of incoherence and the above inequalities. \u53e3 ", "page_idx": 43}, {"type": "text", "text": "J Proofs of LSVI-UCB- $(\\mathbf{S},\\mathbf{d},\\mathbf{A})$ and LSVI-UCB-(S, S, d) ", "text_level": 1, "page_idx": 43}, {"type": "text", "text": "In this section, we present the proofs of Theorem 8 and 9 and the related lemmas. The proofs, theorems, and lemmas are modifications of the analogous result/proof in [17] tailored to our Tucker rank settings. ", "page_idx": 43}, {"type": "text", "text": "J.1 LSVI-UCB- $(\\mathbf{S},\\mathbf{d},\\mathbf{A})$ ", "text_level": 1, "page_idx": 44}, {"type": "text", "text": "To prove Theorem 8, we first introduce notation used throughout this section and then present auxiliary lemmas. We reiterate that the steps and analysis in this subsection are essentially the same as the proofs in [17], except we have $A$ copies of the weight vectors and gram matrices. We let $\\Lambda_{h,k}^{a},\\stackrel{\\_}{w}_{h,k}^{a},Q_{h}^{k},V_{h}^{k},\\pi^{k}$ as the parameters/estimates at episode $k$ . Furthermore, let $V_{h}^{k}\\,=$ $\\operatorname*{max}_{a\\in\\mathcal{A}}Q_{h}^{k}(s,a)$ and $\\pi^{k}$ be the greedy policy w.r.t. $Q_{h}^{k}$ . We let $F_{h}^{k}:=F_{h}(s_{h}^{k})$ . ", "page_idx": 44}, {"type": "text", "text": "To prove the desired regret bound, we first need to prove that $\\mathbb{P}V-{\\hat{P}}V$ concentrates about 0, which differs from typical concentration inequalities for self normalized processes due to the value function not being constant. Thus, we first bound the log of the covering number of our function class for the value function to control the error of our algorithm\u2019s estimate. ", "page_idx": 44}, {"type": "text", "text": "Lemma 4. Let $\\nu$ denote a function class of mappings from $\\boldsymbol{S}$ to $\\mathbb{R}$ with the following parametric form ", "page_idx": 44}, {"type": "equation", "text": "$$\nV(\\cdot)=\\operatorname*{min}\\left\\{\\operatorname*{max}_{a\\in\\mathcal{A}}w_{a}^{\\top}F(\\cdot)+\\beta\\sqrt{F(\\cdot)^{\\top}\\Lambda_{a}^{-1}F(\\cdot)},H\\right\\}\n$$", "text_format": "latex", "page_idx": 44}, {"type": "text", "text": "where the parameters $w_{a},\\beta,\\Lambda_{a}$ satisfy $\\|w_{a}\\|\\leq L$ for all $a\\in A$ , $\\beta\\,\\in\\,[0,B]$ , and the minimum eigenvalue of $\\Lambda_{a}$ is greater than $\\lambda$ . Assume that $\\|F(s)\\|\\,\\leq\\,1$ for all $s\\ \\in\\ S$ , and let $\\mathcal{N}_{\\epsilon}$ be the $\\epsilon$ -covering number of $\\nu$ with respect to the distance $d i s t(\\dot{V},V^{\\prime})=\\operatorname*{sup}_{s}|V(s)-V^{\\prime}(s)|$ . Then, ", "page_idx": 44}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\log(\\mathcal{N}_{\\epsilon})\\leq d\\log(1+4L/\\epsilon)+d^{2}\\log(1+8d^{1/2}B^{2}/(\\lambda\\epsilon^{2}))}\\end{array}\n$$", "text_format": "latex", "page_idx": 44}, {"type": "text", "text": "Proof. Equivalently, we reparameterize the function class by $D_{a}=\\beta^{2}\\Lambda_{a}^{-1}$ , ", "page_idx": 44}, {"type": "equation", "text": "$$\nV(\\cdot)=\\operatorname*{min}\\left\\{\\operatorname*{max}_{a\\in\\mathcal{A}}w_{a}^{\\top}F(\\cdot)+\\sqrt{F(\\cdot)^{\\top}D_{a}F(\\cdot)},H\\right\\}\n$$", "text_format": "latex", "page_idx": 44}, {"type": "text", "text": "where $\\|w_{a}\\|\\leq L$ and $\\|D_{a}\\|\\le B^{2}/\\lambda$ for all $a\\in A$ . For any $V_{1},V_{2}\\in\\mathcal{V}$ , let them take the form in the above equation with parameters $(w_{a},D_{a})$ and $(w_{a}^{\\prime},D_{a}^{\\prime})$ . Since $\\operatorname*{min}(\\cdot,H)$ and $\\operatorname*{max}_{a\\in A}$ are contraction maps, ", "page_idx": 44}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{d i s t(V_{1}-V_{2})\\leq\\underset{s,a}{\\operatorname*{sup}}\\,|(w_{a}^{\\top}F(s)+\\sqrt{F(s)^{\\top}D_{a}F(s)})-(w_{a}^{\\prime\\top}F(s)+\\sqrt{F(s)^{\\top}D_{a}^{\\prime}F(s)})|}\\\\ &{\\qquad\\qquad\\leq\\underset{a,F\\setminus\\{F\\}\\in\\mathbb{S}}{\\operatorname*{sup}}\\,|(w_{a}^{\\top}F+\\sqrt{F^{\\top}D_{a}F})-(w_{a}^{\\prime\\top}F+\\sqrt{F^{\\top}D_{a}^{\\prime}F})|}\\\\ &{\\qquad\\qquad\\leq\\underset{a\\in\\mathcal{A}}{\\operatorname*{max}}\\left[\\underset{F:\\|F\\|\\leq1}{\\operatorname*{sup}}\\,|(w_{a}-w_{a}^{\\prime})^{\\top}F|+\\underset{F:\\|F\\|\\leq1}{\\operatorname*{sup}}\\,|\\sqrt{F^{\\top}(D_{a}-D_{a}^{\\prime})F}|\\right]}\\\\ &{\\qquad\\qquad\\leq\\underset{a\\in\\mathcal{A}}{\\operatorname*{max}}\\left[\\|w_{a}-w_{a}^{\\prime}\\|+\\sqrt{\\|D_{a}-D_{a}^{\\prime}\\|}\\right]\\leq\\underset{a\\in\\mathcal{A}}{\\operatorname*{max}}\\left[\\|w_{a}-w_{a}^{\\prime}\\|+\\sqrt{\\|D_{a}-D_{a}^{\\prime}\\|_{F}}\\right]}\\end{array}\n$$", "text_format": "latex", "page_idx": 44}, {"type": "text", "text": "where the holds because $|{\\sqrt{x}}-{\\sqrt{y}}|\\,\\leq\\,{\\sqrt{|x-y|}}$ for any $x,y\\,\\geq\\,0$ . Let $C_{w}$ be an $\\epsilon/2$ -cover of $\\{w\\in\\mathbb{R}^{d}|\\|w\\|\\leq L\\}$ with respect to the 2-norm, and $C_{D}$ be an $\\epsilon^{2}/4$ -cover of $\\{D\\in\\mathbb{R}^{d\\times d}|\\|D\\|_{F}\\leq$ $d^{1/2}B^{2}/\\lambda\\}$ with respect to the Frobenius norm. By Lemma D.5 from [17], we know that, ", "page_idx": 44}, {"type": "equation", "text": "$$\n|C_{w}|\\leq(1+4L/\\epsilon)^{d},\\quad|C_{D}|\\leq(1+8d^{1/2}B^{2}/(\\lambda\\epsilon^{2}))^{d^{2}}.\n$$", "text_format": "latex", "page_idx": 44}, {"type": "text", "text": "Hence, for any $V_{1}$ , there exists a $w_{a}^{\\prime}\\in C_{w}$ and $D_{a}^{\\prime}\\in C_{D}$ for all $a\\in{\\mathcal{A}}$ such that $V_{2}$ parameterized by $(w_{a}^{\\prime},D_{a}^{\\prime})$ satisfies $d i s t(V_{1},V_{2})\\leq\\epsilon$ . Hence, $\\bar{\\mathcal{N}_{\\epsilon}}\\leq|C_{w}||C_{D}|$ , which gives: ", "page_idx": 44}, {"type": "equation", "text": "$$\n\\log(\\mathcal{N}_{\\epsilon})\\leq\\log(|C_{w}|)+\\log(|C_{D}|)\\leq d\\log(1+4\\epsilon L/\\epsilon)+d^{2}\\log(1+8d^{1/2}B^{2}/(\\lambda\\epsilon^{2})).\n$$", "text_format": "latex", "page_idx": 44}, {"type": "text", "text": "We next bound the $\\ell_{2}$ -norm of the weight vector of any policy. ", "page_idx": 44}, {"type": "text", "text": "Lemma 5. Let $\\{w_{h}^{a}\\}$ be the weight vector of some policy $\\pi$ , i.e., $Q_{h}^{\\pi}(s,a)=F_{h}(s)^{\\top}w_{h}^{a}$ . Then, ", "page_idx": 44}, {"type": "equation", "text": "$$\n\\|w_{h}^{a}\\|\\leq2H{\\sqrt{d}}.\n$$", "text_format": "latex", "page_idx": 44}, {"type": "text", "text": "Proof. Note that $\\begin{array}{r}{Q_{h}^{\\pi}(s,a)=r_{h}(s,a)+\\sum_{s^{\\prime}}V_{h+1}^{\\pi}(s^{\\prime})P_{h}(s^{\\prime}|s,a)}\\end{array}$ , so, using the low-rank representations of $r_{h},P_{h}$ , it follows that ", "page_idx": 45}, {"type": "text", "text": "\u2225 $w_{h}^{a}\\|_{2}=\\|W_{h}(a,\\cdot)+\\sum_{s^{\\prime}}V^{\\pi}(s^{\\prime})U_{h}(s^{\\prime},a,\\cdot)\\|_{2}\\le\\|W_{h}(a,\\cdot)\\|_{2}+\\|\\sum_{s^{\\prime}}V^{\\pi}(s^{\\prime})U_{h}(s^{\\prime},a,\\cdot)\\|_{2}\\le\\sqrt{d}+H^{\\pi},$ d. Recall that since the feature mapping was scaled up (Fh = dS\u00b5 to ensure the max entries of $F$ and $W,U$ are on the same scale, it follows t\u221ahat $\\|W_{h}(a)\\|_{2}\\leq1$ and $\\begin{array}{r}{\\|\\sum_{s^{\\prime}\\in\\mathcal{S}}V_{h+1}^{\\pi}(s^{\\prime})U_{h}(s^{\\prime},a)\\|_{2}\\le H.}\\end{array}$ . Therefore, it follows that $\\|w_{h}^{a}\\|_{2}\\leq2H\\sqrt{d}$ . \u53e3 ", "page_idx": 45}, {"type": "text", "text": "We next bound the 2-norm of the weight vector from the algorithm. ", "page_idx": 45}, {"type": "text", "text": "Lemma 6. For any $k,h,a,$ the weight vector from the above algorithm satisfies $\\begin{array}{r l}{\\|w_{h,k}^{a}\\|}&{{}\\leq}\\end{array}$ $2H\\sqrt{d k/\\lambda}$ . ", "page_idx": 45}, {"type": "text", "text": "Proof. For any $F_{h}(s)=f$ , we have for any $a\\in A$ ", "page_idx": 45}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\displaystyle\\lvert f^{\\top}w_{h,k}^{a}\\rvert=\\lvert f^{\\top}(\\Lambda_{h}^{a})^{-1}\\sum_{t\\in T_{h,k-1}^{a}}F_{h}(s_{h}^{t})\\left[r_{h}(s_{h}^{t},a)+\\operatorname*{max}_{a^{\\prime}\\in A}Q_{h+1}(s_{h+1}^{t},a^{\\prime})\\right]\\rvert}\\\\ &{\\displaystyle\\leq\\lvert\\sum_{t\\in T_{h,k-1}^{a}}f^{\\top}(\\Lambda_{h}^{a})^{-1}F_{h}(s_{h}^{t})\\rvert2H}\\\\ &{\\displaystyle\\leq2H\\sqrt{\\binom{a}{t\\in T_{h,k-1}^{a}}f^{\\top}(\\Lambda_{h}^{a})^{-1}f^{\\top})(\\sum_{t\\in T_{h,k-1}^{a}}F_{h}(s_{h}^{t})^{\\top}(\\Lambda_{h}^{a})^{-1}F_{h}(s_{h}^{t}))}}\\\\ &{\\displaystyle\\leq2H\\lVert f\\rVert_{2}\\sqrt{d|T_{h,k-1}^{a}|/\\lambda}\\le2H\\sqrt{d k/\\lambda},}\\end{array}\n$$", "text_format": "latex", "page_idx": 45}, {"type": "text", "text": "where the second to last inequality is due to Lemma D.1 from [17] and that Rayleigh quotients are upper bounded by the largest eigenvalue of the matrix (Theorem 4.2.2 from [14]). The last inequality is due to $\\|F_{h}(s)\\|_{2}\\leq1$ and $|T_{h,k-1}^{a}|\\leq k$ . \u53e3 ", "page_idx": 45}, {"type": "text", "text": "The above two lemmas are necessary in ensuring that the estimation error is small as they depend multiplicatively on the norm of the weight vectors. We next prove the main concentration lemma that controls the estimate. ", "page_idx": 45}, {"type": "text", "text": "Lemma 7. Let $c^{\\prime}$ be the constant in the definition of $\\beta_{k,h}^{a}=c^{\\prime}d H\\sqrt{\\iota}$ . Then, there exists a constant $C>0$ that is independent of $c^{\\prime}$ such that for any $\\delta\\in(0,1)$ , if we let the event $\\mathcal{X}$ be ", "page_idx": 45}, {"type": "equation", "text": "$$\n\\langle(a,k,h)\\in\\mathcal{A}\\times[K]\\times[H]:\\qquad\\left\\|\\sum_{t\\in T_{h,k-1}^{a}}F_{h}(s_{h}^{t})(V_{h+1}^{t}(s_{h+1}^{t})-P_{h}V_{h+1}^{t}(s_{h}^{t},a)\\right\\|_{(\\Lambda_{h,t}^{a})^{-1}}\\leq C d H\\sqrt{M_{h+1}^{a}}\\leq C d H\\psi_{h},\n$$", "text_format": "latex", "page_idx": 45}, {"type": "text", "text": "where $\\chi=\\log(2(c^{\\prime}+1)d T A/\\delta)$ , then $\\mathbb{P}(\\boldsymbol{\\mathscr{X}})\\ge1-\\delta/2$ . ", "page_idx": 45}, {"type": "text", "text": "Proof. From Lemma 6, we have $\\|w_{h,k}^{a}\\|_{2}\\leq2H\\sqrt{d k/\\lambda}.$ . By construction, the minimum eigenvalue of $\\Lambda_{h,t}^{a}$ is lower bounded by $\\lambda$ . Then, from Lemma D.4 in [17] (with $\\delta^{\\prime}=\\delta/A)$ ), Lemma 4, and taking a union bound over actions, we have that with probability at least $1-\\delta^{\\prime}/2$ , for all $a\\in A$ and $\\epsilon>0$ , ", "page_idx": 45}, {"type": "equation", "text": "$$\n\\left|\\sum_{t\\in T_{h,k-1}^{u}}F_{h}(s_{h}^{t})(V_{h+1}^{t}(s_{h+1}^{t})-P_{h}V_{h+1}^{t}(s_{h}^{t},a))\\right|\\left|_{(\\Lambda_{h,t}^{a})^{-1}}^{2}\\le4H^{2}\\left[\\frac{d}{2}\\log((k+\\lambda)/\\lambda))+\\log(2A N_{\\epsilon}/\\lambda)\\log(d_{\\Lambda_{h,t}^{a}})\\right]\\:.\n$$", "text_format": "latex", "page_idx": 45}, {"type": "text", "text": "Then, from Lemma 4, it follows that with probability at least $1-\\delta^{\\prime}/2$ , for all $a\\in A$ and $\\epsilon>0$ , ", "page_idx": 45}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\left|\\displaystyle\\sum_{t\\in T_{h,k-1}^{a}}F_{h}(s_{h}^{t})(V_{h+1}^{t}(s_{h+1}^{t})-P_{h}V_{h+1}^{t}(s_{h}^{t},a)\\right|\\left|_{(\\Lambda_{h,t}^{a})^{-1}}^{2}}\\\\ &{\\le4H^{2}\\left[\\displaystyle\\frac{d}{2}\\log((k+\\lambda)/\\lambda))+\\log(2A/\\delta)+d\\log(1+4L/\\epsilon)+d^{2}\\log(1+8d^{1/2}\\beta^{2}/(\\lambda\\epsilon^{2}))\\right]+8k^{2}\\epsilon^{2}\\log(1+\\delta)}\\end{array}\n$$", "text_format": "latex", "page_idx": 45}, {"type": "text", "text": "Choosing $\\lambda=1,\\beta_{k,h}^{a}=C d H\\iota,\\epsilon=d H/k$ gives that there exists some constant $C^{\\prime}$ such that ", "page_idx": 46}, {"type": "equation", "text": "$$\n\\left\\|\\sum_{t\\in T_{h,k-1}^{a}}F_{h}(s_{h}^{t})(V_{h+1}^{t}(s_{h+1}^{t})-P_{h}V_{h+1}^{t}(s_{h}^{t},a)\\right\\|_{(\\Lambda_{h,t}^{a})^{-1}}^{2}\\le C^{\\prime}d^{2}H^{2}\\log(2(c_{\\beta}+1)d T A/\\delta).\n$$", "text_format": "latex", "page_idx": 46}, {"type": "text", "text": "We next recursively bound the difference between the value function maintained in the algorithm and the true value function of any policy $\\pi$ . We upperbound this with their expected difference and an additional error term, which is bounded with high probability. ", "page_idx": 46}, {"type": "text", "text": "Lemma 8. There exists a constant $c_{\\beta}$ such that $\\beta_{k,h}^{a}=c_{\\beta}d H\\sqrt{\\iota}$ where $\\iota=\\log(2d A T/p)$ and for any fixed policy $\\pi$ , on the event $\\mathcal{X}$ defined in Lemma 7, we have for all $(s,a,h,k)\\in S\\times A\\times[H]\\times[K]$ : ", "page_idx": 46}, {"type": "text", "text": "where ", "page_idx": 46}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\ \\ \\ \\ \\ F_{h}(s)^{\\top}w_{h,k}^{a}-Q_{h}^{\\pi}(s,a)=P_{h}(V_{h+1}^{k}-V_{h+1}^{\\pi})(s,a)+\\Delta_{h}^{k}(s,a),}\\\\ &{\\ \\ \\ \\ \\ \\ a)|\\leq\\beta_{k,h}^{a}\\sqrt{F_{h}(s)^{\\top}(\\Lambda_{h,k}^{a})^{-1}F_{h}(s)}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 46}, {"type": "text", "text": "Proof. From our low-rank assumption, it follows that ", "page_idx": 46}, {"type": "equation", "text": "$$\nQ_{h}^{\\pi}(s,a)=F_{h}(s)^{\\top}w_{h}^{a}=(r_{h}+P_{h}V_{h+1}^{\\pi})(s,a),\n$$", "text_format": "latex", "page_idx": 46}, {"type": "text", "text": "which following the steps from the proof of Lemma B.4 in [17] gives ", "page_idx": 46}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{w_{h,k}^{a}-w_{h}^{a,\\pi}=-\\lambda(\\Lambda_{h,k}^{a})^{-1}w_{h}^{a,\\pi}}\\\\ &{\\qquad\\qquad\\quad+\\,(\\Lambda_{h,k}^{a})^{-1}\\displaystyle\\sum_{t\\in T_{k-1,h}^{a}}F_{h}(s_{h}^{t})(V_{h+1}^{k}(s_{h+1}^{t})-P_{h}V_{h+1}^{k}(s_{h}^{t},a)}\\\\ &{\\qquad\\qquad\\quad+\\,(\\Lambda_{h,k}^{a})^{-1})\\displaystyle\\sum_{t\\in T_{k-1,h}^{a}}F_{h}(s_{h}^{t})P_{h}(V_{h+1}^{k}-V_{h+1}^{\\pi})(s_{h}^{t},a)}\\end{array}\n$$", "text_format": "latex", "page_idx": 46}, {"type": "text", "text": "Now, we bound each term $(q_{1}^{a},q_{2}^{a},q_{3}^{a})$ individually, for the first term, note for all $a\\in{\\mathcal{A}}$ ", "page_idx": 46}, {"type": "equation", "text": "$$\n|F_{h}(s)^{\\top}q_{1}^{a}|=|\\lambda F_{h}(s)^{\\top}(\\Lambda_{h,k}^{a})^{-1}w_{h}^{a,\\pi}|\\leq\\sqrt{\\lambda}\\|w_{h}^{a,\\pi}\\|\\sqrt{F_{h}(s)^{\\top}(\\Lambda_{h,k}^{a})^{-1}F_{h}(s)}\n$$", "text_format": "latex", "page_idx": 46}, {"type": "text", "text": "For the second term, given the event $\\mathcal{X}$ , we have from Cauchy Schwarz ", "page_idx": 46}, {"type": "equation", "text": "$$\n|F_{h}(s)^{\\top}q_{2}^{a}|\\leq C d H\\sqrt{\\chi}\\sqrt{F_{h}(s)^{\\top}(\\Lambda_{h,k}^{a})^{-1}F_{h}(s)}\n$$", "text_format": "latex", "page_idx": 46}, {"type": "text", "text": "where $\\chi=\\log(2(c_{\\beta}+1)d T A/p)$ . For the third term, ", "page_idx": 46}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{F_{h}(s)^{\\top}q_{3}^{a}=F_{h}(s)^{\\top}\\left((\\Lambda_{h,k}^{a})^{-1}\\right)\\displaystyle\\sum_{t\\in T_{h-1,h}^{a}}F_{h}(s_{h}^{t})P_{h}(V_{h+1}^{k}-V_{h+1}^{\\pi})(s_{h}^{t},a)\\right)}\\\\ &{\\phantom{\\sum_{t\\in T_{h-1,h}^{a}}}=F_{h}(s)^{\\top}\\left((\\Lambda_{h,k}^{a})^{-1}\\right)\\displaystyle\\sum_{t\\in T_{h-1,h}^{a}}F_{h}(s_{h}^{t})F_{h}(s_{h}^{t})^{\\top}\\sum_{s^{\\prime}\\in S}(V_{h+1}^{k}-V_{h+1}^{\\pi})(s^{\\prime})U_{h}(s^{\\prime},a)\\right)}\\\\ &{\\phantom{\\sum_{t\\in T_{h+1}^{a}}}=F_{h}(s)^{\\top}\\left(\\displaystyle\\sum_{s^{\\prime}\\in S}(V_{h+1}^{k}-V_{h+1}^{\\pi})(s^{\\prime})U_{h}(s^{\\prime},a)\\right)}\\\\ &{\\phantom{\\sum_{t\\in T_{h+1}^{a}}}-\\lambda F_{h}(s)^{\\top}\\left((\\Lambda_{h,k}^{a})^{-1}\\right)\\displaystyle\\sum_{s^{\\prime}\\in S}(V_{h+1}^{k}-V_{h+1}^{\\pi})(s^{\\prime})U_{h}(s^{\\prime},a)\\right)}\\end{array}\n$$", "text_format": "latex", "page_idx": 46}, {"type": "text", "text": "We note that ", "page_idx": 46}, {"type": "equation", "text": "$$\nF_{h}(s)^{\\top}\\left(\\sum_{s^{\\prime}\\in\\mathcal{S}}(V_{h+1}^{k}-V_{h+1}^{\\pi})(s^{\\prime})U_{h}(s^{\\prime},a)\\right)=P_{h}(V_{h+1}^{k}-V_{h+1}^{\\pi})(s,a)\n$$", "text_format": "latex", "page_idx": 46}, {"type": "text", "text": "and ", "page_idx": 47}, {"type": "equation", "text": "$$\n|\\lambda F_{h}(s)^{\\top}\\left((\\Lambda_{h,k}^{a})^{-1})\\sum_{s^{\\prime}\\in\\mathcal{S}}(V_{h+1}^{k}-V_{h+1}^{k})(s^{\\prime})U_{h}(s^{\\prime},a)\\right)|\\leq2H\\sqrt{d\\lambda}\\sqrt{F_{h}(s)^{\\top}(\\Lambda_{h,k}^{a})^{-1}F_{h}(s)}\n$$", "text_format": "latex", "page_idx": 47}, {"type": "text", "text": "Since ", "page_idx": 47}, {"type": "equation", "text": "$$\n\\begin{array}{r}{|F_{h}(s)^{\\top}w_{h,k}^{a}-Q_{h}^{\\pi}(s,a)|=F_{h}(s)^{\\top}(w_{h,k}^{a}-w_{h}^{a,\\pi})=F_{h}(s)^{\\top}(q_{1}^{a}+q_{2}^{a}+q_{3}^{a}),}\\end{array}\n$$", "text_format": "latex", "page_idx": 47}, {"type": "text", "text": "it follows that ", "page_idx": 47}, {"type": "equation", "text": "$$\n\\begin{array}{r}{|F_{h}(s)^{\\top}w_{h,k}^{a}-Q_{h}^{\\pi}(s,a)-P_{h}(V_{h+1}^{k}-V_{h+1}^{\\pi})(s,a)|\\leq C^{\\circ}d H\\sqrt{\\chi}\\sqrt{F_{h}(s)^{\\top}(\\Lambda_{h,k}^{a})^{-1}F_{h}(s)}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 47}, {"type": "text", "text": "Similarly as in [17], we choose $c_{\\beta}$ that satisfies $C^{\\prime\\prime}{\\sqrt{\\log(2)+\\log(c_{\\beta}+1)}}\\leq c_{\\beta}{\\sqrt{\\log(2)}}$ . ", "page_idx": 47}, {"type": "text", "text": "This lemma implies that by adding the appropriate bonus, $Q_{h}^{k}$ is always an upperbound of $Q_{h}^{*}$ with high probability, i.e., achieving optimism. ", "page_idx": 47}, {"type": "text", "text": "Lemma 9. On the event $\\mathcal{X}$ defined in lemma 7, we have $Q_{h}^{k}(s,a)\\geq Q_{h}^{*}(s,a)$ for all $(s,a,h,k)\\in$ $\\mathcal{S}\\times\\mathcal{A}\\times[H]\\times[K]$ . ", "page_idx": 47}, {"type": "text", "text": "Proof. We prove this with induction. The base case holds because at step $H+1$ , the value function is zero, so from Lemma 8, ", "page_idx": 47}, {"type": "equation", "text": "$$\n|F_{H}(s)^{\\top}w_{H,k}^{a}-Q_{H}^{*}(s,a)|\\leq\\beta_{k,h}^{a}\\sqrt{F_{H}(s)^{\\top}(\\Lambda_{H,k}^{a})^{-1})F_{H}(s)}\n$$", "text_format": "latex", "page_idx": 47}, {"type": "text", "text": "and thus, ", "page_idx": 47}, {"type": "equation", "text": "$$\nQ_{H}^{*}(s,a)\\leq\\operatorname*{min}\\Big(H,F_{H}(s)^{\\top}w_{H,k}^{a}+\\beta_{k,h}^{a}\\sqrt{F_{H}(s)^{\\top}(\\Lambda_{H,k}^{a})^{-1}}\\big)F_{H}(s)\\Big)=Q_{H}^{k}(s,a).\n$$", "text_format": "latex", "page_idx": 47}, {"type": "text", "text": "From the inductive hypothesis (assuming that $Q_{h+1}^{k}(s,a)\\geq Q_{h+1}^{*}(s,a))$ , it follows that $P_{h}(V_{h+1}^{k}-$ $V_{h+1}^{*})(s,a)\\geq0$ . From Lemma 8, $F_{h}(s)^{\\top}w_{h,k}^{a}\\,-\\,Q_{h}^{*}(s,a)\\,\\le\\,\\beta_{k,h}^{a}\\sqrt{F_{h}(s)^{\\top}(\\Lambda_{h,k}^{a})^{-1})F_{h}(s)}$ . It follows that ", "page_idx": 47}, {"type": "equation", "text": "$$\nQ_{h}^{*}(s,a)\\leq\\operatorname*{min}\\Big(H,F_{h}(s)^{\\top}w_{h,k}^{a}+\\beta_{k,h}^{a}\\sqrt{F_{h}(s)^{\\top}(\\Lambda_{h,k}^{a})^{-1})F_{h}(s)}\\Big)=Q_{h}^{k}(s,a).\n$$", "text_format": "latex", "page_idx": 47}, {"type": "text", "text": "We next show that Lemma 8 transforms to the recursive formula $\\delta_{h}^{k}=V_{h}^{k}(s_{h}^{k})-V_{h}^{\\pi_{k}}(s_{h}^{k})$ , which is used in proving our regret bound. ", "page_idx": 47}, {"type": "text", "text": "Lemma 10. Let $\\delta_{h}^{k}=V_{h}^{k}(s_{h}^{k})-V_{h}^{\\pi_{k}}(s_{h}^{k})$ and $\\xi_{h+1}^{k}=\\mathbb{E}[\\delta_{h+1}^{k}|s_{h}^{k},a_{h}^{k}]-\\delta_{h+1}^{k}$ . Then, on the event $\\mathcal{X}$ defined in Lemma 7, we have for any $(h,k)$ : ", "page_idx": 47}, {"type": "equation", "text": "$$\n\\delta_{h}^{k}\\leq\\delta_{h+1}^{k}+\\xi_{h+1}^{k}+\\beta_{k,h}^{a}\\sqrt{F_{h}(s_{h}^{k})^{\\top}(\\Lambda_{h,k}^{a_{h}^{k}})^{-1}F_{h}(s_{h}^{k})}\n$$", "text_format": "latex", "page_idx": 47}, {"type": "text", "text": "Proof. From Lemma 8, we have for any $(s,a,h,k)$ that ", "page_idx": 47}, {"type": "equation", "text": "$$\nQ_{h}^{k}(s,a)-Q_{h}^{\\pi_{k}}(s,a)\\leq P_{h}(V_{h+1}^{k}-V_{h+1}^{\\pi_{k}})(s,a)+\\beta_{k,h}^{a}\\sqrt{F_{h}(s)^{\\top}(\\Lambda_{h,k}^{a})^{-1}F_{h}(s)}.\n$$", "text_format": "latex", "page_idx": 47}, {"type": "text", "text": "From the definition of $V^{\\pi_{k}}$ , we have ", "page_idx": 47}, {"type": "equation", "text": "$$\n\\delta_{h}^{k}=Q_{h}^{k}(s_{h}^{k},a_{h}^{k})-Q_{h}^{\\pi_{k}}(s_{h}^{k},a_{h}^{k}).\n$$", "text_format": "latex", "page_idx": 47}, {"type": "text", "text": "Finally, we prove the main theorem, Theorem 8, which asserts that the regret bound of our algorithm is efficient with respect to $A$ and $T$ . ", "page_idx": 47}, {"type": "text", "text": "Proof. Suppose that the Assumptions required in Theorem 8 hold. We condition on the event $\\mathcal{X}$ from Lemma 7 with $p=\\delta/2$ and use the notation for $\\delta_{h}^{k},\\xi_{h}^{k}$ as in Lemma 10. From Lemmas 9 and 10, we have ", "page_idx": 48}, {"type": "equation", "text": "$$\n\\mathcal{1}e g r e t(K)=\\sum_{k=1}^{K}(V_{1}^{*}(s_{1}^{k})-V_{1}^{\\pi_{k}}(s_{1}^{k}))\\le\\sum_{k=1}^{K}\\delta_{1}^{k}\\le\\sum_{k\\in[K]}\\sum_{h\\in[H]}\\xi_{h}^{k}+\\beta_{k,h}^{a}\\sum_{k\\in[K]}\\sum_{h\\in[H]}\\sqrt{F_{h}(s_{h}^{k})^{\\top}(\\Lambda_{h,k}^{a_{h}^{k}})}.\n$$", "text_format": "latex", "page_idx": 48}, {"type": "text", "text": "Since the observations at episode $k$ are independent of the computed value function (this uses the trajectories from episodes 1 to $k-1$ , it follows $\\{\\xi_{h}^{k}\\}$ is a martingale difference sequence with $|\\xi_{h}^{k}|\\leq2H$ for all $(k,h)$ . Thus, from the Azuma Hoeffding inequality, we have ", "page_idx": 48}, {"type": "equation", "text": "$$\n\\sum_{k\\in[K],h\\in H}\\xi_{h}^{k}\\leq\\sqrt{2T H^{2}\\log(2/p)}\\leq2H\\sqrt{T\\iota}\n$$", "text_format": "latex", "page_idx": 48}, {"type": "text", "text": "with probability at least $1-\\delta/2$ . For the second term, we note that the minimum eigenvalue of $\\Lambda_{h,k}^{a_{h}^{k}}$ is at least one by construction and . From the Elliptical Potential Lemma (Lemma D.2 [17]), we have for all $a\\in A$ and $h\\in[H]$ , ", "page_idx": 48}, {"type": "equation", "text": "$$\n\\sum_{k=1}^{K}F_{h}(s_{k})^{\\top}(\\Lambda_{h,k}^{a})^{-1}F_{h}(s_{k})\\le2\\log(d e t(\\Lambda_{h,k+1}^{a})/d e t(\\Lambda_{h,0}^{a}))\n$$", "text_format": "latex", "page_idx": 48}, {"type": "text", "text": "Furthermore, we have $\\begin{array}{r}{\\|\\Lambda_{h,k+1}^{a}\\|=\\|\\sum_{t\\in T_{K,h}^{a}}F_{h}(s_{h}^{t})F_{h}(s_{h}^{t})^{\\top}+\\lambda I\\|\\leq\\lambda+|T_{K,h}^{a}|\\leq\\lambda+K}\\end{array}$ . It follows that ", "page_idx": 48}, {"type": "equation", "text": "$$\n\\sum_{k=1}^{K}F_{h}(s_{k})^{\\top}(\\Lambda_{h,k}^{a})^{-1}F_{h}(s_{k})\\le2d\\log(1+K/\\lambda)\\le2d u\n$$", "text_format": "latex", "page_idx": 48}, {"type": "text", "text": "Next, by Cauchy-Schwarz and grouping the regret by each action, it follows that ", "page_idx": 48}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{\\displaystyle\\sum_{k\\in[K]}\\displaystyle\\sum_{h\\in[H]}\\sqrt{F_{h}(s_{h}^{k})^{\\top}(\\Lambda_{h,k}^{a_{h}^{k}})^{-1}F_{h}(s_{h}^{k})}\\leq\\displaystyle\\sum_{h\\in[H]}\\sqrt{K}\\left[\\displaystyle\\sum_{k\\in[K]}F_{h}(s_{h}^{k})^{\\top}(\\Lambda_{h,k}^{a_{h}^{k}})^{-1}F_{h}(s_{h}^{k})\\right]^{1/2}}\\\\ &{=\\displaystyle\\sum_{h\\in[H]}\\sqrt{K}\\left[\\displaystyle\\sum_{a\\in A}\\displaystyle\\sum_{\\ell\\in T_{h,h}^{a}}F_{h}(s_{h}^{t})^{\\top}(\\Lambda_{h,t}^{a})^{-1}F_{h}(s_{h}^{t})\\right]^{1/2}}\\\\ &{\\leq\\displaystyle\\sum_{h\\in[H]}\\sqrt{K}\\left[\\displaystyle\\sum_{a\\in A}2d_{\\ell}\\right]^{1/2}}\\\\ &{<H\\sqrt{2K A d_{L}}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 48}, {"type": "text", "text": "Since $\\beta_{k,h}^{a}=c d H\\sqrt{\\imath}$ for some constant $c$ , from a union bound and the previous bounds, it follows that ", "page_idx": 48}, {"type": "equation", "text": "$$\nR e g r e t(K)\\leq2H\\sqrt{T\\iota}+\\beta_{k,h}^{a}H\\sqrt{2K A d\\iota}\\in\\tilde{O}(\\sqrt{d^{3}H^{3}A T}).\n$$", "text_format": "latex", "page_idx": 48}, {"type": "text", "text": "with probability at least $1-\\delta$ . ", "page_idx": 48}, {"type": "text", "text": "To use LSVI-UCB- $(S,d,A)$ in our transfer RL setting, we next show that it is robust to misspecification error. Similarly, we first prove the helper lemmas needed in the misspecified setting and follow the proof structure and techniques used in [17]. ", "page_idx": 48}, {"type": "text", "text": "Lemma 11. For a $\\xi$ -approximate $(S,d,A)$ Tucker rank MDP (Assumption 7), then for any policy $\\pi$ there exists corresponding weight vectors $\\{w_{h}^{a}\\}$ where $\\begin{array}{r}{w_{h}^{a}=W_{h}(a)^{*}+\\sum_{s^{\\prime}\\in\\mathcal{S}}V_{h+1}^{\\pi^{*}}(s^{\\prime})\\bar{U_{h}}(s^{\\prime},\\bar{a})}\\end{array}$ such that for all $(s,a)\\in S\\times A$ ", "page_idx": 48}, {"type": "equation", "text": "$$\n\\begin{array}{r}{|Q_{h}^{\\pi}(s,a)-F_{h}(s)w_{h}^{a\\top}|\\leq3H\\xi.}\\end{array}\n$$", "text_format": "latex", "page_idx": 48}, {"type": "text", "text": "Proof. Note that $\\begin{array}{r}{Q_{h}^{\\pi}(s,a)=r_{h}(s,a)+\\sum_{s^{\\prime}}V_{h+1}^{\\pi}(s^{\\prime})P_{h}(s^{\\prime}|s,a)}\\end{array}$ , so, using the low-rank representations of $r_{h},P_{h}$ , it follows that ", "page_idx": 49}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{|Q_{h}^{\\pi}(s,a)-F_{h}(s){w_{h}^{a}}^{\\top}|\\leq|r_{h}(s,a)-F_{h}(s)W_{h}(a)^{\\top}|}\\\\ &{\\qquad\\qquad\\qquad\\qquad+\\left|\\displaystyle\\sum_{s^{\\prime}}V_{h+1}^{\\pi}(s^{\\prime})P_{h}(s^{\\prime}|s,a)-F_{h}(s)\\displaystyle\\sum_{s^{\\prime}\\in\\mathcal{S}}V_{h+1}^{\\pi}(s^{\\prime})U_{h}(s^{\\prime},a)\\right|}\\\\ &{\\leq\\xi+2H\\xi}\\\\ &{\\leq3H\\xi}\\end{array}\n$$", "text_format": "latex", "page_idx": 49}, {"type": "text", "text": "Lemma 12. Suppose Assumption 7 holds. Let $\\{w_{h}^{a}\\}$ be the weight vector of some policy $\\pi_{.}$ , i.e., $Q_{h}^{\\pi}(s,a)=F_{h}(s)^{\\top}w_{h}^{a}$ . Then, ", "page_idx": 49}, {"type": "equation", "text": "$$\n\\lVert w_{h}^{a}\\rVert\\leq2H d.\n$$", "text_format": "latex", "page_idx": 49}, {"type": "text", "text": "Proof. Recall that $\\begin{array}{r}{w_{h}^{a}=W_{h}(a)+\\sum_{s^{\\prime}\\in\\mathcal{S}}V_{h+1}^{\\pi}(s^{\\prime})U_{h}(s^{\\prime},a)}\\end{array}$ . Since the feature mapping was scaled up $\\begin{array}{r}{(F_{h}=\\sqrt{\\frac{S}{d\\mu}}F^{\\prime})}\\end{array}$ to ensure the max entries of $F$ and $W,U$ are on the same scale, it follows that $\\|W_{h}(a)\\|_{2}\\leq1$ and $\\begin{array}{r}{\\|\\sum_{s^{\\prime}\\in S}V_{h+1}^{\\pi}(s^{\\prime})U_{h}(s^{\\prime},a)\\|_{2}\\le H}\\end{array}$ . Thus, $\\lVert w_{h}^{a}\\rVert_{2}\\leq2H d$ . \u53e3 ", "page_idx": 49}, {"type": "text", "text": "Similarly, we bound the stochastic noise but account for the misspecification error. ", "page_idx": 49}, {"type": "text", "text": "Lemma 13. Suppose Assumption 7 holds. Let $c_{m}^{\\prime}$ be the constant in the definition of $\\beta_{k,h}^{a}\\,=$ $c_{m}^{\\prime}H(d\\sqrt{\\iota}+\\xi\\sqrt{|T_{k,h}^{a}|d})$ . Then, there exists a constant $C>0$ that is independent of $c_{m}^{\\prime}$ such that for any $\\delta\\in(0,1)$ , if we let the event $\\mathcal{X}$ be ", "page_idx": 49}, {"type": "equation", "text": "$$\n\\langle(a,k,h)\\in\\mathcal{A}\\times[K]\\times[H]:\\qquad\\left\\|\\sum_{t\\in T_{h,k-1}^{a}}F_{h}(s_{h}^{t})(V_{h+1}^{t}(s_{h+1}^{t})-P_{h}V_{h+1}^{t}(s_{h}^{t},a)\\right\\|_{(\\Lambda_{h,t}^{a})^{-1}}\\leq C d H\\sqrt{M_{h+1}^{a}}.\n$$", "text_format": "latex", "page_idx": 49}, {"type": "text", "text": "where $\\chi=\\log(2(c_{m}^{\\prime}+1)d T A/\\delta)$ , then $\\mathbb{P}(\\boldsymbol{\\mathscr{X}})\\ge1-\\delta/2$ . ", "page_idx": 49}, {"type": "text", "text": "Proof. The proof is the same as the proof of Lemma 7 except we increase $\\beta_{k,h}^{a}$ to account for the misspecifiction error. Since $\\xi\\leq1$ by assumption, the modification to $\\beta_{k,h}^{a}$ only affects $C$ . \u53e3 ", "page_idx": 49}, {"type": "text", "text": "We next account for the noise being adversarial due to the misspecification error. ", "page_idx": 49}, {"type": "text", "text": "Lemma 14. Let $\\left\\{\\epsilon_{t}\\right\\}$ be any sequence such that $|\\epsilon_{\\tau}|\\le B$ for any $t$ . Then, for any $(h,k,a)\\in$ $[H]\\times[K]\\times A$ and $F\\in\\mathbb{R}^{d}$ , we have ", "page_idx": 49}, {"type": "equation", "text": "$$\n|F^{\\top}(\\Lambda_{k,h}^{a})^{-1}\\sum_{t\\in T_{k-1,h}^{a}}F_{h}(s_{h}^{t})\\epsilon_{t}|\\leq B\\sqrt{d|T_{k-1,h}^{a}|F^{\\top}(\\Lambda_{k,h}^{a})^{-1}F}.\n$$", "text_format": "latex", "page_idx": 49}, {"type": "text", "text": "Proof. From the Cauchy-Schwarz inequality and Elliptical Potential Lemma (Lemma D.1 [17]), we have ", "page_idx": 49}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{F^{\\top}(\\Lambda_{k,h}^{a})^{-1}\\displaystyle\\sum_{t\\in T_{k-1,h}^{a}}F_{h}(s_{h}^{t})\\epsilon_{t}|\\leq B\\sqrt{\\left(\\displaystyle\\sum_{t\\in T_{k-1,h}^{a}}F^{\\top}(\\Lambda_{k,h}^{a})^{-1}F\\right)\\left(\\displaystyle\\sum_{t\\in T_{k-1,h}^{a}}F_{h}(s_{h}^{t})^{\\top}(\\Lambda_{k,h}^{a})^{-1}F_{h}(s_{h}^{t})\\right)}}&{{}\\mathrm{~a~n~d~}\\mathrm{F~}_{k,h}^{a}\\leq F^{\\top}(\\Lambda_{k,h}^{a})^{-1}F,}\\\\ {\\leq B\\sqrt{d|T_{k-1,h}^{a}|F^{\\top}(\\Lambda_{k,h}^{a})^{-1}F}.}&{{}}\\end{array}\n$$", "text_format": "latex", "page_idx": 49}, {"type": "text", "text": "Next, we bound the error between a policies $Q$ function and our low-rank estimate. ", "page_idx": 49}, {"type": "text", "text": "Lemma 15. There exists a constant $c_{m}^{\\prime}$ such that $\\beta_{k,h}^{a}\\,=\\,c_{m}^{\\prime}H(d\\sqrt{\\iota}+\\xi\\sqrt{|T_{k,h}^{a}|d})$ where $\\iota=$ $\\log(2d A T/p)$ and for any fixed policy $\\pi$ , on the event $\\mathcal{X}$ defined in Lemma $^{13}$ , we have for all $(s,a,h,k)\\in\\mathcal{S}\\times\\mathcal{A}\\times[H]\\times[K]$ : ", "page_idx": 50}, {"type": "equation", "text": "$$\n\\begin{array}{r}{F_{h}(s)^{\\top}w_{h,k}^{a}-Q_{h}^{\\pi}(s,a)=P_{h}(V_{h+1}^{k}-V_{h+1}^{\\pi})(s,a)+\\Delta_{h}^{k}(s,a),}\\\\ {\\mathrm{s}_{h}^{k}(s,a)|\\leq\\beta_{k,h}^{a}\\sqrt{F_{h}(s)^{\\top}(\\Lambda_{h,k}^{a})^{-1}F_{h}(s)}+4H\\xi.\\qquad\\qquad\\qquad\\qquad}\\end{array}\n$$", "text_format": "latex", "page_idx": 50}, {"type": "text", "text": "Proof. From Lemma 12, it follows that there exists a weight vector $\\begin{array}{r l r}{w_{h}^{a}}&{{}=}&{W_{h}(a)\\ +}\\end{array}$ $\\begin{array}{r}{\\sum_{s^{\\prime}\\in\\mathcal{S}}V_{h+1}^{\\pi}(s^{\\prime})U_{h}(s^{\\prime},a)}\\end{array}$ , such that for all $(s,a)\\in S\\times A$ , ", "page_idx": 50}, {"type": "equation", "text": "$$\n\\begin{array}{r}{|Q_{h}^{\\pi}(s,a)-F_{h}(s)^{\\top}w_{h}^{a}|\\leq2H\\xi.}\\end{array}\n$$", "text_format": "latex", "page_idx": 50}, {"type": "text", "text": "Let $\\Tilde{P}(\\cdot|s,a)=F_{h}(s)^{\\top}U_{h}(\\cdot,a)$ , so we have for any $(s,a)\\in S\\times A,F_{h}(s)^{\\top}w_{h}^{a}=F_{h}(s)^{\\top}W_{h}(a)+$ $\\tilde{P}V_{h+1}^{\\pi}(s,a)$ . Therefore, ", "page_idx": 50}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{w_{h,k}^{a}-w_{h}^{a,\\pi}=-\\lambda(\\Lambda_{h,k}^{a})^{-1}w_{h}^{a,\\pi}}\\\\ &{\\quad\\quad\\quad\\quad+(\\Lambda_{h,k}^{a})^{-1}\\displaystyle\\sum_{t\\in T_{k-1,h}^{a}}F_{h}(s_{h}^{t})(V_{h+1}^{k}(s_{h+1}^{t})-P_{h}V_{h+1}^{k}(s_{h}^{t},a)}\\\\ &{\\quad\\quad\\quad\\quad+(\\Lambda_{h,k}^{a})^{-1}\\displaystyle\\sum_{t\\in T_{k-1,h}^{a}}F_{h}(s_{h}^{t})\\tilde{P}_{h}(V_{h+1}^{k}-V_{h+1}^{\\pi})(s_{h}^{t},a)}\\\\ &{\\quad\\quad\\quad\\quad+(\\Lambda_{h,k}^{a})^{-1}\\displaystyle\\sum_{t\\in T_{k-1,h}^{a}}F_{h}(s_{h}^{t})\\left(r_{h}(s_{h}^{t},a)-F_{h}(s_{h}^{t})W_{h}(a)+(P_{h}-\\tilde{P}_{h})V_{h+1}^{k}(s_{h}^{t},a)\\right)}\\end{array}\n$$", "text_format": "latex", "page_idx": 50}, {"type": "text", "text": "Now, we bound each of the four terms above $(q_{1}^{a},q_{2}^{a},q_{3}^{a},q_{4}^{a})$ individually, for the first term, note for all $a\\in{\\mathcal{A}}$ ", "page_idx": 50}, {"type": "equation", "text": "$$\n|F_{h}(s)^{\\top}q_{1}^{a}|=|\\lambda F_{h}(s)^{\\top}(\\Lambda_{h,k}^{a})^{-1}w_{h}^{a,\\pi}|\\leq\\sqrt{\\lambda}\\|w_{h}^{a,\\pi}\\|\\sqrt{F_{h}(s)^{\\top}(\\Lambda_{h,k}^{a})^{-1}F_{h}(s)}\n$$", "text_format": "latex", "page_idx": 50}, {"type": "text", "text": "For the second term, given the event $\\mathcal{X}$ , we have from Cauchy Schwarz ", "page_idx": 50}, {"type": "equation", "text": "$$\n|F_{h}(s)^{\\top}q_{2}^{a}|\\leq C d H\\sqrt{\\chi}\\sqrt{F_{h}(s)^{\\top}(\\Lambda_{h,k}^{a})^{-1}F_{h}(s)}\n$$", "text_format": "latex", "page_idx": 50}, {"type": "text", "text": "where $\\chi=\\log(2(c_{\\beta}+1)d T A/p)$ . For the third term, ", "page_idx": 50}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{F_{h}(s)^{\\top}q_{3}^{a}=F_{h}(s)^{\\top}\\left((\\Lambda_{h,k}^{a})^{-1}\\displaystyle\\sum_{t\\in T_{k-1,h}^{a}}F_{h}(s_{h}^{t})\\bar{P}_{h}(V_{h+1}^{k}-V_{h+1}^{\\pi})(s_{h}^{t},a)\\right)}\\\\ &{\\phantom{F_{h}(s)^{\\top}\\tau_{3}^{a}}=F_{h}(s)^{\\top}\\left((\\Lambda_{h,k}^{a})^{-1}\\displaystyle\\sum_{t\\in T_{k-1,h}^{a}}F_{h}(s_{h}^{t})F_{h}(s_{h}^{t})^{\\top}\\displaystyle\\sum_{s^{\\prime}\\in S}(V_{h+1}^{k}-V_{h+1}^{\\pi})(s^{\\prime})U_{h}(s^{\\prime},a)\\right)}\\\\ &{\\phantom{F_{h}(s)^{\\top}\\tau_{3}^{a}}=F_{h}(s)^{\\top}\\left(\\displaystyle\\sum_{s^{\\prime}\\in S}(V_{h+1}^{k}-V_{h+1}^{\\pi})(s^{\\prime})U_{h}(s^{\\prime},a)\\right)}\\\\ &{\\phantom{F_{h}(s)^{\\top}\\tau_{3}^{a}}-\\lambda F_{h}(s)^{\\top}\\left((\\Lambda_{h,k}^{a})^{-1}\\displaystyle\\sum_{s^{\\prime}\\in S}(V_{h+1}^{k}-V_{h+1}^{\\pi})(s^{\\prime})U_{h}(s^{\\prime},a)\\right),}\\end{array}\n$$", "text_format": "latex", "page_idx": 50}, {"type": "text", "text": "and note that ", "page_idx": 50}, {"type": "equation", "text": "$$\nF_{h}(s)^{\\top}\\left(\\sum_{s^{\\prime}\\in\\mathcal{S}}(V_{h+1}^{k}-V_{h+1}^{\\pi})(s^{\\prime})U_{h}(s^{\\prime},a)\\right)=\\tilde{P}_{h}(V_{h+1}^{k}-V_{h+1}^{\\pi})(s,a)\n$$", "text_format": "latex", "page_idx": 50}, {"type": "text", "text": "and ", "page_idx": 50}, {"type": "equation", "text": "$$\n|\\lambda F_{h}(s)^{\\top}\\left((\\Lambda_{h,k}^{a})^{-1}\\sum_{s^{\\prime}\\in\\mathcal{S}}(V_{h+1}^{k}-V_{h+1}^{k})(s^{\\prime})U_{h}(s^{\\prime},a)\\right)|\\leq2H\\sqrt{d\\lambda}\\sqrt{F_{h}(s)^{\\top}(\\Lambda_{h,k}^{a})^{-1}F_{h}(s)}.\n$$", "text_format": "latex", "page_idx": 50}, {"type": "text", "text": "Since $\\|\\tilde{P}_{h}(\\cdot|s,a)-P_{h}(\\cdot|s,a)\\|_{\\infty}\\leq1$ for all $(s,a)\\in S\\times A$ , it follows that ", "page_idx": 51}, {"type": "equation", "text": "$$\n\\begin{array}{r}{|\\tilde{P}_{h}(V_{h+1}^{k}-V_{h+1}^{\\pi})(s,a)-P_{h}(V_{h+1}^{k}-V_{h+1}^{\\pi})(s,a)|\\le|(\\tilde{P}_{h}-P_{h})(V_{h+1}^{k}-V_{h+1}^{\\pi})(s,a)|\\le2H\\xi.}\\end{array}\n$$", "text_format": "latex", "page_idx": 51}, {"type": "text", "text": "From Lemma 14, we have $|F_{h}(s),q_{4}^{a}|\\leq2H\\xi\\sqrt{d|T_{k,h}^{a}|F_{h}(s)^{\\top}(\\Lambda_{h,k}^{-1})^{-1}F_{h}(s)}$ . Since ", "page_idx": 51}, {"type": "equation", "text": "$$\n\\begin{array}{r}{|F_{h}(s)^{\\top}w_{h,k}^{a}-Q_{h}^{\\pi}(s,a)|=F_{h}(s)^{\\top}(w_{h,k}^{a}-w_{h}^{a,\\pi})=F_{h}(s)^{\\top}(q_{1}^{a}+q_{2}^{a}+q_{3}^{a}+q_{4}^{a}),}\\end{array}\n$$", "text_format": "latex", "page_idx": 51}, {"type": "text", "text": "it follows that ", "page_idx": 51}, {"type": "text", "text": "| $F_{h}(s)^{\\top}w_{h,k}^{a}-Q_{h}^{\\pi}(s,a)-P_{h}(V_{h+1}^{k}-V_{h+1}^{\\pi})(s,a)|\\leq\\sqrt{\\chi}(C^{\\circ}d\\sqrt{\\chi}+2\\xi\\sqrt{|T_{k,h}^{a}|^{d}})H\\sqrt{F_{h}(s)^{\\top}(\\Lambda_{h,k}^{a})^{-1}(\\Lambda_{h,k}^{a})^{-1}}\\,.$ 1Fh(s)+4H\u03be. Similarly as in [17], we choose $c_{\\beta}$ that satisfies $C^{\\prime\\prime}{\\sqrt{\\log(2)+\\log(c_{\\beta}+1)}}\\leq c_{\\beta}{\\sqrt{\\log(2)}}$ \uff0e\u53e3 ", "page_idx": 51}, {"type": "text", "text": "Now, we prove that $Q_{h}^{k}$ is an upperbound of $Q_{h}^{*}$ conditioned on the event in Lemma 13. ", "page_idx": 51}, {"type": "text", "text": "Lemma 16. Suppose Assumption 7 holds. On the event $\\mathcal{X}$ defined in lemma $^{l3}$ , we have $Q_{h}^{k}(s,a)\\geq$ $Q_{h}^{*}(s,a)-4H\\bar{(H+1-h)}\\bar{\\xi}$ for all $(s,a,h,k)\\in\\mathcal{S}\\times\\mathcal{A}\\times[H]\\times[K]$ . ", "page_idx": 51}, {"type": "text", "text": "Proof. We prove this with induction. The base case holds because at step $H+1$ , the value function is zero, so from Lemma 15, ", "page_idx": 51}, {"type": "equation", "text": "$$\n|F_{H}(s)^{\\top}w_{H,k}^{a}-Q_{H}^{*}(s,a)|\\leq\\beta_{k,h}^{a}\\sqrt{F_{H}(s)^{\\top}(\\Lambda_{H,k}^{a})^{-1})F_{H}(s)}+4H\\xi\n$$", "text_format": "latex", "page_idx": 51}, {"type": "text", "text": "and thus, ", "page_idx": 51}, {"type": "equation", "text": "$$\nQ_{H}^{*}(s,a)-4H\\xi\\leq\\operatorname*{min}\\Big(H,F_{H}(s)^{\\top}w_{H,k}^{a}+\\beta_{k,h}^{a}\\sqrt{F_{H}(s)^{\\top}(\\Lambda_{H,k}^{a})^{-1})F_{H}(s)}\\Big)=Q_{H}^{k}(s,a).\n$$", "text_format": "latex", "page_idx": 51}, {"type": "text", "text": "From the inductive hypothesis (assuming that $Q_{h+1}^{k}(s,a)\\ \\geq\\ Q_{h+1}^{*}(s,a)\\ -\\ 4H(H\\ -\\ h)\\xi)$ , it follows that $P_{h}(V_{h+1}^{k}\\,-\\,V_{h+1}^{*})(s,a)\\ \\geq\\ -4\\xi$ . From Lemma 15, $F_{h}(s)^{\\top}w_{h,k}^{a}\\,-\\,Q_{h}^{*}(s,a)\\ \\leq$ $\\beta_{k,h}^{a}\\sqrt{F_{h}(s)^{\\top}(\\Lambda_{h,k}^{a})^{-1})F_{h}(s)}+4H\\xi$ . It follows that ", "page_idx": 51}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!2_{h}^{*}(s,a)\\!-\\!4H(H\\!-\\!h\\!+\\!\\!1)\\xi\\leq\\operatorname*{min}\\Big(H,F_{h}(s)^{\\top}w_{h,k}^{a}+\\beta_{k,h}^{a}\\sqrt{F_{h}(s)^{\\top}(\\Lambda_{h,k}^{a})^{-1})F_{h}(s)}\\Big)=Q_{h}^{k}(s,a).}\\end{array}\n$$", "text_format": "latex", "page_idx": 51}, {"type": "text", "text": "This completes the proof. ", "page_idx": 51}, {"type": "text", "text": "Similarly, to the regular case, the gap in the misspecified setting has a recursive formula. ", "page_idx": 51}, {"type": "text", "text": "Lemma 17. Let $\\delta_{h}^{k}=V_{h}^{k}(s_{h}^{k})-V_{h}^{\\pi_{k}}(s_{h}^{k})$ and $\\xi_{h+1}^{k}=\\mathbb{E}[\\delta_{h+1}^{k}|s_{h}^{k},a_{h}^{k}]-\\delta_{h+1}^{k}$ . Then, on the event defined in Lemma $^{l3}$ , we have for any $(h,k)$ : ", "page_idx": 51}, {"type": "equation", "text": "$$\n\\delta_{h}^{k}\\leq\\delta_{h+1}^{k}+\\xi_{h+1}^{k}+\\beta_{k,h}^{a}\\sqrt{F_{h}(s_{h}^{k})^{\\top}(\\Lambda_{h,k}^{a_{h}^{k}})^{-1}F_{h}(s_{h}^{k})}+4H\\xi\n$$", "text_format": "latex", "page_idx": 51}, {"type": "text", "text": "Proof. From Lemma 15, we have for any $(s,a,h,k)$ that ", "page_idx": 51}, {"type": "equation", "text": "$$\nQ_{h}^{k}(s,a)-Q_{h}^{\\pi_{k}}(s,a)\\leq P_{h}(V_{h+1}^{k}-V_{h+1}^{\\pi_{k}})(s,a)+\\beta_{k,h}^{a}\\sqrt{F_{h}(s)^{\\top}(\\Lambda_{h,k}^{a})^{-1}F_{h}(s)}+4H\\xi.\n$$", "text_format": "latex", "page_idx": 51}, {"type": "text", "text": "From the definition of $V^{\\pi_{k}}$ , we have ", "page_idx": 51}, {"type": "equation", "text": "$$\n\\delta_{h}^{k}=Q_{h}^{k}(s_{h}^{k},a_{h}^{k})-Q_{h}^{\\pi_{k}}(s_{h}^{k},a_{h}^{k}),\n$$", "text_format": "latex", "page_idx": 51}, {"type": "text", "text": "and substituting this into the first equation finishes the proof. ", "page_idx": 51}, {"type": "text", "text": "Finally, we prove the main result in the misspecified setting Theorem 9. ", "page_idx": 51}, {"type": "text", "text": "Proof. Suppose that the Assumptions required in Theorem 9 hold. We condition on the event $\\mathcal{X}$ from Lemma 13 with $p=\\delta/2$ and use the notation for $\\delta_{h}^{k},\\xi_{h}^{k}$ as in Lemma 17. From Lemma 16, we have $Q_{1}^{k}(s,a)\\geq Q_{1}^{*}(s,a)-4H^{2}\\xi$ , which implies $V_{1}^{*}(\\stackrel{..}{s})\\stackrel{...}{-}V_{1}^{\\pi_{k}}(s)\\leq\\delta_{1}^{k}+4H^{2}\\xi$ . Thus, from Lemma 15, on the event $\\mathcal{X}$ , it follows that ", "page_idx": 52}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{R e g r e t(K)=\\displaystyle\\sum_{k=1}^{K}(V_{1}^{*}(s_{1}^{k})-V_{1}^{\\pi_{k}}(s_{1}^{k}))\\le\\displaystyle\\sum_{k=1}^{K}\\delta_{1}^{k}+4H^{2}\\xi}\\\\ &{\\qquad\\qquad\\le\\displaystyle\\sum_{k\\in[K]}\\sum_{h\\in[H]}\\xi_{h}^{k}+\\displaystyle\\sum_{k\\in[K]}\\beta_{k,h}^{a}\\displaystyle\\sum_{h\\in[H]}\\sqrt{F_{h}(s_{h}^{k})^{\\top}(\\Lambda_{h,k}^{a_{h}^{k}})^{-1}F_{h}(s_{h}^{k})}+4H T\\xi}\\end{array}\n$$", "text_format": "latex", "page_idx": 52}, {"type": "text", "text": "since $H K=T$ . Since the observations at episode $k$ are independent of the computed value function (this uses the trajectories from episodes 1 to $k-1$ , it follows $\\displaystyle\\{\\xi_{h}^{k}\\}$ is a martingale difference sequence with $|\\xi_{h}^{k}|\\leq2H$ for all $(k,h)$ . Thus, from the Azuma Hoeffding inequality, we have ", "page_idx": 52}, {"type": "equation", "text": "$$\n\\sum_{k\\in[K],h\\in H}\\xi_{h}^{k}\\leq\\sqrt{2T H^{2}\\log(2/p)}\\leq2H\\sqrt{T\\iota}\n$$", "text_format": "latex", "page_idx": 52}, {"type": "text", "text": "with probability at least $1-\\delta/2$ . By construction of $\\beta_{k,h}^{a}$ , we have ", "page_idx": 52}, {"type": "equation", "text": "$$\n\\begin{array}{r l r}{\\lefteqn{\\sum_{k\\in[K]}\\beta_{k,h}^{a}\\sqrt{F_{h}(s_{h}^{k})^{\\top}(\\Lambda_{h,k}^{a_{h}^{k}})^{-1}F_{h}(s_{h}^{k})}\\le C H(\\sum_{k\\in[K]}d\\sqrt{\\iota}\\sqrt{F_{h}(s_{h}^{k})^{\\top}(\\Lambda_{h,k}^{a_{h}^{k}})^{-1}F_{h}(s_{h}^{k})}}}\\\\ &{}&{\\qquad+\\sum_{k\\in[K]}\\xi\\sqrt{|T_{k,h}^{a}|d}\\sqrt{F_{h}(s_{h}^{k})^{\\top}(\\Lambda_{h,k}^{a_{h}^{k}})^{-1}F_{h}(s_{h}^{k})}).}\\end{array}\n$$", "text_format": "latex", "page_idx": 52}, {"type": "text", "text": "From the Cauchy-Schwarz inequality, it follows that ", "page_idx": 52}, {"type": "equation", "text": "$$\n\\sum_{k\\in[K]}\\sqrt{F_{h}(s_{h}^{k})^{\\top}({\\Lambda}_{h,k}^{a_{h}^{k}})^{-1}F_{h}(s_{h}^{k})}\\le\\left(\\sqrt{K}\\right)\\left(\\sqrt{\\sum_{k\\in[K]}F_{h}(s_{h}^{k})^{\\top}({\\Lambda}_{h,k}^{a_{h}^{k}})^{-1}F_{h}(s_{h}^{k})}\\right).\n$$", "text_format": "latex", "page_idx": 52}, {"type": "text", "text": "Since the minimum eigenvalue of \u039bah,hk is at least one by construction and $\\|F_{h}(s)\\|\\leq1$ , from the Elliptical Potential Lemma (Lemma D.2 [17]), we have for all $a\\in A$ and $h\\in[H]$ , ", "page_idx": 52}, {"type": "equation", "text": "$$\n\\sum_{k=1}^{K}F_{h}(s_{k})^{\\top}(\\Lambda_{h,k}^{a})^{-1}F_{h}(s_{k})\\le2\\log(d e t(\\Lambda_{h,k+1}^{a})/d e t(\\Lambda_{h,0}^{a}))\n$$", "text_format": "latex", "page_idx": 52}, {"type": "text", "text": "Furthermore, we have $\\begin{array}{r}{\\|\\Lambda_{h,k+1}^{a}\\|=\\|\\sum_{t\\in T_{K,h}^{a}}F_{h}(s_{h}^{t})F_{h}(s_{h}^{t})^{\\top}+\\lambda I\\|\\leq\\lambda+|T_{K,h}^{a}|\\leq\\lambda+K}\\end{array}$ . It follows that ", "page_idx": 52}, {"type": "equation", "text": "$$\n\\sum_{k=1}^{K}F_{h}(s_{k})^{\\top}(\\Lambda_{h,k}^{a})^{-1}F_{h}(s_{k})\\le2d\\log(1+K/\\lambda)\\le2d\\iota,\n$$", "text_format": "latex", "page_idx": 52}, {"type": "text", "text": "so grouping the episodes by actions gives ", "page_idx": 52}, {"type": "equation", "text": "$$\n\\left[\\sum_{k\\in[K]}F_{h}(s_{h}^{k})^{\\top}(\\Lambda_{h,k}^{a_{h}^{k}})^{-1}F_{h}(s_{h}^{k})\\right]^{1/2}=\\left[\\sum_{a\\in A}\\sum_{t\\in T_{K,h,a}}F_{h}(s_{h}^{t})^{\\top}(\\Lambda_{h,t}^{a})^{-1}F_{h}(s_{h}^{t})\\right]^{1/2}\\leq\\sqrt{2d A t}.\n$$", "text_format": "latex", "page_idx": 52}, {"type": "text", "text": "For the next term, let $k_{a,i}$ refer to the episode in which action $a$ was taken at time step $h$ for the $i$ th time. Then, we first re-index the summation and then use the Cauchy-Schwarz inequality to get ", "page_idx": 53}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{\\underset{k\\in[K]}{\\sum}\\sqrt{|T_{k,h}^{a}|}\\sqrt{F_{h}(s_{h,k}^{k})^{\\top}(\\Lambda_{h,k}^{a_{k}^{k}})^{-1}F_{h}(s_{h}^{k})})=\\underset{a\\in A}{\\sum}\\underset{i=1}{\\overset{|T|_{k,h}^{a}|}{\\sum}}\\sqrt{i}\\sqrt{F_{k,a_{i},h}^{\\top}(\\Lambda_{k_{a,i},h}^{a})^{-1}F_{k_{a,i},h}}}\\\\ {\\le}&{\\underset{a\\in A}{\\sum}\\Bigg(\\underset{i=1}{\\overset{|T|_{k,h}^{a}|}{\\sum}}i\\Bigg)^{1/2}\\Bigg(\\underset{\\iota\\in T_{k,h}^{a}}{\\sum}F_{t,h}^{\\top}(\\Lambda_{t,h}^{a})^{-1}F_{t,h}\\Bigg)^{1/2}}\\\\ &{\\le C^{\\prime}\\underset{a\\in A}{\\sum}|T_{k,h}^{a}|\\left(\\underset{\\iota\\in T_{k,h}^{a}}{\\sum}F_{t,h}^{\\top}(\\Lambda_{t,h}^{a})^{-1}F_{t,h}\\right)^{1/2}}\\\\ &{\\le C_{\\quad a\\in A}^{\\prime}|T_{k,h}^{a}|\\sqrt{2d},}\\end{array}\n$$", "text_format": "latex", "page_idx": 53}, {"type": "text", "text": "where the last inequality comes from holds from the above elliptical potential lemma. Applying the results to the initial inequality, we have ", "page_idx": 53}, {"type": "equation", "text": "$$\n\\sum_{\\in[K]}\\beta_{k,h}^{a}\\sqrt{F_{h}(s_{h}^{k})^{\\top}(\\Lambda_{h,k}^{a_{h}^{k}})^{-1}F_{h}(s_{h}^{k})}\\le C H(\\sqrt{2d^{3}A K\\iota^{2}}+\\xi\\sqrt{d}C^{\\prime}\\sum_{a\\in A}|T_{K,h}^{a}|\\sqrt{2d})\\le C(\\sqrt{2d^{3}A H}\\operatorname*{sup}(\\sqrt{2d^{3}A M\\iota^{2}})).\n$$", "text_format": "latex", "page_idx": 53}, {"type": "text", "text": "Substituting these results into the original regret bound gives ", "page_idx": 53}, {"type": "equation", "text": "$$\nR e g r e t(K)\\leq C^{\\prime\\prime\\prime}(\\sqrt{d^{3}H^{3}A T{\\iota}^{2}}+d T H\\xi\\sqrt{{\\iota}}).\n$$", "text_format": "latex", "page_idx": 53}, {"type": "text", "text": "for some constant $C^{\\prime\\prime\\prime}>0$ with probability at least $1-\\delta$ . ", "page_idx": 53}, {"type": "text", "text": "J.2 LSVI-UCB-(S, S, d) ", "text_level": 1, "page_idx": 53}, {"type": "text", "text": "We reiterate that the steps and analysis in this subsection are essentially the same as the proofs in [17], except we have $S$ copies of the weight vectors and gram matrices. The results and proofs follow the same structure and logic as in The proof of all the theorems and lemmas follow the same steps as the proofs for the analogous result in the $(S,d,A)$ setting except we replace $F(s)$ with $G(a)$ and estimate the Gram matrix and weight vectors for each state instead of each action. ", "page_idx": 53}, {"type": "text", "text": "To prove Theorem 5, we first introduce notation used throughout this section and then present auxiliary lemmas. We let $\\Lambda_{h,k}^{s},w_{h,k}^{s},Q_{h}^{k},V_{h}^{k},\\pi^{k}$ as the parameters/estimates at episode $k$ . Furthermore, let $V_{h}^{k}=\\operatorname*{max}_{s\\in S}Q_{h}^{k}(s,a)$ and $\\pi^{k}$ be the greedy policy w.r.t. $Q_{h}^{k}$ . We let $G_{h}^{k}:=G_{h}(a_{h}^{k})$ . ", "page_idx": 53}, {"type": "text", "text": "We first bound the log of the covering number of our function class for the value function to control the error of our algorithm\u2019s estimate, which allows us to prove our concentration result as the value function estimate is not constant. ", "page_idx": 53}, {"type": "text", "text": "Lemma 18. Let $\\mathcal{V}$ denote a function class of mappings from $\\boldsymbol{S}$ to $\\mathbb{R}$ with the following parametric form for all $s\\in S$ ", "page_idx": 53}, {"type": "equation", "text": "$$\nV(s)=\\operatorname*{min}\\left\\{\\operatorname*{max}_{a\\in A}w_{s}^{\\top}G(a)+\\beta\\sqrt{G(a)^{\\top}\\Lambda_{s}^{-1}G(a)},H\\right\\}\n$$", "text_format": "latex", "page_idx": 53}, {"type": "text", "text": "where the parameters $w_{s},\\beta,\\Lambda_{s}$ satisfy $\\|w_{s}\\|\\leq L$ for all $s\\ \\in{\\mathcal{S}}_{}$ , $\\beta\\\\,\\in\\,[0,B].$ , and the minimum eigenvalue of $\\Lambda_{s}$ is greater than $\\lambda.$ . Assume that $\\|G(a)\\|\\leq1$ for all $s\\ \\in\\ S$ , and let $\\mathcal{N}_{\\epsilon}$ be the $\\epsilon$ -covering number of $\\nu$ with respect to the distance $d i s t(\\dot{V},V^{\\prime})=\\operatorname*{sup}_{s}|V(s)-V^{\\prime}(s)|$ . Then, ", "page_idx": 53}, {"type": "equation", "text": "$$\n\\log(\\mathcal{N}_{\\epsilon})\\leq d\\log(1+4L/\\epsilon)+d^{2}\\log(1+8d^{1/2}B^{2}/(\\lambda\\epsilon^{2}))\n$$", "text_format": "latex", "page_idx": 53}, {"type": "text", "text": "Proof. Equivalently, we reparameterize the function class by $D_{s}=\\beta^{2}\\Lambda_{s}^{-1}$ , for all $s\\in S$ ", "page_idx": 53}, {"type": "equation", "text": "$$\nV(s)=\\operatorname*{min}{\\left\\{\\operatorname*{max}_{a\\in{\\mathcal{A}}}w_{s}^{\\top}G(a)+\\sqrt{G(a)^{\\top}D_{s}G(a)},H\\right\\}}\n$$", "text_format": "latex", "page_idx": 53}, {"type": "text", "text": "where $\\|w_{s}\\|\\leq L$ and $\\|D_{s}\\|\\,\\le\\,B^{2}/\\lambda$ for all $s\\ \\in{\\cal S}$ . For any $V_{1},V_{2}\\,\\in\\,\\mathcal{V}$ , let them take the form in the above equation with parameters $(w_{s},D_{s})$ and $(w_{s^{\\prime}},D_{s^{\\prime}})$ . Since $\\operatorname*{min}(\\cdot,H)$ and $\\operatorname*{max}_{s\\in S}$ are contraction maps, ", "page_idx": 54}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{d i s t(V_{1}-V_{2})\\leq\\underset{s,a}{\\operatorname*{sup}}\\,|(w_{s}^{\\top}G(a)+\\sqrt{G(a)^{\\top}D_{s}G(a)})-(w_{s^{\\prime}}^{\\top}G(a)+\\sqrt{G(a)^{\\top}D_{s^{\\prime}}G(a)})|}\\\\ &{\\qquad\\qquad\\leq\\underset{s,G\\setminus\\|G\\|\\leq1}{\\operatorname*{sup}}\\,|(w_{s}^{\\top}G+\\sqrt{G^{\\top}D_{s}G})-(w_{s^{\\prime}}^{\\top}G+\\sqrt{G^{\\top}D_{s^{\\prime}}G})|}\\\\ &{\\qquad\\qquad\\leq\\underset{s\\in S}{\\operatorname*{max}}\\left[\\underset{G:\\|G\\|\\leq1}{\\operatorname*{sup}}\\,|(w_{s}-w_{s^{\\prime}})^{\\top}G|+\\underset{G:\\|G\\|\\leq1}{\\operatorname*{sup}}\\,|\\sqrt{G^{\\top}(D_{s}-D_{s^{\\prime}})G}|\\right]}\\\\ &{\\qquad\\qquad\\leq\\underset{s\\in S}{\\operatorname*{max}}\\left[\\|w_{s}-w_{s^{\\prime}}\\|+\\sqrt{\\|D_{s}-D_{s^{\\prime}}\\|}\\right]\\leq\\underset{s\\in S}{\\operatorname*{max}}\\left[\\|w_{s}-w_{s^{\\prime}}\\|+\\sqrt{\\|D_{s}-D_{s^{\\prime}}\\|_{F}}\\right]}\\end{array}\n$$", "text_format": "latex", "page_idx": 54}, {"type": "text", "text": "where the third inequality holds because $|{\\sqrt{x}}-{\\sqrt{y}}|\\,\\leq\\,{\\sqrt{|x-y|}}$ for any $x,y\\ \\geq\\ 0$ . Let $C_{w}$ be an $\\epsilon/2$ -cover of $\\{w\\,\\in\\,\\mathbb{R}^{d}|\\|w\\|\\,\\leq\\,L\\}$ with respect to the 2-norm, and $C_{D}$ be an $\\epsilon^{2}/4$ -cover of $\\{D\\in\\mathbb{R}^{d\\times d}|\\|D\\|_{F}\\leq d^{1/2}B^{2}/\\lambda\\}$ with respect to the Frobenius norm. By Lemma D.5 from [17], we know that, ", "page_idx": 54}, {"type": "equation", "text": "$$\n|C_{w}|\\leq(1+4L/\\epsilon)^{d},\\quad|C_{D}|\\leq(1+8d^{1/2}B^{2}/(\\lambda\\epsilon^{2}))^{d^{2}}.\n$$", "text_format": "latex", "page_idx": 54}, {"type": "text", "text": "Hence, for any $V_{1}$ , there exists a $w_{s^{\\prime}}\\in C_{w}$ and $D_{s^{\\prime}}\\in C_{D}$ for all $a\\in A$ such that $V_{2}$ parameterized by $(w_{s^{\\prime}},D_{s^{\\prime}})$ satisfies $d i s t(V_{1},V_{2})\\leq\\epsilon$ . Hence, $\\mathcal{N}_{\\epsilon}\\leq|C_{w}||C_{D}|$ , which gives: ", "page_idx": 54}, {"type": "equation", "text": "$$\n\\log(\\mathcal{N}_{\\epsilon})\\leq\\log(|C_{w}|)+\\log(|C_{D}|)\\leq d\\log(1+4\\epsilon L/\\epsilon)+d^{2}\\log(1+8d^{1/2}B^{2}/(\\lambda\\epsilon^{2})).\n$$", "text_format": "latex", "page_idx": 54}, {"type": "text", "text": "We next bound the $\\ell_{2}$ -norm of the weight vector of any policy. ", "page_idx": 54}, {"type": "text", "text": "Lemma 19. Let $\\{w_{h}^{s}\\}$ be the weight vector of some policy $\\pi$ , i.e., $Q_{h}^{\\pi}(s,a)=G_{h}(a)^{\\top}w_{h}^{s}$ . Then, ", "page_idx": 54}, {"type": "equation", "text": "$$\n\\|w_{h}^{s}\\|\\leq2H{\\sqrt{d}}.\n$$", "text_format": "latex", "page_idx": 54}, {"type": "text", "text": "Proof. Note that $\\begin{array}{r}{Q_{h}^{\\pi}(s,a)=r_{h}(s,a)+\\sum_{s^{\\prime}}V_{h+1}^{\\pi}(s^{\\prime})P_{h}(s^{\\prime}|s,a)}\\end{array}$ , so, using the low-rank representations of $r_{h},P_{h}$ , it follows that ", "page_idx": 54}, {"type": "equation", "text": "$$\n\\|w_{h}^{s}\\|_{2}=\\|W_{h}(s,\\cdot)+\\sum_{s^{\\prime}}V^{\\pi}(s^{\\prime})U_{h}(s^{\\prime},s,\\cdot)\\|_{2}\\leq\\|W_{h}(s,\\cdot)\\|_{2}+\\|\\sum_{s^{\\prime}}V^{\\pi}(s^{\\prime})U_{h}(s^{\\prime},s,\\cdot)\\|_{2}.\n$$", "text_format": "latex", "page_idx": 54}, {"type": "text", "text": "Recall that since the feature mapping was scaled up $\\begin{array}{r}{(G_{h}=\\sqrt{\\frac{A}{d\\mu}}G^{\\prime})}\\end{array}$ to ensure the max entries of $G$ and $W,U$ are on the same scale, it follows t\u221ahat $\\lVert W_{h}(s)\\rVert_{2}\\leq1$ and $\\begin{array}{r}{\\|\\sum_{s^{\\prime}\\in\\mathcal{S}}V_{h+1}^{\\pi}(s^{\\prime})U_{h}(s^{\\prime},s)\\|_{2}\\le}\\end{array}$ $H$ . Therefore, it follows that $\\|w_{h}^{s}\\|_{2}\\leq2H{\\sqrt{d}}$ . \u53e3 ", "page_idx": 54}, {"type": "text", "text": "We next bound the 2-norm of the weight vector from the algorithm. ", "page_idx": 54}, {"type": "text", "text": "Lemma 20. For any $k,h,s_{i}$ , the weight vector from the above algorithm satisfies $\\lvert|w_{h,k}^{s}\\rvert|\\ \\leq$ $2H\\sqrt{d k/\\lambda}$ . ", "page_idx": 54}, {"type": "text", "text": "Proof. For any $G_{h}(a)=g$ , we have for all $s\\in S$ , ", "page_idx": 54}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\left|g^{\\top}w_{h,k}^{s}\\right|=\\left|g^{\\top}(\\Lambda_{h}^{s})^{-1}\\displaystyle\\sum_{t\\in T_{k-1,h}^{s}}G_{h}(a_{h}^{t})\\left[r_{h}(s,a_{h}^{t})+\\operatorname*{max}_{a^{\\prime}\\in A}Q_{h+1}(s_{h+1}^{t},a^{\\prime})\\right]\\right|}\\\\ &{\\qquad\\qquad\\leq|\\displaystyle\\sum_{t\\in T_{k-1,h}^{s}}g^{\\top}(\\Lambda_{h}^{s})^{-1}G_{h}(a_{h}^{t})|2H}\\\\ &{\\qquad\\leq2H\\sqrt{\\displaystyle(\\sum_{t\\in T_{k-1,h}^{s}}g^{\\top}(\\Lambda_{h}^{s})^{-1}g)(\\sum_{t\\in T_{k-1,h}^{s}}G_{h}(a_{h}^{t})^{\\top}(\\Lambda_{h}^{s})^{-1}G_{h}(a_{h}^{t}))}}\\\\ &{\\qquad\\qquad\\leq2H\\|g\\|_{2}\\sqrt{d|T_{k-1,h}^{s}|/\\lambda}\\leq2H\\sqrt{d k/\\lambda}}\\end{array}\n$$", "text_format": "latex", "page_idx": 54}, {"type": "text", "text": "where the second to last inequality is due to Lemma D.1 from [17] and that Rayleigh quotients are upper bounded by the largest eigenvalue of the matrix (Theorem 4.2.2 from [14]). The last inequality is due to $\\|g\\|_{2}\\leq1$ and $|\\bar{T}_{k-1,h}^{s}|\\leq k$ . \u53e3 ", "page_idx": 55}, {"type": "text", "text": "We next prove the main concentration lemma that controls the estimate. ", "page_idx": 55}, {"type": "text", "text": "Lemma 21. Let $c^{\\prime}$ be the constant in the definition of $\\beta_{k,h}^{s}=c^{\\prime}d H\\sqrt{\\iota}$ . Then, there exists a constant $C>0$ that is independent of $c^{\\prime}$ such that for any $\\delta\\in(0,1)$ , if we let the event $\\mathcal{X}$ be ", "page_idx": 55}, {"type": "equation", "text": "$$\n\\langle(s,k,h)\\in\\mathcal{S}\\times[K]\\times[H]:\\quad\\quad\\left\\|\\sum_{t\\in T_{k-1,h}^{s}}G_{h}(a_{h}^{t})(V_{h+1}^{t}(s_{h+1}^{t})-P_{h}V_{h+1}^{t}(s,a_{h}^{t})\\right\\|_{(\\Lambda_{h,t}^{s})^{-1}}\\leq C d H\\sqrt{d_{h+1}^{t}}.\n$$", "text_format": "latex", "page_idx": 55}, {"type": "text", "text": "where $\\chi=\\log(2(c^{\\prime}+1)d T S/\\delta)$ , then $\\mathbb{P}(\\boldsymbol{\\mathscr{X}})\\ge1-\\delta/2$ . ", "page_idx": 55}, {"type": "text", "text": "Proof. From Lemma 20, we have $\\|w_{h,k}^{s}\\|_{2}\\leq2H\\sqrt{d k/\\lambda}$ . By construction, the minimum eigenvalue of $\\Lambda_{h,t}^{s}$ is lower bounded by $\\lambda$ . Then, from Lemma D.4 in [17] (with $\\delta^{\\prime}=\\delta/S$ ), Lemma 18, and taking a union bound over all states, we have that with probability at least $1-\\delta^{\\prime}/2$ , for all $s\\in S$ and $\\epsilon>0$ , ", "page_idx": 55}, {"type": "equation", "text": "$$\n\\displaystyle\\left|\\sum_{t\\in T_{k-1,h}^{s}}G_{h}(a_{h}^{t})(V_{h+1}^{t}(s_{h+1}^{t})-P_{h}V_{h+1}^{t}(s,a_{h}^{t})\\right|\\right|_{(\\Lambda_{h,t}^{s})^{-1}}^{2}\\le4H^{2}\\left[\\frac{d}{2}\\log((k+\\lambda)/\\lambda))+\\log(2S\\!X_{\\epsilon}/\\epsilon_{1,h+1})\\right].\n$$", "text_format": "latex", "page_idx": 55}, {"type": "text", "text": "Then, from Lemma 18, it follows that with probability at least $1-\\delta^{\\prime}/2$ , for all $a\\in S$ and $\\epsilon>0$ , ", "page_idx": 55}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\displaystyle\\bigg|\\sum_{t\\in T_{k-1,h}^{s}}G_{h}(a_{h}^{t})(V_{h+1}^{t}(s_{h+1}^{t})-P_{h}V_{h+1}^{t}(s,a_{h}^{t})\\bigg|\\Biggl|_{(\\Lambda_{h,t}^{s})^{-1}}^{2}}\\\\ &{\\leq4H^{2}\\left[\\frac{d}{2}\\log((k+\\lambda)/\\lambda))+\\log(2S/\\delta)+d\\log(1+4L/\\epsilon)+d^{2}\\log(1+8d^{1/2}\\beta^{2}/(\\lambda\\epsilon^{2}))\\right]+8k^{2}\\epsilon^{2}}\\end{array}\n$$", "text_format": "latex", "page_idx": 55}, {"type": "text", "text": "Choosing $\\lambda=1,\\beta_{k,h}^{s}=C d H\\iota,\\epsilon=d H/k$ gives that there exists some constant $C^{\\prime}$ such that ", "page_idx": 55}, {"type": "equation", "text": "$$\n\\left\\|\\sum_{t\\in T_{k-1,h}^{s}}G_{h}(a_{h}^{t})(V_{h+1}^{t}(s_{h+1}^{t})-P_{h}V_{h+1}^{t}(s,a_{h}^{t})\\right\\|_{(\\Lambda_{h,t}^{s})^{-1}}^{2}\\le C^{\\prime}d^{2}H^{2}\\log(2(c_{\\beta}+1)d T S/\\delta).\n$$", "text_format": "latex", "page_idx": 55}, {"type": "text", "text": "We next recursively bound the difference between the value function maintained in the algorithm and the true value function of any policy $\\pi$ . We upperbound this with their expected difference and an additional error term, which is bounded with high probability. ", "page_idx": 55}, {"type": "text", "text": "Lemma 22. There exists a constant $c_{\\beta}$ such that $\\beta_{k,h}^{s}=c_{\\beta}d H\\sqrt{\\iota}$ where $\\iota=\\log(2d S T/p)$ and for any fixed policy $\\pi$ , on the event $\\mathcal{X}$ defined in Lemma $2l$ , we have for all $(s,a,h,k)\\in S\\times S\\times[H]\\times$ $[K]$ : ", "page_idx": 55}, {"type": "text", "text": "where ", "page_idx": 55}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{G_{h}(a)^{\\top}w_{h,k}^{s}-Q_{h}^{\\pi}(s,a)=P_{h}(V_{h+1}^{k}-V_{h+1}^{\\pi})(s,a)+\\delta_{h}^{k}(s,a),}\\\\ &{\\leq\\beta_{k,h}^{s}\\sqrt{G_{h}(a)^{\\top}(\\Lambda_{h,k}^{s})^{-1}G_{h}(a)}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 55}, {"type": "text", "text": "Proof. From our low-rank assumption, it follows that ", "page_idx": 55}, {"type": "equation", "text": "$$\nQ_{h}^{\\pi}(s,a)=G_{h}(a)^{\\top}w_{h}^{s}=(r_{h}+P_{h}V_{h+1}^{\\pi})(s,a),\n$$", "text_format": "latex", "page_idx": 55}, {"type": "text", "text": "which following the steps from the proof of Lemma B.4 in [17] gives ", "page_idx": 56}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{w_{h,k}^{s}-w_{h}^{s,\\pi}=-\\lambda(\\Lambda_{h,k}^{s})^{-1}w_{h}^{s,\\pi}}\\\\ &{\\qquad\\qquad+\\,(\\Lambda_{h,k}^{s})^{-1}\\displaystyle\\sum_{t\\in T_{k-1,h}^{s}}G_{h}(a_{h}^{t})(V_{h+1}^{k}(s_{h+1}^{t})-P_{h}V_{h+1}^{k}(s,a_{h}^{t})}\\\\ &{\\qquad\\qquad+\\,(\\Lambda_{h,k}^{s})^{-1})\\displaystyle\\sum_{t\\in T_{k-1,h}^{s}}G_{h}(a_{h}^{t})P_{h}(V_{h+1}^{k}-V_{h+1}^{\\pi})(s,a_{h}^{t})}\\end{array}\n$$", "text_format": "latex", "page_idx": 56}, {"type": "text", "text": "Now, we bound each term $(q_{1}^{s},q_{2}^{s},q_{3}^{s})$ individually, for the first term, note for all $s\\in S,a\\in A$ ", "page_idx": 56}, {"type": "equation", "text": "$$\n|{G}_{h}(a)^{\\top}{q}_{1}^{s}|=|\\lambda G_{h}(a)^{\\top}(\\Lambda_{h,k}^{s})^{-1}w_{h}^{s,\\pi}|\\leq\\sqrt\\lambda\\|w_{h}^{s,\\pi}\\|\\sqrt{G_{h}(a)^{\\top}(\\Lambda_{h,k}^{s})^{-1}G_{h}(a)}\n$$", "text_format": "latex", "page_idx": 56}, {"type": "text", "text": "For the second term, given the event $\\mathcal{X}$ , we have from Cauchy Schwarz ", "page_idx": 56}, {"type": "equation", "text": "$$\n|{\\cal G}_{h}(a)^{\\top}q_{2}^{s}|\\leq C d H\\sqrt{\\chi}\\sqrt{{\\cal G}_{h}(a)^{\\top}(\\Lambda_{h,k}^{s})^{-1}{\\cal G}_{h}(a)}\n$$", "text_format": "latex", "page_idx": 56}, {"type": "text", "text": "where $\\chi=\\log(2(c_{\\beta}+1)d T S/p)$ . For the third term, ", "page_idx": 56}, {"type": "equation", "text": "$$\n\\begin{array}{l}{{G_{h}(a)^{\\top}q_{3}^{s}=G_{h}(a)^{\\top}\\left((\\Lambda_{h,k}^{s})^{-1}\\right)\\displaystyle\\sum_{t\\in T_{h-1,h}^{s}}G_{h}(a_{h}^{t})P_{h}(V_{h+1}^{k}-V_{h+1}^{\\pi})(s,a_{h}^{t})\\Bigg)}}\\\\ {{\\mathrm{}}}\\\\ {{\\displaystyle{=G_{h}(a)^{\\top}\\left((\\Lambda_{h,k}^{s})^{-1}\\right)_{t\\in T_{h-1,h}^{s}}G_{h}(a_{h}^{t})G_{h}(a_{h}^{t})^{\\top}\\underset{s^{\\prime}\\in S}{\\sum_{s^{\\prime}\\in S}(V_{h+1}^{k}-V_{h+1}^{\\pi})(s^{\\prime})}U_{h}(s^{\\prime},s)\\Bigg)}}\\\\ {{\\mathrm{}}}\\\\ {{\\displaystyle{=G_{h}(a)^{\\top}\\left(\\sum_{s^{\\prime}\\in S}(V_{h+1}^{k}-V_{h+1}^{\\pi})(s^{\\prime})U_{h}(s^{\\prime},s)\\right)}}}\\\\ {{\\displaystyle{-\\,\\lambda G_{h}(a)^{\\top}\\left((\\Lambda_{h,k}^{s})^{-1}\\right)\\sum_{s^{\\prime}\\in S}(V_{h+1}^{k}-V_{h+1}^{\\pi})(s^{\\prime})U_{h}(s^{\\prime},s)\\Bigg)}}\\end{array}\n$$", "text_format": "latex", "page_idx": 56}, {"type": "text", "text": "We note that ", "page_idx": 56}, {"type": "equation", "text": "$$\nG_{h}(a)^{\\top}\\left(\\sum_{s^{\\prime}\\in S}(V_{h+1}^{k}-V_{h+1}^{\\pi})(s^{\\prime})U_{h}(s^{\\prime},s)\\right)=P_{h}(V_{h+1}^{k}-V_{h+1}^{\\pi})(s,a)\n$$", "text_format": "latex", "page_idx": 56}, {"type": "text", "text": "and ", "page_idx": 56}, {"type": "equation", "text": "$$\n|\\lambda G_{h}(a)^{\\top}\\left((\\Lambda_{h,k}^{s})^{-1}\\right)\\sum_{s^{\\prime}\\in\\mathcal{S}}(V_{h+1}^{k}-V_{h+1}^{k})(s^{\\prime})U_{h}(s^{\\prime},s)\\right)|\\leq2H\\sqrt{d\\lambda}\\sqrt{G_{h}(a)^{\\top}(\\Lambda_{h,k}^{s})^{-1}G_{h}(a)}\n$$", "text_format": "latex", "page_idx": 56}, {"type": "text", "text": "Since ", "page_idx": 56}, {"type": "equation", "text": "$$\n|{G}_{h}(a)^{\\top}{w}_{h,k}^{s}-{Q}_{h}^{\\pi}(s,a)|={G}_{h}(a)^{\\top}({w}_{h,k}^{s}-{w}_{h}^{s,\\pi})={G}_{h}(a)^{\\top}(q_{1}^{s}+q_{2}^{s}+q_{3}^{s}),\n$$", "text_format": "latex", "page_idx": 56}, {"type": "text", "text": "it follows that ", "page_idx": 56}, {"type": "equation", "text": "$$\n|G_{h}(a)^{\\top}w_{h,k}^{s}-Q_{h}^{\\pi}(s,a)-P_{h}(V_{h+1}^{k}-V_{h+1}^{\\pi})(s,a)|\\leq C^{\\circ}d H\\sqrt{\\chi}\\sqrt{G_{h}(a)^{\\top}(\\Lambda_{h,k}^{s})^{-1}G_{h}(a)}.\n$$", "text_format": "latex", "page_idx": 56}, {"type": "text", "text": "Similarly as in [17], we choose $c_{\\beta}$ that satisfies $C^{\\prime\\prime}{\\sqrt{\\log(2)+\\log(c_{\\beta}+1)}}\\leq c_{\\beta}{\\sqrt{\\log(2)}}$ . ", "page_idx": 56}, {"type": "text", "text": "This lemma implies that by adding the appropriate bonus, $Q_{h}^{k}$ is always an upperbound of $Q_{h}^{*}$ with high probability ", "page_idx": 56}, {"type": "text", "text": "Lemma 23. On the event $\\mathcal{X}$ defined in lemma $2l$ , we have $Q_{h}^{k}(s,a)\\geq Q_{h}^{*}(s,a)$ for all $(s,a,h,k)\\in$ $\\mathcal{S}\\times\\mathcal{A}\\times[H]\\times[K]$ . ", "page_idx": 56}, {"type": "text", "text": "Proof. We prove this with induction. The base case holds because at step $H+1$ , the value function is zero, so from Lemma 22, ", "page_idx": 57}, {"type": "equation", "text": "$$\n|G_{h}(a)^{\\top}w_{h,k}^{s}-Q_{H}^{*}(s,a)|\\leq\\beta_{k,h}^{s}\\sqrt{G_{h}(a)^{\\top}(\\Lambda_{h,k}^{s})^{-1}})G_{h}(a)\n$$", "text_format": "latex", "page_idx": 57}, {"type": "text", "text": "and thus, ", "page_idx": 57}, {"type": "equation", "text": "$$\nQ_{H}^{*}(s,a)\\leq\\operatorname*{min}\\Big(H,G_{h}(a)^{\\top}w_{h,k}^{s}+\\beta_{k,h}^{s}\\sqrt{G_{h}(a)^{\\top}(\\Lambda_{h,k}^{s})^{-1})G_{h}(a)}\\Big)=Q_{H}^{k}(s,a).\n$$", "text_format": "latex", "page_idx": 57}, {"type": "text", "text": "From the inductive hypothesis (assuming that $Q_{h+1}^{k}(s,a)\\geq Q_{h+1}^{*}(s,a))$ , it follows that $P_{h}(V_{h+1}^{k}-$ $V_{h+1}^{*})(s,a)\\geq0$ . From Lemma 22, $G_{h}(a)^{\\top}w_{h,k}^{s}-Q_{h}^{*}(s,a)\\leq\\beta_{k,h}^{s}\\sqrt{G_{h}(a)^{\\top}(\\Lambda_{h,k}^{s})^{-1}G_{h}(a)}$ . It follows that ", "page_idx": 57}, {"type": "equation", "text": "$$\nQ_{h}^{*}(s,a)\\leq\\operatorname*{min}\\Big(H,G_{h}(a)^{\\top}w_{h,k}^{s}+\\beta_{k,h}^{s}\\sqrt{G_{h}(a)^{\\top}(\\Lambda_{h,k}^{s})^{-1})G_{h}(a)}\\Big)=Q_{h}^{k}(s,a).\n$$", "text_format": "latex", "page_idx": 57}, {"type": "text", "text": "We next show that Lemma 22 transforms to the recursive formula $\\delta_{h}^{k}=V_{h}^{k}(s_{h}^{k})-V_{h}^{\\pi_{k}}(s_{h}^{k})$ ", "page_idx": 57}, {"type": "text", "text": "Lemma 24. Let $\\delta_{h}^{k}=V_{h}^{k}(s_{h}^{k})-V_{h}^{\\pi_{k}}(s_{h}^{k})$ and $\\xi_{h+1}^{k}=\\mathbb{E}[\\delta_{h+1}^{k}|s_{h}^{k},s_{h}^{k}]-\\delta_{h+1}^{k}$ . Then, on the event $\\mathcal{X}$ defined in Lemma 21, we have for any $(h,k)$ : ", "page_idx": 57}, {"type": "equation", "text": "$$\n\\delta_{h}^{k}\\leq\\delta_{h+1}^{k}+\\xi_{h+1}^{k}+\\beta_{k,h}^{s}\\sqrt{G_{h}(a_{h}^{k})^{\\top}(\\Lambda_{h,k}^{s_{h}^{k}})^{-1}G_{h}(a_{h}^{k})}\n$$", "text_format": "latex", "page_idx": 57}, {"type": "text", "text": "Proof. From Lemma 22, we have for any $(s,a,h,k)$ that ", "page_idx": 57}, {"type": "equation", "text": "$$\nQ_{h}^{k}(s,a)-Q_{h}^{\\pi_{k}}(s,a)\\leq P_{h}(V_{h+1}^{k}-V_{h+1}^{\\pi_{k}})(s,a)+\\beta_{k,h}^{s}\\sqrt{G_{h}(a)^{\\top}(\\Lambda_{h,k}^{s})^{-1}G_{h}(a)}.\n$$", "text_format": "latex", "page_idx": 57}, {"type": "text", "text": "From the definition of $V^{\\pi_{k}}$ , we have ", "page_idx": 57}, {"type": "equation", "text": "$$\n\\delta_{h}^{k}=Q_{h}^{k}(s_{h}^{k},a_{h}^{k})-Q_{h}^{\\pi_{k}}(s_{h}^{k},a_{h}^{k}).\n$$", "text_format": "latex", "page_idx": 57}, {"type": "text", "text": "Finally, we prove the main theorem, Theorem 5. ", "page_idx": 57}, {"type": "text", "text": "Proof. Suppose that the Assumptions required in Theorem 5 hold. We condition on the event $\\mathcal{X}$ from Lemma 21 with $p=\\delta/2$ and use the notation for $\\delta_{h}^{k},\\xi_{h}^{k}$ as in Lemma 24. From Lemmas 9 and 24, we have ", "page_idx": 57}, {"type": "equation", "text": "$$\n\\mathcal{1}e g r e t(K)=\\sum_{k=1}^{K}(V_{1}^{*}(s_{1}^{k})-V_{1}^{\\pi_{k}}(s_{1}^{k}))\\le\\sum_{k=1}^{K}\\delta_{1}^{k}\\le\\sum_{k\\in[K]}\\sum_{h\\in[H]}\\xi_{h}^{k}+\\beta_{k,h}^{s}\\sum_{k\\in[K]}\\sum_{h\\in[H]}\\sqrt{G_{h}(a_{h}^{k})^{\\top}(\\Lambda_{h,h}^{s_{h}})}.\n$$", "text_format": "latex", "page_idx": 57}, {"type": "text", "text": "Since the observations at episode $k$ are independent of the computed value function (this uses the trajectories from episodes 1 to $k-1$ , it follows $\\{\\xi_{h}^{k}\\}$ is a martingale difference sequence with $|\\xi_{h}^{k}|\\leq2H$ for all $(k,h)$ . Thus, from the Azuma Hoeffding inequality, we have ", "page_idx": 57}, {"type": "equation", "text": "$$\n\\sum_{k\\in[K],h\\in H}\\xi_{h}^{k}\\leq\\sqrt{2T H^{2}\\log(2/p)}\\leq2H\\sqrt{T\\iota}\n$$", "text_format": "latex", "page_idx": 57}, {"type": "text", "text": "iws itaht  lperaosbt aobnilei tbyy a ct olenasstrt $1-\\delta/2$ n. dF .t eFrrmo,m w teh en oEtlel itphtiact atlh eP omteinnitimalu Lme emigmean v(aLleuem omf $\\Lambda_{h,k}^{s_{h}^{k}}$ $\\|G_{h}(a)\\|\\leq1$   \n[17]), we have for all $s\\in S$ and $h\\in[H]$ , ", "page_idx": 57}, {"type": "equation", "text": "$$\n\\sum_{k=1}^{K}G_{h}(a_{h}^{k})^{\\top}(\\Lambda_{h,k}^{s})^{-1}G_{h}(a_{h}^{k})\\leq2\\log(d e t(\\Lambda_{h,k+1}^{s})/\\operatorname*{det}(\\Lambda_{h,0}^{s}))\n$$", "text_format": "latex", "page_idx": 57}, {"type": "text", "text": "Furthermore, we have $\\begin{array}{r}{\\|\\Lambda_{h,k+1}^{s}\\|=\\|\\sum_{t\\in T_{K,h}^{s}}G_{h}(a_{h}^{t})G_{h}(a_{h}^{t})^{\\top}+\\lambda I\\|\\leq\\lambda+|T_{K,h}^{s}|\\leq\\lambda+K}\\end{array}$ . It follows that ", "page_idx": 58}, {"type": "equation", "text": "$$\n\\sum_{k=1}^{K}G_{h}(a_{h}^{k})^{\\top}(\\Lambda_{h,k}^{s})^{-1}G_{h}(a_{h}^{k})\\leq2d\\log(1+K/\\lambda)\\leq2d\\iota\n$$", "text_format": "latex", "page_idx": 58}, {"type": "text", "text": "Next, by Cauchy-Schwarz and grouping the regret by each state, it follows that ", "page_idx": 58}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{\\displaystyle\\sum_{\\substack{c\\in[K]\\,h\\in[H]}}\\sqrt{G_{h}(a_{h}^{k})^{\\top}(\\Lambda_{h,k}^{s_{h}^{k}})^{-1}G_{h}(a_{h}^{k})}\\leq\\displaystyle\\sum_{h\\in[H]}\\sqrt{K}\\left[\\displaystyle\\sum_{k\\in[K]}G_{h}(a_{h}^{k})^{\\top}(\\Lambda_{h,k}^{s_{h}^{k}})^{-1}G_{h}(a_{h}^{k})\\right]^{1/2}}\\\\ &{=\\displaystyle\\sum_{h\\in[H]}\\sqrt{K}\\left[\\displaystyle\\sum_{s\\in\\mathcal{S}}\\displaystyle\\sum_{\\ell\\in T_{h,k}^{s}}G_{h}(a_{h}^{t})^{\\top}(\\Lambda_{h,t}^{s})^{-1}G_{h}(a_{h}^{t})\\right]^{1/2}}\\\\ &{\\leq\\displaystyle\\sum_{h\\in[H]}\\sqrt{K}\\left[\\displaystyle\\sum_{s\\in\\mathcal{S}}2d_{d}\\right]^{1/2}}\\\\ &{<H\\sqrt{2K S d t}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 58}, {"type": "text", "text": "Since $\\beta_{k,h}^{s}=c d H\\sqrt{\\imath}$ for some constant $c$ , from a union bound and the previous bounds, it follows that ", "page_idx": 58}, {"type": "equation", "text": "$$\nR e g r e t(K)\\leq2H\\sqrt{T\\iota}+\\beta_{k,h}^{s}H\\sqrt{2K S d\\iota}\\in\\tilde{O}(\\sqrt{d^{3}H^{3}S T}).\n$$", "text_format": "latex", "page_idx": 58}, {"type": "text", "text": "with probability at least $1-\\delta$ . ", "page_idx": 58}, {"type": "text", "text": "Next, we prove the helper lemmas needed in the misspecified setting and follow the proof structure and techniques used in [17]. ", "page_idx": 58}, {"type": "text", "text": "Lemma 25. For a $\\xi$ -approximate $(S,S,d)$ Tucker rank MDP (Assumption $^{4}$ ), then for any policy $\\pi$ there exists corresponding weight vectors $\\{w_{h}^{s}\\}$ where $\\begin{array}{r}{w_{h}^{s}=\\Sigma_{h}W_{h}(s)+\\sum_{s^{\\prime}\\in\\mathcal{S}}V_{h+1}^{\\pi}(s^{\\prime})U_{h}(s^{\\prime},s)}\\end{array}$ such that for all $(s,a)\\in S\\times A$ ", "page_idx": 58}, {"type": "equation", "text": "$$\n\\begin{array}{r}{|Q_{h}^{\\pi}(s,a)-G_{h}(a)w_{h}^{s\\top}|\\leq3H\\xi.}\\end{array}\n$$", "text_format": "latex", "page_idx": 58}, {"type": "text", "text": "Proof. Note that $\\begin{array}{r}{Q_{h}^{\\pi}(s,a)=r_{h}(s,a)+\\sum_{s^{\\prime}}V_{h+1}^{\\pi}(s^{\\prime})P_{h}(s^{\\prime}|s,a)}\\end{array}$ , so, using the low-rank representations of $r_{h},P_{h}$ , it follows that ", "page_idx": 58}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{|Q_{h}^{\\pi}(s,a)-G_{h}(a)w_{h}^{s^{\\top}}|}\\\\ &{\\leq|r_{h}(s,a)-G_{h}(a)W_{h}(s)^{\\top}|+\\displaystyle\\left|\\sum_{s^{\\prime}}V_{h+1}^{\\pi}(s^{\\prime})P_{h}(s^{\\prime}|s,a)-G_{h}(a)\\sum_{s^{\\prime}\\in\\mathcal{S}}V_{h+1}^{\\pi}(s^{\\prime})U_{h}(s^{\\prime},s)\\right|}\\\\ &{\\leq\\xi+2H\\xi}\\\\ &{\\leq3H\\xi.}\\end{array}\n$$", "text_format": "latex", "page_idx": 58}, {"type": "text", "text": "Lemma 26. Suppose Assumption 7 holds. Let $\\{w_{h}^{s}\\}$ be the weight vector of some policy $\\pi$ , i.e., $Q_{h}^{\\pi}(s,a)=G_{h}(a)^{\\top}w_{h}^{s}$ . Then, ", "page_idx": 58}, {"type": "equation", "text": "$$\n\\|w_{h}^{s}\\|\\leq2H{\\sqrt{d}}.\n$$", "text_format": "latex", "page_idx": 58}, {"type": "text", "text": "Proof. Recall that $\\begin{array}{r}{w_{h}^{s}=\\Sigma_{h}W_{h}(s)+\\sum_{s^{\\prime}\\in\\mathcal{S}}V_{h+1}^{\\pi}(s^{\\prime})U_{h}(s^{\\prime},s)}\\end{array}$ . From the same argument used to prove Lemma 19, it follows that $\\|w_{h}^{s}\\|_{2}\\leq2H{\\sqrt{d}}$ \u53e3 ", "page_idx": 58}, {"type": "text", "text": "Similarly, we bound the stochastic noise but account for the misspecification error. ", "page_idx": 58}, {"type": "text", "text": "Lemma 27. Suppose Assumption 7 holds. Let $c_{m}^{\\prime}$ be the constant in the definition of $\\beta_{k,h}^{s}\\;=\\;$ $c_{m}^{\\prime}H(d\\sqrt{\\iota}+\\xi\\sqrt{|T_{k,h}^{s}|d})$ . Then, there exists a constant $C>0$ that is independent of $c_{m}^{\\prime}$ such that for any $\\delta\\in(0,1)$ , if we let the event $\\mathcal{X}$ be ", "page_idx": 59}, {"type": "equation", "text": "$$\n\\langle(a,k,h)\\in\\mathcal{A}\\times[K]\\times[H]:\\qquad\\left\\|\\sum_{t\\in T_{k-1,h}^{s}}G_{h}(a_{h}^{t})(V_{h+1}^{t}(s_{h+1}^{t})-P_{h}V_{h+1}^{t}(s,a_{h}^{t})\\right\\|_{(\\Lambda_{h,t}^{s})^{-1}}\\le C d H_{\\sqrt{h+1}}.\n$$", "text_format": "latex", "page_idx": 59}, {"type": "text", "text": "where $\\chi=\\log(2(c_{m}^{\\prime}+1)d T S/\\delta)$ , then $\\mathbb{P}(\\boldsymbol{\\mathscr{X}})\\ge1-\\delta/2$ . ", "page_idx": 59}, {"type": "text", "text": "Proof. The proof is the same as the proof of Lemma 21 except we increase $\\beta_{k,h}^{s}$ to account for the misspecifiction error. Since $\\xi\\leq1$ by assumption, the modification to $\\beta_{k,h}^{s}$ only affects $C$ . \u53e3 ", "page_idx": 59}, {"type": "text", "text": "Next, we account for the adversarial misspecification error. ", "page_idx": 59}, {"type": "text", "text": "Lemma 28. Let $\\left\\{\\epsilon_{t}\\right\\}$ be any sequence such that $|\\epsilon_{\\tau}|\\le B$ for any $t$ . Then, for any $(h,k,s)\\in$ $[H]\\times[K]\\times S$ and $G\\in\\mathbb R^{d}$ , we have ", "page_idx": 59}, {"type": "equation", "text": "$$\n|G^{\\top}(\\Lambda_{k,h}^{s})^{-1}\\sum_{t\\in T_{k-1,h}^{s}}G_{h}(a_{h}^{t})\\epsilon_{t}|\\leq B\\sqrt{d|T_{k-1,h}^{s}|G^{\\top}(\\Lambda_{k,h}^{s})^{-1}G}.\n$$", "text_format": "latex", "page_idx": 59}, {"type": "text", "text": "Proof. From the Cauchy-Schwarz inequality and Elliptical Potential Lemma (Lemma D.1 [17]), we have ", "page_idx": 59}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{G^{\\top}(\\Lambda_{k,h}^{s})^{-1}\\displaystyle\\sum_{t\\in T_{k-1,h}^{s}}G_{h}(a_{h}^{t})\\epsilon_{t}\\rvert\\le B\\sqrt{\\left(\\displaystyle\\sum_{t\\in T_{k-1,h}^{s}}G^{\\top}(\\Lambda_{k,h}^{s})^{-1}G\\right)}\\left(\\displaystyle\\sum_{t\\in T_{k-1,h}^{s}}G_{h}(a_{h}^{t})^{\\top}(\\Lambda_{k,h}^{s})^{-1}G_{h}(a_{h}^{t})\\right)}&{}\\\\ {\\le B\\sqrt{d|T_{k-1,h}^{s}|G^{\\top}(\\Lambda_{k,h}^{s})^{-1}G}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 59}, {"type": "text", "text": "Next, we bound the error between a policies $Q$ function and our low-rank estimate. ", "page_idx": 59}, {"type": "text", "text": "Lemma 29. There exists a constant $c_{m}^{\\prime}$ such that $\\beta_{k,h}^{s}\\,=\\,c_{m}^{\\prime}H(d\\sqrt{\\iota}+\\xi\\sqrt{|T_{k,h}^{s}|d})$ where $\\iota=$ $\\log(2d S T/p)$ and for any fixed policy $\\pi$ , on the event $\\mathcal{X}$ defined in Lemma 27, we have for all $(s,a,h,k)\\in S\\times S\\times[H]\\times[K]$ : ", "page_idx": 59}, {"type": "equation", "text": "$$\n\\begin{array}{r}{G_{h}(a)^{\\top}w_{h,k}^{s}-Q_{h}^{\\pi}(s,a)=P_{h}(V_{h+1}^{k}-V_{h+1}^{\\pi})(s,a)+\\delta_{h}^{k}(s,a),}\\\\ {\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad}\\\\ {\\frac{k}{h}(s,a)|\\leq\\beta_{k,h}^{s}\\sqrt{G_{h}(a)^{\\top}(\\Lambda_{h,k}^{s})^{-1}G_{h}(a)}+4H\\xi.\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad}\\end{array}\n$$", "text_format": "latex", "page_idx": 59}, {"type": "text", "text": "Proof. From Lemma 25, it follows that there exists a weight vector $\\begin{array}{r l r}{w_{h}^{s}}&{{}=}&{W_{h}(a)\\ +}\\end{array}$ $\\begin{array}{r}{\\sum_{s^{\\prime}\\in\\mathcal{S}}V_{h+1}^{\\pi}(s^{\\prime})U_{h}(s^{\\prime},s)}\\end{array}$ , such that for all $(s,a)\\in S\\times A$ , ", "page_idx": 59}, {"type": "equation", "text": "$$\n\\begin{array}{r}{|Q_{h}^{\\pi}(s,a)-G_{h}(a)^{\\top}w_{h}^{s}|\\leq2H\\xi.}\\end{array}\n$$", "text_format": "latex", "page_idx": 59}, {"type": "text", "text": "Let $\\Tilde{P}(\\cdot|s,a)=G_{h}(a)^{\\top}U_{h}(\\cdot,s)$ , so we have for any $(s,a)\\in S\\times A,G_{h}(a)^{\\top}w_{h}^{s}=G_{h}(a)^{\\top}W_{h}(a)+$ $\\tilde{P}V_{h+1}^{\\pi}(s,a)$ . Therefore, ", "page_idx": 59}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{w_{h,k}^{s}-w_{h}^{s,\\pi}=-\\lambda(\\Lambda_{h,k}^{s})^{-1}w_{h}^{s,\\pi}}\\\\ &{\\qquad\\qquad+\\displaystyle(\\Lambda_{h,k}^{s})^{-1}\\sum_{t\\in T_{k-1,h}^{s}}G_{h}(a_{h}^{t})(V_{h+1}^{k}(s_{h+1}^{t})-P_{h}V_{h+1}^{k}(s,a_{h}^{t})}\\\\ &{\\qquad\\qquad+\\displaystyle(\\Lambda_{h,k}^{s})^{-1}\\sum_{t\\in T_{k-1,h}^{s}}G_{h}(a_{h}^{t})\\tilde{P}_{h}(V_{h+1}^{k}-V_{h+1}^{\\pi})(s,a_{h}^{t})}\\\\ &{\\qquad\\qquad\\qquad+\\displaystyle(\\Lambda_{h,k}^{s})^{-1}1\\sum_{t\\in T_{k-1,h}^{s}}G_{h}(a_{h}^{t})\\left(r_{h}(s,a_{h}^{t})-G_{h}(a_{h}^{t})W_{h}(a)+(P_{h}-\\tilde{P}_{h})V_{h+1}^{k}(s,a_{h}^{t})\\right)}\\end{array}\n$$", "text_format": "latex", "page_idx": 59}, {"type": "text", "text": "Now, we bound each of the four terms above $(q_{1}^{s},q_{2}^{s},q_{3}^{s},q_{4}^{s})$ individually, for the first term, note for all $a\\in{\\mathcal{A}}$ ", "page_idx": 60}, {"type": "equation", "text": "$$\n|{G}_{h}(a)^{\\top}{q}_{1}^{s}|=|\\lambda G_{h}(a)^{\\top}(\\Lambda_{h,k}^{s})^{-1}w_{h}^{s,\\pi}|\\leq\\sqrt\\lambda\\|w_{h}^{s,\\pi}\\|\\sqrt{G_{h}(a)^{\\top}(\\Lambda_{h,k}^{s})^{-1}G_{h}(a)}\n$$", "text_format": "latex", "page_idx": 60}, {"type": "text", "text": "For the second term, given the event $\\mathcal{X}$ , we have from Cauchy Schwarz ", "page_idx": 60}, {"type": "equation", "text": "$$\n|G_{h}(a)^{\\top}q_{2}^{s}|\\leq C d H\\sqrt{\\chi}\\sqrt{G_{h}(a)^{\\top}(\\Lambda_{h,k}^{s})^{-1}G_{h}(a)}\n$$", "text_format": "latex", "page_idx": 60}, {"type": "text", "text": "where $\\chi=\\log(2(c_{\\beta}+1)d T S/p)$ . For the third term, ", "page_idx": 60}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{G_{h}(a)^{\\top}q_{3}^{s}=G_{h}(a)^{\\top}\\left((\\Lambda_{h,k}^{s})^{-1}\\displaystyle\\sum_{t\\in T_{k-1,h}^{s}}G_{h}(a_{h}^{t})\\tilde{P}_{h}(V_{h+1}^{k}-V_{h+1}^{\\pi})(s,a_{h}^{t})\\right)}\\\\ &{\\phantom{G_{h}(a)^{\\top}\\tau_{3}^{s}}=G_{h}(a)^{\\top}\\left((\\Lambda_{h,k}^{s})^{-1}\\displaystyle\\sum_{t\\in T_{k-1,h}^{s}}G_{h}(a_{h}^{t})G_{h}(a_{h}^{t})^{\\top}\\sum_{s^{\\prime}\\in\\mathcal{S}}(V_{h+1}^{k}-V_{h+1}^{\\pi})(s^{\\prime})U_{h}(s^{\\prime},s)\\right)}\\\\ &{\\phantom{G_{h}(a)^{\\top}\\tau_{3}^{s}}=G_{h}(a)^{\\top}\\left(\\displaystyle\\sum_{s^{\\prime}\\in\\mathcal{S}}(V_{h+1}^{k}-V_{h+1}^{\\pi})(s^{\\prime})U_{h}(s^{\\prime},s)\\right)}\\\\ &{\\phantom{G_{h}(a)^{\\top}\\tau_{3}^{s}}-\\lambda G_{h}(a)^{\\top}\\left((\\Lambda_{h,k}^{s})^{-1}\\displaystyle\\sum_{s^{\\prime}\\in\\mathcal{S}}(V_{h+1}^{k}-V_{h+1}^{\\pi})(s^{\\prime})U_{h}(s^{\\prime},s)\\right),}\\end{array}\n$$", "text_format": "latex", "page_idx": 60}, {"type": "text", "text": "and note that ", "page_idx": 60}, {"type": "equation", "text": "$$\nG_{h}(a)^{\\top}\\left(\\sum_{s^{\\prime}\\in S}(V_{h+1}^{k}-V_{h+1}^{\\pi})(s^{\\prime})U_{h}(s^{\\prime},s)\\right)=\\tilde{P}_{h}(V_{h+1}^{k}-V_{h+1}^{\\pi})(s,a)\n$$", "text_format": "latex", "page_idx": 60}, {"type": "text", "text": "and ", "page_idx": 60}, {"type": "equation", "text": "$$\n|\\lambda G_{h}(a)^{\\top}\\left((\\Lambda_{h,k}^{s})^{-1}\\sum_{s^{\\prime}\\in\\mathcal{S}}(V_{h+1}^{k}-V_{h+1}^{k})(s^{\\prime})U_{h}(s^{\\prime},s)\\right)|\\leq2H\\sqrt{d\\lambda}\\sqrt{G_{h}(a)^{\\top}(\\Lambda_{h,k}^{s})^{-1}G_{h}(a)}.\n$$", "text_format": "latex", "page_idx": 60}, {"type": "text", "text": "Since $\\|\\tilde{P}_{h}(\\cdot|s,a)-P_{h}(\\cdot|s,a)\\|_{\\infty}\\leq1$ for all $(s,a)\\in S\\times A$ , it follows that ", "page_idx": 60}, {"type": "equation", "text": "$$\n|\\tilde{P}_{h}(V_{h+1}^{k}-V_{h+1}^{\\pi})(s,a)-P_{h}(V_{h+1}^{k}-V_{h+1}^{\\pi})(s,a)|\\leq|(\\tilde{P}_{h}-P_{h})(V_{h+1}^{k}-V_{h+1}^{\\pi})(s,a)|\\leq2H\\xi.\n$$", "text_format": "latex", "page_idx": 60}, {"type": "text", "text": "From Lemma 28, we have $|G_{h}(a),q_{4}^{s}|\\leq2H\\xi\\sqrt{d|T_{k,h}^{s}|G_{h}(a)^{\\top}(\\Lambda_{h,k}^{-1})^{-1}G_{h}(a)}.$ Since ", "page_idx": 60}, {"type": "equation", "text": "$$\n|{G}_{h}(a)^{\\top}{w}_{h,k}^{s}-{Q}_{h}^{\\pi}(s,a)|={G}_{h}(a)^{\\top}({w}_{h,k}^{s}-{w}_{h}^{s,\\pi})={G}_{h}(a)^{\\top}(q_{1}^{s}+q_{2}^{s}+q_{3}^{s}+q_{4}^{s}),\n$$", "text_format": "latex", "page_idx": 60}, {"type": "text", "text": "it follows that ", "page_idx": 60}, {"type": "text", "text": "| $G_{h}(a)^{\\top}w_{h,k}^{s}-Q_{h}^{\\pi}(s,a)-P_{h}(V_{h+1}^{k}-V_{h+1}^{\\pi})(s,a)|\\leq\\sqrt{\\chi}(C^{\\circ}d\\sqrt{\\chi}+2\\xi\\sqrt{|T_{k,h}^{s}|d})H\\sqrt{G_{h}(a)^{\\top}(\\Lambda_{h,k}^{s})^{-\\frac{\\chi+\\sqrt{T}}{2}}}\\,.$ 1Gh(a)+4H\u03be. Similarly as in [17], we choose $c_{\\beta}$ that satisfies $C^{\\prime\\prime}{\\sqrt{\\log(2)+\\log(c_{\\beta}+1)}}\\leq c_{\\beta}{\\sqrt{\\log(2)}}$ . \u518f\u53e3 ", "page_idx": 60}, {"type": "text", "text": "Now, we prove that $Q_{h}^{k}$ is an upperbound of $Q_{h}^{*}$ conditioned on the event in Lemma 27. ", "page_idx": 60}, {"type": "text", "text": "Lemma 30. Suppose Assumption 7 holds. On the event $\\mathcal{X}$ defined in lemma 27, we have $Q_{h}^{k}(s,a)\\geq$ $Q_{h}^{*}(s,a)-4H\\bar{(H+1-h)}\\bar{\\xi}$ for all $(s,a,h,k)\\in\\mathcal{S}\\times\\mathcal{A}\\times[H]\\times[K]$ . ", "page_idx": 60}, {"type": "text", "text": "Proof. We prove this with induction. The base case holds because at step $H+1$ , the value function is zero, so from Lemma 29, ", "page_idx": 60}, {"type": "equation", "text": "$$\n|G_{h}(a)^{\\top}w_{h,k}^{s}-Q_{H}^{*}(s,a)|\\leq\\beta_{k,h}^{s}\\sqrt{G_{h}(a)^{\\top}(\\Lambda_{h,k}^{s})^{-1})G_{h}(a)}+4H\\xi\n$$", "text_format": "latex", "page_idx": 60}, {"type": "text", "text": "and thus, ", "page_idx": 61}, {"type": "equation", "text": "$$\nQ_{H}^{*}(s,a)-4H\\xi\\leq\\operatorname*{min}\\Big(H,G_{h}(a)^{\\top}w_{h,k}^{s}+\\beta_{k,h}^{s}\\sqrt{G_{h}(a)^{\\top}(\\Lambda_{h,k}^{s})^{-1})G_{h}(a)}\\Big)=Q_{H}^{k}(s,a).\n$$", "text_format": "latex", "page_idx": 61}, {"type": "text", "text": "From the inductive hypothesis (assuming that $Q_{h+1}^{k}(s,a)\\ \\geq\\ Q_{h+1}^{*}(s,a)\\ -\\ 4H(H\\ -\\ h)\\xi)$ , it follows that $P_{h}(V_{h+1}^{k}\\,-\\,V_{h+1}^{*})(s,a)\\ \\geq\\ -4\\xi$ . From Lemma 29, $G_{h}(a)^{\\top}w_{h,k}^{s}\\,-\\,Q_{h}^{*}(s,a)\\,\\,\\le$ $\\beta_{k,h}^{s}\\sqrt{G_{h}(a)^{\\top}(\\Lambda_{h,k}^{s})^{-1})G_{h}(a)}+4H\\xi$ . It follows that ", "page_idx": 61}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\!\\!\\!\\partial_{h}^{*}(s,a)\\!-\\!4H(H\\!-\\!h\\!+\\!1)\\xi\\leq\\operatorname*{min}\\Big(H,G_{h}(a)^{\\top}w_{h,k}^{s}+\\beta_{k,h}^{s}\\sqrt{G_{h}(a)^{\\top}(\\Lambda_{h,k}^{s})^{-1}})G_{h}(a)\\Big)=Q_{h}^{k}(s,a).}\\end{array}\n$$", "text_format": "latex", "page_idx": 61}, {"type": "text", "text": "Similarly, to the regular case, the gap in the misspecified setting has a recursive formula. ", "page_idx": 61}, {"type": "text", "text": "Lemma 31. Let $\\delta_{h}^{k}=V_{h}^{k}(s_{h}^{k})-V_{h}^{\\pi_{k}}(s_{h}^{k})$ and $\\xi_{h+1}^{k}=\\mathbb{E}[\\delta_{h+1}^{k}|s_{h}^{k},a_{h}^{k}]-\\delta_{h+1}^{k}$ . Then, on the event $\\mathcal{X}$ defined in Lemma 27, we have for any $(h,k)$ : ", "page_idx": 61}, {"type": "equation", "text": "$$\n\\delta_{h}^{k}\\leq\\delta_{h+1}^{k}+\\xi_{h+1}^{k}+\\beta_{k,h}^{s}\\sqrt{G_{h}(a_{h}^{k})^{\\top}(\\Lambda_{h,k}^{s_{h}^{k}})^{-1}G_{h}(a_{h}^{k})}+4H\\xi\n$$", "text_format": "latex", "page_idx": 61}, {"type": "text", "text": "Proof. From Lemma 29, we have for any $(s,a,h,k)$ that ", "page_idx": 61}, {"type": "equation", "text": "$$\nQ_{h}^{k}(s,a)-Q_{h}^{\\pi_{k}}(s,a)\\leq P_{h}(V_{h+1}^{k}-V_{h+1}^{\\pi_{k}})(s,a)+\\beta_{k,h}^{s}\\sqrt{G_{h}(a)^{\\top}(\\Lambda_{h,k}^{s})^{-1}G_{h}(a)}+4H\\xi.\n$$", "text_format": "latex", "page_idx": 61}, {"type": "text", "text": "From the definition of $V^{\\pi_{k}}$ , we have ", "page_idx": 61}, {"type": "equation", "text": "$$\n\\delta_{h}^{k}=Q_{h}^{k}(s_{h}^{k},a_{h}^{k})-Q_{h}^{\\pi_{k}}(s_{h}^{k},a_{h}^{k}),\n$$", "text_format": "latex", "page_idx": 61}, {"type": "text", "text": "and substituting this into the first equation finishes the proof. ", "page_idx": 61}, {"type": "text", "text": "Finally, we prove the main result in the misspecified setting Theorem 9. ", "page_idx": 61}, {"type": "text", "text": "Proof. Suppose that the Assumptions required in Theorem 6 hold. We condition on the event $\\mathcal{X}$ from Lemma 27 with $p=\\delta/2$ and use the notation for $\\delta_{h}^{k},\\xi_{h}^{k}$ as in Lemma 31. From Lemma 16, we have $Q_{1}^{k}(s,a)\\geq Q_{1}^{*}(s,a)-4H^{2}\\xi$ , which implies $V_{1}^{*}(\\stackrel{\\cdot}{s})\\stackrel{\\cdot\\cdot}{-}V_{1}^{\\pi_{k}}(s)\\leq\\delta_{1}^{k}+4H^{2}\\xi$ . Thus, from Lemma 29, on the event $\\mathcal{X}$ , it follows that ", "page_idx": 61}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{R e g r e t(K)=\\displaystyle\\sum_{k=1}^{K}(V_{1}^{*}(s_{1}^{k})-V_{1}^{\\pi_{k}}(s_{1}^{k}))\\leq\\displaystyle\\sum_{k=1}^{K}\\delta_{1}^{k}+4H^{2}\\xi}\\\\ &{\\qquad\\qquad\\leq\\displaystyle\\sum_{k\\in[K]}\\sum_{h\\in[H]}\\xi_{h}^{k}+\\displaystyle\\sum_{k\\in[K]}\\beta_{k,h}^{s}\\displaystyle\\sum_{h\\in[H]}\\sqrt{G_{h}(a_{h}^{k})^{\\top}(\\Lambda_{h,k}^{s_{h}^{k}})^{-1}G_{h}(a_{h}^{k})}+4H T\\xi}\\end{array}\n$$", "text_format": "latex", "page_idx": 61}, {"type": "text", "text": "since $H K=T$ . Since the observations at episode $k$ are independent of the computed value function (this uses the trajectories from episodes 1 to $k-1$ , it follows $\\displaystyle\\{\\xi_{h}^{k}\\}$ is a martingale difference sequence with $|\\xi_{h}^{k}|\\leq2H$ for all $(k,h)$ . Thus, from the Azuma Hoeffding inequality, we have ", "page_idx": 61}, {"type": "equation", "text": "$$\n\\sum_{k\\in[K],h\\in H}\\xi_{h}^{k}\\leq\\sqrt{2T H^{2}\\log(2/p)}\\leq2H\\sqrt{T\\iota}\n$$", "text_format": "latex", "page_idx": 61}, {"type": "text", "text": "with probability at least $1-\\delta/2.\\mathrm{{N}}$ ote that ", "page_idx": 61}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\displaystyle\\sum_{k\\in[K]}\\beta_{k,h}^{s}\\sqrt{G_{h}(a_{h}^{k})^{\\top}(\\Lambda_{h,k}^{s_{h}^{k}})^{-1}G_{h}(a_{h}^{k})}}\\\\ &{\\displaystyle\\leq C H(\\sum_{k\\in[K]}d\\sqrt{\\iota_{h}(a_{h}^{k})^{\\top}(\\Lambda_{h,k}^{s_{h}^{k}})^{-1}G_{h}(a_{h}^{k})}+\\displaystyle\\sum_{k\\in[K]}\\xi\\sqrt{|T_{k,h}^{s}|}d\\sqrt{G_{h}(a_{h}^{k})^{\\top}(\\Lambda_{h,k}^{s_{h}^{k}})^{-1}G_{h}(s_{h}^{k})}).}\\end{array}\n$$", "text_format": "latex", "page_idx": 61}, {"type": "text", "text": "From the Cauchy-Schwarz inequality, it follows that ", "page_idx": 62}, {"type": "equation", "text": "$$\n\\sum_{k\\in[K]}\\sqrt{G_{h}(a_{h}^{k})^{\\top}(\\Lambda_{h,k}^{s_{h}^{k}})^{-1}G_{h}(a_{h}^{k})}\\le\\left(\\sqrt{K}\\right)\\left(\\sqrt{\\sum_{k\\in[K]}G_{h}(a_{h}^{k})^{\\top}(\\Lambda_{h,k}^{s_{h}^{k}})^{-1}G_{h}(a_{h}^{k})}\\right).\n$$", "text_format": "latex", "page_idx": 62}, {"type": "text", "text": "Let $k_{i}$ refers to the episode in which state $s$ was seen at time step $h$ for the $i$ th time. Then, for the other term, we first re-index the summation and then use the Cauchy-Schwarz inequality to get ", "page_idx": 62}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{\\lefteqn{\\sum_{k\\in[K]}\\sqrt{|T_{k,h}^{s}|}\\sqrt{G_{h}(a_{h}^{k})^{\\top}(\\Lambda_{h,k}^{s})^{-1}G_{h}(a_{h}^{k}))}=\\sum_{s\\in S}\\displaystyle\\sum_{i=1}^{|T_{K,h}^{s}|}\\sqrt{i}\\sqrt{G_{k_{i},h}^{\\top}(\\Lambda_{k_{i},h}^{a})^{-1}G_{k_{i},h}}}\\\\ &{\\leq\\left(\\displaystyle\\sum_{i=1}^{|T_{K,h}^{s}|}i\\right)^{1/2}\\left(\\displaystyle\\sum_{t\\in T_{K,h}^{s}}G_{k,h}^{\\top}(\\Lambda_{k,h}^{s_{h}^{k}})^{-1}G_{k,h}\\right)^{1/2}}\\\\ &{\\leq C^{\\prime}|T_{K,h}^{s}|\\left(\\displaystyle\\sum_{t\\in T_{K,h}^{s}}G_{k,h}^{\\top}(\\Lambda_{k,h}^{s_{h}^{k}})^{-1}G_{k,h}\\right)^{1/2}}\\end{array}\n$$", "text_format": "latex", "page_idx": 62}, {"type": "text", "text": "for some absolute constant $C^{\\prime}\\ >\\ 0$ . Since the minimum eigenvalue of $\\Lambda_{h,k}^{s_{h}^{k}}$ is at least one by construction and $\\|G_{h}(s)\\|\\leq1$ , from the Elliptical Potential Lemma (Lemma D.2 [17]), we have for all $a\\in{\\mathcal{A}}$ and $h\\in[H]$ , ", "page_idx": 62}, {"type": "equation", "text": "$$\n\\sum_{k=1}^{K}G_{h}(s_{k})^{\\top}(\\Lambda_{h,k}^{a})^{-1}G_{h}(s_{k})\\leq2\\log(d e t(\\Lambda_{h,k+1}^{a})/d e t(\\Lambda_{h,0}^{a}))\n$$", "text_format": "latex", "page_idx": 62}, {"type": "text", "text": "Furthermore, we have $\\begin{array}{r}{\\|\\Lambda_{h,k+1}^{a}\\|=\\|\\sum_{t\\in T_{k,h}^{s}}G_{h}(s_{h}^{t})G_{h}(s_{h}^{t})^{\\top}+\\lambda I\\|\\leq\\lambda+|T_{k,h}^{s}|\\leq\\lambda+K.}\\end{array}$ . It follows that ", "page_idx": 62}, {"type": "equation", "text": "$$\n\\sum_{k=1}^{K}G_{h}(s_{k})^{\\top}(\\Lambda_{h,k}^{a})^{-1}G_{h}(s_{k})\\leq2d\\log(1+K/\\lambda)\\leq2d,\n$$", "text_format": "latex", "page_idx": 62}, {"type": "text", "text": "so grouping the episodes by actions gives ", "page_idx": 62}, {"type": "equation", "text": "$$\n\\left[\\sum_{k\\in[K]}G_{h}(a_{h}^{k})^{\\top}(\\Lambda_{h,k}^{s_{h}^{k}})^{-1}G_{h}(a_{h}^{k})\\right]^{1/2}=\\left[\\sum_{s\\in S}\\sum_{t\\in T_{K,h,a}}G_{h}(a_{h}^{t})^{\\top}(\\Lambda_{h,t}^{a})^{-1}G_{h}(a_{h}^{t})\\right]^{1/2}\\leq\\sqrt{2d S t}\n$$", "text_format": "latex", "page_idx": 62}, {"type": "text", "text": "Thus, ", "page_idx": 62}, {"type": "equation", "text": "$$\n\\begin{array}{r l r}{\\lefteqn{\\sum_{k\\in[K]}\\beta_{k,h}^{s}\\sqrt{G_{h}(a_{h}^{k})^{\\top}(\\Lambda_{h,k}^{s_{h}^{k}})^{-1}G_{h}(a_{h}^{k})}\\le C H(\\sqrt{2d^{3}S K\\iota^{2}}+\\xi\\sqrt{d}C^{\\prime}\\displaystyle\\sum_{s\\in\\mathcal{S}}|T_{k,h}^{s}|\\sqrt{2d})}}\\\\ &{}&{\\le C(\\sqrt{2d^{3}S H T\\iota^{2}}+\\xi\\sqrt{2\\iota}d T.\\qquad\\qquad\\qquad\\qquad}\\end{array}\n$$", "text_format": "latex", "page_idx": 62}, {"type": "text", "text": "Substituting these results into the original regret bound gives ", "page_idx": 62}, {"type": "equation", "text": "$$\nR e g r e t(K)\\leq C^{\\prime\\prime\\prime}(\\sqrt{d^{3}H^{3}S T\\iota^{2}}+d T H\\xi\\sqrt{\\iota}).\n$$", "text_format": "latex", "page_idx": 62}, {"type": "text", "text": "for some constant $C^{\\prime\\prime\\prime}>0$ with probability at least $1-\\delta$ . ", "page_idx": 62}, {"type": "text", "text": "NeurIPS Paper Checklist ", "text_level": 1, "page_idx": 63}, {"type": "text", "text": "1. Claims ", "text_level": 1, "page_idx": 63}, {"type": "text", "text": "Question: Do the main claims made in the abstract and introduction accurately reflect the paper\u2019s contributions and scope? ", "page_idx": 63}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 63}, {"type": "text", "text": "Justification: Our claims in the abstract and introduction reflect our theoretical results. ", "page_idx": 63}, {"type": "text", "text": "Guidelines: ", "page_idx": 63}, {"type": "text", "text": "\u2022 The answer NA means that the abstract and introduction do not include the claims made in the paper.   \n\u2022 The abstract and/or introduction should clearly state the claims made, including the contributions made in the paper and important assumptions and limitations. A No or NA answer to this question will not be perceived well by the reviewers.   \n\u2022 The claims made should match theoretical and experimental results, and reflect how much the results can be expected to generalize to other settings.   \n\u2022 It is fine to include aspirational goals as motivation as long as it is clear that these goals are not attained by the paper. ", "page_idx": 63}, {"type": "text", "text": "2. Limitations ", "text_level": 1, "page_idx": 63}, {"type": "text", "text": "Question: Does the paper discuss the limitations of the work performed by the authors? ", "page_idx": 63}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 63}, {"type": "text", "text": "Justification: We discuss the optimality of our theoretical guarantees with respect to the parameters of the problem. We highlight that our algorithm is sub-optimal with respect to the rank and horizon of the MDP. ", "page_idx": 63}, {"type": "text", "text": "Guidelines: ", "text_level": 1, "page_idx": 63}, {"type": "text", "text": "\u2022 The answer NA means that the paper has no limitation while the answer No means that the paper has limitations, but those are not discussed in the paper.   \n\u2022 The authors are encouraged to create a separate \"Limitations\" section in their paper.   \n\u2022 The paper should point out any strong assumptions and how robust the results are to violations of these assumptions (e.g., independence assumptions, noiseless settings, model well-specification, asymptotic approximations only holding locally). The authors should reflect on how these assumptions might be violated in practice and what the implications would be.   \n\u2022 The authors should reflect on the scope of the claims made, e.g., if the approach was only tested on a few datasets or with a few runs. In general, empirical results often depend on implicit assumptions, which should be articulated.   \n\u2022 The authors should reflect on the factors that influence the performance of the approach. For example, a facial recognition algorithm may perform poorly when image resolution is low or images are taken in low lighting. Or a speech-to-text system might not be used reliably to provide closed captions for online lectures because it fails to handle technical jargon.   \n\u2022 The authors should discuss the computational efficiency of the proposed algorithms and how they scale with dataset size.   \n\u2022 If applicable, the authors should discuss possible limitations of their approach to address problems of privacy and fairness.   \n\u2022 While the authors might fear that complete honesty about limitations might be used by reviewers as grounds for rejection, a worse outcome might be that reviewers discover limitations that aren\u2019t acknowledged in the paper. The authors should use their best judgment and recognize that individual actions in favor of transparency play an important role in developing norms that preserve the integrity of the community. Reviewers will be specifically instructed to not penalize honesty concerning limitations. ", "page_idx": 63}, {"type": "text", "text": "3. Theory Assumptions and Proofs ", "text_level": 1, "page_idx": 63}, {"type": "text", "text": "Question: For each theoretical result, does the paper provide the full set of assumptions and a complete (and correct) proof? ", "page_idx": 63}, {"type": "text", "text": "Answer: [Yes] . ", "page_idx": 64}, {"type": "text", "text": "Justification: We include all assumptions and proofs for each theorem in this work. ", "page_idx": 64}, {"type": "text", "text": "Guidelines: ", "page_idx": 64}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include theoretical results.   \n\u2022 All the theorems, formulas, and proofs in the paper should be numbered and crossreferenced.   \n\u2022 All assumptions should be clearly stated or referenced in the statement of any theorems.   \n\u2022 The proofs can either appear in the main paper or the supplemental material, but if they appear in the supplemental material, the authors are encouraged to provide a short proof sketch to provide intuition.   \n\u2022 Inversely, any informal proof provided in the core of the paper should be complemented by formal proofs provided in appendix or supplemental material.   \n\u2022 Theorems and Lemmas that the proof relies upon should be properly referenced. ", "page_idx": 64}, {"type": "text", "text": "4. Experimental Result Reproducibility ", "text_level": 1, "page_idx": 64}, {"type": "text", "text": "Question: Does the paper fully disclose all the information needed to reproduce the main experimental results of the paper to the extent that it affects the main claims and/or conclusions of the paper (regardless of whether the code and data are provided or not)? ", "page_idx": 64}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 64}, {"type": "text", "text": "Justification: There are no experiments in this paper. ", "page_idx": 64}, {"type": "text", "text": "Guidelines: ", "page_idx": 64}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 If the paper includes experiments, a No answer to this question will not be perceived well by the reviewers: Making the paper reproducible is important, regardless of whether the code and data are provided or not.   \n\u2022 If the contribution is a dataset and/or model, the authors should describe the steps taken to make their results reproducible or verifiable.   \n\u2022 Depending on the contribution, reproducibility can be accomplished in various ways. For example, if the contribution is a novel architecture, describing the architecture fully might suffice, or if the contribution is a specific model and empirical evaluation, it may be necessary to either make it possible for others to replicate the model with the same dataset, or provide access to the model. In general. releasing code and data is often one good way to accomplish this, but reproducibility can also be provided via detailed instructions for how to replicate the results, access to a hosted model (e.g., in the case of a large language model), releasing of a model checkpoint, or other means that are appropriate to the research performed.   \n\u2022 While NeurIPS does not require releasing code, the conference does require all submissions to provide some reasonable avenue for reproducibility, which may depend on the nature of the contribution. For example (a) If the contribution is primarily a new algorithm, the paper should make it clear how to reproduce that algorithm. (b) If the contribution is primarily a new model architecture, the paper should describe the architecture clearly and fully. (c) If the contribution is a new model (e.g., a large language model), then there should either be a way to access this model for reproducing the results or a way to reproduce the model (e.g., with an open-source dataset or instructions for how to construct the dataset). (d) We recognize that reproducibility may be tricky in some cases, in which case authors are welcome to describe the particular way they provide for reproducibility. In the case of closed-source models, it may be that access to the model is limited in some way (e.g., to registered users), but it should be possible for other researchers to have some path to reproducing or verifying the results. ", "page_idx": 64}, {"type": "text", "text": "5. Open access to data and code ", "text_level": 1, "page_idx": 64}, {"type": "text", "text": "Question: Does the paper provide open access to the data and code, with sufficient instructions to faithfully reproduce the main experimental results, as described in supplemental material? ", "page_idx": 65}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 65}, {"type": "text", "text": "Justification: There is no data or code used in this paper. Guidelines: ", "page_idx": 65}, {"type": "text", "text": "\u2022 The answer NA means that paper does not include experiments requiring code.   \n\u2022 Please see the NeurIPS code and data submission guidelines (https://nips.cc/ public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 While we encourage the release of code and data, we understand that this might not be possible, so \u201cNo\u201d is an acceptable answer. Papers cannot be rejected simply for not including code, unless this is central to the contribution (e.g., for a new open-source benchmark).   \n\u2022 The instructions should contain the exact command and environment needed to run to reproduce the results. See the NeurIPS code and data submission guidelines (https: //nips.cc/public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 The authors should provide instructions on data access and preparation, including how to access the raw data, preprocessed data, intermediate data, and generated data, etc.   \n\u2022 The authors should provide scripts to reproduce all experimental results for the new proposed method and baselines. If only a subset of experiments are reproducible, they should state which ones are omitted from the script and why.   \n\u2022 At submission time, to preserve anonymity, the authors should release anonymized versions (if applicable).   \n\u2022 Providing as much information as possible in supplemental material (appended to the paper) is recommended, but including URLs to data and code is permitted. ", "page_idx": 65}, {"type": "text", "text": "6. Experimental Setting/Details ", "text_level": 1, "page_idx": 65}, {"type": "text", "text": "Question: Does the paper specify all the training and test details (e.g., data splits, hyperparameters, how they were chosen, type of optimizer, etc.) necessary to understand the results? ", "page_idx": 65}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 65}, {"type": "text", "text": "Justification: There are no experiments or data used in this paper. ", "page_idx": 65}, {"type": "text", "text": "Guidelines: ", "page_idx": 65}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments. \u2022 The experimental setting should be presented in the core of the paper to a level of detail that is necessary to appreciate the results and make sense of them. \u2022 The full details can be provided either with the code, in appendix, or as supplemental material. ", "page_idx": 65}, {"type": "text", "text": "7. Experiment Statistical Significance ", "text_level": 1, "page_idx": 65}, {"type": "text", "text": "Question: Does the paper report error bars suitably and correctly defined or other appropriate information about the statistical significance of the experiments? ", "page_idx": 65}, {"type": "text", "text": "Answer: [NA] . ", "page_idx": 65}, {"type": "text", "text": "Justification:There are no experiments or data used in this paper. ", "page_idx": 65}, {"type": "text", "text": "Guidelines: ", "page_idx": 65}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The authors should answer \"Yes\" if the results are accompanied by error bars, confidence intervals, or statistical significance tests, at least for the experiments that support the main claims of the paper.   \n\u2022 The factors of variability that the error bars are capturing should be clearly stated (for example, train/test split, initialization, random drawing of some parameter, or overall run with given experimental conditions).   \n\u2022 The method for calculating the error bars should be explained (closed form formula, call to a library function, bootstrap, etc.)   \n\u2022 The assumptions made should be given (e.g., Normally distributed errors).   \n\u2022 It should be clear whether the error bar is the standard deviation or the standard error of the mean.   \n\u2022 It is OK to report 1-sigma error bars, but one should state it. The authors should preferably report a 2-sigma error bar than state that they have a $96\\%$ CI, if the hypothesis of Normality of errors is not verified.   \n\u2022 For asymmetric distributions, the authors should be careful not to show in tables or figures symmetric error bars that would yield results that are out of range (e.g. negative error rates).   \n\u2022 If error bars are reported in tables or plots, The authors should explain in the text how they were calculated and reference the corresponding figures or tables in the text. ", "page_idx": 65}, {"type": "text", "text": "", "page_idx": 66}, {"type": "text", "text": "8. Experiments Compute Resources ", "text_level": 1, "page_idx": 66}, {"type": "text", "text": "Question: For each experiment, does the paper provide sufficient information on the computer resources (type of compute workers, memory, time of execution) needed to reproduce the experiments? ", "page_idx": 66}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 66}, {"type": "text", "text": "Justification: There are no experiments, so there were no computational resources needed. Guidelines: ", "page_idx": 66}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The paper should indicate the type of compute workers CPU or GPU, internal cluster, or cloud provider, including relevant memory and storage.   \n\u2022 The paper should provide the amount of compute required for each of the individual experimental runs as well as estimate the total compute.   \n\u2022 The paper should disclose whether the full research project required more compute than the experiments reported in the paper (e.g., preliminary or failed experiments that didn\u2019t make it into the paper). ", "page_idx": 66}, {"type": "text", "text": "9. Code Of Ethics ", "text_level": 1, "page_idx": 66}, {"type": "text", "text": "Question: Does the research conducted in the paper conform, in every respect, with the NeurIPS Code of Ethics https://neurips.cc/public/EthicsGuidelines? ", "page_idx": 66}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 66}, {"type": "text", "text": "Justification: The contributions of this paper are theoretical results, and we believe that they will not lead to societal harm. ", "page_idx": 66}, {"type": "text", "text": "Guidelines: ", "page_idx": 66}, {"type": "text", "text": "\u2022 The answer NA means that the authors have not reviewed the NeurIPS Code of Ethics.   \n\u2022 If the authors answer No, they should explain the special circumstances that require a deviation from the Code of Ethics.   \n\u2022 The authors should make sure to preserve anonymity (e.g., if there is a special consideration due to laws or regulations in their jurisdiction). ", "page_idx": 66}, {"type": "text", "text": "10. Broader Impacts ", "text_level": 1, "page_idx": 66}, {"type": "text", "text": "Question: Does the paper discuss both potential positive societal impacts and negative societal impacts of the work performed? ", "page_idx": 66}, {"type": "text", "text": "Answer: [Yes] . ", "page_idx": 66}, {"type": "text", "text": "Justification: We mention potential scenarios in which one benefits from our methodology. As this paper focuses on foundational research by proving theoretical bounds on transfer reinforcement learning, we do not believe that there are any direct paths to negative applications. ", "page_idx": 66}, {"type": "text", "text": "Guidelines: ", "page_idx": 66}, {"type": "text", "text": "\u2022 The answer NA means that there is no societal impact of the work performed. \u2022 If the authors answer NA or No, they should explain why their work has no societal impact or why the paper does not address societal impact. ", "page_idx": 66}, {"type": "text", "text": "\u2022 Examples of negative societal impacts include potential malicious or unintended uses (e.g., disinformation, generating fake profiles, surveillance), fairness considerations (e.g., deployment of technologies that could make decisions that unfairly impact specific groups), privacy considerations, and security considerations.   \n\u2022 The conference expects that many papers will be foundational research and not tied to particular applications, let alone deployments. However, if there is a direct path to any negative applications, the authors should point it out. For example, it is legitimate to point out that an improvement in the quality of generative models could be used to generate deepfakes for disinformation. On the other hand, it is not needed to point out that a generic algorithm for optimizing neural networks could enable people to train models that generate Deepfakes faster.   \n\u2022 The authors should consider possible harms that could arise when the technology is being used as intended and functioning correctly, harms that could arise when the technology is being used as intended but gives incorrect results, and harms following from (intentional or unintentional) misuse of the technology.   \n\u2022 If there are negative societal impacts, the authors could also discuss possible mitigation strategies (e.g., gated release of models, providing defenses in addition to attacks, mechanisms for monitoring misuse, mechanisms to monitor how a system learns from feedback over time, improving the efficiency and accessibility of ML). ", "page_idx": 67}, {"type": "text", "text": "11. Safeguards ", "text_level": 1, "page_idx": 67}, {"type": "text", "text": "Question: Does the paper describe safeguards that have been put in place for responsible release of data or models that have a high risk for misuse (e.g., pretrained language models, image generators, or scraped datasets)? ", "page_idx": 67}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 67}, {"type": "text", "text": "Justification: Our paper poses no such risks as are contributions are strictly theoretical. Guidelines: ", "page_idx": 67}, {"type": "text", "text": "\u2022 The answer NA means that the paper poses no such risks.   \n\u2022 Released models that have a high risk for misuse or dual-use should be released with necessary safeguards to allow for controlled use of the model, for example by requiring that users adhere to usage guidelines or restrictions to access the model or implementing safety filters.   \n\u2022 Datasets that have been scraped from the Internet could pose safety risks. The authors should describe how they avoided releasing unsafe images.   \n\u2022 We recognize that providing effective safeguards is challenging, and many papers do not require this, but we encourage authors to take this into account and make a best faith effort. ", "page_idx": 67}, {"type": "text", "text": "12. Licenses for existing assets ", "text_level": 1, "page_idx": 67}, {"type": "text", "text": "Question: Are the creators or original owners of assets (e.g., code, data, models), used in the paper, properly credited and are the license and terms of use explicitly mentioned and properly respected? ", "page_idx": 67}, {"type": "text", "text": "Answer: [NA] ", "text_level": 1, "page_idx": 67}, {"type": "text", "text": "Justification: The paper does not use existing assets. ", "page_idx": 67}, {"type": "text", "text": "Guidelines: ", "page_idx": 67}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not use existing assets.   \n\u2022 The authors should cite the original paper that produced the code package or dataset.   \n\u2022 The authors should state which version of the asset is used and, if possible, include a URL.   \n\u2022 The name of the license (e.g., CC-BY 4.0) should be included for each asset.   \n\u2022 For scraped data from a particular source (e.g., website), the copyright and terms of service of that source should be provided.   \n\u2022 If assets are released, the license, copyright information, and terms of use in the package should be provided. For popular datasets, paperswithcode.com/datasets has curated licenses for some datasets. Their licensing guide can help determine the license of a dataset.   \n\u2022 For existing datasets that are re-packaged, both the original license and the license of the derived asset (if it has changed) should be provided.   \n\u2022 If this information is not available online, the authors are encouraged to reach out to the asset\u2019s creators. ", "page_idx": 67}, {"type": "text", "text": "", "page_idx": 68}, {"type": "text", "text": "13. New Assets ", "text_level": 1, "page_idx": 68}, {"type": "text", "text": "Question: Are new assets introduced in the paper well documented and is the documentation provided alongside the assets? ", "page_idx": 68}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 68}, {"type": "text", "text": "Justification: Our paper\u2019s contribution is theoretical and does not realease new assets. Guidelines: ", "page_idx": 68}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not release new assets.   \n\u2022 Researchers should communicate the details of the dataset/code/model as part of their submissions via structured templates. This includes details about training, license, limitations, etc.   \n\u2022 The paper should discuss whether and how consent was obtained from people whose asset is used.   \n\u2022 At submission time, remember to anonymize your assets (if applicable). You can either create an anonymized URL or include an anonymized zip file. ", "page_idx": 68}, {"type": "text", "text": "14. Crowdsourcing and Research with Human Subjects ", "text_level": 1, "page_idx": 68}, {"type": "text", "text": "Question: For crowdsourcing experiments and research with human subjects, does the paper include the full text of instructions given to participants and screenshots, if applicable, as well as details about compensation (if any)? ", "page_idx": 68}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 68}, {"type": "text", "text": "Justification: This paper does not involve crowdsourcing nor research with human subjects. Guidelines: ", "page_idx": 68}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Including this information in the supplemental material is fine, but if the main contribution of the paper involves human subjects, then as much detail as possible should be included in the main paper.   \n\u2022 According to the NeurIPS Code of Ethics, workers involved in data collection, curation, or other labor should be paid at least the minimum wage in the country of the data collector. ", "page_idx": 68}, {"type": "text", "text": "15. Institutional Review Board (IRB) Approvals or Equivalent for Research with Human Subjects ", "text_level": 1, "page_idx": 68}, {"type": "text", "text": "Question: Does the paper describe potential risks incurred by study participants, whether such risks were disclosed to the subjects, and whether Institutional Review Board (IRB) approvals (or an equivalent approval/review based on the requirements of your country or institution) were obtained? ", "page_idx": 68}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 68}, {"type": "text", "text": "Justification: This paper does not involve crowdsourcing nor research with human subjects. Guidelines: ", "page_idx": 68}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Depending on the country in which research is conducted, IRB approval (or equivalent) may be required for any human subjects research. If you obtained IRB approval, you should clearly state this in the paper.   \n\u2022 We recognize that the procedures for this may vary significantly between institutions and locations, and we expect authors to adhere to the NeurIPS Code of Ethics and the guidelines for their institution.   \n\u2022 For initial submissions, do not include any information that would break anonymity (if applicable), such as the institution conducting the review. ", "page_idx": 68}]