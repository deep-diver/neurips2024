[{"type": "text", "text": "FuseAnyPart: Diffusion-Driven Facial Parts Swapping via Multiple Reference Images ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Zheng Yu\u2217\u2020 Shanghai Jiao Tong University & Alibaba Group cs-yuzheng@sjtu.edu.cn ", "page_idx": 0}, {"type": "text", "text": "Yaohua Wang \\* \u2021 Alibaba Group xiachen.wyh@alibaba-inc.com ", "page_idx": 0}, {"type": "text", "text": "Siying Cui \u2020 Peking University & Alibaba Group cuisiying.csy@alibaba-inc.com ", "page_idx": 0}, {"type": "text", "text": "Aixi Zhang Alibaba Group aixi.zhax@alibaba-inc.com ", "page_idx": 0}, {"type": "text", "text": "Wei-Long Zheng Shanghai Jiao Tong University weilong@sjtu.edu.cn ", "page_idx": 0}, {"type": "text", "text": "Senzhang Wang Central South University szwang@csu.edu.cn ", "page_idx": 0}, {"type": "image", "img_path": "X2UMdvcmMo/tmp/8ec0def6ce4d61eec59b10af8a0b20014bb76a10fbe79dc58b247c82ae77c16b.jpg", "img_caption": ["Figure 1: Results of facial parts swapping using the proposed FuseAnyPart at $512\\times512$ resolution. The swapped face (central image) is generated by fusing the original face (top-left image) with three facial part reference images (bottom-left, top-right, bottom-right). Notably, FuseAnyPart can seamlessly blend facial parts from multiple reference images with significant differences in appearance, producing high-fidelity and natural-looking swapped faces. "], "img_footnote": [], "page_idx": 0}, {"type": "text", "text": "Abstract ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Facial parts swapping aims to selectively transfer regions of interest from the source image onto the target image while maintaining the rest of the target image unchanged. Most studies on face swapping designed specifically for full-face swapping, are either unable or significantly limited when it comes to swapping individual facial parts, which hinders fine-grained and customized character designs. However, designing such an approach specifically for facial parts swapping is challenged by a reasonable multiple reference feature fusion, which needs to be both efficient and effective. To overcome this challenge, FuseAnyPart is proposed to facilitate the seamless \"fuse-any-part\" customization of the face. In FuseAnyPart, facial parts from different people are assembled into a complete face in latent space within the Mask-based Fusion Module. Subsequently, the consolidated feature is dispatched to the Addition-based Injection Module for fusion within the UNet of the diffusion model to create novel characters. Extensive experiments qualitatively and quantitatively validate the superiority and robustness of FuseAnyPart. Source codes are available at https://github.com/Thomas-wyh/FuseAnyPart. ", "page_idx": 0}, {"type": "text", "text": "", "page_idx": 1}, {"type": "text", "text": "1 Introduction ", "text_level": 1, "page_idx": 1}, {"type": "text", "text": "Imagine a person who possesses the face of Elon Musk, the eyes of Mark Zuckerberg, the nose of Sam Altman, and the mouth of Kobe Bryant. What would the visual composite of such a person look like? Currently, this dream can be realized through the facial parts swapping technology as shown in Fig. 1. Different from traditional face swapping, which is coarse and typically replaces the entire face at once, facial parts swapping aims to transfer the individual facial components, e.g., nose, mouth or eyes from varied sources onto the target image while maintaining the rest of the target image unchanged. A growing interest in facial parts swapping technology has emerged due to its broad applications such as innovative character creation, popular entertainment, privacy protection and beyond [29, 20]. ", "page_idx": 1}, {"type": "text", "text": "Most of the studies so far have primarily focused on full-face swapping, and can be roughly divided into GAN-based and diffusion-based approaches. The GAN-based methods [7, 34, 27, 15, 12] usually perform face swapping by extracting the identity feature from the source images and then injecting them into generative adversarial networks [6]. Nevertheless, the GAN-based techniques may not succeed in completely transferring the identity features, especially when there is a significant difference in shape between the source and the target. In addition, the GAN-based methods often involve an array of losses about image fidelity, identity, and facial attributes to guide the training, which increases the complexity of the training process. On the other hand, diffusion-based models [23, 24, 36, 13, 31, 26, 33] have demonstrated a powerful capability in generating images with high resolution and complex scenes. Some efforts try to swap face [38, 18] through diffusion models, achieving pleasant results. ", "page_idx": 1}, {"type": "text", "text": "However, the aforementioned methods, designed for full-face swapping, are either unable or significantly limited when it comes to swapping individual facial parts. If one needs to replace a facial part, it is only possible to swap the entire face, rather than independently swapping one or several facial parts individually, let alone the facial parts from different individuals. This high degree of coupling poses an inconvenience for users who seek more fine-grained and customized designs. Therefore, the focus on face-swapping shifts from an identity-centric to an attribute-level perspective. ", "page_idx": 1}, {"type": "text", "text": "The primary challenge in facial parts swapping lies in the fusion mechanism. Popular face-swapping techniques [15, 38, 36, 18] perform the fusion of source and target images in the latent space for harmonious generated images. Therefore, the feature fusion mechanism becomes critical in affecting the quality of the generated images. In the facial parts swapping task, the number of source images increases from one to multiple, further complicating the fusion process and making this issue more prominent. Previous methods [36, 13] utilize adapters implemented by a cross-attention mechanism to fuse reference information into the UNet of diffusion models. However, as the cross-attention is initially designed for multi-modal tasks [24], like text and image, it may be sub-optimal for facial parts swapping due to the difficulty in aligning fine-grained facial region features. What is more, the inclusion of multiple references increases computational needs, thus efficient fusion is essential. ", "page_idx": 1}, {"type": "text", "text": "To tackle these challenges, an innovative diffusion-driven approach dubbed FuseAnyPart is proposed to facilitate the seamless \"fuse-any-part\" customization of faces. In FuseAnyPart, a facial image is initially detected by an open-set detector to derive its various facial part masks. Then an image encoder extracts the facial part features based on the facial image and the aforementioned masks. Subsequently, these facial part features are assembled according to the masks within the Mask-based Fusion Module included in FuseAnyPart to generate a complete face in latent space. After this step, the cohesive feature is forwarded to the Addition-based Injection Module proposed by FuseAnyPart for fusion within the UNet of the diffusion model. The Addition-based Injection Module adds a minimal amount of parameters yet is highly effective in preserving the positional information and fine details of the image features, which demonstrates obvious superiority compared to the conventional cross-attention mechanism. During the training stage, FuseAnyPart is trained by reconstructing a facial image conditioned on different facial parts, inspired by [15, 38]. In the inference stage, facial parts from images of various people can be fed into FuseAnyPart to create a novel character. ", "page_idx": 1}, {"type": "text", "text": "", "page_idx": 2}, {"type": "text", "text": "Overall, the contributions can be summarized as follows: (1) To the best of our knowledge, FuseAnyPart is the first diffusion-based work specifically designed for facial parts swapping, which is capable of simultaneous, multi-source and fine-grained facial parts swapping. (2) The proposed Masked-based Fusion Module in FuseAnyPart allows dynamically aggregating specific parts from different faces in latent space. Then, the Addition-based Injection Module of FuseAnyPart injects this conditional information into UNet, which is more effective and efficient than the conventional cross-attention-based adapter methods. (3) Extensive experiments validate the superiority of FuseAnyPart. Ablation studies confirm the soundness of our design choices and the robustness of our proposed approach. ", "page_idx": 2}, {"type": "text", "text": "2 Related Work ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "Image Generation with Multiple References. InstantBooth [26], InstanID [31], and IDAdapter [3] use the average feature of all reference images, which contributes to improving generation quality. And photoMaker [13] generates an ID embedding by stacking embeddings from multiple ID reference images, which results in improved ID representation. Moreover, it can create a mixed ID embedding by controlling the proportion of identity images within the input reference image collection. Although the aforementioned methods introduce a multiple reference image mechanism, the role of these reference images is similar to that of providing a single reference image, affecting only the generation of a specific subject. FastComposer [33], on the other hand, achieves the generation of multiple subjects by injecting different reference image features into distinct word embeddings. Currently, image generation using multiple reference images remains an area ripe for exploration, such as generating human faces with multiple inputs. ", "page_idx": 2}, {"type": "text", "text": "Facial Parts Swapping. In recent years, region-controllable face swapping has emerged as a fascinating subfield within the broader domain of facial manipulation and generation. This technology enables precise control over specific regions of a face in an image, allowing the exchange or modification of features such as the eyes, nose, or mouth, while maintaining the integrity of the original image\u2019s context. The E4S model [15] achieves precise editing results by manipulating masks of specific regions, such as the eyes or lips, using a reference image as a guide. Meanwhile, Diffswap [38] is a technique that selectively determines the regions to swap by constructing masks that cover varying facial areas. Although these methods are capable of transferring specific facial regions from a source image to a target image, the results often exhibit unnatural boundaries. Furthermore, to achieve the replacement of facial features from multiple reference images onto a single face, multiple iterations are typically required, complicating the process. This iterative approach can be time-consuming and may not consistently produce seamless, natural-looking results, indicating that there is still room for improvement in the field of region-controllable face swapping technology. ", "page_idx": 2}, {"type": "text", "text": "3 Method ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "3.1 Preliminary ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "StableDiffusion. Our model is based on the StableDiffusion [24] model, which progresses the diffusion process in low-dimensional latent space with a pre-trained autoencoder. Using a latent representation, StableDiffusion can maintain the essential features and structure of the data while requiring fewer steps and less time to generate high-quality samples. First, the variational autoencoder compresses the input image $x$ to a latent representation $z_{0}$ , which is gradually added Gaussian noise with a fixed Markov chain of $T$ steps. Let $z_{t}=\\alpha_{t}z_{0}+\\sigma_{t}\\epsilon$ be the noised data at the t-th timestep, where $\\alpha_{t},\\sigma_{t}$ are predefined functions of $t$ and $\\epsilon\\in\\mathcal{N}(0,I)$ , UNet $\\epsilon_{\\theta}$ is responsible for the denoising process by predicting the noise $\\epsilon$ . The denoising process can be conditioned by the additional condition $C$ . The training objective is to minimize the ELBO of the denoising process, which is defined as: ", "page_idx": 2}, {"type": "equation", "text": "$$\n\\mathcal{L}=\\mathbb{E}_{z_{t},t,C,\\epsilon}[||\\epsilon-\\epsilon_{\\theta}(z_{t},t,C)||_{2}^{2}].\n$$", "text_format": "latex", "page_idx": 2}, {"type": "text", "text": "During inference time, UNet gradually predicts the noise $\\epsilon_{\\theta}(x_{t},t)$ and recovers the initial latent representation $z_{0}$ from random noise $z_{T}\\in\\mathcal{N}(0,I)$ . Finally, the image is generated by mapping $z_{0}$ back to pixel space with the variational autoencoder. ", "page_idx": 2}, {"type": "image", "img_path": "X2UMdvcmMo/tmp/d97bc6e7439a9f2e11d308e33ba5d1cdfd0358e87b2d40466e407ce4db4e5721.jpg", "img_caption": ["Figure 2: Illustration of FuseAnyPart. The process begins with an open-set detector identifying a facial image to obtain various facial part masks. Following this, an image encoder uses these masks and the facial image to derive the corresponding facial part feature. These facial part features and masks are then fed into the Mask-based Fusion Module to piece together a complete face in latent space. Subsequently, the consolidated feature is dispatched to the Addition-based Injection Module for fusion within the UNet of the diffusion model. "], "img_footnote": [], "page_idx": 3}, {"type": "text", "text": "Image Prompt Adapter. Image prompt adapter [36] is an innovative approach to incorporate image features into the generation process without model fine-tuning for each new concept. This approach addresses the challenge faced by previous methods, which struggled to effectively extract and utilize detailed image features from image prompts. Similarly to text prompts, image prompts can also condition the generative process through the cross-attention mechanism. Specifically, a decoupled cross-attention strategy is employed in which an additional cross-attention layer is added to every original cross-attention layer to inject image features. The output of this new cross-attention layer can be articulated as ", "page_idx": 3}, {"type": "equation", "text": "$$\nZ^{n e w}=\\mathbf{Attention}(Q,K,V)+\\lambda\\cdot\\mathbf{Attention}(Q,K^{i},V^{i}),\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "where $\\lambda$ is weight factor, Attention $(Q,K^{i},V^{i})$ is cross-attention of the new added cross-attention layer, $K^{i}=c_{i}\\bar{W}_{k}^{i}$ and $V^{i}=c_{i}W_{v}^{i}$ are key and values matrices of the corresponding operation. $c_{i}$ are the image features, and $W_{k}^{i}$ and $W_{v}^{i}$ are the relevant weight matrices. ", "page_idx": 3}, {"type": "text", "text": "3.2 Overview ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "The goal of facial parts swapping is to selectively transfer regions of interest such as the eyebrows, eyes, nose, or mouth from the source image onto the target image while maintaining the rest of the image unchanged. Some methods [15, 8] swap region feature obtained by mask pooling to facilitate facial parts swapping and use masks as structure guidance to maintain detail and coherence in the generated results. However, the applicability of this approach is limited in advanced StableDiffusion models utilizing cross-attention mechanisms, due to the difficulty in aligning fine-grained facial region features with the latent features in UNet. Consequently, it is necessary to fine-tune the entire SD model with a significant volume of data. Additionally, there is a notable paucity of methodologies that permit the incorporation of multiple source images to selectively transfer features from sources onto a target image in one step. ", "page_idx": 3}, {"type": "text", "text": "To address these problems, we map a face image into multiple non-overlapping region image features and perform mask-based fusion at the feature map level between the source and target image features. This fusion results in new facial image features, which are then integrated into the generation process through an Addition-based Injection Module. ", "page_idx": 3}, {"type": "text", "text": "3.3 Facial Feature Decomposition and Aggregation ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "For simplicity, we consider three regions for swapping including the eyes (including the eyebrows), nose, and mouth. We use an open-set detection model to get region masks $M_{e y e s}$ , $M_{n o s e}$ , $M_{m o u t h}$ , and the remaining region mask is $M_{r e m a i n}\\,=\\,\\bar{M}_{e y e s}\\odot\\bar{M}_{n o s e}\\odot\\bar{M}_{m o u t h}$ . Let $\\mathcal{M}=\\{M_{e y e s},M_{n o s e},M_{m o u t h},M_{r e m a i n}\\}$ be the region masks, a given face image $I$ can be represented as the union of multiple regional images: $\\mathcal{T}=\\{I_{i}\\}_{i=0}^{3}$ , where $I_{i}=I\\odot\\mathcal{M}_{i}$ . ", "page_idx": 4}, {"type": "text", "text": "Following most of the previous methods [2, 3, 37, 32], we utilize a pre-trained CLIP [22] image encoder $\\phi$ to extract image representations from regional images. Contrary to the preceding work that harnesses the more abstract, global, and high-level features from the last layer, we use the uncompressed feature map from the penultimate layer, which retains greater spatial information and finer details. For a face image $I$ , its feature representation can be decomposed into multiple components $\\mathcal{F}=\\{f_{i}\\}_{i=0}^{3}$ , where $f_{i}=\\phi(I_{i})$ . Replacement is conducted at the feature map level, where a target image\u2019s features $\\mathcal{F}_{t}\\,=\\,\\{\\,f_{t_{i}}\\}_{i=0}^{3}$ , with $i\\,=\\,0,1,2$ , are replaceable, corresponding respectively to eyes, nose, and mouth. Mathematically, the feature replacement between target image features $\\dot{\\mathcal{F}_{t}}=\\dot{\\{f_{t_{i}}\\}}_{i=0}^{3}$ and source image features $\\dot{\\mathcal{F}}_{s}=\\{f_{s_{i}}\\}_{i=0}^{3}$ is realized in the Mask-based Fusion Module, described as follows: ", "page_idx": 4}, {"type": "equation", "text": "$$\nf_{t_{i}}^{\\prime}=\\left\\{\\!\\!\\begin{array}{l l}{f_{t_{i}},}&{\\!R_{i}=T r u e}\\\\ {f_{t_{i}}\\odot\\bar{\\mathcal{M}}_{t_{i}}+\\mathbf{G}(f_{s_{i}}\\odot\\mathcal{M}_{s_{i}},\\mathcal{M}_{t_{i}},\\mathcal{M}_{s_{i}}),}&{\\!R_{i}\\neq T r u e}\\end{array}\\!\\!\\right.\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "where $i\\in\\{0,1,2,3\\}$ , $R_{i}$ indicates whether the region feature $f_{g_{i}}$ is replaced by $f_{s_{i}}$ . $\\mathbf{G}(I,m_{1},m_{2})$ is an interpolation function that resizes the region covered by mask $m_{1}$ in image $I$ to fit the region of mask $m_{2}$ . The resulting features $\\mathcal{F}_{t}^{\\prime}=\\{\\bar{f}_{t_{i}}^{\\prime}\\}_{i=0}^{3}$ are aggregated and then fed into Multi-Layer Perceptron to generate the final condition feature map, which is input into the UNet as $\\begin{array}{r}{C=\\mathbf{M}\\mathbf{L}\\mathbf{P}(\\sum_{i=0}^{3}\\mathcal{F}_{t_{i}}^{\\prime}\\odot\\mathcal{M}_{t_{i}})}\\end{array}$ providing the conditional information to guide the generative network. ", "page_idx": 4}, {"type": "text", "text": "3.4 Addition-based Injection ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "It has been discussed for a long time how to inject image features into the UNet using a crossattention mechanism, and there are two principal methodologies. One is a direct method that feeds the concatenation of image features and text features into the layers of cross-attention. However, this method can be ineffective when image features are misaligned with textual features in the concatenation process. The other one, which has been widely adopted in numerous works, employs adapter modules with decoupled cross-attention [36]. Nevertheless, the cross mechanism still faces the challenge of inaccurate feature fusion because attention maps may fail to focus appropriately on the correct regions. ", "page_idx": 4}, {"type": "text", "text": "Thus, we propose the Addition-based Injection Module for integrating image features into the UNet which directly adds fine-grained image features to latent features within the UNet. Specifically, the output of the injected layer is described as follows: ", "page_idx": 4}, {"type": "equation", "text": "$$\nZ^{\\prime}=Z+\\lambda\\cdot\\mathbf{Inter}(\\mathbf{Linear}(C)),\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "where $Z$ is the latent feature within the UNet, $C$ is the swapped face image feature map that servers as the condition information, Linear $(\\cdot)$ is a linear layer, $\\mathbf{Inter}(\\cdot)$ is a function which is capable of resizing $C$ to match the dimensions of $Z$ and $\\lambda$ is weight factor. It is feasible because the latent space features within the UNet also comprise a feature map that contains positional information, which has a corresponding spatial relationship with the condition feature map $C$ . By adding fine-grained image features at their respective locations, we ensure alignment of the newly introduced features with the original latent space features in terms of position. Furthermore, the injection of such image features is not confined exclusively to the cross-attention layers; it can be integrated at any level within the UNet architecture. Compared to the cross-attention mechanism, this method reduces the number of added parameters and computational load while increasing the flexibility and controllability of feature injection. It enables the model to be fine-tuned with less training data, enhancing efficiency without compromising on the richness of the generated details. ", "page_idx": 4}, {"type": "text", "text": "3.5 Training and Inference ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "To preserve the regions of the face image that are not subject to replacement, FuseAnyPart follows the practice of [1]. Specifically, We concatenate the latent vector $x_{m}$ , derived from the masked image $\\mathcal{T}_{t_{3}}$ , the associated mask $\\bar{\\mathcal{M}}_{t_{3}}$ , and the noised latent vector $z_{t}$ to form a new latent vector $z_{t}^{\\prime}\\stackrel{}{=}\\mathrm{Concat}(x_{m},\\bar{\\mathcal{M}}_{t_{3}},z_{t})$ , which is fed into a convolution layer for dimension adjustment. The feature vector $\\hat{z}_{t}=\\mathbf{Conv}(z_{t}^{\\prime})$ is subsequently introduced into the UNet, serving as the query. Our training objective is similar to the original StableDiffusion model, formulated as: ", "page_idx": 4}, {"type": "text", "text": "", "page_idx": 5}, {"type": "equation", "text": "$$\n\\mathcal{L}=\\mathbb{E}_{z_{t},t,x_{m},\\bar{\\mathcal{M}}_{t_{3}},C,\\epsilon}[||\\epsilon-\\epsilon_{\\theta}(z_{t},t,x_{m},\\bar{\\mathcal{M}}_{t_{3}},C)||_{2}^{2}].\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "During the inference phase, our model possesses the capability to transfer facial regions from multiple source images onto a target image. By deconstructing and reassembling facial image features, we can construct mixed facial features, facilitating flexible and controllable facial parts swapping. ", "page_idx": 5}, {"type": "text", "text": "4 Experiment ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "Dataset. We train our model on the CelebA-HQ [11] dataset. The CelebA-HQ dataset contains 30,000 high-resolution face images of celebrities widely used for face generation and face swapping tasks. This dataset has been pre-processed and aligned, and is available in three different resolutions. In our experiments, we use the $1024\\times1024$ resolution. Our evaluation set is sampled from the FaceForensics $^{++}$ [25] dataset, which contains 1,000 videos. We randomly sample 10 frames from each video and obtain 10,000 images. Then we use GPEN [35] for portrait enhancement and crop and align these images by landmarks to the resolution of $512\\times512$ . Additionally, we collected some high-quality face images from the internet intended for qualitative visual results. ", "page_idx": 5}, {"type": "text", "text": "Implementation Details. Our implementation is based on HuggingFace diffusers [30] library and we use StableDiffusion v1-5 [24] and OpenAI\u2019s clip-vit-large-path14 vison model [22]. We train our model on 16 NVIDIA A100 GPUs (80GB) with a batch size of 16 per GPU using the AdamW optimizer [16] with a constant learning rate of 1e-4 and weight decay of 0.01. During training, facial part reference images are randomly sampled from images with the same ID, and the target image is consistent with the face reference image. During the inference stage, we use the DDIM [28] sampler with 50 steps and set $\\lambda=1.0$ . Since we do not use a text prompt, we set the text prompt to empty. ", "page_idx": 5}, {"type": "text", "text": "4.1 Qualitative Comparisons ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "We collected a series of high-quality celebrity images from the Internet to conduct qualitative experiments. To demonstrate the effectiveness of our approach, we have structured the qualitative experiments into three sets: fuse any part, multiple parts replacement, and multiple parts replacement with reference images in different styles. ", "page_idx": 5}, {"type": "text", "text": "4.1.1 Fuse Any Part ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "With grounding-dino [14], an open-set object detection model, our method is capable of extracting region-specific features of faces based on text, such as \"eyes\", \"nose\", and \"mouth\". Limited by the performance of grounding-dino, the \"eyes\" include the \"eyebrows\" in the subsequent chapters. In this paper, \"reference image\" is used to describe both the source and target images. The face reference image is the target, while the facial part reference image is the source. ", "page_idx": 5}, {"type": "text", "text": "We select eyes, nose, and mouth for attribute-level facial parts swapping. For single part replacement, we compare our method with StableDiffusion (SD)[24], IP-Adapter [36], FacePartsSwap [5], E4S [15] and Diffswap [38], and the results for eyes, nose and mouth are presented respectively in Fig. 3, Fig. 8 and Fig. 9. Since SD and IP-Adapter aren\u2019t designed for facial parts replacement, we cut out the desired attributes from the source image and overlaid them onto the target image, resulting in a pixel blend image, the inputs are source-target image pairs. By utilizing SD\u2019s image-to-image generation function with the denoising strength set to 0.5, we can reconstruct the spliced image. For the IP-Adapter, the spliced image serves as an image prompt, acting as additional information to condition the generation process. FacePartsSwap specifically focuses on exchanging facial parts and E4S and Diffswap are face swapping methods that can utilize different masks during the inference process to achieve partial facial region replacement. ", "page_idx": 5}, {"type": "text", "text": "4.1.2 Multiple Parts Replacement ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "Multi-attribute replacement differs from swapping the entire facial information onto a target image, as it only involves replacing certain attributes within their corresponding regions, and the number of replaced attributes can be arbitrary. We demonstrate the simultaneous replacement of eyes, nose and mouth. Fig. 4 showcases the results of multi-attribute replacement using source-target pairs. ", "page_idx": 5}, {"type": "image", "img_path": "X2UMdvcmMo/tmp/8ffe854e09a15a0a24937524de698adf2f64d5ebe1bf6471ea6ccc65d8bdb7ed.jpg", "img_caption": ["Figure 3: Qualitative comparison of eyes swapping. Our method produces high-fidelity results that maintain the consistency of facial features while ensuring a natural appearance. "], "img_footnote": [], "page_idx": 6}, {"type": "image", "img_path": "X2UMdvcmMo/tmp/a8953ee4a358f7bae67d5c5804b9169b1803fd4d75868e41f896753a222f2a91.jpg", "img_caption": ["Figure 4: Qualitative comparison of multiple facial parts swapping with a single reference face. Our method can naturally replace multiple facial parts of one face with those of another and better preserve both the characteristics and the facial part shape. More results are presented in Fig. 10. "], "img_footnote": [], "page_idx": 6}, {"type": "text", "text": "", "page_idx": 6}, {"type": "text", "text": "Both the SD and IP-Adapter struggle to maintain the non-replacement areas unchanged, and the similarity of the replaced attributes is not high, highlighting the limitations of pixel space manipulations. While FacePartsSwap and E4S can retain a higher degree of attribute similarity, the replacement results often appear visually inconstant and forced, particularly when there is a significant difference between the source image and the target image, such as in skin tone or facial angle. In contrast, the replacement effect of Diffswap is not pronounced. ", "page_idx": 6}, {"type": "text", "text": "Our method outperforms these approaches by offering better consistency across both the replaced attributes and the unaffected areas, leading to a more seamless and natural integration of the replaced features regardless of discrepancies in the reference images. Moreover, Fig. 5 demonstrates the results when each replaced attribute originates from different source images. Our method still significantly surpasses other approaches, as it can combine distinct attribute features and generate natural-looking facial photos. This superior performance indicates that our method effectively extracts and integrates the characteristics of individual attributes, even when dealing with varied sources. It reinforces our method\u2019s flexibility and robustness in handling complex face manipulation scenarios where each facial feature may require a different treatment based on its unique reference image. ", "page_idx": 6}, {"type": "image", "img_path": "X2UMdvcmMo/tmp/e28148723440156d72de777818f9d6f4e2475f0527ceb91f18d214c43a9c012a.jpg", "img_caption": ["Figure 5: Qualitative comparison of multi swapping with multiple reference faces. Our method remains robust to different appearances of various reference facial parts. "], "img_footnote": [], "page_idx": 7}, {"type": "image", "img_path": "X2UMdvcmMo/tmp/da37f1f46df1aa3d40a99b6f39ab18ee92862ac448cf39c8412e694e1ab6aac1.jpg", "img_caption": ["Figure 6: Facial parts swapping on images with different styles. As an extended application, FuseAnyPart can use the facial parts of reference images with different styles to generate harmonious faces without changing the style of the target face. We show that the features of the facial parts and the image style can be well decoupled. "], "img_footnote": [], "page_idx": 7}, {"type": "text", "text": "4.1.3 Fusion Across Different Styles ", "text_level": 1, "page_idx": 7}, {"type": "text", "text": "Fig. 6 shows the results of our method performing multi-attribute replacements on images spanning various styles. This is a limitation often encountered in many face swapping methods, as they typically rely on facial segmentation models which are bound by the constraints of their training data and tend to have poor generalization on unseen data. Beneftiing from the open-set detection model, our method can extract any regional feature from the reference images, which helps our method to generalize well on the data with different distributions. ", "page_idx": 7}, {"type": "text", "text": "To get images in different styles, we apply a style modification model [19] to real photographs to generate a series of images in different styles, including cartoon, 3D, sketch, and more. We then use these stylized images as references to perform multi-attribute replacements following the experimental setup described earlier. Despite the style discrepancies between reference images, our method is still able to accurately extract and fuse the targeted features. The generated results maintain the characteristics of the reference images while preserving the style of the original face reference. This demonstrates our method\u2019s robust capability to handle diverse styles and perform complex attribute fusion tasks effectively. ", "page_idx": 7}, {"type": "text", "text": "4.2 Quantitative Comparisons ", "text_level": 1, "page_idx": 7}, {"type": "text", "text": "Evaluation Metric. Following common practice, we adopt Fr\u00e9chet Inception Distance (FID) [10, 21] to evaluate the quality of the generated images. Our method is capable of generating faces with multiple reference images, including a face reference image and three facial part reference images (an eyes image, a nose image and a mouth image). To evaluate the effect of facial part reference images, we propose a metric named FPSim (Facial Part Similarity) to measure the similarity between the corresponding facial parts of the generated face and those of reference images, and FPSim-E, FPSim-N and FPSim-M are distinct metrics that respectively measure the similarity of the eyes, nose, and mouth. FPSim is defined as $\\frac{f_{a}\\cdot f_{b}}{\\|f_{a}\\|\\|f_{b}\\|}$ , where $f_{a}$ and $f_{b}$ are the attribute-level features of the generated face and the corresponding reference images. To extract attribute-level features, we train three facial attribute-level feature extractor models with ResNet50 [9] and ArcFace loss [4] on the CelebA-HQ dataset for eyes, noses and mouths respectively. To measure the ability to reconstruct faces with reference images from the same ID, we compute the Mean Square Error (MSE) between generated images and reference images. ", "page_idx": 7}, {"type": "table", "img_path": "X2UMdvcmMo/tmp/d1b7daa0a2ddf0eb0545eae8d4f0bd59a529ffe5de228230ce19a08589757728.jpg", "table_caption": ["Table 1: Quantitative Comparisons on $\\mathbf{FF++}$ . We report Fr\u00e9chet inception distance, eye similarity, nose similarity, mouth similarity and Mean Square Error and show that our method achieves SoTA or competitive results compared with existing methods. FacePartsSwap is essentially a cut & paste method, rather than a generative one, and thus has a higher FPSim. Therefore, we only present its results here and do not include it in the quantitative comparisons. "], "table_footnote": [], "page_idx": 8}, {"type": "table", "img_path": "X2UMdvcmMo/tmp/e6a8a46396914e16fdf4f156099cfc20d8941477cddcd613597db85413dcbe05.jpg", "table_caption": ["Table 2: Quantitative comparison of feature fusion under different ablative configurations. Both the generation quality and facial part similarity are measured. "], "table_footnote": ["Cross-attention: Using cross-attention to inject conditional features. Add-in-Conv: Addition within convolutional layers. Add-in-CA: Addition within cross-attention layers. Hierarchy: Use of hierarchical features. "], "page_idx": 8}, {"type": "text", "text": "", "page_idx": 8}, {"type": "text", "text": "Quantitative Comparison. As indicated in Tab. 1, we compare our method with previous methods on the FaceForensics $^{++}$ [25] dataset. The results show that our method outperforms previous methods in FID significantly, indicating that we can generate high-fidelity swapped faces and can better preserve naturalness and harmony. Meanwhile, we also achieve comparable results on attribute-level metrics, demonstrating that our method can also keep the characteristics of the swapped facial parts. Notably, we observed a limitation in DiffSwap [38], with its tendency to yield results more resemble the source face rather than the intended target face, as illustrated in Fig. 4. Therefore, when both the source and target faces come from the same ID, DiffSwap achieves a lower MSE (0.15) compared to ours (0.77). Nonetheless, it is more common for the IDs of the source and target faces to differ; in these cases, our method consistently shows superior performance. ", "page_idx": 8}, {"type": "text", "text": "4.3 Ablation Study ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "Qualitative comparisons are in Fig. 7 and the quantitative comparison is shown in Tab. 2, where both the generation quality and facial part similarity are measured. ", "page_idx": 8}, {"type": "text", "text": "Cross-attention vs. Addition. To inject conditional features of reference facial parts, we directly add the swapped face image feature to the UNet latent feature instead of using cross-attention. As shown in the first and last rows of Tab. 2, direct addition significantly enhances the swapping performance. We also try to use different cross-attention modules for different facial parts and add their results together to form the latent features of the UNet (denoted by \"Multiple Cross-attention\"). This method provides only a limited improvement to the model\u2019s performance (the 2nd row of Tab. 2 and the 4th column of Fig. 7). Moreover, we try to combine the two fusion methods, adding the swapped face image feature to the output of cross-attention layers (the 2nd row of Tab. 2). Although there is a slight improvement in image fidelity (FID and MSE), the facial part similarity all decreased (FPSim-E, FPSim-N and FPSim-M). ", "page_idx": 8}, {"type": "image", "img_path": "X2UMdvcmMo/tmp/212f5a08148011f4ff4dac4652276b676f6f6432d1945e455485b5eac605f6cb.jpg", "img_caption": ["Figure 7: Qualitative comparison of different ablative settings. "], "img_footnote": [], "page_idx": 9}, {"type": "text", "text": "Feature Injection Across Layers. We inject the swapped face image feature between the two convolutional layers in each ResNet block of the UNet, rather than in the cross-attention layers. The results in Tab. 2 suggest that the Addition-based Injection Module should be positioned in the cross-attention layers (Row 3 and 4). From the 5th and 6th columns of Fig. 7, we can observe that fusion in the cross-attention layer preserves more details and achieves higher similarity than that in the convolution layers. ", "page_idx": 9}, {"type": "text", "text": "Hierarchical Feature. Features from the 4th block of the CLIP image encoder and one after every four blocks are extracted and concatenated to form the output of the CLIP image encoder as the hierarchical feature, which contains abundant facial visual information. According to the Row 4 and 5 of Tab. 2, the method is unable to generate high-fidelity and realistic faces with a significant decrease in image quality metrics, which is confirmed by the 7th column in Fig. 7. ", "page_idx": 9}, {"type": "text", "text": "5 Societal Impacts, Limitations and Conclusion ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "Societal Impacts. The proposed FuseAnyPart is fundamentally harmless. Nevertheless, misuse of it, e.g., applications with copyright issues and racial issues, could have negative effects on society. As a result, we call for a conscientious and ethical implementation of FuseAnyPart. ", "page_idx": 9}, {"type": "text", "text": "Limitations. While FuseAnyPart demonstrates strong performance in facial parts swapping, it still has some limitations at the current stage. First, while FuseAnyPart performs well on a range of images, there may be challenges with faces that have extreme poses, occlusions, or expressions. Additionally, our method is primarily designed for facial parts swapping and does not directly tackle the challenge of preserving or transforming facial expressions during the process of swapping. FuseAnyPart is based on diffusion models, which typically exhibit high computational complexity due to recursive iterations. Algorithms like Latent Consistency Models (LCM) [17] can accelerate inference by reducing the number of iterations, while techniques such as int8 model quantization can significantly lower computational load. Together, these strategies enhance the speed of FuseAnyPart. Like most generative models, FuseAnyPart relies on high-quality training datasets. The quality of the images can be enhanced using super-resolution methods. ", "page_idx": 9}, {"type": "text", "text": "Conclusion. This paper proposes FuseAnyPart, a novel diffusion-driven method for facial parts swapping. FuseAnyPart first extracts multiple decomposed features from face images with masks obtained from an open-set detection model. Then parts from different faces are aggregated in latent space with the Mask-based Fusion Module. An injection module injects this conditional information into UNet for fusing effectively. Extensive experiments validate the superiority of FuseAnyPart. ", "page_idx": 9}, {"type": "text", "text": "References ", "text_level": 1, "page_idx": 10}, {"type": "text", "text": "[1] Haoxing Chen, Zhuoer Xu, Zhangxuan Gu, Yaohui Li, Changhua Meng, Huijia Zhu, Weiqiang Wang, et al. Diffute: Universal text editing diffusion model. Advances in Neural Information Processing Systems, 36, 2024.   \n[2] Li Chen, Mengyi Zhao, Yiheng Liu, Mingxu Ding, Yangyang Song, Shizun Wang, Xu Wang, Hao Yang, Jing Liu, Kang Du, et al. Photoverse: Tuning-free image customization with text-to-image diffusion models. arXiv preprint arXiv:2309.05793, 2023. [3] Siying Cui, Jiankang Deng, Jia Guo, Xiang An, Yongle Zhao, Xinyu Wei, and Ziyong Feng. Idadapter: Learning mixed features for tuning-free personalization of text-to-image models. arXiv preprint arXiv:2403.13535, 2024.   \n[4] Jiankang Deng, Jia Guo, Niannan Xue, and Stefanos Zafeiriou. Arcface: Additive angular margin loss for deep face recognition. In Proceedings of the IEEE/CVF conference on computer vision and pattern recognition, pages 4690\u20134699, 2019. [5] Claudio Ferrari, Matteo Serpentoni, Stefano Berretti, and Alberto Del Bimbo. What makes you, you? analyzing recognition by swapping face parts. In 2022 26th International Conference on Pattern Recognition (ICPR), pages 945\u2013951. IEEE, 2022.   \n[6] Ian Goodfellow, Jean Pouget-Abadie, Mehdi Mirza, Bing Xu, David Warde-Farley, Sherjil Ozair, Aaron Courville, and Yoshua Bengio. Generative adversarial nets. Advances in neural information processing systems, 27, 2014.   \n[7] Jingtao Guo and Yi Liu. Facial parts swapping with generative adversarial networks. Journal of Visual Communication and Image Representation, 78:103152, 2021.   \n[8] Yue Han, Jiangning Zhang, Junwei Zhu, Xiangtai Li, Yanhao Ge, Wei Li, Chengjie Wang, Yong Liu, Xiaoming Liu, and Ying Tai. A generalist facex via learning unified facial representation. arXiv preprint arXiv:2401.00551, 2023.   \n[9] Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun. Deep residual learning for image recognition. In Proceedings of the IEEE conference on computer vision and pattern recognition, pages 770\u2013778, 2016.   \n[10] Martin Heusel, Hubert Ramsauer, Thomas Unterthiner, Bernhard Nessler, and Sepp Hochreiter. Gans trained by a two time-scale update rule converge to a local nash equilibrium. Advances in neural information processing systems, 30, 2017.   \n[11] Tero Karras, Timo Aila, Samuli Laine, and Jaakko Lehtinen. Progressive growing of gans for improved quality, stability, and variation. arXiv preprint arXiv:1710.10196, 2017.   \n[12] Lingzhi Li, Jianmin Bao, Hao Yang, Dong Chen, and Fang Wen. Advancing high fidelity identity swapping for forgery detection. In Proceedings of the IEEE/CVF conference on computer vision and pattern recognition, pages 5074\u20135083, 2020.   \n[13] Zhen Li, Mingdeng Cao, Xintao Wang, Zhongang Qi, Ming-Ming Cheng, and Ying Shan. Photomaker: Customizing realistic human photos via stacked id embedding. In IEEE Conference on Computer Vision and Pattern Recognition (CVPR), 2024.   \n[14] Shilong Liu, Zhaoyang Zeng, Tianhe Ren, Feng Li, Hao Zhang, Jie Yang, Chunyuan Li, Jianwei Yang, Hang Su, Jun Zhu, et al. Grounding dino: Marrying dino with grounded pre-training for open-set object detection. arXiv preprint arXiv:2303.05499, 2023.   \n[15] Zhian Liu, Maomao Li, Yong Zhang, Cairong Wang, Qi Zhang, Jue Wang, and Yongwei Nie. Fine-grained face swapping via regional gan inversion. In Proceedings of the IEEE/CVF conference on computer vision and pattern recognition, pages 8578\u20138587, 2023.   \n[16] Ilya Loshchilov and Frank Hutter. Decoupled weight decay regularization, 2019.   \n[17] Simian Luo, Yiqin Tan, Longbo Huang, Jian Li, and Hang Zhao. Latent consistency models: Synthesizing high-resolution images with few-step inference, 2023.   \n[18] Yiyang Ma, Huan Yang, Wenjing Wang, Jianlong Fu, and Jiaying Liu. Unified multi-modal latent diffusion for joint subject and text conditional image generation. arXiv preprint arXiv:2303.09319, 2023.   \n[19] Yifang Men, Yuan Yao, Miaomiao Cui, Zhouhui Lian, and Xuansong Xie. Dct-net: Domain-calibrated translation for portrait stylization. volume 41, pages 1\u20139, 2022.   \n[20] Yuval Nirkin, Yosi Keller, and Tal Hassner. Fsgan: Subject agnostic face swapping and reenactment. In Proceedings of the IEEE/CVF international conference on computer vision, pages 7184\u20137193, 2019.   \n[21] Gaurav Parmar, Richard Zhang, and Jun-Yan Zhu. On aliased resizing and surprising subtleties in gan evaluation. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 11410\u201311420, 2022.   \n[22] Alec Radford, Jong Wook Kim, Chris Hallacy, Aditya Ramesh, Gabriel Goh, Sandhini Agarwal, Girish Sastry, Amanda Askell, Pamela Mishkin, Jack Clark, et al. Learning transferable visual models from natural language supervision. In International conference on machine learning, pages 8748\u20138763. PMLR, 2021.   \n[23] Aditya Ramesh, Prafulla Dhariwal, Alex Nichol, Casey Chu, and Mark Chen. Hierarchical text-conditional image generation with clip latents. arXiv preprint arXiv:2204.06125, 1(2):3, 2022.   \n[24] Robin Rombach, Andreas Blattmann, Dominik Lorenz, Patrick Esser, and Bj\u00f6rn Ommer. High-resolution image synthesis with latent diffusion models. In Proceedings of the IEEE/CVF conference on computer vision and pattern recognition, pages 10684\u201310695, 2022.   \n[25] Andreas Rossler, Davide Cozzolino, Luisa Verdoliva, Christian Riess, Justus Thies, and Matthias Nie\u00dfner. Faceforensics $^{++}$ : Learning to detect manipulated facial images. In Proceedings of the IEEE/CVF international conference on computer vision, pages 1\u201311, 2019.   \n[26] Jing Shi, Wei Xiong, Zhe Lin, and Hyun Joon Jung. Instantbooth: Personalized text-to-image generation without test-time finetuning. arXiv preprint arXiv:2304.03411, 2023.   \n[27] Sridhar Sola and Darshan Gera. Unmasking your expression: Expression-conditioned gan for masked face inpainting. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 5907\u20135915, 2023.   \n[28] Jiaming Song, Chenlin Meng, and Stefano Ermon. Denoising diffusion implicit models. In International Conference on Learning Representations, 2021.   \n[29] Qianru Sun, Ayush Tewari, Weipeng Xu, Mario Fritz, Christian Theobalt, and Bernt Schiele. A hybrid model for identity obfuscation by face replacement. In Proceedings of the European conference on computer vision (ECCV), pages 553\u2013569, 2018.   \n[30] Patrick von Platen, Suraj Patil, Anton Lozhkov, Pedro Cuenca, Nathan Lambert, Kashif Rasul, Mishig Davaadorj, Dhruv Nair, Sayak Paul, William Berman, Yiyi Xu, Steven Liu, and Thomas Wolf. Diffusers: State-of-the-art diffusion models. https://github.com/huggingface/diffusers, 2022.   \n[31] Qixun Wang, Xu Bai, Haofan Wang, Zekui Qin, and Anthony Chen. Instantid: Zero-shot identity-preserving generation in seconds. arXiv preprint arXiv:2401.07519, 2024.   \n[32] Yuxiang Wei, Yabo Zhang, Zhilong Ji, Jinfeng Bai, Lei Zhang, and Wangmeng Zuo. Elite: Encoding visual concepts into textual embeddings for customized text-to-image generation. In Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 15943\u201315953, 2023.   \n[33] Guangxuan Xiao, Tianwei Yin, William T. Freeman, Fr\u00e9do Durand, and Song Han. Fastcomposer: Tuning-free multi-subject image generation with localized attention. arXiv, 2023.   \n[34] Zhiliang Xu, Hang Zhou, Zhibin Hong, Ziwei Liu, Jiaming Liu, Zhizhi Guo, Junyu Han, Jingtuo Liu, Errui Ding, and Jingdong Wang. Styleswap: Style-based generator empowers robust face swapping. In European Conference on Computer Vision, pages 661\u2013677. Springer, 2022.   \n[35] Tao Yang, Peiran Ren, Xuansong Xie, and Lei Zhang. Gan prior embedded network for blind face restoration in the wild. In Proceedings of the IEEE/CVF conference on computer vision and pattern recognition, pages 672\u2013681, 2021.   \n[36] Hu Ye, Jun Zhang, Sibo Liu, Xiao Han, and Wei Yang. Ip-adapter: Text compatible image prompt adapter for text-to-image diffusion models. 2023.   \n[37] Yuxuan Zhang, Yiren Song, Jiaming Liu, Rui Wang, Jinpeng Yu, Hao Tang, Huaxia Li, Xu Tang, Yao Hu, Han Pan, and Zhongliang Jing. Ssr-encoder: Encoding selective subject representation for subject-driven generation, 2024.   \n[38] Wenliang Zhao, Yongming Rao, Weikang Shi, Zuyan Liu, Jie Zhou, and Jiwen Lu. Diffswap: Highfidelity and controllable face swapping via 3d-aware masked diffusion. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 8568\u20138577, 2023. ", "page_idx": 10}, {"type": "text", "text": "", "page_idx": 11}, {"type": "text", "text": "A More qualitative results ", "text_level": 1, "page_idx": 12}, {"type": "text", "text": "As discussed in Sec. 4.1.1, the qualitative comparison of the nose and mouth swaps is presented in Fig. 8 and 9. ", "page_idx": 12}, {"type": "image", "img_path": "X2UMdvcmMo/tmp/778d87a77ff33aab5dda5d6e2cfb9364062fa339ed01b7163bd503415cd074b3.jpg", "img_caption": ["Figure 8: Qualitative comparison of nose swapping. "], "img_footnote": [], "page_idx": 12}, {"type": "image", "img_path": "X2UMdvcmMo/tmp/0ade03b06e96dd2af0212844241433ae3bab0816e04dad84f742990e0c9d79b2.jpg", "img_caption": ["Figure 9: Qualitative comparison of mouth swapping. "], "img_footnote": [], "page_idx": 12}, {"type": "image", "img_path": "X2UMdvcmMo/tmp/9dcd617e1e3e695cb16f53f2e566cb2da2031a75e0ca88c5128a282914fd2724.jpg", "img_caption": ["Figure 10: More qualitative comparisons of multiple facial parts swapping. This provides additional examples related to Fig. 4. "], "img_footnote": [], "page_idx": 12}, {"type": "text", "text": "As shown in Fig. 11, FuseAnyPart performs well when swapping facial parts from individuals of significantly different racial or age groups. ", "page_idx": 12}, {"type": "image", "img_path": "X2UMdvcmMo/tmp/cd5c5b6f210145c082bde38673cc38ec1d9a6b3334a6004f6d6eb908815e4040.jpg", "img_caption": ["Figure 11: Illustrations of facial parts from significantly different racial and age groups. Facial part swapping between source and target images that significantly differ in age and race. "], "img_footnote": [], "page_idx": 13}, {"type": "image", "img_path": "X2UMdvcmMo/tmp/91ed06f8116b8693f9474fae57546032141a759804bce63aa82b638f146823ce.jpg", "img_caption": [], "img_footnote": [], "page_idx": 13}, {"type": "equation", "text": "$$\nt h r e s_{i}=0\\;*T\\;\\;\\;\\;t h r e s_{i}=0.2\\;*T\\;\\;t h r e s_{i}=0.4\\;*T\\;\\;t h r e s_{i}=0.6\\;*T\\;\\;t h r e s_{i}=0.8\\;*T\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "Figure 12: The skin color change issue can be effectively resolved by replacing the generated skin regions with the inverted latent representations of the original skin color using DDIM inversion in the denoising process. The threshold indicates the number of steps performed above the replacement operation in the denoising process. ", "page_idx": 13}, {"type": "text", "text": "FuseAnyPart may encounter issues with color changes in generated images, but this problem can be addressed by replacing the generated skin regions with inverted latent representations of the original skin color using DDIM. The results are presented in Fig. 12. ", "page_idx": 13}, {"type": "text", "text": "FuseAnyPart was also qualitatively compared with DiffFace, and the results are shown in Fig. 13.   \nMore diverse results of multi swapping with multiple reference faces are presented in Fig. 14. ", "page_idx": 13}, {"type": "image", "img_path": "X2UMdvcmMo/tmp/d0aef6f32da6a7f7ca34824a517ac7cf71d2e3ce5646eaea636c57a7882623e4.jpg", "img_caption": [], "img_footnote": [], "page_idx": 14}, {"type": "text", "text": "Figure 13: Comparison with DiffFace. DiffFace generates images with local distortions in the eyes and mouth, whereas our method produces cleaner results that are more similar to the source image regarding the facial parts. ", "page_idx": 14}, {"type": "image", "img_path": "", "img_caption": ["Figure 14: Qualitative results of swapping face parts from different sources to a target face. "], "img_footnote": [], "page_idx": 14}, {"type": "text", "text": "NeurIPS Paper Checklist ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "1. Claims ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "Question: Do the main claims made in the abstract and introduction accurately reflect the paper\u2019s contributions and scope? ", "page_idx": 15}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 15}, {"type": "text", "text": "Justification: The claims made in abstract and introduction in Sec. 1 accurately reflect the paper\u2019s contributions and scope. ", "page_idx": 15}, {"type": "text", "text": "Guidelines: ", "page_idx": 15}, {"type": "text", "text": "\u2022 The answer NA means that the abstract and introduction do not include the claims made in the paper.   \n\u2022 The abstract and/or introduction should clearly state the claims made, including the contributions made in the paper and important assumptions and limitations. A No or NA answer to this question will not be perceived well by the reviewers.   \n\u2022 The claims made should match theoretical and experimental results, and reflect how much the results can be expected to generalize to other settings.   \n\u2022 It is fine to include aspirational goals as motivation as long as it is clear that these goals are not attained by the paper. ", "page_idx": 15}, {"type": "text", "text": "2. Limitations ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "Question: Does the paper discuss the limitations of the work performed by the authors? ", "page_idx": 15}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "Justification: The paper discusses the limitations in Sec. 5 ", "page_idx": 15}, {"type": "text", "text": "Guidelines: ", "page_idx": 15}, {"type": "text", "text": "\u2022 The answer NA means that the paper has no limitation while the answer No means that the paper has limitations, but those are not discussed in the paper.   \n\u2022 The authors are encouraged to create a separate \"Limitations\" section in their paper.   \n\u2022 The paper should point out any strong assumptions and how robust the results are to violations of these assumptions (e.g., independence assumptions, noiseless settings, model well-specification, asymptotic approximations only holding locally). The authors should reflect on how these assumptions might be violated in practice and what the implications would be.   \n\u2022 The authors should reflect on the scope of the claims made, e.g., if the approach was only tested on a few datasets or with a few runs. In general, empirical results often depend on implicit assumptions, which should be articulated.   \n\u2022 The authors should reflect on the factors that influence the performance of the approach. For example, a facial recognition algorithm may perform poorly when image resolution is low or images are taken in low lighting. Or a speech-to-text system might not be used reliably to provide closed captions for online lectures because it fails to handle technical jargon.   \n\u2022 The authors should discuss the computational efficiency of the proposed algorithms and how they scale with dataset size.   \n\u2022 If applicable, the authors should discuss possible limitations of their approach to address problems of privacy and fairness.   \n\u2022 While the authors might fear that complete honesty about limitations might be used by reviewers as grounds for rejection, a worse outcome might be that reviewers discover limitations that aren\u2019t acknowledged in the paper. The authors should use their best judgment and recognize that individual actions in favor of transparency play an important role in developing norms that preserve the integrity of the community. Reviewers will be specifically instructed to not penalize honesty concerning limitations. ", "page_idx": 15}, {"type": "text", "text": "3. Theory Assumptions and Proofs ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "Question: For each theoretical result, does the paper provide the full set of assumptions and a complete (and correct) proof? ", "page_idx": 15}, {"type": "text", "text": "Answer: [No] ", "page_idx": 15}, {"type": "text", "text": "Justification: The approach presented in this paper utilizes deep learning and adopts a data-driven experimental methodology. ", "page_idx": 16}, {"type": "text", "text": "Guidelines: ", "page_idx": 16}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include theoretical results.   \n\u2022 All the theorems, formulas, and proofs in the paper should be numbered and crossreferenced.   \n\u2022 All assumptions should be clearly stated or referenced in the statement of any theorems.   \n\u2022 The proofs can either appear in the main paper or the supplemental material, but if they appear in the supplemental material, the authors are encouraged to provide a short proof sketch to provide intuition.   \n\u2022 Inversely, any informal proof provided in the core of the paper should be complemented by formal proofs provided in appendix or supplemental material.   \n\u2022 Theorems and Lemmas that the proof relies upon should be properly referenced. ", "page_idx": 16}, {"type": "text", "text": "4. Experimental Result Reproducibility ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "Question: Does the paper fully disclose all the information needed to reproduce the main experimental results of the paper to the extent that it affects the main claims and/or conclusions of the paper (regardless of whether the code and data are provided or not)? ", "page_idx": 16}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 16}, {"type": "text", "text": "Justification: The quantitative findings utilize datasets that are publicly accessible. Guidelines: ", "page_idx": 16}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 If the paper includes experiments, a No answer to this question will not be perceived well by the reviewers: Making the paper reproducible is important, regardless of whether the code and data are provided or not.   \n\u2022 If the contribution is a dataset and/or model, the authors should describe the steps taken to make their results reproducible or verifiable.   \n\u2022 Depending on the contribution, reproducibility can be accomplished in various ways. For example, if the contribution is a novel architecture, describing the architecture fully might suffice, or if the contribution is a specific model and empirical evaluation, it may be necessary to either make it possible for others to replicate the model with the same dataset, or provide access to the model. In general. releasing code and data is often one good way to accomplish this, but reproducibility can also be provided via detailed instructions for how to replicate the results, access to a hosted model (e.g., in the case of a large language model), releasing of a model checkpoint, or other means that are appropriate to the research performed.   \n\u2022 While NeurIPS does not require releasing code, the conference does require all submissions to provide some reasonable avenue for reproducibility, which may depend on the nature of the contribution. For example (a) If the contribution is primarily a new algorithm, the paper should make it clear how to reproduce that algorithm. (b) If the contribution is primarily a new model architecture, the paper should describe the architecture clearly and fully. (c) If the contribution is a new model (e.g., a large language model), then there should either be a way to access this model for reproducing the results or a way to reproduce the model (e.g., with an open-source dataset or instructions for how to construct the dataset). (d) We recognize that reproducibility may be tricky in some cases, in which case authors are welcome to describe the particular way they provide for reproducibility. In the case of closed-source models, it may be that access to the model is limited in some way (e.g., to registered users), but it should be possible for other researchers to have some path to reproducing or verifying the results. ", "page_idx": 16}, {"type": "text", "text": "5. Open access to data and code ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "Question: Does the paper provide open access to the data and code, with sufficient instructions to faithfully reproduce the main experimental results, as described in supplemental material? ", "page_idx": 16}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 17}, {"type": "text", "text": "Justification: The code and model flies will be made available to the public after the author has finished refining them. ", "page_idx": 17}, {"type": "text", "text": "Guidelines: ", "page_idx": 17}, {"type": "text", "text": "\u2022 The answer NA means that paper does not include experiments requiring code.   \n\u2022 Please see the NeurIPS code and data submission guidelines (https://nips.cc/ public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 While we encourage the release of code and data, we understand that this might not be possible, so \u201cNo\u201d is an acceptable answer. Papers cannot be rejected simply for not including code, unless this is central to the contribution (e.g., for a new open-source benchmark).   \n\u2022 The instructions should contain the exact command and environment needed to run to reproduce the results. See the NeurIPS code and data submission guidelines (https: //nips.cc/public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 The authors should provide instructions on data access and preparation, including how to access the raw data, preprocessed data, intermediate data, and generated data, etc.   \n\u2022 The authors should provide scripts to reproduce all experimental results for the new proposed method and baselines. If only a subset of experiments are reproducible, they should state which ones are omitted from the script and why.   \n\u2022 At submission time, to preserve anonymity, the authors should release anonymized versions (if applicable).   \n\u2022 Providing as much information as possible in supplemental material (appended to the paper) is recommended, but including URLs to data and code is permitted. ", "page_idx": 17}, {"type": "text", "text": "6. Experimental Setting/Details ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "Question: Does the paper specify all the training and test details (e.g., data splits, hyperparameters, how they were chosen, type of optimizer, etc.) necessary to understand the results? ", "page_idx": 17}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 17}, {"type": "text", "text": "Justification: Please see Sec. 4 ", "page_idx": 17}, {"type": "text", "text": "Guidelines: ", "page_idx": 17}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments. \u2022 The experimental setting should be presented in the core of the paper to a level of detail that is necessary to appreciate the results and make sense of them. \u2022 The full details can be provided either with the code, in appendix, or as supplemental material. ", "page_idx": 17}, {"type": "text", "text": "7. Experiment Statistical Significance ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "Question: Does the paper report error bars suitably and correctly defined or other appropriate information about the statistical significance of the experiments? ", "page_idx": 17}, {"type": "text", "text": "Answer: [No] ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "Justification: Error bars are not reported because it would be too computationally expensive. Guidelines: ", "page_idx": 17}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The authors should answer \"Yes\" if the results are accompanied by error bars, confidence intervals, or statistical significance tests, at least for the experiments that support the main claims of the paper.   \n\u2022 The factors of variability that the error bars are capturing should be clearly stated (for example, train/test split, initialization, random drawing of some parameter, or overall run with given experimental conditions).   \n\u2022 The method for calculating the error bars should be explained (closed form formula, call to a library function, bootstrap, etc.)   \n\u2022 The assumptions made should be given (e.g., Normally distributed errors).   \n\u2022 It should be clear whether the error bar is the standard deviation or the standard error of the mean.   \n\u2022 It is OK to report 1-sigma error bars, but one should state it. The authors should preferably report a 2-sigma error bar than state that they have a $96\\%$ CI, if the hypothesis of Normality of errors is not verified.   \n\u2022 For asymmetric distributions, the authors should be careful not to show in tables or figures symmetric error bars that would yield results that are out of range (e.g. negative error rates).   \n\u2022 If error bars are reported in tables or plots, The authors should explain in the text how they were calculated and reference the corresponding figures or tables in the text. ", "page_idx": 17}, {"type": "text", "text": "", "page_idx": 18}, {"type": "text", "text": "8. Experiments Compute Resources ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Question: For each experiment, does the paper provide sufficient information on the computer resources (type of compute workers, memory, time of execution) needed to reproduce the experiments? ", "page_idx": 18}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 18}, {"type": "text", "text": "Justification: Please see Sec. 4 ", "page_idx": 18}, {"type": "text", "text": "Guidelines: ", "page_idx": 18}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The paper should indicate the type of compute workers CPU or GPU, internal cluster, or cloud provider, including relevant memory and storage.   \n\u2022 The paper should provide the amount of compute required for each of the individual experimental runs as well as estimate the total compute.   \n\u2022 The paper should disclose whether the full research project required more compute than the experiments reported in the paper (e.g., preliminary or failed experiments that didn\u2019t make it into the paper). ", "page_idx": 18}, {"type": "text", "text": "9. Code Of Ethics ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Question: Does the research conducted in the paper conform, in every respect, with the NeurIPS Code of Ethics https://neurips.cc/public/EthicsGuidelines? ", "page_idx": 18}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 18}, {"type": "text", "text": "Justification: The paper conforms with the NeurIPS Code of Ethics in every respect. Guidelines: ", "page_idx": 18}, {"type": "text", "text": "\u2022 The answer NA means that the authors have not reviewed the NeurIPS Code of Ethics.   \n\u2022 If the authors answer No, they should explain the special circumstances that require a deviation from the Code of Ethics.   \n\u2022 The authors should make sure to preserve anonymity (e.g., if there is a special consideration due to laws or regulations in their jurisdiction). ", "page_idx": 18}, {"type": "text", "text": "10. Broader Impacts ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Question: Does the paper discuss both potential positive societal impacts and negative societal impacts of the work performed? ", "page_idx": 18}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Justification: Please see Sec. 5. ", "page_idx": 18}, {"type": "text", "text": "Guidelines: ", "page_idx": 18}, {"type": "text", "text": "\u2022 The answer NA means that there is no societal impact of the work performed.   \n\u2022 If the authors answer NA or No, they should explain why their work has no societal impact or why the paper does not address societal impact.   \n\u2022 Examples of negative societal impacts include potential malicious or unintended uses (e.g., disinformation, generating fake profiles, surveillance), fairness considerations (e.g., deployment of technologies that could make decisions that unfairly impact specific groups), privacy considerations, and security considerations.   \n\u2022 The conference expects that many papers will be foundational research and not tied to particular applications, let alone deployments. However, if there is a direct path to any negative applications, the authors should point it out. For example, it is legitimate to point out that an improvement in the quality of generative models could be used to generate deepfakes for disinformation. On the other hand, it is not needed to point out that a generic algorithm for optimizing neural networks could enable people to train models that generate Deepfakes faster.   \n\u2022 The authors should consider possible harms that could arise when the technology is being used as intended and functioning correctly, harms that could arise when the technology is being used as intended but gives incorrect results, and harms following from (intentional or unintentional) misuse of the technology.   \n\u2022 If there are negative societal impacts, the authors could also discuss possible mitigation strategies (e.g., gated release of models, providing defenses in addition to attacks, mechanisms for monitoring misuse, mechanisms to monitor how a system learns from feedback over time, improving the efficiency and accessibility of ML). ", "page_idx": 18}, {"type": "text", "text": "", "page_idx": 19}, {"type": "text", "text": "11. Safeguards ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "Question: Does the paper describe safeguards that have been put in place for responsible release of data or models that have a high risk for misuse (e.g., pretrained language models, image generators, or scraped datasets)? ", "page_idx": 19}, {"type": "text", "text": "Answer: [No] ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "Justification: The authors will personally evaluate the risks and decide on the publication of the model files. ", "page_idx": 19}, {"type": "text", "text": "Guidelines: ", "page_idx": 19}, {"type": "text", "text": "\u2022 The answer NA means that the paper poses no such risks.   \n\u2022 Released models that have a high risk for misuse or dual-use should be released with necessary safeguards to allow for controlled use of the model, for example by requiring that users adhere to usage guidelines or restrictions to access the model or implementing safety filters.   \n\u2022 Datasets that have been scraped from the Internet could pose safety risks. The authors should describe how they avoided releasing unsafe images.   \n\u2022 We recognize that providing effective safeguards is challenging, and many papers do not require this, but we encourage authors to take this into account and make a best faith effort. ", "page_idx": 19}, {"type": "text", "text": "12. Licenses for existing assets ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "Question: Are the creators or original owners of assets (e.g., code, data, models), used in the paper, properly credited and are the license and terms of use explicitly mentioned and properly respected? ", "page_idx": 19}, {"type": "text", "text": "Answer: [No] ", "page_idx": 19}, {"type": "text", "text": "Justification: The code and data are mentioned, but we were unable to find the license for the dataset we used. ", "page_idx": 19}, {"type": "text", "text": "Guidelines: ", "page_idx": 19}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not use existing assets.   \n\u2022 The authors should cite the original paper that produced the code package or dataset.   \n\u2022 The authors should state which version of the asset is used and, if possible, include a URL.   \n\u2022 The name of the license (e.g., CC-BY 4.0) should be included for each asset.   \n\u2022 For scraped data from a particular source (e.g., website), the copyright and terms of service of that source should be provided.   \n\u2022 If assets are released, the license, copyright information, and terms of use in the package should be provided. For popular datasets, paperswithcode.com/datasets has curated licenses for some datasets. Their licensing guide can help determine the license of a dataset.   \n\u2022 For existing datasets that are re-packaged, both the original license and the license of the derived asset (if it has changed) should be provided.   \n\u2022 If this information is not available online, the authors are encouraged to reach out to the asset\u2019s creators. ", "page_idx": 19}, {"type": "text", "text": "", "page_idx": 20}, {"type": "text", "text": "13. New Assets ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Question: Are new assets introduced in the paper well documented and is the documentation provided alongside the assets? ", "page_idx": 20}, {"type": "text", "text": "Answer: [No] ", "page_idx": 20}, {"type": "text", "text": "Justification: Currently, the data and code remain private, but there may be consideration for public release in the future. ", "page_idx": 20}, {"type": "text", "text": "Guidelines: ", "page_idx": 20}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not release new assets.   \n\u2022 Researchers should communicate the details of the dataset/code/model as part of their submissions via structured templates. This includes details about training, license, limitations, etc.   \n\u2022 The paper should discuss whether and how consent was obtained from people whose asset is used.   \n\u2022 At submission time, remember to anonymize your assets (if applicable). You can either create an anonymized URL or include an anonymized zip file. ", "page_idx": 20}, {"type": "text", "text": "14. Crowdsourcing and Research with Human Subjects ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Question: For crowdsourcing experiments and research with human subjects, does the paper include the full text of instructions given to participants and screenshots, if applicable, as well as details about compensation (if any)? ", "page_idx": 20}, {"type": "text", "text": "Answer: [No] ", "page_idx": 20}, {"type": "text", "text": "Justification: No Crowdsourcing used in this work. ", "page_idx": 20}, {"type": "text", "text": "Guidelines: ", "page_idx": 20}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Including this information in the supplemental material is fine, but if the main contribution of the paper involves human subjects, then as much detail as possible should be included in the main paper.   \n\u2022 According to the NeurIPS Code of Ethics, workers involved in data collection, curation, or other labor should be paid at least the minimum wage in the country of the data collector. ", "page_idx": 20}, {"type": "text", "text": "15. Institutional Review Board (IRB) Approvals or Equivalent for Research with Human Subjects ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Question: Does the paper describe potential risks incurred by study participants, whether such risks were disclosed to the subjects, and whether Institutional Review Board (IRB) approvals (or an equivalent approval/review based on the requirements of your country or institution) were obtained? ", "page_idx": 20}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 20}, {"type": "text", "text": "Justification: We are not sure if we have obtained IRB approvals. ", "page_idx": 20}, {"type": "text", "text": "Guidelines: ", "page_idx": 20}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Depending on the country in which research is conducted, IRB approval (or equivalent) may be required for any human subjects research. If you obtained IRB approval, you should clearly state this in the paper.   \n\u2022 We recognize that the procedures for this may vary significantly between institutions and locations, and we expect authors to adhere to the NeurIPS Code of Ethics and the guidelines for their institution.   \n\u2022 For initial submissions, do not include any information that would break anonymity (if applicable), such as the institution conducting the review. ", "page_idx": 20}]