[{"type": "text", "text": "Towards Understanding Evolving Patterns in Sequential Data ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Qiuhao Zeng Long-Kai Huang Western University Tencent AI Lab qzeng53@uwo.ca hlongkai@gmail.com ", "page_idx": 0}, {"type": "text", "text": "Qi Chen Charles Ling\u2217 Boyu Wang\u2217 Laval University Western University Western University qi.chen.1@ulaval.ca charles.ling@uwo.ca bwang@csd.uwo.ca ", "page_idx": 0}, {"type": "text", "text": "Abstract ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "In many machine learning tasks, data is inherently sequential. Most existing algorithms learn from sequential data in an auto-regressive manner, which predicts the next unseen data point based on the observed sequence, implicitly assuming the presence of an evolving pattern embedded in the data that can be leveraged. However, identifying and assessing evolving patterns in learning tasks heavily relies on human expertise, and lacks a standardized quantitative measure. In this paper, we show that such a measure enables us to determine the suitability of employing sequential models, measure the temporal order of time series data, and conduct feature/data selections, which can be beneficial to a variety of learning tasks: time-series forecastings, classification tasks with temporal distribution shift, video predictions, etc. Specifically, we introduce the EVOLVING RATE (EVORATE), which quantifies the evolving patterns in the data by approximating mutual information between the next data point and the observed sequence. To address cases where the correspondence between data points at different timestamps is absent, we develop $\\mathtt{E v o R A T E}_{\\mathcal{W}}$ , a simple and efficient implementation that leverages optimal transport to construct the correspondence and estimate the first-order EVORATE. Experiments on synthetic and real-world datasets including images and tabular data validate the efficacy of our EVORATE method. ", "page_idx": 0}, {"type": "text", "text": "1 Introduction ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Sequential data is ubiquitous across various machine learning tasks, including multivariate time series [33, 38, 44], video streams in computer vision [18, 52, 54], textual data in natural language processing [9, 17, 34], and state-action trajectories in reinforcement learning [5, 45, 56]. Learning with sequential data usually involves predicting future data points, fostering the development of auto-regressive techniques that learn to forecast the subsequent unseen entries in a sequence. Despite the progress in this field, one fundamental challenge persists: the identification of underlying evolving patterns often depends heavily on the subjective interpretations and prior knowledge of human experts. This reliance on subjective judgment lacks a robust quantitative method to assess the evolving patterns over the high-dimensional data in deep learning. For example, when designing a recommendation system, certain products such as clothing are highly dependent on temporal factors (e.g., seasons, fashion trends), while others, like computers, are more influenced by individual customer preferences. Therefore, it is critical to identify and quantify the underlying evolving patterns for different products and integrate this information into the algorithmic design. ", "page_idx": 0}, {"type": "text", "text": "Specifically, the following questions are essential but unresolved yet in literature: i) How can the existence of evolving patterns in data sequences be determined? Determining the existence of evolving patterns in data is a critical task. It is possible that the data points of a sequence are entirely independent and no evolving patterns exist. For instance, consider the scenario of a person repeatedly tossing a coin. In this case, historical information does not influence the outcome of the next toss. ii) Can one determine the historical span that significantly influences the current time point? For example, how do we determine the order (the optimal number of past observations) of an autoregressive model in a principled way? iii) How can we determine if the collected features are sufficient to reveal evolving patterns? For instance, to achieve better weather forecasting, how can one determine the essential features, such as altitude, humidity, and geographic location, for gathering a comprehensive set of information for forecasting. ", "page_idx": 1}, {"type": "text", "text": "In this work, we address these questions through a unified framework by introducing EVORATE (EVOLVING RATE), a novel approach designed to quantify the evolving patterns of data sequences. EVORATE leverages mutual information as a measure of the existence of the evolving patterns in the data. Notably, while there is a rich history of mutual information estimation in the existing literature [8, 1, 27, 10, 29], existing works ignore the underlying temporal dependency between the data points, and therefore are not well-designed for sequential data. EVORATE tackles this issue by estimating mutual information in an autoregressive manner when learning the compressed embedding from the observed sequence, thereby addressing the aforementioned questions: i) it can serve as an indicator to show that learning a sequential model is not feasible to learn the provided sequential dataset. ii) EVORATE can provide a quantitative measure of the temporal dependency of a sequence, allowing us to control the trade-off between computational complexity and learning performance. iii) EVORATE can also guide us in selecting the most informative features for model training for sequential data. ", "page_idx": 1}, {"type": "text", "text": "However, EVORATE is difficult to estimate when dealing with temporal data characterized by snapshots captured at disparate timestamps without clear correspondence between them [30, 48, 42], as we do not track the same data point over different timestamps and thus lack access to its corresponding sample. This scenario hinders the estimation of EvoRate, due to the absence of the correspondence. To mitigate this issue, we propose an enhanced version of our methodology, $\\mathtt{E v o R A T E}_{\\mathcal{W}}$ , which is specifically designed to establish correspondence among data points across different timestamps utilizing optimal transport within the Wasserstein distance metric, thereby facilitating the estimation of the first-order EVORATE. In all, the benefits of EVORATE to be highlighted include: ", "page_idx": 1}, {"type": "text", "text": "\u2022 EVORATE enables quantitatively measuring the evolving patterns existing in high-dimensional sequential data by utilizing the neural mutual information estimator. Furthermore, it can be applied to assess temporal order and conduct feature selections in sequential data. \u2022 We further proposed $\\mathtt{E v o R A T E}_{\\mathcal{W}}$ to leverage optimal transport to build the correspondence between snapshots at the different timestamps, and hence allow the MI approximations. \u2022 We motivate through analysis the use of mutual information as indicators of evolving patterns and show optimal transport can mitigate the without correspondence issue. \u2022 Synthetic and real-world datasets verify that EVORATE can be a good indicator for evolving patterns, supporting our claim of its benefits. We also design an EDG algorithm based on the insight of $\\mathtt{E v o R A T E}_{\\mathcal{W}}$ and verify its performance. ", "page_idx": 1}, {"type": "text", "text": "2 Related Works ", "text_level": 1, "page_idx": 1}, {"type": "text", "text": "Sequential Data The analysis and processing of sequential data is driven by diverse applications ranging from video predictions to time series forecasting [25, 50, 9, 16, 33]. Pioneering works such as Long Short-Term Memory (LSTM) [25] networks have established foundational principles for handling long-range dependencies in sequence data. Building on this, the Transformer [50] introduced a revolutionary approach through self-attention mechanisms, enhancing flexibility in handling sequence dependencies. The versatility of Transformers has been further demonstrated in models such as GPT-3 [9] and BERT [16]. Beyond text, sequential data analysis in machine learning also extends to time-series forecasting [33]. Moreover, the application of Graph Neural Networks in capturing dependencies in irregular sequences underscores the breadth of methodologies exploring the complexities of sequential data [7]. However, a qualitative method for measuring the intensity of evolving patterns remains lacking in the literature. ", "page_idx": 1}, {"type": "text", "text": "Mutual Information (MI) Estimation has become a pivotal tool in machine learning [39, 8, 1, 27, 10, 29], enabling insights into dependencies that extend beyond traditional correlation measures. In feature selection, MI offers a data-driven approach to identify relevant features without strong assumptions about data distributions [39]. Mutual Information Neural Estimation (MINE) [8] applies deep learning to estimate MI in high-dimensional settings, providing a new methodology for analyzing neural network training dynamics. MI\u2019s application in variational inference, especially in the training of variational autoencoders (VAEs) [1]. In reinforcement learning, MI has been used to enhance exploration strategies by quantifying information gain [27]. MI also improves the performance of generative adversarial networks (GANs) [10]. Furthermore, in unsupervised and semi-supervised learning, MI maximization has been shown to effectively leverage unlabeled data [29]. However, none of them employ MI as an indicator for evolving patterns of sequential data. ", "page_idx": 2}, {"type": "text", "text": "Optimal Transport (OT) has emerged as a powerful framework in machine learning [51, 3, 31, 13, 41], offering a principled approach to compare probability distributions. Optimal transport theory has been leveraged for applications ranging from domain adaptation to generative modeling [51]. Recent advances include the integration of OT with deep learning architectures; Wasserstein GAN (WGAN) utilizes the Wasserstein distance to improve the stability of training GANs [3]. Furthermore, optimal transport has been applied effectively in NLP [31]. The computational aspect of OT has also seen significant developments, Sinkhorn [13] as a scalable method approximates transport plans efficiently. More recently, researchers have explored the differential properties of transport plans in dynamic environments [41]. EVORATE employs OT to recover the correspondence between two consecutive timestamps, facilitating approximations of mutual information. ", "page_idx": 2}, {"type": "text", "text": "Patterns estimation for sequential data has only one related work in the literature ForeCA [24], which proposes a similar concept, \"forecastibility\", which measures the uncertainty of the entropy of the spectral density. However, ForeCA has two drawbacks. Firstly, ForeCA can not be used in deep learning as an unacceptable huge computational consumption for real-world high-dimensional data (audio, videos, etc.). In contrast, EVORATE shows the prediction power by relying on mutual information, which tells the ability to predict another variable based on known observed variables. Secondly, while temporal patterns can include trends, cycles, irregular fluctuations, and more complex behaviors, ForeCA can only detect cycled patterns. Instead, EVORATE relies on the neural mutual information estimator, which is known as a good measurement for various patterns as a result of the strong fitting power of neural nets [8, 11, 37, 46]. ", "page_idx": 2}, {"type": "text", "text": "3 Preliminary ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "3.1 Variational mutual information estimation ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "The mutual information between two random variables $X$ and $Y$ is defined as the KL divergence $D_{\\mathrm{KL}}$ between their joint distribution and the product of their marginal distributions: ", "page_idx": 2}, {"type": "equation", "text": "$$\nI(X;Y)=D_{\\mathrm{KL}}(P(X,Y)||P(X)P(Y)),\n$$", "text_format": "latex", "page_idx": 2}, {"type": "text", "text": "where we aim to estimate this using samples from $P(X,Y)$ ; in some cases, the density of the marginals such as $P(X)$ may be known. A wide range of variational methods are designed to estimate variational mutual information [8, 11, 46, 36, 37]. We then use the below estimator to estimate mutual information: ", "page_idx": 2}, {"type": "equation", "text": "$$\n\\hat{I}(X;Y):=\\mathbb{E}_{P(X,Y)}[m(x,y)]-\\log\\mathbb{E}_{P(X)P(Y)}[e^{m(x,y)}],\n$$", "text_format": "latex", "page_idx": 2}, {"type": "text", "text": "where $X$ is the random variable, $x$ is a realization of $X$ (as is the case with $Y$ and $y$ ), and $m(x,y)$ is a critic function to quantify the similarity between $X$ and $Y$ , usually realized by a neural network [8, 11, 46, 36, 37]. We show that MI is highly related to the evolving patterns of the sequential data in Section 4.2. ", "page_idx": 2}, {"type": "text", "text": "3.2 Optimal transport ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "A rich class of divergences between probability distributions is induced by the optimal transport (OT) problem [51]. Kantorovich\u2019s formulation of the problem is given by ", "page_idx": 2}, {"type": "equation", "text": "$$\nW_{c}(P(X),P(Y))=\\operatorname*{inf}_{\\pi\\in\\Pi(P(X),P(Y))}\\mathbb{E}_{(X,Y)\\sim\\pi}[c(X,Y)],\n$$", "text_format": "latex", "page_idx": 2}, {"type": "text", "text": "where $c(x,y):\\mathcal{X}\\times\\mathcal{Y}\\to\\mathbb{R}_{+}$ is any measurable cost function and $\\Pi(P(X),P(Y))$ is the set of all the joint distributions $\\pi(X,Y)$ whose marginals are $P(X)$ and $P(Y)$ respectively. The Wasserstein distance $W_{c}$ is then the \u201ccost\u201d of the optimal transport plan. ", "page_idx": 3}, {"type": "text", "text": "4 Measure evolving patterns via MI ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "4.1 EvoRate ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "Consider a sequence $\\mathbf{z}_{1}^{T}:\\{z_{t}\\}_{t=1}^{T}$ , a collection of sequential data points from time 1 to $T$ , where each $\\boldsymbol{z}_{t}\\in\\mathbb{R}^{D}$ denotes a state or observation at the discrete time step $t$ with total $T$ steps. In practice, the sequence $\\mathbf{z}_{1}^{T}$ can represent time series data, video, textual, audio, or any other ordered data stream. ", "page_idx": 3}, {"type": "text", "text": "We propose the use of the mutual information (MI) between the next observation and historical data over the past $k$ steps $I(\\mathbf{Z}_{t-k+1}^{t};Z_{t+1})$ to measure the evolving pattern within a time window of length $k$ . In the literature, the mutual information is empirically estimated through equation 2, which involves learning the critic function $m$ [8, 11, 46, 36, 37]. However, one critical issue with existing works is that they ignore the temporal dependency of the data, and therefore the critic function $m$ can have a high bias for sequential data (shown in Figure 1a, 1b). ", "page_idx": 3}, {"type": "text", "text": "To take the temporal dependency into account when estimating $I(\\mathbf{Z}_{t-k+1}^{t};Z_{t+1})$ , instead of learning the critic function $m$ , we propose learning the autoregressive function $f$ , which summarizes the historical information embedded in $Z_{t-k+1}^{t}$ , and measuring its distance to $Z_{t+1}$ via the squared error metric. Specifically, we introduce EvoRate to estimate the empirical sequential MI $\\hat{I}(\\mathbf{Z}_{t-k+1}^{t};Z_{t+1})$ by defining $m:\\mathbb{R}^{k\\times D}\\times\\mathbb{R}^{D}\\to\\mathbb{R}$ , $m(x_{1}^{k},y)=-\\|f(g(x_{1}),..,g(x_{k}))-g(y)\\|_{2}^{2}$ in equation 2: ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathrm{~}\\mathrm{~e~}{:=\\hat{I}(\\mathbf{Z}_{t-k+1}^{t};Z_{t+1})}=\\mathbb{E}_{\\mathbf{z}_{t-k+1}^{t+1}\\sim P(\\mathbf{Z}_{t-k+1},\\ldots,Z_{t+1})}-||f(g(z_{t-k+1}),\\ldots,g(z_{t}))-g(z_{t+1})||_{2}^{2}}\\\\ &{\\qquad\\qquad-\\log\\mathbb{E}_{\\mathbf{z}_{t-k+1}^{t}\\sim P^{\\smash{(}Z_{t-k+1},\\ldots,Z_{t}),z_{t+1}\\sim P(Z_{t+1})}}e^{-||f(g(z_{t-k+1}),\\ldots,g(z_{t}))-g(z_{t+1})||_{2}^{2}},\\quad\\mathrm{~}\\mathrm{~o~n~}\\quad\\mathbb{Z}_{t\\sim Z_{t+1}^{t}\\sim Z_{t}}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "where $g:\\mathbb{R}^{D}\\to\\mathbb{R}^{d}$ is an encoder. By selecting a different $d$ , we can make a trade-off between computational cost and MI estimation accuracy. With $d\\ll D$ , EVORATE is a more computationally efficient method for approximating sequential MI than learning an autoregressive model in the original data space. However, due to the Data-processing inequality [12], this results in lower MI estimates. As $g$ is employed as an identity function, MI is estimated in the original space, thereby enhancing estimation correctness at the expense of increased computational consumption. ", "page_idx": 3}, {"type": "text", "text": "4.2 Discussion ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "In this section, we justify the validity of EVORATE as a metric of evolving patterns through the lens of a $k$ -th order autoregression. Specifically, we define the Maximum likelihood estimation (MLE) loss as $\\mathcal{L}_{m l e}=-\\mathbb{E}_{P(Z_{t+1},\\mathbf{Z}_{t-k+1}^{t})}\\operatorname{log}Q(Z_{t+1}|\\mathbf{Z}_{t-k+1}^{t}).$ , where $Q$ is the probability distribution learned by the autoregressive model $F$ trained with a supervised loss (MLE, MSE) on sequential data. Note that the MLE loss can also be viewed as the expected risk of autoregressive prediction tasks [44]. ", "page_idx": 3}, {"type": "text", "text": "The following proposition establishes the connection between the expected risk of a $k$ -th order autoregression task and the mutual information $I(\\mathbf{Z}_{t-k+1}^{t};Z_{t+1})$ : ", "page_idx": 3}, {"type": "text", "text": "Proposition 1. Let $H$ denote the entropy. For autoregression tasks, the expected MLE loss satisfy: ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\mathcal{L}_{m l e}=\\underbrace{D_{\\mathrm{KL}}(P(Z_{t+1}|Z_{t-k+1}^{t}),Q(Z_{t+1}|Z_{t-k+1}^{t}))}_{(i)\\,M o d e l\\,r e l a t e d}+\\underbrace{H(Z_{t+1})-I(Z_{t+1};Z_{t-k+1}^{t})}_{(i i)\\,D a t a\\,r e l a t e d}}\\end{array}\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "A proof of the proposition is provided in Appendix A. Proposition 1 provides novel insights into learning a predictive model for an autoregression task from an information-theoretic perspective: ", "page_idx": 3}, {"type": "text", "text": "1. The expected risk can be decomposed into two orthogonal factors, where (i) measures the distance between the learned distribution $Q$ and true distribution $P$ , and therefore is determined by the predictive model $F$ . (ii) quantifies the inherent temporal dependency of the sequence. Notably, it is independent of $F$ . ", "page_idx": 3}, {"type": "text", "text": "2. More importantly, due to the nature of mutual information, $I(Z_{t+1};\\mathbf{Z}_{t-k+1}^{t})\\;\\leq\\;H(Z_{t+1})$ and (i) attains a minimum of zero when the observed sequence $\\mathbf{Z}_{t-k+1}^{t}$ encapsulates all the information of $Z_{t+1}$ . Conversely, Proposition 1 reveals that even if $F$ can properly learn the true probability $P$ (i.e., (i) is small), its expected risk remains high when there is no temporal dependency that can be leveraged (i.e., $I$ is small). ", "page_idx": 3}, {"type": "text", "text": "", "page_idx": 4}, {"type": "text", "text": "Consequently, EvoRate, as an empirical estimate of $I(Z_{t+1};\\mathbf{Z}_{t-k+1}^{t})$ , can play an important role in indicating the success of learning from sequential data and therefore is adopted to quantify the evolving pattern in this work. ", "page_idx": 4}, {"type": "text", "text": "Subsequently, we demonstrate that MSE loss defined as $\\mathcal{L}_{m s e}\\,=\\,\\mathbb{E}_{P(Z_{t+1},\\mathbf{Z}_{t-k+1}^{t})}||F(\\mathbf{z}_{t-k+1}^{t})~-~$ $z_{t+1}||_{2}^{2}$ can be interpreted as a variant of MLE loss, hence MI can be applied to a wide range of sequential data tasks that utilize MSE loss. ", "page_idx": 4}, {"type": "text", "text": "Proposition 2. Assume that the predicted conditional probability density $Q$ learned by the prediction model follows $Q(Z_{t+1}|Z_{t-k+1}^{t})=\\mathcal{N}(Z_{t+1}|F(Z_{t-k+1}^{t}),I_{D})$ , where $\\mathcal{N}(\\cdot)$ denotes a Gaussian distribution with mean $F(\\mathbf{Z}_{t-k+1}^{t})$ and identity covariance matrix $I_{D}$ . Then, the following holds ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\mathcal{L}_{m l e}=\\mathcal{L}_{m s e}+c o n s t,\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "where $\\mathcal{L}_{m s e}$ is the MSE loss and const is a constant term. ", "page_idx": 4}, {"type": "text", "text": "5 Measure evolving patterns without correspondences ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "5.1 Estimate joint distribution ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "In many real-world applications, instead of processing many data point observations at different timestamps as data sequences, one needs to handle a data set at each timestamp: $\\{z_{t,i}\\}_{i=1}^{n_{t}}$ collected from multiple timestamps $t=\\{1,\\ldots,T\\}$ [48, 42], where $i$ is the sample index and $n_{t}$ is the number of samples collected at timestamp $t$ . The distribution $P(Z_{t})$ associated with these data sets evolves over time $t\\,\\in\\,\\mathbb{R}$ . For example, consider a supervised learning problem involving medical data $z_{t,i}=(x_{t,i},y_{t,i})$ collected from multiple patients at different ages [42, 6]. In this scenario, we do not track the same patient across different ages, resulting in a lack of correspondence between timestamps and our objective extends to characterizing the evolving patterns of $\\{Z_{t}\\}_{t=1}^{T}$ across these discrete timestamps. However, EVORATE proposed in subsection 4.1 cannot be applied to this context due to the absence of the correspondences. ", "page_idx": 4}, {"type": "text", "text": "Estimating the mutual information from two data sets requires the pairwise correspondences between the sample of two data sets, which are assumed as given in existing works [8, 1, 27, 10, 29]. The correspondence between $Z_{t}$ and $Z_{t+1}$ reflects their joint distribution as it encapsulates how the values of $Z_{t}$ and $Z_{t+1}$ co-occur. This structured relationship indicates the interdependence of $Z_{t}$ and $Z_{t+1}$ , which the joint distribution quantifies. Since the absence of the correspondence (i.e., an object observed at time $t$ is not at time $t+1$ ), we can not access the joint probability distribution of the past states and the next state. To tackle this issue, we estimate the joint distribution through the optimal transport plan of the Wasserstein Distance. Specifically, we define the distance loss according to a joint distribution measurement $\\pi$ ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\mathcal{L}_{\\mathcal{W}}^{t}(\\pi,f)=\\mathbb{E}_{(z_{t},z_{t+1})\\sim\\pi}||f(g(z_{t}))-g(z_{t+1})||_{2}^{2}}\\end{array}\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "where $g$ is fixed from updated gradients computed from $\\mathcal{L}_{\\mathcal{W}}^{t}$ . Empirically, allowing $g$ to update during model training leads to the undesirable outcome of all representations collapsing into a single point as a result of minimizing the Wasserstein distance loss. To avoid this and preserve maximal information within the representations, $g$ is trained separately using an auto-encoder architecture with a reconstruction MSE loss. ", "page_idx": 4}, {"type": "text", "text": "Then, we compute the optimal transport plan $\\pi^{*}$ to approximate the real joint distribution ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\pi^{*}(Z_{t},Z_{t+1})=\\operatorname*{arg\\,min}_{\\pi\\;\\in\\;\\Pi(P(Z_{t}),\\,P(Z_{t+1}))}\\;\\mathcal{L}_{\\mathcal{W}}^{t}(\\pi,f),\\quad\\forall t\\in\\{1,\\ldots,T-1\\},\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "and $f$ is updated in an alternating optimization manner with fixed $\\pi^{*}$ to minimize $\\mathcal{L}_{\\mathcal{W}}^{t}(\\pi^{*},f)$ . When the original dimension $D$ is low, $g$ can be an identity function for precise MI estimation. Conversely, when $D$ is high, directly learning $f$ from $Z_{t}$ to $Z_{t+1}$ requires more accurate information and precise correspondence. This is because $f$ must be a considerably more complex and larger model to facilitate mapping from one high-dimensional space to another. As a result, the hypothesis space $\\mathcal{F}$ for $f$ expands, requiring more information to ensure the model converges to an optimal state. The absence of correspondence therefore presents a challenge as it leads to an information-insufficient situation and it becomes more suitable to set a smaller representation dimension $d$ . ", "page_idx": 4}, {"type": "text", "text": "It is noted that when the correspondences between two consecutive timestamps exist, they can be inferred by minimizing the Wasserstein distance. When such correspondences do not exist, one can still establish correspondences by identifying a proxy of $z_{t,i}$ in the succeeding timestamp that exhibits similar dynamics and shares the latent evolving patterns. ", "page_idx": 5}, {"type": "text", "text": "5.2 EVORATEW ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "We hence use $\\pi^{*}(Z_{t},Z_{t+1})$ to estimate joint distribution $P$ , and then obtain the following estimator with $\\pi^{*}(Z_{t},Z_{t+1})$ ", "page_idx": 5}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathrm{EvoRate}_{\\mathcal{W}}=\\mathbb{E}_{(z_{t},z_{t+1})\\sim\\pi^{*}(Z_{t},Z_{t+1})}-||f(g(z_{t})))-g(z_{t+1})||_{2}^{2}}\\\\ &{\\qquad\\qquad\\qquad-\\log\\mathbb{E}_{z_{t}\\sim P(Z_{t}),z_{t+1}\\sim P(Z_{t+1})}e^{-||f(g(z_{t}))-g(z_{t+1})||_{2}^{2}}}\\end{array}\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "Here $k$ can be regarded to set to 1 compared to equation 4, indicating that $\\mathtt{E v o R A T E}_{\\mathcal{W}}$ focuses on the first-order evolving patterns. It is possible to extend this approach to estimate higher-order $k$ -order sequences by iteratively leveraging outcomes from first-order through to $k$ -order sequential modeling. ", "page_idx": 5}, {"type": "text", "text": "5.3 Discussion ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "The following remark argues that there exists an optimal function that precisely captures the underlying dynamics of evolving data. ", "page_idx": 5}, {"type": "text", "text": "Remark 1. (Realization) In machine learning prediction tasks, there exists a function $f^{*}\\in\\mathcal{F}:\\mathcal{Z}\\to$ $\\mathcal{Z}$ where the conditional distribution of $Z_{t+1}$ given $Z_{t}$ satisfies ", "page_idx": 5}, {"type": "equation", "text": "$$\nZ_{t+1}\\sim\\mathcal{N}(f^{*}(Z_{t}),\\sigma^{2}I)=P(Z_{t+1}|Z_{t})\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "The following lemma demonstrates that when $f$ reaches the optimal predictive model $f^{*}$ , the estimated optimal transport plan equals the real joint distribution. In this context, we consider $g$ to be the identity function. ", "page_idx": 5}, {"type": "text", "text": "Lemma 1. Let $P(Z_{t},Z_{t+1})$ be the ground truth joint distribution. If $f$ attains $f^{*}$ , then ", "page_idx": 5}, {"type": "equation", "text": "$$\n\\pi^{*}(Z_{t},Z_{t+1})=P(Z_{t},Z_{t+1})\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "Below, we give an illustrative example. As $T\\gg1$ , the function $f$ will converge to $f^{*}$ by minimizing $\\mathcal{L}_{\\mathcal{W}}^{t}(\\pi^{*},f)$ . It demonstrates that for a dynamic system without correspondences, the number of timestamps must be greater than 1 to learn the optimal autoregressive model effectively. ", "page_idx": 5}, {"type": "text", "text": "Example Consider data collected from multiple time steps where each sample is a vector $Z_{t}\\in\\mathbb{R}^{D}$ . Specifically, the initial data points at the first timestamp is modeled as a Gaussian variable $Z_{1}\\sim$ $\\bar{\\mathcal{N}}(\\mu_{1},\\Sigma_{1})$ . The temporal evolution of the data is governed by a transition function ", "page_idx": 5}, {"type": "equation", "text": "$$\nz_{t+1}=f^{*}(Z_{t})=A^{*}z_{t}+b^{*},t\\in\\{1,\\ldots,T\\}\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "and each $Z_{t}$ follows a Gaussian distribution $\\boldsymbol{Z}_{t}\\sim\\mathcal N(\\mu_{t},\\Sigma_{t})$ where $\\boldsymbol{A}^{*}\\in\\mathbb{R}^{D\\times D}$ , $b^{*}\\in R^{D}$ . Solving the optimizing problem $\\mathcal{L}_{\\mathcal{W}}^{t}(\\pi^{*},f),t\\in\\{1,\\ldots,T-1\\}$ can lead to the solutions reaching optimal mapping $f^{*}$ with $t\\gg1$ . (Experiment results shown in Figure 1c,1d) ", "page_idx": 5}, {"type": "text", "text": "6 Experiment ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "6.1 Multivariate Gaussians with tractable MI ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "Sequential data with known correspondence We sample data sequences $\\{z_{t}\\}_{t=1}^{T},t\\in\\{1,\\ldots,T\\}$ , $\\begin{array}{r}{z_{T}\\;=\\;\\rho\\frac{\\sum_{t=1}^{T-1}z_{t}}{T-1}+\\sqrt{1-\\rho^{2}}\\epsilon}\\end{array}$ , with correlation $\\rho\\;\\in\\;[-1,1]$ , $\\epsilon\\,\\sim\\,\\mathcal{N}(0,I)$ , $Z_{t}\\ \\sim\\mathcal{N}(0,I),t\\ \\in$ $\\{1,\\dots,T-1\\}$ . Given the correlation coefficient $\\rho$ and dimensionality $D=128$ , we can compute the ground truth MI as $E v o R a t e(\\mathbf{Z}_{1}^{T-1};{Z}_{T})=-(D/2)\\ln(1-\\rho^{2})$ . The optimal MI estimation can be achieved when sequential model $f$ equals the ground truth model $f^{*}=A v g$ , where $A v g(\\cdot)$ is an average operation. In Figure 1a and 1b, we increase $\\rho$ over training steps to show the estimator behavior depends on the true mutual information. Additionally, we experiment with two forms of architecture: separable and joint. Separable architectures independently map the representations of history states $f(\\mathbf{Z}_{1}^{T-1})$ and the future state $Z_{T}$ to an embedding space with neural nets $\\phi_{1}$ and $\\phi_{2}$ separably, and then take the inner product, i.e. $\\phi_{1}\\big(f(\\mathbf{Z}_{1}^{T-1})\\big)^{T}\\phi_{2}\\big(Z_{T}\\big)$ as in [37]. Joint critics concatenate each $f(\\mathbf{Z}_{1}^{T-1})$ , $Z_{T}$ pair before feeding it into the network, i.e. $\\phi\\big([f(\\mathbf{Z}_{1}^{T-1});Z_{T}]\\big)$ as in [8]. In this experiment, $g$ is set to an identity function, and the sequential model $f$ is set to an LSTM [25]. All networks are fully-connected networks with ReLU activations. Figure 1a shows the estimated mutual information by EVORATE over the number of iterations, and square error metric can let $f$ converge to $f^{*}$ such that the $\\mathtt{E v o R A T E}_{\\mathcal{W}}$ converges to ground truth mutual information. Figure 1b verifies that the square error metric has a lower bias compared to trainable concat critic and separable critic. ", "page_idx": 5}, {"type": "image", "img_path": "I2gVmVRgNk/tmp/7aeecb0e0ca673aed663a1e6340a9ce5ea675d192426cfda26b6b67c8a20a1e3.jpg", "img_caption": ["Figure 1: (a-b) Performance of (a) EVORATE / (b) concat and separate critic on mutual information estimation on sequential data with correspondence. (c-d) Performance of EVORATEW on mutual information estimation on two consecutive time steps without correspondence, where $g$ is (c) an identity function / (d) neural nets. "], "img_footnote": [], "page_idx": 6}, {"type": "image", "img_path": "I2gVmVRgNk/tmp/c31ad203e9110cc1d58c145083e1c976ef566ddc1095dc29c3f596e6e36aaba4.jpg", "img_caption": ["Figure 2: (a) $k$ -order EVORATE estimation. (b) EVORATE estimation on a different number of features. (c) EVORATE estimation of the video prediction tasks with a different corruption rate. "], "img_footnote": [], "page_idx": 6}, {"type": "text", "text": "", "page_idx": 6}, {"type": "text", "text": "Sequential data without known correspondence We sample data sequence $\\{z_{t}\\}_{t=1}^{T},t\\quad\\in$ $\\{1,\\dots,T\\mathrm{~-~}1\\}$ , $z_{t+1}\\;=\\;\\rho(A^{*}z_{t}\\,+\\,b^{*})\\,+\\,{\\sqrt{1-\\rho^{2}}}\\epsilon$ , where $A^{*}\\ \\in\\ \\mathbb{R}^{D\\times D}$ is a rotation matrix, $b^{*}\\in\\mathbb{R}^{D}$ is a translation vector, correlation of $\\rho\\in[-1,1]$ , $\\epsilon\\sim\\mathcal{N}(0,I)$ , and $Z_{1}\\sim\\mathcal{N}(0,I)$ . Given the correlation coefficient $\\rho$ and dimensionality $D\\,=\\,128$ , we can compute the ground truth MI value $E v o R a t e(Z_{t};Z_{t+1})=-(D/2)\\ln(1-\\rho^{\\bar{2}})$ . The optimal MI estimation can be achieved when sequential model $f$ equals the ground truth model $f^{*}=A^{*}z_{t}+b^{*}$ . In this experiment, it is actually very difficult to estimate mutual information without correspondence. As a result, the estimations by joint and separable critic do not converge and fail in the case without correspondence, which further shows the square error metric shows better performance than the trainable neural nets critic. In Figure 1c,1d, $g$ being an identity function estimates a higher value than $g$ being a neural-nets encoder. It is noted that $\\mathtt{E v o R A T E}_{\\mathcal{W}}$ is the only method able to estimate the mutual information without the correspondence between timestamps, achieving a reasonable performance to estimate MI. ", "page_idx": 6}, {"type": "text", "text": "6.2 Sequential data\u2019s order approximation and feature selection ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "Order Approximation We sample data with 5-order $[k=5]$ ), and dimensionality $D=5$ , which means $Z_{t+1}$ is determined by $\\mathbf{Z}_{t-4}^{t}$ . More specifically, the data is generated by the dynamic function $Z_{t+1}=A^{*}\\mathrm{vec}(Z_{t-4}^{t})+b^{*}$ , where in this experiment, $\\operatorname{vec}({\\cdot})$ is a vectorized operation, $A^{*}\\in\\mathbb{R}^{5\\times25}$ and $b^{*}\\in\\mathbb{R}^{5}$ . We vary $k\\in\\{1,3,5,12,24\\}$ to measure the EVORATE between $\\mathbf{Z}_{t-k+1}^{t}$ and $Z_{t+1}$ . Figure 2a shows that $k=5$ has the maximal EVORATE value. In another experiment, the time series forecasting task is used to verify the effectiveness of EVORATE. Time series forecasting performance is evaluated with the sMAPE metric [35], measured as the mean absolute error scaled by the magnitude of the predictions and target. The performance shown in Table 1 is the SOTA method [53] and they set the model with order $k\\,=\\,45$ . The order is set as $k\\,\\in\\,\\{10,25,45,90,180,270\\}$ . Although $k=270$ achieves the highest EvoRate, the difference between $k=270$ and $k=90$ is only 0.03, and the performances over average (AVG) sMAPE have the same prediction error. For M4-Weekly, EVORATE shows order set as $k\\,=\\,90$ can achieve a good performance. Although EVORATE is slightly higher for $k=270$ than $k=90$ , it sacrifices three times more computation consumptions compared to only a $+0.03$ EVORATE gain if the model time complexity is $O(k)$ . Forecastability (ForeCA) fails in this experiment, as shown in Table 1, since the longer time series shows smaller forecastability but it achieves smaller sMAPE and a better performance. Longer sequence can have more evolving patterns in different frequencies combined and result in a smaller forecastability, but it may be more easily predictable once the patterns are learned by the model. Therefore, we conclude that the entropy used by ForeCA is not a good indicator of the capability of predictions while MI used by EVORATE is. In addition, randomness is a critical factor for the capability of the predictions of the sequential data. Since one of the evolving patterns is learned by sequential models, the performance only relies on the randomness of the data, which can be regarded as unwanted noises or unobserved factors. ", "page_idx": 6}, {"type": "text", "text": "", "page_idx": 7}, {"type": "table", "img_path": "I2gVmVRgNk/tmp/2b7540255fa5a1e8e4b59dbbde759fe87935e3a2784056b696d74f637e545bf3.jpg", "table_caption": ["Table 1: Time series forecasting (TSF) tasks: M4-Weekly The values of EVORATE and time series forecasting performance below are experiments on dataset M4-Weekly. Here, short, medium, long, Avg stands for shorthorizon sMAPE, medium-horizon sMAPE, long-horizon sMAPE, and the whole average sMAPE. "], "table_footnote": [], "page_idx": 7}, {"type": "text", "text": "Feature Selections For autoregressive tasks, poor predictions may due to the lack of the features. Some features may be redundant and some may be unrelated to predictions. Others may be related to the task but are not put as input fed into the prediction model. The synthetic data has 5 dimensions, where the first 3 are useful, the fourth is redundant and the fifth is unrelated (Details in Appendix B.4). Figure 2b shows the EVORATE of the data sequence with the first $n$ features. The results show that i) EVORATE achieves the highest value with the first three features, ii) the first four features containing one redundant feature sees a minor performance drop, and iii) using all five features sees a larger drop. ", "page_idx": 7}, {"type": "text", "text": "6.3 EvoRate as a criterion for existence of evolving patterns ", "text_level": 1, "page_idx": 7}, {"type": "text", "text": "In some problems, data is sampled independently from the history observations [49, 2]. In this case, we suggest directly learning a model using ERM [49] for i.i.d (independent and identically distributed) or IRM [2] for data sampled independently but with distribution shifts. In many machine learning applications, data is predicted in an autoregressive manner by training sequential models [50, 9, 16, 33]. Whether to use ERM/IRM or sequential models directly depends on the existence of the evolving patterns. Therefore, we take EVORATE as the criterion for the existence of evolving patterns. ", "page_idx": 7}, {"type": "text", "text": "Multivariate time series In Table 2, EVORATE can achieve better estimates of the evolving patterns compared to ForeCA, where stronger evolving patterns indicate smaller regression errors using sequential models. Specifically, for M4-Monthly and M4-daily, ForeCA shows equal values but EVORATE shows higher values for M4-Daily, consistent with experimental results in which M4-Daily achieves lower sMAPE. ", "page_idx": 7}, {"type": "text", "text": "Evolving Domain Generalization (EDG) follows our setting in Section 5.1, where the correspondence is intractable and we aim to learn the evolving patterns to predict $y_{t,i}$ conditioned on input $x_{t,i}$ for every sample $z_{t,i}=\\{x_{t,i},y_{t,i}\\}$ [42, 57]. In Table 3, we show the performance of $\\mathtt{E v o R A T E}_{\\mathcal{W}}$ and SOTA performance for invariant learning [2] and evolving learning [42, 57, 59]. Although, performance of the evolving representation learning not only depends on the existence of the evolving patterns (shown by values of $\\mathtt{E v o R A T E}_{\\mathcal{W}}$ ), EVOR $\\mathrm{ATE}\\gamma\\,$ is still a critical factor in deciding whether to use sequential models. For example, PORTRAITS hahs the lowest $\\mathtt{E v o R A T E}_{\\mathcal{W}}\\ 0.$ .25 and show the smallest improvement $3.7\\%$ of the performance of evolving learning than invariant learning, and RGaussian has the highest $\\mathtt{E v o R A T E}\\nu\\ 1.5$ 8 and show the largest improvement of the performance as $50.2\\%$ . ", "page_idx": 7}, {"type": "table", "img_path": "I2gVmVRgNk/tmp/8b03be9a02976c32b7bbfef28dcf131e453c601b965dc5b7276d93335965439e.jpg", "table_caption": ["Table 2: Time series forecasting (TSF) tasks: The estimated mutual information for the sequential data for different datasets. RMSE (Crypto, Player Traj.)/sMAPE (M4-Monthly, M4-Weekly, M4-Daily) is the performance of one SOTA TSF method [53]. "], "table_footnote": [], "page_idx": 8}, {"type": "text", "text": "", "page_idx": 8}, {"type": "table", "img_path": "I2gVmVRgNk/tmp/10b0360dd403ff36f5b765a79c082c5cde0030c95b7b7c5a3fa18142386d00b1.jpg", "table_caption": ["Table 3: The estimated mutual information for the evolving domains for different datasets. The reported results are the average accuracy of the multiple target domains. "], "table_footnote": [], "page_idx": 8}, {"type": "text", "text": "6.4 Control randomness to corrupt evolving patterns ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "Video prediction aims to predict future video frames from the current ones. In this experiment, we evaluate EVORATE on the KITTI dataset [20], which contains 28 driving videos with a resolution of $375\\!\\times\\!1242$ . 24 videos in KITTI dataset are used for training. We verify the performance of EVORATE by shuffling the index of the sequential data with a certain corrupt probability, and this randomness will decrease the evolving patterns (Figure 3). ", "page_idx": 8}, {"type": "text", "text": "Figure 2c shows that by increasing the corruption rate to the video sequence, EVORATE exhibits a lower value. This is consistent with our ", "page_idx": 8}, {"type": "image", "img_path": "I2gVmVRgNk/tmp/b21c166110cf4152e2a065df00bcd7615ca9ff4ae36f8c4e8db7fac687239be2.jpg", "img_caption": ["Figure 3: Illustration of corrupting the video\u2019s evolving patterns by randomly swapping the frame. "], "img_footnote": [], "page_idx": 8}, {"type": "text", "text": "intuition, which is that the continuous video stream shows higher patterns compared to the disordered video clips. ", "page_idx": 8}, {"type": "text", "text": "6.5 Algorithms to improve performance on EDG tasks ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "From the intuition that $\\mathcal{L}_{\\mathcal{W}}$ can estimate the joint distribution, we apply this loss to learn a transition model based on the estimated joint distribution between two consecutive domains. Table 5 shows this is an efficient method and achieves improved performance on EDG tasks. Our method shows an $11.7\\%$ higher average accuracy than the second-best baselines. ", "page_idx": 8}, {"type": "table", "img_path": "I2gVmVRgNk/tmp/44da477237649e6c3ac7e1da6db1f807b80fae7f424135b0acce169b1c914d71.jpg", "table_caption": ["Table 4: The comparison of the classification accuracy $(\\%)$ between our and baseline methods across the synthetic and real-world datasets. The reported results are the average accuracy of the multiple target domains. "], "table_footnote": [], "page_idx": 8}, {"type": "text", "text": "7 Conclusion ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "In this work, we propose EVORATE to qualitatively estimate the evolving patterns for the data sequences and the data snapshots from multiple consecutive timestamps without correspondences. We show the square error metric can be both a better critic for mutual information estimation, and a well-designed loss to help the optimal transport plan converge to the real joint distribution and the sequential model converge to the latent dynamic governing function. EVORATE reflects the complex patterns for high-dimensional data and is more computationally efficient than directly evaluating the performance of sequential data predictions. Experiments show EVORATE is an effective measure for evolving patterns and has the potential for many applications in the machine learning area. ", "page_idx": 9}, {"type": "text", "text": "Acknowledgements ", "text_level": 1, "page_idx": 10}, {"type": "text", "text": "We appreciate constructive feedback from anonymous reviewers and meta-reviewers. This work is supported by the Natural Sciences and Engineering Research Council of Canada (NSERC), Discovery Grants program. ", "page_idx": 10}, {"type": "text", "text": "References ", "text_level": 1, "page_idx": 10}, {"type": "text", "text": "[1] Alexander A Alemi, Ian Fischer, Joshua V Dillon, and Kevin Murphy. Deep variational information bottleneck. In International Conference on Learning Representations, 2016.   \n[2] Martin Arjovsky, L\u00e9on Bottou, Ishaan Gulrajani, and David Lopez-Paz. Invariant risk minimization. arXiv preprint arXiv:1907.02893, 2019.   \n[3] Martin Arjovsky, Soumith Chintala, and L\u00e9on Bottou. Wasserstein generative adversarial networks. In International conference on machine learning, pages 214\u2013223. PMLR, 2017.   \n[4] Omri Azencot, N Benjamin Erichson, Vanessa Lin, and Michael Mahoney. Forecasting sequential data using consistent koopman autoencoders. In International Conference on Machine Learning, pages 475\u2013485. PMLR, 2020.   \n[5] Adri\u00e0 Puigdom\u00e8nech Badia, Bilal Piot, Steven Kapturowski, Pablo Sprechmann, Alex Vitvitskyi, Daniel Guo, and Charles Blundell. Agent57: Outperforming the atari human benchmark. In International Conference on Machine Learning, pages 507\u2013517, 2020.   \n[6] Guangji Bai, Chen Ling, and Liang Zhao. Temporal domain generalization with drift-aware dynamic neural networks. In The Eleventh International Conference on Learning Representations, 2023.   \n[7] Peter W Battaglia, Jessica B Hamrick, Victor Bapst, Alvaro Sanchez-Gonzalez, Vinicius Zambaldi, Mateusz Malinowski, Andrea Tacchetti, David Raposo, Adam Santoro, Ryan Faulkner, et al. Relational inductive biases, deep learning, and graph networks. arXiv preprint arXiv:1806.01261, 2018.   \n[8] Mohamed Ishmael Belghazi, Aristide Baratin, Sai Rajeshwar, Sherjil Ozair, Yoshua Bengio, Aaron Courville, and Devon Hjelm. Mutual information neural estimation. In Jennifer Dy and Andreas Krause, editors, Proceedings of the 35th International Conference on Machine Learning, volume 80 of Proceedings of Machine Learning Research, pages 531\u2013540. PMLR, 10\u201315 Jul 2018.   \n[9] Tom B Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared Kaplan, Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell, et al. Language models are few-shot learners. In Advances in Neural Information Processing Systems, volume 33, pages 1877\u20131901, 2020.   \n[10] Xi Chen, Yan Duan, Rein Houthooft, John Schulman, Ilya Sutskever, and Pieter Abbeel. Infogan: Interpretable representation learning by information maximizing generative adversarial nets. Advances in neural information processing systems, 29, 2016.   \n[11] Pengyu Cheng, Weituo Hao, Shuyang Dai, Jiachang Liu, Zhe Gan, and Lawrence Carin. Club: A contrastive log-ratio upper bound of mutual information. In International conference on machine learning, pages 1779\u20131788. PMLR, 2020.   \n[12] Thomas M Cover. Elements of information theory. John Wiley & Sons, 1999.   \n[13] Marco Cuturi. Sinkhorn distances: Lightspeed computation of optimal transport. Advances in neural information processing systems, 26, 2013.   \n[14] Hoang Anh Dau, Anthony Bagnall, Kaveh Kamgar, Chin-Chia Michael Yeh, Yan Zhu, Shaghayegh Gharghabi, Chotirat Ann Ratanamahatana, and Eamonn Keogh. The ucr time series archive. IEEE/CAA Journal of Automatica Sinica, 6(6):1293\u20131305, 2019.   \n[15] Li Deng. The mnist database of handwritten digit images for machine learning research [best of the web]. IEEE signal processing magazine, 29(6):141\u2013142, 2012.   \n[16] Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova. Bert: Pre-training of deep bidirectional transformers for language understanding. arXiv preprint arXiv:1810.04805, 2018.   \n[17] Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova. Bert: Pre-training of deep bidirectional transformers for language understanding. In Proceedings of the 2019 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies, volume 1, pages 4171\u20134186, 2019.   \n[18] Chelsea Finn, Ian Goodfellow, and Sergey Levine. Unsupervised learning for physical interaction through video prediction. In Advances in Neural Information Processing Systems, volume 29, pages 64\u201372, 2016.   \n[19] R\u00e9mi Flamary, Nicolas Courty, Alexandre Gramfort, Mokhtar Z. Alaya, Aur\u00e9lie Boisbunon, Stanislas Chambon, Laetitia Chapel, Adrien Corenflos, Kilian Fatras, Nemo Fournier, L\u00e9o Gautheron, Nathalie T.H. Gayraud, Hicham Janati, Alain Rakotomamonjy, Ievgen Redko, Antoine Rolet, Antony Schutz, Vivien Seguy, Danica J. Sutherland, Romain Tavenard, Alexander Tong, and Titouan Vayer. Pot: Python optimal transport. Journal of Machine Learning Research, 22(78):1\u20138, 2021.   \n[20] Andreas Geiger, Philip Lenz, Christoph Stiller, and Raquel Urtasun. Vision meets robotics: The kitti dataset. The International Journal of Robotics Research, 32(11):1231\u20131237, 2013.   \n[21] Matthias Gelbrich. On a formula for the l2 wasserstein metric between measures on euclidean and hilbert spaces. Mathematische Nachrichten, 147(1):185\u2013203, 1990.   \n[22] Muhammad Ghifary, W Bastiaan Kleijn, Mengjie Zhang, and David Balduzzi. Domain generalization for object recognition with multi-task autoencoders. In Proceedings of the IEEE international conference on computer vision, pages 2551\u20132559, 2015.   \n[23] Shiry Ginosar, Kate Rakelly, Sarah Sachs, Brian Yin, and Alexei A Efros. A century of portraits: A visual historical record of american high school yearbooks. In Proceedings of the IEEE International Conference on Computer Vision Workshops, pages 1\u20137, 2015.   \n[24] Georg Goerg. Forecastable component analysis. In International conference on machine learning, pages 64\u201372. PMLR, 2013.   \n[25] Sepp Hochreiter and J\u00fcrgen Schmidhuber. Long short-term memory. Neural computation, 9(8):1735\u20131780, 1997.   \n[26] Judy Hoffman, Trevor Darrell, and Kate Saenko. Continuous manifold based adaptation for evolving visual domains. In Proceedings of the IEEE conference on computer vision and pattern recognition, pages 867\u2013874, 2014.   \n[27] Rein Houthooft, Xi Chen, Yan Duan, John Schulman, Filip De Turck, and Pieter Abbeel. Vime: Variational information maximizing exploration. Advances in neural information processing systems, 29, 2016.   \n[28] Maximilian Ilse, Jakub M Tomczak, Christos Louizos, and Max Welling. Diva: Domain invariant variational autoencoders. In Medical Imaging with Deep Learning, pages 322\u2013348. PMLR, 2020.   \n[29] Xu Ji, Joao F Henriques, and Andrea Vedaldi. Invariant information clustering for unsupervised image classification and segmentation. In Proceedings of the IEEE/CVF international conference on computer vision, pages 9865\u20139874, 2019.   \n[30] Takeshi Koshizuka and Issei Sato. Neural lagrangian schr\u00f6dinger bridge: Diffusion modeling for population dynamics. In The Eleventh International Conference on Learning Representations, 2022.   \n[31] Matt Kusner, Yu Sun, Nicholas Kolkin, and Kilian Weinberger. From word embeddings to document distances. In International conference on machine learning, pages 957\u2013966. PMLR, 2015.   \n[32] Aodong Li, Alex Boyd, Padhraic Smyth, and Stephan Mandt. Detecting and adapting to irregular distribution shifts in bayesian online learning. Advances in neural information processing systems, 34:6816\u20136828, 2021.   \n[33] Bryan Lim, Sercan O Ar\u0131k, Nicolas Loeff, and Tomas Pfister. Temporal fusion transformers for interpretable multi-horizon time series forecasting. In International Conference on Machine Learning, pages 6315\u20136326, 2021.   \n[34] Yinhan Liu, Myle Ott, Naman Goyal, Jingfei Du, Mandar Joshi, Danqi Chen, Omer Levy, Mike Lewis, Luke Zettlemoyer, and Veselin Stoyanov. Roberta: A robustly optimized bert pretraining approach. In Proceedings of the Association for Computational Linguistics (ACL), 2020.   \n[35] Spyros Makridakis, Evangelos Spiliotis, and Vassilios Assimakopoulos. The m4 competition: 100,000 time series and 61 forecasting methods. International Journal of Forecasting, 36(1):54\u2013 74, 2020.   \n[36] David McAllester and Karl Stratos. Formal limitations on the measurement of mutual information. In International Conference on Artificial Intelligence and Statistics, pages 875\u2013884. PMLR, 2020.   \n[37] Aaron van den Oord, Yazhe Li, and Oriol Vinyals. Representation learning with contrastive predictive coding. arXiv preprint arXiv:1807.03748, 2018.   \n[38] Boris N Oreshkin, Dmitri Carpov, Nicolas Chapados, and Yoshua Bengio. N-beats: Neural basis expansion analysis for interpretable time series forecasting. In International Conference on Learning Representations, 2020.   \n[39] Hanchuan Peng, Fuhui Long, and Chris Ding. Feature selection based on mutual information criteria of max-dependency, max-relevance, and min-redundancy. IEEE Transactions on pattern analysis and machine intelligence, 27(8):1226\u20131238, 2005.   \n[40] Ali Pesaranghader and Herna L Viktor. Fast hoeffding drift detection method for evolving data streams. In Machine Learning and Knowledge Discovery in Databases: European Conference, ECML PKDD 2016, Riva del Garda, Italy, September 19-23, 2016, Proceedings, Part II 16, pages 96\u2013111. Springer, 2016.   \n[41] Gabriel Peyr\u00e9, Marco Cuturi, et al. Computational optimal transport: With applications to data science. Foundations and Trends\u00ae in Machine Learning, 11(5-6):355\u2013607, 2019.   \n[42] Tiexin Qin, Shiqi Wang, and Haoliang Li. Generalizing to evolving domains with latent structure-aware sequential autoencoder. In International Conference on Machine Learning, pages 18062\u201318082. PMLR, 2022.   \n[43] Tiexin Qin, Shiqi Wang, and Haoliang Li. Generalizing to evolving domains with latent structure-aware sequential autoencoder. In International Conference on Machine Learning, pages 18062\u201318082. PMLR, 2022.   \n[44] Syama Sundar Rangapuram, Matthias W Seeger, Jan Gasthaus, Lloren\u00e7 Stella, Yuyang Wang, and Tim Januschowski. Deep state space models for time series forecasting. In Advances in Neural Information Processing Systems, volume 31, 2018.   \n[45] David Silver, Satinder Singh, Doina Precup, and Richard S Sutton. Reward is enough. In Artificial Intelligence, volume 299, page 103535. Elsevier, 2021.   \n[46] Jiaming Song and Stefano Ermon. Understanding the limitations of variational mutual information estimators. In International Conference on Learning Representations, 2019.   \n[47] Baochen Sun and Kate Saenko. Deep coral: Correlation alignment for deep domain adaptation. In Computer Vision\u2013ECCV 2016 Workshops: Amsterdam, The Netherlands, October 8-10 and 15-16, 2016, Proceedings, Part III 14, pages 443\u2013450. Springer, 2016.   \n[48] Alexander Tong, Jessie Huang, Guy Wolf, David Van Dijk, and Smita Krishnaswamy. Trajectorynet: A dynamic optimal transport network for modeling cellular dynamics. In International conference on machine learning, pages 9526\u20139536. PMLR, 2020.   \n[49] Vladimir Naumovich Vapnik, Vlamimir Vapnik, et al. Statistical learning theory. 1998.   \n[50] Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N Gomez, \u0141ukasz Kaiser, and Illia Polosukhin. Attention is all you need. Advances in neural information processing systems, 30, 2017.   \n[51] C\u00e9dric Villani et al. Optimal transport: old and new, volume 338. Springer, 2009.   \n[52] Ruben Villegas, Jimei Yang, Seunghoon Hong, Xumin Lin, and Honglak Lee. Decomposing motion and content for natural video sequence prediction. In International Conference on Learning Representations, 2017.   \n[53] Rui Wang, Yihe Dong, Sercan \u00d6 Arik, and Rose Yu. Koopman neural forecaster for time series with temporal distribution shifts. arXiv preprint arXiv:2210.03675, 2022.   \n[54] Yunbo Wang, Zhifeng Jiang, Xingjian Wang, Junyuan Gao, and Yilun Xiong. Predrnn $^{++}$ : Towards a resolution of the deep-in-time dilemma in spatiotemporal predictive learning. In Proceedings of the 35th International Conference on Machine Learning, volume 80, pages 5123\u20135132, 2018.   \n[55] Shen Yan, Huan Song, Nanxiang Li, Lincan Zou, and Liu Ren. Improve unsupervised domain adaptation with mixup training. arXiv preprint arXiv:2001.00677, 2020.   \n[56] Tianhe Yu, Garrett Thomas, Lantao Yu, Stefano Ermon, James Zou, Sergey Levine, Chelsea Finn, and Tengyu Ma. Mopo: Model-based offilne policy optimization. In Advances in Neural Information Processing Systems, volume 33, pages 14129\u201314142, 2020.   \n[57] Qiuhao Zeng, Changjian Shui, Long-Kai Huang, Peng Liu, Xi Chen, Charles Ling, and Boyu Wang. Latent trajectory learning for limited timestamps under distribution shift over time. In The Twelfth International Conference on Learning Representations, 2024.   \n[58] Qiuhao Zeng, Wei Wang, Fan Zhou, Charles Ling, and Boyu Wang. Foresee what you will learn: Data augmentation for domain generalization in non-stationary environment. Proceedings of the AAAI Conference on Artificial Intelligence, 37(9):11147\u201311155, Jun. 2023.   \n[59] Qiuhao Zeng, Wei Wang, Fan Zhou, Gezheng Xu, Ruizhi Pu, Changjian Shui, Christian Gagne, Shichun Yang, Charles X Ling, and Boyu Wang. Generalizing across temporal domains with koopman operators. In Proceedings of the AAAI Conference on Artificial Intelligence, volume 38, pages 16651\u201316659, 2024. ", "page_idx": 10}, {"type": "text", "text": "", "page_idx": 11}, {"type": "text", "text": "", "page_idx": 12}, {"type": "text", "text": "", "page_idx": 13}, {"type": "text", "text": "A Proof of Theories ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "Proposition 1. Assume that the model\u2019s probability density follows $\\begin{array}{r l}{Q(Z_{t+1}|Z_{t-k+1}^{t})}&{{}=}\\end{array}$ $\\mathcal{N}(Z_{t+1};F(\\mathbf{Z}_{t-k+1}^{t}),I_{D})$ ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\mathcal{L}_{m l e}=\\mathcal{L}_{m s e}+c o n s t\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "Proof. ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\mathcal{L}_{m l e}=-\\mathbb{E}_{P}\\log Q=||F(\\mathbf{z}_{t-k+1}^{t})-z_{t+1}||_{2}^{2}+\\frac{D}{2}\\log(2\\pi)=\\mathcal{L}_{m s e}+c o n s t\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "Proposition 2. For autoregression tasks, the expected risk satisfy: ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\mathcal{L}_{m l e}=-I(Z_{t+1};\\mathbf{Z}_{t-k+1}^{t})+H(Z_{t+1})+D_{\\mathrm{KL}}(P(Z_{t+1}|\\mathbf{Z}_{t-k+1}^{t}),Q(Z_{t+1}|\\mathbf{Z}_{t-k+1}^{t}))\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "Proof. ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathcal{L}_{m l e}=-\\mathbb{E}_{\\mathbf{z}_{t-k+1}^{t+1}\\sim P(\\mathcal{Z}_{t-k+1},\\dots,\\mathcal{Z}_{t+1})}\\log Q(\\boldsymbol{Z}_{t+1}|\\mathbf{Z}_{t-k+1}^{t})}\\\\ &{\\qquad=-\\mathbb{E}_{\\mathbf{z}_{t-k+1}^{t+1}\\sim P(\\mathcal{Z}_{t-k+1},\\dots,\\mathcal{Z}_{t+1})}\\log\\frac{Q(\\boldsymbol{Z}_{t+1}|\\mathbf{Z}_{t-k+1}^{t})}{P(\\mathcal{Z}_{t+1}|\\mathbf{Z}_{t-k+1}^{t})}}\\\\ &{\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad-\\mathbb{E}_{\\mathbf{z}_{t-k+1}^{t+1}\\sim P(\\mathcal{Z}_{t-k+1}^{t},\\dots,\\mathcal{Z}_{t+1})}\\log P(\\boldsymbol{Z}_{t+1}|\\mathbf{Z}_{t-k+1}^{t})}\\\\ &{\\qquad=D_{\\mathrm{KL}}(P(\\boldsymbol{Z}_{t+1}|\\mathbf{Z}_{t-k+1}^{t}),Q(\\boldsymbol{Z}_{t+1}|\\mathbf{Z}_{t-k+1}^{t}))-\\mathbb{E}_{\\mathbf{z}_{t-k+1}^{t+1}\\sim P(\\mathcal{Z}_{t-k+1}^{t},\\dots,\\mathcal{Z}_{t+1})}\\log\\frac{P(\\boldsymbol{Z}_{t+1}|\\mathbf{Z}_{t-k+1}^{t})}{P(\\mathcal{Z}_{t+1})}}\\\\ &{\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad-\\mathbb{E}_{\\mathbf{z}_{t-k+1}^{t+1}\\sim P(\\mathcal{Z}_{t-k+1},\\dots,\\mathcal{Z}_{t+1})}\\log P(\\boldsymbol{Z}_{t+1})}\\\\ &{\\qquad=D_{\\mathrm{KL}}(P(\\boldsymbol{Z}_{t+1}|\\mathbf{Z}_{t-k+1}^{t}),Q(\\boldsymbol{Z}_{t+1}|\\mathbf{Z}_{t-k+1}^{t}))-I(\\boldsymbol{Z}_{t+1};\\mathbf{Z}_{t-k+1}^{t})+H(\\boldsymbol{Z}_{t+1})}\\end{array}{(1^{\\prime},\\mathrm{~w~e~r~w~i~n~a~l~})}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "$\\beta$ -mixing is a measure of the degree of dependence between random variables in a sequence over time, which is closely related to MI and furthermore upper bounded by MI: ", "page_idx": 14}, {"type": "text", "text": "Remark 1. $s\\in\\mathbb{N}$ , $\\beta$ -mixing coefficients defined in below satisfy: ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\beta(s)=\\underset{s}{\\operatorname*{sup}}\\,\\mathbb{E}_{\\mathbf{Z}_{-\\infty}^{t}}\\bigg[||P_{t+s}^{\\infty}(\\cdot|\\mathbf{Z}_{-\\infty}^{t})-P_{t+s}^{\\infty}||_{T V}\\bigg]\\leq\\underset{s}{\\operatorname*{sup}}\\,\\bigg[\\sqrt{2I(Z_{t+s}^{\\infty};\\mathbf{Z}_{-\\infty}^{t})}\\bigg]}\\end{array}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "where $||\\cdot||_{T V}$ is the maximum total variation distance. ", "page_idx": 14}, {"type": "text", "text": "Proof. ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\beta(s)=\\underset{s}{\\operatorname*{sup}}\\mathbb{E}_{{\\mathbf{Z}_{-\\infty}^{t}}}\\bigg[||P_{t+s}^{\\infty}(\\cdot|{\\mathbf{Z}_{-\\infty}^{t}})-P_{t+s}^{\\infty}||_{T V}\\bigg]}\\\\ &{\\qquad\\leq\\underset{s}{\\operatorname*{sup}}\\mathbb{E}_{{\\mathbf{Z}_{-\\infty}^{t}}}\\bigg[\\sqrt{2D_{\\mathrm{KL}}(P(Z_{t+s}^{\\infty}|{\\mathbf{Z}_{-\\infty}^{t}})||P(Z_{t+s}^{\\infty}))}\\bigg]}\\\\ &{\\qquad\\leq\\underset{s}{\\operatorname*{sup}}\\left[\\sqrt{2\\mathbb{E}_{{\\mathbf{Z}_{-\\infty}^{t}}}D_{\\mathrm{KL}}(P(Z_{t+s}^{\\infty}|{\\mathbf{Z}_{-\\infty}^{t}})||P(Z_{t+s}^{\\infty}))}\\right]=\\underset{s}{\\operatorname*{sup}}\\left[\\sqrt{2I(Z_{t+s}^{\\infty};{\\mathbf{Z}_{-\\infty}^{t}})}\\right]}\\end{array}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "where the first inequality follows Pinsker\u2019s inequality; the second inequality follows Jensen\u2019s Inequality. ", "page_idx": 14}, {"type": "text", "text": "Lemma 1. $P(X,Y)$ is the real underlying distribution, and $\\pi(X,Y)$ is the optimal transport plan that satisfies both margins comply with $P(X)$ and $P(Y)$ . We first define: ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\begin{array}{l}{\\displaystyle I_{P}(X;Y)=\\int p(x,y)\\log\\frac{p(x,y)}{p(x)p(y)}d x\\,d y}\\\\ {\\displaystyle I_{\\pi}(X;Y)=\\int\\pi(x,y)\\log\\frac{\\pi(x,y)}{p(x)p(y)}d x\\,d y}\\end{array}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "Then, we have ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{I_{p}(X;Y)-I_{\\pi}(X;Y)=H_{\\pi}(X,Y)-H_{p}(X,Y)=H_{\\pi}(Y|X)-H_{p}(Y|X)}\\\\ &{\\ {c a n\\,g e t\\,I_{P}(Z_{t};Z_{t+1})}-I_{\\pi}(Z_{t};Z_{t+1})=H_{\\pi}(Z_{t};Z_{t+1})-H_{P}(Z_{t};Z_{t+1}).}\\end{array}\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "Proof. ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{I_{p}(X;Y)-I_{\\pi}(X;Y)=\\displaystyle\\int p(x,y)\\log\\frac{p(x,y)}{p(x)p(y)}d x\\,d y-\\displaystyle\\int\\pi(x,y)\\log\\frac{\\pi(x,y)}{p(x)p(y)}d x\\,d y}\\\\ &{=\\displaystyle\\int p(x,y)\\log p(x,y)d x\\,d y-\\displaystyle\\int\\pi(x,y)\\log\\pi(x,y)d x\\,d y-\\displaystyle\\int p(x,y)\\log p(x)d x\\,d y}\\\\ &{-\\displaystyle\\int p(x,y)\\log p(y)d x\\,d y+\\displaystyle\\int\\pi(x,y)\\log p(x)d x\\,d y+\\displaystyle\\int\\pi(x,y)\\log p(y)d x\\,d y}\\\\ &{=\\displaystyle\\int p(x,y)\\log p(x,y)d x\\,d y-\\displaystyle\\int\\pi(x,y)\\log\\pi(x,y)d x\\,d y-\\displaystyle\\int p(x)\\log p(x)d x\\,d y}\\\\ &{-\\displaystyle\\int p(y)\\log p(y)d x\\,d y+\\displaystyle\\int p(x)\\log p(x)d x\\,d y+\\displaystyle\\int p(y)\\log p(y)d x\\,d y}\\\\ &{=H_{\\pi}(X,Y)-H_{p}(X,Y)}\\\\ &{=H_{\\pi}(X|Y)-H_{p}(X|Y)=H_{\\pi}(Y|X)-H_{p}(Y|X)}\\end{array}\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "26 to 27 is due to $p(x,y)$ and $\\pi(x,y)$ have the same margins $p(x)$ and $p(y)$ and we integral over $x$ or $y$ first. \u53e3 ", "page_idx": 15}, {"type": "text", "text": "Lemma 2. Let $P(Z_{t},Z_{t+1})$ be the ground truth joint distribution. If $f$ attains $f^{*}$ , then ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\pi^{*}(Z_{t},Z_{t+1})=P(Z_{t},Z_{t+1})\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "Proof. To finish the proof, we first assume $(z_{t},z_{t+1}^{\\prime})\\sim\\pi(Z_{t},Z_{t+1}),(z_{t},z_{t+1})\\sim\\pi(Z_{t},Z_{t+1})$ and $\\epsilon\\sim\\mathcal{N}(0,\\sigma^{2}I)$ , then, ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{\\epsilon\\in\\operatorname{min}\\lbrace\\mathrm{E}_{i,k}^{\\mathrm{id}}\\rbrace\\mathcal{E}_{i,k}^{n}(x_{i},t)}&{\\mathcal{E}_{i,k}^{n}(\\mathrm{tr},\\ f_{i,k}^{\\mathrm{m}})}\\\\ &{=\\phantom{\\sum}_{\\epsilon\\in\\mathrm{E}_{i,k}^{\\mathrm{id}}}\\sum_{\\rho\\in\\mathrm{E}_{i,k}^{\\mathrm{id}}}\\mathrm{E}_{i,k}^{n}(x_{i},\\lambda_{k+1}^{\\mathrm{id}})\\mathbb{E}_{i,k}^{n}(x_{i},\\lambda_{k+1}^{\\mathrm{id}})\\|\\tilde{f}(\\mathcal{X}_{i})-\\mathcal{E}_{i+1}^{n}\\|_{2}^{2}}\\\\ &{=\\phantom{\\sum}_{\\epsilon\\in\\mathrm{E}_{i,k}^{\\mathrm{id}}}\\sum_{\\rho\\in\\mathrm{E}_{i,k}^{\\mathrm{id}}}\\bigg[\\int\\|\\hat{X}_{i}^{\\epsilon}(x_{i}-z_{k+1})\\|_{2}^{2}\\,d z\\,\\mathcal{E}_{i-1}^{\\mathrm{id}}\\bigg]\\|\\tilde{f}(\\mathcal{X}_{i},z_{k+1})}\\\\ &{\\phantom{\\sum}_{\\epsilon\\in\\mathrm{E}_{i,k}^{\\mathrm{id}}}\\sum_{\\rho\\in\\mathrm{E}_{i,k}^{\\mathrm{id}}}\\bigg[2\\epsilon\\int_{i,k+1}^{\\mathrm{id}}-z_{k+1}\\|_{2}^{2}\\,d z\\,(\\mathcal{Z}_{i},z_{k+1})}\\\\ &{\\qquad-\\int\\mathcal{Z}^{n}(\\hat{z}_{i+1}^{\\dagger}-z_{k+1})\\,d z\\,(\\mathcal{Z}_{i},z_{k+1})+\\int\\left|\\vert\\hat{z}\\vert^{2}\\,d z\\,(\\mathcal{Z}_{i},z_{k+1})\\right]}\\\\ &{=\\phantom{\\sum}_{\\epsilon\\in\\mathrm{E}_{i,k}^{\\mathrm{id}}}\\sum_{\\rho\\in\\mathrm{E}_{i,k}^{\\mathrm{id}}}\\bigg[\\int\\|\\hat{z}_{i,k}^{\\mathrm{id}}(x_{i},z_{k+1})\\|_{2}^{2}\\,d z\\,(\\mathcal{Z}_{i},z_{k+1})}\\\\ &{\\qquad-\\int\\int\\mathcal{Z}^{n}(z_{i+1}^{\\dagger}-\\hat{f}_{i}(z\n$$", "text_format": "latex", "page_idx": 15}, {"type": "equation", "text": "$$\n\\operatorname*{inf}_{\\substack{\\pi\\in\\Pi(P(Z_{t}),\\,P(Z_{t+1}))}}\\;\\mathcal{L}_{\\mathcal{W}}^{t}(\\pi,f)=\\operatorname*{inf}_{\\substack{\\pi\\in\\Pi(P(Z_{t}),\\,P(Z_{t+1}))}}\\;\\int||z_{t+1}^{\\prime}-z_{t+1}||_{2}^{2}\\;d\\pi(Z_{t},Z_{t+1})\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "To achieve infimum of $\\mathcal{L}_{\\mathcal{W}}^{t}(\\pi,f),~Z_{t+1}^{\\prime}~=~Z_{t+1}$ should satisfy and hence $\\pi^{*}(Z_{t+1}|Z_{t})\\;\\;=\\;\\;$ $P(Z_{t+1}|Z_{t})$ and $\\pi^{*}(Z_{t+1},\\bar{Z_{t}})=P(Z_{t+1},Z_{t})$ with a feasible solution. \u53e3 ", "page_idx": 15}, {"type": "text", "text": "Example We consider data collected from multiple time steps where each sample is a vector $Z_{t}\\in\\bar{\\mathbb{R}}^{D}$ . Specifically, the initial data points at the first timestamp is modeled as a Gaussian variable $Z_{1}\\sim{\\mathcal{N}}(\\mu_{1},\\Sigma_{1})$ . The temporal evolution of the data is governed by a transition function: ", "page_idx": 16}, {"type": "equation", "text": "$$\nz_{t+1}=f^{*}(Z_{t})=A^{*}z_{t}+b^{*},t\\in\\{1,\\ldots,T\\}.\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "and each $Z_{t}$ follows a Gaussian distribution, $\\begin{array}{r}{Z_{t}\\,\\sim\\,\\mathcal{N}(\\mu_{t},\\Sigma_{t})}\\end{array}$ , where $A^{*}\\,\\in\\,\\mathbb{R}^{D\\times D}$ , $b^{*}\\ \\in\\ R^{D}$ . Solving the optimizing problem $\\mathcal{L}_{\\mathcal{W}}^{t}(\\pi,f),t\\in\\left\\{1,\\ldots,\\ddot{T}-1\\right\\}$ can lead to the solutions reaching optimal mapping $f^{*}$ with $t\\gg1$ . ", "page_idx": 16}, {"type": "text", "text": "Proof. Assume the linear transition function has parameters $(A,b)$ as $z_{t+1}=f(Z_{t})=A z_{t}+b$ , it can be inferred that $\\boldsymbol{Z}_{t+1}\\sim\\mathcal{N}(A\\mu_{t}+b,A\\Sigma_{t}A^{T})$ . ", "page_idx": 16}, {"type": "text", "text": "For each pair of data from two consecutive timestamp data, the Wasserstein distance loss can be expressed as follows, according to [21] ", "page_idx": 16}, {"type": "text", "text": "Wasserstein Distance ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\operatorname{\\toss=inf}_{\\pi}\\mathcal L_{\\mathcal W}(t)=||\\mu_{t}-(A\\mu_{t-1}+b)||_{2}^{2}+}\\\\ &{\\quad\\quad\\quad\\quad\\quad\\quad\\quad T r\\Bigg(A\\Sigma_{t-1}A^{T}+\\Sigma_{t}-2\\big(\\Sigma_{t}^{\\frac{1}{2}}A\\Sigma_{t-1}A^{T}\\Sigma_{t}^{\\frac{1}{2}}\\big)^{\\frac{1}{2}}\\Bigg)}\\end{array}\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "Then, we can have ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{\\operatorname*{inf}\\mathcal{L}_{N}(t)=\\|\\mu_{t-}(A\\mu_{t-1}+b)\\|_{2}^{2}+T\\gamma\\Bigg(4\\mathbb{E}_{t-1}A^{T}+\\Sigma_{t}\\Bigg)-\\Bigg(2T r(\\Sigma_{t}^{\\top}A^{\\top}\\Sigma_{t-1}A^{T}\\Sigma_{t}^{\\top})^{\\frac{1}{2}}\\Bigg)}\\\\ &{=\\|\\mu_{t-}(A\\mu_{t-1}+b)\\|_{2}^{2}+T\\gamma\\Bigg(4T\\Sigma_{t-1}A^{T}+\\Sigma_{t}\\Bigg)-\\Bigg(2T r(A^{T}\\Sigma_{t}A\\Sigma_{t-1})^{\\frac{1}{2}}\\Bigg)}\\\\ &{=\\|\\mu_{t-}(A\\mu_{t-1}+b)\\|_{2}^{2}+T\\gamma\\Bigg(4T\\Sigma_{t-1}A^{T}+\\Sigma_{t}-2(A^{T}\\Sigma_{t}A\\Sigma_{t-1})^{\\frac{1}{2}}\\Bigg)}\\\\ &{=\\|\\mu_{t-}(A\\mu_{t-1}+b)\\|_{2}^{2}+T\\gamma\\Bigg(4T r_{-1}A^{T}+\\Sigma_{t}\\Bigg)-\\Bigg(2T r(A^{T}\\Sigma_{t}A\\Sigma_{t-1})^{\\frac{1}{2}}\\Bigg)}\\\\ &{=\\|\\mu_{t-}(A\\mu_{t-1}+b)\\|_{2}^{2}+T\\gamma\\Bigg(4T r_{-1}A^{T}+\\Sigma_{t}\\Bigg)-\\Bigg(2T r(A^{T}\\Sigma_{t}A\\Sigma_{t-1})^{\\frac{1}{2}}\\Bigg)}\\\\ &{=\\|\\mu_{t-}(A\\mu_{t-1}+b)\\|_{2}^{2}+T\\gamma\\Bigg(4T r_{-1}A^{T}+\\Sigma_{t}-2(A^{T}\\Sigma_{t}A\\Sigma_{t-1})^{\\frac{1}{2}}\\Bigg)}\\\\ &{=\\|\\mu_{t-}(A\\mu_{t-1}+b)\\|_{2}^{2}+T\\gamma\\Bigg(4T r_{-1}A^{T}\\Sigma_{t}-\\Sigma_{t-1}\\Big)(A^{T}\\Sigma_{t}A-\\Sigma_{t-1})^{\\frac{1}{2}}\\Bigg)}\\\\ &{=\\|\\mu_{t-}(A\\mu_{t-1}+b)\\|_{2}^{2}+1[4T\\Sigma_{t}A-\\Sigma_{t-1}\\Big|\\nu\\mu\\mu\\mu\\mu\\mu\\mu\\mu\\mu\\mu\n$$", "text_format": "latex", "page_idx": 16}, {"type": "equation", "text": "$$\n\\left\\{\\begin{array}{l l}{A\\mu_{t-1}+b=\\mu_{t}}\\\\ {A^{T}\\Sigma_{t-1}A=\\Sigma_{t}}\\end{array}\\right.,\\forall\\;t=\\{2,\\ldots,T\\}\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "We are dealing with a system where the matrix $A$ and $b$ together comprise $n\\times(n+1)$ unknown variables. At each time step $t$ , the system is described by $n\\times n$ quadratic equations and $n$ linear equations. Typically, these quadratic equations yield two possible sets of solutions. To refine our estimates and converge towards the optimal parameters $(A^{*},b^{*})$ , employing a large number of time steps $(t\\gg1)$ ) allows us to formulate an overdetermined system of equations. ", "page_idx": 16}, {"type": "text", "text": "B Datasets ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "B.1 Multivariate Gaussians: sequential data with known correspondence ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "We sample data sequence $\\{z_{t}\\}_{t=1}^{T},t\\in\\{1,\\ldots,T\\}$ , $\\begin{array}{r}{z_{T}=\\rho\\frac{\\sum_{t=1}^{T-1}z_{t}}{T-1}+\\sqrt{1-\\rho^{2}}\\epsilon}\\end{array}$ , where correlation of $\\rho\\in[-1,1]$ , $\\epsilon\\sim\\mathcal{N}(0,I)$ , $Z_{t}\\sim\\mathcal{N}(0,I),t\\in\\{1,\\ldots,T-1\\}$ . Given the correlation coefficient $\\rho$ and dimensionality $D=128$ , we can compute the ground truth MI value $E v o R a t e(\\mathbf{Z}_{1}^{T-1};\\boldsymbol{Z}_{T})=$ $-(D/2)\\ln(1-\\rho^{2})$ . ", "page_idx": 16}, {"type": "text", "text": "B.2 Multivariate Gaussians: sequential data without known correspondence ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "We sample data sequence $\\{z_{t}\\}_{t=1}^{T},t\\in\\{1,\\dots,T-1\\}$ , $z_{t+1}=\\rho(A^{*}z_{t}+b^{*})+\\sqrt{1-\\rho^{2}}\\epsilon$ , where $\\boldsymbol{A}^{*}\\,\\in\\,\\mathbb{R}^{D\\times D}$ is a rotation matrix, $b^{*}\\,\\in\\,\\mathbb{R}^{D}$ is a translation vector, correlation of $\\rho\\,\\in\\,[-1,1]$ , $\\epsilon\\sim\\mathcal{N}(0,I)$ , and $Z_{1}\\sim\\mathcal{N}(0,I)$ . Given the correlation coefficient $\\rho$ and dimensionality $D=128$ , we can compute the ground truth MI value $E v o R a t e(Z_{t};Z_{t+1})=-(D/2)\\ln(1-\\rho^{2})$ . ", "page_idx": 17}, {"type": "text", "text": "B.3 Synthetic data for order approximation ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "We sample data with 5-order $[k=5]$ ), and dimensionality $D=5$ , which means $Z_{t+1}$ is determined by $Z_{t-4}^{t}$ . More specifically, the data is generated by the dynamic function $Z_{t+1}=A^{*}\\mathrm{vec}(Z_{t-4}^{t})+b^{*}$ , where in this experiment, $\\operatorname{vec}(\\cdot)$ is a vectorized operation, $A^{*}\\,\\in\\,\\mathbb{R}^{5\\times25}$ , and $b^{*}\\,\\in\\,\\mathbb{R}^{5}$ . In this experiment, we set $k$ to $\\{1,3,5,12,24\\}$ to measure the EVORATE between $\\mathbf{Z}_{t-k+1}^{t}$ and $Z_{t+1}$ . ", "page_idx": 17}, {"type": "text", "text": "B.4 Synthetic data for feature selection ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "In this experiment, We sample data with 5-order $[k=5]$ ), and dimensionality $D=5$ . Only first three features are decided by the past states: $Z_{t+1}[:3]=A^{*}\\mathrm{vec}(Z_{t-4}^{t}[:,:3])+b^{*}$ , where in this experiment, $\\operatorname{vec}({\\cdot})$ is a vectorized operation, $A^{*}\\in\\mathbb{R}^{3\\times15}$ , and $b^{*}\\in\\mathbb{R}^{3}$ . The fourth feature is a linear combination of the first three dimension features, as a redundant feature. The fifth feature is purely noise following the normal distribution. ", "page_idx": 17}, {"type": "text", "text": "B.5 Time-series forecastings ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "M4 [35] contains 10000 highly nonstationary univariate time series with different frequencies from hourly to yearly and different categories from financials to demographics. The forecasting horizon varies across different frequencies. ", "page_idx": 17}, {"type": "text", "text": "Crypto [4] This multivariate dataset contains 8 features on historical trades, such as open and close prices, for 14 cryptocurrencies. The original challenge is to predict 3-step ahead 15-minute relative future returns. Since we focus on long-term forecasting, we train all models to make 15-step predictions of 15-minute relative future returns. We use the original training set from the competition and do an $80\\%{-10\\%-10\\%}$ training-validation-test split. ", "page_idx": 17}, {"type": "text", "text": "Player Trajectory [32] contains basketball player movement trajectories from NBA games in 2016. We randomly sample 300 player trajectories for training and validation and 50 trajectories for testing. All models are trained to yield 30-step ahead predictions ", "page_idx": 17}, {"type": "text", "text": "B.6 Evolving domain generalization ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "Rotated Gaussian [58] consists of 30 domains generated by the same Gaussian distribution, but the decision boundary rotates from $0^{\\circ}$ to $338^{\\circ}$ with an interval of $12^{\\circ}$ . We split the domains into source domains (1-22 domains), intermediate domains (22-25 domains), and target domains (26-30 domains). The intermediate domains are utilized as the validation set. ", "page_idx": 17}, {"type": "text", "text": "Circle [40] contains evolving 30 domains where the instance are sampled from 30 2D Gaussian distributions. The label is assigned using a half-circle curve as the decision boundary. (15 source domains, 5 validation domains, and 10 target domains) ", "page_idx": 17}, {"type": "text", "text": "Sine In Sine [40] each data owns two attributes $(x_{1},x_{2})$ . The label is assigned using a sine curve as the decision boundary. We rearrange this dataset by extending it to 24 evolving domains. Each domain covers214 the period of the sinusoid. (12 source domains, 4 validation domains, and 8 target domains) ", "page_idx": 17}, {"type": "text", "text": "Rotated MNIST (RMNIST) [22] is an adaptation of the popular MNIST digit dataset [15], composed of MNIST digits of various rotations. The task is to classify a digit from 0 to 9 given an image of the digit. We follow [43] and extend it to 19 evolving domains via applying the rotations with degree of $\\{0^{\\circ},15^{\\circ},30^{\\circ},\\ldots,180^{\\circ}\\}$ in order. (10 source domains, 3 validation domains, and 6 target domains). ", "page_idx": 17}, {"type": "text", "text": "Portraits [23] is a real-world dataset that comprises photographs of American high school seniors collected over a period of 108 years (1905-2013) across 26 states. The objective is to accurately classify the gender for each photograph. The dataset is divided into 34 domains based on a fixed interval over time. (19 source domains, 5 validation domains, and 10 target domains) ", "page_idx": 17}, {"type": "text", "text": "", "page_idx": 18}, {"type": "text", "text": "Caltran [26] consists of real-world images captured by a fixed traffic camera deployed in an intersection over time. Frames were updated at 3-minute intervals each with a resolution $320\\times320$ . We divide it into 34 domains by time. The task of Caltran is to classify scenes to identify the presence of one or more vehicles in or approaching the intersection. The challenge mainly raise from the continually evolving domain shift as changes include time, illumination, weather, etc. (19 source domains, 5 validation domains, and 10 target domains) ", "page_idx": 18}, {"type": "text", "text": "PowerSupply [14] is a dataset designed for the task of time-section prediction of current power supply based on hourly records obtained from an Italian electricity company. The dataset consists of 30 domains formed according to days. Each data point is assigned a binary class label indicating whether the current power supply belongs to the morning or the afternoon. Domain shifts may arise due to variations in season, weather, price, or the differences between working days and weekends. (15 source domains, 5 validation domains, and 10 target domains) ", "page_idx": 18}, {"type": "text", "text": "C Full experiments on EDG tasks ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "In this section, we present complete experimental results to validate the efficacy of our proposed evolving domain generalization task. ", "page_idx": 18}, {"type": "table", "img_path": "I2gVmVRgNk/tmp/7db8ff264cabe4b8e29e2c272e6eb3eb97190a1825ce16fd5ebb1b24e4953da9.jpg", "table_caption": ["Table 5: RMNIST. We show the results on each target domain by domain index. "], "table_footnote": [], "page_idx": 18}, {"type": "table", "img_path": "I2gVmVRgNk/tmp/08f5aad395363b07718af1cd2914d5a8113b6c46b28f9fd431302c134d41cd81.jpg", "table_caption": ["Table 6: Rotated Gaussian. We show the results on each target domain by domain index. "], "table_footnote": [], "page_idx": 18}, {"type": "table", "img_path": "I2gVmVRgNk/tmp/2e636f3f52f007bce931693c373c4a10ef34619eefbbdaaa27e1520d7d4f3816.jpg", "table_caption": ["Table 7: PowerSupply. We show the results on each target domain by domain index. "], "table_footnote": [], "page_idx": 18}, {"type": "text", "text": "D Computational Cost ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "All experiments are carried out on 498G memory, $2\\textbf{x}$ AMD Milan $7413\\ @\\ 2.65\\ \\mathrm{GHz}\\ 128\\mathrm{M}$ cache L3, and $2\\textbf{x}$ NVidia A100SXM4 (40 GB memory). The algorithm\u2019s computational cost is the cost of OT (using package [19]) $\\mathcal{O}(B^{3})$ and the cost of estimation of MI ${\\mathcal{O}}(B^{2}d)$ , where $B$ is the batch size in an iteration, and $d$ is the representation dimension. In all, the total computational cost is $O(B^{2}d+B^{3})$ (not counting the encoder $g$ and decoder $h$ ). ", "page_idx": 19}, {"type": "text", "text": "E Algorithms Training Procedures ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "Algorithm 1 EVORATE: Data is sampled in a sequential manner with correspondence   \n1: for each training iteration do   \n2: Sample $\\left\\{\\left\\{z_{t,i}\\right\\}_{t=1}^{T}\\right\\}_{i=1}^{B}$ from $p(\\mathbf{z}_{t=1}^{T})$ , where $B$ is the batch size per training iteration   \n3: Compute EvoRate of $i$ -th sample at timestamp $t$ according to Eq (4), $k<t$ : $\\begin{array}{r l}{\\mathrm{EvoRate}_{t,i}:=-\\left\\|f\\big(g\\big(z_{t-k+1,i}\\big),\\dots,g\\big(z_{t,i}\\big)\\big)-g\\big(z_{t+1,i}\\big)\\right\\|_{2}^{2}}&{}\\\\ &{\\qquad\\qquad-\\log\\displaystyle\\frac{1}{B}\\sum_{j=1}^{B}e^{-\\lvert|f(g\\big(z_{t-k+1,i}\\big),\\dots,g(z_{t,i}))-g(z_{t+1,j})\\rvert|_{2}^{2}}}\\end{array}$   \n4: Update $f$ and $g$ by maximize $\\begin{array}{r}{\\frac{1}{B(T-k)}\\sum_{t=k}^{T-1}\\sum_{i=1}^{B}\\mathrm{EvoRate}_{t,i}}\\end{array}$   \n5: end for ", "page_idx": 19}, {"type": "text", "text": "Algorithm 2 EVORATEW: Data is sampled from different timestamps but without correspondence ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "1: for each training iteration do   \n2: Sample $\\left\\{\\left\\{z_{t,i}\\right\\}_{i=1}^{B}\\right\\}_{t=1}^{T}$ from $p(\\mathbf{z}_{t=1}^{T})$ , where $B$ is the batch size per training iteration   \n3: Compute the optimal transport plan $\\pi^{*}$ , where $\\mathcal{L}_{\\mathcal{W}}^{t}(\\pi,f)$ defined in Eq (7) $\\pi^{*}(Z_{t},Z_{t+1})=\\begin{array}{c}{\\arg\\operatorname*{min}}\\\\ {\\pi\\in\\Pi(P(Z_{t}),P(Z_{t+1}))}\\end{array}\\mathcal{L}_{\\mathcal{W}}^{t}(\\pi,f),\\quad\\forall t\\in\\{1,\\ldots,T-1\\},$   \n4: Compute EvoRate $\\mathcal{W}$ of $i$ -th sample at timestamp $t$ according to Eq (9), especially $(z_{t,i},z_{t+1,i})$ is sampled from $\\pi^{*}$ : $(\\mathrm{EvoRate}_{W})_{t,i}:=-||f(g(z_{t,i}))-g(z_{t+1,i})||_{2}^{2}-\\log\\frac{1}{B}\\sum_{j=1}^{B}e^{-||f(g(z_{t,i}))-g(z_{t+1,j})||_{2}^{2}}$   \n5: Update $f$ by maximize $\\begin{array}{r}{\\frac{1}{B(T-1)}\\sum_{t=1}^{T-1}\\sum_{i=1}^{B}(\\mathrm{EvoRate}_{\\mathcal{W}})_{t,i}}\\end{array}$   \n6: end for ", "page_idx": 19}, {"type": "text", "text": "F Comparisons with Traditional time-series statistic indicators ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "There are traditional statistic indicators for time series, but they have significant limitations: a) System sensitivity, measured by Lyapunov Exponents (LEs) [2] measures how sensitive a dynamic system is to initial conditions, b) Trend is the slope of a linear regression fitted to sequential data, and c) Seasonality, measured by the ACF test [3], assesses linear correlations between observations at different time lags. These methods are not designed to measure evolving patterns and struggle to handle high-dimensional data. Each method measures only one aspect of evolving patterns: system sensitivity, trend, or seasonality. Together, they determine the overall evolving patterns. We present a comparison of these metrics with our method below: ", "page_idx": 19}, {"type": "text", "text": "In the above table, a larger EvoRate consistently indicates a smaller potential prediction error (RMSE/sMAPE) for the dataset. In contrast, LEs, trend, and seasonality show little impact on the prediction errors. Another significant drawback of these methods is their inability to be directly applied to high-dimensional data, such as images, videos, and NLP datasets. ", "page_idx": 19}, {"type": "table", "img_path": "I2gVmVRgNk/tmp/81ceddae5204673470ca41787ce9f208c04959b2e8aee2506a9f992ad58a529b.jpg", "table_caption": ["Table 8: Comparison of Different Metrics Across Various Datasets "], "table_footnote": [], "page_idx": 20}, {"type": "text", "text": "G Limitations ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Due to computational resource limitations, we have not included experiments involving Natural Language Processing (NLP) tasks on Large Language Models (LLMs) in our study. These models typically require extensive processing power and substantial memory, which exceed our current hardware capabilities. Additionally, the high costs associated with running these models make them impractical for our budget. Instead, we focused on alternative datasets and models that align with our available resources. We believe that our chosen datasets still provide valuable insights while remaining within our operational constraints. Future work could explore LLMs as our computational capacity expands. ", "page_idx": 20}, {"type": "text", "text": "NeurIPS Paper Checklist ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "1. Claims ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "Question: Do the main claims made in the abstract and introduction accurately reflect the paper\u2019s contributions and scope? ", "page_idx": 21}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 21}, {"type": "text", "text": "Justification: Claims are in the abstract and introduction sections. ", "page_idx": 21}, {"type": "text", "text": "Guidelines: ", "page_idx": 21}, {"type": "text", "text": "\u2022 The answer NA means that the abstract and introduction do not include the claims made in the paper.   \n\u2022 The abstract and/or introduction should clearly state the claims made, including the contributions made in the paper and important assumptions and limitations. A No or NA answer to this question will not be perceived well by the reviewers.   \n\u2022 The claims made should match theoretical and experimental results, and reflect how much the results can be expected to generalize to other settings.   \n\u2022 It is fine to include aspirational goals as motivation as long as it is clear that these goals are not attained by the paper. ", "page_idx": 21}, {"type": "text", "text": "2. Limitations ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "Question: Does the paper discuss the limitations of the work performed by the authors? ", "page_idx": 21}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "Justification: see section G. ", "page_idx": 21}, {"type": "text", "text": "Guidelines: ", "page_idx": 21}, {"type": "text", "text": "\u2022 The answer NA means that the paper has no limitation while the answer No means that the paper has limitations, but those are not discussed in the paper.   \n\u2022 The authors are encouraged to create a separate \"Limitations\" section in their paper.   \n\u2022 The paper should point out any strong assumptions and how robust the results are to violations of these assumptions (e.g., independence assumptions, noiseless settings, model well-specification, asymptotic approximations only holding locally). The authors should reflect on how these assumptions might be violated in practice and what the implications would be.   \n\u2022 The authors should reflect on the scope of the claims made, e.g., if the approach was only tested on a few datasets or with a few runs. In general, empirical results often depend on implicit assumptions, which should be articulated.   \n\u2022 The authors should reflect on the factors that influence the performance of the approach. For example, a facial recognition algorithm may perform poorly when image resolution is low or images are taken in low lighting. Or a speech-to-text system might not be used reliably to provide closed captions for online lectures because it fails to handle technical jargon.   \n\u2022 The authors should discuss the computational efficiency of the proposed algorithms and how they scale with dataset size.   \n\u2022 If applicable, the authors should discuss possible limitations of their approach to address problems of privacy and fairness.   \n\u2022 While the authors might fear that complete honesty about limitations might be used by reviewers as grounds for rejection, a worse outcome might be that reviewers discover limitations that aren\u2019t acknowledged in the paper. The authors should use their best judgment and recognize that individual actions in favor of transparency play an important role in developing norms that preserve the integrity of the community. Reviewers will be specifically instructed to not penalize honesty concerning limitations. ", "page_idx": 21}, {"type": "text", "text": "3. Theory Assumptions and Proofs ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "Question: For each theoretical result, does the paper provide the full set of assumptions and a complete (and correct) proof? ", "page_idx": 21}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 21}, {"type": "text", "text": "Justification: see section A. ", "page_idx": 22}, {"type": "text", "text": "Guidelines: ", "page_idx": 22}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include theoretical results.   \n\u2022 All the theorems, formulas, and proofs in the paper should be numbered and crossreferenced.   \n\u2022 All assumptions should be clearly stated or referenced in the statement of any theorems.   \n\u2022 The proofs can either appear in the main paper or the supplemental material, but if they appear in the supplemental material, the authors are encouraged to provide a short proof sketch to provide intuition.   \n\u2022 Inversely, any informal proof provided in the core of the paper should be complemented by formal proofs provided in appendix or supplemental material.   \n\u2022 Theorems and Lemmas that the proof relies upon should be properly referenced. ", "page_idx": 22}, {"type": "text", "text": "4. Experimental Result Reproducibility ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Question: Does the paper fully disclose all the information needed to reproduce the main experimental results of the paper to the extent that it affects the main claims and/or conclusions of the paper (regardless of whether the code and data are provided or not)? ", "page_idx": 22}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 22}, {"type": "text", "text": "Justification: See the experiment section and dataset section. ", "page_idx": 22}, {"type": "text", "text": "Guidelines: ", "page_idx": 22}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 If the paper includes experiments, a No answer to this question will not be perceived well by the reviewers: Making the paper reproducible is important, regardless of whether the code and data are provided or not.   \n\u2022 If the contribution is a dataset and/or model, the authors should describe the steps taken to make their results reproducible or verifiable.   \n\u2022 Depending on the contribution, reproducibility can be accomplished in various ways. For example, if the contribution is a novel architecture, describing the architecture fully might suffice, or if the contribution is a specific model and empirical evaluation, it may be necessary to either make it possible for others to replicate the model with the same dataset, or provide access to the model. In general. releasing code and data is often one good way to accomplish this, but reproducibility can also be provided via detailed instructions for how to replicate the results, access to a hosted model (e.g., in the case of a large language model), releasing of a model checkpoint, or other means that are appropriate to the research performed.   \n\u2022 While NeurIPS does not require releasing code, the conference does require all submissions to provide some reasonable avenue for reproducibility, which may depend on the nature of the contribution. For example (a) If the contribution is primarily a new algorithm, the paper should make it clear how to reproduce that algorithm. (b) If the contribution is primarily a new model architecture, the paper should describe the architecture clearly and fully. (c) If the contribution is a new model (e.g., a large language model), then there should either be a way to access this model for reproducing the results or a way to reproduce the model (e.g., with an open-source dataset or instructions for how to construct the dataset). (d) We recognize that reproducibility may be tricky in some cases, in which case authors are welcome to describe the particular way they provide for reproducibility. In the case of closed-source models, it may be that access to the model is limited in some way (e.g., to registered users), but it should be possible for other researchers to have some path to reproducing or verifying the results. ", "page_idx": 22}, {"type": "text", "text": "5. Open access to data and code ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Question: Does the paper provide open access to the data and code, with sufficient instructions to faithfully reproduce the main experimental results, as described in supplemental material? ", "page_idx": 22}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 23}, {"type": "text", "text": "Justification: See dataset section and supplementary files of codes. Guidelines: ", "page_idx": 23}, {"type": "text", "text": "\u2022 The answer NA means that paper does not include experiments requiring code.   \n\u2022 Please see the NeurIPS code and data submission guidelines (https://nips.cc/ public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 While we encourage the release of code and data, we understand that this might not be possible, so \u201cNo\u201d is an acceptable answer. Papers cannot be rejected simply for not including code, unless this is central to the contribution (e.g., for a new open-source benchmark).   \n\u2022 The instructions should contain the exact command and environment needed to run to reproduce the results. See the NeurIPS code and data submission guidelines (https: //nips.cc/public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 The authors should provide instructions on data access and preparation, including how to access the raw data, preprocessed data, intermediate data, and generated data, etc.   \n\u2022 The authors should provide scripts to reproduce all experimental results for the new proposed method and baselines. If only a subset of experiments are reproducible, they should state which ones are omitted from the script and why.   \n\u2022 At submission time, to preserve anonymity, the authors should release anonymized versions (if applicable).   \n\u2022 Providing as much information as possible in supplemental material (appended to the paper) is recommended, but including URLs to data and code is permitted. ", "page_idx": 23}, {"type": "text", "text": "6. Experimental Setting/Details ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: Does the paper specify all the training and test details (e.g., data splits, hyperparameters, how they were chosen, type of optimizer, etc.) necessary to understand the results? ", "page_idx": 23}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 23}, {"type": "text", "text": "Justification: See the experiment section and dataset section. Guidelines: ", "page_idx": 23}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments. \u2022 The experimental setting should be presented in the core of the paper to a level of detail that is necessary to appreciate the results and make sense of them. \u2022 The full details can be provided either with the code, in appendix, or as supplemental material. ", "page_idx": 23}, {"type": "text", "text": "7. Experiment Statistical Significance ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: Does the paper report error bars suitably and correctly defined or other appropriate information about the statistical significance of the experiments? ", "page_idx": 23}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Justification: see the experiment section. ", "page_idx": 23}, {"type": "text", "text": "Guidelines: ", "page_idx": 23}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The authors should answer \"Yes\" if the results are accompanied by error bars, confidence intervals, or statistical significance tests, at least for the experiments that support the main claims of the paper.   \n\u2022 The factors of variability that the error bars are capturing should be clearly stated (for example, train/test split, initialization, random drawing of some parameter, or overall run with given experimental conditions).   \n\u2022 The method for calculating the error bars should be explained (closed form formula, call to a library function, bootstrap, etc.)   \n\u2022 The assumptions made should be given (e.g., Normally distributed errors).   \n\u2022 It should be clear whether the error bar is the standard deviation or the standard error of the mean.   \n\u2022 It is OK to report 1-sigma error bars, but one should state it. The authors should preferably report a 2-sigma error bar than state that they have a $96\\%$ CI, if the hypothesis of Normality of errors is not verified.   \n\u2022 For asymmetric distributions, the authors should be careful not to show in tables or figures symmetric error bars that would yield results that are out of range (e.g. negative error rates).   \n\u2022 If error bars are reported in tables or plots, The authors should explain in the text how they were calculated and reference the corresponding figures or tables in the text. ", "page_idx": 23}, {"type": "text", "text": "", "page_idx": 24}, {"type": "text", "text": "8. Experiments Compute Resources ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Question: For each experiment, does the paper provide sufficient information on the computer resources (type of compute workers, memory, time of execution) needed to reproduce the experiments? ", "page_idx": 24}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 24}, {"type": "text", "text": "Justification: See computational cost section. ", "page_idx": 24}, {"type": "text", "text": "Guidelines: ", "page_idx": 24}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The paper should indicate the type of compute workers CPU or GPU, internal cluster, or cloud provider, including relevant memory and storage.   \n\u2022 The paper should provide the amount of compute required for each of the individual experimental runs as well as estimate the total compute.   \n\u2022 The paper should disclose whether the full research project required more compute than the experiments reported in the paper (e.g., preliminary or failed experiments that didn\u2019t make it into the paper). ", "page_idx": 24}, {"type": "text", "text": "9. Code Of Ethics ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Question: Does the research conducted in the paper conform, in every respect, with the NeurIPS Code of Ethics https://neurips.cc/public/EthicsGuidelines? ", "page_idx": 24}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Justification: We preserve the anonymity. ", "page_idx": 24}, {"type": "text", "text": "Guidelines: ", "page_idx": 24}, {"type": "text", "text": "\u2022 The answer NA means that the authors have not reviewed the NeurIPS Code of Ethics.   \n\u2022 If the authors answer No, they should explain the special circumstances that require a deviation from the Code of Ethics.   \n\u2022 The authors should make sure to preserve anonymity (e.g., if there is a special consideration due to laws or regulations in their jurisdiction). ", "page_idx": 24}, {"type": "text", "text": "10. Broader Impacts ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Question: Does the paper discuss both potential positive societal impacts and negative societal impacts of the work performed? ", "page_idx": 24}, {"type": "text", "text": "Answer: [No] ", "page_idx": 24}, {"type": "text", "text": "Justification: This work is not an application, but foundational research on machine learning.   \nHence, there is no negative social impact. ", "page_idx": 24}, {"type": "text", "text": "Guidelines: ", "page_idx": 24}, {"type": "text", "text": "\u2022 The answer NA means that there is no societal impact of the work performed.   \n\u2022 If the authors answer NA or No, they should explain why their work has no societal impact or why the paper does not address societal impact.   \n\u2022 Examples of negative societal impacts include potential malicious or unintended uses (e.g., disinformation, generating fake profiles, surveillance), fairness considerations (e.g., deployment of technologies that could make decisions that unfairly impact specific groups), privacy considerations, and security considerations.   \n\u2022 The conference expects that many papers will be foundational research and not tied to particular applications, let alone deployments. However, if there is a direct path to any negative applications, the authors should point it out. For example, it is legitimate to point out that an improvement in the quality of generative models could be used to generate deepfakes for disinformation. On the other hand, it is not needed to point out that a generic algorithm for optimizing neural networks could enable people to train models that generate Deepfakes faster.   \n\u2022 The authors should consider possible harms that could arise when the technology is being used as intended and functioning correctly, harms that could arise when the technology is being used as intended but gives incorrect results, and harms following from (intentional or unintentional) misuse of the technology.   \n\u2022 If there are negative societal impacts, the authors could also discuss possible mitigation strategies (e.g., gated release of models, providing defenses in addition to attacks, mechanisms for monitoring misuse, mechanisms to monitor how a system learns from feedback over time, improving the efficiency and accessibility of ML). ", "page_idx": 24}, {"type": "text", "text": "", "page_idx": 25}, {"type": "text", "text": "11. Safeguards ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "Question: Does the paper describe safeguards that have been put in place for responsible release of data or models that have a high risk for misuse (e.g., pretrained language models, image generators, or scraped datasets)? ", "page_idx": 25}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 25}, {"type": "text", "text": "Justification: This paper poses no such risks. ", "page_idx": 25}, {"type": "text", "text": "Guidelines: ", "page_idx": 25}, {"type": "text", "text": "\u2022 The answer NA means that the paper poses no such risks.   \n\u2022 Released models that have a high risk for misuse or dual-use should be released with necessary safeguards to allow for controlled use of the model, for example by requiring that users adhere to usage guidelines or restrictions to access the model or implementing safety filters.   \n\u2022 Datasets that have been scraped from the Internet could pose safety risks. The authors should describe how they avoided releasing unsafe images.   \n\u2022 We recognize that providing effective safeguards is challenging, and many papers do not require this, but we encourage authors to take this into account and make a best faith effort. ", "page_idx": 25}, {"type": "text", "text": "12. Licenses for existing assets ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "Question: Are the creators or original owners of assets (e.g., code, data, models), used in the paper, properly credited and are the license and terms of use explicitly mentioned and properly respected? ", "page_idx": 25}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 25}, {"type": "text", "text": "Justification: All related works are mentioned in related works. ", "page_idx": 25}, {"type": "text", "text": "Guidelines: ", "page_idx": 25}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not use existing assets.   \n\u2022 The authors should cite the original paper that produced the code package or dataset.   \n\u2022 The authors should state which version of the asset is used and, if possible, include a URL.   \n\u2022 The name of the license (e.g., CC-BY 4.0) should be included for each asset.   \n\u2022 For scraped data from a particular source (e.g., website), the copyright and terms of service of that source should be provided.   \n\u2022 If assets are released, the license, copyright information, and terms of use in the package should be provided. For popular datasets, paperswithcode.com/datasets has curated licenses for some datasets. Their licensing guide can help determine the license of a dataset.   \n\u2022 For existing datasets that are re-packaged, both the original license and the license of the derived asset (if it has changed) should be provided. ", "page_idx": 25}, {"type": "text", "text": "\u2022 If this information is not available online, the authors are encouraged to reach out to the asset\u2019s creators. ", "page_idx": 26}, {"type": "text", "text": "13. New Assets ", "text_level": 1, "page_idx": 26}, {"type": "text", "text": "Question: Are new assets introduced in the paper well documented and is the documentation provided alongside the assets? ", "page_idx": 26}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 26}, {"type": "text", "text": "Justification: The new assets are documented in the experiment and dataset sections. Guidelines: ", "page_idx": 26}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not release new assets.   \n\u2022 Researchers should communicate the details of the dataset/code/model as part of their submissions via structured templates. This includes details about training, license, limitations, etc.   \n\u2022 The paper should discuss whether and how consent was obtained from people whose asset is used.   \n\u2022 At submission time, remember to anonymize your assets (if applicable). You can either create an anonymized URL or include an anonymized zip file. ", "page_idx": 26}, {"type": "text", "text": "14. Crowdsourcing and Research with Human Subjects ", "text_level": 1, "page_idx": 26}, {"type": "text", "text": "Question: For crowdsourcing experiments and research with human subjects, does the paper include the full text of instructions given to participants and screenshots, if applicable, as well as details about compensation (if any)? ", "page_idx": 26}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 26}, {"type": "text", "text": "Justification: This paper does not involve crowdsourcing nor research with human subjects. Guidelines: ", "page_idx": 26}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Including this information in the supplemental material is fine, but if the main contribution of the paper involves human subjects, then as much detail as possible should be included in the main paper.   \n\u2022 According to the NeurIPS Code of Ethics, workers involved in data collection, curation, or other labor should be paid at least the minimum wage in the country of the data collector. ", "page_idx": 26}, {"type": "text", "text": "15. Institutional Review Board (IRB) Approvals or Equivalent for Research with Human Subjects ", "text_level": 1, "page_idx": 26}, {"type": "text", "text": "Question: Does the paper describe potential risks incurred by study participants, whether such risks were disclosed to the subjects, and whether Institutional Review Board (IRB) approvals (or an equivalent approval/review based on the requirements of your country or institution) were obtained? ", "page_idx": 26}, {"type": "text", "text": "Answer: [NA] ", "text_level": 1, "page_idx": 26}, {"type": "text", "text": "Justification: This paper does not involve crowdsourcing nor research with human subjects. Guidelines: ", "page_idx": 26}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Depending on the country in which research is conducted, IRB approval (or equivalent) may be required for any human subjects research. If you obtained IRB approval, you should clearly state this in the paper.   \n\u2022 We recognize that the procedures for this may vary significantly between institutions and locations, and we expect authors to adhere to the NeurIPS Code of Ethics and the guidelines for their institution.   \n\u2022 For initial submissions, do not include any information that would break anonymity (if applicable), such as the institution conducting the review. ", "page_idx": 26}]