[{"figure_path": "5ClpGA0u9K/figures/figures_1_1.jpg", "caption": "Figure 1: Energy rank alignment (ERA) enables targeting low-energy, high-reward regions with controllable fluctuations. Optimal policy approaches Boltzmann distribution with low regularization (\u03b3\u2192 0) and reference policy with high regularization (\u03b3 \u2192 \u221e) (left). Aligned models can be used to sample molecules with desired chemical properties (right).", "description": "This figure illustrates the concept of energy rank alignment (ERA). The left panel shows how the optimal policy distribution approaches a Boltzmann distribution as regularization decreases, and how it approaches the reference policy as regularization increases.  The right panel demonstrates the practical application, showing how an aligned model can generate molecules with specific desired chemical properties.", "section": "1.1 Related Work"}, {"figure_path": "5ClpGA0u9K/figures/figures_5_1.jpg", "caption": "Figure 2: Unprompted molecular generator alignment. Distributions of different chemical properties for molecules sampled from aligned and unaligned policies. The center of the harmonic potential, \u03bc, is varied for MR (\u03b2 = 1.0), Ring Count (\u03b2 = 1.0), and LogP (\u03b2 = 10.0), while \u03b2 is varied for QED. All experiments were run with no regularization to the reference policy (\u03b3 = 0).", "description": "This figure displays the distributions of four different chemical properties (Molar Refractivity, Ring Count, Quantitative Estimate of Drug-Likeness, and Wildman-Crippen LogP) for molecules generated by both unaligned and aligned molecular generator models.  The alignment process targets specific values or ranges of these properties by adjusting parameters (\u03bc and \u03b2) in the energy rank alignment (ERA) algorithm. The graphs illustrate how the ERA algorithm successfully shifts the distributions of molecular properties towards the desired targets, while also showing the effect of varying the parameters on the diversity of the generated molecules.  The absence of regularization (\u03b3 = 0) indicates that the aligned models' distributions are not overly constrained to resemble the initial (unaligned) model's distribution.", "section": "4.1 Generating molecules with desired properties"}, {"figure_path": "5ClpGA0u9K/figures/figures_6_1.jpg", "caption": "Figure 3: Unprompted multi-property molecular generator alignment. 2D histograms of LogP versus QED for different combinations of property-specific \u03b2 illustrating a clear trade-off when performing multi-property alignment. Relative increases in \u03b2 for a given property target higher values for that property. All experiments were run with no regularization to the reference policy (\u03b3 = 0).", "description": "This figure displays 2D histograms showing the relationship between the Wildman-Crippen LogP and the Quantitative Estimate of Drug-Likeness (QED) for molecules generated by a molecular generator model.  Different plots represent the results obtained using various combinations of \u03b2 values (beta values) for LogP and QED, influencing the balance between these properties in the generated molecules.  The results illustrate a trade-off: increasing \u03b2 for one property prioritizes higher values of that property but often at the expense of the other.  The overall distribution of points shifts and changes its shape in accordance with the changed \u03b2-values, illustrating the model's ability to favor different chemical properties based on parameter tuning. Importantly, the experiment uses no regularization.", "section": "4.1 Generating molecules with desired properties"}, {"figure_path": "5ClpGA0u9K/figures/figures_7_1.jpg", "caption": "Figure 4: Prompted multi-property molecular generator alignment. From left to right: Tanimoto similarities computed between the prompt and sampled molecules for both aligned and unaligned policies (QED and Tanimoto alignment), per-prompt difference in the average QED under aligned and unaligned policies (QED and Tanimoto alignment), Tanimoto similarities computed between the prompt and sampled molecules for both aligned and unaligned policies (LogP and Tanimoto alignment), and per-prompt difference in the average LogP under aligned and unaligned policies (LogP and Tanimoto alignment). With alignment, we target higher QED and LogP values, while still sampling molecules chemically similar\u2014but not identical to prompt molecule.", "description": "This figure visualizes the results of prompted molecular generator alignment experiments targeting multiple properties.  It shows how the distribution of Tanimoto similarity (a measure of chemical similarity to the prompt molecule) and the average QED and LogP values change after applying the Energy Rank Alignment (ERA) algorithm. The plots demonstrate that ERA successfully generates molecules that are both similar to the prompt molecule (high Tanimoto similarity) and possess the desired properties (high QED and LogP).", "section": "4.1.2 Prompted molecular alignment"}, {"figure_path": "5ClpGA0u9K/figures/figures_7_2.jpg", "caption": "Figure 2: Unprompted molecular generator alignment. Distributions of different chemical properties for molecules sampled from aligned and unaligned policies. The center of the harmonic potential, \u03bc, is varied for MR (\u03b2 = 1.0), Ring Count (\u03b2 = 1.0), and LogP (\u03b2 = 10.0), while \u03b2 is varied for QED. All experiments were run with no regularization to the reference policy (\u03b3 = 0).", "description": "This figure shows the results of applying the Energy Rank Alignment (ERA) algorithm to an unprompted molecular generator.  The goal was to align the generator's output to favor specific chemical properties.  Different subplots show the distributions of four properties (Molar Refractivity, Ring Count, Wildman-Crippen LogP, and Quantitative Estimate of Drug-likeness) for molecules generated by both the unaligned (original) model and models aligned using ERA. The parameter \u03bc (center of harmonic potential) and \u03b2 (inverse temperature) were adjusted during alignment.  The plots illustrate how ERA successfully shifts the distribution of chemical properties towards the desired values.  No regularization (\u03b3=0) was used in these experiments.", "section": "4.1 Generating molecules with desired properties"}, {"figure_path": "5ClpGA0u9K/figures/figures_23_1.jpg", "caption": "Figure 6: Chemical diversity of samples from training dataset and from unprompted molecular generator (unaligned) as measured by pairwise Tanimoto similarities. Lower Tanimoto similarities correspond to more chemically dissimilar molecules.", "description": "This figure compares the chemical diversity of molecules from the ChEMBL dataset used for training and the molecules generated by an unaligned (i.e., not optimized) molecular generator.  The diversity is measured using pairwise Tanimoto similarity scores, where a higher score indicates greater similarity between two molecules. The distribution of Tanimoto similarities from the molecular generator is compared against the distribution from the ChEMBL dataset to highlight the difference in molecular diversity before applying the Energy Rank Alignment method.  The unaligned model shows a lower diversity in the chemical space compared to the training dataset.", "section": "4.1 Generating molecules with desired properties"}, {"figure_path": "5ClpGA0u9K/figures/figures_24_1.jpg", "caption": "Figure 2: Unprompted molecular generator alignment. Distributions of different chemical properties for molecules sampled from aligned and unaligned policies. The center of the harmonic potential, \u03bc, is varied for MR (\u03b2 = 1.0), Ring Count (\u03b2 = 1.0), and LogP (\u03b2 = 10.0), while \u03b2 is varied for QED. All experiments were run with no regularization to the reference policy (\u03b3 = 0).", "description": "This figure displays the distributions of four different chemical properties (Molar Refractivity, Ring Count, Wildman-Crippen LogP, and Quantitative Estimate of Drug-Likeness) for molecules generated by both unaligned and aligned molecular generator models.  The alignment process uses the ERA algorithm with different hyperparameters (\u03b2 and \u03bc) to target specific values for each property.  The absence of regularization (\u03b3 = 0) means the model's generation is less restricted by the initial model.  The figure shows how ERA successfully shifts the distribution of generated molecules towards the desired properties, demonstrating its effectiveness in aligning the models.", "section": "4.1 Generating molecules with desired properties"}, {"figure_path": "5ClpGA0u9K/figures/figures_25_1.jpg", "caption": "Figure 3: Unprompted multi-property molecular generator alignment. 2D histograms of LogP versus QED for different combinations of property-specific \u03b2 illustrating a clear trade-off when performing multi-property alignment. Relative increases in \u03b2 for a given property target higher values for that property. All experiments were run with no regularization to the reference policy (\u03b3 = 0).", "description": "This figure displays 2D histograms showing the distribution of LogP versus QED for molecules generated by a molecular generator model.  Different panels represent different combinations of hyperparameters (\u03b2 values for LogP and QED). The histograms illustrate how adjusting these hyperparameters allows for control over the balance between the two properties.  Higher \u03b2 values for a given property shift the distribution towards higher values for that property, demonstrating a trade-off between LogP and QED.", "section": "4.1.1 Unprompted molecular alignment"}, {"figure_path": "5ClpGA0u9K/figures/figures_25_2.jpg", "caption": "Figure 9: Sample molecules from prompted molecular generator after multi-property alignment experiments: QED and Tanimoto (left) and LogP and Tanimoto (right). With alignment, generated molecules are diverse, while still chemically similar to prompt molecule.", "description": "This figure shows the results of prompted molecular generation after multi-property alignment using the ERA algorithm.  The left side displays results for QED and Tanimoto similarity, while the right side shows results for LogP and Tanimoto similarity.  In both cases, multiple molecules are generated for each prompt molecule. The aligned model generates molecules that are diverse, meaning chemically different from each other, but also similar to the prompt molecule.  This demonstrates the ability of ERA to balance both diversity and similarity in molecular generation, a key goal in drug discovery and materials science.", "section": "4.1.2 Prompted molecular alignment"}, {"figure_path": "5ClpGA0u9K/figures/figures_27_1.jpg", "caption": "Figure 1: Energy rank alignment (ERA) enables targeting low-energy, high-reward regions with controllable fluctuations. Optimal policy approaches Boltzmann distribution with low regularization (\u03b3\u2192 0) and reference policy with high regularization (y \u2192 \u221e) (left). Aligned models can be used to sample molecules with desired chemical properties (right).", "description": "The figure illustrates the concept of energy rank alignment (ERA). The left panel shows how the optimal policy of ERA converges to a Boltzmann distribution with tunable entropy, controlled by hyperparameters \u03b2 and \u03b3, while the right panel shows how aligned models are used to sample molecules with desirable chemical properties.", "section": "1.1 Related Work"}, {"figure_path": "5ClpGA0u9K/figures/figures_29_1.jpg", "caption": "Figure 10: Distribution of energies evaluated by sentiment model for aligned GPT-2 models across varying \u03b2 and \u03b3.", "description": "This figure shows the distribution of energies (sentiments) evaluated by a sentiment model for aligned and unaligned GPT-2 models.  The distributions are shown for different values of \u03b2 (inverse temperature) and \u03b3 (regularization strength), demonstrating the effect of these hyperparameters on the model's output distribution.  Each subfigure represents a different value of \u03b3, while the different colored bars within each subfigure represent the distributions for different values of \u03b2, including the unaligned model.", "section": "4.2 AI-guided alignment of large language models"}]