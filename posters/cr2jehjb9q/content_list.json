[{"type": "text", "text": "Scaling Law for Time Series Forecasting ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Jingzhe $\\mathbf{Shi^{1*}}$ , Qinwei $\\bf{M a}^{1}$ \u2217, Huan $\\mathbf{M}\\mathbf{a}^{2}$ , Lei Li3,4 ", "page_idx": 0}, {"type": "text", "text": "1 Institute for Interdisciplinary Information Sciences, Tsinghua University 2 Zhili College, Tsinghua University 3 University of Copenhagen 4 University of Washington 1,2 {shi-jz21,mqw21,mah21}@mails.tsinghua.edu.cn, 3,4 lilei@di.ku.dk ", "page_idx": 0}, {"type": "text", "text": "Abstract ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Scaling law that rewards large datasets, complex models and enhanced data granularity has been observed in various fields of deep learning. Yet, studies on time series forecasting have cast doubt on scaling behaviors of deep learning methods for time series forecasting: while more training data improves performance, more capable models do not always outperform less capable models, and longer input horizons may hurt performance for some models. We propose a theory for scaling law for time series forecasting that can explain these seemingly abnormal behaviors. We take into account the impact of dataset size and model complexity, as well as time series data granularity, particularly focusing on the look-back horizon, an aspect that has been unexplored in previous theories. Furthermore, we empirically evaluate various models using a diverse set of time series forecasting datasets, which (1) verifies the validity of scaling law on dataset size and model complexity within the realm of time series forecasting, and (2) validates our theoretical framework, particularly regarding the influence of look back horizon. We hope our findings may inspire new models targeting time series forecasting datasets of limited size, as well as large foundational datasets and models for time series forecasting in future work.2 ", "page_idx": 0}, {"type": "text", "text": "1 Introduction ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Because of the practical value of time series forecasting, past years have seen rapid development for time series forecasting methods using the paradigm of neural network training. Neural Nets utilize different model architectures, including FFN-based [1, 2, 3], Transformer-based [4, 5, 6, 7, 8] and Convolution-based [9, 10] neural nets have been proposed. Starting from around 2022, some previous work [1, 11, 7, 10] proposed that powerful models could be enhanced by extending the look-back horizon because more historical information can be utilized. However, our experiments (Figure 3) show that this claim may not hold for datasets in practice with a certain amount of training data: optimal horizon does exist, and it will increase if the amount of available training data increases. This calls for a more thorough understanding of the impact of horizon and dataset size on forecasting loss. ", "page_idx": 0}, {"type": "text", "text": "In Natural Language Processing (NLP) [12, 13], Computer Vision (CV) [14] and other fields in deep learning, the impact of dataset size, model size and data granularity on performance is sometimes summarized as the Scaling Law: larger dataset, larger models and more detailed data granularity improves performance in these cases, and theories [15, 16] have been proposed to explain these behaviors. However, these theories do not lay emphasis on the horizon of time series, hence cannot be used directly to explain the impact of the horizon. ", "page_idx": 0}, {"type": "text", "text": "In this work, we introduce a comprehensive scaling law theory for time series forecasting, with a particular emphasis on the impact of the horizon. This theory integrates dataset size and model size to optimize predictive performance based on the look-back horizon. We further conduct experiments to (1) verify that scaling behaviors for dataset size and model size do exist in time series forecasting and (2) validate our theory, especially about the influence of different horizons. ", "page_idx": 1}, {"type": "text", "text": "Our main contribution regarding time series forecasting includes: ", "page_idx": 1}, {"type": "text", "text": "1. We introduce a novel theoretical framework that elucidates scaling behaviors from an intrinsic space perspective, highlighting the critical influence of the look-back horizon on model performance. Our theory identifies an optimal horizon, demonstrating that beyond this point, performance degrades due to the inherent limitations of dataset size.   \n2. We conduct a comprehensive empirical investigation into the scaling behaviors of dataset size, model size, and look-back horizon across various models and datasets. Our research establishes a robust scaling law for time series forecasting, providing a foundational framework that adapts to diverse modeling contexts. ", "page_idx": 1}, {"type": "text", "text": "As a corollary to our conclusions, we point out that different models might have different optimal look-back horizon for the same dataset (Figure 1); therefore, we call for future work to compare different models using the optimal look-back horizon for each model correspondingly rather than using a fixed look-back horizon. ", "page_idx": 1}, {"type": "text", "text": "As a further result of our findings, though widely used in previous work, to show a model benefits from longer horizon compared to baseline models is unnecessary for proving its superiority over these baseline models. ", "page_idx": 1}, {"type": "text", "text": "We hope our work may inspire future work when designing forecasting models for specific datasets of limited size, as well as future work proposing large foundational datasets and models in the field of time series. ", "page_idx": 1}, {"type": "text", "text": "2 Related Work ", "text_level": 1, "page_idx": 1}, {"type": "text", "text": "2.1 Time Series Forecasting ", "text_level": 1, "page_idx": 1}, {"type": "text", "text": "The task of time series forecasting is to predict a time series with $N$ variables in its next $S$ frames (denoted as $Y=\\{y_{1},y_{2},\\dotsc,y_{N}\\}^{\\bullet}\\in\\mathbb{R}^{N\\setminus S})$ given its previous observations with $H$ frames (denoted as $X=\\{x_{1},x_{2},\\ldots,x_{N}\\}\\in\\mathbb{R}^{N\\times H})$ . $H$ is called look back horizon in some scenarios. ", "page_idx": 1}, {"type": "text", "text": "Channel-Independent model means to predict $y_{i}$ by $\\hat{y_{i}}\\,=\\,f(x_{i})$ . Linear models and MLPs have been proven to be effective learners for time series forecasting. A series of work [1, 3, 17] utilizes linear layers and methods like low-pass-filter and Ordinary Least Squares regression to learn linear relationships in the time series. Reversible MLP [18] proposes to use linear layers and MLPs with reversible Instance Norm [19] and obtains satisfying results. PatchTST [7] proposes to use patch embedding for time series. ", "page_idx": 1}, {"type": "text", "text": "Channel-Dependent model means to predict $y$ by ${\\hat{y_{i}}}=[f(x_{1},x_{2},...,x_{N})]_{i}$ . A series of works based on Transformers and its variants have been proposed[4, 5, 6], as well as a series of convolutionbased methods based on TCN[20, 21]. More recently, iTransformer [8] proposes to use attention to capture the relationship between different variables. ModernTCN [10] proposes new convolutional architectures enabling a wide Effective Receptive Field. ", "page_idx": 1}, {"type": "text", "text": "There have been many works analyzing on mathematical properties of time series before machine learning exists. [22, 23] give good summaries of the early works from different perspectives. ", "page_idx": 1}, {"type": "text", "text": "Recently, there have been works proposing large foundational datasets and models for time series. Some propose foundational models that can do zero-shot forecasting[24]. Some propose open-source foundational datasets and verify the ability for transfer learning of foundation models trained on the datasets[25, 26].3 There are also works utilizing LLMs to do zero-shot prediction[28], or use LLM backbones pretrained on text contexts to perform time series forecasting[29, 30, 31]. ", "page_idx": 1}, {"type": "text", "text": "2.2 Scaling Law and related Theory ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "A plethora of research has been conducted to investigate the scaling law in various domains of deep learning, encompassing Natural Language Processing, Computer Vision tasks, and Graph-based Neural Networks [12, 13, 14, 32]. These studies have not only observed the existence of scaling law but also proposed theories to elucidate them. For instance, certain work has interpreted the scaling behavior from the standpoint of intrinsic space or data manifold, providing a deeper understanding of the underlying mechanisms [15, 16]. In parallel, the properties of time series have been the subject of extensive theoretical and empirical studies. Notably, some research has established bounds for the quantization error of time series, contributing to the body of knowledge on time series analysis [33]. ", "page_idx": 2}, {"type": "text", "text": "3 Theory for Scaling Law in Time Series Forecasting ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "3.1 Forecasting in Intrinsic Space ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "To represent the amount of information carried by a time series slice of length $L$ , we consult the concept of intrinsic dimension and intrinsic space. Consider all time series slices of length $L$ in a particular scenario, these slices are hypothesized to reside within an intrinsic space that encapsulates the fundamental characteristics of the data, effectively representing its inherent features. Denote this intrinsic space as $\\mathcal{M}(L)$ and its intrinsic dimension as $d_{I}(L)$ . ", "page_idx": 2}, {"type": "text", "text": "It immediately follows that time series forecasting is equivalent to predicting a vector in $\\mathcal{M}(S)$ given its previous $H$ frames, which can be represented by a vector in the space $\\mathcal{M}(H)$ . ", "page_idx": 2}, {"type": "text", "text": "3.2 Formulation ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "Before studying the impact of horizon, dataset size and model on loss, we first formulate the intrinsic space, the data distribution and the form of the loss. ", "page_idx": 2}, {"type": "text", "text": "3.2.1 Intrinsic Space ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "For a time series $s_{0,1,\\ldots,L}$ of length $L$ (each $s_{i}$ is a unit element in the sequence that may contain single or multiple variables, dependent or independent), we represent it using a vector $x$ in $\\mathcal{M}(L)$ . ", "page_idx": 2}, {"type": "text", "text": "We make these assumptions on the spaces $\\{\\mathcal{M}(1),\\mathcal{M}(2),...\\}$ and the distribution of data in the spaces: ", "page_idx": 2}, {"type": "text", "text": "Information-preserving: Intuitively speaking, we should be able to recover the real sequence (which might be a multivariable sequence or a singlevariable sequence) from its corresponding intrinsic vector with the error bounded by a small constant value. Formally we can state this as follows:   \nExists a mapping $\\phi$ from the original length- $L$ sequence space $\\mathcal{O}(L)$ to $\\mathcal{M}(L)$ , an inverse mapping $\\phi^{-1}:\\mathcal{M}(L)\\to\\mathcal{O}(L)$ and a constant $e\\ll1$ related to $L$ so that for any $\\mathbb{E}_{x\\sim O(L)}$ , $\\|x-\\phi^{-1}(\\phi(x))\\|_{2}^{2}\\leq e(L)$ . ", "page_idx": 2}, {"type": "text", "text": "2. Inverse Lipschitz: $\\phi^{-1}$ should be $K_{I}$ -Lipschitz under L2 norm. That is: ", "page_idx": 2}, {"type": "equation", "text": "$$\n\\forall x,y\\in\\mathcal{M}(L),\\|\\phi^{-1}(x)-\\phi^{-1}(y)\\|_{2}\\leq K_{I}\\|x-y\\|_{2}\n$$", "text_format": "latex", "page_idx": 2}, {"type": "text", "text": "3. Bounded: For simplicity, we assume the values in all dimensions of the intrinsic space are bounded, and thus we can scale the intrinsic space to fit it into $\\mathcal{M}(H)=[0,1]d_{I}(\\bar{H})$ . ", "page_idx": 2}, {"type": "text", "text": "4. Isomorphism: $\\mathcal{M}(L_{1})$ is isomorphic to a subspace of $\\mathcal{M}(L_{2})$ for $L_{1}\\leq L_{2}$ . Moreover, the isometry should also preserve the data distribution in the space. Formally, we can state it as: Let $P[H_{1},H_{2}]$ denote the linear projection from $\\mathcal{M}(H_{1})$ to the subspace of it isomorphic to $\\mathcal{M}(H_{2})$ , and let $C o v_{L}$ denote the covariance matrix of data distribution in $\\mathcal{M}(L)$ , then $C o v_{L_{1}}$ should be congruent to $P[L_{2},L_{1}](C o v_{L_{2}})$ for any $L_{1}<L_{2}$ . ", "page_idx": 2}, {"type": "text", "text": "5. Linear Truncation: Truncation in time series space is close to linear projection mapping in $\\mathcal{M}(L)$ . Formally, we can state it as: ", "page_idx": 2}, {"type": "text", "text": "Define a truncating function $t_{p}[H_{1},H_{2}](x_{0:H_{1}})_{:}$ , so that for any sequence s, let $S_{h_{1}:h_{2}}$ denote the intrinsic vector for the subsequence from $s[h_{1}]$ to $s[h_{2}-1],$ , then $t_{p}[H_{1},H_{2}](s_{0:H_{1}})=$ $S_{0:H_{2}}$ , then $t_{p}[H_{1},H_{2}]\\approx P[H_{1},H_{2}]$ . ", "page_idx": 3}, {"type": "text", "text": "6. Causality: There should be an optimal model to predict the next $S$ frames given the previous $h\\to\\infty$ frames, so that the error only originates from the intrinsic noise. That is: ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\exists F[S]:\\mathcal{M}\\to\\mathcal{M}(S),s.t.\\operatorname*{lim}_{h\\to\\infty}\\mathbb{P}(y\\mid x_{-h:0})=(1-\\eta)\\delta(F[S](x_{-h:0}))+\\eta\\mathcal{N}(F[S](x_{-h:0}),\\Sigma_{S}),\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "where $\\eta$ stands for the noise ratio in the system, $\\delta(\\cdot)$ stands for the Dirichlet function and $\\mathcal{N}(\\mu,\\Sigma)$ stands for a normal distribution with mean $\\mu$ and covariance $\\Sigma$ . (Notice that the noise distribution is not necessarily a normal distribution and our result holds for any noise distribution with mean $\\mu$ and covariance $\\sigma$ . However we only consider the normal distribution case here for simplicity.) ", "page_idx": 3}, {"type": "text", "text": "Moreover, we assume $F[S]$ is first-order $K_{1}$ -Lipschitz and second-order $K_{2}$ -Lipschitz in $L_{2}$ metric (as we assume $S$ is fixed we don\u2019t discuss how the Lipschitz coefficients vary with $S$ and simply take them as constant). ", "page_idx": 3}, {"type": "text", "text": "7. Uniform Sampling Noise: When drawing a length- $L$ sample, we assume the sampling noise is uniform in each direction in $\\mathcal{M}(L)$ . ", "page_idx": 3}, {"type": "text", "text": "8. Zip-f Distribution: We assume the data distribution in the intrinsic space follows a Zip-f law on different dimensions of the intrinsic space. That is, the eigenvalue spectrum of $C o v_{L}$ satisfies $\\lambda_{i}\\approx\\lambda_{0}i^{-\\alpha_{Z}}$ where $\\lambda_{i}$ represents the $i$ -th largest eigenvalue. This is shown by other work [34, 35] and also verified in our experiments. ", "page_idx": 3}, {"type": "text", "text": "This result is asymptotic and does not suggest uniform intrinsic dimensions across sequence elements. Specifically, for a sequence element with $v$ variables, $d_{I}(H)\\propto v$ approximately in channelindependent scenarios. In contrast, for channel-dependent cases, which are more common, the total intrinsic dimension is typically less than the sum of dimensions for individual variables. ", "page_idx": 3}, {"type": "text", "text": "In the deduction part we do not assume the specific relationship between $d_{I}(H)$ and $H$ . Some previous work[36] shows that in some cases $\\bar{d_{I}}(H)\\approx\\Theta(H)$ . In Appendix A.1 we discuss more about their relationship. ", "page_idx": 3}, {"type": "text", "text": "We formulate the intrinsic space and these assumptions more strictly and provide a brief construction of $\\{\\mathcal{M}(1),\\mathcal{M}(2),...\\}$ in Appendix A.2. Also, we discuss cases where these conditions are not strictly satisfied in Appendix A.3. ", "page_idx": 3}, {"type": "text", "text": "Moreover, under these assumptions made, the loss in the original space $L_{o r i}$ can be linearly bounded by the loss in the intrinsic space $L_{i n s}$ , details of which can be found at Appendix A.4. ", "page_idx": 3}, {"type": "text", "text": "In the following deduction, we use $L$ to denote $L_{i n s}$ . ", "page_idx": 3}, {"type": "text", "text": "3.2.2 Loss: Overall ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "In the following sections, we consider the task to predict a vector in $\\mathcal{M}(S)$ given the vector corresponding to its previous $H$ frames in $\\mathcal{M}(H)$ with a model $m$ . For simplicity, we represent the operation of obtaining a vector in $\\mathcal{M}(t_{2}-t_{1})$ by truncating the sequence $s$ from time $t_{1}$ to $t_{2}$ as $x\\bar{[t_{1}:t_{2}]}$ , where $x$ is a representation in $\\mathcal{M}(|s|)$ . ", "page_idx": 3}, {"type": "equation", "text": "$$\nL=E_{x\\sim\\mathcal{M}(H+S)}[(x[H:H+S]-m(x[0:H]))^{2}]\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "Let $m^{*}$ denote the optimal Bayesian model, then it should satisfy: ", "page_idx": 3}, {"type": "equation", "text": "$$\nm^{*}(x[0:H])=E_{x\\sim\\mathcal{M}(H+S)}[x[H:H+S]|x[0:H]]\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "Thus: ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{L=\\!E_{x\\sim M(H+S)}[(x[H:H+S]-m^{*}(x[0:H])+m^{*}(x[0:H]-m o d e l(x[0:H]))^{2}]}\\\\ &{\\quad=\\!E_{x\\sim M(H+S)}[(x[H:H+S]-m^{*}(x[0:H])^{2}]+E_{x\\sim M(H)}[(m^{*}(x)-m(x))^{2}]}\\\\ &{\\quad\\quad+2*E_{x\\sim M(H+S)}[(x[H:H+S]-m^{*}(x[0:H])*(m^{*}(x)-m(x))]}\\end{array}\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "Since $x[H:H\\!+\\!S]\\!-\\!m^{*}(x[0:H])$ and $m^{*}(x)\\!-\\!m(x)$ are independent with respect to $s[H:H\\!+\\!S]$ and $E_{x\\sim\\mathcal{M}(H+S)}[x[H:H+S]-m^{*}(x[0:H])]=0$ , the loss is a sum of the previous two terms: one is decided by the capability of the optimal Bayesian model (or the Bayesian Error), and the other is the model\u2019s ability to approximate the Bayes Estimation: $L=L_{B a y e s i a n}+L_{a p p r o x}$ . ", "page_idx": 4}, {"type": "text", "text": "We then calculate each of the two terms corresponding to the horizon, dataset size and model size. ", "page_idx": 4}, {"type": "text", "text": "3.2.3 Bayesian Loss ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "We consider the Bayesian error for $\\mathcal{M}(\\infty)$ , when the loss for predicting $S$ frames originates from the inherent uncertainty of the system. That is, we evaluate the amount of information carried by $\\mathcal{M}(H)$ compared to $\\mathcal{M}(\\breve{\\infty})$ . By assumption 5 and 6 in section 3.2.1, It can be verified that: ", "page_idx": 4}, {"type": "equation", "text": "$$\nL_{B a y e s i a n}\\leq(1-\\eta)K_{1}^{2}\\mathbb{E}[v a r(P^{-1}[\\infty,H](x))]+\\eta\\cdot t r(\\Sigma_{S})\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "According to assumption 7, the noise in the $i$ -th predicted frame would be proportional to $\\sqrt{i}$ , and the total noise in the predicted $S$ frames would be proportional to $S$ . Let $\\sigma_{M}^{2}$ denote the variance of the noise for a single frame in a single dimension, then $t r(\\Sigma_{S})$ should be equal to $\\sigma_{M}^{2}S^{2}d_{I}(S)$ . ", "page_idx": 4}, {"type": "text", "text": "According to assumptions 4 and 8, we can express the inverse projection term into: ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\mathbb{E}[v a r(P^{-1}[H](x))]=\\sum_{d_{I}(H)\\leq i<d_{I}}\\lambda_{i}\\approx\\frac{\\lambda_{0}}{(\\alpha_{Z}-1)d_{I}(H)^{\\alpha_{Z}-1}}\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "which indicates that: ", "page_idx": 4}, {"type": "equation", "text": "$$\nL_{B a y e s i a n}\\approx K_{1}^{2}(1-\\eta)\\frac{\\lambda_{0}}{(\\alpha_{Z}-1)d_{I}(H)^{\\alpha_{Z}-1}}+\\eta\\sigma_{M}^{2}S^{2}d_{I}(S)\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "3.2.4 Approximation Loss: Two Cases ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "The training data is sampled from the distribution of $E_{x\\sim\\mathcal{M}(H+S)}[x[H:H+S]|x[0:H]]$ . Following previous works [16, 37], we utilize the piece-wise linear assumption for deep learning models. That is, we assume the model partitions the intrinsic space into $N$ subregions, and does a linear prediction for each subregion independently. Here we discuss two cases: the large-dataset limit and the small-dataset limit. ", "page_idx": 4}, {"type": "text", "text": "If the dataset is large and contains many samples in the piece of the model, the model tends to learn the averaged behavior of the region. Intuitively, a larger dataset size brings smaller noise averages, and a larger model brings smaller piece-wise linear pieces, reducing the error caused by deviation of the data distribution to the linear model in the small blocks. Roughly speaking, the loss consists of two terms: one caused by the uncertainly within the subregions partitioned by the model $L_{r}$ , and one caused by the noise in the data that makes the model fail to learn the optimal model $L_{n}$ . If we assume that the model partitions the space uniformly, then the loss should satisfy: ", "page_idx": 4}, {"type": "equation", "text": "$$\nL_{a p p r o x}\\approx K_{2}^{2}\\frac{d_{I}(H)^{2}N^{-\\frac{4}{d_{I}(H)}}}{4\\pi^{2}}+\\frac{N d_{I}(H)}{D}(\\sigma_{M}^{2}S^{2}d_{I}(S)+\\frac{K_{1}^{2}\\lambda_{0}}{(\\alpha_{Z}-1)d_{I}(H)^{\\alpha_{Z}-1}}).\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "The uniform partitioning should be the most naive case for the model to learn, and we also analyze on the cases where more advanced partitionings are learned in Appendix D. Also, it is worth noticing that the noise consists of two term, one is the systematic uncertainly as shown in section 3.2.3, and the other is caused by the horizon limitation so that the effect of unseen dimension seems exactly like noise for the model. Please refer to Appendix B.2 for a more detailed derivation. ", "page_idx": 4}, {"type": "text", "text": "Otherwise if there are few data samples, or the model is sufficiently large and the model cannot learn to average the noises of closed samples, but rather learns to remember each sample in certain pieces. This would give a data-scaling loss determined by nearest-neighbor distance. In this case: ", "page_idx": 4}, {"type": "equation", "text": "$$\nL_{a p p r o x}\\approx\\frac{K_{1}^{2}}{4\\pi}d_{I}(H)D^{-\\frac{2}{d_{I}(H)}}.\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "Please refer to Appendix B.3 for a more detailed derivation of this scenario. ", "page_idx": 4}, {"type": "text", "text": "Boundary of the two phases is decided by Dataset size and Model size, as well as horizon. It is worth noticing that in time series forecasting tasks, the sliding window method for constructing data samples is usually used. 4 Therefore, the closest data points are always dependent on each other and are strongly correlated. The effective number of mutually independent data fragments is approximately proportional to $D/H$ rather than $D$ , and $\\xi=D/N H$ would be a very approximate order parameter separating the previous two scenarios. Again, please refer to Appendix $\\mathbf{B}$ for a more detailed derivation. ", "page_idx": 4}, {"type": "text", "text": "", "page_idx": 5}, {"type": "text", "text": "3.3 Optimal Horizon under Each Circumstance ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "As stated in section 3.2.2, the total loss would be simply the sum of the two components deduced above. Analyzing the total loss form, we may achieve an optimal horizon $H^{*}$ (or a corresponding optimal intrinsic dimension $d_{I}^{*}$ that minimizes the loss for different cases. ", "page_idx": 5}, {"type": "text", "text": "3.3.1 Optimal Horizon for large amount of data ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "For the case with sufficient data, the total loss is: ", "page_idx": 5}, {"type": "equation", "text": "$$\n\\begin{array}{l}{{{\\cal L}=\\!{\\cal L}_{B a y e s i a n}+{\\cal L}_{A p p r o x}}}\\\\ {{\\mathrm{}~}}\\\\ {{\\approx\\!{\\cal K}_{2}^{2}\\frac{d_{I}(H)^{2}N^{-\\frac{4}{d_{I}(H)}}}{4\\pi^{2}}+{\\cal K}_{1}^{2}(1-\\eta)\\frac{\\lambda_{0}}{\\alpha_{Z}-1}\\frac{1}{d_{I}(H)^{\\alpha z-1}}}}\\\\ {{\\mathrm{}~}}\\\\ {{\\mathrm{}~}}\\\\ {{\\mathrm{}~}}\\\\ {{\\sim\\!{\\cal K}_{2}^{2}\\frac{d_{I}(H)}{D}(\\sigma_{M}^{2}S^{2}d_{I}(S)+\\frac{{\\cal K}_{1}^{2}\\lambda_{0}}{(\\alpha_{Z}-1)d_{I}^{\\alpha z-1}(H)})}}\\\\ {{\\mathrm{}~}}\\\\ {{\\approx\\!{\\cal K}_{2}^{2}\\frac{d_{I}(H)^{2}N^{-\\frac{4}{d_{I}(H)}}}{4\\pi^{2}}+{\\cal K}_{1}^{2}(1-\\eta)\\frac{\\lambda_{0}}{\\alpha_{Z}-1}\\frac{1}{d_{I}(H)^{\\alpha z-1}}+\\frac{N d_{I}(H)}{D}\\sigma_{M}^{2}S^{2}d_{I}(S)}}\\end{array}\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "We consider two cases. The detailed derivation can be found in Appendix C.1. ", "page_idx": 5}, {"type": "text", "text": "If model size is too small compared to dataset size such that $N=o\\big(D^{\\frac{d_{I}(H)}{d_{I}(H)+4}}\\big)$ , then the effect of dataset size on picking optimal horizon could be neglected, thus: ", "page_idx": 5}, {"type": "equation", "text": "$$\nd_{I}^{*}=\\mathcal{W}(\\frac{4}{\\alpha_{Z}C_{0}^{\\frac{1}{\\alpha_{Z}}}}\\ln^{1+\\frac{1}{\\alpha_{Z}}}N)\\approx\\frac{4}{\\alpha_{Z}C_{0}^{\\frac{1}{\\alpha_{Z}}}}\\ln^{1+\\frac{1}{\\alpha_{Z}}}N.\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "where W(\u00b7) is the Lambert W function (W(x) \u2248x) and C0 = K12\u03c02(K12\u2212\u03b7)\u03bb0. ", "page_idx": 5}, {"type": "text", "text": "If $\\mathbf{N}$ is not that small: ${\\cal N}=\\omega\\big(D^{\\frac{d_{I}(H)}{d_{I}(H)+4}}\\big)$ . Then the noise effect would be dominant in picking optimal $H$ , and the optimal $d_{I}(H)$ would be: ", "page_idx": 5}, {"type": "equation", "text": "$$\nd_{I}^{*}=(\\frac{K_{1}^{2}(1-\\eta)\\lambda_{0}D}{N\\sigma_{M}^{2}S^{2}d_{I}(S)})^{\\frac{1}{\\alpha_{Z}}}.\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "In this case, $d_{I}^{*}$ grows noticeably with the increment of $D$ and the decrement of $N$ . ", "page_idx": 5}, {"type": "text", "text": "3.3.2 Optimal Horizon for a relatively small amount of data ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "If data is scarce, the loss could be written as: ", "page_idx": 5}, {"type": "equation", "text": "$$\n\\mathrm{loss}\\approx K_{1}^{2}(1-\\eta)\\frac{\\lambda_{0}}{\\alpha_{Z}-1}\\frac{1}{d_{I}(H)^{\\alpha_{Z}-1}}+\\frac{K_{1}^{2}}{4\\pi}d_{I}(H)D^{-\\frac{2}{d_{I}(H)}}\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "It is worth noticing that in this case, we assume the model is always large enough to find the nearest neighbor for a test sample, hence the loss is irrelevant with $N$ . We can estimate the optimal $d_{I}^{*}$ as: ", "page_idx": 5}, {"type": "equation", "text": "$$\nd_{I}^{*}=C_{s}\\frac{\\ln D}{\\ln\\ln D}\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "Where $C_{s}$ is a constant irrelevant with $D,\\,N$ or $H$ . The exact form is provided in Appendix C.2.   \nCompared to the first scenario, the optimal $d_{I}$ changes much less in this scenario. ", "page_idx": 5}, {"type": "text", "text": "4 Experiment Results ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "4.1 Scaling Law for dataset size and model width do exist for Time Series Forecasting ", "text_level": 1, "page_idx": 6}, {"type": "image", "img_path": "Cr2jEHJB9q/tmp/2199b1279fd45c1ef4b94a0ea60beaed34324111369eb1af434e27210cadea7d.jpg", "img_caption": [], "img_footnote": [], "page_idx": 6}, {"type": "text", "text": "Figure 1: Data Scaling. The proposed formula $l o s s(D)=A+B/D^{\\alpha}$ fits well. More comparison with other formulas can be found at Appendix I. ", "page_idx": 6}, {"type": "image", "img_path": "Cr2jEHJB9q/tmp/25ec20204d648141888011250134e03c94d36e443ea8c7c35fb8cf2abdd21b0f.jpg", "img_caption": [], "img_footnote": [], "page_idx": 6}, {"type": "text", "text": "Figure 2: Width Scaling. When the model is not powerful enough, $l o s s(W)=A+B/W^{\\alpha}$ ftis well for these situations. When data is scarce, a large model may lead to overfitting, as observed with ModernTCN on ETTm1. ", "page_idx": 6}, {"type": "text", "text": "As depicted in Figure 1 and Figure 2, we corroborate the scaling behaviors pertaining to data scaling and model-size scaling across a diverse range of datasets and models. This validation underscores the robustness and versatility of our proposed theoretical framework in the context of time series forecasting. ", "page_idx": 6}, {"type": "text", "text": "Here we mainly include NLinear[1]/MLP, ModernTCN[10] and iTransformer[8] as our models, covering a scenario of Channel-Independent and Channel-Dependent, FFN-based, Transformer-based and Convolution-based methods. For datasets, we mainly use ETTh1, ETTh2, ETTm1, ETTm2, Traffic and Weather[4, 5] as our datasets. Detailed experiment settings can be found at Appendix E. ", "page_idx": 6}, {"type": "text", "text": "It can be seen that for all these models on all these datasets, for the dataset-scaling case where $l o s s=C_{D}\\!+\\!1/D^{\\alpha_{D}}$ and the model width-scaling with large amount of data: $l o s s=C_{W}\\!+\\!1/W^{\\alpha_{W}}$ The results fit well, thus verifying the existence of the original understanding of the scaling law. ", "page_idx": 6}, {"type": "text", "text": "However, in some special cases when the model is large enough to approximate the data, increasing model size would not gain performance, and may hurt performance (if regularization that is not strong enough is added) in some cases, like ModernTCN for ETTm1. ", "page_idx": 6}, {"type": "text", "text": "4.2 The Impact of Horizon to Final Loss ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "4.2.1 Optimal Horizon and Training Data Amount ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "Optimal Horizon grows with more available training data. We conduct experiments, fixing the available training data amount and model size while adjusting the horizon. As shown in Figure 3, an optimal horizon is observed at each data amount, and this optimal value grows with more available training data. ", "page_idx": 6}, {"type": "text", "text": "", "page_idx": 7}, {"type": "image", "img_path": "Cr2jEHJB9q/tmp/a000caf8ea8ca497bbd745f1705a35a7a03f14870e6fb0b371ad7daf49d2e2c4.jpg", "img_caption": ["Figure 3: Loss v.s. Horizon for a certain amount of training data, for different datasets and different models. "], "img_footnote": [], "page_idx": 7}, {"type": "text", "text": "A dataset with a larger feature degradation has a smaller optimal horizon. As our theory predicts, larger $\\alpha_{z}$ leads to a smaller optimal horizon. In the experiment in Figure 4, we use the same Linear model on two different datasets with comparable amount of training data: the Exchange Dataset has $70\\%$ available training data compared to the ETTh1 Dataset. We use eigenvalues obtained by doing Principal component analysis on sampled series as an approximation to the feature variance in the intrinsic space. Detailed procedure and more PCA results can be found at Appendix G. ", "page_idx": 7}, {"type": "image", "img_path": "Cr2jEHJB9q/tmp/73fcdaf571da1332b008ce0d092771a7db736fda553259d2f824c888bca63c4b.jpg", "img_caption": ["Figure 4: PCA results under Channel-Independent and Instance Normalization setting(left), Loss v.s. Horizon for certaim amount of training data on Exchange(middle) and ETTh1(right). Exchange dataset has $70\\%$ data points compared to ETTh1 for training. However, since its feature degradation is stronger, the optimal horizon $(<30)$ using $100\\%$ of Exchange dataset is much smaller than the optimal horizon of the ETTh1 dataset $(>300)$ with only $11\\%$ of available training data. "], "img_footnote": [], "page_idx": 7}, {"type": "text", "text": "Channel-Dependent and Channel-Independent Models sometimes are in different states of the two cases. For CD models, $d_{I}(H)$ is larger and less training data is available, hence it tends to be in the few-data limit. For CI models, $d_{I}(H)$ is smaller and $D$ is larger, hence it may reach the data-dense limit (where the scaling exponent for $D$ is $-1$ ). ", "page_idx": 7}, {"type": "text", "text": "In the following Figure 5, iTransformer on Traffic dataset is in the data-dense limit. For MLP on Transformer, when the horizon is small it is in the few-data limit. For the Linear model, since it is simply linear (rather than piece-wise linear), we expect it to be within the data-dense limit even for long horizons and when the dataset is relatively small (like ETTh1). ", "page_idx": 7}, {"type": "text", "text": "The advantage of channel-independent and channel-dependent models can be explained from the perspective of our theory. For channel-dependent models, the horizon limitation is smaller hence it performs better with plenty of training data. For channel-independent models, more training data is available; moreover, $d$ is smaller, making the scaling exponent larger. ", "page_idx": 7}, {"type": "image", "img_path": "Cr2jEHJB9q/tmp/89e3b4dbd49e13afc2c5412966afefa5b3a3078ffec5d6aa91671a21b1e7cd95.jpg", "img_caption": ["Figure 5: Data scaling behavior for iTransformer (Channel-Dependent model, left) and NormMLP(Channel-Independent model, middle) and NLinear (CI, right). "], "img_footnote": [], "page_idx": 8}, {"type": "text", "text": "4.2.2 Optimal Horizon v.s. Model Size ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "As predicted by our theory there are two cases. (1) When $N$ is small, the optimal horizon does not change much with $N$ . (2) When $N$ is large, the model size scaling term no longer dominates, the coefficient of the noise term $\\frac{N d_{L}}{D}$ dominants thus larger $N$ leads to smaller optimal $H$ . ", "page_idx": 8}, {"type": "image", "img_path": "Cr2jEHJB9q/tmp/7be4f9a738c0978e04849e5f6ae274e6c7c20329f66397871e4431b1952af5cd.jpg", "img_caption": ["Figure 6: Loss v.s. Horizon for models of different widths. For MLP on ETTh1 (left), ModernTCN on ETTh1(middle) and ModernTCN on Weather (right). "], "img_footnote": [], "page_idx": 8}, {"type": "text", "text": "From the observations in Figure 6, it can be discerned that in the initial scenario, where an enhancement in $_\\mathrm{N}$ results in a performance augmentation, the optimal horizon remains relatively invariant with respect to $N$ . This is exemplified in the case of the SingleLayerMLP model. However, in the second scenario, where $_\\mathrm{N}$ attains its optimal value (i.e., for a certain horizon, a smaller N surpasses a larger $N$ in performance), a larger $N$ will correspond to a reduced optimal horizon. This phenomenon is evident in the instances involving the ModernTCN model. ", "page_idx": 8}, {"type": "text", "text": "As predicted by our theory, we see that dataset size has an impact on optimal horizon, while model size has a less significant influence on it. ", "page_idx": 8}, {"type": "text", "text": "5 Discussion and Conclusion ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "5.1 Limitation and Discussion ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "Our theory mainly covers the part of time series forecasting, and our experiments verify our proposed theory on some of the well-used datasets of various sizes. However, these datasets are still small compared to some of the recently proposed large datasets[25]. The scaling behavior predicted in our work of the horizon on these large datasets remains to be experimentally verified and studied. Moreover, we mainly use popular time series forecasting models in recent work and these models might be over-designed for a few datasets for time series. ", "page_idx": 8}, {"type": "text", "text": "Moreover, our work mainly focus on the in-domain setting, rather for pretrained-then-finetuned models or foundation models trained on mixed datasets. We discuss more about whether the assumptions made and our theory deduction work for mixed datasets at Appendix H. ", "page_idx": 8}, {"type": "text", "text": "Since we focus on the impact of the horizon which is an adjustable hyper-parameter for forecasting tasks but a fixed hyper-parameter for other time series tasks, this work does not involve scaling behaviors for other tasks related to time series analysis.The theory for scaling law in other areas of time series forecasting as well as for foundation time series forecasting models remains to be studied. ", "page_idx": 8}, {"type": "text", "text": "Also, although our theory is compatible with analyzing the effect of the predict length $S$ and current experiment for fixed $S$ verifies the impact of $H$ , it is still worth studying the impact of $S$ on optimal $H$ . Also, our theory only holds with assumptions made in Section 3. We leave these to future work. 5 ", "page_idx": 9}, {"type": "text", "text": "We call for future work to compare different models by \u2018performance at optimal look back horizon\u2019 rather than \u2018performance at a certain look back horizon\u2019 to improve robustness. This work further elucidates that, though used in a lot of previous work, to show a model benefits from longer horizon compared to baseline models does not necessarily prove its superiority over these baseline models. ", "page_idx": 9}, {"type": "text", "text": "5.2 Conclusion ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "In this work, we propose a theoretical framework that contemplates the influence of the horizon on scaling behaviors and the performance of time series forecasting models. We take into account the size of the dataset, the complexity of the model, and the impact of the horizon on the ultimate performance. An expanded horizon results in a diminished Bayesian Error, but it simultaneously complicates the task for a limited dataset to fully encompass the entire space and for a model of restricted size to learn effectively. Furthermore, our empirical investigations corroborate the existence of scaling behaviors in relation to dataset size and model size, and validate our proposed theory concerning the impact of the horizon. ", "page_idx": 9}, {"type": "text", "text": "Our theory provides some insight into the area of time series forecasting. For a certain dataset, it would be beneficial to design the models and hyperparameters according to the dataset size and feature degradation property of the particular dataset. Moreover, we think further experiments on larger foundational time series dataset about the optimal horizon with respect to pretraining loss and the loss for transferring to certain datasets may provide further insight as well. ", "page_idx": 9}, {"type": "text", "text": "In conclusion, we aim to provide insights to future work on time series forecasting, emphasizing the importance of the horizon and its potential impact on scaling behaviors in time series forecasting tasks. ", "page_idx": 9}, {"type": "text", "text": "Acknowledgments and Disclosure of Funding ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "We would like to express our great gratitude to Professor Robert M. Haralick for significantly insightful and invaluable help and discussion. We would also like to extend our deep gratitude to Jiaye Teng, whose invaluable help and advice have been instrumental to our progress. In addition, we are profoundly grateful to Professor Yang Yuan for the enlightening discussion we had, which provided significant inspiration and insight into our work. ", "page_idx": 9}, {"type": "text", "text": "We would also like to thank Professor Xiaolong Wang and Jiarui Xu at UCSD for inspiring discussions about scaling context length for NLP, and Yu Sun at Stanford for discussions about properties of time series. ", "page_idx": 9}, {"type": "text", "text": "We would also like to express our gratitude to CPHOS (https://cphos.cn), an academic nonprofit organization dedicated to providing Physics Olympiad Simulations (targeting Physics Olympiads like IPhO) for high school students for free. At CPHOS, we communicate innovative ideas and get to know great academic collaborators, without which this work could not have been carried out. ", "page_idx": 9}, {"type": "text", "text": "We would also like to thank reviewers, ACs and PCs from NeurIPS 2024 who have provided valuable suggestions which have helped to improve this work. ", "page_idx": 9}, {"type": "text", "text": "References ", "text_level": 1, "page_idx": 10}, {"type": "text", "text": "[1] A. Zeng, M. Chen, L. Zhang, and Q. Xu, \u201cAre transformers effective for time series forecasting?\u201d 2022.   \n[2] S.-A. Chen, C.-L. Li, N. Yoder, S. O. Arik, and T. Pfister, \u201cTsmixer: An all-mlp architecture for time series forecasting,\u201d 2023.   \n[3] Z. Xu, A. Zeng, and Q. Xu, \u201cFits: Modeling time series with $10k$ parameters,\u201d 2024.   \n[4] H. Zhou, S. Zhang, J. Peng, S. Zhang, J. Li, H. Xiong, and W. Zhang, \u201cInformer: Beyond efficient transformer for long sequence time-series forecasting,\u201d 2021.   \n[5] H. Wu, J. Xu, J. Wang, and M. Long, \u201cAutoformer: Decomposition transformers with autocorrelation for long-term series forecasting,\u201d 2022.   \n[6] T. Zhou, Z. Ma, Q. Wen, X. Wang, L. Sun, and R. Jin, \u201cFedformer: Frequency enhanced decomposed transformer for long-term series forecasting,\u201d 2022.   \n[7] Y. Nie, N. H. Nguyen, P. Sinthong, and J. Kalagnanam, \u201cA time series is worth 64 words: Longterm forecasting with transformers,\u201d in International Conference on Learning Representations, 2023.   \n[8] Y. Liu, T. Hu, H. Zhang, H. Wu, S. Wang, L. Ma, and M. Long, \u201citransformer: Inverted transformers are effective for time series forecasting,\u201d 2024.   \n[9] H. Wu, T. Hu, Y. Liu, H. Zhou, J. Wang, and M. Long, \u201cTimesnet: Temporal 2d-variation modeling for general time series analysis,\u201d 2023.   \n[10] L. donghao and wang xue, \u201cModernTCN: A modern pure convolution structure for general time series analysis,\u201d in The Twelfth International Conference on Learning Representations, 2024. [Online]. Available: https://openreview.net/forum?id $\\equiv$ vpJMJerXHU   \n[11] H. Wang, J. Peng, F. Huang, J. Wang, J. Chen, and Y. Xiao, \u201cMicn: Multi-scale local and global context modeling for long-term series forecasting,\u201d 2023.   \n[12] J. Kaplan, S. McCandlish, T. Henighan, T. B. Brown, B. Chess, R. Child, S. Gray, A. Radford, J. Wu, and D. Amodei, \u201cScaling laws for neural language models,\u201d 2020.   \n[13] J. Hoffmann, S. Borgeaud, A. Mensch, E. Buchatskaya, T. Cai, E. Rutherford, D. de Las Casas, L. A. Hendricks, J. Welbl, A. Clark, T. Hennigan, E. Noland, K. Millican, G. van den Driessche, B. Damoc, A. Guy, S. Osindero, K. Simonyan, E. Elsen, J. W. Rae, O. Vinyals, and L. Sifre, \u201cTraining compute-optimal large language models,\u201d 2022.   \n[14] X. Zhai, A. Kolesnikov, N. Houlsby, and L. Beyer, \u201cScaling vision transformers,\u201d 2022.   \n[15] Y. Bahri, E. Dyer, J. Kaplan, J. Lee, and U. Sharma, \u201cExplaining neural scaling laws,\u201d 2024.   \n[16] U. Sharma and J. Kaplan, \u201cA neural scaling law from the dimension of the data manifold,\u201d 2020.   \n[17] W. Toner and L. Darlow, \u201cAn analysis of linear time series forecasting models,\u201d 2024.   \n[18] Z. Li, S. Qi, Y. Li, and Z. Xu, \u201cRevisiting long-term time series forecasting: An investigation on linear mapping,\u201d 2023.   \n[19] T. Kim, J. Kim, Y. Tae, C. Park, J.-H. Choi, and J. Choo, \u201cReversible instance normalization for accurate time-series forecasting against distribution shift,\u201d in International Conference on Learning Representations, 2021. [Online]. Available: https://openreview.net/forum?id= cGDAkQo1C0p   \n[20] S. Bai, J. Z. Kolter, and V. Koltun, \u201cAn empirical evaluation of generic convolutional and recurrent networks for sequence modeling,\u201d 2018.   \n[21] R. Sen, H.-F. Yu, and I. Dhillon, \u201cThink globally, act locally: A deep neural network approach to high-dimensional time series forecasting,\u201d 2019.   \n[22] E. Parzen, \u201cAn Approach to Time Series Analysis,\u201d The Annals of Mathematical Statistics, vol. 32, no. 4, pp. 951 \u2013 989, 1961. [Online]. Available: https: //doi.org/10.1214/aoms/1177704840   \n[23] J. G. De Gooijer and R. J. Hyndman, \u201c25 years of time series forecasting,\u201d International journal of forecasting, vol. 22, no. 3, pp. 443\u2013473, 2006.   \n[24] A. Garza, C. Challu, and M. Mergenthaler-Canseco, \u201cTimegpt-1,\u201d 2024.   \n[25] Y. Liu, H. Zhang, C. Li, X. Huang, J. Wang, and M. Long, \u201cTimer: Transformers for time series analysis at scale,\u201d 2024.   \n[26] A. Das, W. Kong, R. Sen, and Y. Zhou, \u201cA decoder-only foundation model for time-series forecasting,\u201d 2024.   \n[27] T. D. P. Edwards, J. Alvey, J. Alsing, N. H. Nguyen, and B. D. Wandelt, \u201cScaling-laws for large time-series models,\u201d 2024. [Online]. Available: https://arxiv.org/abs/2405.13867   \n[28] N. Gruver, M. Finzi, S. Qiu, and A. G. Wilson, \u201cLarge language models are zero-shot time series forecasters,\u201d 2023.   \n[29] C. Chang, W.-Y. Wang, W.-C. Peng, and T.-F. Chen, \u201cLlm4ts: Aligning pre-trained llms as data-efficient time-series forecasters,\u201d 2024.   \n[30] T. Zhou, P. Niu, X. Wang, L. Sun, and R. Jin, \u201cOne ftis all:power general time series analysis by pretrained lm,\u201d 2023.   \n[31] M. Jin, S. Wang, L. Ma, Z. Chu, J. Y. Zhang, X. Shi, P.-Y. Chen, Y. Liang, Y.-F. Li, S. Pan, and Q. Wen, \u201cTime-llm: Time series forecasting by reprogramming large language models,\u201d 2024.   \n[32] J. Liu, H. Mao, Z. Chen, T. Zhao, N. Shah, and J. Tang, \u201cNeural scaling laws on graphs,\u201d 2024.   \n[33] P. Zador, \u201cAsymptotic quantization error of continuous signals and the quantization dimension,\u201d IEEE Transactions on Information Theory, vol. 28, no. 2, pp. 139\u2013149, 1982.   \n[34] N. Levi and Y. Oz, \u201cThe underlying scaling laws and universal statistical structure of complex datasets,\u201d 2024.   \n[35] S. Petrini, A. Casas-i Mu\u00f1oz, J. Cluet-i Martinell, M. Wang, C. Bentz, and R. Ferrer-i Cancho, \u201cDirect and indirect evidence of compression of word lengths. zipf\u2019s law of abbreviation revisited,\u201d Glottometrics, vol. 54, p. 58\u201387, 2023. [Online]. Available: http://dx.doi.org/10.53482/2023_54_407   \n[36] T. M. Buzug, J. von Stamm, and G. Pfister, \u201cCharacterising experimental time series using local intrinsic dimension,\u201d Physics Letters A, vol. 202, no. 2-3, pp. 183\u2013190, 1995.   \n[37] T. N. Chan, Z. Li, L. H. U, and R. Cheng, \u201cPlame: Piecewise-linear approximate measure for additive kernel svm,\u201d IEEE Transactions on Knowledge and Data Engineering, vol. 35, no. 10, pp. 9985\u20139997, 2023.   \n[38] K. D. Ba, P. Indyk, E. Price, and D. P. Woodruff, \u201cLower bounds for sparse recovery,\u201d in Proceedings of the twenty-first annual ACM-SIAM symposium on Discrete Algorithms. SIAM, 2010, pp. 1190\u20131197.   \n[39] X. Qiu, J. Hu, L. Zhou, X. Wu, J. Du, B. Zhang, C. Guo, A. Zhou, C. S. Jensen, Z. Sheng, and B. Yang, \u201cTfb: Towards comprehensive and fair benchmarking of time series forecasting methods,\u201d 2024.   \n[40] A. Paszke, S. Gross, F. Massa, A. Lerer, J. Bradbury, G. Chanan, T. Killeen, Z. Lin, N. Gimelshein, L. Antiga, A. Desmaison, A. K\u00f6pf, E. Yang, Z. DeVito, M. Raison, A. Tejani, S. Chilamkurthy, B. Steiner, L. Fang, J. Bai, and S. Chintala, \u201cPytorch: An imperative style, high-performance deep learning library,\u201d 2019.   \n[41] H. Liu, Z. Dai, D. R. So, and Q. V. Le, \u201cPay attention to mlps,\u201d 2021. ", "page_idx": 10}, {"type": "text", "text": "", "page_idx": 11}, {"type": "text", "text": "A More about the intrinsic space ", "text_level": 1, "page_idx": 12}, {"type": "text", "text": "A.1 Relationship between intrinsic dimension and horizon ", "text_level": 1, "page_idx": 12}, {"type": "text", "text": "We claimed in section 3.2.1 that $d_{I}(H)$ should be asymptotically linear to $H$ . Here we give a rough explanation for this. Since the reconstruction error is bounded by a constant value irrelevant to $L$ , the relative error should be $O(\\frac{1}{L})$ . That is, the error reconstructing $y\\in{\\mathcal{O}}(L)$ from $x\\in\\mathcal{M}(L)$ should be $\\begin{array}{r}{O(\\frac{1}{L})}\\end{array}$ . On the hand, this error can be viewed as an error caused by compressing a $d_{O}(L)$ -dimensional vector into a $d_{I}(L)$ -dimensional space. From a sparse recovery aspect, if the covariance matrix in $\\mathcal{O}(L)$ has rank $r$ , then the $d_{O}(L)$ -dimensional vector would be equivalent with a $r$ -sparse vector. [38] shows that, in this case, the minimal dimension that could recover it with relative error bounded by $C$ is $\\tilde{\\Omega}(r)$ . Since in our case $r\\propto L$ due to intrinsic uncertainty, hence $d_{I}(L)=\\Omega(L)$ . And since $d_{I}(L)\\leq d_{O}(L)=O(L)$ , we proved that $d_{I}(L)=O(L)$ . ", "page_idx": 12}, {"type": "text", "text": "A.2 A Construction Method ", "text_level": 1, "page_idx": 12}, {"type": "text", "text": "We informally provide a specified method to construct $\\mathcal{M}(L)$ theoretically in a recursion method. If $\\mathcal{M}(0),\\mathcal{M}(\\bar{1}),\\dotsc,\\mathcal{M}(\\bar{L}-1)$ has been defined, then we define $\\mathcal{M}(L)$ as follows: given a time series $\\scriptstyle x_{0,1,\\ldots,L-1}$ of length $L$ , we represent it by concatenating the representation of $\\scriptstyle x_{0,1,\\ldots,L-2}$ in $\\mathcal{M}(L-1)$ and $x_{L-1}$ in a space with dimension $d i m(\\mathcal{M}(L-1)+1)$ . Then we find a manifold that these points lie in in this space to represent $\\mathcal{M}(L)$ . ", "page_idx": 12}, {"type": "text", "text": "A.3 Non-linear truncation ", "text_level": 1, "page_idx": 12}, {"type": "text", "text": "We assumed that the truncating function is close to linear projection in section 3.2.1. But in fact the two functions might have some subtle differences. This is because for a certain feature, estimating the feature with a sequence of finite length $L$ might result in error for the feature even if each element in the sequence is accurate enough. (For example, if the feature comes directly from DFT (Discrete Fourier Transform), there might be \u2019leakage error\u2019 if the base frequency is not an exact multiple of the feature frequency.) This is a systematic error caused by the \u2019precession\u2019, where the feature\u2019s characteristic frequency mismatches the measuring frequency. ", "page_idx": 12}, {"type": "text", "text": "For any sequence $S$ and let $x_{t_{1}:t_{2}}\\,\\in\\,\\mathcal{M}(t_{2}\\,-\\,t_{1})$ denote the vector for the sequence $S[t1:t2]$ , we can define a \u2019truncating function\u2019 $t_{p}[H_{1},H_{2}]:{\\mathcal{M}}(H_{1})\\,\\to{\\mathcal{M}}(H_{2})$ for any $H_{1}\\,\\geq\\,H_{2}\\,>\\,0$ with $t_{p}[H_{1},H_{2}](x_{0:H_{1}})=x_{0:H_{2}}.$ . Let $t_{p}^{-1}[H_{1},H_{2}]$ denote the inverse image function, which maps $x\\,\\in\\,\\mathcal{M}(H_{2})$ to $\\{y\\mid y\\,\\in\\,{\\mathcal{M}}(H_{1}),t_{p}^{-}[H_{1},H_{2}](y)\\,=\\,x$ . Notice that this truncating function is unrelated to the specific sequence. Now, assume that $t_{p}[H_{1},H_{2}]$ is smooth, then from implicit function theorem we know that for any vector $x\\in\\mathcal{M}(H_{1})^{\\ast}$ if $t_{p}[H_{1},H_{2}]$ is locally differentiable in a neighborhood of $x$ then $t_{p}^{-1}[H_{1},H_{2}](t_{p}[H_{1},H_{2}](x))$ is a submanifold of $\\mathcal{M}(H_{1})$ with dimension $d_{I}(H_{1})-d_{I}(H_{2})$ , and from Sard\u2019s theorem we know that the targets of these locally undifferentiable points have measure zero. That is: ", "page_idx": 12}, {"type": "text", "text": "Let $S=\\{x\\mid x\\in\\mathcal{M}(H_{1}),t_{p}^{-1}[H_{1},H_{2}](x)\\,\\notin\\,M^{d_{I}(H_{1})-d_{I}(H_{2})}\\}$ where $M^{d}$ denotes the set of all $d$ -dimensional manifolds. Let $\\mu$ denote a measuring function defined in $\\mathcal{M}(H_{1})$ , then $\\mu(S)=0$ . ", "page_idx": 12}, {"type": "text", "text": "Hence the impact of such \u2018critical points\u2019 to the total loss is negligible. For simplicity, we can assume $S=\\emptyset$ . Then $t_{p}$ could be written as: ", "page_idx": 12}, {"type": "equation", "text": "$$\nt_{p}[H_{1},H_{2}](x)=P[H_{1},H_{2}]g[H_{1},H_{2}](x),\n$$", "text_format": "latex", "page_idx": 12}, {"type": "text", "text": "where $P[H_{1},H_{2}]$ is the projection mapping from $\\mathcal{M}(H_{1})$ to $\\mathcal{M}(H_{2})$ , and $g[H_{1},H_{2}]$ is an invertible mapping in $\\mathcal{M}(H_{1})$ that maps $t_{p}^{-1}(y)$ to a $\\left(d_{I}(H_{1})-d_{I}(H_{2})\\right)$ -dimensional subspace of $\\mathcal{M}(H_{1})$ for each $y\\in\\mathcal{M}(H_{2})$ . ", "page_idx": 12}, {"type": "text", "text": "We can naturally assume that the \u2019precession\u2019 effect on each subsequence with a certain length $l$ is only related to $l$ and intrinsic properties of the task itself, then consider a length- $2l$ sequence, it could be viewed as two independent measuring of length- $l$ subsequences, hence this error is always bounded by $\\begin{array}{r}{O(\\frac{1}{\\sqrt{L}})}\\end{array}$ . We can formalize this condition into: ", "page_idx": 12}, {"type": "equation", "text": "$$\n\\frac{\\|g[H_{1},H_{2}](x)-x\\|_{2}}{\\|g[H_{1},H_{2}](x)\\|_{2}}\\leq\\frac{\\kappa}{\\sqrt{H_{1}}},\\forall x\\in\\mathcal{M}(H_{1}),\n$$", "text_format": "latex", "page_idx": 12}, {"type": "text", "text": "where $\\kappa$ is a constant, and $\\|\\cdot\\|_{2}$ represents L2-norm. Also we should have $\\mathbb{E}[g(x)-x]=0$ . This results in an extra term in the Bayesian loss. We deduce it again formally from $\\mathbb{E}[v a r(t_{p}^{-1}[H](x))]$ . ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\begin{array}{l}{\\displaystyle\\mathbb{E}[v a r(t_{p}^{-1}[H](x))]=\\mathbb{E}[v a r(g^{-1}[H]P^{-1}[H](x))]}\\\\ {\\displaystyle\\qquad\\qquad\\qquad\\le\\mathbb{E}[\\frac{\\kappa^{2}}{H}\\|y\\|_{2}^{2}]+\\mathbb{E}[v a r(P^{-1}(x)]}\\\\ {\\displaystyle\\qquad\\qquad=\\frac{\\kappa^{2}}{H}\\sum_{0\\le i<d_{I}}\\lambda_{i}+\\mathbb{E}[v a r(P^{-1}(x)]}\\end{array}\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "Same to what we have done in section 3.2.3: ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\mathbb{E}[v a r(P^{-1}(x))]=\\sum_{d_{I}(H)<=i<d_{I}}\\lambda_{i}\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "Hence: ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\begin{array}{r l r}{\\lefteqn{\\mathbb{E}[v a r(t_{p}^{-1}[H](x))]\\leq\\frac{\\kappa^{2}}{H}\\sum_{0\\leq i<d_{I}}\\lambda_{i}+\\sum_{d_{I}(H)<=i<d_{I}}\\lambda_{i}}}\\\\ &{}&{\\leq\\frac{\\lambda_{0}}{\\alpha_{Z}-1}(\\frac{\\kappa^{2}\\alpha_{Z}}{H}+\\frac{1}{d_{I}(H)^{2\\alpha_{Z}-1}})}\\end{array}\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "which indicates that: ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\mathrm{loss}\\le K^{2}(1-\\eta)\\frac{\\lambda_{0}}{\\alpha_{Z}-1}(\\frac{\\kappa^{2}\\alpha_{Z}}{H}+\\frac{1}{d_{I}(H)^{\\alpha_{Z}-1}})+\\eta\\sigma_{M}^{2}S^{2}d_{I}(S)\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "Since $\\kappa$ should be small, and typically $\\alpha<2$ (it holds for all our experiment results), the extra term could be neglected. Hence, it is reasonable that we assume $t_{p}[H_{1},\\bar{H}_{2}]\\approx P[H_{1},H_{2}]$ . ", "page_idx": 13}, {"type": "text", "text": "A.4 Reduction of Loss into Intrinsic Space ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "We prove that under assumptions made in Section 3.2.1, the loss in the orginal space can be linearly bounded by the loss in the intrinsic space. ", "page_idx": 13}, {"type": "text", "text": "Consider we are predicting $x[0:S]$ from $x[-H:0]$ , let $y_{i}\\,\\in\\,\\mathcal{M}(H)$ be the intrinsic vector of $x[-H:0]$ and $y_{o}\\in\\mathcal{M}(S)$ be the intrinsic vector of $x[0:S]$ (the true intrinsic vector). If we have a model $m$ so that: ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\mathbb{E}_{x[-H:S]\\in\\mathcal{O}(H+S)}[|m(y_{i})-y_{o}|_{2}]\\le L_{i n s}\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "where $L_{i n s}$ represents the expected error (or loss) in the intrinsic space. Then, from assumption 2 we have: ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\mathbb{E}_{x[-H:S]\\in\\mathcal{O}(H+S)}[|\\phi^{-1}(m(y_{i}))-\\phi^{-1}(y_{o})|_{2}]\\le K_{I}L_{i n s}\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "and from assumption 1 we know that $\\mathbb{E}_{x[0:S]\\in\\mathcal{O}(S)}[|\\phi^{-1}(y_{o})-x[0:S]|_{2}]\\le e(S)$ . Therefore: ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{L_{o r i}=\\mathbb{E}_{x[-H:S]\\in\\mathcal{O}(H+S)}[|\\phi^{-1}(m(y_{i}))-x[0:S]|_{2}]}\\\\ &{\\qquad\\leq2\\mathbb{E}_{x[-H:S]\\in\\mathcal{O}(H+S)}[|\\phi^{-1}(m(y_{i}))-\\phi^{-1}(y_{o})|_{2}]+2\\mathbb{E}_{x[0:S]\\in\\mathcal{O}(S)}[|\\phi^{-1}(y_{o})-x[0:S]|_{2}]}\\\\ &{\\qquad\\leq2K_{I}L_{i n s}+2e(S).}\\end{array}\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "Therefore, the loss in the original space is linearly bounded by the loss in the intrinsic space. W.l.o.g we may focus on studying the loss in the intrinsic space. ", "page_idx": 13}, {"type": "text", "text": "B Details about the loss deduction ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "B.1 Boundary ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "Recall that in section 3.2.4 we mentioned that there are two scenarios in which the model should work in totally different ways. The boundary between the two scenarios depends not only on the dataset size $D$ but also on the model size and prediction horizon. A larger model subdivides the intrinsic space into smaller subregions, each containing fewer training samples, with the number of samples per subregion inversely related to model size, expressed as $\\bar{N}^{-1}$ . ", "page_idx": 13}, {"type": "text", "text": "", "page_idx": 14}, {"type": "text", "text": "In time series forecasting, a unique characteristic is that a single sequence, containing multiple length- $\\mathcal{H}$ subsequences, counts as multiple samples. However, these subsequences are not fully independent due to their proximity in the intrinsic space. To quantify independence, we define a separation function $f(H)$ , assumed to be proportional to $H$ , meaning that a sequence of total length $L$ represents $\\frac{L}{f(H)}$ independent samples. Thus, the effective number of independent samples in the dataset scales with $\\frac{D}{H}$ . ", "page_idx": 14}, {"type": "text", "text": "Combining the above analysis, we can define a hyperparameter as $\\begin{array}{r}{\\xi=\\frac{D}{N H}}\\end{array}$ . If $\\xi$ is large enough, then we can assume data is sufficient, and the model tends to learn a linear approximation for each subregion; if $\\xi$ is small, we can assume data is scarce and the model tends to find the nearest neighbour for each test sample. ", "page_idx": 14}, {"type": "text", "text": "B.2 Sufficient Data ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "We formally derive the total loss in the scenario where we have a large amount of data. First recall that the Bayesian loss calculated in section 3.2.3 is: ", "page_idx": 14}, {"type": "equation", "text": "$$\nL_{B a y e s i a n}\\approx K_{1}^{2}(1-\\eta)\\frac{\\lambda_{0}}{(\\alpha_{Z}-1)d_{I}(H)^{\\alpha_{Z}-1}}+\\eta\\sigma_{M}^{2}S^{2}d_{I}(S)\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "As we assume $S$ is fixed, $\\eta\\sigma_{M}^{2}S^{2}d_{I}(S)$ is constant and hence could be ignored. Now let\u2019s consider the approximation loss, it should come from two sources: the limited model size would result in uncertainty in the subregions, and the limited dataset size would bring noise to the data. Let\u2019s consider these two causes separately. ", "page_idx": 14}, {"type": "text", "text": "B.2.1 Model Size Limitation ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "We assume that a model is separating the intrinsic space into $N$ regions, and does a linear prediction for each region. It is easy to verify that the optimal prediction from $\\mathcal{M}(H)$ to $\\mathcal{M}(S)$ should be first-order $K_{1}$ -Lipschitz and second-order $K_{2}$ -Lipschitz, too. ", "page_idx": 14}, {"type": "text", "text": "For any region with volume $V$ , the loss could be estimated as: ", "page_idx": 14}, {"type": "equation", "text": "$$\nL=\\int_{V}\\mathrm{d}^{d_{I}(H)}x|f(x)-l(x)|^{2}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "where $l$ is the predicted linear function for the region. Expanding with Taylor\u2019s series, we have $f(x)\\approx l(x)+{\\textstyle\\frac{1}{2}}(f^{\\prime}(x)-f^{\\prime}(\\mu_{V}))(x-\\mu_{V})$ . From the second-order Lipschitz condition, we can conclude that: ", "page_idx": 14}, {"type": "equation", "text": "$$\n|f(x)-l(x)|^{2}\\leq K_{2}^{2}(x-\\mu_{V})^{4}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "The total loss could be bounded as follows: ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\mathrm{loss}\\leq K_{2}^{2}\\int f(x)(x-Q(x))^{4}\\mathrm{d}x\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "where $Q(x)$ represents the center of the region that $x$ is in and $f(x)$ represents the probability density. We can find that the integral in the formula is exactly the 4th power distortion of the quantization. For an arbitrary quantization with code density $g(x)$ , [33] gives an exact value of distortion equal to: ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\int f(x)(x-Q^{*}(x))^{4}\\mathrm{d}x=\\pi^{-2}N^{-\\frac{4}{d_{I}(H)}}\\Gamma(\\frac{d_{I}(H)+4}{d_{I}(H)})(\\Gamma(\\frac{d_{I}(H)+2}{2}))^{\\frac{4}{d_{I}(H)}}\\int\\frac{f(x)}{g(x)^{\\frac{4}{d_{I}(H)}}}\\mathrm{d}x\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "Assume $d_{I}(H)$ is sufficiently large, then $\\Gamma\\big(\\frac{d_{I}(H)+4}{d_{I}(H)}\\big)\\approx1$ . So the expression can be transformed into: ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\int f(x)(x-Q^{*}(x))^{4}\\mathrm{d}x\\approx\\frac{d_{I}(H)^{2}N^{-\\frac{4}{d_{I}(H)}}}{4\\pi^{2}}\\int\\frac{f(x)}{g(x)^{\\frac{4}{d_{I}(H)}}}\\mathrm{d}x\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "For uniform distribution, $g(x)=1$ (as we assume $\\mathcal{M}(H)=[0,1]^{d_{I}(H)}$ . Hence: ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\int\\frac{f(x)}{g(x)^{\\frac{4}{d_{I}(H)}}}\\mathrm{d}x=1\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "And the total loss could be bounded as: ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\mathrm{loss}\\leq K_{2}^{2}\\frac{d_{I}(H)^{2}N^{-\\frac{4}{d_{I}(H)}}}{4\\pi^{2}}\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "From this bound, we can see that a larger horizon implies a larger burden for the model, which might lead to worse performance for the model. ", "page_idx": 15}, {"type": "text", "text": "B.2.2 Dataset Limitation ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "Following the previous chapter, as we assume the mapping $f$ represented by the model is a piecewise linear function, then regionally it can be written as the usual form of the gaussian-markov linear model, assuming there are homoscedastic uncorrelated noise $\\varepsilon$ for every single sample in the dataset. Now we show that this noise will cause another term of loss even compared to the optimal performance of the model. We first analyze a single region containing $D_{i}$ samples. Consider $X,Y$ from the training set: ", "page_idx": 15}, {"type": "equation", "text": "$$\nY=X\\beta+\\varepsilon.\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "Where $X$ is of shape $D_{i}\\times d_{I}(H)$ and $Y,\\varepsilon$ is of shape $D\\times d_{I}(S)$ . $\\beta$ is the variable to learn of shape $d_{I}(H)\\times d_{I}(S)$ . The BLUE estimator $\\hat{\\beta}$ should be ${\\hat{\\beta}}=(X^{T}X)^{-1}X^{T}Y$ . ", "page_idx": 15}, {"type": "text", "text": "Now consider $X^{\\prime},Y^{\\prime}$ from the test set: ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\quad Y^{\\prime}=X^{\\prime}\\beta+\\varepsilon^{\\prime}}\\\\ &{L_{r e c o n}=E[(Y^{\\prime}-X^{\\prime}\\beta)^{2}]}\\\\ &{\\quad\\quad\\quad=E[(\\varepsilon^{\\prime}-X^{\\prime}(X^{T}X)^{-1}X^{T}\\varepsilon)^{2}]}\\\\ &{\\quad\\quad\\quad=E[\\varepsilon^{\\prime2}]+E[(X^{\\prime}(X^{T}X)^{-1}X^{T}\\varepsilon)^{2}]}\\end{array}\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "The first term goes to 0 if the test set is sufficiently large, and it is a constant given a fixed test set, so we can simply ignore it in our analysis. Consider the second term, we can show that: ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\mathbb{E}[(X^{\\prime}(X^{T}X)^{-1}X^{T}\\varepsilon)^{2}]=D_{i}^{-1}d_{I}(H)\\varepsilon_{y}^{2}\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "Recall the noise consisting of two sources: ", "page_idx": 15}, {"type": "equation", "text": "$$\nY=X\\beta+F[S](X^{*}-P_{c}[H]^{-1}(X))+\\varepsilon_{B}\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "As we\u2019ve done in section 3.2.3, we can derive that: ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\begin{array}{l}{\\mathrm{var}(X^{*}-P_{c}[H]^{-1}(X))\\approx\\displaystyle\\sum_{d_{I}(H)\\le i<d_{I}}\\lambda_{i}}\\\\ {\\approx\\displaystyle\\frac{\\lambda_{0}}{(\\alpha_{Z}-1)d_{I}^{\\alpha_{Z}-1}(H)}}\\end{array}\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "As $F[S]$ is $K_{1}$ -Lipschitz, this indicates that: ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\varepsilon_{h}\\leq\\frac{K_{1}^{2}\\lambda_{0}}{(\\alpha_{Z}-1)d_{I}^{\\alpha_{Z}-1}(H)}\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "And as mentioned in section $3.2.3\\mathrm{~var}(\\varepsilon_{B})=\\sigma_{M}^{2}S^{2}d_{I}(S)$ , hence we can bound the total loss related to $D_{i}$ into: ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\mathrm{loss}_{i}\\leq D_{i}^{-1}d_{I}(H)(\\sigma_{M}^{2}S^{2}d_{I}(S)+\\frac{K_{1}^{2}\\lambda_{0}}{(\\alpha_{Z}-1)d_{I}^{\\alpha_{Z}-1}(H)})\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "It is worth noticing that, although different regions have their own distributions and hence may have different eigenvalues, the loss expression is irrelevant with the eigenvalues, so we can ignore this issue. Considering the entire dataset with all regions, the total loss should be: ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\begin{array}{r l r}{\\lefteqn{\\mathrm{loss}\\approx\\frac{\\displaystyle\\sum_{j=1}^{N}\\mathrm{loss}_{i}\\cdot D_{i}}{D}}}\\\\ &{}&{=\\frac{N d_{I}(H)}{D}(\\sigma_{M}^{2}S^{2}d_{I}(S)+\\frac{K_{1}^{2}\\lambda_{0}}{(\\alpha_{Z}-1)d_{I}^{\\alpha_{Z}-1}(H)})}\\end{array}\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "This indicates that, using a larger model would be more prone to being affected by noise in the dataset, so especially when the data is noisy and the dataset size is limited, our theory suggests that it would perhaps be better to use a smaller model. ", "page_idx": 16}, {"type": "text", "text": "B.2.3 Total loss ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "Combining the above approximation loss and the Bayesian loss, the total loss would be: ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\mathrm{loss}\\approx K_{2}^{2}\\frac{d^{2}N^{-\\frac{4}{d}}}{4\\pi^{2}}+K_{1}^{2}(1-\\eta)\\frac{\\lambda_{0}}{\\alpha_{Z}-1}\\frac{1}{d_{I}(H)^{\\alpha_{Z}-1}}+\\frac{N d_{I}(H)}{D}\\sigma_{M}^{2}S^{2}d_{I}(S)\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "B.3 Scarce Data ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "As the model finds the nearest neighbor, the approximation loss in this scenario should consist of two sources: the distance from the test sample to its nearest neighbor and the noise in its nearest neighbor. If the distribution is smooth, then locally around any point $x$ , the distribution of other points can be viewed as uniform when $D$ is large. ", "page_idx": 16}, {"type": "text", "text": "Consider a sphere of radius $r$ around a test sample, the probability that no point in the training set lies in the ball is approximately: ", "page_idx": 16}, {"type": "equation", "text": "$$\nP(r)\\approx e^{-D V(r)}=e^{-D C_{d}r^{d_{I}(H)}}\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "where Cd =\u0393(dI\u03c0(H)/2+1) $\\begin{array}{r}{C_{d}=\\frac{\\pi^{\\frac{d_{I}(H)}{2}}}{\\Gamma\\left(d_{I}(H)/2+1\\right)}}\\end{array}$ denotes the volume of a unit sphere. ", "page_idx": 16}, {"type": "text", "text": "From this, we can derive that: ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\mathbb{E}_{x}[r^{2}]\\approx\\frac{(\\Gamma(\\frac{d}{2}+1))^{\\frac{2}{d_{I}(H)}}\\Gamma\\big(\\frac{2}{d_{I}(H)}\\big)}{\\pi d_{I}(H)}D^{-\\frac{2}{d_{I}(H)}}f(x)^{\\frac{2}{d_{I}(H)}}\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "Considering $d_{I}(H)$ is large, we can get that: ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\mathbb{E}[r^{2}]\\approx\\frac{d_{I}(H)}{4\\pi}D^{-\\frac{2}{d_{I}(H)}}\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "which means: ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\displaystyle\\cos\\approx\\frac{K_{1}^{2}d}{4\\pi}f D^{-\\frac{2}{d}}\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "Combining the Bayesian loss similar to the previous scenario, the total loss should be: ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\mathrm{loss}\\approx K_{1}^{2}(1-\\eta)\\frac{\\lambda_{0}}{\\alpha_{Z}-1}\\frac{1}{d_{I}(H)^{\\alpha_{Z}-1}}+\\frac{K_{1}^{2}}{4\\pi}d_{I}(H)D^{-\\frac{2}{d_{I}(H)}}\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "C Optimal Horizon deduction ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "Continuing from section B, we study the optimal horizon in two scenarios. ", "page_idx": 16}, {"type": "text", "text": "C.1 Sufficient Data ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "Let\u2019s first study the case where the dataset is large, which is the case in section B.2. ", "page_idx": 16}, {"type": "text", "text": "C.1.1 Small Model ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "If the model size is too small compared to the dataset size, i.e. $N=o\\big(D^{\\frac{d_{I}(H)}{d_{I}(H)+4}}\\big)$ (however we still assume $N$ is sufficiently large compared to other variables), then the effect of dataset size on picking the optimal horizon could be neglected. In this case, the optimal value of $d_{I}(H)$ is unrelated with the dataset size $D$ , and should satisfy: ", "page_idx": 16}, {"type": "equation", "text": "$$\nd_{I}^{*}=(\\frac{K_{1}^{2}\\pi^{2}(1-\\eta)\\lambda_{0}N^{\\frac{4}{d_{I}^{*}}}}{K_{2}^{2}\\ln N})^{\\frac{1}{\\alpha_{Z}}}\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "Solving the formula we get the following result: ", "page_idx": 17}, {"type": "equation", "text": "$$\nd_{I}^{*}=\\mathcal{W}(\\frac{4}{\\alpha_{Z}C_{0}^{\\frac{1}{\\alpha_{Z}}}}\\ln^{1+\\frac{1}{\\alpha_{Z}}}N)\\approx\\frac{4}{\\alpha_{Z}C_{0}^{\\frac{1}{\\alpha_{Z}}}}\\ln^{1+\\frac{1}{\\alpha_{Z}}}N\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "where $\\mathcal{W}(\\cdot)$ is the Lambert $\\mathrm{W}$ function and $\\begin{array}{r}{C_{0}=\\frac{K_{1}^{2}\\pi^{2}(1-\\eta)\\lambda_{0}}{K_{2}^{2}}}\\end{array}$ . ", "page_idx": 17}, {"type": "text", "text": "We can see that in this case, $d_{I}^{*}$ is not only irrelevant with $D$ , but also changes very little with $N$ . ", "page_idx": 17}, {"type": "text", "text": "C.1.2 Large Model ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "On the other hand, if we assume the model is large enough, such that $N=\\omega\\big(D^{\\frac{d_{I}(H)}{d_{I}(H)+4}}\\big)$ , then the noise effect would be dominant in picking the optimal $H$ . In this case, the optimal value of $d_{I}(H)$ should be: ", "page_idx": 17}, {"type": "equation", "text": "$$\nd_{I}^{*}=(\\frac{K^{2}(1-\\eta)\\lambda_{0}D}{N\\sigma_{M}^{2}S^{2}d_{I}(S)})^{\\frac{1}{\\alpha_{Z}}}\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "We can see that in this case the optimal $d_{I}$ changes rapidly to $D$ and $N$ . Moreover, the optimal horizon increases with a larger dataset size $D$ and decreases with a larger model size $N$ (this is quite counter-intuitive but it surprisingly matches our experiment result). ", "page_idx": 17}, {"type": "text", "text": "C.2 Scarce Data ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "This is the case in section B.3. We can directly solve $\\begin{array}{r}{\\frac{\\partial\\mathrm{loss}}{\\partial d_{I}(H)}=0}\\end{array}$ , which is equivalent to: ", "page_idx": 17}, {"type": "equation", "text": "$$\n\\frac{4\\pi(1-\\eta)\\lambda_{0}}{d_{I}^{*}\\alpha z}=D^{-\\frac{2}{d_{I}^{*}}}(1+\\frac{2\\ln D}{d_{I}^{*}})\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "We can estimate that $d_{I}^{*}=\\beta C^{\\frac{1}{\\alpha_{Z}-1}}{\\frac{\\ln D}{\\ln\\ln D}}$ ", "page_idx": 17}, {"type": "equation", "text": "$$\nd_{I}^{*}\\approx\\frac{2}{\\alpha_{Z}+1}\\frac{\\ln D}{\\ln\\ln D}\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "where $C=4\\pi(1-\\eta)\\lambda_{0}$ . Substituting $d_{I}^{*}$ into the formula, we can get: ", "page_idx": 17}, {"type": "equation", "text": "$$\n(\\alpha z-1)\\beta^{2}+\\beta-{\\frac{2}{C^{\\frac{1}{\\alpha_{Z}-1}}}}=0\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "Hence we have: ", "page_idx": 17}, {"type": "equation", "text": "$$\n\\beta=\\frac{\\sqrt{1+\\frac{8(\\alpha_{Z}-1)}{C^{\\frac{1}{\\alpha_{Z}-1}}}}}{2(\\alpha_{Z}-1)}\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "and $d_{I}^{*}$ should be: ", "page_idx": 17}, {"type": "equation", "text": "$$\nd_{I}^{*}=\\frac{\\sqrt{1+\\frac{8(\\alpha_{Z}-1)}{C^{\\frac{1}{\\alpha_{Z}-1}}}}}{2(\\alpha_{Z}-1)}C^{\\frac{1}{\\alpha_{Z}-1}}\\frac{\\ln D}{\\ln\\ln D}\\propto\\frac{\\ln D}{\\ln\\ln D}\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "Compared to the first scenario, the optimal $d_{I}$ almost doesn\u2019t change in this scenario. ", "page_idx": 17}, {"type": "text", "text": "D Details about model\u2019s partitioning ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "As we mentioned in section 3.2.4, we assume the model partitions the intrinsic space uniformly, but there should be better partitions. As [33] states the optimal partition should satisfy $g(x)~\\overset{\\cdot}{\\propto}$ $f(x)^{\\frac{d_{I}(H)}{d_{I}(H)+4}}$ , and if the distribution is Gaussian then the loss (only for this term) should satisfy: ", "page_idx": 17}, {"type": "equation", "text": "$$\nL_{p}\\approx K_{2}^{2}\\frac{\\lambda_{0}^{2}N^{-\\frac{4}{d_{I}(H)}}}{e^{2}d_{I}(H)^{2\\alpha-2}}\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "Replacing the corresponding term with this, we see that in the case in section C.1.2, since the noise makes the most impact, this term does not matter. However, in the case in section C.1.1, if we assume the dataset size is infinite, then the loss is asymptotically monotonically decreasing with $d_{I}(H)$ . Thus, the larger the horizon we use, the better performance the model will potentially reach. ", "page_idx": 18}, {"type": "text", "text": "However, experiments show that the optimal horizon always exists in this case. This might suggest that the model structure limits itself from finding the best partitioning. Hence, we expect that when we design a good enough model structure (maybe only exists theoretically) and when we have enough data, we should be able to make full use of our horizon regardless of the model size or computational resources. ", "page_idx": 18}, {"type": "text", "text": "E Experiment settings ", "text_level": 1, "page_idx": 18}, {"type": "table", "img_path": "Cr2jEHJB9q/tmp/04175ca3408265e86d91891d8ac061c3bd7794eafe2ba96206f5aea7503f41b7.jpg", "table_caption": ["E.1 Dataset "], "table_footnote": ["Table 1: Dataset used for experiments "], "page_idx": 18}, {"type": "text", "text": "We conduct experiments on 8 datasets listed here. ETTh1, ETTh2, ETTm1, ETTm2 [4] contains 7 factors of electricity transformer from July 2016 - July 2018 at a certain frequency. Exchange [5] includes panel data for daily exchange rates from 8 countries across 27 years. Weather [5] includes 21 meteorological factors from a Weather Station. ECL [5] records electricity consumption of 321 clients. Traffic [5] records hourly road occupancy rates for 2 years in San Francisco Bay area freeways. For all experiments, the pred-len is set to 192. ", "page_idx": 18}, {"type": "text", "text": "In our experiments, we do 3 iterations for ETTh1, ETTh2, ETTm1, ETTm2, Weather and Exchange, and draw graphs with error bar equaling to the standard error of these iterations. For Weather dataset, actually the error is minor. (see Appendix E.3), and for larger datasets including Traffic and Electricity, the error is even smaller. Therefore, we conduct 1 iters for Traffic and ECL since they are large and will introduce minor std error. ", "page_idx": 18}, {"type": "text", "text": "E.2 Drop-last issue ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "The drop-last issue is reported by several researchers [3, 39]. That is, in some previous work evaluating the model on test set with drop_las $\\scriptstyle\\mathtt{t}=$ True setting may cause additional errors related to test batch size. In our experiments, we use drop-last set to False to avoid this issue. ", "page_idx": 18}, {"type": "text", "text": "E.3 Time-related Domain Difference in Datasets: can be neglected to a certain extent ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "We use the first $p$ percent of our training dataset as our dataset as available training data. This may introduce an error caused by time-index-related domain differences in these datasets. To avoid this we utilize the Instance Normalization [19]. Our further experiments on the Weather dataset show that this error is actually minor compared to the randomness introduced in the training procedure. We use an NLinear model to forecast 192 frames based on a look-back window of size 336. We use $10\\%$ of training data, from different slices in the training set. For each slice, we repeat the experiment for 3 times. The result is: ", "page_idx": 18}, {"type": "text", "text": "It can be seen that the variance introduced by different slicing points is very small. ", "page_idx": 18}, {"type": "table", "img_path": "Cr2jEHJB9q/tmp/d1cdf9f5ec39ad2ab3da226848ef8a81d09b48e984c18e6a284844ad830f2341.jpg", "table_caption": [], "table_footnote": ["Table 2: MSE measured for weather dataset "], "page_idx": 19}, {"type": "text", "text": "E.4 Models and Experiment settings ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "For all models we utilize instance normalization that normalizes an input sequence based on its mean and std. All the deep learning networks are implemented in PyTorch[40] and conducted on a cluster with NVIDIA RTX 3080, RTX 3090, RTX 4090D and A100 40GB GPUs. Although we use multiple types of GPUs, it is possible to carry out all experiments on a single GPU with greater or equal to 24GB of memory. Experiments conducted in this work cost about $\\mathrm{\\overline{{\\calO}}(10^{3})}$ gpu hours for RTX 3090 in total. ", "page_idx": 19}, {"type": "text", "text": "E.4.1 Linear Models ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "For linear models, we use the linear layer after instance normalization, and perform de-normalization after the linear layer, equivalent to the NLinear model[1], for all datasets and all experiments.Batch size are chosen from $\\{\\bar{1}024,2048,4096,8192,16384\\}$ , learning rate is chosen from $\\{0.003,0.001\\}$ and weight decay is chosen from $\\{0.0005,0.005,0.00\\dot{1},0.0001\\}$ , and we decay the learning rate with a factor of $\\{0.96,0.97,0.98\\}$ for at most 100 epochs with patience at most 30. For larger datasets including Electricity, Traffic and weather the learning rate and weight decay barely make differences to the result. For relatively small datasets includgin ETTh1/ETTh2, ETTm1/ETTm2 and Exchange, larger weight decay may improve performance. ", "page_idx": 19}, {"type": "text", "text": "E.4.2 MLP ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "We use two types of MLPs. For the data scaling (including the HorizonXDataset) experiments, we use the gated MLP[41]: hidden $(x)=W_{1}(x)\\odot$ sigmoid $\\bar{(W_{2}(x))}$ where $\\odot$ is the element-wise product to improve the capability of our model. For the width scaling (and the HorizonXWidth) experiments, we use plain MLP with leaky-relu as activation function. ", "page_idx": 19}, {"type": "text", "text": "Gated MLP is used on Traffic, Weather and Electricity dataset. On these datasets we use 3 \u2212layer mlp with model dimension 768 and hidden dimension $2*768$ . Learning rate is set to 0.001 and weight decay is set to $\\{0.00001,0.0005\\}$ . ", "page_idx": 19}, {"type": "text", "text": "For single layer mlp that we use to experiment the effect of model size scaling, we us the relu activation function and the model width denotes the hidden dimension of the single hidden layer. For different datasets, the learning rate is set to $\\{0.003\\}$ and the weight decay is set to $\\{0.0005\\}$ . ", "page_idx": 19}, {"type": "text", "text": "Batchsize is set to 4096 or 8192 for these cases. ", "page_idx": 19}, {"type": "text", "text": "E.4.3 iTransformer ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "We follow the original codes provided by iTransformer[10]. ", "page_idx": 19}, {"type": "text", "text": "For dataset size scaling and (Horizon X Dataset Size) case we use 4 iTransformer encoder blocks of dimension 512 for Traffic, Weather and Electricity. For other smaller datasets, we use 1 blocks of dimension 192. ", "page_idx": 19}, {"type": "text", "text": "For Model size scaling case we use 2 iTransformer encoder blocks for large datasets including Traffic, Weather and ECL, and 1 block for smaller datasets. The width indicates the model dimension as well as the feedforward dimension. ", "page_idx": 19}, {"type": "text", "text": "Learning rate is set to 0.003 for small datasets and 0.0003 for large datasets. We decay the learning rate with a factor of 0.97 or 0.98 every epoch, and run the training procedure for at most 100 epochs with patience 10 for small datasets, and 40 epochs with patience 10 for larger datasets including Traffic, Weather and Electricity. Batch size is chosen from $\\{12,20,32\\}$ , mainly to fit into the gpu memory. ", "page_idx": 19}, {"type": "text", "text": "E.4.4 ModernTCN ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "We follow the original codes provided by ModernTCN[10]. We use the recommended settings given by the authors of ModernTCN except for the horizon, the channel dimension and the training procedure. Since ModernTCN has many hyperparameters that can be flexibly tuned, we do not include other same hyperparameter here, and please refer to the original paper and cods for ModernTCN for a more detailed description. Here we only include the different hyper-parameters. ", "page_idx": 20}, {"type": "text", "text": "For Dataset Size Scaling and (Horizon X Dataset Size) experiments, we only modify the look back horizon. For training procedure, we use learning rate in $\\{0.00005,0.0001\\}$ . We train for 100 epochs with patience 20 for small datasets and 40 epochs with patience 10 for larger datasets. ", "page_idx": 20}, {"type": "text", "text": "For Model Size Scaling and (Horizon X Model Size) experiments, we only modify the look back horizon as well as the chanenl dimension and the depth-wise dimensions in the code.Again the learning rate is chosen from $\\{0.00005,0.0001\\}$ , and we train for 100 epochs with patience 20 for small datasets and 40 epochs with patience 10 for larger datasets. Batchsize is chosen from $\\{16,64\\}$ following the original hyperparameter settings given by the author of ModernTCN. ", "page_idx": 20}, {"type": "text", "text": "F Downsampling May Improve Performance: power of patch, low-pass-fliter, and downsampling ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Previous work has proven the success of patches [7] and low-pass-fliter [3] for time series prediction. These can be explained with our theory by making the assumption that high frequency features are the most unimportant ones: thus by flitering up high frequency features we make the model visible to the most important dimensions of the intrinsic space. ", "page_idx": 20}, {"type": "text", "text": "From a more detailed theoretical perspective, downsampling can be viewed as a projection to a subspace in the intrinsic space and thus has a similar effect as decreasing the horizon. Experimental results (as shown in experiments in previous works like FITS[3], PatchTST[7] and in Figure 7) show that the projected subspace of higher frequency tends to fall on the large-eigenvalue directions, or the \u2018invisible\u2019 dimensions masked by the projection tends to be the more unimportant ones. Although the precise effect of down sampling is unknown or may need further assumptions and methods for precise consideration, it is acceptable that we may approximate the effect of down sampling to be similar to a projection to the first $d_{e f f}<d_{I}(H)$ dimensions in the intrinsic space. After making this assumption, the overall loss could be expressed as: ", "page_idx": 20}, {"type": "equation", "text": "$$\nl o s s_{n e w}=L(d_{e f f})\\mathrm{where}\\;d_{e f f}<d_{I}(H).\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "Hence, if the original intrinsic dimension is larger than (local) optimal $d$ , indicating $\\partial l o s s/\\partial d>0$ , reducing $d$ from $d_{I}(H)$ to $d_{e f f}$ would help reduce loss. Otherwise if $d_{I}(H)$ is already smaller than (local) optimal $d^{\\ast}$ , meaning $\\dot{\\partial}l o s s/\\partial d<\\dot{0}$ , we would expect no performance improvement from reducing $d$ from $d_{I}(H)$ to $d_{e f f}$ . ", "page_idx": 20}, {"type": "text", "text": "To validate this idea, We do a similar experiment here, that is to do down-sampling and to use the downsampled sequence as input sequence. We conduct experiments on Traffic dataset and Weather dataset with a lookback horizon set to be 336 and a prediction length set to be 192. We use a 4-layer 512-dim gated mlp for traffic dataset and 2-layer 192-dim gated mlp for weather dataset. We can see that doing downsampling would improve the performance of the weather dataset and the optimal downsample ratio also changes with different training dataset size. The explanation for this is similar to how we explain the optimal horizon growth with the growth of the training dataset. More data in the training dataset would lead to less noise on higher dimensions, thus seeing more of these dimensions (or flitering out fewer dimensions with downsampling with longer interpolate length) can improve performance. ", "page_idx": 20}, {"type": "text", "text": "Meanwhile, for the traffic dataset, downsampling may hurt performance. This is because Traffic has large amount of training data, and 336 is smaller than the optimal horizon. At this all dimensions in the intrinsic space are not dominated by noise, hence flitering them out would hurt performance, and we would expect the performance to be improved with the increment of interpolate length. ", "page_idx": 20}, {"type": "image", "img_path": "Cr2jEHJB9q/tmp/fc883c22f7d88bec437c16f7cb63fe2fec2e4db8f2d8b9cb1dad4caa3081166e.jpg", "img_caption": ["Figure 7: MSE loss v.s. interpolate-to-len (length after downsampling) for Traffic and Weather dataset for a certain amount of training data. "], "img_footnote": [], "page_idx": 21}, {"type": "text", "text": "G PCA settings ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "We use PCA to obtain eigen values that we use to approximate the importance of features in the intrinsic space. We conduct PCA at (all or part of the) training samples (after instance normalization), mainly for the Channel-Independent case. For the PCA used in Figure4 and Figure 8 the horizon is set to 2000 for both datasets and we perform PCA on all the training samples. We provide more PCA results in Figure 8: if we approximately view the PCA eig-val as the feature importance, then they do follow a Zip-f law approximately. ", "page_idx": 21}, {"type": "image", "img_path": "Cr2jEHJB9q/tmp/07c7c0c67cd739aa0a21cbc85362c05102a649c9289fb7ad19f34d29b9ca14e2.jpg", "img_caption": ["Figure 8: PCA results for $L=2000$ under Channel-Independent setting on some datasets. "], "img_footnote": [], "page_idx": 21}, {"type": "text", "text": "We further conduct PCA on intermediate vectors of the iTransformer[8] model and obtain results, further validating the Zip-f assumption in our paper for intrinsic space for Non-Linear ChannelDependent Multivariable cases, as shown in Figure 9. ", "page_idx": 21}, {"type": "text", "text": "H Foundation Models for Mixed Datasets ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "Our theory holds without the need for any modification as long as the dataset itself follows a Zip-f distribution in the intrinsic space. This assumption is sort of natural given that Zip-f law is a natural distribution, and previous datasets we examined (like Traffic, ETT, etc) to follow the Zip-f law are composed of smaller datasets. Moreover, we provide further analysis from Theoretical and Experimental perspective on why it holds for mixed datasets. ", "page_idx": 21}, {"type": "image", "img_path": "Cr2jEHJB9q/tmp/92c7faa2347d83ac4966957677de16feb7ed68bf27ccde33d0b0910ee473d031.jpg", "img_caption": ["Figure 9: PCA obtained with iTransformer features. Zip-f law fitting receives $p\\,>\\,0.05$ in all cases. Note that it is hard for deep-learning methods (like iTransformer) to learn feature with small covariance very well, it may be hard to learn features in exchange dataset well (in which feature degrades very fast), hence the seemingly not-fitting figure for exchange is more likely caused by under-training of deep learning models. "], "img_footnote": [], "page_idx": 22}, {"type": "text", "text": "H.1 Zip-f distribution for Mixed Datasets: a toy model ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Theoretically, if a large dataset is composed of $s$ sub-datasets of similar size each following the Zip-f law with degradation coefficient $\\alpha_{1}<\\alpha_{2}<\\ldots<\\alpha_{s}$ , each with size $S_{i}$ and follows Zip-f law: $\\lambda_{i j}=A_{i}/j^{\\alpha_{i}}$ where $\\lambda_{i j}$ represents the $j$ -th largest eigenvalue of the $i$ -th dataset. Suppose the intrinsic dimensions are orthogonal with each other (hence PCA components are orthogonal). A simple assumption is that the new intrinsic space is a direct product of the old intrinsic spaces, hence eigenvalues are the union of old eigenvalues. For which, an eigenvalue of value $S$ should be the $i d x_{t o t a l}$ -largest eigen value, in which: ", "page_idx": 22}, {"type": "equation", "text": "$$\ni d x_{t o t a l}=\\sum_{i}i d x_{i}=\\sum_{i}(A_{i}/S)^{1/\\alpha_{i}}.\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "When $S$ is small (or correspondingly, when $i d x_{t o t a l}$ is large) this sum is dominated by small $\\alpha\\mathbf{S}$ , and in limitation cases the sum is dominated by $\\alpha_{1}$ term: $i d x\\stackrel{.}{\\approx}(A_{1}/S)^{1/\\alpha_{1}}+C$ , which is approximately a Zip-f distribution. ", "page_idx": 22}, {"type": "text", "text": "H.2 Experiment results for Zip-f distribution for Mixed Datasets ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Experimentally, we use the Mixed Dataset of Traffic, Weather, ETTh1, ETTh2, ETTm1, ETTm2, exchange and ECL to train a Channel-Independent 2-layer 512-dimension MLP and use the Intermediate vector before the decoder layer as a feature vector to do PCA analysis. We found that the result follows a Zip-f distribution for higher-order components, as shown in Figure 10. ", "page_idx": 22}, {"type": "text", "text": "I More comparison with other formulas ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "We compare AiC and BiC value of our proposed formula $f(x)=A+B/x^{\\alpha}$ with other possible formulas: ", "page_idx": 22}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\bullet\\,g_{1}(x)=A/x^{\\alpha}}\\\\ &{\\bullet\\,g_{2}(x)=A+B\\log(x)}\\\\ &{\\bullet\\,g_{3}(x)=A+B x+C x^{2}}\\end{array}\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "For ModernTCN: ", "page_idx": 22}, {"type": "text", "text": "For iTransformer: ", "page_idx": 22}, {"type": "text", "text": "For MLP or Linear models: ", "page_idx": 22}, {"type": "image", "img_path": "Cr2jEHJB9q/tmp/2b472e863309a17768fa7a088bb3a4e1fb7abcdd5716a5cecd212e48c05ce7b0.jpg", "img_caption": ["Figure 10: PCA obtained with MLP features trained on Mixed Dataset. The 2-layer 512-dimension MLP is trained under Channel Independent setting on a mixed dataset of Traffic, Weather, Exchange, ETTh1, ETTh2, ETTm1, ETTm2 and ECL. The mixed feature shows a well-aligned Zip-f law for features of higher rankings. "], "img_footnote": [], "page_idx": 23}, {"type": "table", "img_path": "Cr2jEHJB9q/tmp/60220a252daf5e06a35aee6c31db7d5309c2329c5c93119168b398773adcaf5f.jpg", "table_caption": [], "table_footnote": ["Table 3: regression results for ModernTCN "], "page_idx": 23}, {"type": "table", "img_path": "Cr2jEHJB9q/tmp/86f3d3fb3ccac7429decc12acf9bd42d535d835bebacfcadb554b81c5856361a.jpg", "table_caption": [], "table_footnote": ["Table 4: regression results for iTransformer "], "page_idx": 23}, {"type": "table", "img_path": "Cr2jEHJB9q/tmp/0f9f62359847dedd578d94a76bfd3742c1385a4aa380566a9b2cdb0d1f5c8e0e.jpg", "table_caption": [], "table_footnote": ["Table 5: regression results for MLP or Linear models "], "page_idx": 23}, {"type": "text", "text": "NeurIPS Paper Checklist ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "1. Claims ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: Do the main claims made in the abstract and introduction accurately reflect the paper\u2019s contributions and scope? ", "page_idx": 23}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Justification: We made claims in the abstract and introduction part that our main contribution includes: (1) proposes a theory (please refer to Section 3) for scaling law for time series forecasting, taking into account the impact of dataset size, model size and look back horizon and (2) conduct experiments (please refer to Section 4) to verify the validity of scaling law on dataset size and model complexity, as well as to validate our theoretical framework on time series forecasting models. This aligns with our claims and our paper\u2019s contribution. ", "page_idx": 23}, {"type": "text", "text": "Guidelines: ", "page_idx": 24}, {"type": "text", "text": "\u2022 The answer NA means that the abstract and introduction do not include the claims made in the paper.   \n\u2022 The abstract and/or introduction should clearly state the claims made, including the contributions made in the paper and important assumptions and limitations. A No or NA answer to this question will not be perceived well by the reviewers.   \n\u2022 The claims made should match theoretical and experimental results, and reflect how much the results can be expected to generalize to other settings.   \n\u2022 It is fine to include aspirational goals as motivation as long as it is clear that these goals are not attained by the paper. ", "page_idx": 24}, {"type": "text", "text": "2. Limitations ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Question: Does the paper discuss the limitations of the work performed by the authors? Answer: [Yes] ", "page_idx": 24}, {"type": "text", "text": "Justification: We discuss our limitation in Section 5. ", "page_idx": 24}, {"type": "text", "text": "Guidelines: ", "page_idx": 24}, {"type": "text", "text": "\u2022 The answer NA means that the paper has no limitation while the answer No means that the paper has limitations, but those are not discussed in the paper.   \n\u2022 The authors are encouraged to create a separate \"Limitations\" section in their paper.   \n\u2022 The paper should point out any strong assumptions and how robust the results are to violations of these assumptions (e.g., independence assumptions, noiseless settings, model well-specification, asymptotic approximations only holding locally). The authors should reflect on how these assumptions might be violated in practice and what the implications would be.   \n\u2022 The authors should reflect on the scope of the claims made, e.g., if the approach was only tested on a few datasets or with a few runs. In general, empirical results often depend on implicit assumptions, which should be articulated.   \n\u2022 The authors should reflect on the factors that influence the performance of the approach. For example, a facial recognition algorithm may perform poorly when image resolution is low or images are taken in low lighting. Or a speech-to-text system might not be used reliably to provide closed captions for online lectures because it fails to handle technical jargon.   \n\u2022 The authors should discuss the computational efficiency of the proposed algorithms and how they scale with dataset size.   \n\u2022 If applicable, the authors should discuss possible limitations of their approach to address problems of privacy and fairness.   \n\u2022 While the authors might fear that complete honesty about limitations might be used by reviewers as grounds for rejection, a worse outcome might be that reviewers discover limitations that aren\u2019t acknowledged in the paper. The authors should use their best judgment and recognize that individual actions in favor of transparency play an important role in developing norms that preserve the integrity of the community. Reviewers will be specifically instructed to not penalize honesty concerning limitations. ", "page_idx": 24}, {"type": "text", "text": "3. Theory Assumptions and Proofs ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Question: For each theoretical result, does the paper provide the full set of assumptions and a complete (and correct) proof? ", "page_idx": 24}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 24}, {"type": "text", "text": "Justification: We gave thorough assumptions and clear proofs. More specifically, we formulate the intrinsic space in section 3.2.1, and calculate the loss in the rest of section 3.2. Then we analyze the optimal horizon in section 3.3. The detailed proof is shown from Appendix A to C ", "page_idx": 24}, {"type": "text", "text": "Guidelines: ", "page_idx": 24}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include theoretical results. \u2022 All the theorems, formulas, and proofs in the paper should be numbered and crossreferenced. ", "page_idx": 24}, {"type": "text", "text": "\u2022 All assumptions should be clearly stated or referenced in the statement of any theorems. \u2022 The proofs can either appear in the main paper or the supplemental material, but if they appear in the supplemental material, the authors are encouraged to provide a short proof sketch to provide intuition. \u2022 Inversely, any informal proof provided in the core of the paper should be complemented by formal proofs provided in appendix or supplemental material. \u2022 Theorems and Lemmas that the proof relies upon should be properly referenced. ", "page_idx": 25}, {"type": "text", "text": "4. Experimental Result Reproducibility ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "Question: Does the paper fully disclose all the information needed to reproduce the main experimental results of the paper to the extent that it affects the main claims and/or conclusions of the paper (regardless of whether the code and data are provided or not)? ", "page_idx": 25}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "Justification: We give details for our experiments at Appendix E. We also provide code and logs in the supplementary materials. ", "page_idx": 25}, {"type": "text", "text": "Guidelines: ", "page_idx": 25}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 If the paper includes experiments, a No answer to this question will not be perceived well by the reviewers: Making the paper reproducible is important, regardless of whether the code and data are provided or not.   \n\u2022 If the contribution is a dataset and/or model, the authors should describe the steps taken to make their results reproducible or verifiable.   \n\u2022 Depending on the contribution, reproducibility can be accomplished in various ways. For example, if the contribution is a novel architecture, describing the architecture fully might suffice, or if the contribution is a specific model and empirical evaluation, it may be necessary to either make it possible for others to replicate the model with the same dataset, or provide access to the model. In general. releasing code and data is often one good way to accomplish this, but reproducibility can also be provided via detailed instructions for how to replicate the results, access to a hosted model (e.g., in the case of a large language model), releasing of a model checkpoint, or other means that are appropriate to the research performed.   \n\u2022 While NeurIPS does not require releasing code, the conference does require all submissions to provide some reasonable avenue for reproducibility, which may depend on the nature of the contribution. For example (a) If the contribution is primarily a new algorithm, the paper should make it clear how to reproduce that algorithm. (b) If the contribution is primarily a new model architecture, the paper should describe the architecture clearly and fully. (c) If the contribution is a new model (e.g., a large language model), then there should either be a way to access this model for reproducing the results or a way to reproduce the model (e.g., with an open-source dataset or instructions for how to construct the dataset). (d) We recognize that reproducibility may be tricky in some cases, in which case authors are welcome to describe the particular way they provide for reproducibility. In the case of closed-source models, it may be that access to the model is limited in some way (e.g., to registered users), but it should be possible for other researchers to have some path to reproducing or verifying the results. ", "page_idx": 25}, {"type": "text", "text": "5. Open access to data and code ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "Question: Does the paper provide open access to the data and code, with sufficient instructions to faithfully reproduce the main experimental results, as described in supplemental material? ", "page_idx": 25}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 25}, {"type": "text", "text": "Justification: we describe the hyperparameters used in Appendix E, and we provide code in our supplementary material. We will make our code publicly available after refactoring. Guidelines: ", "page_idx": 25}, {"type": "text", "text": "\u2022 The answer NA means that paper does not include experiments requiring code.   \n\u2022 Please see the NeurIPS code and data submission guidelines (https://nips.cc/ public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 While we encourage the release of code and data, we understand that this might not be possible, so \u201cNo\u201d is an acceptable answer. Papers cannot be rejected simply for not including code, unless this is central to the contribution (e.g., for a new open-source benchmark).   \n\u2022 The instructions should contain the exact command and environment needed to run to reproduce the results. See the NeurIPS code and data submission guidelines (https: //nips.cc/public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 The authors should provide instructions on data access and preparation, including how to access the raw data, preprocessed data, intermediate data, and generated data, etc.   \n\u2022 The authors should provide scripts to reproduce all experimental results for the new proposed method and baselines. If only a subset of experiments are reproducible, they should state which ones are omitted from the script and why.   \n\u2022 At submission time, to preserve anonymity, the authors should release anonymized versions (if applicable).   \n\u2022 Providing as much information as possible in supplemental material (appended to the paper) is recommended, but including URLs to data and code is permitted. ", "page_idx": 26}, {"type": "text", "text": "6. Experimental Setting/Details ", "text_level": 1, "page_idx": 26}, {"type": "text", "text": "Question: Does the paper specify all the training and test details (e.g., data splits, hyperparameters, how they were chosen, type of optimizer, etc.) necessary to understand the results? ", "page_idx": 26}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 26}, {"type": "text", "text": "Justification: We give different dataset configs and corresponding hyperparameters at Appendix E. ", "page_idx": 26}, {"type": "text", "text": "Guidelines: ", "page_idx": 26}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments. \u2022 The experimental setting should be presented in the core of the paper to a level of detail that is necessary to appreciate the results and make sense of them. \u2022 The full details can be provided either with the code, in appendix, or as supplemental material. ", "page_idx": 26}, {"type": "text", "text": "7. Experiment Statistical Significance ", "text_level": 1, "page_idx": 26}, {"type": "text", "text": "Question: Does the paper report error bars suitably and correctly defined or other appropriate information about the statistical significance of the experiments? ", "page_idx": 26}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 26}, {"type": "text", "text": "Justification: We report and analyze the error in our experiments. Please refer to Appendix E for more details about errors. ", "page_idx": 26}, {"type": "text", "text": "Guidelines: ", "page_idx": 26}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The authors should answer \"Yes\" if the results are accompanied by error bars, confidence intervals, or statistical significance tests, at least for the experiments that support the main claims of the paper.   \n\u2022 The factors of variability that the error bars are capturing should be clearly stated (for example, train/test split, initialization, random drawing of some parameter, or overall run with given experimental conditions).   \n\u2022 The method for calculating the error bars should be explained (closed form formula, call to a library function, bootstrap, etc.)   \n\u2022 The assumptions made should be given (e.g., Normally distributed errors).   \n\u2022 It should be clear whether the error bar is the standard deviation or the standard error of the mean.   \n\u2022 It is OK to report 1-sigma error bars, but one should state it. The authors should preferably report a 2-sigma error bar than state that they have a $96\\%$ CI, if the hypothesis of Normality of errors is not verified.   \n\u2022 For asymmetric distributions, the authors should be careful not to show in tables or figures symmetric error bars that would yield results that are out of range (e.g. negative error rates).   \n\u2022 If error bars are reported in tables or plots, The authors should explain in the text how they were calculated and reference the corresponding figures or tables in the text. ", "page_idx": 26}, {"type": "text", "text": "", "page_idx": 27}, {"type": "text", "text": "8. Experiments Compute Resources ", "text_level": 1, "page_idx": 27}, {"type": "text", "text": "Question: For each experiment, does the paper provide sufficient information on the computer resources (type of compute workers, memory, time of execution) needed to reproduce the experiments? ", "page_idx": 27}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 27}, {"type": "text", "text": "Justification: We provide information about implementation framework and compute resources at Appendix E.4. ", "page_idx": 27}, {"type": "text", "text": "Guidelines: ", "page_idx": 27}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The paper should indicate the type of compute workers CPU or GPU, internal cluster, or cloud provider, including relevant memory and storage.   \n\u2022 The paper should provide the amount of compute required for each of the individual experimental runs as well as estimate the total compute.   \n\u2022 The paper should disclose whether the full research project required more compute than the experiments reported in the paper (e.g., preliminary or failed experiments that didn\u2019t make it into the paper). ", "page_idx": 27}, {"type": "text", "text": "9. Code Of Ethics ", "text_level": 1, "page_idx": 27}, {"type": "text", "text": "Question: Does the research conducted in the paper conform, in every respect, with the NeurIPS Code of Ethics https://neurips.cc/public/EthicsGuidelines? ", "page_idx": 27}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 27}, {"type": "text", "text": "Justification: We follow NeurIPS Code of Ethics and give clear details. ", "page_idx": 27}, {"type": "text", "text": "Guidelines: ", "page_idx": 27}, {"type": "text", "text": "\u2022 The answer NA means that the authors have not reviewed the NeurIPS Code of Ethics.   \n\u2022 If the authors answer No, they should explain the special circumstances that require a deviation from the Code of Ethics.   \n\u2022 The authors should make sure to preserve anonymity (e.g., if there is a special consideration due to laws or regulations in their jurisdiction). ", "page_idx": 27}, {"type": "text", "text": "10. Broader Impacts ", "text_level": 1, "page_idx": 27}, {"type": "text", "text": "Question: Does the paper discuss both potential positive societal impacts and negative societal impacts of the work performed? ", "page_idx": 27}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 27}, {"type": "text", "text": "Justification: Our work proposes a theory for scaling behaviors for time series forecasting tasks and experimentally validates the proposed theory. Though we hope our work may inspire work for time series forecasting, this work alone is a foundational research that sees no social impact on its own. ", "page_idx": 27}, {"type": "text", "text": "Guidelines: ", "page_idx": 27}, {"type": "text", "text": "\u2022 The answer NA means that there is no societal impact of the work performed.   \n\u2022 If the authors answer NA or No, they should explain why their work has no societal impact or why the paper does not address societal impact.   \n\u2022 Examples of negative societal impacts include potential malicious or unintended uses (e.g., disinformation, generating fake profiles, surveillance), fairness considerations (e.g., deployment of technologies that could make decisions that unfairly impact specific groups), privacy considerations, and security considerations.   \n\u2022 The conference expects that many papers will be foundational research and not tied to particular applications, let alone deployments. However, if there is a direct path to any negative applications, the authors should point it out. For example, it is legitimate to point out that an improvement in the quality of generative models could be used to generate deepfakes for disinformation. On the other hand, it is not needed to point out that a generic algorithm for optimizing neural networks could enable people to train models that generate Deepfakes faster.   \n\u2022 The authors should consider possible harms that could arise when the technology is being used as intended and functioning correctly, harms that could arise when the technology is being used as intended but gives incorrect results, and harms following from (intentional or unintentional) misuse of the technology.   \n\u2022 If there are negative societal impacts, the authors could also discuss possible mitigation strategies (e.g., gated release of models, providing defenses in addition to attacks, mechanisms for monitoring misuse, mechanisms to monitor how a system learns from feedback over time, improving the efficiency and accessibility of ML). ", "page_idx": 27}, {"type": "text", "text": "", "page_idx": 28}, {"type": "text", "text": "11. Safeguards ", "text_level": 1, "page_idx": 28}, {"type": "text", "text": "Question: Does the paper describe safeguards that have been put in place for responsible release of data or models that have a high risk for misuse (e.g., pretrained language models, image generators, or scraped datasets)? ", "page_idx": 28}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 28}, {"type": "text", "text": "Justification: Our work does not release new models or datasets, hence the paper poses no such risks. ", "page_idx": 28}, {"type": "text", "text": "Guidelines: ", "page_idx": 28}, {"type": "text", "text": "\u2022 The answer NA means that the paper poses no such risks.   \n\u2022 Released models that have a high risk for misuse or dual-use should be released with necessary safeguards to allow for controlled use of the model, for example by requiring that users adhere to usage guidelines or restrictions to access the model or implementing safety filters.   \n\u2022 Datasets that have been scraped from the Internet could pose safety risks. The authors should describe how they avoided releasing unsafe images.   \n\u2022 We recognize that providing effective safeguards is challenging, and many papers do not require this, but we encourage authors to take this into account and make a best faith effort. ", "page_idx": 28}, {"type": "text", "text": "12. Licenses for existing assets ", "text_level": 1, "page_idx": 28}, {"type": "text", "text": "Question: Are the creators or original owners of assets (e.g., code, data, models), used in the paper, properly credited and are the license and terms of use explicitly mentioned and properly respected? ", "page_idx": 28}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 28}, {"type": "text", "text": "Justification: We use previously proposed models and datasets, and include license for existing assets. ", "page_idx": 28}, {"type": "text", "text": "Guidelines: ", "page_idx": 28}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not use existing assets.   \n\u2022 The authors should cite the original paper that produced the code package or dataset.   \n\u2022 The authors should state which version of the asset is used and, if possible, include a URL.   \n\u2022 The name of the license (e.g., CC-BY 4.0) should be included for each asset.   \n\u2022 For scraped data from a particular source (e.g., website), the copyright and terms of service of that source should be provided.   \n\u2022 If assets are released, the license, copyright information, and terms of use in the package should be provided. For popular datasets, paperswithcode.com/datasets has curated licenses for some datasets. Their licensing guide can help determine the license of a dataset.   \n\u2022 For existing datasets that are re-packaged, both the original license and the license of the derived asset (if it has changed) should be provided.   \n\u2022 If this information is not available online, the authors are encouraged to reach out to the asset\u2019s creators. ", "page_idx": 28}, {"type": "text", "text": "", "page_idx": 29}, {"type": "text", "text": "13. New Assets ", "text_level": 1, "page_idx": 29}, {"type": "text", "text": "Question: Are new assets introduced in the paper well documented and is the documentation provided alongside the assets? ", "page_idx": 29}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 29}, {"type": "text", "text": "Justification: We use publicly available models and datasets and do not release new assets including models or datasets. We mainly conduct experiments based on code bases of previous work. ", "page_idx": 29}, {"type": "text", "text": "Guidelines: ", "page_idx": 29}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not release new assets.   \n\u2022 Researchers should communicate the details of the dataset/code/model as part of their submissions via structured templates. This includes details about training, license, limitations, etc.   \n\u2022 The paper should discuss whether and how consent was obtained from people whose asset is used.   \n\u2022 At submission time, remember to anonymize your assets (if applicable). You can either create an anonymized URL or include an anonymized zip file. ", "page_idx": 29}, {"type": "text", "text": "14. Crowdsourcing and Research with Human Subjects ", "text_level": 1, "page_idx": 29}, {"type": "text", "text": "Question: For crowdsourcing experiments and research with human subjects, does the paper include the full text of instructions given to participants and screenshots, if applicable, as well as details about compensation (if any)? ", "page_idx": 29}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 29}, {"type": "text", "text": "Justification: Our work does not involve crowd sourcing or research with human subjects. Guidelines: ", "page_idx": 29}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Including this information in the supplemental material is fine, but if the main contribution of the paper involves human subjects, then as much detail as possible should be included in the main paper.   \n\u2022 According to the NeurIPS Code of Ethics, workers involved in data collection, curation, or other labor should be paid at least the minimum wage in the country of the data collector. ", "page_idx": 29}, {"type": "text", "text": "15. Institutional Review Board (IRB) Approvals or Equivalent for Research with Human Subjects ", "text_level": 1, "page_idx": 29}, {"type": "text", "text": "Question: Does the paper describe potential risks incurred by study participants, whether such risks were disclosed to the subjects, and whether Institutional Review Board (IRB) approvals (or an equivalent approval/review based on the requirements of your country or institution) were obtained? ", "page_idx": 29}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 29}, {"type": "text", "text": "Justification: Our work does not involve crowd sourcing or research with human subjects. Guidelines: ", "page_idx": 29}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Depending on the country in which research is conducted, IRB approval (or equivalent) may be required for any human subjects research. If you obtained IRB approval, you should clearly state this in the paper.   \n\u2022 We recognize that the procedures for this may vary significantly between institutions and locations, and we expect authors to adhere to the NeurIPS Code of Ethics and the guidelines for their institution. ", "page_idx": 29}, {"type": "text", "text": "\u2022 For initial submissions, do not include any information that would break anonymity (if applicable), such as the institution conducting the review. ", "page_idx": 30}]