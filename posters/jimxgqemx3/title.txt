AMOR: A Recipe for Building Adaptable Modular Knowledge Agents Through Process Feedback