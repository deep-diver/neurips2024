[{"type": "text", "text": "RegExplainer: Generating Explanations for Graph Neural Networks in Regression Tasks ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Jiaxing Zhang1, Zhuomin Chen2, Hao Mei3, Longchao $\\mathbf{Da}^{3}$ , Dongsheng $\\mathbf{Luo}^{2}$ , Hua Wei3 1New Jersey Institute of Technology, 2Florida International University, 3Arizona State University $^1\\mathrm{j}z48\\textcircled{\\alpha}$ njit.edu, 2{zchen051, dluo} $@$ fiu.edu, 3{hmei7, longchao, hua.wei} $@$ asu.edu ", "page_idx": 0}, {"type": "text", "text": "Abstract ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Graph regression is a fundamental task that has gained significant attention in various graph learning tasks. However, the inference process is often not easily interpretable. Current explanation techniques are limited to understanding Graph Neural Network (GNN) behaviors in classification tasks, leaving an explanation gap for graph regression models. In this work, we propose a novel explanation method to interpret the graph regression models (XAIG-R). Our method addresses the distribution shifting problem and continuously ordered decision boundary issues that hinder existing methods away from being applied in regression tasks. We introduce a novel objective based on the graph information bottleneck theory (GIB) and a new mix-up framework, which can support various GNNs and explainers in a model-agnostic manner. Additionally, we present a self-supervised learning strategy to tackle the continuously ordered labels in regression tasks. We evaluate our proposed method on three benchmark datasets and a real-life dataset introduced by us, and extensive experiments demonstrate its effectiveness in interpreting GNN models in regression tasks. ", "page_idx": 0}, {"type": "text", "text": "1 Introduction ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Graph Neural Networks [1] (GNNs) have become a powerful tool for learning knowledge from graphstructure data and achieved remarkable performance in many areas, including social networks [2, 3], molecular structures [4, 5], traffic flows [6\u20139], and recommendation systems [10\u201312]. Despite the success, their popularity in sensitive fields such as fraud detection and drug discovery [13, 14] requires an understanding of their decision-making processes. To address this challenge, some efforts have been made to explain GNN\u2019s predictions in a post-hoc manner, which aims to find a sub-graph that preserves the information about the predicted label. On top of the intuitive principle, Graph Information Bottleneck (GIB) [15, 16] maximizes the mutual information $I(G^{*};Y)$ between the target prediction label $Y$ and the explanation $G^{*}$ while constraining the size of the explanation. ", "page_idx": 0}, {"type": "text", "text": "However, existing methods focus on the explanation of the classification tasks, leaving another fundamental task, explainable regression, unexplored. Graph regression tasks exist widely in nowadays applications, such as predicting the molecular property [17] or traffic flow volume [18]. Explaining the instance-level predictions of graph regression is challenging due to two main obstacles. First, in the routinely adopted GIB framework, the mutual information between the explanation sub-graph and label, $I(G^{*};Y)$ , is estimated with the Cross-Entropy between the predictions $f(G^{*})$ from GNN model $f$ and its prediction label $Y$ . However, in the regression task, the regression label is the continuous value, making the approximation unsuitable. Another challenge is the distribution shifting problem in the usage of $f(G^{*})$ , where the prediction of the explanation sub-graph made by the GNN model $f$ is unsafe. Usually, explanation sub-graphs have different topology and feature information compared to the original graph. As a result, explanation sub-graphs are out-of-distribution of the original training graph dataset [19\u201321]. As shown in Figure 1, a GNN model $f$ is trained on the original graph training set and cannot be safely used to make predictions for sub-graphs. ", "page_idx": 0}, {"type": "text", "text": "", "page_idx": 1}, {"type": "text", "text": "To fill the gap, in this paper, we propose RegExplainer, to generate post-hoc instancelevel explanations for graph regression tasks. Specifically, we formulate a theoretical-sound objective for explainable regression based on information theory. To further address the distribution shifting issue, RegExplainer develops a new mix-up approach with self-supervised learning. Our experiments show that RegExplainer provides consistent and concise explanations of GNN\u2019s predictions on regression tasks. We achieved up to $48.0\\%$ improvement when compared to the alternative baselines in our experiments. Our contributions can be summarized as follows. ", "page_idx": 1}, {"type": "text", "text": "\u2022 To our best knowledge, we are the first to explain GNN predictions on graph regression tasks. We addressed two challenges in explaining the graph regression task: the mutual information estimation in the GIB objective and the distribution shifting problem with continuous decision boundaries. ", "page_idx": 1}, {"type": "image", "img_path": "ejWvCpLuwu/tmp/68fb8848b82dd90bf104a3a1595ff6bb25017a5a42eb60507c3acb821868de35.jpg", "img_caption": [], "img_footnote": [], "page_idx": 1}, {"type": "text", "text": "Figure 1: Intuitive illustration of the distribution shifting problem. The 3-dimensional map represents a trained GNN model $f$ , where $(h_{1},h_{2})$ represents the embedding distribution of the graph in two dimensions, and $Y$ represents the prediction value of the graph through $f$ . The red and blue lines represent the distribution of the original training graph set and the corresponding explanation sub-graph set, respectively. The distribution of $G^{*}$ shifts away from the original distribution, resulting in shifted prediction values. ", "page_idx": 1}, {"type": "text", "text": "\u2022 We proposed a novel model with selfsupervised learning and the mix-up approach, ", "page_idx": 1}, {"type": "text", "text": "which can address the two challenges more effectively, and better explain the graph model on the regression tasks compared to other baselines. ", "page_idx": 1}, {"type": "text", "text": "\u2022 We designed three synthetic datasets, namely BA-Motif-Volume, BA-Motif-Counting and Triangles, as well as a real-world dataset called Crippen, which can also be used in future works, to evaluate the effectiveness of our regression task explanations. Comprehensive empirical studies on both synthetic and real-world datasets demonstrate that our method can provide consistent and concise explanations for graph regression tasks. ", "page_idx": 1}, {"type": "text", "text": "2 Related Work and Further Discussions ", "text_level": 1, "page_idx": 1}, {"type": "text", "text": "GNN Explainability The explanation methods for GNN models can be categorized into two types based on their granularity: instance-level [22\u201325] and model-level [26], where the former methods explain the prediction for each instance by identifying important sub-graphs, and the latter method aims to understand the global decision rules captured by the GNN. These methods can also be classified into two categories based on their methodology: self-explainable GNNs [27, 28] and post-hoc explanation methods [23\u201325], where the former methods provide both predictions and explanations, while the latter methods use an additional model or strategy to explain the target GNN. Additionally, CGE [29] (cooperative explanation) generates the sub-graph explanation with the sub-network simultaneously, by using cooperative learning. However, it has to treat the GNN model as a white box, which is usually unavailable in the post-hoc explanation. Existing methods have only partially addressed the explanation of graph regression tasks and have not fully considered two important challenges: the distribution shifting problem and the limitations of the GIB objective, both of which are key areas our work aims to tackle. ", "page_idx": 1}, {"type": "text", "text": "GIB Objective The Information Bottleneck (IB) [30, 31] provides an intuitive principle for learning dense representations that an optimal representation should contain sufficient information for the downstream prediction task with a minimal size. Based on IB, a recent work [32] unifies the most existing post-hoc explanation methods for GNN, such as GNNExplainer [23], PGExplainer [24], with the graph information bottleneck (GIB) principle [15, 16, 32]. Formally, the objective of explaining ", "page_idx": 1}, {"type": "text", "text": "the prediction of $f$ on $G$ can be represented by ", "page_idx": 2}, {"type": "equation", "text": "$$\n\\operatorname*{arg\\,min}_{G^{*}}I(G;G^{*})-\\alpha I(G^{*};Y),\n$$", "text_format": "latex", "page_idx": 2}, {"type": "text", "text": "where $G$ is the to-be-explained original graph, $G^{*}$ is the explanation sub-graph of $G,\\,Y$ is the original ground-truth label of $G$ , and $\\alpha$ is a hyper-parameter to get the trade-off between minimal and sufficient constraints. GIB uses the mutual information $I(G;{\\bar{G}}^{*})$ to select the minimal explanation that inherits only the most indicative information from $G$ to predict the label $Y$ by maximizing $I(G^{*};Y)$ , where $I(G;G^{*})$ avoids imposing potentially biased constraints, such as the size or the connectivity of the selected sub-graphs [15]. Through the optimization of the sub-graph, $G^{*}$ provides model interpretation. In graph classification task, a widely-adopted approximation to Eq. (1) in previous methods [23, 24] is: ", "page_idx": 2}, {"type": "equation", "text": "$$\n\\underset{G^{*}}{\\arg\\operatorname*{min}}I(G;G^{*})+\\alpha H(Y|G^{*})\\approx\\underset{G^{*}}{\\arg\\operatorname*{min}}I(G;G^{*})+\\alpha\\mathrm{CE}(Y,Y^{*}),\n$$", "text_format": "latex", "page_idx": 2}, {"type": "text", "text": "where $Y$ and $Y^{*}$ , approximated by $f(G)$ and $f(G^{*})$ , is the predicted label of $G$ and $G^{*}$ made by the to-be-explained model $f$ , and the cross-entropy $\\mathrm{CE}(Y,Y^{*})$ between $Y$ and $Y^{*}$ is used to approximate $-I(G^{*};Y)$ . The approximation is based on the definition of mutual information $I(G^{*};Y)=H(Y)-H(Y|G^{*})$ : with entropy $H(Y)$ being static and independent of the explanation process, minimizing the mutual information between the explanation sub-graph $G^{*}$ and $Y$ can be reformulated as maximizing the conditional entropy of $Y$ given $G^{*}$ , which can be approximated by $\\mathrm{CE}(Y,Y^{*})$ . ", "page_idx": 2}, {"type": "text", "text": "3 Preliminary ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "Notation and Problem Formulation We use $G=(\\mathcal{V},\\mathcal{E};\\boldsymbol{X},\\boldsymbol{A})$ to represent a graph from an alphabet $\\mathcal{G}$ , where $\\nu$ equals to $\\{v_{1},v_{2},...,v_{n}\\}$ represents a set of $n$ nodes and $\\mathcal{E}\\in\\mathcal{V}\\times\\mathcal{V}$ represents the edge set. Each graph has a feature matrix $\\pmb{X}\\in\\mathbb{R}^{n\\times d}$ for the nodes, wherein $\\mathbf{\\deltaX}$ , $X_{i}\\in\\mathbb{R}^{1\\times d}$ is the $d$ -dimensional node feature of node $v_{i}$ . $\\mathcal{E}$ is described by an adjacency matrix $A\\in\\{0,1\\}^{n\\times n}$ , where $A_{i j}=1$ means that there is an edge between node $v_{i}$ and $v_{j}$ ; otherwise, $A_{i j}=0$ . For the graph prediction task, each graph $G_{k}$ has a label $Y_{k}\\in{\\mathcal{C}}$ , where $k\\overset{..}{\\in}\\{1,...,N\\}$ , $N$ represents the number of graphs in the dataset, $\\mathcal{C}$ is the set of the classification categories or regression values in $\\mathbb{R}$ , with a GNN model $f$ trained to make the prediction, i.e., $f:(X,A)\\mapsto{\\mathcal{C}}$ . ", "page_idx": 2}, {"type": "text", "text": "Problem 1 (Post-hoc Instance-level GNN Explanation). Given a trained GNN model $f_{;}$ , for an arbitrary input graph $G=(\\mathcal{V},\\mathcal{E};X,A),$ , the goal of post-hoc instance-level GNN explanation is to find a sub-graph $G^{*}$ that can explain the prediction of $f$ on $G$ . ", "page_idx": 2}, {"type": "text", "text": "In non-graph structured data, the informative feature selection has been well studied [33], as well as in traditional methods, such as concrete auto-encoder [34], which can be directly extended to explain features in GNNs. In this paper, we focus on discovering the important sub-graph typologies following the previous work [23, 24]. Specifically, the obtained explanation $G^{*}$ is depicted by a binary mask $\\bar{M}^{*}\\in\\{0,1\\}^{n\\times n}$ on the adjacency matrix, e.g., $G^{*}=(\\mathcal{V},\\mathcal{E};X,A\\odot M^{*})$ , $\\odot$ means elements-wise multiplication. The mask highlights components of $G$ which are essential for $f$ to make the prediction. ", "page_idx": 2}, {"type": "text", "text": "4 Methodology ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "In this section, we first introduce a new objective based on GIB for explaining graph regression tasks. Then we showcase the distribution shifting problem in the objective for regression and propose a novel framework with the mix-up approach to solve the distribution shifting problem, by incorporating the mix-up approach with self-supervised contrastive learning. ", "page_idx": 2}, {"type": "text", "text": "4.1 GIB for Explaining Graph Regression ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "As introduced in Section 2, in the classification task, $I(G^{*};Y)$ in Eq. (1) is commonly approximated by cross-entropy $\\mathrm{CE}(Y^{*},Y)$ [35]. However, it is non-trivial to extend it for regression tasks because $Y$ is a continuous variable and it is intractable to compute the cross-entropy $\\mathrm{CE}(Y^{*},Y)$ or the mutual information $I(G^{*};Y)$ , where $G^{*}$ is a graph variable with a continuous variable $Y^{*}$ as its label. ", "page_idx": 2}, {"type": "text", "text": "4.1.1 Optimizing the Lower Bound of $I(G^{*};Y)$ ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "To address the challenge of computing the mutual information $I(G^{*};Y)$ with a continuous $Y$ , we propose a novel objective for explaining graph regression. ", "page_idx": 3}, {"type": "text", "text": "Instead of minimizing $I(G^{*};Y)$ directly, we propose to maximize a lower bound for the mutual information by including the prediction label of $G^{*}$ , denoted by $Y^{*}$ , and approximate $I(G^{*};Y)$ in Eq. (1) with $\\bar{I(Y^{*};Y)}$ : ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\operatorname*{arg\\,min}_{G^{*}}I(G;G^{*})-\\alpha I(Y^{*};Y).\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "$I(Y^{*};Y)$ has the following property, upon which we can approximate Eq. (2): ", "page_idx": 3}, {"type": "text", "text": "Property 1 $I(Y^{*};Y)$ is a lower bound of $I(G^{*};Y)$ . ", "page_idx": 3}, {"type": "text", "text": "Intuitively, the property of $I(Y^{*};Y)$ is guaranteed by the chain rule for mutual information and the independence between each explanation instance $g^{*}$ in $G^{*}$ . An intuitive demonstration is shown in Figure 2. The proof is shown in the Appendix B.1. ", "page_idx": 3}, {"type": "image", "img_path": "ejWvCpLuwu/tmp/c957a2e00a77c5d881b98ba567fc9c1d4106f621c9f03623f001b3b55ec92484.jpg", "img_caption": [], "img_footnote": [], "page_idx": 3}, {"type": "text", "text": "4.1.2 Estimating $I(Y^{*};Y)$ with InfoNCE ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "Now the challenge becomes the estimation of the mutual information $I(Y^{*};Y)$ . Inspired by the model of Contrastive Predictive Coding [36], in which InfoNCE loss is interpreted as a mutual information estimator, we further adapt the objective function so that it can be applied with ", "page_idx": 3}, {"type": "text", "text": "Figure 2: Intuitive illustration about why $I(G^{*};Y)~\\geq~I(Y^{*};Y)$ . $G^{*}$ contains more mutual information as having more overlapping area with $Y$ than the overlapping area between $Y^{*}$ and $Y$ . ", "page_idx": 3}, {"type": "text", "text": "InfoNCE loss in explaining graph regression. In our graph explanation scenario, the InfoNCE Loss defined in Eq. (3) can also be utilized as a lower bound of ${\\bar{I}}(Y^{*};Y)$ , as shown in the following property with proofs: ", "page_idx": 3}, {"type": "text", "text": "Property 2 InfoNCE Loss is a lower bound of the $I(Y^{*};Y)$ : ", "page_idx": 3}, {"type": "equation", "text": "$$\nI(Y^{*};Y)\\ge\\mathbb{E}\\left[\\log\\frac{\\sin{(Y^{*},Y)}}{\\frac{1}{|\\mathbb{Y}|}\\sum_{Y^{\\prime}\\in\\mathbb{Y}}\\sin{(Y^{*},Y^{\\prime})}}\\right],\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "where $Y^{\\prime}$ is the prediction label of the randomly sampled graph neighbors, $\\mathbb{Y}$ is the set of the neighbors\u2019 prediction labels, and $\\dim()$ estimates the similarity between $Y^{*}$ and $Y$ . The proof is shown in the Appendix B.2. Therefore, we have the InfoNCE loss $\\mathcal{L}_{\\mathrm{NCE}}$ as the lower bound of the $I(Y^{*};Y)$ . We approximate Eq. (2) as: ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\underset{G^{*}}{\\arg\\operatorname*{min}}\\,I(G;G^{*})-\\alpha\\underset{\\mathbb{Y}}{\\mathbb{E}}\\left[\\log\\frac{\\sin\\left(Y^{*},Y\\right)}{\\frac{1}{\\vert\\mathbb{Y}\\vert}\\sum_{Y^{\\prime}\\in\\mathbb{Y}}\\sin\\left(Y^{*},Y^{\\prime}\\right)}\\right].\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "4.2 Distribution Shifting Problem in Graph Regression ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "We include the prediction label $Y^{*}$ in Eq. (4) to estimate similarity, which is approximated with $f(G^{*})$ in previous work [23, 24]. However, we argue that $f(G^{*})$ cannot be safely obtained due to the distribution shift problem [37, 19]. In classification tasks, a small shift may not cross the decision boundaries, which can still lead to a correct prediction. However, due to the continuous decision boundaries in regression, the distribution problem would cause serious prediction errors. Here in this paper, the graph distribution is indicated by its regression label in the regression task. ", "page_idx": 3}, {"type": "text", "text": "Figure 3 shows the existence of distribution shifts between $f(G^{*})$ and $f(G)$ in graph regression tasks. For each dataset, we sort the indices of the data samples according to the value of their labels, and visualize the label $Y$ , prediction $f(G)$ of the original graph from the trained GNN model $f$ , and prediction $f(G^{*})$ of the explanation sub-graph $G^{*}$ from $f$ . As we can see in Figure 3, in all four graph regression datasets, the red points are well distributed around the ground-truth blue points, indicating that $f(G)$ is close to $Y$ . In comparison, the green points shift away from the red points, indicating the shifts between $f(G^{*})$ and $f(G)$ . Especially in dataset BA-Motif-Counting, the sub-graph explanation distribution was shifted extremely. ", "page_idx": 3}, {"type": "image", "img_path": "ejWvCpLuwu/tmp/359fe3953724e2845fc91645a51b7e4b9a67493e9058242ab38fea994a282aa4.jpg", "img_caption": ["Figure 3: Visualization of distribution shifting problem on four graph regression datasets. The points represent the regression value, where the blue points mean ground truth label $Y$ , red points mean prediction $f(G)$ , and the green points mean prediction $f(G^{*})$ on the four datasets. The $\\mathbf{X}_{\\mathrm{}}$ -axis is the indices of the graph, sorted by the value of the label $Y$ . "], "img_footnote": [], "page_idx": 4}, {"type": "text", "text": "Intuitively, this phenomenon indicates the GNN model $f$ can make correct predictions only with the original graph $G$ yet can not predict the explanation sub-graph $G^{*}$ correctly. This is because the GNN model $f$ is trained with the original graph sets, whereas the explanation $G^{*}$ as the sub-graph is different from the original graph sets. With the shift between $f(G)$ and $f(G^{*})$ , the optimal solution in Eq. (4) is unlikely to work well. ", "page_idx": 4}, {"type": "text", "text": "4.3 Mix-up Approach with Contrastive Learning ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "To address this distribution-shifting problem in graph regression, we innovatively incorporate the mix-up approach with a self-supervised contrastive learning strategy. Instead of calculating $Y^{*}$ with $f(G^{*})$ directly, we approximate with $Y^{(\\mathrm{mix})}$ from $f(G^{(\\mathrm{mix})})$ , which contains similar information as $G^{*}$ but is in the same distribution with $G$ . Specifically, our approach includes the following steps: ", "page_idx": 4}, {"type": "text", "text": "\u2022 Step 1 (Neighbor Sampling): Learning through the triplet instances can effectively reinforce the ability of the explainer to learn the explanation self-supervised. For each target graph $G$ with label $Y$ to be explained, we can define two randomly sampled graphs as positive neighbor $G^{+}$ and negative neighbor $G^{-}$ , where $G^{+}$ \u2019s label $Y^{+}$ is closer to $Y$ than $G^{-}$ \u2019s label $Y^{-}$ , i.e., $|\\bar{Y}^{+}-Y|<|Y^{-}-\\bar{Y}|$ . Intuitively, the distance between the distributions of the positive pair $\\langle G,G^{+}\\rangle$ should be smaller than the distance between the distributions of the negative pair $\\langle G,G^{-}\\rangle$ . ", "page_idx": 4}, {"type": "text", "text": "\u2022 Step 2 (Mixup for $G^{*}$ ): Then we generate two mixup graphs $G^{(\\mathrm{mix})+}$ and $G^{\\mathrm{(mix)-}}$ by mixing the sub-graph explanation $G^{*}$ with the label irrelevant sub-graph $(G^{+})^{\\Delta}=G^{+}-(G^{+})^{*}$ from its positive neighbor $G^{+}$ and the label irrelevant sub-graph $(G^{-})^{\\Delta}\\,=\\,\\dot{G}^{-}\\,-\\,(G^{-})^{*}$ from negative neighbor $G^{-}$ respectively. Specifically, the label mixup approach is calculated from: ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\frac{\\gamma(\\operatorname*{min})+}{\\gamma}=G^{*}+(G^{+})^{\\Delta}=G^{*}+(G^{+}-(G^{+})^{*}),G^{(\\operatorname*{min})-}=G^{*}+(G^{-})^{\\Delta}=G^{*}+(G^{-}-(G^{-})^{*}).}\\end{array}\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "$G^{(\\mathrm{mix})+}$ and $G^{\\mathrm{(mix)-}}$ should have the similar information to $G$ because they have the same labelpreserving sub-graphs $G^{*}$ . Additionally, considering the following two pairs: $(G^{(\\operatorname*{mix})+},G^{+})$ and $\\tilde{(G}^{\\mathrm{(mix)-}},\\tilde{G}^{-})$ . The similarity between $\\left\\langle G^{\\mathrm{(mix)+}},G^{+}\\right\\rangle$ should be larger than the similarity between $\\left(G^{\\mathrm{(mix)-}},G^{-}\\right)$ . Intuitively, since $G^{\\mathrm{(mix)+}}$ and $G^{\\mathrm{(mix)-}}$ have the same label-preserving sub-graphs $G^{*}$ and $|Y^{-}-Y|>|Y^{+}-Y|$ , we can have $|f(G^{-})-f(G^{\\mathrm{(mix)-}})|>|f(\\mathring{G}^{+})-f(\\mathring{G}^{\\mathrm{(mix)+}})|$ , where $f(G)$ represents the prediction label of graph $G$ . ", "page_idx": 4}, {"type": "text", "text": "\u2022 Step 3 (InfoNCE Loss Approximation): Then we can safely estimate the similarity with $\\mathrm{sim}(\\bar{Y}^{\\mathrm{(mix)}},Y)$ . To save more information, we use the similarity of representation embedding to approximate the similarity of the graph prediction label, where $\\bar{h^{\\mathrm{(mix)}}}$ represents the embedding for $\\bar{G}^{(\\mathrm{mix})}$ and $^h$ represents the embedding for $G$ . We use $\\mathbb H$ to represent the neighbors set accordingly. Thus, we approximate Eq. (4) as: ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\operatorname*{arg\\,min}_{G^{*}}I(G;G^{*})-\\alpha\\mathbb{E}\\left[\\log\\frac{\\sin\\left(h^{(\\operatorname*{mix})},h\\right)}{\\frac{1}{\\left|\\mathbb{H}\\right|}\\sum_{\\pmb{h}^{\\prime}\\in\\mathbb{H}}\\sin\\left(h^{(\\operatorname*{mix})},h^{\\prime}\\right)}\\right].\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "Different between Mix-up Approach in Classification Tasks The mix-up approach in previous work [19] generates a mixed graph by simply mixing explanation sub-graph $G^{*}$ with a randomly sampled label-irrelevant sub-graph $G^{\\Delta}$ [19], which can be formally written as $G_{a}^{\\mathrm{(mix)}}=G_{a}^{*}+(G_{b}\\;\\dot{-}$ ", "page_idx": 4}, {"type": "image", "img_path": "ejWvCpLuwu/tmp/bfa4272b6bb6adaea37c2bdd763d962af5d8b3024c57d1f69207ce261d41a73c.jpg", "img_caption": ["Figure 4: Illustration of RegExplainer. $G$ is the to-be-explained graph, $G^{+}$ and $G^{-}$ are the randomly sampled positive and negative neighbors. The explanation of the graph is produced by the explainer model. Then graph $G^{*}$ is mixed with $(G^{+})^{\\Delta}=\\dot{G^{+}}\\!-\\!(G^{+})^{*}$ and $(\\bar{G}^{-})^{\\Delta}=G^{-}\\!-(G^{-})^{*}$ respectively to produce $\\tilde{G^{\\mathrm{(mix)+}}}$ and $G^{\\mathrm{(mix)-}}$ . Then the graphs are fed into the trained GNN model to retrieve the embedding vectors $h^{+}$ , $h^{-}$ , $h^{\\mathrm{(mix)+}}$ and $\\bar{h}^{\\mathrm{(mix)-}}$ , where $h^{(\\mathrm{mix})+}\\,\\approx\\,h^{(\\mathrm{mix})-}$ due to the same label-preserving sub-graph $G^{*}$ . We use InfoNCE loss to minimize the distance between $G^{(\\mathrm{mix})+}$ and the positive sample and maximize the distance between $G^{\\mathrm{(mix)-}}$ and the negative sample. The explainer is trained with the GIB objective and self-supervised contrastive loss. "], "img_footnote": [], "page_idx": 5}, {"type": "text", "text": "$G_{b}^{*})$ . However, it cann\u2019t tackle the continuous decision boundaries in graph regression tasks. A detailed description of the mix-up approach can be found in Appendix C. ", "page_idx": 5}, {"type": "text", "text": "4.4 Implementation ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "InfoNCE Loss After generating the mix-up explanation $G^{(\\mathrm{mix})}$ , we specify the InfoNCE loss to further train the parameterized explainer with a triplet of graphs $\\langle G,G^{+},G^{-}\\rangle$ . In practice, $G^{+}$ and $G^{-}$ are randomly sampled from the graph dataset, upon which we calculate their similarity score with the target graph $G$ . The sample with a higher score would be the positive sample and the other one would be the negative sample. Specifically, we use $\\sin(h,h^{\\prime})=h^{\\dagger}h^{\\prime}$ to compute the similarity score, where $G^{\\prime}$ can be $G^{+}$ or $G^{-}$ . $^h$ is generated by feeding $G$ into the GNN model $f$ and retrieving the embedding vector before the dense layers. ", "page_idx": 5}, {"type": "text", "text": "Formally, given a target graph $G$ , the sampled positive graph $G^{+}$ and negative graph $G^{-}$ , we formulate the InfoNCE loss in Eq. (5) as the following: ", "page_idx": 5}, {"type": "equation", "text": "$$\n\\mathcal{L}_{\\mathrm{NCE}}(G,G^{+},G^{-})=-\\log\\frac{\\exp((h^{(\\mathrm{mix})+})^{\\top}h)}{\\exp((h^{(\\mathrm{mix})+})^{\\top}h^{+})+\\exp((h^{(\\mathrm{mix})-})^{\\top}h^{-})},\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "where $\\exp(h^{\\top}h)$ is used to instantiate the function sim, the denominator is a sum over the similarities of both positive and negative samples. ", "page_idx": 5}, {"type": "text", "text": "Size Constraints We optimize $I(G;G^{*})$ in Eq. (5) to constraint the size of the explanation subgraph $G^{*}$ . The upper bound of $I(G;G^{*})$ is optimized as the estimation of the KL-divergence between the probabilistic distribution between the $G^{*}$ and $G$ , where the KL-divergence term can be divided into two parts as the entropy loss and size loss [16]. In practice, we follow the previous work [23, 24, 38] to implement them. Specifically, ", "page_idx": 5}, {"type": "equation", "text": "$$\n\\mathcal{L}_{\\mathrm{size}}(G,G^{*})=\\gamma\\sum_{(i,j)\\in\\mathcal{E}}(M_{i j}^{*})-\\log\\sigma((h^{*})^{\\top}h^{*}),\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "where $\\sum_{i,j)\\in\\mathcal{E}}(M_{i j}^{*})$ means sum the weights of the existing edges in the edge weight mask $M^{*}$ for the explanation $G^{*};h^{*}$ is extracted from the embedding of the graph $G^{*}$ before the GNN model $f$ transforming it into prediction $Y^{*}$ , $\\sigma$ means the sigmoid function and $\\gamma$ is the weight for the size of the masked graph. In implementation, we set $\\gamma=(0.0003,0.3)$ following previous work [19]. ", "page_idx": 5}, {"type": "text", "text": "", "page_idx": 5}, {"type": "text", "text": "Overall Objective Function In practice, the denominator in Eq. (5) works as a regularization to avoid trivial solutions. Since the label $Y$ is given and independent of the optimization process, we can also employ the MSE loss between $Y^{*}$ and $Y$ additionally, regarding InfoNCE loss only estimates the ", "page_idx": 5}, {"type": "text", "text": "Table 1: Illustration of the graph regression datasets together with the explanation faithfulness in terms of AUC-ROC on edges under four datasets on RegExplainer and other baselines. The original graph row visualizes the structure of the complete graph, the explanation row highlights the explanation sub-graph of the corresponding original graph. In the Crippen dataset, different colors of the node represent different kinds of atoms and the node feature is a one-hot vector to encode the atom type. ", "page_idx": 6}, {"type": "table", "img_path": "ejWvCpLuwu/tmp/63de59902cd865349e24eba14f77292024772a9be641bd1260f89917111669a9.jpg", "table_caption": [], "table_footnote": [], "page_idx": 6}, {"type": "text", "text": "mutual information between the embeddings. Formally, the overall loss function can be implemented as: ", "page_idx": 6}, {"type": "text", "text": "$G^{(\\mathrm{mix})+}$ means mix $G^{*}$ with the positive sample $G^{+}$ and $\\alpha$ and $\\beta$ are hyper-parameters. The training algorithm and description of it are put in Appendix D. ", "page_idx": 6}, {"type": "text", "text": "5 Experiments ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "In this section, we conduct experiments to demonstrate the performance of our proposed method1. These experiments are mainly designed to explore the following research questions: ", "page_idx": 6}, {"type": "text", "text": "\u2022 RQ1: Can RegExplainer outperforms other baselines in explaining GNNs on regression tasks? ", "page_idx": 6}, {"type": "text", "text": "\u2022 RQ2: How does each part of RegExplainer and hyperparameters impact the overall performance in generating explanations? ", "page_idx": 6}, {"type": "text", "text": "\u2022 RQ3: Does the distribution shifting exist in GNN explanation? Can RegExplainer alleviate it? ", "page_idx": 6}, {"type": "text", "text": "5.1 Experiment Settings ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "We formulate Three synthetic datasets and a real-world dataset, as is shown in Table 1, in order to address the lack of graph regression datasets with ground-truth explanation. The datasets include: BA-Motif-Volume and BA-Motif-Counting, which are based on BA-shapes [23], Triangles [39], and Crippen [40]. We compared the proposed RegExplainer against a comprehensive set of baselines in all datasets, including: GRAD [23], ATT [41], GNNExplainer [23], PGExplainer [24], and MixupExplainer [19]. Detailed information about experiment setting are put in the Appendix E. We elaborate on the measurement metric of methods as follows: (1) AUC-ROC: We use the AUC score to evaluate the performance of our proposed methods against baseline methods regarding the ground-truth explanation, which can be treated as a binary classification task. (2) We evaluate the similarity of distribution of the graph with Cosine Similarity and Euclidean Distance. ", "page_idx": 6}, {"type": "text", "text": "5.2 Quantitative Evaluation (RQ1) ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "In this section, we evaluate the performance of our approach with other baselines. For GRAD and GAT, we use the gradient-based and attention-based explanation, following the setting in the previous work [23]. We take GCN as our to-be-explained model for all post-hoc explainers. For GNNExplainer, PGExplainer, and MixupExplainer, which were previously used for the classification task, we replace the Cross-Entropy loss with the MSE loss. We run and tune all the baselines on our four datasets. We evaluate the explanation from all the methods with the AUC metric, as done in the previous work. As we can see in Table 1, we take GNNExplainer and PGExplainer as backbones and apply our framework as RegExplainer on both of them. The experiment results demonstrate the effectiveness of our methods in explaining graph regression tasks, where our method achieves the best performance compared to the baselines in all four datasets. ", "page_idx": 6}, {"type": "text", "text": "", "page_idx": 7}, {"type": "text", "text": "In Table 1, RegExplainer based on PGExplainer improves the second best baseline with $0.175/34.3\\%$ on average and up to $0.246/48.0\\%$ . The comparison between RegExplainer and other baselines indicates the advantages of our proposed approach. This improvement indicates the effectiveness of our proposed method, showing that by incorporating the mix-up approach and contrastive learning, we can generate more faithful explanations in the graph regression tasks. In the following sections, we analyze the RegExplainer with PGExplainer as a backbone. ", "page_idx": 7}, {"type": "text", "text": "5.3 Ablation Study and Hyper-parameter Sensitivity Study (RQ2) ", "text_level": 1, "page_idx": 7}, {"type": "text", "text": "We conducted an ablation study to show how our proposed components, specifically, the mixup approach and self-supervised learning, contribute to the final performance of RegExplainer. To this end, we denote RegExplainer as RegE and design three types of variants as follows: (1) $\\mathrm{RegE^{-mix}}$ : We remove the mix-up processing after generating the explanations and feed the sub-graph $G^{*}$ into the objective function directly. (2) $\\bar{\\mathbf{R}}\\mathrm{egE^{-nce}}$ : We remove the InfoNCE loss term but still maintain the mix-up processing and MSE loss. (3) $\\mathrm{RegE^{-mse}}$ : We remove the MSE loss computation item from the objective function. ", "page_idx": 7}, {"type": "text", "text": "Additionally, we set all variants with the same configurations as original RegExplainer, including learning rate, training epochs, and hyperparameters $\\eta,\\,\\alpha,$ , and $\\beta$ . We trained them on all four datasets and conducted the results in Fig", "page_idx": 7}, {"type": "text", "text": "Figure 5: Ablation study of RegExplainer. We evaluated the AUC performance of the original RegExplainer and its variants that exclude the mixup approach, InfoNCE loss, or MSE loss, respectively. The black solid line shows the standard deviation. ", "page_idx": 7}, {"type": "image", "img_path": "ejWvCpLuwu/tmp/e6c24f0cc358cd0b3d8d5b38784b5c69d7dff9d2235ef36693811445116a8b0e.jpg", "img_caption": [], "img_footnote": [], "page_idx": 7}, {"type": "text", "text": "ure 5. We observed that the proposed RegExplainer outperforms its variants in all datasets, which indicates that each component is necessary and the combination of them is effective. ", "page_idx": 7}, {"type": "text", "text": "We also investigate the hyper-parameters of our approach, which include $\\alpha$ and $\\beta$ , across all four datasets. The hyper-parameter $\\alpha$ controls the weight of the InfoNCE loss in the GIB objective while the $\\beta$ controls the weight of the MSE loss. We determined the optimal values of $\\alpha$ and $\\beta$ with grid search. The experimental results can be found in Figure 6. We fixed $\\alpha$ and $\\beta$ at 1 and changed another parameter to visualize the change in model performance. Figure 6 illustrates that the model\u2019s performance is robust to changes in hyper parameters within the scope [0.001, 1000]. Our findings indicate that our approach, RegExplainer, is stable and robust when using different hyper-parameter settings, as evidenced by consistent performance across a range. ", "page_idx": 7}, {"type": "text", "text": "Figure 6: Hyper-parameters study of $\\alpha$ and $\\beta$ on four datasets with RegExplainer. In both figures, the x-axis is the value of different hyper-parameter settings, and the y-axis is the value of the average AUC score over ten runs with different random seeds. ", "page_idx": 7}, {"type": "image", "img_path": "ejWvCpLuwu/tmp/76f57762d0e8f1b0421a4d908a299cd4bd8f54d138e38170e5179951be429e03.jpg", "img_caption": [], "img_footnote": [], "page_idx": 7}, {"type": "text", "text": "Table 2: Prediction shifting study on the RMSE of $(f(G),Y)$ , $(f(G^{*}),Y)$ , $(f(G),f(G^{*}))$ respectively. ", "page_idx": 8}, {"type": "table", "img_path": "ejWvCpLuwu/tmp/af92d6bf8730bb8b8cb7ea210030e6557af2d87d31a5a1c88658ad90309abbdc.jpg", "table_caption": [], "table_footnote": [], "page_idx": 8}, {"type": "text", "text": "5.4 Alleviating Distribution Shifts (RQ3) ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "In this section, we visualize the regression values of the graphs and calculate the prediction shifting distance for each dataset and analyze their correlations to the distance of the decision boundaries. We put our results into Figure 7 and Table 2. ", "page_idx": 8}, {"type": "text", "text": "We observed that in Figure 3, red points surround the blue points but green points are shifted away, which indicates that the explanation sub-graph cann\u2019t help GNNs make correct predictions. As shown in Table 2, we calculate the RMSE score between the $f(G)$ and $Y$ , $f(G^{*})$ and $Y$ , $f(G)$ and $f(G^{*})$ respectively, where $f(G)$ is the prediction the original graph, $f(G^{*}$ is the prediction of the explanation sub-graph, and $Y$ is the regression label. We can observe that $f(G^{*})$ shows a significant prediction shifting from $f(G)$ and $Y$ , indicating that the mutual information calculated with $(f(G^{*}),Y)$ would be biased. ", "page_idx": 8}, {"type": "text", "text": "We further explore the relationship of the prediction shifting against the label value with dataset BA-Motif-Volume, which represents the semantic decision boundary. This additional experiment with Figure 7 can be found in Appendix F.1. ", "page_idx": 8}, {"type": "text", "text": "We also design experiments to illustrate how RegExplainer corrects the deviations: we calculate the graph embeddings $v$ and predictions $p$ of the explanation sub-graphs and the mix-up graph. Then we compare them to the ground truth and calculate the Euclidean or Cosine distance between the vectors and RMSE between prediction labels. From the results in Table 3, we can observe that all the performances of $\\mathrm{COS}(v_{g},v_{m})$ , $\\mathrm{EUC}(v_{g},v_{m})$ and prediction errors are better than those of $(v_{g},v_{e})$ , which indicates RegExplainer can effectively fix the distribution of sub-graph explanation $G^{*}$ and reduce the embedding distance and prediction error. ", "page_idx": 8}, {"type": "text", "text": "Table 3: Table for measuring distribution repairing. $v_{g},\\,v_{e}$ and $v_{m}$ are the embeddings from $f$ of original graph $G$ , explanation subgraph $G^{*}$ and the mix-up explanation $G^{(\\mathrm{mix})+}$ . $p_{g},p_{e}$ and $p_{m}$ are the predicted labels for the original graph, explanation subgraph and the mix-up explanation. EUC means Euclidean distance ( $\\downarrow.$ , the smaller the better) and COS means cosine distance $\\uparrow$ , the larger the better). RMSE means Root Mean Square Error (\u2193, the smaller the better). ", "page_idx": 8}, {"type": "table", "img_path": "ejWvCpLuwu/tmp/6a2994cdb5729010f0b7933c85143981cc4c68d53ecbe001d23e3d343213dc19.jpg", "table_caption": [], "table_footnote": [], "page_idx": 8}, {"type": "text", "text": "6 Conclusion ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "We addressed the challenges in the explainability of graph regression tasks and proposed the RegExplainer, a novel method for explaining the predictions of GNNs with the post-hoc explanation sub-graph on graph regression task without requiring modification of the underlying GNN architecture or re-training. We showed how RegExplainer can leverage the mix-up approach to solve the distribution shifting problem and adopt the GIB objective with the InfoNCE loss to migrate it from graph classification tasks to graph regression tasks, while these existing challenges seriously affect the performances of other explainers. We formulated four new datasets: BA-Motif-Volume, BA-Motif-Counting, Triangles, and Crippen for evaluating the explainers on the graph regression task, which are aligned with the design of datasets in previous work. They can also benefit future studies on the XAIG-R. While we acknowledge the effectiveness of our method, we also recognize its limitations. Specifically, although our approach can be applied to explainers for graph regression tasks in an explainer-agnostic manner, it cannot be easily applied to explainers built for explaining the spatio-temporal graph due to the dynamic topology and node features of the STG. To overcome this challenge, a potential solution is to incorporate cached dynamic embedding memories into the framework. ", "page_idx": 8}, {"type": "text", "text": "", "page_idx": 9}, {"type": "text", "text": "7 Ethics Statement ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "This work is primarily foundational in GNN explainability, focusing on expanding the GIB objective function of the explainer framework from graph classification tasks to graph regression tasks. Its primary aim is to contribute to the academic community by enhancing the explanation in graph regression. We do not foresee any direct, immediate, or negative societal impacts stemming from the outcomes of our research. ", "page_idx": 9}, {"type": "text", "text": "8 Acknowledgments ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "The work was partially supported by NSF awards #2421839 and #2331908. The views and conclusions contained in this paper are those of the authors and should not be interpreted as representing any funding agencies. ", "page_idx": 9}, {"type": "text", "text": "References ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "[1] Franco Scarselli, Marco Gori, Ah Chung Tsoi, Markus Hagenbuchner, and Gabriele Monfardini. The graph neural network model. IEEE Transactions on Neural Networks, 20(1):61\u201380, 2009.   \n[2] Wenqi Fan, Yao Ma, Qing Li, Yuan He, Eric Zhao, Jiliang Tang, and Dawei Yin. Graph neural networks for social recommendation, 2019.   \n[3] Shengjie Min, Zhan Gao, Jing Peng, Liang Wang, Ke Qin, and Bo Fang. Stgsn \u2014 a spatial\u2013temporal graph neural network framework for time-evolving social networks. KnowledgeBased Systems, 214:106746, 2021.   \n[4] Hryhorii Chereda, Annalen Bleckmann, Frank Kramer, Andreas Leha, and Tim Beissbarth. Utilizing molecular network information via graph convolutional neural networks to predict metastatic event in breast cancer. In GMDS, pages 181\u2013186, 2019.   \n[5] E. Mansimov, O. Mahmood, and S. Kang. Molecular geometry prediction using a deep generative graph neural network, 2019.   \n[6] Xiaoyang Wang, Yao Ma, Yiqi Wang, Wei Jin, Xin Wang, Jiliang Tang, Caiyan Jia, and Jian Yu. Traffic flow prediction via spatial temporal graph neural network. In Proceedings of The Web Conference 2020, WWW $^{\\prime}20$ , page 1082\u20131092, New York, NY, USA, 2020. Association for Computing Machinery.   \n[7] Mengzhang Li and Zhanxing Zhu. Spatial-temporal fusion graph neural networks for traffic flow forecasting. Proceedings of the AAAI Conference on Artificial Intelligence, 35(5):4189\u20134196, May 2021.   \n[8] Zonghan Wu, Shirui Pan, Guodong Long, Jing Jiang, and Chengqi Zhang. Graph wavenet for deep spatial-temporal graph modeling. In Proceedings of the 28th International Joint Conference on Artificial Intelligence, IJCAI\u201919, page 1907\u20131913. AAAI Press, 2019.   \n[9] Bing Yu, Haoteng Yin, and Zhanxing Zhu. Spatio-temporal graph convolutional networks: A deep learning framework for traffic forecasting. In Proceedings of the Twenty-Seventh International Joint Conference on Artificial Intelligence, IJCAI-18, pages 3634\u20133640. International Joint Conferences on Artificial Intelligence Organization, 7 2018.   \n[10] Shakila Shaikh, Sheetal Rathi, and Prachi Janrao. Recommendation system in e-commerce websites: a graph based approached. In 2017 IEEE 7th International Advance Computing Conference (IACC), pages 931\u2013934. IEEE, 2017.   \n[11] Shiwen Wu, Fei Sun, Wentao Zhang, Xu Xie, and Bin Cui. Graph neural networks in recommender systems: A survey. ACM Comput. Surv., 55(5), dec 2022.   \n[12] Kaige Yang and Laura Toni. Graph-based recommendation system. In 2018 IEEE Global Conference on Signal and Information Processing (GlobalSIP), pages 798\u2013802. IEEE, 2018.   \n[13] Zhaoping Xiong, Dingyan Wang, Xiaohong Liu, Feisheng Zhong, Xiaozhe Wan, Xutong Li, Zhaojun Li, Xiaomin Luo, Kaixian Chen, Hualiang Jiang, et al. Pushing the boundaries of molecular representation for drug discovery with the graph attention mechanism. Journal of medicinal chemistry, 63(16):8749\u20138760, 2019.   \n[14] Pietro Bongini, Monica Bianchini, and Franco Scarselli. Molecular generative graph neural networks for drug discovery. Neurocomputing, 450:242\u2013252, 2021.   \n[15] Tailin Wu, Hongyu Ren, Pan Li, and Jure Leskovec. Graph information bottleneck. Advances in Neural Information Processing Systems, 33:20437\u201320448, 2020.   \n[16] Siqi Miao, Mia Liu, and Pan Li. Interpretable and generalizable graph learning via stochastic attention mechanism. In International Conference on Machine Learning, pages 15524\u201315543. PMLR, 2022.   \n[17] Marc Brockschmidt. Gnn-film: Graph neural networks with feature-wise linear modulation, 2020.   \n[18] Krzysztof Rusek, Paul Almasan, Jos\u00e9 Su\u00e1rez-Varela, Piotr Cho\u0142da, Pere Barlet-Ros, and Albert Cabellos-Aparicio. Fast traffic engineering by gradient descent with learned differentiable routing, 2022.   \n[19] Jiaxing Zhang, Dongsheng Luo, and Hua Wei. Mixupexplainer: Generalizing explanations for graph neural networks with data augmentation. In Proceedings of 29th ACM SIGKDD Conference on Knowledge Discovery and Data Mining (SIGKDD), 2023.   \n[20] Xu Zheng, Farhad Shirani, Tianchun Wang, Wei Cheng, Zhuomin Chen, Haifeng Chen, Hua Wei, and Dongsheng Luo. Towards robust fidelity for evaluating explainability of graph neural networks. In The Twelfth International Conference on Learning Representations, 2024.   \n[21] Zhuomin Chen, Jiaxing Zhang, Jingchao Ni, Xiaoting Li, Yuchen Bian, Md Mezbahul Islam, Ananda Mondal, Hua Wei, and Dongsheng Luo. Generating in-distribution proxy graphs for explaining graph neural networks. In Forty-first International Conference on Machine Learning, 2024.   \n[22] Caihua Shan, Yifei Shen, Yao Zhang, Xiang Li, and Dongsheng Li. Reinforcement learning enhanced explainer for graph neural networks. In M. Ranzato, A. Beygelzimer, Y. Dauphin, P.S. Liang, and J. Wortman Vaughan, editors, Advances in Neural Information Processing Systems, volume 34, pages 22523\u201322533. Curran Associates, Inc., 2021.   \n[23] Zhitao Ying, Dylan Bourgeois, Jiaxuan You, Marinka Zitnik, and Jure Leskovec. Gnnexplainer: Generating explanations for graph neural networks. Advances in neural information processing systems, 32, 2019.   \n[24] Dongsheng Luo, Wei Cheng, Dongkuan Xu, Wenchao Yu, Bo Zong, Haifeng Chen, and Xiang Zhang. Parameterized explainer for graph neural network. Advances in neural information processing systems, 33:19620\u201319631, 2020.   \n[25] Hao Yuan, Haiyang Yu, Jie Wang, Kang Li, and Shuiwang Ji. On explainability of graph neural networks via subgraph explorations. In International Conference on Machine Learning, pages 12241\u201312252. PMLR, 2021.   \n[26] Hao Yuan, Jiliang Tang, Xia Hu, and Shuiwang Ji. XGNN: towards model-level explanations of graph neural networks. In KDD \u201920: The 26th ACM SIGKDD Conference on Knowledge Discovery and Data Mining, Virtual Event, CA, USA, August 23-27, 2020, pages 430\u2013438. ACM, 2020.   \n[27] Federico Baldassarre and Hossein Azizpour. Explainability techniques for graph convolutional networks, 2019.   \n[28] Enyan Dai and Suhang Wang. Towards self-explainable graph neural network, 2021.   \n[29] Junfeng Fang, Xiang Wang, An Zhang, Zemin Liu, Xiangnan He, and Tat-Seng Chua. Cooperative Explanations of Graph Neural Networks, page 616\u2013624. Association for Computing Machinery, New York, NY, USA, 2023.   \n[30] Naftali Tishby, Fernando C Pereira, and William Bialek. The information bottleneck method. arXiv preprint physics/0004057, 2000.   \n[31] Naftali Tishby and Noga Zaslavsky. Deep learning and the information bottleneck principle. In 2015 ieee information theory workshop (itw), pages 1\u20135. IEEE, 2015.   \n[32] Junchi Yu, Tingyang Xu, Yu Rong, Yatao Bian, Junzhou Huang, and Ran He. Graph information bottleneck for subgraph recognition. arXiv preprint arXiv:2010.05563, 2020.   \n[33] Jundong Li, Kewei Cheng, Suhang Wang, Fred Morstatter, Robert P. Trevino, Jiliang Tang, and Huan Liu. Feature selection: A data perspective. ACM Comput. Surv., 50(6), dec 2017.   \n[34] Muhammed Fatih Bal\u0131n, Abubakar Abid, and James Zou. Concrete autoencoders: Differentiable feature selection and reconstruction. In International conference on machine learning, pages 444\u2013453. PMLR, 2019.   \n[35] Zhilu Zhang and Mert Sabuncu. Generalized cross entropy loss for training deep neural networks with noisy labels. Advances in neural information processing systems, 31, 2018.   \n[36] Aaron van den Oord, Yazhe Li, and Oriol Vinyals. Representation learning with contrastive predictive coding, 2019.   \n[37] Junfeng Fang, Xiang Wang, An Zhang, Zemin Liu, Xiangnan He, and Tat-Seng Chua. Cooperative explanations of graph neural networks. In Proceedings of the Sixteenth ACM International Conference on Web Search and Data Mining, pages 616\u2013624, 2023.   \n[38] Yaochen Xie, Sumeet Katariya, Xianfeng Tang, Edward Huang, Nikhil Rao, Karthik Subbian, and Shuiwang Ji. Task-agnostic graph explanations, 2022.   \n[39] Zhengdao Chen, Lei Chen, Soledad Villar, and Joan Bruna. Can graph neural networks count substructures?, 2020.   \n[40] John S Delaney. Esol: estimating aqueous solubility directly from molecular structure. Journal of chemical information and computer sciences, 44(3):1000\u20131005, 2004.   \n[41] Petar Velic\u02c7kovic\u00b4, Guillem Cucurull, Arantxa Casanova, Adriana Romero, Pietro Lio, and Yoshua Bengio. Graph attention networks. arXiv preprint arXiv:1710.10903, 2017.   \n[42] Scott A Wildman and Gordon M Crippen. Prediction of physicochemical parameters by atomic contributions. Journal of chemical information and computer sciences, 39(5):868\u2013873, 1999.   \n[43] Benjamin Sanchez-Lengeling, Jennifer Wei, Brian Lee, Emily Reif, Peter Wang, Wesley Qian, Kevin McCloskey, Lucy Colwell, and Alexander Wiltschko. Evaluating attribution for graph neural networks. Advances in neural information processing systems, 33:5898\u20135910, 2020. ", "page_idx": 9}, {"type": "text", "text": "", "page_idx": 10}, {"type": "text", "text": "", "page_idx": 11}, {"type": "text", "text": "A Symbols Table ", "text_level": 1, "page_idx": 12}, {"type": "table", "img_path": "ejWvCpLuwu/tmp/74ed52028babd7c3151f8ad78057d97160a84452efae67ebe22a48043d3549f2.jpg", "table_caption": ["Table 4: Important notations and symbols table. "], "table_footnote": [], "page_idx": 12}, {"type": "text", "text": "B Proof ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "B.1 Property 1 ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "Proof. From the definition of $Y^{*}$ , we can make a safe assumption that there is a many-to-one map (function), denoted by $h$ , from $G^{*}$ to $Y^{*}$ as $Y^{*}$ is the prediction label for $G^{*}$ . For simplicity, we assume a finite number of explanation instances for each label $y^{\\ast}$ , and each explanation instance, denoted by $g^{*}$ , is generated independently. Then, we have $\\begin{array}{r}{\\bar{p}(y^{*})~=~\\sum_{g^{*}\\in\\mathbb{G}(y^{*})}p(g^{*})}\\end{array}$ , where $\\mathbb{G}(y^{*})=\\{g|h(g)=y^{*}\\}$ is the set of explanations whose labels are $y^{\\ast}$ . ", "page_idx": 13}, {"type": "text", "text": "Based on the definition of mutual information, we have: ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{I(G^{*};Y)=\\displaystyle\\int_{\\mathbb{R}^{n}}p_{(G^{*}\\cdot Y^{*})}(\\varrho^{*},y)\\log\\frac{p(\\varrho(\\cdot,y^{*});\\varrho^{*})}{p_{(G^{*}\\cdot(Z^{*})^{n})V^{*}(y)}}\\mathrm{d}_{y}\\mathrm{d}_{x}\\,d_{y}}\\\\ &{=\\displaystyle\\int_{\\mathbb{R}^{n}}\\int_{\\mathbb{R}^{n}}p(\\varrho(\\cdot,y^{*});\\varrho(y^{*}),y)}\\\\ &{\\qquad\\qquad\\qquad\\qquad\\log\\frac{p(\\varrho(\\cdot,y^{*});\\varrho(y^{*}),y)}{p_{(G^{*}\\cdot(Z^{*})^{n})V^{*}(y)}}\\mathrm{d}_{y}\\,d_{x}\\,d_{y}}\\\\ &{=\\displaystyle\\int_{\\mathbb{R}^{n}}\\int_{\\mathbb{R}^{n}}p(\\varrho(\\cdot,y^{*},y)(\\varrho^{*},h(\\varrho^{*}),y)}\\\\ &{\\qquad\\qquad\\qquad\\qquad\\log\\frac{p(\\varrho(\\cdot,y^{*},y)(\\varrho^{*},h(\\varrho^{*}),y))}{p_{(G^{*}\\cdot(Y^{*})^{n})}(\\varrho^{*},h(\\varrho^{*}))\\gamma_{D}(y)}d_{y}\\,d_{y}\\,d_{y}}\\\\ &{=\\displaystyle\\int_{\\mathbb{R}^{n}}\\int_{\\mathbb{R}^{n}}\\sum_{\\varrho^{*}\\in\\{0,1\\}}\\varrho(\\varrho(\\cdot,y^{*},y)(\\varrho^{*},y^{*}))}\\\\ &{\\qquad\\qquad\\qquad\\qquad\\qquad\\log\\frac{p(\\varrho(\\cdot,y^{*},y))}{p_{(G^{*}\\cdot(Z^{*})^{n})}(\\varrho^{*},y)}\\mathrm{d}_{y}\\,d_{x}\\,d_{y}}\\end{array}\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "Based on our many-to-one assumption, while each $g^{*}$ is generated independently, we know that if $g\\notin\\mathbb{G}(y^{*})$ , then we have $p_{(G^{*},Y^{*},Y)}(g^{*},y^{*},y)=0$ . Thus, we have: ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{I(G^{*};Y)=I(G^{*};Y)}\\\\ &{\\ \\ +\\displaystyle\\int_{y}\\int_{y^{*}}\\displaystyle\\sum_{g\\in\\{0,\\gamma^{*},Y\\}}p_{(G^{*};Y^{*},Y)}(g^{*},y^{*},y)}\\\\ &{\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\log\\displaystyle\\frac{p_{(G^{*};Y^{*},Y^{*})}(g^{*},y^{*},y)}{p_{(G^{*};Y^{*})}(g^{*},y^{*})p_{Y}(y)}d_{y^{*}}d_{y}}\\\\ &{=\\displaystyle\\int_{y}\\int_{y^{*}}\\int_{g^{*}}p_{(G^{*},Y^{*},Y)}(g^{*},y^{*},y)}\\\\ &{\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\log\\displaystyle\\frac{p_{(G^{*},Y^{*},Y)}(g^{*},y^{*},y)}{p_{(G^{*},Y^{*})}(g^{*},y^{*})p_{Y}(y)}d_{g^{*}}d_{y^{*}}d_{y}}\\\\ &{=I(G^{*},Y^{*};Y).}\\end{array}\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "With the chain rule for mutual information, we have $I(G^{*},Y^{*};Y)\\,=\\,I(Y^{*};Y)+I(G^{*};Y|Y^{*})$ .   \nThen due to the non-negativity of the mutual information, we have $I(G^{*},Y^{*};Y)\\ge I(Y^{*};Y)$ . ", "page_idx": 13}, {"type": "text", "text": "B.2 Property 2 ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "Proof. As in the InfoNCE method, the mutual information between $Y^{*}$ and $Y$ is defined as: ", "page_idx": 13}, {"type": "equation", "text": "$$\nI(Y^{*};Y)=\\sum_{Y^{*},Y}p(Y^{*},Y)\\log\\frac{p(Y|Y^{*})}{P(Y)}\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "However, the ground truth joint distribution $p(Y^{*},Y)$ is not controllable, so, we turn to maximize the similarity ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\sin\\left(Y^{*},Y\\right)\\propto\\frac{p(Y|Y^{*})}{p(Y)}.\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "We want to put the representation function of mutual information into the NCE Loss ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\mathcal{L}_{N}=-\\mathbb{E}\\log\\left[\\frac{\\sin\\left(Y^{*},Y\\right)}{\\sum_{Y^{\\prime}\\in\\mathbb{Y}}(Y^{*},Y^{\\prime})}\\right],\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "where $\\mathcal{L}_{\\mathrm{N}}$ denotes the NCE loss. By inserting the optimal sim $(Y^{*},Y)$ into Eq. (11), we can get: ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathcal{L}_{\\mathrm{NCE}}=-\\frac{\\mathbb{F}}{\\mathbb{F}}\\log\\left[\\frac{p(Y^{\\dagger}Y^{*})}{p(Y^{\\dagger}Y^{*})}\\right]}\\\\ &{\\qquad=\\frac{\\mathbb{F}}{\\mathbb{F}}\\log\\left[1+\\frac{p(Y|Y^{*})}{p(Y^{\\dagger})}\\sum_{Y^{\\prime}\\in\\mathcal{Y}_{m}}\\frac{p(Y^{*},Y^{*})}{p(Y^{\\dagger})}\\right]}\\\\ &{\\qquad\\approx\\frac{\\mathbb{F}}{\\mathbb{F}}\\log\\left[1+\\frac{p(Y|Y^{*})}{p(Y^{\\dagger})}\\sum_{Y^{\\prime}\\in\\mathcal{Y}_{m}}\\frac{p(Y^{*},Y^{\\prime})}{p(Y^{\\prime})}\\right]}\\\\ &{\\qquad\\approx\\frac{\\mathbb{F}}{\\mathbb{F}}\\log\\left[1+\\frac{p(Y|Y^{*})}{p(Y^{\\dagger})}(N-1)\\frac{p(Y^{*},Y^{\\prime})}{p(Y^{\\prime})}\\right]}\\\\ &{\\qquad=\\frac{\\mathbb{F}}{\\mathbb{F}}\\log\\left[1+\\frac{p(Y|Y^{*})}{p(Y^{\\dagger})}(N-1)\\right]}\\\\ &{\\qquad\\geq\\frac{\\mathbb{F}}{\\mathbb{F}}\\log\\left[\\frac{p(Y|Y^{*})}{p(Y^{\\dagger})}N\\right]}\\\\ &{\\qquad=-I(Y^{*},Y)+\\log(N)}\\end{array}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "C Graph Mix-up Approach ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "To address the distribution shifting issue between $f(G)$ and $f(G^{*})$ in the GIB objective, we introduce the mix-up approach to reconstruct a within-distribution graph, $G^{(\\mathrm{mix})}$ , from the explanation graph $G^{*}$ . We follow [24] to make a widely-accepted assumption that a graph can be divided by $G=G^{*}+G^{\\Delta}$ , where $G^{*}$ presents the underlying sub-graph that makes important contributions to GNN\u2019s predictions, which is the expected explanatory graph, and $G^{\\Delta}$ consists of the remaining label-independent edges for predictions made by the GNN. Both $G^{*}$ and $G^{\\Delta}$ influence the distribution of $G$ . Therefore, we need a graph $G^{(\\mathrm{mix})}$ that contains both $G^{*}$ and $G^{\\Delta}$ , upon which we use the prediction of $G^{(\\mathrm{mix})}$ made by $f$ to approximate $Y^{*}$ and $h^{*}$ . ", "page_idx": 14}, {"type": "text", "text": "Specifically, for a target graph $G_{a}$ in the original graph set to be explained, we generate the explanation sub-graph $G_{a}^{*}=G_{a}^{\\ \\ \\bar{-}}\\bar{G}_{a}^{\\Delta}$ from the explainer. To generate a graph in the same distribution of original $G_{a}$ , we can randomly sample a graph $G_{b}$ from the original set, generate the explanation sub-graph of $G_{b}^{*}$ with the same explainer and retrieve its label-irrelevant graph $G_{b}^{\\Delta}={G_{b}}^{\\bullet}-G_{b}^{*}$ . Then we can merge $G_{a}^{*}$ together with $G_{b}^{\\Delta}$ and produce the mix-up explanation $G_{a}^{\\mathrm{(mix)}}$ . Formally, we can have G(amix)= G\u2217a + (Gb \u2212Gb\u2217). ", "page_idx": 14}, {"type": "text", "text": "Since we are using the edge weights mask to describe the explanation, we can denote $G_{a}$ and $G_{b}$ with the adjacency matrices $A_{a}$ and $\\boldsymbol{A}_{b}$ , their edge weight mask matrices as $M_{a}$ and $M_{b}$ . If $G_{a}$ and $G_{b}$ are aligned graphs with the same number of nodes, we can simply mix them up by $M_{a}^{\\mathrm{(mix)}}=M_{a}^{*}+\\left(I_{b}-M_{b}^{*}\\right)$ , where $_M$ denotes the weight of the adjacency matrix and $\\pmb{I}_{b}$ denotes the zero-ones matrix as weights of all edges in the adjacency matrix of $G_{b}$ , where 1 represents the existing edge and 0 represents there is no edge between the node pair. ", "page_idx": 14}, {"type": "text", "text": "If $G_{a}$ and $G_{b}$ are not aligned with the same number of nodes, we can use a connection adjacency matrix $A_{\\mathrm{conn}}$ and mask matrix $M_{\\mathrm{conn}}$ to merge two graphs with different numbers of nodes. Specifically, the mix-up adjacency matrix can be formed as: ", "page_idx": 14}, {"type": "equation", "text": "$$\nA_{a}^{\\mathrm{(mix)}}=\\left[\\begin{array}{c c}{{A_{a}}}&{{A_{\\mathrm{conn}}}}\\\\ {{A_{\\mathrm{conn}}^{T}}}&{{A_{b}}}\\end{array}\\right].\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "And the mix-up mask matrix can be formed as: ", "page_idx": 14}, {"type": "equation", "text": "$$\nM_{a}^{\\mathrm{(mix)}}=\\left[\\begin{array}{c c}{{M_{a}^{*}}}&{{M_{\\mathrm{conn}}}}\\\\ {{M_{\\mathrm{conn}}^{T}}}&{{M_{b}^{\\Delta}}}\\end{array}\\right]\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "Finally, we can form $G_{a}^{\\mathrm{(mix)}}$ as $(X^{\\mathrm{(mix)}},A_{a}^{\\mathrm{(mix)}}\\odot M_{a}^{\\mathrm{(mix)}})$ , where $X^{(\\mathrm{mix})}=[X_{a};X_{b}]$ . The detailed algorithm for mix-up is shown in Algorithm 1. In implantation, $\\eta=|\\mathcal{E}|*0.\\bar{0}3$ . ", "page_idx": 15}, {"type": "table", "img_path": "ejWvCpLuwu/tmp/b12a6c9f9d31cec2c1e26d2eec9ede67ff81bb09ca31ad35857d3a6703aa69ca.jpg", "table_caption": [], "table_footnote": [], "page_idx": 15}, {"type": "text", "text": "D Training Algorithm ", "text_level": 1, "page_idx": 15}, {"type": "table", "img_path": "ejWvCpLuwu/tmp/5a0524f92dd3a0c2f07342cefdfb18203921c2a1390e76e33d4406a07f71e689.jpg", "table_caption": [], "table_footnote": [], "page_idx": 15}, {"type": "text", "text": "Algorithm 2 shows the training procedure for our explainer. For each epoch and each to-be-explained graph $G$ , we first randomly sample two neighbors and decide the positive neighbor $G^{+}$ and negative neighbor $G^{-}$ according to the similarity between their embedding vectors respectively. The graph with higher similarity to $G$ is the positive neighbor $G^{+}$ . We generate the explanation for graphs and mix $G$ with $G^{+}$ and $G^{-}$ respectively. We calculate the InfoNCE for triplet $\\langle\\bar{G},G^{+},G^{-}\\rangle$ with Eq. (6) and the GIB loss, which contains the size loss and InfoNCE loss. We also calculate the MSE loss between $f(G^{\\mathrm{(mix)+}})$ and $f(G)$ . The overall loss is the sum of size loss, InfoNCE loss, and MSE loss. We update the trainable parameters in the explainer with the overall loss. ", "page_idx": 15}, {"type": "text", "text": "E Implantation details ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "We provided implementation details for our experiments in this section. Data and code are available in the Anumuous git repo and supplementary. ", "page_idx": 15}, {"type": "text", "text": "All experiments are conducted on a Linux machine (Ubuntu 16.04.4 LTS (GNU/Linux 4.4.0-210- generic x86_64)) with 4 NVIDIA TITAN Xp (12 GB) GPUs. CUDA version is 11.8 and the Driver version is 520.56.06. All codes are written with the Python version 3.8.13 with PyTorch 1.12.1 and PyTorch Geometric (PyG) 2.1.0.post1, torch-scatter 2.0.9, and torch-sparse 0.6.15. We adopt the Adam optimizer throughout all experiments. Overall, for each dataset, a GCN regression model is well-trained first, where we take a three-layer GCN model as the backbone. Then the explainers take the to-be-explained GNN and original graph and generate explanations for its prediction on the dataset. After that, we evaluate the performance of the explanation. We split the dataset into 8:1:1, where we train the GNN base model with 8 folds, and train and test explainer models with 1 fold respectively. The hyper-parameters are illustrated in the paper correspondingly. ", "page_idx": 15}, {"type": "text", "text": "", "page_idx": 16}, {"type": "text", "text": "E.1 Datasets ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "We formulate Three synthetic datasets and a real-world dataset, as is shown in Table 1, in order to address the lack of graph regression datasets with ground-truth explanations. (1) BA-Motif-Volume: This dataset is based on the BA-shapes [23] and makes a modification, which is adding random float values from [0.00, 100.00] as the node feature. We then sum the node values on the motif as the regression label of the whole graph, which means the GNNs should recognize the [house] motif and then sum features to make the prediction. (2) BA-Motif-Counting: Different from BA-Motif-Volume, where node features are summarized, in this dataset, we attach various numbers of motifs to the base BA random graph and pad all graphs to equal size. The number of motifs is counted as the regression label. Additionally, we pad base graphs to dynamic size to prevent the GNNs from making trivial predictions based on the total number of nodes. (3) Triangles: We follow the previous work [39] to construct this dataset. The dataset is a set of 5000 Erdo\u02dds\u2013R\u00e9nyi random graphs denoted as $E R(m,p)$ , where $m=30$ is the number of nodes in each graph and $p=0.2$ is the probability for an edge to exist. The size of 5000 was chosen to match the previous work. The regression label for this dataset is the number of triangles in a graph and GNNs are trained to count the triangles. (4) Crippen: The Crippen dataset is a real-life dataset that was initially used to evaluate the graph regression task. The dataset has 1127 graphs reported in the Delaney solubility dataset [40] and has weights of each node assigned by the Crippen model [42], which is an empirical chemistry model predicting the water-actual partition coefficient. We adopt this dataset, firstly shown in the previous work [43], and construct edge weights by taking the average of the two connected nodes\u2019 weights. ", "page_idx": 16}, {"type": "text", "text": "E.2 Baselines ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "We compared the proposed RegExplainer against a comprehensive set of baselines in all datasets, including: (1) GRAD [23]: GRAD is a gradient-based method that learns weight vectors of edges by computing gradients of the GNN\u2019s objective function. (2) ATT [41]: ATT is a graph attention network (GAT) that learns attention weights for edges in the input graph. These weights can be utilized as a proxy measure of edge importance. (3) GNNExplainer [23]: GNNExplainer is a model-agnostic method that learns an adjacency matrix mask by maximizing the mutual information between the predictions of the GNN and the distribution of possible sub-graph structures. (4) PGExplainer [24]: PGExplainer adopts a deep neural network to parameterize the generation process of explanations, which facilitates a comprehensive understanding of the predictions made by GNNs. It also produces sub-graph explanations with edge importance masks. (5) MixupExplainer [19]: MixupExplainer adopts the graph mix-up approach with PGExplainer and address the Out-Of-Distribution problem in graph classification tasks. ", "page_idx": 16}, {"type": "text", "text": "F Additional Experiments ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "F.1 Correlation between Prediction Shifting and the Label Value ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "In Figure 7, each point represents a graph instance, where $Y$ represents the ground-truth label, and $\\Delta$ represents the absolute value difference. It\u2019s clear that both the $\\Delta(f(G^{*}),Y)$ and $\\Delta(f(G),f(G^{*}))$ strongly correlated to $Y$ with statistical significance, indicating the prediction shifting problem is related to the continuous ordered decision boundary, which is present in regression tasks. ", "page_idx": 16}, {"type": "image", "img_path": "ejWvCpLuwu/tmp/7b4ec821478bfb880429048d3e289ca8c0bba39fd6bfe998653fe87a1a278dae.jpg", "img_caption": ["Figure 7: Correlations between the predictions and their shifting on BA-Motif-Volume. The value of $r$ indicates the Pearson Correlation Coefficient, and the values with \\* indicate statistical significance for correlation, where $^{\\ast}=\\ast\\ast$ indicates the p-value for testing non-correlation $p\\leq0.001$ . Each point represents one graph instance. "], "img_footnote": [], "page_idx": 17}, {"type": "text", "text": "NeurIPS Paper Checklist ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "The checklist is designed to encourage best practices for responsible machine learning research, addressing issues of reproducibility, transparency, research ethics, and societal impact. Do not remove the checklist: The papers not including the checklist will be desk rejected. The checklist should follow the references and follow the (optional) supplemental material. The checklist does NOT count towards the page limit. ", "page_idx": 18}, {"type": "text", "text": "Please read the checklist guidelines carefully for information on how to answer these questions. For each question in the checklist: ", "page_idx": 18}, {"type": "text", "text": "\u2022 You should answer [Yes] , [No] , or [NA] .   \n\u2022 [NA] means either that the question is Not Applicable for that particular paper or the relevant information is Not Available.   \n\u2022 Please provide a short (1\u20132 sentence) justification right after your answer (even for NA). ", "page_idx": 18}, {"type": "text", "text": "The checklist answers are an integral part of your paper submission. They are visible to the reviewers, area chairs, senior area chairs, and ethics reviewers. You will be asked to also include it (after eventual revisions) with the final version of your paper, and its final version will be published with the paper. ", "page_idx": 18}, {"type": "text", "text": "The reviewers of your paper will be asked to use the checklist as one of the factors in their evaluation. While \"[Yes] \" is generally preferable to \"[No] \", it is perfectly acceptable to answer \"[No] \" provided a proper justification is given (e.g., \"error bars are not reported because it would be too computationally expensive\" or \"we were unable to find the license for the dataset we used\"). In general, answering \"[No] \" or \"[NA] \" is not grounds for rejection. While the questions are phrased in a binary way, we acknowledge that the true answer is often more nuanced, so please just use your best judgment and write a justification to elaborate. All supporting evidence can appear either in the main paper or the supplemental material, provided in appendix. If you answer [Yes] to a question, in the justification please point to the section(s) where related material for the question can be found. ", "page_idx": 18}, {"type": "text", "text": "IMPORTANT, please: ", "page_idx": 18}, {"type": "text", "text": "\u2022 Delete this instruction block, but keep the section heading \u201cNeurIPS paper checklist\", \u2022 Keep the checklist subsection headings, questions/answers and guidelines below. \u2022 Do not modify the questions and only use the provided macros for your answers. ", "page_idx": 18}, {"type": "text", "text": "1. Claims ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Question: Do the main claims made in the abstract and introduction accurately reflect the paper\u2019s contributions and scope? ", "page_idx": 18}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Justification: We discussed the background scope and introduced our contributions in abstract and introduction. ", "page_idx": 18}, {"type": "text", "text": "Guidelines: ", "page_idx": 18}, {"type": "text", "text": "\u2022 The answer NA means that the abstract and introduction do not include the claims made in the paper.   \n\u2022 The abstract and/or introduction should clearly state the claims made, including the contributions made in the paper and important assumptions and limitations. A No or NA answer to this question will not be perceived well by the reviewers.   \n\u2022 The claims made should match theoretical and experimental results, and reflect how much the results can be expected to generalize to other settings.   \n\u2022 It is fine to include aspirational goals as motivation as long as it is clear that these goals are not attained by the paper. ", "page_idx": 18}, {"type": "text", "text": "2. Limitations ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Question: Does the paper discuss the limitations of the work performed by the authors? Answer: [Yes] ", "page_idx": 18}, {"type": "text", "text": "Justification: We provided the discussion about the limitations at the end of conclusion. Guidelines: ", "page_idx": 19}, {"type": "text", "text": "\u2022 The answer NA means that the paper has no limitation while the answer No means that the paper has limitations, but those are not discussed in the paper.   \n\u2022 The authors are encouraged to create a separate \"Limitations\" section in their paper.   \n\u2022 The paper should point out any strong assumptions and how robust the results are to violations of these assumptions (e.g., independence assumptions, noiseless settings, model well-specification, asymptotic approximations only holding locally). The authors should reflect on how these assumptions might be violated in practice and what the implications would be.   \n\u2022 The authors should reflect on the scope of the claims made, e.g., if the approach was only tested on a few datasets or with a few runs. In general, empirical results often depend on implicit assumptions, which should be articulated.   \n\u2022 The authors should reflect on the factors that influence the performance of the approach. For example, a facial recognition algorithm may perform poorly when image resolution is low or images are taken in low lighting. Or a speech-to-text system might not be used reliably to provide closed captions for online lectures because it fails to handle technical jargon.   \n\u2022 The authors should discuss the computational efficiency of the proposed algorithms and how they scale with dataset size.   \n\u2022 If applicable, the authors should discuss possible limitations of their approach to address problems of privacy and fairness.   \n\u2022 While the authors might fear that complete honesty about limitations might be used by reviewers as grounds for rejection, a worse outcome might be that reviewers discover limitations that aren\u2019t acknowledged in the paper. The authors should use their best judgment and recognize that individual actions in favor of transparency play an important role in developing norms that preserve the integrity of the community. Reviewers will be specifically instructed to not penalize honesty concerning limitations. ", "page_idx": 19}, {"type": "text", "text": "3. Theory Assumptions and Proofs ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "Question: For each theoretical result, does the paper provide the full set of assumptions and a complete (and correct) proof? ", "page_idx": 19}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "Justification: We provided assumptions and proofs to our theoretical results. Guidelines: ", "page_idx": 19}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include theoretical results.   \n\u2022 All the theorems, formulas, and proofs in the paper should be numbered and crossreferenced.   \n\u2022 All assumptions should be clearly stated or referenced in the statement of any theorems.   \n\u2022 The proofs can either appear in the main paper or the supplemental material, but if they appear in the supplemental material, the authors are encouraged to provide a short proof sketch to provide intuition.   \n\u2022 Inversely, any informal proof provided in the core of the paper should be complemented by formal proofs provided in appendix or supplemental material.   \n\u2022 Theorems and Lemmas that the proof relies upon should be properly referenced. ", "page_idx": 19}, {"type": "text", "text": "4. Experimental Result Reproducibility ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "Question: Does the paper fully disclose all the information needed to reproduce the main experimental results of the paper to the extent that it affects the main claims and/or conclusions of the paper (regardless of whether the code and data are provided or not)? ", "page_idx": 19}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 19}, {"type": "text", "text": "Justification: We provided the hyper-parameters setting. ", "page_idx": 19}, {"type": "text", "text": "Guidelines: \u2022 The answer NA means that the paper does not include experiments. ", "page_idx": 19}, {"type": "text", "text": "\u2022 If the paper includes experiments, a No answer to this question will not be perceived well by the reviewers: Making the paper reproducible is important, regardless of whether the code and data are provided or not.   \n\u2022 If the contribution is a dataset and/or model, the authors should describe the steps taken to make their results reproducible or verifiable.   \n\u2022 Depending on the contribution, reproducibility can be accomplished in various ways. For example, if the contribution is a novel architecture, describing the architecture fully might suffice, or if the contribution is a specific model and empirical evaluation, it may be necessary to either make it possible for others to replicate the model with the same dataset, or provide access to the model. In general. releasing code and data is often one good way to accomplish this, but reproducibility can also be provided via detailed instructions for how to replicate the results, access to a hosted model (e.g., in the case of a large language model), releasing of a model checkpoint, or other means that are appropriate to the research performed.   \n\u2022 While NeurIPS does not require releasing code, the conference does require all submissions to provide some reasonable avenue for reproducibility, which may depend on the nature of the contribution. For example (a) If the contribution is primarily a new algorithm, the paper should make it clear how to reproduce that algorithm. (b) If the contribution is primarily a new model architecture, the paper should describe the architecture clearly and fully. (c) If the contribution is a new model (e.g., a large language model), then there should either be a way to access this model for reproducing the results or a way to reproduce the model (e.g., with an open-source dataset or instructions for how to construct the dataset). (d) We recognize that reproducibility may be tricky in some cases, in which case authors are welcome to describe the particular way they provide for reproducibility. In the case of closed-source models, it may be that access to the model is limited in some way (e.g., to registered users), but it should be possible for other researchers to have some path to reproducing or verifying the results. ", "page_idx": 20}, {"type": "text", "text": "5. Open access to data and code ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Question: Does the paper provide open access to the data and code, with sufficient instructions to faithfully reproduce the main experimental results, as described in supplemental material? ", "page_idx": 20}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Justification: We provided code and data in supplementary. ", "page_idx": 20}, {"type": "text", "text": "Guidelines: ", "page_idx": 20}, {"type": "text", "text": "\u2022 The answer NA means that paper does not include experiments requiring code.   \n\u2022 Please see the NeurIPS code and data submission guidelines (https://nips.cc/ public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 While we encourage the release of code and data, we understand that this might not be possible, so \u201cNo\u201d is an acceptable answer. Papers cannot be rejected simply for not including code, unless this is central to the contribution (e.g., for a new open-source benchmark).   \n\u2022 The instructions should contain the exact command and environment needed to run to reproduce the results. See the NeurIPS code and data submission guidelines (https: //nips.cc/public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 The authors should provide instructions on data access and preparation, including how to access the raw data, preprocessed data, intermediate data, and generated data, etc.   \n\u2022 The authors should provide scripts to reproduce all experimental results for the new proposed method and baselines. If only a subset of experiments are reproducible, they should state which ones are omitted from the script and why.   \n\u2022 At submission time, to preserve anonymity, the authors should release anonymized versions (if applicable). ", "page_idx": 20}, {"type": "text", "text": "\u2022 Providing as much information as possible in supplemental material (appended to the paper) is recommended, but including URLs to data and code is permitted. ", "page_idx": 21}, {"type": "text", "text": "6. Experimental Setting/Details ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "Question: Does the paper specify all the training and test details (e.g., data splits, hyperparameters, how they were chosen, type of optimizer, etc.) necessary to understand the results? ", "page_idx": 21}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 21}, {"type": "text", "text": "Justification: The experimental setting is presented in the paper and The full details can be found in the appendix and supplemental material. ", "page_idx": 21}, {"type": "text", "text": "Guidelines: ", "page_idx": 21}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments. \u2022 The experimental setting should be presented in the core of the paper to a level of detail that is necessary to appreciate the results and make sense of them. \u2022 The full details can be provided either with the code, in appendix, or as supplemental material. ", "page_idx": 21}, {"type": "text", "text": "7. Experiment Statistical Significance ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "Question: Does the paper report error bars suitably and correctly defined or other appropriate information about the statistical significance of the experiments? ", "page_idx": 21}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 21}, {"type": "text", "text": "Justification: We conduct our experiments in 10 random seeds and report the mean and std values in the performance table. ", "page_idx": 21}, {"type": "text", "text": "Guidelines: ", "page_idx": 21}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The authors should answer \"Yes\" if the results are accompanied by error bars, confidence intervals, or statistical significance tests, at least for the experiments that support the main claims of the paper.   \n\u2022 The factors of variability that the error bars are capturing should be clearly stated (for example, train/test split, initialization, random drawing of some parameter, or overall run with given experimental conditions).   \n\u2022 The method for calculating the error bars should be explained (closed form formula, call to a library function, bootstrap, etc.)   \n\u2022 The assumptions made should be given (e.g., Normally distributed errors).   \n\u2022 It should be clear whether the error bar is the standard deviation or the standard error of the mean.   \n\u2022 It is OK to report 1-sigma error bars, but one should state it. The authors should preferably report a 2-sigma error bar than state that they have a $96\\%$ CI, if the hypothesis of Normality of errors is not verified.   \n\u2022 For asymmetric distributions, the authors should be careful not to show in tables or figures symmetric error bars that would yield results that are out of range (e.g. negative error rates).   \n\u2022 If error bars are reported in tables or plots, The authors should explain in the text how they were calculated and reference the corresponding figures or tables in the text. ", "page_idx": 21}, {"type": "text", "text": "8. Experiments Compute Resources ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "Question: For each experiment, does the paper provide sufficient information on the computer resources (type of compute workers, memory, time of execution) needed to reproduce the experiments? ", "page_idx": 21}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 21}, {"type": "text", "text": "Justification: We provided the information of computing resources in the section of implementation details in the appendix. ", "page_idx": 21}, {"type": "text", "text": "Guidelines: ", "page_idx": 21}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments. ", "page_idx": 21}, {"type": "text", "text": "\u2022 The paper should indicate the type of compute workers CPU or GPU, internal cluster, or cloud provider, including relevant memory and storage.   \n\u2022 The paper should provide the amount of compute required for each of the individual experimental runs as well as estimate the total compute.   \n\u2022 The paper should disclose whether the full research project required more compute than the experiments reported in the paper (e.g., preliminary or failed experiments that didn\u2019t make it into the paper). ", "page_idx": 22}, {"type": "text", "text": "9. Code Of Ethics ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Question: Does the research conducted in the paper conform, in every respect, with the NeurIPS Code of Ethics https://neurips.cc/public/EthicsGuidelines? ", "page_idx": 22}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 22}, {"type": "text", "text": "Justification: Our research doesn\u2019t have a concern about the ethics. ", "page_idx": 22}, {"type": "text", "text": "Guidelines: ", "page_idx": 22}, {"type": "text", "text": "\u2022 The answer NA means that the authors have not reviewed the NeurIPS Code of Ethics.   \n\u2022 If the authors answer No, they should explain the special circumstances that require a deviation from the Code of Ethics.   \n\u2022 The authors should make sure to preserve anonymity (e.g., if there is a special consideration due to laws or regulations in their jurisdiction). ", "page_idx": 22}, {"type": "text", "text": "10. Broader Impacts ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Question: Does the paper discuss both potential positive societal impacts and negative societal impacts of the work performed? ", "page_idx": 22}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 22}, {"type": "text", "text": "Justification: There is no societal impact of the work performed, other than helping human beings better understand the black-box GNNs models. ", "page_idx": 22}, {"type": "text", "text": "Guidelines: ", "page_idx": 22}, {"type": "text", "text": "\u2022 The answer NA means that there is no societal impact of the work performed.   \n\u2022 If the authors answer NA or No, they should explain why their work has no societal impact or why the paper does not address societal impact.   \n\u2022 Examples of negative societal impacts include potential malicious or unintended uses (e.g., disinformation, generating fake profiles, surveillance), fairness considerations (e.g., deployment of technologies that could make decisions that unfairly impact specific groups), privacy considerations, and security considerations.   \n\u2022 The conference expects that many papers will be foundational research and not tied to particular applications, let alone deployments. However, if there is a direct path to any negative applications, the authors should point it out. For example, it is legitimate to point out that an improvement in the quality of generative models could be used to generate deepfakes for disinformation. On the other hand, it is not needed to point out that a generic algorithm for optimizing neural networks could enable people to train models that generate Deepfakes faster.   \n\u2022 The authors should consider possible harms that could arise when the technology is being used as intended and functioning correctly, harms that could arise when the technology is being used as intended but gives incorrect results, and harms following from (intentional or unintentional) misuse of the technology.   \n\u2022 If there are negative societal impacts, the authors could also discuss possible mitigation strategies (e.g., gated release of models, providing defenses in addition to attacks, mechanisms for monitoring misuse, mechanisms to monitor how a system learns from feedback over time, improving the efficiency and accessibility of ML). ", "page_idx": 22}, {"type": "text", "text": "11. Safeguards ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Question: Does the paper describe safeguards that have been put in place for responsible release of data or models that have a high risk for misuse (e.g., pretrained language models, image generators, or scraped datasets)? ", "page_idx": 22}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 22}, {"type": "text", "text": "Justification: The paper poses no such risks. ", "page_idx": 23}, {"type": "text", "text": "Guidelines: ", "page_idx": 23}, {"type": "text", "text": "\u2022 The answer NA means that the paper poses no such risks.   \n\u2022 Released models that have a high risk for misuse or dual-use should be released with necessary safeguards to allow for controlled use of the model, for example by requiring that users adhere to usage guidelines or restrictions to access the model or implementing safety filters.   \n\u2022 Datasets that have been scraped from the Internet could pose safety risks. The authors should describe how they avoided releasing unsafe images.   \n\u2022 We recognize that providing effective safeguards is challenging, and many papers do not require this, but we encourage authors to take this into account and make a best faith effort. ", "page_idx": 23}, {"type": "text", "text": "12. Licenses for existing assets ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: Are the creators or original owners of assets (e.g., code, data, models), used in the paper, properly credited and are the license and terms of use explicitly mentioned and properly respected? ", "page_idx": 23}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 23}, {"type": "text", "text": "Justification: We produce the data by ourselves and the original papers we refer to are cited.   \nThe baseline model we used are also cited. ", "page_idx": 23}, {"type": "text", "text": "Guidelines: ", "page_idx": 23}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not use existing assets.   \n\u2022 The authors should cite the original paper that produced the code package or dataset.   \n\u2022 The authors should state which version of the asset is used and, if possible, include a URL.   \n\u2022 The name of the license (e.g., CC-BY 4.0) should be included for each asset.   \n\u2022 For scraped data from a particular source (e.g., website), the copyright and terms of service of that source should be provided.   \n\u2022 If assets are released, the license, copyright information, and terms of use in the package should be provided. For popular datasets, paperswithcode.com/datasets has curated licenses for some datasets. Their licensing guide can help determine the license of a dataset.   \n\u2022 For existing datasets that are re-packaged, both the original license and the license of the derived asset (if it has changed) should be provided.   \n\u2022 If this information is not available online, the authors are encouraged to reach out to the asset\u2019s creators. ", "page_idx": 23}, {"type": "text", "text": "13. New Assets ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: Are new assets introduced in the paper well documented and is the documentation provided alongside the assets? ", "page_idx": 23}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Justification: We provided the details about our new proposed datasets in the paper. ", "page_idx": 23}, {"type": "text", "text": "Guidelines: ", "page_idx": 23}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not release new assets.   \n\u2022 Researchers should communicate the details of the dataset/code/model as part of their submissions via structured templates. This includes details about training, license, limitations, etc.   \n\u2022 The paper should discuss whether and how consent was obtained from people whose asset is used.   \n\u2022 At submission time, remember to anonymize your assets (if applicable). You can either create an anonymized URL or include an anonymized zip file. ", "page_idx": 23}, {"type": "text", "text": "14. Crowdsourcing and Research with Human Subjects ", "page_idx": 23}, {"type": "text", "text": "Question: For crowdsourcing experiments and research with human subjects, does the paper include the full text of instructions given to participants and screenshots, if applicable, as well as details about compensation (if any)? ", "page_idx": 24}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 24}, {"type": "text", "text": "Justification: The paper does not involve crowdsourcing nor research with human subjects. Guidelines: ", "page_idx": 24}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Including this information in the supplemental material is fine, but if the main contribution of the paper involves human subjects, then as much detail as possible should be included in the main paper.   \n\u2022 According to the NeurIPS Code of Ethics, workers involved in data collection, curation, or other labor should be paid at least the minimum wage in the country of the data collector. ", "page_idx": 24}, {"type": "text", "text": "15. Institutional Review Board (IRB) Approvals or Equivalent for Research with Human Subjects ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Question: Does the paper describe potential risks incurred by study participants, whether such risks were disclosed to the subjects, and whether Institutional Review Board (IRB) approvals (or an equivalent approval/review based on the requirements of your country or institution) were obtained? ", "page_idx": 24}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 24}, {"type": "text", "text": "Justification: The paper does not involve crowdsourcing nor research with899 human subjects. ", "page_idx": 24}, {"type": "text", "text": "Guidelines: ", "page_idx": 24}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Depending on the country in which research is conducted, IRB approval (or equivalent) may be required for any human subjects research. If you obtained IRB approval, you should clearly state this in the paper.   \n\u2022 We recognize that the procedures for this may vary significantly between institutions and locations, and we expect authors to adhere to the NeurIPS Code of Ethics and the guidelines for their institution.   \n\u2022 For initial submissions, do not include any information that would break anonymity (if applicable), such as the institution conducting the review. ", "page_idx": 24}]