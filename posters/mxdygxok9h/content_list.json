[{"type": "text", "text": "Boosting Weakly-Supervised Referring Image Segmentation via Progressive Comprehension ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Zaiquan Yang, Yuhao Liu\u2020, Jiaying Lin, Gerhard Hancke\u2020, Rynson W.H. Lau\u2020 ", "page_idx": 0}, {"type": "text", "text": "Department of Computer Science City University of Hong Kong {zaiquyang2-c, yuhliu9-c,jiayinlin5-c}@my.cityu.edu.hk {gp.hancke, Rynson.Lau}@cityu.edu.hk ", "page_idx": 0}, {"type": "text", "text": "Abstract ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "This paper explores the weakly-supervised referring image segmentation (WRIS) problem, and focuses on a challenging setup where target localization is learned directly from image-text pairs. We note that the input text description typically already contains detailed information on how to localize the target object, and we also observe that humans often follow a step-by-step comprehension process (i.e., progressively utilizing target-related attributes and relations as cues) to identify the target object. Hence, we propose a novel Progressive Comprehension Network (PCNet) to leverage target-related textual cues from the input description for progressively localizing the target object. Specifically, we first use a Large Language Model (LLM) to decompose the input text description into short phrases. These short phrases are taken as target-related cues and fed into a Conditional Referring Module (CRM) in multiple stages, to allow updating the referring text embedding and enhance the response map for target localization in a multi-stage manner. Based on the CRM, we then propose a Region-aware Shrinking (RaS) loss to constrain the visual localization to be conducted progressively in a coarse-to-fine manner across different stages. Finally, we introduce an Instance-aware Disambiguation (IaD) loss to suppress instance localization ambiguity by differentiating overlapping response maps generated by different referring texts on the same image. Extensive experiments show that our method outperforms SOTA methods on three common benchmarks. ", "page_idx": 0}, {"type": "text", "text": "1 Introduction ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Referring Image Segmentation (RIS) aims to segment a target object in an image via a user-specified input text description. RIS has various applications, such as text-based image editing [17, 13, 2] and human-computer interaction [62, 51]. Despite remarkable progress, most existing RIS works [7, 58, 27, 26, 21, 5] rely heavily on pixel-level ground-truth masks to learn visual-linguistic alignment. Recently, there has been a surge in interest in developing weakly-supervised RIS (WRIS) methods via weak supervisions, e.g., bounding-boxes [9], and text descriptions [54, 18, 30, 4], to alleviate burden of data annotations. In this work, we focus on obtaining supervision from text descriptions only. ", "page_idx": 0}, {"type": "text", "text": "The relatively weak constraint of utilizing text alone as supervision makes visual-linguistic alignment particularly challenging. There are some attempts [30, 18, 22, 46] to explore various alignment workflows. For example, TRIS [30] classifies referring texts that describe the target object as positive texts while other texts as negative ones, to model a text-to-image response map for locating potential target objects. SAG [18] introduces a bottom-up and top-down attention framework to discover individual entities and then combine these entities as the target of the referring expression. However, these methods encode the entire referring text as a single language embedding. They can easily overlook some critical cues related to the target object in the text description, leading to localization ambiguity and even errors. For example, in Fig. 1(e), TRIS [30] erroneously activates all three players due to its use of cross-modality interactions between the image and the complete language embedding only. ", "page_idx": 0}, {"type": "image", "img_path": "MxdyGXoK9h/tmp/57d847a163677b79d80ecb8dbbbb34f6046c7f0eee02a499dc5f411236eacae3.jpg", "img_caption": ["Figure 1: Given an image and a language description as inputs (a), RIS aims to predict the target object (d). Unlike existing methods (e.g., TRIS [30] (e) \u2013 a WRIS method) that directly utilize the complete language description for target localization, we observe that humans would naturally break down the sentence into several key cues (e.g., Q1 \u2013 Q3) and progressively converge onto the target object (from (b) to (d). This behavior inspires us to develop the Progressive Comprehension Network (PCNet), which merges text cues pertinent to the target object step-by-step (from (f) to (h)), significantly enhancing visual localization. $\\bigoplus$ denotes the text combination operation. "], "img_footnote": [], "page_idx": 1}, {"type": "text", "text": "", "page_idx": 1}, {"type": "text", "text": "We observe that humans typically localize target objects through a step-by-step comprehension process. Cognitive neuroscience studies [48, 41] also support this observation, indicating that humans tend to simplify a complex problem by breaking it down into manageable sub-problems and reasoning them progressively. For example, in Fig. 1(b-d), human perception would first begin with \u201ca player\u201d and identify all three players (b). The focus is then refined by the additional detail \u201cblue and gray uniform\u201d, which helps exclude the white player on the left (c). Finally, the action \u201ccatches a ball\u201d helps further exclude the person on the right, leaving the correct target person in the middle (d). ", "page_idx": 1}, {"type": "text", "text": "Inspired by the human comprehension process, we propose in this paper a novel Progressive Comprehension Network (PCNet) for WRIS. We first employ a Large Language Model (LLM) [59] to dissect the input text description into multiple short phrases. These decomposed phrases are considered as target-related cues and fed into a novel Conditional Referring Module (CRM), which helps update the global referring embedding and enhance target localization in a multi-stage manner. We also propose a novel Region-aware Shrinking (RaS) loss to facilitate visual localization across different stages at the region level. ReS first separates the target-related response map (indicating the foreground region) from the target-irrelevant response map (indicating the background region), and then constrains the background response map to progressively attenuate, thus enhancing the localization accuracy of the foreground region. Finally, we notice that salient objects in an image can sometimes trigger incorrect response map activation for text descriptions that aim for other target objects. Hence, we introduce an Instance-aware Disambiguation (IaD) loss to reduce the overlapping of the response maps by rectifying the alignment score of different referring texts to the same object. ", "page_idx": 1}, {"type": "text", "text": "In summary, our main contributions are as follows : ", "page_idx": 1}, {"type": "text", "text": "\u2022 We propose the Progressive Comprehension Network (PCNet) for the WRIS task. Inspired by the human comprehension processes, this model achieves visual localization by progressively incorporating target-related textual cues for visual-linguistic alignment. \u2022 Our method has three main technical novelties. First, we propose a Conditional Referring Module (CRM) to model the response maps through multiple stages for localization. Second, we propose a Region-aware Shrinking (RaS) loss to constrain the response maps across different stages for better cross-modal alignment. Third, to rectify overlapping localizations, we propose an Instance-aware Disambiguation (IaD) loss for different referring texts paired with the same image. ", "page_idx": 1}, {"type": "text", "text": "\u2022 We conduct extensive experiments on three popular benchmarks, demonstrating that our method outperforms existing methods by a remarkable margin. ", "page_idx": 2}, {"type": "text", "text": "2 Related work ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "Referring Image Segmentation (RIS) aims to segment the target object from the input image according to the input natural language expression. Hu et al. [14] proposes the first CNN-based RIS method. There are many follow-up works. Early methods [60, 28, 38] focus on object-level cross-modal alignment between the visual region and the corresponding referring expression. Later, many works explore the use of attention mechanisms [15, 7, 58, 19] or transformer architectures [58, 29] to model long-range dependencies, which can facilitate pixel-level cross-model alignment. For example, CMPC [15] employs a two-stage progressive comprehension model to first perceive all relevant instances through entity wording and then use relational wording to highlight the referent. In contrast, our approach leverages LLMs to decompose text descriptions into short phrases related to the target object, focusing on sentence-level (rather than word-level) comprehension, which aligns more closely with human cognition. Focusing on the visual grounding, DGA [56] also adopts multi-stage refinement. It aims to model visual reasoning on top of the relationships among the objects in the image. Differently, our work addresses the weakly RIS task and aims to alleviate the localization ambiguity by progressively integrating fine-grained attribute cues. ", "page_idx": 2}, {"type": "text", "text": "Weakly-supervised RIS (WRIS) has recently begun to attract some attention, as it can substantially reduce the burden of data labeling especially on the segmentation field [25, 57, 63]. Feng et al. [9] proposes the first WRIS method, which uses bounding boxes for annotations. Several subsequent works [18, 22, 30] attempt to use weaker supervision signal, i.e., text descriptions. SAG [18] proposes to first divide image features into individual entities via bottom-up attention and then employ top-down attention to learn relations for combining entities. Lee et al. [22] generate Grad-CAM for each word of the description and then consider the relations using an intra-chunk and inter-chunk consistency. Instead of merging individual responses, TRIS [30] directly learns the text-to-image response map by contrasting target-related positive and target-unrelated negative texts. Inspired by the generalization capabilities of segmentation foundation models [20, 8, 34], PPT [6] enables effective integration with pre-trained language-image models [43, 33] and SAM [20] by a lightweight point generator to identify the referent and context noise. Despite their success, these methods encode the full text as a single embedding for cross-modality alignment, which overlooks target-related nuances in the textual descriptions. In contrast, our method proposes to combine progressive text comprehension and object-centric visual localization to obtain better fine-grained cross-modal alignment. ", "page_idx": 2}, {"type": "text", "text": "Large Language Models (LLMs) are revolutionizing various visual domains, beneftied by their userfriendly interfaces and strong zero-shot prompting capabilities [3, 49, 1, 47]. Building on this trend, recent works [42, 55, 53, 45, 64] explore the integration of LLMs into vision tasks (e.g., languageguided segmentation [55, 53], relation [23], and image classification [42]) through parameter-efficient fine-tuning or knowledge extraction. For example, LISA [55] and GSVA [53] utilize LLaVA [32], a large vision-language model (LVLM), as a feature encoder to extract visual-linguistic crossmodality features and introduce a small set of trainable parameters to prompt SAM [20] for reasoning segmentation. RECODE [23] and CuPL [42] leverage the knowledge in LLMs to generate informative descriptions as prompts for different categories classification. Unlike these works, we capitalize on the prompt capability of LLMs to help decompose a single referring description into multiple target object-related phrases, which are then used in our progressive comprehension process for RIS. ", "page_idx": 2}, {"type": "text", "text": "3 Our Method ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "In this work, we observe that when identifying an object based on a description, humans tend to first pinpoint multiple relevant objects and then narrow their focus to the target through step-by-step reasoning [48, 41]. Inspired by this, we propose a Progressive Comprehension Network (PCNet) for WRIS, which enhances cross-modality alignment by progressively integrating target-related text cues at multiple stages. Fig. 2 shows the overall framework of our PCNet. ", "page_idx": 2}, {"type": "text", "text": "Given an image I and a referring expression $\\mathbf{T}$ as input, we first feed $\\mathbf{T}$ into a Large Language Model (LLM) to break it down into $K$ short phrases $T_{s u b}\\,=\\,\\{t_{0},t_{1},\\,\\cdot\\,\\cdot\\,,t_{K-1}\\}$ , referred to as target-related text cues. We then feed image I and referring expression $\\mathbf{T}$ and the set of short phrases $\\mathcal{T}_{s u b}$ into image encoder and text encoder to obtain visual feature $\\mathbf{V}_{0}\\in\\mathbb{R}^{H\\times W\\times C_{v}}$ and language ", "page_idx": 2}, {"type": "image", "img_path": "MxdyGXoK9h/tmp/e21585938896c0a0bcc7dfd6feb94a02681758a9a6d290ac63aeecbbcc361f60.jpg", "img_caption": ["Cls Classification loss RaS Region-aware Shrinking loss IaD Instance-aware Disambiguation loss CRM Conditional Referring Module $\\oplus$ Concatenation "], "img_footnote": [], "page_idx": 3}, {"type": "text", "text": "Figure 2: The pipeline of PCNet. Given a pair of image-text as input, PCNet enhances the visuallinguistic alignment by progressively comprehending the target-related textual nuances in the text description. It starts with using a LLM to decompose the input description into several target-related short phrases as target-related textual cues. The proposed Conditional Referring Module (CRM) then processes these cues to update the linguistic embeddings across multiple stages. Two novel loss functions, Region-aware Shrinking (RaS) and Instance-aware Disambiguation (IaD), are also proposed to supervise the progressive comprehension process. ", "page_idx": 3}, {"type": "text", "text": "feature $\\mathbf{Q}_{0}\\in\\mathbb{R}^{1\\times C_{t}}$ , and $\\mathcal{Q}_{s u b}=\\left\\{\\mathbf{q}_{0},\\mathbf{q}_{1},\\,\\cdot\\,\\cdot\\,,\\mathbf{q}_{K-1}\\right\\}$ , with $\\mathbf{q}_{k}\\in\\mathbb{R}^{1\\times C_{t}}$ , where $H=H_{I}/s$ and $W=W_{I}/s$ . $C_{v}$ and $C_{l}$ denote the numbers of channels of visual and text features. $s$ is the ratio of down-sampling. We then use projector layers to transform the visual feature $\\mathbf{V}_{0}$ and textual features $\\mathbf{Q}_{0}$ and $\\mathcal{Q}_{s u b}$ to a unified dimension $C$ , i.e., $\\mathbf{V}_{0}\\in\\mathbb{R}^{H\\times W\\times C}$ , $\\mathbf{Q}_{0}$ and $\\mathbf{q}_{i}$ are in $\\mathbb{R}^{1\\times C}$ . ", "page_idx": 3}, {"type": "text", "text": "We design PCNet with multiple consecutive Conditional Referring Modules (CRMs) to progressively locate the target object across $N$ stages1. Specifically, at stage $n$ , the $n$ -th CRM updates the referring embedding $\\mathbf{Q}_{n}$ into $\\mathbf{Q}_{n+1}$ conditioned on the short phrase $q_{n}$ from the proposed Referring Modulation block. Both $\\mathbf{Q}_{n+1}$ and visual embedding $\\mathbf{V}_{n}$ are fed into Response Map Generation to generate the text-to-image response map ${\\bf R}_{n}$ and updated visual embedding $\\mathbf{V}_{n+1}$ . Finally, the response map ${\\mathbf{R}}_{N-1}$ generated by the $n$ -th CRM is used as the final localization result. To optimize the resulting response map for accurate visual localization, we employ the pre-trained proposal generator to obtain localization-matched mask proposals. We also propose Region-aware Shrinking (RaS) loss to constrain the visual localization in a coarse-to-fine manner, and Instance-aware Disambiguation (IaD) loss to suppress instance localization ambiguity. ", "page_idx": 3}, {"type": "text", "text": "In the following subsections, we first discuss how we decompose the input referring expression into target-related cues in Sec. 3.1. We then introduce the CRM in Sec. 3.2. Finally, we present our Region-aware Shrinking loss in Sec. 3.3, and Instance-aware Disambiguation loss in Sec. 3.4. ", "page_idx": 3}, {"type": "text", "text": "3.1 Generation of Target-related Cues ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "Existing works typically encode the entire input referring text description, and can easily overlook some critical cues (e.g., attributes and relations) in the description (particularly for a long/complex description), leading to target localization problems. To address this problem, we propose dividing the input description into short phrases to process it individually. To do this, we leverage the strong in-context capability of the LLM [1] to decompose the text description. We design a prompt, with four parts, to instruct the LLM to do this: (1) general instruction $\\mathbf{P}_{G}$ ; (2) output constraints $\\mathbf{P}_{C}$ ; (3) in-context task examples $\\mathbf{P}_{E}$ ; and (4) input question $\\mathbf{P}_{Q}$ . $\\mathbf{P}_{G}$ describes the overall instruction, e.g.\u201cdecomposing the referring text into target object-related short phrases\u201d. $\\mathbf{P}_{C}$ elaborates the output setting, e.g., sentence length of each short phrase. In $\\mathbf{P}_{E}$ , we specifically curate several in-context pairs as guidance for the LLM to generate analogous outputs. Finally, $\\mathbf{P}_{Q}$ encapsulates the input text description and the instruction words for the LLM to execute the operation. The process of generating ", "page_idx": 3}, {"type": "text", "text": "target-related cues is formulated as: ", "page_idx": 4}, {"type": "equation", "text": "$$\n{\\mathcal{T}}_{s u b}=\\{t_{0},t_{1},\\,\\cdot\\cdot\\cdot,t_{K-1}\\}=\\mathrm{LLM}\\,(\\mathbf{P}_{G},\\mathbf{P}_{C},\\mathbf{P}_{E},\\mathbf{P}_{Q}),\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "where $K$ represents the total number of phrases, which varies depending on the input description. Typically, longer descriptions more likely yield more phrases. To maintain consistency in our training dataset, we standardize it to five phrases (i.e., $K=5$ ). If fewer than five phrases are produced, we simply duplicate some of the short phrases to obtain five short phrases. In this way, phrases generated by LLM are related to the target object and align closely with our objective. ", "page_idx": 4}, {"type": "text", "text": "3.2 Conditional Referring Module (CRM) ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "Given the decomposed phrases (i.e., target-related cues), we propose a CRM to enhance the discriminative ability on the target object region conditioned on these phrases, thereby improving localization accuracy. As shown in Fig. 2, the CRM operates across $N$ consecutive stages. At each stage, it first utilizes a different target-related cue to modulate the global referring embedding via a referring modulation block and then produces the image-to-text response map through a response map generation block. ", "page_idx": 4}, {"type": "text", "text": "Referring Modulation Block. Considering the situation at stage $n$ , we first concatenate one targetrelated cue $q_{n}$ and the $L$ negative text cues obtained from other images 2, to form $\\mathbf{q}_{n}^{\\prime}\\in\\mathbb{R}^{(L+1)\\times C}$ . We then fuse the visual features $\\mathbf{V}_{n}$ with ${\\bf q}_{n}^{\\prime}$ through a vision-to-text cross-attention, to obtain vision-attended cue features $\\hat{\\mathbf{q}}_{n}\\in\\mathbb{R}^{(L+1)\\times C}$ , as: ", "page_idx": 4}, {"type": "equation", "text": "$$\nA_{v\\rightarrow t}=\\mathrm{SoftMax}\\left((\\mathbf{q}_{n}^{\\prime}W_{1}^{q^{\\prime}})\\otimes(\\mathbf{V}_{n}W_{2}^{V})^{\\top}/\\sqrt{C}\\right);\\,\\,\\hat{\\mathbf{q}}_{n}=\\mathrm{MLP}(A_{v\\rightarrow t}\\otimes(\\mathbf{V}_{n}W_{3}^{V}))+\\mathbf{q}_{n}^{\\prime},\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "where $A_{v\\rightarrow t}\\in\\mathbb{R}^{(L+1)\\times H\\times W}$ denotes the vision-to-text inter-modality attention weight. $W_{*}^{V}$ and $\\boldsymbol{W}_{*}^{q^{\\prime}}$ are learnable projection layers. $\\otimes$ denotes matrix multiplication. Using the vision-attended cue features $\\hat{\\mathbf{q}}_{n}$ , we then enrich the global textual features $\\mathbf{Q}_{n}$ into cue-enhanced textual features $\\mathbf{Q}_{n+1}\\in\\mathbb{R}^{1\\times\\bar{C}}$ through another text-to-text cross-attention, as: ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{A_{t\\rightarrow t}=\\mathrm{SoftMax}\\left(\\left(\\mathbf{Q}_{n}W_{1}^{\\bar{q}}\\right)\\otimes(\\hat{\\mathbf{q}}_{n}W_{2}^{\\bar{q}})^{\\top}/\\sqrt{C}\\right);\\ \\mathbf{Q}_{n+1}=\\mathrm{MLP}(A_{t\\rightarrow t}\\otimes(\\hat{\\mathbf{q}}_{n}W_{3}^{\\bar{q}}))+\\mathbf{Q}_{n},}\\end{array}\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "where $A_{t\\rightarrow t}\\in\\mathbb{R}^{1\\times(L+1)}$ represents the text-to-text intra-modality attention weight. $\\boldsymbol{W}_{*}^{Q}$ and $\\boldsymbol{W}_{*}^{\\hat{q}}$ are learnable projection layers. In this way, we can enhance the attention of $\\mathbf{Q}_{n}$ on the target object by conditioning its own target-related cue features and the global visual features. ", "page_idx": 4}, {"type": "text", "text": "Response Map Generation. To compute the response map, we first update the visual features $\\mathbf{V}_{n}$ to $\\hat{\\mathbf{V}}_{n}$ by integrating them with the updated referring text embedding $\\mathbf Q_{n+1}$ using a text-to-visual cross-attention, thereby reducing the cross-modality discrepancy. Note that $\\hat{\\mathbf{V}}_{n}$ is then used in the next stage (i. $e.,\\mathbf{V}_{n+1}=\\hat{\\mathbf{V}}_{n})$ . The response map ${\\bf R}_{n}\\in\\mathbb{R}^{H\\times W}$ at the $n$ -th stage is computed as: ", "page_idx": 4}, {"type": "equation", "text": "$$\n{\\bf R}_{n}=\\mathrm{Norm}(\\mathrm{ReLU}(\\hat{{\\bf V}}_{n}\\otimes{\\bf Q}_{n+1}^{\\top})),\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "where Norm normalizes the output in the range of [0,1]. To achieve global visual-linguistic alignment, we adopt classification loss $\\mathcal{L}_{\\mathrm{C1s}}$ in [30] to optimize the generation of the response map at each stage. It formulates the target localization problem as a classification process to differentiate between positive and negative text expressions. While the referring text expressions for an image are used as positive expressions, the ones from other images can be used as negative for this image. More explanations are given in appendix. ", "page_idx": 4}, {"type": "text", "text": "3.3 Region-aware Shrinking (RaS) Loss ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "Despite modulating the referring attention with the target-related cues stage-by-stage, image-text classification often activates irrelevant background objects due to its reliance on global and coarse response map constraints. Ideally, as the number of target-related cues used increases across each stage, the response map should become more compact and accurate. However, directly constraining the latter stage to have a more compact spatial activation than the former stage can lead to a trivial solution (i.e., without target activation). To address this problem, we propose a novel region-aware shrinking (RaS) loss, which segments the response map into foreground (target) and background (non-target) regions. Through contrastive enhancement between these regions, our method gradually reduces the background interference while refining the foreground activation in the response map. ", "page_idx": 4}, {"type": "text", "text": "", "page_idx": 5}, {"type": "text", "text": "Specifically, at stage $n$ , we first employ a pretrained proposal generator to obtain a set of mask proposals, $\\mathcal{M}\\,=\\,\\bar{\\{}m_{1},m_{2},}\\cdot\\cdot\\cdot,m_{P}^{\\bar{\\phantom{}}}\\}$ , where each proposal $m_{p}$ is in $\\mathbb{R}^{H\\times W}$ and $P$ is the total number of segment proposals. We then compute a alignment score between the response map ${\\bf R}_{n}$ and each proposal $m_{p}$ in $\\mathcal{M}$ as: ", "page_idx": 5}, {"type": "equation", "text": "$$\nS_{n}=\\{s_{n,1},\\,s_{n,2},\\,\\,\\cdot\\,\\cdot\\,,s_{n,P}\\}\\mathrm{~with~}s_{n,p}=\\operatorname*{max}(\\mathbf{R}_{n}\\odot m_{p}),\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "where $\\odot$ denotes the hadamard product. The proposal with the highest score (denoted as $m_{f}$ ) is then treated as the target foreground region, while the combination of other proposals (denoted as $m_{b}$ ) is regarded as non-target background regions. With the separated regions, we define a localization ambiguity $S_{n}^{a m b}$ , which measures the uncertainty of the target object localization in the current stage $n$ , as: ", "page_idx": 5}, {"type": "equation", "text": "$$\nS_{n}^{a m b}=1-\\left(\\mathrm{IoU}({\\bf R}_{n},m_{f})-\\mathrm{IoU}({\\bf R}_{n},m_{b})\\right),\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "where $S_{n}^{a m b}$ is in the range of [0, 1], and IoU denotes the intersection over union. When the localization result (i.e., the response map) matches the only target object proposal instance exactly, ambiguity is 0. Conversely, if it matches the more background proposals, ambiguity approaches 1. ", "page_idx": 5}, {"type": "text", "text": "Assuming that each target in the image corresponds to an instance, by integrating more cues, the model will produce a more compact response map and gradually reduce the ambiguity. Consequently, based on the visual localization results from two consecutive stages, we can formulate the region-aware shrinking objective for a total of $N$ stages as: ", "page_idx": 5}, {"type": "equation", "text": "$$\n\\mathcal{L}_{\\mathtt{R a S}}=\\frac{1}{N-1}\\sum_{n=0}^{N-2}\\operatorname*{max}\\left(0,(S_{n+1}^{a m b}-S_{n}^{a m b})\\right).\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "By introducing region-wise ambiguity, $\\mathcal{L}_{\\mathtt{R a S}}$ can direct non-target regions to converge towards attenuation while maintaining and improving the quality of the response map in the target region. This enables the efficient integration of target-related textual cues for progressively finer cross-modal alignment. Additionally, the mask proposals can also provide a shape prior to the target region, which helps to further enhance the accuracy of the target object localization. ", "page_idx": 5}, {"type": "text", "text": "3.4 Instance-aware Disambiguation (IaD) Loss ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "Although the RaS loss can help improve the localization accuracy by reducing region-wise ambiguity within one single response map, it takes less consideration of the relation between different instancewise response maps. Particularly, we note that, given different referring descriptions that refer to different objects of an image, there are usually some overlaps among the corresponding response maps. For example, in Fig. 2, the player in the middle is simultaneously activated by two referring expressions (i.e., the response maps $\\mathbf{R}_{*,a}$ and $\\mathbf{R}_{*,d}$ have overlapping activated regions), resulting in inaccurate localization. To address this problem, we propose an Instance-aware Disambiguation (IaD) loss to help enforce that different regions of the response maps within a stage are activated if the referring descriptions of an image refer to different objects. ", "page_idx": 5}, {"type": "text", "text": "Specifically, given a pair of image ${\\mathbf{I}}_{a}$ and input text description ${\\mathbf{T}}_{a}$ , we first sample extra $N_{d}$ text descriptions, $\\mathcal{T}_{d}=\\{t_{1},t_{2},\\,\\cdot\\cdot\\cdot,t_{N_{d}}\\}$ , where the referred target object of each text description $t_{d}$ is in the image ${\\mathbf{I}}_{a}$ but is different from the target object referred to by ${\\mathbf{T}}_{a}$ . We then obtain the image-to-text response maps ${\\mathbf{R}}_{a}$ and $\\mathcal{R}_{d}\\,=\\,\\{\\bar{\\mathbf{R}_{1}},\\mathbf{R}_{2}^{\\bar{\\}},\\cdot\\cdot\\cdot,\\mathbf{R}_{N_{d}}\\}$ for ${\\mathbf{T}}_{a}$ and $\\tau_{d}$ through Eq. (4). Here, we omit the stage index $n$ for clarity. Then, based on the Eq. (5), we obtain the alignment scores $\\textstyle S_{a}$ and $\\{S_{d}\\}_{d=1}^{N_{d}}$ for ${\\mathbf{T}}_{a}$ and $\\tau_{d}$ . In $\\boldsymbol{S}$ , the larger the value, the higher the alignment between the corresponding proposal (specified by the index) and the current text. To disambiguate overlapping activated regions, we constrain that the maximum index of the alignment score between $\\textstyle S_{a}$ and each of $\\textstyle S_{d}$ must be different from each other (i.e., different texts must activate different objects). Here, we follow [50] to compute the index vector, $\\boldsymbol{y}\\in\\mathbb{R}^{1\\times P}$ , as: ", "page_idx": 5}, {"type": "equation", "text": "$$\ny=\\mathsf{o n e\\mathrm{-}h o t}(\\mathsf{a r g m a x}(S))+S-\\mathsf{s g}(S),\n$$", "text_format": "latex", "page_idx": 5}, {"type": "table", "img_path": "MxdyGXoK9h/tmp/81becf35a32bcfe2e60d191d55bed317907da69a39f551dcda946b80d3af1e23.jpg", "table_caption": ["Table 1: Quantitative comparison using mIoU and PointM metrics. \u201c(U)\" and \u201c(G)\" indicate the UMD and Google partitions. \u201cSegmentor\u201d denotes utilizing the pre-trained segmentation models (SAM [20] by default) for segmentation mask generation. $\\dagger$ denotes that the method is fully-supervised. \u201c-\u201d means unavailable values. Oracle represents the evaluation of the best proposal mask based on ground-truth. Best and second-best performances are marked in bold and underlined. "], "table_footnote": [], "page_idx": 6}, {"type": "text", "text": "where $\\operatorname{sg}(\\cdot)$ represents the stop gradient operation. Finally, we denote the index vectors for $\\textstyle S_{a}$ and $\\{S_{d}\\}_{d=1}^{N_{d}}$ as $y_{a}$ and $\\{y_{d}\\}_{d=1}^{N_{d}}$ , and we formulate the IaD loss as: ", "page_idx": 6}, {"type": "equation", "text": "$$\n\\mathcal{L}_{\\mathtt{I a D}}=\\frac{1}{N_{d}}\\sum_{d=1}^{N_{d}}\\left(1-||y_{a}-y_{d}||^{2}\\right).\n$$", "text_format": "latex", "page_idx": 6}, {"type": "text", "text": "By enforcing the constraint at each stage, the response maps activated by different referring descriptions in an image for different instances are separated, and the comprehension of the discriminative cues is further enhanced. ", "page_idx": 6}, {"type": "text", "text": "4 Experiments ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "4.1 Settings ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "Dataset. We have conducted experiments on three standard benchmarks: RefCOCO [61], RefCOCO+ [61], and RefCOCOg [39]. They are constructed based on MSCOCO [24]. Specially, the referring expressions in RefCOCO and $\\mathbf{RefCOCO+}$ focus more on object positions and appearances, respectively, and they are characterized by succinct descriptions, averaging 3.5 words in length. RefCOCOg contains much longer sentences (average length of 8.4 words), making it more challenging than others. RefCOCOg includes two partitions: UMD [40] and Google [39]. ", "page_idx": 6}, {"type": "text", "text": "Implementation Details. We train our framwork for 15 epochs with a batch size of 36 on an RTX4090 GPU. The total loss for training is $\\mathcal{L}_{\\mathrm{total}}=\\mathcal{L}_{\\mathtt{C l s}}+\\mathcal{L}_{\\mathtt{R a S}}+\\mathcal{L}_{\\mathtt{I a D}}$ . By default, we set the number of stages $N$ to 3, and the number of the additional text descriptions sampled for each image $N_{d}$ to 1. Without loss of generality, we use FreeSOLO [52] and SAM [20] as the proposal generators to obtain two versions: $\\mathrm{PCNet}_{S}$ and $\\mathrm{PCNet}_{F}$ . Refer to Sec. A for more implementation details. ", "page_idx": 6}, {"type": "image", "img_path": "MxdyGXoK9h/tmp/ec9cafd2d87db2f6453b1be6f32d74ef730a5ff28820972d01425fba625beda3.jpg", "img_caption": ["Figure 3: qVisual results of our PCNet. The green markers denote the peaks of the response maps. "], "img_footnote": [], "page_idx": 7}, {"type": "text", "text": "Evaluation Metrics. We argue that the key to WRIS is target localization, and the performance evaluation should not rely primarily on pixel-wise metrics. With the accurate localization points, pixel-level masks can be readily obtained by prompting the pre-trained segmentors (e.g., SAM [20]). Thus, following [18, 22, 30], we adopt localization-based metric (i.e., PointM), and pixel-wise metrics (i.e., mean and overall intersection-over-union (mIoU and oIoU) for evaluation. PointM [30] is used to evaluate the localization accuracy, which computes the ratio of activation peaks in the mask region. ", "page_idx": 7}, {"type": "text", "text": "4.2 Comparison with State-of-the-Art Methods ", "text_level": 1, "page_idx": 7}, {"type": "text", "text": "Quantitative comparison. Tab. 1 compares our method with various SOTA methods. Specifically, we first compare target localization accuracy using the PointM metric. We evaluate two model variants: $\\mathrm{PCNet}_{F}$ and $\\mathrm{PCNet}_{S}$ , which use different segmentors (e.g., FreeSOLO [52] and SAM [20]) to extract mask proposals for RaS and IaD losses. Even when using FreeSOLO as the proposal generator, our model still significantly outperforms all compared methods. For example, on the most challenging dataset, $\\mathbf{RefCOCOg}$ , with more complex object relationships and longer texts, $\\mathrm{PCNet}_{F}$ achieves performance improvements of $55.2\\%$ and $10.3\\%$ on the Val (G) set compared to SAG and TRIS3. $\\mathrm{PCNet}_{S}$ further boosts the performance if we replace FreeSOLO with the stronger SAM. ", "page_idx": 7}, {"type": "text", "text": "In addition, we verify the accuracy of the response map through pixel-wise mIoU metric. Results are shown in the middle part of Tab. 1. Our PCNet still achieves superior performances on all benchmarks, against all compared methods. Particularly, $\\mathrm{PCNet}_{F}$ and $\\mathrm{PCNet}_{S}$ outperform TRIS by an improvement of $10.8\\%$ and $14.1\\%$ mIoU, respectively, on the $\\mathbf{RefCOCOg}$ Val (G) set. In the bottom part of Tab. 1, we compare the accuracy of the extracted mask proposals generated using the target localization point (i.e., the peak point of the response map) to prompt SAM. We can see that our PCNet significantly outperforms other WRIS methods. We can also see that higher PointM values correlate with higher mIoU accuracy values of the corresponding mask proposals for different methods. We further tested the mask accuracy using the Ground-Truth localization point (i.e., the last row), and find that its performance even surpasses the fully-supervised method, LAVT [58]. All these results highlight the critical importance of target localization (i.e., peak point) for the WRIS task. ", "page_idx": 7}, {"type": "text", "text": "In Fig. 3, we show some visual results of our method across different scenes by using the target localization point (i.e., the green marker) to prompt SAM to generate the target mask. Our method effectively localizes the target instance among other instances within the image, even in complex scenarios with region occlusion (a), multiple instances (b), similar appearance (c), and dim light (d). ", "page_idx": 7}, {"type": "text", "text": "4.3 Ablation Study ", "text_level": 1, "page_idx": 7}, {"type": "text", "text": "We conduct ablation experiments on the RefCOCOg dataset and report the results on the Val (G) set from both $\\mathrm{PCNet}_{S}$ and $\\mathrm{PCNet}_{F}$ in Tab. 2, and from $\\mathrm{PCNet}_{F}$ in Tab. 3, Tab. 4, and Tab. 5. ", "page_idx": 7}, {"type": "text", "text": "Component Analysis. In Tab. 2, we first construct a single-stage baseline ( $l s t$ row) to optimize visual-linguistic alignment by removing all proposed components and using only the global imagetext classification loss $\\mathcal{L}_{\\mathrm{C1s}}$ . We then introduce the proposed conditional referring module (CRM) to the baseline to allow for multi-stage progressive comprehension (2nd row). To validate the efficacy of the region-aware shrinking loss (RaS) and instance-aware disambiguation loss (IaD), we introduce them separately ( $3r d$ and $4t h$ rows). Finally, we combine all proposed components (5th row). ", "page_idx": 7}, {"type": "table", "img_path": "MxdyGXoK9h/tmp/fe79b431abb43980cf8332d15b417b06420cde45d5be6e690ccce8aeb442afd7.jpg", "table_caption": ["Table 2: Component ablations on RefCOCOg Val (G) set. "], "table_footnote": [], "page_idx": 8}, {"type": "table", "img_path": "MxdyGXoK9h/tmp/dd7fb2ca020ec20436bbfaf545fca4aab94599746cdd893639a695b2b9678fb7.jpg", "table_caption": ["Table 3: Ablation of the number of iterative stages $N$ . "], "table_footnote": [], "page_idx": 8}, {"type": "table", "img_path": "MxdyGXoK9h/tmp/5c28d73709857a6b2ccda7a498bfe2c27d1bc98583b6200a0faa157dc49e8a26.jpg", "table_caption": ["Table 4: Ablation of different modulation strategies in CRM. "], "table_footnote": [], "page_idx": 8}, {"type": "table", "img_path": "MxdyGXoK9h/tmp/1b56187d754469af89783cbad3cd422d10d377f35e36deecb432d48fdc04a56d.jpg", "table_caption": ["Table 5: Ablation of the numbers of descriptions $N_{d}$ in IaD. "], "table_footnote": [], "page_idx": 8}, {"type": "text", "text": "The results demonstrate that $\\pmb{\\mathrm{\\Sigma}}$ even using only $\\mathcal{L}_{\\mathrm{C1s}}$ , progressively introducing target-related cues through CRM can still significantly enhance target object localization. In particular, PCNetS achieves improvements of $3.1\\%$ on PointM and $5.9\\%$ on mIoU; $\\pmb{\\varphi}$ by using $\\mathcal{L}_{\\mathrm{RaS}}$ to constrain response maps, making them increasingly compact and complete during the progressive comprehension process, the accuracy of target localization is dramatically enhanced, resulting in an improvement of $11.6\\%$ on PointM. $\\pmb{\\otimes}$ although $\\mathcal{L}_{\\mathtt{I a D}}$ can facilitate the separation of overlapping response maps between different instances within the same image and improve the discriminative ability of our model on the target object, the lack of constraints between consecutive stages results in a smaller performance improvement than $\\mathcal{L}_{\\mathrm{RaS}}$ ; and $\\pmb{\\mathbb{\\otimes}}$ all components are essential for our final PCNet, and combining them achieves the best performance. In Fig. 4, we also provide the visual results of the ablation study on two examples. We can see that each component can bring obvious localization improvement. ", "page_idx": 8}, {"type": "text", "text": "Number of Iterative Stages. In Tab. 3, we analyze the effect of the number of iterative stages $N$ . When $N=1$ , we can only apply $\\mathcal{L}_{\\mathrm{Cls}}$ and $\\mathcal{L}_{\\mathrm{IaD}}$ , but not $\\mathcal{L}_{\\mathtt{R a S}}$ , resulting in inferior results. Increasing $N$ from 1 to 2 significantly improves the performance due to the progressive introduction of targetrelated cues. However, the improvement from $N=2$ to $N=3$ is less pronounced than from $N=1$ to $N=2$ , and the performance stabilizes at $N=3$ . At $N=4$ , the performance slightly declines. This is because when the effective short-phrases decomposed by LLM are fewer than the number of stages, we need to repeat text phrases in later stages, which may affect the loss optimization. ", "page_idx": 8}, {"type": "text", "text": "Modulation Strategy. In Tab. 4, we ablate different variants of CRM: $\\pmb{\\mathrm{\\Sigma}}$ directly adding target cue features $\\mathbf{q}_{n}$ and global referring features $\\mathbf{Q}_{n}$ (denoted as ADD); $\\pmb{\\varphi}$ fusing $\\mathbf{q}_{n}$ and $\\mathbf{Q}_{n}$ using only text-to-text cross-attention (denoted as TTA); $\\pmb{\\otimes}$ first employing a vision-to-text cross-attention to fuse visual features $\\mathbf{V}_{n}$ and $\\mathbf{q}_{n}$ to obtain vision-attended features $\\hat{\\mathbf{q}}_{n}$ , and then adding them to $\\mathbf{Q}_{n}$ (denoted $\\mathrm{VTA+ADD}_{\\ i}$ ). The results demonstrate that ADD is the least efficient method. TTA ", "page_idx": 8}, {"type": "image", "img_path": "MxdyGXoK9h/tmp/8ea524c01449c75e7464ba35173d957b5d155c150ecfc0ffd80a10e967e21b90.jpg", "img_caption": ["Q: \u201ca light brown color sweet vada with dark brown one next to it\u201d ", "Figure 4: Visualization of the ablation study to show the efficacy of each proposed component. "], "img_footnote": [], "page_idx": 8}, {"type": "image", "img_path": "MxdyGXoK9h/tmp/61bb749addd1ac04132435f2c6f175af1aa9dcd16b4e849d9d27f512ca0820bd.jpg", "img_caption": ["Figure 5: A failure case of our PCNet. As our model design assumes that there is only one object referred to by the language expression, it usually returns only one object. "], "img_footnote": [], "page_idx": 9}, {"type": "text", "text": "outperforms ADD but is less effective than $\\mathrm{VTA+ADD}$ , verifying the importance of the vision context.   \nFinally, our CRM combines VTA and TTA and achieves the best results. ", "page_idx": 9}, {"type": "text", "text": "Number of Referring Texts. In Tab. 5, we analyze the effect of $N_{d}$ used in $\\mathcal{L}_{\\mathrm{LaD}}$ . The results show that $N_{d}=1$ is enough, and the performance deteriorates as $N_{d}$ increases. This is because an image typically has 2-3 text descriptions, which means $N_{d}$ should be 1-2. As $N_{d}$ increases, repeated sampling becomes more frequent, affecting model training and thus leading to poorer results. ", "page_idx": 9}, {"type": "text", "text": "5 Conclusion ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "In this paper, we have proposed a novel Progressive Comprehension Network (PCNet) to perfom progressive visual-linguistic alignment for the weakly-supervised referring image segmentation (WRIS) task. PCNet first leverages a LLM to decompose the input referring description into several target-related phrases, which are then used by the proposed Conditional Referring Module (CRM) to update the referring text embedding stage-by-stage, thus enhancing target localization. In addition, we proposed two loss functions, region-aware shrinking loss and instance-aware disambiguation loss, to facilitate comprehension of the target-related cues progressively. We have also conducted extensive experiments on three RIS benchmarks. Results show that the proposed PCNet achieves superior visual localization performances and outperforms existing SOTA WRIS methods by large margins. ", "page_idx": 9}, {"type": "text", "text": "Our method does have limitations. For example, as shown in Fig. 5, when the text description refers to multiple objects, our method fails to return all referring regions. This is because our model design always assumes that there is only one object referred to by the language expression. In the future, we plan to incorporate more fine-grained vision priors [35, 44] and open-world referring descriptions (e.g., camouflaged [12], semi-transparent [31], shadow [36] and etc.) into the model design to enable a more generalized solution. ", "page_idx": 9}, {"type": "text", "text": "References ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "[1] Achiam, J., Adler, S., Agarwal, S., Ahmad, L., Akkaya, I., Aleman, F.L., Almeida, D., Altenschmidt, J., Altman, S., Anadkat, S., et al.: Gpt-4 technical report. arXiv:2303.08774 (2023)   \n[2] Avrahami, O., Lischinski, D., Fried, O.: Blended diffusion for text-driven editing of natural images. In: CVPR. pp. 18208\u201318218 (2022)   \n[3] Brown, T., Mann, B., Ryder, N., Subbiah, M., Kaplan, J.D., Dhariwal, P., Neelakantan, A., Shyam, P., Sastry, G., Askell, A., et al.: Language models are few-shot learners. pp. 1877\u20131901 (2020)   \n[4] Chen, D., Wu, Z., Liu, F., Yang, Z., Huang, Y., Bao, Y., Zhou, E.: Prototypical contrastive language image pretraining. arXiv preprint arXiv:2206.10996 (2022)   \n[5] Chng, Y.X., Zheng, H., Han, Y., Qiu, X., Huang, G.: Mask grounding for referring image segmentation. arXiv:2312.12198 (2023)   \n[6] Dai, Q., Yang, S.: Curriculum point prompting for weakly-supervised referring image segmentation. In: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition. pp. 13711\u201313722 (2024)   \n[7] Ding, H., Liu, C., Wang, S., Jiang, X.: Vision-language transformer and query generation for referring segmentation. In: ICCV. pp. 16321\u201316330 (2021) [8] Du, Y., Bai, F., Huang, T., Zhao, B.: Segvol: Universal and interactive volumetric medical image segmentation. arXiv preprint arXiv:2311.13385 (2023)   \n[9] Feng, G., Zhang, L., Hu, Z., Lu, H.: Learning from box annotations for referring image segmentation. IEEE TNNLS (2022)   \n[10] He, C., Li, K., Zhang, Y., Xu, G., Tang, L., Zhang, Y., Guo, Z., Li, X.: Weakly-supervised concealed object segmentation with sam-based pseudo labeling and multi-scale feature grouping. NeurIPS 36 (2024)   \n[11] He, K., Zhang, X., Ren, S., Sun, J.: Deep residual learning for image recognition. In: CVPR. pp. 770\u2013778 (2016)   \n[12] He, R., Dong, Q., Lin, J., Lau, R.W.: Weakly-supervised camouflaged object detection with scribble annotations. In: AAAI (2023)   \n[13] Hertz, A., Mokady, R., Tenenbaum, J., Aberman, K., Pritch, Y., Cohen-or, D.: Prompt-to-prompt image editing with cross-attention control. In: ICLR (2022)   \n[14] Hu, R., Rohrbach, M., Darrell, T.: Segmentation from natural language expressions. In: ECCV. pp. 108\u2013124 (2016)   \n[15] Huang, S., Hui, T., Liu, S., Li, G., Wei, Y., Han, J., Liu, L., Li, B.: Referring image segmentation via cross-modal progressive comprehension. In: CVPR. pp. 10488\u201310497 (2020)   \n[16] Jiang, A.Q., Sablayrolles, A., Mensch, A., Bamford, C., Chaplot, D.S., Casas, D.d.l., Bressand, F., Lengyel, G., Lample, G., Saulnier, L., et al.: Mistral 7b. arXiv preprint arXiv:2310.06825 (2023)   \n[17] Kawar, B., Zada, S., Lang, O., Tov, O., Chang, H., Dekel, T., Mosseri, I., Irani, M.: Imagic: Text-based real image editing with diffusion models. In: CVPR. pp. 6007\u20136017 (2023)   \n[18] Kim, D., Kim, N., Lan, C., Kwak, S.: Shatter and gather: Learning referring image segmentation with text supervision. In: ICCV. pp. 15547\u201315557 (2023)   \n[19] Kim, N., Kim, D., Lan, C., Zeng, W., Kwak, S.: Restr: Convolution-free referring image segmentation using transformers. In: CVPR. pp. 18145\u201318154 (2022)   \n[20] Kirillov, A., Mintun, E., Ravi, N., Mao, H., Rolland, C., Gustafson, L., Xiao, T., Whitehead, S., Berg, A.C., Lo, W.Y., et al.: Segment anything. In: ICCV. pp. 4015\u20134026 (2023)   \n[21] Lai, X., Tian, Z., Chen, Y., Li, Y., Yuan, Y., Liu, S., Jia, J.: Lisa: Reasoning segmentation via large language model. arXiv:2308.00692 (2023)   \n[22] Lee, J., Lee, S., Nam, J., Yu, S., Do, J., Taghavi, T.: Weakly supervised referring image segmentation with intra-chunk and inter-chunk consistency. In: ICCV. pp. 21870\u201321881 (2023)   \n[23] Li, L., Xiao, J., Chen, G., Shao, J., Zhuang, Y., Chen, L.: Zero-shot visual relation detection via composite visual cues from large language models. In: NeurIPS (2024)   \n[24] Lin, T.Y., Maire, M., Belongie, S., Hays, J., Perona, P., Ramanan, D., Doll\u00e1r, P., Zitnick, C.L.: Microsoft coco: Common objects in context. In: ECCV. pp. 740\u2013755 (2014)   \n[25] Lin, Y., Chen, M., Wang, W., Wu, B., Li, K., Lin, B., Liu, H., He, X.: Clip is also an efficient segmenter: A text-driven approach for weakly supervised semantic segmentation. In: CVPR. pp. 15305\u201315314 (2023)   \n[26] Liu, C., Ding, H., Jiang, X.: Gres: Generalized referring expression segmentation. In: CVPR. pp. 23592\u201323601 (2023)   \n[27] Liu, C., Ding, H., Zhang, Y., Jiang, X.: Multi-modal mutual attention and iterative interaction for referring image segmentation. IEEE TIP (2023)   \n[28] Liu, D., Zhang, H., Wu, F., Zha, Z.J.: Learning to assemble neural module tree networks for visual grounding. In: ICCV. pp. 4673\u20134682 (2019)   \n[29] Liu, F., Kong, Y., Zhang, L., Feng, G., Yin, B.: Local-global coordination with transformers for referring image segmentation. Neurocomputing (2023)   \n[30] Liu, F., Liu, Y., Kong, Y., Xu, K., Zhang, L., Yin, B., Hancke, G., Lau, R.: Referring image segmentation using text supervision. In: ICCV. pp. 22124\u201322134 (2023)   \n[31] Liu, F., Liu, Y., Lin, J., Xu, K., Lau, R.W.: Multi-view dynamic reflection prior for video glass surface detection. In: AAAI (2024)   \n[32] Liu, H., Li, C., Wu, Q., Lee, Y.J.: Visual instruction tuning (2024)   \n[33] Liu, Y., Wang, X., Zhu, M., Cao, Y., Huang, T., Shen, C.: Masked channel modeling for bootstrapping visual pre-training. International Journal of Computer Vision pp. 1\u201321 (2024)   \n[34] Liu, Y., Zhu, M., Li, H., Chen, H., Wang, X., Shen, C.: Matcher: Segment anything with one shot using all-purpose feature matching. arXiv preprint arXiv:2305.13310 (2023)   \n[35] Liu, Y., Ke, Z., Liu, F., Zhao, N., Lau, R.W.: Diff-plugin: Revitalizing details for diffusion-based low-level tasks. In: CVPR (2024)   \n[36] Liu, Y., Ke, Z., Xu, K., Liu, F., Wang, Z., Lau, R.W.: Recasting regional lighting for shadow removal. In: AAAI (2024)   \n[37] Loshchilov, I., Hutter, F.: Decoupled weight decay regularization. In: ICLR (2018)   \n[38] Luo, G., Zhou, Y., Sun, X., Cao, L., Wu, C., Deng, C., Ji, R.: Multi-task collaborative network for joint referring expression comprehension and segmentation. In: CVPR. pp. 10034\u201310043 (2020)   \n[39] Mao, J., Huang, J., Toshev, A., Camburu, O., Yuille, A.L., Murphy, K.: Generation and comprehension of unambiguous object descriptions. In: CVPR. pp. 11\u201320 (2016)   \n[40] Nagaraja, V.K., Morariu, V.I., Davis, L.S.: Modeling context between objects for referring expression understanding. In: ECCV. pp. 792\u2013807 (2016)   \n[41] Plass, J.L., Moreno, R., Br\u00fcnken, R.: Cognitive load theory. Cambridge University Press (2010)   \n[42] Pratt, S., Covert, I., Liu, R., Farhadi, A.: What does a platypus look like? generating customized prompts for zero-shot image classification. In: ICCV. pp. 15691\u201315701 (2023)   \n[43] Radford, A., Kim, J.W., Hallacy, C., Ramesh, A., Goh, G., Agarwal, S., Sastry, G., Askell, A., Mishkin, P., Clark, J., et al.: Learning transferable visual models from natural language supervision. In: ICML. pp. 8748\u20138763 (2021)   \n[44] Rombach, R., Blattmann, A., Lorenz, D., Esser, P., Ommer, B.: High-resolution image synthesis with latent diffusion models. In: CVPR (2022)   \n[45] Salewski, L., Alaniz, S., Rio-Torto, I., Schulz, E., Akata, Z.: In-context impersonation reveals large language models\u2019 strengths and biases. In: NeurIPS (2024)   \n[46] Shaharabany, T., Tewel, Y., Wolf, L.: What is where by looking: Weakly-supervised open-world phrase-grounding without text inputs. pp. 28222\u201328237 (2022)   \n[47] Shao, H., Qian, S., Xiao, H., Song, G., Zong, Z., Wang, L., Liu, Y., Li, H.: Visual cot: Unleashing chain-of-thought reasoning in multi-modal language models. arXiv preprint arXiv:2403.16999 (2024)   \n[48] Simon, H.A., Newell, A.: Human problem solving: The state of the theory in 1970. American Psychologist (1971)   \n[49] Touvron, H., Lavril, T., Izacard, G., Martinet, X., Lachaux, M.A., Lacroix, T., Rozi\u00e8re, B., Goyal, N., Hambro, E., Azhar, F., et al.: Llama: Open and efficient foundation language models. arXiv:2302.13971 (2023) ", "page_idx": 9}, {"type": "text", "text": "", "page_idx": 10}, {"type": "text", "text": "", "page_idx": 11}, {"type": "text", "text": "[50] Van Den Oord, A., Vinyals, O., et al.: Neural discrete representation learning (2017) ", "page_idx": 12}, {"type": "text", "text": "[51] Wang, X., Huang, Q., Celikyilmaz, A., Gao, J., Shen, D., Wang, Y.F., Wang, W.Y., Zhang, L.: Reinforced cross-modal matching and self-supervised imitation learning for vision-language navigation. In: CVPR. pp. 6629\u20136638 (2019)   \n[52] Wang, X., Yu, Z., De Mello, S., Kautz, J., Anandkumar, A., Shen, C., Alvarez, J.M.: Freesolo: Learning to segment objects without annotations. In: CVPR. pp. 14176\u201314186 (2022)   \n[53] Xia, Z., Han, D., Han, Y., Pan, X., Song, S., Huang, G.: Gsva: Generalized segmentation via multimodal large language models. arXiv:2312.10103 (2023)   \n[54] Xu, J., De Mello, S., Liu, S., Byeon, W., Breuel, T., Kautz, J., Wang, X.: Groupvit: Semantic segmentation emerges from text supervision. In: CVPR. pp. 18134\u201318144 (2022)   \n[55] Yang, S., Qu, T., Lai, X., Tian, Z., Peng, B., Liu, S., Jia, J.: An improved baseline for reasoning segmentation with large language model. arXiv:2312.17240 (2023)   \n[56] Yang, S., Li, G., Yu, Y.: Dynamic graph attention for referring expression comprehension. In: Proceedings of the IEEE/CVF International Conference on Computer Vision. pp. 4644\u20134653 (2019)   \n[57] Yang, Z., Ke, Z., Hancke, G., Lau, R.: Cross-domain semantic decoupling for weakly-supervised semantic segmentation (2023)   \n[58] Yang, Z., Wang, J., Tang, Y., Chen, K., Zhao, H., Torr, P.H.: Lavt: Language-aware vision transformer for referring image segmentation. In: CVPR. pp. 18155\u201318165 (2022)   \n[59] Ye, J., Chen, X., Xu, N., Zu, C., Shao, Z., Liu, S., Cui, Y., Zhou, Z., Gong, C., Shen, Y., et al.: A comprehensive capability analysis of gpt-3 and gpt-3.5 series models. arXiv:2303.10420 (2023)   \n[60] Yu, L., Lin, Z., Shen, X., Yang, J., Lu, X., Bansal, M., Berg, T.L.: Mattnet: Modular attention network for referring expression comprehension. In: CVPR. pp. 1307\u20131315 (2018)   \n[61] Yu, L., Poirson, P., Yang, S., Berg, A.C., Berg, T.L.: Modeling context in referring expressions. In: ECCV. pp. 69\u201385 (2016)   \n[62] Zhu, F., Zhu, Y., Chang, X., Liang, X.: Vision-language navigation with self-supervised auxiliary reasoning tasks. In: CVPR. pp. 10012\u201310022 (2020)   \n[63] Zhu, L., Zhou, J., Liu, Y., Hao, X., Liu, W., Wang, X.: Weaksam: Segment anything meets weakly-supervised instance-level recognition. arXiv preprint arXiv:2402.14812 (2024)   \n[64] Zong, Z., Ma, B., Shen, D., Song, G., Shao, H., Jiang, D., Li, H., Liu, Y.: Mova: Adapting mixture of vision experts to multimodal context. arXiv preprint arXiv:2404.13046 (2024) ", "page_idx": 12}, {"type": "text", "text": "A More Implementation Details ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "A.1 Generation of Target-related Cues ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "To obtain multiple target-related cues, we leverage the strong in-context capability of the Large Language Model (LLM) [16] to decompose the input referring expression and obtain the target-related textual cues. The Fig. 6 presents the LLM prompting details. ", "page_idx": 13}, {"type": "text", "text": "The prompt includes four parts: (1) general instruction $\\mathbf{P}_{G}$ , (2) output constraints $\\mathbf{P}_{C}$ , (3) incontext task examples $\\mathbf{P}_{E}$ , and (4) input question $\\mathbf{P}_{Q}$ . In part $\\mathbf{P}_{G}$ , we define a overall instruction for our task (i.e, decomposing the referring text) Then in part $\\mathbf{P}_{C}$ , we elaborate some details about the output (e.g, the sentence length for each cue description). In part $\\mathbf{P}_{E}$ , we curate ", "page_idx": 13}, {"type": "image", "img_path": "MxdyGXoK9h/tmp/df15f99b4f93667a7b27a80450c8f4be19f06d93976cedf96d773cce33ad129c.jpg", "img_caption": ["Figure 6: Flow of LLM-based referring text decomposition. "], "img_footnote": [], "page_idx": 13}, {"type": "text", "text": "several in-context learning examples as guidance for the LLM to generating analogous output. Considering that the input referring expressions contain various sentence structures, in part $\\mathbf{P}_{E}$ the more examples given, the more reliable the output will be. The part $\\mathbf{P}_{Q}$ instructs the LLM to output the results given the input referring expression. ", "page_idx": 13}, {"type": "image", "img_path": "MxdyGXoK9h/tmp/4eb18665b14c1adf320b2c807b209926132750f2f2603f745d391b438369c7d3.jpg", "img_caption": [], "img_footnote": [], "page_idx": 13}, {"type": "text", "text": "Figure 7: LLM generated examples. We show the LLM generated examples for long language expressions in (a)-(f) and the ones for short language expressions in (g)-(i). \u201cQ\u201d denotes the input language expression and the \u201cA\u201d denotes the output target-related textual cues of LLM. ", "page_idx": 13}, {"type": "text", "text": "In Fig. 7, we give some examples of decomposing the referring expressions. The \u201cQ\u201d denotes the input referring content and the \u201cA\u201d denotes the answers of LLM. In most cases, we can obtain reliable target-related textual cues that do not contradict the original text input. Besides, we also notice that there are some cases in which the text is not sufficiently decomposed (e.g, the example (c)) or the LLM outputs redundant results (e.g, the example (f)), which hinders the model to benefit from progressive comprehension to some extent. ", "page_idx": 14}, {"type": "text", "text": "A.2 Text-to Image Classification Loss ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "Our work consists of multiple stages and utilizes $\\mathcal{L}_{\\mathrm{cls}}$ in TRIS [30] at each stage independently for response maps optimization. Here, we omit the index of stage $n$ for clarity. $\\mathcal{L}_{\\mathrm{c1s}}$ formulates the target localization problem as a classification process to differentiate between positive and negative text expressions. The key idea of $\\mathcal{L}_{\\mathrm{cls}}$ loss function is to contrast image-text pairs such that correlated image-text pairs have high similarity scores and uncorrelated image-text pairs have low similarity scores. While the referring text expressions for an image are used as positive expressions, the referring text expressions from other images can be used as negative expressions for this image. Thus, given a batch (i.e., $B$ ) of image samples , each sample is mutually associated with one positive reference text (i.e., a text describing a specific object in the current image) and mutually exclusive with L negative reference texts (texts that are not related to the target object in the image). Note that the number of batches is equal to the sum of the positive samples and the negative samples (i.e., $B=1+L)$ . ", "page_idx": 14}, {"type": "text", "text": "Speficially, in each training batch, $B$ image-text pairs $\\{\\mathbf{I}_{i},\\mathbf{T}_{i}\\}_{i=1}^{B}$ are sampled. Through the language and vision encoders, we can get referring embeddings $\\mathbf{Q}\\,\\in\\,\\bar{\\mathbb{R}}^{B\\times C}$ and image embeddings $\\textbf{V}\\in$ $\\mathbb{R}^{B\\times H\\times W\\times C}$ . Then, we obtain the response maps $\\mathbf{R}\\in\\mathbb{R}^{\\bar{B}\\times B\\times H\\times W}$ by applying cosine similarity calculation and normalization operation. After the pooling operation as done in TRIS, we further obtain the alignment score matrix $\\mathbf{y}\\in\\mathbb{R}^{B\\times B}$ . According to the $\\mathcal{L}_{\\mathrm{cls}}$ , for $i_{\\mathrm{th}}$ image in the batch, there is a prediction score $\\mathbf{y}[i,:]$ , where ${\\bf y}[i,i]$ predicted by the corresponding text deserves a higher value (i.e, the positive one) and the others deserve lower values ( $L$ negative ones). Then classification loss for the $i_{t h}$ image from the batch can be formulated as cross-entropy loss: ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\mathcal{L}_{\\mathrm{cls},i}=-\\frac{1}{B}\\sum_{j=1}^{B}\\left(\\mathbb{1}_{i=j}\\log\\left(\\frac{1}{1+e^{-{\\bf y}[i,j]}}\\right)+(1-\\mathbb{1}_{i=j})\\log\\left(\\frac{e^{-{\\bf y}[i,j]}}{1+e^{-{\\bf y}[i,j]}}\\right)\\right),\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "and the classification loss for the batch can be formulated as: ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\mathcal{L}_{\\mathtt{c l s}}=\\frac{1}{B}\\sum_{i=1}^{B}\\mathcal{L}_{\\mathtt{c l s},i}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "The $i$ denotes the index for the visual image and the $j$ denotes the index for the referring text. ", "page_idx": 14}, {"type": "text", "text": "A.3 Referring Modulation Block ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "In Sec. 3.2, we have mentioned that the conditional referring module (CRM) utilizes the decomposed textual cues to progressively modulate the referring embedding via a modulation block across $N$ consecutive stages, and then produces the image-to-text response map by computing the patch-based similarity between visual and language embeddings. ", "page_idx": 14}, {"type": "text", "text": "Specifically, the modulation block is implemented by a vision-to-text and a textto-text cross-attention mechanism in cascade for facilitating the interaction between cross-modal features. In Fig. 8, we give an overview of the block design. For the block at each stage, We concatenate one targetrelated cue and the $L$ negative text cues obtained from other images as the conditional text cues and then obtain the visionattended cue features by the vision-to-text attention. Then by learning the interaction between referring embedding and different textual cue embeddings, the block is expec ", "page_idx": 14}, {"type": "text", "text": "", "page_idx": 14}, {"type": "image", "img_path": "MxdyGXoK9h/tmp/c454a5ec51b0c2ca183c5732f3115f8ccfc7b74a54180d878e4d18f849d25db5.jpg", "img_caption": ["Figure 8: Illustration of referring modulation block. ted to enhance the integration of discriminative cues. "], "img_footnote": [], "page_idx": 14}, {"type": "text", "text": "A.4 Training and Inference ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "We implement our framework on PyTorch and train it for 15 epochs with a batch size of 36 (i.e., $L+1)$ on a RTX4090 GPU with 24GB of memory. The input images are resized to $320\\times320$ . We use ResNet-50 [11] as our backbone of image encoder, and utilize the pre-trained CLIP [43] model to initialize the image and text encoders. The down-sampling ratio of visual feature $s\\,=32$ , the channels of vision feature $C_{v}=2048$ , text features $C_{l}=1024$ , and the unified hidden dimension $C=1024$ . The network is optimized using the AdamW optimizer [37] with a weight decay of $1e^{-2}$ and an initial learning rate of $5e^{-5}$ with polynomial learning rate decay. For the LLM, we utilize the open-source powerful language model Mistral 7B [16] for referring text decomposition. For the proposal generator, we set the number of extracted proposals $P=40$ for each image. ", "page_idx": 15}, {"type": "text", "text": "B More Quantitative Studies ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "B.1 Comparisons with other SOTA methods ", "text_level": 1, "page_idx": 15}, {"type": "table", "img_path": "MxdyGXoK9h/tmp/bcc584f0b07e94b98c907f04c346a2a001cba3a0ad3ca42d29e53fe43728de84.jpg", "table_caption": ["Table 6: Different criterions for alignment score measurement in $\\mathcal{L}_{\\mathtt{R a S}}$ . "], "table_footnote": [], "page_idx": 15}, {"type": "table", "img_path": "MxdyGXoK9h/tmp/b011bd0e52f41677665a21120dc2137306e84588950a3c92af2319ceb01166d4.jpg", "table_caption": ["Table 7: Different criterions for alignment score measurement in $\\mathcal{L}_{\\mathtt{I a D}}$ . "], "table_footnote": [], "page_idx": 15}, {"type": "text", "text": "In Tab. 6 and Tab. 7, we conduct the ablation studies about the measurement criterion of alignment score. The results demonstrate that the maximum value of the response map in each proposal better represents the alignment level of region-wise cross-modal alignment than the average ", "page_idx": 15}, {"type": "table", "img_path": "MxdyGXoK9h/tmp/dc4270786d8acbe6f59bee7513edc80546716ee191839f06e003a726a3302c61.jpg", "table_caption": ["Table 8: Comparison between different stages. "], "table_footnote": [], "page_idx": 15}, {"type": "text", "text": "value. To validate the effectiveness of the modeling the progressive comprehension, we also quantitatively compare the outputs of our method at different stages in Tab. 8. The results show that the localization results gradually improve with more discriminative cues integration, especially in the early stages. ", "page_idx": 15}, {"type": "text", "text": "B.2 More Ablation Studies ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "Comparison between IaD loss and others. In our IaD loss $\\mathcal{L}_{\\mathtt{I a D}}$ , we adopt a hard assignment for deriving the loss function as GroupViT [54]. The motivation is that we aims to get the pseudo mask prediction by the accurate peak value point (i.e., the hard assignment results) instead of relying on whole score distribution $S(\\cdot)$ (e.g., $S_{a}$ , $S_{d}$ in Sec. 3.4). ", "page_idx": 15}, {"type": "text", "text": "Thus utilizing the hard assignment to derive the IaD loss well matches our purpose, which helps rectify the ambiguous localization results. If we use the soft assignment (e.g., measuring KL divergence between $S_{a}$ and $S_{d}$ ), though the equivalent may be simpler, it not only does not match our purpose but also introduces more tricky com", "page_idx": 15}, {"type": "table", "img_path": "MxdyGXoK9h/tmp/80769e5339eca5169f7120223c86e027e81b19a241693794ab036fb3fb5be9d1.jpg", "table_caption": ["Table 9: Comparison between IaD loss and KL loss. "], "table_footnote": [], "page_idx": 15}, {"type": "text", "text": "ponents for optimization (e.g., extra distribution regularization is required). In order to verify the argument, we conduct a comparison on $\\operatorname{RefCOCOg}(\\mathbf{G})$ val dataset as Tab. 9. The $\\mathcal{L}_{\\mathtt{I a D}}$ even causes a slight decline, while the proposed loss $\\mathcal{L}_{\\mathrm{KL}}$ brings clear improvement on localization accuracy. ", "page_idx": 15}, {"type": "text", "text": "Comparison between IaD loss and calibration loss in TRIS. There are essential differences between them. First, the calibration loss in TRIS [30] is used to suppress noisy background activation and thus help to re-calibrate the target response map. In contrast, in our method, we observe that, multiple referring texts corresponding to different instances in one image may locate the same instances (or we say overlapping), due to the lack of instance-level supervision in WRIS. ", "page_idx": 15}, {"type": "text", "text": "As for the implementation, the calibration loss adopts the global CLIP score of image-text to implement a simple contrastive learning for revising the response map. Differently, we simultaneously infer the response maps of different referring texts from the same image, and obtain the instance-level localization results by choos", "page_idx": 16}, {"type": "text", "text": "Table 10: Comparison between IaD loss and calibration loss LCal . ", "page_idx": 16}, {"type": "table", "img_path": "MxdyGXoK9h/tmp/ee14d72ddc5a8de098f322dd587bee480587253579cb8b8c7292e4ed05307c5a.jpg", "table_caption": [], "table_footnote": [], "page_idx": 16}, {"type": "text", "text": "ing the mask proposal with max alignment score. To further verify the superiority of our loss, we conduct an ablation on the RefCOCO(val) dataset. We use the TRIS without calibration loss as the baseline and then separately introduced these two loss functions for comparison. Both ablations demonstrate that the IaD loss not only refines the response map (mIoU) but also significantly improves the localization accuracy (PointM). ", "page_idx": 16}, {"type": "text", "text": "C More Visualization of Localization Results ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "Progressive Comprehension for Localization. In Fig. 9, we also give visualization of each stage\u2019s response map for qualitative analysis. The results show that our proposed CRM module can effectively integrate the target-related textual cues. For example, in the first row, the method produces ambiguous localization result at the first stage. After taking the cue \u201cwith gold necklace\u201d into consideration, the attention is transferred to the target object at the second stage. Finally, after considering all the cues, the method produces less ambiguous and more accurate localization results. ", "page_idx": 16}, {"type": "text", "text": "Q: woman with gold necklace sitting behind little birthday girl ", "page_idx": 16}, {"type": "image", "img_path": "MxdyGXoK9h/tmp/9fbbab3e216b637af03239331d2cb5e6b041baea8139c1d5b7396f75f6941bd8.jpg", "img_caption": ["Q: a young man with a shirt that has a giant musical note on it "], "img_footnote": [], "page_idx": 16}, {"type": "image", "img_path": "MxdyGXoK9h/tmp/3e90ccf30df05a1f50885c3623d83852af13d9d9ac79746757cd07ae0f45d200.jpg", "img_caption": ["Q: a boy in black t-shirt and jeans bending by keeping his hands on knees "], "img_footnote": [], "page_idx": 16}, {"type": "image", "img_path": "MxdyGXoK9h/tmp/4ed58e0d9098d9ce61a5dbb374e8e8dfd6d3503177c6d014274e10941480edd9.jpg", "img_caption": [], "img_footnote": [], "page_idx": 16}, {"type": "text", "text": "Figure 9: Visualization of progressive localization. With the integration of discriminative cues, the identification of target instance gradually improves. ", "page_idx": 16}, {"type": "text", "text": "Qualitative Comparison with Other method. More qualitative comparisons of our method with other methods are shown in the Fig. 10. For the example shown in the fifth row, the query is \u201ca man in a arm striped sweater\u201d. The TRIS [30] mistakenly locates the left man as the target regions. In contrast, our PCNet optimizes the response map generation process by continuously modulating the referring embedding query conditioned on the target-related cues instead of a static referring embedding. As a result, our method can obtain more accurate localization result. ", "page_idx": 17}, {"type": "text", "text": "D Proposal Generator ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "In this work, we adopt the two representative pre-trained segmentors: FreeSOLO [52] and SAM [20] for proposal generation. Specifically, the FreeSOLO [52] is a fully unsupervised learning method that learns class-agnostic instance segmentation without any annotations. The SAM\u2019s training utilizes densely labeled data, but it does not include semantic supervision. This supervision does not contradict our weakly supervised RIS setting. More importantly, it offers a promising solution as an image segmentation foundation model and can be used for refining the coarse localization results from weakly-supervised methods into precise segmentation masks as done in the recent works [10, 63]. For the usage of SAM, We adopt the ViT-H backbone, the hyperparameter predicted iou threshold and stability score threshold are set to 0.7, and points per side is set to 8. ", "page_idx": 17}, {"type": "text", "text": "In Fig. 11 and Fig. 12, we give the generated mask proposals examples by FreeSOLO [52] and SAM [20], respectively. We notice that there are often overlaps among the generated proposals. Thus, we refine the generated proposals by flitering out candidate proposals with small area (the threshold is set as 1000) and then selecting the ones with smaller intersection over union (the threshold is set as 0.8). Considering that the number of proposals generated by the segmentor may be different for different image inputs, in implementation, we maintain consistency by selecting the top 40 proposals with the largest area $ 'P=40$ ). If fewer than 40, we simply complete it with an all-zero mask. ", "page_idx": 17}, {"type": "text", "text": "E Broader Impacts ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "While we do not foresee our method causing any direct negative societal impact, it may potentially be leveraged by malicious parties to create applications that could misuse the segmentation capabilities for unethical or illegal purposes. We urge the readers to limit the usage of this work to legal use cases. ", "page_idx": 17}, {"type": "text", "text": "Q: \u201cthe guy wearing white sitting on the couch watching his friends play video games\u201d ", "page_idx": 18}, {"type": "image", "img_path": "MxdyGXoK9h/tmp/29beff19c14c91d068216503b334ab23b58b64dad3c3b35b1023fc8c19ec0f2b.jpg", "img_caption": [], "img_footnote": [], "page_idx": 18}, {"type": "text", "text": "Q: \u201ca catcher rushing to make a play on the ball\u201d ", "page_idx": 18}, {"type": "image", "img_path": "MxdyGXoK9h/tmp/31661429c29ea8283d564606995fcf9241f76474aba6f42fe71b710242a54821.jpg", "img_caption": [], "img_footnote": [], "page_idx": 18}, {"type": "text", "text": "Q: \u201ca boy in black t - shirt and jeans bending by keeping his hands on knees\u201d ", "page_idx": 18}, {"type": "image", "img_path": "MxdyGXoK9h/tmp/a3126c897272594eb369b11a1d9b6fdf2ac0b8ad007680bcfb8fff301248b75b.jpg", "img_caption": [], "img_footnote": [], "page_idx": 18}, {"type": "text", "text": "Q: \u201ca smiling man with a small infant wearing a beige t - shirt and gray jeans\u201d ", "page_idx": 18}, {"type": "image", "img_path": "MxdyGXoK9h/tmp/3a9a97f10fc22dcf9825b4dd6b911d09a381c8ed7b47d718528df1965ac7c611.jpg", "img_caption": [], "img_footnote": [], "page_idx": 18}, {"type": "text", "text": "Q: \u201ca man in a arm striped sweater\u201d ", "page_idx": 18}, {"type": "image", "img_path": "MxdyGXoK9h/tmp/934ea83dd54d828b082458c3484d509b0bc649b31bbaeea7e5d84edc2556e309.jpg", "img_caption": [], "img_footnote": [], "page_idx": 18}, {"type": "text", "text": "Q: \u201ca postcard with picture of face of cute girl\u201d ", "page_idx": 18}, {"type": "image", "img_path": "MxdyGXoK9h/tmp/06933eb01516c188ad4d22aa52d2388c260c7aec11c7338b1cf7da894f080122.jpg", "img_caption": [], "img_footnote": [], "page_idx": 18}, {"type": "text", "text": "Q: \u201cdark haired woman wearing a blue jacket next to a teddy bear\u201d ", "page_idx": 18}, {"type": "image", "img_path": "MxdyGXoK9h/tmp/ab1b7f63958d4ec5183ccefd5ae4ec32b8e01543410e29ffd8c2a4ea2613f677.jpg", "img_caption": [], "img_footnote": [], "page_idx": 18}, {"type": "text", "text": "(a) Image (b) TRIS (c) SAG (d) PCNet (e) GT ", "page_idx": 18}, {"type": "text", "text": "Figure 10: More visual comparison between our method with TRIS and SAG for WRIS. ", "page_idx": 18}, {"type": "text", "text": "", "page_idx": 19}, {"type": "image", "img_path": "MxdyGXoK9h/tmp/ca4a054b0f861aa1f302be0823f84d3ac4de55956fbb8da65a0bc321ec069aaf.jpg", "img_caption": ["Figure 11: FreeSOLO [52] generated mask proposals examples. "], "img_footnote": [], "page_idx": 19}, {"type": "image", "img_path": "MxdyGXoK9h/tmp/d95251042478f783c87dece214e7d4a0c2d5b4ccac1a58e4be369eb8ceb6e096.jpg", "img_caption": ["Figure 12: SAM [20] generated mask proposals examples. "], "img_footnote": [], "page_idx": 20}, {"type": "text", "text": "NeurIPS Paper Checklist ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "1. Claims ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "Question: Do the main claims made in the abstract and introduction accurately reflect the paper\u2019s contributions and scope? ", "page_idx": 21}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 21}, {"type": "text", "text": "Justification: In Sec. 1, we make the claims to reflect the paper\u2019s contributions and scope. Guidelines: ", "page_idx": 21}, {"type": "text", "text": "\u2022 The answer NA means that the abstract and introduction do not include the claims made in the paper.   \n\u2022 The abstract and/or introduction should clearly state the claims made, including the contributions made in the paper and important assumptions and limitations. A No or NA answer to this question will not be perceived well by the reviewers.   \n\u2022 The claims made should match theoretical and experimental results, and reflect how much the results can be expected to generalize to other settings.   \n\u2022 It is fine to include aspirational goals as motivation as long as it is clear that these goals are not attained by the paper. ", "page_idx": 21}, {"type": "text", "text": "2. Limitations ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "Question: Does the paper discuss the limitations of the work performed by the authors? ", "page_idx": 21}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "Justification: In Sec. 5, we discuss the limitations of the work ", "page_idx": 21}, {"type": "text", "text": "Guidelines: ", "page_idx": 21}, {"type": "text", "text": "\u2022 The answer NA means that the paper has no limitation while the answer No means that the paper has limitations, but those are not discussed in the paper.   \n\u2022 The authors are encouraged to create a separate \"Limitations\" section in their paper.   \n\u2022 The paper should point out any strong assumptions and how robust the results are to violations of these assumptions (e.g., independence assumptions, noiseless settings, model well-specification, asymptotic approximations only holding locally). The authors should reflect on how these assumptions might be violated in practice and what the implications would be.   \n\u2022 The authors should reflect on the scope of the claims made, e.g., if the approach was only tested on a few datasets or with a few runs. In general, empirical results often depend on implicit assumptions, which should be articulated.   \n\u2022 The authors should reflect on the factors that influence the performance of the approach. For example, a facial recognition algorithm may perform poorly when image resolution is low or images are taken in low lighting. Or a speech-to-text system might not be used reliably to provide closed captions for online lectures because it fails to handle technical jargon.   \n\u2022 The authors should discuss the computational efficiency of the proposed algorithms and how they scale with dataset size.   \n\u2022 If applicable, the authors should discuss possible limitations of their approach to address problems of privacy and fairness.   \n\u2022 While the authors might fear that complete honesty about limitations might be used by reviewers as grounds for rejection, a worse outcome might be that reviewers discover limitations that aren\u2019t acknowledged in the paper. The authors should use their best judgment and recognize that individual actions in favor of transparency play an important role in developing norms that preserve the integrity of the community. Reviewers will be specifically instructed to not penalize honesty concerning limitations. ", "page_idx": 21}, {"type": "text", "text": "3. Theory Assumptions and Proofs ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "Question: For each theoretical result, does the paper provide the full set of assumptions and a complete (and correct) proof? ", "page_idx": 21}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 21}, {"type": "text", "text": "Justification: The paper does not include theoretical results. Guidelines: ", "page_idx": 22}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include theoretical results.   \n\u2022 All the theorems, formulas, and proofs in the paper should be numbered and crossreferenced.   \n\u2022 All assumptions should be clearly stated or referenced in the statement of any theorems.   \n\u2022 The proofs can either appear in the main paper or the supplemental material, but if they appear in the supplemental material, the authors are encouraged to provide a short proof sketch to provide intuition.   \n\u2022 Inversely, any informal proof provided in the core of the paper should be complemented by formal proofs provided in appendix or supplemental material.   \n\u2022 Theorems and Lemmas that the proof relies upon should be properly referenced. ", "page_idx": 22}, {"type": "text", "text": "4. Experimental Result Reproducibility ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Question: Does the paper fully disclose all the information needed to reproduce the main experimental results of the paper to the extent that it affects the main claims and/or conclusions of the paper (regardless of whether the code and data are provided or not)? ", "page_idx": 22}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Justification: We provide implementation details in Sec. 4 and the Appendix for reproducibility. ", "page_idx": 22}, {"type": "text", "text": "Guidelines: ", "page_idx": 22}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 If the paper includes experiments, a No answer to this question will not be perceived well by the reviewers: Making the paper reproducible is important, regardless of whether the code and data are provided or not.   \n\u2022 If the contribution is a dataset and/or model, the authors should describe the steps taken to make their results reproducible or verifiable.   \n\u2022 Depending on the contribution, reproducibility can be accomplished in various ways. For example, if the contribution is a novel architecture, describing the architecture fully might suffice, or if the contribution is a specific model and empirical evaluation, it may be necessary to either make it possible for others to replicate the model with the same dataset, or provide access to the model. In general. releasing code and data is often one good way to accomplish this, but reproducibility can also be provided via detailed instructions for how to replicate the results, access to a hosted model (e.g., in the case of a large language model), releasing of a model checkpoint, or other means that are appropriate to the research performed.   \n\u2022 While NeurIPS does not require releasing code, the conference does require all submissions to provide some reasonable avenue for reproducibility, which may depend on the nature of the contribution. For example (a) If the contribution is primarily a new algorithm, the paper should make it clear how to reproduce that algorithm. (b) If the contribution is primarily a new model architecture, the paper should describe the architecture clearly and fully. (c) If the contribution is a new model (e.g., a large language model), then there should either be a way to access this model for reproducing the results or a way to reproduce the model (e.g., with an open-source dataset or instructions for how to construct the dataset). (d) We recognize that reproducibility may be tricky in some cases, in which case authors are welcome to describe the particular way they provide for reproducibility. In the case of closed-source models, it may be that access to the model is limited in some way (e.g., to registered users), but it should be possible for other researchers to have some path to reproducing or verifying the results. ", "page_idx": 22}, {"type": "text", "text": "5. Open access to data and code ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Question: Does the paper provide open access to the data and code, with sufficient instructions to faithfully reproduce the main experimental results, as described in supplemental material? ", "page_idx": 22}, {"type": "text", "text": "Answer: [No] ", "page_idx": 23}, {"type": "text", "text": "Justification: We will consider releasing the data and code once the paper is accepted. Guidelines: ", "page_idx": 23}, {"type": "text", "text": "\u2022 The answer NA means that paper does not include experiments requiring code.   \n\u2022 Please see the NeurIPS code and data submission guidelines (https://nips.cc/ public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 While we encourage the release of code and data, we understand that this might not be possible, so \u201cNo\u201d is an acceptable answer. Papers cannot be rejected simply for not including code, unless this is central to the contribution (e.g., for a new open-source benchmark).   \n\u2022 The instructions should contain the exact command and environment needed to run to reproduce the results. See the NeurIPS code and data submission guidelines (https: //nips.cc/public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 The authors should provide instructions on data access and preparation, including how to access the raw data, preprocessed data, intermediate data, and generated data, etc.   \n\u2022 The authors should provide scripts to reproduce all experimental results for the new proposed method and baselines. If only a subset of experiments are reproducible, they should state which ones are omitted from the script and why.   \n\u2022 At submission time, to preserve anonymity, the authors should release anonymized versions (if applicable).   \n\u2022 Providing as much information as possible in supplemental material (appended to the paper) is recommended, but including URLs to data and code is permitted. ", "page_idx": 23}, {"type": "text", "text": "6. Experimental Setting/Details ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: Does the paper specify all the training and test details (e.g., data splits, hyperparameters, how they were chosen, type of optimizer, etc.) necessary to understand the results? ", "page_idx": 23}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 23}, {"type": "text", "text": "Justification: We provide details about the experimental setting (e.g., hyperparameters) in Sec. 4 and the Appendix for reproducibility. ", "page_idx": 23}, {"type": "text", "text": "Guidelines: ", "page_idx": 23}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments. \u2022 The experimental setting should be presented in the core of the paper to a level of detail that is necessary to appreciate the results and make sense of them. \u2022 The full details can be provided either with the code, in appendix, or as supplemental material. ", "page_idx": 23}, {"type": "text", "text": "7. Experiment Statistical Significance ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: Does the paper report error bars suitably and correctly defined or other appropriate information about the statistical significance of the experiments? ", "page_idx": 23}, {"type": "text", "text": "Answer: [No] ", "page_idx": 23}, {"type": "text", "text": "Justification: We do not report error bars due to limited computing resources. ", "page_idx": 23}, {"type": "text", "text": "Guidelines: ", "page_idx": 23}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The authors should answer \"Yes\" if the results are accompanied by error bars, confidence intervals, or statistical significance tests, at least for the experiments that support the main claims of the paper.   \n\u2022 The factors of variability that the error bars are capturing should be clearly stated (for example, train/test split, initialization, random drawing of some parameter, or overall run with given experimental conditions).   \n\u2022 The method for calculating the error bars should be explained (closed form formula, call to a library function, bootstrap, etc.)   \n\u2022 The assumptions made should be given (e.g., Normally distributed errors).   \n\u2022 It should be clear whether the error bar is the standard deviation or the standard error of the mean.   \n\u2022 It is OK to report 1-sigma error bars, but one should state it. The authors should preferably report a 2-sigma error bar than state that they have a $96\\%$ CI, if the hypothesis of Normality of errors is not verified.   \n\u2022 For asymmetric distributions, the authors should be careful not to show in tables or figures symmetric error bars that would yield results that are out of range (e.g. negative error rates).   \n\u2022 If error bars are reported in tables or plots, The authors should explain in the text how they were calculated and reference the corresponding figures or tables in the text. ", "page_idx": 23}, {"type": "text", "text": "", "page_idx": 24}, {"type": "text", "text": "8. Experiments Compute Resources ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Question: For each experiment, does the paper provide sufficient information on the computer resources (type of compute workers, memory, time of execution) needed to reproduce the experiments? ", "page_idx": 24}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 24}, {"type": "text", "text": "Justification: We provide the information on the computer resources in the implementation details of Sec. 4. ", "page_idx": 24}, {"type": "text", "text": "Guidelines: ", "page_idx": 24}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The paper should indicate the type of compute workers CPU or GPU, internal cluster, or cloud provider, including relevant memory and storage.   \n\u2022 The paper should provide the amount of compute required for each of the individual experimental runs as well as estimate the total compute.   \n\u2022 The paper should disclose whether the full research project required more compute than the experiments reported in the paper (e.g., preliminary or failed experiments that didn\u2019t make it into the paper). ", "page_idx": 24}, {"type": "text", "text": "9. Code Of Ethics ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Question: Does the research conducted in the paper conform, in every respect, with the NeurIPS Code of Ethics https://neurips.cc/public/EthicsGuidelines? ", "page_idx": 24}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Justification: The research conducted in the paper conform with the NeurIPS Code of Ethics. Guidelines: ", "page_idx": 24}, {"type": "text", "text": "\u2022 The answer NA means that the authors have not reviewed the NeurIPS Code of Ethics.   \n\u2022 If the authors answer No, they should explain the special circumstances that require a deviation from the Code of Ethics.   \n\u2022 The authors should make sure to preserve anonymity (e.g., if there is a special consideration due to laws or regulations in their jurisdiction). ", "page_idx": 24}, {"type": "text", "text": "10. Broader Impacts ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Question: Does the paper discuss both potential positive societal impacts and negative societal impacts of the work performed? ", "page_idx": 24}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Justification: The paper discusses societal impacts of the work in the Appendix Sec. E. Guidelines: ", "page_idx": 24}, {"type": "text", "text": "\u2022 The answer NA means that there is no societal impact of the work performed.   \n\u2022 If the authors answer NA or No, they should explain why their work has no societal impact or why the paper does not address societal impact.   \n\u2022 Examples of negative societal impacts include potential malicious or unintended uses (e.g., disinformation, generating fake profiles, surveillance), fairness considerations (e.g., deployment of technologies that could make decisions that unfairly impact specific groups), privacy considerations, and security considerations.   \n\u2022 The conference expects that many papers will be foundational research and not tied to particular applications, let alone deployments. However, if there is a direct path to any negative applications, the authors should point it out. For example, it is legitimate to point out that an improvement in the quality of generative models could be used to generate deepfakes for disinformation. On the other hand, it is not needed to point out that a generic algorithm for optimizing neural networks could enable people to train models that generate Deepfakes faster.   \n\u2022 The authors should consider possible harms that could arise when the technology is being used as intended and functioning correctly, harms that could arise when the technology is being used as intended but gives incorrect results, and harms following from (intentional or unintentional) misuse of the technology.   \n\u2022 If there are negative societal impacts, the authors could also discuss possible mitigation strategies (e.g., gated release of models, providing defenses in addition to attacks, mechanisms for monitoring misuse, mechanisms to monitor how a system learns from feedback over time, improving the efficiency and accessibility of ML). ", "page_idx": 24}, {"type": "text", "text": "", "page_idx": 25}, {"type": "text", "text": "11. Safeguards ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "Question: Does the paper describe safeguards that have been put in place for responsible release of data or models that have a high risk for misuse (e.g., pretrained language models, image generators, or scraped datasets)? ", "page_idx": 25}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 25}, {"type": "text", "text": "Justification: The paper poses no such risks. ", "page_idx": 25}, {"type": "text", "text": "Guidelines: ", "page_idx": 25}, {"type": "text", "text": "\u2022 The answer NA means that the paper poses no such risks.   \n\u2022 Released models that have a high risk for misuse or dual-use should be released with necessary safeguards to allow for controlled use of the model, for example by requiring that users adhere to usage guidelines or restrictions to access the model or implementing safety filters.   \n\u2022 Datasets that have been scraped from the Internet could pose safety risks. The authors should describe how they avoided releasing unsafe images.   \n\u2022 We recognize that providing effective safeguards is challenging, and many papers do not require this, but we encourage authors to take this into account and make a best faith effort. ", "page_idx": 25}, {"type": "text", "text": "12. Licenses for existing assets ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "Question: Are the creators or original owners of assets (e.g., code, data, models), used in the paper, properly credited and are the license and terms of use explicitly mentioned and properly respected? ", "page_idx": 25}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 25}, {"type": "text", "text": "Justification: The paper properly cites the existing assets. ", "page_idx": 25}, {"type": "text", "text": "Guidelines: ", "page_idx": 25}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not use existing assets.   \n\u2022 The authors should cite the original paper that produced the code package or dataset.   \n\u2022 The authors should state which version of the asset is used and, if possible, include a URL.   \n\u2022 The name of the license (e.g., CC-BY 4.0) should be included for each asset.   \n\u2022 For scraped data from a particular source (e.g., website), the copyright and terms of service of that source should be provided.   \n\u2022 If assets are released, the license, copyright information, and terms of use in the package should be provided. For popular datasets, paperswithcode.com/datasets has curated licenses for some datasets. Their licensing guide can help determine the license of a dataset.   \n\u2022 For existing datasets that are re-packaged, both the original license and the license of the derived asset (if it has changed) should be provided. ", "page_idx": 25}, {"type": "text", "text": "\u2022 If this information is not available online, the authors are encouraged to reach out to the asset\u2019s creators. ", "page_idx": 26}, {"type": "text", "text": "13. New Assets ", "text_level": 1, "page_idx": 26}, {"type": "text", "text": "Question: Are new assets introduced in the paper well documented and is the documentation provided alongside the assets? ", "page_idx": 26}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 26}, {"type": "text", "text": "Justification: The paper does not release new assets. ", "page_idx": 26}, {"type": "text", "text": "Guidelines: ", "page_idx": 26}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not release new assets.   \n\u2022 Researchers should communicate the details of the dataset/code/model as part of their submissions via structured templates. This includes details about training, license, limitations, etc.   \n\u2022 The paper should discuss whether and how consent was obtained from people whose asset is used.   \n\u2022 At submission time, remember to anonymize your assets (if applicable). You can either create an anonymized URL or include an anonymized zip file. ", "page_idx": 26}, {"type": "text", "text": "14. Crowdsourcing and Research with Human Subjects ", "text_level": 1, "page_idx": 26}, {"type": "text", "text": "Question: For crowdsourcing experiments and research with human subjects, does the paper include the full text of instructions given to participants and screenshots, if applicable, as well as details about compensation (if any)? ", "page_idx": 26}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 26}, {"type": "text", "text": "Justification: The paper does not involve crowdsourcing nor research with human subjects. Guidelines: ", "page_idx": 26}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Including this information in the supplemental material is fine, but if the main contribution of the paper involves human subjects, then as much detail as possible should be included in the main paper.   \n\u2022 According to the NeurIPS Code of Ethics, workers involved in data collection, curation, or other labor should be paid at least the minimum wage in the country of the data collector. ", "page_idx": 26}, {"type": "text", "text": "15. Institutional Review Board (IRB) Approvals or Equivalent for Research with Human Subjects ", "text_level": 1, "page_idx": 26}, {"type": "text", "text": "Question: Does the paper describe potential risks incurred by study participants, whether such risks were disclosed to the subjects, and whether Institutional Review Board (IRB) approvals (or an equivalent approval/review based on the requirements of your country or institution) were obtained? ", "page_idx": 26}, {"type": "text", "text": "Answer: [NA] ", "text_level": 1, "page_idx": 26}, {"type": "text", "text": "Justification: The paper does not involve crowdsourcing nor research with human subjects. Guidelines: ", "page_idx": 26}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Depending on the country in which research is conducted, IRB approval (or equivalent) may be required for any human subjects research. If you obtained IRB approval, you should clearly state this in the paper.   \n\u2022 We recognize that the procedures for this may vary significantly between institutions and locations, and we expect authors to adhere to the NeurIPS Code of Ethics and the guidelines for their institution.   \n\u2022 For initial submissions, do not include any information that would break anonymity (if applicable), such as the institution conducting the review. ", "page_idx": 26}]