[{"type": "text", "text": "HYDRA-FL: Hybrid Knowledge Distillation for Robust and Accurate Federated Learning ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Momin Ahmad Khan ", "page_idx": 0}, {"type": "text", "text": "Yasra Chandio ", "page_idx": 0}, {"type": "text", "text": "University of Massachusetts, Amherst makhan@umass.edu ", "page_idx": 0}, {"type": "text", "text": "University of Massachusetts, Amherst ychandio@umass.edu ", "page_idx": 0}, {"type": "text", "text": "Fatima Muhammad Anwar University of Massachsuetts, Amherst fanwar@umass.edu ", "page_idx": 0}, {"type": "text", "text": "Abstract ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Data heterogeneity among Federated Learning (FL) users poses a significant challenge, resulting in reduced global model performance. The community has designed various techniques to tackle this issue, among which Knowledge Distillation (KD)-based techniques are common. While these techniques effectively improve performance under high heterogeneity, they inadvertently cause higher accuracy degradation under model poisoning attacks (known as attack amplification). This paper presents a case study to reveal this critical vulnerability in KD-based FL systems. We show why KD causes this issue through empirical evidence and use it as motivation to design a hybrid distillation technique. We introduce a novel algorithm, Hybrid Knowledge Distillation for Robust and Accurate FL (HYDRA-FL), which reduces the impact of attacks in attack scenarios by offloading some of the KD loss to a shallow layer via an auxiliary classifier. We model HYDRA-FL as a generic framework and adapt it to two KD-based FL algorithms, FedNTD and MOON. Using these two as case studies, we demonstrate that our technique outperforms baselines in attack settings while maintaining comparable performance in benign settings. Our code is available at https://github.com/momin-ahmad-khan/HYDRA-FL. ", "page_idx": 0}, {"type": "text", "text": "1 Introduction ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Federated Learning (FL) [33] is an emerging machine learning paradigm enabling multiple users\u2019 collaborative model training without data sharing. Each user, termed a client, only shares their local model with a server, which aggregates all local models into a single global model and redistributes it to the clients. Due to its decentralized, privacy-preserving, and highly-scalable nature, FL has been adopted by Google\u2019s Gboard [2] for next-word prediction, Apple\u2019s Siri [1] for automatic speech recognition, and WeBank [44] for credit risk prediction. ", "page_idx": 0}, {"type": "text", "text": "Despite its benefits, FL faces challenges with data heterogeneity [29, 52, 14, 25]. FL performs well when client data is independent and identically distributed (IID) and achieves similar convergence as a single model trained on all the clients\u2019 data but struggles when clients have diverse data (nonIID). In this case, the client\u2019s local data is not a good representation of the overall data distribution (unlike an ideal IID case), causing local models to drift away from each other. This drift results in a global model with significant accuracy degradation compared to the IID scenario. Numerous solutions [26, 21, 23, 54, 24, 47, 16, 28] address data heterogeneity, including Knowledge Distillation (KD) [12] to reduce the drift between local models. ", "page_idx": 0}, {"type": "image", "img_path": "6LVxO1C819/tmp/d8f50879075b78c5f50bc3d3b98efe3b14e9ee945808aa54a36fb8c1224f00cf.jpg", "img_caption": ["Figure 1: Overview of attack amplification through knowledge distillation. a) In the benign setting, KD reduces drift and brings benign local models closer to the benign global model. b) In the malicious setting, KD unknowingly reduces drift between benign local models and the poisoned global model. "], "img_footnote": [], "page_idx": 1}, {"type": "text", "text": "Besides data heterogeneity, FL also faces the issue of Byzantine robustness [15], where untrusted clients can inject poisoned models into the aggregator by altering client data (data poisoning [36]) or client models (model poisoning [11, 4, 34, 46, 5, 3, 42]). Research by [41] shows that model poisoning attacks are more potent as they directly manipulate local models. To counteract poisoning in FL, various defenses have been developed [6, 48, 51, 7, 27, 9, 8]. ", "page_idx": 1}, {"type": "text", "text": "In this work, we identify a critical vulnerability in KD-based FL techniques under model poisoning attacks. The adversarial settings, i.e., threat model, attacks and defense, are explained in $\\S C$ . These techniques unknowingly align benign client models with a poisoned server model (Figure 1). We study two such classes of KD-based solutions: FedNTD [21], which reduces the loss between not-true logits of the server and client models, and MOON [26], which reduces the contrastive loss between the representation vector of the server and client models. While these techniques improve global model accuracy in benign settings compared to FedAvg [33] (standard FL aggregator), they reduce performance below FedAvg under attack, a phenomenon we term attack amplification, especially noticeable at higher heterogeneity levels. ", "page_idx": 1}, {"type": "text", "text": "Motivated by our findings, we propose a Hybrid Knowledge Distillation for Robust and Accurate FL (HYDRA-FL) framework for KD-based techniques that restricts attack amplification under poisoning attacks while retaining performance in the benign setting. Unlike traditional KD methods that apply KD-loss only at the final layer, HYDRA-FL introduces KD-loss at a shallow layer via an auxiliary classifier and reduces the KD-loss impact at the final layer. This approach draws inspiration from Self-Distillation (SD) [50] and Skeptical Students (SS) [19], but with a distinct focus on enhancing robustness against heterogeneity and model poisoning attacks in FL. ", "page_idx": 1}, {"type": "text", "text": "SD improves model accuracy by self-distillation, while SS distills from \"nasty teachers\" [31] to shallow layers. In contrast, our approach uses auxiliary classifiers to enhance FL client robustness against heterogeneity and model poisoning attacks. We design a generic loss function adaptable to specific KD-based algorithms. Our evaluation show that HYDRA-FL significantly boosts accuracy over FedNTD and MOON in attack settings while maintaining performance in benign settings. ", "page_idx": 1}, {"type": "text", "text": "Contributions. This work addresses the critical issue of attack amplification in KD-based FL techniques to counter data heterogeneity. In doing so we make the following contributions: ", "page_idx": 1}, {"type": "text", "text": "1. Proving KD amplifies model poisoning: our motivational case study (\u00a73) on two KD-based techniques, FedNTD and MOON, shows that KD improves accuracy in benign settings but helps the malicious clients propagate poisoning through the KD-loss in adversarial settings. We empirically and theoretically show that this attack amplification issue is inherent to any technique aligning client outputs/representations with the server.   \n2. Designing HYDRA-FL: using our observations as a guideline, we design HYDRA-FL (\u00a74) to prevent attack amplification while retaining performance in the benign setting. HYDRA-FL is formulated as a general loss function that can be adapted to any FL algorithm so that it can be used as its local model training objective.   \n3. Implementation and Evaluation: we adapt HYDRA-FL to the FedNTD and MOON algorithms and modify their local training objectives (\u00a75). Our detailed qualitative and quantitative analysis (\u00a76) shows that HYDRA-FL not only achieves higher accuracy in attack settings but also maintains accuracy in the benign settings. ", "page_idx": 1}, {"type": "text", "text": "2 Background and Related Work ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "2.1 Federated Learning (FL) ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "In FL [15, 33], a service provider, called server, trains a global model, $\\theta^{g}$ , on private data from multiple collaborating clients, without directly collecting their data. The server selects $n$ out of $N$ clients in every $\\mathrm{FL}$ round and shares the most recent global model $(\\theta_{g}^{t})$ with them, where $t$ is the round number. Then, a client $k$ uses local data $D_{k}$ to compute an update $\\nabla_{k}^{t}$ and shares it with the server. The server aggregates these updates using some aggregation rule, like FedAvg [33] algorithm. ", "page_idx": 2}, {"type": "text", "text": "In FedAvg, a client $k$ fine-tunes $\\theta_{g}^{t}$ on their local data using stochastic gradient descent (SGD) for a fixed number of local epochs $E$ , resulting in an updated local model $\\theta_{k}^{t}$ . The client then computes their update as the difference $\\nabla_{k_{\\circ}}^{t}\\!=\\theta_{k}^{t}-\\bar{\\theta}_{g}^{t}$ and shares $\\nabla_{k}^{t}$ with the server. Next, the server computes an aggregate of client updates, $f_{\\tt a g g}$ using mean, i.e., ", "page_idx": 2}, {"type": "equation", "text": "$$\n\\nabla_{\\mathsf{a g g}}^{t}=f_{\\mathsf{m e a n}}(\\nabla_{\\{k\\in[n]\\}}^{t}).\n$$", "text_format": "latex", "page_idx": 2}, {"type": "text", "text": "The server then updates the global model of the $(t+1)^{t h}$ round using SGD and server learning $\\eta$ as: ", "page_idx": 2}, {"type": "equation", "text": "$$\n\\theta_{g}^{t+1}\\gets\\theta_{g}^{t}+\\eta\\nabla_{\\mathsf{a g g}}^{t}\n$$", "text_format": "latex", "page_idx": 2}, {"type": "text", "text": "2.1.1 Data Heterogeneity in FL ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "Data heterogeneity is a well-explored problem [29, 52, 14, 25] in FL. Each client in FL generates its data, leading to local data distributions that vary across clients and do not accurately represent the global data distribution. By extension, a global model learned by aggregating local models using FedAvg may not be the best representation of all the client\u2019s local data. Studies have shown that this data heterogeneity degrades performance and have proposed various methods to address this issue [26, 21, 23, 54, 24, 47, 16, 28]. This degradation is more prominent in the presence of poisoning attacks. Research on poisoning attacks in FL has demonstrated that such attacks become more successful under high heterogeneity [11, 42]. This increased risk is because the malicious clients can more easily hide between drifted benign client models, making it difficult for the server to differentiate between heterogeneous benign clients and malicious ones. [17] highlights that overlooking this heterogeneity is a critical oversight in FL defense evaluations. Unlike MOON [26] and FedNTD [21], the two baseline techniques used in this paper which address data heterogeneity only in no-attack settings, HYDRAFL operates in both no-attack and attack settings, achieving robustness and accuracy under high heterogeneity. ", "page_idx": 2}, {"type": "text", "text": "2.1.2 Poisoning in FL ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "FL is vulnerable to poisoning attacks [6, 4, 5, 3, 34, 11, 32, 46, 36, 42], where malicious clients aim to compromise the training process by degrading the global model\u2019s performance. These attacks come in various forms: In data poisoning [3], malicious clients poison their local data to introduce a backdoor in the local model. This backdoor then propagates to the global model upon aggregation. In model poisoning [11, 4, 34, 46, 5, 3, 42], malicious clients perturb their local models so that, when aggregated, the global model is poisoned. Poisoning attacks can be further classified based on their targets: If the performance degradation is on specific inputs, the attack is termed as targeted poisoning [5, 3], and if it is on all inputs, then it is termed as untargeted poisoning [11, 4, 34, 32, 46]. We explain the attacks used in this paper in $\\S C.2$ . Our paper shows how KD-based data-heterogeneity mitigation techniques amplify poisoning attacks and that our approach HYDRAFL addresses both data heterogeneity and poisoning. ", "page_idx": 2}, {"type": "text", "text": "2.2 Knowledge Distillation (KD) ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "Knowledge Distillation (KD) [12] transfers knowledge from a large, complex model (teacher) to a smaller, more computationally efficient model (student). This process involves distilling the teacher\u2019s rich and intricate information into the student by aligning their predictions. Formally, if the teacher and student models produce the output probabilities $\\bar{y}_{t}^{i}$ and $\\bar{y}_{s}^{i}$ respectively for the $i^{t h}$ input $(x^{i},y^{i})$ , KD aims to match these probabilities by applying the Kullback-Leibler (KL) divergence between them. The KL-divergence between their softened probabilities is given by: ", "page_idx": 2}, {"type": "text", "text": "$K L(s o f t m a x(y_{t}^{i}/\\tau)||s o f t m a x(y_{s}^{i}/\\tau)$ , where $\\tau$ is the temperature parameter that softens the probabilities. The overall KD loss function combines this KL-divergence with the usual loss function such as cross-entropy (CE) loss with $\\beta$ (balances the importance of the KL-divergence and CE loss) as: ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\mathcal{L}=(1-\\beta)\\cdot\\mathcal{L}_{C E}(y_{s}^{i},y^{i})+\\beta\\cdot\\mathcal{L}_{K L}(s o f t m a x(y_{s}^{i}/\\tau)||s o f t m a x(y_{t}^{i}/\\tau))\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "KD in $\\mathbf{FL}$ is becoming essential as it addresses critical challenges such as non-IID data distributions, enhances model performance, accelerates convergence, reduces communication overhead, and improves robustness by making the global model learn from an ensemble of local models [10, 23, 30, 53]. In FL, data is often non-IID across clients, leading to significant discrepancies in local models. KD mitigates these discrepancies by aligning the local models with the global model, ensuring that the global model captures a more generalized representation of the data. The general approach is to reduce the local model drift by improving the aggregation through distillation using unlabeled auxiliary data. However, the auxiliary data may not always be available, and methods have also been developed to enable KD without such data [49, 54]. ", "page_idx": 3}, {"type": "text", "text": "3 Attack Amplification through Knowledge Distillation ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "Hypothesis. KD-based techniques in FL improve accuracy in non-adversarial settings but result in more significant accuracy degradation under model poisoning attacks compared to the baseline techniques such as FedAvg. ", "page_idx": 3}, {"type": "text", "text": "Motivational case study. In this case study, we compare FedAvg against two distinct KD-based solutions addressing the local model drift from non-IID. MOON [26] uses model-contrastive learning to align local and global model representations, while FedNTD [21] uses KL-divergence to align not-true logits of client models with those of the server. FedNTD penalizes prediction divergence measured through distillation loss, improving knowledge transfer and stability, while MOON penalizes representation divergence measured through contrastive loss, enhancing robustness and generalization. This comparison will help us understand the trade-offs of using KD in FL, especially under adversarial conditions. Throughout this paper, benign conditions mean that no attacks are present, while adversarial conditions mean that model poisoning attacks are present. We implement the same settings and hyperparameters for FedAvg as for MOON and FedNTD to ensure a fair comparison, so FedAvg results may vary between these techniques. This is not an inconsistency. We do not directly compare FedNTD to MOON unless stated otherwise, as the original FedNTD work already did so. Our goal is to test how adversarial settings affect these two fundamentally different techniques similarly, demonstrating that attack amplification is inherent to KD and not specific to a particular technique. ", "page_idx": 3}, {"type": "text", "text": "Adversarial conditions. We simulate untargeted model poisoning attacks using techniques from [42, 11]. To observe their effects on accuracy in both benign and adversarial settings, we vary key hyperparameters \u2014 LDdivergence loss coefficient $\\beta$ for FedNTD and contrastive loss coefficient $\\mu$ for MOON. The baseline for comparison is FedAvg with $\\beta\\:=\\:0$ and $\\mu=0$ . To ensure high heterogeneity in both settings, the Dirichlet distribution [35] parameter $\\alpha$ is fixed at 0.1. ", "page_idx": 3}, {"type": "image", "img_path": "6LVxO1C819/tmp/703900829f146dcce6b80232ca20a9a6e6647fdbf60fb0467533c3333bfabe1f.jpg", "img_caption": ["(a) FedNTD, $\\beta=0$ is FedAvg (b) MOON, $\\mu=0$ is FedAvg ", "Figure 2: Impact of increasing KL-divergence loss for FedNTD and contrastive loss for MOON on accuracy. "], "img_footnote": [], "page_idx": 3}, {"type": "text", "text": "Findings. In Figures 2(a) and 2(b), we present three key results: benign accuracy (blue), postattack accuracy (orange), and the accuracy drop (green). We make the following observations from increasing $\\beta$ and $\\mu$ are as follows: (1) the global model accuracy improves in benign settings; (2) post-attack accuracy decreases; and (3) accuracy drop increases. Our analysis shows a significant trade-off: the very mechanisms that improve performance in benign conditions (increasing $\\beta$ and $\\mu_{.}$ ) also make the models more vulnerable to adversarial attacks. ", "page_idx": 3}, {"type": "text", "text": "What causes attack amplification? The fundamental nature of KD-based FL methods aims to align local models with the global model. In benign scenarios, these methods significantly outperform ", "page_idx": 3}, {"type": "text", "text": "FedAvg [26, 21]. However, in the presence of model poisoning attacks, this model alignment process inadvertently forces local models to align its representation/predictions to the poisoned global model, amplifying the attack\u2019s impact. This is illustrated in Figure 1, where clients unknowingly distill knowledge from a poisioned server model. ", "page_idx": 4}, {"type": "text", "text": "Formally: Consider a set of $n$ clients $c_{1},c_{2},\\ldots,c_{n}$ with $m$ being malicious. Using an aggregation rule such as FedAvg, the server aggregates updates from both benign $(\\nabla_{i\\in[m+1,n]})$ and malicious $(\\nabla_{i\\in[m]}^{m})$ clients: ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\nabla_{g}=f_{\\mathrm{agr}}(\\nabla_{i\\in[m]}^{m}\\cup\\nabla_{i\\in[m+1,n]})\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "When $m=0$ , the server model $\\nabla_{g}^{b}$ is benign. For $m\\neq0$ , the server model $\\nabla_{g}^{'}$ is poisoned, deviating from the ideal unpoisoned global model due to the nature of these attacks [42, 11, 41]. Aligning local models with a poisoned global model reduces gradient diversity, making local models more similar to the poisoned global model [21] through KL-divergence or contrastive loss. We rewrite Equation 3 to formalize the loss function for an FL client, using KD, where the client is the student with output $\\hat{y}_{c}$ , and the server is the teacher with output $y_{s}$ : ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\mathcal{L}=\\mathcal{L}_{C E}(\\hat{y}_{c},y)+\\beta\\mathcal{L}_{K L}(\\hat{y}_{c},y_{s})\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "Note that for the sake of derivation here, we are using $\\hat{y}_{c}$ , which represents the generic client model output. In the case of FedNTD, it can be replaced by $\\tilde{y}_{c}$ that represents the not-true logits of the client model, and in the case of MOON, it can be replaced by $z_{c}$ that represents the client model\u2019s high dimensional representation. ", "page_idx": 4}, {"type": "text", "text": "In benign scenarios, this loss function $\\begin{array}{r}{\\mathcal{L}=\\mathcal{F}(\\boldsymbol{\\beta}))}\\end{array}$ decreases monotonically with $\\beta$ because KD brings local models closer to an unpoisoned global model. Conversely, in adversarial scenarios, it increases with $\\beta$ because KD brings local models to the poisoned global model. We can write the relation of this loss function with $\\beta$ as: ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\mathscr{L}(\\beta)\\,\\mathrm{is}\\,\\left\\{\\!\\!\\begin{array}{l l}{\\mathrm{monotonically~decreasing,}}&{m=0}\\\\ {\\mathrm{monotonically~increasing,}}&{m\\neq0}\\end{array}\\!\\!\\right.\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "Then, the derivative of the loss function is: ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\frac{d\\mathcal{L}}{d\\beta}=\\left\\{\\!\\!\\begin{array}{c c}{{<0,}}&{{m=0}}\\\\ {{>0,}}&{{m\\neq0}}\\end{array}\\!\\!\\right.\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "Our derivation shows that while the distillation process decreases loss in the absence of malicious clients, it increases loss in their presence, thereby leading to reduced global model accuracy. This formal analysis highlights the need for a solution that mitigates the accuracy degradation under adversarial conditions while retaining the benefits of KD under benign conditions. ", "page_idx": 4}, {"type": "text", "text": "Impact of Heterogeneity. ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "Now, we explore the effect of heterogeneity on the performance of FedNTD, MOON, and FedAvg in both benign and adversarial conditions to gain deeper insights into the role of heterogeneity in the KD performance gain vs. vulnerability tradeoff. As shown in Figure 3(a), several interesting observations emerge. First, both FedNTD and FedAvg achieve higher accuracy at lower heterogeneity levels (indicated by higher $\\alpha$ ). In benign settings, ", "page_idx": 4}, {"type": "image", "img_path": "6LVxO1C819/tmp/94b4952c2a30a5c4a25342a3e89f9e97587aba9e5ec0e4bbbcd05929a5205e08.jpg", "img_caption": ["Figure 3: Impact of the heterogeneity parameter, $\\alpha$ in benign and adversarial settings. We use the Dirichlet distribution where a higher $\\alpha$ means lower heterogeneity. ", "(a) FedNTD vs FedAvg ", "(b) MOON vs FedAvg "], "img_footnote": [], "page_idx": 4}, {"type": "text", "text": "FedNTD consistently outperforms FedAvg. However, the trend reverses in adversarial settings: FedAvg achieves higher accuracy than FedNTD, except at $\\alpha=0.5$ . A similar pattern is observed with MOON in Figure 3(b), where FedAvg outperforms MOON across all heterogeneity levels in adversarial settings. In the benign setting, as expected, MOON slightly outperforms FedAvg at high heterogeneity. This comparison highlights again how the alignment mechanisms in FedNTD and MOON with higher heterogeneity exacerbate the vulnerability of KD methods to attacks. ", "page_idx": 4}, {"type": "image", "img_path": "6LVxO1C819/tmp/738bead9340fd2250f46478f833c91bdbf2fd30f9531f24beb35fd65c8ef07e7.jpg", "img_caption": ["Figure 4: HYDRA-FL framework: we refine client model training by reducing the final layer\u2019s KD-loss and incorporating shallow KD-loss at an earlier shallow layer via an auxiliary classifier. "], "img_footnote": [], "page_idx": 5}, {"type": "text", "text": "4.1 Generic Formulation ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "In this section, we propose Hybrid Knowledge Distillation for Robust and Accurate FL (HYDRA-FL), a technique to mitigate the attack amplification caused by KD in FL. We take a hybrid distillation approach, applying KD-loss at both the final and a shallow layer of the client model (Figure 4). This method incorporates shallow distillation, which applies KD-loss at an intermediate layer and helps reduce the impact of poisoning by preventing over-reliance on final layer alignment. Shallow distillation previously used to handle nasty teachers trained adversarially [19], to reduce the impact of poisoning. In summary, shallow layers capture basic features, and shallow distillation ensures these features are robustly learned, protecting the model from adversarial influences that could corrupt deeper layers and final outputs. We first formulate the generic loss function of an FL client using KD in HYDRA-FL as: ", "page_idx": 5}, {"type": "equation", "text": "$$\n\\mathcal{L}=\\mathcal{L}_{C E}(y_{c},y)+\\frac{\\beta}{b}\\mathcal{L}_{K D}(y_{c},y_{s})+\\gamma\\mathcal{L}_{K D}(y_{a u x},y_{s})\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "This loss function has three key components: ", "page_idx": 5}, {"type": "text", "text": "1. Cross-entropy loss $(\\mathcal{L}_{C E}(y_{c},y))$ is the loss between the client\u2019s prediction $y_{c}$ and the target $y$ , drives the client model to learn from its own data, ensuring it captures in-distribution knowledge such as features and patterns specific to its data. 2. Diminished KD loss $(\\frac{\\beta}{b}\\mathcal{L}_{K D}(\\bar{y_{c}},y_{s}))$ is the loss between the client\u2019s output/representation $y_{c}$ and the server\u2019s output/representation ${y_{s}}^{1}$ . It is a strategic reduction of the KD loss to ensure that the local model benefits from the global model\u2019s knowledge while remaining robust against adversarial attacks. This approach helps balance the trade-offs between learning efficiency and model integrity. In practice, this is achieved by introducing a diminishing factor $b$ to the KD loss at the client model\u2019s output layer to diminish the poisoning effect. The KD loss coefficient $\\beta$ is divided by $b$ , effectively reducing its weight in the total loss calculation, thus reducing its influence on the local model\u2019s training. This diminishing factor is essential, as shown later in $\\S6.3$ and Figure 7, where reducing the $\\beta$ yields better results. 3. Shallow distillation loss $(\\gamma\\breve{\\mathscr{L}}_{K D}(y_{a u x},y_{s}))$ is applied at a shallow layer of the local model, enhancing robustness without heavily relying on final layer alignment. This loss, between the auxiliary classifier\u2019s output/representation $y_{a u x}$ at the client model\u2019s shallow layer and the server\u2019s output/representation $y_{s}$ , is scaled by $\\gamma$ to control the amount of distillation. This reduces the impact of poisoning on the client model. Simply reducing the KD-loss in FedNTD or MOON improves post-attack accuracy but reduces benign setting accuracy, as shown in Figure 2. Shallow distillation loss helps maintain the balance between accuracy in benign settings and lowering the impact of poisoning on the client model in adversarial settings. ", "page_idx": 5}, {"type": "text", "text": "Differences with previous works.The key difference between our work and [19] lies in our approach to shallow distillation. [19] aims to distill from models that are designed to be undistillable, a.k.a nasty teachers [31]. While both use hybrid shallow distillation, [19] completely removes the KD-loss from the model\u2019s output layer and uses self-distillation to compensate for performance loss due to shallow distillation. In contrast, we retain a scaled-down KD-loss at the output layer. We found that completely removing the KD-loss at the output layer may cause a more negative impact than keeping it in a reduced form. Additionally, the untargeted poisoning is different from the poisoning in the \"nasty teacher\" paper [31]. The \"nasty teacher\" performs near-perfect under normal conditions unless a malicious model distills from it. In untargeted FL poisoning, the global model is poisoned and performs poorly regardless of its use for distillation. ", "page_idx": 5}, {"type": "text", "text": "", "page_idx": 6}, {"type": "text", "text": "In HYDRA-FL, we use both final layer and shallow layer distillation to enhance robustness. Final layer distillation aligns client outputs with server outputs for consistent predictions, whereas the shallow layer distillation aligns intermediate representations to improve robustness against attacks. This dual approach reduces vulnerability to poisoning attacks, enhances learning by leveraging knowledge transfer from multiple layers, and maintains high accuracy in benign settings while being resilient under attack conditions. ", "page_idx": 6}, {"type": "text", "text": "4.2 Adapting HYDRA-FL to State-of-Art Techniques ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "In this section, we will adapt our generic HYDRA-FL to two state-of-the-art KD techniques for FL. ", "page_idx": 6}, {"type": "text", "text": "FedNTD with shallow distillation and auxiliary classifiers. We modify the FedNTD base model by introducing auxiliary classifiers. The base model includes two convolutional layers, a linear layer, and a classification layer. Auxiliary classifiers, each consisting of a linear layer (hidden dimension 512) followed by a classification layer, are added after each convolutional layer. We update the loss function to include a shallow-distillation term, representing the KL-divergence loss between the not-true logits of an auxiliary classifier and the global model. The final loss function is a weighted sum of the standard cross-entropy loss, KL-divergence loss between the not-true logits of the global model and the client model, and the KL-divergence loss between the not-true logits of the global model and the auxiliary classifier. The revised loss function in Equation 8 for FedNTD is: ", "page_idx": 6}, {"type": "equation", "text": "$$\n\\mathcal{L}=\\mathcal{L}_{C E}(y_{c},y)+\\frac{\\beta}{b}\\mathcal{L}_{K L}(\\tilde{y}_{c},\\tilde{y}_{s})+\\gamma\\mathcal{L}_{K L}(\\tilde{y}_{a u x},\\tilde{y}_{s})\n$$", "text_format": "latex", "page_idx": 6}, {"type": "text", "text": "Here $y$ is the target label, $y_{c}$ is the client model\u2019s output, $\\tilde{y}_{s},\\,\\tilde{y_{c}}$ , and $\\tilde{y}_{a u x}$ are the client model\u2019s, server model\u2019s, and auxiliary classifier\u2019s not-true logits respectively. ", "page_idx": 6}, {"type": "text", "text": "MOON with shallow distillation and auxiliary classifiers. MOON base model has two convolution layers, two linear layers, and an output classification layer. We insert auxiliary classifiers after each convolution layer. Each auxiliary classifier has two linear layers, with a hidden dimension of 256 and an output dimension of 10. We adapt Equation 8 to MOON to compute the contrastive loss at the hidden representation layer of the auxiliary classifier as: ", "page_idx": 6}, {"type": "equation", "text": "$$\n\\mathcal{L}=\\mathcal{L}_{C E}(y_{c},y)+\\frac{\\mu}{b}\\mathcal{L}_{c o n}(z_{c},z_{s})+\\gamma\\mathcal{L}_{c o n}(z_{a u x},z_{s})\n$$", "text_format": "latex", "page_idx": 6}, {"type": "text", "text": "Here $y$ is the target label, $y_{c}$ is the client\u2019s output, $z_{c}$ is the representation from the client\u2019s final layer, $z_{s}$ is the representation from the server\u2019s final layer, $z_{a u x}$ is the representation from the client\u2019s auxiliary classifier, and $y_{s}$ is the server model\u2019s output. For simplicity, we do not write the previous round\u2019s representation in the loss function here. ", "page_idx": 6}, {"type": "text", "text": "5 Experimental Results ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "5.1 Experimental Settings ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "Datasets and Models: We conduct our experiments over three popular datasets: MNIST, CIFAR10, and CIFAR100. To ensure a fair comparison with previous works, MOON and FedNTD, we utilized the same models and hyperparameters they used. Specifically, we incorporated our algorithm as a simple modification into their publicly available codes [22, 38] (more details on experimental and adversarial setups in Appendices D & C). ", "page_idx": 6}, {"type": "text", "text": "Table 1: Test accuracy for three techniques on three datasets. In the no-attack setting, $(\\uparrow\\downarrow)$ shows comparison to FedAvg. In the attack setting, we use bold if our technique outperforms FedNTD. ", "page_idx": 7}, {"type": "table", "img_path": "6LVxO1C819/tmp/31a7551143746da24b4a4d6da5e13a0fefa4c8eb33ddf9aeda40e903f448bd13.jpg", "table_caption": [], "table_footnote": [], "page_idx": 7}, {"type": "text", "text": "Table 2: Test accuracy for three techniques on three datasets. In the no-attack setting, $(\\uparrow\\downarrow)$ shows comparison to FedAvg. In the attack setting, we use bold if our technique outperforms MOON. ", "page_idx": 7}, {"type": "table", "img_path": "6LVxO1C819/tmp/5452432ce860f674fea23c5d3ad9b2503b39c294b5303c7d1ad442ac5a9a7810.jpg", "table_caption": [], "table_footnote": [], "page_idx": 7}, {"type": "text", "text": "5.2 Shallow Not-True Distillation ", "text_level": 1, "page_idx": 7}, {"type": "text", "text": "Our hybrid shallow not-true distillation technique significantly improves post-attack accuracy over the baseline FedNTD. As shown in Table 1, we achieve higher post-attack accuracy across all heterogeneity levels. By retaining a diminished NTD loss at the output layer, we maintain similar accuracy to FedNTD in no-attack scenarios and, in some cases, even achieve slightly higher accuracy. We also compare no-attack and post-attack accuracies for FedAvg, the foundational algorithm for many FL aggregation methods. ", "page_idx": 7}, {"type": "text", "text": "5.3 Shallow MOON ", "text_level": 1, "page_idx": 7}, {"type": "text", "text": "Our shallow-distillation design effectively prevents attack amplification in MOON while maintaining nearly the same no-attack accuracy. Table 2 shows that we achieve higher post-attack accuracy across all heterogeneity levels. Our technique also outperforms FedAvg, except in a few scenarios. Techniques like ", "page_idx": 7}, {"type": "image", "img_path": "6LVxO1C819/tmp/5dc6182339a669fcb2d6333757e987e4cfd2a590439b77d3bdf2a7cea85838d9.jpg", "img_caption": ["Figure 5: HYDRA-FL vs. MOON and FedAvg when auxiliary classifiers are placed at different shallow layers. ", "(a) No Attack ", "(b) Attack "], "img_footnote": [], "page_idx": 7}, {"type": "text", "text": "MOON are designed to enhance accuracy under high heterogeneity $\\alpha=0.1$ ). HYDRA-FL achieves a no-attack [attack] accuracy of $60.1\\%[43.6\\%]$ , surpassing both MOON $(58.8\\%[39.9\\%])$ and FedAvg $(57.76\\%[40.9\\%])$ ), thereby demonstrating efficacy in high heterogeneity. ", "page_idx": 7}, {"type": "text", "text": "6 Analysis ", "text_level": 1, "page_idx": 7}, {"type": "text", "text": "In this section, we provide an in-depth analysis of HYDRA-FL. We begin with a theoretical justification behind the efficacy of HYDRA-FL. Then we perform a qualitative analysis using t-distributed stochastic neighbor embedding (t-SNE [43]) plots to visualize the representations of the models. Finally, we explore the impact of different design choices through ablation studies, focusing on the choice of the shallow layer for auxiliary classifiers and the distillation coefficients. ", "page_idx": 7}, {"type": "text", "text": "6.1 Theoretical Justification ", "text_level": 1, "page_idx": 7}, {"type": "text", "text": "Here we provide the theoretical justification for the working of HYDRA-FL. The generic loss function of an FL client using KD is: ", "page_idx": 7}, {"type": "equation", "text": "$$\n\\mathcal{L}=\\mathcal{L}_{C E}(\\hat{y}_{c},y)+\\beta\\mathcal{L}_{K D}(y_{c},y_{s})\n$$", "text_format": "latex", "page_idx": 7}, {"type": "text", "text": "In Section 3, we showed that in the presence of malicious clients, $\\begin{array}{r}{{\\frac{d{\\mathcal{L}}}{d\\beta}}\\,>\\,0}\\end{array}$ , i.e., KD causes the loss to increase. In Section 4, we formulated the generic loss function of an FL client using KD in ", "page_idx": 7}, {"type": "text", "text": "HYDRA-FL as: ", "page_idx": 8}, {"type": "equation", "text": "$$\n\\mathcal{L}^{\\prime}=\\mathcal{L}_{C E}(y_{c},y)+\\frac{\\beta}{b}\\mathcal{L}_{K D}(y_{c},y_{s})+\\gamma\\mathcal{L}_{K D}(y_{a u x},y_{s})\n$$", "text_format": "latex", "page_idx": 8}, {"type": "text", "text": "We use ${\\mathcal{L}}^{\\prime}$ for HYDRA-FL loss and $\\mathcal{L}$ for basic KD loss. Comparing them, since $\\begin{array}{r}{\\frac{\\beta}{b}<\\beta\\;\\mathcal{L}}\\end{array}$ , it follows that $\\begin{array}{r}{\\frac{\\beta}{b}\\mathcal{L}_{K D}\\big(y_{c},y_{s}\\big)<\\beta\\mathcal{L}_{K D}\\big(y_{c},y_{s}\\big)}\\end{array}$ . The entire model is $\\theta$ , and the part up til the auxiliary layer $\\theta^{\\prime}$ . The impact of shallow distillation loss is only on $\\theta^{\\prime}$ and not the rest of the model $\\theta-\\theta^{\\prime}$ . Therefore, with appropriate $b$ and $\\gamma$ , $\\begin{array}{r}{\\frac{d{\\mathcal{L}}^{\\prime}}{d\\beta}<\\frac{d{\\mathcal{L}}}{d\\beta}}\\end{array}$ . This is shown in Figure 7, where we select $b=[1,4]$ (so $\\beta$ effectively becomes 1 and $\\textstyle{\\frac{1}{4}}$ , respectively) and $\\gamma=2$ to show the effectiveness of our technique and the impact of the variation of these hyperparameters. ", "page_idx": 8}, {"type": "text", "text": "6.2 Qualitative Analysis ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "We show the t-SNE plots of the representations (Figure 6) generated by the client model for FedAvg, MOON, and HYDRA-FL for both attack and no-attack scenarios. The t-SNE plots show the classes as clusters. In the MOON attack scenario, the deviation from the no-attack scenario is much higher than the deviation between HYDRA-FL with and without attack, as evident from the spread of the class clusters, especially along the $\\mathbf{X}$ -axis. ", "page_idx": 8}, {"type": "image", "img_path": "6LVxO1C819/tmp/a6a6e76ee977ab24b50de5a0d68a08ff9b13b9981c0673a0b0916a9e2ce36c29.jpg", "img_caption": ["Figure 6: T-SNE visualizations of CIFAR10 on local model\u2019s hidden representations $(\\alpha=0.5)$ ) on FedAvg, MOON, and HYDRA-FL (ours). The attack vs. no-attack plot shows the deviation of the attack clusters from the no-attack clusters. Visually we can see MOON-attack has the greatest deviation, particularly along the $\\mathbf{X}$ -axis, compared to FedAvg and HYDRA-FL. "], "img_footnote": [], "page_idx": 8}, {"type": "text", "text": "6.3 Ablation Study ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "Impact of choice of the shallow layer. Figure 5 illustrates the impact of the choice of the layer at which we insert our auxiliary classifier. We represent these choices by HYDRAFL-S1 and HYDRAFLS2, where the auxiliary classifier is inserted after the first and second convolutional layers, respectively. We compare them in both attack and no-attack settings with simple MOON and FedAvg. In Figure 5(a), both HYDRAFL-S1 and HYDRAFL-S2 outperform other techniques at low heterogeneity in the absence of an attack but slightly underperform in low heterogeneity when $\\beta=5$ . Figure 5(b) shows that both HYDRAFL-S1 and HYDRAFL-S2 achieve higher post-attack accuracy at all heterogeneity levels, with HYDRAFL-S2 giving a slightly higher accuracy than HYDRAFL-S1. The benefit from the contrastive loss reduces as we go shallower, so an optimal balance is necessary. ", "page_idx": 8}, {"type": "text", "text": "Impact of distillation coefficients. We examine the impact of distillation coefficients on the performance of FedNTD and HYDRA-FL. Figure 7 shows the post-attack accuracies with two different values of the diminishing factor $b=1,4$ , resulting in output-layer NTD-loss coefficients of $\\beta=1$ and $\\beta=0.25$ . Diminishing the coefficient $\\beta$ leads to improved performance, with a significant increase in post-attack accuracy for $\\beta=0.25$ at high heterogeneity $(\\alpha=0.05,0.1)$ ). As demonstrated in $\\S3$ , $\\beta$ contributes to attack amplification in FedNTD. Reducing it while performing distillation at the auxiliary classifier yields the best performance. For example, at $\\alpha\\,=\\,0.05$ , HYDRA-FL achieves $25.15\\%$ accuracy at $\\beta=1$ , but a much higher accuracy of $28.81\\%$ at $\\beta=0.25$ . Similar improvements are observed at other heterogeneity levels. ", "page_idx": 8}, {"type": "table", "img_path": "6LVxO1C819/tmp/7ec9830d25ccf54182732b3fad6f525a2c6466e4f29b89ffb75379b9c7b41e6a.jpg", "table_caption": ["Table 3: MNIST test accuracy with 0.05 heterogeneity for MOON "], "table_footnote": [], "page_idx": 9}, {"type": "text", "text": "", "page_idx": 9}, {"type": "text", "text": "6.4 Additional Results on MNIST at Very High Heterogeneity ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "To demonstrate robustness and generalizability, we conducted more experiments now on MNIST at a much lower heterogeneity of 0.05. Table 3 shows attack amplification and the effectiveness of our solution. MOON\u2019s accuracy drops from $73.57\\%$ (no-attack) to $55.32\\%$ (attack), showing attack amplification compared to FedAvg. HYDRAFL achieves higher accuracy than both FedAvg and MOON in the no-attack setting and higher accuracy than MOON in the attack setting, reducing attack amplification. ", "page_idx": 9}, {"type": "text", "text": "6.5 Thoughts on Data Poisoning ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "While data poisoning in the context of knowledge distillation (KD) requires a dedicated study, we believe our solution is broadly applicable as it prevents the flow of poison through the entire model and dilutes its effect. Consider a simple example: label filpping, a basic data poisoning attack where some labels in the training dataset are flipped (e.g., changing a bird image\u2019s label to \u2019airplane\u2019 in CIFAR-10). Suppose the server model (teacher) is poisoned with this flipped dataset. During the distillation process, since we are using HYDRAFL, this poisoned distillation information would be diluted at the final layer. Instead, it will flow through an auxiliary classifier into the early layers of the model, thereby reducing the impact of the data poisoning attack via label flipping. ", "page_idx": 9}, {"type": "image", "img_path": "6LVxO1C819/tmp/b998ae31736feb9f3948ebd6150d4ab923b8f7b3b0e045cab28e36e417812af1.jpg", "img_caption": ["Figure 7: Comparison of performance of FedNTD-S with different values of $\\beta$ "], "img_footnote": [], "page_idx": 9}, {"type": "text", "text": "", "page_idx": 9}, {"type": "text", "text": "7 Conclusion ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "In this paper, we first identified a critical issue in KD-based FL techniques that aim to tackle data heterogeneity: in the presence of model poisoning attacks, these techniques help the attacker amplify its effect, leading to reduced global model performance. We presented empirical evidence and theoretical reasoning to back this claim. This motivated us to propose HYDRA-FL: a hybrid knowledge distillation technique for robust and accurate FL technique that aims to tackle both data heterogeneity and model poisoning, two of the biggest problems in FL. Through extensive evaluation across three datasets and comparing with baseline techniques, FedNTD and MOON, we showed that HYDRA-FL achieves superior results. ", "page_idx": 9}, {"type": "text", "text": "8 Acknowledgements ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "We thank the NeurIPS reviewers for their insightful feedback and comments. This research is supported by NSF grant 2237485. ", "page_idx": 9}, {"type": "text", "text": "References ", "text_level": 1, "page_idx": 10}, {"type": "text", "text": "[1] How Apple personalizes Siri without hoovering up your data. https://www.technologyreview.com/2019/12/11/131629/ apple-ai-personalizes-siri-federated-learning/.   \n[2] Federated learning: Collaborative machine learning without centralized training data. https: //ai.googleblog.com/2017/04/federated-learning-collaborative.html, 2017.   \n[3] Eugene Bagdasaryan, Andreas Veit, Yiqing Hua, Deborah Estrin, and Vitaly Shmatikov. How to backdoor federated learning. In AISTATS, 2020.   \n[4] Moran Baruch, Baruch Gilad, and Yoav Goldberg. A Little Is Enough: Circumventing Defenses For Distributed Learning. In NeurIPS, 2019.   \n[5] Arjun Nitin Bhagoji, Supriyo Chakraborty, Prateek Mittal, and Seraphin Calo. Analyzing federated learning through an adversarial lens. In ICML, 2019.   \n[6] Peva Blanchard, Rachid Guerraoui, Julien Stainer, et al. Machine learning with adversaries: Byzantine tolerant gradient descent. In NeurIPS, 2017.   \n[7] X. Cao, J. Jia, Z. Zhang, and N. Gong. Fedrecover: Recovering from poisoning attacks in federated learning using historical information. In 2023 2023 IEEE Symposium on Security and Privacy (SP) (SP), pages 326\u2013343, Los Alamitos, CA, USA, may 2023. IEEE Computer Society.   \n[8] Xiaoyu Cao, Jinyuan Jia, and Neil Zhenqiang Gong. Provably Secure Federated Learning against Malicious Clients. In AAAI, 2021.   \n[9] Hongyan Chang, Virat Shejwalkar, Reza Shokri, and Amir Houmansadr. Cronus: Robust and Heterogeneous Collaborative Learning with Black-Box Knowledge Transfer. arXiv:1912.11279, 2019.   \n[10] Hong-You Chen and Wei-Lun Chao. Fedbe: Making bayesian model ensemble applicable to federated learning. arXiv preprint arXiv:2009.01974, 2020.   \n[11] Minghong Fang, Xiaoyu Cao, Jinyuan Jia, and Neil Zhenqiang Gong. Local Model Poisoning Attacks to Byzantine-Robust Federated Learning. In USENIX, 2020.   \n[12] Geoffrey Hinton, Oriol Vinyals, and Jeff Dean. Distilling the knowledge in a neural network. arXiv preprint arXiv:1503.02531, 2015.   \n[13] Junyuan Hong, Yi Zeng, Shuyang Yu, Lingjuan Lyu, Ruoxi Jia, and Jiayu Zhou. Revisiting datafree knowledge distillation with poisoned teachers. In International Conference on Machine Learning, pages 13199\u201313212. PMLR, 2023.   \n[14] Tzu-Ming Harry Hsu, Hang Qi, and Matthew Brown. Measuring the effects of non-identical data distribution for federated visual classification. arXiv preprint arXiv:1909.06335, 2019.   \n[15] Peter Kairouz, H Brendan McMahan, Brendan Avent, et al. Advances and open problems in federated learning. arXiv:1912.04977, 2019.   \n[16] Sai Praneeth Karimireddy, Satyen Kale, Mehryar Mohri, Sashank Reddi, Sebastian Stich, and Ananda Theertha Suresh. Scaffold: Stochastic controlled averaging for federated learning. In International Conference on Machine Learning, pages 5132\u20135143. PMLR, 2020.   \n[17] Momin Ahmad Khan, Virat Shejwalkar, Amir Houmansadr, and Fatima M Anwar. On the pitfalls of security evaluation of robust federated learning. In 2023 IEEE Security and Privacy Workshops (SPW), pages 57\u201368. IEEE, 2023.   \n[18] Alex Krizhevsky. Learning multiple layers of features from tiny images. Technical report, University of Toronto, 2009.   \n[19] Souvik Kundu, Qirui Sun, Yao Fu, Massoud Pedram, and Peter Beerel. Analyzing the confidentiality of undistillable teachers in knowledge distillation. Advances in Neural Information Processing Systems, 34:9181\u20139192, 2021.   \n[20] Yann LeCun and Corinna Cortes. The mnist database of handwritten digits. http://yann. lecun. com/exdb/mnist/, 1998.   \n[21] Gihun Lee, Minchan Jeong, Yongjin Shin, Sangmin Bae, and Se-Young Yun. Preservation of the global knowledge by not-true distillation in federated learning. Advances in Neural Information Processing Systems, 35:38461\u201338474, 2022. ", "page_idx": 10}, {"type": "text", "text": "[22] Lee-Gihun. Fedntd. https://github.com/Lee-Gihun/FedNTD/tree/master. ", "page_idx": 11}, {"type": "text", "text": "[23] Daliang Li and Junpu Wang. Fedmd: Heterogenous federated learning via model distillation. arXiv preprint arXiv:1910.03581, 2019.   \n[24] Liping Li, Wei Xu, Tianyi Chen, Georgios B Giannakis, and Qing Ling. RSA: Byzantine-robust stochastic aggregation methods for distributed learning from heterogeneous datasets. In AAAI, 2019.   \n[25] Qinbin Li, Yiqun Diao, Quan Chen, and Bingsheng He. Federated learning on non-iid data silos: An experimental study. In 2022 IEEE 38th international conference on data engineering (ICDE), pages 965\u2013978. IEEE, 2022.   \n[26] Qinbin Li, Bingsheng He, and Dawn Song. Model-contrastive federated learning. In Proceedings of the IEEE/CVF conference on computer vision and pattern recognition, pages 10713\u201310722, 2021.   \n[27] Tian Li, Shengyuan Hu, Ahmad Beirami, and Virginia Smith. Ditto: Fair and robust federated learning through personalization. In ICML, 2021.   \n[28] Tian Li, Anit Kumar Sahu, Manzil Zaheer, Maziar Sanjabi, Ameet Talwalkar, and Virginia Smith. Federated optimization in heterogeneous networks. Proceedings of Machine learning and systems, 2:429\u2013450, 2020.   \n[29] Xiang Li, Kaixuan Huang, Wenhao Yang, Shusen Wang, and Zhihua Zhang. On the convergence of fedavg on non-iid data. arXiv preprint arXiv:1907.02189, 2019.   \n[30] Tao Lin, Lingjing Kong, Sebastian U Stich, and Martin Jaggi. Ensemble distillation for robust model fusion in federated learning. In NeurIPS, 2020.   \n[31] Haoyu Ma, Tianlong Chen, Ting-Kuei Hu, Chenyu You, Xiaohui Xie, and Zhangyang Wang. Undistillable: Making a nasty teacher that cannot teach students. arXiv preprint arXiv:2105.07381, 2021.   \n[32] Saeed Mahloujifar, Mohammad Mahmoody, and Ameer Mohammed. Universal multi-party poisoning attacks. In ICML, 2019.   \n[33] H Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and Blaise Aguera y Arcas. Communication-efficient learning of deep networks from decentralized data. In AISTATS, 2017.   \n[34] El Mahdi El Mhamdi, Rachid Guerraoui, and S\u00e9bastien Rouault. The Hidden Vulnerability of Distributed Learning in Byzantium. In ICML, 2018.   \n[35] Thomas Minka. Estimating a Dirichlet distribution, 2000.   \n[36] Luis Mu\u00f1oz-Gonz\u00e1lez, Battista Biggio, Ambra Demontis, Andrea Paudice, Vasin Wongrassamee, Emil C Lupu, and Fabio Roli. Towards poisoning of deep learning algorithms with back-gradient optimization. In AISec, 2017.   \n[37] PyTorch Documentation. https://pytorch.org/, 2019.   \n[38] QinbinLi. Moon. https://github.com/QinbinLi/MOON/tree/main.   \n[39] Alec Radford, Jong Wook Kim, Chris Hallacy, Aditya Ramesh, Gabriel Goh, Sandhini Agarwal, Girish Sastry, Amanda Askell, Pamela Mishkin, Jack Clark, et al. Learning transferable visual models from natural language supervision. In International conference on machine learning, pages 8748\u20138763. PMLR, 2021.   \n[40] Sashank J Reddi, Zachary Charles, Manzil Zaheer, Zachary Garrett, Keith Rush, Jakub Konec\u02c7ny\\`, Sanjiv Kumar, and Hugh Brendan McMahan. Adaptive Federated Optimization. In ICLR, 2020.   \n[41] V. Shejwalkar, A. Houmansadr, P. Kairouz, and D. Ramage. Back to the drawing board: A critical evaluation of poisoning attacks on production federated learning. In 2022 2022 IEEE Symposium on Security and Privacy (SP) $(S P)$ , pages 1117\u20131134, Los Alamitos, CA, USA, may 2022. IEEE Computer Society.   \n[42] Virat Shejwalkar and Amir Houmansadr. Manipulating the Byzantine: Optimizing Model Poisoning Attacks and Defenses for Federated Learning. In NDSS, 2021.   \n[43] Laurens Van der Maaten and Geoffrey Hinton. Visualizing data using t-sne. Journal of machine learning research, 9(11), 2008.   \n[44] Utilization of FATE in Risk Management of Credit in Small and Micro Enterprises. https://www.fedai.org/cases/ utilization-of-fate-in-risk-management-of-credit-in-small-and-micro-enterpris 2019.   \n[45] Cong Xie, Oluwasanmi Koyejo, and Indranil Gupta. Generalized byzantine-tolerant sgd. arXiv:1802.10116, 2018.   \n[46] Cong Xie, Sanmi Koyejo, and Indranil Gupta. Fall of empires: Breaking Byzantine-tolerant SGD by inner product manipulation. arXiv:1903.03936, 2019.   \n[47] Yueqi Xie, Weizhong Zhang, Renjie Pi, Fangzhao Wu, Qifeng Chen, Xing Xie, and Sunghun Kim. Robust federated learning against both data heterogeneity and poisoning attack via aggregation optimization. arXiv preprint, 2022.   \n[48] Dong Yin, Yudong Chen, Kannan Ramchandran, and Peter Bartlett. Byzantine-robust distributed learning: Towards optimal statistical rates. In ICML, 2018.   \n[49] Lin Zhang, Li Shen, Liang Ding, Dacheng Tao, and Ling-Yu Duan. Fine-tuning global model via data-free knowledge distillation for non-iid federated learning. In Proceedings of the IEEE/CVF conference on computer vision and pattern recognition, pages 10174\u201310183, 2022.   \n[50] Linfeng Zhang, Jiebo Song, Anni Gao, Jingwei Chen, Chenglong Bao, and Kaisheng Ma. Be your own teacher: Improve the performance of convolutional neural networks via self distillation. In Proceedings of the IEEE/CVF international conference on computer vision, pages 3713\u20133722, 2019.   \n[51] Zaixi Zhang, Xiaoyu Cao, Jinyuan Jia, and Neil Zhenqiang Gong. Fldetector: Defending federated learning against model poisoning attacks via detecting malicious clients. In Proceedings of the 28th ACM SIGKDD Conference on Knowledge Discovery and Data Mining, pages 2545\u20132555, 2022.   \n[52] Yue Zhao, Meng Li, Liangzhen Lai, Naveen Suda, Damon Civin, and Vikas Chandra. Federated learning with non-iid data. arXiv preprint arXiv:1806.00582, 2018.   \n[53] Yanlin Zhou, George Pu, Xiyao Ma, Xiaolin Li, and Dapeng Wu. Distilled one-shot federated learning. arXiv preprint arXiv:2009.07999, 2020.   \n[54] Zhuangdi Zhu, Junyuan Hong, and Jiayu Zhou. Data-free knowledge distillation for heterogeneous federated learning. In International conference on machine learning, pages 12878\u201312889. PMLR, 2021. ", "page_idx": 11}, {"type": "text", "text": "", "page_idx": 12}, {"type": "text", "text": "Appendix ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "We provide additional information for our paper, HYDRA-FL: Hybrid Knowledge Distillation for Robust and Accurate Federated Learning, in the following order: ", "page_idx": 13}, {"type": "text", "text": "\u2022 Limitations and Future Work (Appendix A) \u2022 Terminology/Techniques (Appendix B \u2022 Adversarial Settings (Appendix C) \u2022 Experimental Setup (Appendix D) \u2022 Additional Results (Appendix E \u2022 Comparison with Standard KD (Appendix F) \u2022 Adaptability to Any KD Algorithm (Appendix G) \u2022 Other Related Works (Appendix H) ", "page_idx": 13}, {"type": "text", "text": "A Limitations and Future Work ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "Federated Learning can have very diverse setups, especially FL in an adversarial setting. We can have many setup combinations as we can choose between different aggregation rules, attacks, defenses, datasets, data modalities, data distribution types, data heterogeneity levels, number of clients, etc. Therefore, evaluating against all combinations of these settings is well beyond the scope of one paper. Hence, for this paper, we chose only a few combinations of FL settings and tried our best to show that the problem we identified using two representative FL techniques will also exist in similar techniques. Similarly, we laid out our solution as a general framework to achieve good performance under high heterogeneity and model poisoning simultaneously. To show generalizability, we tailored it to our two representative techniques, but it would be interesting to see how our solution adapts to and performs with other FL techniques in future works. Also, we have only used unimodal, i.e., image datasets for our evaluations. This was done to stay consistent with the implementations of the techniques chosen for our case study, FedNTD and MOON. However, the language modality is becoming popular now, and multimodal models such as CLIP [39] are being widely used as they achieve superior performance by combining both image and language modalities. We hope to incorporate language and multimodal models in our future works. ", "page_idx": 13}, {"type": "text", "text": "B Terminology/Techniques ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "B.1 FedNTD ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "FedNTD [21] is a KD-based technique that tackles the problem of data heterogeneity in FL. They first demonstrate that Data Heterogeneity causes local models to forget out-distribution knowledge, i.e., the data samples not part of the client\u2019s local data. Therefore, to preserve the out-distribution knowledge, they introduce not-true distillation, which basically modifies the loss function for the client model\u2019s local objective. FedNTD\u2019s loss function is given by: ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\mathcal{L}=\\mathcal{L}_{C E}(y_{c},y)+\\frac{\\beta}{b}\\mathcal{L}_{K L}(\\tilde{y}_{c},\\tilde{y}_{s})\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "Here $y$ is the target label, $y_{c}$ is the client model\u2019s output, $\\tilde{y}_{s}$ and $\\tilde{y_{c}}$ are the client model\u2019s and the server model\u2019s not-true logits, respectively. ", "page_idx": 13}, {"type": "text", "text": "B.2 MOON ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "MOON [26] also aims to solve the problem of data heterogeneity in FL. They do so by reducing the distance between the representation learned by the local model with that of the global model. MOON\u2019s loss function is given by: ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\mathcal{L}=\\mathcal{L}_{C E}(y_{c},y)+\\frac{\\mu}{b}\\mathcal{L}_{c o n}(z_{c},z_{s})\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "Here $y$ is the target label, $y_{c}$ is the client\u2019s output, $z_{c}$ is the representation from the client\u2019s final layer, $z_{s}$ is the representation from the server\u2019s final layer, and $y_{s}$ is the server model\u2019s output. ", "page_idx": 13}, {"type": "text", "text": "B.3 Shallow Layer and Shallow Distillation ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "Shallow layer. in a neural network refers to one of the early layers close to the input, as opposed to deeper layers that are closer to the output. In the context of a deep learning model, shallow layers generally capture low-level features, such as edges in images or simple patterns in data, while deeper layers capture more complex, abstract representations. ", "page_idx": 14}, {"type": "text", "text": "Shallow distillation. is a technique used in KD where the knowledge transfer happens at a shallow layer of the neural network rather than at the final output layer. In traditional KD, the student model tries to mimic the teacher model\u2019s output at the final layer. In shallow distillation, an additional distillation loss is applied at one of the shallow layers of the student model. This helps the student model learn intermediate representations from the teacher, providing a more comprehensive learning experience. By aligning these intermediate representations, the student model gains a more robust understanding of the data, leading to better generalization. ", "page_idx": 14}, {"type": "text", "text": "Robustness against poisoning. Shallow layers are less affected by adversarial attacks that target the final output of the model. Applying distillation at a shallow layer reduces the impact of a poisoned global model because the knowledge transferred is more fundamental and less influenced by the adversarial manipulations that typically affect the deeper layers. ", "page_idx": 14}, {"type": "text", "text": "C Adversarial Settings ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "Here we present the details of the adversarial settings of our experiments. We explain our threat model, which attacks we are using and why we are using them, and the defense we are using. ", "page_idx": 14}, {"type": "text", "text": "C.1 Threat Model ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "Goal: Our untargeted poisoning adversary controls $m$ out of $N$ clients to manipulate the global model to misclassify all the inputs it can during testing. Unless stated otherwise, we assume $20\\%$ malicious clients. Most defense works assume high percentages of malicious clients to demonstrate that their defenses work even in highly adversarial settings. Hence, although unreasonable in practical FL settings [41], we follow prior defense works and use $20\\%$ malicious clients. ", "page_idx": 14}, {"type": "text", "text": "Knowledge: Following most of the defense works, we assume that the adversary knows the robust AGR that the server uses. As assumed by most works, the adversary knows the server\u2019s AGR. To test the efficacy of our technique with a strong adversary, we consider the case where the adversary has access to not only the malicious clients\u2019 data but also the benign clients\u2019 data. This enables us to determine the upper bound of the efficacy of our technique. ", "page_idx": 14}, {"type": "text", "text": "Capabilities: Our adversary is strong enough to directly manipulate model updates of the malicious clients it controls. While poisoning attacks come in various types and flavors, we restrict ourselves to only model poisoning attacks. This is because model poisoning attacks are much stronger. It has been shown in [41] that model poisoning attacks are much stronger because they directly perturb the local model parameters. In contrast, data poisoning attacks perturb the data, subsequently perturbing the local and global models upon aggregation. Poisoning attacks can also be classified based on their error specificity. If the goal is to misclassify certain classes only, then it is a targeted attack and is often achieved by inserting a backdoor in the model that activates only for certain inputs. On the other hand, an untargeted attack indiscriminately lowers the accuracy for all inputs. ", "page_idx": 14}, {"type": "text", "text": "C.2 Attacks we use in our evaluation ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "We use two model poisoning attacks for our evaluations. By testing which attack worked well, we chose the Stat-Opt attack for MOON and the Dyn-Opt attack for FedNTD. Below, we briefly explain how they work: ", "page_idx": 14}, {"type": "text", "text": "\u2022 Stat-Opt [11]: gives an untargeted model poisoning framework and tailors it to specific defenes such as TrMean [48], Median [48], and Krum [6]. The adversary first calculates the mean of the benign updates, $\\nabla^{b}$ , and finds the static malicious direction $w=-s i g n(\\nabla^{b})$ . It directs the benign average along the calculated direction and scales it with $\\gamma$ to obtain the final poisoned update, $-\\gamma w$ . ", "page_idx": 14}, {"type": "text", "text": "\u2022 Dyn-Opt [42]: also gives an untargeted model poisoning framework and tailors it to specific defenses, similar to Stat-Opt but differs in the dynamic and data-dependent nature of the perturbation. The attack first computes the mean of benign updates, $\\nabla^{b}$ , and a datadependent direction, $w$ . The final poisoned update is calculated as $\\mathbf{\\boldsymbol{\\nabla}}^{\\prime}=\\nabla^{b}+\\gamma\\boldsymbol{w}$ , where the attack finds the largest $\\gamma$ that can bypass the AGR. They compare their attack with Stat-Opt and show that the dataset-tailored $w$ and optimization-based scaling factor $\\gamma$ make their attack much stronger. ", "page_idx": 15}, {"type": "text", "text": "C.3 Defense we use in our evaluation ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "We use the Trimmed Mean defense in our evaluations. Trimmed Mean [48, 45] is a foundational defense used in advanced AGRs [7, 51, 42]. The server receives model updates from each client, sorts each input dimension $j$ , discards the $m$ largest and smallest values (where $m$ indicates malicious clients), and averages the rest. ", "page_idx": 15}, {"type": "text", "text": "D Experimental Setup ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "Models: For MOON, we use a base encoder with two $5\\times5$ convolutional layers, each followed by a $2\\times2$ max pooling layer and two fully connected layers with ReLU activation. The base encoder is followed by a projection head with an output dimension of 256. For FedNTD, we use a model (similar to the one in [33]) having two convolutional layers followed by a linear layer and a classification layer. For FedNTD, we test with different values and settle upon a diminishing factor $b=1$ and $\\gamma{=}2$ . For MOON, we set $\\beta=0$ and set $\\gamma=1$ . We used PyTorch [37] for our implementation on an 8GB NVIDIA RTX 3060 Ti GPU. Each run of FedNTD and MOON took about 2-3 hours on our machine. ", "page_idx": 15}, {"type": "text", "text": "FL Settings: For FedNTD, we use 100 clients with a sampling ratio of 0.1, i.e., 10 clients are selected every round. We use momentum SGD with an initial learning rate of 0.1, weight decay of $1\\times e^{-5}$ , batch size of 50, and momentum of 0.9. Each run consists of 200 rounds with 5 local epochs. For MOON, we use 10 clients with a sampling ratio of 1. We use SGD with an initial learning rate of 0.01, weight decay of $1\\times e^{-5}$ , batch size of 64, and momentum of 0.9. Each run consists of 30 rounds with 10 local epochs, sufficient for convergence. ", "page_idx": 15}, {"type": "text", "text": "Data Partitioning: We use the widely used Dirichlet [35] distribution to generate the non-IID partitioning of data between clients. Dirichlet distribution works by sampling $p_{k}\\sim D i r_{N}(\\alpha)$ and assigns $p_{k,j}$ proportion of samples of class $k$ to client $j$ . A lower value of $\\alpha$ corresponds to a higher level of heterogeneity since it means that most of the samples of a certain class belong to one client. Conversely, at a higher value of $\\alpha$ , the class samples are more evenly distributed between the clients. Also, a characteristic of the Dirichlet distribution is that both local dataset size and local per-class distribution vary across clients. ", "page_idx": 15}, {"type": "text", "text": "Datasets: The three datasets we use in our experiments are: ", "page_idx": 15}, {"type": "text", "text": "\u2022 MNIST [20]: MNIST is a 10-class digit image classification dataset, which contains 70,000 grayscale images of size $28\\times28$ . We divide all data among FL clients (100 for FedNTD and 10 for MOON) using the Dirichlet [40] distribution. ", "page_idx": 15}, {"type": "text", "text": "\u2022 CIFAR10 [18]: CIFAR10 is a 10-class classification task with 60,000 total RGB images, each of size $32\\times32$ . Each class has 6000 training images and 1000 testing images. We divide all the data among 100 clients using the Dirichlet distribution, a popular synthetic strategy to generate FL datasets. ", "page_idx": 15}, {"type": "text", "text": "\u2022 CIFAR100 [18]: CIFAR100 is similar to CIFAR10, except that it is a 100-class classification task where each class has 600 images of size $32\\times32$ . There are 500 training images and 100 test images per class. Like other datasets, we also partition this dataset using the Dirichlet distribution. ", "page_idx": 15}, {"type": "text", "text": "E Additional Results ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "In this section, we present some of the additional results we have obtained. ", "page_idx": 15}, {"type": "table", "img_path": "6LVxO1C819/tmp/85194bcb36ca9cbfa5c9e4a76c4d7736eefbaeb3898bd0cb4c82ec1500c0df54.jpg", "table_caption": ["Table 4: FedNTD "], "table_footnote": [], "page_idx": 16}, {"type": "text", "text": "E.1 FedNTD ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "For visual symmetry, we did not include the full table in $\\S5$ , but we had also run our FedNTD experiments at $\\alpha\\,=\\,0.3$ . We show the full FedNTD results in Table 4. Here, we can see that at at $\\alpha=0.3$ too, we achieve superior results FedAvg and FedNTD in both benign and adversarial conditions. ", "page_idx": 16}, {"type": "text", "text": "E.2 MOON ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "We also ran ablation with MNIST for different shallow layers and diminishing coefficients. We show the results in Table 5, where we can see that at a lower effective $\\mu\\left({\\frac{\\mu}{b}}\\right)$ , i.e., higher diminishing factor, we achieve the best results. A lower $\\mu$ does give us better no-attack accuracy, but we lose a lot in the attack scenario. ", "page_idx": 16}, {"type": "table", "img_path": "6LVxO1C819/tmp/a12b9a6695293a2a57826e11b3e9f6b8659992c88d677048cc300470c80c9bd2.jpg", "table_caption": [], "table_footnote": ["Table 5: Comparison of HYDRA-FL for MOON with different distillation coefficients. "], "page_idx": 16}, {"type": "text", "text": "F Comparison With Standard KD ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "Dissimilarities: We elaborate on the dissimilarities first since they relate to the practicality of the attack amplification phenomenon. The threat model differs when we compare standard KD to KD in FL. In standard KD, there is only one student and one teacher. An attacker might poison the teacher with a backdoor trigger that causes misclassification on specific input samples. In the FL case, the teacher (server) model itself is not directly attacked. Instead, some of the client models are attacked, which indirectly poisons the global model because it is obtained by aggregating all the client models. Therefore, in the FL case, the attacker is poisoning some of the student models, which in turn poison the server model upon aggregation, and then propagates the poison to the non-malicious/benign clients when they use KD in their local training step. ", "page_idx": 16}, {"type": "text", "text": "Similarities: We believe that our mitigation technique, originally designed for FL, can also be effectively applied in non-FL settings. The premise of our technique, HYDRA-FL, is to reduce the distillation at the final layer and relegate some of it to a lower layer, thereby reducing the impact of distillation. To illustrate, imagine the poisoned distillation loss at the final layer as noise being injected into the model. By adjusting the distillation process (Section 4.1), this noise is relegated to lower layers through an auxiliary classifier, thereby mitigating the impact of such attacks. This dilution of adversarial effects can enhance robustness in both FL and non-FL settings. This is an interesting comment by the reviewer. It can be a potential future direction to rigorously experiment to find similarities and dissimilarities between KD in non-FL and FL settings. ", "page_idx": 16}, {"type": "text", "text": "G Adaptability to any KD Algorithm ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "Here we explain how HYDRA-FL can be applied to any KD algorithm in general. KD-based FL techniques align local and server models to reduce deviation caused by data heterogeneity. As ", "page_idx": 16}, {"type": "text", "text": "stated in Section 3, MOON uses model-contrastive learning for alignment, while FedNTD uses KL-divergence. Thus, any such KD based FL algorithm performs alignment (like tuning an engine). Its equation is: ", "page_idx": 17}, {"type": "equation", "text": "$$\n\\mathcal{L}=\\mathcal{L}_{C E}(y_{c},y)+\\phi\\mathcal{L}_{a l i g n m e n t}(y_{c},y_{s})\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "Here, $\\mathcal{L}_{a l i g n m e n t}$ represents the alignment technique. $\\phi$ represents the strength of this alignment. ", "page_idx": 17}, {"type": "text", "text": "In this generic setting, HYDRAFL would be a modification of the above equation. We will diminish $\\phi$ with $\"b'$ . We add a new loss term that performs this alignment at a shallow layer with an auxiliary classifier. HYDRAFL\u2019s equation becomes: ", "page_idx": 17}, {"type": "equation", "text": "$$\n\\mathcal{L}=\\mathcal{L}_{C E}(y_{c},y)+\\frac{\\phi}{b}\\mathcal{L}_{a l i g n m e n t}(y_{c},y_{s})+\\eta\\mathcal{L}_{a l i g n m e n t}(y_{a u x},y_{s})\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "H Other Related Works ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "H.1 Tao et al. [30] ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "Tao et al. [30] was primarily designed to address model heterogeneity in addition to data heterogeneity. Hence, they came up with model fusion on the server side using knowledge distillation with auxiliary data. Briefly, this fusion step involves initializing a student server model by aggregating the client models of different heterogeneous groups and then using an auxiliary dataset with each group to distill information into the server model. Our focus is on uncovering issues arising from data heterogeneity, which makes it difficult for fusion models to determine whether attack amplification is caused by data or model heterogeneity. However, exploring how model heterogeneity impacts attack success is an intriguing direction for future research. ", "page_idx": 17}, {"type": "text", "text": "H.2 Junyuan et al. [13] ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "Similarities: ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "Junyuan et al. [13] is also a mitigation technique against poisoned teachers. They also try to find out if poison is passed from the teacher to the student through the distillation process. To prevent this passing of poison, they have designed an anti-backdoor technique. Their technique also works by suppressing the poison and mitigating the performance degradation caused by bad supervision. They name these two stages of their defense mechanism as Shuffling Vaccine (SV) and Self-Retrospection (SR). ", "page_idx": 17}, {"type": "text", "text": "Dissimilarities: ", "page_idx": 17}, {"type": "text", "text": "However, there are two key differences. ", "page_idx": 17}, {"type": "text", "text": "Their technique targets backdoor attacks where a trigger causes performance degradation for a specific subset of samples. They use a \"shuffling vaccine\" to detect suspicious samples by shuffling channels. In contrast, we reduce the impact of poison by scaling down the distillation loss at the final layer using a diminishing factor. We address model poisoning, which is much stronger than backdoors since it aims to indiscriminately lower the accuracy of all samples. Therefore, our intuition is that their technique might not work against untargeted model poisoning as it is explicitly designed for backdoors. To mitigate performance degradation from a backdoored teacher, they use self-retrospection by synthesizing potential backdoor knowledge learned and confronting it during training. Conversely, we mitigate this by directing the distillation loss through an auxiliary classifier and scaling down the loss at the final classification layer. ", "page_idx": 17}, {"type": "text", "text": "NeurIPS Paper Checklist ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "1. Claims ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Question: Do the main claims made in the abstract and introduction accurately reflect the paper\u2019s contributions and scope? ", "page_idx": 18}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 18}, {"type": "text", "text": "Justification: Yes, we have ensured that the main claims in the abstract and introduction accurately reflect the paper\u2019s contributions and scope. ", "page_idx": 18}, {"type": "text", "text": "Guidelines: ", "page_idx": 18}, {"type": "text", "text": "\u2022 The answer NA means that the abstract and introduction do not include the claims made in the paper.   \n\u2022 The abstract and/or introduction should clearly state the claims made, including the contributions made in the paper and important assumptions and limitations. A No or NA answer to this question will not be perceived well by the reviewers.   \n\u2022 The claims made should match theoretical and experimental results, and reflect how much the results can be expected to generalize to other settings.   \n\u2022 It is fine to include aspirational goals as motivation as long as it is clear that these goals are not attained by the paper. ", "page_idx": 18}, {"type": "text", "text": "2. Limitations ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Question: Does the paper discuss the limitations of the work performed by the authors? ", "page_idx": 18}, {"type": "text", "text": "Answer: [Yes] . ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Justification: Yes, we have discussed the limitations and future work in Appendix A. ", "page_idx": 18}, {"type": "text", "text": "Guidelines: ", "page_idx": 18}, {"type": "text", "text": "\u2022 The answer NA means that the paper has no limitation while the answer No means that the paper has limitations, but those are not discussed in the paper.   \n\u2022 The authors are encouraged to create a separate \"Limitations\" section in their paper.   \n\u2022 The paper should point out any strong assumptions and how robust the results are to violations of these assumptions (e.g., independence assumptions, noiseless settings, model well-specification, asymptotic approximations only holding locally). The authors should reflect on how these assumptions might be violated in practice and what the implications would be.   \n\u2022 The authors should reflect on the scope of the claims made, e.g., if the approach was only tested on a few datasets or with a few runs. In general, empirical results often depend on implicit assumptions, which should be articulated.   \n\u2022 The authors should reflect on the factors that influence the performance of the approach. For example, a facial recognition algorithm may perform poorly when image resolution is low or images are taken in low lighting. Or a speech-to-text system might not be used reliably to provide closed captions for online lectures because it fails to handle technical jargon.   \n\u2022 The authors should discuss the computational efficiency of the proposed algorithms and how they scale with dataset size.   \n\u2022 If applicable, the authors should discuss possible limitations of their approach to address problems of privacy and fairness.   \n\u2022 While the authors might fear that complete honesty about limitations might be used by reviewers as grounds for rejection, a worse outcome might be that reviewers discover limitations that aren\u2019t acknowledged in the paper. The authors should use their best judgment and recognize that individual actions in favor of transparency play an important role in developing norms that preserve the integrity of the community. Reviewers will be specifically instructed to not penalize honesty concerning limitations. ", "page_idx": 18}, {"type": "text", "text": "3. Theory Assumptions and Proofs ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Question: For each theoretical result, does the paper provide the full set of assumptions and a complete (and correct) proof? ", "page_idx": 18}, {"type": "text", "text": "Answer: [NA] . ", "page_idx": 18}, {"type": "text", "text": "Justification: There is no theoretical result in this paper that requires a full set of assumptions and correct proof. ", "page_idx": 19}, {"type": "text", "text": "Guidelines: ", "page_idx": 19}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include theoretical results.   \n\u2022 All the theorems, formulas, and proofs in the paper should be numbered and crossreferenced.   \n\u2022 All assumptions should be clearly stated or referenced in the statement of any theorems.   \n\u2022 The proofs can either appear in the main paper or the supplemental material, but if they appear in the supplemental material, the authors are encouraged to provide a short proof sketch to provide intuition.   \n\u2022 Inversely, any informal proof provided in the core of the paper should be complemented by formal proofs provided in appendix or supplemental material.   \n\u2022 Theorems and Lemmas that the proof relies upon should be properly referenced. ", "page_idx": 19}, {"type": "text", "text": "4. Experimental Result Reproducibility ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "Question: Does the paper fully disclose all the information needed to reproduce the main experimental results of the paper to the extent that it affects the main claims and/or conclusions of the paper (regardless of whether the code and data are provided or not)? ", "page_idx": 19}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 19}, {"type": "text", "text": "Justification: Yes, we have fully disclosed the information needed to reproduce the main experimental results of the paper. They are written in Section 5 and Appendix D. ", "page_idx": 19}, {"type": "text", "text": "Guidelines: ", "page_idx": 19}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 If the paper includes experiments, a No answer to this question will not be perceived well by the reviewers: Making the paper reproducible is important, regardless of whether the code and data are provided or not.   \n\u2022 If the contribution is a dataset and/or model, the authors should describe the steps taken to make their results reproducible or verifiable.   \n\u2022 Depending on the contribution, reproducibility can be accomplished in various ways. For example, if the contribution is a novel architecture, describing the architecture fully might suffice, or if the contribution is a specific model and empirical evaluation, it may be necessary to either make it possible for others to replicate the model with the same dataset, or provide access to the model. In general. releasing code and data is often one good way to accomplish this, but reproducibility can also be provided via detailed instructions for how to replicate the results, access to a hosted model (e.g., in the case of a large language model), releasing of a model checkpoint, or other means that are appropriate to the research performed.   \n\u2022 While NeurIPS does not require releasing code, the conference does require all submissions to provide some reasonable avenue for reproducibility, which may depend on the nature of the contribution. For example (a) If the contribution is primarily a new algorithm, the paper should make it clear how to reproduce that algorithm. (b) If the contribution is primarily a new model architecture, the paper should describe the architecture clearly and fully. (c) If the contribution is a new model (e.g., a large language model), then there should either be a way to access this model for reproducing the results or a way to reproduce the model (e.g., with an open-source dataset or instructions for how to construct the dataset). (d) We recognize that reproducibility may be tricky in some cases, in which case authors are welcome to describe the particular way they provide for reproducibility. In the case of closed-source models, it may be that access to the model is limited in some way (e.g., to registered users), but it should be possible for other researchers to have some path to reproducing or verifying the results. ", "page_idx": 19}, {"type": "text", "text": "5. Open access to data and code ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "Question: Does the paper provide open access to the data and code, with sufficient instructions to faithfully reproduce the main experimental results, as described in supplemental material? ", "page_idx": 20}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 20}, {"type": "text", "text": "Justification: The code is available at https://github.com/momin-ahmad-khan/ HYDRA-FL. ", "page_idx": 20}, {"type": "text", "text": "Guidelines: ", "page_idx": 20}, {"type": "text", "text": "\u2022 The answer NA means that paper does not include experiments requiring code.   \n\u2022 Please see the NeurIPS code and data submission guidelines (https://nips.cc/ public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 While we encourage the release of code and data, we understand that this might not be possible, so \u201cNo\u201d is an acceptable answer. Papers cannot be rejected simply for not including code, unless this is central to the contribution (e.g., for a new open-source benchmark).   \n\u2022 The instructions should contain the exact command and environment needed to run to reproduce the results. See the NeurIPS code and data submission guidelines (https: //nips.cc/public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 The authors should provide instructions on data access and preparation, including how to access the raw data, preprocessed data, intermediate data, and generated data, etc.   \n\u2022 The authors should provide scripts to reproduce all experimental results for the new proposed method and baselines. If only a subset of experiments are reproducible, they should state which ones are omitted from the script and why.   \n\u2022 At submission time, to preserve anonymity, the authors should release anonymized versions (if applicable).   \n\u2022 Providing as much information as possible in supplemental material (appended to the paper) is recommended, but including URLs to data and code is permitted. ", "page_idx": 20}, {"type": "text", "text": "6. Experimental Setting/Details ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Question: Does the paper specify all the training and test details (e.g., data splits, hyperparameters, how they were chosen, type of optimizer, etc.) necessary to understand the results? ", "page_idx": 20}, {"type": "text", "text": "Answer: [Yes] . ", "page_idx": 20}, {"type": "text", "text": "Justification: We specify the training and test details in Appendix D. ", "page_idx": 20}, {"type": "text", "text": "Guidelines: ", "page_idx": 20}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments. \u2022 The experimental setting should be presented in the core of the paper to a level of detail that is necessary to appreciate the results and make sense of them. \u2022 The full details can be provided either with the code, in appendix, or as supplemental material. ", "page_idx": 20}, {"type": "text", "text": "7. Experiment Statistical Significance ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Question: Does the paper report error bars suitably and correctly defined or other appropriate information about the statistical significance of the experiments? ", "page_idx": 20}, {"type": "text", "text": "Answer: [No] . ", "page_idx": 20}, {"type": "text", "text": "Justification: We did not have enough compute resources to completely re-run all the experiments for different seeds and report error bars for different runs. We ran our experiments on different validation sets to verify that our technique generalizes well and is not overfitting over one particular data distribution. ", "page_idx": 20}, {"type": "text", "text": "Guidelines: ", "page_idx": 20}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments. \u2022 The authors should answer \"Yes\" if the results are accompanied by error bars, confidence intervals, or statistical significance tests, at least for the experiments that support the main claims of the paper. ", "page_idx": 20}, {"type": "text", "text": "\u2022 The factors of variability that the error bars are capturing should be clearly stated (for example, train/test split, initialization, random drawing of some parameter, or overall run with given experimental conditions).   \n\u2022 The method for calculating the error bars should be explained (closed form formula, call to a library function, bootstrap, etc.)   \n\u2022 The assumptions made should be given (e.g., Normally distributed errors).   \n\u2022 It should be clear whether the error bar is the standard deviation or the standard error of the mean.   \n\u2022 It is OK to report 1-sigma error bars, but one should state it. The authors should preferably report a 2-sigma error bar than state that they have a $96\\%$ CI, if the hypothesis of Normality of errors is not verified.   \n\u2022 For asymmetric distributions, the authors should be careful not to show in tables or figures symmetric error bars that would yield results that are out of range (e.g. negative error rates).   \n\u2022 If error bars are reported in tables or plots, The authors should explain in the text how they were calculated and reference the corresponding figures or tables in the text. ", "page_idx": 21}, {"type": "text", "text": "8. Experiments Compute Resources ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "Question: For each experiment, does the paper provide sufficient information on the computer resources (type of compute workers, memory, time of execution) needed to reproduce the experiments? ", "page_idx": 21}, {"type": "text", "text": "Answer: [Yes] . ", "page_idx": 21}, {"type": "text", "text": "Justification: We present these details in Appendix D. ", "page_idx": 21}, {"type": "text", "text": "Guidelines: ", "page_idx": 21}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The paper should indicate the type of compute workers CPU or GPU, internal cluster, or cloud provider, including relevant memory and storage.   \n\u2022 The paper should provide the amount of compute required for each of the individual experimental runs as well as estimate the total compute.   \n\u2022 The paper should disclose whether the full research project required more compute than the experiments reported in the paper (e.g., preliminary or failed experiments that didn\u2019t make it into the paper). ", "page_idx": 21}, {"type": "text", "text": "9. Code Of Ethics ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "Question: Does the research conducted in the paper conform, in every respect, with the NeurIPS Code of Ethics https://neurips.cc/public/EthicsGuidelines? ", "page_idx": 21}, {"type": "text", "text": "Answer: [Yes] . ", "page_idx": 21}, {"type": "text", "text": "Justification: Yes, to the best of our knowledge, our paper conforms to the NeurIPS Code of Ethics in every aspect. ", "page_idx": 21}, {"type": "text", "text": "Guidelines: ", "page_idx": 21}, {"type": "text", "text": "\u2022 The answer NA means that the authors have not reviewed the NeurIPS Code of Ethics.   \n\u2022 If the authors answer No, they should explain the special circumstances that require a deviation from the Code of Ethics.   \n\u2022 The authors should make sure to preserve anonymity (e.g., if there is a special consideration due to laws or regulations in their jurisdiction). ", "page_idx": 21}, {"type": "text", "text": "10. Broader Impacts ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "Question: Does the paper discuss both potential positive societal impacts and negative societal impacts of the work performed? ", "page_idx": 21}, {"type": "text", "text": "Answer: [NA] . ", "page_idx": 21}, {"type": "text", "text": "Justification: Or work does not have such a societal impact that requires discussion in the paper. ", "page_idx": 21}, {"type": "text", "text": "Guidelines: \u2022 The answer NA means that there is no societal impact of the work performed. ", "page_idx": 21}, {"type": "text", "text": "\u2022 If the authors answer NA or No, they should explain why their work has no societal impact or why the paper does not address societal impact.   \n\u2022 Examples of negative societal impacts include potential malicious or unintended uses (e.g., disinformation, generating fake profiles, surveillance), fairness considerations (e.g., deployment of technologies that could make decisions that unfairly impact specific groups), privacy considerations, and security considerations.   \n\u2022 The conference expects that many papers will be foundational research and not tied to particular applications, let alone deployments. However, if there is a direct path to any negative applications, the authors should point it out. For example, it is legitimate to point out that an improvement in the quality of generative models could be used to generate deepfakes for disinformation. On the other hand, it is not needed to point out that a generic algorithm for optimizing neural networks could enable people to train models that generate Deepfakes faster.   \n\u2022 The authors should consider possible harms that could arise when the technology is being used as intended and functioning correctly, harms that could arise when the technology is being used as intended but gives incorrect results, and harms following from (intentional or unintentional) misuse of the technology.   \n\u2022 If there are negative societal impacts, the authors could also discuss possible mitigation strategies (e.g., gated release of models, providing defenses in addition to attacks, mechanisms for monitoring misuse, mechanisms to monitor how a system learns from feedback over time, improving the efficiency and accessibility of ML). ", "page_idx": 22}, {"type": "text", "text": "11. Safeguards ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Question: Does the paper describe safeguards that have been put in place for responsible release of data or models that have a high risk for misuse (e.g., pretrained language models, image generators, or scraped datasets)? ", "page_idx": 22}, {"type": "text", "text": "Answer: [NA] . ", "page_idx": 22}, {"type": "text", "text": "Justification: To the best of our knowledge, our paper poses no such risks. We use publicly available code and data for our work. ", "page_idx": 22}, {"type": "text", "text": "Guidelines: ", "page_idx": 22}, {"type": "text", "text": "\u2022 The answer NA means that the paper poses no such risks.   \n\u2022 Released models that have a high risk for misuse or dual-use should be released with necessary safeguards to allow for controlled use of the model, for example by requiring that users adhere to usage guidelines or restrictions to access the model or implementing safety filters.   \n\u2022 Datasets that have been scraped from the Internet could pose safety risks. The authors should describe how they avoided releasing unsafe images.   \n\u2022 We recognize that providing effective safeguards is challenging, and many papers do not require this, but we encourage authors to take this into account and make a best faith effort. ", "page_idx": 22}, {"type": "text", "text": "12. Licenses for existing assets ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Question: Are the creators or original owners of assets (e.g., code, data, models), used in the paper, properly credited and are the license and terms of use explicitly mentioned and properly respected? ", "page_idx": 22}, {"type": "text", "text": "Answer: [Yes] . ", "page_idx": 22}, {"type": "text", "text": "Justification: We have cited all three datasets; MNIST [20], CIFAR10 [18], and CIFAR100 [18]. Their licenses are not mentioned on paperswithcode. ", "page_idx": 22}, {"type": "text", "text": "Guidelines: ", "page_idx": 22}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not use existing assets.   \n\u2022 The authors should cite the original paper that produced the code package or dataset.   \n\u2022 The authors should state which version of the asset is used and, if possible, include a URL.   \n\u2022 The name of the license (e.g., CC-BY 4.0) should be included for each asset.   \n\u2022 For scraped data from a particular source (e.g., website), the copyright and terms of service of that source should be provided.   \n\u2022 If assets are released, the license, copyright information, and terms of use in the package should be provided. For popular datasets, paperswithcode.com/datasets has curated licenses for some datasets. Their licensing guide can help determine the license of a dataset.   \n\u2022 For existing datasets that are re-packaged, both the original license and the license of the derived asset (if it has changed) should be provided.   \n\u2022 If this information is not available online, the authors are encouraged to reach out to the asset\u2019s creators. ", "page_idx": 22}, {"type": "text", "text": "", "page_idx": 23}, {"type": "text", "text": "13. New Assets ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: Are new assets introduced in the paper well documented and is the documentation provided alongside the assets? ", "page_idx": 23}, {"type": "text", "text": "Answer: [Yes] . ", "page_idx": 23}, {"type": "text", "text": "Justification: The code is available at https://github.com/momin-ahmad-khan/ HYDRA-FL. ", "page_idx": 23}, {"type": "text", "text": "Guidelines: ", "page_idx": 23}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not release new assets.   \n\u2022 Researchers should communicate the details of the dataset/code/model as part of their submissions via structured templates. This includes details about training, license, limitations, etc.   \n\u2022 The paper should discuss whether and how consent was obtained from people whose asset is used.   \n\u2022 At submission time, remember to anonymize your assets (if applicable). You can either create an anonymized URL or include an anonymized zip file. ", "page_idx": 23}, {"type": "text", "text": "14. Crowdsourcing and Research with Human Subjects ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: For crowdsourcing experiments and research with human subjects, does the paper include the full text of instructions given to participants and screenshots, if applicable, as well as details about compensation (if any)? ", "page_idx": 23}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 23}, {"type": "text", "text": "Justification: Our paper does not involve any crowdsourcing experiments nor research with human subjects. ", "page_idx": 23}, {"type": "text", "text": "Guidelines: ", "page_idx": 23}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Including this information in the supplemental material is fine, but if the main contribution of the paper involves human subjects, then as much detail as possible should be included in the main paper.   \n\u2022 According to the NeurIPS Code of Ethics, workers involved in data collection, curation, or other labor should be paid at least the minimum wage in the country of the data collector. ", "page_idx": 23}, {"type": "text", "text": "15. Institutional Review Board (IRB) Approvals or Equivalent for Research with Human Subjects ", "page_idx": 23}, {"type": "text", "text": "Question: Does the paper describe potential risks incurred by study participants, whether such risks were disclosed to the subjects, and whether Institutional Review Board (IRB) approvals (or an equivalent approval/review based on the requirements of your country or institution) were obtained? ", "page_idx": 23}, {"type": "text", "text": "Answer: [NA] . ", "page_idx": 23}, {"type": "text", "text": "Justification: Our paper does not involve crowdsourcing nor research with human subjects. Guidelines: ", "page_idx": 23}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects. ", "page_idx": 23}, {"type": "text", "text": "\u2022 Depending on the country in which research is conducted, IRB approval (or equivalent) may be required for any human subjects research. If you obtained IRB approval, you should clearly state this in the paper.   \n\u2022 We recognize that the procedures for this may vary significantly between institutions and locations, and we expect authors to adhere to the NeurIPS Code of Ethics and the guidelines for their institution.   \n\u2022 For initial submissions, do not include any information that would break anonymity (if applicable), such as the institution conducting the review. ", "page_idx": 24}]