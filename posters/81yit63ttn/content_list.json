[{"type": "text", "text": "Twin-Merging: Dynamic Integration of Modular Expertise in Model Merging ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Zhenyi $\\mathbf{L}\\mathbf{u}^{1,2*}$ Chenghao $\\mathbf{Fan}^{1,2*}$ Wei Wei1,2\u2020 Xiaoye $\\mathbf{Qu^{1}}$ Dangyang Chen3 Yu Cheng4 ", "page_idx": 0}, {"type": "text", "text": "1 School of Computer Science & Technology, Huazhong University of Science and Technology, 2 Joint Laboratory of HUST and Pingan Property & Casualty Research (HPL), 3 Ping An Property & Casualty Insurance Company of China, Ltd., 4 The Chinese University of Hong Kong. {luzhenyi529,facicofan}@gmail.com, {weiw, xiaoye}@hust.edu.cn, chendangyang273@pingan.com.cn, chengyu@cse.cuhk.edu.hk ", "page_idx": 0}, {"type": "text", "text": "Abstract ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "In the era of large language models, model merging is a promising way to combine multiple task-specific models into a single multitask model without extra training. However, two challenges remain: (a) interference between different models and (b) heterogeneous data during testing. Traditional model merging methods often show significant performance gaps compared to fine-tuned models due to these issues. Additionally, a one-size-ftis-all model lacks flexibility for diverse test data, leading to performance degradation. We show that both shared and exclusive task-specific knowledge are crucial for merging performance, but directly merging exclusive knowledge hinders overall performance. In view of this, we propose Twin-Merging, a method that encompasses two principal stages: (1) modularizing knowledge into shared and exclusive components, with compression to reduce redundancy and enhance efficiency; (2) dynamically merging shared and taskspecific knowledge based on the input. This approach narrows the performance gap between merged and fine-tuned models and improves adaptability to heterogeneous data. Extensive experiments on 20 datasets for both language and vision tasks demonstrate the effectiveness of our method, showing an average improvement of $28.34\\%$ in absolute normalized score for discriminative tasks and even surpassing the fine-tuned upper bound on the generative tasks. 1 ", "page_idx": 0}, {"type": "text", "text": "1 Introduction ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "In recent years, Large Language Models (LLMs) have demonstrated notable success across various Natural Language Processing (NLP) tasks [12, 16, 43, 61\u201363, 65, 68], including code generation [22, 56], solving math problems [2, 44], multilingualism [47], etc. These models, with billions of parameters, excel in various downstream tasks [25, 34, 72] but require extensive training on large datasets using thousands of GPUs. The considerable computational and energy costs [53] limit their specialization and deployment in resource-constrained environments [38]. ", "page_idx": 0}, {"type": "text", "text": "To tackle this challenge, model fusion has emerged as a promising solution [37]. One notable paradigm is model merging [29, 33, 76, 78], where multiple task-specific models, or \u201cexperts\u201d, are combined into a single unified model. This unified model can quickly adapt to new tasks without the need to retrain a large model. Various techniques, such as parameter averaging [6, 74], weight interpolation [33, 46], and advanced strategies like task arithmetic [29, 51, 67, 78], have been developed for model merging. These techniques have been proven effective, enabling the integration of fine-tuned knowledge from diverse tasks into a multi-task model without additional training. ", "page_idx": 0}, {"type": "table", "img_path": "81YIt63TTn/tmp/3d913d2a9dd1349f9edee1ca9724840e2acfffcc69efaf993d375defa1e21404.jpg", "table_caption": [], "table_footnote": [], "page_idx": 1}, {"type": "text", "text": "", "page_idx": 1}, {"type": "text", "text": "However, merging models from different domains often sacrifices specific task performance, leading to a large performance gap compared to the individual expert [31, 76]. Two major causes prevent the existing merging methods from reaching the theoretical upper-bound performance of individual experts: (1) Interference between models. Previous research shows that parameter redundancy and sign discrepancies [76], as well as the distribution gap between tasks [31], hinder effective model merging. We demonstrate that task-specific models often contain mixed knowledge, where the expertise in one model may be exclusive or detrimental to others. This redundancy or interference can obstruct the integration of expertise across models [9]. (2) heterogeneity of data at test time. Previous methods pursue a single, static optimal solution for various tasks. While a one-size-fitsall model avoids introducing new parameters, it might be inadequate or suboptimal due to the unpredictable nature of test inputs [78]. It limits the utilization of complementary knowledge and leads to deteriorated performance [71]. ", "page_idx": 1}, {"type": "text", "text": "To address the above issues, in this paper, we introduce Twin Merging, involving two principal stages: (1) Knowledge Modularization: Unlike previous research that migrates merging interference in a parameter-wise manner or searches merging coefficients, we decompose the knowledge possessed by experts into shared knowledge and exclusive task-specific knowledge, as shown in Figure 1 (II). First, we compress common knowledge into a shared expert, serving to capture and consolidate common knowledge across varying tasks. Then we isolate exclusive knowledge based on the difference between the task experts and the shared expert, allowing diverse knowledge to be decomposed more finely. (2) Dynamic Merging: Inspired by Mixture of Experts (MoE) [80, 84, 85], we simplify the parameter merging problem into a conditional composition problem. Instead of pre-determining the best parameter combination for heterogeneous data at test time, as illustrated in Figure 1 (III), we introduce a router to dynamically merge shared and exclusive knowledge based on the test inputs. The shared model serves as the foundation, and task-specific knowledge is conditionally injected according to the router. ", "page_idx": 1}, {"type": "text", "text": "We demonstrate the effectiveness of our proposed Twin-Merging method through extensive experiments on 12 datasets, covering both discriminative and generative tasks, various model architectures, and in-domain and out-of-domain setups. As shown in Figure 2b, Twin-Merging consistently outperforms other merging methods across all datasets, surpassing the strongest baseline by an average of $28.34\\%$ in normalized scores for discriminative tasks and $\\bar{3}.86\\%$ for generative tasks on the scaled model (Qwen-14B). We validate the scalability, extensibility, generalization, and storage efficiency of Twin-Merging (Figure 2a). Remarkably, even with a $99.9\\%$ reduction in parameters, our method only experiences a slight $14\\%$ performance degradation. Our results establish Twin-Merging as a powerful and effective method for combining multiple fine-tuned models into a single multi-task model. ", "page_idx": 1}, {"type": "text", "text": "To summarize, our contributions are as follows: (1) We introduce Twin-Merging, a novel model fusion method that reduces the performance gap between traditional model merging and fine-tuned models while enhancing adaptability to diverse data. (2) We investigate the impact of shared and exclusive task-specific knowledge on merging performance, presenting innovative techniques for knowledge disentanglement and dynamic merging. (3) Twin-Merging is simple to implement with minimal hyperparameters, improves multi-task performance without retraining expert models, and can be combined with other merging methods for further gains. Our approach scales well with model size and task numbers and is storage-efficient. ", "page_idx": 1}, {"type": "image", "img_path": "81YIt63TTn/tmp/0ced60dd72ecf9119a6f8987bb4f7c896f483373de0c803b34be26819680e041.jpg", "img_caption": ["Figure 2: The effectiveness of Twin-Merging in terms of performance and parameter-efficiency. "], "img_footnote": [], "page_idx": 2}, {"type": "text", "text": "", "page_idx": 2}, {"type": "text", "text": "2 Related Work ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "In this section, we focus on model merging research, for additional related work on multi-task learning and Mixture of Experts, please see Appendix B. Model merging aims to fuse multiple fine-tuned taskspecific models into one comprehensive multi-task model without additional training. FisherMerging [46] and RegMean [33], use straightforward weight averaging but require extra data and computation. Some works [1, 21, 58, 60, 70] bring models into a single low-loss basin and interpolate between them based on the linear mode connectivity (LMC) theory [15, 18, 20]. The weight permutations [1] and optimal transport [58] are utilized to better interpolate neural networks. However, recent studies [83] suggest that LMC might not always hold for fine-tuned models. Task-Arithmetic [28, 51] extends averaging to arithmetic operations in the parameter space for finer control over model behaviors, but the interference between the multiple models can be an issue. To tackle this challenge, advanced merging methods like Ties-Merging [76], AdaMerging [78] and DARE [79] have been proposed. These methods aim to reduce task confilcts by addressing parameter redundancy or disagreements in signs, finding optimal merging coefficients, and reducing weight density, respectively. Jiang et al. [32] assume that test tasks are known and use task-specific knowledge to improve performance. However, this assumption is often unrealistic since real-world data distributions are unpredictable. In contrast, our method addresses merging interference by modularizing shared and task-specific knowledge. We handle heterogeneous test data scenarios by introducing dynamic merging techniques. ", "page_idx": 2}, {"type": "text", "text": "3 Methodology ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "3.1 Analysis of the Performance Gap in Model Merging ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "In this paper, following the settings of model merging [29, 76, 79], we consider the case of $T$ tasks, where training for each task $t$ starts from pre-trained model weight $\\theta_{0}$ and fine-tunes on $\\mathcal{D}_{t}^{t r a i n}$ to obtain task-specific model $\\pmb\\theta_{t}$ . Let $f(\\pmb{x};\\pmb{\\theta})$ be a language model accepting inputs $\\pmb{x}\\in\\mathcal{X}$ and paramterized by weights $\\theta\\in\\Theta$ . Considering the real data distributions are diverse and challenging to represent with a single task, to model such distributions, previous methods typically consider the mixture of $T$ task test data: $\\begin{array}{r}{\\mathcal{D}=\\sum_{t=1}^{T}\\alpha_{t}\\mathcal{D}_{t}}\\end{array}$ , where $\\begin{array}{r}{\\sum_{t=1}^{T}\\alpha_{t}=1,\\alpha_{t}>0\\:\\forall t}\\end{array}$ . The model merging considers the problem where we have $T$ fine-tuned expert models $\\{f_{t}(\\mathbf{x};\\pmb{\\theta}_{t})\\}_{t=1}^{T}$ and pre-trained weight $\\pmb{\\theta}_{0}$ , composing a multitask model $\\pmb{\\theta}^{*}$ to approximate the optimal solution. ", "page_idx": 2}, {"type": "text", "text": "", "page_idx": 3}, {"type": "equation", "text": "$$\n\\pmb{\\theta}_{o p t}\\approx\\pmb{\\theta}^{*}=\\mathcal{F}(\\pmb{\\theta}_{0},\\pmb{\\theta}_{1},\\cdot\\cdot\\cdot\\mathrm{~,~}\\pmb{\\theta}_{T})\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "Here $\\mathcal{F}$ represents an arbitrary merging function. For example, in Task Arithmetic [28], $\\pmb{\\theta}^{*}~=$ $\\begin{array}{r}{\\pmb{\\theta}_{0}+\\sum_{t=1}^{T}\\gamma_{t}(\\pmb{\\theta}_{t}-\\pmb{\\theta}_{0})}\\end{array}$ . ", "page_idx": 3}, {"type": "table", "img_path": "81YIt63TTn/tmp/da8e7cb6f4edfdbdb2d6c0f74b0d13e81b9655f3ec5a3b407657267781d10594.jpg", "table_caption": ["Table 1: Merging without parameter interference and merging between similar tasks both cause performance degradation (Notice: these two experiments use different datasets). "], "table_footnote": [], "page_idx": 3}, {"type": "image", "img_path": "81YIt63TTn/tmp/fdba7bae6793e1b0bb17959534270af4ca39f9d65caa810b766cd514be498b76.jpg", "img_caption": ["Figure 3: The impact of different ratios of shared knowledge and exclusive knowledge. "], "img_footnote": [], "page_idx": 3}, {"type": "text", "text": "Although existing merging methods, like Task Arithmetic, can combine multiple task-specific models efficiently, they often exhibit significant performance gaps compared to single-task models. Prior research, such as Ties Merging [76], attributes this phenomenon to parameter interference. This term refers to the redundancy or sign discrepancies found in parameters located at the same position (e.g., self-attention weights) across different task models, which in turn result in information confilcting and performance loss. Additionally, task interference, as noted in multi-task learning literature [13, 31], arises from the inherent differences between tasks. For instance, tasks such as summarization, mathematical reasoning, and code generation require the model to process information in distinct ways. These differences worsen interference when models trained on different tasks are merged. ", "page_idx": 3}, {"type": "text", "text": "To understand these performance drops, we conducted two experiments using Task Arithmetic. First, we fine-tuned Qwen-14B with LoRA, assigning non-overlapping modules to avoid parameter interference. Despite this, a $3.21\\%$ drop in performance occurred, indicating persistent interference. Second, using two similar summarization tasks (XSUM and DailyMail), we observed an $8.42\\%$ drop compared to individually fine-tuned models, confirming that interference persists even between similar tasks. These results suggest that interference in model merging is not limited to parameter-wise and task-wise issues. ", "page_idx": 3}, {"type": "text", "text": "3.2 Interpreting Interference From the Perspective of Knowledge ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "To tackle the challenge of interference, we examine the merging process at a finer-grained knowledge perspective. We identify two types of critical knowledge: (1) Shared knowledge, which benefits multiple tasks, and (2) Exclusive knowledge, which is useful only for a specific task. Single-task models often contain both types, complicating the merging process and leading to interference. To validate our hypotheses, we conduct experiments that vary the ratio of task-specific and shared knowledge. ", "page_idx": 3}, {"type": "text", "text": "To examine the impact of shared knowledge, we conducted full fine-tuning on each model for its specific task. Excessive fine-tuning epochs can lead to catastrophic forgetting [19], a phenomenon where the model retains task-specific knowledge but loses general knowledge. As the fine-tuning epochs increase, the shared knowledge gradually decreases. The top section of Figure 3 illustrates that as the epoch count increases, merging performance significantly deteriorates, even though the fine-tuned model performs well on its task. This underscores the crucial role of shared knowledge in merging performance. ", "page_idx": 3}, {"type": "text", "text": "To explore the impact of exclusive knowledge, we merge a single task-specific model into the base model. We apply a sparsity method (e.g., SVD) to reduce the ratios of task-specific weights in the merging model from $100\\%$ (standard merging) to $0\\%$ (base model). As shown in the lower part of Figure 3, performance remains stable up to $90\\%$ sparsity. Notably, even with a $99\\%$ sparsity rate, a single-merged model outperforms multi-model merging, confirming the existence of exclusive knowledge, which is more pronounced with more models. This also underscores the value of unmerged task-specific knowledge, since the fine-tuning performance can be effectively restored by preserving unmerged task-specific information. ", "page_idx": 3}, {"type": "text", "text": "", "page_idx": 4}, {"type": "text", "text": "To summarize, both shared knowledge and un-merged task-specific knowledge play a vital role in merging performance. The exclusive nature of task-specific knowledge hinders the effectiveness of merging methods. Different types of knowledge need to be separated and modularized to achieve optimal performance. Thus, the first step of our Twin-Merging approach is to explicitly partition the weights into an expert containing shared knowledge and weights holding task-exclusive knowledge before merging. Formally, we denote the shared expert as $\\theta_{s}$ and the exclusive task-specific knowledge as $\\{v_{t}\\}_{t=1}^{T}$ , the detail of our method is illustrated in the following section. ", "page_idx": 4}, {"type": "text", "text": "3.3 Twin Merging ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "Our proposed Twin-Merging employs two main stages: knowledge modularization and dynamic merging. These stages are designed to narrow the performance gap and enhance adaptive knowledge composition. Building on the formulation in Equation (2), Twin-Merging preprocesses experts into shared experts, isolates and compresses exclusive knowledge into vectors, and dynamically composes them during inference. ", "page_idx": 4}, {"type": "text", "text": "The preprocess stage comprises three steps: (1) Shared Expert: To separate shared knowledge across different models, we consider the pre-merged model as a natural placeholder to encapsulate common knowledge that is important to all tasks (denoted as $\\pmb{\\theta}^{*}$ ). By leveraging established merging techniques such as Task Arithmetic, we can readily extract the shared experts from the initial merged model. (2) Exclusive Knowledge: To convey task-specific information while separating common knowledge, we calculate the difference vector: ${\\pmb v}_{t}={\\pmb\\theta}_{t}-{\\pmb\\theta}^{*}$ . This subtraction vector preserves un-merged task-specific information while discarding the shared knowledge. (3) Compressed ex", "page_idx": 4}, {"type": "table", "img_path": "81YIt63TTn/tmp/df95f8af1b836fc8558d4b50ce8acf97bc9459f88c32c70e6124317004e42dc4.jpg", "table_caption": [], "table_footnote": [], "page_idx": 4}, {"type": "text", "text": "clusive vectors: For practical use and distribution, we apply singular value decomposition (SVD) to further compress the above exclusive knowledge into vectors for each task. Assuming $\\pmb{v}_{t}$ has a rank- $\\cdot m$ decomposition, $\\pmb{v}_{t}=\\mathbf{U}_{t}\\pmb{\\Sigma}_{t}\\mathbf{V}_{t}^{T}$ , we achieve a low-rank task space by selecting the top- $-r$ singular values, resulting in $\\mathbf{U}_{t}(r)\\Sigma_{t}(r)\\mathbf{V}_{t}(r)^{T}$ . We store only $\\mathbf{U}_{t}(r),\\dot{\\Sigma}_{t}(r),\\mathbf{\\dot{V}}_{t}(r)^{T}$ . ", "page_idx": 4}, {"type": "text", "text": "In inference stage, adapting to unforeseen challenges is difficult, especially with varied test data. For example, if most of the data consists of a certain type (denoted as $\\mathcal{D}_{u}$ ), we should tailor the merged model for that specific task to get the best results. Instead of pre-defining the best parameters, we propose a new approach that combines shared expertise with exclusive knowledge. Our method involves using the input $\\textbf{\\em x}$ to dynamically adjust to the current data, enabling us to utilize shared knowledge and apply specialized expertise based on the inputs. ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\pmb{\\theta}^{*}=\\mathcal{F}(\\underbrace{\\textnormal{\\texttt{\\textbf{\\theta}}}}_{\\mathrm{~\\normalfont~\\leftmoon~}}\\underbrace{\\textnormal{\\texttt{\\textbf{\\theta}}},\\ \\ \\mathbf{v}_{1},\\cdot\\cdot\\cdot\\mathbf{\\theta},v_{T}}_{\\mathrm{~\\normalfont~\\leftmoon~}}\\ ,\\pmb{x})\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "During inference, we fine-tune a small fuser $\\mathcal{R}$ parameterized by $\\phi$ through empirical risk minimization on a small validation dataset. This fuser, trained to dynamically select the specific task experts, ", "page_idx": 4}, {"type": "text", "text": "replacing the need for complex optimization algorithms to determine fusion coefficients. The merging model is obtained by: ", "page_idx": 5}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\theta^{*}=\\theta_{s}+\\displaystyle\\sum_{t=1}^{T}w_{t}*\\mathrm{SVD}_{r}\\big(\\pmb{\\theta}_{t}-\\pmb{\\theta}^{*}\\big)}\\\\ {\\{w_{1},\\dots,w_{T}\\}=\\mathrm{softmax}\\Bigg(\\mathcal{R}\\big(\\mathrm{Emb}(\\pmb{x});\\phi\\big)\\Bigg)}\\end{array}\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "Here, $\\operatorname{Emb}(x)$ represents the sequence of the last-layer token embeddings from the shared expert $f(\\pmb{x};\\pmb{\\theta}_{s})$ . ", "page_idx": 5}, {"type": "text", "text": "4 Experiments ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "4.1 Merging Experiment ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "Baselines We first compare Twin-Merging with several train-free model-merging methods on both discriminative and generative NLP benchmarks, including weight averaging, Task Arithmetic [28], Ties-Merging [76], and DARE Merging [79]. To compare with Merging methods that need validation dataset, we also conduct experiments on CV tasks with AdaMerging [78] and Surgery [77]. Details on these baselines are provided in Appendix D. ", "page_idx": 5}, {"type": "text", "text": "Benchmarks For language discriminative tasks, following [76, 79], we use RoBERTa [42] as the backbone and evaluate on the 8-task GLUE benchmark [69]. More details are in Appendix D.2. For language generative tasks, we use Qwen-14B [3] as the primary model to demonstrate the effectiveness of our approach on large-scale language models. To reduce deployment costs, we utilize task-specific checkpoints fine-tuned with the LoRA method [26] (See Appendix A for details on adapting Twin-Merging to LoRA). We evaluate our model on four scenarios: general knowledge (MMLU benchmark [24]), factualness (TruthfulQA [40]), safety (BBQ [52]), and summarization (CNN-DailyMail [48]). ", "page_idx": 5}, {"type": "text", "text": "For vision tasks, following AdaMerging [78], we use ViT-B/32 in CLIP [55] as the backbone on eight image classification datasets: SUN397 [75], Stanford Cars [35], RESISC45 [5], EuroSAT [23], SVHN [50], GTSRB [59], MNIST [10], and DTD [7]. We employ the best version of AdaMerging (layer-wise AdaMerging $^{++}$ ) and the Surgery (AdaMerging version), and apply $90\\%$ sparsity for our Twin-Merging. Detailed information is provided in Appendix D.2. ", "page_idx": 5}, {"type": "text", "text": "Metrics We include individually fine-tuned models and the pre-trained model as upper and lower bounds on performance, respectively. To mitigate the effects of different task-specific score ranges, performance is assessed using the average normalized score of the fine-tuned models. The normalized score of merged model $\\theta^{*}$ is calculated as: ", "page_idx": 5}, {"type": "equation", "text": "$$\n{\\mathrm{Normalized~Score}}={\\frac{1}{T}}\\sum_{t=1}^{T}{\\frac{\\mathrm{Score}\\left[f({\\pmb x};{\\pmb\\theta}^{*})\\right]}{\\mathrm{Score}\\left[f_{t}({\\pmb x};{\\pmb\\theta}_{t})\\right]}}\n$$", "text_format": "latex", "page_idx": 5}, {"type": "table", "img_path": "81YIt63TTn/tmp/93c4bd22850fb41e5e33b7253ac1a3629908c734e7d611be4b6d9ddb8e1b0b8a.jpg", "table_caption": ["Table 2: Performance on 8 Discriminative Tasks (RoBERTa) and 4 Generative Tasks (Qwen-14B) "], "table_footnote": [], "page_idx": 5}, {"type": "table", "img_path": "81YIt63TTn/tmp/f867deb6aa5931706a73bd66718ad7bbfd936e498a60528b45559696b6f26158.jpg", "table_caption": ["Table 3: Performance and Cost on 8 CV Tasks (ViT-B/32) "], "table_footnote": [], "page_idx": 6}, {"type": "text", "text": "Main Results Table 2 presents the results for all discriminative and generative benchmarks for language tasks, while Table 3 provides the results for vision tasks. A comparison of each task is illustrated in Figure 2b, with detailed statistics provided in Table 8 and Table 9 in the Appendix D.7. We also list the full-finetuned LLaMA results in Appendix D.7. ", "page_idx": 6}, {"type": "text", "text": "For discriminative tasks, it approachs the upper bound of finetune performance in the GLUE benchmark. Specifically, our methods improve over Task Arithmetic by $28.34\\%$ , Ties-Merging by $32.46\\%$ , and DARE-Merging by $30.56\\%$ in absolute normalized score. In Figure 2b, we observe that especially on the COLA task, where conventional merging methods fail to improve the result, our approach can still approach the upper bound of the COLA expert. ", "page_idx": 6}, {"type": "text", "text": "On generative tasks, Twin-Merging achieves strong performance, outperforming Task Arithmetic and DARE Merging by $5.77\\%$ and $3.86\\%$ . Two interesting insights emerge: (1) The performance gains for Qwen-14B in generative tasks are smaller compared to RoBERTa in discriminative tasks. This indicates that smaller models like RoBERTa gain more from task-specific knowledge, while large models like Qwen-14B perform well because its strong general knowledge. (2)Twin-Merging surpasses the upper bound set by fine-tuned experts on the generative benchmark. This may be due to the extensive knowledge in Qwen-14B, where modularization and dynamic merging unlock further potential without additional fine-tuning. These findings highlight a promising path for improving large language models without retraining. ", "page_idx": 6}, {"type": "text", "text": "For vision tasks, Twin-Merging outperforms the AdaMerging and Surgery baselines with a higher accuracy ${}_{\\left(95.33\\%\\right.}$ vs. $94.04\\%$ ) while being more efficient in time and storage $47m22s$ vs. $215m01s$ , 5.0GB vs. 32.4GB). AdaMerging uses task-wise or layer-wise learnable parameters to improve merging, and Surgery adds task-specific modules after merging, requiring training on the validation set for all eight tasks. Surgery also needs prior knowledge of the task type before inference and involves multiple forward passes, leading to high VRAM usage. In contrast, our method efficiently handles diverse test inputs with minimal time and storage costs. ", "page_idx": 6}, {"type": "table", "img_path": "81YIt63TTn/tmp/6128d6625e4be4367f80cbdea2528df40126d7cab4a3e81eb34b1cf5fd3fbddb.jpg", "table_caption": ["Table 4: Our method scalability (72B) "], "table_footnote": [], "page_idx": 6}, {"type": "table", "img_path": "81YIt63TTn/tmp/57dd7e2e6bc77c8b088087db9b2e61c8cb9fb9692d6824f0e47f764e5537c67f.jpg", "table_caption": ["Table 5: Performance (un-normalized2) on unseen tasks "], "table_footnote": [], "page_idx": 6}, {"type": "text", "text": "Scalability of Twin-Merging Our method remains effective with scaled models (e.g., 72B parameters), as shown in Table 4. To manage high deployment costs, we limited our evaluation and merged experts to two tasks: BBQ and TruthfulQA. Twin-Merging consistently surpasses scaled pre-trained models and Task Arithmetic, highlighting our approach\u2019s scalability. Additionally, our method can be easily integrated with other merging methods, as detailed in Appendix D.9, making it both extensible and scalable. ", "page_idx": 6}, {"type": "text", "text": "", "page_idx": 7}, {"type": "text", "text": "4.2 Unseen Generalization ", "text_level": 1, "page_idx": 7}, {"type": "text", "text": "As shown in Table 5, Twin-Merging method benefits from complementary collaboration among different experts. Since the corresponding task-specific experts are unavailable, we directly use the average of the unnormalized scores as the metrics. In the GLUE benchmark, when QNLI, MNLI, and RTE experts are absent, our approach still outperforms traditional baselines. Details on the expert combination for QNLI can be found in Figure 5a. For complex tasks like MMLU, which involves multiple-choice QA tasks across 57 categories, Twin-Merging demonstrates superior performance using the combined knowledge from TruthfulQA, BBQ, and CNN-DailyMail domains. ", "page_idx": 7}, {"type": "text", "text": "4.3 Ablation Studies ", "text_level": 1, "page_idx": 7}, {"type": "table", "img_path": "81YIt63TTn/tmp/f98af2d2222b85c64eadd9c5921b582f4242706cff85c5dd778a8bb9b2f90a5a.jpg", "table_caption": ["Table 6: Ablation study of Twin-Merging "], "table_footnote": [], "page_idx": 7}, {"type": "text", "text": "To demonstrate the effectiveness of our approach, we conducted ablation studies for Twin-Merging, summarized in Table 6. Removing dynamic experts from the Shared model leads to a significant performance loss (96.14 vs. 67.80), highlighting the need for dynamic merging. Replacing the shared expert with a task-specific expert also results in a clear drop in performance (96.14 vs. 81.47), showing the value of the shared expert in capturing common knowledge. ", "page_idx": 7}, {"type": "text", "text": "Additionally, applying dynamic merging directly to a pretrained model performs worse than Twin Merging (85.90 vs. 96.14), likely due to two factors: (1) Pretrained models may lack rich task knowledge, while the shared expert in Twin Merging captures diverse, task-specific knowledge. (2) Subtracting the pretrained model fails to fully consider exclusive knowledge specific to each task, leading to interference, as analyzed in Section 3.2. ", "page_idx": 7}, {"type": "text", "text": "Discussion 1 We find that removing dynamic experts severely impacts RoBERTa but has less effect on Qwen-14B, suggesting that smaller models rely more on task-specific biases, while larger models benefti more from general shared knowledge. This indicates that our method adapts effectively to the varying knowledge requirements of models of different sizes. ", "page_idx": 7}, {"type": "text", "text": "Discussion 2 Compared to simpler routing methods like direct route to task-specific expert or combining multiple experts based on multiple LoRA [27, 81], Twin Merging delivers better performance, especially on unseen tasks, by reducing interference and leveraging complementary knowledge. ", "page_idx": 7}, {"type": "text", "text": "Direct route to task-specific expert refers to the fine-tuned baseline in Table 2. This approach assumes perfect routing and the absence of out-of-domain data, where each task uses its own dedicated expert. It represents the ideal scenario and serves as an oracle baseline to highlight the performance gap for merging methods. Despite this, Twin Merging still improves performance on generative tasks (102.38 vs. 100.0) and unseen tasks (Table 5) by leveraging different sources of exclusive knowledge. Moreover, this baseline demands storing all task-specific experts, which significantly increases storage, as discussed in Section 4.6. ", "page_idx": 7}, {"type": "text", "text": "In combining multiple experts, the lack of separation between shared and exclusive knowledge leads to interference, as conflicts between exclusive knowledge are inevitable (Section 3.2). There are two ways to combine experts: (1) Static Combination: This is akin to \u201cTask Arithmetic\u201d in LoRA (Table 2). Twin Merging outperforms static combinations (102.38 vs. 96.61). (2) Dynamic Combination: This matches \u201cPretrain $^+$ Dynamic Merging\u201d method in Table 6, and Twin Merging again shows superior performance (102.38 vs. 97.03). ", "page_idx": 7}, {"type": "image", "img_path": "81YIt63TTn/tmp/c859a591fe353eb6d0f321d3dca97f29271ea3b96f0d50c0be58fa9b37d84431.jpg", "img_caption": ["Figure 4: Averaged normalized accuracy vs. the number of tasks for various benchmarks. TwinMerging maintains performance regardless of task number and compresses the fine-tuned checkpoints. "], "img_footnote": [], "page_idx": 8}, {"type": "text", "text": "In the left panel of Figure 4, we examine the impact of the number of tasks on model merging performance. Conventional model merging methods degrade notably, especially with many tasks, nearly reaching pre-trained levels. However, Twin-Merging consistently outperforms other methods, approaching fine-tuned performance, with greater gains as the task count rises. ", "page_idx": 8}, {"type": "text", "text": "The right panel of Figure 4 shows the performance-storage trade-offs. While model merging methods have a constant storage cost, their performance remains low. In contrast, maintaining individual task-specific models guarantees strong performance but requires excessive storage. Twin-Merging achieves nearly $100\\%$ normalized accuracy across various tasks, balancing performance and storage efficiency by maintaining task-specific parameters with shared experts. This makes Twin-Merging a viable solution for scenarios demanding a balance between performance and storage efficiency. ", "page_idx": 8}, {"type": "text", "text": "4.5 Router Analysis ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "(a) The routing result on the QNLI dataset using different numbers of GLUE experts, ranging from 2 twin vectors $\\scriptstyle\\overline{{v_{\\mathrm{CoLA}}}}$ and vSST-2) to 7 twin vectors $\\scriptstyle v_{\\mathrm{CoLA}}$ , vSST-2, vMRPC, vSTS-B, vQQP, $v_{\\mathrm{MNLI}}$ , and $\\pmb{v}_{\\mathrm{QNLI}}$ ). The router weights are Softmax normalized. ", "page_idx": 8}, {"type": "image", "img_path": "81YIt63TTn/tmp/fc66daa2e7c3d320b2fb5386cf5b9c19ba456b7c7ef5dd389efd8d961299435f.jpg", "img_caption": ["Figure 5: Twin-Merging routing decisions of the experts for various tasks. ", "(b) The routing weight of Qwen experts (vMMLU,vTruthfulQA,vBBQ,vCNN-DailyMail) on four generative tasks (MMLU, TruthfulQA, BBQ, CNN-DailyMail). "], "img_footnote": [], "page_idx": 8}, {"type": "text", "text": "Figure 5 shows the results of routing decisions among experts for the QNLI dataset and four generative benchmarks. As shown in Figure 5a, the router maximizes the use of limited expert knowledge to address QNLI, a task where the goal is to determine if the context sentence contains the answer to the input question. For example, with only $\\pmb{v}_{\\mathrm{CoLA}}$ and $\\pmb{v}_{\\mathrm{SST}-2}$ available, the router primarily uses $\\pmb{v}_{\\mathrm{CoLA}}$ , which provides knowledge of sentence and word relations, while $\\pmb{v}\\mathbf{s}\\mathbf{s}\\mathbf{T}{-}2$ is focused on irrelevant sentiment classification. With six experts ranging from $\\pmb{v}_{\\mathrm{CoLA}}$ to $v_{\\mathrm{MNLI}}$ , the router mainly leverages $v_{\\mathrm{MNLI}}$ for textual entailment and $\\pmb{v}_{\\mathrm{QQP}}$ for question-answering capabilities. When $\\pmb{v}_{\\mathrm{{QNLI}}}$ is included, the router naturally relies on QNLI-specific knowledge. These results demonstrate the flexibility and adaptability of our Twin-Merging method, providing good interpretability. For larger models like Qwen-14B, as shown in Figure 5b, the router plays a crucial role in selecting and combining specific knowledge. When experts have overlapping task-specific knowledge, such as $\\pmb{v}$ TruthfulQA and $\\pmb{v}_{\\mathrm{MMLU}}$ , the router may assign them similar weights. ", "page_idx": 8}, {"type": "text", "text": "4.6 Compression and Speed Analysis ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "Compression Analysis In the left panel of Figure 6, we explore sparsity rates from $0\\%$ to $100\\%$ . Appendix E attachs detail qualtivie analysis of various Merging methods. Remarkably, our Twin", "page_idx": 8}, {"type": "image", "img_path": "81YIt63TTn/tmp/c201579fe4815a29ba557fbb36f65e98d6491ed9d74f2f3546fad0855d2b9d64.jpg", "img_caption": ["Figure 6: Twin-Merging performance vs. different sparsity levels and techniques for GLUE "], "img_footnote": [], "page_idx": 9}, {"type": "text", "text": "Merging method maintains $86.4\\%$ performance even at a $99.8\\%$ compression rate. This suggests that performance relies on a small fraction of task-specific parameters, aligning with previous findings [76, 79]. Our results also validate our hypothesis that redundant parameters can obscure critical knowledge, leading to performance degradation. Consequently, we primarily use a $90\\%$ sparsity rate in our experiments to preserve performance while reducing storage costs. We also conducted an ablation study on sparsity methods, shown on the right side of Figure 6. SVD better retains task-specific information compared to Magnitude [76] and Bernoulli Dropout [79]. As SVD is applied only once during preprocessing, it does not become an inference bottleneck. ", "page_idx": 9}, {"type": "table", "img_path": "81YIt63TTn/tmp/c5e783d81eb24331703b662f4cda2610331e0e22a795cc110978b2940848b942.jpg", "table_caption": ["Table 7: Compute-performance tradeoff in the generative benchmark. "], "table_footnote": [], "page_idx": 9}, {"type": "text", "text": "Speed Analysis Table 7 presents the time cost for Twin-Merging in generative benchmarks. Although the training stage utilizes only $0.1\\%$ of the total training budget, Twin-Merging significantly improves general capabilities compared to multi-task learning. Compared to conventional model merging methods, Twin-Merging sacrifices minimal router training budget and incurs a slight reduction in inference speed for dynamically composing the twin vectors, thereby achieving superior performance. More detailed analysis and results are provided in Appendix E. In summary, our approach strikes a better balance between computational cost and performance. ", "page_idx": 9}, {"type": "text", "text": "5 Conclusions ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "In this paper, we introduce the Twin-Merging to merge language models, aiming to close the performance gap between conventional model merging techniques and fine-tuned models, while improving adaptability to data heterogeneity. By modularizing and dynamically merging shared and task-specific knowledge, Twin-Merging significantly outperforms existing model-merging methods and approaches the performance of fine-tuned models across various settings and domains. Our study highlights the impact of shared and exclusive task-specific knowledge on merging performance. We show that Twin-Merging benefits even strong scaled models like Qwen-72B, which already perform well across domains. It extends to more tasks and merging methods, demonstrating better generalization on unseen data. By utilizing SVD, our solution retains $86\\%$ of the performance with only $0.1\\%$ of the parameters, approaching upper-bound performance with minimal storage increase as tasks grow, achieving a better tradeoff between computation and performance. ", "page_idx": 9}, {"type": "text", "text": "6 Acknowledgments ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "We thank the Shanghai AI Laboratory for supporting GPU resources. We also thank the anonymous reviewers for their comments on improving the quality of this paper and Netmind.AI for their resource/technical support. ", "page_idx": 9}, {"type": "text", "text": "References ", "text_level": 1, "page_idx": 10}, {"type": "text", "text": "[1] Samuel Ainsworth, Jonathan Hayase, and Siddhartha Srinivasa. Git re-basin: Merging models modulo permutation symmetries. In The Eleventh International Conference on Learning Representations, 2023.   \n[2] Zhangir Azerbayev, Hailey Schoelkopf, Keiran Paster, Marco Dos Santos, Stephen McAleer, Albert Q. Jiang, Jia Deng, Stella Biderman, and Sean Welleck. Llemma: An open language model for mathematics, 2024.   \n[3] Jinze Bai, Shuai Bai, Yunfei Chu, Zeyu Cui, Kai Dang, Xiaodong Deng, Yang Fan, Wenbin Ge, Yu Han, Fei Huang, Binyuan Hui, Luo Ji, Mei Li, Junyang Lin, Runji Lin, Dayiheng Liu, Gao Liu, Chengqiang Lu, Keming Lu, Jianxin Ma, Rui Men, Xingzhang Ren, Xuancheng Ren, Chuanqi Tan, Sinan Tan, Jianhong Tu, Peng Wang, Shijie Wang, Wei Wang, Shengguang Wu, Benfeng Xu, Jin Xu, An Yang, Hao Yang, Jian Yang, Shusheng Yang, Yang Yao, Bowen Yu, Hongyi Yuan, Zheng Yuan, Jianwei Zhang, Xingxuan Zhang, Yichang Zhang, Zhenru Zhang, Chang Zhou, Jingren Zhou, Xiaohuan Zhou, and Tianhang Zhu. Qwen technical report, 2023.   \n[4] Zhao Chen, Vijay Badrinarayanan, Chen-Yu Lee, and Andrew Rabinovich. Gradnorm: Gradient normalization for adaptive loss balancing in deep multitask networks. In International conference on machine learning, pages 794\u2013803. PMLR, 2018.   \n[5] Gong Cheng, Junwei Han, and Xiaoqiang Lu. Remote sensing image scene classification: Benchmark and state of the art. Proceedings of the IEEE, 105(10):1865\u20131883, 2017.   \n[6] Leshem Choshen, Elad Venezian, Noam Slonim, and Yoav Katz. Fusing finetuned models for better pretraining, 2022.   \n[7] Mircea Cimpoi, Subhransu Maji, Iasonas Kokkinos, Sammy Mohamed, and Andrea Vedaldi. Describing textures in the wild. In Proceedings of the IEEE conference on computer vision and pattern recognition, pages 3606\u20133613, 2014.   \n[8] Aidan Clark, Diego de Las Casas, Aurelia Guy, Arthur Mensch, Michela Paganini, Jordan Hoffmann, Bogdan Damoc, Blake Hechtman, Trevor Cai, Sebastian Borgeaud, et al. Unified scaling laws for routed language models. In International conference on machine learning, pages 4057\u20134086. PMLR, 2022.   \n[9] Damai Dai, Chengqi Deng, Chenggang Zhao, R. X. Xu, Huazuo Gao, Deli Chen, Jiashi Li, Wangding Zeng, Xingkai Yu, Y. Wu, Zhenda Xie, Y. K. Li, Panpan Huang, Fuli Luo, Chong Ruan, Zhifang Sui, and Wenfeng Liang. Deepseekmoe: Towards ultimate expert specialization in mixture-of-experts language models, 2024.   \n[10] Li Deng. The mnist database of handwritten digit images for machine learning research. IEEE Signal Processing Magazine, 29(6):141\u2013142, 2012.   \n[11] Tim Dettmers, Artidoro Pagnoni, Ari Holtzman, and Luke Zettlemoyer. Qlora: Efficient finetuning of quantized llms. Advances in Neural Information Processing Systems, 36, 2024.   \n[12] Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova. BERT: Pre-training of deep bidirectional transformers for language understanding. In Proceedings of the 2019 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies, Volume 1 (Long and Short Papers), pages 4171\u20134186, Minneapolis, Minnesota, June 2019. Association for Computational Linguistics. doi: 10.18653/v1/N19-1423. URL https://aclanthology.org/N19-1423.   \n[13] Chuntao Ding, Zhichao Lu, Shangguang Wang, Ran Cheng, and Vishnu Naresh Boddeti. Mitigating task interference in multi-task learning via explicit task routing with non-learnable primitives. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 7756\u20137765, 2023.   \n[14] Daxiang Dong, Hua Wu, Wei He, Dianhai Yu, and Haifeng Wang. Multi-task learning for multiple language translation. In Proceedings of the 53rd Annual Meeting of the Association for Computational Linguistics and the 7th International Joint Conference on Natural Language Processing (Volume 1: Long Papers), pages 1723\u20131732, Beijing, China, July 2015. Association for Computational Linguistics. doi: 10.3115/v1/P15-1166. URL https://aclanthology. org/P15-1166.   \n[15] Felix Draxler, Kambis Veschgini, Manfred Salmhofer, and Fred Hamprecht. Essentially no barriers in neural network energy landscape. In International conference on machine learning, pages 1309\u20131318. PMLR, 2018.   \n[16] Chenghao Fan, Zhenyi Lu, Wei Wei, Jie Tian, Xiaoye Qu, Dangyang Chen, and Yu Cheng. On giant\u2019s shoulders: Effortless weak to strong by dynamic logits fusion. arXiv preprint arXiv:2406.15480, 2024.   \n[17] William Fedus, Barret Zoph, and Noam Shazeer. Switch transformers: Scaling to trillion parameter models with simple and efficient sparsity. Journal of Machine Learning Research, 23 (120):1\u201339, 2022.   \n[18] Jonathan Frankle, Gintare Karolina Dziugaite, Daniel Roy, and Michael Carbin. Linear mode connectivity and the lottery ticket hypothesis. In International Conference on Machine Learning, pages 3259\u20133269. PMLR, 2020.   \n[19] Robert M French. Catastrophic forgetting in connectionist networks. Trends in cognitive sciences, 3(4):128\u2013135, 1999.   \n[20] Timur Garipov, Pavel Izmailov, Dmitrii Podoprikhin, Dmitry P Vetrov, and Andrew G Wilson. Loss surfaces, mode connectivity, and fast ensembling of dnns. Advances in neural information processing systems, 31, 2018.   \n[21] Almog Gueta, Elad Venezian, Colin Raffel, Noam Slonim, Yoav Katz, and Leshem Choshen. Knowledge is a region in weight space for fine-tuned language models. In Houda Bouamor, Juan Pino, and Kalika Bali, editors, Findings of the Association for Computational Linguistics: EMNLP 2023, pages 1350\u20131370, Singapore, December 2023. Association for Computational Linguistics. doi: 10.18653/v1/2023.findings-emnlp.95. URL https://aclanthology.org/ 2023.findings-emnlp.95.   \n[22] Daya Guo, Qihao Zhu, Dejian Yang, Zhenda Xie, Kai Dong, Wentao Zhang, Guanting Chen, Xiao Bi, Y. Wu, Y. K. Li, Fuli Luo, Yingfei Xiong, and Wenfeng Liang. Deepseek-coder: When the large language model meets programming \u2013 the rise of code intelligence, 2024.   \n[23] Patrick Helber, Benjamin Bischke, Andreas Dengel, and Damian Borth. Eurosat: A novel dataset and deep learning benchmark for land use and land cover classification. IEEE Journal of Selected Topics in Applied Earth Observations and Remote Sensing, 12(7):2217\u20132226, 2019.   \n[24] Dan Hendrycks, Collin Burns, Steven Basart, Andy Zou, Mantas Mazeika, Dawn Song, and Jacob Steinhardt. Measuring massive multitask language understanding. In International Conference on Learning Representations, 2020.   \n[25] Jordan Hoffmann, Sebastian Borgeaud, Arthur Mensch, Elena Buchatskaya, Trevor Cai, Eliza Rutherford, Diego de Las Casas, Lisa Anne Hendricks, Johannes Welbl, Aidan Clark, Tom Hennigan, Eric Noland, Katie Millican, George van den Driessche, Bogdan Damoc, Aurelia Guy, Simon Osindero, Karen Simonyan, Erich Elsen, Jack W. Rae, Oriol Vinyals, and Laurent Sifre. Training compute-optimal large language models, 2022.   \n[26] Edward J Hu, Phillip Wallis, Zeyuan Allen-Zhu, Yuanzhi Li, Shean Wang, Lu Wang, Weizhu Chen, et al. Lora: Low-rank adaptation of large language models. In International Conference on Learning Representations, 2021.   \n[27] Chengsong Huang, Qian Liu, Bill Yuchen Lin, Tianyu Pang, Chao Du, and Min Lin. Lorahub: Efficient cross-task generalization via dynamic lora composition, 2024. URL https://arxiv. org/abs/2307.13269.   \n[28] Gabriel Ilharco, Marco Tulio Ribeiro, Mitchell Wortsman, Ludwig Schmidt, Hannaneh Hajishirzi, and Ali Farhadi. Editing models with task arithmetic. In The Eleventh International Conference on Learning Representations, 2022.   \n[29] Gabriel Ilharco, Marco Tulio Ribeiro, Mitchell Wortsman, Ludwig Schmidt, Hannaneh Hajishirzi, and Ali Farhadi. Editing models with task arithmetic. In The Eleventh International Conference on Learning Representations, 2023. URL https://openreview.net/forum?id= 6t0Kwf8-jrj.   \n[30] Albert Q. Jiang, Alexandre Sablayrolles, Antoine Roux, Arthur Mensch, Blanche Savary, Chris Bamford, Devendra Singh Chaplot, Diego de las Casas, Emma Bou Hanna, Florian Bressand, Gianna Lengyel, Guillaume Bour, Guillaume Lample, L\u00e9lio Renard Lavaud, Lucile Saulnier, Marie-Anne Lachaux, Pierre Stock, Sandeep Subramanian, Sophia Yang, Szymon Antoniak, Teven Le Scao, Th\u00e9ophile Gervet, Thibaut Lavril, Thomas Wang, Timoth\u00e9e Lacroix, and William El Sayed. Mixtral of experts, 2024.   \n[31] Junguang Jiang, Baixu Chen, Junwei Pan, Ximei Wang, Dapeng Liu, Mingsheng Long, et al. Forkmerge: Mitigating negative transfer in auxiliary-task learning. In Thirty-seventh Conference on Neural Information Processing Systems, 2023.   \n[32] Weisen Jiang, Baijiong Lin, Han Shi, Yu Zhang, Zhenguo Li, and James T. Kwok. Byom: Building your own multi-task model for free, 2024.   \n[33] Xisen Jin, Xiang Ren, Daniel Preotiuc-Pietro, and Pengxiang Cheng. Dataless knowledge fusion by merging weights of language models. In The Eleventh International Conference on Learning Representations, 2022.   \n[34] Jared Kaplan, Sam McCandlish, Tom Henighan, Tom B. Brown, Benjamin Chess, Rewon Child, Scott Gray, Alec Radford, Jeffrey Wu, and Dario Amodei. Scaling laws for neural language models, 2020.   \n[35] Jonathan Krause, Michael Stark, Jia Deng, and Li Fei-Fei. 3d object representations for finegrained categorization. In Proceedings of the IEEE international conference on computer vision workshops, pages 554\u2013561, 2013.   \n[36] Dmitry Lepikhin, HyoukJoong Lee, Yuanzhong Xu, Dehao Chen, Orhan Firat, Yanping Huang, Maxim Krikun, Noam Shazeer, and Zhifeng Chen. Gshard: Scaling giant models with conditional computation and automatic sharding. In International Conference on Learning Representations, 2021.   \n[37] Weishi Li, Yong Peng, Miao Zhang, Liang Ding, Han Hu, and Li Shen. Deep model fusion: A survey, 2023.   \n[38] Lucas Liebenwein, Cenk Baykal, Brandon Carter, David Gifford, and Daniela Rus. Lost in pruning: The effects of pruning neural networks beyond test accuracy. Proceedings of Machine Learning and Systems, 3:93\u2013138, 2021.   \n[39] Chin-Yew Lin and Eduard Hovy. Automatic evaluation of summaries using n-gram cooccurrence statistics. In Proceedings of the 2003 Human Language Technology Conference of the North American Chapter of the Association for Computational Linguistics, pages 150\u2013157, 2003. URL https://aclanthology.org/N03-1020.   \n[40] Stephanie Lin, Jacob Hilton, and Owain Evans. Truthfulqa: Measuring how models mimic human falsehoods. In Proceedings of the 60th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers), 2022.   \n[41] Bo Liu, Xingchao Liu, Xiaojie Jin, Peter Stone, and Qiang Liu. Confilct-averse gradient descent for multi-task learning. Advances in Neural Information Processing Systems, 2021.   \n[42] Yinhan Liu, Myle Ott, Naman Goyal, Jingfei Du, Mandar Joshi, Danqi Chen, Omer Levy, Mike Lewis, Luke Zettlemoyer, and Veselin Stoyanov. Roberta: A robustly optimized bert pretraining approach. 2019.   \n[43] Zhenyi Lu, Jie Tian, Wei Wei, Xiaoye Qu, Yu Cheng, Dangyang Chen, et al. Mitigating boundary ambiguity and inherent bias for text classification in the era of large language models. arXiv preprint arXiv:2406.07001, 2024.   \n[44] Haipeng Luo, Qingfeng Sun, Can Xu, Pu Zhao, Jianguang Lou, Chongyang Tao, Xiubo Geng, Qingwei Lin, Shifeng Chen, and Dongmei Zhang. Wizardmath: Empowering mathematical reasoning for large language models via reinforced evol-instruct, 2023.   \n[45] Kevis-Kokitsi Maninis, Ilija Radosavovic, and Iasonas Kokkinos. Attentive single-tasking of multiple tasks. In Proceedings of the IEEE/CVF conference on computer vision and pattern recognition, pages 1851\u20131860, 2019.   \n[46] Michael S Matena and Colin A Raffel. Merging models with fisher-weighted averaging. Advances in Neural Information Processing Systems, 2022.   \n[47] Taishi Nakamura, Mayank Mishra, Simone Tedeschi, Yekun Chai, Jason T Stillerman, Felix Friedrich, Prateek Yadav, Tanmay Laud, Vu Minh Chien, Terry Yue Zhuo, Diganta Misra, Ben Bogin, Xuan-Son Vu, Marzena Karpinska, Arnav Varma Dantuluri, Wojciech Kusa, Tommaso Furlanello, Rio Yokota, Niklas Muennighoff, Suhas Pai, Tosin Adewumi, Veronika Laippala, Xiaozhe Yao, Adalberto Junior, Alpay Ariyak, Aleksandr Drozd, Jordan Clive, Kshitij Gupta, Liangyu Chen, Qi Sun, Ken Tsui, Noah Persaud, Nour Fahmy, Tianlong Chen, Mohit Bansal, Nicolo Monti, Tai Dang, Ziyang Luo, Tien-Tung Bui, Roberto Navigli, Virendra Mehta, Matthew Blumberg, Victor May, Huu Nguyen, and Sampo Pyysalo. Aurora-m: The first open source multilingual language model red-teamed according to the u.s. executive order, 2024.   \n[48] Ramesh Nallapati, Bowen Zhou, Caglar Gulcehre, Bing Xiang, et al. Abstractive text summarization using sequence-to-sequence rnns and beyond. arXiv preprint arXiv:1602.06023, 2016.   \n[49] Aviv Navon, Aviv Shamsian, Idan Achituve, Haggai Maron, Kenji Kawaguchi, Gal Chechik, and Ethan Fetaya. Multi-task learning as a bargaining game. In International Conference on Machine Learning, pages 16428\u201316446. PMLR, 2022.   \n[50] Yuval Netzer, Tao Wang, Adam Coates, Alessandro Bissacco, Baolin Wu, Andrew Y Ng, et al. Reading digits in natural images with unsupervised feature learning. In NIPS workshop on deep learning and unsupervised feature learning, volume 2011, page 4. Granada, 2011.   \n[51] Guillermo Ortiz-Jimenez, Alessandro Favero, and Pascal Frossard. Task arithmetic in the tangent space: Improved editing of pre-trained models. In Thirty-seventh Conference on Neural Information Processing Systems, 2023. URL https://openreview.net/forum?id= 0A9f2jZDGW.   \n[52] Alicia Parrish, Angelica Chen, Nikita Nangia, Vishakh Padmakumar, Jason Phang, Jana Thompson, Phu Mon Htut, and Samuel Bowman. Bbq: A hand-built bias benchmark for question answering. In Findings of the Association for Computational Linguistics: ACL 2022, 2022.   \n[53] David Patterson, Joseph Gonzalez, Quoc Le, Chen Liang, Lluis-Miquel Munguia, Daniel Rothchild, David So, Maud Texier, and Jeff Dean. Carbon emissions and large neural network training, 2021.   \n[54] Ruoyu Qin, Zheming Li, Weiran He, Mingxing Zhang, Yongwei Wu, Weimin Zheng, and Xinran Xu. Mooncake: A kvcache-centric disaggregated architecture for llm serving, 2024. URL https://arxiv.org/abs/2407.00079.   \n[55] Alec Radford, Jong Wook Kim, Chris Hallacy, Aditya Ramesh, Gabriel Goh, Sandhini Agarwal, Girish Sastry, Amanda Askell, Pamela Mishkin, Jack Clark, et al. Learning transferable visual models from natural language supervision. In International conference on machine learning, pages 8748\u20138763. PMLR, 2021.   \n[56] Baptiste Rozi\u00e8re, Jonas Gehring, Fabian Gloeckle, Sten Sootla, Itai Gat, Xiaoqing Ellen Tan, Yossi Adi, Jingyu Liu, Romain Sauvestre, Tal Remez, J\u00e9r\u00e9my Rapin, Artyom Kozhevnikov, Ivan Evtimov, Joanna Bitton, Manish Bhatt, Cristian Canton Ferrer, Aaron Grattafiori, Wenhan Xiong, Alexandre D\u00e9fossez, Jade Copet, Faisal Azhar, Hugo Touvron, Louis Martin, Nicolas Usunier, Thomas Scialom, and Gabriel Synnaeve. Code llama: Open foundation models for code, 2024.   \n[57] Victor Sanh, Albert Webson, Colin Raffel, Stephen H Bach, Lintang Sutawika, Zaid Alyafeai, Antoine Chaffin, Arnaud Stiegler, Teven Le Scao, Arun Raja, et al. Multitask prompted training enables zero-shot task generalization. In International Conference on Learning Representations, 2022.   \n[58] Sidak Pal Singh and Martin Jaggi. Model fusion via optimal transport. Advances in Neural Information Processing Systems, 33:22045\u201322055, 2020.   \n[59] Johannes Stallkamp, Marc Schlipsing, Jan Salmen, and Christian Igel. The german traffic sign recognition benchmark: a multi-class classification competition. In The 2011 international joint conference on neural networks, pages 1453\u20131460. IEEE, 2011.   \n[60] George Stoica, Daniel Bolya, Jakob Bjorner, Taylor Hearn, and Judy Hoffman. Zipit! merging models from different tasks without training, 2023.   \n[61] Zhaochen Su, Juntao Li, Jun Zhang, Tong Zhu, Xiaoye Qu, Pan Zhou, Yan Bowen, Yu Cheng, et al. Living in the moment: Can large language models grasp co-temporal reasoning? arXiv preprint arXiv:2406.09072, 2024.   \n[62] Zhaochen Su, Jun Zhang, Xiaoye Qu, Tong Zhu, Yanshu Li, Jiashuo Sun, Juntao Li, Min Zhang, and Yu Cheng. Confilctbank: A benchmark for evaluating the influence of knowledge confilcts in llm. arXiv preprint arXiv:2408.12076, 2024.   \n[63] Zhaochen Su, Jun Zhang, Tong Zhu, Xiaoye Qu, Juntao Li, Min Zhang, and Yu Cheng. Timo: Towards better temporal reasoning for language models. arXiv preprint arXiv:2406.14192, 2024.   \n[64] Sainbayar Sukhbaatar, Olga Golovneva, Vasu Sharma, Hu Xu, Xi Victoria Lin, Baptiste Rozi\u00e8re, Jacob Kahn, Daniel Li, Wen-tau Yih, Jason Weston, et al. Branch-train-mix: Mixing expert llms into a mixture-of-experts llm. arXiv preprint arXiv:2403.07816, 2024.   \n[65] Xiaofei Sun, Linfeng Dong, Xiaoya Li, Zhen Wan, Shuhe Wang, Tianwei Zhang, Jiwei Li, Fei Cheng, Lingjuan Lyu, Fei Wu, and Guoyin Wang. Pushing the limits of chatgpt on nlp tasks, 2023.   \n[66] Anke Tang, Li Shen, Yong Luo, Nan Yin, Lefei Zhang, and Dacheng Tao. Merging multi-task models via weight-ensembling mixture of experts, 2024.   \n[67] Anke Tang, Li Shen, Yong Luo, Yibing Zhan, Han Hu, Bo Du, Yixin Chen, and Dacheng Tao. Parameter-efficient multi-task model fusion with partial linearization. In The Twelfth International Conference on Learning Representations, 2024. URL https://openreview. net/forum?id $\\equiv$ iynRvVVAmH.   \n[68] Hugo Touvron, Thibaut Lavril, Gautier Izacard, Xavier Martinet, Marie-Anne Lachaux, Timoth\u00e9e Lacroix, Baptiste Rozi\u00e8re, Naman Goyal, Eric Hambro, Faisal Azhar, Aurelien Rodriguez, Armand Joulin, Edouard Grave, and Guillaume Lample. Llama: Open and efficient foundation language models, 2023.   \n[69] Alex Wang, Amanpreet Singh, Julian Michael, Felix Hill, Omer Levy, and Samuel Bowman. Glue: A multi-task benchmark and analysis platform for natural language understanding. In Proceedings of the 2018 EMNLP Workshop BlackboxNLP: Analyzing and Interpreting Neural Networks for NLP, 2018.   \n[70] Hongyi Wang, Mikhail Yurochkin, Yuekai Sun, Dimitris Papailiopoulos, and Yasaman Khazaeni. Federated learning with matched averaging. In International Conference on Learning Representations, 2019.   \n[71] Hongyi Wang, Felipe Maia Polo, Yuekai Sun, Souvik Kundu, Eric P Xing, and Mikhail Yurochkin. Fusing models with complementary expertise. In NeurIPS 2023 Workshop on Distribution Shifts: New Frontiers with Foundation Models, 2023.   \n[72] Jason Wei, Yi Tay, Rishi Bommasani, Colin Raffel, Barret Zoph, Sebastian Borgeaud, Dani Yogatama, Maarten Bosma, Denny Zhou, Donald Metzler, et al. Emergent abilities of large language models. Transactions on Machine Learning Research, 2022.   \n[73] Thomas Wolf, Lysandre Debut, Victor Sanh, Julien Chaumond, Clement Delangue, Anthony Moi, Pierric Cistac, Tim Rault, R\u00e9mi Louf, Morgan Funtowicz, Joe Davison, Sam Shleifer, Patrick von Platen, Clara Ma, Yacine Jernite, Julien Plu, Canwen Xu, Teven Le Scao, Sylvain Gugger, Mariama Drame, Quentin Lhoest, and Alexander M. Rush. Huggingface\u2019s transformers: State-of-the-art natural language processing, 2020.   \n[74] Mitchell Wortsman, Gabriel Ilharco, Samir Yitzhak Gadre, Rebecca Roelofs, Raphael Gontijo Lopes, Ari S. Morcos, Hongseok Namkoong, Ali Farhadi, Yair Carmon, Simon Kornblith, and Ludwig Schmidt. Model soups: averaging weights of multiple fine-tuned models improves accuracy without increasing inference time. In International Conference on Machine Learning, 2022.   \n[75] Jianxiong Xiao, Krista A Ehinger, James Hays, Antonio Torralba, and Aude Oliva. Sun database: Exploring a large collection of scene categories. International Journal of Computer Vision, 119: 3\u201322, 2016.   \n[76] Prateek Yadav, Derek Tam, Leshem Choshen, Colin Raffel, and Mohit Bansal. Ties-merging: Resolving interference when merging models. In Thirty-seventh Conference on Neural Information Processing Systems, 2023.   \n[77] Enneng Yang, Li Shen, Zhenyi Wang, Guibing Guo, Xiaojun Chen, Xingwei Wang, and Dacheng Tao. Representation surgery for multi-task model merging. arXiv preprint arXiv:2402.02705, 2024.   \n[78] Enneng Yang, Zhenyi Wang, Li Shen, Shiwei Liu, Guibing Guo, Xingwei Wang, and Dacheng Tao. Adamerging: Adaptive model merging for multi-task learning. In The Twelfth International Conference on Learning Representations, 2024. URL https://openreview.net/forum?id= nZP6NgD3QY.   \n[79] Le Yu, Bowen Yu, Haiyang Yu, Fei Huang, and Yongbin Li. Language models are super mario: Absorbing abilities from homologous models as a free lunch, 2024.   \n[80] Jihai Zhang, Xiaoye Qu, Tong Zhu, and Yu Cheng. Clip-moe: Towards building mixture of experts for clip with diversified multiplet upcycling. arXiv preprint arXiv:2409.19291, 2024.   \n[81] Jinghan Zhang, Junteng Liu, Junxian He, et al. Composing parameter-efficient modules with arithmetic operation. Advances in Neural Information Processing Systems, 36:12589\u201312610, 2023.   \n[82] Yanqi Zhou, Tao Lei, Hanxiao Liu, Nan Du, Yanping Huang, Vincent Zhao, Andrew M Dai, Quoc V Le, James Laudon, et al. Mixture-of-experts with expert choice routing. Advances in Neural Information Processing Systems, 2022.   \n[83] Zhanpeng Zhou, Zijun Chen, Yilan Chen, Bo Zhang, and Junchi Yan. Cross-task linearity emerges in the pretraining-finetuning paradigm, 2024.   \n[84] Tong Zhu, Daize Dong, Xiaoye Qu, Jiacheng Ruan, Wenliang Chen, and Yu Cheng. Dynamic data mixing maximizes instruction tuning for mixture-of-experts. arXiv preprint arXiv:2406.11256, 2024.   \n[85] Tong Zhu, Xiaoye Qu, Daize Dong, Jiacheng Ruan, Jingqi Tong, Conghui He, and Yu Cheng. Llama-moe: Building mixture-of-experts from llama with continual pre-training. arXiv preprint arXiv:2406.16554, 2024.   \n[86] Barret Zoph. Designing effective sparse expert models. In 2022 IEEE International Parallel and Distributed Processing Symposium Workshops (IPDPSW), pages 1044\u20131044, 2022. doi: 10.1109/IPDPSW55747.2022.00171. ", "page_idx": 10}, {"type": "text", "text": "", "page_idx": 11}, {"type": "text", "text": "", "page_idx": 12}, {"type": "text", "text": "", "page_idx": 13}, {"type": "text", "text": "", "page_idx": 14}, {"type": "text", "text": "", "page_idx": 15}, {"type": "text", "text": "A Twin Merge on LoRA ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "Here, we will demonstrate that our Twin-Merging method can be seamlessly applied to LoRA module [26], where the base model is fixed and additional task-specific information is injected through matrix, i.e., $\\pmb{\\theta}_{t}=\\pmb{\\theta}_{0}+\\mathrm{LoRA}_{t}$ , where $\\mathrm{LoRA}_{t}$ represents the fine-tuned LoRA module for the $t$ -th task. let $\\pmb{\\theta}_{s}=\\pmb{\\theta}_{0}+\\mathbf{LoRA}_{s}$ , we can prove that Twin-Merging on the $\\pmb{\\theta}$ is equivalent to Twin-Merging on the LoRA module. ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\pmb{\\theta}^{*}=\\pmb{\\theta}_{s}+\\sum_{t=1}^{T}w_{t}*\\mathbf{S}\\mathbf{V}\\mathbf{D}_{r}\\big(\\pmb{\\theta}_{t}-\\pmb{\\theta}_{s}\\big)\n$$", "text_format": "latex", "page_idx": 16}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{\\quad}&{\\underbrace{\\cdots}_{\\mathrm{Twin-Merging~on~}\\theta}}\\\\ &{=\\theta_{0}+\\mathrm{LoRA}_{s}+\\displaystyle\\sum_{t=1}^{T}w_{t}*\\mathrm{SVD}_{r}\\left((\\theta_{0}+\\mathrm{LoRA}_{t})-(\\theta_{0}+\\mathrm{LoRA}_{s})\\right)}\\\\ &{=\\theta_{0}+\\underbrace{\\mathrm{LoRA}_{s}+\\displaystyle\\sum_{t=1}^{T}w_{t}*\\mathrm{SVD}_{r}(\\mathrm{LoRA}_{t}-\\mathrm{LoRA}_{s})}_{\\mathrm{Twin-Merging~on~LoRA}}}\\\\ &{=\\theta_{0}+\\mathrm{LORA}^{*}}\\end{array}\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "where we denote $\\begin{array}{r}{\\mathrm{LORA}^{*}=\\mathrm{LORA}_{s}+\\sum_{t=1}^{T}w_{t}*\\mathrm{SVD}_{r}\\big(\\mathrm{LoRA}_{t}-\\mathrm{LoRA}_{s}\\big).}\\end{array}$ ", "page_idx": 16}, {"type": "text", "text": "B More relative research ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "Multi-Task Learning. The multi-task training typically learns multi-task features by simultaneously optimizing task-specific objectives, facilitating the integration of diverse knowledge into the model. Existing works mainly focus on mitigating task conflicts [41] and catastrophic forgetting [19] by parameter sharing [45], adjusting suitable objectives [14, 57], find suitable task weighting [4, 49], and minimizing negative transfer [31]. In an era where models are growing larger, and the number of task scenarios is increasing, what we need to explore is a more cost-effective approach to multi-task learning. Therefore our focus is on multi-task scenarios that do not require acquiring or integrating multi-task data and do not involve additional updates to existing experts. ", "page_idx": 16}, {"type": "text", "text": "Mixture of Experts. To enhance model scalability without increasing computational costs, the mixture of experts (MoE) paradigm introduces conditional routing of inputs to a subset of learnable parameters. Several efforts have extended feedforward networks (FFNs) within Transformers to incorporate MoE layers, such as GShard [36] and Switch Transformer [17]. These models typically employ learnable top-2 or top-1 routing strategies to scale MoE language models to an extremely large size [30]. Recent studies have focused on challenges such as load balancing of experts [8, 82], training instability [86], expert specialization [9, 66], and synchronization reduction [64]. However, these methods often require substantial multi-task data and costly joint training. In contrast, our approach directly reuses task-specific experts, leading to the natural specialization of experts in different domains. We only require minimal fine-tuning for a small router to calculate fusion weights, making our method highly efficient. ", "page_idx": 16}, {"type": "text", "text": "C The Merging Interference and Limited Generalization ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "To illustrate the challenge in determining the optimal merging coefficient and the limitations of prespecified coefficients with unpredictable data, we consider COLA and SST-2 as in-domain experts. We merge them using Task Arithmetic and evaluate on the eight discriminative tasks from the GLUE benchmark. Only COLA and SST-2 are seen tasks, while the others are unseen. Since the merging coefficient is crucial for performance [51, 78], we conduct an extensive grid search for coefficients ranging from $-2$ to 2. ", "page_idx": 16}, {"type": "text", "text": "A large dark-blue region indicates consistent optimal performance, which is why Task Arithmetic can work with various weights. Conventional methods search this region for optimal performance across all in-domain tasks, avoiding the red region. However, this is computationally expensive and does not scale well with an increasing number of tasks. Additionally, it cannot handle unseen tasks, as the same coefficients can produce different patterns across tasks. For example, setting coefficients $\\gamma_{\\mathrm{COLA}}$ and $\\gamma_{\\mathrm{SST}-2}$ to 1 leads to performance drops in MRPC and QNLI, but gains in MNLI, QQP, and RTE. 4 ", "page_idx": 16}, {"type": "image", "img_path": "81YIt63TTn/tmp/6122904526452bda9e57a0b5c0ebd94236dded49b5cd9172bad21e88728f1785.jpg", "img_caption": ["Figure 7: The visualizations show normalized performance across eight GLUE tasks, highlighting the impact of combining expertise from the COLA and SST-2 domains (expert indicated by red vectors) through Task Arithmetic. Performance scores are normalized, with the unmerged pretrained model set to zero and other results scaled to the $[-1,1]$ range. The $\\mathbf{X}$ -axis $(\\gamma_{\\mathrm{COLA}})$ and y-axis $(\\gamma_{\\mathrm{SST}-2})$ represent the merging weights for COLA and SST-2 expertise. Blue regions indicate improved performance over the pretrained model, while red regions indicate deterioration. "], "img_footnote": [], "page_idx": 17}, {"type": "text", "text": "", "page_idx": 17}, {"type": "text", "text": "Furthermore, merging performance is not always a single cluster. For example, within the range of $[-2,2]$ , STS-B and QNLI already show complex patterns, making it difficult to find an optimal weight for all tasks when task-specific experts are limited. Although Yang et al. [78] propose unsupervised entropy minimization to find optimal coefficients, this method is limited to classification tasks and has limited adaptability. ", "page_idx": 17}, {"type": "text", "text": "To address this, we propose reformulating the problem of fusing models as a supervised learning task.   \nSpecifically, we train a router to dynamically merge task-specific experts, as detailed in Section 3.3. ", "page_idx": 17}, {"type": "text", "text": "D Experiment Details ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "Here we detaily illustrate the setting of our experiments. ", "page_idx": 17}, {"type": "text", "text": "D.1 Compute Resources Used and Runtimes ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "We executed all our experiments on Nvidia A100 GPUs equipped with 80GB RAM. Single-task LoRA models for Qwen-14B on four generative tasks required 1-2 hours per task, Single-task LoRA for Qwen-72B need 10 hours on single GPUs to train. while the multitask vector took around 10 hours on single GPUs of 500M tokens. The RoBERTa model needs 15 minutes per task on GLUE datasets. ", "page_idx": 17}, {"type": "text", "text": "Our router is implemented as a three-layer linear network with Leaky ReLU activations and batch normalization. We train the router on the validation dataset with a learning rate of 5e-4 for 10 epochs. The validation set consists of the integration of in-domain downstream tasks, not the general text corpus. The validation set is taken from a split of the training set, and we use at most 1,000 items for router training for each task. ", "page_idx": 17}, {"type": "text", "text": "Merge experiments were efficient, with evaluations consuming less than 2 minutes. The inference is generally fast within 4 minutes per 1000 items for generative tasks and less than 30 seconds per 1000 items for discriminative tasks. The detail comparison of the training cost and inference cost of different methods are detailed in Table 7. ", "page_idx": 18}, {"type": "text", "text": "D.2 Employed Datasets and Associated Licences ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Discriminative Tasks. we conduct experiments on the GLUE benchmark [69] with eight discriminative tasks, which is designed for classification tasks except for STS-B for the regression task. The detail of eight dataset can be found in the paper of Wang et al. [69]. Consistent with prior research [79], We split $10\\%$ of the training set as a validation set and employ the original validation data as the test set. ", "page_idx": 18}, {"type": "text", "text": "The licenses of QNLI, COLA, and STS-B are licensed under CC-BY-SA. QQP is licensed under MIT. SST-2 and MRPC are licensed under Apache 2.0. MNLI is licensed under OANC. RTE is licensed under CC BY 4.0. Thus, these datasets in GLUE are available for non-commercial research purposes. ", "page_idx": 18}, {"type": "text", "text": "Generative Tasks. We conducted experiments on four benchmarks: ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "1. MMLU [24]: This benchmark tests general and STEM knowledge across 57 subjects, from elementary to professional levels. We used Exact-Match as the metric.   \n2. TruthfulQA [40]: This benchmark assesses the truthfulness of language models with 817 questions spanning 38 categories like health, law, finance, and politics. Exact-Match was used as the metric.   \n3. BBQ [52]: This dataset highlights social biases against protected classes in nine social dimensions relevant to U.S. English-speaking contexts. Exact-Match was the metric.   \n4. CNN-DailyMail [48]: This dataset is used for text summarization, requiring models to generate summaries of news stories. ROUGE-2 scores [39] were used for evaluation. ", "page_idx": 18}, {"type": "text", "text": "We evaluated these tasks using the HELM benchmark5 in a few-shot setting. ", "page_idx": 18}, {"type": "text", "text": "For MMLU and TruthfulQA, which lack official training sets, we used the Dolly-15k dataset6 for MMLU and the BigBench-sampled dataset for TruthfulQA. ", "page_idx": 18}, {"type": "text", "text": "The GSM8K and MMLU datasets are under the MIT License. TruthfulQA and CNN-DailyMail are under the Apache-2.0 License. BBQ is under the CC-BY 4.0 License. These datasets are available for non-commercial research purposes. ", "page_idx": 18}, {"type": "text", "text": "Vision Tasks. ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "1. SUN397 [75]:A scene classification dataset containing 108,754 images across 397 classes, with each class having at least 100 images.   \n2. Stanford Cars [35]: A car classification dataset comprising 196 classes and a total of 16,185 images, divided equally between the training and test sets.   \n3. RESISC45 [5]: A remote sensing image scene classification dataset with 45 classes and 31,500 images, approximately 700 per class.   \n4. EuroSAT [23]: A satellite image classification dataset consisting of 27,000 labeled and geo-referenced images across 10 classes.   \n5. SVHN [50]: A real-world digit classification dataset extracted from Google Street View images. It includes 10 classes, with 73,257 training samples, 26,032 test samples, and 531,131 additional simple samples.   \n6. GTSRB [59]: A traffic sign classification dataset containing over 50,000 images across 43 classes of traffic signs.   \n7. MNIST [10]: A benchmark dataset for image classification, containing grayscale images of handwritten digits across 10 classes. The training set has 60,000 images, and the test set has 10,000 images, with a balanced distribution among classes. ", "page_idx": 18}, {"type": "text", "text": "8. DTD [7]: A texture classification dataset with 47 classes and a total of 5,640 images, with approximately 120 images per class. ", "page_idx": 19}, {"type": "text", "text": "D.3 Language Model Backbone ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "For discriminative tasks, we used RoBERTa-base7 [42] as our pre-trained backbone and fine-tuned it for each dataset to create supervised models. We conducted separate fine-tuning for the RoBERTabase model on each dataset for 10 epochs. Our selected hyperparameters included a batch size of 64 and a learning rate set at $1e^{-5}$ . ", "page_idx": 19}, {"type": "text", "text": "For generative tasks, we employed Qwen- $14\\mathrm{{B}^{8}}$ as the backbone and applied LoRA [26] for taskspecific fine-tuning. In the case of generative tasks, the fine-tuning process for Qwen-14B involved the utilization of LoRA with a rank set to 32, a batch size of 128, and a learning rate of $2e^{-4}$ for 3 epochs. For Qwen-72B we employ the same setting with QLoRA technique [11]. ", "page_idx": 19}, {"type": "text", "text": "D.4 Non-Overlapping Merging ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "To serperate the impact of parameter-wise interference, we design the non-overlapping experiment based on Qwen LoRA modules as follows: (1) Firstly, we obtain standard merging experts by injecting the LoRA module into both the \u201cw1\u201d and \u201cc_proj\u201d weights of the Qwen-based model, and fine-tune them on two different tasks, resulting in two distinct models. Then we combine it into a single model to obtrain standard merging results. (2) Next, we performe a non-overlapping fine-tuning by injecting LoRA only to \u201cw1\u201d on one task and \u201cc_proj\u201d on another, producing two models with task-specific knowledge in different modules. (3) Finally, we combined the non-overlapping checkpoints to get the merged results. Since task-specific knowledge was injected into separate modules, parameter-wise interference was minimized. The results are shown in the upper section of Table 1. ", "page_idx": 19}, {"type": "text", "text": "D.5 Sparsification Methods Details ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "In Figure 6, we conduct a comparative analysis employing various sparsification methods. The specifics of each method are outlined below: ", "page_idx": 19}, {"type": "text", "text": "\u2022 Magnitude. Following the setting in Ties-Merging [76], we retain solely the $k\\%$ largestmagnitude values while resetting the remaining values to zero. ", "page_idx": 19}, {"type": "text", "text": "\u2022 Bernoulli-Dropout. Adhering to the methodology introduced in DARE [79], we employ a parameterized Bernoulli distribution to sample a sparse mask $m^{t}$ . This mask is then applied to the parameters $\\delta$ and subsequently rescaled with respect to the mask rate $k$ . ", "page_idx": 19}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{m^{t}\\sim\\mathrm{Bernoulli}(k),}\\\\ &{\\quad\\widetilde{\\delta}^{t}=m^{t}\\odot\\delta^{t},}\\\\ &{\\quad\\hat{\\delta}^{t}=\\widetilde{\\delta}^{t}/(1-k).}\\end{array}\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "\u2022 Singular value decomposition (SVD). Assuming that matrix $M$ has a rank- $^m$ decomposition, expressed as $\\mathbf{M}^{\\top}{=\\mathbf{\\Delta}\\mathbf{U}_{t}\\pmb{\\Sigma}_{t}\\mathbf{V}_{t}^{T}}$ where $\\mathbf{U}_{t}\\in\\overline{{\\mathbb{R}^{d_{o u t}\\times m}}}$ , $\\pmb{\\Sigma}_{t}\\in\\mathbb{R}^{m\\times m}$ , $\\mathbf{V}_{t}\\in\\mathbb{R}^{d_{i n}\\times m}$ . We compress the matrix $\\mathbf{M}$ by selecting only the top- $^r$ singular values from $\\Sigma_{t}$ , denoted as $\\mathbf{M}_{r}\\,\\dot{=}\\,\\mathbf{U}_{t}(r)\\pmb{\\Sigma}_{t}(r)\\mathbf{V}_{t}(r)^{\\check{T}}$ . Here, $\\mathbf{\\breve{U}}_{t}(r)\\,\\in\\,\\mathbb{R}^{d_{o u t}\\times r}$ , $\\bar{\\Sigma}_{t}(r)\\,\\in\\,\\mathbb{R}^{r\\times r}$ , $\\mathbf{V}_{t}^{r}\\,\\in\\,\\mathbb{R}^{d_{i n}\\times r}$ represent sub-matrices of $\\dot{\\mathbf{U}}_{t},\\pmb{\\Sigma}_{t},\\mathbf{V}_{t}^{T}$ . This transformation significantly reduces the taskspecific parameter dimensionality from $m\\times(d_{o u t}+d_{i n}+1)$ to $r\\times(\\dot{d}_{o u t}+d_{i n}+1)$ , as the maximum $m$ typically equals to the hidden size of the language model (e.g., $m=768$ for RoBERTa-base and $m=4096$ for Qwen-14B) and $r$ can be reduced to 1, resulting in a significant reduction in parameters and storage effectiveness. During merging, we decompress these matrices by extending $\\mathbf{U}_{t}(r),\\boldsymbol{\\Sigma}_{t}(r),\\mathbf{V}_{t}(r)^{T}$ to size$m$ by fliling with zeros, allowing us to recover $\\mathbf{M}$ via their product. This operation is only at the matrix level; once we obtain the merged matrix, we discard the decompressed matrices, ensuring efficient storage. ", "page_idx": 19}, {"type": "text", "text": "D.6 Baselines Details ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Here we will elaborate on the baselines utilized in our main comparison experiment, as outlined in Table 2 and Figure 2b. ", "page_idx": 20}, {"type": "text", "text": "\u2022 Individual means that each task uses the corresponding fine-tuned model, which has no interference between tasks but cannot perform multiple tasks simultaneously. It serves as the upper-bound performance for each specific task.   \n\u2022 Weight Averaging [6, 74] is the simplest form of model merging, which straightforwardly averages the parameters of multiple models. It serves as a lower bound for model merging.   \n\u2022 Task Arithmetic [28] first introduces the concept of \u201ctask vectors\u201d and merges them into the pre-trained model to execute multi-task learning.   \n\u2022 Ties-Merging [76] addresses task conflicts by eliminating redundant parameters. The process involves three steps: Trim, Elect Sign, and Disjoint Merge.   \n\u2022 Task Arithmetic (w/ DARE) [79] This variant incorporates the Bernoulli-Dropout technique for $70\\%$ sparsification before employing Task Arithmetic [28] for merging.   \n\u2022 Ties-Merging (w/ DARE) [79] Similar to the previous approach, this variant integrates Bernoulli-Dropout for $70\\%$ sparsification, followed by Ties-Merging [76] for the merging process.   \n\u2022 AdaMerging [78] assumes access to an offline test set and dynamically adapts to it by introducing additional coefficients at every layer, conducting unsupervised training across multiple iterations on the test set (without labels) to refine the model.   \n\u2022 Surgery [77] assumes that test data IDs are accessible during inference, allowing it to insert corresponding task-specific adapters to leverage task-specific knowledge. ", "page_idx": 20}, {"type": "text", "text": "The coefficient for Task Arithmetic and Ties-Merging are decided by a small scale grid search on validation datasets. The coefficient of 0.7 is consistently applied for DARE Merging, following the previous papers [79]. ", "page_idx": 20}, {"type": "text", "text": "D.7 Detail Results ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "In Table 2, we present only the average normalized scores across various tasks. In this section, we detail the statistical performance of all tasks, with discriminative results displayed in Table 8 and generative results shown in Table 9. ", "page_idx": 20}, {"type": "text", "text": "Table 8: The detail statistics of different merging performance on 8 discriminative tasks. Bold numbers indicate the best-averaging performance across different model merging methods. ", "page_idx": 20}, {"type": "table", "img_path": "81YIt63TTn/tmp/7e5e326ca91d986588eb52b0372967d9452695da094a8edb2fc6d64702dc1b18.jpg", "table_caption": [], "table_footnote": [], "page_idx": 20}, {"type": "text", "text": "We primarily merge using LoRA for the Qwen-14B models because fully finetuning them to obtain task-specific experts would require a huge amount of resources and computation (finetuning the full 14B model requires at least 8 A100 GPUs). However, to further demonstrate, we provide experiments on fully fine-tuned LLaMA 7B models for generative tasks (GSM8k and TruthfulQA), where our approach still exhibits superior performance. ", "page_idx": 20}, {"type": "text", "text": "D.8 More Advantages of Our Method ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Beyond its strong performance and efficiency, our method offers key beneftis in handling distribution shifts and LLM deployment, surpassing approaches like AdaMerging and Surgery. ", "page_idx": 20}, {"type": "text", "text": "Table 9: The detail statistics of different merging performance on 4 generative tasks. Bold numbers indicate the best-averaging performance across different model merging methods. Underlines indicate the second best performance of each task across different model merging methods. ", "page_idx": 21}, {"type": "table", "img_path": "81YIt63TTn/tmp/f0541763f985c15bcb3ef09cd976b727d4a7f00f70c2d520809e2cd92aba2b91.jpg", "table_caption": [], "table_footnote": [], "page_idx": 21}, {"type": "table", "img_path": "81YIt63TTn/tmp/44dab18cca1fc4c2c55bcc223f555b175b8fcbcc455e4f7cdb776e6e233e12a8.jpg", "table_caption": ["Table 10: Performance of LLaMA-7B "], "table_footnote": [], "page_idx": 21}, {"type": "text", "text": "AdaMerging tackles distribution shifts in image domains by requiring access to test sets, even in unseen domains. This is problematic for online settings where test data is unpredictable. In offline scenarios, scaling test sets to large sizes is inefficient. Additionally, AdaMerging\u2019s entropy-based optimization limits it to classification tasks, which restricts its applicability as generative models like LLaMA and GPT-4 become more prominent. ", "page_idx": 21}, {"type": "text", "text": "Our method overcomes these limitations by dynamically adapting to test inputs, as shown in Table 5. It does not require specific validation datasets for each in-domain expert, making it more flexible. For example, the open-source Dolly dataset can represent the MMLU expert, and we do not need validation sets for QNLI, MNLI, RTE, or MMLU. Instead, we assume that combining in-domain knowledge helps address out-of-domain inputs, as supported by [71]. This dynamic merging ensures better generalization to diverse inputs, unlike AdaMerging, which relies on entropy approximations without supervision. ", "page_idx": 21}, {"type": "text", "text": "Our approach is also optimized for real-world LLM deployment with continuous data streams and no gradient updates, aligning with current trends [54]. Key advantages include: ", "page_idx": 21}, {"type": "text", "text": "\u2022 Handling Unpredictable, Heterogeneous Data: Our dynamic merging technique efficiently addresses diverse streaming inputs. \u2022 Reducing Latency and Storage: We shift router training and knowledge modularization to preprocessing, and apply SVD techniques to minimize storage needs. \u2022 Broad Applicability: Our method works across NLP and CV tasks, including generative tasks with Qwen-14B and up to 72B models, supporting large-scale AI deployment. ", "page_idx": 21}, {"type": "text", "text": "D.9 Compatibility of Twin-Merging with Other Merging Methods ", "text_level": 1, "page_idx": 21}, {"type": "table", "img_path": "81YIt63TTn/tmp/b3870557b39d5ddbc47e6cc57febf1dd4f33036395537f3603c568041848ccbf.jpg", "table_caption": ["Table 11: Our method extensibility to other model merging methods "], "table_footnote": [], "page_idx": 21}, {"type": "text", "text": "To evaluate the compatibility of Twin-Merging with other merging methods, we conducted experiments using different techniques to create a shared expert, followed by dynamically merging the twin vectors. The results in Table 11 demonstrate that our method integrates seamlessly with primary merging techniques, leading to significant improvements. For example, when combined with our approach, the baseline Weight Average method improves from 52.26 to 96.23 on GLUE, approaching the performance of fine-tuned experts. Notably, our method complements Ties-Merging particularly well, suggesting that better isolation of shared knowledge enhances the overall performance of Twin-Merging. ", "page_idx": 22}, {"type": "text", "text": "E Inference Efficiency ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Assume we have $T$ tasks, the fine-tuned model have $P=P_{f}+P_{a}$ parameters, where $P_{f}$ are frozen and $P_{a}$ are activated. ", "page_idx": 22}, {"type": "text", "text": "Parameter Count and Storage Cost Assuming each float parameter uses 16 bits (either fp16 or bf16): Fine-tuned models require $2(T P_{a}+P_{f})$ bytes of storage. Pretrained models, including those using Weight Average, Task Arithmetic, Ties-Merging, and DARE Merging techniques, each need $2P$ bytes of storage per model. For Twin-Merging, with the router having $P_{r}$ parameters $(P_{r}\\ll P)$ and a compression rate of $k\\%$ , it need to store $2T k P_{a}+2P+P_{r}$ bytes including a shared expert, compressed exclusive task-specific vectors, and the router. We can select $k$ to compress the model matrix to rank 1 for best storage. These strategies enhance the accessibility and sustainability of task-specific models, fostering wider advancements and applications. Visual representations can be found in Figure 2a and Figure 4. ", "page_idx": 22}, {"type": "text", "text": "Computation FLOPs Analysis Our method mainly introduce the extra time cost due to routing and dynamical merging. However, as the inference process typically involves hundreds of forward passes (e.g., 300 tokens for summarization tasks), the additional computing is usually neglectable. Assuming context length $s$ , task number $T$ , layer number $m$ , the introduced FLOPs ( Multiply\u2013accumulate operation ) can be computed as $m(24s h^{2}+4b s^{2}h)$ for routing, $T m(12h^{2}+9\\dot{h})$ for merging (excluding norm parameter), while generating $L$ tokens typically requires $\\begin{array}{r}{\\sum_{l=s}^{L}24m(l h^{2}+4b l^{2}h)}\\end{array}$ FLOPs. Given that $n\\ll L$ and $s$ are typically truncated, the additional cons umption is neglectable in generation tasks. We demonstrate the actual time cost in Table 7, which adds only 0.039 seconds per sample while bringing significant performance improvements. ", "page_idx": 22}, {"type": "text", "text": "Comparison with other baselises Moreover, our approach offers significant performance improvements with these additional computing resources. As shown in Table 2 and the \"More Baseline\" section, we achieve an absolute normalized improvement of $28.34\\%$ for RoBERTa, $18.83\\%$ on ViTB-32 compared to Task Arithmetic, $9.71\\%$ compared to Twin-Merging on Qwen-14B. Traditional model merging methods often overlook the heterogeneous nature of test inputs, leading to substantial performance gaps. Advanced merging techniques like AdaMerging and Surgery typically require costly training and searching processes, as demonstrated in Table 3. In contrast, our method achieves superior performance to fine-tuned models with minimal cost and storage requirements ( $47m22s$ vs. 215m01s, 5.0GB vs. 32.4GB) due to dynamic merging and SVD techniques. ", "page_idx": 22}, {"type": "text", "text": "Speedup variants Currently, our method supports batch inference for the routing process, while the dynamic merging process handles inputs sequentially. However, it is straightforward to extend our approach to support merging in batches or groups. We can achieve this by first obtaining router weights in batch, then grouping similar data items using the following strategy: (1) Divide into Bins Based on Argmax Indices: First, we divide the data into several bins according to the arg-max indices of the router logits. (2) Cluster Within Each Bin: Then, we cluster (by KMeans) within each bin to group the logits (we set the group number to 20). (3) Average Weights Within Each Group: Within each group, the router weights are averaged to obtain a merged model. Each group corresponds to one merged process, and the group size is typically larger than the batch size, making it very efficient. We have added a group-wise experiment on RoBERTa to illustrate this: ", "page_idx": 22}, {"type": "table", "img_path": "81YIt63TTn/tmp/bed21fa3402740ba22401a39cc45a213d815a89971a48ca90f4aef63f9c6d819.jpg", "table_caption": ["Table 12: Performance of group-wise variant "], "table_footnote": [], "page_idx": 23}, {"type": "text", "text": "F Limitations and Future Work ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Our approach shares common limitations with existing merging methods: (1) The underlying theory behind why and when weight interpolation works is not fully understood, though recent works [51, 83] have made interesting observations about weight disentanglement and cross-task linearity. (2) Currently, merging is limited to models with the same architecture and it may be difficult to find a suitable fine-tuned model with specific capacities. ", "page_idx": 23}, {"type": "text", "text": "Additionally, while our method focuses on shared and exclusive task-specific knowledge, providing a way to approach fine-tuned model performance and potentially surpass it without additional training, we observe there may be other types of knowledge that remain unexplored: (1) Evil knowledge: Useless for any task and distracts the model, obscuring critical knowledge during merging. (2) Irrelevant knowledge: Has no impact on merging performance. Our experiments validate the existence of the irrelevant knowledge since we demonstrate that dropping $90\\bar{\\%}$ of parameters retains most of the fine-tuned performance, but we have not investigated evil knowledge. Future work may include further investigation and decomposing these different types of knowledge to better ignite the model\u2019s full potential without retraining. ", "page_idx": 23}, {"type": "text", "text": "G Broader Impacts ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "This paper presents work whose goal is to advance the field of machine learning and model merging research. In terms of positive social impact, twin-merging techniques can achieve multi-task performance of foundation models without retraining expert models, significantly reducing computational and energy costs. Our proposed knowledge modularization and compression techniques make the task-specific enhanced model more accessible and sustainable, paving the way for broader applications and advancements in the field. These techniques effectively align unaligned models by leveraging experts, thus mitigating the harmfulness and biases present in the original models. Additionally, model merging allows the unified model to benefit from the strengths of each task-specific model, even for tasks with private or inaccessible data, enhancing commercial and safety benefits. However, improper merging of biased models may contaminate the merged model. This issue can be addressed by merging a de-bias expert or using sparsity techniques to minimize the impact. ", "page_idx": 23}, {"type": "text", "text": "NeurIPS Paper Checklist ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "1. Claims ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Question: Do the main claims made in the abstract and introduction accurately reflect the paper\u2019s contributions and scope? ", "page_idx": 24}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 24}, {"type": "text", "text": "Justification: The main claims made in the abstract and introduction accurately reflect the paper\u2019s contributions and scope. ", "page_idx": 24}, {"type": "text", "text": "Guidelines: ", "page_idx": 24}, {"type": "text", "text": "\u2022 The answer NA means that the abstract and introduction do not include the claims made in the paper.   \n\u2022 The abstract and/or introduction should clearly state the claims made, including the contributions made in the paper and important assumptions and limitations. A No or NA answer to this question will not be perceived well by the reviewers.   \n\u2022 The claims made should match theoretical and experimental results, and reflect how much the results can be expected to generalize to other settings.   \n\u2022 It is fine to include aspirational goals as motivation as long as it is clear that these goals are not attained by the paper. ", "page_idx": 24}, {"type": "text", "text": "2. Limitations ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Question: Does the paper discuss the limitations of the work performed by the authors? ", "page_idx": 24}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Justification: Appendix F provides a detailed report on our limitations and future work. Guidelines: ", "page_idx": 24}, {"type": "text", "text": "\u2022 The answer NA means that the paper has no limitation while the answer No means that the paper has limitations, but those are not discussed in the paper.   \n\u2022 The authors are encouraged to create a separate \"Limitations\" section in their paper.   \n\u2022 The paper should point out any strong assumptions and how robust the results are to violations of these assumptions (e.g., independence assumptions, noiseless settings, model well-specification, asymptotic approximations only holding locally). The authors should reflect on how these assumptions might be violated in practice and what the implications would be.   \n\u2022 The authors should reflect on the scope of the claims made, e.g., if the approach was only tested on a few datasets or with a few runs. In general, empirical results often depend on implicit assumptions, which should be articulated.   \n\u2022 The authors should reflect on the factors that influence the performance of the approach. For example, a facial recognition algorithm may perform poorly when image resolution is low or images are taken in low lighting. Or a speech-to-text system might not be used reliably to provide closed captions for online lectures because it fails to handle technical jargon.   \n\u2022 The authors should discuss the computational efficiency of the proposed algorithms and how they scale with dataset size.   \n\u2022 If applicable, the authors should discuss possible limitations of their approach to address problems of privacy and fairness.   \n\u2022 While the authors might fear that complete honesty about limitations might be used by reviewers as grounds for rejection, a worse outcome might be that reviewers discover limitations that aren\u2019t acknowledged in the paper. The authors should use their best judgment and recognize that individual actions in favor of transparency play an important role in developing norms that preserve the integrity of the community. Reviewers will be specifically instructed to not penalize honesty concerning limitations. ", "page_idx": 24}, {"type": "text", "text": "3. Theory Assumptions and Proofs ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Question: For each theoretical result, does the paper provide the full set of assumptions and a complete (and correct) proof? ", "page_idx": 24}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 24}, {"type": "text", "text": "Justification: This paper does not include theoretical results. Guidelines: ", "page_idx": 25}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include theoretical results.   \n\u2022 All the theorems, formulas, and proofs in the paper should be numbered and crossreferenced.   \n\u2022 All assumptions should be clearly stated or referenced in the statement of any theorems.   \n\u2022 The proofs can either appear in the main paper or the supplemental material, but if they appear in the supplemental material, the authors are encouraged to provide a short proof sketch to provide intuition.   \n\u2022 Inversely, any informal proof provided in the core of the paper should be complemented by formal proofs provided in appendix or supplemental material.   \n\u2022 Theorems and Lemmas that the proof relies upon should be properly referenced. ", "page_idx": 25}, {"type": "text", "text": "4. Experimental Result Reproducibility ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "Question: Does the paper fully disclose all the information needed to reproduce the main experimental results of the paper to the extent that it affects the main claims and/or conclusions of the paper (regardless of whether the code and data are provided or not)? ", "page_idx": 25}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 25}, {"type": "text", "text": "Justification: Section 3.3 provides the pseudo-code of our method and Appendix D provides the training and test details of each method we experiment with. ", "page_idx": 25}, {"type": "text", "text": "Guidelines: ", "page_idx": 25}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 If the paper includes experiments, a No answer to this question will not be perceived well by the reviewers: Making the paper reproducible is important, regardless of whether the code and data are provided or not.   \n\u2022 If the contribution is a dataset and/or model, the authors should describe the steps taken to make their results reproducible or verifiable.   \n\u2022 Depending on the contribution, reproducibility can be accomplished in various ways. For example, if the contribution is a novel architecture, describing the architecture fully might suffice, or if the contribution is a specific model and empirical evaluation, it may be necessary to either make it possible for others to replicate the model with the same dataset, or provide access to the model. In general. releasing code and data is often one good way to accomplish this, but reproducibility can also be provided via detailed instructions for how to replicate the results, access to a hosted model (e.g., in the case of a large language model), releasing of a model checkpoint, or other means that are appropriate to the research performed.   \n\u2022 While NeurIPS does not require releasing code, the conference does require all submissions to provide some reasonable avenue for reproducibility, which may depend on the nature of the contribution. For example (a) If the contribution is primarily a new algorithm, the paper should make it clear how to reproduce that algorithm. (b) If the contribution is primarily a new model architecture, the paper should describe the architecture clearly and fully. (c) If the contribution is a new model (e.g., a large language model), then there should either be a way to access this model for reproducing the results or a way to reproduce the model (e.g., with an open-source dataset or instructions for how to construct the dataset). (d) We recognize that reproducibility may be tricky in some cases, in which case authors are welcome to describe the particular way they provide for reproducibility. In the case of closed-source models, it may be that access to the model is limited in some way (e.g., to registered users), but it should be possible for other researchers to have some path to reproducing or verifying the results. ", "page_idx": 25}, {"type": "text", "text": "5. Open access to data and code ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "Question: Does the paper provide open access to the data and code, with sufficient instructions to faithfully reproduce the main experimental results, as described in supplemental material? ", "page_idx": 25}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 26}, {"type": "text", "text": "Justification: Our paper uses publicly available datasets and provides the complete code and execution scripts in the supplementary material. ", "page_idx": 26}, {"type": "text", "text": "Guidelines: ", "page_idx": 26}, {"type": "text", "text": "\u2022 The answer NA means that paper does not include experiments requiring code.   \n\u2022 Please see the NeurIPS code and data submission guidelines (https://nips.cc/ public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 While we encourage the release of code and data, we understand that this might not be possible, so \u201cNo\u201d is an acceptable answer. Papers cannot be rejected simply for not including code, unless this is central to the contribution (e.g., for a new open-source benchmark).   \n\u2022 The instructions should contain the exact command and environment needed to run to reproduce the results. See the NeurIPS code and data submission guidelines (https: //nips.cc/public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 The authors should provide instructions on data access and preparation, including how to access the raw data, preprocessed data, intermediate data, and generated data, etc.   \n\u2022 The authors should provide scripts to reproduce all experimental results for the new proposed method and baselines. If only a subset of experiments are reproducible, they should state which ones are omitted from the script and why.   \n\u2022 At submission time, to preserve anonymity, the authors should release anonymized versions (if applicable).   \n\u2022 Providing as much information as possible in supplemental material (appended to the paper) is recommended, but including URLs to data and code is permitted. ", "page_idx": 26}, {"type": "text", "text": "6. Experimental Setting/Details ", "text_level": 1, "page_idx": 26}, {"type": "text", "text": "Question: Does the paper specify all the training and test details (e.g., data splits, hyperparameters, how they were chosen, type of optimizer, etc.) necessary to understand the results? ", "page_idx": 26}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 26}, {"type": "text", "text": "Justification: Appendix D provides the training and test details of each method we experiment with. ", "page_idx": 26}, {"type": "text", "text": "Guidelines: ", "page_idx": 26}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments. \u2022 The experimental setting should be presented in the core of the paper to a level of detail that is necessary to appreciate the results and make sense of them. \u2022 The full details can be provided either with the code, in appendix, or as supplemental material. ", "page_idx": 26}, {"type": "text", "text": "7. Experiment Statistical Significance ", "text_level": 1, "page_idx": 26}, {"type": "text", "text": "Question: Does the paper report error bars suitably and correctly defined or other appropriate information about the statistical significance of the experiments? ", "page_idx": 26}, {"type": "text", "text": "Answer: [No] ", "page_idx": 26}, {"type": "text", "text": "Justification: The paper does not include error bars for the experiments. This omission is due to the high computational cost associated with calculating error bars for large language models. Additionally, the training-free algorithms used in the experiments are deterministic, ensuring reproducibility and consistency of the results. ", "page_idx": 26}, {"type": "text", "text": "Guidelines: ", "page_idx": 26}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The authors should answer \"Yes\" if the results are accompanied by error bars, confidence intervals, or statistical significance tests, at least for the experiments that support the main claims of the paper.   \n\u2022 The factors of variability that the error bars are capturing should be clearly stated (for example, train/test split, initialization, random drawing of some parameter, or overall run with given experimental conditions).   \n\u2022 The method for calculating the error bars should be explained (closed form formula, call to a library function, bootstrap, etc.)   \n\u2022 The assumptions made should be given (e.g., Normally distributed errors).   \n\u2022 It should be clear whether the error bar is the standard deviation or the standard error of the mean.   \n\u2022 It is OK to report 1-sigma error bars, but one should state it. The authors should preferably report a 2-sigma error bar than state that they have a $96\\%$ CI, if the hypothesis of Normality of errors is not verified.   \n\u2022 For asymmetric distributions, the authors should be careful not to show in tables or figures symmetric error bars that would yield results that are out of range (e.g. negative error rates).   \n\u2022 If error bars are reported in tables or plots, The authors should explain in the text how they were calculated and reference the corresponding figures or tables in the text. ", "page_idx": 26}, {"type": "text", "text": "", "page_idx": 27}, {"type": "text", "text": "8. Experiments Compute Resources ", "text_level": 1, "page_idx": 27}, {"type": "text", "text": "Question: For each experiment, does the paper provide sufficient information on the computer resources (type of compute workers, memory, time of execution) needed to reproduce the experiments? ", "page_idx": 27}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 27}, {"type": "text", "text": "Justification: The paper provides computer resources and information needed to reproduce experiments in Appendix D.1. ", "page_idx": 27}, {"type": "text", "text": "Guidelines: ", "page_idx": 27}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The paper should indicate the type of compute workers CPU or GPU, internal cluster, or cloud provider, including relevant memory and storage.   \n\u2022 The paper should provide the amount of compute required for each of the individual experimental runs as well as estimate the total compute.   \n\u2022 The paper should disclose whether the full research project required more compute than the experiments reported in the paper (e.g., preliminary or failed experiments that didn\u2019t make it into the paper). ", "page_idx": 27}, {"type": "text", "text": "9. Code Of Ethics ", "text_level": 1, "page_idx": 27}, {"type": "text", "text": "Question: Does the research conducted in the paper conform, in every respect, with the NeurIPS Code of Ethics https://neurips.cc/public/EthicsGuidelines? ", "page_idx": 27}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 27}, {"type": "text", "text": "Justification: Yes, the research conducted in the paper conforms in every respect with the NeurIPS Code of Ethics. ", "page_idx": 27}, {"type": "text", "text": "Guidelines: ", "page_idx": 27}, {"type": "text", "text": "\u2022 The answer NA means that the authors have not reviewed the NeurIPS Code of Ethics.   \n\u2022 If the authors answer No, they should explain the special circumstances that require a deviation from the Code of Ethics.   \n\u2022 The authors should make sure to preserve anonymity (e.g., if there is a special consideration due to laws or regulations in their jurisdiction). ", "page_idx": 27}, {"type": "text", "text": "10. Broader Impacts ", "text_level": 1, "page_idx": 27}, {"type": "text", "text": "Question: Does the paper discuss both potential positive societal impacts and negative societal impacts of the work performed? ", "page_idx": 27}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 27}, {"type": "text", "text": "Justification: We analyze both the positive and negative societal impacts in the Appendix G. Guidelines: ", "page_idx": 27}, {"type": "text", "text": "\u2022 The answer NA means that there is no societal impact of the work performed. \u2022 If the authors answer NA or No, they should explain why their work has no societal impact or why the paper does not address societal impact. ", "page_idx": 27}, {"type": "text", "text": "\u2022 Examples of negative societal impacts include potential malicious or unintended uses (e.g., disinformation, generating fake profiles, surveillance), fairness considerations (e.g., deployment of technologies that could make decisions that unfairly impact specific groups), privacy considerations, and security considerations.   \n\u2022 The conference expects that many papers will be foundational research and not tied to particular applications, let alone deployments. However, if there is a direct path to any negative applications, the authors should point it out. For example, it is legitimate to point out that an improvement in the quality of generative models could be used to generate deepfakes for disinformation. On the other hand, it is not needed to point out that a generic algorithm for optimizing neural networks could enable people to train models that generate Deepfakes faster.   \n\u2022 The authors should consider possible harms that could arise when the technology is being used as intended and functioning correctly, harms that could arise when the technology is being used as intended but gives incorrect results, and harms following from (intentional or unintentional) misuse of the technology.   \n\u2022 If there are negative societal impacts, the authors could also discuss possible mitigation strategies (e.g., gated release of models, providing defenses in addition to attacks, mechanisms for monitoring misuse, mechanisms to monitor how a system learns from feedback over time, improving the efficiency and accessibility of ML). ", "page_idx": 28}, {"type": "text", "text": "11. Safeguards ", "text_level": 1, "page_idx": 28}, {"type": "text", "text": "Question: Does the paper describe safeguards that have been put in place for responsible release of data or models that have a high risk for misuse (e.g., pretrained language models, image generators, or scraped datasets)? ", "page_idx": 28}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 28}, {"type": "text", "text": "Justification: The paper poses no such risks. ", "page_idx": 28}, {"type": "text", "text": "Guidelines: ", "page_idx": 28}, {"type": "text", "text": "\u2022 The answer NA means that the paper poses no such risks.   \n\u2022 Released models that have a high risk for misuse or dual-use should be released with necessary safeguards to allow for controlled use of the model, for example by requiring that users adhere to usage guidelines or restrictions to access the model or implementing safety filters.   \n\u2022 Datasets that have been scraped from the Internet could pose safety risks. The authors should describe how they avoided releasing unsafe images.   \n\u2022 We recognize that providing effective safeguards is challenging, and many papers do not require this, but we encourage authors to take this into account and make a best faith effort. ", "page_idx": 28}, {"type": "text", "text": "12. Licenses for existing assets ", "text_level": 1, "page_idx": 28}, {"type": "text", "text": "Question: Are the creators or original owners of assets (e.g., code, data, models), used in the paper, properly credited and are the license and terms of use explicitly mentioned and properly respected? ", "page_idx": 28}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 28}, {"type": "text", "text": "Justification: All the creators or original owners of assets used in the paper are properly cited and Appendix D.2 provides licensing information for datasets used in our work. ", "page_idx": 28}, {"type": "text", "text": "Guidelines: ", "page_idx": 28}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not use existing assets.   \n\u2022 The authors should cite the original paper that produced the code package or dataset.   \n\u2022 The authors should state which version of the asset is used and, if possible, include a URL.   \n\u2022 The name of the license (e.g., CC-BY 4.0) should be included for each asset.   \n\u2022 For scraped data from a particular source (e.g., website), the copyright and terms of service of that source should be provided.   \n\u2022 If assets are released, the license, copyright information, and terms of use in the package should be provided. For popular datasets, paperswithcode.com/datasets has curated licenses for some datasets. Their licensing guide can help determine the license of a dataset.   \n\u2022 For existing datasets that are re-packaged, both the original license and the license of the derived asset (if it has changed) should be provided.   \n\u2022 If this information is not available online, the authors are encouraged to reach out to the asset\u2019s creators. ", "page_idx": 28}, {"type": "text", "text": "", "page_idx": 29}, {"type": "text", "text": "13. New Assets ", "text_level": 1, "page_idx": 29}, {"type": "text", "text": "Question: Are new assets introduced in the paper well documented and is the documentation provided alongside the assets? ", "page_idx": 29}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 29}, {"type": "text", "text": "Justification: We submit the code in the supplementary material with detail scripts and guidance. ", "page_idx": 29}, {"type": "text", "text": "Guidelines: ", "page_idx": 29}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not release new assets.   \n\u2022 Researchers should communicate the details of the dataset/code/model as part of their submissions via structured templates. This includes details about training, license, limitations, etc.   \n\u2022 The paper should discuss whether and how consent was obtained from people whose asset is used.   \n\u2022 At submission time, remember to anonymize your assets (if applicable). You can either create an anonymized URL or include an anonymized zip file. ", "page_idx": 29}, {"type": "text", "text": "14. Crowdsourcing and Research with Human Subjects ", "text_level": 1, "page_idx": 29}, {"type": "text", "text": "Question: For crowdsourcing experiments and research with human subjects, does the paper include the full text of instructions given to participants and screenshots, if applicable, as well as details about compensation (if any)? ", "page_idx": 29}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 29}, {"type": "text", "text": "Justification: The paper does not involve crowdsourcing or research with humans subjects. Guidelines: ", "page_idx": 29}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing or research with human subjects.   \n\u2022 Including this information in the supplemental material is fine, but if the main contribution of the paper involves human subjects, then as much detail as possible should be included in the main paper.   \n\u2022 According to the NeurIPS Code of Ethics, workers involved in data collection, curation, or other labor should be paid at least the minimum wage in the country of the data collector. ", "page_idx": 29}, {"type": "text", "text": "15. Institutional Review Board (IRB) Approvals or Equivalent for Research with Human Subjects ", "text_level": 1, "page_idx": 29}, {"type": "text", "text": "Question: Does the paper describe potential risks incurred by study participants, whether such risks were disclosed to the subjects, and whether Institutional Review Board (IRB) approvals (or an equivalent approval/review based on the requirements of your country or institution) were obtained? ", "page_idx": 29}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 29}, {"type": "text", "text": "Justification: The paper does not involve crowdsourcing or research with human subjects. Guidelines: ", "page_idx": 29}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing or research with human subjects.   \n\u2022 Depending on the country in which research is conducted, IRB approval (or equivalent) may be required for any human subjects research. If you obtained IRB approval, you should clearly state this in the paper.   \n\u2022 We recognize that the procedures for this may vary significantly between institutions and locations, and we expect authors to adhere to the NeurIPS Code of Ethics and the guidelines for their institution.   \n\u2022 For initial submissions, do not include any information that would break anonymity (if applicable), such as the institution conducting the review. ", "page_idx": 29}, {"type": "text", "text": "", "page_idx": 30}]