[{"type": "text", "text": "Boosting the Transferability of Adversarial Attack on Vision Transformer with Adaptive Token Tuning ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Di Ming, Peng Ren, Yunlong Wang, Xin Feng ", "page_idx": 0}, {"type": "text", "text": "School of Computer Science and Engineering, Chongqing University of Technology Chongqing, China diming@cqut.edu.cn, misterr_2019@163.com, {ylwang, xfeng}@cqut.edu.cn ", "page_idx": 0}, {"type": "text", "text": "Abstract ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Vision transformers (ViTs) perform exceptionally well in various computer vision tasks but remain vulnerable to adversarial attacks. Recent studies have shown that the transferability of adversarial examples exists for CNNs, and the same holds true for ViTs. However, existing ViT attacks aggressively regularize the largest token gradients to exact zero within each layer of the surrogate model, overlooking the interactions between layers, which limits their transferability in attacking blackbox models. Therefore, in this paper, we focus on boosting the transferability of adversarial attacks on ViTs through adaptive token tuning (ATT). Specifically, we propose three optimization strategies: an adaptive gradient re-scaling strategy to reduce the overall variance of token gradients, a self-paced patch out strategy to enhance the diversity of input tokens, and a hybrid token gradient truncation strategy to weaken the effectiveness of attention mechanism. We demonstrate that scaling correction of gradient changes using gradient variance across different layers can produce highly transferable adversarial examples. In addition, introducing attentional truncation can mitigate the overfitting over complex interactions between tokens in deep ViT layers to further improve the transferability. On the other hand, using feature importance as a guidance to discard a subset of perturbation patches in each iteration, along with combining self-paced learning and progressively more sampled attacks, significantly enhances the transferability over attacks that use all perturbation patches. Extensive experiments conducted on ViTs, undefended CNNs, and defended CNNs validate the superiority of our proposed ATT attack method. On average, our approach improves the attack performance by $10.1\\%$ compared to state-of-the-art transfer-based attacks. Notably, we achieve the best attack performance with an average of $58.3\\%$ on three defended CNNs. Code is available at https://github.com/MisterRpeng/ATT. ", "page_idx": 0}, {"type": "text", "text": "1 Introduction ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "The Vision Transformer (ViT) [1] was the first to apply the transformer architecture to computer vision models, demonstrating excellent performance in image classification tasks. Since then, various ViT-based transformer structures have shown comparable success in a range of computer vision tasks, including object detection [2, 3], semantic segmentation [4, 5], and human pose estimation [6]. However, similar to convolutional neural networks (CNNs), ViT models are also vulnerable to adversarial attacks [7, 8, 9, 10]. For ViT to be widely adopted in real-world applications, particularly in secure systems, it is crucial to identify model weaknesses [11, 12, 13] and develop more robust ViT models. Specifically, adversarial attacks generate perturbations that can cause incorrect model classifications, which are often too subtle for humans to notice. The transferability of the adversarial perturbations leads to the fact that the perturbations can directly deceive the unknown target model. Therefore, it is imperative to study transferable ViT attacks to further uncover the vulnerabilities of ViT models, thereby providing valuable insights for adversarial defense or building robust ViTs. ", "page_idx": 0}, {"type": "text", "text": "", "page_idx": 1}, {"type": "text", "text": "Gradient regularization-based adversarial attack adjusts the gradient after back-propagation to update the perturbation more stably and effectively. However, attack methods designed specifically for CNNs are less effective when directly applied to ViTs. Token gradient regularization (TGR) [14] addresses the shortcomings of existing gradient regularization methods and designs a technique that regularizes the gradient of intermediate ViT layers, leading to a significant improvement of the transferability of adversarial attacks on ViTs. However, we observe that TGR simply sets the largest part of token gradients in each module to zero, thereby losing feature information to a certain extent. To solve this problem, we propose an adaptive variance reduction method, not only correcting the gradient variance but also preserving the feature information (see the bottom-right of Fig. 1). Thus, the perturbation can learn more features while reducing overfitting and improving the transferability of adversarial examples across ViT models with various network structures. ", "page_idx": 1}, {"type": "text", "text": "Another ViT attack approach, proposed by Wei et al. [15], inspired us to incorporate input diversity with gradient regularization to enhance the transferability further. This transfer-based ViT method proposes the PatchOut Attack to exploit the input diversity [16]. PatchOut is a straightforward and effective way to address the overftiting. However, this approach does not account for update efficiency and difficulty, leading to potential over-discarding of updates. As a result, the finite number of iterations may end with a perturbation that has not reached its optimal state. To address this, we propose a discard strategy that combines feature importance-based sampling and self-paced learning. As shown on the left side of Fig. 1, this approach allows for a more rational implementation of patch out strategy and improves the update efficiency. ", "page_idx": 1}, {"type": "text", "text": "Influenced by [15, 17], we found out that the attention mechanism specific to ViTs tends to cause the perturbation overftiting in surrogate models. To resolve this, we propose an attention weakening strategy to further adaptively tune the token gradients both within and across ViT layers. Secifically, as indicated in the top-right of Fig. 1, we truncate the gradient back-propagation in the ttention module of deep ViT layers while preserving the token gradients of QKV and MLP modules, to reduce the overftiting caused by excessive global attention. In addition, for purpose of balancing the interactions between different modules in the remaining shallow ViT layers, we also adjust the token gradients of the attention, QKV and MLP modules accordingly. ", "page_idx": 1}, {"type": "text", "text": "In summary, the main contributions of our paper include: ", "text_level": 1, "page_idx": 1}, {"type": "text", "text": "\u2022 We propose an adaptive token gradient re-scaling method to improve the transferability of adversarial attacks. This method aims to reduce the overall variance of token gradients in each ViT layer and smooth token gradient variance changes throughout all the ViT layers. Meanwhile, we introduce a hybrid token gradient truncation method to weaken the effectiveness of attention mechanism. In order to achieve a balance between different modules, we further adjust the truncation factors of each module accordingly.   \n\u2022 We propose a self-paced patch out strategy for learning the input diversity. During the perturbation training, a sparse mask is constructed under the semantic guidance of patch-level feature importance. As the iterations increase, self-paced learning strategy is employed to generate a progressively more sampled mask. These sparse masks are then superimposed with perturbations as input samples, and the perturbation updates are incrementally enhanced through this self-paced training process, which not only mitigates the overfitting issue but also enhances the attack efficiency.   \n\u2022 Extensive experiments are conducted to verify the effectiveness of our proposed adaptive token tuning attack method, which improves the attack success rate by an average of $10.1\\%$ over state-ofthe-art methods under black-box attack setting, including an average of $4.9\\%$ for attacking ViTs and $12.8\\%$ for attacking CNNs. Additionally, we achieves the highest average attack rate of $58.3\\%$ on defended CNNs, further demonstrating the superior transferability of our ATT attack approach in both undefended and defended black-box models. ", "page_idx": 1}, {"type": "text", "text": "2 Related Work ", "text_level": 1, "page_idx": 1}, {"type": "text", "text": "Current adversarial attacks can be broadly divided into two main categories: white-box and blackbox attacks. White-box attack refers to adversarial attack under the condition that all the model information is known. On the contrary, black-box attacks do not have unrestricted access to all model\u2019s information. Specifically, black-box attacks consist of two types: query-based black-box attacks, which could access the output of the target model, and transfer-based black-box attacks, where no knowledge of the target model is available. In practice, it is often impossible to obtain any information about the target model, making transfer-based black-box attacks a more serious security threat. Therefore, this paper focuses on transferable black-box attacks on ViT models. ", "page_idx": 1}, {"type": "image", "img_path": "sNz7tptCH6/tmp/b08daa826cd4f6307ef75bf297d6139828d88dc70b289fc9a307ccdfdddec60b.jpg", "img_caption": ["Figure 1: The overall framework of our Adaptive Token Tuning (ATT) attack method. "], "img_footnote": [], "page_idx": 2}, {"type": "text", "text": "", "page_idx": 2}, {"type": "text", "text": "Adversarial Attacks on CNNs. Adversarial attacks on CNNs can be categorized into gradient optimization-based and feature information-based attacks. In gradient optimization-based adversarial attacks, [18, 19, 20] incorporated a momentum term into the existing iterative attack update process [21] to stabilize the update direction and avoid the local optima. Towards improving the backpropagation path, Skipping Gradient Method (SGM) [22] allowed gradients to backpropagate more through skip connections, while Backward Propagation Attack (BPA) [23] mitigated the negative impact of gradient truncation in ReLU and max-pooling to improve the relevance between the gradient and the input. Besides, [24, 25] introduced variance adjustment methods that modify the current gradient based on the variance of gradients from the previous iteration and from ensemble surrogate models respectively, resulting in more stable gradient updates. In comparison, feature informationbased adversarial attacks, such as FIA [26] and FDA [27], aim to degrade model performance by disrupting important features that play a critical role in the model\u2019s decisions. Since inaccurate feature importance guidance could lead to a decrease in transferability, [28, 29] proposed the neuron attribution-based attack methods that utilized more accurate neuron importance for feature-level attacks. Furthermore, there were also other approaches [30, 31, 32] that utilized feature importance to create masks that guide perturbation updates, enhancing transferability by focusing on more critical features during attacks. In addition to that, [33, 34] specifically targeted feature information from shallow layers to craft more transferable perturbation against the fine-tuned models. ", "page_idx": 2}, {"type": "text", "text": "Adversarial Attacks on ViTs. However, attack methods designed for CNNs have very low transferability to ViT models. To improve the attack performance against ViTs, Nasser et al. [35] proposed the self-integration (SE) method and token refinement module (TR). Specifically, SE leverages the classification header at each layer of the ViT model to produce adversarial perturbations, while TR further refines the classification token based on SE to enhance the attack transferability. Wei et al. [15] approached the problem from the perspective of attention, proposing a method to skip the attention module, which significantly improves the transferability of adversarial examples. Additionally, they proposed a random extraction of perturbation patch strategy from the perspective of image transformation to further enhance the transferability. Zhang et al. [36] introduced a virtual dense connectivity approach, enabling the backpropagation of gradients through jump connections in a deep network. Gao et al. [37] developed a feature diversity-based attack that uses adversarial perturbations to accelerate feature collapse due to the ViT attention module. Zhang et al. [14] proposed a token gradient regularization approach to reduce gradient variance during backpropagation in a token-wise manner, based on the structural features of ViTs, to improve the transferability of adversarial perturbations. By contrast, our adaptive token tuning method not only considers the token gradient variance but also aims to reduce the destruction of feature diversity to preserve the original feature information. Additionally, we design a self-paced patch out strategy to enhance both the transferability and efficiency of adversarial attacks. ", "page_idx": 2}, {"type": "text", "text": "3 Methodology ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "3.1 Preliminary ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "Notations and Definitions. A benign sample is defined as the original clean image $\\pmb{x}\\in\\mathbb{R}^{C\\times H\\times W}$ along with its corresponding ground-truth label $y\\in\\{1,2,\\cdot\\cdot\\cdot,K\\}$ , where $C,H,W$ , and $K$ represent the number of channels, height, width of the image, and the number of label categories, respectively. In ViT networks, the image $\\textbf{\\em x}$ is evenly partitioned into a set of patches $\\pmb{x}_{p}=\\{\\pmb{x}_{p}^{1},\\pmb{x}_{p}^{2},\\dot{\\cdot}\\cdot\\cdot,\\pmb{x}_{p}^{n}\\}$ where $\\pmb{x}_{p}^{i}\\in\\mathbb{R}^{C\\times P\\times P}$ denotes the $i$ -th patch and $n=H W/P^{2}$ denotes the number of patches. The set of ViT modules is defined as $\\mathcal{M}=\\{\\mathrm{QKV},\\mathrm{MLP},\\mathrm{Attention}\\}$ , and the total number of ViT layers is $L$ . Given a surrogate ViT model $f$ , the predicted label for the input $\\textbf{\\em x}$ is represented by $\\hat{y}=f(\\pmb{x})$ , where ${\\hat{y}}=y$ for benign sample $\\textbf{\\em x}$ . Consistent with previous works, we focus on fooling ViT models in the untargeted attack setting. To guarantee the effectiveness and imperceptibility of adversarial example $\\mathbf{x}_{a d v}=\\mathbf{x}+\\delta$ , adversarial attack maximizes the following optimization problem: ", "page_idx": 3}, {"type": "equation", "text": "$$\n{\\underset{\\delta}{\\operatorname{arg\\,max}}}\\ {\\mathcal{L}}(f(\\pmb{x}+\\delta),y),\\quad{\\mathrm{s.t.}}\\ \\|\\delta\\|_{\\infty}\\leq\\epsilon\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "where $\\mathcal{L}$ is the loss function, e.g., cross-entropy, and $\\epsilon$ is a constant to constrain the adversarial perturbation $\\delta$ in the $\\ell_{\\infty}$ -norm bound, thereby resulting in a change of label that $f(\\pmb{x}_{a d v})\\neq y$ . ", "page_idx": 3}, {"type": "text", "text": "Patch Out. Motivated by previous work [16], Wei et al. [15] proposed the PatchOut attack to alleviate the overftiting phenomenon by creating diverse input patterns. Specifically, a portion of patches in the adversarial perturbation are randomly discarded using a binarized attack mask $\\pmb{w}$ , where the values of selected/unselected patches are set to ones/zeros respectively. During the feed-forward process, the input to surrogate model $f$ becomes as $\\mathbf{\\boldsymbol{x}}+\\pmb{\\delta}\\odot\\pmb{w}$ , thus enhancing the input diversity. ", "page_idx": 3}, {"type": "text", "text": "Token Gradient Regularization. As compared to gradient variance tuning [24] applied directly to the input, Zhang et al. [14] regularized the gradient variance of tokens in the intermediate ViT blocks. Through the back-propagation in ViT layers, token gradients are multiplied by a scaling factor $s$ and $k$ extreme values are further reset to zeros. As a result, adversarial perturbation is updated by a regularized input gradient, i.e., $T G R(\\nabla_{\\delta}\\mathcal{L},s,k)$ , resulting in a more stable optimization process. ", "page_idx": 3}, {"type": "text", "text": "3.2 Adaptive Variance Reduced Token Gradient ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "During the training, a large gradient variance tends to overfit the surrogate model and causes the update of the perturbations to fall into a local optimal solution, which lowers the transferability of adversarial attack. Wang et al. [24] propose a variance tuning method to reduce the gradient variance in the input perturbation space, but ignoring the gradient variance in intermediate layers. Thus, we aim to reduce the overall gradient variance across all ViT layers to improve training effectiveness. ", "page_idx": 3}, {"type": "text", "text": "Variance Reduction in a Single ViT Layer. Given the module $m\\in\\mathcal{M}$ in an intermediate $l_{\\cdot}$ -th ViT layer, the latent representation of $i$ -th token is defined as zi(l,m)and its corresponding gradient w.r.t. the loss function $\\mathcal{L}$ in Eq. 1 is defined as $\\pmb{g}_{i}^{(l,m)}=\\partial\\mathcal{L}/\\partial\\dot{z}_{i}^{(l,m)}$ zi(l,m). During the back-propagation, TGR [14] searches the largest gradient out of $n$ token gradients via $\\pmb{g}_{j}^{(l,m)}=\\arg\\operatorname*{max}_{i\\in\\{1,\\cdots,n\\}}\\pmb{g}_{i}^{(l,m)}$ for each module m, and simply sets gj(l $\\pmb{g}_{j}^{(l,m)}=0$ to reduce the variance of token gradients in $l_{\\cdot}$ -th ViT layer. However, this largest gradient could be highly correlated with important features. As a consequence, iterative optimization updates may overlook this portion of semantic information, undermining the quality of the perturbations. ", "page_idx": 3}, {"type": "text", "text": "To simultaneously reduce the token gradient variance and preserve the feature information from the largest token gradient, we decrease the largest token gradient mildly by a gradient penalty factor $\\gamma\\in\\left(0,1\\right)$ . For $m=\\mathrm{QKV}$ or $m=\\mathbf{M}\\mathbf{L}\\mathbf{P}$ , $\\pmb{g}_{i}^{(l,m)}=\\gamma\\cdot\\pmb{g}_{i}^{(l,m)}$ gi(l,m). Following the TGR [14] method, for $m=$ Attention, we also search for the set $\\boldsymbol{S}$ of extreme token gradients located in the same row or column as the largest token gradient. Thus, all the token gradients in $\\boldsymbol{S}$ are re-scaled by $\\pmb{g}_{i}^{(l,m)}=\\gamma\\cdot\\pmb{g}_{i}^{(l,m)}$ gi(l,m)for i \u2208S, since they are highly correlated with the largest token gradient. As can be seen, this mild re-scaling strategy allows some important feature information in the largest or extreme token gradients (i.e., nonzero gradient values) to back-propagate between consecutive ViT layers in certain degree. The detailed analysis of the change in the token gradient variance (before and after mild re-scaling by $\\gamma$ ) is provided in Appendix A. ", "page_idx": 3}, {"type": "text", "text": "Adaptive Variance Reduction Throughout ViT Layers. If re-scaling the token gradient of each intermediate ViT layer independently, after back-propagation, the gradient w.r.t. the input perturbation could be deviated from the original updating direction. Inspired by [38, 39], we utilize the gradient information across ViT layers to adaptively re-scale the token gradients in each ViT layer. To be specific, the last ViT layer is selected as the anchor, since it is most relevant to the classification task. Then, the largest token gradient (or the set of extreme token gradients) in each ViT layer is adaptively re-scaled to ensure its gradient variance remains consistent with previous ViT layer. Thus, for $t$ -th iteration, we define the adaptive variance reduce token gradient method as follows: ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\pmb{g}_{i,t}^{(l,m)}=\\pmb{g}_{i,t}^{(l,m)}\\cdot\\bigg(\\gamma+\\lambda\\bigg(1-\\sqrt{\\Phi_{t}^{(l,m)}/\\Phi_{t}^{(l+1,m)}}\\bigg)\\bigg),\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "where $\\Phi_{t}^{(l,m)}$ and $\\Phi_{t}^{(l+1,m)}$ denote the variance of token gradients for module $m$ in $l$ -th and $(l+1)$ -th layers respectively, i.e., $\\Phi_{t}^{(l,m)}=\\operatorname{Var}(g^{(l,m)})$ and \u03a6t(l+1,m)= Var(g(l+1,m)), and \u03bb is the adaptive factor balancing the relative importance between the gradient penalty factor and the ratio of gradient variances. With this adaptive updating strategy, the variances of token gradients between consecutive ViT layers become smoother compared to using a fixed constant value for re-scaling token gradients. Appendix B provides further details regarding the analysis of adaptive variance reduced token gradient throughout ViT layers with different parameter settings. ", "page_idx": 4}, {"type": "text", "text": "3.3 Self-Paced Patch Out under Semantic Guidance ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "Undoubtedly, random discarding [15] is a simple and effective method to alleviate the overfitting and improve the transferability. However, discarding patches inappropriately raised by randomness could lead to the difficulty in updating the perturbation, especially when limiting the total number of iterations to a small value, e.g., only 10 iterations are commonly used in the literature of ViT attack. Thus, within a limited training budget, we propose a self-paced patch out strategy under semantic guidance to prevent the improper discarding of important patches to a certain degree. In addition to that, the number of discarded patches are dynamically controlled by a scheduled pace to further stablize the perturbation training. ", "page_idx": 4}, {"type": "text", "text": "Generating Semantic Guided Sparse Mask. Instead of generating a completely random mask, we leverage the rich semantic information to mitigate the optimization instability caused by discarding perturbation patches. Based on Grad-CAM [40], we construct the feature importance matrix $W\\in$ $\\mathbb{R}^{H\\times W}$ by fusing gradients and features from an intermediate ViT layer, i.e., $\\begin{array}{r}{\\overbar{\\mathbf{W}}=\\sum_{i=1}^{C^{(l)}}\\mathbf{G}_{i}^{(l)}\\odot\\mathbf{F}_{i}^{(l)}}\\end{array}$ , where $C^{(l)}$ is the number of channels in -th layer and $l\\in(0,L)$ . According to the partition of $\\pmb{x}_{p}$ , we further define the patch version of $W$ as $W_{p}=\\{W_{p}^{1},\\cdot\\cdot\\cdot,W_{p}^{n}\\}$ , where $W_{p}^{i}\\in\\mathbb{R}^{P\\times P}$ . Thus, the feature importance of $i$ -th patch $\\pmb{x}_{p}^{(i)}$ can be measured by the Frobenius norm $||W_{p}^{i}||_{F}$ . ", "page_idx": 4}, {"type": "text", "text": "Furthermore, patch-level feature importance can be combined with random sampling to discard a portion of patches under semantic guidance. First, we define ${\\bf1}_{p}$ as a $C\\times P\\times P$ tensor with all ones and the scaled patch-level feature importance as $\\pmb{c}\\in[0,1]^{\\bar{C}\\times H\\times W}$ , where $c_{p}^{i}=(||W_{p}^{i}||_{F}-$ $\\mathrm{min}_{j}(||W_{p,\\cdot}^{j}||_{F}))/(\\mathrm{max}_{j}(||W_{p}^{j}||_{F})-\\mathrm{min}_{j}(||W_{p}^{j}||_{F}))_{\\cdot}\\cdot\\mathbf{1}_{p}$ for $i,j\\;\\in\\;\\{1,\\cdot\\cdot\\cdot,n\\}$ . To control the number of discarded patches, we further introduce $\\alpha\\geq0$ and $\\beta\\geq0$ as scaling and offset coefficients to shift the distribution of $^c$ . Then, the semantic guided sparse mask $\\mathbf{\\nabla}w$ can be generated by: ", "page_idx": 4}, {"type": "equation", "text": "$$\n{\\pmb w}=({\\pmb q}<{\\alpha}\\cdot{\\pmb c}-\\beta),\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "where $\\pmb q\\in[0,1]^{C\\times H\\times W}$ is a random variable sampled from the patch-level uniform distribution $\\mathcal{U}_{p}(0,1)$ . In detail, for $i$ -th patch of $\\pmb q$ , we have $\\pmb q_{p}^{i}=\\epsilon\\cdot\\mathbf{1}_{p}$ where $\\epsilon\\sim\\mathcal{U}(0,1)$ . As can be seen, the elements within a patch will be discarded or preserved altogether with the same probability. Additionally, patches with lower feature importance are more likely to be discarded, while those with higher feature importance are less likely to be discarded. ", "page_idx": 4}, {"type": "text", "text": "Self-Paced Patch Out via Progressive Sparse Mask. To further improve both the efficiency and the effectiveness of training adversarial perturbations, a self-paced patch out strategy is introduced to control the number of discarded patches for each iteration at a dynamic pace. For $t$ -th iteration, we define the progressive sparse mask $\\pmb{w}_{t}$ based on feature importance $c_{t}$ as follows: ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{w_{t}=\\{w|w=(\\pmb{q}_{t}<\\alpha\\cdot\\pmb{c}_{t}-\\beta),\\;\\pmb{q}_{t}\\sim\\mathcal{U}_{p}(0,1),\\;\\pmb{c}_{t}=1-\\frac{t}{T}(1-\\pmb{c})\\},}\\\\ &{N_{p}(\\pmb{w}_{1})<N_{p}(\\pmb{w}_{2})<\\cdots<N_{p}(\\pmb{w}_{T}),}\\end{array}\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "where $T$ is the number of iterations, $\\pmb q_{t}$ is the random variable sampled from $\\mathcal{U}_{p}(0,1)$ , and $N_{p}({\\pmb w}_{t})$ is the number of discarded patches in $\\pmb{w}_{t}$ , approximately equal to $\\mathbb{E}[1-\\alpha\\cdot{\\pmb{c}}_{t}+\\beta)]/(C\\cdot P^{2})$ . ", "page_idx": 5}, {"type": "text", "text": "To be specific, as the iteration $t$ increases, $\\mathbf{}c_{t}$ becomes to $^c$ gradually, and more perturbation patches are discarded such as $N_{p}(\\pmb{w}_{t})<N_{p}(\\pmb{w}_{t+1})$ to prevent the overfitting. In the meanwhile, training samples with varying patterns are fed into the surrogate ViT model for purpose of enhancing the diversity of inputs. On the other hand, the coefficients $\\alpha$ and $\\beta$ can be adjusted correspondingly to guarantee that the strength (i.e., the magnitude) of adversarial perturbations increases step by step, e.g., $\\|\\pmb{w}_{t}\\odot\\pmb{\\delta}_{t}||_{1}\\leq||\\pmb{w}_{t+1}\\bar{\\odot}\\,\\pmb{\\delta}_{t+1}||_{1}$ . For a fair comparison, we also set appropriate values for $\\alpha$ and $\\beta$ to generate progressive sparse masks, ensuring that the total number of discarded patches throughout the training process is greater than or at least equal to that of other methods such as PNA [15]. Thus, we have $\\begin{array}{r}{\\sum_{t=1}^{T}\\mathbb{E}[1-\\alpha\\cdot{\\pmb c}_{t}+\\beta)]/(C\\cdot P^{2})\\ge T\\cdot N_{d p a t c h}}\\end{array}$ , where $T$ is the number of iterations and $N_{d p a t c h}$ is the fixed number of patches discarded by comparison methods per iteration. To summarize, our proposed self-paced patch out effectively integrates self-paced learning into training process and maximizes the adaptive loss function $\\mathcal{L}_{t}=\\dot{\\mathcal{L}}(f(\\bar{\\boldsymbol{x}}+\\delta\\odot\\bar{\\boldsymbol{w_{t}}}),\\boldsymbol{y})$ at each iteration, which can further improve the transferability of crafted adversarial perturbations across various models. ", "page_idx": 5}, {"type": "text", "text": "3.4 Weakening the Effectiveness of Attention Mechanism ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "Feature-based adversarial attacks [26, 29, 33, 34] have shown that not all the features in DNNs contribute positively to the generation of adversarial perturbations, despite their significances in classification tasks. On the other hand, it is demonstrated in previous ViT studies [15, 17] that attention modules in certain ViT layers are redundant for image classification and adversarial perturbation generation, which could cause the overftiting phenomenon. Building upon this, we propose to reduce the impact of some attention modules during the training of adversarial perturbations. ", "page_idx": 5}, {"type": "text", "text": "Truncated Attention Layers. According to [41, 35], shallow layers exploit generic properties of attention. whereas deep layers exploit highly model-specific properties of attention. To mitigate the overfitting caused by excessive global attention, we introduce a hard truncation strategy for deep ViT layers. During back-propagation, we multiply the token gradient gi(l,m)with a truncation factor $\\tau$ for module $m=$ Attention. To be specific, we set $\\tau^{(l,m)}$ to 0 for $l\\,\\in\\,\\{l^{\\prime}+1,\\cdot\\cdot\\cdot,L\\}$ , while setting $\\tau^{(l,m)}$ to non-zero value for $l\\in\\{1,\\cdots,l^{\\prime}\\}$ . As a result, intermediate gradients can be back-propagated to each token individually via skipping attention mechanism, thereby reducing the adversarial perturbation\u2019s dependence on complex interactions between tokens in deep ViT layers. ", "page_idx": 5}, {"type": "text", "text": "Hybrid Token Gradient Truncation. For purpose of effectively balancing the influence of different modules on the perturbation training, we further introduce a hybrid token gradient truncation method to constrain the token gradient in each module $m$ throughout all ViT layers using the predefined set S\u03c4(m)of L truncation factors. For m = Attention, we set S\u03c4(m $\\boldsymbol{S_{\\tau}^{(m)}}=\\{\\tau^{(1,m)},\\cdot\\cdot\\cdot,\\tau^{(l^{\\prime},m)},0,\\cdot\\cdot\\cdot,0\\}$ , where deep ViT layers are processed via the hard truncation $(i.e.,\\tau^{(l,m)}=0,l>l^{\\prime})$ , and shallow ViT layers are processed via the soft truncation $(i.e.,\\tau^{(l,m)}>0,l\\leq l^{\\prime})$ . For either $m=\\mathrm{QKV}$ or $m=\\operatorname{MLP}$ , we set $\\begin{array}{r}{S_{\\tau}^{(m)}=\\{\\tau^{(1,m)},\\cdot\\cdot\\cdot,\\tau^{(l^{\\prime},m)},\\tau^{(l^{\\prime}+1,m)},\\cdot\\cdot\\cdot,\\tau^{(L,m)}\\}}\\end{array}$ , where all the intermediate ViT layers are processed via the soft truncation (i.e., $\\tau^{(l,m)}>0$ , $l\\,\\in\\,\\{1,\\cdots,L\\})$ . In addition to that, for any $l$ -th ViT layer $(1\\leq l\\leq l^{\\prime})$ , by setting $\\tau^{(l,\\mathrm{Attention})}<\\operatorname*{max}(\\tau^{(l,\\mathrm{QKV})},\\tau^{(l,\\mathrm{MLP})})$ between different ViT modules, we can continue to weaken the effectiveness of attention mechanism during the perturbation training process. ", "page_idx": 5}, {"type": "text", "text": "In sections 3.2-3.4, we introduced the details of our proposed adaptive token tuning (ATT) attack method from three perspectives. On the one hand, both variance reduction and hybrid truncation aim to adaptively tune the token gradient throughout the back-propagation path. On the other hand, self-paced patch out focuses on adaptively tuning the token diversity in the input perturbation space. The overall optimization algorithm for training adversarial example is provided in Appendix C. ", "page_idx": 5}, {"type": "text", "text": "4 Experiments ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "We utilized different surrogate models for comparison, demonstrating versatility and effectiveness of our ATT attack. Ablation experiments were conducted to verify the effectiveness of each component of our approach. Additionally, we analyzed experimental results by examining gradient variance and feature information, providing a statistical explanation for the effectiveness of our method. ", "page_idx": 5}, {"type": "text", "text": "4.1 Experiment Setup ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "Dataset. We followed the baseline approach [14] by selecting 1,000 random images from different categories in the ILSVRC2012 [42] validation set. All surrogate models can classify the images in our chosen dataset with near-perfect accuracy. ", "page_idx": 6}, {"type": "text", "text": "Models. We chose four representative ViT models as surrogate models to produce adversarial samples: ViT-B/16 [1], PiT-B [43], CaiTS/24 [44], and Visformer-S [45]. Considering structural differences between ViTs and CNNs, we divided attack scenarios into two categories: attacking ViTs and attacking CNNs. For ViT attack, we used four ViT models as target models to test the transferability of adversarial samples: DeiT-B [46], TNT-S [47], LeViT-256 [48], and ConViT-B [49]. Similarly, we selected four CNN models as target models to verify the transferability of adversarial samples: Inception-v3 (Inc-v3) [50], Inception-v4 (Inc-v4) [51], Inception-ResNet-v2 (IncRes-v2) [51], and ResNet-v2-152 (Res-v2) [52, 53]. To validate the effectiveness against defense models, we further selected three adversarially trained defense models: Inception-v3-ens3 (Inc-v3ens3), Inception-v4-ens4 (Inc-v4ens4), and Inception-ResNet-v2 (IncRes-v2adv) [54, 55]. ", "page_idx": 6}, {"type": "text", "text": "Baseline Methods. Since our approach takes into account the optimization of the gradient, we selected several methods closely related to ours as baselines, including MI-FGSM (MIM) [18], VMI-FGSM (VMI) [24], and SGM [22]. To demonstrate the superiority of our approach over stateof-the-art ViT attacks, we used PNA [15] and TGR [14] for comparison. Our approach also proposes a superior self-paced input diversity method; therefore, we used PatchOut [15] as the baseline. ", "page_idx": 6}, {"type": "text", "text": "Evaluation Metrics. Consistent with the baseline methodology [14], we used the attack success rate (ASR) as the evaluation metric in all transferability comparison experiments. Additionally, we defined the number of iterations that led to the first-time misclassification by the model as $t$ , which we used as a metric for efficiency comparison within a limited training budget $T$ . For ASR, higher values $(\\uparrow)$ indicate better transferability, while for $t$ , lower values (\u2193) indicate better efficiency. ", "page_idx": 6}, {"type": "text", "text": "Parameters. We kept all known parameter settings consistent with [14]. The maximum perturbation amplitude was set to $\\epsilon=16$ , and the number of training iterations was set to $T=10$ , resulting in a step size of $\\begin{array}{r}{\\eta=\\frac{\\epsilon}{T}=1.6}\\end{array}$ for each perturbation update. All comparison methods used momentum as the stabilization update strategy with decay factor $\\mu=1.0$ . Hyperparameters specific to each method were kept the same as those set by original methods. The penultimate ViT layer (i.e., $l=L-1)$ ) is selected to generate patch-level feature importance. We set appropriate values for $\\alpha$ and $\\beta$ to ensure the expected value of the number of discards in our method was greater than or equal to the number of PatchOut discards, where its optimal $N_{d p a t c h}$ is 130. We adjusted the images of the whole dataset to $224\\times224$ and set the patch size to $16\\times16$ . For the adaptive gradient variance reduction strategy, we set the gradient penalty factor to $\\gamma=0.5$ and the adaptive factor to $\\lambda=0.01$ . Truncation factor $\\tau$ is finetuned with appropriate values to balance different modules for each surrogate model. ", "page_idx": 6}, {"type": "text", "text": "4.2 Evaluating the Transferability ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "In this section, we verified the transferability of adversarial perturbations on four ViTs, four undefended CNNs, and three defended CNN models. Specifically, we produced adversarial samples using the four ViT surrogate models, tested the attack success rate on all black-box models, and calculated the average attack success rate across all black-box models (abbreviated as $\\mathrm{Avg}_{b b}$ ). ", "page_idx": 6}, {"type": "text", "text": "Firstly, we focus solely on the ViT attack using \u201cToken Gradient-Based Optimization\u201d. Here, all comparison methods and \u201cOurs\u201d indicate the pure gradient-based attack \u201cWithout Input Diversity Enhancements\u201d. In Table 1, we verified the transferability of our method on ViTs. The experimental results indicated that our method achieved nearly $100\\%$ attack success rate under white-box settings. In addition, the transferability of our method performed significantly better than all other baseline methods, with an average increase of $6.4\\%$ in the attack success rate of black-box models. All baseline methods optimized the gradient and achieved good attack performance, especially TGR, improving the transferability by a large margin. However, TGR directly set the token with the maximum gradient to zero, preventing the perturbation from learning potentially important feature information. In contrast, our method greatly preserved the original feature information while avoiding the overfitting phenomenon caused by excessively large gradients. ", "page_idx": 6}, {"type": "text", "text": "Furthermore, we validated the transferability of our method from ViT models to undefended and defended CNN models. Experimental results on CNN models are shown in Table 2, where the ", "page_idx": 6}, {"type": "table", "img_path": "sNz7tptCH6/tmp/3cd17ca0ebeb60a1667d292477be21bd70a491fc76d8f4e12b6de6e5649807a4.jpg", "table_caption": ["Table 1: The attack success rate $(\\%)$ of various transfer-based attacks against eight ViT models and the average attack success rate $(\\%)$ of all black-box models. The best results are highlighted in bold. "], "table_footnote": [], "page_idx": 7}, {"type": "text", "text": "Table 2: The attack success rate $(\\%)$ of various transfer-based attacks against four undefended CNN models and three defended CNN models and the average attack success rate $(\\%)$ of all black-box models. The best results are highlighted in bold. ", "page_idx": 7}, {"type": "table", "img_path": "sNz7tptCH6/tmp/ef8ea88dd8b7370c2cf384ef6f31a772a97b3bf224039a873b4dc143d17312cd.jpg", "table_caption": [], "table_footnote": [], "page_idx": 7}, {"type": "text", "text": "transferability of all other methods on CNNs was low, but our method significantly outperformed all baselines. The black-box attack success rate increased by an average of $10.5\\%$ , which was higher than the transferability improvement on the ViT model, indicating that our method is more advantageous for cross-model attacks. We analyzed that our method, in addition to avoiding overfitting surrogate models, allowed the perturbation to learn as many features as possible, thus enabling the perturbation to better attack both ViTs and CNN models. Our method achieved the average attack success rate of three surrogate models on CNNs to exceed $60\\%$ , with the highest average attack success rate on the defended CNNs reaching $50.2\\%$ , which poses a serious security threat. Additional attack results against robust ViTs [56, 57, 58] are provided in Appendix D.9 ", "page_idx": 7}, {"type": "text", "text": "Lastly, we further investigated the ViT attack strategy that combined \u201cToken Gradient-based Optimization\u201d with \u201cInput Diversity Enhancement\u201d, where Patch Out (PO) and the proposed Self-Paced ", "page_idx": 7}, {"type": "text", "text": "Table 3: The average attack success rate $(\\%)$ against ViTs, CNNs, and defended CNNs by various transfer-based attacks with input diversity enhancement strategy. The best results are highlighted in bold. \u201cPO\u201d denotes PatchOut and \u201cSPPO\u201d denotes self-paced patch out under semantic guidance. ", "page_idx": 8}, {"type": "table", "img_path": "sNz7tptCH6/tmp/b5f4cea31d4d12fb212e5ba346f9fa3fcebf44829c15fe025f663c431240187e.jpg", "table_caption": [], "table_footnote": [], "page_idx": 8}, {"type": "text", "text": "Patch Out (SPPO) were used as the input diversity enhancement strategy. As a result, we denoted these methods with $\\bullet\\mathbf{+}\\mathbf{PO}^{\\bullet}$ or $^{\\bullet\\bullet}\\!+\\!\\mathrm{SPPO^{\\circ}}$ to indicate that gradient-based attacks were combined \u201cWith PO-based or SPPO-based Input Diversity Enhancement\u201d. As shown in Table 3, the experimental results indicated that our method demonstrated an average improvement of $6.6\\%$ in the black-box average attack success rate against ViTs, CNNs, and defended CNNs (Def-CNNs). When combined with the proposed self-paced patch out, our method exhibited superior attack abilities. Our strategy, which discards perturbation patches under semantic guidance in a self-paced way, proved to be more effective than PatchOut\u2019s random discarding. The success rate of our method\u2019s black-box attacks was further enhanced by $3.5\\%$ when compared to direct utilization of the PatchOut strategy. ", "page_idx": 8}, {"type": "text", "text": "In addition to that, we further conducted cross-task transferability experiments on object detections [59, 60, 61, 62, 63] and semantic segmentations [64, 65, 66] in black-box attack scenarios. Adversarial samples crafted by our approach demonstrated greater aggressiveness than baselines, see Appendix D.6 and D.7. ", "page_idx": 8}, {"type": "text", "text": "4.3 Ablation Study ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "In this section, we performed three sets of ablation studies on the proposed ATT attack. In the subsequent experiments, all methods were compared based on their complete attack strategies. ", "page_idx": 8}, {"type": "text", "text": "Adaptive Factor. We explored the role of the adaptive factor $\\lambda$ in smoothing the gradient variance across different layers of ViT-B. The attention\u2019s gradient is used as a demonstration that similar results can be obtained for other modules. We found that the larger the $\\lambda$ , the more effective the gradient variance smoothing was. However, the results of the transferability experiments showed that smoother gradient variance did not always result in higher transferability. We analyzed that this might be due to excessive gradient variance smoothing leading to changes and loss of feature information. Therefore, to balance performance, we chose $\\lambda=0.01$ . More results are given in Appendix B. ", "page_idx": 8}, {"type": "text", "text": "Attentional Truncation. Considering the differences between models, we conducted experiments on varying the number of truncated ViT layers. In Fig. 5 of Appendix D.2, three models required truncation to achieve better transferability. Visformer-S achieved the best result without truncation, since it is a shallow model, where scaling alone was sufficient to mitigate overftiting in attention mechanism. ", "page_idx": 8}, {"type": "text", "text": "Attacks with Different Module Settings. We conducted ablation experiments using four surrogate models to compute the average attack success rate for ViTs, undefended CNNs, and defended CNNs in black-box setting. Table 4 shows experimental results on the surrogate model ViT-B, where attacking the attention module greatly improved the transferability, and attacking all three modules achieves the best ASR. The rest of the experimental results are shown in the Appendices D.5 and D.8. ", "page_idx": 8}, {"type": "table", "img_path": "sNz7tptCH6/tmp/833b9a73b03fa336f526f8b92b79578edb539fdaeaf7123274b1103be98982ee.jpg", "table_caption": ["Table 4: The average attack success rate $(\\%)$ against ViTs, CNNs, and defended CNNs by our method with different module settings. "], "table_footnote": [], "page_idx": 8}, {"type": "text", "text": "", "page_idx": 8}, {"type": "text", "text": "We utilized ViT-B/16 to generate adversarial examples and retained intermediate results for 10 iterations. Fig. 2 shows the process of discarding perturbation patches for \u201cOurs $^+$ SPPO\u201d versus $\\mathrm{^{\\bullet}T G R+P O^{\\ast}}$ , and the classification results (label and probability). For each iteration, class activation map of adversarial example was generated by GradCAM on CaiT-S/24 with an unlabeled setup. The results showed that our method required only 5 iterations for the model to determine the error, while TGR required 9 iterations. Class activation maps also reflected this change. After 10 iterations, the confidence level of wrong label due to our attack was higher, indicating that our attack was not only more efficient but also stronger. Additionally, considering that each iteration increases a fixed perturbation magnitude, our method required a smaller perturbation to mislead the model. More efficiency results tested in different surrogate models are provided in Appendix D.1 and D.3. ", "page_idx": 9}, {"type": "image", "img_path": "sNz7tptCH6/tmp/eb140480beab60c7aef3945965254baf9657a43e64b49e356f22658e1f058cb8.jpg", "img_caption": ["Figure 2: The attack efficiency of \u201cOurs $^{+}$ SPPO\u201d versus $^{\\;\\leftarrow}\\mathrm{TGR}\\mathrm{+}\\mathrm{PO}^{\\;\\ast}$ . Our ATT attack makes the model predict wrong faster and ends up generating error labels with a higher level of confidence. "], "img_footnote": [], "page_idx": 9}, {"type": "text", "text": "5 Conclusion ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "In this paper, we propose an adaptive token tuning attack method to enhance the transferability of ViT attacks. Unlike previous gradient-based attacks, our method puts more emphasis on smoothing the token gradient variance between different layers and preserving important features along with the back-propagation. Guided by patch-level feature importance, we introduce a self-paced discarding strategy from the perspective of input diversity, where the number of discarded perturbation patches is gradually increased. To further improve transferability, we propose a hybrid truncation strategy to reduce overfitting in the attention mechanism. Extensive experiments show that our adaptive token tuning attack method has superior transferability and efficiency. ", "page_idx": 9}, {"type": "text", "text": "6 Limitations and Broader Impacts ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "Although our experimental results verified the effectiveness of the proposed adaptive token tuning strategy in enhancing the transferability of ViT attacks, the relationship between gradient variance reduction and transferability still lacked theoretical support. Existing research suggested that more generalized feature information could improve perturbation\u2019s transferability, and our work focused on leveraging this by reducing token gradient variance. In future work, we will continue exploring from a theoretical persepctive to provide valuable insights into adversarial attacks. ", "page_idx": 9}, {"type": "text", "text": "If the proposed ATT attack method is maliciously used in real-world applications, it could lead to security concerns, representing one of its potential negative social impacts. Due to the superior performance of pretrained models and the significant time cost associated with training from scratch, many applications opt to fine-tune pretrained models. As a result, this undoubtedly exposes applications to a risky environment vulnerable to attacks. Our research aims to encourage deep learning practitioners to further explore security concerns related to model vulnerabilities, and in return, offering constructive guidance for adversarial defense. ", "page_idx": 9}, {"type": "text", "text": "Acknowledgements ", "text_level": 1, "page_idx": 10}, {"type": "text", "text": "This work is partially supported by the Natural Science Foundation of Chongqing, China (Grant No. CSTB2024NSCQ-MSX0341), the Science and Technology Research Program of Chongqing Municipal Education Commission (Grant No. KJQN202301142), the Scientific Research Foundation of Chongqing University of Technology (Grant No. 2022ZDZ026), Chongqing Education Ministry\u2019s Key Research Base Project for Humanities and Social Sciences (Grant No. 24SKJD134). ", "page_idx": 10}, {"type": "text", "text": "References ", "text_level": 1, "page_idx": 10}, {"type": "text", "text": "[1] Alexey Dosovitskiy, Lucas Beyer, Alexander Kolesnikov, Dirk Weissenborn, Xiaohua Zhai, Thomas Unterthiner, Mostafa Dehghani, Matthias Minderer, Georg Heigold, Sylvain Gelly, Jakob Uszkoreit, and Neil Houlsby. An image is worth 16x16 words: Transformers for image recognition at scale. In International Conference on Learning Representations, 2021.   \n[2] Josh Beal, Eric Kim, Eric Tzeng, Dong Huk Park, Andrew Zhai, and Dmitry Kislyuk. Toward transformer-based object detection. ArXiv, abs/2012.09958, 2020.   \n[3] Nicolas Carion, Francisco Massa, Gabriel Synnaeve, Nicolas Usunier, Alexander Kirillov, and Sergey Zagoruyko. End-to-end object detection with transformers. In European Conference on Computer Vision, volume 16, pages 213\u2013229, 2020. [4] Robin Strudel, Ricardo Garcia, Ivan Laptev, and Cordelia Schmid. Segmenter: Transformer for semantic segmentation. In Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 7262\u20137272, 2021.   \n[5] Fangrui Zhu, Yi Zhu, Li Zhang, Chongruo Wu, Yanwei Fu, and Mu Li. A unified efficient pyramid transformer for semantic segmentation. In Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 2667\u20132677, 2021.   \n[6] Yufei Xu, Jing Zhang, Qiming Zhang, and Dacheng Tao. Vitpose: Simple vision transformer baselines for human pose estimation. In Advances in Neural Information Processing Systems, volume 35, pages 38571\u201338584, 2022.   \n[7] Ian J. Goodfellow, Jonathon Shlens, and Christian Szegedy. Explaining and harnessing adversarial examples. In International Conference on Learning Representations, 2015.   \n[8] Jiakai Wang, Aishan Liu, Zixin Yin, Shunchang Liu, Shiyu Tang, and Xianglong Liu. Dual attention suppression attack: Generate adversarial camouflage in physical world. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, 2021.   \n[9] Kai Chen, Zhipeng Wei, Jingjing Chen, Zuxuan Wu, and Yu-Gang Jiang. Attacking video recognition models with bullet-screen comments. In Proceedings of the AAAI Conference on Artificial Intelligence, volume 36, pages 312\u2013320, 2022.   \n[10] Zhipeng Wei, Jingjing Chen, Xingxing Wei, Linxi Jiang, Tat-Seng Chua, Fengfeng Zhou, and Yu-Gang Jiang. Heuristic black-box adversarial attacks on video recognition models. In Proceedings of the AAAI Conference on Artificial Intelligence, volume 34, pages 12338\u201312345, 2020.   \n[11] Zihan Liu, Yun Luo, Lirong Wu, Zicheng Liu, and Stan Z Li. Towards reasonable budget allocation in untargeted graph structure attacks via gradient debias. In Advances in Neural Information Processing Systems, 2022.   \n[12] Zihan Liu, Yun Luo, Zelin Zang, and Stan Z Li. Surrogate representation learning with isometric mapping for gray-box graph adversarial attacks. In Proceedings of the ACM International Conference on Web Search and Data Mining, pages 591\u2013598, 2022.   \n[13] Weibin Wu, Hui Xu, Sanqiang Zhong, Michael R Lyu, and Irwin King. Deep validation: Toward detecting real-world corner cases for deep neural networks. In Proceedings of the IEEE/IFIP International Conference on Dependable Systems and Networks, pages 125\u2013137, 2019.   \n[14] Jianping Zhang, Yizhan Huang, Weibin Wu, and Michael R Lyu. Transferable adversarial attacks on vision transformers with token gradient regularization. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 16415\u201316424, 2023.   \n[15] Zhipeng Wei, Jingjing Chen, Micah Goldblum, Zuxuan Wu, Tom Goldstein, and Yu-Gang Jiang. Towards transferable adversarial attacks on vision transformers. In Proceedings of the AAAI Conference on Artificial Intelligence, volume 36, pages 2668\u20132676, 2022.   \n[16] Cihang Xie, Zhishuai Zhang, Yuyin Zhou, Song Bai, Jianyu Wang, Zhou Ren, and Alan L. Yuille. Improving transferability of adversarial examples with input diversity. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 2730\u20132739, June 2019.   \n[17] Sihao Lin, Pumeng Lyu, Dongrui Liu, Tao Tang, Xiaodan Liang, Andy Song, and Xiaojun Chang. Mlp can be a good transformer learner. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, 2024.   \n[18] Yinpeng Dong, Fangzhou Liao, Tianyu Pang, Hang Su, Jun Zhu, Xiaolin Hu, and Jianguo Li. Boosting adversarial attacks with momentum. In Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition, pages 9185\u20139193, 2018.   \n[19] Xiaosen Wang, Jiadong Lin, Han Hu, Jingdong Wang, and Kun He. Boosting adversarial transferability through enhanced momentum. In British Machine Vision Conference, 2021.   \n[20] Jiadong Lin, Chuanbiao Song, Kun He, Liwei Wang, and John E. Hopcroft. Nesterov accelerated gradient and scale invariance for adversarial attacks. In International Conference on Learning Representations, 2020.   \n[21] Alexey Kurakin, Ian Goodfellow, and Samy Bengio. Adversarial examples in the physical world. In International Conference on Learning Representations, 2017.   \n[22] Dongxian Wu, Yisen Wang, Shu-Tao Xia, James Bailey, and Xingjun Ma. Skip connections matter: On the transferability of adversarial examples generated with resnets. In International Conference on Learning Representations, 2020.   \n[23] Wang Xiaosen, Kangheng Tong, and Kun He. Rethinking the backward propagation for adversarial transferability. In Advances in Neural Information Processing Systems, volume 36, pages 1905\u20131922, 2023.   \n[24] Xiaosen Wang and Kun He. Enhancing the transferability of adversarial attacks through variance tuning. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 1924\u20131933, 2021.   \n[25] Yifeng Xiong, Jiadong Lin, Min Zhang, John E. Hopcroft, and Kun He. Stochastic variance reduced ensemble adversarial attack for boosting the adversarial transferability. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR), pages 14983\u201314992, June 2022.   \n[26] Zhibo Wang, Hengchang Guo, Zhifei Zhang, Wenxin Liu, Zhan Qin, and Kui Ren. Feature importance-aware transferable adversarial attacks. In Proceedings of the IEEE/CVF International Conference on Computer Vision (ICCV), pages 7639\u20137648, October 2021.   \n[27] Aditya Ganeshan, Vivek B.S., and R. Venkatesh Babu. Fda: Feature disruptive attack. In Proceedings of the IEEE/CVF International Conference on Computer Vision (ICCV), pages 8069\u20138079, October 2019.   \n[28] Yi Huang and Adams Wai-Kin Kong. Transferable adversarial attack based on integrated gradients. In International Conference on Learning Representations, 2022.   \n[29] Jianping Zhang, Weibin Wu, Jen-tse Huang, Yizhan Huang, Wenxuan Wang, Yuxin Su, and Michael R Lyu. Improving adversarial transferability via neuron attribution-based attacks. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 14993\u201315002, 2022.   \n[30] Xiaoyi Dong, Jiangfan Han, Dongdong Chen, Jiayang Liu, Huanyu Bian, Zehua Ma, Hongsheng Li, Xiaogang Wang, Weiming Zhang, and Nenghai Yu. Robust superpixel-guided attentional adversarial attack. In Proceedings of the IEEE Conference on Computer Vision Pattern Recognition, pages 12892\u201312901, 2020.   \n[31] Qilong Zhang, Xiaodan Li, Yuefeng Chen, Jingkuan Song, Lianli Gao, Yuan He, and Hui Xue. Beyond imagenet attack: Towards crafting adversarial examples for black-box domains. In International Conference on Learning Representations, 2022.   \n[32] Di Ming, Ren Peng, Yunlong Wang, and Xin Feng. Transferable structural sparse adversarial attack via exact group sparsity training. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR), pages 24696\u201324705, June 2024.   \n[33] Yuanhao Ban and Yinpeng Dong. Pre-trained adversarial perturbations. In Advances in Neural Information Processing Systems, volume 35, pages 1196\u20131209, 2022.   \n[34] Yiran Liu, Xin Feng, Yunlong Wang, Wu Yang, and Di Ming. Trm-uap: Enhancing the transferability of data-free universal adversarial perturbation via truncated ratio maximization. In Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 4739\u2013 4748, 2023.   \n[35] Muzammal Naseer, Kanchana Ranasinghe, Salman Khan, Fahad Shahbaz Khan, and Fatih Porikli. On improving adversarial transferability of vision transformers. In International Conference on Learning Representations, 2022.   \n[36] Jianping Zhang, Yizhan Huang, Zhuoer Xu, Weibin Wu, and Michael R. Lyu. Improving the adversarial transferability of vision transformers with virtual dense connection. In Proceedings of the AAAI Conference on Artificial Intelligence, pages 7133\u20137141, 2024.   \n[37] Chenxing Gao, Hang Zhou, Junqing Yu, YuTeng Ye, Jiale Cai, Junle Wang, and Wei Yang. Attacking transformers with feature diversity adversarial perturbation. In Proceedings of the AAAI Conference on Artificial Intelligence, volume 38, pages 1788\u20131796, 2024.   \n[38] Yang You, Jing Li, Sashank Reddi, Jonathan Hseu, Sanjiv Kumar, Srinadh Bhojanapalli, Xiaodan Song, James Demmel, Kurt Keutzer, and Cho-Jui Hsieh. Large batch optimization for deep learning: Training bert in 76 minutes. In International Conference on Learning Representations, 2020.   \n[39] Zeyue Xue, Jianming Liang, Guanglu Song, Zhuofan Zong, Liang Chen, Yu Liu, and Ping Luo. Large-batch optimization for dense visual predictions: Training faster r-cnn in 4.2 minutes. In Advances in Neural Information Processing Systems, volume 35, pages 18694\u201318706, 2022.   \n[40] Ramprasaath R. Selvaraju, Abhishek Das, Ramakrishna Vedantam, Michael Cogswell, Devi Parikh, and Dhruv Batra. Grad-cam: Visual explanations from deep networks via gradient-based localization. International Journal of Computer Vision, 128:336\u2013359, 2016.   \n[41] Jason Yosinski, Jeff Clune, Yoshua Bengio, and Hod Lipson. How transferable are features in deep neural networks? In Advances in Neural Information Processing Systems, volume 27, 2014.   \n[42] Olga Russakovsky, Jia Deng, Hao Su, Jonathan Krause, Sanjeev Satheesh, Sean Ma, Zhiheng Huang, Andrej Karpathy, Aditya Khosla, Michael Bernstein, et al. Imagenet large scale visual recognition challenge. International Journal of Computer Vision, 115(3):211\u2013252, 2015.   \n[43] Byeongho Heo, Sangdoo Yun, Dongyoon Han, Sanghyuk Chun, Junsuk Choe, and Seong Joon Oh. Rethinking spatial dimensions of vision transformers. In Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 11936\u201311945, 2021.   \n[44] Hugo Touvron, Matthieu Cord, Alexandre Sablayrolles, Gabriel Synnaeve, and Herv\u00e9 J\u00e9gou. Going deeper with image transformers. In Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 32\u201342, 2021.   \n[45] Zhengsu Chen, Lingxi Xie, Jianwei Niu, Xuefeng Liu, Longhui Wei, and Qi Tian. Visformer: The vision-friendly transformer. In Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 589\u2013598, 2021.   \n[46] Hugo Touvron, Matthieu Cord, Matthijs Douze, Francisco Massa, Alexandre Sablayrolles, and Herv\u00e9 J\u00e9gou. Training data-efficient image transformers & distillation through attention. In Proceedings of the International Conference on Machine Learning, pages 10347\u201310357. PMLR, 2021.   \n[47] Kai Han, An Xiao, Enhua Wu, Jianyuan Guo, Chunjing Xu, and Yunhe Wang. Transformer in transformer. In Advances in Neural Information Processing Systems, volume 34, pages 15908\u201315919, 2021.   \n[48] Benjamin Graham, Alaaeldin El-Nouby, Hugo Touvron, Pierre Stock, Armand Joulin, Herv\u00e9 J\u00e9gou, and Matthijs Douze. Levit: a vision transformer in convnet\u2019s clothing for faster inference. In Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 12259\u2013 12269, 2021.   \n[49] St\u00e9phane d\u2019Ascoli, Hugo Touvron, Matthew L Leavitt, Ari S Morcos, Giulio Biroli, and Levent Sagun. Convit: Improving vision transformers with soft convolutional inductive biases. In Proceedings of the International Conference on Machine Learning, pages 2286\u20132296. PMLR, 2021.   \n[50] Christian Szegedy, Vincent Vanhoucke, Sergey Ioffe, Jon Shlens, and Zbigniew Wojna. Rethinking the inception architecture for computer vision. In Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition, pages 2818\u20132826, 2016.   \n[51] Christian Szegedy, Sergey Ioffe, Vincent Vanhoucke, and Alexander A Alemi. Inception-v4, inception-resnet and the impact of residual connections on learning. In Proceedings of the AAAI conference on Artificial Intelligence, pages 4278\u20134284, 2017.   \n[52] Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun. Deep residual learning for image recognition. In Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition, pages 770\u2013778, 2016.   \n[53] Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun. Identity mappings in deep residual networks. In European Conference on Computer Vision, pages 630\u2013645. Springer, 2016.   \n[54] Aleksander Madry, Aleksandar Makelov, Ludwig Schmidt, Dimitris Tsipras, and Adrian Vladu. Towards deep learning models resistant to adversarial attacks. In International Conference on Learning Representations, 2018.   \n[55] Zhuoer Xu, Guanghui Zhu, Changhua Meng, Shiwen Cui, Zhenzhe Ying, Weiqiang Wang, Gu Ming, and Yihua Huang. A2: Efficient automated attacker for boosting adversarial training. In Advances in Neural Information Processing Systems, 2021.   \n[56] Yutong Bai, Jieru Mei, Alan L Yuille, and Cihang Xie. Are transformers more robust than cnns? In M. Ranzato, A. Beygelzimer, Y. Dauphin, P.S. Liang, and J. Wortman Vaughan, editors, Advances in Neural Information Processing Systems, volume 34, pages 26831\u201326843. Curran Associates, Inc., 2021.   \n[57] Yichuan Mo, Dongxian Wu, Yifei Wang, Yiwen Guo, and Yisen Wang. When adversarial training meets vision transformers: Recipes from training to architecture. In Advances in Neural Information Processing Systems, volume 35, pages 18599\u201318611, 2022.   \n[58] Edoardo Debenedetti, Vikash Sehwag, and Prateek Mittal. A light recipe to train robust vision transformers. In 2023 IEEE Conference on Secure and Trustworthy Machine Learning (SaTML), pages 225\u2013253, 2023.   \n[59] Shaoqing Ren, Kaiming He, Ross Girshick, and Jian Sun. Faster r-cnn: Towards real-time object detection with region proposal networks. In Advances in Neural Information Processing Systems, volume 28, 2015.   \n[60] Kaiming He, Georgia Gkioxari, Piotr Doll\u00e1r, and Ross Girshick. Mask r-cnn. In Proceedings of the IEEE International Conference on Computer Vision, pages 2980\u20132988, 2017.   \n[61] Wei Liu, Dragomir Anguelov, Dumitru Erhan, Christian Szegedy, Scott Reed, Cheng-Yang Fu, and Alexander C Berg. Ssd: Single shot multibox detector. In European Conference on Computer Vision, pages 21\u201337, 2016.   \n[62] Tsung-Yi Lin, Priya Goyal, Ross B. Girshick, Kaiming He, and Piotr Doll\u00e1r. Focal loss for dense object detection. In Proceedings of the IEEE International Conference on Computer Vision, pages 2999\u20133007, 2017.   \n[63] Zhi Tian, Chunhua Shen, Hao Chen, and Tong He. Fcos: Fully convolutional one-stage object detection. Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 9626\u20139635, 2019.   \n[64] Evan Shelhamer, Jonathan Long, and Trevor Darrell. Fully convolutional networks for semantic segmentation. IEEE Transactions on Pattern Analysis and Machine Intelligence, 39:640\u2013651, 2017.   \n[65] Liang-Chieh Chen, George Papandreou, Florian Schroff, and Hartwig Adam. Rethinking atrous convolution for semantic image segmentation. ArXiv, abs/1706.05587, 2017.   \n[66] Andrew Howard, Mark Sandler, Bo Chen, Weijun Wang, Liang-Chieh Chen, Mingxing Tan, Grace Chu, Vijay Vasudevan, Yukun Zhu, Ruoming Pang, Hartwig Adam, and Quoc Le. Searching for mobilenetv3. In Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 1314\u20131324, 2019. ", "page_idx": 10}, {"type": "text", "text": "", "page_idx": 11}, {"type": "text", "text": "", "page_idx": 12}, {"type": "text", "text": "", "page_idx": 13}, {"type": "text", "text": "", "page_idx": 14}, {"type": "text", "text": "Appendix ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "A The Analysis of the Variance of Token Gradients in ViT Layers ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "Based on the TGR [14] method\u2019s assumption that channels in the ViT module are independent, we can analyze the variance of token gradient in a single channel, which can then be applied repeatedly to all remaining channels within each module. In the following derivations, we replace $\\pmb{g}^{(l,m)}[c]$ in $c$ -th channel $(c=1,\\cdot\\cdot\\cdot,C)$ with $\\textbf{\\textit{g}}$ for notational simplicity. Without loss of generality, the number of token gradients in each module $m$ is represented by $n$ . Thus, $\\textbf{\\textit{g}}$ is defined in the $\\mathbb{R}^{n}$ space. Since the scales of different token gradients vary significantly, we can assume that the largest token gradient (either before or after re-scaling) is far beyond the expectation of token gradients, i.e., $\\operatorname*{max}(g)>0$ , $\\operatorname*{max}(g)\\gg\\mathbb{E}[g]$ , and $\\gamma\\cdot\\operatorname*{max}(\\bar{\\pmb{g}})\\gg\\mathbb{E}[\\pmb{g}]$ with $\\gamma\\in(\\bar{0},1)$ . ", "page_idx": 15}, {"type": "text", "text": "Theorem 1. Given the token gradients $\\pmb{g}=[g_{1},\\cdot\\cdot\\cdot,g_{n}]$ and the scaling factor $\\gamma\\in(0,1)$ , the variance of token gradients $V a r(g)$ is reduced after re-scaling the largest token gradient by $g_{j}=\\gamma\\cdot g_{j}$ , where $j=\\arg\\operatorname*{max}_{i\\in\\{1,\\cdots,n\\}}g_{i}$ . ", "page_idx": 15}, {"type": "text", "text": "Proof of Theorem 1. Based on the predefined re-scaling operation on the largest token gradient, we define an auxiliary variable $\\widetilde{\\pmb{g}}=[\\widetilde{\\widetilde{g}}_{1},\\cdot\\cdot\\cdot,\\widetilde{g}_{n}]$ , where $\\widetilde{g}_{i}=\\gamma\\cdot g_{i}$ for $i=j$ , and $\\widetilde{g}_{i}=g_{i}$ for $i\\neq j$ . After re-scaling the largest token   gradi ent by $\\widetilde{g}_{j}=\\gamma\\cdot g_{j}$ ,  we can rewrite the varian c e of the auxiliary gradient variable $\\widetilde g$ equivalently as follows: ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\begin{array}{l l l}{\\mathrm{Var}(\\widetilde{g})\\!}&{=}&{\\displaystyle\\mathbb{E}[\\widetilde{g}^{2}]-(\\mathbb{E}[\\widetilde{g}])^{2}}\\\\ &{=}&{\\displaystyle\\frac{1}{n}\\Big(\\sum_{i=1}^{n}g_{i}^{2}+\\gamma^{2}\\cdot g_{j}^{2}\\Big)-\\Big[\\frac{1}{n}\\big(\\sum_{i=1}^{n}g_{j}+\\gamma\\cdot g_{j}\\big)\\Big]^{2}}\\\\ &{=}&{\\displaystyle\\frac{1}{n}\\Big[\\sum_{i=1}^{n}g_{i}^{2}-(1-\\gamma^{2})\\cdot g_{j}^{2}\\Big]-\\Big(\\frac{1}{n}\\sum_{i=1}^{n}g_{j}-\\frac{1-\\gamma}{n}\\cdot g_{j}\\Big)^{2}}\\\\ &{=}&{\\displaystyle\\mathbb{E}[g^{2}]-(\\mathbb{E}[g])^{2}-\\underbrace{\\Big(\\frac{1-\\gamma}{n}\\cdot g_{j}\\Big)\\Big[(1+\\gamma)\\cdot g_{j}+\\frac{1-\\gamma}{n}\\cdot g_{j}-2\\mathbb{E}[g]\\Big]}_{\\Delta}.}\\end{array}}\\end{array}\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "On the other hand, we have the following inequalities that $g_{j}\\gg\\mathbb{E}[g]$ and $\\gamma\\cdot g_{j}\\geq\\mathbb{E}[g]$ since $g_{j}$ is an outlier (i.e., largest) value from the original distribution of token gradients. As a result, we can obtain that $\\widetilde{g}_{j}\\geq\\mathbb{E}[\\widetilde{g}]$ , since $\\widetilde{g}_{j}=\\gamma\\cdot g_{j}\\geq\\mathbb{E}[\\pmb{g}]\\geq\\mathbb{E}[\\pmb{\\tilde{g}}]$ . ", "page_idx": 15}, {"type": "text", "text": "Then, the third term $\\Delta$ in the last row of Eq. 5 can be rewritten equivalently as: ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{\\Delta\\ =\\ }&{\\!\\Big(\\displaystyle\\frac{1-\\gamma}{n}\\cdot g_{j}\\Big)\\Big[\\big(g_{j}-\\mathbb{E}[g]\\big)+\\Big(\\gamma\\cdot g_{j}+\\displaystyle\\frac{(1-\\gamma)}{n}\\cdot g_{j}-\\mathbb{E}[g]\\Big)\\Big]}\\\\ {\\ =\\ }&{\\!\\Big(\\displaystyle\\frac{1-\\gamma}{n}\\cdot g_{j}\\Big)\\Big[\\big(g_{j}-\\mathbb{E}[g]\\big)+\\big(\\widetilde{g}_{j}-\\mathbb{E}[\\widetilde{g}]\\big)\\Big]\\geq0,}\\end{array}\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "where $g_{j}\\geq0$ and $1-\\gamma\\geq0$ . ", "page_idx": 15}, {"type": "text", "text": "Combining Eq. 5 and Eq. 6 together, we can obtain the following inequality between the original variance and the variance after re-scaling token gradients: ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\mathrm{Var}(\\widetilde g)=\\mathrm{Var}(g)-\\Delta\\leq\\mathrm{Var}(g),\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "which completes the proof. ", "page_idx": 15}, {"type": "text", "text": "For QKV and MLP modules, we can re-scale the largest token gradient in each channel to reduce the overall gradient variance according to Theorem 1. For Attention module, we found out that the largest token gradient is highly correlated with other extreme token gradients. We define $\\boldsymbol{S}$ as the set of extreme token gradients and its size is $|S|=n^{\\prime}\\ll n$ , where $\\boldsymbol{S}$ includes the largest token gradient $g_{j}$ and its correlated extreme token gradients at the same row or the same column. Thus, we can also assume that all the token gradients in $\\boldsymbol{S}$ are far beyond the expectation of token gradients, i.e., $g_{j}>0$ , $g_{j}\\gg\\mathbb{E}[g]$ , and $\\gamma\\cdot g_{j}\\geq\\mathbb{E}[g]$ for $j\\in S$ . ", "page_idx": 15}, {"type": "text", "text": "Lemma 2. Given the token gradients $\\pmb{g}=[g_{1},\\cdot\\cdot\\cdot,g_{n}]$ and the scaling factor $\\gamma\\in(0,1)$ , the variance of token gradients $V a r(g)$ is reduced after re-scaling all the extreme token gradients in the set $\\boldsymbol{S}$ by $g_{j}=\\gamma\\cdot g_{j}$ , where $j\\in S$ and $|S|=n^{\\prime}\\ll n$ . ", "page_idx": 16}, {"type": "text", "text": "Proof of Lemma 2. In the following, the token gradients in the set $\\boldsymbol{S}$ are re-scaled one by one $w.r t$ . their descending order $\\scriptscriptstyle\\mathcal{O}$ , i.e., $g_{\\mathcal{O}_{1}}\\geq\\cdots\\geq g_{\\mathcal{O}_{n^{\\prime}}}$ . For each index ${\\mathcal{O}}_{j}$ , we define an auxiliary gradient variableg(j) and its corresponding index set $\\boldsymbol{S^{(j)}}=\\{\\mathcal{O}_{1},\\cdot\\cdot\\cdot,\\mathcal{O}_{j}\\}$ , where $\\widetilde{g}_{i}^{(j)}=\\gamma\\cdot g_{i}$ for $i\\in S^{(j)}$ and $\\widetilde{g}_{i}^{(j)}=g_{i}$ for $i\\not\\in{\\cal S}^{(j)}$ . For any two consecutive indices ${\\mathcal{O}}_{j}$ and ${\\mathcal{O}}_{j+1}$ , the relationships between gradients and their expectations are $\\widetilde{g}_{\\mathcal{O}_{j}}\\geq\\mathbb{E}[\\widetilde{\\pmb{g}}^{(j)}]$ and $\\widetilde{g}_{\\mathcal{O}_{j+1}}\\geq\\mathbb{E}[\\widetilde{\\pmb{g}}^{(j+1)}]$ ", "page_idx": 16}, {"type": "text", "text": "According to Theorem 1, we have the following inequality of variances before and after re-scaling $\\widetilde{g}_{\\mathcal{O}_{j+1}}^{(j+1)}=\\boldsymbol{\\gamma}\\cdot\\widetilde{g}_{\\mathcal{O}_{j+1}}^{(j)}$ , i.e., $\\operatorname{Var}(\\widetilde g^{(j+1)})\\,\\le\\,\\operatorname{Var}(\\widetilde g^{(j)})$ . By setting $\\widetilde{\\pmb g}^{(0)}=\\pmb g$ and iteratively re-scaling token gradients in the set $\\boldsymbol{S}$ using the descending order $\\scriptscriptstyle\\mathcal{O}$ , the following inequality can be obtained: ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\operatorname{Var}(g)=\\operatorname{Var}({\\widetilde{g}}^{(0)})\\geq\\operatorname{Var}({\\widetilde{g}}^{(1)})\\geq\\dots\\geq\\operatorname{Var}({\\widetilde{g}}^{(n^{\\prime}-1)})\\geq\\operatorname{Var}({\\widetilde{g}}^{(n^{\\prime})})=\\operatorname{Var}({\\widetilde{g}}),\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "where $\\widetilde{g}_{i}\\,=\\,\\gamma\\cdot g_{i}$ for $i\\in S$ and $\\widetilde{g}_{i}\\,=\\,g_{i}$ for $i\\not\\in{\\cal S}$ . As a result, we have $\\operatorname{Var}({\\widetilde{g}})\\leq\\operatorname{Var}(g)$ re-scal i ng all the $n^{\\prime}$ largest token  g radients in the set $\\boldsymbol{S}$ , which completes the proo f. ", "page_idx": 16}, {"type": "text", "text": "Based on Lemma 2, we can re-scale the set $\\boldsymbol{S}$ of extreme token gradients in each channel to reduce the overall gradient variance for Attention module. As a result, by combining Theorem 1 and Lemma 2, we theoretically verify the effectiveness of our mild re-scaling strategy that the overall gradient variance can be reduced for all the modules in ViT layers. ", "page_idx": 16}, {"type": "text", "text": "B The Analysis of Adaptive Variance Reduced Token Gradient ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "It is demonstrated in Fig. 3a that the variance of token gradients after re-scaling was reduced greatly compared to the variance of original token gradients. Additionally, by adaptively re-scaling the token gradient, the variances throughout ViT layers became more smoother with the increase of the value of $\\lambda$ , as shown in Fig. 3b. Thus, the proposed adaptive variance reduced token gradient method was more effective than the one of re-scaling the token gradient with a fixed constant value. ", "page_idx": 16}, {"type": "image", "img_path": "sNz7tptCH6/tmp/207daf30097e2084687a1313de296915319a7332c477bf65b1230a4dec54c363.jpg", "img_caption": ["(b) Comparison of different values of $\\lambda$ . "], "img_footnote": [], "page_idx": 16}, {"type": "image", "img_path": "sNz7tptCH6/tmp/a7d3dfbc685935d89da37ef4790a035f71d45e62dc94bfdbba1bd722119996e1.jpg", "img_caption": ["(a) Comparison of original and re-scaled gradients ", "Figure 3: The analysis of adaptive variance reduced token gradient with different parameter settings. "], "img_footnote": [], "page_idx": 16}, {"type": "text", "text": "C The Overall Framework of Optimization Algorithm ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "In section 3, we present the details of the proposed adaptive token tuning (ATT) method from three perspectives, towards training transferable adversarial examples on ViT models. ", "page_idx": 16}, {"type": "text", "text": "At each iteration, during the feed-forward process, self-paced patch out method is applied to randomly discard a portion of adversarial perturbations via the semantic guided sparse mask. Following this, the adaptive loss function and its gradient are calculated based on the input pair (i.e., the crafted adversarial example and the ground truth label). On the other hand, during the back-propagation process, we first truncate token gradient in a hybrid mode to weaken the effectiveness of attention mechanism, and then adaptively re-scale the set of extreme token gradients to reduce the overall gradient variance for each module throughout ViT layers. ", "page_idx": 16}, {"type": "text", "text": "The overall optimization algorithm is summarized in Algorithm 1. In line11, we adaptively re-scale the largest token gradient (i.e., $|{\\cal S}|=1;$ ) for MLP or QKV module and the set $\\boldsymbol{S}$ of extreme token gradients for Attention module respectively. ", "page_idx": 17}, {"type": "text", "text": "Algorithm 1 Adversarial Attack on ViTs with Adaptive Token Tuning (ATT)   \nInput: clean image $\\textbf{\\em x}$ with its ground truth label $y$ , surrogate model $f$ , loss function $\\mathcal{L}$ , maximum perturbation bound $\\epsilon$ , maximum iteration number $T$ , total number of network layers $L$ , gradient penalty factor $\\gamma$ , adaptive factor $\\lambda$ , scaling and offset factors $\\alpha$ , $\\beta$ , truncation factor $\\tau$   \nOutput: xadv   \n1: Initialize $\\delta_{0}={\\bf0}$   \n2: Set $\\begin{array}{r}{\\eta=\\frac{\\epsilon}{T}}\\end{array}$   \n3: Compute the patch-level feature importance $^c$   \n4: for $t=1$ to $T$ do   \n5: Generate the progressive sparse mask $\\pmb{w}_{t}$ via Eq. 4   \n6: Compute the loss function $\\mathcal{L}_{t}=\\mathcal{L}\\big(f(\\pmb{x}+\\delta_{t-1}\\odot\\pmb{w}_{t}),y\\big)$   \n7: Back-propagate the gradient $\\nabla\\mathcal{L}_{t}$   \n8: for $l=L$ to 1 do   \n9: for $m\\in\\{$ {Attention, MLP, QKV} do   \n10: Truncate the token gradients $\\bar{\\pmb{g}^{(l,m)}}$ by $\\tau^{(l,m)}$   \n11: Adaptively re-scale the set $\\boldsymbol{S}$ of extreme token gradients via Eq. 2   \n12: end for   \n13: end for   \n14: Update adversarial perturbation $\\delta_{t}=\\delta_{t-1}+\\eta\\cdot\\mathrm{sgn}(\\nabla_{\\delta}\\mathcal{L}_{t})$   \n15: end for   \n16: Generate adversarial example ${\\pmb x}_{a d v}=\\operatorname*{max}(\\operatorname*{min}({\\pmb x}+\\delta_{T},255),0)$   \n17: return xadv ", "page_idx": 17}, {"type": "text", "text": "D Additional Experiments ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "D.1 Comparison of Attack Efficiency between Different Methods ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "Tables 5-6 demonstrated the attack efficiency of different methods on ViTs, CNNs, and defended CNNs. To effectively evaluate the attack efficiency during the perturbation training, we calculated the average of the number of iterations that lead to the first-time misclassification by the model across the entire dataset, defined as $t_{a v g}=(1/|D|)\\cdot\\textstyle\\sum_{i=1}^{|D|}t_{i}$ where $|D|$ represents the total number of test data samples in the dataset $D$ . Compared to s tate-of-the-art methods, experimental results showed that the attack efficiency of our ATT method is the highest in all black-box settings. In Fig. 4, we showed the attack efficiency of different methods in another way, where the subtitle represented the surrogate model and the $x$ -axis represented the target model (total 15 models; $0\\sim7$ are ViTs; $8\\sim14$ are CNNs). It can be clearly seen that all methods were significantly less efficient against CNNs, which was consistent with the above-mentioned experimental results presented by ASR $(\\%)$ . ", "page_idx": 17}, {"type": "text", "text": "D.2 The Analysis of Truncating Attention Module ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "Inspired by [17], we considered the possible redundancy of the attention module, which could lead to perturbation overfitting in the surrogate ViT model. Thus, we adopted a truncation strategy to discard part of the attention layer. The corresponding number of truncation layers is chosen based on the best ASR, as shown in Fig. 5, where we conducted the analysis on four surrogate ViT models. Due to differences in network structures, the shallow models (e.g., Visformer-S) obtained the best performance without applying truncation, while the deep models (e.g., PiT-B, CaiT-S/24, Visformer-S) required truncation at varying levels. ", "page_idx": 17}, {"type": "text", "text": "Without loss of generality, we set all the non-zero truncation factors of each module to the same value. Additionally, to ensure the effectiveness of hybrid truncation, we first normalized the token gradients of Attention, QKV, and MLP modules to approximately same order of magnitude, i.e., $\\bar{||}\\pmb{g}^{(l,m)}||_{2}/(C H W)$ . Then, according to the normalized values, we adjusted the truncation factors to let MLP and QKV modules dominate the back-propagated token gradients and weaken the impact of Attention module on updating the perturbation. ", "page_idx": 17}, {"type": "table", "img_path": "sNz7tptCH6/tmp/2307617d79930f137ea5d3e16e5040883cfd577c2130b9131610a6b33886960c.jpg", "table_caption": ["Table 5: Comparison of attack efficiency of different methods on ViTs. "], "table_footnote": [], "page_idx": 18}, {"type": "table", "img_path": "sNz7tptCH6/tmp/5964a67cc0014e81ede96d1c66dfe974bd22e8073022073a012780972e1e7fa7.jpg", "table_caption": ["Table 6: Comparison of attack efficiency of different methods on CNNs and defended CNNs. "], "table_footnote": [], "page_idx": 18}, {"type": "image", "img_path": "sNz7tptCH6/tmp/c641bf47f3a8324ea20bfab8f2e77ffc2edc204ef4b4d6a0eb7c39246e36dd01.jpg", "img_caption": ["Figure 4: Comparison of attack efficiency of different methods on ViTs, CNNs, and defended CNNs. "], "img_footnote": [], "page_idx": 18}, {"type": "image", "img_path": "sNz7tptCH6/tmp/e8339b7af042a6eed802ad80286bc08fba45cc2449c8c4d021fad2577a8f6540.jpg", "img_caption": ["Figure 5: Comparison of ASR $(\\%)$ of our ATT method with different number of truncated layers. "], "img_footnote": [], "page_idx": 19}, {"type": "text", "text": "D.3 Additional Analysis of Attack\u2019s Effectiveness and Efficiency ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "We illustrated Fig. 2 more specifically, and in Fig. 6 we visualized class activation maps guided by correct and incorrect labels. It could be clearly seen that, during iterative training, adversarial perturbations gradually allowed the feature information of the correct label to be corrupted, while generating the feature information of the incorrect label. Compared to other methods, our ATT method successfully disrupted the model more effectively (i.e., higher confidence level) and more efficiently (i.e., fewer iteration number). In this figure, it was observed that for the correctly labeled class activation map, the important regions were not exactly in the classification target region, which was obviously a distribution problem incurred by the dataset and the model. This also provoked us to think that a good model should try to avoid classification errors due to background changes, but this did not seem to be achievable on this type of image or model. We believed that a more comprehensive dataset should include the case where the classification target remained the same but the background changed, so that the model could recognize the classification target more accurately. ", "page_idx": 19}, {"type": "image", "img_path": "sNz7tptCH6/tmp/14abf2d493517e08f051df7ba1412cd04d076d12b593686dd24d18cb2224902d.jpg", "img_caption": ["Figure 6: Class activation maps guided by correct label (top) and incorrect label (bottom). "], "img_footnote": [], "page_idx": 19}, {"type": "text", "text": "D.4 Comparison of Class Activation Maps in Intermediate Attack Processes ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "In Figs. 7, we further showed class activation maps of adversarial examples in intermediate attack processes, trained by different surrogate models. We used a pseudo label (i.e., the label of maximum probability) to guide the generation of class activation maps. Compared to $\\mathbf{\\nabla}^{\\bullet}\\mathbf{P}\\mathbf{N}\\mathbf{A}\\mathbf{+}\\mathbf{P}\\mathbf{O}^{\\bullet\\bullet}$ and \u201cTGR+PO\u201d, our ATT method achieves higher attack efficiency and effectiveness. ", "page_idx": 19}, {"type": "image", "img_path": "sNz7tptCH6/tmp/514f77573924193d50105aaad35b99ef2987f56a767f6da1525abbd1df45399c.jpg", "img_caption": ["(d) InceptionV3ens4 "], "img_footnote": [], "page_idx": 20}, {"type": "text", "text": "Figure 7: Comparison results of class activation maps in intermediate attack processes under different surrogate models. For each subfigure, the top row is the attack results for $\\mathbf{^{\\bullet\\bullet}P N A\\mathbf{+}P O^{\\ast}}$ , the middle row is the attack results for $^{\\bullet\\bullet}\\mathrm{TGR}\\mathrm{+PO}^{\\ast}$ , and the bottom row is the attack results for \u201cOurs $^{,+}$ SPPO\u201d. ", "page_idx": 20}, {"type": "text", "text": "D.5 The Analysis of Our ATT Attack with Different Module Settings ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "The analysis results were shown in Tables 7-9, where the ASR is calculated on average for ViTs, CNNs, and defended-CNNs (Def-CNNs) respectively (which will also be used in subsequent experiments). We further conducted analytical experiments on three additional surrogate ViT models to assess the impact of different module settings on attack transferability in black-box scenarios. ", "page_idx": 21}, {"type": "text", "text": "In almost all ablation experiments, it was obtained that attacking the Attention module gave the best transferability. But unexpectedly, attacking the MLP module of the CaiT-S-24 model resulted in better transferability. We analyzed that it was due to deeper ViT models like CaiT-S-24, where the MLP module played a greater role in correct classification. Overall, attacking all three modules simultaneously yielded better performance than other module settings in most cases. ", "page_idx": 21}, {"type": "table", "img_path": "sNz7tptCH6/tmp/94377728758b86cb316b9c579a85073ff83e565e17fd0a7246d33b37f8084415.jpg", "table_caption": ["Table 7: The average attack success rate $(\\%)$ of our ATT method with different module settings trained by the surrogate model \u201cPiT-B\u201d. "], "table_footnote": [], "page_idx": 21}, {"type": "table", "img_path": "sNz7tptCH6/tmp/af13e9fcb41806d85421163a0b13b1f1ce6e1d8c1973173bb81363df34d3d4ef.jpg", "table_caption": ["Table 8: The average attack success rate $(\\%)$ of our ATT method with different module settings trained by the surrogate model\u201cCaiT-S-24\u201d. "], "table_footnote": [], "page_idx": 21}, {"type": "table", "img_path": "sNz7tptCH6/tmp/6d8c2b7a468465786ea3cb49b89be5d88679bd7f8aa0a52b255e9a0c65c294d0.jpg", "table_caption": ["Table 9: The average attack success rate $(\\%)$ by our ATT method with different module settings trained by the surrogate model \u201cVisformer-S\u201d. "], "table_footnote": [], "page_idx": 21}, {"type": "text", "text": "D.6 Evaluating the Transferability of Our ATT Attack on Object Detection Models ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "In the previous experiments, we evaluated the transferability of different attack methods from one classification model to another classification model (i.e., the cross-model transferability). Thus, we further explored the versatility of ViT attacks in cross-task scenarios, where adversarial examples crafted by image classification models (i.e., ViT-B) on the ImageNet dataset were directly input into object detection models. For purpose of better visualization of the cross-task attack process, we used all the intermediate states from 10 updates during the perturbation generation. Additionally, only the top three detection boxes with the highest confidence in the prediction results were considered. We compared the performance of \u201cOur $^{;+}$ SPPO\u201d with \u201cTGR $^{+}$ PO\u201d on different object detection models, including Faster-RCNN [59], Mask-RCNN [60], SSD [61], RetinaNet [62], and FCOS [63]. ", "page_idx": 21}, {"type": "text", "text": "", "page_idx": 22}, {"type": "text", "text": "As shown in Fig 8, it was clear to see that our ATT attack method allowed the object detection model to produce higher confidence error in detection results. ", "page_idx": 22}, {"type": "text", "text": "D.7 Evaluating the Transferability of Our ATT Attack on Semantic Segmentation Models ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "To further evaluate the cross-task transferability, we directly input adversarial examples crafted by image classification models (i.e., ViT-B) on the ImageNet dataset into semantic segmentation models. Here, the experimental setup was identical to that used in D.6. We compared the performance of \u201cOurs $^+$ SPPO\u201d with $\\mathrm{^{\\bullet}T G R+P O^{\\circ}}$ on different semantic segmentation models, including FCNresnet101 [64], Deeplabv3-resnet50 [65], and LRASPP [66]. It could be seen in Fig. 9 that our ATT attack method corrupted the segmentation results more severely, which generated more incorrect semantic labels. ", "page_idx": 22}, {"type": "image", "img_path": "sNz7tptCH6/tmp/d9f0a54a4e02fabe1ae3e158ec931de633b5e8538c6a2e4478498f785acc7480.jpg", "img_caption": ["Figure 8: Demonstration of results of attacking multiple object detection models using adversarial examples trained by ViT-B. For each subfigure, the leftmost shows the detection results for clean images, the top right shows the attack results for $^{\\bullet\\bullet}\\mathrm{TGR}\\mathrm{+PO^{\\circ}}^{\\bullet}$ , and the bottom right shows the attack results for \u201cOurs $^+$ SPPO\u201d. "], "img_footnote": [], "page_idx": 22}, {"type": "image", "img_path": "sNz7tptCH6/tmp/ac60fea71078e32bb1ae8b0aa9481bb695e3d5b4738a02c1c4b20d6bfb0e2b1b.jpg", "img_caption": ["Figure 9: Demonstration of results of attacking multiple semantic segmentation models using adversarial examples trained by ViT-B. For each subfigure, the leftmost is the clean image, the top right is the attack results for $^{\\bullet\\bullet}\\mathrm{TGR}\\mathrm{+PO}^{\\ast}$ , and the bottom right is the attack results for \u201cOurs+SPPO\u201d. ", "(c) LRASPP [66] "], "img_footnote": [], "page_idx": 23}, {"type": "text", "text": "Table 10: Ablation experiments of our ATT method using different attack strategies with the SPPO setup (\u201cAVR\": Adaptive Variance Reduced Token Gradient; \u201cST\": Soft Truncation; \u201cHT\": Hard Truncation). ", "page_idx": 23}, {"type": "table", "img_path": "sNz7tptCH6/tmp/9d2fde68eac2af9e4ba3fe9e172ce005dbb044bf0cadb958d51ffb1c2c90059d.jpg", "table_caption": [], "table_footnote": ["(c) CaiT-S/24 ", "(d) Visformer-S "], "page_idx": 23}, {"type": "text", "text": "D.8 Additional Ablation Experiments of Our ATT Method using Different Attack Strategies ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "In Table 10, we performed ablation experiments on three strategies (AVR/ST/HT), where \u201cAVR\u201d denoted Adaptive Variance Reduced Token Gradient, \u201cST\u201d denoted soft truncation that we utilized the truncation factor to truncate Attention, QKV, and MLP modules, and \u201cHT\u201d denoted hard truncation that we could truncate the gradient of selected Attention layers to zero. It could be seen in Table 10 that \u201cAVR\u201d achieved better attack performances than \u201cST\u201d and \u201cHT\u201d. The hybrid truncation strategy that combined \u201cST\u201d with \u201cHT\u201d resulted in a higher ASR than using \u201cST\u201d or \u201cHT\u201d independently. On the whole, when considering all three different attack strategies, our ATT method obtained the best transferability in nearly all of black-box settings. ", "page_idx": 23}, {"type": "text", "text": "", "page_idx": 24}, {"type": "text", "text": "In Table 11, an additional experiment was conducted to study the variance reduction of token gradients, where both input enhancement and other gradient strategies are not considered here. \u201cOnly VR\u201d denoted that only the variance reduction strategy was utilized in our ATT method, while \u201cOnly AVR\u201d denoted that only the adaptive variance reduction (AVR) was ultized in our ATT method. As shown in Table 11, our proposed adaptive variance reduction strategy performs better than the fixed variance reduction strategy, leading to better transferability of crafted adversarial examples. ", "page_idx": 24}, {"type": "text", "text": "Table 11: Study of the effect of gradient variance reduction on ASR. \u201cOnly VR\u201d indicates \u201cVariance Reduced\u201d and \u201cOnly AVR\u201d indicates \u201cAdaptive Variance Reduced\u201d. ", "page_idx": 24}, {"type": "table", "img_path": "sNz7tptCH6/tmp/673f517c85fc06fdbe79e4306f75a9fd6c1cce28245b09d828d37252226e75a5.jpg", "table_caption": [], "table_footnote": [], "page_idx": 24}, {"type": "text", "text": "D.9 Evaluating the Transferability of Different Attack Methods on Robust ViT Models ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "In Table 12, we added a validation experiment for robust ViTs, where $\\mathbf{\\cdot}\\mathbf{P}\\mathbf{N}\\mathbf{A}{+}\\mathbf{P}\\mathbf{O}^{\\ast}$ , \u201c $\\mathrm{^{\\bullet}T G R+P O^{\\ast}}$ , and \u201cOur $^{,+}$ SPPO\u201d use their optimal hyperparameters. \u201cclean\u201d denoted that the model was utilized to classify a clean dataset and the result was the probability of the classifier classifying the data incorrectly. The rest of the attack results were presented by all ASRs. Experimental results showed that our ATT attack method still outperforms SOTA methods in robust ViT models (i.e., DeiTS [56], Swin-B [57], Xcit-S [58]). Meanwhile, we performed the same test on normal ViT models corresponding to these robust ViT models, where the proposed \u201cOurs $^{+}$ SPPO\u201d also achieved the highest ASR. ", "page_idx": 24}, {"type": "table", "img_path": "sNz7tptCH6/tmp/d0bd5cfd8b544eb38f2f942699c741d83135b188e07837e8b53436d3bc8674fc.jpg", "table_caption": ["Table 12: Comparative experiments of different attack methods on robust ViTs. \u201cclean\u201d indicates that clean images are classified and all results indicate the percentage of classification errors (i.e., ASR). "], "table_footnote": [], "page_idx": 24}, {"type": "text", "text": "NeurIPS Paper Checklist ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "1. Claims ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "Question: Do the main claims made in the abstract and introduction accurately reflect the paper\u2019s contributions and scope? ", "page_idx": 25}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 25}, {"type": "text", "text": "Justification: Please see Section 4 and Appendix D.1- D.9 ", "page_idx": 25}, {"type": "text", "text": "Guidelines: ", "page_idx": 25}, {"type": "text", "text": "\u2022 The answer NA means that the abstract and introduction do not include the claims made in the paper.   \n\u2022 The abstract and/or introduction should clearly state the claims made, including the contributions made in the paper and important assumptions and limitations. A No or NA answer to this question will not be perceived well by the reviewers.   \n\u2022 The claims made should match theoretical and experimental results, and reflect how much the results can be expected to generalize to other settings.   \n\u2022 It is fine to include aspirational goals as motivation as long as it is clear that these goals are not attained by the paper. ", "page_idx": 25}, {"type": "text", "text": "2. Limitations ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "Question: Does the paper discuss the limitations of the work performed by the authors? ", "page_idx": 25}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "Justification: We have dedicated the separate section to discussing the limitations of our method. Please refer to Section 6. ", "page_idx": 25}, {"type": "text", "text": "Guidelines: ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "\u2022 The answer NA means that the paper has no limitation while the answer No means that the paper has limitations, but those are not discussed in the paper.   \n\u2022 The authors are encouraged to create a separate \"Limitations\" section in their paper.   \n\u2022 The paper should point out any strong assumptions and how robust the results are to violations of these assumptions (e.g., independence assumptions, noiseless settings, model well-specification, asymptotic approximations only holding locally). The authors should reflect on how these assumptions might be violated in practice and what the implications would be.   \n\u2022 The authors should reflect on the scope of the claims made, e.g., if the approach was only tested on a few datasets or with a few runs. In general, empirical results often depend on implicit assumptions, which should be articulated.   \n\u2022 The authors should reflect on the factors that influence the performance of the approach. For example, a facial recognition algorithm may perform poorly when image resolution is low or images are taken in low lighting. Or a speech-to-text system might not be used reliably to provide closed captions for online lectures because it fails to handle technical jargon.   \n\u2022 The authors should discuss the computational efficiency of the proposed algorithms and how they scale with dataset size.   \n\u2022 If applicable, the authors should discuss possible limitations of their approach to address problems of privacy and fairness.   \n\u2022 While the authors might fear that complete honesty about limitations might be used by reviewers as grounds for rejection, a worse outcome might be that reviewers discover limitations that aren\u2019t acknowledged in the paper. The authors should use their best judgment and recognize that individual actions in favor of transparency play an important role in developing norms that preserve the integrity of the community. Reviewers will be specifically instructed to not penalize honesty concerning limitations. ", "page_idx": 25}, {"type": "text", "text": "3. Theory Assumptions and Proofs ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "Question: For each theoretical result, does the paper provide the full set of assumptions and a complete (and correct) proof? ", "page_idx": 25}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 25}, {"type": "text", "text": "Justification: The full set of assumptions for proving Theorem 1 and Lemma 2 is provided in Appendix A. ", "page_idx": 26}, {"type": "text", "text": "Guidelines: ", "page_idx": 26}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include theoretical results.   \n\u2022 All the theorems, formulas, and proofs in the paper should be numbered and crossreferenced.   \n\u2022 All assumptions should be clearly stated or referenced in the statement of any theorems.   \n\u2022 The proofs can either appear in the main paper or the supplemental material, but if they appear in the supplemental material, the authors are encouraged to provide a short proof sketch to provide intuition.   \n\u2022 Inversely, any informal proof provided in the core of the paper should be complemented by formal proofs provided in appendix or supplemental material.   \n\u2022 Theorems and Lemmas that the proof relies upon should be properly referenced. ", "page_idx": 26}, {"type": "text", "text": "4. Experimental Result Reproducibility ", "text_level": 1, "page_idx": 26}, {"type": "text", "text": "Question: Does the paper fully disclose all the information needed to reproduce the main experimental results of the paper to the extent that it affects the main claims and/or conclusions of the paper (regardless of whether the code and data are provided or not)? ", "page_idx": 26}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 26}, {"type": "text", "text": "Justification: Section 4.1 describes all experimental setup to reproduce our main experimental results. Additionally, the optimal parameters of our method are also provided in the Supplementary Material. ", "page_idx": 26}, {"type": "text", "text": "Guidelines: ", "page_idx": 26}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 If the paper includes experiments, a No answer to this question will not be perceived well by the reviewers: Making the paper reproducible is important, regardless of whether the code and data are provided or not.   \n\u2022 If the contribution is a dataset and/or model, the authors should describe the steps taken to make their results reproducible or verifiable.   \n\u2022 Depending on the contribution, reproducibility can be accomplished in various ways. For example, if the contribution is a novel architecture, describing the architecture fully might suffice, or if the contribution is a specific model and empirical evaluation, it may be necessary to either make it possible for others to replicate the model with the same dataset, or provide access to the model. In general. releasing code and data is often one good way to accomplish this, but reproducibility can also be provided via detailed instructions for how to replicate the results, access to a hosted model (e.g., in the case of a large language model), releasing of a model checkpoint, or other means that are appropriate to the research performed.   \n\u2022 While NeurIPS does not require releasing code, the conference does require all submissions to provide some reasonable avenue for reproducibility, which may depend on the nature of the contribution. For example (a) If the contribution is primarily a new algorithm, the paper should make it clear how to reproduce that algorithm. (b) If the contribution is primarily a new model architecture, the paper should describe the architecture clearly and fully. (c) If the contribution is a new model (e.g., a large language model), then there should either be a way to access this model for reproducing the results or a way to reproduce the model (e.g., with an open-source dataset or instructions for how to construct the dataset). (d) We recognize that reproducibility may be tricky in some cases, in which case authors are welcome to describe the particular way they provide for reproducibility. In the case of closed-source models, it may be that access to the model is limited in some way (e.g., to registered users), but it should be possible for other researchers to have some path to reproducing or verifying the results. ", "page_idx": 26}, {"type": "text", "text": "5. Open access to data and code ", "text_level": 1, "page_idx": 26}, {"type": "text", "text": "Question: Does the paper provide open access to the data and code, with sufficient instructions to faithfully reproduce the main experimental results, as described in supplemental material? ", "page_idx": 27}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 27}, {"type": "text", "text": "Justification: Please see the README.md file in the Supplementary Material. Guidelines: ", "page_idx": 27}, {"type": "text", "text": "\u2022 The answer NA means that paper does not include experiments requiring code.   \n\u2022 Please see the NeurIPS code and data submission guidelines (https://nips.cc/ public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 While we encourage the release of code and data, we understand that this might not be possible, so \u201cNo\u201d is an acceptable answer. Papers cannot be rejected simply for not including code, unless this is central to the contribution (e.g., for a new open-source benchmark).   \n\u2022 The instructions should contain the exact command and environment needed to run to reproduce the results. See the NeurIPS code and data submission guidelines (https: //nips.cc/public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 The authors should provide instructions on data access and preparation, including how to access the raw data, preprocessed data, intermediate data, and generated data, etc.   \n\u2022 The authors should provide scripts to reproduce all experimental results for the new proposed method and baselines. If only a subset of experiments are reproducible, they should state which ones are omitted from the script and why.   \n\u2022 At submission time, to preserve anonymity, the authors should release anonymized versions (if applicable).   \n\u2022 Providing as much information as possible in supplemental material (appended to the paper) is recommended, but including URLs to data and code is permitted. ", "page_idx": 27}, {"type": "text", "text": "6. Experimental Setting/Details ", "text_level": 1, "page_idx": 27}, {"type": "text", "text": "Question: Does the paper specify all the training and test details (e.g., data splits, hyperparameters, how they were chosen, type of optimizer, etc.) necessary to understand the results? ", "page_idx": 27}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 27}, {"type": "text", "text": "Justification: Please see Section 4 and the Supplementary Material. ", "page_idx": 27}, {"type": "text", "text": "Guidelines: ", "page_idx": 27}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments. \u2022 The experimental setting should be presented in the core of the paper to a level of detail that is necessary to appreciate the results and make sense of them. \u2022 The full details can be provided either with the code, in appendix, or as supplemental material. ", "page_idx": 27}, {"type": "text", "text": "7. Experiment Statistical Significance ", "text_level": 1, "page_idx": 27}, {"type": "text", "text": "Question: Does the paper report error bars suitably and correctly defined or other appropriate information about the statistical significance of the experiments? ", "page_idx": 27}, {"type": "text", "text": "Answer: [No] ", "page_idx": 27}, {"type": "text", "text": "Justification: All our results are using fixed seeds since the uncertainty in the transferability of adversarial attacks is small. ", "page_idx": 27}, {"type": "text", "text": "Guidelines: ", "page_idx": 27}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The authors should answer \"Yes\" if the results are accompanied by error bars, confidence intervals, or statistical significance tests, at least for the experiments that support the main claims of the paper.   \n\u2022 The factors of variability that the error bars are capturing should be clearly stated (for example, train/test split, initialization, random drawing of some parameter, or overall run with given experimental conditions).   \n\u2022 The method for calculating the error bars should be explained (closed form formula, call to a library function, bootstrap, etc.)   \n\u2022 The assumptions made should be given (e.g., Normally distributed errors).   \n\u2022 It should be clear whether the error bar is the standard deviation or the standard error of the mean.   \n\u2022 It is OK to report 1-sigma error bars, but one should state it. The authors should preferably report a 2-sigma error bar than state that they have a $96\\%$ CI, if the hypothesis of Normality of errors is not verified.   \n\u2022 For asymmetric distributions, the authors should be careful not to show in tables or figures symmetric error bars that would yield results that are out of range (e.g. negative error rates).   \n\u2022 If error bars are reported in tables or plots, The authors should explain in the text how they were calculated and reference the corresponding figures or tables in the text. ", "page_idx": 27}, {"type": "text", "text": "", "page_idx": 28}, {"type": "text", "text": "8. Experiments Compute Resources ", "text_level": 1, "page_idx": 28}, {"type": "text", "text": "Question: For each experiment, does the paper provide sufficient information on the computer resources (type of compute workers, memory, time of execution) needed to reproduce the experiments? ", "page_idx": 28}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 28}, {"type": "text", "text": "Justification: Please see the README.md file in the Supplementary Material. ", "page_idx": 28}, {"type": "text", "text": "Guidelines: ", "page_idx": 28}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The paper should indicate the type of compute workers CPU or GPU, internal cluster, or cloud provider, including relevant memory and storage.   \n\u2022 The paper should provide the amount of compute required for each of the individual experimental runs as well as estimate the total compute.   \n\u2022 The paper should disclose whether the full research project required more compute than the experiments reported in the paper (e.g., preliminary or failed experiments that didn\u2019t make it into the paper). ", "page_idx": 28}, {"type": "text", "text": "9. Code Of Ethics ", "text_level": 1, "page_idx": 28}, {"type": "text", "text": "Question: Does the research conducted in the paper conform, in every respect, with the NeurIPS Code of Ethics https://neurips.cc/public/EthicsGuidelines? ", "page_idx": 28}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 28}, {"type": "text", "text": "Justification: We have strictly adhered to the NeurIPS Code of Ethics. ", "page_idx": 28}, {"type": "text", "text": "Guidelines: ", "page_idx": 28}, {"type": "text", "text": "\u2022 The answer NA means that the authors have not reviewed the NeurIPS Code of Ethics.   \n\u2022 If the authors answer No, they should explain the special circumstances that require a deviation from the Code of Ethics.   \n\u2022 The authors should make sure to preserve anonymity (e.g., if there is a special consideration due to laws or regulations in their jurisdiction). ", "page_idx": 28}, {"type": "text", "text": "10. Broader Impacts ", "text_level": 1, "page_idx": 28}, {"type": "text", "text": "Question: Does the paper discuss both potential positive societal impacts and negative societal impacts of the work performed? ", "page_idx": 28}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 28}, {"type": "text", "text": "Justification: We have dedicated a separate section to discussing the broader impacts of our method. Please refer to Section 6. ", "page_idx": 28}, {"type": "text", "text": "Guidelines: ", "page_idx": 28}, {"type": "text", "text": "\u2022 The answer NA means that there is no societal impact of the work performed. \u2022 If the authors answer NA or No, they should explain why their work has no societal impact or why the paper does not address societal impact. ", "page_idx": 28}, {"type": "text", "text": "\u2022 Examples of negative societal impacts include potential malicious or unintended uses (e.g., disinformation, generating fake profiles, surveillance), fairness considerations (e.g., deployment of technologies that could make decisions that unfairly impact specific groups), privacy considerations, and security considerations.   \n\u2022 The conference expects that many papers will be foundational research and not tied to particular applications, let alone deployments. However, if there is a direct path to any negative applications, the authors should point it out. For example, it is legitimate to point out that an improvement in the quality of generative models could be used to generate deepfakes for disinformation. On the other hand, it is not needed to point out that a generic algorithm for optimizing neural networks could enable people to train models that generate Deepfakes faster.   \n\u2022 The authors should consider possible harms that could arise when the technology is being used as intended and functioning correctly, harms that could arise when the technology is being used as intended but gives incorrect results, and harms following from (intentional or unintentional) misuse of the technology.   \n\u2022 If there are negative societal impacts, the authors could also discuss possible mitigation strategies (e.g., gated release of models, providing defenses in addition to attacks, mechanisms for monitoring misuse, mechanisms to monitor how a system learns from feedback over time, improving the efficiency and accessibility of ML). ", "page_idx": 29}, {"type": "text", "text": "11. Safeguards ", "text_level": 1, "page_idx": 29}, {"type": "text", "text": "Question: Does the paper describe safeguards that have been put in place for responsible release of data or models that have a high risk for misuse (e.g., pretrained language models, image generators, or scraped datasets)? ", "page_idx": 29}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 29}, {"type": "text", "text": "Justification: Our work poses no such risks. ", "page_idx": 29}, {"type": "text", "text": "Guidelines: ", "page_idx": 29}, {"type": "text", "text": "\u2022 The answer NA means that the paper poses no such risks.   \n\u2022 Released models that have a high risk for misuse or dual-use should be released with necessary safeguards to allow for controlled use of the model, for example by requiring that users adhere to usage guidelines or restrictions to access the model or implementing safety filters.   \n\u2022 Datasets that have been scraped from the Internet could pose safety risks. The authors should describe how they avoided releasing unsafe images.   \n\u2022 We recognize that providing effective safeguards is challenging, and many papers do not require this, but we encourage authors to take this into account and make a best faith effort. ", "page_idx": 29}, {"type": "text", "text": "12. Licenses for existing assets ", "text_level": 1, "page_idx": 29}, {"type": "text", "text": "Question: Are the creators or original owners of assets (e.g., code, data, models), used in the paper, properly credited and are the license and terms of use explicitly mentioned and properly respected? ", "page_idx": 29}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 29}, {"type": "text", "text": "Justification: Please see Section 4 and the Supplementary Material. Additionally, both the data and model used in our work are open source and can be used for academic research. ", "page_idx": 29}, {"type": "text", "text": "Guidelines: ", "page_idx": 29}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not use existing assets.   \n\u2022 The authors should cite the original paper that produced the code package or dataset.   \n\u2022 The authors should state which version of the asset is used and, if possible, include a URL.   \n\u2022 The name of the license (e.g., CC-BY 4.0) should be included for each asset.   \n\u2022 For scraped data from a particular source (e.g., website), the copyright and terms of service of that source should be provided.   \n\u2022 If assets are released, the license, copyright information, and terms of use in the package should be provided. For popular datasets, paperswithcode.com/datasets has curated licenses for some datasets. Their licensing guide can help determine the license of a dataset.   \n\u2022 For existing datasets that are re-packaged, both the original license and the license of the derived asset (if it has changed) should be provided.   \n\u2022 If this information is not available online, the authors are encouraged to reach out to the asset\u2019s creators. ", "page_idx": 29}, {"type": "text", "text": "", "page_idx": 30}, {"type": "text", "text": "13. New Assets ", "text_level": 1, "page_idx": 30}, {"type": "text", "text": "Question: Are new assets introduced in the paper well documented and is the documentation provided alongside the assets? ", "page_idx": 30}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 30}, {"type": "text", "text": "Justification: Our work do not release new assets. ", "page_idx": 30}, {"type": "text", "text": "Guidelines: ", "page_idx": 30}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not release new assets.   \n\u2022 Researchers should communicate the details of the dataset/code/model as part of their submissions via structured templates. This includes details about training, license, limitations, etc.   \n\u2022 The paper should discuss whether and how consent was obtained from people whose asset is used.   \n\u2022 At submission time, remember to anonymize your assets (if applicable). You can either create an anonymized URL or include an anonymized zip file. ", "page_idx": 30}, {"type": "text", "text": "14. Crowdsourcing and Research with Human Subjects ", "text_level": 1, "page_idx": 30}, {"type": "text", "text": "Question: For crowdsourcing experiments and research with human subjects, does the paper include the full text of instructions given to participants and screenshots, if applicable, as well as details about compensation (if any)? ", "page_idx": 30}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 30}, {"type": "text", "text": "Justification: Our work do not involve crowdsourcing nor research with human subjects. Guidelines: ", "page_idx": 30}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Including this information in the supplemental material is fine, but if the main contribution of the paper involves human subjects, then as much detail as possible should be included in the main paper.   \n\u2022 According to the NeurIPS Code of Ethics, workers involved in data collection, curation, or other labor should be paid at least the minimum wage in the country of the data collector. ", "page_idx": 30}, {"type": "text", "text": "15. Institutional Review Board (IRB) Approvals or Equivalent for Research with Human Subjects ", "text_level": 1, "page_idx": 30}, {"type": "text", "text": "Question: Does the paper describe potential risks incurred by study participants, whether such risks were disclosed to the subjects, and whether Institutional Review Board (IRB) approvals (or an equivalent approval/review based on the requirements of your country or institution) were obtained? ", "page_idx": 30}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 30}, {"type": "text", "text": "Justification: Our work do not involve crowdsourcing nor research with human subjects. Guidelines: ", "page_idx": 30}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Depending on the country in which research is conducted, IRB approval (or equivalent) may be required for any human subjects research. If you obtained IRB approval, you should clearly state this in the paper.   \n\u2022 We recognize that the procedures for this may vary significantly between institutions and locations, and we expect authors to adhere to the NeurIPS Code of Ethics and the guidelines for their institution.   \n\u2022 For initial submissions, do not include any information that would break anonymity (if applicable), such as the institution conducting the review. ", "page_idx": 30}, {"type": "text", "text": "", "page_idx": 31}]