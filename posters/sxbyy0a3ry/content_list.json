[{"type": "text", "text": "GrounDiT: Grounding Diffusion Transformers via Noisy Patch Transplantation ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Phillip Y. Lee\u2217 Taehoon Yoon\u2217 Minhyuk Sung KAIST {phillip0701,taehoon,mhsung}@kaist.ac.kr ", "page_idx": 0}, {"type": "image", "img_path": "SXbyy0a3rY/tmp/859c0148edb0e12fcef40db89cbf8c0d9e5a7142c28b35de2624d0c6284ff609.jpg", "img_caption": ["Figure 1: Spatially grounded images generated by our GROUNDIT. Each image is generated based on a text prompt along with bounding boxes, which are displayed in the upper right corner of each image. Compared to existing methods that often struggle to accurately place objects within their designated bounding boxes, our GROUNDIT enables more precise spatial control through a novel noisy patch transplantation mechanism. "], "img_footnote": [], "page_idx": 0}, {"type": "text", "text": "Abstract ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "We introduce GROUNDIT, a novel training-free spatial grounding technique for text-to-image generation using Diffusion Transformers (DiT). Spatial grounding with bounding boxes has gained attention for its simplicity and versatility, allowing for enhanced user control in image generation. However, prior training-free approaches often rely on updating the noisy image during the reverse diffusion process via backpropagation from custom loss functions, which frequently struggle to provide precise control over individual bounding boxes. In this work, we leverage the flexibility of the Transformer architecture, demonstrating that DiT can generate noisy patches corresponding to each bounding box, fully encoding the target object and allowing for fine-grained control over each region. Our approach builds on an intriguing property of DiT, which we refer to as semantic sharing. Due to semantic sharing, when a smaller patch is jointly denoised alongside a generatable-size image, the two become semantic clones. Each patch is denoised in its own branch of the generation process and then transplanted into the corresponding region of the original noisy image at each timestep, resulting in robust spatial grounding for each bounding box. In our experiments on the HRS and DrawBench benchmarks, we achieve state-of-the-art performance compared to previous training-free approaches. Project Page: https://groundit-diffusion.github.io/. ", "page_idx": 0}, {"type": "text", "text": "1 Introduction ", "text_level": 1, "page_idx": 1}, {"type": "text", "text": "The Transformer architecture [45] has driven breakthroughs across a wide range of applications, with diffusion models emerging as significant recent beneficiaries. Despite the success of diffusion models with U-Net [42] as the denoising backbone [22, 43, 41, 39], recent Transformer-based diffusion models, namely Diffusion Transformers (DiT) [37], have marked another leap in performance. This is demonstrated by recent state-of-the-art generative models such as Stable Diffusion 3 [13] and Sora [6]. Open-source models like DiT [37] and its text-guided successor PixArt- $\\alpha$ [8] have also achieved superior quality compared to prior U-Net-based diffusion models. Given the scalability of Transformers, Diffusion Transformers are expected to become the new standard for image generation, especially when trained on an Internet-scale dataset. ", "page_idx": 1}, {"type": "text", "text": "With high quality image generation achieved, the next critical step is to enhance user controllability. Among the various types of user guidance in image generation, one of the most fundamental and significant is spatial grounding. For instance, a user may provide not only a text prompt describing the image but also a set of bounding boxes indicating the desired positions of each object, as shown in Fig. 1. Such spatial constraints can be integrated into text-to-image (T2I) diffusion models by adding extra modules that are designed for spatial grounding and fine-tuning the model. GLIGEN [31] is a notable example, which incorporates a gated self-attention module [1] into the U-Net layers of Stable Diffusion [41]. Although effective, such fine-tuning-based approaches incur substantial training costs each time a new T2I model is introduced. ", "page_idx": 1}, {"type": "text", "text": "Recent training-free approaches for spatially grounded image generation [9, 47, 11, 36, 38, 48, 12, 26] have led to new advances, removing the high costs for fine-tuning. These methods leverage the fact that cross-attention maps in T2I diffusion models convey rich structural information about where each concept from the text prompt is being generated in the image [7, 19]. Building on this, these approaches aim to align the cross-attention maps of specific objects with the given spatial constraints (e.g. bounding boxes), ensuring that the objects are placed within their designated regions. This alignment is typically achieved by updating the noisy image in the reverse diffusion process using backpropagation from custom loss functions. However, such loss-guided update methods often struggle to provide precise spatial control over individual bounding boxes, leading to missing objects (Fig. 4, Row 9, Col. 5) or discrepancies between objects and their bounding boxes (Fig. 4, Row 4, Col. 4). This highlights the need for finer control over each bounding box during image generation. ", "page_idx": 1}, {"type": "text", "text": "We aim to provide more precise spatial control over each bounding box, addressing the limitations in previous loss-guided update approaches. A well-known technique for manipulating local regions of the noisy image during the reverse diffusion process is to directly replace or merge the pixels (or latents) in those regions. This simple but effective approach has proven effective in various tasks, including compositional generation [17, 50, 44, 32] and high-resolution generation [5, 29, 24, 25]. One could consider defining an additional branch for each bounding box, denoising with the corresponding text prompt, and then copying the noisy image into its designated area in the main image at each timestep. However, a key challenge lies in creating a noisy image patch\u2013at the same noise level\u2013that reliably contains the desired object while fitting within the specified bounding box. This has been impractical with existing T2I diffusion models, as they are trained on a limited set of image resolutions. While recent models such as PixArt- $\\alpha$ [8] support a wider range of image resolutions, they remain constrained by specific candidate sizes, particularly for smaller image patches. As a result, when these models are used to create a local image patch, they are often limited to denoising a fixed-size image and cropping the region to fit the bounding box. This approach can critically fail to include the desired object within the cropped region. ", "page_idx": 1}, {"type": "text", "text": "In this work, we show that by exploiting the flexibility of the Transformer architecture, DiT can generate noisy image patches that fit the size of each bounding box, thereby reliably including each desired object. This is made possible through our proposed joint denoising technique. First, we introduce an intriguing property of DiT: when a smaller noisy patch is jointly denoised with a generatable-size noisy image, the two gradually become semantic clones\u2014a phenomenon we call semantic sharing. Next, building on this observation, we propose a training-free framework that involves cultivating a noisy patch for each bounding box in a separate branch and then transplanting that patch into its corresponding region in the original noisy image. By iteratively transplanting the separately denoised patches into their respective bounding boxes, we achieved fine-grained spatial control over each bounding box region. This approach leads to more robust spatial grounding, particularly in cases where previous methods fail to accurately adhere to spatial constraints. ", "page_idx": 1}, {"type": "text", "text": "In our experiments on the HRS [3] and DrawBench [43] datasets, we evaluate our framework, GROUNDIT, using PixArt- $\\alpha$ [8] as the base text-to-image DiT model. Our approach demonstrates superior performance in spatial grounding compared to previous training-free methods [38, 9, 47, 48], especially outperforming the state-of-the-art approach [47], highlighting its effectiveness in providing fine-grained spatial control. ", "page_idx": 2}, {"type": "text", "text": "2 Related Work ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "In this section, we review the two primary approaches for incorporating spatial controls into textto-image (T2I) diffusion models: fine-tuning-based methods (Sec. 2.1) and training-free guidance techniques (Sec. 2.2). ", "page_idx": 2}, {"type": "text", "text": "2.1 Spatial Grounding via Fine-Tuning ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "Fine-tuning with additional modules is a powerful approach for enhancing T2I models with spatial grounding capabilities [51, 31, 2, 53, 46, 16, 10, 54]. SpaText [2] introduces a spatio-textual representation that combines segmentations and CLIP embeddings [40]. ControlNet [51] incorporates a trainable U-Net encoder that processes spatial conditions such as depth maps, sketches, and human keypoints, guiding image generation within the main U-Net branch. GLIGEN [31] enables T2I models to accept bounding boxes by inserting a gated attention module into Stable Diffusion [41]. GLIGEN\u2019s strong spatial accuracy has led to its integration into follow-up spatial grounding methods [48, 38, 30] and applications such as compositional generation [15] and video editing [23]. InstanceDiffusion [46] further incorporates conditioning modules to provide finer spatial control through diverse conditions like boxes, scribbles, and points. While these fine-tuning methods are effective, they require taskspecific datasets and involve substantial costs, as they must be retrained for each new T2I model, underscoring the need for training-free alternatives. ", "page_idx": 2}, {"type": "text", "text": "2.2 Spatial Grounding via Training-Free Guidance ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "In response to the inefficiencies of fine-tuning, training-free approaches have been introduced to incorporate spatial grounding into T2I diffusion models. One approach involves a region-wise composition of noisy patches, each conditioned on a different text input [5, 50, 32]. These patches, extracted using binary masks, are intended to generate the object they are conditioned on within the generated image. However, since existing T2I diffusion models are limited to a fixed set of image resolutions, each patch cannot be treated as a complete image, making it uncertain whether the extracted patch will contain the desired object. Another approach leverages the distinct roles of attention modules in T2I models\u2014self-attention captures long-range interactions between image features, while cross-attention links image features with text embeddings. By using spatial constraints such as bounding boxes or segmentation masks, spatial grounding can be achieved either by updating the noisy image using backpropagation based on a loss calculated from cross-attention maps [48, 38, 9, 7, 18, 36], or by directly manipulating cross- or self-attention maps to follow the given spatial layouts [26, 4, 14]. While the loss-guided methods enable spatial grounding in a training-free manner, they still lack precise control over individual bounding boxes, often leading to missing objects or misalignmet between objects and their bounding boxes. In this work, we propose a novel training-free framework that offers fine-grained spatial control over each bounding box by harnessing the flexibility of the Transformer architecture in DiT. ", "page_idx": 2}, {"type": "text", "text": "3 Background: Diffusion Transformers ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "Diffusion Transformer (DiT) [37] represents a new class of diffusion models that utilize the Transformer architecture [45] for their denoising network. Previous diffusion models like Stable Diffusion [41] use the U-Net [42] architecture, of which each layer contains a convolutional block and attention modules. In contrast, DiT consists of a sequence of DiT blocks, each containing a pointwise feedforward network and attention modules, removing convolution operations and instead processing image tokens directly through attention mechanisms. ", "page_idx": 2}, {"type": "image", "img_path": "SXbyy0a3rY/tmp/f41ee6a1af87bbec2a9c3292eeb367c80c1f8224b3521a260970adbc94f41372.jpg", "img_caption": ["Figure 2: A single denoising step in GROUNDIT consists of two stages. The Global Update (Sec. 5.1) established coarse spatial grounding by updating the noisy image with a custom loss function. Then, the Local Update (Sec. 5.3) further provides fine-grained spatial control over individual bounding boxes through a novel technique called noisy patch transplantation. "], "img_footnote": [], "page_idx": 3}, {"type": "text", "text": "DiT follows the formulation of diffusion models [22], in which the forward process applies noise to a real clean data $\\mathbf{x}_{\\mathrm{0}}$ by ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\mathbf{x}_{t}=\\sqrt{\\alpha_{t}}\\mathbf{x}_{0}+\\sqrt{1-\\alpha_{t}}\\epsilon\\quad\\mathrm{where}\\quad\\epsilon\\sim\\mathcal{N}(0,I),\\;\\alpha_{t}\\in[0,1].\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "The reverse process denoises the noisy data $\\mathbf{x}_{t}$ through a Gaussian transition ", "page_idx": 3}, {"type": "equation", "text": "$$\np_{\\theta}(\\mathbf{x}_{t-1}|\\mathbf{x}_{t})=\\mathcal{N}(\\mathbf{x}_{t};\\mu_{\\theta}(\\mathbf{x}_{t},t),\\Sigma_{\\theta}(\\mathbf{x}_{t},t))\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "where $\\mu_{\\theta}(\\mathbf{x}_{t},t)$ is calculated by a learned neural network trained by minimizing the negative ELBO objective [27]. While $\\Sigma_{\\theta}(\\mathbf{x}_{t},t)$ can also be learned, it is usually set as time dependent constants. ", "page_idx": 3}, {"type": "text", "text": "Positional Embeddings. As DiT is based on the Transformer architecture, it treats the noisy image $\\mathbf{x}_{t}\\in\\mathbb{R}^{h\\times w\\times d}$ as a set of image tokens. Specifically, $\\mathbf{x}_{t}$ is divided into patches, each transformed into an image token via linear embedding. This results in $(h/l)\\times(w/l)$ tokens, where $l$ is the patch size. Importantly, before each denoising step, 2D sine-cosine positional embeddings are assigned to each image token to provide spatial information as follows: ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\mathbf{x}_{t-1}\\leftarrow\\mathsf{D e n o i s e}(\\mathsf{P E}(\\mathbf{x}_{t}),t,c).\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "Here, $\\operatorname{PE}(\\cdot)$ applies positional embeddings, Denoise $(\\cdot)$ represents a single denoising step in DiT at timestep $t$ , and $c$ is the text embedding. This contrasts with U-Net-based diffusion models, which typically do not utilize positional embeddings for the noisy image. Detailed formulations of the positional embeddings are provided in the Appendix (Sec. A). ", "page_idx": 3}, {"type": "text", "text": "4 Problem Definition ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "Let $P$ be the input text prompt (i.e., a list of words), which we refer to as the global prompt. Let $c_{P}$ be the text embedding of $P$ . We define a set of $N$ grounding conditions $G=\\{g_{i}\\}_{i=0}^{N-1}$ , where each condition specifies the coordinates of a bounding box and the desired object to be placed within it. Specifically, each condition $g_{i}:=(b_{i},p_{i},c_{i})$ consists of the following: $b_{i}\\in\\mathbb{R}^{4}$ , the $x y$ -coordinates of the bounding box\u2019s upper-left and lower-right corners, $p_{i}\\,\\in\\,P$ , the word in the global prompt describing the desired object within the box, and $c_{i}$ , the text embedding of $p_{i}$ . The objective is to generate an image that aligns with the global prompt $P$ while ensuring each specified object is accurately positioned within its corresponding bounding box $b_{i}$ . ", "page_idx": 3}, {"type": "text", "text": "5 GROUNDIT: Grounding Diffusion Transformers ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "We propose GROUNDIT, a training-free framework based on DiT for generating images spatially grounded on bounding boxes. Each denoising step in GROUNDIT consists of two stages: Global Update and Local Update. Global Update ensures coarse alignment between the noisy image and the bounding boxes through a gradient descent update using cross-attention maps (Sec. 5.1). Following this, Local Update further provides fine-grained control over individual bounding boxes via a novel noisy patch transplantation technique (Sec. 5.3). This approach leverages our key observation of DiT\u2019s semantic sharing property, introduced in Sec. 5.2. An overview of this two-stage denoising step is provided in Fig. 2. ", "page_idx": 3}, {"type": "text", "text": "5.1 Global Update with Cross-Attention Maps ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "First, the noisy image $\\mathbf{x}_{t}$ is updated to spatially align with the bounding box inputs. For this, we leverage the rich structural information encoded in cross-attention maps, as first demonstrated by Chefer et al. [7]. Each cross-attention map shows how a region of the noisy image correspond to a specific word in the global prompt $P$ . Let DiT consist of $M$ sequential DiT blocks. As $\\mathbf{x}_{t}$ passes through the $m$ -th block, the cross-attention map $a_{i,t}^{m}\\in\\mathbb{R}^{h\\times w\\times1}$ for object $p_{i}$ is extracted. For each grounding condition $g_{i}$ , the mean cross-attention map $A_{i,t}$ is obtained by averaging $a_{i,t}^{m}$ over all $M$ blocks as follows: ", "page_idx": 4}, {"type": "equation", "text": "$$\nA_{i,t}=\\frac{1}{M}\\sum_{m=0}^{M-1}a_{i,t}^{m}.\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "For convenience, we denote the operation of extracting $A_{i,t}$ for every $g_{i}\\in G$ as below: ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\{A_{i,t}\\}_{i=0}^{N-1}\\gets\\mathtt{E x t r a c t A t t e n t i o n}(\\mathbf{x}_{t},t,c_{P},G).\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "Then, following prior works on U-Net-based diffusion models [48, 47, 38, 9, 36, 7], we measure the spatial alignment for each object $p_{i}$ by comparing its mean cross-attention map $A_{i,t}$ with its corresponding bounding box $b_{i}$ , using a predefined grounding loss $\\mathcal{L}(A_{i,t},b_{i})$ as defined in R&B [47]. The aggregated grounding loss $\\mathcal{L}_{\\mathrm{AGG}}$ is then computed by summing the grounding loss across all grounding conditions $g_{i}\\in G$ : ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\mathcal{L}_{\\mathrm{AGG}}(\\{A_{i,t}\\}_{i=0}^{N-1},G)=\\sum_{i=0}^{N-1}\\mathcal{L}(A_{i,t},b_{i}).\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "Based on the backpropagation from $\\mathcal{L}_{\\mathrm{AGG}},\\,\\mathbf{x}_{t}$ is updated via gradient descent as follows: ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\hat{\\mathbf{x}}_{t}\\gets\\mathbf{x}_{t}-\\omega_{t}\\nabla_{\\mathbf{x}_{t}}\\mathcal{L}_{\\mathrm{AGG}}\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "where $\\omega_{t}$ is a scalar weight value for gradient descent. We refer to Eq. 7 as the Global Update, as the whole noisy image $\\mathbf{x}_{t}$ is updated based on an aggregated loss from all grounding conditions in $G$ . ", "page_idx": 4}, {"type": "text", "text": "The Global Update achieves reasonable accuracy in spatial grounding. However, it often struggles with more complex grounding conditions. For instance, when $G$ contains multiple bounding boxes (e.g., six boxes in Fig. 4, Row 9) or small, thin boxes (e.g., Fig. 4, Row 5), the desired objects may be missing or misaligned with the boxes. These examples show that the Global Update lacks fine-grained, box-specific control, underscoring the need for precise controls for individual bounding boxes. In the following sections, we introduce a novel method to achieve this fine-grained spatial control. ", "page_idx": 4}, {"type": "text", "text": "5.2 Semantic Sharing in Diffusion Transformers ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "In this section, we present our observations on an intriguing property of DiT, semantic sharing, which will serve as a key building block for our main method in Sec. 5.3. ", "page_idx": 4}, {"type": "text", "text": "Joint Denoising. We observed that DiT can jointly denoise two different noisy images together. For example, consider two noisy images, $\\mathbf{x}_{t}$ and $\\mathbf{y}_{t}$ , both at timestep $t$ in the reverse diffusion process. Position embeddings are applied to the image tokens according to their sizes, resulting in $\\bar{\\mathbf{x}}_{t}=\\mathsf{P E}(\\mathbf{x}_{t})$ and $\\bar{\\mathbf{y}}_{t}\\,=\\,\\mathsf{P E}\\big(\\mathbf{y}_{t}\\big)$ . Notably, the two noisy images can differ in size, providing flexibility in joint denoising. The key part is that the two noisy images\u2014more precisely, two sets of image tokens\u2014are merged into a single set $\\mathbf{z}_{t}$ . We denote this process as $\\mathtt{M e r g e(\\cdot)}$ (see Alg. 1, line 4). $\\mathbf{z}_{t}$ is passed through the DiT blocks, yielding the output $\\mathbf{z}_{t-1}$ , which is then split into the denoised versions $\\mathbf X_{t-1}$ and $\\mathbf y_{t-1}$ via $\\mathtt{S p l i t}(\\cdot)$ . Joint denoising is illustrated in Fig. 3-(A), and a pseudocode for a single step of joint denoising is shown in Alg. 1. ", "page_idx": 4}, {"type": "text", "text": "Semantic Sharing. Surprisingly, we found that joint denoising of two noisy images generates semantically correlated content in correponding pixels, even when the initial random noise differs. Consider two noisy images, $\\mathbf{x}_{T}\\,\\in\\,\\mathbb{R}^{h_{\\mathbf{x}}^{\\star}\\times w_{\\mathbf{x}}\\times d}$ and $\\mathbf{y}_{T}\\,\\in\\,\\mathbb{R}^{h_{\\mathbf{y}}\\times w_{\\mathbf{y}}\\times d}$ , both initialized from a unit Gaussian distribution ${\\mathcal{N}}(0,I)$ . We experiment with a reverse diffusion process in which, for the initial $100\\gamma\\%$ of the denoising steps $(\\gamma\\in[0,1])$ ), $\\mathbf{x}_{T}$ and ${\\bf y}_{T}$ undergo joint denoising. For the remaining timesteps, they are denoised independently. The same text embedding $c$ is used as a condition in both cases. ", "page_idx": 4}, {"type": "image", "img_path": "SXbyy0a3rY/tmp/12c314bc0fd2fbdad2b8babbc17ef79703a9a13f50187a6ee4ed2c74a3282d7a.jpg", "img_caption": ["Figure 3: (A) Joint Denoising. Two different noisy images, $\\mathbf{x}_{t}$ and $\\mathbf{y}_{t}$ , are each assigned positional embeddings based on their respective sizes. The two sets of image tokens are then merged and passed through DiT for a denoising step. Afterward, the denoised tokens are split back into $\\mathbf X_{t-1}$ and $\\mathbf y_{t-1}$ . (B), (C) Semantic Sharing. Denoising two noisy images using joint denoising results in semantically correlated content between the generated images. Here, $\\gamma$ indicates that joint denoising is during the initial $100\\gamma\\%$ of the timesteps, after which the images are denoised for the remaining steps. "], "img_footnote": [], "page_idx": 5}, {"type": "text", "text": "", "page_idx": 5}, {"type": "text", "text": "Fig. 3 shows the generated images from $\\mathbf{x}_{T}$ and $\\mathbf{y}_{T}$ across different $\\gamma$ values. In Fig. 3-(B), $\\mathbf{x}_{T}$ and $\\mathbf{y}_{T}$ have the same resolution $(h_{\\mathbf{x}}=h_{\\mathbf{y}},w_{\\mathbf{x}}=w_{\\mathbf{y}})$ , while in Fig. 3-(C) their resolutions differ $(h_{\\mathbf{x}}>h_{\\mathbf{y}},w_{\\mathbf{x}}>w_{\\mathbf{y}})$ . When $\\gamma=0$ , the two noisy images are denoised completely independently, resulting in clearly distinct images (leftmost column). We found that DiT models have a certain range of resolutions within which they can generate plausible images\u2014which we refer to as generatable resolutions\u2014but face challenges when generating images far outside this range. This is demonstrated in the output of $\\mathbf{y}_{0}$ in Fig. 3-(C) with $\\gamma=0$ . Further discussions and visual analyses are provided in the Appendix (Sec. D). But as $\\gamma$ increases, allowing $\\mathbf{x}_{T}$ and ${\\bf y}_{T}$ to be jointly denoised in the initial steps, the generated images become progressively more similar. When $\\gamma=1$ , the images generated from $\\mathbf{x}_{T}$ and $\\mathbf{y}_{T}$ appear almost identical. These results demonstrate that, in joint denoising, assigning identical or similar positional embeddings to different image tokens promotes strong interactions between them during the denoising process. This correlated behavior during joint denoising causes the two image tokens to converge toward semantically similar outputs\u2014a phenomenon we term semantic sharing. ", "page_idx": 5}, {"type": "text", "text": "Notably, this pattern holds not only when both noisy images share the same resolution (Fig. 3-(B)), but even when one of the images does not have DiT\u2019s generatable resolution (Fig. 3-(C)). While self-attention sharing techniques have been explored in U-Net-based diffusion models to enhance style consistency between images [20, 34], they have been limited to images of equal resolution. By leveraging the flexibility to assign positional embeddings across different resolutions, our joint ", "page_idx": 5}, {"type": "text", "text": "Algorithm 1: Pseudocode of Joint Denoising (Sec. 5.2). ", "page_idx": 5}, {"type": "text", "text": "Inputs: $\\mathbf{x}_{t}\\in\\mathbb{R}^{h_{\\mathbf{x}}\\times w_{\\mathbf{x}}\\times d}$ $\\mathbf{y}_{t}\\in\\mathbb{R}^{h_{\\mathbf{y}}\\times w_{\\mathbf{y}}\\times d},t,c,l;$ patch size. Outputs: $\\mathbf x_{t-1},\\mathbf y_{t-1}$ ; 1 Function JointDenoise $({\\bf x}_{t},{\\bf y}_{t},t,c)$ : 2 $n_{\\mathbf{x}}\\leftarrow h_{\\mathbf{x}}w_{\\mathbf{x}}/l^{2}$ , $n_{\\mathbf{y}}\\leftarrow h_{\\mathbf{y}}w_{\\mathbf{y}}/l^{2}$ ; 3 $\\bar{\\mathbf{x}}_{t}\\gets\\mathsf{P E}(\\mathbf{x}_{t})$ , $\\bar{\\mathbf{y}}_{t}\\gets\\mathsf{P E}(\\mathbf{y}_{t})$ ; 4 $\\mathbf{z}_{t}\\gets\\mathsf{M e r g e}(\\bar{\\mathbf{x}}_{t},\\bar{\\mathbf{y}}_{t})$ ; 5 $\\mathbf{z}_{t-1}\\gets\\mathtt{D e n o i s e}(\\mathbf{z}_{t},t,c)$ ; 6 $\\{\\mathbf{x}_{t-1},\\mathbf{y}_{t-1}\\}\\gets\\mathbf{Split}(\\mathbf{z}_{t-1},\\{n_{\\mathbf{x}},n_{\\mathbf{y}}\\})$ ; 7 return $\\mathbf x_{t-1},\\mathbf y_{t-1}$ ; ", "page_idx": 5}, {"type": "text", "text": "isy images, timestep, text embedding, // Noisy images at timestep $t-1$ .   \n// Store the number of image tokens. // Apply positional embeddings. // Merge two sets of image tokens. // Denoising step with DiT. // Split back into two sets. ", "page_idx": 5}, {"type": "text", "text": "denoising approach extends across heterogeneous resolutions, offering greater versatility. We provide further discussions and analyses on semantic sharing in the Appendix (Sec. D). ", "page_idx": 6}, {"type": "text", "text": "5.3 Local Update with Noisy Patch Transplantation ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "In this section, we introduce our key technique: Local Update via noisy patch cultivation and transplantation. Building on DiT\u2019s semantic sharing property from Sec. 5.2, we show how this can be leveraged to provide precise spatial control over each bounding box. ", "page_idx": 6}, {"type": "text", "text": "Main & Object Branches. We propose a parallel denoising approach with multiple branches: one for the main noisy image $\\hat{\\mathbf{x}}_{t}$ and additional branches for each grounding condition $g_{i}$ . The main branch denoises the main noisy image using the global prompt $P$ , while each object branch is designed to denoise local regions within the bounding boxes, enabling fine-grained spatial control over each region. For each $i$ -th object branch, there is a distinct noisy object image $\\mathbf{u}_{i,t}$ , initialized as $\\mathbf{u}_{i,T}\\sim\\mathcal{N}(0,I)$ . We predefine the resolution of the noisy object image ${\\bf{u}}_{i,t}$ by searching in PixArt- $\\cdot\\alpha$ \u2019s generatble resolutions that closely match the aspect ratio of the corresponding bounding box $b_{i}$ . With $\\hat{\\mathbf{x}}_{t}$ obtained from Global Update (Sec. 5.1), each branch performs denoising in parallel. Below we explain the denoising mechanism for each branch. ", "page_idx": 6}, {"type": "text", "text": "Noisy Patch Cultivation. In the main branch at timestep $t$ , the noisy image $\\hat{\\mathbf{x}}_{t}$ is denoised using the global prompt $P$ as follows: $\\tilde{\\mathbf{x}}_{t-1}\\gets\\mathsf{D e n o i s e}(\\mathsf{P E}(\\hat{\\mathbf{x}}_{t}),t,c_{P})$ , where $\\hat{\\mathbf{x}}_{t}$ is the output from the Global Update and $c_{P}$ is the text embedding of $P$ . For the $i$ -th object branch, there are two inputs: the noisy object image ${\\bf{u}}_{i,t}$ and a subset $\\mathbf{v}_{i,t}$ of image tokens extracted from $\\hat{\\mathbf{x}}_{t}$ , corresponding to the bounding box $b_{i}$ . We denote this extraction as $\\mathbf v_{i,t}\\gets\\mathsf{C r o p}(\\hat{\\mathbf{x}}_{t},b_{i})$ , where $\\mathbf{v}_{i,t}\\in\\mathbb{R}^{h_{i}\\times w_{i}\\times d}$ is referred to as a noisy local patch. Here, $h_{i}$ and $w_{i}$ corresponds to height and width of bounding box $b_{i}$ , respectively. Joint denoising is then performed on ${\\bf u}_{i,t}$ and $\\mathbf{v}_{i,t}$ to yield their denoised versions: ", "page_idx": 6}, {"type": "equation", "text": "$$\n\\\\{\\mathbf{u}_{i,t-1},\\mathbf{v}_{i,t-1}\\}\\gets\\mathrm{JointDenoise}(\\mathbf{u}_{i,t},\\mathbf{v}_{i,t},t,c_{i}),\n$$", "text_format": "latex", "page_idx": 6}, {"type": "text", "text": "where $c_{i}$ is the text embedding of the object $p_{i}$ . ", "page_idx": 6}, {"type": "text", "text": "Through semantic sharing with the noisy object image ${\\bf{u}}_{i,t}$ during joint denoising, the denoised local patch $\\mathbf{v}_{i,t-1}$ is expected to gain richer semantic features of object $p_{i}$ than it would without joint denoising. Note that even when the noisy local patch $\\mathbf{v}_{i,t}$ does not meet the typical generatable resolution of DiT (since it often requires cropping small bounding box regions of $\\hat{\\mathbf{x}}_{t}$ to obtain $\\mathbf{v}_{i,t}$ ), it offers a simple and effective way for enriching $\\mathbf{v}_{i,t}$ of the semantic features of object $p_{i}$ . We refer to this process as noisy patch cultivation. ", "page_idx": 6}, {"type": "text", "text": "Noisy Patch Transplantation. After cultivating local patches through joint denoising in Eq. 8, each patch is transplanted into $\\tilde{\\mathbf{x}}_{t-1}$ , obtained from the main branch. The patches are transplanted in their original bounding box regions specified by $b_{i}$ as follows: ", "page_idx": 6}, {"type": "equation", "text": "$$\n\\tilde{\\mathbf{x}}_{t-1}\\gets\\tilde{\\mathbf{x}}_{t-1}\\odot(1-\\mathbf{m}_{i})+\\mathtt{U n c r o p}(\\mathbf{v}_{i,t-1},b_{i})\\odot\\mathbf{m}_{i}\n$$", "text_format": "latex", "page_idx": 6}, {"type": "text", "text": "Here, $\\odot$ denotes the Hadamard product, ${\\bf m}_{i}$ is a binary mask for the bounding box $b_{i}$ , and ${\\mathtt{U n c r o p}}(\\mathbf{v}_{i,t-1},b_{i})$ applies zero-padding to $\\mathbf{v}_{i,t-1}$ to align its position with that of $b_{i}$ . This transplantation enables fine-grained local control for the grounding condition $g_{i}$ . After transplanting the outputs from all $N$ object branches, we obtain $\\mathbf{x}_{t-1}$ , representing the final output of GROUNDIT denoising step at timestep $t$ . In $\\mathbf X_{t-1}$ , the image tokens within the $b_{i}$ region are expected to possess richer semantic information about object $p_{i}$ compared to the initial $\\tilde{\\mathbf{x}}_{t-1}$ from the main branch. This process is referred to as noisy patch transplantation. We provide implementation details and full pseudocode of a single GROUNDIT denoising step in the Appendix (Sec. E). ", "page_idx": 6}, {"type": "text", "text": "6 Results ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "In this section, we present the experiment results of our method, GROUNDIT, and provide comparisons with baselines. For the base text-to-image DiT model, we use PixArt- $\\alpha$ [8], which builds on the original DiT architecture [37] by incorporating an additional cross-attention module to condition on text prompts. ", "page_idx": 6}, {"type": "image", "img_path": "SXbyy0a3rY/tmp/7a1c55013383a3dc5c849f525799f8eca592986170fb729cc7395ec883a3e22d.jpg", "img_caption": ["Figure 4: Qualitative comparisons between our GROUNDIT and baselines. Leftmost column shows the input bounding boxes, and columns 2-6 include the baseline results. The rightmost column includes the results of our GROUNDIT. "], "img_footnote": [], "page_idx": 7}, {"type": "text", "text": "6.1 Evaluation Settings ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "Baselines. We compare our method with state-of-the-art training-free approaches for bounding box-based image generation, including R&B [47], BoxDiff [48], Attention-Refocusing [38], and Layout-Guidance [14]. For a fair comparison, we also implement R&B using PixArt- $\\alpha$ , which we refer to as PixArt-R&B, and treat it as an internal baseline. Note that this is identical to our method without the Local Guidance (Sec. 5.3). ", "page_idx": 8}, {"type": "text", "text": "Evaluation Metrics and Benchmarks. ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "\u2022 (Grounding Accuracy) We follow the evaluation protocol of R&B [47] to assess spatial grounding on the HRS [3] and DrawBench [43] datasets, using three criteria: spatial, size, and color. The HRS dataset consists of 1002, 501, and 501 images for each respective criterion, with bounding boxes generated using GPT-4 by Phung et al. [38]. For DrawBench, we use the same 20 positional prompts as in R&B [47]. ", "page_idx": 8}, {"type": "text", "text": "\u2022 (Prompt Fidelity) We use the CLIP score [21] to evaluate how well the generated images adhere to the text prompt. Additionally, we assess our method using PickScore [28] and ImageReward [49], which provide human alignment scores based on the consistency between the text prompt and generated images. ", "page_idx": 8}, {"type": "table", "img_path": "SXbyy0a3rY/tmp/4b1b78a08d3aea5a9d62103d55b3af05d6b0251f3524931c5040b5543ef45a43.jpg", "table_caption": [], "table_footnote": ["Table 1: Quantitative comparisons of grounding accuracy on HRS [3] and DrawBench [43] benchmarks. Bold represents the best, and underline represents the second best method. "], "page_idx": 8}, {"type": "text", "text": "6.2 Grounding Accuracy ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "Quantitative Comparisons. Tab. 1 presents a quantitative comparison of grounding accuracy between our method, GROUNDIT, and baselines. GROUNDIT outperforms all baselines across different criteria of grounding accuracy\u2014spatial, size, and color\u2014including the state-of-the-art R&B [47] and our internal baseline PixArt-R&B. Notably, the spatial accuracy on the HRS benchmark [3] (Col. 1) of GROUNDIT is significantly higher, with a $+14.87\\%$ improvement over R&B and $+7.88\\%$ over PixArt- $\\cdot\\alpha$ . The comparison between PixArt- $\\cdot\\alpha$ [8], PixArt-R&B and GROUNDIT highlights the effectiveness of the two-stage pipeline of GROUNDIT. First, integrating the loss-based Global Update into PixArt- $\\alpha$ results in a substantial improvement in spatial accuracy (from $17.86\\%$ to $37.13\\%$ ). Then, incorporating our key contribution, the Local Update, further boosts accuracy (from $37.13\\%$ to $45.01\\%$ ). For size accuracy (Col. 2), which evaluates how well the size of each generated object matches its corresponding bounding box, GROUNDIT shows a $+1.01\\%$ improvement over R&B. In terms of color accuracy (Col. 3), our method achieves a $+6.60\\%$ improvement over PixArt-R&B and outperforms R&B by $+3.63\\%$ . This underscores the effectiveness of our noisy patch transplantation technique in accurately assigning color descriptions to the corresponding objects. As DrawBench [43] only contains images with two bounding boxes, which are relatively easy to generate, employing the Global Update is sufficient for grounding. We present additional quantitative comparisons of grounding accuracy in the Appendix (Sec. B). ", "page_idx": 8}, {"type": "text", "text": "Qualitative Comparisons. Fig. 4 presents the qualitative comparisons. When the grounding condition involves one or two simple bounding boxes (Rows 1, 2), both our method and the baselines successfully generate objects within the designated regions. However, as the number of bounding boxes increases and the grounding conditions become more challenging, the baselines struggle to correctly place each object inside the bounding box (Rows 4, 8), or even fail to generate the object at all (Rows 5, 7, 9). In contrast, GROUNDIT successfully grounds each object within the boxes, even when the number of boxes is relatively high, such as four boxes (Rows 5, 6, 8), five boxes (Row 7) and six boxes (Row 9). This highlights that our proposed noisy patch transplantation technique provides superior control over each bounding box, addressing the limitations of previous loss-based update methods, as discussed in Sec. 5.1. For more qualitative comparisons, including images generated with various aspect ratios, please refer to the Appendix (Sec. G and Fig. 5). ", "page_idx": 8}, {"type": "text", "text": "", "page_idx": 9}, {"type": "text", "text": "6.3 Prompt Fidelity ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "Tab. 2 presents a quantitative comparison of prompt fidelity between our method and PixArt-R&B. Each metric is measured using the generated images from the HRS dataset [3]. GROUNDIT achieves higher CLIP score [21] than PixArt-R&B (Col. 1), indicating that our noisy patch transplantation improves the text prompt fidelity of the generated images. Additionally, our method achieves a higer ImageReward [49] score, which measures human preference by considering both prompt fidelity and overall image quality. While GROUNDIT shows a slight underperformance compared to PixArt-R&B in Pickscore [28], it remains comparable overall. We provide further comparisons of prompt fidelity with other baselines in the Appendix (Sec. C). ", "page_idx": 9}, {"type": "table", "img_path": "SXbyy0a3rY/tmp/d3d74d65ce2459502c6bcfbe0fa7896790b7563f1dbbc8a1f7461ff89dbc0fd5.jpg", "table_caption": ["Table 2: Quantitative comparisons on prompt fidelity on HRS benchmark [3]. Bold represents the best method. "], "table_footnote": [], "page_idx": 9}, {"type": "text", "text": "7 Conclusion ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "In this work, we introduced GROUNDIT, a training-free spatial grounding technique for text-to-image generation, leveraging Diffusion Transformers (DiT). To address the limitation of prior approaches, which lacked fine-grained spatial control over individual bounding boxes, we proposed a novel approach that transplants a noisy patch generated in a separate denoising branch into the designated area of the noisy image. By exploiting an intriguing property of DiT, semantic sharing, which arises from the flexibility of the Transformer architecture and the use of positional embeddings, GROUNDIT generates a smaller patch by simultaneously denoising two noisy image: one with a smaller size and the other with a generatable resolution by DiT. Through semantic sharing, these two noisy images become semantic clones, enabling fine-grained spatial control for each bounding box. Our experiments on the HRS and DrawBench benchmarks demonstrated that GROUNDIT achieves state-of-the-art performance compared to previous training-free grounding methods. ", "page_idx": 9}, {"type": "text", "text": "Limitations and Societal Impacts. A limitation of our method is the increased computation time, as it requires a separate object branch for each bounding box. We provide further analysis on the computation time in the Appendix (Sec. F). Additionally, like other generative AI techniques, our method is susceptible to misuse, such as creating deepfakes, which can raise significant concerns related to privacy, bias, and fairness. It is crucial to develop safeguards to control and mitigate these risks responsibly. ", "page_idx": 9}, {"type": "text", "text": "Acknowledgements ", "text_level": 1, "page_idx": 10}, {"type": "text", "text": "We thank Juil Koo and Jaihoon Kim for valuable discussions on Diffusion Transformers. This work was supported by the NRF grant (RS-2023-00209723), IITP grants (RS-2019-II190075, RS2022-II220594, RS-2023-00227592, RS-2024-00399817), and KEIT grant (RS-2024-00423625), all funded by the Korean government (MSIT and MOTIE), as well as grants from the DRB-KAIST SketchTheFuture Research Center, NAVER-Intel Co-Lab, Hyundai NGV, KT, and Samsung Electronics. ", "page_idx": 10}, {"type": "text", "text": "References ", "text_level": 1, "page_idx": 10}, {"type": "text", "text": "[1] Jean-Baptiste Alayrac, Jeff Donahue, Pauline Luc, Antoine Miech, Iain Barr, Yana Hasson, Karel Lenc, Arthur Mensch, Katherine Millican, Malcolm Reynolds, et al. Flamingo: a visual language model for few-shot learning. In NeurIPS, 2022.   \n[2] Omri Avrahami, Thomas Hayes, Oran Gafni, Sonal Gupta, Yaniv Taigman, Devi Parikh, Dani Lischinski, Ohad Fried, and Xi Yin. Spatext: Spatio-textual representation for controllable image generation. In CVPR, 2023.   \n[3] Eslam Mohamed Bakr, Pengzhan Sun, Xiaogian Shen, Faizan Farooq Khan, Li Erran Li, and Mohamed Elhoseiny. Hrs-bench: Holistic, reliable and scalable benchmark for text-to-image models. In ICCV, 2023.   \n[4] Yogesh Balaji, Seungjun Nah, Xun Huang, Arash Vahdat, Jiaming Song, Karsten Kreis, Miika Aittala, Timo Aila, Samuli Laine, Bryan Catanzaro, et al. ediff:i Text-to-image diffusion models with an ensemble of expert denoisers. arXiv preprint arXiv:2211.01324, 2022.   \n[5] Omer Bar-Tal, Lior Yariv, Yaron Lipman, and Tali Dekel. MultiDiffusion: Fusing diffusion paths for controlled image generation. In ICML, 2023.   \n[6] Tim Brooks, Bill Peebles, Connor Holmes, Will DePue, Yufei Guo, Li Jing, David Schnurr, Joe Taylor, Troy Luhman, Eric Luhman, Clarence Ng, Ricky Wang, and Aditya Ramesh. Video generation models as world simulators. https://openai.com/research/ video-generation-models-as-world-simulators, 2024.   \n[7] Hila Chefer, Yuval Alaluf, Yael Vinker, Lior Wolf, and Daniel Cohen-Or. Attend-and-excite: Attentionbased semantic guidance for text-to-image diffusion models. ACM Transactions on Graphics, 2023.   \n[8] Junsong Chen, Jincheng YU, Chongjian GE, Lewei Yao, Enze Xie, Zhongdao Wang, James Kwok, Ping Luo, Huchuan Lu, and Zhenguo Li. Pixart- $\\alpha$ : Fast training of diffusion transformer for photorealistic text-to-image synthesis. In ICLR, 2024.   \n[9] Minghao Chen, Iro Laina, and Andrea Vedaldi. Training-free layout control with cross-attention guidance. In WACV, 2024.   \n[10] Jiaxin Cheng, Xiao Liang, Xingjian Shi, Tong He, Tianjun Xiao, and Mu Li. Layoutdiffuse: Adapting foundational diffusion models for layout-to-image generation. arXiv preprint arXiv:2302.08908, 2023.   \n[11] Guillaume Couairon, Marl\u00e8ne Careil, Matthieu Cord, St\u00e9phane Lathuili\u00e8re, and Jakob Verbeek. Zero-shot spatial layout conditioning for text-to-image diffusion models. arXiv preprint arXiv:2403.13589, 2023.   \n[12] Dave Epstein, Allan Jabri, Ben Poole, Alexei Efros, and Aleksander Holynski. Diffusion self-guidance for controllable image generation. In NeurIPS, 2023.   \n[13] Patrick Esser, Sumith Kulal, Andreas Blattmann, Rahim Entezari, Jonas M\u00fcller, Harry Saini, Yam Levi, Dominik Lorenz, Axel Sauer, Frederic Boesel, et al. Scaling rectified flow transformers for high-resolution image synthesis. arXiv preprint arXiv:2403.03206, 2024.   \n[14] Weixi Feng, Xuehai He, Tsu-Jui Fu, Varun Jampani, Arjun Akula, Pradyumna Narayana, Sugato Basu, Xin Eric Wang, and William Yang Wang. Training-free structured diffusion guidance for compositional text-to-image synthesis. In ICLR, 2023.   \n[15] Weixi Feng, Wanrong Zhu, Tsu-jui Fu, Varun Jampani, Arjun Akula, Xuehai He, Sugato Basu, Xin Eric Wang, and William Yang Wang. Layoutgpt: Compositional visual planning and generation with large language models. arXiv preprint arXiv:2305.15393, 2023.   \n[16] Oran Gafni, Adam Polyak, Oron Ashual, Shelly Sheynin, Devi Parikh, and Yaniv Taigman. Make-a-scene: Scene-based text-to-image generation with human priors. In ECCV, 2022.   \n[17] Songwei Ge, Taesung Park, Jun-Yan Zhu, and Jia-Bin Huang. Expressive text-to-image generation with rich text. In ICCV, 2023.   \n[18] Xiefan Guo, Jinlin Liu, Miaomiao Cui, Jiankai Li, Hongyu Yang, and Di Huang. Initno: Boosting text-to-image diffusion models via initial noise optimization. In CVPR, 2024.   \n[19] Amir Hertz, Ron Mokady, Jay Tenenbaum, Kfir Aberman, Yael Pritch, and Daniel Cohen-Or. Prompt-toprompt image editing with cross attention control. In ICLR, 2023.   \n[20] Amir Hertz, Andrey Voynov, Shlomi Fruchter, and Daniel Cohen-Or. Style aligned image generation via shared attention. In CVPR, 2024.   \n[21] Jack Hessel, Ari Holtzman, Maxwell Forbes, Ronan Le Bras, and Yejin Choi. CLIPScore: a reference-free evaluation metric for image captioning. In EMNLP, 2021.   \n[22] Jonathan Ho, Ajay Jain, and Pieter Abbeel. Denoising diffusion probabilistic models. In NeurIPS, 2020.   \n[23] Hyeonho Jeong and Jong Chul Ye. Ground-a-video: Zero-shot grounded video editing using text-to-image diffusion models. In ICLR, 2024.   \n[24] Gwanghyun Kim, Hayeon Kim, Hoigi Seo, Dong Un Kang, and Se Young Chun. Beyondscene: Higherresolution human-centric scene generation with pretrained diffusion. arXiv preprint arXiv:2404.04544, 2024.   \n[25] Jaihoon Kim, Juil Koo, Kyeongmin Yeo, and Minhyuk Sung. Synctweedies: A general generative framework based on synchronized diffusions. arXiv preprint arXiv:2403.14370, 2024.   \n[26] Yunji Kim, Jiyoung Lee, Jin-Hwa Kim, Jung-Woo Ha, and Jun-Yan Zhu. Dense text-to-image generation with attention modulation. In ICCV, 2023.   \n[27] Diederik P Kingma and Max Welling. Auto-encoding variational bayes. In ICLR, 2014.   \n[28] Yuval Kirstain, Adam Polyak, Uriel Singer, Shahbuland Matiana, Joe Penna, and Omer Levy. Pick-a-pic: An open dataset of user preferences for text-to-image generation. In NeurIPS, 2023.   \n[29] Yuseung Lee, Kunho Kim, Hyunjin Kim, and Minhyuk Sung. SyncDiffusion: Coherent montage via synchronized joint diffusions. In NeurIPS, 2023.   \n[30] Yuseung Lee and Minhyuk Sung. Reground: Improving textual and spatial grounding at no cost. arXiv preprint arXiv:2403.13589, 2024.   \n[31] Yuheng Li, Haotian Liu, Qingyang Wu, Fangzhou Mu, Jianwei Yang, Jianfeng Gao, Chunyuan Li, and Yong Jae Lee. Gligen: Open-set grounded text-to-image generation. In CVPR, 2023.   \n[32] Long Lian, Boyi Li, Adam Yala, and Trevor Darrell. Llm-grounded diffusion: Enhancing prompt understanding of text-to-image diffusion models with large language models. TMLR, 2024.   \n[33] Tsung-Yi Lin, Michael Maire, Serge Belongie, Lubomir Bourdev, Ross Girshick, James Hays, Pietro Perona, Deva Ramanan, C. Lawrence Zitnick, and Piotr Doll\u00e1r. Microsoft coco: Common objects in context, 2015.   \n[34] Yuxin Liu, Minshan Xie, Hanyuan Liu, and Tien-Tsin Wong. Text-guided texturing by synchronized multi-view diffusion. arXiv preprint arXiv:2311.12891, 2023.   \n[35] Cheng Lu, Yuhao Zhou, Fan Bao, Jianfei Chen, Chongxuan Li, and Jun Zhu. Dpm-solver: A fast ode solver for diffusion probabilistic model sampling in around 10 steps. In NeurIPS, 2022.   \n[36] Wan-Duo Kurt Ma, Avisek Lahiri, JP Lewis, Thomas Leung, and W Bastiaan Kleijn. Directed diffusion: Direct control of object placement through attention guidance. In AAAI, 2024.   \n[37] William Peebles and Saining Xie. Scalable diffusion models with transformers. In ICCV, 2023.   \n[38] Quynh Phung, Songwei Ge, and Jia-Bin Huang. Grounded text-to-image synthesis with attention refocusing. arXiv preprint arXiv:2306.05427, 2023.   \n[39] Dustin Podell, Zion English, Kyle Lacey, Andreas Blattmann, Tim Dockhorn, Jonas M\u00fcller, Joe Penna, and Robin Rombach. Sdxl: Improving latent diffusion models for high-resolution image synthesis. arXiv preprint arXiv:2307.01952, 2023.   \n[40] Alec Radford, Jong Wook Kim, Chris Hallacy, Aditya Ramesh, Gabriel Goh, Sandhini Agarwal, Girish Sastry, Amanda Askell, Pamela Mishkin, Jack Clark, et al. Learning transferable visual models from natural language supervision. In ICML, 2021.   \n[41] Robin Rombach, Andreas Blattmann, Dominik Lorenz, Patrick Esser, and Bj\u00f6rn Ommer. High-resolution image synthesis with latent diffusion models. In CVPR, 2022.   \n[42] Olaf Ronneberger, Philipp Fischer, and Thomas Brox. U-net: Convolutional networks for biomedical image segmentation. In Medical image computing and computer-assisted intervention\u2013MICCAI 2015: 18th international conference, 2015.   \n[43] Chitwan Saharia, William Chan, Saurabh Saxena, Lala Li, Jay Whang, Emily Denton, Seyed Kamyar Seyed Ghasemipour, Burcu Karagol Ayan, S. Sara Mahdavi, Rapha Gontijo Lopes, Tim Salimans, Jonathan Ho, David J Fleet, and Mohammad Norouzi. Photorealistic text-to-image diffusion models with deep language understanding. In NeurIPS, 2022.   \n[44] Takahiro Shirakawa and Seiichi Uchida. Noisecollage: A layout-aware text-to-image diffusion model based on noise cropping and merging. In CVPR, 2024.   \n[45] Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N Gomez, \u0141ukasz Kaiser, and Illia Polosukhin. Attention is all you need. In NeurIPS, 2017.   \n[46] Xudong Wang, Trevor Darrell, Sai Saketh Rambhatla, Rohit Girdhar, and Ishan Misra. Instancediffusion: Instance-level control for image generation. In CVPR, 2024.   \n[47] Jiayu Xiao, Liang Li, Henglei Lv, Shuhui Wang, and Qingming Huang. R&b: Region and boundary aware zero-shot grounded text-to-image generation. In ICLR, 2024.   \n[48] Jinheng Xie, Yuexiang Li, Yawen Huang, Haozhe Liu, Wentian Zhang, Yefeng Zheng, and Mike Zheng Shou. Boxdiff: Text-to-image synthesis with training-free box-constrained diffusion. In ICCV, 2023.   \n[49] Jiazheng Xu, Xiao Liu, Yuchen Wu, Yuxuan Tong, Qinkai Li, Ming Ding, Jie Tang, and Yuxiao Dong. Imagereward: Learning and evaluating human preferences for text-to-image generation. In NeurIPS, 2023.   \n[50] Ling Yang, Zhaochen Yu, Chenlin Meng, Minkai Xu, Stefano Ermon, and Bin Cui. Mastering text-to-image diffusion: Recaptioning, planning, and generating with multimodal llms. In ICML, 2024.   \n[51] Lvmin Zhang, Anyi Rao, and Maneesh Agrawala. Adding conditional control to text-to-image diffusion models. In ICCV, 2023.   \n[52] Richard Zhang, Phillip Isola, Alexei A. Efros, Eli Shechtman, and Oliver Wang. The unreasonable effectiveness of deep features as a perceptual metric. In CVPR, 2018.   \n[53] Guangcong Zheng, Xianpan Zhou, Xuewei Li, Zhongang Qi, Ying Shan, and Xi Li. Layoutdiffusion: Controllable diffusion model for layout-to-image generation. In CVPR, 2023.   \n[54] Dewei Zhou, You Li, Fan Ma, Xiaoting Zhang, and Yi Yang. Migc: Multi-instance generation controller for text-to-image synthesis. In CVPR, 2024.   \n[55] Xingyi Zhou, Vladlen Koltun, and Philipp Kr\u00e4henb\u00fchl. Simple multi-dataset detection. In CVPR, 2022. ", "page_idx": 10}, {"type": "text", "text": "", "page_idx": 11}, {"type": "text", "text": "", "page_idx": 12}, {"type": "text", "text": "Appendix ", "text_level": 1, "page_idx": 13}, {"type": "image", "img_path": "SXbyy0a3rY/tmp/16bfc52fdfb8d6ec59356b92d7fc61d38c3a24e9e5b4981f21112f0aecc818a4.jpg", "img_caption": [], "img_footnote": [], "page_idx": 13}, {"type": "image", "img_path": "SXbyy0a3rY/tmp/8a3d04d0732ec2722af1f22a898c88a07269b1eab27f2a1d62fb730a48cd2aa9.jpg", "img_caption": ["Figure 5: Spatially grounded images generated by our GROUNDIT with varying aspect ratios and sizes. Each image is generated based on a text prompt along with bounding boxes, which are displayed next to (or below) each image. "], "img_footnote": [], "page_idx": 13}, {"type": "text", "text": "A Positional Embeddings in Diffusion Transformers ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "Diffusion Transformers (DiT) [37] handle noisy images of varying aspect ratios and resolutions by processing them as a set of image tokens. For this, the noisy image is first divided into patches, with each patch subsequently converted into an image token of hidden dimension $D$ through a linear embedding layer. DiT then applies 2D sine-cosine positional embeddings to each image token, based on its coordinates $(x,y)$ , defined as follows: ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\begin{array}{r}{p_{x,y}:=\\mathrm{CONCAT}\\left[p_{x},\\ p_{y}\\right],\\quad\\mathrm{where}\\quad p_{x}:=\\left[\\cos(w_{d}\\cdot x),\\ \\sin(w_{d}\\cdot x)\\right]_{d=0}^{D/4}}\\\\ {p_{y}:=\\left[\\cos(w_{d}\\cdot y),\\ \\sin(w_{d}\\cdot y)\\right]_{d=0}^{D/4}}\\end{array}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "where $w_{d}=1/10000^{(4d/D)}$ . The positional embedding $p_{x,y}$ is then added to each corresponding image token, denoted as $\\operatorname{PE}(\\cdot)$ . ", "page_idx": 14}, {"type": "text", "text": "B Additional Quantitative Comparisons: Grounding Accuracy ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "In addition to Sec. 6.2, we provide further quantitative comparisons of grounding accuracy between our GROUNDIT and the baselines. Specifically, we generated images based on text prompts and bounding boxes using each method, then calculated the mean Intersection over Union (mIoU) between the detected bounding boxes from an object detection model [55] and the input bounding boxes. Below, we present the quantitative comparisons across three datasets with varying average numbers of bounding boxes: subset of MS-COCO-2014 [33], HRS-Spatial [3], and a custom dataset. ", "page_idx": 14}, {"type": "table", "img_path": "SXbyy0a3rY/tmp/1fdddd9042400c6bf2937ba879f93d79a5cb0632e96c45e2a2fa33c53a0c0734.jpg", "table_caption": ["Table 3: Average number of bounding boxes per dataset. "], "table_footnote": [], "page_idx": 14}, {"type": "text", "text": "Subset of MS-COCO-2014. We filtered the validation set of MS-COCO-2014 [33] to exclude image-caption pairs where the target objects were either not mentioned in the captions or duplicate objects were present. From this filtered set, we randomly selected 500 pairs for evaluation. ", "page_idx": 14}, {"type": "text", "text": "The results are presented in Tab. 4, column 2. GROUNDIT outperforms R&B by 0.021 (a $5.1\\%$ improvement) and PixArt-R&B by 0.014 (a $2.2\\%$ improvement). The relatively small margin can be attributed to the simplicity of the task, as this dataset has an average of 2.06 bounding boxes (Tab. 3), making it less challenging even for the baseline methods. ", "page_idx": 14}, {"type": "text", "text": "HRS-Spatial. Column 3 of Tab. 4 presents the results on the Spatial subset of the HRS dataset [3]. GROUNDIT surpasses R&B [47] by 0.046 (a $14.1\\%$ improvement) and PixArt-R&B by 0.038 (an $11.4\\%$ improvement). Compared to the results on the MS-COCO-2014 subset, the higher percentage increase in mIoU highlights the robustness of GROUNDIT under more complex grounding conditions. Note that HRS-Spatial has an average of 3.11 bounding boxes (Tab. 3), which is higher than that of the MS-COCO-2014 subset (2.06). ", "page_idx": 14}, {"type": "text", "text": "Custom Dataset. The custom dataset consists of 500 layout-text pairs, generated using the layout generation pipeline from LayoutGPT [15]. As shown in column 4 of Tab. 4, GROUNDIT outperforms R&B by 0.052 (a $26.3\\%$ improvement) and PixArt-R&B by 0.044 (a $21.4\\%$ improvement). This dataset has the highest average number of bounding boxes at 4.48 (Tab. 3). These results further emphasize the robustness and effectiveness of our approach in handling more complex grounding conditions with a larger number of bounding boxes. ", "page_idx": 14}, {"type": "table", "img_path": "SXbyy0a3rY/tmp/f7c7856eca33b39661eae947ce31baa3f8bf8390b021331e3d674a3316d89ff3.jpg", "table_caption": [], "table_footnote": ["Table 4: Quantitative comparisons of mIoU (\u2191) on a subset of MS-COCO-2014 [33], HRS-Spatial [3], and our custom dataset. Bold represents the best, and underline represents the second best method. "], "page_idx": 15}, {"type": "text", "text": "C Additional Quantitative Comparisons: Prompt Fidelity ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "In addition to Sec. 6.3, we provide further quantitative comparisons of the prompt fidelity of the generated images between our GROUNDIT and the baselines. We evaluated the generated images from the HRS dataset [3] using three different metrics: CLIP score [21], ImageReward [49], and PickScore [28]. The results are presented in Tab. 5. Since PickScore evaluates preferences between a pair of images, we report the difference between our GROUNDIT and each baseline method in column 4. Our GROUNDIT consistently outperforms the baselines in both CLIP score and ImageReward. For PickScore, GROUNDIT outperforms all baselines except PixArt-R&B, while remaining comparable. ", "page_idx": 15}, {"type": "table", "img_path": "SXbyy0a3rY/tmp/7d3380bd9c6727c0169874ece8a724bddca82ba8114556c969d0d6fec8f51a99.jpg", "table_caption": [], "table_footnote": ["Table 5: Quantitative comparisons of prompt fidelity on the HRS dataset [3]. Bold represents the best method. "], "page_idx": 15}, {"type": "text", "text": "D Additional Analysis on Semantic Sharing ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "In this section, we provide further analyses on the generatable resolution and the semantic sharing property of DiT, initially introduced in Sec. 5.2. ", "page_idx": 15}, {"type": "text", "text": "Generatable Resolution of DiT. Although recent DiT models can generate images at various resolutions, they still struggle to produce images at completely arbitrary resolutions. We speculate that this limitation arises not from the model architecture itself, but from the resolution of the training images, which typically falls within a specific range [8]. Generating images at resolutions far outside this range often results in implausible outputs, suggesting the existence of an acceptable resolution range for DiT, which we refer to as its generatable resolution. In Fig. 6, we illustrate this phenomenon. When the noisy image size falls within DiT\u2019s generatable resolution range, the model produces plausible images (rightmost two images). However, when the image size is significantly outside this range (leftmost two images), DiT fails to generate a plausible image. ", "page_idx": 15}, {"type": "image", "img_path": "SXbyy0a3rY/tmp/9713ce5833cf6c8704a5439981b1e31f0be5bdc8c011a0d412754e4bbafc2d82.jpg", "img_caption": ["Figure 6: Illustration of the generatable resolution range of DiT. The images are generated using PixArt- $\\cdot\\alpha$ [8] from the text prompt \u201cA dog\u201d, with varying resolutions. "], "img_footnote": [], "page_idx": 16}, {"type": "text", "text": "Semantic Sharing. Even though DiT models have a limited range of generatable resolutions, their Transformer architecture offers flexibility in handling varying lengths of image tokens, making it feasible to merge two sets of image tokens and denoise them through a single network evaluation. Leveraging this flexibility of Transformers, we presented our joint denoising technique (Alg. 1). Our main observation was that the joint denoising between two noisy images causes the two generated images to become semantically correlated, as illustrated in Fig. 3-(B) and Fig. 3-(C). ", "page_idx": 16}, {"type": "text", "text": "In addition to the visualizations in Fig. 3, we further quantify the semantic sharing property by measuring the LPIPS score [52] between two generated images. To explore the effect of joint denoising, we varied the parameter $\\gamma\\in[0,1]$ , which controls the proportion of denoising steps where joint denoising is applied. Specifically, $\\gamma=0$ means no joint denoising is applied, and each image is denoised independently, while $\\gamma=1$ means full joint denoising across all steps. As shown in Fig. 7, increasing $\\gamma$ (i.e., applying more joint denoising steps) results in a decrease in the LPIPS score between the two generated images, indicating that the images become more semantically similar as joint denoising is applied for a larger portion of the denoising process. ", "page_idx": 16}, {"type": "image", "img_path": "SXbyy0a3rY/tmp/d35c28fee32b344d41e8ef703c12d8f44f3eb8b40a13289888f1f0d8824f7d3d.jpg", "img_caption": ["(b) Semantic sharing between different resolutions "], "img_footnote": [], "page_idx": 16}, {"type": "image", "img_path": "SXbyy0a3rY/tmp/2085a9b1455bd7b3ff1a6000366dca11df83ff17ce3be930f8730b591487f532.jpg", "img_caption": ["(a) Semantic sharing between equal resolutions ", "Figure 7: LPIPS score between two generated images with varying $\\gamma$ value. A gradual decrease in LPIPS [52] indicates that joint denoising progressively enhances the similarity between the generated images. "], "img_footnote": [], "page_idx": 16}, {"type": "text", "text": "E Implementation Details ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "As the base text-to-image DiT model, we used the 512-resolution version of PixArt- $\\alpha$ [8]. For sampling we employed the DPM-Solver scheduler [35] with 50 steps. Out of the 50 denoising steps, we applied our GROUNDIT denoising step (Alg. 2) for the initial 25 steps, and applied the vanilla denoising step for the remaining 25 steps. For the grounding loss in Global Update of GROUNDIT, we adopted the definition proposed in R&B [47], and we set the loss scale to 10 and used a gradient descent weight of 5 for the gradient descent update in Eq. 7. ", "page_idx": 16}, {"type": "text", "text": "As discussed in Sec. 5.3, for each $i$ -th object branch we have a noisy object image $u_{i,t}$ and a noisy local patch $v_{i,t}$ , which is extracted from the noisy image $\\hat{\\mathbf{x}}_{t}$ in main branch via $\\mathbf{v}_{i,t}\\gets\\mathsf{C r o p}(\\hat{\\mathbf{x}}_{t},b_{i})$ . We determine the resolution of the noisy object image $u_{i,t}$ by selecting from PixArt- $\\cdot\\alpha$ \u2019s generatable resolutions, choosing one that best aligns with the aspect ratio of the corresponding bounding box $b_{i}$ . ", "page_idx": 16}, {"type": "text", "text": "All our experiments were conducted an NVIDIA RTX 3090 GPU. In Algorithm 2, we provide the pseudocode of GROUNDIT single denoising step. ", "page_idx": 17}, {"type": "table", "img_path": "SXbyy0a3rY/tmp/f2c88bdab02cf7d69de9f8e1517e9e4f63193ea49c21844386a1c8afbf286f9b.jpg", "table_caption": [], "table_footnote": [], "page_idx": 17}, {"type": "text", "text": "F Analysis on Computation Time ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "We present the average inference time based on the number of bounding boxes in Tab. 6. While our method shows a slight increase in inference time, the rate of increase remains modest. For three bounding boxes, the inference time is 1.01 times that of R&B and 1.33 times that of PixArt-R&B. Even with six bounding boxes, the inference time is only 1.41 times that of R&B and 1.90 times that of PixArt-R&B. ", "page_idx": 17}, {"type": "table", "img_path": "SXbyy0a3rY/tmp/55dbc686d35cd2d6387324e14cc315c47e69989770963db56c80ef59887c2624.jpg", "table_caption": [], "table_footnote": ["Table 6: Comparison of the average inference time based on the number of bounding boxes. Values in the table are given in seconds. "], "page_idx": 17}, {"type": "text", "text": "G Additional Qualitative Results ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "We provide more qualitative comparisons in Fig. 8. Our method demonstrates greater robustness against issues such as the missing object problem, attribute leakage, or object interruption problem [47], due to its local update mechanism with semantic sharing. For instance, in Row 1, baseline methods struggle to generate certain objects (i.e. missing object problem). In Row 2, baselines generate a banana that retains features of an apple, illustrating attribute leakage. In Row 3, R&B generates a bus that interrupts the generation of a couch, with part of the bus overlapping with the designate region of the couch. Similarly, in PixArt-R&B, a hamburger and a donut interrupt the generation of a surfboard, demonstrating the object interruption problem. In more challenging cases, like Row 4, combinations of these issues appear. By contrast, our method consistently generates each object accurately within specified locations, even under complex bounding box configurations, highlighting its robustness and precision. Additional results are shown in Fig. 9, and examples of various aspect ratio images generated with grounding conditions are provided in Fig. 5. ", "page_idx": 17}, {"type": "image", "img_path": "SXbyy0a3rY/tmp/360457a1db861e440593877c945843a1a2bf80dd9a7fc6125a5e2bfd29257487.jpg", "img_caption": ["Figure 8: Additional qualitative comparisons between our GROUNDIT, the previous state-of-the-art, R&B [47], and our internal baseline PixArt-R&B. Leftmost column shows the input bounding boxes, and columns 2-3 include the baseline results. The rightmost column includes the results of our GROUNDIT. ", ""], "img_footnote": [], "page_idx": 18}, {"type": "text", "text": "", "page_idx": 18}, {"type": "image", "img_path": "SXbyy0a3rY/tmp/f863d87d8dc8f12afe81886b46fe9399d09fd67d1ae148d56ca61da6d2af9963.jpg", "img_caption": ["Figure 9: Additional spatially grounded images generated by out GROUNDIT. "], "img_footnote": [], "page_idx": 19}, {"type": "text", "text": "NeurIPS Paper Checklist ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "1. Claims ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Question: Do the main claims made in the abstract and introduction accurately reflect the paper\u2019s contributions and scope? ", "page_idx": 20}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 20}, {"type": "text", "text": "Justification: Our abstract and introduction include our key contribution of improving the spatial grounding of Diffusion Transformers via noisy patch transplantation, and mention the experimental results. ", "page_idx": 20}, {"type": "text", "text": "Guidelines: ", "page_idx": 20}, {"type": "text", "text": "\u2022 The answer NA means that the abstract and introduction do not include the claims made in the paper.   \n\u2022 The abstract and/or introduction should clearly state the claims made, including the contributions made in the paper and important assumptions and limitations. A No or NA answer to this question will not be perceived well by the reviewers.   \n\u2022 The claims made should match theoretical and experimental results, and reflect how much the results can be expected to generalize to other settings.   \n\u2022 It is fine to include aspirational goals as motivation as long as it is clear that these goals are not attained by the paper. ", "page_idx": 20}, {"type": "text", "text": "2. Limitations ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Question: Does the paper discuss the limitations of the work performed by the authors? ", "page_idx": 20}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Justification: In the Conclusion section and Section D of appendix, we discuss our main limitation, which is the increased computation time for image generation. ", "page_idx": 20}, {"type": "text", "text": "Guidelines: ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "\u2022 The answer NA means that the paper has no limitation while the answer No means that the paper has limitations, but those are not discussed in the paper.   \n\u2022 The authors are encouraged to create a separate \"Limitations\" section in their paper.   \n\u2022 The paper should point out any strong assumptions and how robust the results are to violations of these assumptions (e.g., independence assumptions, noiseless settings, model well-specification, asymptotic approximations only holding locally). The authors should reflect on how these assumptions might be violated in practice and what the implications would be.   \n\u2022 The authors should reflect on the scope of the claims made, e.g., if the approach was only tested on a few datasets or with a few runs. In general, empirical results often depend on implicit assumptions, which should be articulated.   \n\u2022 The authors should reflect on the factors that influence the performance of the approach. For example, a facial recognition algorithm may perform poorly when image resolution is low or images are taken in low lighting. Or a speech-to-text system might not be used reliably to provide closed captions for online lectures because it fails to handle technical jargon.   \n\u2022 The authors should discuss the computational efficiency of the proposed algorithms and how they scale with dataset size.   \n\u2022 If applicable, the authors should discuss possible limitations of their approach to address problems of privacy and fairness.   \n\u2022 While the authors might fear that complete honesty about limitations might be used by reviewers as grounds for rejection, a worse outcome might be that reviewers discover limitations that aren\u2019t acknowledged in the paper. The authors should use their best judgment and recognize that individual actions in favor of transparency play an important role in developing norms that preserve the integrity of the community. Reviewers will be specifically instructed to not penalize honesty concerning limitations. ", "page_idx": 20}, {"type": "text", "text": "3. Theory Assumptions and Proofs ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Question: For each theoretical result, does the paper provide the full set of assumptions and a complete (and correct) proof? ", "page_idx": 21}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 21}, {"type": "text", "text": "Justification: Our work is mainly based on empirical observations regarding Diffusion Transformers, and does not include theoretical findings. ", "page_idx": 21}, {"type": "text", "text": "Guidelines: ", "page_idx": 21}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include theoretical results.   \n\u2022 All the theorems, formulas, and proofs in the paper should be numbered and crossreferenced.   \n\u2022 All assumptions should be clearly stated or referenced in the statement of any theorems.   \n\u2022 The proofs can either appear in the main paper or the supplemental material, but if they appear in the supplemental material, the authors are encouraged to provide a short proof sketch to provide intuition.   \n\u2022 Inversely, any informal proof provided in the core of the paper should be complemented by formal proofs provided in appendix or supplemental material.   \n\u2022 Theorems and Lemmas that the proof relies upon should be properly referenced. ", "page_idx": 21}, {"type": "text", "text": "4. Experimental Result Reproducibility ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "Question: Does the paper fully disclose all the information needed to reproduce the main experimental results of the paper to the extent that it affects the main claims and/or conclusions of the paper (regardless of whether the code and data are provided or not)? ", "page_idx": 21}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 21}, {"type": "text", "text": "Justification: In the appendix, we provide the exact model that our method is build upon, and the implementation details required for reproducing the method. ", "page_idx": 21}, {"type": "text", "text": "Guidelines: ", "page_idx": 21}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 If the paper includes experiments, a No answer to this question will not be perceived well by the reviewers: Making the paper reproducible is important, regardless of whether the code and data are provided or not.   \n\u2022 If the contribution is a dataset and/or model, the authors should describe the steps taken to make their results reproducible or verifiable.   \n\u2022 Depending on the contribution, reproducibility can be accomplished in various ways. For example, if the contribution is a novel architecture, describing the architecture fully might suffice, or if the contribution is a specific model and empirical evaluation, it may be necessary to either make it possible for others to replicate the model with the same dataset, or provide access to the model. In general. releasing code and data is often one good way to accomplish this, but reproducibility can also be provided via detailed instructions for how to replicate the results, access to a hosted model (e.g., in the case of a large language model), releasing of a model checkpoint, or other means that are appropriate to the research performed.   \n\u2022 While NeurIPS does not require releasing code, the conference does require all submissions to provide some reasonable avenue for reproducibility, which may depend on the nature of the contribution. For example (a) If the contribution is primarily a new algorithm, the paper should make it clear how to reproduce that algorithm. (b) If the contribution is primarily a new model architecture, the paper should describe the architecture clearly and fully. (c) If the contribution is a new model (e.g., a large language model), then there should either be a way to access this model for reproducing the results or a way to reproduce the model (e.g., with an open-source dataset or instructions for how to construct the dataset). (d) We recognize that reproducibility may be tricky in some cases, in which case authors are welcome to describe the particular way they provide for reproducibility. In the case of closed-source models, it may be that access to the model is limited in some way (e.g., to registered users), but it should be possible for other researchers to have some path to reproducing or verifying the results. ", "page_idx": 21}, {"type": "text", "text": "5. Open access to data and code ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Question: Does the paper provide open access to the data and code, with sufficient instructions to faithfully reproduce the main experimental results, as described in supplemental material? ", "page_idx": 22}, {"type": "text", "text": "Answer: [No] ", "page_idx": 22}, {"type": "text", "text": "Justification: While we have not provided the code yet, we provide a link to our project page, at which we will provide the official code for our method. ", "page_idx": 22}, {"type": "text", "text": "Guidelines: ", "page_idx": 22}, {"type": "text", "text": "\u2022 The answer NA means that paper does not include experiments requiring code.   \n\u2022 Please see the NeurIPS code and data submission guidelines (https://nips.cc/ public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 While we encourage the release of code and data, we understand that this might not be possible, so \u201cNo\u201d is an acceptable answer. Papers cannot be rejected simply for not including code, unless this is central to the contribution (e.g., for a new open-source benchmark).   \n\u2022 The instructions should contain the exact command and environment needed to run to reproduce the results. See the NeurIPS code and data submission guidelines (https: //nips.cc/public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 The authors should provide instructions on data access and preparation, including how to access the raw data, preprocessed data, intermediate data, and generated data, etc.   \n\u2022 The authors should provide scripts to reproduce all experimental results for the new proposed method and baselines. If only a subset of experiments are reproducible, they should state which ones are omitted from the script and why.   \n\u2022 At submission time, to preserve anonymity, the authors should release anonymized versions (if applicable).   \n\u2022 Providing as much information as possible in supplemental material (appended to the paper) is recommended, but including URLs to data and code is permitted. ", "page_idx": 22}, {"type": "text", "text": "6. Experimental Setting/Details ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Question: Does the paper specify all the training and test details (e.g., data splits, hyperparameters, how they were chosen, type of optimizer, etc.) necessary to understand the results? ", "page_idx": 22}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 22}, {"type": "text", "text": "Justification: Both in the Results section and Appendix, we provide the used benchmarks, our experiment settings, and the used hyperparameters. ", "page_idx": 22}, {"type": "text", "text": "Guidelines: ", "page_idx": 22}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments. \u2022 The experimental setting should be presented in the core of the paper to a level of detail that is necessary to appreciate the results and make sense of them. \u2022 The full details can be provided either with the code, in appendix, or as supplemental material. ", "page_idx": 22}, {"type": "text", "text": "7. Experiment Statistical Significance ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Question: Does the paper report error bars suitably and correctly defined or other appropriate information about the statistical significance of the experiments? ", "page_idx": 22}, {"type": "text", "text": "Answer: [No] ", "page_idx": 22}, {"type": "text", "text": "Justification: We do not provide error bars for the experiments as we have not run our main experiments multiple times. ", "page_idx": 22}, {"type": "text", "text": "Guidelines: ", "page_idx": 22}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments. \u2022 The authors should answer \"Yes\" if the results are accompanied by error bars, confidence intervals, or statistical significance tests, at least for the experiments that support the main claims of the paper. ", "page_idx": 22}, {"type": "text", "text": "\u2022 The factors of variability that the error bars are capturing should be clearly stated (for example, train/test split, initialization, random drawing of some parameter, or overall run with given experimental conditions).   \n\u2022 The method for calculating the error bars should be explained (closed form formula, call to a library function, bootstrap, etc.)   \n\u2022 The assumptions made should be given (e.g., Normally distributed errors).   \n\u2022 It should be clear whether the error bar is the standard deviation or the standard error of the mean.   \n\u2022 It is OK to report 1-sigma error bars, but one should state it. The authors should preferably report a 2-sigma error bar than state that they have a $96\\%$ CI, if the hypothesis of Normality of errors is not verified.   \n\u2022 For asymmetric distributions, the authors should be careful not to show in tables or figures symmetric error bars that would yield results that are out of range (e.g. negative error rates).   \n\u2022 If error bars are reported in tables or plots, The authors should explain in the text how they were calculated and reference the corresponding figures or tables in the text. ", "page_idx": 23}, {"type": "text", "text": "8. Experiments Compute Resources ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: For each experiment, does the paper provide sufficient information on the computer resources (type of compute workers, memory, time of execution) needed to reproduce the experiments? ", "page_idx": 23}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 23}, {"type": "text", "text": "Justification: We provide the specific GPU resources and also the inference time of our generation method. ", "page_idx": 23}, {"type": "text", "text": "Guidelines: ", "page_idx": 23}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The paper should indicate the type of compute workers CPU or GPU, internal cluster, or cloud provider, including relevant memory and storage.   \n\u2022 The paper should provide the amount of compute required for each of the individual experimental runs as well as estimate the total compute.   \n\u2022 The paper should disclose whether the full research project required more compute than the experiments reported in the paper (e.g., preliminary or failed experiments that didn\u2019t make it into the paper). ", "page_idx": 23}, {"type": "text", "text": "9. Code Of Ethics ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: Does the research conducted in the paper conform, in every respect, with the NeurIPS Code of Ethics https://neurips.cc/public/EthicsGuidelines? ", "page_idx": 23}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 23}, {"type": "text", "text": "Justification: Our research process and results adhere to the NeurIPS Code of Ethics. Guidelines: ", "page_idx": 23}, {"type": "text", "text": "\u2022 The answer NA means that the authors have not reviewed the NeurIPS Code of Ethics.   \n\u2022 If the authors answer No, they should explain the special circumstances that require a deviation from the Code of Ethics.   \n\u2022 The authors should make sure to preserve anonymity (e.g., if there is a special consideration due to laws or regulations in their jurisdiction). ", "page_idx": 23}, {"type": "text", "text": "10. Broader Impacts ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: Does the paper discuss both potential positive societal impacts and negative societal impacts of the work performed? ", "page_idx": 23}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 23}, {"type": "text", "text": "Justification: In the Conclusion section, we discuss the potential societal impacts of our work. ", "page_idx": 23}, {"type": "text", "text": "Guidelines: \u2022 The answer NA means that there is no societal impact of the work performed. ", "page_idx": 23}, {"type": "text", "text": "\u2022 If the authors answer NA or No, they should explain why their work has no societal impact or why the paper does not address societal impact.   \n\u2022 Examples of negative societal impacts include potential malicious or unintended uses (e.g., disinformation, generating fake profiles, surveillance), fairness considerations (e.g., deployment of technologies that could make decisions that unfairly impact specific groups), privacy considerations, and security considerations.   \n\u2022 The conference expects that many papers will be foundational research and not tied to particular applications, let alone deployments. However, if there is a direct path to any negative applications, the authors should point it out. For example, it is legitimate to point out that an improvement in the quality of generative models could be used to generate deepfakes for disinformation. On the other hand, it is not needed to point out that a generic algorithm for optimizing neural networks could enable people to train models that generate Deepfakes faster.   \n\u2022 The authors should consider possible harms that could arise when the technology is being used as intended and functioning correctly, harms that could arise when the technology is being used as intended but gives incorrect results, and harms following from (intentional or unintentional) misuse of the technology.   \n\u2022 If there are negative societal impacts, the authors could also discuss possible mitigation strategies (e.g., gated release of models, providing defenses in addition to attacks, mechanisms for monitoring misuse, mechanisms to monitor how a system learns from feedback over time, improving the efficiency and accessibility of ML). ", "page_idx": 24}, {"type": "text", "text": "11. Safeguards ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Question: Does the paper describe safeguards that have been put in place for responsible release of data or models that have a high risk for misuse (e.g., pretrained language models, image generators, or scraped datasets)? ", "page_idx": 24}, {"type": "text", "text": "Answer: [No] ", "page_idx": 24}, {"type": "text", "text": "Justification: We do not discuss any additional safeguards for our method. However, we adhere to the safeguards already implemented in text-to-image models that we utilize. ", "page_idx": 24}, {"type": "text", "text": "Guidelines: ", "page_idx": 24}, {"type": "text", "text": "\u2022 The answer NA means that the paper poses no such risks.   \n\u2022 Released models that have a high risk for misuse or dual-use should be released with necessary safeguards to allow for controlled use of the model, for example by requiring that users adhere to usage guidelines or restrictions to access the model or implementing safety filters.   \n\u2022 Datasets that have been scraped from the Internet could pose safety risks. The authors should describe how they avoided releasing unsafe images.   \n\u2022 We recognize that providing effective safeguards is challenging, and many papers do not require this, but we encourage authors to take this into account and make a best faith effort. ", "page_idx": 24}, {"type": "text", "text": "12. Licenses for existing assets ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Question: Are the creators or original owners of assets (e.g., code, data, models), used in the paper, properly credited and are the license and terms of use explicitly mentioned and properly respected? ", "page_idx": 24}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 24}, {"type": "text", "text": "Justification: We credit the authors of Attention Refocusing [38] who have suggested the evaluation method, and also the creators of HRS [3] and DrawBench [43]. ", "page_idx": 24}, {"type": "text", "text": "Guidelines: ", "page_idx": 24}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not use existing assets.   \n\u2022 The authors should cite the original paper that produced the code package or dataset.   \n\u2022 The authors should state which version of the asset is used and, if possible, include a URL.   \n\u2022 The name of the license (e.g., CC-BY 4.0) should be included for each asset.   \n\u2022 For scraped data from a particular source (e.g., website), the copyright and terms of service of that source should be provided.   \n\u2022 If assets are released, the license, copyright information, and terms of use in the package should be provided. For popular datasets, paperswithcode.com/datasets has curated licenses for some datasets. Their licensing guide can help determine the license of a dataset.   \n\u2022 For existing datasets that are re-packaged, both the original license and the license of the derived asset (if it has changed) should be provided.   \n\u2022 If this information is not available online, the authors are encouraged to reach out to the asset\u2019s creators. ", "page_idx": 24}, {"type": "text", "text": "", "page_idx": 25}, {"type": "text", "text": "13. New Assets ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "Question: Are new assets introduced in the paper well documented and is the documentation provided alongside the assets? ", "page_idx": 25}, {"type": "text", "text": "Answer: [No] ", "page_idx": 25}, {"type": "text", "text": "Justification: For the custom benchmarks that we have used in additional experiments in the appendix, we plan to open-source them along with the official code. ", "page_idx": 25}, {"type": "text", "text": "Guidelines: ", "page_idx": 25}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not release new assets.   \n\u2022 Researchers should communicate the details of the dataset/code/model as part of their submissions via structured templates. This includes details about training, license, limitations, etc.   \n\u2022 The paper should discuss whether and how consent was obtained from people whose asset is used.   \n\u2022 At submission time, remember to anonymize your assets (if applicable). You can either create an anonymized URL or include an anonymized zip file. ", "page_idx": 25}, {"type": "text", "text": "14. Crowdsourcing and Research with Human Subjects ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "Question: For crowdsourcing experiments and research with human subjects, does the paper include the full text of instructions given to participants and screenshots, if applicable, as well as details about compensation (if any)? ", "page_idx": 25}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 25}, {"type": "text", "text": "Justification: We do not include research with crowdsourcing and human subjects. ", "page_idx": 25}, {"type": "text", "text": "Guidelines: ", "page_idx": 25}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Including this information in the supplemental material is fine, but if the main contribution of the paper involves human subjects, then as much detail as possible should be included in the main paper.   \n\u2022 According to the NeurIPS Code of Ethics, workers involved in data collection, curation, or other labor should be paid at least the minimum wage in the country of the data collector. ", "page_idx": 25}, {"type": "text", "text": "15. Institutional Review Board (IRB) Approvals or Equivalent for Research with Human Subjects ", "text_level": 1, "page_idx": 25}, {"type": "text", "text": "Question: Does the paper describe potential risks incurred by study participants, whether such risks were disclosed to the subjects, and whether Institutional Review Board (IRB) approvals (or an equivalent approval/review based on the requirements of your country or institution) were obtained? ", "page_idx": 25}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 25}, {"type": "text", "text": "Justification: We do not include research with crowdsourcing and human subjects. Guidelines: ", "page_idx": 25}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects. ", "page_idx": 25}, {"type": "text", "text": "\u2022 Depending on the country in which research is conducted, IRB approval (or equivalent) may be required for any human subjects research. If you obtained IRB approval, you should clearly state this in the paper.   \n\u2022 We recognize that the procedures for this may vary significantly between institutions and locations, and we expect authors to adhere to the NeurIPS Code of Ethics and the guidelines for their institution.   \n\u2022 For initial submissions, do not include any information that would break anonymity (if applicable), such as the institution conducting the review. ", "page_idx": 26}]