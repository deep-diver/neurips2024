Towards Exact Gradient-based Training on Analog In-memory Computing