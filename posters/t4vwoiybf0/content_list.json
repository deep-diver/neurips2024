[{"type": "text", "text": "C-GAIL: Stabilizing Generative Adversarial Imitation Learning with Control Theory ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Tianjiao Luo1, Tim Pearce2, Huayu Chen1, Jianfei Chen1, Jun Zhu1\u2217 ", "page_idx": 0}, {"type": "text", "text": "1Dept. of Comp. Sci. and Tech., Institute for AI, Tsinghua-Bosch Joint ML Center, THBI Lab, BNRist Center, Tsinghua University, Beijing 100084, China 2Microsoft Research {luotj21, chenhuay21}@mails.tsinghua.edu.cn {jianfeic, dcszj}@tsinghua.edu.cn ", "page_idx": 0}, {"type": "text", "text": "Abstract ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Generative Adversarial Imitation Learning (GAIL) provides a promising approach to training a generative policy to imitate a demonstrator. It uses on-policy Reinforcement Learning (RL) to optimize a reward signal derived from an adversarial discriminator. However, optimizing GAIL is difficult in practise, with the training loss oscillating during training, slowing convergence. This optimization instability can prevent GAIL from finding a good policy, harming its final performance. In this paper, we study GAIL\u2019s optimization from a control-theoretic perspective. We show that GAIL cannot converge to the desired equilibrium. In response, we analyze the training dynamics of GAIL in function space and design a novel controller that not only pushes GAIL to the desired equilibrium but also achieves asymptotic stability in a simplified \u201cone-step\u201d setting. Going from theory to practice, we propose Controlled-GAIL (C-GAIL), which adds a differentiable regularization term on the GAIL objective to stabilize training. Empirically, the C-GAIL regularizer improves the training of various existing GAIL methods, including the popular GAIL-DAC, by speeding up the convergence, reducing the range of oscillation, and matching the expert distribution more closely. ", "page_idx": 0}, {"type": "text", "text": "1 Introduction ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Generative Adversarial Imitation Learning (GAIL) [1] aims to learn a decision-making policy in a sequential environment by imitating trajectories collected from an expert demonstrator. Inspired by Generative Adversarial Networks (GANs) [2], GAIL consists of a learned policy serving as a generator, and a discriminator distinguishing expert trajectories from generated ones. The learned policy is optimized through Reinforcement Learning (RL) with a reward signal derived from the discriminator. This paradigm offers distinct advantages over other imitation learning strategies such as Inverse Reinforcement Learning (IRL), which requires an explicit model of the reward function [3], and Behavior Cloning (BC), which suffers from a distribution mismatch during roll-outs [4]. ", "page_idx": 0}, {"type": "text", "text": "Meanwhile, GAIL does bring certain challenges. One key issue it inherits from GANs is instability during training [5]. GAIL presents a difficult minimax optimization problem, where the convergence of the discriminator and the policy generator towards their optimal points is not guaranteed in general. This problem manifests in practice as oscillating training curves and an inconsistency in matching the expert\u2019s performance (Fig. 1). However, recent empirical works [6\u201310] on GAIL mostly focus on improving the sample efficiency and final return of the learned policy, without directly resolving the problem of unstable training. On the other hand, theoretical works [11\u201314] on GAIL\u2019s convergence are based on strong assumptions and do not yield a practical algorithm for stabilizing training. ", "page_idx": 0}, {"type": "image", "img_path": "t4VwoIYBf0/tmp/ec00ba6903266ad55987855401ae1532a50cc0fd5063393c1c906e34f4a47682.jpg", "img_caption": ["Figure 1: Normalized return curves for controlled GAIL-DAC with four expert demonstrations on five MuJoCo environments averaged over five random seeds. The ${\\bf X}$ -axis represents the number of gradient step updates in millions and the y-axis represents the normalized environment reward, where 1 stands for the expert policy return and 0 stands for the random policy return "], "img_footnote": [], "page_idx": 1}, {"type": "text", "text": "In this paper, we study GAIL\u2019s training stability using control theory. We describe how the generative policy and discriminator evolve over training at timestep $t$ with a dynamical system of differential equations. We study whether the system can converge to the desired state where the generator perfectly matches with the expert policy and the discriminator cannot distinguish generated from expert trajectories. This surprisingly reveals that the desirable state is not an equilibrium of the system, indicating that existing algorithms do not converge to the expert policy, even with unlimited data and model capacity. In response, we study a \u201cone-step GAIL\u201d setting, and design a controller that does create an equilibrium at the desired state. We theoretically prove that this controller achieves asymptotic stability around this desired state, which means that if initialized within a sufficiently close radius, the generator and discriminator will indeed converge to it. ", "page_idx": 1}, {"type": "text", "text": "Motivated by our theoretical analysis, we propose C-GAIL, which incorporates a pragmatic controller that can be added as a regularization term to the loss function to stabilize training in practice. Empirically we find that our method speeds up the convergence, reduces the range of oscillation in the return curves (shown on Fig. 1), and matches the expert\u2019s distribution more closely on GAIL-DAC and other imitation learning methods for a suite of MuJoCo control tasks. ", "page_idx": 1}, {"type": "text", "text": "1.1 Related Work ", "text_level": 1, "page_idx": 1}, {"type": "text", "text": "Adversarial imitation learning. Inspired by GANs and IRL, Adversarial Imitation Learning (AIL) has emerged as a popular technique to learn from demonstrations. GAIL [1] formulated the problem as matching an occupancy measure under the maximum entropy RL framework, with a discriminator providing the policy reward signal, bypassing the need to recover the expert\u2019s reward function. Several advancements were subsequently proposed to enhance performance and stability. For instance, AIRL [6] replaced the Shannon-Jensen divergence of GAIL by KL divergence. Baram et al. [15] explored combining GAIL with model-based reinforcement learning. DAC [9] utilized a replay buffer to remove the need for importance sampling and address the issue of absorbing states. Other empirical works such as [7\u201310, 16] helped improve the sample efficiency and final return of GAIL. In contrast, our work focuses on the orthogonal direction of training stability. ", "page_idx": 1}, {"type": "text", "text": "Meanwhile, the convergence behaviors of AIL have also been investigated theoretically. Chen et al. [11] proved that GAIL convergences to a stationary point (not necessarily the desired state). The convergence to the desired state has only been established under strong assumptions such as i.i.d. samples and linear MDP [12, 13] and strongly concave objective functions [14]. However, existing theory has not analyzed the convergence behavior to the desired state in a general setting, and has so far not presented practically useful algorithms to improve GAIL\u2019s convergence. Our analysis in Sec. 3.2 show that GAIL actually cannot converge to the desired state under general settings. ", "page_idx": 1}, {"type": "text", "text": "Additionally, our proposed controller achieves not only a theoretical convergence guarantee, but also empirical improvements in terms of convergence speed and range of oscillation. ", "page_idx": 2}, {"type": "text", "text": "Control theory in GANs. Control theory has recently emerged as a promising technique for studying the convergence of GANs. Xu et al. [17] designed a linear controller which offers GANs local stability. Luo et al. [18] utilized a Brownian motion controller which was shown to offer GANs global exponential stability. However, for GAIL, the policy generator involves an MDP transition, which results in a much more complicated dynamical system induced by a policy acting in an MDP rather than a static data generating distribution. Prior theoretical analysis and controllers are therefore inapplicable. We adopt different analysis and controlling techniques, to present new stability guarantee, controller, and theoretical results for the different dynamical system of GAIL. ", "page_idx": 2}, {"type": "text", "text": "2 Preliminaries ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "We start by formally introducing our problem setting, as well as necessary definitions and theorems relating to the stability of dynamical systems represented by Ordinary Differential Equations (ODEs). ", "page_idx": 2}, {"type": "text", "text": "2.1 Problem Setting ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "Consider a Markov Decision Process (MDP), described by the tuple $\\langle S,A,\\mathcal{P},r,p_{0},\\gamma\\rangle$ , where $\\boldsymbol{S}$ is the state space, $\\boldsymbol{\\mathcal{A}}$ is the action space, $\\mathcal{P}(s^{\\prime}|s,a)$ is the transition probability function, $r(s,a)$ is the reward function, $p_{0}$ is the probability distribution of the initial state $s_{0}$ , and $\\gamma\\in[0,1]$ is the discount factor. We work on the $\\gamma$ -discounted infinite horizon setting, and define the expectation with respect to a policy $\\pi\\in\\Pi$ as the (discounted) expectation over the trajectory it generates. For some arbitrary function $g$ we have $\\mathbb{E}_{\\pi}[g(s,a)]\\triangleq\\mathbb{E}[\\Sigma_{n=0}^{\\infty}\\gamma^{n}g(s_{n},a_{n})]$ , where $a_{n}\\sim\\pi(a_{n}|s_{n})$ , $s_{0}\\sim p_{0}$ , $s_{n+1}\\sim$ $\\mathcal{P}(s_{n+1}|s_{n},a_{n})$ . Note that we use $n$ to represent the environment timestep, reserving $t$ to denote the training timestep of GAIL. For a policy $\\pi\\in\\Pi$ , We define its (unnormalized) state occupancy $\\begin{array}{r}{\\rho_{\\pi}(s)=\\sum_{n=0}^{\\infty}\\gamma^{n}P(s_{n}=s|\\pi)}\\end{array}$ . We denote $Q^{\\pi}(s,a)=\\mathbb{E}_{\\pi}[\\log D(\\bar{s},\\bar{a})+\\lambda\\log\\pi(\\bar{a}|\\bar{s})|s_{0}=s,a_{0}=$ $a]$ and th e advantage function $A^{\\pi}(s,a)=Q^{\\pi}(s,a)-\\mathbb{E}_{\\pi}[Q^{\\pi}(s,a)]$ . We assume the setting where we are given a dataset of trajectories $\\tau_{E}$ consisting of state-action tuples, collected from an expert policy $\\pi_{E}$ . We assume access to interact in the environment in order to learn a policy $\\pi$ , but do not make use of any external reward signal (except during evaluation). ", "page_idx": 2}, {"type": "text", "text": "2.2 Dynamical Systems and Control Theory ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "In this paper, we consider dynamical systems represented by an ODE of the form ", "page_idx": 2}, {"type": "equation", "text": "$$\n{\\frac{d x(t)}{d t}}=f(x(t)),\n$$", "text_format": "latex", "page_idx": 2}, {"type": "text", "text": "where $x$ represents some property of the system, $t$ refers to the timestep of the system and $f$ is a function. The necessary condition for a solution trajectory $\\{x(t)\\}_{t\\geq0}$ converging to some steady state value is the existence of an \u2018equilibrium\u2019. ", "page_idx": 2}, {"type": "text", "text": "Definition 2.1. (Equilibrium) [19] A point $\\textstyle{\\bar{x}}$ is an equilibrium of system (1) if $f({\\bar{x}})=0$ . Such an equilibrium is also called a fixed point, critical point, or steady state. ", "page_idx": 2}, {"type": "text", "text": "Note that a dynamical system is unable to converge if an equilibrium does not exist. A second important property of dynamical systems is \u2018stability\u2019. The stability of a dynamical system can be described with Lyapunov stability criteria. More formally, suppose $\\bar{\\{x(t)\\}}_{t\\geq0}$ is a solution trajectory of the above system (1) with equilibrium $\\textstyle{\\bar{x}}$ , we define two types of stability. ", "page_idx": 2}, {"type": "text", "text": "Definition 2.2. (Lyapunov Stability) [20] System (1) is Lyapunov Stable if given any $\\epsilon>0$ , there exists a $\\delta>0$ such that whenever $\\|x(0)-{\\bar{x}}\\|\\leq\\delta$ , we have $\\|x(t)-\\bar{x}\\|<\\epsilon$ for $0\\le t\\le\\infty$ . ", "page_idx": 2}, {"type": "text", "text": "Definition 2.3. (Asymptotic Stability) [20] System (1) is asymptotic stable if it is Lyapunov stable, and there exists a $\\delta>0$ such that whenever $\\|x(0)-{\\bar{x}}\\|\\leq\\delta$ , we have $\\begin{array}{r}{\\operatorname*{lim}_{t\\rightarrow\\infty}\\lVert\\boldsymbol{x}(t)-\\bar{\\boldsymbol{x}}\\rVert=0}\\end{array}$ . ", "page_idx": 2}, {"type": "text", "text": "Note that a dynamical system can be Lyapnuov stable but not asymptotic stable. However, every asymptotic stable dynamical system is Lyapnuov stable. ", "page_idx": 2}, {"type": "text", "text": "The field of control theory has studied how to drive dynamical systems to desired states. This can be achieved through the addition of a \u2018controller\u2019 to allow influence over the dynamical system\u2019s evolution, for example creating an equilibrium at some desired state, and making the dynamical system stable around it. ", "page_idx": 2}, {"type": "text", "text": "", "page_idx": 3}, {"type": "text", "text": "Definition 2.4. (Controller) [21] A controller of a dynamical system is a function $u(t)$ such that ", "page_idx": 3}, {"type": "equation", "text": "$$\n{\\frac{d x(t)}{d t}}=f(x(t))+u(t).\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "The equilibrium and stability criteria introduced for dynamical system (1), equally apply to this controlled dynamical system (2). In order to analyze the stability of a controller $u(t)$ of the controlled dynamical system given an equilibrium $\\textstyle{\\bar{x}}$ , the following result will be useful. ", "page_idx": 3}, {"type": "text", "text": "Theorem 2.5. (Principle of Linearized Stability) $\\it{[22]}\\ A$ controlled dynamical system (2) with equilibrium $\\textstyle{\\bar{x}}$ is asymptotically stable if all eigenvalues of $\\mathbb{J}(f({\\bar{x}})+u(t))$ have negative real parts, where $\\mathbb{J}(f({\\bar{x}})+u(t))$ represents the Jacobian of $f(x(t))+u(t)$ evaluated at $\\bar{x}$ . ", "page_idx": 3}, {"type": "text", "text": "Corollary 2.6. If $\\mathbb{J}(f({\\bar{x}})+u(t))$ has positive determinant and negative trace, all its eigenvalues have negative real parts and the system is asymptotically stable. ", "page_idx": 3}, {"type": "text", "text": "3 Analyzing GAIL as a Dynamical System ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "In this section, we study the training stability of GAIL through the lens of control theory. We derive the differential equations governing the training process of GAIL, framing it as a dynamical system. Then, we analyze the convergence of GAIL and find that it cannot converge to the desired equilibrium due to the entropy term. For simplicity, we limit the theoretical analysis to the original GAIL[1] among many variants [6\u201310], while the controller proposed in the next section is general. ", "page_idx": 3}, {"type": "text", "text": "3.1 GAIL Dynamics ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "GAIL consists of a learned generative policy $\\pi_{\\theta}:{\\mathcal{S}}\\rightarrow A$ and a discriminator $D_{\\omega}:S\\times A\\to(0,1)$ . The discriminator estimates the probability that an input state-action pair is from the expert policy, rather than the learned policy. GAIL alternatively updates the policy and discriminator parameters, $\\theta$ and $\\omega$ . (The parameter subscripts are subsequently dropped for clarity.) The GAIL objective [1] is $\\mathbb{E}_{\\pi}[\\log(D(s,\\stackrel{\\cdot}{a}))]+\\mathbb{E}_{\\pi_{E}}[\\log(\\stackrel{\\cdot}{1}-D(s,a))]-\\lambda\\dot{H(\\pi)}$ , where $\\pi_{E}$ is the expert demonstrator policy, $\\pi$ is the learned policy, and $H(\\pi)\\,\\equiv\\,\\mathbb{E}_{\\pi}[-\\log\\pi(a|s)]$ is its entropy. Respectively, the objective functions for the discriminator and policy (to be maximized and minimized respectively) are, ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{V_{D}(D,\\pi)=\\mathbb{E}_{\\pi}[\\log D(s,a)]+\\mathbb{E}_{\\pi_{E}}[\\log(1-D(s,a))]}\\\\ &{V_{\\pi}(D,\\pi)=\\mathbb{E}_{\\pi}[\\log D(s,a)]-\\lambda\\mathbb{E}_{\\pi}[-\\log\\pi(a|s)].}\\end{array}\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "To describe GAIL as a dynamical system, we express how $\\pi$ and $D$ evolve during training. For the analysis to be tractable, we study the training dynamics from a variational perspective, by directly considering the optimization of $\\pi$ and $D$ in their respective function spaces. This approach has been used in other theoretical deep learning works [2, 5, 23] to avoid complications of the parameter space. ", "page_idx": 3}, {"type": "text", "text": "We start by considering optimizing Eq. (3) with functional gradient descent with discrete iterations indexed by $\\begin{array}{r}{m\\colon D_{m+1}(s,a)=D_{m}(s,a)\\!+\\!\\beta\\frac{\\partial V_{D}(D_{m},\\pi_{m})}{\\partial D_{m}(s,a)}}\\end{array}$ , and $\\begin{array}{r}{\\pi_{m+1}(a|s)=\\pi_{m}(a|s)-\\beta\\frac{\\partial V_{\\pi}(D_{m},\\pi_{m})}{\\partial\\pi_{m}(a|s)}}\\end{array}$ , where $\\beta$ is the learning rate, $m$ the discrete iteration numbe r, \u2202VD(Dm,\u03c0m)(similarly for \u2202Dm(s,a) $\\frac{\\partial V_{\\pi}(D_{m},\\pi_{m})}{\\partial\\pi_{m}(a|s)})$ is the functional derivative [24] defined via $\\begin{array}{r}{\\partial V_{D}(D_{m},\\pi_{m})\\,=\\,\\int\\frac{\\partial V_{D}(D_{m},\\pi_{m})}{\\partial D_{m}(s,a)}\\partial D_{m}(s,a)}\\end{array}$ $d a$ which implies the total change in $V_{D}$ upon variation of function $D_{m}$ is a linear superposition [25] of the local changes summed over the whole range of $(s,a)$ value pairs. ", "page_idx": 3}, {"type": "text", "text": "We then consider the limit $\\beta\\rightarrow0$ , where discrete dynamics become continuous (\u2018gradient flow\u2019) $\\begin{array}{r}{\\frac{d D_{t}(s,a)}{d t}\\,=\\,\\frac{\\partial V_{D}(D_{t},\\pi_{t})}{\\partial D_{t}(s,a)}\\,}\\end{array}$ , and d\u03c0t(a|s) $\\begin{array}{r}{\\frac{d\\pi_{t}(a|s)}{d t}\\,=\\,\\frac{-\\partial V_{\\pi}(D_{t},\\pi_{t})}{\\partial\\pi_{t}(a|s)}}\\end{array}$ \u2212\u2202\u2202V\u03c0\u03c0((aD|ts,)\u03c0t). Formally, we consider the evolution of the discriminator function $D_{t}:S\\times A\\to\\mathbb{R}$ and the policy generator $\\pi_{t}:\\mathcal{S}\\rightarrow\\mathcal{A}$ over continuous time $t$ rather than discrete time $m$ . We derive the training dynamic of GAIL in the following theorem. ", "page_idx": 3}, {"type": "text", "text": "Theorem 3.1. The training dynamic of GAIL takes the form (detailed proof in Appendix Lemma $C.2$ ) ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\begin{array}{c}{{\\displaystyle\\frac{d D_{t}(s,a)}{d t}=\\frac{\\rho_{\\pi_{t}}(s)\\pi_{t}(a|s)}{D_{t}(s,a)}-\\frac{\\rho_{\\pi_{E}}(s)\\pi_{E}(a|s)}{1-D_{t}(s,a)},}}\\\\ {{\\displaystyle\\frac{d\\pi_{t}(a|s)}{d t}=-\\rho_{\\pi_{t}}(s)A^{\\pi_{t}}(s,a).}}\\end{array}\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "3.2 On the Convergence of GAIL ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "Now, we study the optimization stability of GAIL using the dynamical system Eq. (5). The desirable outcome of the GAIL training process, is for the learned policy to perfectly match the expert policy, and the discriminator to be unable to distinguish between the expert and learned policy. ", "page_idx": 4}, {"type": "text", "text": "Definition 3.2. (Desired state) We define the desired outcome of the GAIL training process as the discriminator and policy reaching $\\begin{array}{r}{D_{t}^{*}(s,a)=\\frac{1}{2},\\pi_{t}^{*}(a|s)=\\pi_{E}(a|s)}\\end{array}$ . ", "page_idx": 4}, {"type": "text", "text": "We are interested in understanding whether GAIL converges to the desired state. As discussed in Sec. 2.2, the desired state should be the equilibrium of the dynamical system Eq. (5) for such convergence. According to Def. 2.1, the dynamical system should equal to zero at this point, but we present the following theorem (proved in Proposition C.3 and C.5): ", "page_idx": 4}, {"type": "text", "text": "Theorem 3.3. The training dynamics of GAIL does not converge to the desired state, and we have ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\frac{d D_{t}^{*}(s,a)}{d t}=\\frac{\\rho_{\\pi_{t}^{*}}(s)\\pi_{t}^{*}(a|s)}{D_{t}^{*}}-\\frac{\\rho_{\\pi_{E}}(s)\\pi_{E}(a|s)}{1-D_{t}^{*}}=0,\\frac{d\\pi_{t}^{*}(a|s)}{d t}=-\\rho_{\\pi_{E}^{*}}(s)A^{\\pi_{E}^{*}}(s,a)\\neq0.\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "Hence, the desired state is not an equilibrium, and GAIL will not converge to it. Since $\\frac{d\\pi_{t}^{*}(a|s)}{d t}\\neq0$ even if the system is forced to the desired state, it will drift away from it. We find that the nonequilibrium result is due to the entropy term $\\lambda H(\\pi)$ , and an equilibrium could be achieved by simply setting $\\lambda=0$ (Corollary C.4). However, the entropy term is essential since it resolves the exploration issue and prevents over-fitting. Therefore, we aim to design a controller that not only keeps the entropy term but also improves the theoretical convergence guarantee. ", "page_idx": 4}, {"type": "text", "text": "4 Controlled GAIL ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "Having shown in Section 3 that GAIL does not converge to the desired state, this section considers adding a controller to enable the convergence. We design controllers for both the discriminator and the policy. We show that this controlled system converges to the desired equilibrium and also achieves asymptotic stability in a simplified \u201cone-step\u201d setting. ", "page_idx": 4}, {"type": "text", "text": "4.1 Controlling the Training Process of GAIL ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "Establishing the convergence for GAIL is challenging since the occupancy measure $\\rho_{\\pi}$ involves an expectation over the states generated by playing the policy $\\pi$ for infinite many steps. We simplify the analysis by truncating the trajectory length to one: we only consider the evolution from timestep $n$ to $n+1$ . We refer this simplified setting as \u201cone-step GAIL\u201d, and the convergence guarantee of our proposed algorithm will be established in this simplified setting. Let $p(s)$ be the probability of the state at $s$ on timestep $n$ . The objectives for the discriminator and the policy can then be simplified as, ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\begin{array}{l}{{\\displaystyle\\tilde{V}_{D}(D,\\pi)=\\int_{a}\\int_{s}p(s)\\pi(a|s)\\log D(s,a)+\\pi_{E}(a|s)\\log(1-D(s,a))\\;d s\\;d a,}}\\\\ {{\\displaystyle\\tilde{V}_{\\pi}(D,\\pi)=\\int_{a}\\int_{s}p(s)\\pi(a|s)\\log D(s,a)+\\lambda p(s)\\pi(a|s)\\log\\pi(a|s)\\;d s\\;d a.}}\\end{array}\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "The gradient flow dynamical system of these functions is, ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\begin{array}{l}{\\displaystyle\\frac{d D_{t}(s,a)}{d t}=\\frac{p(s)\\pi_{t}(a|s)}{D_{t}(s,a)}+\\frac{p(s)\\pi_{E}(a|s)}{D_{t}(s,a)-1},}\\\\ {\\displaystyle\\frac{d\\pi_{t}(a|s)}{d t}=-p(s)(\\log D_{t}(s,a)+\\lambda\\log\\pi_{t}(a|s)+\\lambda).}\\end{array}\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "With this \u201cone-step\u201d simplification, the GAIL dynamics now reveal a clearer structure. For a given $(s,a)$ pair, the change of $D(s,a)$ and $\\pi(a|s)$ only depends on $D(s,a),\\pi(a|s),p(s)$ and $\\pi_{E}(a|s)$ for the same $(s,a)$ pair, without the need to access function values of other $(s,a)$ pairs. Therefore, we can decompose Eq. (7) & (8), which are ODEs of functions, into a series of ODEs of scalar values. Each ODE only models the dynamics of two scalar values $(D(s,a),\\pi(a|s))$ for a particular $(s,a)$ pair. We will add controller to the scalar ODEs, to asymptotically stabilize their dynamical system. Proving that each scalar ODE is stable suggests that the functional ODE will also be stable. Note that such decomposition is not possible without the \u201cone-step\u201d simplification, since the evolution of $D$ and $\\pi$ for all $(s,a)$ pairs is coupled through $\\rho_{\\pi}(s)$ and $A^{\\pi}(s,a)$ in Eq. (5). ", "page_idx": 4}, {"type": "text", "text": "", "page_idx": 5}, {"type": "text", "text": "Based on the above discussion, we now consider the stability of a system of ODEs for two scalar variables $(D(s,a),\\pi(a|s))$ . With $s,a$ given, we simplify the notation as $x(t):=D_{t}(s,a),y(t):=$ $\\pi_{t}(s|a)$ , $E:=\\pi_{E}(a|s)$ , $c:=p(s)$ , so each scalar ODE can be rewritten as, ", "page_idx": 5}, {"type": "equation", "text": "$$\n{\\frac{d x(t)}{d t}}={\\frac{c y(t)}{x(t)}}+{\\frac{c E}{x(t)-1}},{\\frac{d y(t)}{d t}}=-c\\log x(t)-c\\lambda\\log y(t)-c\\lambda.\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "We showed earlier that the GAIL dynamic in Eq. (5) does not converge to the desired state. Similarly, neither does our simplified \u2018one-step\u2019 dynamic in Eq. (9) converge to the desired state. We now consider the addition of controllers to push our dynamical system to the desired stated. Specifically, we consider linear negative feedback control [26], which can be applied to a dynamical system to reduce its oscillation. We specify our controlled GAIL system as, ", "page_idx": 5}, {"type": "equation", "text": "$$\n\\frac{\\mathrm{d}x(t)}{\\mathrm{d}t}=\\frac{c y(t)}{x(t)}+\\frac{c E}{x(t)-1}+u_{1}(t)\n$$", "text_format": "latex", "page_idx": 5}, {"type": "equation", "text": "$$\n\\frac{\\mathrm{d}y(t)}{\\mathrm{d}t}=-c\\log x(t)-c\\lambda\\log y(t)-c\\lambda+u_{2}(t),\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "where $u_{1}(t)$ and $u_{2}(t)$ are the controllers to be designed for the discriminator and policy respectively. Since the derivative of the discriminator with respect to time evaluated at the desired state (Def. 3.2) already equals zero, the discriminator is already able to reach its desired state. Nevertheless, the discriminator can still benefit from a controller to speed up the rate of convergence \u2013 we choose a linear negative feedback controller for $u_{1}(t)$ to push the discriminator towards its desired state. On the other hand, the derivative of the policy generator evaluated at its desired state in Eq. (9) does not equal zero. Therefore, $u_{2}(t)$ should be set to make Eq. (11) equal to zero evaluated at the desired state. We have designed it to cancel out all terms in Eq. (9) at this desired state, and also provide feasible hyperparameter values for an asymptotically stable system. Hence, we select $u_{1}(t)$ and $u_{2}(t)$ to be the following functions, ", "page_idx": 5}, {"type": "equation", "text": "$$\nu_{1}(t)=-k(x(t)-\\frac{1}{2}),\n$$", "text_format": "latex", "page_idx": 5}, {"type": "equation", "text": "$$\nu_{2}(t)=c\\lambda\\log E+c\\log\\frac{1}{2}+c\\lambda+\\alpha\\frac{y(t)}{E}-\\alpha,\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "where $k,\\alpha$ are hyperparameters. Intuitively, as $k$ gets larger, the discriminator will be pushed harder towards the optimal value of $1/2$ . This means the discriminator would converge at a faster speed but may also have a larger radius of oscillation. ", "page_idx": 5}, {"type": "text", "text": "4.2 Analyzing the Stability of Controlled GAIL ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "In this section, we apply Theorem 2.5 to formally prove that the controlled GAIL dynamical system described in Eq. (10) & (11) is asymptotically stable (Def. 2.3) and give bounds with $\\lambda,\\alpha.$ , and $k$ . ", "page_idx": 5}, {"type": "text", "text": "For simplicity, let us define $z(t)=(x(t),y(t))^{\\top}$ , and a function $f$ such that $f(z(t))$ is the vector $\\begin{array}{r}{\\left[\\frac{c y(t)}{x(t)}+\\frac{c E}{x(t)-1}-k\\left(x(t)-\\frac{1}{2}\\right),c\\log\\frac{1}{2}{+}c\\lambda\\log E{-}c\\lambda\\log y(t)\\!-\\!c\\log x(t)\\!+\\!\\alpha\\frac{y(t)}{E}-\\alpha\\right]^{\\intercal}}\\end{array}$ . Therefore, our controlled training dynamic of GAIL in Eq. (10) and Eq. (11) can be transformed to the following vector form ", "page_idx": 5}, {"type": "equation", "text": "$$\nd(z(t))=f(z(t))d t.\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "Theorem 4.1. Let assumption 4.2 hold. The training dynamic of GAIL in Eq. (14) is asymptotically stable (proof in Appendix $D$ ). ", "page_idx": 5}, {"type": "text", "text": "Assumption 4.2. We assume $\\alpha,k~\\in~\\mathbb{R},k~>~0$ , $8c^{2}\\lambda\\textrm{--}8c\\alpha\\textrm{--}4c^{2}+c k\\lambda\\textrm{--}k\\alpha\\;>\\;0$ , andk2+32c(\u2212c\u03bb+\u03b1)< 0.", "page_idx": 5}, {"type": "text", "text": "Proof sketch. The first step in proving asymptotic stability of the system in Eq. (14), is to verify whether our desired state is an equilibrium (Def. 2.1). We substitute the desired state, $z^{*}(t)=$ $(\\textstyle{\\frac{1}{2}},E)^{\\top}$ , into system (14) and verify that $d(z^{*}(t))\\,=\\,f(z^{*}(t))\\,=\\,0$ . We then find the linearized system about the desired state $d(z(t))=\\mathbb{J}(f(z^{*}(t)))z(t)d t$ . Under Assumption 4.2, we show that $d e t(\\mathbb{J}(f(z^{*}(t))))>0$ and $t r a c e(\\mathbb{J}(f(z^{*}(t))))<0$ . Finally we invoke Theorem 2.5 and Corollary 2.6 to conclude that the system in Eq. (14) is asymptotically stable. ", "page_idx": 5}, {"type": "text", "text": "1: Input: Expert trajectory $\\tau_{E}$ sampled from $\\pi_{E}$ , initial parameters $\\theta_{0}$ , and $\\phi_{0}$ for generator and discriminator. ", "page_idx": 6}, {"type": "text", "text": "2: repeat ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "3: Sample trajectory $\\tau$ from $\\pi_{\\theta}$ .   \n4: Update discriminator parameters $\\phi$ with gradient from, ", "page_idx": 6}, {"type": "text", "text": "$\\begin{array}{r}{\\hat{\\mathbb{E}}_{\\tau}\\left[\\log D(s,a)-\\frac{k}{2}\\left(D(s,a)-\\frac{1}{2}\\right)^{2}\\right]+\\hat{\\mathbb{E}}_{\\tau_{E}}\\left[\\log(1-D(s,a))-\\frac{k}{2}\\left(D(s,a)-\\frac{1}{2}\\right)^{2}\\right]}\\end{array}$ 5: Update policy parameters $\\theta$ with $V_{\\pi}(D,\\pi)$ in Eq. 3 ", "page_idx": 6}, {"type": "text", "text": "6: until Stopping criteria reached ", "page_idx": 6}, {"type": "text", "text": "5 A Practical Method to Stabilize GAIL ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "In this section, we extend our controller from the \u201cone-step\u201d setting back to the general setting and instantiate our controller as a regularization term on the original GAIL loss function. This results in our proposed variant C-GAIL; a method to stabilize the training process of GAIL. ", "page_idx": 6}, {"type": "text", "text": "Since the controllers in Eq. (13) are defined in the dynamical system setting, we need to integrate these with respect to time, in order to recover an objective function that can be practically optimized by a GAIL algorithm. Recalling that $V_{D}(D,\\pi)$ and $\\bar{V}_{\\pi}(D,\\pi)$ are the original GAIL loss functions for the discriminator and policy (Eq. (3)), we define $V_{D}^{\\prime}(D,\\pi)$ and $V_{\\pi}^{\\prime}(D,\\bar{\\pi})$ as modified loss functions with the integral of our controller applied, such that ", "page_idx": 6}, {"type": "equation", "text": "$$\n\\begin{array}{l}{{{\\cal V}_{D}^{\\prime}(D,\\pi)=V_{D}(D,\\pi)-\\mathbb{E}_{\\pi,\\pi_{E}}\\left[\\frac{k}{2}(D(s,a)-\\frac12)^{2}\\right],}}\\\\ {{{\\cal V}_{\\pi}^{\\prime}(D,\\pi)=V_{\\pi}(D,\\pi)+\\mathbb{E}_{\\pi,\\pi_{E}}\\left[\\frac{\\alpha}{2}\\frac{\\pi^{2}(a|s)}{\\pi_{E}(a|s)}+(c\\log\\frac12+c\\lambda\\log\\pi_{E}(a|s)+c\\lambda-\\alpha)\\pi(a|s)\\right].}}\\end{array}\n$$", "text_format": "latex", "page_idx": 6}, {"type": "text", "text": "Note that the training dynamics with these loss functions are identical to Eq. (10-13) with guaranteed stability under the \u2018one-step\u2019 setting. ", "page_idx": 6}, {"type": "text", "text": "While $V_{D}^{\\prime}(D,\\pi)$ can be computed directly, the inclusion of $\\pi_{E}$ , the expert policy, in $V_{\\pi}^{\\prime}(D,\\pi)$ is problematic \u2013 the very goal of the algorithm is to learn $\\pi_{E}$ , and we do not have access to it during training. Hence, in our practical implementations, we only use our modified loss $V_{D}^{\\prime}(D,\\pi)$ to update the discriminator, but use the original unmodified policy objective $V_{\\pi}(D,\\pi)$ for the policy. In other words, we only add the controller to the discriminator objective $V_{D}(D,\\pi)$ . This approximation has no convergence guarantee, even in the one-step setting. Nevertheless, the control theory-motivated approach effectively stabilizes GAIL in practice, as we shall see in Sec. 6. Intuitively, C-GAIL pushes the discriminator to its equilibrium at a faster speed by introducing a penalty controller centered at $\\frac{1}{2}$ . With proper selection of the hyperparameter $k$ (ablation study provided in Appendix E), the policy generator is able to train the discriminator at the same pace, leading GAIL\u2019s training to converge faster with a smaller range of oscillation, and match the expert distribution more closely. ", "page_idx": 6}, {"type": "text", "text": "Our C-GAIL algorithm is listed in Alg. 1. It can be implemented by simply adding a regularization term to the discriminator loss. Hence, our method is also compatible with other variants of GAIL, by straightforwardly incorporating the regularization into their discriminator objective function. ", "page_idx": 6}, {"type": "text", "text": "6 Evaluation ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "This section evaluates the benefit of integrating the controller developed in Section 4 with popular variants of GAIL. We test the algorithms on their ability to imitate an expert policy in simulated continuous control problems in MuJoCo [27]. Specifically, we consider applying our controller to two popular GAIL algorithms \u2013 both the original \u2018vanilla\u2019 GAIL [1] and also GAIL-DAC [9], a state-of-the-art variant which uses a discriminator-actor-critic (DAC) to improve sample efficiency and reduce the bias of the reward function. Additionally, we include supplementary experiments compared with other GAIL variants such as Jena et al. [7] and Xiao et al. [8] in appendix F. ", "page_idx": 6}, {"type": "image", "img_path": "t4VwoIYBf0/tmp/058ddfacdf7e6050ee6d4ba36961cc0effd934112571905cc65df5d0fcd456c6.jpg", "img_caption": ["Figure 2: State Wasserstein distance (lower is better) between expert and learned policies, over number of gradient step updates. Our controlled variant matches the expert distribution more closely. "], "img_footnote": [], "page_idx": 7}, {"type": "text", "text": "6.1 Experimental Setup ", "text_level": 1, "page_idx": 7}, {"type": "text", "text": "We incorporate our controller in vanilla GAIL and GAIL-DAC, naming our controlled variants C-GAIL and C-GAIL-DAC. We leverage the implementations of Gleave et al. [28] (vanilla GAIL) and Kostrikov et al. [9] (GAIL-DAC). Gleave et al. [28] also provide other common imitation learning frameworks \u2013 BC, AIRL, and dataset aggregation (DAgger) [29] \u2013 which we also compare to. ", "page_idx": 7}, {"type": "text", "text": "For C-GAIL-DAC, we test five MuJuCo environments: Half-Cheetah, Ant, Hopper, Reacher and Walker 2D. Our experiments follow the same settings as Kostrikov et al. [9]. The discriminator architecture has a two-layer MLP with 100 hidden units and tanh activations. The networks are optimized using Adam with a learning rate of $10^{-3}$ , decayed by 0.5 every $10^{5}$ gradient steps. We vary the number of provided expert demonstrations: $\\{4,7,11,15,18\\}$ , though unless stated we report results using four demonstrations. We assess the normalized return over training for GAIL-DAC and C-GAIL-DAC to evaluate their speed of convergence and stability, reporting the mean and standard deviation over five random seeds. The normalization is done with 0 set to a random policy\u2019s return and 1 to the expert policy return. ", "page_idx": 7}, {"type": "text", "text": "In addition to recovering the expert\u2019s return, we are also interested in how closely our policy generator\u2019s and the expert\u2019s state distribution are matched, for which we use the state Wasserstein [30]. This requires samples from two distributions, collected by rolling out the expert and learned policy for 100 trajectories each. We then use the POT library\u2019s \u2018emd2\u2019 function [31] to compute the Wasserstein distance, using the L2 cost function with a uniform weighting across samples. ", "page_idx": 7}, {"type": "text", "text": "To evaluate C-GAIL, we follow the experimental protocol from Gleave et al. [28], both for GAIL and other imitation learning baselines. These are evaluated on Ant, Hopper, Swimmer, Half-Cheetah and Walker 2D. For C-GAIL, we change only the loss and all other GAIL settings are held constant. We assess performance in terms of the normalized return. We use this set up to ablate the controller strength hyperparameter of C-GAIL (Appendix E), varying $k\\in\\{0.1,1,10\\}$ (ablation study of $\\alpha$ is not included since our algorithm only involves controller for the discriminator in practice). Our experiments are conducted on a single NVIDIA GeForce GTX TITAN X. ", "page_idx": 7}, {"type": "table", "img_path": "t4VwoIYBf0/tmp/7a2e4744ab3e697402b0d721a9b66192029c081dec31eb39a911e5c63434d6fc.jpg", "table_caption": ["Table 1: Mean and standard deviation for returns of various $\\mathrm{IL}$ algorithms and environments "], "table_footnote": [], "page_idx": 7}, {"type": "text", "text": "6.2 Results ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "We compare GAIL-DAC to C-GAIL-DAC in Figure 1 (return), 2 (state Wasserstein), and 3 (convergence speed). Figure 1 shows that C-GAIL-DAC speeds up the rate of convergence and reduces the oscillation in the return training curves across all environments. For instance, on Hopper, CGAIL-DAC converges $5\\mathrm{x}$ faster than GAIL-DAC with less oscillations. On Reacher, the return of GAIL-DAC continues to spike even after matching the expert return, but this does not happen with C-GAIL-DAC. On Walker 2D, the return of GAIL-DAC oscillates throughout training, whereas our method achieves a higher return at has reduced the range of oscillation by more than 3 times. For Half-Cheetah, our method converges $2\\mathbf{x}$ faster than GAIL-DAC. For Ant environment, C-GAIL-DAC reduces the range of oscillations by around $10\\mathrm{x}$ . ", "page_idx": 8}, {"type": "text", "text": "In addition to matching the expert\u2019s return faster and with more stability, Figure 2 shows that C-GAILDAC also more closely matches the expert\u2019s state distribution than GAIL-DAC, with the difference persisting even towards the end of training for various numbers of expert trajectories. Toward the end of training, the state Wasserstein for C-GAIL-DAC is more than two times smaller than the state Wasserstein for GAIL-DAC on all five environments. ", "page_idx": 8}, {"type": "text", "text": "Figure 3 shows that these improvements hold for differing numbers of provided demonstrations. It plots the number of gradient steps for GAIL-DAC and C-GAIL-DAC to reach $95\\%$ of the max-return for vaious numbers of expert demonstrations. Our method is able to converge faster than GAIL-DAC regardless of the number of demonstrations. ", "page_idx": 8}, {"type": "text", "text": "Hyperparameter sensitivity. We evaluate the sensitivity to the controller\u2019s hyperparameter $k$ using vanilla GAIL. Figure 4 (Appendix E) plots normalized returns. For some environments, minor gains can be found by tuning this hyperparameter, though in general for all values tested, the return curves of C-GAIL approach the expert policy\u2019s return earlier and with less oscillations than GAIL. This is an important result as it shows that our regularizer can easily be applied by practitioners without the need for a fine-grained hyperparameter sweep. ", "page_idx": 8}, {"type": "text", "text": "Other imitation learning methods. Table 1 benchmarks C-GAIL against other imitation learning methods, including BC, AIRL, and DAgger, some of which have quite different requirements to the GAIL framework. The table shows that C-GAIL is competitive with many other paradigms, and in consistently offers the lowest variance between runs of any method. Moreover, we include supplementary experiments compared with Jena et al. [7] and Xiao et al. [8] in appendix F. ", "page_idx": 8}, {"type": "text", "text": "7 Discussion & Conclusion ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "This work helped understand and address the issue of training instability in GAIL using the lens of control theory. This advances recent findings showing its effectiveness in other adversarial learning frameworks. We formulated GAIL\u2019s training as a dynamical system and designed a controller that stabilizes it at the desired state, encouraging convergence to this point. We showed theoretically that our controlled system achieves asymptotic stability under a \u201cone-step\u201d setting. We proposed a ", "page_idx": 8}, {"type": "image", "img_path": "t4VwoIYBf0/tmp/a8c328fdcf555fba920481117302652dee4c73492cf5313de793ac351a6d4ffb.jpg", "img_caption": [], "img_footnote": [], "page_idx": 8}, {"type": "text", "text": "Figure 3: Number of gradient step updates (in millions) required to reach $95\\%$ of the max-return for various numbers of expert trajectories on MuJoCo environments averaged over five random seeds. ", "page_idx": 8}, {"type": "text", "text": "practical realization of this named C-GAIL, which reaches expert returns both faster and with less oscillation than the uncontrolled variants, and also matches their state distribution more closely. ", "page_idx": 9}, {"type": "text", "text": "Whilst our controller theoretically converges to the desired state, and empirically stabilizes training, we recognize several limitations of our work. In our description of GAIL training as a continuous dynamical system, we do not account for the updating of generator and discriminator being discrete as in practice. In our practical implementation of the controller, we only apply the portion of the loss function acting on the discriminator, since the generator portion requires knowing the likelihood of an action under the expert policy (which is precisely what we aim to learn!). We leave it to future work to explore whether estimating the expert policy and incorporating a controller for the policy generator brings benefit. ", "page_idx": 9}, {"type": "text", "text": "Acknowledgments and Disclosure of Funding ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "We thank Professor Yang Gao for support in discussions. This work was supported by the National Science and Technology Major Project (2021ZD0110502), NSFC Projects (Nos. 62350080, 62376131, 62061136001, 62106123, 62076147, U19A2081, 61972224), and the High Performance Computing Center, Tsinghua University. J.Z is also supported by the XPlorer Prize. ", "page_idx": 9}, {"type": "text", "text": "References ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "[1] Jonathan Ho and Stefano Ermon. Generative adversarial imitation learning. Advances in neural information processing systems, 29, 2016.   \n[2] Ian Goodfellow, Jean Pouget-Abadie, Mehdi Mirza, Bing Xu, David Warde-Farley, Sherjil Ozair, Aaron Courville, and Yoshua Bengio. Generative adversarial nets. Advances in neural information processing systems, 27, 2014.   \n[3] Andrew Y Ng, Stuart Russell, et al. Algorithms for inverse reinforcement learning. In Icml, volume 1, page 2, 2000.   \n[4] Felipe Codevilla, Eder Santana, Antonio M L\u00f3pez, and Adrien Gaidon. Exploring the limitations of behavior cloning for autonomous driving. In Proceedings of the IEEE/CVF International Conference on Computer Vision, pages 9329\u20139338, 2019.   \n[5] Lars Mescheder, Andreas Geiger, and Sebastian Nowozin. Which training methods for gans do actually converge? In International conference on machine learning, pages 3481\u20133490. PMLR, 2018.   \n[6] Justin Fu, Katie Luo, and Sergey Levine. Learning robust rewards with adversarial inverse reinforcement learning. arXiv preprint arXiv:1710.11248, 2017.   \n[7] Rohit Jena, Changliu Liu, and Katia Sycara. Augmenting gail with bc for sample efficient imitation learning. In Conference on Robot Learning, pages 80\u201390. PMLR, 2021.   \n[8] Huang Xiao, Michael Herman, Joerg Wagner, Sebastian Ziesche, Jalal Etesami, and Thai Hong Linh. Wasserstein adversarial imitation learning. arXiv preprint arXiv:1906.08113, 2019.   \n[9] Ilya Kostrikov, Kumar Krishna Agrawal, Debidatta Dwibedi, Sergey Levine, and Jonathan Tompson. Discriminator-actor-critic: Addressing sample inefficiency and reward bias in adversarial imitation learning. arXiv preprint arXiv:1809.02925, 2018.   \n[10] Gokul Swamy, Nived Rajaraman, Matt Peng, Sanjiban Choudhury, J Bagnell, Steven Z Wu, Jiantao Jiao, and Kannan Ramchandran. Minimax optimal online imitation learning via replay estimation. Advances in Neural Information Processing Systems, 35:7077\u20137088, 2022.   \n[11] Minshuo Chen, Yizhou Wang, Tianyi Liu, Zhuoran Yang, Xingguo Li, Zhaoran Wang, and Tuo Zhao. On computation and generalization of generative adversarial imitation learning. arXiv preprint arXiv:2001.02792, 2020.   \n[12] Qi Cai, Mingyi Hong, Yongxin Chen, and Zhaoran Wang. On the global convergence of imitation learning: A case for linear quadratic regulator. arXiv preprint arXiv:1901.03674, 2019.   \n[13] Yufeng Zhang, Qi Cai, Zhuoran Yang, and Zhaoran Wang. Generative adversarial imitation learning with neural network parameterization: Global optimality and convergence rate. In International Conference on Machine Learning, pages 11044\u201311054. PMLR, 2020.   \n[14] Ziwei Guan, Tengyu Xu, and Yingbin Liang. When will generative adversarial imitation learning algorithms attain global convergence. In International Conference on Artificial Intelligence and Statistics, pages 1117\u20131125. PMLR, 2021.   \n[15] Nir Baram, Oron Anschel, Itai Caspi, and Shie Mannor. End-to-end differentiable adversarial imitation learning. In International Conference on Machine Learning, pages 390\u2013399. PMLR, 2017.   \n[16] Nived Rajaraman, Lin Yang, Jiantao Jiao, and Kannan Ramchandran. Toward the fundamental limits of imitation learning. Advances in Neural Information Processing Systems, 33:2914\u20132924, 2020.   \n[17] Kun Xu, Chongxuan Li, Jun Zhu, and Bo Zhang. Understanding and stabilizing gans\u2019 training dynamics using control theory. In International Conference on Machine Learning, pages 10566\u201310575. PMLR, 2020.   \n[18] Tianjiao Luo, Ziyu Zhu, Jianfei Chen, and Jun Zhu. Stabilizing gans\u2019 training with brownian motion controller. ICML, 2023.   \n[19] Edward L Ince. Ordinary differential equations. Courier Corporation, 1956.   \n[20] Paul Glendinning. Stability, instability and chaos: an introduction to the theory of nonlinear differential equations. Cambridge university press, 1994.   \n[21] William L Brogan. Modern control theory. Pearson education india, 1991.   \n[22] Joseph P La Salle. The stability of dynamical systems. SIAM, 1976.   \n[23] Arthur Jacot, Franck Gabriel, and Cl\u00e9ment Hongler. Neural tangent kernel: Convergence and generalization in neural networks. Advances in neural information processing systems, 31, 2018.   \n[24] Jacques Lafontaine et al. An introduction to differential manifolds. Springer, 2015.   \n[25] Walter Greiner and Joachim Reinhardt. Field quantization. Springer Science & Business Media, 2013.   \n[26] Stephen P Boyd and Craig H Barratt. Linear controller design: limits of performance, volume 7. Citeseer, 1991.   \n[27] Emanuel Todorov, Tom Erez, and Yuval Tassa. Mujoco: A physics engine for model-based control. In 2012 IEEE/RSJ international conference on intelligent robots and systems, pages 5026\u20135033. IEEE, 2012.   \n[28] Adam Gleave, Mohammad Taufeeque, Juan Rocamonde, Erik Jenner, Steven H Wang, Sam Toyer, Maximilian Ernestus, Nora Belrose, Scott Emmons, and Stuart Russell. imitation: Clean imitation learning implementations. arXiv preprint arXiv:2211.11972, 2022.   \n[29] St\u00e9phane Ross, Geoffrey Gordon, and Drew Bagnell. A reduction of imitation learning and structured prediction to no-regret online learning. In Proceedings of the fourteenth international conference on artificial intelligence and statistics, pages 627\u2013635. JMLR Workshop and Conference Proceedings, 2011.   \n[30] Tim Pearce, Tabish Rashid, Anssi Kanervisto, Dave Bignell, Mingfei Sun, Raluca Georgescu, Sergio Valcarcel Macua, Shan Zheng Tan, Ida Momennejad, Katja Hofmann, et al. Imitating human behaviour with diffusion models. ICLR, 2023.   \n[31] R\u00e9mi Flamary, Nicolas Courty, Alexandre Gramfort, Mokhtar Z Alaya, Aur\u00e9lie Boisbunon, Stanislas Chambon, Laetitia Chapel, Adrien Corenflos, Kilian Fatras, Nemo Fournier, et al. Pot: Python optimal transport. The Journal of Machine Learning Research, 22(1):3571\u20133578, 2021.   \n[32] Christopher M Bishop and Nasser M Nasrabadi. Pattern recognition and machine learning, volume 4. Springer, 2006. ", "page_idx": 9}, {"type": "text", "text": "", "page_idx": 10}, {"type": "text", "text": "A Broader impact ", "text_level": 1, "page_idx": 11}, {"type": "text", "text": "This work has provided an algorithmic advancement in imitation learning. As such, we have been cognisant of various issues such as those related to learning from human demonstrators \u2013 e.g. privacy issues when collecting data. However, this work avoids such matters by using trained agents as the demonstrators. More broadly, we see our work as a step towards more principled machine learning methods providing more efficient and stable learning, which we believe in general has a positive impact. ", "page_idx": 11}, {"type": "text", "text": "B Basics of Functional Derivatives ", "text_level": 1, "page_idx": 11}, {"type": "text", "text": "We provide some background on functional derivatives, which are necessary for the derivations in Appendix C. For a more rigorous and detailed introduction, please refer to the Appendix $\\mathrm{D}$ of [32]. ", "page_idx": 11}, {"type": "text", "text": "Definition B.1. (functionals) We define a functional $F[y]:f\\longrightarrow\\mathbb{R}$ to be an operator that takes a function $y(x)$ and returns a scalar value $F[y]$ . ", "page_idx": 11}, {"type": "text", "text": "Definition B.2. (functionals derivatives) We consider how much a functional $F[y]$ changes when we make a small change $h\\eta(x)|_{h\\to0}$ to the function. If we have ", "page_idx": 11}, {"type": "equation", "text": "$$\n\\int\\frac{\\partial F}{\\partial y}(x)\\eta(x)\\,\\mathrm{d}x=\\operatorname*{lim}_{h\\to0}\\frac{F(y+h\\eta)-F(y)}{h}=\\frac{d F(y+h\\eta)}{d h}\\bigg|_{h=0},\n$$", "text_format": "latex", "page_idx": 11}, {"type": "text", "text": "such that ", "page_idx": 11}, {"type": "equation", "text": "$$\nF(y+h\\eta)=F(y)+h\\int\\frac{\\partial F}{\\partial y}(x)\\eta(x)\\;\\mathrm{d}x+\\mathcal{O}(h^{2}),\n$$", "text_format": "latex", "page_idx": 11}, {"type": "text", "text": "then $\\frac{\\partial F}{\\partial y}$ is called the functional derivative of $F$ with respect to function $y$ . ", "page_idx": 11}, {"type": "text", "text": "Theorem B.3. (chain rule) If the function $y$ is controlled by some weights $\\theta$ can be rewritten as y\u03b8. We have ", "page_idx": 11}, {"type": "equation", "text": "$$\n{\\frac{\\partial F(y_{\\theta})}{\\partial\\theta}}=\\int{\\frac{\\partial F}{\\partial y}}(x){\\frac{\\partial y_{\\theta}}{\\partial\\theta}}(x)\\mathrm{d}x.\n$$", "text_format": "latex", "page_idx": 11}, {"type": "text", "text": "C Detailed Theoretical Analysis of General GAIL ", "text_level": 1, "page_idx": 11}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\underset{D}{\\operatorname*{max}}\\,V_{D}(D,\\pi)=\\mathbb{E}_{\\pi}[\\log D(s,a)]+\\mathbb{E}_{\\pi_{E}}[\\log(1-D(s,a))]}\\\\ &{\\quad\\underset{\\pi}{\\operatorname*{min}}\\,V_{\\pi}(D,\\pi)=\\mathbb{E}_{\\pi}[\\log D(s,a)]-\\lambda\\mathbb{E}_{\\pi}[-\\log\\pi(a|s)].}\\end{array}\n$$", "text_format": "latex", "page_idx": 11}, {"type": "text", "text": "Lemma C.1. Given that $\\pi_{\\theta}$ is a parameterized policy. Define the training objective for entropyregularized policy optimization as ", "page_idx": 11}, {"type": "equation", "text": "$$\nJ(\\theta)=\\mathbb{E}_{\\pi_{\\theta}}[r(s,a)]-\\lambda\\mathbb{E}_{\\pi_{\\theta}}[-\\log\\pi_{\\theta}(a|s)].\n$$", "text_format": "latex", "page_idx": 11}, {"type": "text", "text": "Its gradient satisfies ", "page_idx": 11}, {"type": "equation", "text": "$$\n\\frac{\\partial}{\\partial\\theta}J(\\theta)=\\mathbb{E}_{\\pi_{\\theta}}[\\frac{\\partial\\log\\pi_{\\theta}(a|s)}{\\partial\\theta}Q^{\\pi_{\\theta}}(s,a)]=\\mathbb{E}_{\\pi_{\\theta}}[\\frac{\\partial\\log\\pi_{\\theta}(a|s)}{\\partial\\theta}A_{E}^{\\pi_{\\theta}}(s,a)],\n$$", "text_format": "latex", "page_idx": 11}, {"type": "text", "text": "where $Q^{\\pi_{\\theta}}(s,a)$ and $A^{\\pi_{\\theta}}(s,a)$ are defined as ", "page_idx": 11}, {"type": "equation", "text": "$$\n\\begin{array}{r}{2^{\\pi_{\\theta}}(s,a):=E_{\\pi_{\\theta}}[r(\\bar{s},\\bar{a})+\\lambda\\log\\pi_{\\theta}(\\bar{a}|\\bar{s})|s_{0}=s,a_{0}=a],\\quad A^{\\pi_{\\theta}}(s,a):=Q^{\\pi_{\\theta}}(s,a)-\\mathbb{E}_{\\pi_{\\theta}}Q^{\\pi_{\\theta}}(s,a).}\\end{array}\n$$", "text_format": "latex", "page_idx": 11}, {"type": "text", "text": "Proof. ", "page_idx": 12}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\displaystyle\\frac{\\partial}{\\partial\\rho}J(\\theta)=\\frac{\\partial}{\\partial\\theta}\\mathbb{E}_{\\boldsymbol{\\pi}}\\{r(s,a)\\}-\\lambda\\mathbb{E}_{\\boldsymbol{\\pi}}\\{-\\log\\pi_{\\theta}(a|s)|\\}}\\\\ &{\\quad\\quad=\\frac{\\partial}{\\partial\\theta}\\int\\rho_{\\pi_{\\theta}}(s)\\pi_{\\theta}(a|s)r(s,a)\\mathrm{d}a\\mathrm{d}s+\\lambda\\frac{\\partial}{\\partial\\theta}\\int\\rho_{\\pi_{\\theta}}(s)\\pi_{\\theta}(a|s)\\log\\pi_{\\theta}(a|s)\\mathrm{d}a\\mathrm{d}s}\\\\ &{\\quad\\quad=\\int\\frac{\\partial\\rho_{\\pi_{\\theta}}(s)\\pi_{\\theta}(a|s)}{\\partial\\theta}r(s,a)\\mathrm{d}a\\mathrm{d}s+\\lambda\\int\\frac{\\partial\\rho_{\\pi_{\\theta}}(s)\\pi_{\\theta}(a|s)}{\\partial\\theta}\\log\\pi_{\\theta}(a|s)\\mathrm{d}a\\mathrm{d}s+\\lambda\\int\\rho_{\\pi_{\\theta}}(s)\\pi_{\\theta}(a|s)\\mathrm{d}s}\\\\ &{\\quad\\quad=\\int\\frac{\\partial\\rho_{\\pi_{\\theta}}(s)\\pi_{\\theta}(a|s)}{\\partial\\theta}\\Gamma(s,a)+\\lambda\\log\\pi_{\\theta}(a|s)\\mathrm{d}a\\mathrm{d}s+\\lambda\\int\\rho_{\\pi_{\\theta}}(s)\\pi_{\\theta}(a|s)\\frac{1}{\\overline{{\\pi}}\\theta}\\frac{\\partial\\pi_{\\theta}(a|s)}{\\partial\\theta}\\mathrm{d}s}\\\\ &{\\quad\\quad=\\int\\frac{\\partial\\rho_{\\pi_{\\theta}}(s)\\pi_{\\theta}(a|s)}{\\partial\\theta}[r(s,a)+\\lambda\\log\\pi_{\\theta}(a|s)]\\mathrm{d}a\\mathrm{d}s+\\lambda\\int\\rho_{\\pi_{\\theta}}(s)\\frac{\\partial}{\\partial\\theta}\\int\\pi_{\\theta}(a|s)\\mathrm{d}a\\mathrm{d}s}\\\\ &{\\quad\\quad=\\int\\frac{\\partial\\rho_{\\pi_{\\theta}}(s)\\pi_{\\theta}(a|s)}{\\partial\\theta}[r(s,a)+\\lambda\\log\\pi_{\\theta}(a|s)]\\mathrm{d}a\\mathrm{d}s}\\\\ &{\\quad\\quad=\\frac{\\partial\\mathbb{E}_{\\pi_{\\theta}}[r(s,a)+\\lambda\\log\\pi_{\\theta}(a|s)]}{\\partial\\theta}[\\rho_{\\pi_{\\theta}}(a|s)]\\mathrm{d}a\\mathrm{d}s}\\\\ &{\\quad\\quad=\\frac{\\partial\\mathbb{E}_{\n$$", "text_format": "latex", "page_idx": 12}, {"type": "text", "text": "The above derivation suggests that we can view the entropy term as an additional fixed reward $r^{\\prime}(s,a)=\\lambda\\log\\pi_{\\theta}(a|s)$ . Applying the Policy Gradient Theorem, we have ", "page_idx": 12}, {"type": "equation", "text": "$$\n\\frac{\\partial}{\\partial\\theta}J(\\theta)=\\mathbb{E}_{\\pi_{\\theta}}[\\frac{\\partial\\log\\pi_{\\theta}(a|s)}{\\partial\\theta}Q^{\\pi_{\\theta}}(s,a)]=\\mathbb{E}_{\\pi_{\\theta}}[\\frac{\\partial\\log\\pi_{\\theta}(a|s)}{\\partial\\theta}A^{\\pi_{\\theta}}(s,a)],\n$$", "text_format": "latex", "page_idx": 12}, {"type": "text", "text": "where $Q^{\\pi_{\\theta}}$ is similar to the classic Q-function but with an extra \u201centropy reward\u201d term. ", "page_idx": 12}, {"type": "text", "text": "Lemma C.2. The functional derivatives for the two optimization objectives ", "page_idx": 12}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{{\\cal V}_{D}(D,\\pi)=\\mathbb{E}_{\\pi}[\\log D(s,a)]+\\mathbb{E}_{\\pi_{E}}[\\log(1-D(s,a))]}\\\\ &{~~~{\\cal V}_{\\pi}(D,\\pi)=\\mathbb{E}_{\\pi}[\\log D(s,a)]-\\lambda\\mathbb{E}_{\\pi}[-\\log\\pi(a|s)]}\\end{array}\n$$", "text_format": "latex", "page_idx": 12}, {"type": "text", "text": "respectively satisfy ", "page_idx": 12}, {"type": "equation", "text": "$$\n\\frac{\\partial V_{D}}{\\partial D}=\\frac{\\rho_{\\pi}(s)\\pi(a|s)}{D(s,a)}-\\frac{\\rho_{\\pi_{E}}(s)\\pi_{E}(a|s)}{1-D(s,a)}.\n$$", "text_format": "latex", "page_idx": 12}, {"type": "equation", "text": "$$\n{\\frac{\\partial V_{\\pi}}{\\partial\\pi}}=\\rho_{\\pi}(s)A^{\\pi}(s,a).\n$$", "text_format": "latex", "page_idx": 12}, {"type": "text", "text": "where $A^{\\pi}$ follows the same definition as in Lemma C.1. ", "page_idx": 12}, {"type": "equation", "text": "$$\n\\begin{array}{r}{2^{\\pi}(s,a):=E_{\\pi}[\\log D(\\bar{s},\\bar{a})+\\lambda\\log\\pi(\\bar{a}|\\bar{s})|s_{0}=s,a_{0}=a],\\quad A^{\\pi}(s,a):=Q^{\\pi}(s,a)-\\mathbb{E}_{\\pi(a|s)}Q^{\\pi}(s,a)}\\end{array}\n$$", "text_format": "latex", "page_idx": 12}, {"type": "text", "text": "Proof. Regarding $\\frac{\\partial V_{D}}{\\partial D}$ , by definition of $\\mathbb{E}_{\\pi}$ we have ", "page_idx": 12}, {"type": "equation", "text": "$$\nV_{D}(D,\\pi)=\\int\\rho_{\\pi}(s)\\pi(a|s)\\log D(s,a)\\mathrm{d}a\\mathrm{d}s+\\int\\rho_{\\pi_{E}}(s)\\pi_{E}(a|s)\\log(1-D(s,a))\\mathrm{d}a\\mathrm{d}s\n$$", "text_format": "latex", "page_idx": 12}, {"type": "text", "text": "according to the chain rule [25] of functional derivative, we have ", "page_idx": 12}, {"type": "equation", "text": "$$\n\\frac{\\partial V_{D}}{\\partial D}=\\frac{\\rho_{\\pi}(s)\\pi(a|s)}{D(s,a)}-\\frac{\\rho_{\\pi_{E}}(s)\\pi_{E}(a|s)}{1-D(s,a)}\n$$", "text_format": "latex", "page_idx": 12}, {"type": "text", "text": "Regarding $\\frac{\\partial V_{\\pi}}{\\partial\\pi}$ , suppose $\\pi$ is parameterized by $\\theta$ . The chain rule for functional derivative states ", "page_idx": 12}, {"type": "equation", "text": "$$\n\\frac{\\partial V_{\\pi}}{\\partial\\theta}=\\int\\frac{\\partial V_{\\pi}}{\\partial\\pi}\\frac{\\partial\\pi}{\\partial\\theta}\\mathrm{d}a\\mathrm{d}s.\n$$", "text_format": "latex", "page_idx": 12}, {"type": "text", "text": "According to Lemma C.1, we have ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\begin{array}{l}{\\displaystyle\\frac{\\partial V_{\\pi}}{\\partial\\theta}=\\!\\mathbb{E}_{\\pi}[\\frac{\\partial\\log\\pi(a|s)}{\\partial\\theta}A^{\\pi}(s,a)]}\\\\ {\\displaystyle\\qquad=\\int\\rho_{\\pi}(s)\\pi(a|s)\\frac{\\partial\\log\\pi(a|s)}{\\partial\\theta}A^{\\pi}(s,a)\\mathrm{d}a\\mathrm{d}s}\\\\ {\\displaystyle\\qquad=\\int\\rho_{\\pi}(s)\\frac{\\partial\\pi(a|s)}{\\partial\\theta}A^{\\pi}(s,a)\\mathrm{d}a\\mathrm{d}s.}\\end{array}\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "Therefore, we have ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\frac{\\partial V_{\\pi}}{\\partial\\pi}=\\rho_{\\pi}(s)A^{\\pi}(s,a)=\\rho_{\\pi}(s)[Q^{\\pi}(s,a)-\\mathbb{E}_{\\pi}Q^{\\pi}(s,a)].\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "Proposition C.3. The constrained optimization problem ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\operatorname*{min}_{\\pi}V_{\\pi}(D,\\pi)=\\mathbb{E}_{\\pi}[\\log D(s,a)]-\\lambda\\mathbb{E}_{\\pi}[-\\log\\pi(a|s)]\\quad s.t.\\int\\pi(a|s)=1\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "does not converge when $\\pi=\\pi_{E}$ and $\\begin{array}{r}{D(s,a)=\\frac{1}{2}\\,f\\!o r\\,\\forall s,a.}\\end{array}$ . Namely, ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\frac{\\partial V_{\\pi}}{\\partial\\pi}|_{\\pi(s,a)=\\pi_{E}(s,a),D(s,a)=\\frac{1}{2}}\\neq0.\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "When $\\pi=\\pi_{E}$ and $\\begin{array}{r}{D(s,a)=\\frac{1}{2}}\\end{array}$ , we have ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\begin{array}{l}{{\\displaystyle Q^{\\pi}(s,a)=E_{\\pi_{E}}[\\lambda\\log\\pi_{E}(\\bar{a}|\\bar{s})-\\log2|s_{0}=s,a_{0}=a]}}\\\\ {{\\displaystyle\\qquad=\\sum_{n=0}^{\\infty}\\gamma^{n}\\int p(s_{n}=\\bar{s}|s_{0}=s,a_{0}=a)\\int\\pi_{E}(\\bar{a}|\\bar{s})[\\lambda\\log\\pi_{E}(\\bar{a}|\\bar{s})-\\log2]\\mathrm{d}\\bar{a}\\mathrm{d}\\bar{s}}}\\\\ {{\\displaystyle\\qquad=-\\sum_{n=0}^{\\infty}\\gamma^{n}\\int p(s_{n}=\\bar{s}|s_{0}=s,a_{0}=a)[\\lambda H(\\pi_{E}(\\cdot|\\bar{s}))+\\log2]\\mathrm{d}\\bar{s}}}\\end{array}\n$$", "text_format": "latex", "page_idx": 13}, {"type": "equation", "text": "$$\n\\begin{array}{l}{{\\displaystyle A^{\\pi}(s,a)=\\!Q^{\\pi}(s,a)-\\mathbb{E}_{\\pi}Q^{\\pi}(s,a)}}\\\\ {{\\displaystyle\\qquad\\quad\\simeq\\sum_{n=0}^{\\infty}\\gamma^{n}[p(s_{n}=\\bar{s}|s_{0}=s)-p(s_{n}=\\bar{s}|s_{0}=s,a_{0}=a)]\\lambda H(\\pi_{E}(\\cdot|\\bar{s}))}}\\end{array}\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "According to Lemma C.2, ", "page_idx": 13}, {"type": "equation", "text": "$$\n{\\frac{\\partial V_{\\pi}}{\\partial\\pi}}=\\rho_{\\pi_{E}}(s)A^{\\pi_{E}}(s,a)=\\rho_{\\pi_{E}}(s)A^{\\pi_{E}}(s,a)\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "Recall that we have $\\begin{array}{r}{A^{\\pi_{E}}(s,a)\\,=\\,\\sum_{n=0}^{\\infty}\\gamma^{n}\\big[p_{\\pi_{E}}(s_{n}\\,=\\,\\bar{s}|s_{0}\\,=\\,s)-p_{\\pi_{E}}(s_{n}\\,=\\,\\bar{s}|s_{0}\\,=\\,s,a_{0}\\,=\\,\\bar{s}|s_{0}\\big)\\big]\\,,}\\end{array}$ $a)]\\lambda H(\\pi_{E}(\\cdot|\\bar{s}))$ . Since $\\pi_{E}$ can by an y policy distribution determined by the expert dataset, $H(\\pi_{E}(\\cdot|\\bar{s}))$ can be any value for various s and $a$ . Additionally, for different actions $a_{1}\\neq a_{2}$ , we cannot guarantee $p_{\\pi_{E}}(s_{n}={\\bar{s}}|s_{0}=s,a_{0}=a_{1})=p_{\\pi_{E}}(s_{n}={\\bar{s}}|s_{0}=s,a_{0}=a_{2})$ . Thus $\\frac{\\partial V_{\\pi}}{\\partial\\pi}$ is not a constant and relies on action $a$ . $A^{\\pi_{E}}(s,a)=0$ cannot hold, and thus $\\begin{array}{r}{\\frac{\\partial V_{\\pi}}{\\partial\\pi}\\neq0}\\end{array}$ . ", "page_idx": 13}, {"type": "text", "text": "Corollary C.4. This is a corollary of Proposition C.3. When $\\begin{array}{r}{\\pi(s,a)=\\pi_{E}(s,a),D(s,a)=\\frac{1}{2}}\\end{array}$ , and the entropy term is excluded from the GAIL objective, we find, $\\begin{array}{r}{\\frac{\\partial V_{\\pi}}{\\partial\\pi}=0}\\end{array}$ . ", "page_idx": 13}, {"type": "text", "text": "Proof. Exclusion of the entropy term can be achieved by setting $\\lambda=0$ . Then we have, ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\begin{array}{l}{{\\displaystyle\\frac{\\partial V_{\\pi}}{\\partial\\pi}=\\rho_{\\pi_{E}}(s){\\cal A}^{\\pi_{E}}(s,a)}}\\\\ {{\\displaystyle\\qquad=\\rho_{\\pi_{E}}(s)\\sum_{n=0}^{\\infty}\\gamma^{n}[p(s_{n}=\\bar{s}|s_{0}=s)-p(s_{n}=\\bar{s}|s_{0}=s,a_{0}=a)]\\lambda H(\\pi_{\\mathrm{E}}(\\cdot|\\bar{s}))}}\\\\ {{\\displaystyle\\qquad=0}}\\end{array}\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "Proposition C.5. The optimization problem ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\operatorname*{max}_{D}V_{D}(D,\\pi)=\\mathbb{E}_{\\pi}[\\log D(s,a)]+\\mathbb{E}_{\\pi_{E}}[\\log(1-D(s,a))]\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "converges when $\\pi=\\pi_{E}$ and $\\begin{array}{r}{D(s,a)=\\frac{1}{2}\\,f o r\\,\\forall s,a.}\\end{array}$ . Namely, ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\frac{\\partial V_{D}}{\\partial D}|_{\\pi(s,a)=\\pi_{E}(s,a),D(s,a)=\\frac{1}{2}}=0.\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "Proof. According to the chain rule of functional derivative, we have ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\begin{array}{l}{\\displaystyle\\frac{\\partial V_{D}}{\\partial D}=\\frac{\\partial\\mathbb{E}_{\\boldsymbol\\pi}[\\log D]+\\mathbb{E}_{\\boldsymbol\\pi_{E}}[\\log(1-D)]}{\\partial D}}\\\\ {\\displaystyle\\qquad=\\mathbb{E}_{\\boldsymbol\\pi}[\\frac{1}{D}]-\\mathbb{E}_{\\boldsymbol\\pi_{E}}[\\frac{1}{1-D}]}\\\\ {\\displaystyle\\qquad=\\mathbb{E}_{\\boldsymbol\\pi_{E}}[\\frac{1}{D}-\\frac{1}{1-D}]}\\\\ {\\displaystyle\\qquad=\\mathbb{E}_{\\boldsymbol\\pi_{E}}[2-2]}\\\\ {\\displaystyle\\qquad=0}\\end{array}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "D Proof of Theorem 4.1 ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "Theorem D.1. Let assumption 4.2 holds. The training dynamic of GAIL in Eq. (14) is asymptotically stable. ", "page_idx": 14}, {"type": "text", "text": "Proof. To analyze the convergence and stability behavior of system 14, first we need to verify definition 2.1 to make sure our goal functions are equilibrium points. Then we apply theorem 2.5 to prove system 14 is asymptotically stable. Notice that $\\boldsymbol{z}^{*}(t)=\\dot{(\\frac{1}{2},E)}^{\\top}$ , then we substitute this goal function to system 14 ", "page_idx": 14}, {"type": "equation", "text": "$$\nd(z^{*}(t))=f(z^{*}(t))=0\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "We the compute the linearized system near the goal function such that ", "page_idx": 14}, {"type": "equation", "text": "$$\nd(z(t))=\\mathbb{J}(f(z^{*}(t)))z(t)d t,\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "where $\\mathbb{J}$ is the Jacobian of function $f$ . Therefore, ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\mathbb{J}(f(z^{*}(t)))=\\left(^{-\\frac{c y(t)}{x(t)^{2}}-\\frac{c E}{(x(t)-1)^{2}}-k}\\begin{array}{c c}{\\frac{c}{x(t)}}\\\\ {-\\frac{c}{y(t)}}&{-\\frac{c\\lambda}{y(t)}+\\frac{\\alpha}{E}}\\end{array}\\right)_{(\\frac{1}{2},E)},\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "which after evaluation becomes ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\mathbb{J}(f(z^{*}(t)))=\\left({-8c E-k\\begin{array}{c}{2c}\\\\ {-2c}\\end{array}}\\right)\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "Then we compute the determinate and trace of $\\mathbb{J}(f(z^{*}(t)))$ , which ", "page_idx": 14}, {"type": "equation", "text": "$$\nd e t(\\mathbb{J}(f(z^{*}(t))))=\\frac{(8c^{2}\\lambda-8c\\alpha-4c^{2})E+(c k\\lambda-k\\alpha)}{E}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "equation", "text": "$$\nt r a c e(\\mathbb{J}(f(z^{*}(t))))=\\frac{-8c E^{2}-k E-c\\lambda+\\alpha}{E}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "Since $E=\\pi_{E}(a|s)$ has range $[0,1]$ , therefore we have $d e t(\\mathbb{J}(f(z^{*}(t))))>0$ , if ", "page_idx": 14}, {"type": "equation", "text": "$$\nc k\\lambda-k\\alpha>0\n$$", "text_format": "latex", "page_idx": 14}, {"type": "equation", "text": "$$\n8c^{2}\\lambda-8c\\alpha-4c^{2}+c k\\lambda-k\\alpha>0\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "The graph of $t r a c e(\\mathbb{J}((f(z^{*}(t)))))$ is also a downward hyperbola with middle point ( 1\u22126kc, k2+32c3(2\u2212cc\u03bb+\u03b1)). Therefore, trace(J((f(z\u2217(t))))) < 0, if ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\frac{k^{2}+32c(-c\\lambda+\\alpha)}{32c}<0.\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "Note that this implies $c k\\lambda-k\\alpha>0$ , since ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\frac{k^{2}+32c(-c\\lambda+\\alpha)}{32c}<0}\\\\ {\\frac{k^{2}}{32c}-c\\lambda+\\alpha<0}\\\\ {-\\frac{k^{2}}{32c}+c\\lambda-\\alpha>0}\\\\ {c\\lambda-\\alpha>\\frac{k^{2}}{32c}>0.}\\end{array}\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "As a result, system 14 is asymptotically stable if assumptions 4.2 hold. ", "page_idx": 15}, {"type": "image", "img_path": "t4VwoIYBf0/tmp/7214947aa698ea9af9f8bc68ee9f9fa9ae4b8eaeb0c634bcb4282771d0226e0b.jpg", "img_caption": ["E Ablation on k ", "Figure 4: Normalized returns curves for controlled GAIL with $k\\,=\\,0.1$ , $k\\,=\\,1$ , and $k\\,=\\,10$ on MuJoCo environments, where on the y-axis, 1 represents expert policy return and 0 represents random policy return "], "img_footnote": [], "page_idx": 16}, {"type": "table", "img_path": "t4VwoIYBf0/tmp/e235e3352796734ebcc97a09273828ac924824debbfc4dc163d2268830fa4025.jpg", "table_caption": ["F Comparison with Other IL Methods "], "table_footnote": ["Table 2: Return for each environment on various GAIL algorithms. "], "page_idx": 17}, {"type": "table", "img_path": "t4VwoIYBf0/tmp/54bb482b1093c7b67ad45348902e2e101715df910d9b150c3991443dc99a83b6.jpg", "table_caption": [], "table_footnote": ["Table 3: Number of Iterations needed to reach $\\overline{{95\\%}}$ of return "], "page_idx": 17}, {"type": "table", "img_path": "t4VwoIYBf0/tmp/0ccb74f1cd13089698616e1b5a5ce5898a13023dbe8d7b20c958fbf935abc353.jpg", "table_caption": [], "table_footnote": ["Table 4: Final reward with 1 trajectory in diffusion-based GAIL [2], both vanilla and controlled variant. Mean and standard deviation over five runs "], "page_idx": 17}, {"type": "table", "img_path": "t4VwoIYBf0/tmp/29b93d9e722eeddb16c9b195278466ee508f0777ecbd66998ec12b8a1d90720a.jpg", "table_caption": ["G Comparison in Atari tasks "], "table_footnote": ["Table 5: Final reward in five Atari tasks. Mean and standard deviation over ten runs "], "page_idx": 18}, {"type": "text", "text": "NeurIPS Paper Checklist ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "1. Claims ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "Question: Do the main claims made in the abstract and introduction accurately reflect the paper\u2019s contributions and scope? ", "page_idx": 19}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "Justification: We state our contribution and scope clearly in the abstract and introduction. Overall, we asymptotically stabilize the training process of GAIL and achieve a faster rate of convergence, smaller range of oscillation and match the expert distribution more closely. ", "page_idx": 19}, {"type": "text", "text": "Guidelines: ", "page_idx": 19}, {"type": "text", "text": "\u2022 The answer NA means that the abstract and introduction do not include the claims made in the paper.   \n\u2022 The abstract and/or introduction should clearly state the claims made, including the contributions made in the paper and important assumptions and limitations. A No or NA answer to this question will not be perceived well by the reviewers.   \n\u2022 The claims made should match theoretical and experimental results, and reflect how much the results can be expected to generalize to other settings.   \n\u2022 It is fine to include aspirational goals as motivation as long as it is clear that these goals are not attained by the paper. ", "page_idx": 19}, {"type": "text", "text": "2. Limitations ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "Question: Does the paper discuss the limitations of the work performed by the authors? ", "page_idx": 19}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "Justification: We discuss the limitations of our paper in Section 7. ", "page_idx": 19}, {"type": "text", "text": "Guidelines: ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "\u2022 The answer NA means that the paper has no limitation while the answer No means that the paper has limitations, but those are not discussed in the paper.   \n\u2022 The authors are encouraged to create a separate \"Limitations\" section in their paper.   \n\u2022 The paper should point out any strong assumptions and how robust the results are to violations of these assumptions (e.g., independence assumptions, noiseless settings, model well-specification, asymptotic approximations only holding locally). The authors should reflect on how these assumptions might be violated in practice and what the implications would be.   \n\u2022 The authors should reflect on the scope of the claims made, e.g., if the approach was only tested on a few datasets or with a few runs. In general, empirical results often depend on implicit assumptions, which should be articulated.   \n\u2022 The authors should reflect on the factors that influence the performance of the approach. For example, a facial recognition algorithm may perform poorly when image resolution is low or images are taken in low lighting. Or a speech-to-text system might not be used reliably to provide closed captions for online lectures because it fails to handle technical jargon.   \n\u2022 The authors should discuss the computational efficiency of the proposed algorithms and how they scale with dataset size.   \n\u2022 If applicable, the authors should discuss possible limitations of their approach to address problems of privacy and fairness.   \n\u2022 While the authors might fear that complete honesty about limitations might be used by reviewers as grounds for rejection, a worse outcome might be that reviewers discover limitations that aren\u2019t acknowledged in the paper. The authors should use their best judgment and recognize that individual actions in favor of transparency play an important role in developing norms that preserve the integrity of the community. Reviewers will be specifically instructed to not penalize honesty concerning limitations. ", "page_idx": 19}, {"type": "text", "text": "3. Theory Assumptions and Proofs ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "Question: For each theoretical result, does the paper provide the full set of assumptions and a complete (and correct) proof? ", "page_idx": 19}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 20}, {"type": "text", "text": "Justification: We provide our assumptions in Section 2 and Assumption 4.2. Our complete proofs are provided in Section C and D. ", "page_idx": 20}, {"type": "text", "text": "Guidelines: ", "page_idx": 20}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include theoretical results.   \n\u2022 All the theorems, formulas, and proofs in the paper should be numbered and crossreferenced.   \n\u2022 All assumptions should be clearly stated or referenced in the statement of any theorems.   \n\u2022 The proofs can either appear in the main paper or the supplemental material, but if they appear in the supplemental material, the authors are encouraged to provide a short proof sketch to provide intuition.   \n\u2022 Inversely, any informal proof provided in the core of the paper should be complemented by formal proofs provided in appendix or supplemental material.   \n\u2022 Theorems and Lemmas that the proof relies upon should be properly referenced. ", "page_idx": 20}, {"type": "text", "text": "4. Experimental Result Reproducibility ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Question: Does the paper fully disclose all the information needed to reproduce the main experimental results of the paper to the extent that it affects the main claims and/or conclusions of the paper (regardless of whether the code and data are provided or not)? ", "page_idx": 20}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 20}, {"type": "text", "text": "Justification: We include the implementation of our method in Algorithm 1. Additionally, we submit an additional zip file to reproduce our experimental results. ", "page_idx": 20}, {"type": "text", "text": "Guidelines: ", "page_idx": 20}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 If the paper includes experiments, a No answer to this question will not be perceived well by the reviewers: Making the paper reproducible is important, regardless of whether the code and data are provided or not.   \n\u2022 If the contribution is a dataset and/or model, the authors should describe the steps taken to make their results reproducible or verifiable.   \n\u2022 Depending on the contribution, reproducibility can be accomplished in various ways. For example, if the contribution is a novel architecture, describing the architecture fully might suffice, or if the contribution is a specific model and empirical evaluation, it may be necessary to either make it possible for others to replicate the model with the same dataset, or provide access to the model. In general. releasing code and data is often one good way to accomplish this, but reproducibility can also be provided via detailed instructions for how to replicate the results, access to a hosted model (e.g., in the case of a large language model), releasing of a model checkpoint, or other means that are appropriate to the research performed.   \n\u2022 While NeurIPS does not require releasing code, the conference does require all submissions to provide some reasonable avenue for reproducibility, which may depend on the nature of the contribution. For example (a) If the contribution is primarily a new algorithm, the paper should make it clear how to reproduce that algorithm. (b) If the contribution is primarily a new model architecture, the paper should describe the architecture clearly and fully. (c) If the contribution is a new model (e.g., a large language model), then there should either be a way to access this model for reproducing the results or a way to reproduce the model (e.g., with an open-source dataset or instructions for how to construct the dataset). (d) We recognize that reproducibility may be tricky in some cases, in which case authors are welcome to describe the particular way they provide for reproducibility. In the case of closed-source models, it may be that access to the model is limited in some way (e.g., to registered users), but it should be possible for other researchers to have some path to reproducing or verifying the results. ", "page_idx": 20}, {"type": "text", "text": "5. Open access to data and code ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Question: Does the paper provide open access to the data and code, with sufficient instructions to faithfully reproduce the main experimental results, as described in supplemental material? ", "page_idx": 21}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 21}, {"type": "text", "text": "Justification: We submit an additional zip file to reproduce our experimental results. Guidelines: ", "page_idx": 21}, {"type": "text", "text": "\u2022 The answer NA means that paper does not include experiments requiring code.   \n\u2022 Please see the NeurIPS code and data submission guidelines (https://nips.cc/ public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 While we encourage the release of code and data, we understand that this might not be possible, so \u201cNo\u201d is an acceptable answer. Papers cannot be rejected simply for not including code, unless this is central to the contribution (e.g., for a new open-source benchmark).   \n\u2022 The instructions should contain the exact command and environment needed to run to reproduce the results. See the NeurIPS code and data submission guidelines (https: //nips.cc/public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 The authors should provide instructions on data access and preparation, including how to access the raw data, preprocessed data, intermediate data, and generated data, etc.   \n\u2022 The authors should provide scripts to reproduce all experimental results for the new proposed method and baselines. If only a subset of experiments are reproducible, they should state which ones are omitted from the script and why.   \n\u2022 At submission time, to preserve anonymity, the authors should release anonymized versions (if applicable).   \n\u2022 Providing as much information as possible in supplemental material (appended to the paper) is recommended, but including URLs to data and code is permitted. ", "page_idx": 21}, {"type": "text", "text": "6. Experimental Setting/Details ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "Question: Does the paper specify all the training and test details (e.g., data splits, hyperparameters, how they were chosen, type of optimizer, etc.) necessary to understand the results? ", "page_idx": 21}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "Justification: We specify our settings in Section 6.1, and we provide an ablation study on hyperparameters in Section E. ", "page_idx": 21}, {"type": "text", "text": "Guidelines: ", "page_idx": 21}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments. \u2022 The experimental setting should be presented in the core of the paper to a level of detail that is necessary to appreciate the results and make sense of them. \u2022 The full details can be provided either with the code, in appendix, or as supplemental material. ", "page_idx": 21}, {"type": "text", "text": "7. Experiment Statistical Significance ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "Question: Does the paper report error bars suitably and correctly defined or other appropriate information about the statistical significance of the experiments? ", "page_idx": 21}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 21}, {"type": "text", "text": "Justification: We provide the error bars in Figure 1 and 3. The methodology for their calculation is included in their respective captions and Section 6.1. ", "page_idx": 21}, {"type": "text", "text": "Guidelines: ", "page_idx": 21}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The authors should answer \"Yes\" if the results are accompanied by error bars, confidence intervals, or statistical significance tests, at least for the experiments that support the main claims of the paper.   \n\u2022 The factors of variability that the error bars are capturing should be clearly stated (for example, train/test split, initialization, random drawing of some parameter, or overall run with given experimental conditions).   \n\u2022 The method for calculating the error bars should be explained (closed form formula, call to a library function, bootstrap, etc.)   \n\u2022 The assumptions made should be given (e.g., Normally distributed errors).   \n\u2022 It should be clear whether the error bar is the standard deviation or the standard error of the mean.   \n\u2022 It is OK to report 1-sigma error bars, but one should state it. The authors should preferably report a 2-sigma error bar than state that they have a $96\\%$ CI, if the hypothesis of Normality of errors is not verified.   \n\u2022 For asymmetric distributions, the authors should be careful not to show in tables or figures symmetric error bars that would yield results that are out of range (e.g. negative error rates).   \n\u2022 If error bars are reported in tables or plots, The authors should explain in the text how they were calculated and reference the corresponding figures or tables in the text. ", "page_idx": 21}, {"type": "text", "text": "", "page_idx": 22}, {"type": "text", "text": "8. Experiments Compute Resources ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Question: For each experiment, does the paper provide sufficient information on the computer resources (type of compute workers, memory, time of execution) needed to reproduce the experiments? ", "page_idx": 22}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 22}, {"type": "text", "text": "Justification: We provide information on computer resources in Section 6.1. Guidelines: ", "page_idx": 22}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The paper should indicate the type of compute workers CPU or GPU, internal cluster, or cloud provider, including relevant memory and storage.   \n\u2022 The paper should provide the amount of compute required for each of the individual experimental runs as well as estimate the total compute.   \n\u2022 The paper should disclose whether the full research project required more compute than the experiments reported in the paper (e.g., preliminary or failed experiments that didn\u2019t make it into the paper). ", "page_idx": 22}, {"type": "text", "text": "9. Code Of Ethics ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Question: Does the research conducted in the paper conform, in every respect, with the NeurIPS Code of Ethics https://neurips.cc/public/EthicsGuidelines? ", "page_idx": 22}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Justification: Our research comforms with the NeurIPS Code of Ethics. Guidelines: ", "page_idx": 22}, {"type": "text", "text": "\u2022 The answer NA means that the authors have not reviewed the NeurIPS Code of Ethics.   \n\u2022 If the authors answer No, they should explain the special circumstances that require a deviation from the Code of Ethics.   \n\u2022 The authors should make sure to preserve anonymity (e.g., if there is a special consideration due to laws or regulations in their jurisdiction). ", "page_idx": 22}, {"type": "text", "text": "10. Broader Impacts ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Question: Does the paper discuss both potential positive societal impacts and negative societal impacts of the work performed? ", "page_idx": 22}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Justification: We discuss broader impacts of our work in Appendix A. Guidelines: ", "page_idx": 22}, {"type": "text", "text": "\u2022 The answer NA means that there is no societal impact of the work performed.   \n\u2022 If the authors answer NA or No, they should explain why their work has no societal impact or why the paper does not address societal impact.   \n\u2022 Examples of negative societal impacts include potential malicious or unintended uses (e.g., disinformation, generating fake profiles, surveillance), fairness considerations (e.g., deployment of technologies that could make decisions that unfairly impact specific groups), privacy considerations, and security considerations.   \n\u2022 The conference expects that many papers will be foundational research and not tied to particular applications, let alone deployments. However, if there is a direct path to any negative applications, the authors should point it out. For example, it is legitimate to point out that an improvement in the quality of generative models could be used to generate deepfakes for disinformation. On the other hand, it is not needed to point out that a generic algorithm for optimizing neural networks could enable people to train models that generate Deepfakes faster.   \n\u2022 The authors should consider possible harms that could arise when the technology is being used as intended and functioning correctly, harms that could arise when the technology is being used as intended but gives incorrect results, and harms following from (intentional or unintentional) misuse of the technology.   \n\u2022 If there are negative societal impacts, the authors could also discuss possible mitigation strategies (e.g., gated release of models, providing defenses in addition to attacks, mechanisms for monitoring misuse, mechanisms to monitor how a system learns from feedback over time, improving the efficiency and accessibility of ML). ", "page_idx": 22}, {"type": "text", "text": "", "page_idx": 23}, {"type": "text", "text": "11. Safeguards ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: Does the paper describe safeguards that have been put in place for responsible release of data or models that have a high risk for misuse (e.g., pretrained language models, image generators, or scraped datasets)? ", "page_idx": 23}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 23}, {"type": "text", "text": "Justification: We do not think our paper poses such risks. ", "page_idx": 23}, {"type": "text", "text": "Guidelines: ", "page_idx": 23}, {"type": "text", "text": "\u2022 The answer NA means that the paper poses no such risks.   \n\u2022 Released models that have a high risk for misuse or dual-use should be released with necessary safeguards to allow for controlled use of the model, for example by requiring that users adhere to usage guidelines or restrictions to access the model or implementing safety filters.   \n\u2022 Datasets that have been scraped from the Internet could pose safety risks. The authors should describe how they avoided releasing unsafe images.   \n\u2022 We recognize that providing effective safeguards is challenging, and many papers do not require this, but we encourage authors to take this into account and make a best faith effort. ", "page_idx": 23}, {"type": "text", "text": "12. Licenses for existing assets ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: Are the creators or original owners of assets (e.g., code, data, models), used in the paper, properly credited and are the license and terms of use explicitly mentioned and properly respected? ", "page_idx": 23}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 23}, {"type": "text", "text": "Justification: We properly cite all the original papers we used. ", "page_idx": 23}, {"type": "text", "text": "Guidelines: ", "page_idx": 23}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not use existing assets.   \n\u2022 The authors should cite the original paper that produced the code package or dataset.   \n\u2022 The authors should state which version of the asset is used and, if possible, include a URL.   \n\u2022 The name of the license (e.g., CC-BY 4.0) should be included for each asset.   \n\u2022 For scraped data from a particular source (e.g., website), the copyright and terms of service of that source should be provided.   \n\u2022 If assets are released, the license, copyright information, and terms of use in the package should be provided. For popular datasets, paperswithcode.com/datasets has curated licenses for some datasets. Their licensing guide can help determine the license of a dataset.   \n\u2022 For existing datasets that are re-packaged, both the original license and the license of the derived asset (if it has changed) should be provided. ", "page_idx": 23}, {"type": "text", "text": "\u2022 If this information is not available online, the authors are encouraged to reach out to the asset\u2019s creators. ", "page_idx": 24}, {"type": "text", "text": "13. New Assets ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Question: Are new assets introduced in the paper well documented and is the documentation provided alongside the assets? ", "page_idx": 24}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 24}, {"type": "text", "text": "Justification: This paper does not release new assets. ", "page_idx": 24}, {"type": "text", "text": "Guidelines: ", "page_idx": 24}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not release new assets.   \n\u2022 Researchers should communicate the details of the dataset/code/model as part of their submissions via structured templates. This includes details about training, license, limitations, etc.   \n\u2022 The paper should discuss whether and how consent was obtained from people whose asset is used.   \n\u2022 At submission time, remember to anonymize your assets (if applicable). You can either create an anonymized URL or include an anonymized zip file. ", "page_idx": 24}, {"type": "text", "text": "14. Crowdsourcing and Research with Human Subjects ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Question: For crowdsourcing experiments and research with human subjects, does the paper include the full text of instructions given to participants and screenshots, if applicable, as well as details about compensation (if any)? ", "page_idx": 24}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 24}, {"type": "text", "text": "Justification: This paper does not involve crowdsourcing nor research with human subjects. Guidelines: ", "page_idx": 24}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Including this information in the supplemental material is fine, but if the main contribution of the paper involves human subjects, then as much detail as possible should be included in the main paper.   \n\u2022 According to the NeurIPS Code of Ethics, workers involved in data collection, curation, or other labor should be paid at least the minimum wage in the country of the data collector. ", "page_idx": 24}, {"type": "text", "text": "15. Institutional Review Board (IRB) Approvals or Equivalent for Research with Human Subjects ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Question: Does the paper describe potential risks incurred by study participants, whether such risks were disclosed to the subjects, and whether Institutional Review Board (IRB) approvals (or an equivalent approval/review based on the requirements of your country or institution) were obtained? ", "page_idx": 24}, {"type": "text", "text": "Answer: [NA] ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Justification: This paper does not involve crowdsourcing nor research with human subjects. Guidelines: ", "page_idx": 24}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Depending on the country in which research is conducted, IRB approval (or equivalent) may be required for any human subjects research. If you obtained IRB approval, you should clearly state this in the paper.   \n\u2022 We recognize that the procedures for this may vary significantly between institutions and locations, and we expect authors to adhere to the NeurIPS Code of Ethics and the guidelines for their institution.   \n\u2022 For initial submissions, do not include any information that would break anonymity (if applicable), such as the institution conducting the review. ", "page_idx": 24}]