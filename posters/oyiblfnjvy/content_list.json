[{"type": "text", "text": "Exploration by Learning Diverse Skills through Successor State Representations ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Paul-Antoine Le Tolguenec Yann Besse ISAE-Supaero, Airbus Airbus paul-antoine.le-tolguenec@airbus.com yann.besse@airbus.com ", "page_idx": 0}, {"type": "text", "text": "Florent Teichteil-Konigsbuch Airbus florent.teichteil-konigsbuch@airbus.com ", "page_idx": 0}, {"type": "text", "text": "Dennis G. Wilson ISAE-Supaero, Universit\u00e9 de Toulouse dennis.wilson@isae-supaero.fr ", "page_idx": 0}, {"type": "text", "text": "Emmanuel Rachelson ISAE-Supaero, Universit\u00e9 de Toulouse emmanuel.rachelson@isae-supaero.fr ", "page_idx": 0}, {"type": "text", "text": "Abstract ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "The ability to perform different skills can encourage agents to explore. In this work, we aim to construct a set of diverse skills that uniformly cover the state space. We propose a formalization of this search for diverse skills, building on a previous definition based on the mutual information between states and skills. We consider the distribution of states reached by a policy conditioned on each skill and leverage the successor state representation to maximize the difference between these skill distributions. We call this approach LEADS: Learning Diverse Skills through Successor State Representations. We demonstrate our approach on a set of maze navigation and robotic control tasks which show that our method is capable of constructing a diverse set of skills which exhaustively cover the state space without relying on reward or exploration bonuses. Our findings demonstrate that this new formalization promotes more robust and efficient exploration by combining mutual information maximization and exploration bonuses. ", "page_idx": 0}, {"type": "text", "text": "1 Introduction ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Humans demonstrate an outstanding ability to elaborate a repertoire of varied skills and behaviors, without extrinsic motivation and supervision. This ability is currently captured through the problem of unsupervised skill discovery in reinforcement learning [41], where one seeks to learn a finite set of policies in a given environment whose behaviors are notably different from each other. Implicitly, seeking behavioral diversity is also related to the question of efficient exploration, as a set of skills that better covers the state space is often preferable. Seeking diversity has recently been successfully studied through the prism of mutual information maximization [17, 13, 8]. In this article, we argue maximizing mutual information might be ambiguous when seeking exploratory behaviors and propose an alternative, motivated variant. The key intuition underpinning this formulation is that a good set of exploratory skills should maximize state coverage, while preserving the ability to distinguish a skill from another. Then, we propose a new algorithm which implements this generalized objective, leveraging neural networks as estimators of the state occupancy measure. This algorithm demonstrates better exploration properties than state of the art methods, both those designed for reward-free exploration and those seeking skill diversity. ", "page_idx": 0}, {"type": "text", "text": "We motivate our developments with a first illustrative toy example. Let us consider a reward-free Markov decision process [38, MDP] $(S,\\mathcal{A},P,\\gamma,\\delta_{0})$ where $\\boldsymbol{S}$ is the state space, $\\boldsymbol{\\mathcal{A}}$ the action space, $P$ the transition function, $\\gamma$ the discount factor and $\\delta_{0}$ the initial state distribution. A behavior policy, parameterized by $\\theta$ , maps state to distribution over actions. We define a skill encoding $z\\in\\mathbb{R}^{\\bar{d}}$ as an abstract set of skill descriptors that enhances the policy description and conditions the action taken $a\\sim\\pi_{\\theta}(s,z)$ , making the policy a function $\\pi:\\Theta\\ ^{\\cdot}\\!\\times\\!\\mathcal{S}\\stackrel{\\cdot}{\\times}\\mathbb{R}^{d}\\mapsto\\Delta(A)$ . Unsupervised skill discovery generally considers a finite collection $\\mathcal{Z}=\\{z_{i}\\}_{i\\in[1,n]}$ of $n$ skills, and a distribution $p(z)$ on skills within $\\mathcal{Z}$ (generally uniform). For a given $\\theta$ , each skill $z$ induces a state distribution $p(s|z)$ . The state distribution under the full set of skills is hence $\\begin{array}{r}{p(s)=\\sum_{\\mathcal{Z}}p(s|z)p(z)}\\end{array}$ . When maximizing diversity, we aim to find $\\theta^{*}$ such that, for any pair of skills $z_{1},z_{2}\\in{\\mathcal{Z}}$ , the states visited by each skill are as separable as possible. Additionally, we would like the state coverage of the full set of skills to cover as much of the state space as possible. ", "page_idx": 1}, {"type": "text", "text": "Maximizing diversity has been formalized in the literature as the maximization of the mutual information $\\mathcal{T}(S,Z)$ between the state random variable $S$ and the skill descriptor $Z$ . This mutual information [39, MI] quantifies how predictable $S$ is, when $Z$ is known (and conversely): ", "page_idx": 1}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathcal{Z}(S,Z)\\triangleq D_{K L}(\\mathbb{P}(S,Z)||\\mathbb{P}(S)\\mathbb{P}(Z)),}\\\\ &{\\qquad\\qquad=\\mathcal{H}(S)-\\mathcal{H}(S|Z),}\\end{array}\n$$", "text_format": "latex", "page_idx": 1}, {"type": "text", "text": "where $D_{K L}$ is the Kullback-Leibler divergence and $\\mathcal{H}$ is the (conditional) entropy. ", "page_idx": 1}, {"type": "image", "img_path": "oyiBLfNJvY/tmp/9b000896ec52274e760c6a3bd20223eb004dac83f4c95d80ee562ae007c5b995.jpg", "img_caption": ["Figure 1: State distributions of two sets $\\mathcal{Z}_{1}$ (left) and ${\\mathcal{Z}}_{2}$ (right) of four skills each on a grid maze. Each skill\u2019s visited states are represented by a different symbol and distributed uniformly. The gray boxes are unreachable. "], "img_footnote": [], "page_idx": 1}, {"type": "text", "text": "Figure 1 illustrates why $\\mathcal{T}(S,Z)$ is an imperfect measure of diversity. In this figure, two sets ${\\mathcal{Z}}_{1}$ and ${\\mathcal{Z}}_{2}$ of four skills each are represented by their respective state coverage in a grid maze ", "page_idx": 1}, {"type": "text", "text": "MDP (one symbol per skill). In each set of skills, each skill is picked with probability $p(z)=1/4$ . On the leftmost image $(\\mathcal{Z}_{1})$ , each skill covers a single state, hence $p(s|z)\\,=\\,1$ in this state and 0 otherwise. On the rightmost image $(\\mathcal{Z}_{2})$ , $p(s|z)\\bar{=}\\,1/2$ on each covered state and 0 otherwise. Consequently, $\\mathcal{Z}_{1}(S,Z)=\\mathcal{H}_{1}(S)-\\mathcal{H}_{1}(S|Z)=\\log4$ and $\\mathcal{T}_{2}(S,Z)=\\mathcal{H}_{2}(S)-\\mathcal{H}_{2}(S|Z)=\\log4$ The mutual information is hence ambiguous as it ranks the two sets of skills equally, while ${\\mathcal{Z}}_{2}$ enables better exploration. ", "page_idx": 1}, {"type": "text", "text": "Our contribution is structured around maximizing a variant of $\\mathcal{T}(S,Z)$ , using the successor state representation [4] to enable its estimation. Section 2 puts this idea in perspective of the relevant literature, highlighting similarities and contrasts with previous works. Then Section 3 introduces and discusses our LEADS algorithm. Section 4 reports empirical evidence of the good exploratory properties of LEADS, demonstrating its ability to outperform state-of-the-art methods on a span of benchmarks. ", "page_idx": 1}, {"type": "text", "text": "2 Related work ", "text_level": 1, "page_idx": 1}, {"type": "text", "text": "This section endeavors to provide the reader with a comprehensive overview of approaches which aim at exploration in RL and skill diversity. ", "page_idx": 1}, {"type": "text", "text": "Exploration bonuses. Driving exploration by defining reward bonuses has been a major field of research for over two decades [25, 6, 1, 3, 36, 7, 2, 19]. These methods generally involve defining reward bonuses across the state space, which decrease over time in well-explored states. In large state spaces where count-based methods are challenging, these approaches require function approximation to generalize across the state space. However, as explained by Jarrett et al. [23], identifying these exploration bonus approximators is an adversarial optimization problem making these approaches unstable in practice [12]. ", "page_idx": 1}, {"type": "text", "text": "Quality Diversity. Exploration can also be achieved as a by-product of behavior diversity search. Evolutionary algorithms have been used to search for new behaviors, such as in Novelty Search [27], and for a diversity of behaviors which encourage high performance through the growing domain of Quality Diversity algorithms, exemplified by MAP-Elites [11]. In these algorithms, skills are usually characterized through hand-crafted behavior descriptors, although there are methods which learn such descriptors through variational inference [10, 9]. Diversity is expressed as the coverage over such descriptors, and policies are modified through gradient-free [11] or gradient-based [32] updates in order to incrementally populate an archive of diverse skills. While these algorithms have demonstrated competitive results with exploration algorithms in RL [9], in general, they require expertise to define a behavior descriptor and are less sample-efficient than RL methods [28]. ", "page_idx": 1}, {"type": "text", "text": "", "page_idx": 2}, {"type": "text", "text": "Information theory approaches to diversity. The field of information theory offers valuable insights into designing algorithms that generically promote diversity. Gregor et al. [17], Eysenbach et al. [13] and Sharma et al. [40] were pioneers in proposing methods to maximize either the reverse or forward form of $\\mathcal{T}(S,Z)$ for a fixed set of skills $\\mathcal{Z}$ . To address the issue of unbalanced state distributions across skills throughout the entire environment, Campos et al. [8] suggest sequencing the problem into three stages: pure exploration in $\\boldsymbol{S}$ to promote sampled states diversity, state clustering via variational inference, and skill learning by maximisation of the forward form as proposed by Sharma et al. [40]. In the exploration phase, Campos et al. [8] employs the State Marginal Matching algorithm proposed by Lee et al. [26], which resembles MI-based algorithms as it combines mutual information maximization with an exploration bonus to efficiently explore the state space. ", "page_idx": 2}, {"type": "text", "text": "Focusing even more on exploration, Liu and Abbeel [29] automate learning Novelty Search behavior descriptors by training an encoder with contrastive learning in order to promote exploration. Focusing also on exploration, Kamienny et al. [24] employ an incremental approach combined with the maximization of the reverse form of MI to eliminate skills that are not discernable enough, subsequently generating new skills from the most discernable ones. ", "page_idx": 2}, {"type": "text", "text": "Finally, recent studies including those by Park et al. [33], Park et al. [34], and Park et al. [35], integrate mutual information (MI) with trajectory-based metrics between states to enhance exploration. Specifically, these studies aim to maximize the Wasserstein distance, also known as the Earth mover\u2019s distance, between $\\mathbb{P}(S,Z)$ and $\\mathbb{P}(S)\\mathbb{P}(Z)$ while the definition of MI uses the KL divergence. This distance requires specifying a metric for the state space. Park et al. [33] and Park et al. [34] uses the Euclidean distance, while Park et al. [35] employs the temporal distance. ", "page_idx": 2}, {"type": "text", "text": "It is important to note that, although these methods induce an interesting approach to exploration (as a by-product of diversity), they do not explicitly aim at encouraging coverage of the MDP\u2019s state space. ", "page_idx": 2}, {"type": "text", "text": "Successor features for MI maximization. Few attempts have been made to exploit universal successor features [5] in MI maximization methods. Machado et al. [30] decompose the learning process into two stages: first, they automatically acquire specific options, which are then used to develop a hierarchical policy that integrates these options. In contrast, Hansen et al. [21] first learn a general task-based policy conditioned on a task $z$ , and subsequently optimize the reverse form of MI by utilizing universal successor features to identify a range of diverse skills efficiently. More recently, Grillotti et al. [18] used successor features to optimize the quality of predefined behaviors based on the Quality Diversity formulation, which requires hand-crafted behavior descriptors. ", "page_idx": 2}, {"type": "text", "text": "The method we propose explicitly aims at promoting diversity with the goal of achieving good exploration. For this purpose, we turn the MI objective function into a new objective which promotes exploration, separating this work from previous contributions in MI maximization. ", "page_idx": 2}, {"type": "text", "text": "3 Promoting exploration with successor state representations ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "We now derive an algorithm that explicitly encourages exploration in diversity search. We start by casting mutual information maximization in terms of state occupancy measures and derive a lower bound which can be maximized with stochastic gradient ascent on the policy\u2019s parameters $\\theta$ (Section 3.1). Then, as maximizing MI does not encourage exploration, we transform this lower bound so that its maximization ftis this goal, leading to a new target quantity designed to promote both diversity and exploration (Section 3.2). This enables defining and implementing a general algorithm for Learning Diverse Skills through successor state representations (LEADS, Section 3.3). ", "page_idx": 2}, {"type": "text", "text": "3.1 MI lower bound with successor state representations ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "The mutual information $\\mathcal{T}(S,Z)$ is naturally expressed through the (conditional) probability densities of $S$ and $Z$ . Successor state representation estimators [4, SSR] provide a direct way of estimating these densities. More precisely, we identify the Successor State Representation as the density of the measure defined on the set of states. The SSR $p(s|s_{1},\\theta,z)$ of a skill $(\\theta,z)$ is the state occupancy measure of policy $\\pi_{\\boldsymbol{\\theta}}(s,z)$ , when starting from $s_{1}$ , that is ", "page_idx": 3}, {"type": "equation", "text": "$$\np(s_{2}|s_{1},\\theta,z)=\\sum_{t=0}^{\\infty}\\gamma^{t}p\\left(s_{t}=s_{2}\\left|\\begin{array}{l}{s_{0}=s_{1},}\\\\ {a_{t}\\sim\\pi_{\\theta}(s_{t},z)}\\end{array}\\right.\\right).\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "For the sake of readability, we make $\\theta$ implicit in our notations going forward. This measure can be understood as the probability density of reaching the state $s_{2}$ starting from another state $s_{1}$ when the skill $z$ is used [22]. It encodes all the paths of the Markov chain that can be taken from $s_{1}$ to $s_{2}$ when the skill $z$ is used [4]. Here $(s_{1},s_{2})\\bar{\\in}\\;{\\cal S}^{2}$ can be any two states of the Markov chain. ", "page_idx": 3}, {"type": "text", "text": "The SSR is the fixed point of a Bellman operator and one can employ temporal difference (TD) learning to guide a function approximator towards this fixed point. There are numerous methods for estimating the SSR density [4, 22, 14, 15]. In this paper, we use C-Learning [14] for estimating the SSR for all experiments. C-Learning proposes to cast the regression problem of learning $p$ as a classification problem. Specifically, for a given pair $\\left(s_{1},a,z\\right)$ , a classifier $\\sigma(f_{\\phi}(s_{1},a,s_{2},\\bar{z}))$ , where $\\sigma$ is the sigmoid function, is trained to predict whether $s_{2}$ was sampled from an outcome trajectory from $s_{1}$ $(s_{2}\\,\\sim\\,p(\\cdot|s_{1},a,z))$ or from the marginal density of all possible skills $(s_{2}\\,\\sim$ $p(s)$ , the distribution over $\\boldsymbol{S}$ ). The optimal classifier holds the following relation with the SSR\u2019s density: $e^{f_{\\phi}(s_{1},a,s_{2},z)}=p(s_{2}|s_{1},a,z)/p(s_{2})$ . We denote $m_{\\phi}(s_{1},a,s_{2},z)\\,=\\,e^{f_{\\phi}(s_{1},a,s_{2},z)}$ , as the SSR estimated via C-Learning, taking $a\\sim\\pi_{\\theta}{\\left(s_{1},z\\right)}$ . For the sake of brevity, we will use the notation $m_{\\phi}(s_{1},s_{2},z)\\,=\\,\\underset{a\\sim\\pi_{\\theta}(s_{1},z)}{\\mathbb{E}}\\,[\\bar{m}_{\\phi}(s_{1},\\stackrel{.}{a},s_{2},z)]$ . We note that any method which reliably estimates $m_{\\phi}(s_{1},s_{2},z)$ can be used instead of C-Learning in LEADS. ", "page_idx": 3}, {"type": "text", "text": "As described in Section 1, the mutual information between the state random variable $S$ and the skill descriptor $Z$ is $\\mathcal{Z}(S,Z)=D_{K L}(\\mathbb{P}(S,Z)||\\mathbb{P}(S)\\mathbb{P}(Z))$ . This can be expressed as ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\mathcal{Z}(S,Z)=\\mathbb{E}_{(s_{2},z)\\sim p(s,z)}\\left[\\log\\left(p(s_{2}|z)/p(s_{2})\\right)\\right].}\\end{array}\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "State $s_{2}$ can be any state $s$ within the set $\\boldsymbol{S}$ , yet we refer to it as $s_{2}$ to ensure that when we incorporate the definition of the SSR, it aligns directly with the notation of Equation 1. By definition of the SSR under a given policy $\\pi(s,z)$ , the state distribution $p(s|z)$ obeys ", "page_idx": 3}, {"type": "equation", "text": "$$\np(s_{2}|z)=\\mathbb{E}_{s_{1}\\sim p(s|z)}\\left[p(s_{2}|s_{1},z)\\right].\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "By sampling $s_{1}\\ \\sim\\ p(s|z)$ , we can therefore estimate $p(s_{2}|z)$ , allowing for the injection of $m(s_{1},s_{2},z)=p(s_{2}|s_{1},z)/p(s_{2})$ from Eysenbach et al. [14] into Equation 2: ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\mathbb{Z}(S,Z)=\\mathbb{E}_{(s_{2},z)\\sim p(s,z)}\\left[\\log\\left(\\mathbb{E}_{s_{1}\\sim p(s|z)}\\left(m(s_{1},s_{2},z)\\right)\\right)\\right].}\\end{array}\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "A Monte Carlo estimator of $\\mathcal{T}(S,Z)$ can be obtained by sampling $(s,z)$ from a replay buffer. However, for every state $s$ sampled this way, the estimate of $p(s|z)$ provided by Equation 3 requires sampling a batch of $s_{1}\\sim p(s|\\bar{z})$ . This is possible through keeping separate replay buffers for each skill, but would be computationally intractable for an accurate estimation. Hence, as in similar methods, we turn rather to a lower bound on $\\mathcal{T}(S,Z)$ , which admits a Monte Carlo estimator, and which will be maximized with respect to $\\theta$ using stochastic gradient ascent. ", "page_idx": 3}, {"type": "text", "text": "Applying Jensen\u2019s inequality to the inner expectation in the previous expression yields ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\mathcal{Z}(S,Z)\\ge\\mathbb{E}_{\\textit{z}\\sim p(z)\\atop s_{2}\\sim p(s|z)}\\left[\\log(m(s_{1},s_{2},z))\\right].}\\\\ {s_{1}{\\sim}p(s|z)\\atop s_{1}{\\sim}p(s|z)}\\end{array}\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "Note that $\\theta$ participates in this lower bound through $m(s_{1},s_{2},z)=\\mathbb{E}_{a\\sim\\pi_{\\theta}(\\cdot|s_{1})}m(s_{1},a,s_{2},z)$ . This quantity is essentially what an algorithm like DIAYN [13] maximizes: given separate experience buffers for each skill, one can compute a Monte Carlo estimate of this lower bound on the gradient of the mutual information $\\mathcal{T}(S,Z)$ with respect to $\\theta$ . ", "page_idx": 3}, {"type": "text", "text": "3.2 Promoting exploration with different skills ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "Looking closely at Equation 4, one can note that the interplay between each skill\u2019s state distribution is lost when deriving the lower bound. Hence, this bound can be maximized without actually pushing skills towards distinct states, hence without skill diversity. To regain the incentive to promote skill diversity, we propose to encourage exploration in each skill to put probability mass on states which receive little coverage by the full set of skills. In other words, for a given transition $(s,\\pi(s))$ , we want to augment the probability of occurrence for one skill while decreasing it for all others. ", "page_idx": 4}, {"type": "text", "text": "Since $m(s_{1},s,z)\\geq0$ , we can introduce the following bound: ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\mathcal{Z}(S,Z)\\geq\\underset{s_{2}\\sim p(z)\\atop s_{1}\\sim p(s|z)}{\\mathbb{E}}\\left[\\log\\left(\\frac{m(s_{1},s_{2},z)}{1+\\underset{z^{\\prime}\\in\\mathcal{Z}}{\\sum}m(s_{1},s_{2},z^{\\prime})}\\right)\\right].\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "While Equation 5 is a looser lower bound than Equation 4, it goes towards the goal of diversity search originally captured by MI maximization: to have distinct state distributions for each skill. ", "page_idx": 4}, {"type": "text", "text": "However, as illustrated in the introductory example, maximizing MI does not promote large state coverage, nor exploratory behaviors. Equation 5 promotes skill diversity, but it does not explicitly encourage state coverage. We therefore argue that exploratory behaviors can be obtained by focusing the state distribution of each skill towards specific states within the support of $p(s|z)$ . Instead of sampling $s$ according to $p(s|z)$ , we encourage exploration by attributing more probability mass to states that trigger exploration. We do so by creating a sampling distribution $\\bar{\\delta}(s|z)$ based on an uncertainty measure $u_{t}(s,z)$ , as explained next. ", "page_idx": 4}, {"type": "text", "text": "Biasing a skill towards promising states for exploration is often achieved through exploratory bonuses based on uncertainty measures [36, 7, 2], or repulsion mechanisms [16]. These heuristic measures encourage exploration by pushing policies towards states of high uncertainty or away from previously covered transitions. The novelty of our approach is the use of an exploration bonus in the framing of mutual information maximization. However, by replacing $s_{2}\\,\\sim\\,p(s|z)$ by another sampling distribution $\\delta(s|z)$ , we lose the theoretic guarantee of maximizing the lower bound of Equation 5. Rather, we propose a new objective, expressing an incentive to explore within the search for skill diversity, but with a greater focus on state coverage through distinct skills than previous lower bounds on mutual information. The quantity we maximize is then: ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\mathcal{G}(\\theta)=\\underset{\\underset{s_{1}\\sim p(s\\mid z)}{\\mathbb{E}}}{\\mathbb{E}}\\left[\\log\\left(\\frac{m(s_{1},a_{z},s_{2},z)}{1+\\underset{z^{\\prime}\\in\\mathcal{Z}}{\\sum}m(s_{1},a_{z^{\\prime}},s_{2},z^{\\prime})}\\right)\\right].\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "The uncertainty measure $u_{t}$ which defines the distribution $\\delta(s|z)$ is designed to explore under-visited areas and to create repulsion between different skills. We define three desired properties for states to prioritize using this measure. To describe these properties, consider a sequence of policies $\\pi_{t}$ , each defining a set of skills $\\{\\pi_{t}(\\cdot,z)\\}_{z\\in\\mathcal{Z}}$ , and the corresponding sequence of SSRs $m_{t}$ ; the three properties are then as follows. (1) A good target state $s_{t}^{z}$ for skill $z$ at time step $t$ is one that has high probability of being visited by $\\pi_{t}(\\cdot,z)$ , but was relatively infrequently visited by previous policies\u2019 state occupancy measures $\\{m_{k}\\}_{k\\in[1,t-1]}$ for any skill. (2) It is also a state which has both high probability of being reached by the current $\\pi_{t}(\\cdot,z)$ and low probability of being reached by any other current skill, starting from $s_{0}$ . (3) Given a previous target state $s_{t-1}^{z}$ , a good new target state is one that has high (resp. low) probability to be reached by $\\pi_{t}(\\cdot,z)$ (resp. any other skill), starting from $s_{t-1}^{z}$ . While the first property explicitly encourages visiting under-visited states, the two others do not encourage exploration per se, and rather strengthen skill diversity by pushing their state distributions apart. This leads to the idea of ranking target states according to: ", "page_idx": 4}, {"type": "equation", "text": "$$\nu_{t}(s,z)=\\log\\left(\\frac{m_{t}(s_{0},s,z_{i})}{\\sum_{k=1}^{t-1}\\sum_{z^{\\prime}}m_{k}(s_{0},s,z^{\\prime})}\\right)+\\sum_{z^{\\prime}\\neq z}\\log\\left(\\frac{m_{t}(s_{t-1}^{z},s,z)}{m_{t}(s_{t-1}^{z^{\\prime}},s,z^{\\prime})}\\right)+\\log\\left(\\frac{m_{t}(s_{0},s,z)}{m_{t}(s_{0},s,z^{\\prime})}\\right)\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "The $\\delta(s|z)$ distribution of Equation 6 therefore allocates more probability to states with high $u_{t}(s,z)$ . Empirically, we found that making $\\delta$ deterministic as the Dirac distribution on a state that maximizes $u_{t}(s,z)$ enabled efficient exploration. Appendix A provides a more formal perspective on the derivation of the $u_{t}$ uncertainty measure. ", "page_idx": 5}, {"type": "text", "text": "3.3 The LEADS algorithm ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "With the objective of maximizing ${\\mathcal{G}}(\\theta)$ (Equation 6), we define the LEADS (Learning Diverse Skills through successor state representations) algorithm, presented in Algorithm 1. ", "page_idx": 5}, {"type": "text", "text": "In order to maximize ${\\mathcal{G}}(\\theta)$ , we must first sample from $p(s|z)$ for each skill $z$ , then compute the SSR for the current skills $\\pi_{t}(\\cdot,z)$ in order to define ${\\mathcal{G}}(\\theta)$ , then finally update $\\theta$ to maximize $\\mathcal G(\\theta)$ . As such, an iteration of LEADS features three phases in order to learn a new set of skills: sampling, learning the SSR, and optimizing the policy parameters $\\theta$ . ", "page_idx": 5}, {"type": "text", "text": "First, the sampling phase populates separate replay buffers $\\mathcal{D}_{z}$ for each skill $z\\,\\sim\\,p(z)$ . This is achieved by rolling out $n_{e p}$ episodes with a given policy $\\pi_{\\theta}(\\cdot,z)$ . Then, C-learning is used to compute the parameters $\\phi_{t}$ of a joint SSR $m_{t}(s_{1},a,s,z)$ for $\\pi_{t}$ , and store it. We note that the on-policy version of C-learning can be used for this step as the data in the replay buffers has been collected with the current policy $\\pi_{t}$ . This SSR, and all previous ones, are then used to define $\\dot{\\boldsymbol{u}}_{t}(s,z)$ , which in turn defines the distribution ", "page_idx": 5}, {"type": "table", "img_path": "oyiBLfNJvY/tmp/57b715fa5563bdc06ae52e4ed8026861c66eefee7dabc4fcf48c15dc1e50847e.jpg", "table_caption": [], "table_footnote": [], "page_idx": 5}, {"type": "text", "text": "$\\delta(s,z)$ . As this can be approximated for a static policy, sampling can be performed before updating $\\theta$ . Sampling $s\\sim\\delta(s|z)$ is performed by running all states in $\\mathcal{D}_{z}$ through $u_{t}(s,z)$ , although, to limit computational cost, we can restrict this evaluation and selection to only a uniformly drawn subset of each $\\mathcal{D}_{z}$ . ", "page_idx": 5}, {"type": "text", "text": "We therefore have the necessary components to optimize $\\theta$ according to ${\\mathcal{G}}(\\theta)$ : a means of sampling states and the SSR. At each gradient ascent step, we sample a mini-batch of states $s_{1}$ from $\\mathcal{D}_{z}$ for a given skill $z\\sim p(z)$ to estimate $p(s|z)$ . This permits calculating the objective ${\\mathcal{G}}(\\theta)$ for the current $\\theta$ using $m_{\\phi_{t}}$ and performing a gradient step. In the gradient calculation, we also include an action entropy maximization term, as done in other works [31, 20]: ", "page_idx": 5}, {"type": "equation", "text": "$$\n\\mathcal{H}(\\theta)=\\underset{s_{1}\\sim p(s|z)}{\\mathbb{E}}\\left[-\\log(\\pi_{\\theta}(a|s_{1},z))\\right].\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "$\\theta$ is therefore updated to maximize $\\mathcal{G}(\\theta)+\\lambda_{h}\\mathcal{H}(\\theta)$ , although $\\lambda_{h}$ is intentionally kept small (0.05) to focus on the principal LEADS objective ${\\mathcal{G}}(\\theta)$ . ", "page_idx": 5}, {"type": "text", "text": "Finally, after each gradient step, the SSR is updated using the off-policy formulation of C-learning so that $m_{\\phi_{t}}$ remains representative of the state distribution under $\\pi_{\\theta_{t}}$ . This is done without sampling new transitions and is justified by the fact that the target state $s_{t}^{z}$ and the states along a trajectory to $s_{t}^{z}$ are already within the replay buffer $\\mathcal{D}_{z}$ . $n_{S G D}$ steps of gradient ascent on $\\theta$ are performed in this way, before a new iteration of LEADS is started. ", "page_idx": 5}, {"type": "text", "text": "4 Experiments & Results ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "We demonstrate LEADS on a set of maze navigation and robotic control tasks and compare its behavior to state-of-the-art exploration algorithms. We provide all code for LEADS and the baseline algorithms, as well as the scripts to reproduce the experiments (repository). All hyperparameters are summarized in Appendix C. ", "page_idx": 6}, {"type": "text", "text": "4.1 Evaluation benchmarks ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "Mazes. Maze navigation has been frequently used in the exploration literature, as 2D environments allows for a clear visualization of the behaviors induced by an algorithm. The assessment of state coverage is also easier to understand than in environments with high-dimensional states. We design three different maze navigation tasks, named Easy, U, and Hard (depicted in Figure 2), of increasing difficulty in reaching all parts of the state space. In each of the mazes, the state space is defined by the agent\u2019s Euclidean coordinates $\\mathcal{S}=[-1,1]^{2}$ and the action space corresponds to the agent\u2019s velocity $\\bar{\\mathcal{A}}=[-1,1]^{2}$ . Hitting a wall terminates an episode, making exploration difficult. ", "page_idx": 6}, {"type": "text", "text": "Robotic control. We further assess the capabilities of LEADS in complex robotic control tasks. These tasks allow evaluating the ability of LEADS to explore in diverse and high-dimensional state spaces. We evaluate LEADS on a variety of MuJoCo [42] environments from different benchmark suites. Fetch-Reach [37] is a 7-DoF (degrees of freedom) robotic arm equipped with a two-fingered parallel gripper; its observation space is 10-dimensional. Fetch-Slide extends the former with a puck placed on a platform in front of the arm, increasing the observation space dimension to 25. Hand [37] is a 24-DoF anthropomorphic robotic hand, with a 63-dimensional observation space. Finger [44] a 3-DoF, 12-dimensional observation space, manipulation environment where a planar finger is required to rotate an object on an unactuated hinge. Appendix D discusses additional experiments and limitations on other MuJoCo tasks. ", "page_idx": 6}, {"type": "image", "img_path": "oyiBLfNJvY/tmp/8ade182237f7c788840d551b051987d3dd6156ba8b35330af67535f5c0101c94.jpg", "img_caption": ["Figure 2: Skill visualisation for each algorithm. Per algorithm, the tasks are the mazes Easy (top left), U (top right), Hard (bottom left), and the control task Fetch-Reach (bottom right). "], "img_footnote": [], "page_idx": 6}, {"type": "text", "text": "4.2 Skill Visualization ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "The first goal of this work, as exposed in the introductory example, is to obtain a set of skills that are as distinct from each other as possible in their visited states, while simultaneously covering as much of the state space as possible. We first assess this property in LEADS, DIAYN [13] and LSD [33] through a visual analysis of their state space coverage in Figure 2. For all experiments, the number of skills is $n_{\\mathrm{skill}}=6$ . To ensure fairness, for each algorithm, we report the skill visualization from the experiment that achieves maximum coverage (as defined in the following section) out of five runs. For each algorithm, Figure 2 presents four figures: the three mazes and the Fetch-Reach environment. In all the mazes, we visualize the 2D coordinates of the states reached over training. Given that 2D visualization is not suitable for the Fetch-Reach environment due to its higher state space dimension, we project the state onto the two first eigenvectors of a Principal Component Analysis (PCA) of the states encountered by all skills in this environment. ", "page_idx": 6}, {"type": "text", "text": "", "page_idx": 7}, {"type": "text", "text": "We note that LEADS clearly defines distinct skills in the state space. Furthermore, it leads to a more extensive exploration of the environment than LSD and DIAYN. The Hard maze (bottom left) is noteworthy, as some parts of the environment are difficult to access due to bottleneck passages in the maze. LEADS is the only algorithm that manages to reach all sections of the Hard maze. ", "page_idx": 7}, {"type": "image", "img_path": "oyiBLfNJvY/tmp/2e197b2d98c6502a526b7e8507abaf506dc12f6a80c80dcd36065e338a1da5c3.jpg", "img_caption": [], "img_footnote": [], "page_idx": 7}, {"type": "text", "text": "and a PCA over all explored states. ", "page_idx": 7}, {"type": "text", "text": "Figure 4: (a): The SSR $m(s_{0},s,z)$ at a given epoch during training on Hard maze, per skill, normalized in $[0,1]$ . (b): The uncertainty measure $u(s,z)$ at the final epoch on Hard maze, per skill, with the maximum state highlighted. ", "page_idx": 7}, {"type": "text", "text": "Figure 3 further demonstrates the ability of LEADS to create distinct skills in the high-dimensional state space of the Hand environment. It reports the state distribution obtained by $n_{\\mathrm{skill}}=12$ skills found by LEADS, projected onto the two first components of a PCA on all visited states. As in the maze navigation tasks, LEADS explores states in distinct clusters, organized by skill. These skills correspond to a visual variety of finger positions, illustrating the ability to discover varied behaviors. ", "page_idx": 7}, {"type": "text", "text": "Section 3.2 claimed that the uncertainty measure $u_{t}(s,z)$ of Equation 7, and its associated distribution $\\delta$ triggered relevant exploratory behaviors. Figures 4(a) and 4(b), display the final SSR and uncertainty measure, respectively, for the Hard maze task. The same visual representation of these densities for the other environments can be found in Appendix B. Figure 4(a) demonstrates that the SSR clearly separates states based on skill. The SSR is zero for all states outside of the distribution of a given skill, and all states in a skill have a non-zero probability of being reached by that skill. This confirms that this SSR can reliably be used within the objective function of Equation 6. ", "page_idx": 7}, {"type": "text", "text": "Similarly, Figure 4(b) illustrates how the uncertainty measure concentrates on states that promote both exploration and diversity. High values for this measure are found in very different states for each skill (hence promoting diversity), and within a skill, the highest value is found far from the starting state $s_{0}$ (hence promoting exploration). The state maximizing $u_{t}$ is represented by a colored dot for each skill. This confirms that the uncertainty measure achieves the joint goal of exploring under-visited areas and creating repulsion between skills. By defining $\\delta(s|z)$ as the state which maximizes $u_{t}(s,z)$ for each skill $z$ , LEADS ensures a continuing exploration of the state space. ", "page_idx": 7}, {"type": "text", "text": "4.3 Quantitative Evaluation ", "text_level": 1, "page_idx": 7}, {"type": "text", "text": "We now turn to a quantitative evaluation of the ability to explore using diversified skills. For the sake of completeness, we compare LEADS to seven seminal algorithms. Five of these are skill-based, namely DIAYN [13], SMM [26], LSD [33], CSD [34], and METRA [35]. We use $n_{\\mathrm{skill}}=6$ for each skill-based algorithm and for all environments. The two last algorithms are pure-exploration ones, which do not rely on skill diversity and rather rely on exploration bonuses: Random Network Distillation (RND) [7] and Never Give Up (NGU) [2]. ", "page_idx": 7}, {"type": "image", "img_path": "oyiBLfNJvY/tmp/0a0cd358b0246912882feff4db4102f2e038541529448e1a6b1b1f377203f08c.jpg", "img_caption": ["Figure 5: Relative coverage evolution across six tasks. The $\\mathbf{X}$ -axis represents the number of samples collected since the algorithm began. "], "img_footnote": [], "page_idx": 8}, {"type": "table", "img_path": "oyiBLfNJvY/tmp/a71af6b704e0f3a41492e4591d5f923ad7de451a285d18bf935e79e8b01397d9.jpg", "table_caption": [], "table_footnote": ["Table 1: Final coverage percentages for each method on each environments. Bold indicates when a single method is statistically superior to all other methods $p<0.05)$ . Full T-test results are presented in Appendix B. "], "page_idx": 8}, {"type": "text", "text": "", "page_idx": 8}, {"type": "text", "text": "A metric of state space coverage should characterize how widespread the state distribution is, in particular across behavior descriptors that are meaningful for the task at hand. Following the practice of previous work, for high-dimensional environments, we use a featurization of the state, retaining a low-dimensional representation of meaningful variables: the $\\left(x,y,z\\right)$ coordinates of the gripper in Fetch-Reach, the $(x,y)$ coordinates of the puck in Fetch-Slide, and the angles of the finger\u2019s two joints and the hinge\u2019s angle in Finger. This projection is then discretized and the coverage of a trajectory is defined as the number of visited cells. Figure 5 depicts the evolution of coverage, normalized by the maximum coverage achieved by any run in the current environment. This figure illustrates how coverage progresses relative to the number of samples taken in the environment since the beginning of the algorithm. Shaded areas represent the standard error across five seeds for each algorithm. ", "page_idx": 8}, {"type": "text", "text": "One can note that LEADS outperforms other methods across almost all tasks. This is especially notable in the Fetch-Slide environment, where LEADS exceeds the coverage of all other methods by over $20\\%$ . Furthermore, besides LEADS, no algorithm is consistently good across all tasks. In the Fetch-Reach task, DIAYN, METRA, and CSD each achieved a coverage between $80\\%$ and $85\\%$ . LEADS excelled with $90\\%$ coverage, significantly outperforming NGU at $50\\%$ and SMM and RND, both at $20\\%$ . CSD surpasses LEADS and all other methods on the Finger environment, achieving a relative mean coverage of $96\\%$ where LEADS is still competitive with $87\\%$ . On this specific benchmark, NGU, METRA and LSD are competitive with LEADS, whereas DIAYN, SMM and RND exhibit low coverage. ", "page_idx": 8}, {"type": "text", "text": "", "page_idx": 9}, {"type": "text", "text": "5 Conclusion ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "In this work, we consider the problem of exploration in reinforcement learning, via the search for behavioral diversity in a finite set of skills. We take inspiration from the classical framework of maximization of the mutual information between visited states and skill descriptors, and illustrate why it might be insufficient to promote exploration. This motivates the introduction of a new objective function for skill diversity and exploration. This objective exploits an uncertainty measure to encourage extensive state space coverage. We leverage off-the-shelf estimators of the successor state representation to estimate this non-stationary uncertainty measure, and introduce the LEADS algorithm. ", "page_idx": 9}, {"type": "text", "text": "Specifically, LEADS estimates the successor state representation for each skill, then specializes each skill towards under-visited states while keeping skills in distinct state distributions. This results in an efficient method for state space coverage via skill diversity search. Our experiments highlight the efficacy of this approach, achieving superior coverage in nearly all tested environments compared to state-of-the-art baselines. ", "page_idx": 9}, {"type": "text", "text": "LEADS intrinsically relies on good SSR estimators. In this work, we used C-Learning [14] for all experiments, which proved efficient but might reach generalization limits in some environments. As a consequence, advances on the question of reliable SSR estimation will directly benefit LEADS, opening new perspectives for research. ", "page_idx": 9}, {"type": "text", "text": "Acknowledgments ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "This work was performed using HPC resources from CALMIP (Grant 2016-[p21001]). ", "page_idx": 9}, {"type": "text", "text": "References ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "[1] Peter Auer, Thomas Jaksch, and Ronald Ortner. Near-optimal regret bounds for reinforcement learning. Advances in neural information processing systems, 21, 2008.   \n[2] Adri\u00e0 Puigdom\u00e8nech Badia, Pablo Sprechmann, Alex Vitvitskyi, Daniel Guo, Bilal Piot, Steven Kapturowski, Olivier Tieleman, Mart\u00edn Arjovsky, Alexander Pritzel, Andew Bolt, et al. Never give up: Learning directed exploration strategies. arXiv preprint arXiv:2002.06038, 2020.   \n[3] Marc Bellemare, Sriram Srinivasan, Georg Ostrovski, Tom Schaul, David Saxton, and Remi Munos. Unifying count-based exploration and intrinsic motivation. Advances in neural information processing systems, 29, 2016.   \n[4] L\u00e9onard Blier, Corentin Tallec, and Yann Ollivier. Learning successor states and goal-dependent values: A mathematical viewpoint. arXiv preprint arXiv:2101.07123, 2021.   \n[5] Diana Borsa, Andr\u00e9 Barreto, John Quan, Daniel Mankowitz, R\u00e9mi Munos, Hado Van Hasselt, David Silver, and Tom Schaul. Universal successor features approximators. arXiv preprint arXiv:1812.07626, 2018.   \n[6] Ronen I Brafman and Moshe Tennenholtz. R-max-a general polynomial time algorithm for near-optimal reinforcement learning. Journal of Machine Learning Research, 3(Oct):213\u2013231, 2002.   \n[7] Yuri Burda, Harrison Edwards, Amos Storkey, and Oleg Klimov. Exploration by random network distillation. arXiv preprint arXiv:1810.12894, 2018.   \n[8] V\u00edctor Campos, Alexander Trott, Caiming Xiong, Richard Socher, Xavier Gir\u00f3-i Nieto, and Jordi Torres. Explore, discover and learn: Unsupervised discovery of state-covering skills. In International Conference on Machine Learning, pages 1317\u20131327. PMLR, 2020.   \n[9] Felix Chalumeau, Raphael Boige, Bryan Lim, Valentin Mac\u00e9, Maxime Allard, Arthur Flajolet, Antoine Cully, and Thomas Pierrot. Neuroevolution is a competitive alternative to reinforcement learning for skill discovery. arXiv preprint arXiv:2210.03516, 2022.   \n[10] Antoine Cully. Autonomous skill discovery with quality-diversity and unsupervised descriptors. In Proceedings of the Genetic and Evolutionary Computation Conference, pages 81\u201389, 2019.   \n[11] Antoine Cully, Jeff Clune, Danesh Tarapore, and Jean-Baptiste Mouret. Robots that can adapt like animals. Nature, 521(7553):503\u2013507, 2015.   \n[12] Adrien Ecoffet, Joost Huizinga, Joel Lehman, Kenneth O Stanley, and Jeff Clune. Go-explore: a new approach for hard-exploration problems. arXiv preprint arXiv:1901.10995, 2019.   \n[13] Benjamin Eysenbach, Abhishek Gupta, Julian Ibarz, and Sergey Levine. Diversity is all you need: Learning skills without a reward function. arXiv preprint arXiv:1802.06070, 2018.   \n[14] Benjamin Eysenbach, Ruslan Salakhutdinov, and Sergey Levine. C-learning: Learning to achieve goals via recursive classification. arXiv preprint arXiv:2011.08909, 2020.   \n[15] Benjamin Eysenbach, Tianjun Zhang, Sergey Levine, and Russ R Salakhutdinov. Contrastive learning as goal-conditioned reinforcement learning. Advances in Neural Information Processing Systems, 35:35603\u201335620, 2022.   \n[16] Yannis Flet-Berliac, Johan Ferret, Olivier Pietquin, Philippe Preux, and Matthieu Geist. Adversarially guided actor-critic. In ICLR 2021-International Conference on Learning Representations, 2021.   \n[17] Karol Gregor, Danilo Jimenez Rezende, and Daan Wierstra. Variational intrinsic control. arXiv preprint arXiv:1611.07507, 2016.   \n[18] Luca Grillotti, Maxence Faldor, Borja G Le\u00f3n, and Antoine Cully. Skill-conditioned policy optimization with successor features representations. In Second Agent Learning in OpenEndedness Workshop, 2023.   \n[19] Zhaohan Guo, Shantanu Thakoor, Miruna P\u00eeslar, Bernardo Avila Pires, Florent Altch\u00e9, Corentin Tallec, Alaa Saade, Daniele Calandriello, Jean-Bastien Grill, Yunhao Tang, et al. BYOL-explore: Exploration by bootstrapped prediction. Advances in neural information processing systems, 35:31855\u201331870, 2022.   \n[20] Tuomas Haarnoja, Aurick Zhou, Pieter Abbeel, and Sergey Levine. Soft actor-critic: Offpolicy maximum entropy deep reinforcement learning with a stochastic actor. In International conference on machine learning, pages 1861\u20131870. PMLR, 2018.   \n[21] Steven Hansen, Will Dabney, Andre Barreto, Tom Van de Wiele, David Warde-Farley, and Volodymyr Mnih. Fast task inference with variational intrinsic successor features. arXiv preprint arXiv:1906.05030, 2019.   \n[22] Michael Janner, Igor Mordatch, and Sergey Levine. gamma-models: Generative temporal difference learning for infinite-horizon prediction. Advances in Neural Information Processing Systems, 33:1724\u20131735, 2020.   \n[23] Daniel Jarrett, Corentin Tallec, Florent Altch\u00e9, Thomas Mesnard, R\u00e9mi Munos, and Michal Valko. Curiosity in hindsight. arXiv preprint arXiv:2211.10515, 2022.   \n[24] Pierre-Alexandre Kamienny, Jean Tarbouriech, Sylvain Lamprier, Alessandro Lazaric, and Ludovic Denoyer. Direct then diffuse: Incremental unsupervised skill discovery for state covering and goal reaching. arXiv preprint arXiv:2110.14457, 2021.   \n[25] Michael Kearns and Satinder Singh. Near-optimal reinforcement learning in polynomial time. Machine learning, 49:209\u2013232, 2002.   \n[26] Lisa Lee, Benjamin Eysenbach, Emilio Parisotto, Eric Xing, Sergey Levine, and Ruslan Salakhutdinov. Efficient exploration via state marginal matching. arXiv preprint arXiv:1906.05274, 2019.   \n[27] Joel Lehman and Kenneth O Stanley. Evolving a diversity of virtual creatures through novelty search and local competition. In Proceedings of the 13th annual conference on Genetic and evolutionary computation, pages 211\u2013218, 2011.   \n[28] Bryan Lim, Manon Flageat, and Antoine Cully. Understanding the synergies between qualitydiversity and deep reinforcement learning. In Proceedings of the Genetic and Evolutionary Computation Conference, pages 1212\u20131220, 2023.   \n[29] Hao Liu and Pieter Abbeel. Behavior from the void: Unsupervised active pre-training. Advances in Neural Information Processing Systems, 34:18459\u201318473, 2021.   \n[30] Marlos C Machado, Clemens Rosenbaum, Xiaoxiao Guo, Miao Liu, Gerald Tesauro, and Murray Campbell. Eigenoption discovery through the deep successor representation. arXiv preprint arXiv:1710.11089, 2017.   \n[31] Volodymyr Mnih, Adria Puigdomenech Badia, Mehdi Mirza, Alex Graves, Timothy Lillicrap, Tim Harley, David Silver, and Koray Kavukcuoglu. Asynchronous methods for deep reinforcement learning. In International conference on machine learning, pages 1928\u20131937. PMLR, 2016.   \n[32] Olle Nilsson and Antoine Cully. Policy gradient assisted map-elites. In Proceedings of the Genetic and Evolutionary Computation Conference, pages 866\u2013875, 2021.   \n[33] Seohong Park, Jongwook Choi, Jaekyeom Kim, Honglak Lee, and Gunhee Kim. Lipschitzconstrained unsupervised skill discovery. In International Conference on Learning Representations, 2022.   \n[34] Seohong Park, Kimin Lee, Youngwoon Lee, and Pieter Abbeel. Controllability-aware unsupervised skill discovery. arXiv preprint arXiv:2302.05103, 2023.   \n[35] Seohong Park, Oleh Rybkin, and Sergey Levine. Metra: Scalable unsupervised rl with metricaware abstraction. In The Twelfth International Conference on Learning Representations, 2023.   \n[36] Deepak Pathak, Pulkit Agrawal, Alexei A Efros, and Trevor Darrell. Curiosity-driven exploration by self-supervised prediction. In International conference on machine learning, pages 2778\u2013 2787. PMLR, 2017.   \n[37] Matthias Plappert, Marcin Andrychowicz, Alex Ray, Bob McGrew, Bowen Baker, Glenn Powell, Jonas Schneider, Josh Tobin, Maciek Chociej, Peter Welinder, et al. Multi-goal reinforcement learning: Challenging robotics environments and request for research. arXiv preprint arXiv:1802.09464, 2018.   \n[38] Martin L Puterman. Markov decision processes: discrete stochastic dynamic programming. John Wiley & Sons, 2014.   \n[39] Claude Elwood Shannon. A mathematical theory of communication. The Bell system technical journal, 27(3):379\u2013423, 1948.   \n[40] Archit Sharma, Shixiang Gu, Sergey Levine, Vikash Kumar, and Karol Hausman. Dynamicsaware unsupervised discovery of skills. arXiv preprint arXiv:1907.01657, 2019.   \n[41] Richard S Sutton and Andrew G Barto. Reinforcement learning: An introduction. MIT press, 2018.   \n[42] Emanuel Todorov, Tom Erez, and Yuval Tassa. Mujoco: A physics engine for model-based control. In 2012 IEEE/RSJ international conference on intelligent robots and systems, pages 5026\u20135033. IEEE, 2012.   \n[43] Mark Towers, Jordan K. Terry, Ariel Kwiatkowski, John U. Balis, Gianluca de Cola, Tristan Deleu, Manuel Goul\u00e3o, Andreas Kallinteris, Arjun KG, Markus Krimmel, Rodrigo PerezVicente, Andrea Pierr\u00e9, Sander Schulhoff, Jun Jet Tai, Andrew Tan Jin Shen, and Omar G. Younis. Gymnasium, March 2023. URL https://zenodo.org/record/8127025.   \n[44] Saran Tunyasuvunakool, Alistair Muldal, Yotam Doron, Siqi Liu, Steven Bohez, Josh Merel, Tom Erez, Timothy Lillicrap, Nicolas Heess, and Yuval Tassa. dm_control: Software and tasks for continuous control. Software Impacts, 6:100022, 2020.   \n[45] Chongyi Zheng, Ruslan Salakhutdinov, and Benjamin Eysenbach. Contrastive difference predictive coding. arXiv preprint arXiv:2310.20141, 2023. ", "page_idx": 9}, {"type": "text", "text": "", "page_idx": 10}, {"type": "text", "text": "", "page_idx": 11}, {"type": "text", "text": "", "page_idx": 12}, {"type": "text", "text": "A A formal motivation for the uncertainty measure of Equation 7 ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "In Section 3.2, we introduced a new optimization target, based on the uncertainty measure $u_{t}(s,z)$ , used in LEADS to strategically distribute probability mass across states for each skill to foster effective exploration. $u_{t}(s,z)$ is introduced in Equation 7, which is reproduced here for clarity: ", "page_idx": 13}, {"type": "equation", "text": "$$\nu_{t}(s,z)=\\log\\left(\\frac{m_{t}(s_{0},s,z_{i})}{\\sum_{k=1}^{t-1}\\sum_{z^{\\prime}}m_{k}(s_{0},s,z^{\\prime})}\\right)+\\sum_{z^{\\prime}\\neq z}\\log\\left(\\frac{m_{t}(s_{t-1}^{z},s,z)}{m_{t}(s_{t-1}^{z^{\\prime}},s,z^{\\prime})}\\right)+\\log\\left(\\frac{m_{t}(s_{0},s,z)}{m_{t}(s_{0},s,z^{\\prime})}\\right)\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "This section delves into the theoretical foundations of this target. We begin by discussing the left term of Equation 7, which corresponds to the exploration component of the measure. Subsequently, we detail the right term, which promotes greater repulsion between the skills. ", "page_idx": 13}, {"type": "text", "text": "A.1 Exploration term (left side of Equation 7) ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "The Successor State Representation (SSR) extends the concept of the occupancy measure. Unlike the traditional occupancy measure, which begins with the initial state distribution, the SSR is an estimation of the occupancy measure starting from any state. In practice, we work with the expected sum of discounted presences of a state over time because we know this measure exists regardless of the ergodicity of the Markov process. ", "page_idx": 13}, {"type": "text", "text": "LEADS is an epoch-based algorithm with each epoch consisting of four phases, as presented in Section 3.2 and Algorithm 1: ", "page_idx": 13}, {"type": "text", "text": "1. Sample transitions from the environment for each skill,   \n2. Learn the SSR of each skill (for the given policy),   \n3. Define a state on which to put more probability mass for each skill,   \n4. Use the objective of Equation 6 to update the policy so that it implements this probability   \nmass transport plan. ", "page_idx": 13}, {"type": "text", "text": "Since the policy changes in each epoch, the discounted occupancy measure of the policy also evolves over time. For a given skill and epoch $n$ , it can be defined as: ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\rho_{n}^{\\pi_{z}}(s)=\\mathbb{E}_{\\underset{s_{t+1}\\sim p(\\cdot\\vert s_{t},z)}{s_{0}\\sim\\delta_{0}}}\\left[\\sum_{t=0}^{\\infty}\\gamma^{t}\\mathbb{1}(s_{t}=s)\\right]\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "This occupancy measure has a direct estimator, using the SSR in the initial state $s_{0}$ : ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\rho_{n}^{\\pi_{z}}(s)=m_{n}(s_{0},s,z)\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "At epoch $n$ , the state occupancy measure of all skills is the mixture of all skills\u2019 state occupancy measures: ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\rho_{n}^{\\pi}(s)=\\sum_{\\mathcal{Z}}p(z)\\rho_{n}^{\\pi_{z}}(s)\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "Then, the left side term in the definition of the uncertainty measure $u_{t}(s,z)$ corresponds to the contribution of a state $s$ to the following Kullback-Leibler divergence: ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathrm{KL}\\left(\\rho_{n}^{\\pi_{z}}\\parallel\\underset{k=1}{\\overset{n-1}{\\sum}}\\rho_{k}^{\\pi}\\right)=\\mathbb{E}_{s\\sim\\rho_{n}^{\\pi_{z}}}\\left[\\log\\left(\\frac{\\rho_{n}^{\\pi_{z}}\\left(s\\right)}{\\sum_{k=1}^{n-1}\\rho_{k}^{\\pi}\\left(s\\right)}\\right)\\right]}\\\\ &{\\qquad\\qquad\\qquad\\quad=\\int_{S}\\rho_{n}^{\\pi_{z}}(s)\\log\\left(\\frac{\\rho_{n}^{\\pi_{z}}\\left(s\\right)}{\\sum_{k=1}^{n-1}\\rho_{k}^{\\pi}\\left(s\\right)}\\right)\\mathrm{d}s}\\\\ &{\\qquad\\qquad\\qquad\\quad=\\int_{S}\\rho_{n}^{\\pi_{z}}(s)\\log\\left(\\frac{m_{n}\\left(s_{0},s,z\\right)}{\\sum_{k=1}^{n-1}\\sum_{z^{\\prime}}m_{k}\\left(s_{0},s,z^{\\prime}\\right)}\\right)\\mathrm{d}s}\\end{array}\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "Note in particular that this divergence accounts for the discrepancy between $\\rho_{n}^{\\pi_{z}}$ , ie. the states visited by skill z at epoch n, and kn=\u221211 , ie. the states previously explored by all skills in all past epochs. Thus, the KL divergence of Equation 9 serves as a measure of novelty for the current distribution. Intuitively, the newer a state visited by the current distribution $\\rho_{n}^{\\pi_{z}}(s)$ is, the larger its contribution to this KL divergence will be. Recall that at this stage, we do not modify the policy (it is the role of the objective function of Equation 6), but rather aim at identifying which states within the support of $\\rho_{n}^{\\pi_{z}}$ should be those skill $z$ is encouraged to explore next. By defining the state-wise novelty score log  kn=\u221211 nz\u2032 0mk(s0,s,z\u2032) , the distribution $\\delta(s|z)$ unfolds as the Dirac distribution which maximizes the expected value of this score. Overall, LEADS aims to identify and prioritize states with the highest novelty score for each skill, thereby enhancing exploration by shifting each skill\u2019s induced distribution towards these novel states. ", "page_idx": 14}, {"type": "text", "text": "A.2 Repulsion term (right side of Equation 7) ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "Building on the previous discussion about the formal motivation of the exploration term on the left side in 7, we now explore the right side term, which is intended to enhance repulsion between skills. The right side term of Equation 7 can be interpreted as the contribution of a state $s$ within a sum of multiple Kullback-Leibler divergences: ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\sum_{z^{\\prime}\\neq z}\\underbrace{\\mathrm{KL}(m_{n}(s_{n-1}^{z},\\cdot,z)\\parallel m_{n}(s_{n-1}^{z^{\\prime}},\\cdot,z^{\\prime}))}_{(a)}+\\underbrace{\\mathrm{KL}(\\rho_{n}^{\\pi_{z}}(s)\\parallel\\rho_{n}^{\\pi_{z^{\\prime}}}(s))}_{(b)}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "In this equation, term (a) represents the KL divergence of the occupancy measure for the current skill $z$ , starting from its last target state, compared to the occupancy measure of each other skill starting from their respective last target states. Maximizing this KL divergence aims to make the distribution of each skill (starting from their last target state) as distinct as possible. Similarly, term (b) is the KL divergence between the occupancy measures of a skill $z$ and that of any other skill $z^{\\prime}$ . Maximizing these two KL divergences leads to disjoint distributions for each skill. As in the previous subsection, we do not change the policy at this stage (this would lead to an ill-defined optimization problem as the KL can become unbounded), but rather aim at identifying which are the states that contribute most to these KL divergences, so that we can promote exploration towards them. Overall, LEADS combines all these terms into the uncertainty measure of Equation 7 to determine which state contributes the most to these KL divergences for each skill. In turn, these states define the distribution $\\delta$ designed to promote exploration, by increasing the weight of the most likely states of $\\delta$ in Equation 6 ", "page_idx": 14}, {"type": "text", "text": "A.3 Numerical advantage of Lower Bound 4 ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "This section offers a more detailed explanation of the passage from the definition of Mutual Information 2 to the Lower Bound 4. The mutual information can be defined as: $\\mathbb{E}_{(s_{2},z)\\sim p(s,z)}\\left[\\log\\left(\\mathbb{E}s_{1}\\left[m(s_{1},s_{2},z)\\right]\\right)\\right]$ , with $s_{1}\\sim p(s_{1}|z)$ . ", "page_idx": 14}, {"type": "text", "text": "Suppose we wish to maximize this quantity using SGD. For each sample $\\left(s_{2},z\\right)$ , we need to compute the expectation $\\mathbb{E}_{s_{1}\\sim p(s|z)}\\left(m(s_{1},s_{2},z)\\right)$ (because the log is not linear). In practice, this is computationally expensive because it requires sampling a mini-batch of $s_{1}$ states for every single $s_{2}$ state. Instead, we use Jensen\u2019s inequality, leveraging the concavity of the log function to derive the lower bound: ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\mathbb{E}_{z\\sim p(z)~s_{2}\\sim p(s|z)~s_{1}\\sim p(s|z)}\\left[\\log(m(s_{1},s_{2},z))\\right]\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "Maximizing this new quantity can be done with SGD by sampling three independent mini-batches at each iteration. ", "page_idx": 14}, {"type": "text", "text": "B Supplementary Analyses and Visualizations ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "LEADS is based on the estimation of the successor state representation for each skill. Figure 6 and Figure 7 show the final SSR and uncertainty measure, respectively, for the maze and Fetch tasks. These correspond to the same runs shown in Figure 2 for LEADS. ", "page_idx": 14}, {"type": "image", "img_path": "oyiBLfNJvY/tmp/a5b43ce773caebd3858a00c5a51148cae6b7b8254fe9c1923bf28f05d4f4132b.jpg", "img_caption": ["Figure 6: The SSR $m(s_{0},s,z)$ at a given epoch during training on each task, per skill, normalized in [0, 1]. "], "img_footnote": [], "page_idx": 15}, {"type": "image", "img_path": "oyiBLfNJvY/tmp/74bee5c1feb0c38a009bac27c91082263d2772facee7ff56cdbdb96705b1f9fc.jpg", "img_caption": ["Figure 7: The uncertainty measure $u(s,z)$ at a given epoch during training on each task, per skill, with the maximum state highlighted. "], "img_footnote": [], "page_idx": 15}, {"type": "text", "text": "Figure 5 illustrates the temporal evolution of coverage for all methods across various environments, evaluated over five different seeds. We extend our analysis by presenting the $\\mathbf{p}$ -values from the t-tests conducted on the distributions of the final (highest) coverage values for these five seeds, comparing the first method to both the second and third methods. We conducted a t-test for each environment in which no method outperformed the second method by a margin greater than $10\\%$ . The results are visible in the table 2. ", "page_idx": 15}, {"type": "table", "img_path": "oyiBLfNJvY/tmp/46335bf454282130624e9c48be1a69062c6b56269f6de137816eb555a51a00c9.jpg", "table_caption": [], "table_footnote": ["Table 2: Comparison of p-values for paired t-tests across methods "], "page_idx": 15}, {"type": "text", "text": "B.1 Key Differences with Baseline Methods ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "The LEADS algorithm learns diverse skills that evolve over time to maintain exploration of the state space. Unlike the baselines, LEADS does not rely on any reward function to be maximized. Instead, it uses the same tool, the SSR, to plan exploration and adjust the set of skills to ensure effective exploration. Unlike static skills, the skills learned by LEADS are dynamic, continuously adapting throughout the algorithm\u2019s execution to move away from previously explored areas, as explained in A. LEADS achieves this by maximizing an uncertainty measure, which includes elements from the Kullback-Leibler divergence between the current occupancy measure of each skill and the history of occupancy measures from the set of skills. ", "page_idx": 16}, {"type": "text", "text": "This mechanism differs from algorithms such as DIAYN [13], LSD [33], CSD [34], and METRA [35], which aim to learn a static set of skills. These methods evolve the skills until reaching an optimum or sub-optimum. DIAYN maximizes mutual information, represented as the KullbackLeibler divergence between $\\mathbb{P}(S,Z)$ and $\\mathbb{P}(S)\\mathbb{P}(Z)$ , while LSD, CSD, and METRA maximize the Wasserstein distance between these distributions using different metrics. ", "page_idx": 16}, {"type": "text", "text": "In contrast, NGU [2] and RND [7] use uncertainty methods that evolve only a single policy over time and do not seek to learn a set of diverse skills. The method closest to LEADS is SMM [26], which also learns a set of diverse skills that explore using a specific uncertainty measure. SMM uses the loss from a VAE [17] as the uncertainty measure, framing the optimization as a two-player adversarial game. ", "page_idx": 16}, {"type": "text", "text": "LEADS uses a novelty-based uncertainty measure, which appears to lead to a more stable optimization process leading to a more continous and efficient exploration. ", "page_idx": 16}, {"type": "text", "text": "C Hyperparameters ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "The following table (Table 3) summarizes the hyperparameters used in our experimental setup. ", "page_idx": 16}, {"type": "table", "img_path": "oyiBLfNJvY/tmp/600940f250725cd736d3d4d6bcfc38b4b7de34e44311c70563f28ec500adb0b5.jpg", "table_caption": [], "table_footnote": ["Table 3: Hyperparameters used for LEADS "], "page_idx": 16}, {"type": "table", "img_path": "oyiBLfNJvY/tmp/ec007595d6e2a32ef837fc98b246113f7424b1bd5f1b59a4b78e652947690108.jpg", "table_caption": [], "table_footnote": ["Table 4: Structure of the Classifier and Actor Networks "], "page_idx": 16}, {"type": "text", "text": "C.1 The number of skills ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "As with other skill-based algorithms, LEADS\u2019s coverage changes with the number of skills. However, the skills learned by LEADS evolve throughout the entire training procedure to visit unexplored areas. Hence, one can expect LEADS to require fewer skills to achieve the same final coverage performance than algorithms that learn static skills, like DIAYN [13]. Choosing the number of skills involves a tradeoff between the acceptable computational runtime of the algorithm (which increases with the number of skills) and the desired efficiency in state space coverage. This choice is also highly problem-dependent. Dynamic adaptation of the number of skills is a challenging and open topic, covered by works such as the one proposed by Kamienny et al. [24]. Although this remains an open question, for LEADS we worked with a hand-chosen, predetermined number of skills and did not focus on this aspect. ", "page_idx": 17}, {"type": "text", "text": "D Failure cases of the successor state representation estimation ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "LEADS relies intrinsically on the quality of the SSR estimator. When this estimator is poor, LEADS might not yield diverse and exploratory skills. For instance, in a number of standard MuJoCo environments from the Gymnasium suite [43], LEADS performs poorly as a consequence of CLearning\u2019s inability to obtain a reliable estimation of the successor state representation. Figures 8 and 9 illustrate this phenomenon on the HalfCheetah benchmark after 25 epochs of LEADS. We evaluate the discrepancy between the estimated state occupancy measure and the actual distribution of states for a set of 6 skills. To enable visualization of these quantities, we project these densities on the $(x,y)$ plane where $x$ and $y$ are the coordinates of the center of mass of the cheetah\u2019s torso. Figures 8 reports the estimated state occupancy measure from the initial state $m(s_{0},\\Pi(s),z)$ , where $\\bar{\\Pi}(s)=(\\bar{x},y)$ , using the SSR. In contrast, Figure 9 displays the scatter plot of visited states for each skill in the $(x,y)$ plane. Despite experimenting with an extensive range of hyperparameters for C-Learning, a satisfactory estimation of the measure could not be obtained and the probability density of Figure 8 could not match the $(x,y)$ coordinates of the visited states of Figure 11. ", "page_idx": 17}, {"type": "text", "text": "As a comparison, Figures 10 and 11 illustrate the identical experiment conducted in the Fetch-Reach environment reported in the main body of the paper. The state occupancy estimated with the SSR of Figure 10 matches closely the states encountered by each skill in Figure 11. This corroborates the quantitative results reported in Figure 5: when a reliable estimation of the SSR is available, LEADS performs effectively. ", "page_idx": 17}, {"type": "text", "text": "Investigating why C-Learning performs poorly in such MuJoCo environments is beyond the scope of this paper. One could conjecture, following the conclusions of Blier et al. [4], that learning a successor state representation that generalizes efficiently through high-dimensional state spaces is a challenging task. Although we could not obtain conclusive results with C-Learning in these specific cases, recent methodologies [15, 45] demonstrate improved generalization capabilities. These new methods appear to be more successful in MuJoCo environments. We reserve the extension of LEADS to such SSR estimators for future work. ", "page_idx": 17}, {"type": "image", "img_path": "oyiBLfNJvY/tmp/74ca110196ad98a9e2c4fe9359a35286d96eba1a3d56332587e89ec0023d07a8.jpg", "img_caption": [], "img_footnote": [], "page_idx": 18}, {"type": "text", "text": "Figure 8: The SSR $m(s_{0},\\Pi(s),z)$ at epoch 25 for each skill in HalfCheetah environment ", "page_idx": 18}, {"type": "text", "text": "Figure 9: (x,y) coordinates of the states sampled by each skill for 16 rollouts each in HalfCheetah environment ", "page_idx": 18}, {"type": "image", "img_path": "oyiBLfNJvY/tmp/a77aa6d1f8b0dabff74f33236754360877bd3723759ea42dec91512129f806c1.jpg", "img_caption": [], "img_footnote": [], "page_idx": 18}, {"type": "image", "img_path": "oyiBLfNJvY/tmp/21c7fed8a29840405efe8add59c2321a62dc5609da39044bea4d088637b422c8.jpg", "img_caption": ["Figure 11: $\\mathrm{(x,y)}$ coordinates of the states sampled by each skill for 16 rollouts each in FetchReach environment "], "img_footnote": [], "page_idx": 18}, {"type": "text", "text": "Figure 10: The SSR $m(s_{0},\\Pi(s),z)$ at epoch 25 for each skill in FetchReach environment ", "page_idx": 18}, {"type": "text", "text": "NeurIPS Paper Checklist ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Claims ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Question: Do the main claims made in the abstract and introduction accurately reflect the paper\u2019s contributions and scope? ", "page_idx": 18}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 18}, {"type": "text", "text": "Justification: Our study illustrates the limitations of using mutual information (MI) as an objective for exploration. We propose a refined objective, offer a theoretical perspective on it, and demonstrate experimentally that it surpasses state-of-the-art approaches. ", "page_idx": 18}, {"type": "text", "text": "Guidelines: ", "page_idx": 18}, {"type": "text", "text": "\u2022 The answer NA means that the abstract and introduction do not include the claims made in the paper. ", "page_idx": 18}, {"type": "text", "text": "\u2022 The abstract and/or introduction should clearly state the claims made, including the contributions made in the paper and important assumptions and limitations. A No or NA answer to this question will not be perceived well by the reviewers. \u2022 The claims made should match theoretical and experimental results, and reflect how much the results can be expected to generalize to other settings. \u2022 It is fine to include aspirational goals as motivation as long as it is clear that these goals are not attained by the paper. ", "page_idx": 19}, {"type": "text", "text": "2. Limitations ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "Question: Does the paper discuss the limitations of the work performed by the authors? Answer: [Yes] ", "page_idx": 19}, {"type": "text", "text": "Justification: We discuss it in a section in the appendix. See section D ", "page_idx": 19}, {"type": "text", "text": "Guidelines: ", "page_idx": 19}, {"type": "text", "text": "\u2022 The answer NA means that the paper has no limitation while the answer No means that the paper has limitations, but those are not discussed in the paper.   \n\u2022 The authors are encouraged to create a separate \"Limitations\" section in their paper.   \n\u2022 The paper should point out any strong assumptions and how robust the results are to violations of these assumptions (e.g., independence assumptions, noiseless settings, model well-specification, asymptotic approximations only holding locally). The authors should reflect on how these assumptions might be violated in practice and what the implications would be.   \n\u2022 The authors should reflect on the scope of the claims made, e.g., if the approach was only tested on a few datasets or with a few runs. In general, empirical results often depend on implicit assumptions, which should be articulated.   \n\u2022 The authors should reflect on the factors that influence the performance of the approach. For example, a facial recognition algorithm may perform poorly when image resolution is low or images are taken in low lighting. Or a speech-to-text system might not be used reliably to provide closed captions for online lectures because it fails to handle technical jargon.   \n\u2022 The authors should discuss the computational efficiency of the proposed algorithms and how they scale with dataset size.   \n\u2022 If applicable, the authors should discuss possible limitations of their approach to address problems of privacy and fairness.   \n\u2022 While the authors might fear that complete honesty about limitations might be used by reviewers as grounds for rejection, a worse outcome might be that reviewers discover limitations that aren\u2019t acknowledged in the paper. The authors should use their best judgment and recognize that individual actions in favor of transparency play an important role in developing norms that preserve the integrity of the community. Reviewers will be specifically instructed to not penalize honesty concerning limitations. ", "page_idx": 19}, {"type": "text", "text": "3. Theory Assumptions and Proofs ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "Question: For each theoretical result, does the paper provide the full set of assumptions and a complete (and correct) proof? ", "page_idx": 19}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 19}, {"type": "text", "text": "Justification: See A. ", "page_idx": 19}, {"type": "text", "text": "Guidelines: ", "page_idx": 19}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include theoretical results.   \n\u2022 All the theorems, formulas, and proofs in the paper should be numbered and crossreferenced.   \n\u2022 All assumptions should be clearly stated or referenced in the statement of any theorems.   \n\u2022 The proofs can either appear in the main paper or the supplemental material, but if they appear in the supplemental material, the authors are encouraged to provide a short proof sketch to provide intuition.   \n\u2022 Inversely, any informal proof provided in the core of the paper should be complemented by formal proofs provided in appendix or supplemental material. ", "page_idx": 19}, {"type": "text", "text": "4. Experimental Result Reproducibility ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Question: Does the paper fully disclose all the information needed to reproduce the main experimental results of the paper to the extent that it affects the main claims and/or conclusions of the paper (regardless of whether the code and data are provided or not)? ", "page_idx": 20}, {"type": "text", "text": "Answer: [Yes] . ", "page_idx": 20}, {"type": "text", "text": "Justification: The code was provided, and the description of the method, along with the details provided in C, ensures full reproducibility of the experiments. ", "page_idx": 20}, {"type": "text", "text": "Guidelines: ", "page_idx": 20}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 If the paper includes experiments, a No answer to this question will not be perceived well by the reviewers: Making the paper reproducible is important, regardless of whether the code and data are provided or not.   \n\u2022 If the contribution is a dataset and/or model, the authors should describe the steps taken to make their results reproducible or verifiable.   \n\u2022 Depending on the contribution, reproducibility can be accomplished in various ways. For example, if the contribution is a novel architecture, describing the architecture fully might suffice, or if the contribution is a specific model and empirical evaluation, it may be necessary to either make it possible for others to replicate the model with the same dataset, or provide access to the model. In general. releasing code and data is often one good way to accomplish this, but reproducibility can also be provided via detailed instructions for how to replicate the results, access to a hosted model (e.g., in the case of a large language model), releasing of a model checkpoint, or other means that are appropriate to the research performed.   \n\u2022 While NeurIPS does not require releasing code, the conference does require all submissions to provide some reasonable avenue for reproducibility, which may depend on the nature of the contribution. For example (a) If the contribution is primarily a new algorithm, the paper should make it clear how to reproduce that algorithm. (b) If the contribution is primarily a new model architecture, the paper should describe the architecture clearly and fully. (c) If the contribution is a new model (e.g., a large language model), then there should either be a way to access this model for reproducing the results or a way to reproduce the model (e.g., with an open-source dataset or instructions for how to construct the dataset). (d) We recognize that reproducibility may be tricky in some cases, in which case authors are welcome to describe the particular way they provide for reproducibility. In the case of closed-source models, it may be that access to the model is limited in some way (e.g., to registered users), but it should be possible for other researchers to have some path to reproducing or verifying the results. ", "page_idx": 20}, {"type": "text", "text": "5. Open access to data and code ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Question: Does the paper provide open access to the data and code, with sufficient instructions to faithfully reproduce the main experimental results, as described in supplemental material? ", "page_idx": 20}, {"type": "text", "text": "Answer: [Yes] . ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Justification: Everything is provided in this repository. ", "page_idx": 20}, {"type": "text", "text": "Guidelines: ", "page_idx": 20}, {"type": "text", "text": "\u2022 The answer NA means that paper does not include experiments requiring code.   \n\u2022 Please see the NeurIPS code and data submission guidelines (https://nips.cc/ public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 While we encourage the release of code and data, we understand that this might not be possible, so \u201cNo\u201d is an acceptable answer. Papers cannot be rejected simply for not including code, unless this is central to the contribution (e.g., for a new open-source benchmark).   \n\u2022 The instructions should contain the exact command and environment needed to run to reproduce the results. See the NeurIPS code and data submission guidelines (https: //nips.cc/public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 The authors should provide instructions on data access and preparation, including how to access the raw data, preprocessed data, intermediate data, and generated data, etc.   \n\u2022 The authors should provide scripts to reproduce all experimental results for the new proposed method and baselines. If only a subset of experiments are reproducible, they should state which ones are omitted from the script and why.   \n\u2022 At submission time, to preserve anonymity, the authors should release anonymized versions (if applicable).   \n\u2022 Providing as much information as possible in supplemental material (appended to the paper) is recommended, but including URLs to data and code is permitted. ", "page_idx": 20}, {"type": "text", "text": "", "page_idx": 21}, {"type": "text", "text": "6. Experimental Setting/Details ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "Question: Does the paper specify all the training and test details (e.g., data splits, hyperparameters, how they were chosen, type of optimizer, etc.) necessary to understand the results? ", "page_idx": 21}, {"type": "text", "text": "Answer: [Yes] . ", "page_idx": 21}, {"type": "text", "text": "Justification: The paper is self-contained. The method section 3 provide the pseudo-code of the algorithm with all the hyper-parameters used and C provide the values used in this study. Guidelines: ", "page_idx": 21}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments. \u2022 The experimental setting should be presented in the core of the paper to a level of detail that is necessary to appreciate the results and make sense of them. \u2022 The full details can be provided either with the code, in appendix, or as supplemental material. ", "page_idx": 21}, {"type": "text", "text": "7. Experiment Statistical Significance ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "Question: Does the paper report error bars suitably and correctly defined or other appropriate information about the statistical significance of the experiments? ", "page_idx": 21}, {"type": "text", "text": "Answer: [Yes] . ", "page_idx": 21}, {"type": "text", "text": "Justification: For every quantitative experiment, the specific standard deviation is made explicit. Additionally, 2 provides the p-value when the final distributions of coverage are closely matched between methods. ", "page_idx": 21}, {"type": "text", "text": "Guidelines: ", "page_idx": 21}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The authors should answer \"Yes\" if the results are accompanied by error bars, confidence intervals, or statistical significance tests, at least for the experiments that support the main claims of the paper.   \n\u2022 The factors of variability that the error bars are capturing should be clearly stated (for example, train/test split, initialization, random drawing of some parameter, or overall run with given experimental conditions).   \n\u2022 The method for calculating the error bars should be explained (closed form formula, call to a library function, bootstrap, etc.)   \n\u2022 The assumptions made should be given (e.g., Normally distributed errors).   \n\u2022 It should be clear whether the error bar is the standard deviation or the standard error of the mean.   \n\u2022 It is OK to report 1-sigma error bars, but one should state it. The authors should preferably report a 2-sigma error bar than state that they have a $96\\%$ CI, if the hypothesis of Normality of errors is not verified.   \n\u2022 For asymmetric distributions, the authors should be careful not to show in tables or figures symmetric error bars that would yield results that are out of range (e.g. negative error rates).   \n\u2022 If error bars are reported in tables or plots, The authors should explain in the text how they were calculated and reference the corresponding figures or tables in the text. ", "page_idx": 21}, {"type": "text", "text": "8. Experiments Compute Resources ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Question: For each experiment, does the paper provide sufficient information on the computer resources (type of compute workers, memory, time of execution) needed to reproduce the experiments? ", "page_idx": 22}, {"type": "text", "text": "Answer: [NA] . ", "page_idx": 22}, {"type": "text", "text": "Justification: All experiments conducted in this study can be performed on any minimal system architecture, without the need for a GPU. ", "page_idx": 22}, {"type": "text", "text": "Guidelines: ", "page_idx": 22}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The paper should indicate the type of compute workers CPU or GPU, internal cluster, or cloud provider, including relevant memory and storage.   \n\u2022 The paper should provide the amount of compute required for each of the individual experimental runs as well as estimate the total compute.   \n\u2022 The paper should disclose whether the full research project required more compute than the experiments reported in the paper (e.g., preliminary or failed experiments that didn\u2019t make it into the paper). ", "page_idx": 22}, {"type": "text", "text": "9. Code Of Ethics ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Question: Does the research conducted in the paper conform, in every respect, with the NeurIPS Code of Ethics https://neurips.cc/public/EthicsGuidelines? ", "page_idx": 22}, {"type": "text", "text": "Answer: [Yes] . ", "page_idx": 22}, {"type": "text", "text": "Justification: We preserved anonimity and conformed with the NeurIPS Code of Ethics. Guidelines: ", "page_idx": 22}, {"type": "text", "text": "\u2022 The answer NA means that the authors have not reviewed the NeurIPS Code of Ethics.   \n\u2022 If the authors answer No, they should explain the special circumstances that require a deviation from the Code of Ethics.   \n\u2022 The authors should make sure to preserve anonymity (e.g., if there is a special consideration due to laws or regulations in their jurisdiction). ", "page_idx": 22}, {"type": "text", "text": "10. Broader Impacts ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Question: Does the paper discuss both potential positive societal impacts and negative societal impacts of the work performed? ", "page_idx": 22}, {"type": "text", "text": "Answer: [NA] . ", "page_idx": 22}, {"type": "text", "text": "Justification: There is no societal impact of the work performed. ", "page_idx": 22}, {"type": "text", "text": "Guidelines: ", "page_idx": 22}, {"type": "text", "text": "\u2022 The answer NA means that there is no societal impact of the work performed.   \n\u2022 If the authors answer NA or No, they should explain why their work has no societal impact or why the paper does not address societal impact.   \n\u2022 Examples of negative societal impacts include potential malicious or unintended uses (e.g., disinformation, generating fake profiles, surveillance), fairness considerations (e.g., deployment of technologies that could make decisions that unfairly impact specific groups), privacy considerations, and security considerations.   \n\u2022 The conference expects that many papers will be foundational research and not tied to particular applications, let alone deployments. However, if there is a direct path to any negative applications, the authors should point it out. For example, it is legitimate to point out that an improvement in the quality of generative models could be used to generate deepfakes for disinformation. On the other hand, it is not needed to point out that a generic algorithm for optimizing neural networks could enable people to train models that generate Deepfakes faster.   \n\u2022 The authors should consider possible harms that could arise when the technology is being used as intended and functioning correctly, harms that could arise when the technology is being used as intended but gives incorrect results, and harms following from (intentional or unintentional) misuse of the technology. ", "page_idx": 22}, {"type": "text", "text": "\u2022 If there are negative societal impacts, the authors could also discuss possible mitigation strategies (e.g., gated release of models, providing defenses in addition to attacks, mechanisms for monitoring misuse, mechanisms to monitor how a system learns from feedback over time, improving the efficiency and accessibility of ML). ", "page_idx": 23}, {"type": "text", "text": "11. Safeguards ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: Does the paper describe safeguards that have been put in place for responsible release of data or models that have a high risk for misuse (e.g., pretrained language models, image generators, or scraped datasets)? ", "page_idx": 23}, {"type": "text", "text": "Answer: [NA] . ", "page_idx": 23}, {"type": "text", "text": "Justification: The paper poses no such risks. ", "page_idx": 23}, {"type": "text", "text": "Guidelines: ", "page_idx": 23}, {"type": "text", "text": "\u2022 The answer NA means that the paper poses no such risks.   \n\u2022 Released models that have a high risk for misuse or dual-use should be released with necessary safeguards to allow for controlled use of the model, for example by requiring that users adhere to usage guidelines or restrictions to access the model or implementing safety filters.   \n\u2022 Datasets that have been scraped from the Internet could pose safety risks. The authors should describe how they avoided releasing unsafe images.   \n\u2022 We recognize that providing effective safeguards is challenging, and many papers do not require this, but we encourage authors to take this into account and make a best faith effort. ", "page_idx": 23}, {"type": "text", "text": "12. Licenses for existing assets ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: Are the creators or original owners of assets (e.g., code, data, models), used in the paper, properly credited and are the license and terms of use explicitly mentioned and properly respected? ", "page_idx": 23}, {"type": "text", "text": "Answer: [NA] . ", "page_idx": 23}, {"type": "text", "text": "Justification: The paper does not use existing assets. ", "page_idx": 23}, {"type": "text", "text": "Guidelines: ", "page_idx": 23}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not use existing assets.   \n\u2022 The authors should cite the original paper that produced the code package or dataset.   \n\u2022 The authors should state which version of the asset is used and, if possible, include a URL.   \n\u2022 The name of the license (e.g., CC-BY 4.0) should be included for each asset.   \n\u2022 For scraped data from a particular source (e.g., website), the copyright and terms of service of that source should be provided.   \n\u2022 If assets are released, the license, copyright information, and terms of use in the package should be provided. For popular datasets, paperswithcode.com/datasets has curated licenses for some datasets. Their licensing guide can help determine the license of a dataset.   \n\u2022 For existing datasets that are re-packaged, both the original license and the license of the derived asset (if it has changed) should be provided.   \n\u2022 If this information is not available online, the authors are encouraged to reach out to the asset\u2019s creators. ", "page_idx": 23}, {"type": "text", "text": "13. New Assets ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: Are new assets introduced in the paper well documented and is the documentation provided alongside the assets? ", "page_idx": 23}, {"type": "text", "text": "Answer: [NA] . ", "page_idx": 23}, {"type": "text", "text": "Justification: The paper does not release new assets. ", "page_idx": 23}, {"type": "text", "text": "Guidelines: \u2022 The answer NA means that the paper does not release new assets. ", "page_idx": 23}, {"type": "text", "text": "\u2022 Researchers should communicate the details of the dataset/code/model as part of their submissions via structured templates. This includes details about training, license, limitations, etc.   \n\u2022 The paper should discuss whether and how consent was obtained from people whose asset is used.   \n\u2022 At submission time, remember to anonymize your assets (if applicable). You can either create an anonymized URL or include an anonymized zip file. ", "page_idx": 24}, {"type": "text", "text": "14. Crowdsourcing and Research with Human Subjects ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Question: For crowdsourcing experiments and research with human subjects, does the paper include the full text of instructions given to participants and screenshots, if applicable, as well as details about compensation (if any)? ", "page_idx": 24}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 24}, {"type": "text", "text": "Justification: The paper does not involve crowdsourcing nor research with human subjects. Guidelines: ", "page_idx": 24}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Including this information in the supplemental material is fine, but if the main contribution of the paper involves human subjects, then as much detail as possible should be included in the main paper.   \n\u2022 According to the NeurIPS Code of Ethics, workers involved in data collection, curation, or other labor should be paid at least the minimum wage in the country of the data collector. ", "page_idx": 24}, {"type": "text", "text": "15. Institutional Review Board (IRB) Approvals or Equivalent for Research with Human Subjects ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Question: Does the paper describe potential risks incurred by study participants, whether such risks were disclosed to the subjects, and whether Institutional Review Board (IRB) approvals (or an equivalent approval/review based on the requirements of your country or institution) were obtained? ", "page_idx": 24}, {"type": "text", "text": "Answer: [NA] ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Justification: The paper does not involve crowdsourcing nor research with human subjects. Guidelines: ", "page_idx": 24}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Depending on the country in which research is conducted, IRB approval (or equivalent) may be required for any human subjects research. If you obtained IRB approval, you should clearly state this in the paper.   \n\u2022 We recognize that the procedures for this may vary significantly between institutions and locations, and we expect authors to adhere to the NeurIPS Code of Ethics and the guidelines for their institution.   \n\u2022 For initial submissions, do not include any information that would break anonymity (if applicable), such as the institution conducting the review. ", "page_idx": 24}]