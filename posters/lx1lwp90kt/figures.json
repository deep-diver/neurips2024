[{"figure_path": "LX1lwP90kt/figures/figures_3_1.jpg", "caption": "Figure 1: SSL kernel and generative model. A. 1D function samples, plotted in different colors, from four kernels: two linear kernels with different hyperparameters, the partition kernel, and the SSL kernel. B. (top) An example \u03c0(x) in 2D and (bottom) a sample of dynamics from a SSL kernel in 2D with \u03c0(x) as hyperparameters. The 11- and 12- directions of the arrows are given by independent 1D samples of the kernel. C. Schematic of the generative model. Simulated trajectories follow the sampled dynamics. Each trajectory is observed via Poisson process or Gaussian observations.", "description": "This figure illustrates the Smoothly Switching Linear (SSL) kernel, a core innovation of the paper. Panel A shows 1D function samples from different kernels to highlight the properties of the SSL kernel. Panel B demonstrates a 2D example of \u03c0(x) and resulting dynamics. Panel C provides a schematic overview of the generative model, showing how simulated trajectories are generated based on the sampled dynamics and observed via Poisson process or Gaussian observations.", "section": "3 Gaussian process switching linear dynamical systems"}, {"figure_path": "LX1lwP90kt/figures/figures_6_1.jpg", "caption": "Figure 2: Synthetic data results. A. True dynamics and latent states used to generate the dataset. Dynamics are clockwise and counterclockwise linear systems separated by x\u2081 = 0. Two latent trajectories are shown on top of a kernel density estimate of the latent states visited by all 30 trials. B. Poisson process observations from an example trial. C. True vs. inferred latent states for the gpSLDS and rSLDS, with 95% posterior credible intervals. D. Inferred dynamics (pink/green) and two inferred latent trajectories (gray) corresponding to those in Panel A from a gpSLDS fit with 2 linear regimes. The model finds high-probability fixed points (purple) overlapping with true fixed points (stars). E. Analogous plot to D for the GP-SDE model with RBF kernel. Note that this model does not provide a partition of the dynamics. F. rSLDS inferred latents, dynamics, and fixed points (pink/green dots). G. (top) Sampled latents and corresponding dynamics from the gpSLDS, with 95% posterior credible intervals. (bottom) Same, but for the rSLDS. The pink/green trace represents the most likely dynamics at the sampled latents, colored by discrete switching variable. H. MSE between true and inferred latents and dynamics for gpSLDS, GP-SDE with RBF kernel, and rSLDS while varying the number of trials in the dataset. Error bars are \u00b12SE over 5 random initializations.", "description": "The figure displays the results of applying the gpSLDS, rSLDS, and GP-SDE with RBF kernel to a synthetic dataset of two linear rotational systems.  Panels A-F visually compare the true and inferred latent states and dynamics, highlighting the gpSLDS's ability to accurately recover the true dynamics and identify fixed points.  Panel G illustrates the differences in how uncertainty is expressed by the gpSLDS and rSLDS. Finally, Panel H provides a quantitative comparison of the three models in terms of mean squared error (MSE) for both latent states and dynamics, demonstrating the gpSLDS's superior performance.", "section": "4 Results"}, {"figure_path": "LX1lwP90kt/figures/figures_7_1.jpg", "caption": "Figure 3: Results on hypothalamic data from Nair et al. [27]. In each of the panels A-C, flow field arrow widths are scaled by the magnitude of dynamics for clarity of visualization. A. rSLDS inferred latents and most likely dynamics. The presumed location of the line attractor from [27] is marked with a red box. B. gpSLDS inferred latents and most likely dynamics in latent space. Background is colored by posterior standard deviation of dynamics averaged across latent dimensions, which adjusts relative to the presence of data in the latent space. C. Posterior probability of slow points in gpSLDS, which validates line-attractor like dynamics, as marked by a red box. D. Comparison of in-sample forward simulation R\u00b2 between gpSLDS, rSLDS, and GP-SDE with RBF kernel. To compute this, we choose initial conditions uniformly spaced 100 time bins apart in both trials, simulate latent states k steps forward according to learned dynamics (with k ranging from 100-1500), and evaluate the R\u00b2 between predicted and true observations as in Nassar et al. [23]. Error bars are \u00b12SE over 5 different initializations.", "description": "This figure compares the results of applying rSLDS, gpSLDS, and GP-SDE with RBF kernel to real neural data from Nair et al. [27] concerning hypothalamic activity during aggression.  Panels A-C visualize the latent dynamics inferred by the rSLDS and gpSLDS models, highlighting the identification of a line attractor by the gpSLDS with associated uncertainty estimates. Panel D shows a quantitative comparison of the in-sample forward simulation accuracy across the models, demonstrating the gpSLDS's improved performance compared to rSLDS.", "section": "Application to hypothalamic neural population recordings during aggression"}, {"figure_path": "LX1lwP90kt/figures/figures_8_1.jpg", "caption": "Figure 4: Results on LIP spiking data from a decision-making task in Stine et al. [42]. A. gpSLDS inferred latents colored by coherence, inferred dynamics with background colored by most likely linear regime, and the learned input-driven direction depicted by an orange arrow. B. Projection of latents onto the 1D input-driven axis from Panel A, colored by coherence (top) and choice (bottom). C. Inferred latents with 95% credible intervals and corresponding 100ms pulse input for an example trial. D. Posterior variance of dynamics produced by the gpSLDS.", "description": "This figure shows the results of applying the gpSLDS model to LIP spiking data from a decision-making task. Panel A shows the inferred latent states colored by coherence, the inferred dynamics with background colored by the most likely linear regime, and the learned input-driven direction. Panel B shows the projection of latents onto the 1D input-driven axis, colored by coherence and choice. Panel C shows the inferred latents with 95% credible intervals and the corresponding 100ms pulse input for an example trial. Panel D shows the posterior variance of dynamics produced by the gpSLDS model.", "section": "4.3 Application to lateral intraparietal neural recordings during decision making"}, {"figure_path": "LX1lwP90kt/figures/figures_21_1.jpg", "caption": "Figure 5: Comparison between the standard vEM approach in Duncker et al. [10] and our modified vEM approach. A. Estimation error between the true and learned decision boundaries, computed as described in Appendix C. For each vEM approach, we fit 5 gpSLDS models with different random initializations. The estimation errors are denoted in light blue/purple dots. The runs that we display in the next two panels are denoted by a solid blue/purple dot. B. The standard vEM approach fails to learn the true decision boundary of x1 = 0. C. The modified vEM approach precisely learns this decision boundary.", "description": "This figure compares the performance of standard and modified variational expectation-maximization (vEM) approaches for learning the hyperparameters of Gaussian Process Switching Linear Dynamical Systems (gpSLDS).  Panel A shows the error in estimating the decision boundary between two dynamical regimes for five model fits using each vEM method. Panel B displays the learned and true decision boundaries for the standard vEM, illustrating failure to learn the true boundary. Panel C shows that the modified vEM successfully learns the true boundary.", "section": "Appendix C: Empirical results for new learning objective"}, {"figure_path": "LX1lwP90kt/figures/figures_22_1.jpg", "caption": "Figure 6: Additional synthetic data results on a 2D limit cycle from a gpSLDS fit with quadratic decision boundaries. A. True dynamics and true latent trajectories on 3 example trials used to generate the dataset. Dynamics are an unstable rotation and a stable rotation with fixed points at (0,0), separated by x1 + x2 = 4. B. Poisson process observations for an example trial. C. gpSLDS inferred latent trajectory with 95% posterior credible intervals for an example trial. D. The learned \u03c0(x) accurately recovers the true circular boundary between the two sets of linear dynamics. E. The gpSLDS learned posterior variance on dynamics. The posterior variance is low in regions heavily traversed by the true latent paths, and is high in regions with little to no data.", "description": "This figure displays the results of applying the gpSLDS model to a synthetic dataset with a 2D limit cycle. The true dynamics consist of an unstable and a stable rotation around (0,0), separated by a nonlinear boundary (x1 + x2 = 4). The gpSLDS successfully infers the latent trajectories, accurately recovers the nonlinear boundary, and appropriately reflects uncertainty in its dynamics estimates (low variance in high-density regions, high variance elsewhere).  The figure demonstrates the model's ability to handle nonlinear decision boundaries.", "section": "Additional synthetic data results"}]