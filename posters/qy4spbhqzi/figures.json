[{"figure_path": "QY4SpBhQZI/figures/figures_1_1.jpg", "caption": "Figure 1: Reference-based face image restoration. Given an input low-quality face image (a), a Latent Diffusion Model (LDM) can reconstruct a high-quality image (b); however, it may not be faithful to the individual's facial identity. To address this problem, we propose ReF-LDM, which restores a high-quality image with faithful details (c) by utilizing additional reference images (d).", "description": "This figure shows a comparison of face image restoration results using different methods.  The input is a low-quality (LQ) image (a). A standard Latent Diffusion Model (LDM) produces a high-quality (HQ) image (b), but it doesn't perfectly match the person's identity. The proposed ReF-LDM method, which uses additional reference HQ images (d), achieves a much better result (c) with more accurate facial details and identity preservation.", "section": "1 Introduction"}, {"figure_path": "QY4SpBhQZI/figures/figures_2_1.jpg", "caption": "Figure 2: The proposed ReF-LDM pipeline. Our model accepts a low-quality image and multiple high-quality reference images as input and generates a high-quality image. The blue top panel alone represents a typical LDM [22] denoising process. For an LQ image XLQ, we concatenate its latent ZLQ with zt along the channel axis to serve as the input for the denoising U-net. For the reference images {xref}, we design a CacheKV mechanism, depicted in the red panel, to extract and cache their key and value tokens using the same denoising U-net for just one time. These cached KV tokens can then be utlized repeatedly in each of the T timesteps of the main denoising process. During training, we adopt the classic LDM loss (LLDM) and introduce a timestep-scaled identity loss (Ltime ID).", "description": "This figure illustrates the architecture of the ReF-LDM model, which consists of a main denoising process (using a U-net) and a CacheKV mechanism for efficiently integrating multiple reference images. The model takes a low-quality (LQ) input image and several high-quality (HQ) reference images as input and generates a high-quality (HQ) output image. The CacheKV mechanism stores key-value pairs extracted from the reference images to avoid redundant computations. The model uses a classic LDM loss and a timestep-scaled identity loss during training.", "section": "3 The proposed ReF-LDM model"}, {"figure_path": "QY4SpBhQZI/figures/figures_4_1.jpg", "caption": "Figure 3: Different mechanisms for incorporating reference images into the main denoising process.", "description": "This figure compares four different methods for integrating reference images into a diffusion model for image generation.  (a) Channel-concatenation simply concatenates the reference image features with the main input features along the channel dimension. (b) Cross-attention uses a cross-attention mechanism to relate the reference and main features, but this is done at every timestep, which is computationally expensive. (c) Spatial-concatenation concatenates the features spatially, increasing computational cost, but more effectively leveraging the spatial alignment. (d) CacheKV (the authors' method) caches the reference image features using the same U-net only once, then uses them repeatedly in each timestep, significantly increasing efficiency without compromising results.", "section": "3.1.3 Comparing CacheKV with other designs"}, {"figure_path": "QY4SpBhQZI/figures/figures_7_1.jpg", "caption": "Figure 4: Visual ablation results for the timestep-scaled identity loss.", "description": "This figure shows the visual comparison of the results of three different training settings: without identity loss (LLDM), with naive identity loss (LLDM + LID), and with the proposed timestep-scaled identity loss (LLDM + Ltime ID). The input LQ image is severely blurred. The LLDM result shows a blurry image with missing details.  The (LLDM + LID) result shows a relatively clear image, but it has some artifacts. The (LLDM + Ltime ID) result shows a high-quality image that is similar to the ground truth image.", "section": "3.2 Timestep-scaled identity loss"}, {"figure_path": "QY4SpBhQZI/figures/figures_9_1.jpg", "caption": "Figure 5: Qualitative comparison. From left to right: input LQ, ground truth, other methods, and our ReF-LDM. From top to bottom: FFHQ-Ref-Severe, FFHQ-Ref-Moderate, and CelebA-Test-Ref.", "description": "This figure shows a qualitative comparison of the proposed ReF-LDM model against several state-of-the-art methods for reference-based face image restoration.  Three examples are shown, each with varying levels of degradation (FFHQ-Ref-Severe, FFHQ-Ref-Moderate, and CelebA-Test-Ref). For each example, the input low-quality (LQ) image is displayed, along with the ground truth (GT) image and the results from CodeFormer, DMDNet, LDM, and ReF-LDM. This allows for a visual comparison of the different methods' ability to reconstruct high-quality images that accurately reflect the individual's facial identity. ", "section": "5.3.2 Qualitative comparison"}, {"figure_path": "QY4SpBhQZI/figures/figures_13_1.jpg", "caption": "Figure 1: Reference-based face image restoration. Given an input low-quality face image (a), a Latent Diffusion Model (LDM) can reconstruct a high-quality image (b); however, it may not be faithful to the individual's facial identity. To address this problem, we propose ReF-LDM, which restores a high-quality image with faithful details (c) by utilizing additional reference images (d).", "description": "This figure shows a comparison of face image restoration results using different methods.  The input is a low-quality (LQ) face image. A standard Latent Diffusion Model (LDM) is used for restoration, which produces a high-quality (HQ) result but one that may not accurately reflect the subject's identity.  The authors' proposed method, ReF-LDM, uses additional high-quality reference images as input, to improve the accuracy of the restored identity. The figure visually demonstrates that ReF-LDM is able to generate higher-quality images that are more faithful to the individual's actual appearance.", "section": "1 Introduction"}, {"figure_path": "QY4SpBhQZI/figures/figures_13_2.jpg", "caption": "Figure 7: Example images with mirror padding and watermark artifacts in the CelebRef-HQ dataset.", "description": "This figure shows examples of images from the CelebRef-HQ dataset that have issues with image quality.  The issues include mirror padding artifacts around the edges of the faces and watermarks overlaying parts of the image.  These artifacts reduce the quality of the images and demonstrate a limitation of this dataset for face restoration tasks.", "section": "Image quality issues in the previous dataset CelebRef-HQ"}, {"figure_path": "QY4SpBhQZI/figures/figures_14_1.jpg", "caption": "Figure 8: Distribution of the number of available reference images per image in the FFHQ-Ref dataset of train, validation, and test splits.", "description": "This figure shows the distribution of the number of reference images per image in the FFHQ-Ref dataset, which is used for training and testing the ReF-LDM model.  The figure is broken down into three subfigures, one for each split of the data: (a) Training set, (b) Validation set, and (c) Test set. Each subfigure displays a histogram showing the frequency of images with a specific number of reference images. The x-axis represents the number of reference images (1-9, 9+), and the y-axis shows the count of images with that many reference images.  The histograms provide an understanding of the distribution of reference images, highlighting which numbers of references are most common in each dataset split. This information is important because the ReF-LDM model uses multiple reference images for face image restoration, and the distribution of reference images in the dataset can influence the training and performance of the model.", "section": "4 FFHQ-Ref dataset"}, {"figure_path": "QY4SpBhQZI/figures/figures_14_2.jpg", "caption": "Figure 1: Reference-based face image restoration. Given an input low-quality face image (a), a Latent Diffusion Model (LDM) can reconstruct a high-quality image (b); however, it may not be faithful to the individual's facial identity. To address this problem, we propose ReF-LDM, which restores a high-quality image with faithful details (c) by utilizing additional reference images (d).", "description": "This figure shows a comparison of face image restoration results using a standard Latent Diffusion Model (LDM) and the proposed ReF-LDM.  The input is a low-quality (LQ) image (a). The standard LDM produces a high-quality (HQ) image (b), but it may not accurately reflect the person's true appearance.  In contrast, ReF-LDM uses additional HQ reference images (d) to generate a restored HQ image (c) that is more faithful to the original person's identity.", "section": "1 Introduction"}, {"figure_path": "QY4SpBhQZI/figures/figures_14_3.jpg", "caption": "Figure 1: Reference-based face image restoration. Given an input low-quality face image (a), a Latent Diffusion Model (LDM) can reconstruct a high-quality image (b); however, it may not be faithful to the individual's facial identity. To address this problem, we propose ReF-LDM, which restores a high-quality image with faithful details (c) by utilizing additional reference images (d).", "description": "This figure demonstrates the effectiveness of ReF-LDM, a reference-based face image restoration model. It shows that while a standard LDM can generate a high-quality image from a low-quality input, it may not accurately reflect the person's true appearance.  By incorporating additional high-quality reference images, ReF-LDM achieves more accurate and faithful restoration of facial features.", "section": "1 Introduction"}, {"figure_path": "QY4SpBhQZI/figures/figures_15_1.jpg", "caption": "Figure 1: Reference-based face image restoration. Given an input low-quality face image (a), a Latent Diffusion Model (LDM) can reconstruct a high-quality image (b); however, it may not be faithful to the individual's facial identity. To address this problem, we propose ReF-LDM, which restores a high-quality image with faithful details (c) by utilizing additional reference images (d).", "description": "This figure demonstrates the effectiveness of the proposed ReF-LDM model in restoring high-quality face images from low-quality inputs. It shows a comparison between a standard LDM approach and the ReF-LDM approach, highlighting how the inclusion of reference images significantly improves the accuracy and fidelity of the restored image. The reference images provide additional information about the person's appearance, enabling the ReF-LDM to reconstruct a more accurate and realistic image compared to the LDM which only uses the low-quality image.", "section": "1 Introduction"}, {"figure_path": "QY4SpBhQZI/figures/figures_15_2.jpg", "caption": "Figure 1: Reference-based face image restoration. Given an input low-quality face image (a), a Latent Diffusion Model (LDM) can reconstruct a high-quality image (b); however, it may not be faithful to the individual's facial identity. To address this problem, we propose ReF-LDM, which restores a high-quality image with faithful details (c) by utilizing additional reference images (d).", "description": "This figure shows a comparison of face image restoration results using a Latent Diffusion Model (LDM) and the proposed ReF-LDM.  The input is a low-quality (LQ) image (a).  A standard LDM produces a high-quality (HQ) image (b), but the result may not accurately reflect the person's identity.  ReF-LDM incorporates multiple HQ reference images (d) to improve the restoration, producing a result (c) that is both high-quality and preserves the identity more faithfully.", "section": "1 Introduction"}, {"figure_path": "QY4SpBhQZI/figures/figures_16_1.jpg", "caption": "Figure 5: Qualitative comparison. From left to right: input LQ, ground truth, other methods, and our ReF-LDM. From top to bottom: FFHQ-Ref-Severe, FFHQ-Ref-Moderate, and CelebA-Test-Ref.", "description": "This figure shows a qualitative comparison of face image restoration results from different methods: input low-quality (LQ) image, ground truth (GT), CodeFormer, DMDNet, LDM (Latent Diffusion Model), and ReF-LDM (the proposed method).  The comparison is done across three different datasets: FFHQ-Ref-Severe, FFHQ-Ref-Moderate, and CelebA-Test-Ref, representing varying levels of image degradation. Each row shows the results for a different input image, illustrating the strengths and weaknesses of each method in restoring detail, preserving identity, and handling different levels of image noise and corruption.", "section": "5.3 Qualitative comparison"}, {"figure_path": "QY4SpBhQZI/figures/figures_16_2.jpg", "caption": "Figure 5: Qualitative comparison. From left to right: input LQ, ground truth, other methods, and our ReF-LDM. From top to bottom: FFHQ-Ref-Severe, FFHQ-Ref-Moderate, and CelebA-Test-Ref.", "description": "This figure presents a qualitative comparison of face image restoration results using different methods.  The top row shows an example from the FFHQ-Ref-Severe dataset, the middle row from the FFHQ-Ref-Moderate dataset, and the bottom row from the CelebA-Test-Ref dataset. For each dataset, the image sequence shows (from left to right): the low-quality (LQ) input image, the ground truth (GT) high-quality image, and the results generated by CodeFormer, DMDNet, a standard Latent Diffusion Model (LDM), and the proposed ReF-LDM.  The comparison highlights ReF-LDM's ability to better preserve the facial identity and produce more realistic high-quality images compared to other methods.", "section": "5.3.2 Qualitative comparison"}, {"figure_path": "QY4SpBhQZI/figures/figures_16_3.jpg", "caption": "Figure 5: Qualitative comparison. From left to right: input LQ, ground truth, other methods, and our ReF-LDM. From top to bottom: FFHQ-Ref-Severe, FFHQ-Ref-Moderate, and CelebA-Test-Ref.", "description": "This figure compares the image restoration results of different methods including ReF-LDM, CodeFormer, DMDNet, and LDM on three different datasets with varying degradation levels.  It visually demonstrates ReF-LDM's superior ability to restore high-quality images that are both realistic and maintain facial identity compared to other methods, especially in cases of severe degradation.  The top row shows examples from the FFHQ-Ref-Severe dataset; the middle row shows examples from the FFHQ-Ref-Moderate dataset; and the bottom row shows examples from the CelebA-Test-Ref dataset.", "section": "5.3.2 Qualitative comparison"}, {"figure_path": "QY4SpBhQZI/figures/figures_17_1.jpg", "caption": "Figure 1: Reference-based face image restoration. Given an input low-quality face image (a), a Latent Diffusion Model (LDM) can reconstruct a high-quality image (b); however, it may not be faithful to the individual's facial identity. To address this problem, we propose ReF-LDM, which restores a high-quality image with faithful details (c) by utilizing additional reference images (d).", "description": "This figure demonstrates the core idea of the paper by comparing the results of a standard Latent Diffusion Model (LDM) and the proposed ReF-LDM on face image restoration.  It shows that while a regular LDM can generate a high-quality image from a low-quality input, it might not accurately reflect the person's true facial identity. In contrast, ReF-LDM, by incorporating additional high-quality reference images of the same person, produces a restored image that is both high-quality and accurately represents the individual's identity.", "section": "1 Introduction"}]