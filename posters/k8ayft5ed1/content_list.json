[{"type": "text", "text": "Understanding and Improving Adversarial Collaborative Filtering for Robust Recommendation ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Kaike Zhang1,2, Qi $\\mathbf{Cao^{1}}$ ,\u2217 Yunfan $\\mathbf{W}\\mathbf{u}^{1,2}$ , Fei $\\mathbf{Sun}^{1}$ , Huawei Shen1, Xueqi Cheng ", "page_idx": 0}, {"type": "text", "text": "1 CAS Key Laboratory of AI Safety, Institute of Computing Technology, Chinese Academy of Sciences 2 University of Chinese Academy of Sciences Beijing, China {zhangkaike21s, caoqi, wuyunfan19b, sunfei, shenhuawei, cxq}@ict.ac.cn ", "page_idx": 0}, {"type": "text", "text": "Abstract ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Adversarial Collaborative Filtering (ACF), which typically applies adversarial perturbations at user and item embeddings through adversarial training, is widely recognized as an effective strategy for enhancing the robustness of Collaborative Filtering (CF) recommender systems against poisoning attacks. Besides, numerous studies have empirically shown that ACF can also improve recommendation performance compared to traditional CF. Despite these empirical successes, the theoretical understanding of ACF\u2019s effectiveness in terms of both performance and robustness remains unclear. To bridge this gap, in this paper, we first theoretically show that ACF can achieve a lower recommendation error compared to traditional CF with the same training epochs in both clean and poisoned data contexts. Furthermore, by establishing bounds for reductions in recommendation error during ACF\u2019s optimization process, we find that applying personalized magnitudes of perturbation for different users based on their embedding scales can further improve ACF\u2019s effectiveness. Building on these theoretical understandings, we propose Personalized Magnitude Adversarial Collaborative Filtering (PamaCF). Extensive experiments demonstrate that PamaCF effectively defends against various types of poisoning attacks while significantly enhancing recommendation performance. ", "page_idx": 0}, {"type": "text", "text": "1 Introduction ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Collaborative Filtering (CF) is widely recognized as a powerful tool for providing personalized recommendations [1, 2, 3] across various domains [4, 5]. However, the inherent openness of recommender systems allows attackers to inject fake users into the training data, aiming to manipulate recommendations, also known as poisoning attacks [6, 7]. Such manipulations can skew the distribution of item exposure, degrading the overall quality of the recommender system, thus harming the user experience and hindering the long-term development of the recommender system [8]. ", "page_idx": 0}, {"type": "text", "text": "Existing methods for defending against poisoning attacks in CF can be categorized into two types [8]: (1) detecting and mitigating the influence of fake users [9, 10, 11, 12, 13, 14], and (2) developing robust models via adversarial training, also known as Adversarial Collaborative Filtering (ACF) [15, 16, 17, 18, 19, 20]. The first strategy focuses on detecting and removing fake users from the dataset before training [9, 10, 11, 14] or mitigating their impact during the training phase [12, 13]. These methods often rely on predefined assumptions about attacks [9, 12] or require labeled data related to attacks [10, 11, 12, 13]. Consequently, deviations from predefined attack patterns may lead to misclassification, failing to resist attacks while potentially harming genuine users\u2019 experience [13]. ", "page_idx": 0}, {"type": "text", "text": "In contrast, ACF provides a more general defense paradigm without prior knowledge [15, 16, 17, 18, 19, 20]. Poisoning attacks in recommender systems mainly affect the learned embeddings of users and items, i.e., the system\u2019s parameters [6, 7]. Predominant ACF methods, particularly those aligned with Adversarial Personalized Ranking (APR) framework [15], heuristically incorporate adversarial perturbations at the parameter level during the training phase to mitigate these attacks [15, 17, 19, 20]. This approach employs a \u201cmin-max\u201d paradigm, designed to minimize the recommendation error while contending with parameter perturbations aimed at maximizing this error within a specified magnitude [15], thus enhancing the robustness of CF. ", "page_idx": 1}, {"type": "text", "text": "It is interesting to note that adversarial training in the Computer Vision (CV) domain [21, 22, 23] has been observed to degrade model performance on clean samples [24, 25]. Several studies have also theoretically demonstrated a trade-off between robustness against evasion attacks and the performance of adversarial training in CV [26]. In contrast, ACF in recommender systems has been shown in numerous studies not only to enhance the robustness against poisoning attacks [8, 13, 18] but also to improve recommendation performance [15, 20, 27]. Despite the empirical evidence highlighting ACF\u2019s advantages, it still lacks a comprehensive theoretical understanding, which limits the ability to fully exploit the benefits and potential of ACF. To bridge this gap, in this paper, we propose the following research questions for further investigation: ", "page_idx": 1}, {"type": "text", "text": "i. Why does ACF enhance both robustness and performance compared to traditional CF? ii. How can we further improve ACF? ", "page_idx": 1}, {"type": "text", "text": "To answer these questions, we delve into a theoretical analysis of a simplified CF scenario. This analysis confirms that ACF can achieve a lower recommendation error at the same training epoch in both clean and poisoned data contexts, showing better performance and robustness compared to traditional CF. To investigate potential improvements to ACF, we establish upper and lower bounds for reductions in recommendation error during ACF\u2019s optimization process. Our findings indicate that (1) Users have varying constraints for perturbation magnitudes, i.e., different maximum perturbation magnitudes; (2) Within these constraints, applying personalized perturbation magnitudes as much as possible for each user can increase the error reduction bounds, further improving ACF\u2019s effectiveness. ", "page_idx": 1}, {"type": "text", "text": "Extending our theoretical results to practical CF scenarios, we establish a positive correlation between users\u2019 maximum perturbation magnitudes and their embedding scales. Building on these theoretical understandings, we introduce Personalalized Magnitude Adversarial Collaborative Filtering (PamaCF). PamaCF dynamically and personally assigns perturbation magnitudes based on users\u2019 embedding scales. Extensive experiments confirm that PamaCF outperforms baselines in both performance and robustness. Notably, PamaCF increases the average recommendation performance of the backbone model by $13.84\\%$ and reduces the average success ratio of attacks by $44.92\\%$ compared to the best baseline defense method. The main contributions of our study are summarized as follows: ", "page_idx": 1}, {"type": "text", "text": "", "page_idx": 1}, {"type": "text", "text": "\u2022 We provide theoretical evidence that ACF can achieve better performance and robustness compared to traditional CF in both clean and poisoned data contexts.   \n\u2022 We further identify upper and lower bounds of reduction in recommendation error for ACF during its optimization and demonstrate that applying personalized magnitudes of perturbation for each user can further improve ACF.   \n\u2022 Based on the above theoretical understandings, we propose Personalized Magnitude Adversarial Collaborative Filtering (PamaCF), with extensive experiments confirming that PamaCF further improves both performance and robustness compared to state-of-the-art defense methods. ", "page_idx": 1}, {"type": "text", "text": "The code of our experiments is available at https://github.com/Kaike-Zhang/PamaCF. ", "page_idx": 1}, {"type": "text", "text": "2 Preliminary ", "text_level": 1, "page_idx": 1}, {"type": "text", "text": "Collaborative Filtering (CF) methods are widely employed in recommender systems. Following [1], we define a set of users $\\mathcal{U}=\\{u\\}$ and a set of items $\\mathcal{V}=\\{v\\}$ . Using data from user-item interactions, our objective is to learn latent embeddings $\\pmb{U}=[\\pmb{u}\\in\\mathbb{R}^{d}]_{u\\in\\mathcal{U}}$ for users and $V=[\\pmb{v}\\in\\mathbb{R}^{d}]_{v\\in\\mathcal{V}}$ for items. Then, we employ a preference function $f:\\mathbb{R}^{d}\\times\\mathbb{R}^{d}\\to\\mathbb{R}$ , which predicts user-item preference scores, denoted as $\\hat{r}_{u,v}=f(u,v)$ . ", "page_idx": 1}, {"type": "text", "text": "Adversarial Collaborative Filtering (ACF) is acknowledged as an effective approach for enhancing both the performance and the robustness of CF recommender systems in the face of poisoning attacks. ACF methods, particularly within the framework of Adversarial Personalized Ranking (APR) [15], integrate adversarial perturbations at the parameter level (i.e., the latent embeddings $U$ and $V$ ) during the training phase. Let $\\mathcal{L}(\\Theta)$ denote the loss function of the CF recommender system, where $\\boldsymbol\\Theta=\\bar{(\\boldsymbol U},\\boldsymbol V)$ represents the recommender system\u2019s parameters. ACF methods apply perturbations $\\Delta$ directly to the parameters as: ", "page_idx": 2}, {"type": "equation", "text": "$$\n\\mathcal{L}_{\\mathrm{ACF}}(\\Theta)=\\mathcal{L}(\\Theta)+\\lambda\\mathcal{L}(\\Theta+\\Delta^{\\mathrm{adv}}),\n$$", "text_format": "latex", "page_idx": 2}, {"type": "equation", "text": "$$\n\\mathrm{where}\\quad\\Delta^{\\mathrm{adv}}=\\arg\\operatorname*{max}_{\\Delta,\\;\\|\\Delta\\|\\leq\\epsilon}\\mathcal{L}(\\Theta+\\Delta),\n$$", "text_format": "latex", "page_idx": 2}, {"type": "text", "text": "where $\\epsilon>0$ defines the maximum magnitude of perturbations, and $\\lambda$ is the adversarial training weight. Due to constraints on space, a detailed discussion of related works is provided in Appendix A. ", "page_idx": 2}, {"type": "text", "text": "3 Theoretical Understanding of ACF ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "In this section, we provide a theoretical analysis of why ACF achieves superior performance and robustness compared to traditional CF from the perspective of recommendation error. Then, we explore mechanisms to further improve ACF\u2019s effectiveness based on its error reduction bounds. For clarity and simplicity, we initially focus on a Gaussian Single-item Recommender System, aligning with the frameworks presented in [18, 28]. It\u2019s important to note that the insights and analytical frameworks developed here are also applicable to more practical scenarios, as discussed in Section 4. ", "page_idx": 2}, {"type": "text", "text": "Definition 1 (Gaussian Recommender System). Given a rating set $\\mathcal{R}\\,=\\,\\{r_{1},r_{2},...\\,,r_{n}\\}$ corresponding to $n$ users, where each rating $r$ is randomly selected from $\\{\\pm1\\}$ , an average embedding vector $\\bar{\\pmb{u}}\\in\\mathbb R^{d}$ , and $\\sigma>0$ , the Gaussian Recommender System initializes each user\u2019s embedding $\\textbf{\\em u}$ from the normal distribution $\\mathcal{N}(r\\bar{\\pmb u},\\sigma^{2}{\\pmb I})$ . The item embedding $\\pmb{v}$ is initialized as the average vector derived from these users: $\\begin{array}{r}{{\\pmb v}=\\frac{1}{n}\\sum_{i=1.}^{n}r_{i}{\\pmb u}_{i}}\\end{array}$ . Then, a preference function $f:\\mathbb{R}^{d}\\times\\mathbb{R}^{d}\\rightarrow\\{\\pm1\\}$ is employed to predict user preferences: $\\dot{f}(\\pmb{u},\\pmb{v})=\\mathrm{sgn}(\\langle\\pmb{v},\\pmb{u}\\rangle)$ , where $\\operatorname{sgn}({\\mathord{\\cdot}})$ denotes the sign function, returning $^{\\,l}$ if $\\langle\\boldsymbol{u},\\boldsymbol{v}\\rangle>0$ and $-I$ otherwise. ", "page_idx": 2}, {"type": "text", "text": "Based on Definition 1, we obtain ${\\mathcal Z}\\,=\\,\\bigl\\{(\\pmb{{u}}_{1},r_{1}),\\dots,(\\pmb{{u}}_{n},r_{n})\\bigr\\}$ , where $\\textbf{\\em u}$ represents the systemlearned user embedding. With continued training, both each user embedding $\\textbf{\\em u}$ and item embedding $\\pmb{v}$ are iteratively updated. Let $\\pmb{u}_{(t)}$ and $\\pmb{v}_{(t)}$ denote user and item embeddings at the $t^{\\mathrm{th}}$ epoch, respectively. For analytical simplicity and without loss of generality, we define the standard loss function $\\mathcal{L}(\\Theta)$ (as traditional CF) used in the Gaussian Recommender System as follows [18]: ", "page_idx": 2}, {"type": "equation", "text": "$$\n\\mathcal{L}(\\boldsymbol{\\Theta}_{(t)})=-\\sum_{(\\boldsymbol{u},\\boldsymbol{r})\\in\\mathbb{Z}}\\left[\\boldsymbol{r}\\cdot\\left\\langle\\boldsymbol{u}_{(t)},\\boldsymbol{v}_{(t)}\\right\\rangle\\right],\n$$", "text_format": "latex", "page_idx": 2}, {"type": "text", "text": "where the model parameters $\\Theta_{(t)}\\,=\\,\\bigl(\\pmb{v}_{(t)},\\bigl[\\pmb{u}_{1,(t)},\\pmb{u}_{2,(t)},\\dots,\\pmb{u}_{n,(t)}\\bigr]\\bigr)$ . To integrate ACF into the Gaussian Recommender System, we introduce the adversarial loss [15], $\\mathcal{L}_{\\mathrm{adv}}(\\Theta)$ , defined as: ", "page_idx": 2}, {"type": "equation", "text": "$$\n\\mathcal{L}_{\\mathrm{adv}}(\\Theta_{(t)})=\\mathcal{L}(\\Theta_{(t)})-\\lambda\\sum_{(\\boldsymbol{u},\\boldsymbol{r})\\in\\mathbb{Z}}\\left[\\boldsymbol{r}\\cdot\\left\\langle\\boldsymbol{u}_{(t)}+\\Delta_{\\boldsymbol{u}},\\boldsymbol{v}_{(t)}+\\Delta_{\\boldsymbol{v}}\\right\\rangle\\right],\n$$", "text_format": "latex", "page_idx": 2}, {"type": "text", "text": "where $\\lambda$ is the adversarial training weight. The perturbations $\\Delta_{u}$ and $\\Delta_{v}$ are applied to the user and item embeddings, respectively, as computed based on Equation 1. ", "page_idx": 2}, {"type": "text", "text": "3.1 Why Does Adversarial Collaborative Filtering Benefit Recommender Systems? ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "To analyze the performance and robustness of traditional CF and ACF within the Gaussian Recommender System, we evaluate them from the perspective of recommendation error during the training process. For each user, both performance and robustness are reflected by the user\u2019s recommendation error. Specifically, attacks\u2014whether item promotion attacks [6, 29] or performance damage attacks [8]\u2014inevitably increase the user\u2019s recommendation error. Meanwhile, a smaller recommendation error means a higher recommendation performance. For a given user $\\textbf{\\em u}$ , the initial item embedding $\\pmb{v}_{(0)}$ in the Gaussian Recommender System can be approximately modeled2 as a sample from $\\mathcal{N}(\\bar{\\pmb u},\\frac{\\sigma^{2}}{n-1}{\\pmb I})$ . Here, we provide the definition of recommendation error for user $\\textbf{\\em u}$ . ", "page_idx": 2}, {"type": "text", "text": "Definition 2 (Recommendation Error). Given a Gaussian Recommender System $f_{(t)}$ that has been trained for t epochs, the recommendation error for the user u with rating r at the $t^{\\mathrm{th}}$ epoch is defined as the probability that the system\u2019s prediction does not align with the user\u2019s actual rating, as: ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\mathbb{P}_{v_{(0)}\\sim N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}\\left[f_{(t)}(u,v)\\neq r\\mid(u,r)\\right]:=\\mathbb{E}_{v_{(0)}\\sim N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}\\left[\\mathbb{I}\\left(f_{(t)}(u,v)\\neq r\\mid(u,r),v_{(0)}\\right)\\right],}\\end{array}\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "where $\\mathbb{I}(\\cdot)$ is an indicator function that returns $^{\\,I}$ if the condition is true and $\\boldsymbol{O}$ otherwise. ", "page_idx": 3}, {"type": "text", "text": "Based on the framework of ACF [15, 20], which includes $t$ epochs of pre-training with standard loss before adversarial training, we derive a theorem that identifies the difference in recommendation error between standard and adversarial loss at the $(t+1)^{\\mathrm{th}}$ epoch. To distinguish between the recommendation error of traditional CF and ACF, we define Pv(0)\u223cN(u\u00af, \u03c32 I) f(t+1)(u, v) \u0338= r | (u, r) as the recommendation error following standard training (Equation 2) at the $(t+1)^{\\mathrm{th}}$ epoch, and P va(d0)v\u223cN(u\u00af, \u03c32 I) f(t+1)(u, v) \u0338= r | (u, r) as the recommendation error following adversarial training (Equation 3) at the $(t+1)^{\\mathrm{th}}$ epoch. ", "page_idx": 3}, {"type": "text", "text": "Theorem 1. Consider a Gaussian Recommender System $f_{(t)}$ , pre-trained for $t$ epochs using the standard loss function (Equation 2). Given a learning rate $\\eta$ , an adversarial training weight $\\lambda_{i}$ , and $a$ perturbation magnitude $\\epsilon_{s}$ , when <min(\u2225u\u03b7(t\u03bb)\u2225,\u2225u\u00af\u2225), and \u2225u\u00af\u2225\u226b\u03c33, the recommendation error for a user u with rating $r$ at the $(t+1)^{\\mathrm{th}}$ epoch follows that: ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\mathbb{P}_{v_{(0)}\\sim N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}\\left[f_{(t+1)}(\\pmb{u},v)\\neq r\\mid(\\pmb{u},r)\\right]>\\mathbb{P}_{v_{(0)}\\sim N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}^{\\mathrm{~adv}}\\left[f_{(t+1)}(\\pmb{u},v)\\neq r\\mid(\\pmb{u},r)\\right].}\\end{array}\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "For the proof, please refer to Appendix D.1.1. After the same epochs of pre-training, ACF at the next epoch achieves a lower recommendation error compared to traditional CF, thereby benefiting recommendation performance. ", "page_idx": 3}, {"type": "text", "text": "Next, our analysis extends to contexts where the recommender system is subject to poisoning attacks. These attacks involve injecting fake users into the system\u2019s training dataset to manipulate item exposure. We examine a Gaussian Recommender System with $\\mathcal{T}=\\{(\\bar{\\pmb{u}}_{1},r_{1}),\\dots,(\\pmb{u}_{n},\\bar{r}_{n})\\}$ , where each tuple $\\left(\\pmb{u},r\\right)\\in\\mathbb{R}^{d}\\times\\left\\{\\pmb{\\pm}1\\right\\}$ represents the learned embedding and the rating of a genuine user. A poisoning attack on this system injects a poisoning user set, $\\mathcal{Z}^{\\prime}=\\tilde{\\left\\{(\\pmb{{u}}_{1}^{\\prime},r_{1}^{\\prime}),(\\pmb{{u}}_{2}^{\\prime},r_{2}^{\\prime}),\\therefore...,(\\pmb{{u}}_{n^{\\prime}}^{\\prime},r_{n^{\\prime}}^{\\prime})\\right\\}}$ , with each tuple $\\left(\\pmb{u}^{\\prime},r^{\\prime}\\right)\\in\\mathbb{R}^{d}\\times\\{\\pmb{\\pmb{\\pmb{\\operatorname{t}}}}1\\}$ representing a fake user crafted by attackers4. The poisoned item embedding $\\pmb{v}^{\\prime}$ is reinitialized to include both genuine and malicious contributions: ", "page_idx": 3}, {"type": "equation", "text": "$$\n{\\pmb v}^{\\prime}=\\frac{1}{n+n^{\\prime}}\\left(\\sum_{({\\pmb u},r)\\in\\mathbb{Z}}r{\\pmb u}+\\sum_{({\\pmb u}^{\\prime},r^{\\prime})\\in\\mathbb{Z}^{\\prime}}r^{\\prime}{\\pmb u}^{\\prime}\\right),\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "where $n$ and $n^{\\prime}$ represent the number of genuine and fake users, respectively. ", "page_idx": 3}, {"type": "text", "text": "To evaluate the impact of these attacks, we introduce a formal definition of recommendation error in poisoned data. ", "page_idx": 3}, {"type": "text", "text": "Definition 3 ( $_{\\alpha}$ -Poisoned Recommendation Error). Given a boundary $\\alpha\\,>\\,0$ , and a set of fake users injected by attackers within this boundary, i.e., $\\mathcal{Z}^{\\prime}\\;\\subseteq\\;\\mathcal{P}(\\pmb{\\mathscr{u}}^{\\prime},\\alpha)\\;=\\;\\{(\\pmb{\\mathscr{u}}^{\\prime},r^{\\prime})\\ |\\ (\\pmb{\\mathscr{u}}^{\\prime},r^{\\prime})\\ \\in$ $\\mathbb{R}^{d}\\times\\{\\pm1\\}\\wedge\\|\\pmb{u}^{\\prime}\\|_{\\infty}\\leq\\alpha\\}$ , the $\\alpha$ -poisoned recommendation error for the genuine user u with rating $r$ at the $t^{\\mathrm{th}}$ epoch is defined as the probability: $\\begin{array}{r}{\\stackrel{\\mathrm{P}}{\\underset{v_{(0)}\\sim N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}{\\sim}}\\left[f_{(t),\\alpha}(u,v^{\\prime})\\neq r\\ |\\ (u,r)\\right]:=\\mathbb{E}_{v_{(0)}\\sim N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}\\left[\\mathbb{I}\\left(f_{(t),\\alpha}(u,v^{\\prime})\\neq r\\ |\\ (u,r),v_{(0)}\\right)\\right]}\\end{array}$ where $f_{(t),\\alpha}$ represents the Gaussian Recommender System under the $_{\\alpha}$ -poisoned condition, and $\\mathbb{I}(\\cdot)$ is an indicator function that returns $^{\\,I}$ if the condition is true and $\\boldsymbol{O}$ otherwise. For simplicity, we continue using the distribution of ${\\pmb v}_{(0)}$ from the definition. This allows us to further analyze the \u03b1-poisoned recommendation error based on the distribution of v\u2032(0) =n+nn\u2032 v(0) + $\\scriptstyle{\\frac{1}{n+n^{\\prime}}}\\sum_{(u^{\\prime},r^{\\prime})\\in{\\mathcal{Z}}^{\\prime}}r^{\\prime}{\\bf u}^{\\prime}.$ ", "page_idx": 3}, {"type": "text", "text": "", "page_idx": 3}, {"type": "text", "text": "Then we extend Theorem 1 to $_{\\alpha}$ -Poisoned Recommendation Error in the following theorem: ", "page_idx": 3}, {"type": "text", "text": "Theorem 2. Consider a poisoned Gaussian Recommender System $f_{(t),\\alpha}$ , pre-trained for t epochs using the standard loss function (Equation 2). Given a learning rate $\\eta_{:}$ , an adversarial training weight $\\lambda_{i}$ , and a perturbation magnitude $\\epsilon_{s}$ , when $\\epsilon<\\frac{\\operatorname*{min}(\\|\\pmb{u}_{(t)}\\|,\\|\\bar{\\pmb{u}}\\|)}{\\eta\\lambda}$ , and $\\|\\bar{\\pmb{u}}\\|\\gg\\sigma,$ , the $_{\\alpha}$ -poisoned recommendation error for a genuine user u with rating $r$ at the $(t+1)^{\\mathrm{th}}$ epoch follows that: ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\stackrel{\\mathcal{P}}{\\because}_{v(0)}\\sim\\!N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)\\left[f_{(t+1),\\alpha}(\\boldsymbol{u},\\boldsymbol{v}^{\\prime})\\neq\\boldsymbol{r}\\mid(\\boldsymbol{u},\\boldsymbol{r})\\right]>\\mathbb{P}_{v_{(0)}\\sim\\mathcal{N}(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}^{\\mathrm{~adv}}\\left[f_{(t+1),\\alpha}(\\boldsymbol{u},\\boldsymbol{v}^{\\prime})\\neq\\boldsymbol{r}\\mid(\\boldsymbol{u},\\boldsymbol{r})\\right].}\\end{array}\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "For the proof, please refer to Appendix D.1.2. Combining Theorem 1 and Theorem 2, we find that adversarial training, i.e., ACF, lowers recommendation errors compared to traditional CF in both clean and poisoned data contexts. Accordingly, ACF achieves better performance and robustness. ", "page_idx": 4}, {"type": "text", "text": "3.2 How to Further Enhance Adversarial Collaborative Filtering ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "To explore mechanisms to further improve the effectiveness of ACF, we subsequently derive upper and lower bounds on the reduction of recommendation error between any two consecutive epochs after $t$ epochs of pre-training. ", "page_idx": 4}, {"type": "text", "text": "Theorem 3. Consider a Gaussian Recommender System $f_{(t)}$ which has been pre-trained for t epochs using standard loss (Equation 2) and subsequently trained on adversarial loss (Equation 3). For the $(t+\\bar{k}+1)^{\\mathrm{th}}$ epoch, let the reduction in recommendation error of user u with rating r relative to the $(t+k)^{\\mathrm{th}}$ epoch from adversarial loss be denoted by: ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\Delta_{(t+k+1)}^{\\mathrm{adv}}\\mathbb{P}_{v_{(0)}\\sim N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}^{\\mathrm{adv}}[f(\\pmb{u},\\pmb{v})\\neq\\pmb{r}\\mid(\\pmb{u},\\pmb{r})]=}\\\\ &{\\mathbb{P}_{v_{(0)}\\sim N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}^{\\mathrm{adv}}\\left[f_{(t+k)}(\\pmb{u},\\pmb{v})\\neq\\pmb{r}\\mid(\\pmb{u},\\pmb{r})\\right]-\\mathbb{P}_{v_{(0)}\\sim N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}^{\\mathrm{adv}}\\left[f_{(t+k+1)}(\\pmb{u},\\pmb{v})\\neq\\pmb{r}\\mid(\\pmb{u},\\pmb{r})\\right].}\\end{array}\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "Given a learning rate $\\eta_{:}$ , an adversarial training weight $\\lambda_{i}$ , and a perturbation magnitude \u03f5, when \u03f5 < min(\u2225u(t+k)\u2225,\u2225u\u00af\u2225), and $\\|\\bar{\\pmb u}\\|\\gg\\sigma$ , it follows that: ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathrm{\\lambda}_{(t+k+1)}^{\\mathrm{adv}}\\mathbb{P}_{v_{(0)}\\sim N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}^{\\mathrm{\\adv}}[f(\\pmb{u},\\pmb{v})\\neq\\pmb{r}\\mid(\\pmb{u},\\pmb{r})]\\geq}\\\\ &{\\qquad\\qquad\\qquad\\Phi\\left(\\frac{\\sqrt{n-1}}{\\sigma}\\left(\\|\\bar{\\pmb{u}}\\|+\\eta(\\|\\bar{\\pmb{u}}\\|^{2}+\\frac{d\\sigma^{2}}{n-1})\\Psi(\\pmb{u},t+k)\\right)\\right)-\\Phi\\left(\\frac{\\sqrt{n-1}}{\\sigma}\\|\\bar{\\pmb{u}}\\|\\right),}\\\\ &{\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\mathrm{\\lambda}_{(t+k+1)}^{\\mathrm{adv}}\\mathbb{P}_{v_{(0)}\\sim N(\\bar{\\pmb{u}},\\frac{\\sigma^{2}}{n-1}I)}^{\\mathrm{\\adv}}[f(\\pmb{u},\\pmb{v})\\neq\\pmb{r}\\mid(\\pmb{u},\\pmb{r})]\\leq2\\Phi\\left(\\frac{\\sqrt{n-1}\\eta}{2\\sigma}(\\|\\bar{\\pmb{u}}\\|^{2}+\\frac{d\\sigma^{2}}{n-1})\\Psi(\\pmb{u},t+k)\\right)-1}\\end{array}\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "where $d$ is the embedding dimension, and $\\Phi(\\cdot)$ denotes the cumulative distribution function $(C D F)$ of the standard Gaussian distribution, and $\\Psi({\\boldsymbol{u}},t+k)$ is defined as: ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\Psi(u,t+k)=(1+\\lambda)\\gamma_{(t+k)}^{u}\\frac{C_{t+k}}{\\left\\|u_{(t+k)}\\right\\|},\\ \\ \\ w h e r e\\ \\ \\ \\gamma_{(t+k)}^{u}=\\left(1-\\frac{\\eta\\lambda\\epsilon}{\\left\\|u_{(t+k)}\\right\\|}\\right)^{-1},\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "where $C_{t+k}$ is a constant at the $(t+k)^{\\mathrm{th}}$ epoch ", "page_idx": 4}, {"type": "text", "text": "For the proof, please refer to Appendix D.2.1. In light of Theorem 3, given a learning rate $\\eta$ and an adversarial training weight $\\lambda$ , we can establish the following: (1) When the conditions, i.e., $\\begin{array}{r}{\\epsilon<\\frac{\\operatorname*{min}(\\|\\pmb{u}_{(t+k)}\\|,\\|\\bar{\\pmb{u}}\\|)}{\\eta\\lambda}}\\end{array}$ and $\\|\\bar{\\pmb u}\\|\\gg\\sigma$ , are satisfied, the error reduction for ACF can be both upper and lower bounded. (2) Increasing the perturbation magnitude $\\epsilon$ under the above conditions can further improve these bounds, thus benefiting ACF\u2019s effectiveness. ", "page_idx": 4}, {"type": "text", "text": "Then, similarly, we extend Theorem 3 to the $_{\\alpha}$ -poisoned context. ", "page_idx": 4}, {"type": "text", "text": "Theorem 4. Consider a poisoned Gaussian Recommender System $f_{(t),\\alpha}$ which has been pre-trained for $t$ epochs using standard loss (Equation 2) and subsequently trained on adversarial loss (Equation 3). For the $\\!\\,(t+k+1)^{\\mathrm{th}}$ epoch, let the reduction in $_{\\alpha}$ -poisoned recommendation error of $a$ genuine user $\\textbf{\\em u}$ with rating $r$ relative to the $(t+k)^{\\mathrm{th}}$ epoch from adversarial loss be denoted by \u2206(atd+vk+1)P va(d0)v\u223cN(u\u00af, n\u03c3\u221221 I)[f\u03b1(u, v\u2032) \u0338= r | (u, r)]. Let \u03b2 = nn\u2032 d\u03b1 + \u2225u\u00af\u2225and \u03c4 = 2nn\u2032\u03b1\u2225u\u00af\u22250, where $d$ is the embedding dimension, and given a learning rate $\\eta_{:}$ , an adversarial training weight $\\lambda_{-}$ , and a perturbation magnitude $\\epsilon$ , when <min(\u2225u(t\u03b7+\u03bbk)\u2225,\u2225u\u00af\u2225), and \u2225u\u00af\u2225\u226b\u03c3, it follows that: ", "page_idx": 4}, {"type": "text", "text": "", "page_idx": 5}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\Delta_{(t+k+1)}^{\\mathrm{adv}}\\mathbb{P}_{v_{(0)}\\sim\\mathcal{N}(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}^{\\mathrm{~adv}}[f_{\\alpha}(\\pmb{u},\\pmb{v}^{\\prime})\\neq r\\mid(\\pmb{u},r)]\\quad>}\\\\ &{\\Phi\\left(\\frac{\\sqrt{n-1}}{\\sigma}\\left(\\beta+\\eta\\left(\\frac{n^{2}\\|\\bar{\\pmb{u}}\\|^{2}-\\tau}{n(n+n^{\\prime})}+\\frac{n d\\sigma^{2}}{(n-1)(n+n^{\\prime})}\\right)\\Psi(\\pmb{u},t+k)\\right)\\right)-\\Phi\\left(\\frac{\\sqrt{n-1}}{\\sigma}\\beta\\right),}\\\\ &{\\Delta_{(t+k+1)}^{\\mathrm{adv}}\\mathbb{P}_{v_{(0)}\\sim\\mathcal{N}(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}^{\\mathrm{~adv}}[f_{\\alpha}(\\pmb{u},\\pmb{v}^{\\prime})\\neq r\\mid(\\pmb{u},r)]\\quad\\leq}\\\\ &{\\qquad\\qquad2\\Phi\\left(\\frac{\\sqrt{n-1}\\eta}{2\\sigma}\\left(\\frac{n^{2}\\|\\bar{\\pmb{u}}\\|^{2}+(n^{\\prime})^{2}d\\alpha^{2}+\\tau}{n(n+n^{\\prime})}+\\frac{n d\\sigma^{2}}{(n-1)(n+n^{\\prime})}\\right)\\Psi(\\pmb{u},t+k)\\right)-1,}\\end{array}\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "where $\\Phi()$ denotes the cumulative distribution function $(C D F)$ of the standard Gaussian distribution, $n^{\\prime}$ is the number of fake users, and $\\Psi(\\cdot)$ is defined in Equation $^{4}$ . ", "page_idx": 5}, {"type": "text", "text": "For the proof, please refer to Appendix D.2.2. From Theorem 4, we understand that increasing $\\Psi({\\boldsymbol{u}},t\\!+\\!{\\boldsymbol{k}})$ can further improve both the upper and lower bounds of error reduction, thereby mitigating the negative impact of poisons. Specifically, this involves the same mechanism as in the clean data context: increasing the perturbation magnitude $\\epsilon$ within $\\begin{array}{r}{\\epsilon<\\frac{\\operatorname*{min}(\\|\\pmb{u}_{(t+k)}\\|,\\|\\bar{\\pmb{u}}\\|)}{\\eta\\lambda}}\\end{array}$ ", "page_idx": 5}, {"type": "text", "text": "In conclusion, the theorems in this section indicate that for each user $\\textbf{\\em u}$ , when the user\u2019s perturbation magnitude meets $\\begin{array}{r}{\\epsilon<\\frac{\\operatorname*{min}(\\|\\pmb{u}_{(t+k)}\\|,\\|\\bar{\\pmb{u}}\\|)}{\\eta\\lambda}}\\end{array}$ , we have the following: (1) ACF is theoretically shown to be more effective than traditional CF, and (2) Increasing the user\u2019s perturbation magnitude during training as much as possible can further improve both the performance and robustness of ACF. These theoretical understandings can further benefit exploring and fully unleashing the potential of ACF. ", "page_idx": 5}, {"type": "text", "text": "4 Methodology ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "To extend theoretical understandings from the simple CF scenario to more practical scenarios, such as multi-item recommendations with Bayesian Personalized Ranking (BPR) [31], which is a mainstream loss function used in CF recommendations, we first conduct a preliminary experiment shown in Figure 1. Using Matrix Factorization [2] on the Gowalla dataset [32], we observe results similar to those in Theorem 3 and Theorem 4: $\\mathrm{NDCG}@20$ for users improves within their maximum magnitudes, i.e., constraints, but significantly declines once these constraints are surpassed. Based on the theoretical understandings provided in Section 3, we derive the following corollary to identify the maximum perturbation magnitude for each user in practical CF scenarios. ", "page_idx": 5}, {"type": "image", "img_path": "k8AYft5ED1/tmp/0be84af9198593222541179e409f76312577c9b84d94c145c12f8bd5523ed80b.jpg", "img_caption": ["Figure 1 $:\\,\\mathrm{NDCG}@20$ across various perturbation magnitudes for five users (subject to Random Attacks [30]). "], "img_footnote": [], "page_idx": 5}, {"type": "text", "text": "Corollary 1. Given any dot-product-based loss function $\\mathcal{L}(\\Theta)$ , within the framework of Adversarial Collaborative Filtering as defined in Equation 1, the maximum perturbation magnitude \u03f5((tu)),m $\\epsilon_{(t),\\mathrm{max}}^{({\\bf u})}f o r$ user u at the $t^{\\mathrm{th}}$ epoch is positively related to $\\|\\pmb{u}_{(t)}\\|$ . ", "page_idx": 5}, {"type": "text", "text": "For the proof of Corollary 1, please refer to Appendix D.3. According to Corollary 1, we observe that for a user $\\textbf{\\em u}$ , the larger $\\lVert u\\rVert$ , the greater the maximum perturbation magnitude. Considering that maximum perturbation magnitudes will be affected by other factors in the actual training process, to ensure training stability, we decompose $\\epsilon_{(t),\\mathrm{max}}^{({\\boldsymbol{u}})}$ for a user $\\textbf{\\em u}$ at epoch $t$ into two components: the uniform perturbation magnitude $\\rho$ , applicable to all users, and a user-specific perturbation coefficient $c({\\pmb u},t)$ , expressed as: ", "page_idx": 5}, {"type": "equation", "text": "$$\n\\epsilon_{(t),\\mathrm{max}}^{({\\pmb u})}=\\rho\\cdot c({\\pmb u},t).\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "According to Corollary 1, $c({\\pmb u},t)$ provides coefficients positively related to users\u2019 embedding scales. To avoid training instability caused by extreme scale values, we map $c({\\pmb u},t)$ into the interval $(0,1)$ , ", "page_idx": 5}, {"type": "text", "text": "defined by: ", "page_idx": 6}, {"type": "equation", "text": "$$\nc(\\pmb{u},t)=\\mathrm{sig}\\left(\\frac{\\|\\pmb{u}_{(t)}\\|-\\overline{{\\|\\pmb{u}_{(t)}\\|}}}{\\|\\pmb{u}_{(t)}\\|}\\right),\n$$", "text_format": "latex", "page_idx": 6}, {"type": "text", "text": "where $\\overline{{\\|\\boldsymbol{u}_{(t)}\\|}}$ represents the average norm of all user embeddings at epoch $t$ , and $\\mathrm{sig}(\\cdot)$ denotes the sigmoid function. Consequently, the loss function for our method, Personalized Magnitude Adversarial Collaborative Filtering (PamaCF), is defined as: ", "page_idx": 6}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\mathcal{L}_{\\operatorname{PamaCF}}(\\Theta)=\\mathcal{L}(\\Theta)+\\lambda\\mathcal{L}(\\Theta+\\Delta^{\\operatorname{PamaCF}}),\\quad}\\\\ {\\mathrm{where}\\quad\\Delta^{\\operatorname{PamaCF}}=\\arg\\operatorname*{max}_{\\Delta,\\,\\|\\Delta_{u}\\|\\leq\\rho\\cdot c(u,t)}\\mathcal{L}(\\Theta+\\Delta),}\\end{array}\n$$", "text_format": "latex", "page_idx": 6}, {"type": "text", "text": "where $\\lambda$ is the weight of adversarial training, $\\rho$ represents the uniform perturbation magnitude for all users, and $\\Delta_{u}$ is the perturbation relative to user $u$ . To maximize the perturbation magnitude for each user within $\\rho c(\\pmb{u},t)$ , we use the perturbation along the gradient direction of the user\u2019s adversarial loss with a step length of $\\rho c(\\pmb{u},t)$ as $\\Delta_{u}$ . The specific algorithm process is detailed in Appendix B. ", "page_idx": 6}, {"type": "text", "text": "5 Experiments ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "In this section, we conduct extensive experiments to address the following research questions (RQs): ", "page_idx": 6}, {"type": "text", "text": "\u2022 RQ1: Can PamaCF further improve the performance and robustness of traditional ACF?   \n\u2022 RQ2: Why does PamaCF perform better than traditional ACF?   \n\u2022 RQ3: How do hyper-parameters affect PamaCF? ", "page_idx": 6}, {"type": "text", "text": "5.1 Experimental Setup ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "In this section, we briefly introduce the experimental settings. For detailed information, including dataset preprocessing, comprehensive baseline descriptions, and implementation details, please refer to Appendix C.1. ", "page_idx": 6}, {"type": "text", "text": "Datasets. We employ three common benchmarks: the Gowalla check-in dataset [32], the Yelp2018 business dataset, and the MIND news recommendation dataset [33]. ", "page_idx": 6}, {"type": "text", "text": "Attack Methods. We employ both heuristic (Random Attack [30], Bandwagon Attack [34]) and optimization-based (Rev Attack [7], DP Attack [6]) attack methods within a black-box context, where the attacker does not have access to the internal architecture or parameters of the target model. ", "page_idx": 6}, {"type": "text", "text": "Defense Baselines. We incorporate a variety of defense methods, including detection-based approaches (GraphRf i[12] and LLM4Dec [13]), adversarial collaborative flitering methods (APR [15] and SharpCF [20]), and a denoise-based strategy (StDenoise [35, 19]). In our study, we employ three common backbone recommendation models, Matrix Factorization (MF) [2], LightGCN [3], and NeurMF [36]. ", "page_idx": 6}, {"type": "text", "text": "Evaluation Metrics. The primary metrics for assessing recommendation performance are the top- $k$ metrics: Recall $@k$ and $\\mathrm{NDCG@\\mathcal{k}}$ , as documented in [3, 8, 37]. To quantify the success ratio of attacks, we utilize $\\mathrm{T}{\\mathrm{-}}\\mathrm{HR@}k$ and $\\mathrm{T-NDCG@\\mathcal{k}}$ to measure the performance of target items within the top- $k$ recommendations [7, 6, 13], as: ", "page_idx": 6}, {"type": "equation", "text": "$$\n\\mathrm{T}\\mathrm{-}\\mathrm{HR@}k=\\frac{1}{|\\mathcal{T}|}\\sum_{t a r\\in\\mathcal{T}}\\frac{\\sum_{u\\in\\mathcal{U}\\backslash\\mathcal{U}_{t a r}}\\mathbb{I}\\left(t a r\\in L_{u,1:k}\\right)}{|\\mathcal{U}\\backslash\\mathcal{U}_{t a r}|},\n$$", "text_format": "latex", "page_idx": 6}, {"type": "text", "text": "where $\\tau$ is the set of target items, $\\mathcal{U}_{t a r}$ denotes the set of genuine users who have interacted with target items tar, $L_{u,1:k}$ represents the top- ${\\cdot k}$ list of recommendations for user $u$ , and $\\mathbb{I}(\\cdot)$ is the indicator function that returns 1 if the condition is true. The $\\mathrm{T-NDCG}@k$ mirrors $\\mathrm{T}{\\mathrm{-}}\\mathrm{HR@}k$ , serving as the target item-specific version of $\\mathrm{NDCG@\\mathcal{k}}$ . ", "page_idx": 6}, {"type": "text", "text": "5.2 Performance Comparison (RQ1) ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "In this section, we answer RQ1. We focus on two key aspects: the recommendation performance and the robustness against poisoning attacks. ", "page_idx": 6}, {"type": "table", "img_path": "k8AYft5ED1/tmp/34730998c83883cc774c5ae99bf13f09b3ecd6b872fa6e449b561e7e072aa4ed.jpg", "table_caption": ["Table 1: Recommendation Performance "], "table_footnote": ["The Rev attack method could not be executed on the dataset due to memory constraints, resulting in an out-of-memory error. "], "page_idx": 7}, {"type": "table", "img_path": "k8AYft5ED1/tmp/2a29d3fabbb0813c4d90c548f01b011a5c35c3c9c4935d683bebf7f75b7cf2a9.jpg", "table_caption": ["Table 2: Robustness against target items promotion "], "table_footnote": ["1 Target Item Hit Ratio (Equation 7); T-HR $@50$ and T-NDCG@50 of all target items on clean datasets are 0.000. 2 The relative percentage increase of PamaCF\u2019s metrics to the best value of other baselines\u2019 metrics, i.e., (min ( $\\Gamma{\\mathrm{-HR}}_{\\mathrm{Beslines}}\\rangle$ ) \u2212 $\\mathrm{T-HR}_{\\mathrm{PamaCF}}\\}$ ) / $\\mathrm{min}$ (T-HRBeslines). Notably, only three decimal places are presented due to space limitations, though the actual ranking and calculations utilize the full precision of the data. "], "page_idx": 7}, {"type": "text", "text": "Recommendation Performance. We assess the efficacy of PamaCF in both clean and poisoning data contexts, focusing on the performance of recommender systems, as presented in Table 1. The denoise-based defense method, which does not directly defend against poisoning attacks but rather purifies noisy interactions, fails to improve recommendation performance in most cases. Detectionbased methods, such as GraphRf iand LLM4Dec, exhibit some misclassifications of fake and genuine users, leading to a decline in recommendation performance. ", "page_idx": 7}, {"type": "text", "text": "In contrast, we observe a notable enhancement in recommendation quality when ACF methods (APR, SharpCF, and PamaCF) are utilized. This finding is consistent with results from previous studies [15, 20] and aligns with our prior theoretical analysis. Among the defense methods, PamaCF stands out, achieving the most significant improvements in recommendation performance compared to the backbone model and other baseline approaches. Specifically, PamaCF increases Recall $@20$ and $\\mathrm{NDCG@20}$ by $13.84\\%$ and $22.04\\%$ in average, respectively, compared to the backbone model. ", "page_idx": 7}, {"type": "text", "text": "Robustness Against Poisoning Attacks. We evaluate the capability of PamaCF in defending against poisoning attacks by examining the attack success ratio. Our experiments specifically target items with notably low popularity, as indicated by T-HR $@50$ and T-NDCG $@50$ scores of 0.0 when no attacks are present. Lower scores for T-HR@50 and T-NDCG $@50$ indicate stronger defense capabilities. ", "page_idx": 7}, {"type": "text", "text": "Table 2 presents the results, indicating that the purely denoise-based defense method is generally ineffective against most attacks and may even increase the attack\u2019s success ratio in some instances. ", "page_idx": 7}, {"type": "image", "img_path": "k8AYft5ED1/tmp/af38300f9945eea20d1d77afac5ea445ce28b6744fe3b4ca6ccbf929121c181c.jpg", "img_caption": ["Figure 2: (a) PamaCF brings real preference items closer; (b) PamaCF achieves larger magnitudes. "], "img_footnote": [], "page_idx": 8}, {"type": "image", "img_path": "k8AYft5ED1/tmp/1d71db297b0667eca491191bdc3649e3a29bf6570c0eae493b333a48f586f5df.jpg", "img_caption": ["Figure 3: Left: Analysis of Hyper-Parameters $\\rho$ ; Right: Analysis of Hyper-Parameters $\\lambda$ . "], "img_footnote": [], "page_idx": 8}, {"type": "text", "text": "Detection-based methods, such as GraphRfi and LLM4Dec, show robust defense against attacks similar to their training data, i.e., random attacks. However, the effectiveness of GraphRf ideclines against other attack types. In contrast, ACF methods demonstrate stable defense capabilities across various attacks. Specifically, PamaCF significantly reduces the success ratio of attacks, decreasing T-HR $@50$ and $\\mathrm{T-NDCG@50}$ by $49.92\\%$ and $43.73\\%$ in average, respectively, compared to the best baseline. These results highlight PamaCF\u2019s advanced defense capabilities against various attacks. ", "page_idx": 8}, {"type": "text", "text": "Additionally, PamaCF\u2019s defense effectiveness against attacks targeting popular items is further evaluated. The corresponding results for LightGCN [3] and NeuMF [36], along with the recommendation performance at top-10, are also presented. All supplementary results are in Appendix C.2. ", "page_idx": 8}, {"type": "text", "text": "5.3 Augmentation Analysis (RQ2) ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "In this section, we address RQ2 by exploring why PamaCF can outperform traditional ACF (especially APR [15]) through embedding visualization and perturbation magnitude comparison. ", "page_idx": 8}, {"type": "text", "text": "Embedding Visualization. We randomly select a user and project the normalized embeddings of the user, real preference items, the target item given by attacks, and other items in the user\u2019s top-10 recommendation list into a two-dimensional space using T-SNE [38], as shown in Figure 2(a). We observe that PamaCF can bring real preference items closer, reducing the distance from the farthest real preference item from 0.736 to 0.365, while leading the target item farther away from all the real preference items. PamaCF\u2019s personalized perturbation magnitude lowers the ranking of both the target item and other items, thus improving robustness and performance. ", "page_idx": 8}, {"type": "text", "text": "Perturbation Magnitude Comparison. We compare the maximum perturbation magnitudes of APR and PamaCF, i.e., $\\epsilon$ in Equation 1 for APR and $\\rho$ in Equation 6 for PamaCF. Both $\\epsilon$ and $\\rho$ are selected through hyper-parameter tuning from $\\{0.1,0.2,\\ldots,1.0\\}$ . In the left part of Figure 2(b), we observe that PamaCF finds a higher perturbation magnitude. Additionally, the right portion of Figure 2(b) illustrates the distribution of personalized perturbation magnitudes across all users. These varying magnitudes for different users contribute to the improved effectiveness of PamaCF. ", "page_idx": 8}, {"type": "text", "text": "5.4 Hyper-Parameters Analysis (RQ3) ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "In this section, we answer RQ3 by exploring the effects of the hyperparameters, magnitude $\\rho$ and adversarial training weight $\\lambda$ , as defined in Equation 6. The results are illustrated in Figure 3. ", "page_idx": 8}, {"type": "text", "text": "Analysis of Hyper-Parameters $\\rho$ . With $\\lambda$ fixed at 1.0, we vary $\\rho$ from 0.1 to 1.0 in increments of 0.1. Our findings demonstrate a significant improvement in both robustness and performance as $\\rho$ increases. Notably, even when $\\rho$ exceeds 0.1, there is an enhancement in recommendation performance compared to that of the backbone model, i.e., MF, with the range between 0.7 and 0.9 yielding the most significant enhancements. ", "page_idx": 8}, {"type": "text", "text": "", "page_idx": 9}, {"type": "text", "text": "Analysis of Hyper-Parameters $\\lambda$ . With $\\rho$ set at 0.9, we adjust $\\lambda$ from 0.2 to 2.0 in increments of 0.2.   \nThe analysis indicates that the defensive ability becomes stable once $\\lambda$ surpasses 1.0 in most attacks.   \nHowever, setting $\\lambda$ too high gradually diminishes the recommendation performance of PamaCF.   \nDespite this, the performance of PamaCF remains considerably improved compared to MF. ", "page_idx": 9}, {"type": "text", "text": "6 Conclusion ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "In this work, we theoretically analyze why Adversarial Collaborative Filtering (ACF) enhances both the performance and robustness of Collaborative Filtering (CF) systems against poisoning attacks. Additionally, by establishing bounds for reductions in recommendation error during ACF\u2019s optimization process, we discover that applying personalized perturbation magnitudes for users based on their embedding scales can significantly improve ACF\u2019s effectiveness. Leveraging these theoretical understandings, we introduce Personalized Magnitude Adversarial Collaborative Filtering (PamaCF). Comprehensive experiments confirm that PamaCF effectively defends against various attacks and significantly enhances the quality of recommendations. ", "page_idx": 9}, {"type": "text", "text": "Limitations. Our study identifies several limitations that require further investigation. Firstly, our theoretical analysis is based on certain assumptions, specifically with the Gaussian Recommender System. We intend to relax these assumptions in future work. Secondly, this study only examines adversarial training within CF recommendations. In future research, we plan to extend our analysis to include more recommendation scenarios, such as sequential recommendations. ", "page_idx": 9}, {"type": "text", "text": "Broader Impacts. Our work focuses on enhancing both the performance and robustness of recommender systems against poisoning attacks, thereby beneftiing the overall development of recommender systems. We do not foresee any negative impacts resulting from our work. ", "page_idx": 9}, {"type": "text", "text": "Acknowledgements ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "This work is funded by the National Key R&D Program of China (2022YFB3103700, 2022YFB3103701), the Strategic Priority Research Program of the Chinese Academy of Sciences under Grant No. XDB0680101, and the National Natural Science Foundation of China under Grant Nos. 62102402, 62272125, U21B2046. Huawei Shen is also supported by Beijing Academy of Artificial Intelligence (BAAI). ", "page_idx": 9}, {"type": "text", "text": "References ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "[1] Xiaoyuan Su and Taghi M Khoshgoftaar. A survey of collaborative filtering techniques. Advances in Artificial Intelligence, 2009, 2009.   \n[2] Yehuda Koren, Robert Bell, and Chris Volinsky. Matrix factorization techniques for recommender systems. Computer, 42(8):30\u201337, 2009.   \n[3] Xiangnan He, Kuan Deng, Xiang Wang, Yan Li, YongDong Zhang, and Meng Wang. Lightgcn - Simplifying and Powering Graph Convolution Network for Recommendation. In Proceedings of the 43rd International ACM SIGIR Conference on Research and Development in Information Retrieval, pages 639\u2013648. ACM, 2020.   \n[4] Brent Smith and Greg Linden. Two decades of recommender systems at amazon.com. IEEE Internet Computing, 21(3):12\u201318, 2017.   \n[5] Carlos A Gomez-Uribe and Neil Hunt. The netfilx recommender system: Algorithms, business value, and innovation. ACM Transactions on Management Information Systems, 6(4):1\u201319, 2015.   \n[6] Hai Huang, Jiaming Mu, Neil Zhenqiang Gong, Qi Li, Bin Liu, and Mingwei Xu. Data Poisoning Attacks to Deep Learning Based Recommender Systems. In Proceedings 2021 Network and Distributed System Security Symposium, 2021.   \n[7] Jiaxi Tang, Hongyi Wen, and Ke Wang. Revisiting adversarially learned injection attacks against recommender systems. In Proceedings of the 14th ACM Conference on Recommender Systems, pages 318\u2013327, 2020.   \n[8] Kaike Zhang, Qi Cao, Fei Sun, Yunfan Wu, Shuchang Tao, Huawei Shen, and Xueqi Cheng. Robust recommender system: A survey and future directions. arXiv preprint arXiv:2309.02057, 2023.   \n[9] Chen-Yao Chung, Ping-Yu Hsu, and Shih-Hsiang Huang. \u03b2p: A novel approach to filter out malicious rating rroflies from recommender systems. Decision Support Systems, 55(1):314\u2013325, 2013.   \n[10] Fuzhi Zhang and Quanqiang Zhou. Hht\u2013SVM: An online method for detecting proflie injection attacks in collaborative recommender systems. Knowledge-Based Systems, 65:96\u2013105, 2014.   \n[11] Zhihai Yang, Lin Xu, Zhongmin Cai, and Zongben Xu. Re-scale AdaBoost for attack detection in collaborative filtering recommender systems. Knowledge-Based Systems, 100:74\u201388, 2016.   \n[12] Shijie Zhang, Hongzhi Yin, Tong Chen, Quoc Viet Nguyen Hung, Zi Huang, and Lizhen Cui. Gcn-Based User Representation Learning for Unifying Robust Recommendation and Fraudster Detection. In Proceedings of the 43rd International ACM SIGIR Conference on Research and Development in Information Retrieval, pages 689\u2013698, 2020.   \n[13] Kaike Zhang, Qi Cao, Yunfan Wu, Fei Sun, Huawei Shen, and Xueqi Cheng. Lorec: Combating poisons with large language model for robust sequential recommendation. In Proceedings of the 47th International ACM SIGIR Conference on Research and Development in Information Retrieval, pages 1733\u20131742, 2024.   \n[14] Yuli Liu. Recommending Inferior Results: A General and Feature-Free Model for Spam Detection. In Proceedings of the 29th ACM International Conference on Information and Knowledge Management, pages 955\u2013974, 2020.   \n[15] Xiangnan He, Zhankui He, Xiaoyu Du, and Tat-Seng Chua. Adversarial Personalized Ranking for Recommendation. In The 41st International ACM SIGIR Conference on Research and Development in Information Retrieval, pages 355\u2013364, 2018.   \n[16] Huiyuan Chen and Jing Li. Adversarial tensor factorization for context-aware recommendation. In Proceedings of the 13th ACM Conference on Recommender Systems, pages 363\u2013367, 2019.   \n[17] Ruirui Li, Xian Wu, and Wei Wang. Adversarial learning to compare: Self-attentive prospective customer recommendation in location based social networks. In Proceedings of the 13th International Conference on Web Search and Data Mining, pages 349\u2013357, 2020.   \n[18] Chenwang Wu, Defu Lian, Yong Ge, Zhihao Zhu, Enhong Chen, and Senchao Yuan. Fight Fire with Fire: Towards Robust Recommender Systems via Adversarial Poisoning Training. In Proceedings of the 44th International ACM SIGIR Conference on Research and Development in Information Retrieval, pages 1074\u20131083, 2021.   \n[19] Haibo Ye, Xinjie Li, Yuan Yao, and Hanghang Tong. Towards robust neural graph collaborative flitering via structure denoising and embedding perturbation. ACM Transactions on Information Systems, 41(3):1\u201328, 2023.   \n[20] Huiyuan Chen, Xiaoting Li, Vivian Lai, Chin-Chia Michael Yeh, Yujie Fan, Yan Zheng, Mahashweta Das, and Hao Yang. Adversarial Collaborative Filtering for Free. In Proceedings of the 17th ACM Conference on Recommender Systems, pages 245\u2013255. ACM, 2023.   \n[21] Naman Deep Singh, Francesco Croce, and Matthias Hein. Revisiting adversarial training for imagenet: Architectures, training and generalization across threat models. In Advances in Neural Information Processing Systems, volume 36, pages 13931\u201313955, 2024.   \n[22] Florian Tram\u00e8r, Alexey Kurakin, Nicolas Papernot, Ian Goodfellow, Dan Boneh, and Patrick McDaniel. Ensemble adversarial training: Attacks and defenses. arXiv preprint arXiv:1705.07204, 2017.   \n[23] Yian Deng and Tingting Mu. Understanding and improving ensemble adversarial defense. In Advances in Neural Information Processing Systems, volume 36, pages 58075\u201358087, 2023.   \n[24] Florian Tramer and Dan Boneh. Adversarial training and robustness for multiple perturbations. In Advances in Neural Information Processing Systems, volume 32, 2019.   \n[25] Cheng-Hsin Weng, Yan-Ting Lee, and Shan-Hung Brandon Wu. On the trade-off between adversarial and backdoor robustness. In Advances in Neural Information Processing Systems, volume 33, pages 11973\u201311983, 2020.   \n[26] Hongyang Zhang, Yaodong Yu, Jiantao Jiao, Eric Xing, Laurent El Ghaoui, and Michael Jordan. Theoretically principled trade-off between robustness and accuracy. In International Conference on Machine Learning, pages 7472\u20137482. PMLR, 2019.   \n[27] Kaike Zhang, Qi Cao, Yunfan Wu, Fei Sun, Huawei Shen, and Xueqi Cheng. Improving the shortest plank: Vulnerability-aware adversarial training for robust recommender system. In Proceedings of the 18th ACM Conference on Recommender Systems, pages 680\u2013689, 2024.   \n[28] Ludwig Schmidt, Shibani Santurkar, Dimitris Tsipras, Kunal Talwar, and Aleksander Madry. Adversarially robust generalization requires more data. In S. Bengio, H. Wallach, H. Larochelle, K. Grauman, N. Cesa-Bianchi, and R. Garnett, editors, Advances in Neural Information Processing Systems, volume 31, 2018.   \n[29] Haoyang LI, Shimin DI, and Lei Chen. Revisiting Injective Attacks on Recommender Systems. In Conference on Neural Information Processing Systems (NeurIPS), volume 35, pages 29989\u2013 30002, 2022.   \n[30] Shyong K Lam and John Riedl. Shilling recommender systems for fun and profti. In Proceedings of the 13th International Conference on World Wide Web, pages 393\u2013402, 2004.   \n[31] Steffen Rendle, Christoph Freudenthaler, Zeno Gantner, and Lars Schmidt-Thieme. Bpr: Bayesian personalized ranking from implicit feedback. In Proceedings of the Twenty-Fifth Conference on Uncertainty in Artificial Intelligence, pages 452\u2013461, 2009.   \n[32] Dawen Liang, Laurent Charlin, James McInerney, and David M Blei. Modeling user exposure in recommendation. In Proceedings of the 25th International Conference on World Wide Web, pages 951\u2013961, 2016.   \n[33] Fangzhao Wu, Ying Qiao, Jiun-Hung Chen, Chuhan Wu, Tao Qi, Jianxun Lian, Danyang Liu, Xing Xie, Jianfeng Gao, Winnie Wu, et al. Mind: A large-scale dataset for news recommendation. In Proceedings of the 58th Annual Meeting of the Association for Computational Linguistics, pages 3597\u20133606, 2020.   \n[34] Robin Burke, Bamshad Mobasher, and Runa Bhaumik. Limited knowledge shilling attacks in collaborative filtering systems. In Proceedings of 3rd International Workshop on Intelligent Techniques for Web Personalization, 19th International Joint Conference on Artificial Intelligence, pages 17\u201324, 2005.   \n[35] Changxin Tian, Yuexiang Xie, Yaliang Li, Nan Yang, and Wayne Xin Zhao. Learning to Denoise Unreliable Interactions for Graph Collaborative Filtering. In Proceedings of the 45th International ACM SIGIR Conference on Research and Development in Information Retrieval, pages 122\u2013132, 2022.   \n[36] Xiangnan He, Lizi Liao, Hanwang Zhang, Liqiang Nie, Xia Hu, and Tat-Seng Chua. Neural collaborative flitering. In Proceedings of the 26th International Conference on World Wide Web, pages 173\u2013182, 2017.   \n[37] Xiang Wang, Xiangnan He, Meng Wang, Fuli Feng, and Tat-Seng Chua. Neural graph collaborative filtering. In Proceedings of the 42nd international ACM SIGIR Conference on Research and Development in Information Retrieval, pages 165\u2013174, 2019.   \n[38] Laurens Van der Maaten and Geoffrey Hinton. Visualizing data using t-sne. Journal of Machine Learning Research, 9(11), 2008.   \n[39] Paul Covington, Jay Adams, and Emre Sargin. Deep neural networks for youtube recommendations. In Proceedings of the 10th ACM Conference on Recommender Systems, pages 191\u2013198, 2016.   \n[40] Rex Ying, Ruining He, Kaifeng Chen, Pong Eksombatchai, William L Hamilton, and Jure Leskovec. Graph convolutional neural networks for web-scale recommender systems. In Proceedings of the 24th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining, pages 974\u2013983, 2018.   \n[41] Yehuda Koren, Steffen Rendle, and Robert Bell. Advances in collaborative filtering. Recommender Systems Handbook, pages 91\u2013142, 2021.   \n[42] Hao Wang, Naiyan Wang, and Dit-Yan Yeung. Collaborative deep learning for recommender systems. In Proceedings of the 21th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining, pages 1235\u20131244, 2015.   \n[43] Bamshad Mobasher, Robin Burke, Runa Bhaumik, and Chad Williams. Toward trustworthy recommender systems: An analysis of attack models and algorithm robustness. ACM Transactions on Internet Technology, 7(4):23\u2013es, 2007.   \n[44] Carlos E Seminario and David C Wilson. Attacking item-based recommender systems with power items. In Proceedings of the 8th ACM Conference on Recommender Systems, pages 57\u201364, 2014.   \n[45] Bo Li, Yining Wang, Aarti Singh, and Yevgeniy Vorobeychik. Data poisoning attacks on factorization-based collaborative filtering. In Advances in Neural Information Processing Systems, volume 29, 2016.   \n[46] Chenwang Wu, Defu Lian, Yong Ge, Zhihao Zhu, and Enhong Chen. Triple adversarial learning for influence-based poisoning attack in recommender systems. In Proceedings of the 27th ACM SIGKDD Conference on Knowledge Discovery and Data Mining, pages 1830\u20131840, 2021.   \n[47] Jingfan Chen, Wenqi Fan, Guanghui Zhu, Xiangyu Zhao, Chunfeng Yuan, Qing Li, and Yihua Huang. Knowledge-enhanced black-box attacks for recommendations. In Proceedings of the 28th ACM SIGKDD Conference on Knowledge Discovery and Data Mining, pages 108\u2013117, 2022.   \n[48] Fulan Qian, Bei Yuan, Hai Chen, Jie Chen, Defu Lian, and Shu Zhao. Enhancing the transferability of adversarial examples based on nesterov momentum for recommendation systems. IEEE Transactions on Big Data, 2023.   \n[49] Yanling Wang, Yuchen Liu, Qian Wang, Cong Wang, and Chenliang Li. Poisoning selfsupervised learning based sequential recommendations. In Proceedings of the 46th International ACM SIGIR Conference on Research and Development in Information Retrieval, pages 300\u2013310, 2023.   \n[50] Ziheng Chen, Fabrizio Silvestri, Jia Wang, Yongfeng Zhang, and Gabriele Tolomei. The dark side of explanations: Poisoning recommender systems with counterfactual examples. arXiv preprint arXiv:2305.00574, 2023.   \n[51] Chengzhi Huang and Hui Li. Single-user injection for invisible shilling attack against recommender systems. In Proceedings of the 32nd ACM International Conference on Information and Knowledge Management, pages 864\u2013873, 2023.   \n[52] Yunfan Wu, Qi Cao, Shuchang Tao, Kaike Zhang, Fei Sun, and Huawei Shen. Accelerating the surrogate retraining for poisoning attacks against recommender systems. In Proceedings of the 18th ACM Conference on Recommender Systems, pages 701\u2013711, 2024.   \n[53] Paul-Alexandru Chirita, Wolfgang Nejdl, and Cristian Zamfir. Preventing shilling attacks in online recommender systems. In Proceedings of the 7th Annual ACM International Workshop on Web Information and Data Management, pages 67\u201374, 2005. ", "page_idx": 9}, {"type": "text", "text": "", "page_idx": 10}, {"type": "text", "text": "", "page_idx": 11}, {"type": "text", "text": "", "page_idx": 12}, {"type": "text", "text": "A Related Work ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "A.1 Collaborative Filtering ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "Collaborative Filtering (CF) has become a cornerstone of modern recommender systems, evidenced by its widespread application in various studies [3, 39, 40]. The fundamental premise of CF is that users with similar preferences are likely to exhibit similar behaviors, which can be leveraged to predict future recommendations [41]. A principal approach within CF is Matrix Factorization, which learns latent embeddings of users and items by decomposing the observed interaction matrix [2]. ", "page_idx": 13}, {"type": "text", "text": "With the advent of deep learning, neural CF models have emerged, designed to capture more complex patterns in user preferences. For example, CDL [42] merges auxiliary item information through neural networks into CF, addressing challenges associated with data sparsity. Additionally, NCF [36] replaces the traditional dot product with a neural network, enhancing the modeling of user-item interactions. More recently, Graph Neural Networks have prompted the development of graphbased CF models, such as NGCF [37] and LightGCN [3], which have shown remarkable efficacy in recommender systems. However, despite these technological advances, susceptibility to poisoning attacks remains a significant challenge, compromising the robustness of these systems [8]. ", "page_idx": 13}, {"type": "text", "text": "A.2 Poisoning Attacks against Recommender Systems ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "Poisoning attacks within recommender systems involve injecting fake users into the training data to manipulate the exposure of certain items. Initial research predominantly focused on rule-based heuristic attacks, where proflies for these fake users were constructed using predetermined heuristic rules [30, 34, 43, 44]. For example, the Random Attack [30] generated fake users interacting with targeted items alongside a random selection of other items. In contrast, the Bandwagon Attack [34] generated fake user interactions to include targeted items and others selected for their high popularity. ", "page_idx": 13}, {"type": "text", "text": "As the technique of attacks has evolved, recent studies have shifted towards optimization-based methods for generating fake users [7, 6, 29, 45, 46, 47, 48, 49, 50, 51, 52]. For instance, the Rev Attack [7] formalizes the attack as a bi-level optimization problem, addressed using gradient-based techniques. Similarly, the DP Attack [6] specifically targets deep learning-based recommender systems. ", "page_idx": 13}, {"type": "text", "text": "A.3 Robust Recommender Systems ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "Mainstream strategies for enhancing the robustness of CF systems against poisoning attacks broadly categorize into two main approaches [8]: (1) detecting and removing fake users [9, 10, 11, 12, 13, 14, 53], and (2) developing robust models via adversarial training, i.e., Adversarial Collaborative Filtering (ACF) [15, 16, 17, 18, 19, 20, 27]. ", "page_idx": 13}, {"type": "text", "text": "Detection-based strategies focus either on pre-identifying and removing potential fake users from the dataset [9, 10, 11, 14] or on mitigating their influence during the training phase [12, 13]. These methods often rely on specific assumptions about the attacks [9, 12] or require supervised data regarding attacks [10, 11, 12, 13]. Among these, LoRec [13] utilizes large language models to enhance sequential recommendations, overcoming the limitations associated with specific knowledge in detection-based strategies. However, its scope is limited to sequential recommender systems and may not generalize well across different CF scenarios. ", "page_idx": 13}, {"type": "text", "text": "Conversely, ACF methodologies, particularly those aligned with the Adversarial Personalized Ranking (APR) framework [15], integrate adversarial perturbations at the parameter level (i.e., user and item embeddings) during the model training process [15, 17, 19, 20]. This approach follows a \u201cminmax\u201d optimization paradigm, designed to minimize the error in recommendations under parameter perturbations which aim to maximize the error [13]. Besides, numerous studies have demonstrated that ACF not only enhances the model\u2019s robustness but also improves its recommendation performance [15, 20, 27]. Nonetheless, despite its beneftis in specific contexts through empirical validation, the intrinsic mechanisms of ACF\u2019s effectiveness and its universal applicability remain areas for further theoretical exploration. ", "page_idx": 13}, {"type": "text", "text": "Algorithm 1 The Training Procedure of PamaCF-BPR ", "page_idx": 14}, {"type": "text", "text": "Input: Training set $\\mathcal{D}$ , uniform perturbation magnitude $\\rho$ , adversarial training weight $\\lambda$ , pre-training epochs $T_{\\mathrm{pre}}$ , batch size $\\mathbb{B}$   \nOutput: Model parameters $\\boldsymbol{\\Theta}=[\\boldsymbol{U},\\boldsymbol{V}]$ .   \n1: Pre-train $\\boldsymbol{\\Theta}=[\\boldsymbol{U},\\boldsymbol{V}]$ for $T_{\\mathrm{pre}}$ epochs using Equation 8.   \n2: while stopping criteria not met do   \n3: Draw batch of $\\mathbb{B}$ pairs $(u,i,j)$ from $\\mathcal{D}$ .   \n4: for each $(u,i,j)$ in the batch do   \n5: Calculate $\\mathrm{\\ddot{\\Delta}_{}^{P a m a C F}},\\mathrm{\\Delta_{}^{P a m a C F}}$ , and $\\Delta_{j}^{\\mathrm{PamaCF}}$ using Equation 10.   \n6: Compute $\\mathcal{L}_{\\mathrm{PamaCF}}\\big((u,i,j)|\\Theta\\big)$ using Equation 9.   \n7: end for   \n8: Update $\\Theta$ using the aggregated gradients from $\\mathcal{L}_{\\mathrm{PamaCF}}(\\Theta)$ in the batch.   \n9: end while   \n10: return $\\boldsymbol{\\Theta}=[\\boldsymbol{U},\\boldsymbol{V}]$ ", "page_idx": 14}, {"type": "text", "text": "B Methodology ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "For clarity, we present the PamaCF version of the widely used Bayesian Personalized Ranking (BPR) [31] loss function, which optimizes recommender models towards personalized ranking. Given the user set $\\mathcal{U}\\,=\\,\\{u\\}$ , the item set $\\mathcal{V}=\\{v\\}$ , and the training set $\\bar{\\cal{D}}\\bar{\\doteq\\ }\\{(u,i,j)\\ |\\ u\\in\\bar{\\mathcal{U}}\\wedge i\\ \\in$ $\\mathcal{V}_{u}\\wedge j\\in\\mathcal{V}\\setminus\\mathcal{V}_{u}\\}$ , where $\\nu_{u}$ denotes the set of items with which user $u$ has interacted. The objective function (to be minimized) of BPR is formally given by: ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\mathcal{L}_{\\mathrm{BPR}}(\\Theta=[U,V])=-\\sum_{(u,i,j)\\in\\mathcal{D}}\\ln\\sigma\\left(\\langle U_{u},V_{i}\\rangle-\\langle U_{u},V_{j}\\rangle\\right),\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "where $U$ and $V$ represent the learned user and item embeddings, respectively. ", "page_idx": 14}, {"type": "text", "text": "The PamaCF version of the BPR loss function is defined as: ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\qquad\\qquad\\mathcal{L}_{\\mathrm{PamaCF}}(\\Theta)=\\!\\!\\mathcal{L}_{\\mathrm{BPR}}(\\Theta)+\\lambda\\mathcal{L}_{\\mathrm{BPR}}(\\Theta+\\Delta^{\\mathrm{PamaCF}}),}\\\\ &{\\!\\!\\!\\!\\mathrm{where}\\quad\\Delta^{\\mathrm{PamaCF}}=\\!\\arg\\!\\!\\!\\!\\!\\operatorname*{max}_{\\Delta,\\|\\Delta_{u/i/j}\\|\\leq\\rho\\cdot c(u,t),(u,i,j)\\in\\mathcal{D}}\\!\\!\\!\\mathcal{L}_{\\mathrm{BPR}}(\\Theta+\\Delta),}\\end{array}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "where $\\lambda$ is the weight of adversarial training, $\\rho$ represents the uniform perturbation magnitude for all users, and ", "page_idx": 14}, {"type": "equation", "text": "$$\nc(\\pmb{u},t)=\\mathrm{sig}\\left(\\frac{\\|\\pmb{u}_{(t)}\\|-\\overline{{\\|\\pmb{u}_{(t)}\\|}}}{\\|\\pmb{u}_{(t)}\\|}\\right).\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "The specific handling of a pair $(u,i,j)\\in\\mathcal{D}$ is expressed by: ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathcal{L}_{\\operatorname{PamaCF}}((u,i,j)|\\boldsymbol\\Theta)=-\\ln\\sigma\\left(\\langle U_{u},V_{i}\\rangle-\\langle U_{u},V_{j}\\rangle\\right)}\\\\ &{\\qquad-\\lambda\\ln\\sigma\\left(\\langle U_{u}+\\Delta_{u}^{\\operatorname{PamaCF}},V_{i}+\\Delta_{i}^{\\operatorname{PamaCF}}\\rangle-\\langle U_{u}+\\Delta_{u}^{\\operatorname{PamaCF}},V_{j}+\\Delta_{j}^{\\operatorname{PamaCF}}\\rangle\\right),}\\end{array}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "where ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\Delta_{u}^{\\mathrm{PamaCF}}=\\rho c(u,t)\\frac{\\Gamma_{u}}{\\left\\|\\Gamma_{u}\\right\\|},\\quad\\mathrm{where}\\quad\\Gamma_{u}=\\frac{\\partial\\mathcal{L}_{\\mathrm{BPR}}((u,i,j)|\\Theta+\\Delta^{\\mathrm{PamaCF}})}{\\partial\\Delta_{u}},}\\\\ &{\\Delta_{i}^{\\mathrm{PamaCF}}=\\rho c(u,t)\\frac{\\Gamma_{i}}{\\left\\|\\Gamma_{i}\\right\\|},\\quad\\mathrm{where}\\quad\\Gamma_{i}=\\frac{\\partial\\mathcal{L}_{\\mathrm{BPR}}((u,i,j)|\\Theta+\\Delta^{\\mathrm{PamaCF}})}{\\partial\\Delta_{i}},}\\\\ &{\\Delta_{j}^{\\mathrm{PamaCF}}=\\rho c(u,t)\\frac{\\Gamma_{i}}{\\left\\|\\Gamma_{j}\\right\\|},\\quad\\mathrm{where}\\quad\\Gamma_{j}=\\frac{\\partial\\mathcal{L}_{\\mathrm{BPR}}((u,i,j)|\\Theta+\\Delta^{\\mathrm{PamaCF}})}{\\partial\\Delta_{j}}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "The procedure of training with PamaCF is illustrated in Algorithm 1. ", "page_idx": 14}, {"type": "text", "text": "C Experiments ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "C.1 Supplements to Experimental Settings ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "Datasets. We employ three common benchmarks: the Gowalla check-in dataset [32], the Yelp2018   \nbusiness dataset, and the MIND news recommendation dataset [33]. The Gowalla and Yelp2018 ", "page_idx": 14}, {"type": "table", "img_path": "k8AYft5ED1/tmp/c64e1a02cd67f0365f90e5aef9750ed70f5b602584a71fb28dece5625ccb0624.jpg", "table_caption": ["Table 3: Dataset statistics "], "table_footnote": [], "page_idx": 15}, {"type": "text", "text": "datasets include interactions from all users. For the MIND dataset, we sample a subset of users following [13]. Following [3, 37], users and items with fewer than 10 interactions are excluded from our analysis. We allocate $80\\%$ of each user\u2019s historical interactions to the training set and the remainder for testing. Additionally, $10\\%$ of the interactions from the training set are randomly selected to form a validation set for hyperparameter tuning. Detailed statistics of the datasets are summarized in Table 3. ", "page_idx": 15}, {"type": "text", "text": "Attack Methods. We explore both heuristic (Random Attack [30], Bandwagon Attack [34]) and optimization-based (Rev Attack [7], DP Attack [6]) attack methods within a black-box context, where the attacker does not have access to the internal architecture or parameters of the target model. ", "page_idx": 15}, {"type": "text", "text": "\u2022 Random Attack (Heuristic Method) [30]: This method entails fake users including interactions with both the targeted items and a set of randomly chosen items.   \n\u2022 Bandwagon Attack (Heuristic Method) [34]: Fake users\u2019 interactions encompass the targeted items and those selected for their high popularity.   \n\u2022 DP Attack (Optimization-based Method) [6]: This approach is specifically designed to compromise deep learning-based recommender systems.   \n\u2022 Rev Attack (Optimization-based Method) [7]: The attack is conceptualized as a bi-level optimization problem, addressed through gradient-based methods. ", "page_idx": 15}, {"type": "text", "text": "Defense Baselines. We incorporate a variety of defense methods, including detection-based approaches (GraphRf i[12] and LLM4Dec [13]), adversarial collaborative flitering methods (APR [15] and SharpCF [20]), and a denoise-based strategy (StDenoise [35, 19]). In our study, we employ three common backbone recommendation models, MF [2], LightGCN [3], and NeurMF [36]. ", "page_idx": 15}, {"type": "text", "text": "\u2022 GraphRf i[12]: Employs a combination of Graph Convolutional Networks and Neural Random Forests for identifying fake users.   \n\u2022 LLM4Dec [13]: Utilizes an LLM-based framework for fake users detection.   \n\u2022 APR [15]: Generates parameter perturbations and integrates these perturbations into training.   \n\u2022 SharpCF [20]: Adopts a sharpness-aware minimization approach to refine the adversarial training process proposed by APR.   \n\u2022 StDenoise [35, 19]: Applies a structural denoising technique that leverages the similarity between $U_{u}$ and $V_{i}$ for each $(u,i)$ pair, aiding in the removal of noise, as described in [35, 19]. ", "page_idx": 15}, {"type": "text", "text": "Note that: With the need of item-side information, LLM4Dec is exclusively evaluated on the MIND dataset. Moreover, we observe that SharpCF, initially proposed for the MF model, exhibits unstable training performance when applied to the LightGCN model or the MIND dataset. Consequently, we present SharpCF results solely for the MF model on the Gowalla and Yelp2018 datasets. ", "page_idx": 15}, {"type": "text", "text": "Implementation Details. In our study, we employ three common backbone recommendation models, Matrix Factorization (MF) [2], LightGCN [3], and NeurMF [36]. To quantify the success ratio of attacks, we select $k\\,=\\,50$ as the evaluation metric following [6, 7, 18], while for assessing recommendation performance, we utilize $k=10$ , 20 following [3, 37]. For each attack setting, we conduct experiments five times, taking the average value as the result and the standard deviation as the error bar. The configuration of both the defense methods and the recommendation models involves selecting a learning rate from $\\{0.1,0.01,\\,.\\,.\\,.\\,,1\\times10^{-5}\\}$ , and a weight decay from {0, 0.1, $\\ldots,1\\times10^{-5}\\}$ . The implementation of GraphRf ifollows its paper. For the detection-based methods, we employ the Random Attack to generate supervised attack data. The magnitude parameter of adversarial perturbations in both APR and PamaCF is determined from a range of $\\{{\\overline{{0.1,0.2,\\ldots}}}\\}$ , 1.0}. In terms of attack methods, we set the attack budget to $1\\%$ and target five specific items. The hyperparameters align with those detailed in their original publications. ", "page_idx": 15}, {"type": "image", "img_path": "k8AYft5ED1/tmp/9e6ad4212d36ca64c7532520c07f6c905c4034e67d14ce57592c26e7abc7a611.jpg", "img_caption": ["Figure 4: Robustness against popular items promotion. "], "img_footnote": [], "page_idx": 16}, {"type": "table", "img_path": "k8AYft5ED1/tmp/ccebd5c9b20884aa29f6391b7301f288d04fcac4030b690e8cfb21964e63250e.jpg", "table_caption": ["Table 4: Robustness against target items promotion on Gowalla "], "table_footnote": ["1 Target Item Hit Ratio (Equation 7); T-HR@50 and $\\mathrm{T-NDCG}@50$ of all target items on clean datasets are 0.000. 2 The relative percentage increase of PamaCF\u2019s metrics to the best value of other baselines\u2019 metrics, i.e., $\\left(\\mathrm{min}\\left(\\mathrm{T-HR_{Beslines}}\\right)-\\mathrm{T-HR_{VAT}}\\right)/\\left.\\mathrm{min}(\\mathrm{T-HR_{Beslines}})\\right)$ Notably, only three decimal places are presented due to space limitations, though the actual ranking and calculations utilize the full precision of the data. 3 The Rev attack method could not be executed on the dataset due to memory constraints, resulting in an out-of-memory error. "], "page_idx": 16}, {"type": "text", "text": "Compute Resources. The experiments are conducted using two primary GPU: the RTX 4090 with 24GB of VRAM and the A800 with 80GB of VRAM. For most baseline defense methods applied across all datasets, a single RTX 4090 GPU suffices, requiring several hours per experiment. However, the LLM4Dec method [13] demands an A800 GPU due to its higher resource requirements for processing Large Language Models. In terms of attack generation, heuristic poisoning attacks such as the Random Attack [30] and Bandwagon Attack [34] are generated within seconds and do not require specific GPU resources. Conversely, the time required to generate optimization-based poisoning attacks, such as the DP Attack [6] and Rev Attack [7], depends on the dataset. For the Gowalla and Yelp datasets, these attacks take hours to execute on an A800 GPU. The DP Attack on the MIND dataset extends to several days, also utilizing an A800 GPU. However, the Rev Attack cannot be completed on a single A800 GPU due to its even greater computational demands. ", "page_idx": 16}, {"type": "text", "text": "C.2 Supplements to Performance Comparison ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "We assess PamaCF\u2019s defense capabilities against attacks targeting popular items on Gowalla. According to Figure 4, PamaCF exhibits strong defensibility, outperforming the best baseline even when attacks specifically promote popular items. ", "page_idx": 16}, {"type": "text", "text": "We also evaluate PamaCF\u2019s defense capabilities and recommendation performance when applied to LightGCN [3] and NeurMF [36], as shown in Table 4 and Table 5, which produces consistent results with MF [2]. ", "page_idx": 16}, {"type": "text", "text": "Additionally, we report PamaCF\u2019s recommendation performance on MF for the Gowalla dataset, specifically for $k\\,=\\,10$ , using Recall@10 and NDCG@10. PamaCF demonstrates significantly greater improvement at $k=10$ , achieving a $29.59\\%$ increase in Recall and a $56.41\\%$ increase in NDCG, relative to the baseline model, as shown in Table 6. ", "page_idx": 16}, {"type": "table", "img_path": "k8AYft5ED1/tmp/934169de2d7568f546575cc61f3154e81b130a8bd4cfb8a094d827d6120e33ad.jpg", "table_caption": ["Table 5: Recommendation Performance on Gowalla "], "table_footnote": ["The relative percentage increase of PamaCF\u2019s metrics to the best value of other baselines\u2019 metrics. Notably, only three decimal places are presented due to space limitations, though the actual ranking and calculations utilize the full precision of the data. "], "page_idx": 17}, {"type": "table", "img_path": "k8AYft5ED1/tmp/48833db404f73dd58b583cef59021489a5c41a75d2fc42faf842d3d88e1a87aa.jpg", "table_caption": ["Table 6: Recommendation Performance@10 on Gowalla "], "table_footnote": ["The relative percentage increase of PamaCF\u2019s metrics to the best value of other baselines\u2019 metrics. Notably, only three decimal places are presented due to space limitations, though the actual ranking and calculations utilize the full precision of the data. "], "page_idx": 17}, {"type": "text", "text": "D Proofs ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "D.1 Proofs for Section 3.1 ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "D.1.1 Proof of Theorem 1 ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "To investigate the recommendation error of each user during the training period, we first analyze how the item embeddings change. We discover a transformation function that accurately measures the change in the item embedding from its initial state to its state after a certain number of training epochs. This insight is formally expressed in the following proposition. ", "page_idx": 17}, {"type": "text", "text": "Proposition 1. Consider a Gaussian Recommender System $f_{(t)}$ , undergoing training for t epochs using the standard loss function specified in Equation 2. Given a learning rate $\\eta_{-}$ , there exists a function $M(t,\\eta):\\mathbb{N}^{+}\\times\\mathbb{R}^{+}\\rightarrow\\mathbb{R}^{+}$ that quantify the transformation of the item embedding due to training. Specifically, we have: ", "page_idx": 17}, {"type": "equation", "text": "$$\n\\pmb{v}_{(t)}=M(t,\\eta)\\pmb{v}_{(0)},\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "where ${\\pmb v}_{(0)}$ denotes the initial item embedding and $\\pmb{v}_{(t)}$ represents the item embedding after t epochs of training. ", "page_idx": 17}, {"type": "text", "text": "Proof of Proposition 1. Consider the training process of the Gaussian Recommender System $f_{(t)}$ over $t$ epochs, with each update through the standard loss outlined in Equation 2. The update mechanism for user and item embeddings at the $t^{\\mathrm{th}}$ epoch can be described as follows: ", "page_idx": 17}, {"type": "equation", "text": "$$\n\\begin{array}{l}{{\\pmb u}_{(t)}={\\pmb u}_{(t-1)}+{\\pmb\\eta}\\cdot r{\\pmb v}_{(t-1)},}\\\\ {{\\pmb v}_{(t)}={\\pmb v}_{(t-1)}+{\\pmb\\eta}\\cdot\\displaystyle\\sum_{({\\pmb u},r)\\in\\mathbb{Z}}r{\\pmb u}_{(t-1)}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 17}, {"type": "text", "text": "Considering the sum $\\sum_{({\\boldsymbol{u}},r)}r{\\boldsymbol{u}}_{(t-1)}$ , we have: ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\displaystyle\\sum_{(u,r)}r u_{(t-1)}=\\sum_{(u,r)}\\left(r u_{(t-2)}+\\eta r^{2}v_{(t-2)}\\right)}\\\\ &{\\quad\\quad\\quad\\quad=\\sum_{(u,r)}\\left(r u_{(t-3)}+\\eta\\left(v_{(t-2)}+v_{(t-3)}\\right)\\right)}\\\\ &{\\quad\\quad\\quad\\quad\\quad\\cdot\\dots}\\\\ &{\\quad\\quad\\quad\\quad=\\sum_{(u,r)}\\left(r u_{(0)}+\\eta\\sum_{j=0}^{t-2}v_{(j)}\\right)}\\\\ &{\\quad\\quad\\quad\\quad=\\alpha\\nu_{(0)}+n\\eta\\sum_{j=0}^{t-2}v_{(j)},}\\end{array}\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "where $n$ is the number of users. This leads to the recursive update for $\\pmb{v}_{(t)}$ ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathfrak{z}_{(t)}=\\!v_{(t-1)}+n\\eta v_{(0)}+n\\eta^{2}\\displaystyle\\sum_{j=0}^{t-2}v_{(j)}}\\\\ &{\\quad=\\!(1+n\\eta^{2})v_{(t-2)}+2n\\eta v_{(0)}+2n\\eta^{2}\\displaystyle\\sum_{j=0}^{t-3}v_{(j)}}\\\\ &{\\quad=\\!(1+n\\eta^{2}+2n\\eta^{2})v_{(t-3)}+\\big(n\\eta\\cdot(1+n\\eta^{2})+2n\\eta\\big)\\,v_{(0)}+\\big(n\\eta^{2}\\cdot(1+n\\eta^{2})+2n\\eta^{2}\\big)\\displaystyle\\sum_{j=0}^{t-4}v_{(j)}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "To simplify, we introduce $a(k),b(k)$ and $c(k)$ to represent the cumulative scaling factors as: ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{a(k)=\\left\\{\\begin{array}{l l}{1}&{k=1\\,,}\\\\ {a(k-1)+c(k-1)}&{k\\ge2\\,}\\end{array}\\right.}\\\\ &{b(k)=\\left\\{\\begin{array}{l l}{n\\eta}&{k=1\\,}\\\\ {n\\eta\\cdot a(k-1)+b(k-1)}&{k\\ge2\\,}\\end{array}\\right.,}\\\\ &{c(k)=\\left\\{\\begin{array}{l l}{n\\eta^{2}}&{k=1\\,}\\\\ {n\\eta^{2}\\cdot a(k-1)+c(k-1)}&{k\\ge2\\,}\\end{array}\\right.}\\end{array}\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "yielding a general form for $\\pmb{v}_{(t)}$ : ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\begin{array}{r l r}{\\lefteqn{\\pmb{v}_{(t)}=\\pmb{a}(k)\\pmb{v}_{(t-k)}+b(k)\\pmb{v}_{(0)}+c(k)\\sum_{j=0}^{t-k-1}\\pmb{v}_{(j)}}}\\\\ &{}&{=\\pmb{a}(t-1)\\pmb{v}_{(1)}+b(t-1)\\pmb{v}_{(0)}+c(t-1)\\pmb{v}_{(0)}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "Based on ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\pmb{v}_{(1)}=\\pmb{v}_{(0)}+\\eta\\sum_{(\\pmb{u},r)\\in\\mathbb{Z}}r\\pmb{u}_{(0)}=(1+n\\eta)\\pmb{v}_{(0)},\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "let $M(t,\\eta):\\mathbb{N}^{+}\\times\\mathbb{R}^{+}\\rightarrow\\mathbb{R}^{+}$ be the transformation function related to training epochs $t$ and learning rate $\\eta$ , which is defined as: ", "page_idx": 18}, {"type": "equation", "text": "$$\nM(t,\\eta)=\\left\\{\\!\\!\\begin{array}{l l}{{1+n\\eta}}&{{t=1}}\\\\ {{(1+n\\eta)a(t-1)+b(t-1)+c(t-1)}}&{{t>1}}\\end{array}\\!\\!.\\right.\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "Then we can get: ", "page_idx": 18}, {"type": "equation", "text": "$$\n\\pmb{v}_{(t)}=M(t,\\eta)\\pmb{v}_{(0)}.\n$$", "text_format": "latex", "page_idx": 18}, {"type": "text", "text": "This proves that the item embedding $\\pmb{v}_{(t)}$ after $t$ epochs of training is a scaled version of the initial embedding $\\pmb{v}_{(0)}$ , with the scaling factor $M(t,\\eta)$ being a function of the number of epochs $t$ and the learning rate $\\eta$ . \u53e3 ", "page_idx": 18}, {"type": "text", "text": "Fact 1. Let $\\varepsilon\\in\\mathbb{R}^{d}$ be drawn from $\\mathcal{N}(\\mathbf{0},\\sigma^{2}I)$ , with $\\sigma>0$ . Let $\\pmb{w}\\in\\mathbb{R}^{d}$ represent any unit vector.   \nThen, $\\langle\\varepsilon,w\\rangle$ follows a normal distribution ${\\mathcal{N}}(0,\\sigma^{2})$ . ", "page_idx": 19}, {"type": "text", "text": "Proof of Fact $^{\\,I}$ . Consider $\\pmb\\varepsilon=[\\varepsilon_{1},\\ldots,\\varepsilon_{d}]$ , with each $\\varepsilon_{i}$ following ${\\mathcal{N}}(0,\\sigma^{2})$ . Let $\\pmb{w}=[w_{1},\\dots,w_{d}]$ , satisfying $w_{1}^{2}+\\cdot\\cdot\\cdot+w_{d}^{2}=1$ . Then $\\langle\\varepsilon,w\\rangle$ is distributed as $\\mathcal{N}\\left(\\mathbb{E}[\\langle\\pmb{\\varepsilon},\\pmb{w}\\rangle],\\mathbb{D}[\\langle\\pmb{\\varepsilon},\\pmb{w}\\rangle]\\right)$ , where: ", "page_idx": 19}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{E}[\\langle\\pmb{\\varepsilon},\\pmb{w}\\rangle]=\\mathbb{E}[\\varepsilon_{1}w_{1}+\\cdots+\\varepsilon_{d}w_{d}]=0,}\\\\ &{\\mathbb{D}[\\langle\\pmb{\\varepsilon},\\pmb{w}\\rangle]=\\mathbb{D}[\\varepsilon_{1}w_{1}+\\cdots+\\varepsilon_{d}w_{d}]}\\\\ &{\\qquad\\qquad=\\mathbb{D}[\\varepsilon_{1}w_{1}]+\\cdots+\\mathbb{D}[\\varepsilon_{d}w_{d}]}\\\\ &{\\qquad\\qquad=(w_{1}^{2}+\\cdots+w_{d}^{2})\\sigma^{2}}\\\\ &{\\qquad\\qquad=\\sigma^{2}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "Hence, Fact 1 is proved. ", "page_idx": 19}, {"type": "text", "text": "Proof of Theorem 1. By invoking Proposition 1, we establish the basis for evaluating the impact of training on the recommendation error at the $(t+1)^{\\mathrm{th}}$ epoch. Proposition 1 specifies the scaling relationship between the initial and trained item embeddings, leading to the following update expressions for user and item embeddings. For the standard loss though Equation 2, we have: ", "page_idx": 19}, {"type": "equation", "text": "$$\n\\begin{array}{l}{{\\pmb u}_{(t+1)}={\\pmb u}_{(t)}+\\eta r M(t,\\eta){\\pmb v}_{(0)},}\\\\ {{\\pmb v}_{(t+1)}=M(t+1,\\eta){\\pmb v}_{(0)}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "Considering the above update rules, the recommendation error at the $(t+1)^{\\mathrm{th}}$ epoch is given by: ", "page_idx": 19}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{P}_{v_{(0)}\\sim N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}\\left[f_{(t+1)}(u,v)\\neq r\\ |\\ (u,r)\\right]}\\\\ &{\\qquad\\qquad\\qquad=\\mathbb{P}_{v_{(0)}\\sim N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}\\left[r\\cdot\\langle u_{(t+1)},v_{(t+1)}\\rangle\\le0\\right]}\\\\ &{\\qquad\\qquad\\qquad=\\mathbb{P}_{v_{(0)}\\sim N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}\\left[r\\cdot\\left\\langle(u_{(t)}+\\eta r M(t,\\eta)v_{(0)})\\,,M(t+1,\\eta)v_{(0)}\\right\\rangle\\le0\\right]}\\\\ &{\\qquad\\qquad\\qquad=\\mathbb{P}_{v_{(0)}\\sim N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}\\left[r\\cdot\\left\\langle(u_{(t)}+\\eta r M(t,\\eta)v_{(0)})\\,,v_{(0)}\\right\\rangle\\le0\\right]}\\\\ &{\\qquad\\qquad\\qquad=\\mathbb{P}_{v_{(0)}\\sim N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}\\left[r\\cdot\\left\\langle u_{(t)},v_{(0)}\\right\\rangle\\le-\\eta M(t,\\eta)\\|v_{(0)}\\|^{2}\\right].}\\end{array}\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "For adversarial loss as detailed by Equation 1, we have: ", "page_idx": 19}, {"type": "equation", "text": "$$\n\\Delta_{\\mathrm{adv}}=\\arg\\operatorname*{max}_{\\Delta,\\|\\Delta\\|\\leq\\epsilon}\\mathcal{L}(\\Theta+\\Delta).\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "According to the first-order Taylor expansion, we have: ", "page_idx": 19}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\Delta_{\\mathrm{adv}}\\approx\\arg\\underset{\\Delta,\\|\\Delta\\|\\leq\\epsilon}{\\operatorname*{max}}\\mathcal{L}(\\Theta)+\\langle\\Delta,\\nabla_{\\Theta}\\mathcal{L}(\\Theta)\\rangle}\\\\ &{\\qquad=\\arg\\underset{\\Delta,\\|\\Delta\\|\\leq\\epsilon}{\\operatorname*{max}}\\langle\\Delta,\\nabla_{\\Theta}\\mathcal{L}(\\Theta)\\rangle}\\\\ &{\\qquad=\\!\\epsilon\\frac{\\nabla_{\\Theta}\\mathcal{L}(\\Theta)}{\\|\\nabla_{\\Theta}\\mathcal{L}(\\Theta)\\|},}\\end{array}\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "leading to specific perturbations $\\Delta_{u}$ and $\\Delta_{v}$ in Equation 3: ", "page_idx": 19}, {"type": "equation", "text": "$$\n\\begin{array}{l l}{\\Delta_{\\pmb{u}}=\\epsilon\\frac{\\Gamma_{v}}{\\left\\|\\Gamma_{\\pmb{u}}\\right\\|},\\quad\\mathrm{where}\\quad\\Gamma_{\\pmb{u}}=\\frac{\\partial\\mathcal{L}(\\pmb{u},\\pmb{v}|\\Theta)}{\\partial\\pmb{u}}=-r\\pmb{v},}\\\\ {\\Delta_{\\pmb{v}}=\\epsilon\\frac{\\Gamma_{v}}{\\left\\|\\Gamma_{v}\\right\\|},\\quad\\mathrm{where}\\quad\\Gamma_{\\pmb{v}}=\\frac{\\partial\\mathcal{L}(\\pmb{v},\\pmb{u}|\\Theta)}{\\partial\\pmb{v}}=-r\\pmb{u}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 19}, {"type": "text", "text": "Subsequently, the updated embeddings through adversarial loss are expressed as: ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{u_{(t+1)}^{\\mathrm{sdr}}=u_{(t)}+\\eta\\cdot\\left(r v_{(t)}+\\lambda r\\left(v_{(t)}-\\epsilon\\frac{r v_{(t)}}{\\|u_{(t)}\\|}\\right)\\right)}\\\\ &{\\quad\\quad=u_{(t)}+\\eta(1+\\lambda)r v_{(t)}-\\eta\\lambda\\frac{u_{(t)}}{\\|u_{(t)}\\|}}\\\\ &{\\quad\\quad=\\left(1-\\frac{\\eta\\lambda\\epsilon}{\\|u_{(t)}\\|}\\right)u_{(t)}+\\eta(1+\\lambda)r\\cdot M(t,\\eta)v_{(0)}}\\\\ &{\\quad\\quad\\overset{v=u_{(t)}^{\\mathrm{sdr}}}{\\quad\\cap_{(t+1)}^{\\mathrm{sdr}}}=v_{(t)}+\\eta\\cdot\\left(\\sum r^{\\mathrm{su}_{(t)}}+\\lambda\\sum r\\left(u_{(t)}-\\epsilon\\frac{r v_{(t)}}{\\|v_{(t)}\\|}\\right)\\right)}\\\\ &{\\quad\\quad\\quad=v_{(t)}+\\eta(1+\\lambda)\\sum r^{\\mathrm{su}_{(t)}}-\\frac{m\\eta\\lambda\\epsilon}{\\|v_{(t)}\\|}}\\\\ &{\\quad\\quad\\quad=\\left(M(t,\\eta)+n\\eta(1+\\lambda)\\left(1+\\eta+\\eta\\sum_{j=1}^{n}M(j,\\eta)\\right)-\\frac{n\\eta\\lambda\\epsilon}{\\|v_{(0)}\\|}\\right)v_{(0)}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "Given $\\|\\bar{\\pmb{u}}\\|\\quad\\gg\\quad\\sigma.$ , we can approximate $\\Vert\\pmb{v}_{(0)}\\Vert$ with $\\mathbb{E}[\\|\\pmb{v}_{(0)}\\|]$ . Given $\\epsilon\\mathrm{~\\ensuremath~{~\\K~}~}$ $\\frac{\\operatorname*{min}(\\|\\pmb{u}_{(t)}\\|,\\|\\bar{\\pmb{u}}\\|)}{\\eta\\lambda}$ , according to the expansion of $M(t,\\eta)$ in Proposition 1, it follows that $\\begin{array}{r}{\\left(M(t,\\overset{.}{\\eta})+n\\eta(1+\\lambda)\\left(1+\\eta+\\eta\\sum_{j=1}^{t-1}M(j,\\eta)\\right)-\\frac{n\\eta\\lambda\\epsilon}{\\|\\mathfrak{v}_{(0)}\\|}\\right)>0.}\\end{array}$ Considering these update rules, the recommendation error at the $(t+1)^{\\mathrm{th}}$ epoch is determined by: ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{\\lefteqn{\\mathrm{\\bf~s}_{\\tau(0)}^{\\mathrm{\\,adv}}\\sim\\!\\!N(\\bar{\\mathbf{u}},\\frac{\\sigma^{2}}{n-1}I)\\left[f(t+1)(\\boldsymbol{u},\\boldsymbol{v})\\neq\\boldsymbol{r}\\mid(\\boldsymbol{u},\\boldsymbol{r})\\right]}}\\\\ &{=\\mathbb{P}_{\\mathfrak{v}_{(0)}\\sim\\mathcal{N}(\\bar{\\mathbf{u}},\\frac{\\sigma^{2}}{n-1}I)}\\left[\\boldsymbol{r}\\cdot\\langle\\boldsymbol{u}_{(t+1)}^{\\mathrm{\\,adv}},\\boldsymbol{v}_{(t+1)}^{\\mathrm{\\,adv}}\\rangle\\leq0\\right]}\\\\ &{=\\mathbb{P}_{\\mathfrak{v}_{(0)}\\sim\\mathcal{N}(\\bar{\\mathbf{u}},\\frac{\\sigma^{2}}{n-1}I)}\\left[\\boldsymbol{r}\\cdot\\langle\\left(\\left(1-\\frac{\\eta\\lambda\\epsilon}{\\left\\lVert u_{(t)}\\right\\rVert}\\right)\\boldsymbol{u}_{(t)}+\\eta(1+\\lambda)\\boldsymbol{r}\\cdot M(t,\\eta)\\mathfrak{v}_{(0)}\\right),\\boldsymbol{v}_{(0)}\\rangle:\\right.}\\\\ &{=\\mathbb{P}_{\\mathfrak{v}_{(0)}\\sim\\mathcal{N}(\\bar{\\mathbf{u}},\\frac{\\sigma^{2}}{n-1}I)}\\left[\\boldsymbol{r}\\cdot\\langle\\left(1-\\frac{\\eta\\lambda\\epsilon}{\\left\\lVert u_{(t)}\\right\\rVert}\\right)\\boldsymbol{u}_{(t)},\\boldsymbol{v}_{(0)}\\rangle+\\eta(1+\\lambda)M(t,\\eta)\\langle\\boldsymbol{v}_{(0)},\\boldsymbol{v}_{(0)}\\rangle:\\right.}\\\\ &{\\left.=\\mathbb{P}_{\\mathfrak{v}_{(0)}\\sim\\mathcal{N}(\\bar{\\mathbf{u}},\\frac{\\sigma^{2}}{n-1}I)}\\left[\\boldsymbol{r}\\cdot\\langle\\left(1-\\frac{\\eta\\lambda\\epsilon}{\\left\\lVert u_{(t)}\\right\\rVert}\\right)\\boldsymbol{u}_{(t)},\\boldsymbol{v}_{(0)}\\rangle\\leq-\\eta(1+\\lambda)M(t,\\eta)\\lVert\\boldsymbol{v}_{(0)}\\rVert_{\\mathfrak{v}_{(0)}^{2}}\\right].}\\end{array}\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "Let \u03b3((tu)) $\\begin{array}{r}{\\gamma_{(t)}^{(\\boldsymbol{u})}=\\left(1-\\frac{\\eta\\lambda\\epsilon}{\\|\\boldsymbol{u}_{(t)}\\|}\\right)^{-1}}\\end{array}$ . Given the condition < min(\u2225u(t)\u2225,\u2225u\u00af\u2225), it follows \u03b3(u) (t) > 1. The final form of the recommendation error at the $(t+1)^{\\mathrm{th}}$ epoch under adversarial training is: ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{P}_{\\mathbf{v}(0)\\sim\\mathcal{N}(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}^{\\mathrm{~adv}}\\left[f_{(t+1)}(\\pmb{u},\\pmb{v})\\neq r\\mid(\\pmb{u},r)\\right]}\\\\ &{\\qquad\\qquad\\qquad\\qquad=\\mathbb{P}_{\\mathbf{v}(0)\\sim\\mathcal{N}(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}\\left[r\\cdot\\langle\\pmb{u}_{(t)},\\pmb{v}_{(0)}\\rangle\\le-\\eta(1+\\lambda)\\gamma_{(t)}^{(u)}M(t,\\eta)\\|\\pmb{v}_{(0)}\\|^{2}\\right]}\\end{array}\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "This leads us to: ", "page_idx": 20}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{P}_{v_{(0)}\\sim N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}\\left[f_{(t+1)}(\\boldsymbol{u},\\boldsymbol{v})\\neq\\boldsymbol{r}\\mid(\\boldsymbol{u},\\boldsymbol{r})\\right]-\\mathbb{P}_{v_{(0)}\\sim N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}^{\\mathrm{\\adv}}\\left[f_{(t+1)}(\\boldsymbol{u},\\boldsymbol{v})\\neq\\boldsymbol{r}\\mid(\\boldsymbol{u},\\boldsymbol{r})\\right]}\\\\ &{=\\mathbb{P}_{v_{(0)}\\sim N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}\\left[-\\eta(1+\\lambda)\\gamma_{(t)}^{u}M(t,\\eta)\\|v_{(0)}\\|^{2}<r\\langle u_{(t)},v_{(0)}\\rangle\\le-\\eta M(t,\\eta)\\|v_{(0)}\\|^{2}\\right]}\\\\ &{=\\mathbb{P}_{v_{(0)}\\sim N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}\\left[-\\eta(1+\\lambda)\\gamma_{(t)}^{u}M(t,\\eta)\\frac{\\|v_{(0)}\\|^{2}}{\\|u_{(t)}\\|}<\\langle\\frac{r u_{(t)}}{\\|u_{(t)}\\|},v_{(0)}\\rangle\\le-\\eta M(t,\\eta)\\frac{\\|v_{(0)}\\|^{2}}{\\|u_{(t)}\\|}\\right].}\\end{array}\n$$", "text_format": "latex", "page_idx": 20}, {"type": "text", "text": "Given that $\\|\\bar{\\pmb u}\\|\\gg\\sigma$ , we can approximate the $\\Vert\\pmb{v}_{(0)}\\Vert^{2}$ by using $\\mathbb{E}_{\\pmb{v}_{(0)}\\sim\\mathcal{N}(\\bar{\\pmb{u}},\\frac{\\sigma^{2}}{n-1}I)}\\left[\\|\\pmb{v}_{(0)}\\|^{2}\\right]$ as an estimate. Therefore, we have: ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathrm{\\mathop{\\mathbb{P}}}_{v_{(0)}\\sim N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}\\left[f_{(t+1)}({\\boldsymbol u},{\\boldsymbol v})\\neq r\\mid({\\boldsymbol u},{\\boldsymbol r})\\right]-\\mathbb{P}_{v_{(0)}\\sim N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}^{\\mathrm{\\mathop{\\,adv}}}\\left[f_{(t+1)}({\\boldsymbol u},{\\boldsymbol v})\\neq r\\mid({\\boldsymbol u},{\\boldsymbol r})\\right]}\\\\ &{\\approx\\mathbb{P}_{v_{(0)}\\sim N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}\\left[-\\eta(1+\\lambda)\\gamma_{(t)}^{u}M(t,\\eta)\\frac{\\lVert\\bar{u}\\rVert^{2}+\\frac{d\\sigma^{2}}{n-1}}{\\lVert u_{(t)}\\rVert}<\\langle\\frac{r u_{(t)}}{\\lVert u_{(t)}\\rVert},v_{(0)}\\rangle\\leq-\\eta M(t,\\eta)\\frac{\\lVert\\bar{u}\\rVert^{2}+\\frac{d\\sigma}{n-1}}{\\lVert u_{(t)}\\rVert}\\right.}\\end{array}\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "where $d$ is the dimension of $\\pmb{v}_{(0)}$ . ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathfrak{v}_{v(0)}\\sim\\!N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)\\left[f_{(t+1)}(u,v)\\neq r\\mid(u,r)\\right]-\\mathbb{P}_{v(0)\\sim\\mathcal{N}(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}^{\\operatorname*{adv}}\\left[f_{(t+1)}(u,v)\\neq r\\mid(u,r)\\right]}\\\\ &{=\\mathbb{P}_{\\varepsilon\\sim\\mathcal{N}\\left(0,\\frac{\\sigma^{2}}{n-1}I\\right)}\\left[-\\eta(1+\\lambda)\\gamma_{(t)}^{u}M(t,\\eta)\\frac{\\|\\bar{u}\\|^{2}+\\frac{d\\sigma^{2}}{n-1}}{\\|u_{(t)}\\|}<\\langle\\frac{r u_{(t)}}{\\|u_{(t)}\\|},\\bar{u}+\\varepsilon\\rangle\\leq-\\eta M(t,\\eta)\\frac{\\|\\bar{u}\\|^{2}+\\frac{d}{n-1}}{\\|u_{(t)}\\|}\\right]}\\\\ &{=\\mathbb{P}_{\\varepsilon\\sim\\mathcal{N}\\left(0,\\frac{\\sigma^{2}}{n-1}I\\right)}\\left[-\\eta(1+\\lambda)\\gamma_{(t)}^{u}M(t,\\eta)\\frac{\\|\\bar{u}\\|^{2}+\\frac{d\\sigma^{2}}{n-1}}{\\|u_{(t)}\\|}-\\langle\\frac{r u_{(t)}}{\\|u_{(t)}\\|},\\bar{u}\\rangle\\right.}\\\\ &{\\qquad\\qquad\\qquad\\qquad\\qquad\\left.<\\langle\\frac{r u_{(t)}}{\\|u_{(t)}\\|},\\varepsilon\\rangle\\leq-\\eta M(t,\\eta)\\frac{\\|\\bar{u}\\|^{2}+\\frac{d\\sigma^{2}}{n-1}}{\\|u_{(t)}\\|}-\\langle\\frac{r u_{(t)}}{\\|u_{(t)}\\|},\\bar{u}\\rangle\\right].}\\end{array}\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "According to Fact 1, $\\begin{array}{r}{\\langle\\frac{r\\pmb{u}_{(t)}}{\\|\\pmb{u}_{(t)}\\|},\\pmb{\\varepsilon}\\rangle\\sim\\mathcal{N}\\left(0,\\frac{\\sigma^{2}}{n-1}\\right)}\\end{array}$ , then: ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{P}_{\\mathbf{v}_{(0)}\\sim\\mathcal{N}(\\bar{\\pi},\\frac{\\sigma^{2}}{n-1}I)}\\left[f_{(t+1)}(\\pmb{u},\\pmb{v})\\neq\\pmb{r}\\mid(\\pmb{u},\\pmb{r})\\right]-\\mathbb{P}_{\\mathbf{v}_{(0)}\\sim\\mathcal{N}(\\bar{\\pi},\\frac{\\sigma^{2}}{n-1}I)}^{\\mathrm{~adv}}\\left[f_{(t+1)}(\\pmb{u},\\pmb{v})\\neq\\pmb{r}\\mid(\\pmb{u},\\pmb{r})\\right]}\\\\ &{=\\Phi\\left(\\frac{\\sqrt{n-1}}{\\sigma}\\left(\\eta(1+\\lambda)\\gamma_{(t)}^{u}M(t,\\eta)\\frac{\\left\\|\\bar{\\pmb{u}}\\right\\|^{2}+\\frac{d\\sigma^{2}}{n-1}}{\\left\\|\\pmb{u}_{(t)}\\right\\|}+\\langle\\frac{r\\pmb{u}_{(t)}}{\\left\\|\\pmb{u}_{(t)}\\right\\|},\\bar{\\pmb{u}}\\rangle\\right)\\right)}\\\\ &{\\qquad\\qquad-\\Phi\\left(\\frac{\\sqrt{n-1}}{\\sigma}\\left(\\eta M(t,\\eta)\\frac{\\left\\|\\bar{\\pmb{u}}\\right\\|^{2}+\\frac{d\\sigma^{2}}{n-1}}{\\left\\|\\pmb{u}_{(t)}\\right\\|}+\\langle\\frac{r\\pmb{u}_{(t)}}{\\left\\|\\pmb{u}_{(t)}\\right\\|},\\bar{\\pmb{u}}\\rangle\\right)\\right),}\\end{array}\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "where $\\Phi()$ is the CDF of standard Gaussian distribution. Given < min(\u2225u(t)\u2225,\u2225u\u00af\u2225), it follows that $(1+\\lambda)\\gamma_{(t)}^{(u)}>1+\\lambda>1$ . This condition implies a lower recommendation error at the $(t+1)^{\\mathrm{th}}$ epoch under adversarial training compared to standard training: ", "page_idx": 21}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\mathbb{P}_{v_{(0)}\\sim N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}\\left[f_{(t+1)}(\\boldsymbol{u},\\boldsymbol{v})\\neq\\boldsymbol{r}\\mid(\\boldsymbol{u},\\boldsymbol{r})\\right]-\\mathbb{P}_{v_{(0)}\\sim N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}^{\\mathrm{\\arg}}\\left[f_{(t+1)}(\\boldsymbol{u},\\boldsymbol{v})\\neq\\boldsymbol{r}\\mid(\\boldsymbol{u},\\boldsymbol{r})\\right]>0.}\\end{array}\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "Therefore, Theorem 1 is proved. ", "page_idx": 21}, {"type": "text", "text": "D.1.2 Proof of Theorem 2 ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "Proof of Theorem 2. In light of Theorem 1 and the impact of poisoning attacks, our objective is to measure the alteration in the recommendation error within a poisoning attack, i.e., $\\alpha$ -poisoned recommendation error. ", "page_idx": 21}, {"type": "text", "text": "A poisoning attack on Gaussian Recommender System injects a poisoning user set $\\begin{array}{r l}{\\mathcal{I}^{\\prime}}&{{}=}\\end{array}$ $\\{(\\dot{\\pmb u}_{1}^{\\prime},r_{1}^{\\prime}),(\\ddot{\\pmb u}_{2}^{\\prime},r_{2}^{\\prime}),\\dots,(\\pmb u_{n^{\\prime}}^{\\prime},r_{n^{\\prime}}^{\\prime})\\}$ , with each tuple $(\\dot{\\mathbf{u}}^{\\prime},r^{\\prime})\\in\\dot{\\mathbb{R}}^{d}\\times\\{\\dot{\\pm}1\\}$ representing data maliciously crafted by attackers. Considering the initialized poisoned item embedding v: ", "page_idx": 21}, {"type": "equation", "text": "$$\n{\\pmb v}_{(0)}^{'}=\\frac{1}{n+n^{\\prime}}\\left(\\sum_{({\\pmb u},r)\\in\\mathbb{Z}}r{\\pmb u}_{(0)}+\\sum_{({\\pmb u}^{\\prime},r^{\\prime})\\in\\mathbb{Z}^{\\prime}}r^{\\prime}{\\pmb u}_{(0)}^{'}\\right),\n$$", "text_format": "latex", "page_idx": 21}, {"type": "text", "text": "by employing Theorem 1 as a basis (similar to Equations 13 and 16), we derive: ", "page_idx": 22}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{E}_{\\left|{\\boldsymbol{U}}_{t}\\right|^{2}}\\left(\\left|\\mathcal{E}_{t+1,1}(\\boldsymbol{u},\\boldsymbol{v})\\right|^{p}\\mathcal{E}_{t}\\right)[(\\left|\\boldsymbol{U}_{t}),\\hat{\\boldsymbol{V}}_{t}^{\\top}\\boldsymbol{U}_{t}^{\\top},\\hat{\\mathbf{t}},\\hat{\\mathbf{t}},\\hat{\\mathbf{t}},\\hat{\\mathbf{t}},(\\boldsymbol{v})^{T}\\mathcal{F}^{T}\\mathcal{L}]\\left(\\left|\\bar{\\mathcal{U}}_{t+1,1}(\\boldsymbol{\\hat{\\mathbf{t}}}),\\boldsymbol{v}\\right|^{p}\\mathcal{F}\\right)[(\\left|\\boldsymbol{U}_{t}),\\hat{\\mathbf{t}},\\hat{\\mathbf{t}},\\hat{\\mathbf{t}},\\hat{\\mathbf{t}}^{\\top}\\right|]}\\\\ &{=\\mathbb{E}_{\\left|{\\boldsymbol{U}}_{t+1,1}^{p}\\boldsymbol{u}_{t}\\right|_{0}^{p}}\\left[\\left|\\left(1+\\lambda_{t}\\right)\\overline{{\\mathcal{V}_{t}^{\\top}\\partial_{t}(\\boldsymbol{t},\\hat{\\mathbf{t}})}}\\right|\\frac{\\bar{\\mathcal{V}}_{t}^{p}}{\\log(p_{0})}\\right]^{-1}\\left(\\frac{\\bar{\\mathcal{V}}_{t}^{p}(\\boldsymbol{t},\\hat{\\mathbf{t}})}{\\log(p_{0})}\\right)^{\\frac{p_{0}}{p_{0}}}\\times\\mathcal{U}[\\left(1+\\frac{p_{0}}{p_{0}}\\right)\\frac{p_{0}^{p_{0}}\\big|\\mathcal{V}_{t}^{\\top}}{\\log(p_{0})}]}\\\\ &{\\quad-\\mathbb{E}_{\\left|{\\boldsymbol{U}}_{t+1,1}^{p}\\boldsymbol{u}_{t}\\right|_{0}^{p}}\\left[\\left|\\left(-1+\\lambda_{t}^{\\top}\\right)\\overline{{\\mathcal{V}_{t}^{\\top}\\partial_{t}(\\boldsymbol{t},\\hat{\\mathbf{t}})}}\\right|\\frac{\\bar{\\mathcal{V}}_{t}^{p}}{\\log(p_{0})}\\right]^{-1}}\\\\ &{\\qquad\\quad\\times\\zeta\\left(\\frac{\\bar{\\mathcal{V}}_{t}^{\\top}\\partial_{t}(\\boldsymbol{t},\\hat{\\mathbf{t}})}{\\sqrt{p_{0}}}\\right)\\frac{p_{0}^{p_{0}}}{p \n$$$\\begin{array}{r}{\\gamma_{(t)}^{(\\boldsymbol{u})}=\\left(1-\\frac{\\eta\\lambda\\epsilon}{\\|\\boldsymbol{u}_{(t)}\\|}\\right)^{-1}}\\end{array}$ ", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "Given $\\|\\bar{\\pmb u}\\|\\gg\\sigma$ , we can use $\\mathbb{E}_{\\pmb{v}_{(0)}\\sim\\mathcal{N}(\\bar{\\pmb{u}},\\frac{\\sigma^{2}}{n-1}I)}\\left[\\|\\pmb{v}_{(0)}^{\\prime}\\|^{2}\\right]$ to approximate the $\\Vert\\pmb{v}_{(0)}^{\\prime}\\Vert^{2}$ in the above. Similar to the proof of Theorem 1, specifically Equation 17, and under the precondition $\\epsilon<$ $\\frac{\\operatorname*{min}(\\|\\pmb{u}_{(t)}\\|,\\|\\bar{\\pmb{u}}\\|)}{\\eta\\lambda}$ , we have: ", "page_idx": 22}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\sim\\!\\!N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)\\left[f_{(t+1),\\alpha}(\\boldsymbol{u},\\boldsymbol{v}^{\\prime})\\neq\\boldsymbol{r}\\mid(\\boldsymbol{u},\\boldsymbol{r})\\right]-\\mathbb{P}_{\\boldsymbol{v}(\\boldsymbol{0})\\sim\\mathcal{N}(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}^{\\mathrm{~adv}}\\left[f_{(t+1),\\alpha}(\\boldsymbol{u},\\boldsymbol{v}^{\\prime})\\neq\\boldsymbol{r}\\mid(\\boldsymbol{u},\\boldsymbol{r})\\right]>0.}\\end{array}\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "Hence, Theorem 2 is proved. ", "page_idx": 22}, {"type": "text", "text": "D.2 Proofs for Section 3.2 ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "D.2.1 Proof of Theorem 3 ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Extending Proposition 1 to ACF yields the following proposition, which captures the transformation of item embedding due to adversarial loss as defined in Equation 3. ", "page_idx": 22}, {"type": "text", "text": "Proposition 2. Consider a Gaussian Recommender System $f_{(t)}$ , per-trained on standard loss over $t$ epochs, then trained by the adversarial loss specified in Equation $^3$ over $k$ epochs. Given learning rate $\\eta,$ , adversarial training weight $\\lambda_{i}$ , and perturbation magnitude $\\epsilon_{i}$ , when $\\begin{array}{r}{\\epsilon<\\frac{||\\bar{\\boldsymbol{u}}||}{\\eta\\lambda}}\\end{array}$ , and $\\|\\bar{\\pmb u}\\|\\gg\\sigma$ there exists a transformation function $M_{\\mathrm{adv}}(t,\\eta,\\lambda,\\epsilon):\\mathbb{N}^{+}\\times\\mathbb{R}^{+}\\times\\mathbb{R}^{+}\\times\\mathbb{R}^{+}\\rightarrow\\mathbb{R}^{+}$ , such that the item embedding at $(t+k)^{\\mathrm{th}}$ epoch, $\\pmb{v}_{(t+k)}$ , is related to the initial embedding $\\pmb{v}_{(0)}$ by: ", "page_idx": 22}, {"type": "equation", "text": "$$\n\\pmb{v}_{(t+k)}=\\frac{M_{\\mathrm{adv}}(t+k,\\eta,\\lambda,\\epsilon)}{M_{\\mathrm{adv}}(t,\\eta,\\lambda,\\epsilon)}M(t,\\eta)\\pmb{v}_{(0)},\n$$", "text_format": "latex", "page_idx": 22}, {"type": "text", "text": "where $M(t,\\eta)$ is the transformation function given by standard loss in Proposition $^{\\,I}$ . ", "page_idx": 22}, {"type": "text", "text": "The proof of Proposition 2 follows a reasoning analogous to that of Proposition 1. Due to the similarity, the detailed proof is omitted for brevity. ", "page_idx": 22}, {"type": "text", "text": "Proof of Theorem 3. Given $\\begin{array}{r}{\\epsilon\\,<\\,\\frac{||\\bar{\\pmb u}||}{\\eta\\lambda}}\\end{array}$ , drawing from Proposition 2 and Theorem 1 (specifically Equation 15), the update rules for user and item embeddings in the ACF at the epoch are presented as: ", "page_idx": 23}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\pmb{u}_{(t+k+1)}=\\left(1-\\frac{\\eta\\lambda\\epsilon}{\\|\\pmb{u}_{(t+k)}\\|}\\right)\\pmb{u}_{(t+k)}+\\eta(1+\\lambda)r\\cdot\\frac{M_{\\mathrm{adv}}(t+k,\\eta,\\lambda,\\epsilon)}{M_{\\mathrm{adv}}(t,\\eta,\\lambda,\\epsilon)}M(t,\\eta)\\pmb{v}_{(0)},}\\\\ &{\\pmb{v}_{(t+k+1)}=\\frac{M_{\\mathrm{adv}}(t+k+1,\\eta,\\lambda,\\epsilon)}{M_{\\mathrm{adv}}(t,\\eta,\\lambda,\\epsilon)}M(t,\\eta)\\pmb{v}_{(0)}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 23}, {"type": "text", "text": "Considering the above update rules, the recommendation error at the $(t+k+1)^{\\mathrm{th}}$ epoch is given by: ", "page_idx": 23}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{P}_{v_{(0)}\\sim\\mathcal{N}(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}^{\\mathrm{~adv}}\\left[f_{(t+k+1)}(\\boldsymbol{u},\\boldsymbol{v})\\neq\\boldsymbol{r}\\mid(\\boldsymbol{u},\\boldsymbol{r})\\right]}\\\\ &{=\\mathbb{P}_{v_{(0)}\\sim\\mathcal{N}(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}\\left[\\boldsymbol{r}\\cdot\\left\\langle\\boldsymbol{u}_{(t+k+1)},\\boldsymbol{v}_{(t+k+1)}\\right\\rangle\\le0\\right]}\\\\ &{=\\mathbb{P}_{v_{(0)}\\sim\\mathcal{N}(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}\\left[\\boldsymbol{r}\\cdot\\left\\langle\\left(1-\\frac{\\eta\\lambda\\epsilon}{\\left\\lVert\\boldsymbol{u}_{(t+k)}\\right\\rVert}\\right)\\boldsymbol{u}_{(t+k)},\\boldsymbol{v}_{(0)}\\right\\rangle\\le-\\eta(1+\\lambda)C_{t+k}\\lVert\\boldsymbol{v}_{(0)}\\rVert^{2}\\right],}\\end{array}\n$$", "text_format": "latex", "page_idx": 23}, {"type": "text", "text": "where Ct+k = $\\begin{array}{r}{C_{t+k}\\;=\\;\\frac{M_{\\mathrm{adv}}(t+k,\\eta,\\lambda,\\epsilon)}{M_{\\mathrm{adv}}(t,\\eta,\\lambda,\\epsilon)}M(t,\\eta)}\\end{array}$ $\\begin{array}{r}{\\gamma_{(t+k)}^{({\\boldsymbol u})}~=~\\left(1-\\frac{\\eta\\lambda\\epsilon}{\\|{\\boldsymbol u}_{(t+k)}\\|}\\right)^{-1}}\\end{array}$ etphoec ch otnhrdoituiognh $\\begin{array}{r}{\\epsilon<\\frac{\\operatorname*{min}(\\|\\pmb{u}_{(t+k)}\\|,\\|\\bar{\\pmb{u}}\\|)}{\\eta\\lambda}}\\end{array}$ $\\gamma_{(t+k)}^{({\\boldsymbol u})}>1$ $(t+1)^{\\mathrm{th}}$ adversarial loss can be expressed as: ", "page_idx": 23}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{P}_{v_{(0)}\\sim N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}^{\\mathrm{~adv}}\\left[f_{(t+k+1)}(u,v)\\neq r\\;|\\;(u,r)\\right]}\\\\ &{\\qquad\\qquad\\qquad\\qquad=\\mathbb{P}_{v_{(0)}\\sim N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}\\left[r\\cdot\\langle u_{(t+k)},v_{(0)}\\rangle\\leq-\\eta(1+\\lambda)\\gamma_{(t+k)}^{(u)}C_{t+k}\\|v_{(0)}\\|^{2}\\right].}\\end{array}\n$$", "text_format": "latex", "page_idx": 23}, {"type": "text", "text": "With ", "page_idx": 23}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\mathbb{P}_{v_{(0)}\\sim N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}^{\\mathrm{~adv}}\\left[f_{(t+k)}(\\pmb{u},v)\\neq\\pmb{r}\\mid(\\pmb{u},r)\\right]=\\mathbb{P}_{v_{(0)}\\sim N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}\\left[r\\cdot\\left\\langle\\pmb{u}_{(t+k)},\\pmb{v}_{(0)}\\right\\rangle\\le0\\right],}\\end{array}\n$$", "text_format": "latex", "page_idx": 23}, {"type": "text", "text": "the change in recommendation error can be written as: ", "page_idx": 23}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\Delta_{(t+k+1)}^{\\mathrm{adv}}\\mathbb{P}_{v_{(0)}\\sim N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}^{\\mathrm{adv}}[f(u,v)\\neq r\\mid(u,r)]}\\\\ &{\\qquad\\quad=\\mathbb{P}_{v_{(0)}\\sim N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}\\left[-\\eta(1+\\lambda)\\gamma_{(t+k)}^{(u)}C_{t+k}\\|v_{(0)}\\|^{2}<r\\cdot\\langle u_{(t+k)},v_{(0)}\\rangle\\le0\\right]}\\\\ &{\\qquad\\quad=\\mathbb{P}_{v_{(0)}\\sim N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}\\left[-\\eta(1+\\lambda)\\gamma_{(t+k)}^{(u)}\\frac{C_{t+k}}{\\|u_{(t+k)}\\|}\\|v_{(0)}\\|^{2}<r\\cdot\\langle\\frac{u_{(t+k)}}{\\|u_{(t+k)}\\|},v_{(0)}\\rangle\\le0\\right]}\\end{array}\n$$", "text_format": "latex", "page_idx": 23}, {"type": "text", "text": "Considering $\\begin{array}{r}{{\\pmb v}_{(0)}\\sim\\mathcal{N}\\left(\\bar{\\pmb u},\\frac{\\sigma^{2}}{n-1}{\\cal I}\\right)}\\end{array}$ , let $\\begin{array}{r}{\\varepsilon\\sim\\mathcal{N}\\left(\\mathbf{0},\\frac{\\sigma^{2}}{n-1}I\\right)}\\end{array}$ , we have $\\pmb{v}_{(0)}=\\bar{\\pmb{u}}+\\pmb{\\varepsilon}$ . Then we obtain: ", "page_idx": 23}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathrm{\\Lambda}_{(t+k+1)}^{\\mathrm{adv}}\\mathbb{P}_{v_{(0)}\\sim N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}^{\\mathrm{adv}}[f(\\pmb{u},\\pmb{v})\\neq\\pmb{r}\\mid(\\pmb{u},\\pmb{r})]}\\\\ &{\\qquad=\\!\\!\\mathbb{P}_{\\varepsilon\\sim N\\left(0,\\frac{\\sigma^{2}}{n-1}I\\right)}\\Bigg[-\\eta(1+\\lambda)\\gamma_{(t+k)}^{(\\pmb{u})}\\frac{C_{t+k}}{\\|\\pmb{u}_{(t+k)}\\|}\\|\\mathfrak{v}_{(0)}\\|^{2}<\\langle\\frac{r\\pmb{u}_{(t+k)}}{\\|\\pmb{u}_{(t+k)}\\|},\\bar{\\pmb{u}}+\\varepsilon\\rangle\\leq0\\Bigg]}\\\\ &{\\qquad=\\!\\!\\mathbb{P}_{\\varepsilon\\sim N\\left(0,\\frac{\\sigma^{2}}{n-1}I\\right)}\\Bigg[-\\eta(1+\\lambda)\\gamma_{(t+k)}^{(\\pmb{u})}\\frac{C_{t+k}}{\\|\\pmb{u}_{(t+k)}\\|}\\|\\mathfrak{v}_{(0)}\\|^{2}-\\langle\\frac{r\\pmb{u}_{(t+k)}}{\\|\\pmb{u}_{(t+k)}\\|},\\bar{\\pmb{u}}\\rangle<\\langle\\frac{r\\pmb{u}_{(t+k)}}{\\|\\pmb{u}_{(t+k)}\\|},\\varepsilon\\rangle\\leq-\\underbrace{\\lambda}_{\\pmb{u}_{(t+k)}},}\\end{array}\n$$", "text_format": "latex", "page_idx": 23}, {"type": "text", "text": "Given that $\\|\\bar{\\pmb u}\\|\\gg\\sigma$ , we can approximate the $\\Vert\\pmb{v}_{(0)}\\Vert^{2}$ by using $\\mathbb{E}_{\\pmb{v}_{(0)}\\sim\\mathcal{N}(\\bar{\\pmb{u}},\\frac{\\sigma^{2}}{n-1}I)}\\left[\\|\\pmb{v}_{(0)}\\|^{2}\\right]$ as an estimate. Thus, we have: ", "page_idx": 23}, {"type": "equation", "text": "$$\n\\begin{array}{l}{\\displaystyle\\sum_{(t+k+1)}^{\\mathrm{adv}}\\mathbb{P}_{v_{(0)}\\sim N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}^{\\mathrm{\\normalfont~adv}}\\Big[f(\\pmb{u},\\pmb{v})\\neq\\pmb{r}\\mid(\\pmb{u},\\pmb{r})\\Big]}\\\\ {\\displaystyle\\approx\\mathbb{P}_{\\varepsilon\\sim N\\big(\\mathbf{0},\\frac{\\sigma^{2}}{n-1}I\\big)}\\Bigg[-\\eta(1+\\lambda)\\gamma_{(t+k)}^{(u)}C_{t+k}\\frac{\\|\\bar{\\pmb{u}}\\|^{2}+\\frac{d\\sigma^{2}}{n-1}}{\\|\\pmb{u}_{(t+k)}\\|}-\\langle\\frac{r\\pmb{u}_{(t+k)}}{\\|\\pmb{u}_{(t+k)}\\|},\\bar{\\pmb{u}}\\rangle<\\langle\\frac{r\\pmb{u}_{(t+k)}}{\\|\\pmb{u}_{(t+k)}\\|},\\pmb{\\varepsilon}\\rangle\\leq0}\\end{array}\n$$", "text_format": "latex", "page_idx": 23}, {"type": "text", "text": "By Fact 1, we have $\\begin{array}{r}{\\langle\\frac{r\\pmb{u}_{(t)}}{\\|\\pmb{u}_{(t)}\\|},\\pmb{\\varepsilon}\\rangle\\sim\\mathcal{N}\\left(0,\\frac{\\sigma^{2}}{n-1}\\right)}\\end{array}$ , then: ", "page_idx": 24}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\frac{\\mathrm{{Adv}}}{(t+k+1)^{\\mathbb{P}}{v}_{(0)}\\sim{N}(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}[f(\\pmb{u},\\pmb{v})\\neq\\pmb{r}\\mid(\\pmb{u},\\pmb{r})]}\\\\ &{\\qquad=\\Phi\\left(\\frac{\\sqrt{n-1}}{\\sigma}\\left(-\\langle\\frac{r\\pmb{u}_{(t+k)}}{\\|\\pmb{u}_{(t+k)}\\|},\\bar{\\pmb{u}}\\rangle\\right)\\right)-\\Phi\\left(\\frac{\\sqrt{n-1}}{\\sigma}\\left(-\\eta(1+\\lambda)\\gamma_{(t+k)}^{(u)}C_{t+k}\\frac{\\|\\bar{\\pmb{u}}\\|^{2}+\\frac{d\\sigma^{2}}{n-1}}{\\|\\pmb{u}_{(t+k)}\\|}-\\frac{\\|\\pmb{u}\\|^{2}}{\\|\\pmb{u}_{(t+k)}\\|}\\right)\\right)}\\end{array}\n$$", "text_format": "latex", "page_idx": 24}, {"type": "text", "text": "where $\\Phi()$ is the CDF of standard Gaussian distribution. ", "page_idx": 24}, {"type": "text", "text": "Obviously, ", "page_idx": 24}, {"type": "equation", "text": "$$\n\\langle\\frac{r\\pmb{u}_{(t+k)}}{\\|\\pmb{u}_{(t+k)}\\|},\\bar{\\pmb{u}}\\rangle\\in[-\\|\\bar{\\pmb{u}}\\|,\\|\\bar{\\pmb{u}}\\|]\\,.\n$$", "text_format": "latex", "page_idx": 24}, {"type": "text", "text": "Let ", "page_idx": 24}, {"type": "equation", "text": "$$\n\\Psi(u,t+k)=(1+\\lambda)\\gamma_{(t+k)}^{u}\\frac{C_{t+k}}{\\|u_{(t+k)}\\|}.\n$$", "text_format": "latex", "page_idx": 24}, {"type": "text", "text": "Using the CDF properties of the standard normal distribution, we can conclude: ", "page_idx": 24}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{\\displaystyle\\lambda_{(t+k+1)}^{\\mathrm{adv}}\\mathbb{P}_{v_{(0)}\\sim N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}^{\\mathrm{~adv}}[f(\\pmb{u},\\pmb{v})\\neq\\pmb{r}\\mid(\\pmb{u},\\pmb{r})]}&{{}\\geq}\\\\ {\\displaystyle\\Phi\\left(\\frac{\\sqrt{n-1}}{\\sigma}\\left(\\|\\bar{u}\\|+\\eta(\\|\\bar{u}\\|^{2}+\\frac{d\\sigma^{2}}{n-1})\\Psi(\\pmb{u},t+k)\\right)\\right)-\\Phi\\left(\\frac{\\sqrt{n-1}}{\\sigma}(\\|\\bar{u}\\|^{2})\\right)=\\frac{\\sigma^{2}}{2}\\|\\bar{u}\\|^{2},}\\end{array}\n$$", "text_format": "latex", "page_idx": 24}, {"type": "text", "text": "equality holds when ", "page_idx": 24}, {"type": "equation", "text": "$$\n\\langle\\frac{r\\pmb{u}_{(t+k)}}{\\|\\pmb{u}_{(t+k)}\\|},\\bar{\\pmb{u}}\\rangle=\\|\\bar{\\pmb{u}}\\|.\n$$", "text_format": "latex", "page_idx": 24}, {"type": "text", "text": "Furthermore, ", "text_level": 1, "page_idx": 24}, {"type": "equation", "text": "$$\n\\begin{array}{r l r}{\\displaystyle\\sum_{(t+k+1)}^{\\mathrm{adv}}\\mathbb{P}_{\\mathbf{v}_{(0)}\\sim N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}^{\\mathrm{~adv}}[f(\\pmb{u},\\pmb{v})\\neq\\pmb{r}\\mid(\\pmb{u},\\pmb{r})]}&{{}\\le}&{2\\Phi\\left(\\frac{\\sqrt{n-1}\\eta}{2\\sigma}(\\|\\bar{u}\\|^{2}+\\frac{d\\sigma^{2}}{n-1})\\Psi(\\pmb{u},t+k)\\right)}\\end{array}\n$$", "text_format": "latex", "page_idx": 24}, {"type": "text", "text": "Equality is achieved when ", "page_idx": 24}, {"type": "equation", "text": "$$\n\\langle\\frac{r\\pmb{u}_{(t+k)}}{\\|\\pmb{u}_{(t+k)}\\|},\\bar{\\pmb{u}}\\rangle=-\\frac{1}{2}\\eta(\\|\\bar{\\pmb{u}}\\|^{2}+\\frac{d\\sigma^{2}}{n-1})\\Psi(\\pmb{u},t+k).\n$$", "text_format": "latex", "page_idx": 24}, {"type": "text", "text": "Therefore, Theorem 3 is proved. ", "page_idx": 24}, {"type": "text", "text": "D.2.2 Proof of Theorem 4 ", "text_level": 1, "page_idx": 24}, {"type": "text", "text": "Proof of Theorem 4. Given $\\begin{array}{r}{\\boldsymbol{\\epsilon}\\ <\\ \\frac{||\\bar{\\mathbf{u}}||}{\\eta\\lambda}}\\end{array}$ , according to Proposition 2 and Theorem 1 (specifically Equation 15), we have: ", "page_idx": 24}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\pmb{u}_{(t+k+1)}=\\left(1-\\frac{\\eta\\lambda\\epsilon}{\\|\\pmb{u}_{(t+k)}\\|}\\right)\\pmb{u}_{(t+k)}+\\eta(1+\\lambda)\\pmb{r}\\cdot\\frac{M_{\\mathrm{adv}}(t+k,\\eta,\\lambda,\\epsilon)}{M_{\\mathrm{adv}}(t,\\eta,\\lambda,\\epsilon)}\\pmb{M}(t,\\eta)\\pmb{v}_{(0)}^{\\prime},}\\\\ &{\\pmb{v}_{(t+k+1)}^{\\prime}=\\frac{M_{\\mathrm{adv}}(t+k+1,\\eta,\\lambda,\\epsilon)}{M_{\\mathrm{adv}}(t,\\eta,\\lambda,\\epsilon)}\\pmb{M}(t,\\eta)\\pmb{v}_{(0)}^{\\prime},}\\end{array}\n$$", "text_format": "latex", "page_idx": 24}, {"type": "text", "text": "where $\\pmb{v}_{(0)}^{'}$ is the poisoned item embedding as given by Equation 18. ", "page_idx": 24}, {"type": "text", "text": "Considering the above update rules, the $\\alpha$ -poisoned recommendation error at the $(t+k+1)^{\\mathrm{th}}$ epoch is given by: ", "page_idx": 24}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{P}_{v_{(0)}\\sim\\mathcal{N}(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}^{\\mathrm{~adv}}\\left[f_{(t+k+1),\\alpha}(u,v^{\\prime})\\neq r\\mid(u,r)\\right]}\\\\ &{=\\mathbb{P}_{v_{(0)}\\sim\\mathcal{N}(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}\\left[r\\cdot\\langle u_{(t+k+1)},v_{(t+k+1)}^{\\prime}\\rangle\\le0\\right]}\\\\ &{=\\mathbb{P}_{v_{(0)}\\sim\\mathcal{N}(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}\\left[r\\cdot\\langle\\left(1-\\frac{\\eta\\lambda\\epsilon}{\\|u_{(t+k)}\\|}\\right)u_{(t+k)},v_{(0)}^{'}\\rangle\\le-\\eta(1+\\lambda)C_{t+k}\\|v_{(0)}^{'}\\|^{2}\\right],}\\end{array}\n$$", "text_format": "latex", "page_idx": 24}, {"type": "text", "text": "where MadMv(t+(kt,+\u03b7,1\u03bb,\u03b7,\u03f5,)\u03bb,\u03f5)M(t, \u03b7). Let \u03b3((tu+)k) $\\begin{array}{r}{\\gamma_{(t+k)}^{(\\boldsymbol{u})}\\,=\\,\\left(1-\\frac{\\eta\\lambda\\epsilon}{\\|\\boldsymbol{u}_{(t+k)}\\|}\\right)^{-1}}\\end{array}$ . Given the condition <min(\u2225u(t\u03b7+\u03bbk)\u2225,\u2225u\u00af\u2225), it follows \u03b3((tu+)k) > . The recommendation error at the $(t+1)^{\\mathrm{th}}$ epoch under adversarial loss can be expressed as: ", "page_idx": 25}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{P}_{v_{(0)}\\sim N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}^{\\mathrm{~adv}}\\left[f_{(t+k+1),\\alpha}({u},{v}^{\\prime})\\neq r\\;|\\;({u},{r})\\right]}\\\\ &{\\qquad\\qquad\\qquad\\qquad=\\mathbb{P}_{v_{(0)}\\sim N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}\\left[r\\cdot\\langle u_{(t+k)},v_{(0)}^{\\prime}\\rangle\\le-\\eta(1+\\lambda)\\gamma_{(t+k)}^{(u)}C_{t+k}\\|v_{(0)}^{\\prime}\\|^{2}\\right].}\\end{array}\n$$", "text_format": "latex", "page_idx": 25}, {"type": "text", "text": "With ", "page_idx": 25}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\mathbb{P}_{v_{(0)}\\sim N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}^{\\mathrm{~adv}}\\left[f_{(t+k),\\alpha}(\\pmb{u},\\pmb{v}^{\\prime})\\neq\\boldsymbol{r}\\mid(\\pmb{u},\\pmb{r})\\right]=\\mathbb{P}_{v_{(0)}\\sim N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}\\left[\\boldsymbol{r}\\cdot\\left\\langle\\pmb{u}_{(t+k)},\\pmb{v}_{(0)}^{\\prime}\\right\\rangle\\le0\\right],}\\end{array}\n$$", "text_format": "latex", "page_idx": 25}, {"type": "text", "text": "the change in $\\alpha$ -poisoned recommendation error can be written as: ", "page_idx": 25}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\Delta t_{(+k+1)}^{\\mathrm{shele}}\\mathbb{P}_{\\mathrm{v}_{(0)}\\sim\\mathcal{N}(\\cdot,\\cdot,\\frac{\\sigma^{2}}{\\nu-1})}^{\\mathrm{adv}}[\\left(\\mathbf{z}_{i},\\cdot\\right)^{\\alpha}\\neq\\vec{r}\\,|\\,\\left(\\mathbf{u},r\\right)]}\\\\ &{=\\!\\!\\!\\!\\nabla_{\\mathbf{v}_{(0)}\\sim\\mathcal{N}(\\cdot,\\frac{\\sigma^{2}}{\\nu-1})}\\left[\\left(\\mathbf{z}_{i}+\\lambda\\right)\\!\\gamma_{(i+k)}^{\\alpha}C_{\\mathbb{I}+k}\\right]\\!\\left|\\mathbf{v}_{(0)}^{\\prime}\\right|^{2}<r\\cdot\\left\\langle\\mathbf{u}_{(t+k)},\\mathbf{v}_{(0)}^{\\prime}\\right\\rangle\\leq0\\right]}\\\\ &{\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\\n$$", "text_format": "latex", "page_idx": 25}, {"type": "text", "text": "Considering $\\begin{array}{r}{{\\pmb v}_{(0)}\\sim\\mathcal{N}\\left(\\bar{\\pmb u},\\frac{\\sigma^{2}}{n-1}{\\cal I}\\right)}\\end{array}$ , let $\\begin{array}{r}{\\varepsilon\\sim\\mathcal{N}\\left(\\mathbf{0},\\frac{\\sigma^{2}}{n-1}I\\right)}\\end{array}$ , we have $\\pmb{v}_{(0)}=\\bar{\\pmb{u}}+\\pmb{\\varepsilon}$ . Then we obtain: ", "page_idx": 25}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\displaystyle\\Delta\\mathrm{a}_{(t+k+1)}^{\\mathrm{adev}}\\mathbb{P}_{v_{(0)}\\sim\\mathcal{N}}^{\\mathrm{adev}}(\\boldsymbol{u},\\boldsymbol{v}^{2})\\left[f_{\\alpha}(\\boldsymbol{u},\\boldsymbol{v}^{\\prime})\\neq\\boldsymbol{r}\\mid(\\boldsymbol{u},\\boldsymbol{r})\\right]}\\\\ &{\\displaystyle=\\mathbb{P}_{\\varepsilon\\sim\\mathcal{N}}\\Big(0,\\frac{\\sigma^{2}}{n-1}t\\Big)\\left[-\\eta\\frac{n+n^{\\prime}}{n}(1+\\lambda)\\gamma_{(t+k)}^{(0)}\\frac{C_{t+k}}{\\|\\mathbf{u}(t+k)\\|}\\right\\|\\mathrm{v}_{(0)}^{\\prime}\\|^{2}-\\frac{1}{n}\\sum_{(\\boldsymbol{u}^{\\prime},\\boldsymbol{r})\\in\\mathcal{T}^{\\prime}}r r^{\\prime}\\big\\|\\frac{\\mathbf{u}_{(t+k)}}{\\|\\mathbf{u}(t+k)\\|},\\boldsymbol{u}_{(0)}^{\\prime}\\rangle}\\\\ &{\\displaystyle\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\times\\left\\langle\\frac{r\\mathbf{u}(t+k)}{\\|\\mathbf{u}(t+k)\\|},\\bar{u}+\\varepsilon\\right\\rangle\\le-\\frac{1}{n}\\sum_{(\\boldsymbol{u}^{\\prime},\\boldsymbol{r}^{\\prime})\\in\\mathcal{T}}r^{\\prime}\\big\\langle\\frac{\\mathbf{u}_{(t+k)}}{\\|\\mathbf{u}(t+k)\\|},\\boldsymbol{u}_{(0)}^{\\prime}\\big\\rangle\\right]}\\\\ &{\\displaystyle=\\mathbb{P}_{\\varepsilon\\sim\\mathcal{N}}\\Big(0,\\frac{\\sigma^{2}}{n-1}t\\Big)\\left[-\\eta\\frac{n+n^{\\prime}}{n}(1+\\lambda)\\gamma_{(t+k)}^{(0)}\\frac{C_{t+k}}{\\|\\mathbf{u}(t+k)\\|}\\right\\|\\mathrm{v}_{(0)}^{\\prime}\\|^{2}-\\frac{1}{n}\\sum_{(\\boldsymbol{u}^{\\prime},\\boldsymbol{r}^{\\prime})\\in\\mathcal{T}^{\\prime}}r^{\\prime}\\big\\langle\\frac{\\mathbf{u}(t+k)}{\\|\\mathbf{u}(t+k)\\|},\\boldsymbol{u}_{(0)}^{\\prime}\\rangle-\\big\\langle\\frac{r}{\\|\\mathbf{u}(t+k)\\|},\\frac{\\hat{\\mathbf{u}}(t)}{\\|\\mathbf{u}(t)\\|}\\big\\rangle\\right.}\\\\ &{\\displaystyle\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\left.<\\frac{\n$$", "text_format": "latex", "page_idx": 25}, {"type": "text", "text": "Given that $\\|\\bar{\\pmb u}\\|\\gg\\sigma$ , we can approximate $\\Vert\\pmb{v}_{(0)}^{\\prime}\\Vert^{2}$ by using: ", "page_idx": 25}, {"type": "equation", "text": "$$\n{\\mathbb E}_{{\\mathbf v}_{(0)}\\sim{\\cal N}(\\bar{\\mathbf u},\\frac{\\sigma^{2}}{n-1}I)}\\left[\\lVert{\\mathbf v}_{(0)}^{\\prime}\\rVert^{2}\\right]={\\mathbb E}_{{\\mathbf v}_{(0)}\\sim{\\cal N}(\\bar{\\mathbf u},\\frac{\\sigma^{2}}{n-1}I)}\\left[\\lVert\\frac{n}{n+n^{\\prime}}{\\boldsymbol v}_{(0)}+\\frac{1}{n+n^{\\prime}}\\sum_{({\\mathbf u}^{\\prime},{r})\\in{\\cal T}}{r}^{\\prime}{\\boldsymbol u}^{\\prime}\\rVert^{2}\\right],\n$$", "text_format": "latex", "page_idx": 25}, {"type": "text", "text": "as an estimate. For simplicity, we use $\\mathbb{E}\\left[\\Vert\\pmb{v}_{(0)}^{\\prime}\\Vert^{2}\\right]$ to represent Ev(0)\u223cN(u\u00af, n\u03c3\u221221 I) \u2225v\u2032(0)\u22252 . Thus, we have: ", "page_idx": 25}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\frac{\\mathrm{sdv}}{(t+k+1)}\\mathbb{P}_{v_{(0)}\\sim\\mathcal{N}(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}^{\\mathrm{adv}}[f_{\\alpha}({\\boldsymbol u},{\\boldsymbol v}^{\\prime})\\neq r\\mid({\\boldsymbol u},r)]}\\\\ &{\\sim\\!\\mathcal{N}\\!\\left(0,\\frac{\\sigma^{2}}{n-1}I\\right)\\Bigg[-\\eta\\frac{n+n^{\\prime}}{n}(1+\\lambda)\\gamma_{(t+k)}^{(u)}\\frac{C_{t+k}}{\\left\\|{\\boldsymbol u}_{(t+k)}\\right\\|}\\mathbb{E}\\left[\\|{\\boldsymbol v}_{(0)}^{\\prime}\\|^{2}\\right]-\\frac{1}{n}\\sum_{({\\boldsymbol u}^{\\prime},{\\boldsymbol r}^{\\prime})\\in\\mathcal{T}^{\\prime}}r r^{\\prime}\\langle\\frac{{\\boldsymbol u}_{(t+k)}}{\\left\\|{\\boldsymbol u}_{(t+k)}\\right\\|},{\\boldsymbol u}_{(0)}^{\\prime}\\rangle-}\\\\ &{\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\quad}\\\\ &{\\qquad\\qquad\\qquad\\quad<\\langle\\frac{r u_{(t+k)}}{\\left\\|{\\boldsymbol u}_{(t+k)}\\right\\|},{\\boldsymbol\\varepsilon}\\rangle\\le-\\frac{1}{n}\\sum_{({\\boldsymbol u}^{\\prime},{\\boldsymbol r}^{\\prime})\\in\\mathcal{T}}r r^{\\prime}\\langle\\frac{{\\boldsymbol u}_{(t+k)}}{\\left\\|{\\boldsymbol u}_{(t+k)}\\right\\|},{\\boldsymbol u}_{(0)}^{\\prime}\\rangle-\\langle\\frac{r u_{(t+k)}}{\\left\\|{\\boldsymbol u}_{(t+k)}\\right\\|},\\bar{{\\boldsymbol u}}\\rangle\\Bigg].}\\end{array}\n$$", "text_format": "latex", "page_idx": 26}, {"type": "text", "text": "By Fact 1, we have $\\begin{array}{r}{\\langle\\frac{r\\mathbf{\\boldsymbol{u}}_{(t+k)}}{\\|\\mathbf{\\boldsymbol{u}}_{(t+k)}\\|},\\varepsilon\\rangle\\sim\\mathcal{N}\\left(0,\\frac{\\sigma^{2}}{n-1}\\right)}\\end{array}$ , then: ", "page_idx": 26}, {"type": "equation", "text": "$$\n\\begin{array}{l}{\\Delta_{(t+k+1)}^{\\mathrm{adv}}\\mathbb{P}_{v_{(0)}\\sim N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}^{\\mathrm{adv}}[f_{\\alpha}(u,v^{\\prime})\\neq r\\mid(u,r)]}\\\\ {\\Rightarrow\\Phi\\left(\\frac{\\sqrt{n-1}}{\\sigma}\\left(-\\frac{1}{n}\\sum_{(u^{\\prime},r^{\\prime})\\in\\mathcal{X}^{\\prime}}r r^{\\prime}\\langle\\frac{u_{(t+k)}}{\\|u_{(t+k)}\\|},u_{(0)}^{\\prime}\\rangle-\\langle\\frac{r u_{(t+k)}}{\\|u_{(t+k)}\\|},\\bar{u}\\rangle\\right)\\right)}\\\\ {\\;-\\Phi\\left(\\frac{\\sqrt{n-1}}{\\sigma}\\left(-\\eta\\frac{n+n^{\\prime}}{n}(1+\\lambda)\\gamma_{(t+k)}^{(u)}\\frac{C_{t+k}}{\\|u_{(t+k)}\\|}\\mathbb{E}\\left[\\|v_{(0)}^{\\prime}\\|^{2}\\right]-\\frac{1}{n}\\sum_{(u^{\\prime},r^{\\prime})\\in\\mathcal{X}^{\\prime}}r r^{\\prime}\\langle\\frac{u_{(t+k)}}{\\|u_{(t+k)}\\|},u_{(0)}^{\\prime}\\rangle\\right)\\right)}\\end{array}\n$$", "text_format": "latex", "page_idx": 26}, {"type": "text", "text": "where $\\Phi()$ is the CDF of standard Gaussian distribution. ", "page_idx": 26}, {"type": "text", "text": "Obviously, ", "page_idx": 26}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\quad\\sum_{\\substack{(u^{\\prime},r^{\\prime})\\in\\mathbb{Z}^{\\prime}}}r r^{\\prime}\\langle\\frac{u_{(t+k)}}{\\|u_{(t+k)}\\|},u_{(0)}^{\\prime}\\rangle\\in\\left[-n^{\\prime}\\sqrt{d}\\alpha,n^{\\prime}\\sqrt{d}\\alpha\\right],}\\\\ &{\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\langle\\frac{r\\pm u_{(t+k)}}{\\|u_{(t+k)}\\|},\\bar{u}\\rangle\\in[-\\|\\bar{u}\\|,\\|\\bar{u}\\|],}\\\\ &{\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad}\\\\ &{\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad}\\\\ &{\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad}\\\\ &{\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad}\\\\ &{\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad}\\\\ &{\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad}\\\\ &{\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad\\quad}\\end{array}\n$$", "text_format": "latex", "page_idx": 26}, {"type": "text", "text": "n2d\u03c32 (n \u22121)(n + n\u2032)2 ", "page_idx": 26}, {"type": "text", "text": "where $n^{\\prime}$ is the number of fake users, $d$ is the dimension of $\\pmb{u}^{\\prime}$ , and $\\alpha=\\operatorname*{max}_{(\\pmb{u}^{\\prime},r^{\\prime})\\in\\mathcal{Z}^{\\prime}}\\|\\pmb{u}^{\\prime}\\|_{\\infty}$ . ", "page_idx": 26}, {"type": "text", "text": "Let ", "page_idx": 26}, {"type": "equation", "text": "$$\n\\begin{array}{l}{\\displaystyle\\Psi(\\boldsymbol{u},t+k)\\!=\\!(1+\\lambda)\\gamma_{(t+k)}^{\\boldsymbol{u}}\\frac{C_{t+k}}{\\|\\boldsymbol{u}_{(t+k)}\\|},}\\\\ {\\displaystyle\\beta\\!=\\!\\frac{n^{\\prime}}{n}\\sqrt{d}\\alpha+\\|\\bar{\\boldsymbol{u}}\\|.}\\end{array}\n$$", "text_format": "latex", "page_idx": 26}, {"type": "text", "text": "According to the CDF properties of the standard normal distribution, we can conclude that: ", "page_idx": 26}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\lambda_{(t+k+1)}^{\\mathrm{{adv}}}\\mathbb{P}_{v_{(0)}\\sim N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}^{\\mathrm{{adv}}}[f_{\\alpha}(u,v^{\\prime})\\neq r\\mid(u,r)]\\quad>}\\\\ &{\\mathfrak{p}\\left(\\frac{\\sqrt{n-1}}{\\sigma}\\left(\\beta+\\eta\\left(\\frac{n^{2}\\lVert\\bar{u}\\rVert^{2}-2n n^{\\prime}\\alpha\\lVert\\bar{u}\\rVert_{0}}{n(n+n^{\\prime})}+\\frac{n d\\sigma^{2}}{(n-1)(n+n^{\\prime})}\\right)\\Psi(u,t+k)\\right)\\right)-\\Phi\\left(\\frac{\\sqrt{n-1}}{\\sigma}(u,v^{\\prime})\\right).}\\end{array}\n$$", "text_format": "latex", "page_idx": 26}, {"type": "text", "text": "reaches the minimum value when ", "page_idx": 26}, {"type": "equation", "text": "$$\n\\begin{array}{r l r}&{\\lefteqn{\\sum_{(\\mathbf{u^{\\prime}},r^{\\prime})\\in\\mathbb{Z}^{\\prime}}r r^{\\prime}\\langle\\frac{\\mathbf{u}_{(t+k)}}{\\|\\mathbf{u}_{(t+k)}\\|},\\mathbf{u}_{(0)}^{'}\\rangle=n^{\\prime}\\sqrt{d}\\alpha,}}\\\\ &{}&\\\\ &{\\qquad\\qquad\\qquad\\langle\\frac{r\\mathbf{u}_{(t+k)}}{\\|\\mathbf{u}_{(t+k)}\\|},\\bar{\\mathbf{u}}\\rangle=\\|\\bar{\\mathbf{u}}\\|,}\\end{array}\n$$", "text_format": "latex", "page_idx": 26}, {"type": "text", "text": "and $\\mathbb{E}\\left[\\Vert\\pmb{v}_{(0)}^{\\prime}\\Vert^{2}\\right]$ reaches the minimum value $\\begin{array}{r}{\\frac{n^{2}\\|\\bar{\\boldsymbol{u}}\\|^{2}-2n n^{\\prime}\\alpha\\|\\bar{\\boldsymbol{u}}\\|_{0}}{(n+n^{\\prime})^{2}}+\\frac{n^{2}d\\sigma^{2}}{(n-1)(n+n^{\\prime})^{2}}.}\\end{array}$ ", "page_idx": 26}, {"type": "text", "text": "Moreover, ", "text_level": 1, "page_idx": 26}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{\\!\\!\\!\\!\\Delta_{(t+k+1)}^{\\mathrm{adv}}\\mathbb{P}_{v_{(0)}\\sim N(\\bar{u},\\frac{\\sigma^{2}}{n-1}I)}^{\\mathrm{adv}}[f_{\\alpha}(u,v^{\\prime})\\neq r\\mid(u,r)]}&{\\leq}\\\\ {\\!\\!\\!\\!\\!2\\Phi\\left(\\frac{\\sqrt{n-1}\\eta}{2\\sigma}\\left(\\frac{n^{2}\\|\\bar{u}\\|^{2}+(n^{\\prime})^{2}\\alpha+2n n^{\\prime}\\alpha\\|\\bar{u}\\|_{0}}{n(n+n^{\\prime})}+\\frac{n d\\sigma^{2}}{(n-1)(n+n^{\\prime})}\\right)\\Psi(u,t+k)\\right)-1,}\\end{array}\n$$", "text_format": "latex", "page_idx": 26}, {"type": "text", "text": "equality holds when ", "page_idx": 27}, {"type": "equation", "text": "$$\n\\begin{array}{c}{\\displaystyle\\mathbb{E}\\left[\\|v_{(0)}^{\\prime}\\|^{2}\\right]=\\frac{n^{2}\\|\\bar{u}\\|^{2}+(n^{\\prime})^{2}\\alpha+2n n^{\\prime}\\alpha\\|\\bar{u}\\|_{0}}{(n+n^{\\prime})^{2}}+\\frac{n^{2}d\\sigma^{2}}{(n-1)(n-1)}}\\\\ {\\displaystyle\\frac{1}{^{\\iota}}\\sum_{(u^{\\prime},r^{\\prime})\\in\\cal Z^{\\prime}}r r^{\\prime}\\langle\\frac{u_{(t+k)}}{\\|u_{(t+k)}\\|},u_{(0)}^{\\prime}\\rangle+\\langle\\frac{r u_{(t+k)}}{\\|u_{(t+k)}\\|},\\bar{u}\\rangle=-\\frac{1}{2}\\eta\\frac{n+n^{\\prime}}{n}\\mathbb{E}\\left[\\|v_{(0)}^{\\prime}\\|^{2}\\right]\\Psi(u,t+k).}\\end{array}\n$$", "text_format": "latex", "page_idx": 27}, {"type": "text", "text": "Hence, Theorem 4 is proved. ", "page_idx": 27}, {"type": "text", "text": "D.3 Proofs for Section 4 ", "text_level": 1, "page_idx": 27}, {"type": "text", "text": "Given any dot-product-based loss function $\\mathcal{L}(\\Theta)$ , characterized by its dependency on the product of user and item embeddings, the gradients of user and item embeddings at the $t^{\\mathrm{th}}$ epoch can be expressed as follows: ", "page_idx": 27}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\nabla_{{\\boldsymbol u}_{(t)}}\\mathcal L({\\boldsymbol u},{\\boldsymbol v}|\\Theta_{(t)})=\\phi\\big(r,{\\boldsymbol u}_{(t)},{\\boldsymbol v}_{(t)}\\big){\\boldsymbol v}_{(t)},}\\\\ &{\\nabla_{{\\boldsymbol v}_{(t)}}\\mathcal L({\\boldsymbol u},{\\boldsymbol v}|\\Theta_{(t)})=\\psi\\big(r,{\\boldsymbol u}_{(t)},{\\boldsymbol v}_{(t)}\\big){\\boldsymbol u}_{(t)},}\\end{array}\n$$", "text_format": "latex", "page_idx": 27}, {"type": "text", "text": "where $\\phi(\\cdot)$ and $\\psi(\\cdot)$ denote coefficient functions derived from $\\mathcal{L}(\\Theta)$ , mapping from the embeddings space to the scalar values. ", "page_idx": 27}, {"type": "text", "text": "Considering the proofs of Theorem 3 and Theorem 4, there is a coefficient \u03b3((tu)) for the user u. When \u03b3((tu)) > 1 is satisfied, the effectiveness of ACF can be guaranteed. Here, we derive the coefficient $\\gamma_{(t)}^{(u)}$ in multi-item recommendation scenarios with dot-product-based loss through the following corollary. ", "page_idx": 27}, {"type": "text", "text": "Corollary 2. Assuming the incorporation of adversarial training as defined in Equation $^{\\,l}$ with dot-product-based loss function $\\mathcal{L}(\\Theta)$ , and given the learning rate $\\eta,$ , the adversarial training weight $\\lambda,$ , and the perturbation scale $\\epsilon_{s}$ , the ${\\boldsymbol\\gamma}_{(t)}^{({\\boldsymbol u})}$ for user u is given by: ", "page_idx": 27}, {"type": "equation", "text": "$$\n\\gamma_{(t)}^{(\\boldsymbol{u})}=\\left(1-\\frac{\\eta\\lambda\\epsilon}{\\|\\boldsymbol{u}_{t}\\|}\\sum_{\\boldsymbol{v}\\in\\mathcal{N}_{\\boldsymbol{u}}}|\\psi(\\boldsymbol{r},\\boldsymbol{u}_{(t)},\\boldsymbol{v}_{(t)})|\\right)^{-1},\n$$", "text_format": "latex", "page_idx": 27}, {"type": "text", "text": "where $\\mathcal{N}_{u}$ is the item set that user u interacts with. ", "page_idx": 27}, {"type": "text", "text": "Proof of Corollary 2. Recall Equation 1. Given a dot-product-based loss function $\\mathcal{L}(\\Theta)$ within the framework of adversarial training: ", "page_idx": 27}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\mathcal{L}_{\\mathrm{ACF}}(\\Theta)=\\mathcal{L}(\\Theta)+\\lambda\\mathcal{L}(\\Theta+\\Delta^{\\mathrm{adv}}),}\\\\ {\\mathrm{where}\\quad\\Delta^{\\mathrm{adv}}=\\arg\\underset{\\Delta,\\parallel\\Delta\\parallel\\leq\\epsilon}{\\operatorname*{max}}\\mathcal{L}(\\Theta+\\Delta),}\\end{array}\n$$", "text_format": "latex", "page_idx": 27}, {"type": "text", "text": "where $\\epsilon>0$ defines the magnitude of perturbation, and $\\lambda$ is the adversarial training weight. Considering any pair $(u,v)$ , the perturbations can be computed as (similar to Equation 14): ", "page_idx": 27}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\Delta_{\\boldsymbol{u}_{(t)}}=\\epsilon\\frac{\\nabla_{\\boldsymbol{u}_{(t)}}\\mathcal{L}(\\boldsymbol{u},\\boldsymbol{v}|\\boldsymbol{\\Theta}_{(t)})}{\\left\\|\\nabla_{\\boldsymbol{u}_{(t)}}\\mathcal{L}(\\boldsymbol{u},\\boldsymbol{v}|\\boldsymbol{\\Theta}_{(t)})\\right\\|},}\\\\ {\\Delta_{\\boldsymbol{v}_{(t)}}=\\epsilon\\frac{\\nabla_{\\boldsymbol{v}_{(t)}}\\mathcal{L}(\\boldsymbol{u},\\boldsymbol{v}|\\boldsymbol{\\Theta}_{(t)})}{\\left\\|\\nabla_{\\boldsymbol{v}_{(t)}}\\mathcal{L}(\\boldsymbol{u},\\boldsymbol{v}|\\boldsymbol{\\Theta}_{(t)})\\right\\|}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 27}, {"type": "text", "text": "The update equations for the embedding of user $\\textbf{\\em u}$ at the $t^{\\mathrm{th}}$ epoch under adversarial perturbations can be expressed as follows: ", "page_idx": 27}, {"type": "equation", "text": "$$\n\\pmb{u}_{(t+1)}=\\pmb{u}_{(t)}-\\sum_{\\pmb{v}\\in\\mathcal{N}_{\\pmb{u}}}\\left(\\eta\\cdot\\nabla_{\\pmb{u}_{(t)}}\\mathcal{L}(\\pmb{u},\\pmb{v}\\mid\\Theta_{(t)})+\\eta\\lambda\\nabla_{\\pmb{u}_{(t)}}\\mathcal{L}(\\pmb{u},\\pmb{v}\\mid\\Theta_{(t)}+\\Delta_{\\mathrm{adv}})\\right),\n$$", "text_format": "latex", "page_idx": 27}, {"type": "text", "text": "where $\\mathcal{N}_{u}$ is the set of items that user $\\textbf{\\em u}$ interacts with. ", "page_idx": 27}, {"type": "text", "text": "By employing the first-order Taylor expansion on $(\\pmb{u}_{(t)}+\\Delta_{\\pmb{u}_{(t)}})$ and $(\\pmb{v}_{(t)}+\\Delta_{\\pmb{v}_{(t)}})$ , we have: ", "page_idx": 28}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\nabla_{{\\boldsymbol u}_{(t)}}\\mathcal L({\\boldsymbol u},{\\boldsymbol v}|\\Theta_{(t)}+\\Delta_{\\mathrm{adv}})}\\\\ &{\\quad\\approx\\nabla_{{\\boldsymbol u}_{(t)}}\\left[\\mathcal L({\\boldsymbol u},{\\boldsymbol v}|\\Theta_{(t)})+\\langle\\Delta_{{\\boldsymbol v}_{(t)}},\\nabla_{{\\boldsymbol v}_{(t)}}\\mathcal L({\\boldsymbol u},{\\boldsymbol v}|\\Theta_{(t)})\\rangle+\\langle\\Delta_{{\\boldsymbol u}_{(t)}},\\nabla_{{\\boldsymbol u}_{(t)}}\\mathcal L({\\boldsymbol u},{\\boldsymbol v}|\\Theta_{(t)})\\rangle\\right.}\\\\ &{\\quad\\quad\\quad\\quad\\quad\\quad\\left.+\\langle\\Delta_{{\\boldsymbol v}_{(t)}},\\left(\\nabla_{{\\boldsymbol u}_{(t)}}\\nabla_{{\\boldsymbol v}_{(t)}}\\mathcal L({\\boldsymbol u},{\\boldsymbol v}|\\Theta_{(t)})\\right)^{\\top}\\Delta_{{\\boldsymbol u}_{(t)}}\\rangle\\right]}\\\\ &{\\quad\\approx\\!\\nabla_{{\\boldsymbol u}_{(t)}}\\mathcal L({\\boldsymbol u},{\\boldsymbol v}|\\Theta_{(t)})+\\left(\\nabla_{{\\boldsymbol u}_{(t)}}\\nabla_{{\\boldsymbol v}_{(t)}}\\mathcal L({\\boldsymbol u},{\\boldsymbol v}|\\Theta_{(t)})\\right)^{\\top}\\Delta_{{\\boldsymbol v}_{(t)}}+\\Bigl(\\nabla_{{\\boldsymbol u}_{(t)}}^{2}\\mathcal L({\\boldsymbol u},{\\boldsymbol v}|\\Theta_{(t)})\\Bigr)^{\\top}\\Delta_{{\\boldsymbol u}_{(t)}}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 28}, {"type": "text", "text": "Subsequently, the update mechanism for the user embedding, incorporating both direct and adversarial gradients, is computed as: ", "page_idx": 28}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{\\Phi_{1}=\\operatorname*{lim}_{\\theta\\rightarrow0}-\\sum_{n\\leq m_{k}}\\Bigg(\\pi_{k}^{n}\\!+\\!1\\!+\\!\\sum_{v_{n}\\in\\mathcal{S}_{m_{k}}}\\!\\!\\big(\\!\\frac{v_{n}}{\\theta t}\\big(\\!-\\!\\theta_{n+1}\\!)\\!+\\!\\gamma\\!\\exp\\big(\\!\\pi_{k}v_{n}\\big(\\!-\\!\\theta_{n+1}\\big(v_{n}\\!)\\big)v_{n}\\big)\\!\\Bigg)^{T}\\Bigg(\\overline{{\\mathbf{R}_{\\infty\\theta}}}\\!+\\!\\frac{\\mathbf{C}_{v_{n}}\\big(u_{n}^{T}\\big(u_{n}\\big)\\big)}{\\theta t}\\!)}\\\\ &{\\quad\\quad+\\!\\eta\\!+\\!\\frac{1}{2}\\!(\\overline{{\\mathbf{R}_{\\infty\\theta}}})G^{\\top}\\!\\!\\exp\\big(\\!-\\!\\frac{\\mathbf{C}_{v_{n}}}{\\theta t}\\big(\\overline{{\\mathbf{R}_{\\infty\\theta}}}\\big(T\\!+\\!\\frac{\\mathbf{C}_{v_{n}}\\big(u_{n}^{T}\\big(u_{n}\\big)\\big)}{\\theta t}\\big)\\big)\\Bigg)}\\\\ &{\\quad\\quad-\\!\\frac{\\mathbf{C}_{v_{n}}}{\\theta t}\\!+\\!1\\!+\\!\\frac{1}{2}\\!(\\overline{{\\mathbf{R}_{\\infty\\theta}}})G^{\\top}\\!\\exp\\big(\\!-\\!\\frac{\\mathbf{C}_{v_{n}}}{\\theta t}\\big(\\overline{{\\mathbf{R}_{\\infty\\theta}}}\\big(T\\!+\\!\\frac{\\mathbf{C}_{v_{n}}\\big(u_{n}^{T}\\big(u_{n}\\big)\\big)}{\\theta t}\\big)\\big)\\Bigg)}\\\\ &{\\quad\\quad\\quad+\\!\\frac{1}{2}\\!\\exp\\bigg(\\!1\\!+\\!\\frac{\\mathbf{C}_{v_{n}}}{\\theta t}\\bigg(\\overline{{\\mathbf{R}_{\\infty\\theta}}}\\bigg(T\\!+\\!\\frac{\\mathbf{C}_{v_{n}}\\big(u_{n}\\big)}{\\theta t}\\bigg(\\overline{{\\mathbf{R}_{\\infty\\theta}}}\\!+\\!\\frac{\\mathbf{C}_{v_{n}}\\big(u_{n}\\big)}{\\theta t}\\bigg(u_{n}\\big)\\!+\\!\\frac{\\mathbf{C}_{v_{n}}}{\\theta t}\\!+\\!\\mathrm{tr}(u_{n+1})\\!)\\!-\\!\\frac{\\mathbf{C}\n$$", "text_format": "latex", "page_idx": 28}, {"type": "text", "text": "Considering Equation 22, for a loss function $\\mathcal{L}(\\Theta)$ based on dot-products, the coefficients of gradients for user embedding $\\textbf{\\em u}$ and item embedding $\\pmb{v}$ , denoted as $\\psi(\\cdot)$ and $\\phi(\\cdot)$ respectively, are still functions based on the dot-product of user embedding $\\textbf{\\em u}$ and item embedding $\\pmb{v}$ . Consequently, the gradients of $\\psi(\\cdot)$ and $\\phi(\\cdot)$ with respect to user embedding $\\textbf{\\em u}$ depend on item embedding $\\pmb{v}$ . Specifically, $\\nabla_{\\pmb{u}_{(t)}}\\psi_{(\\pmb{r},\\pmb{u}_{(t)},\\pmb{v}_{(t)})}=\\xi(\\pmb{r},\\pmb{u}_{(t)},\\pmb{v}_{(t)})\\pmb{v}_{(t)}$ and $\\nabla_{\\pmb{u}_{(t)}}\\phi(\\pmb{r},\\pmb{u}_{(t)},\\pmb{v}_{(t)})\\,=\\,\\xi^{'}(\\pmb{r},\\pmb{u}_{(t)},\\pmb{v}_{(t)})\\pmb{v}_{(t)}$ . Thus, the updated expression for the user embedding $\\pmb{u}_{(t+1)}$ under adversarial training conditions is delineated as follows: ", "page_idx": 28}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\pmb{u}_{(t+1)}=\\left(1-\\displaystyle\\sum_{v\\in\\mathcal{N}_{u}}\\eta\\lambda\\epsilon\\frac{\\psi^{2}(r,u_{(t)},v_{(t)})}{\\|\\nabla_{v_{(t)}}\\mathcal{L}(u,v|\\Theta_{(t)})\\|}\\right)\\pmb{u}_{(t)}}\\\\ &{\\qquad\\qquad-\\eta\\displaystyle\\sum_{v\\in\\mathcal{N}_{u}}\\left((1+\\lambda)\\phi(r,u_{(t)},v_{(t)})+\\lambda\\epsilon\\frac{\\psi(r,u_{(t)},v_{(t)})\\xi(r,u_{(t)},v_{(t)})\\|u_{(t)}\\|^{2}}{\\|\\nabla_{v_{(t)}}\\mathcal{L}(u,v|\\Theta_{(t)})\\|}\\right.}\\\\ &{\\qquad\\qquad\\left.+\\lambda\\epsilon\\frac{\\phi(r,u_{(t)},v_{(t)})\\xi^{'}(r,u_{(t)},v_{(t)})\\|v_{(t)}\\|^{2}}{\\|\\nabla_{u_{(t)}}\\mathcal{L}(u,v|\\Theta_{(t)})\\|}\\right)\\pmb{v}_{(t)}}\\end{array}\n$$", "text_format": "latex", "page_idx": 28}, {"type": "text", "text": "Following the aforementioned Equation 16 and Equation 20, the $\\gamma^{(u)}$ for the user $\\textbf{\\em u}$ in the context of multi-item ACF with a dot-product loss function is given by: ", "page_idx": 29}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\gamma_{(t)}^{(\\mathbf{u})}=\\left(1-\\displaystyle\\sum_{v\\in\\mathcal{N}_{u}}\\eta\\lambda\\epsilon\\frac{\\psi^{2}(r,\\,u_{(t)},v_{(t)})}{\\|\\nabla_{v_{(t)}}\\mathcal{L}(\\mathbf{u},v|\\Theta_{(t)})\\|}\\right)^{-1}}\\\\ &{\\qquad=\\left(1-\\displaystyle\\sum_{v\\in\\mathcal{N}_{u}}\\eta\\lambda\\epsilon\\frac{|\\psi(r,\\,u_{(t)},v_{(t)})||\\psi(r,\\,u_{(t)},v_{(t)})|}{\\|\\nabla_{v_{(t)}}\\mathcal{L}(\\mathbf{u},v|\\Theta_{(t)})\\|}\\right)^{-1}}\\\\ &{\\qquad=\\left(1-\\displaystyle\\frac{\\eta\\lambda\\epsilon}{\\|u_{t}\\|}\\displaystyle\\sum_{v\\in\\mathcal{N}_{u}}|\\psi(r,\\,u_{(t)},v_{(t)})|\\right)^{-1}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 29}, {"type": "text", "text": "Therefore, Corollary 2 is proved. ", "page_idx": 29}, {"type": "text", "text": "Proof of Corollary $^{\\,I}$ . For any dot-product-based loss function $\\mathcal{L}(\\boldsymbol{u},\\boldsymbol{v}|\\Theta)$ , the coefficient functions in Equation 22 can be given by: ", "page_idx": 29}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\nabla_{\\pmb{u}_{(t)}}\\mathscr{L}\\big(\\pmb{u}_{(t)},\\pmb{v}_{(t)}|\\Theta\\big)=\\phi\\big(r,\\pmb{u}_{(t)},\\pmb{v}_{(t)}\\big)\\pmb{v}_{(t)},}\\\\ &{\\nabla_{\\pmb{v}_{(t)}}\\mathscr{L}\\big(\\pmb{u}_{(t)},\\pmb{v}_{(t)}|\\Theta\\big)=\\psi\\big(r,\\pmb{u}_{(t)},\\pmb{v}_{(t)}\\big)\\pmb{u}_{(t)}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 29}, {"type": "text", "text": "Building upon Corollary 2, we can express $\\gamma_{(t)}^{(u)}$ as: ", "page_idx": 29}, {"type": "equation", "text": "$$\n\\gamma_{(t)}^{(\\boldsymbol{u})}=\\left(1-\\frac{\\eta\\lambda\\epsilon}{\\|\\boldsymbol{u}_{t}\\|}\\sum_{\\boldsymbol{v}\\in\\mathcal{N}_{\\boldsymbol{u}}}|\\psi(\\boldsymbol{r},\\boldsymbol{u}_{(t)},\\boldsymbol{v}_{(t)})|\\right)^{-1}.\n$$", "text_format": "latex", "page_idx": 29}, {"type": "text", "text": "Considering the proofs of Theorem 3 and Theorem 4, under $0<(\\gamma_{(t)}^{(u)})^{-1}<1$ , we can guarantee the effectiveness of ACF. Therefore, it implies: ", "page_idx": 29}, {"type": "equation", "text": "$$\n0<\\epsilon_{(t)}^{(\\mathbf{u})}<\\|\\pmb{u}_{(t)}\\|\\cdot\\frac{1}{\\sum_{\\pmb{v}\\in\\mathcal{N}_{\\mathbf{u}}}\\eta\\lambda|\\psi(\\boldsymbol{r},\\pmb{u}_{(t)},\\pmb{v}_{(t)})|}.\n$$", "text_format": "latex", "page_idx": 29}, {"type": "text", "text": "In actual training, the maximum perturbation magnitudes will also be affected by other factors. From the perspective of Corollary 2, we can only conclude that the maximum perturbation magnitude $\\epsilon_{(t),\\mathrm{max}}^{(\\mathbf{\\boldsymbol{u}})}$ for user $\\textbf{\\em u}$ at epoch $t$ is positively related to $\\|u_{(t)}\\|$ . ", "page_idx": 29}, {"type": "text", "text": "Therefore, Corollary 1 is proved. ", "page_idx": 29}, {"type": "text", "text": "NeurIPS Paper Checklist ", "text_level": 1, "page_idx": 30}, {"type": "text", "text": "1. Claims ", "text_level": 1, "page_idx": 30}, {"type": "text", "text": "Question: Do the main claims made in the abstract and introduction accurately reflect the paper\u2019s contributions and scope? ", "page_idx": 30}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 30}, {"type": "text", "text": "Justification: The abstract and introduction clearly articulate the primary contributions and scope of the paper. They accurately summarize the theoretical and experimental findings, explicitly matching the claims made throughout the document. ", "page_idx": 30}, {"type": "text", "text": "Guidelines: ", "page_idx": 30}, {"type": "text", "text": "\u2022 The answer NA means that the abstract and introduction do not include the claims made in the paper.   \n\u2022 The abstract and/or introduction should clearly state the claims made, including the contributions made in the paper and important assumptions and limitations. A No or NA answer to this question will not be perceived well by the reviewers.   \n\u2022 The claims made should match theoretical and experimental results, and reflect how much the results can be expected to generalize to other settings.   \n\u2022 It is fine to include aspirational goals as motivation as long as it is clear that these goals are not attained by the paper. ", "page_idx": 30}, {"type": "text", "text": "2. Limitations ", "text_level": 1, "page_idx": 30}, {"type": "text", "text": "Question: Does the paper discuss the limitations of the work performed by the authors? ", "page_idx": 30}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 30}, {"type": "text", "text": "Justification: The limitations of our work are discussed in Section 6. ", "page_idx": 30}, {"type": "text", "text": "Guidelines: ", "text_level": 1, "page_idx": 30}, {"type": "text", "text": "\u2022 The answer NA means that the paper has no limitation while the answer No means that the paper has limitations, but those are not discussed in the paper.   \n\u2022 The authors are encouraged to create a separate \"Limitations\" section in their paper.   \n\u2022 The paper should point out any strong assumptions and how robust the results are to violations of these assumptions (e.g., independence assumptions, noiseless settings, model well-specification, asymptotic approximations only holding locally). The authors should reflect on how these assumptions might be violated in practice and what the implications would be.   \n\u2022 The authors should reflect on the scope of the claims made, e.g., if the approach was only tested on a few datasets or with a few runs. In general, empirical results often depend on implicit assumptions, which should be articulated.   \n\u2022 The authors should reflect on the factors that influence the performance of the approach. For example, a facial recognition algorithm may perform poorly when image resolution is low or images are taken in low lighting. Or a speech-to-text system might not be used reliably to provide closed captions for online lectures because it fails to handle technical jargon.   \n\u2022 The authors should discuss the computational efficiency of the proposed algorithms and how they scale with dataset size.   \n\u2022 If applicable, the authors should discuss possible limitations of their approach to address problems of privacy and fairness.   \n\u2022 While the authors might fear that complete honesty about limitations might be used by reviewers as grounds for rejection, a worse outcome might be that reviewers discover limitations that aren\u2019t acknowledged in the paper. The authors should use their best judgment and recognize that individual actions in favor of transparency play an important role in developing norms that preserve the integrity of the community. Reviewers will be specifically instructed to not penalize honesty concerning limitations. ", "page_idx": 30}, {"type": "text", "text": "3. Theory Assumptions and Proofs ", "text_level": 1, "page_idx": 30}, {"type": "text", "text": "Question: For each theoretical result, does the paper provide the full set of assumptions and a complete (and correct) proof? ", "page_idx": 30}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 31}, {"type": "text", "text": "Justification: The assumptions are presented in Section 3, and the related proofs are found in Appendix D. ", "page_idx": 31}, {"type": "text", "text": "Guidelines: ", "page_idx": 31}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include theoretical results.   \n\u2022 All the theorems, formulas, and proofs in the paper should be numbered and crossreferenced.   \n\u2022 All assumptions should be clearly stated or referenced in the statement of any theorems.   \n\u2022 The proofs can either appear in the main paper or the supplemental material, but if they appear in the supplemental material, the authors are encouraged to provide a short proof sketch to provide intuition.   \n\u2022 Inversely, any informal proof provided in the core of the paper should be complemented by formal proofs provided in appendix or supplemental material.   \n\u2022 Theorems and Lemmas that the proof relies upon should be properly referenced. ", "page_idx": 31}, {"type": "text", "text": "4. Experimental Result Reproducibility ", "text_level": 1, "page_idx": 31}, {"type": "text", "text": "Question: Does the paper fully disclose all the information needed to reproduce the main experimental results of the paper to the extent that it affects the main claims and/or conclusions of the paper (regardless of whether the code and data are provided or not)? ", "page_idx": 31}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 31}, {"type": "text", "text": "Justification: Experimental information, including datasets, baselines, and evaluation metrics, is provided in Section 5.1, while implementation details are found in Appendix C.1. ", "page_idx": 31}, {"type": "text", "text": "Guidelines: ", "page_idx": 31}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 If the paper includes experiments, a No answer to this question will not be perceived well by the reviewers: Making the paper reproducible is important, regardless of whether the code and data are provided or not.   \n\u2022 If the contribution is a dataset and/or model, the authors should describe the steps taken to make their results reproducible or verifiable.   \n\u2022 Depending on the contribution, reproducibility can be accomplished in various ways. For example, if the contribution is a novel architecture, describing the architecture fully might suffice, or if the contribution is a specific model and empirical evaluation, it may be necessary to either make it possible for others to replicate the model with the same dataset, or provide access to the model. In general. releasing code and data is often one good way to accomplish this, but reproducibility can also be provided via detailed instructions for how to replicate the results, access to a hosted model (e.g., in the case of a large language model), releasing of a model checkpoint, or other means that are appropriate to the research performed.   \n\u2022 While NeurIPS does not require releasing code, the conference does require all submissions to provide some reasonable avenue for reproducibility, which may depend on the nature of the contribution. For example (a) If the contribution is primarily a new algorithm, the paper should make it clear how to reproduce that algorithm. (b) If the contribution is primarily a new model architecture, the paper should describe the architecture clearly and fully. (c) If the contribution is a new model (e.g., a large language model), then there should either be a way to access this model for reproducing the results or a way to reproduce the model (e.g., with an open-source dataset or instructions for how to construct the dataset). (d) We recognize that reproducibility may be tricky in some cases, in which case authors are welcome to describe the particular way they provide for reproducibility. In the case of closed-source models, it may be that access to the model is limited in some way (e.g., to registered users), but it should be possible for other researchers to have some path to reproducing or verifying the results. ", "page_idx": 31}, {"type": "text", "text": "5. Open access to data and code ", "text_level": 1, "page_idx": 31}, {"type": "text", "text": "Question: Does the paper provide open access to the data and code, with sufficient instructions to faithfully reproduce the main experimental results, as described in supplemental material? ", "page_idx": 32}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 32}, {"type": "text", "text": "Justification: The experimental code and data are provided through an anonymous link in Section 1. ", "page_idx": 32}, {"type": "text", "text": "Guidelines: ", "page_idx": 32}, {"type": "text", "text": "\u2022 The answer NA means that paper does not include experiments requiring code.   \n\u2022 Please see the NeurIPS code and data submission guidelines (https://nips.cc/ public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 While we encourage the release of code and data, we understand that this might not be possible, so \u201cNo\u201d is an acceptable answer. Papers cannot be rejected simply for not including code, unless this is central to the contribution (e.g., for a new open-source benchmark).   \n\u2022 The instructions should contain the exact command and environment needed to run to reproduce the results. See the NeurIPS code and data submission guidelines (https: //nips.cc/public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 The authors should provide instructions on data access and preparation, including how to access the raw data, preprocessed data, intermediate data, and generated data, etc.   \n\u2022 The authors should provide scripts to reproduce all experimental results for the new proposed method and baselines. If only a subset of experiments are reproducible, they should state which ones are omitted from the script and why.   \n\u2022 At submission time, to preserve anonymity, the authors should release anonymized versions (if applicable).   \n\u2022 Providing as much information as possible in supplemental material (appended to the paper) is recommended, but including URLs to data and code is permitted. ", "page_idx": 32}, {"type": "text", "text": "6. Experimental Setting/Details ", "text_level": 1, "page_idx": 32}, {"type": "text", "text": "Question: Does the paper specify all the training and test details (e.g., data splits, hyperparameters, how they were chosen, type of optimizer, etc.) necessary to understand the results? ", "page_idx": 32}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 32}, {"type": "text", "text": "Justification: Experimental settings are outlined in Section 5.1. Additional details can be found in Appendix C.1. ", "page_idx": 32}, {"type": "text", "text": "Guidelines: ", "page_idx": 32}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments. \u2022 The experimental setting should be presented in the core of the paper to a level of detail that is necessary to appreciate the results and make sense of them. \u2022 The full details can be provided either with the code, in appendix, or as supplemental material. ", "page_idx": 32}, {"type": "text", "text": "7. Experiment Statistical Significance ", "text_level": 1, "page_idx": 32}, {"type": "text", "text": "Question: Does the paper report error bars suitably and correctly defined or other appropriate information about the statistical significance of the experiments? ", "page_idx": 32}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 32}, {"type": "text", "text": "Justification: The results presented in Section 5 include error bars. The method for calculating these error bars is explained in the implementation details provided in Appendix C.1. ", "page_idx": 32}, {"type": "text", "text": "Guidelines: ", "page_idx": 32}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments. \u2022 The authors should answer \"Yes\" if the results are accompanied by error bars, confidence intervals, or statistical significance tests, at least for the experiments that support the main claims of the paper. ", "page_idx": 32}, {"type": "text", "text": "\u2022 The factors of variability that the error bars are capturing should be clearly stated (for example, train/test split, initialization, random drawing of some parameter, or overall run with given experimental conditions).   \n\u2022 The method for calculating the error bars should be explained (closed form formula, call to a library function, bootstrap, etc.)   \n\u2022 The assumptions made should be given (e.g., Normally distributed errors).   \n\u2022 It should be clear whether the error bar is the standard deviation or the standard error of the mean.   \n\u2022 It is OK to report 1-sigma error bars, but one should state it. The authors should preferably report a 2-sigma error bar than state that they have a $96\\%$ CI, if the hypothesis of Normality of errors is not verified.   \n\u2022 For asymmetric distributions, the authors should be careful not to show in tables or figures symmetric error bars that would yield results that are out of range (e.g. negative error rates).   \n\u2022 If error bars are reported in tables or plots, The authors should explain in the text how they were calculated and reference the corresponding figures or tables in the text. ", "page_idx": 33}, {"type": "text", "text": "8. Experiments Compute Resources ", "text_level": 1, "page_idx": 33}, {"type": "text", "text": "Question: For each experiment, does the paper provide sufficient information on the computer resources (type of compute workers, memory, time of execution) needed to reproduce the experiments? ", "page_idx": 33}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 33}, {"type": "text", "text": "Justification: We provide sufficient information on the computer resources in Appendix C.1. Guidelines: ", "page_idx": 33}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The paper should indicate the type of compute workers CPU or GPU, internal cluster, or cloud provider, including relevant memory and storage.   \n\u2022 The paper should provide the amount of compute required for each of the individual experimental runs as well as estimate the total compute.   \n\u2022 The paper should disclose whether the full research project required more compute than the experiments reported in the paper (e.g., preliminary or failed experiments that didn\u2019t make it into the paper). ", "page_idx": 33}, {"type": "text", "text": "9. Code Of Ethics ", "text_level": 1, "page_idx": 33}, {"type": "text", "text": "Question: Does the research conducted in the paper conform, in every respect, with the NeurIPS Code of Ethics https://neurips.cc/public/EthicsGuidelines? ", "page_idx": 33}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 33}, {"type": "text", "text": "Justification: We conform with the NeurIPS Code of Ethics. ", "page_idx": 33}, {"type": "text", "text": "Guidelines: ", "page_idx": 33}, {"type": "text", "text": "\u2022 The answer NA means that the authors have not reviewed the NeurIPS Code of Ethics.   \n\u2022 If the authors answer No, they should explain the special circumstances that require a deviation from the Code of Ethics.   \n\u2022 The authors should make sure to preserve anonymity (e.g., if there is a special consideration due to laws or regulations in their jurisdiction). ", "page_idx": 33}, {"type": "text", "text": "10. Broader Impacts ", "text_level": 1, "page_idx": 33}, {"type": "text", "text": "Question: Does the paper discuss both potential positive societal impacts and negative societal impacts of the work performed? ", "page_idx": 33}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 33}, {"type": "text", "text": "Justification: The robust recommendation algorithm has a positive impact on the field of recommender systems. The impact is discussed in Section 6. ", "page_idx": 33}, {"type": "text", "text": "Guidelines: ", "page_idx": 33}, {"type": "text", "text": "\u2022 The answer NA means that there is no societal impact of the work performed. ", "page_idx": 33}, {"type": "text", "text": "\u2022 If the authors answer NA or No, they should explain why their work has no societal impact or why the paper does not address societal impact.   \n\u2022 Examples of negative societal impacts include potential malicious or unintended uses (e.g., disinformation, generating fake profiles, surveillance), fairness considerations (e.g., deployment of technologies that could make decisions that unfairly impact specific groups), privacy considerations, and security considerations.   \n\u2022 The conference expects that many papers will be foundational research and not tied to particular applications, let alone deployments. However, if there is a direct path to any negative applications, the authors should point it out. For example, it is legitimate to point out that an improvement in the quality of generative models could be used to generate deepfakes for disinformation. On the other hand, it is not needed to point out that a generic algorithm for optimizing neural networks could enable people to train models that generate Deepfakes faster.   \n\u2022 The authors should consider possible harms that could arise when the technology is being used as intended and functioning correctly, harms that could arise when the technology is being used as intended but gives incorrect results, and harms following from (intentional or unintentional) misuse of the technology.   \n\u2022 If there are negative societal impacts, the authors could also discuss possible mitigation strategies (e.g., gated release of models, providing defenses in addition to attacks, mechanisms for monitoring misuse, mechanisms to monitor how a system learns from feedback over time, improving the efficiency and accessibility of ML). ", "page_idx": 34}, {"type": "text", "text": "11. Safeguards ", "text_level": 1, "page_idx": 34}, {"type": "text", "text": "Question: Does the paper describe safeguards that have been put in place for responsible release of data or models that have a high risk for misuse (e.g., pretrained language models, image generators, or scraped datasets)? ", "page_idx": 34}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 34}, {"type": "text", "text": "Justification: The paper poses no such risks. Guidelines: ", "page_idx": 34}, {"type": "text", "text": "\u2022 The answer NA means that the paper poses no such risks.   \n\u2022 Released models that have a high risk for misuse or dual-use should be released with necessary safeguards to allow for controlled use of the model, for example by requiring that users adhere to usage guidelines or restrictions to access the model or implementing safety filters.   \n\u2022 Datasets that have been scraped from the Internet could pose safety risks. The authors should describe how they avoided releasing unsafe images.   \n\u2022 We recognize that providing effective safeguards is challenging, and many papers do not require this, but we encourage authors to take this into account and make a best faith effort. ", "page_idx": 34}, {"type": "text", "text": "12. Licenses for existing assets ", "text_level": 1, "page_idx": 34}, {"type": "text", "text": "Question: Are the creators or original owners of assets (e.g., code, data, models), used in the paper, properly credited and are the license and terms of use explicitly mentioned and properly respected? ", "page_idx": 34}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 34}, {"type": "text", "text": "Justification: The original papers that produced the code package or dataset are cited in both Section 5 and Appendix C.1. ", "page_idx": 34}, {"type": "text", "text": "Guidelines: ", "page_idx": 34}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not use existing assets.   \n\u2022 The authors should cite the original paper that produced the code package or dataset.   \n\u2022 The authors should state which version of the asset is used and, if possible, include a URL.   \n\u2022 The name of the license (e.g., CC-BY 4.0) should be included for each asset.   \n\u2022 For scraped data from a particular source (e.g., website), the copyright and terms of service of that source should be provided.   \n\u2022 If assets are released, the license, copyright information, and terms of use in the package should be provided. For popular datasets, paperswithcode.com/datasets has curated licenses for some datasets. Their licensing guide can help determine the license of a dataset.   \n\u2022 For existing datasets that are re-packaged, both the original license and the license of the derived asset (if it has changed) should be provided.   \n\u2022 If this information is not available online, the authors are encouraged to reach out to the asset\u2019s creators. ", "page_idx": 34}, {"type": "text", "text": "", "page_idx": 35}, {"type": "text", "text": "13. New Assets ", "text_level": 1, "page_idx": 35}, {"type": "text", "text": "Question: Are new assets introduced in the paper well documented and is the documentation provided alongside the assets? ", "page_idx": 35}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 35}, {"type": "text", "text": "Justification: We provide the code via both an anonymized URL (in Section 1) and an anonymized zip file. ", "page_idx": 35}, {"type": "text", "text": "Guidelines: ", "page_idx": 35}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not release new assets.   \n\u2022 Researchers should communicate the details of the dataset/code/model as part of their submissions via structured templates. This includes details about training, license, limitations, etc.   \n\u2022 The paper should discuss whether and how consent was obtained from people whose asset is used.   \n\u2022 At submission time, remember to anonymize your assets (if applicable). You can either create an anonymized URL or include an anonymized zip file. ", "page_idx": 35}, {"type": "text", "text": "14. Crowdsourcing and Research with Human Subjects ", "text_level": 1, "page_idx": 35}, {"type": "text", "text": "Question: For crowdsourcing experiments and research with human subjects, does the paper include the full text of instructions given to participants and screenshots, if applicable, as well as details about compensation (if any)? ", "page_idx": 35}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 35}, {"type": "text", "text": "Justification: The paper does not involve crowdsourcing nor research with human subjects. Guidelines: ", "page_idx": 35}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Including this information in the supplemental material is fine, but if the main contribution of the paper involves human subjects, then as much detail as possible should be included in the main paper.   \n\u2022 According to the NeurIPS Code of Ethics, workers involved in data collection, curation, or other labor should be paid at least the minimum wage in the country of the data collector. ", "page_idx": 35}, {"type": "text", "text": "15. Institutional Review Board (IRB) Approvals or Equivalent for Research with Human Subjects ", "text_level": 1, "page_idx": 35}, {"type": "text", "text": "Question: Does the paper describe potential risks incurred by study participants, whether such risks were disclosed to the subjects, and whether Institutional Review Board (IRB) approvals (or an equivalent approval/review based on the requirements of your country or institution) were obtained? ", "page_idx": 35}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 35}, {"type": "text", "text": "Justification: The paper does not involve crowdsourcing nor research with human subjects. Guidelines: ", "page_idx": 35}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Depending on the country in which research is conducted, IRB approval (or equivalent) may be required for any human subjects research. If you obtained IRB approval, you should clearly state this in the paper.   \n\u2022 We recognize that the procedures for this may vary significantly between institutions and locations, and we expect authors to adhere to the NeurIPS Code of Ethics and the guidelines for their institution.   \n\u2022 For initial submissions, do not include any information that would break anonymity (if applicable), such as the institution conducting the review. ", "page_idx": 35}, {"type": "text", "text": "", "page_idx": 36}]