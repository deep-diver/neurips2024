[{"type": "text", "text": "Unlock the Intermittent Control Ability of Model Free Reinforcement Learning ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Jiashun Liu, Jianye Hao& Xiaotian Hao Yi Ma College of Intelligence and Computing School of Computer and Information Technology Tianjin University Shanxi University China China ", "page_idx": 0}, {"type": "text", "text": "YAN ZHENG   \nTianjin University   \nChina   \nyanzheng@tju.edu.cn   \nYujing Hu & Tangji Lv   \nFUXI AI Laboratory   \nNetEase   \nChina ", "page_idx": 0}, {"type": "text", "text": "", "page_idx": 0}, {"type": "text", "text": "Abstract ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Intermittent control problems are common in real world. The interactions between the decision maker and the executor can be discontinuous (intermittent) due to various types of interruptions, e.g. unstable communication channel. Due to intermittent interaction, agents are unable to acquire the state sent by the executor and cannot transmit actions to the executor within a period of time step, i.e. bidirectional blockage, which may lead to inefficiencies of reinforcement learning policies and prevent the executors from completing the task. Such problem is not well studied in the RL community. In this paper, we model Intermittent Control Problem as an Intermittent Control Markov Decision Process, i.e., agents are expected to generate action sequences corresponding to the unavailable states and transmit them before disabling interactions to ensure the smooth and effective motion of executors. However, directly generating multiple future actions in the original action space has unnatural motion issue and exploration difficulty. We propose Multi-step Action RepreSentation (MARS), which encodes a sequence of actions from the original action space to a compact and decodable latent space. Then based on the latent action sequence representation, the mainstream RL methods can be easily optimized to learn a smooth and efficient motion policy. Extensive experiments on simulation tasks and real-world robotic grasping tasks show that MARS significantly improves the learning efficiency and final performances compared with existing baselines. ", "page_idx": 0}, {"type": "text", "text": "1 Introduction ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "In recent years, the field of deep reinforcement learning (DRL) has witnessed striking empirical achievements in a variety of Markov Decision Process (MDP) problems [Mnih et al., 2013, Kaufmann et al., 2023] and has been successfully applied to many real-time control tasks [Mahmood et al., 2018, Lee et al., 2020]. In real-time control, \u201cinteraction\" plays a crucial role. At each time step, the decision maker obtains observations from the environment and feeds actions back to the action executor through real-time interactions. Thus, in an ideal MDP setting, the interaction should be continuous. However, in many scenarios, interactions become intermittent due to limitations of realistic conditions [Jiang et al., 2021] or communication interruption (e.g., unstable network) [Dong et al., 2009]. Due to bidirectional communication blockage caused by intermittent interaction, agents (decision makers) are unable to acquire the state sent by the executor and cannot transmit actions to the executor within a period of time step (as shown in Figure 1 (top). The sparse observations resulting from this phenomenon can make normal step-by-step decisions unstable. Thus, directly deploying existing DRL algorithms could make the action executor abruptly stop (can not make decision when the current state is unavailable) or move abnormally when the environment suddenly changes [Sutton and Barto, 2018]. ", "page_idx": 0}, {"type": "text", "text": "", "page_idx": 1}, {"type": "text", "text": "Typically, there are two types of intermittent interactions. Illustrations are shown in Figure 1(bottom). \u2776Fixed interaction interval: in numerous real-world robot scenarios, interacting with the environment is often timeconsuming and costly [Liu et al., 2020]. For example, before the robotic arm performs its next actions, it has to first halt its current operations, move to a designated position to capture an image, and then use a specific technique to extract features and provide them to the decision maker. To ensure reliable operation and stable movement, we usually set a fixed interaction interval for the robot arm [Jiang et al., 2021, Bonarini, 2020]. \u2777Random interaction interval: unexpected interaction intervals may occur due to unstable communication channels and loss of wireless signals [Li et al., 2016]. For example, in real-time strategy games, the ", "page_idx": 1}, {"type": "image", "img_path": "eC5qdC4ZTQ/tmp/996f97398647267aa3df24f6dc61e319de1808421d313d498659629f0dfe9fcc.jpg", "img_caption": ["Constant interaction interval Random interaction interval Figure 1: Detail of Intermitted Control (top part). Two types of intermittent interactions (bottom part). For both cases, we can generate a sequence of actions in advance for the next $c$ states based on the current state $s_{t}$ to make the control more smooth and robust. "], "img_footnote": [], "page_idx": 1}, {"type": "text", "text": "decision end remotely controls the terminal non-player characters (NPC) [Zheng et al., 2019], the interaction interval between the decision end and NPC terminals may become random [Wong et al., 2021] due to above reasons, which may cause the NPC to be stuck and disconnected from the changed environment, reducing the player\u2019s experience. ", "page_idx": 1}, {"type": "text", "text": "The essence of addressing the two aforementioned intermittent control tasks is identical, that is, to achieve intensive control under sparse interaction (or observation) to ensure the effective and smooth movement of the executor, ultimately leading to efficient task completion. To this end, we introduce Intermittent-MDP (refer to Sec.3 for further elaboration) to model the above two settings in a unified manner, that is, the agent is expected to decide on a sequence of actions based on the current state, covering a suitable number of time steps, to maintain smooth and efficient motion of the executor between the two interactions. The most direct approach would be to employ modelbased reinforcement learning (MBRL) methods with multi-step decision-making capabilities, such as Dreamer [Hafner et al., 2023] and TD-MPC [Hansen et al., 2022]. Regrettably, the form of multi-step decision makes the error of the dynamic model accumulate and then make the policies suboptimal. In addition, the high demand for high-quality data and the complexity of constructing dynamic models makes MBRL deployment costly in real-world scenarios [Janner et al., 2019] (detailed experimental analysis in Appendix C.1). Instead, we sought to unlock the multi-step decision-making ability of the model-free DRL approach, e.g. TD3 [Fujimoto et al., 2018] and PPO [Schulman et al., 2017]. ", "page_idx": 1}, {"type": "text", "text": "The most simple method for model-free DRL to alleviate the intermittent interaction issue is using frameskip (also commonly known as \u2018action-repeat\u2019) [Kalyanakrishnan et al., 2021], where the same action (usually the last action) is repeated during a fixed interval which is often used in Atari [Braylan et al., 2015]. However, longer frameskip will lead to mechanized motion, making it impossible for the agent to change actions at key states and thus resulting in suboptimal policies. Another way is to let the RL algorithms make up-front decisions (advance decisions) for future steps according to the current state or the received delayed state. Only actions for the correct time steps will be executed. Compared to frameskip, these methods can improve action diversity. However, directly increasing the horizon of decision making will lead to action space explosion and increase the difficulty of policy optimization [Chen et al., 2021]. ", "page_idx": 1}, {"type": "text", "text": "In this paper, we propose Multi-step Action RepreSentation (MARS), which is the first plugin method for DRL algorithms to solve intermittent control tasks, significantly reducing the difficulty of multi-step policy training while ensuring the flexibility and diversity. The high level idea is shown in Figure 2. MARS constructs a compact and decodable low dimensional latent action space for the original multi-step actions, the latent action dimension does not explode as the steps number increases. Based on this latent action space agent can learn a stable latent policy. The latent action selected by the policy can be reconstructed into original multi-step actions by the decoder. Specifically, MARS relies on a conditional Variational Auto-encoder (c-VAE) [Sohn et al., 2015] to construct the latent representation space for the associated multi-step actions. Intuitively, an efficient latent action space should have two characteristics: $\\pmb{\\mathrm{\\Sigma}}$ Decision space simplification: the combination number of long-sequence actions is huge, especially in the continuous action space, which can complicate the decision space and potentially result in suboptimal policies. We restrict the decision space to a relatively small subspace by introducing the concept of action transfer scale $\\upsilon$ and taking it as the condition term of our VAE, i.e. using $\\upsilon$ to implicit segment the latent space [Sohn et al., 2015]. $\\pmb{\\varphi}$ Dynamic semantic smoothness, a characteristic of the original action space, which means latent actions that have similar impacts on the environment should be close together in latent spaces. Dynamic semantic smooth action space can retain the utility of adding Gaussian noise perturbations to the policy during training: While ensuring that the impacts of initial latent action chosen by the policy and latent action after disturbance on the environment is similar in high probability, some uncertainty is also retained that the disturbed action may explore rare actions that have unknown impacts on the environment, which helps maintain a balance between exploration and exploitation [Schwarzer et al., 2020]. We utilize unsupervised environmental dynamics to learn a predictive representation of dynamics for improving semantic smoothness. In practice, we adding an additional dynamic residual prediction module for VAE. ", "page_idx": 1}, {"type": "text", "text": "", "page_idx": 2}, {"type": "text", "text": "Our contributions are summarized as follows: $\\ngtr$ We propose the first plugin method and DRL framework for solving intermittent control tasks via multi-step action representation learning. $\\ngtr$ We provide two modules to improve the effectiveness and smoothness of the learned multi-step latent space. $\\ngtr$ Our method outperforms baselines on both realworld fixed interaction interval robotic control tasks and random interaction interval simulation control tasks. ", "page_idx": 2}, {"type": "image", "img_path": "eC5qdC4ZTQ/tmp/ec0ac62a4e97483f6a91052f125d9a0c10a28e768fd2fe6c2359b5d7d1b84eb5.jpg", "img_caption": ["Figure 2: Conceptual overview of MARS. "], "img_footnote": [], "page_idx": 2}, {"type": "text", "text": "2 Background ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "Markov Decision Process (MDP). A MDP can be represented as a tuple: $(S,\\mathcal{A},\\mathcal{P},\\mathcal{R},\\gamma,T)$ , where $\\boldsymbol{S}$ denotes the state set, $\\boldsymbol{\\mathcal{A}}$ denotes an action set, $\\mathcal{P}$ is the transition function: $\\mathcal{S}\\times\\mathcal{A}\\times\\mathcal{S}\\rightarrow[0,1]$ and $\\mathcal{R}$ is the reward function: $S\\times A\\to\\mathbb{R}$ . $\\gamma\\in[0,1)$ is a discount factor and $T$ is the decision horizon. The goal is to optimize the agent\u2019s policy to maximize the expected discounted cumulative reward. ", "page_idx": 2}, {"type": "text", "text": "Variational Auto-Encoder. The variational auto-encoder (VAE) is a directed graphical model with certain types of latent variables, such as Gaussian latent variables. A generative process of the VAE is as follows: a set of latent variable $z$ is generated from the prior distribution $p_{\\theta}(z)$ and the data ${\\bf X}$ is generated by the generative distribution $p_{\\theta}(x|z)$ conditioned on $z:z\\sim p_{\\theta}(z),x\\sim p_{\\theta}(x|z)$ . In general, parameter estimation of directed graphical models is often challenging due to intractable posterior inference. However, the parameters of the VAE can be estimated efficiently using the stochastic gradient variational Bayes (SGVB) framework, where the variational lower bound of the log-likelihood is used as a surrogate objective function. In this framework, a proposal distribution $q_{\\theta}(x|z)$ , is introduced to approximate the true posterior $p_{\\theta}(x|z)$ . MLPs are used to model the recognition and the generation models. Based on the Gaussian latent assumption, the first term of Eq.1 can be marginalized. The second term can be approximated by drawing samples $z^{(l)}(l=1,...,L)$ by the proposal distribution $q_{\\theta}(x|z)$ . The empirical objective of the VAE is written as: ", "page_idx": 2}, {"type": "equation", "text": "$$\nL_{V A E}(\\phi,\\psi)=\\frac{1}{L}\\sum_{\\theta}(x|z^{(l)})-K L\\big(q_{\\phi}(z|x)||N(0,I)\\big)\n$$", "text_format": "latex", "page_idx": 2}, {"type": "text", "text": "3 Intermittent Control Markov Decision Process (Intermittent-MDP) ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "In this section, we introduce the Intermittent Control Markov Decision Process (Intermittent-MDP) to model both fixed and random interaction interval control problems. The objective of IntermittentMDP is to train the policy to decide on an effective action sequence $u$ based on the current state $s$ , which should be longer than or equal to the maximum interaction interval $c$ , thus ensuring smooth and efficient motion of executor between the two interactions. ", "page_idx": 3}, {"type": "text", "text": "Definition of Intermittent-MDP. Intermittent-MDP $(\\mathcal{M})$ can be represented as a tuple: $\\mathcal{M}\\triangleq\\langle\\mathcal{S},\\mathcal{U},\\mathcal{R},\\mathcal{K},\\mu_{0}\\rangle$ . $S\\in\\mathbb{R}^{n}$ is the state space, $\\mathcal{U}$ is the set of action sequence $u$ that the policy can select. and $\\mu_{0}$ denotes the initial state distribution. The reward is defined as $\\mathcal{R}$ , $\\kappa$ is the multi-step transition function. ", "page_idx": 3}, {"type": "text", "text": "Different from normal MDP in which the agent makes a decision $a_{t}$ according to the current state $s_{t}$ , intermittent-MDP requires the agent to generate an action sequence $u_{t}=\\{a_{t},...,a_{t+c}\\}$ according to the received state $s_{t}(a_{t}$ is the single step action at timestep $t$ ). The cumulative rewards of executed actions can be received in the next interaction. Policy $\\pi$ takes current state to select action sequence $u_{t}=\\{a_{t},...,a_{t+c}\\}$ . When the interaction interval is present for $j$ timesteps, the executor uses $j$ single-step actions in the action sequence $u$ to maintain the motion $(j\\in\\{0,1,...,c\\})$ . When the interaction is continuous, the executor uses the first single-step action in $u$ each time (degenerated to the transition function $\\mathcal{P}$ in normal MDP). Thus, the environment transition function $\\kappa$ is defined as: ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\mathcal{K}(s_{t+j}|s_{t},u_{t})=\\Pi_{i=t}^{t+j-1}\\mathcal{P}(s_{i+1}|s_{i},a_{i})\\pi(u_{t}|s_{t})\\;\\;j\\in\\{0,1,...,c\\},\\;a_{i}\\in u_{t}.\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "If the interval is random and we only know the maximum number of interval step $c$ , Intermittent-MDP is represented as random Intermittent-MDP. When the interval time is fixed, Intermittent-MDP represents a fixed interaction interval problem, i.e., fixed Intermittent-MDP. ", "page_idx": 3}, {"type": "text", "text": "4 Multi-step Action Representation ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "In this section, we introduce Multi-step Action Representation (MARS), a novel framework that can map long action sequences into an efficient latent space. We hypothesize that multi-step actions reside on a homogeneous manifold. To learn the multi-step action representation, we employ VAE to constructing a compact and decodable latent representation space to approximate such a manifold. ", "page_idx": 3}, {"type": "text", "text": "To align our latent action space with the two characteristics mentioned in Sec.1, i.e. $\\textcircled{1}$ Decision space simplification $\\circledcirc$ Dynamic semantic smoothness. In Sec.4.1, we introduce the concept of action transition scale and encode this as a conditional aid in VAE training to simplify the decision space of the policy. In Sec.4.2, we demonstrate how state residual prediction can be leveraged to smooth the semantics of dynamic transitions in latent action spaces, and in Sec.4.3, we illustrate the combination of MARS with DRL, as well as the extension of our approach to random intermittent-MDP. ", "page_idx": 3}, {"type": "text", "text": "4.1 Scale-Conditioned Multi-step Action Encoding and Decoding ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "Although VAE has been proven to be able to construct a compact and effective latent action space for normal MDP with state $s$ as the prior condition [Li et al., 2021], due to the complex combinatorial nature of multi-step actions in Intermittent-MDP, the policy still struggles to explore the optimal actions in the vast action space. Therefore, to address this challenge, we introduce the concept of action transition scale $\\upsilon$ as a conditional term in VAE, to constructs the multi-step latent action space $\\mathcal{Z}$ . $\\upsilon$ stands for a description of the motion style, it represents the accumulation of action change scales within each action sequence $u$ . By determining $\\upsilon$ , we can constrain the latent action $z\\in Z$ chosen by the policy within a related subspace [Sohn et al., 2015] in which all candidate action sequences have the same motion style in terms of $\\upsilon$ , thus reducing the difficulty of exploration. We choose $\\upsilon$ as a conditional term due to its task-specific nature. For instance, in robot scenarios, to ensure the balance of the robot and prevent joint damage, the scale of action changes is typically small. In some obstacle avoidance tasks, however, the magnitude of action changes can be significant when the agent encounters suddenly approaching obstacles. Once the policy roughly determines the appropriate action transfer scale for the current state, it can make more suitable decisions, making the policy more efficient and controllable in the complex action space. Notably $\\upsilon$ does not need to be set manually but is selected adaptively by the policy through training, which is described in detail in Sec.4.3. We formulate $\\upsilon$ as follows: ", "page_idx": 3}, {"type": "text", "text": "", "page_idx": 4}, {"type": "equation", "text": "$$\nv_{u_{t}}=\\frac{\\sum_{i=t}^{c-1}||a_{i+1}-a_{i}||}{(c-1)\\times B}.\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "$c$ is the maximum interval and $B$ denotes the upper limit of action change. The numerator part represents the total absolute difference between consecutive actions, used to assess the transition magnitude of $u_{t}$ . Eq.3 normalizes $\\upsilon_{u_{t}}$ to $[0,1]$ . ", "page_idx": 4}, {"type": "text", "text": "Given an action sequence $u_{t}$ and the corresponding states $s_{t:t+c}$ , our encoder $q_{\\phi}(z_{u_{t}}|u_{t},s_{t:t+c},v_{u_{t}})$ parameterized by $\\phi$ takes $s_{t:t+c}$ and the action transition scale $\\boldsymbol{v}_{u_{t}}$ as conditions to build a multistep latent action space, and maps the action sequence $u_{t}$ into the latent variable $\\boldsymbol{z}_{u_{t}}\\,\\in\\,\\mathbb{R}^{d_{1}}$ $d_{1}$ denotes the dimension of $z_{u_{t}}$ ). The decoder $p_{\\psi}(\\hat{u}_{t}|\\boldsymbol{z}_{u_{t}},\\boldsymbol{s}_{t},\\boldsymbol{v}_{u_{t}})$ parameterized by $\\psi$ then reconstructs the multi-step actions $u_{t}$ from $z_{u_{t}}$ . We employ a Gaussian latent distribution $N\\!\\left(\\mu_{z},\\sigma_{z}\\right)$ to model $q_{\\phi}(z_{u_{t}}|u_{t},s_{t:t+c},v_{u_{t}})$ where $\\mu_{z}$ and $\\sigma_{z}$ are the mean and standard deviation outputted by the encoder. The decoder decodes $z_{u_{t}}\\,\\sim\\,N(\\mu_{z_{u_{t}}},\\sigma_{z_{u_{t}}})$ as following: $\\hat{u}_{t}\\,=\\,g_{\\psi_{1}}\\,\\circ\\,p_{\\psi_{0}}\\bigl(z_{u_{t}},s_{t},v_{u_{t}}\\bigr)$ , $g_{\\psi_{1}}$ is a fully-connected layer for reconstruction. $\\circ$ denotes cascade, i.e. the output of $p_{\\psi_{0}}$ acts as the input of $g_{\\psi_{1}}$ . We utilize cascaded heads because traditional parallel heads, employed for both reconstruction and state residual prediction, can interfere with optimizing individual objectives and impede the learning of the shared representation [Azabou et al., 2021]. $p_{\\psi_{0}}$ denotes the shared layers of the decoder. $\\psi_{i\\in\\{1,2\\}}$ denote the parameters of the prediction networks. The loss function of our VAE is: ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\begin{array}{r}{L_{V A E}\\big(\\phi,\\psi\\big)=\\mathbb{E}_{s,u\\sim D,z\\sim q_{\\psi}}\\big[\\|\\hat{u}_{t}-u_{t}\\|_{2}^{2}+D_{K L}\\big(q_{\\phi}\\big(\\cdot|u_{t},s_{t:t+c},v_{u_{t}}\\big)\\|N(0,I)\\big)\\big],}\\end{array}\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "where $D$ is the buffer. The first term is the reconstruction loss (using MSE) of the action sequence, the last term is the Kullback Leibler divergence $D_{K L}$ between the variational posterior of latent representation $z$ and the standard Gaussian prior. By using the reparameterization trick [Kingma and Welling, 2013], $\\hat{u}_{t}$ is differentiable with respect to $\\psi$ and $\\phi$ . For any latent variables $z_{u_{t}}$ , it can be decoded into multi-step actions $\\hat{u}_{t}$ conveniently by the VAE decoder. That is, ", "page_idx": 4}, {"type": "equation", "text": "$$\n:\\!z_{u_{t}}\\sim q_{\\phi}\\big(\\cdot\\big|u_{t},s_{t:t+c},v_{u_{t}}\\big)\\quad\\forall\\:s_{t:t+c},u_{t},v_{u_{t}}\n$$", "text_format": "latex", "page_idx": 4}, {"type": "equation", "text": "$\\dot{\\cdot}\\hat{u}_{t}=g_{\\psi_{1}}\\circ p_{\\psi_{0}}(z_{u_{t}},s_{t},v_{u_{t}})\\quad\\forall\\,\\,s,z_{u_{t}},v_{u_{t}}$ ", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "4.2 Dynamic-Aware Multi-step Action Representation ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "In section 4.1, we introduce how to build a decodable representation space for multi-step actions. However, it is still inefficient to learn the policy and value functions in the latent action space learned by the above VAE. In comparison to the real-world action space, the current construction of our action space lacks a crucial attribute: dynamic semantic smoothness. This refers to the manifestation of differences in environmental impact through the Euclidean distance between points in the latent space, where closer points correspond to ", "page_idx": 4}, {"type": "image", "img_path": "eC5qdC4ZTQ/tmp/265d3d7e78168bb03e59c14c453a5d786c45e6ca714e8cabbb82dd5b1b9960b5.jpg", "img_caption": ["", "Figure 3: Architecture of MARS. \u2018t\u2019 denotes different steps at different stage. Both $z_{u_{t}}$ and $z_{t}$ refer to variables in $Z$ , but they are used in different stages (the same goes for $\\upsilon_{u_{t}}$ and $\\upsilon_{t}$ ). "], "img_footnote": [], "page_idx": 4}, {"type": "text", "text": "more similar impacts. To address this issue, we further apply an unsupervised learning loss based on environmental dynamics prediction to refine the multi-step action representation. Relevant proof can be found in [Whitney et al., 2019]. MARS captures the environmental dynamics by predicting the state transition residual. We use the state transition as a measure of environmental dynamic becuase: ", "page_idx": 4}, {"type": "text", "text": "$\\pmb{\\mathrm{\\Sigma}}$ State transition does not require a per-step reward, it can be used in reward-agnostic pretraining. $\\pmb{\\varphi}$ Building value equivalent models is more difficult since Q-values in the early stage of training are inaccurate [Wang et al., 2016]. In contrast, state transition is more reliable and accessible. $\\pmb{\\otimes}$ The same reward or Q-value may correspond to different environmental dynamics, but the same environmental dynamics have the same reward or Q-value. ", "page_idx": 4}, {"type": "text", "text": "Specifically, MARS predicts the residual difference between the state $s_{t+c}$ after the execution of $u_{t}$ and the current state $s_{t}$ . As shown in the left of Figure 3, $h_{\\psi_{2}}$ is a subnetwork of the decoder. For any transition sample $(s_{t},u_{t},s_{t+c})$ , we denote the state residual as $\\delta_{s_{t},s_{t+1}}=s_{t+c}-s_{t}$ and denote $p_{s t a t e}=h_{\\psi_{2}}\\circ p_{\\psi}$ . The residual $\\hat{\\delta}_{s_{t},s_{t+c}}$ is predicted as: ", "page_idx": 5}, {"type": "equation", "text": "$$\n\\hat{\\delta}_{s_{t},s_{t+c}}=p_{s t a t e}(z_{u_{t}},s_{t},v_{u_{t}})\\mathrm{~\\\\\\}\\forall\\,s_{t},z_{u_{t}},{\\upsilon}_{u_{t}}.\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "The environmental transition prediction loss is defined as: ", "page_idx": 5}, {"type": "equation", "text": "$$\nL_{d y}(\\phi,\\psi)=\\mathbb{E}_{s_{t},u_{t},s_{t+c}}\\big[\\|\\hat{\\delta}_{s_{t},s_{t+c}}-\\delta_{s_{t},s_{t+c}}\\|\\big].\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "Above all, the ultimate training loss for the multi-step action representation is: ", "page_idx": 5}, {"type": "equation", "text": "$$\nL_{M A R S}(\\phi,\\psi)=L_{V A E}(\\phi,\\psi)+\\beta L_{d y}(\\phi,\\psi),\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "where $\\beta$ is a hyper-parameter that controls the relative importance of the $L_{d y}$ and $L_{V A E}$ . $L_{M A R S}$ only depends on the environmental dynamic data which is reward-agnostic [Erraqabi et al., 2021, Yarats et al., 2021]. During training, transitions stored in the buffer or offline dataset are utilized. Additionally, we observe that MARS exhibits insensitivity to data quality. Notably, data collected through random policies suffice for effective training the multi-step action representation. ", "page_idx": 5}, {"type": "text", "text": "4.3 DRL with Multi-step Action Representation ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "As a plug-in method, MARS can be applied to any RL algorithm. It contains two types of actions: $\\pmb{\\mathrm{\\Sigma}}$ the encoded multi-step action $z$ and $\\pmb{\\varphi}$ the action transition scale $\\upsilon$ . RL algorithms maximize the expected cumulative reward by selecting the optimal $z_{t}$ and $\\upsilon_{t}$ at $s_{t}$ . In this section, we apply MARS to a typical model-free RL method TD3 [Fujimoto et al., 2018] as an example. TD3 is a deterministic Actor-Critic algorithm. As illustrated in the right part of Figure 3, with the learned transition-aware multi-step action representation, the actor network learns a latent policy $\\pi_{\\omega}$ that outputs the latent actions according to current state $s$ , i.e., $[z_{t},v_{t}]=\\pi_{\\omega}(s)$ . $z_{t}$ and $\\upsilon_{t}$ respectively represent the action selected at time $t$ from $\\mathcal{Z}$ and $\\upsilon$ constructed in the section 4.1. Then we obtain the corresponding multistep actions $u_{t}$ by decoding the latent action $z_{t}$ and $v_{t}\\colon u_{t}=g_{\\psi_{1}}\\circ p_{\\psi_{0}}(s,z_{t},v_{t})$ . ", "page_idx": 5}, {"type": "table", "img_path": "eC5qdC4ZTQ/tmp/af4afcc8603f851db1159cd52c7e5aebeb558f11b54216e6060cb1fdd5c59e55.jpg", "table_caption": [], "table_footnote": [], "page_idx": 5}, {"type": "text", "text": "Two critic networks $Q_{\\theta_{1}},Q_{\\theta_{2}}$ are utilized   \nwhich take the latent actions $z_{t}$ and $\\upsilon_{t}$ as inputs to approximate the value function $\\overline{{Q_{\\pi_{\\omega}}}}$ more accurately. We train the critic network using the transition data $(s,v_{t},z_{t},r,s^{\\prime})$ sampled from the experience replay. To simplify notations, in this subsection, $s$ is the current state. $s^{\\prime}$ is the state perceived at the next interaction interval. The critic loss function is: ", "page_idx": 5}, {"type": "equation", "text": "$$\nL_{Q}(\\theta_{i})=\\mathbb{E}_{s,z_{t},v_{t},s^{\\prime}}\\big[(y-Q_{\\theta_{i}}(s,z_{t},v_{t}))^{2}\\big]\\;\\mathrm{for}\\;\\forall i\\in\\{1,2\\}.\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "Where $y=r\\!+\\!\\gamma\\operatorname*{min}_{j=1,2}Q_{\\bar{\\theta_{j}}}(s^{\\prime},\\pi_{\\bar{\\omega}}(s^{\\prime})),\\upsilon$ $\\bar{\\omega}$ denotes the target network parameters. The actor is updated according to the Deterministic Policy Gradient [Silver et al., 2014]: ", "page_idx": 5}, {"type": "equation", "text": "$$\n\\nabla_{\\omega}J(\\omega)=\\mathbb{E}_{s}\\big[\\nabla_{\\pi_{\\omega}(s)}Q_{\\theta_{1}}(s,\\pi_{\\omega}(s))\\nabla_{\\omega}\\pi_{\\omega}(s)\\big].\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "The overall algorithm MARS-TD3 is summarized in Algorithm 1, which contains two major stages: $\\textcircled{1}$ the warmup stage and $\\circledcirc$ the policy learning stage. In stage 1, MARS is trained using a prepared replay buffer $D$ . The SC-VAE is updated by minimizing the VAE and the environmental dynamic prediction loss. Note that the proposed algorithm has no requirement on how the buffer $D$ is prepared and here we simply use a random policy to gather the data. In stage 2, given an environment state, the latent policy outputs the latent action $z_{t}$ and the action transition scale $\\upsilon_{t}$ perturbed by the Gaussian exploration noise. Then, the latent action is decoded into the original multi-step actions by the decoder so as to interact with the environment. The newly collected transition sample is stored in the replay buffer $D$ . After that, the latent policy is updated using the data sampled from $D$ . The action representation model is also updated periodically in the second stage to make continual adjustments to the change of data distribution. The detailed network architectures are presented in appendix B.1. ", "page_idx": 5}, {"type": "image", "img_path": "eC5qdC4ZTQ/tmp/79de3b91f6f9fcb0cab72edb96dbcd75181be59a73289c640687193fa16efedd.jpg", "img_caption": ["Figure 4: Comparisons of methods in simulated remote NPC control tasks with random interaction interval. The $\\mathrm{X-}$ and y-axis denote the environment steps and average episode reward. Curves and shades denote the mean and the standard deviation over 8 runs. "], "img_footnote": [], "page_idx": 6}, {"type": "text", "text": "", "page_idx": 6}, {"type": "text", "text": "As for random interaction interval tasks, the interaction interval cannot be predicted, so we let the agent output an action sequence with the maximum length. To improve the training stability, we precisely record the absolute time step and the execution flag of each action, which makes the actions be executed in strict accordance with the time step order. When a new action sequence arrives at the action executor, the previous action sequence will be replaced, and the execution flag of the unexecuted actions will be set to False. The subsequent rewards will be attributed to the actions executed in the new action sequence. Thus, the actual reward stored in the experience replay $D$ for each latent action is the sum of the executed action reward in the corresponding sequence. ", "page_idx": 6}, {"type": "text", "text": "5 Experiment ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "We empirically evaluate MARS to answer the following research questions. RQ1: Performance in random interaction interval tasks. Can MARS significantly improve the performance in random Intermittent-MDP tasks, such as simulated remote NPC control tasks? RQ2: Performance in fixed interaction interval tasks. Can MARS significantly improve the performance in fixed IntermittentMDP problems, such as real-world robot arm grasping tasks? RQ3: Generalization. Can MARS be seamlessly integrated into existing RL algorithms and improve their performance? RQ4: Ablation study. Do both the action transition scale and the state dynamic prediction contribute to optimizing the multi-step latent action space? How is the robustness of MARS? ", "page_idx": 6}, {"type": "text", "text": "5.1 Random Intermittent-MDP Tasks (RQ1) ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "5.1.1 Experimental Setups ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "Benchmarks. We select two types of control tasks to simulate the remote NPC control problem with random interaction intervals: (1) robot control and (2) navigation tasks. For robot control tasks, we select four typical openai Mujoco tasks with random interaction delays,i.e., Hopper, Ant, Walker, HalfCheetah. Mujoco is a well-known testbed and is widely used in reinforcement learning research [Brockman et al., 2016]. For navigation tasks, we used the medium and difficult maps of 2dmaze in D4RL [Fu et al., 2020], where the agent\u2019s goal is to walk to the end of the maze under unstable interactions. Both types of tasks are modified to incorporate random interaction intervals, mimicking the real-world remote control scenarios [Chen and Wu, 2015]. In RTS games [Andersen et al., 2018], the maximum interaction interval usually spans $0.5s$ to $0.7s$ , with the action execution time typically between $0.1s$ and $0.25s$ . Accordingly, we set the maximum interval to 10 time steps, requiring the policy to generate an effective action sequence $a_{t:t+9}$ based on the received state $s_{t}$ . ", "page_idx": 6}, {"type": "text", "text": "", "page_idx": 7}, {"type": "text", "text": "Baselines. To our knowledge, no specific solution exists for the Intermittent-MDP problem. Thus, we compare with three baseline methods. (1) Perfect-TD3: We train TD3 in the perfect environments with continuous interaction without interaction interval, i.e., normal MDP. It is the highest standard for evaluating MARS. (2) Frameskip-TD3: We combine the frameskip technique with TD3 (a common trick for multi-step decision) and apply it to the intermittent-MDP tasks. (3) Multistep-TD3: We modify TD3 to directly make decisions for the $c$ future steps by outputting a concatenated action vector of $c$ times of dimensionality. ", "page_idx": 7}, {"type": "text", "text": "5.1.2 Performance of remote NPC control tasks ", "text_level": 1, "page_idx": 7}, {"type": "text", "text": "To mitigate implementation bias and ensure a comprehensive comparison, we implement all methods using the same architecture based on TD3 [Fujimoto et al., 2018]. For all tasks, we set the dimension of $z_{t}$ to 8 and the scaling parameter $\\beta$ to 5. We set the warm-up (stage 1) step to 400000 and 100000 for the Mujoco tasks and the navigation task respectively. Detailed parameter setting can be found in appendix B.2. The results in Figure 4 show that MARS-TD3 outperforms the other methods in all tasks, especially in the high-dimensional action control tasks (i.e., Mujoco). Compared with vanilla multstep-TD3, our method can significantly improve the performance of the RL algorithm in random Intermittent-MDP control problems by learning a more compact multistep action representation while avoiding the convergence difficulties caused by dimensional explosion. Note that MARS-TD3 can also achieve comparable performance with perfect-TD3 in most tasks. ", "page_idx": 7}, {"type": "text", "text": "5.2 Fixed Intermittent-MDP Tasks (RQ2) ", "text_level": 1, "page_idx": 7}, {"type": "text", "text": "5.2.1 Experimental Setups ", "text_level": 1, "page_idx": 7}, {"type": "text", "text": "Task description.The experiment involves a 6-DoF robot arm performing grasping tasks within a $30\\times\\dot{3}0\\times30c m^{\\frac{1}{3}}$ tabletop workspace. 15 rounds of experiments are conducted using our method and baselines. In each round, 6 objects are randomly selected and placed on the table. The robot observes the workspace with a single-depth image from a fixed side view. The viewpoint of the virtual camera points toward the workspace\u2019s origin at a radial distance $r\\;=\\;2l$ and ", "page_idx": 7}, {"type": "image", "img_path": "eC5qdC4ZTQ/tmp/65db784b40695011c86a7da638bb0a4ac3f5ff84fa0e47b762a19c3c16c34dbb.jpg", "img_caption": [], "img_footnote": [], "page_idx": 7}, {"type": "text", "text": "an angle $\\theta=\\pi/3$ , $l$ is the workspace\u2019s Figure 5: A complete grasp process in each interaction interval. length. We follow the setting of traditional grasp tasks [Jiang et al., 2021] and set the total number of interactions to 6, meaning that the policy is expected to complete the grasp of all six targets in six intervals. Thus, the robot arm is allotted a single observation of the environment per object. As shown in Figure 5, at each interaction interval, there are 4 steps to grasp an object. The robotic arm has to first acquire observations at the beginning of each grasping. Upon perceiving the observation, an action sequence $a_{t:t+15}$ is executed to grasp the target object and then place the object in the target box. The time limit for grasping one object is set to 30s. The robot need to move to a predefined location for capturing image (images are transformed into a 512-dim vector). Action space is $3{\\mathrm{-dim}}^{2}$ , the reward function encourages policies to maximize the grasping success rate and motion smoothness. ", "page_idx": 7}, {"type": "text", "text": "Baselines. Online RL demands extensive exploration, resulting in low sample efficiency. Besides, Online RL accidental random exploration may lead to robot arm damage. Thus, we opt for offline ", "page_idx": 7}, {"type": "text", "text": "RL commonly utilized in robot scenarios, i.e. TD3 $^+$ Behavior Cloning (TD3-BC) [Fujimoto and Gu, 2021], to serve as the backbone. Methods: (1) Vanilla TD3-BC. (2) Multistep TD3-BC, same as Multistep-TD3 used in the section 5.1 (3) Dense observation $^+$ TD3-BC. An extra camera provides dense observation every 3 seconds, and the robot arm still has to move to the observing position at the start of each episode to eliminate differences caused by the observing motion. ", "page_idx": 8}, {"type": "text", "text": "Evaluation metrics. (1) Grasp success rate (GSR), the ratio of successfully grasping the objects. (2) Declutter rate (DR), the average ratio of objects removed after successful grasping. (3) Motion smooth ratio (MSR): $\\frac{\\mathrm{grasp\\;time}}{\\mathrm{total\\;time}}$ , evaluating whether the motion is smooth and natural (pauses and shaking can result in lower scores). All results are averaged over 15 simulation rounds. ", "page_idx": 8}, {"type": "text", "text": "5.2.2 Performance of real-world Robot Arm Grasping ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "The overall comparison is presented in Table 1. The results show that due to the sparse interaction, the vanilla TD3-BC fails to complete the task and frequently pauses or takes unnatural motions during the execution. While the performance of TD3-BC is significantly improved with additional dense observations, it remains ", "page_idx": 8}, {"type": "table", "img_path": "eC5qdC4ZTQ/tmp/fff52502849603a7f91ea595b45bb1610e1028649bcd7f3d9590ac42e9c0bffe.jpg", "table_caption": [], "table_footnote": ["Table 1: Performance of the robot arm grasping task. "], "page_idx": 8}, {"type": "text", "text": "unsatisfactory due to the lack of real-time feedback. Moreover, the use of extra cameras results in higher costs of the experiment. Although Multistep $^+$ TD3-BC helps smoothen the motion, it fails to effectively mitigate the instability caused by Intermittent-MDP. MARS addresses the limitation of the vanilla Multistep $+\\mathrm{\\TD}3{\\-}\\mathrm{BC}$ , which makes TD3-BC complete the task with high quality. We provide the corresponding motion pattern for each method. To further verify the effectiveness of MARS combined with online RL on fixed interaction interval control task. The results in the Appendix C.2 show that our method outperforms the baselines on all four tasks. ", "page_idx": 8}, {"type": "text", "text": "5.3 Generalization of MARS (RQ3) ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "We further test MARS with popular RL algorithms on three random interaction interval tasks: Hopper, Walker, and Maze hard. We maintain consistent parameters for each method and implement them based on the publicly available codebase. We train each RL algorithm with dense interactions as baselines and compare them with MARS-enhanced methods under the random interaction interval setting. Results in Appendix C.3 shows that all methods can learn effective policies with the help of MARS and the converged performance is comparable to the perfect interaction settings. ", "page_idx": 8}, {"type": "text", "text": "5.4 Ablation Study and Visual Analysis (RQ4) ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "We conducted evaluations on the key components of MARS, i.e. action transition scale and state dynamic prediction. Figure 6 (a) shows that both components optimize the latent space and improve the learning efficiency of DRL policies. MARS performs best when both modules are integrated. A comprehensive analysis is ", "page_idx": 8}, {"type": "image", "img_path": "eC5qdC4ZTQ/tmp/bd6d66a21de671f9c0902434891051b0e999815e7bdd06c8ec30ce4f514868aa.jpg", "img_caption": [], "img_footnote": [], "page_idx": 8}, {"type": "text", "text": "shown in Appendix C.4. Figure 6 (b) uses t- Figure 6: Ablation study, the curve and shade denote the SNE [van der Maaten and Hinton, 2008] to vi- mean and a standard deviation of the returns over 5 runs. sualize the latent action representations. We color each action based on its impact on the environment. Results show that actions with a similar impact, i.e., $\\delta_{s_{t},s_{t+c}}$ , on the environment are clustered closely, which indicats that the learned action representation is dynamic smooth. Besides, results in Appendix C.5 improve the robustness of MARS to different interaction interval settings. Results in Appendix C.6 show the influence of latent space dimensions on MARS. Lastly, an analysis of self-supervised training steps can be found in Appendix C.7. ", "page_idx": 8}, {"type": "text", "text": "6 Conclusion and Limitation ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "In this paper, we observe that previous DRL methods fail to learn effective policies in intermittent control scenarios because of the discontinue interaction. To improve the performance of DRL on such tasks, we propose Multi-step action representation (MARS) to construct a reliable multi-step latent action space. Based on this latent action space, DRL methods can make effective advance decisions to ensure the smoothness and efficiency of the agent\u2019s motion when it cannot interact with the environment. MARS outperforms baselines in a variety of fixed and random interaction intervals control tasks. Additionally, MARS has potential for improvement in represent extremely long action sequences, which we will address by identifying more powerful representation models, e.g. transformer based VAE, in the future. ", "page_idx": 8}, {"type": "text", "text": "", "page_idx": 9}, {"type": "text", "text": "Acknowledgement ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "This work is supported by the National Natural Science Foundation of China (Grant Nos. 62422605, 92370132, 62106172), the National Key R&D Program of China (Grant No. 2022ZD0116402) and the Xiaomi Young Talents Program of Xiaomi Foundation. ", "page_idx": 9}, {"type": "text", "text": "References ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "Per-Arne Andersen, Morten Goodwin, and Ole-Christoffer Granmo. Deep rts: a game environment for deep reinforcement learning in real-time strategy games. In 2018 IEEE conference on computational intelligence and games (CIG), pages 1\u20138. IEEE, 2018. ", "page_idx": 9}, {"type": "text", "text": "Mehdi Azabou, Mohammad Gheshlaghi Azar, Ran Liu, Chi-Heng Lin, Erik C Johnson, Kiran Bhaskaran-Nair, Max Dabagia, Bernardo Avila-Pires, Lindsey Kitchell, Keith B Hengen, et al. Mine your own view: Self-supervised learning through across-sample prediction. arXiv preprint arXiv:2102.10106, 2021.   \nAndrea Bonarini. Communication in human-robot interaction. Current Robotics Reports, 1:279\u2013285, 2020.   \nAlexander Braylan, Mark Hollenbeck, Elliot Meyerson, and Risto Miikkulainen. Frame skip is a powerful parameter for learning to play atari. In AAAI-15 Workshop on Learning for General Competency in Video Games, 2015. URL http://nn.cs.utexas.edu/?braylan:aaai15ws.   \nGreg Brockman, Vicki Cheung, Ludwig Pettersson, Jonas Schneider, John Schulman, Jie Tang, and Wojciech Zaremba. Openai gym. arXiv preprint arXiv:1606.01540, 2016.   \nChen Chen, Hongyao Tang, Jianye Hao, Wulong Liu, and Zhaopeng Meng. Addressing action oscillations through learning policy inertia. In Proceedings of the AAAI Conference on Artificial Intelligence, volume 35, pages 7020\u20137027, 2021.   \nQian Chen and Dapeng Wu. Delay-rate-distortion model for real-time video communication. IEEE Transactions on Circuits and Systems for Video Technology, 25(8):1376\u20131394, 2015.   \nXihua Dong, Xiaochen Li, and Dapeng Wu. Analysis of packet error probability in delay constrained communication over fading channels. In 2009 6th IEEE Consumer Communications and Networking Conference, pages 1\u20135. IEEE, 2009.   \nAkram Erraqabi, Mingde Zhao, Marlos C Machado, Yoshua Bengio, Sainbayar Sukhbaatar, Ludovic Denoyer, and Alessandro Lazaric. Exploration-driven representation learning in reinforcement learning. In ICML 2021 Workshop on Unsupervised Reinforcement Learning, 2021.   \nJustin Fu, Aviral Kumar, Ofir Nachum, George Tucker, and Sergey Levine. D4rl: Datasets for deep data-driven reinforcement learning. arXiv preprint arXiv:2004.07219, 2020.   \nFlorian Fuchs, Yunlong Song, Elia Kaufmann, Davide Scaramuzza, and Peter D\u00fcrr. Super-human performance in gran turismo sport using deep reinforcement learning. IEEE Robotics and Automation Letters, 6(3):4257\u20134264, 2021.   \nScott Fujimoto and Shixiang Shane Gu. A minimalist approach to offline reinforcement learning. Advances in neural information processing systems, 34:20132\u201320145, 2021.   \nScott Fujimoto, Herke Hoof, and David Meger. Addressing function approximation error in actorcritic methods. In International conference on machine learning, pages 1587\u20131596. PMLR, 2018.   \nDanijar Hafner, Jurgis Pasukonis, Jimmy Ba, and Timothy Lillicrap. Mastering diverse domains through world models. arXiv preprint arXiv:2301.04104, 2023.   \nNicklas Hansen, Xiaolong Wang, and Hao Su. Temporal difference learning for model predictive control. arXiv preprint arXiv:2203.04955, 2022.   \nMichael Janner, Justin Fu, Marvin Zhang, and Sergey Levine. When to trust your model: Model-based policy optimization. Advances in neural information processing systems, 32, 2019.   \nZhenyu Jiang, Yifeng Zhu, Maxwell Svetlik, Kuan Fang, and Yuke Zhu. Synergies between affordance and geometry: 6-dof grasp detection via implicit representations. arXiv preprint arXiv:2104.01542, 2021.   \nShivaram Kalyanakrishnan, Siddharth Aravindan, Vishwajeet Bagdawat, Varun Bhatt, Harshith Goka, Archit Gupta, Kalpesh Krishna, and Vihari Piratla. An analysis of frame-skipping in reinforcement learning. arXiv preprint arXiv:2102.03718, 2021.   \nElia Kaufmann, Leonard Bauersfeld, Antonio Loquercio, Matthias M\u00fcller, Vladlen Koltun, and Davide Scaramuzza. Champion-level drone racing using deep reinforcement learning. Nature, 620 (7976):982\u2013987, 2023.   \nDiederik $\\mathbf{P}$ Kingma and Max Welling. Auto-encoding variational bayes. arXiv preprint arXiv:1312.6114, 2013.   \nJoonho Lee, Jemin Hwangbo, Lorenz Wellhausen, Vladlen Koltun, and Marco Hutter. Learning quadrupedal locomotion over challenging terrain. Science robotics, 5(47):eabc5986, 2020.   \nBoyan Li, Hongyao Tang, Yan Zheng, Jianye Hao, Pengyi Li, Zhen Wang, Zhaopeng Meng, and Li Wang. Hyar: Addressing discrete-continuous action reinforcement learning via hybrid action representation. arXiv preprint arXiv:2109.05490, 2021.   \nYuliang Li, Rui Miao, Changhoon Kim, and Minlan Yu. Lossradar: Fast detection of lost packets in data center networks. In Proceedings of the 12th International on Conference on Emerging Networking EXperiments and Technologies, CoNEXT \u201916, page 481\u2013495, New York, NY, USA, 2016. Association for Computing Machinery. ISBN 9781450342926. doi: 10.1145/2999572. 2999609. URL https://doi.org/10.1145/2999572.2999609.   \nChuzhao Liu, Junyao Gao, Yuanzhen Bi, Xuanyang Shi, and Dingkui Tian. A multitasking-oriented robot arm motion planning scheme based on deep reinforcement learning and twin synchrocontrol. Sensors, 20(12), 2020. ISSN 1424-8220. doi: 10.3390/s20123515. URL https: //www.mdpi.com/1424-8220/20/12/3515.   \nYue Ma, Yali Wang, Yue Wu, Ziyu Lyu, Siran Chen, Xiu Li, and Yu Qiao. Visual knowledge graph for human action reasoning in videos. In Proceedings of the 30th ACM International Conference on Multimedia, pages 4132\u20134141, 2022.   \nYue Ma, Yingqing He, Hongfa Wang, Andong Wang, Chenyang Qi, Chengfei Cai, Xiu Li, Zhifeng Li, Heung-Yeung Shum, Wei Liu, et al. Follow-your-click: Open-domain regional image animation via short prompts. arXiv preprint arXiv:2403.08268, 2024.   \nA Rupam Mahmood, Dmytro Korenkevych, Brent J Komer, and James Bergstra. Setting up a reinforcement learning task with a real-world robot. In 2018 IEEE/RSJ International Conference on Intelligent Robots and Systems (IROS), pages 4635\u20134640. IEEE, 2018.   \nVolodymyr Mnih, Koray Kavukcuoglu, David Silver, Alex Graves, Ioannis Antonoglou, Daan Wierstra, and Martin Riedmiller. Playing atari with deep reinforcement learning. arXiv preprint arXiv:1312.5602, 2013.   \nJohn Schulman, Filip Wolski, Prafulla Dhariwal, Alec Radford, and Oleg Klimov. Proximal policy optimization algorithms. arXiv preprint arXiv:1707.06347, 2017.   \nMax Schwarzer, Ankesh Anand, Rishab Goel, R Devon Hjelm, Aaron Courville, and Philip Bachman. Data-efficient reinforcement learning with self-predictive representations. arXiv preprint arXiv:2007.05929, 2020.   \nDavid Silver, Guy Lever, Nicolas Heess, Thomas Degris, Daan Wierstra, and Martin Riedmiller. Deterministic policy gradient algorithms. In International conference on machine learning, pages 387\u2013395. Pmlr, 2014.   \nKihyuk Sohn, Honglak Lee, and Xinchen Yan. Learning structured output representation using deep conditional generative models. In C. Cortes, N. Lawrence, D. Lee, M. Sugiyama, and R. Garnett, editors, Advances in Neural Information Processing Systems, volume 28. Curran Associates, Inc., 2015. URL https://proceedings.neurips.cc/paper_files/paper/2015/ file/8d55a249e6baa5c06772297520da2051-Paper.pdf.   \nRichard S. Sutton and Andrew G. Barto. Reinforcement Learning: An Introduction. A Bradford Book, Cambridge, MA, USA, 2018. ISBN 0262039249.   \nLaurens van der Maaten and Geoffrey Hinton. Visualizing data using t-sne. Journal of Machine Learning Research, 9(86):2579\u20132605, 2008. URL http://jmlr.org/papers/v9/vandermaaten08a. html.   \nZiyu Wang, Tom Schaul, Matteo Hessel, Hado Hasselt, Marc Lanctot, and Nando Freitas. Dueling network architectures for deep reinforcement learning. In International conference on machine learning, pages 1995\u20132003. PMLR, 2016.   \nWilliam Whitney, Rajat Agarwal, Kyunghyun Cho, and Abhinav Gupta. Dynamics-aware embeddings. arXiv preprint arXiv:1908.09357, 2019.   \nAlbert Wong, Chunyin Chiu, Ga\u00e9tan Hains, James Behnke, Youry Khmelevsky, and Tyler Sutherland. Network latency classification for computer games. In 2021 IEEE International Conference on Recent Advances in Systems Science and Engineering (RASSE), pages 1\u20136, 2021. doi: 10.1109/ RASSE53195.2021.9686848.   \nDenis Yarats, Rob Fergus, Alessandro Lazaric, and Lerrel Pinto. Reinforcement learning with prototypical representations. In International Conference on Machine Learning, pages 11920\u2013 11931. PMLR, 2021.   \nYan Zheng, Changjie Fan, Xiaofei Xie, Ting Su, L. Ma, Jianye Hao, Zhaopeng Meng, Y. Liu, Ruimin Shen, and Yingfeng Chen. Wuji: Automatic online combat game testing using evolutionary deep reinforcement learning. 2019 34th IEEE/ACM International Conference on Automated Software Engineering (ASE), pages 772\u2013784, 2019. URL https://api.semanticscholar.org/ CorpusID:210694979. ", "page_idx": 9}, {"type": "text", "text": "", "page_idx": 10}, {"type": "text", "text": "", "page_idx": 11}, {"type": "text", "text": "A Preliminaries ", "text_level": 1, "page_idx": 12}, {"type": "text", "text": "Markov Decision Process (MDP). A standard MDP can be represented as a tuple: $(S,\\mathcal{A},\\mathcal{P},\\mathcal{R},\\gamma,T)$ , where $\\boldsymbol{S}$ denotes the state set, $\\boldsymbol{\\mathcal{A}}$ denotes an action set, $\\mathcal{P}$ is the transition function: $S\\!\\times\\!A\\!\\times\\!S\\to[0,1]$ and $\\mathcal{R}$ is the reward function: $s\\times A\\to\\mathbb{R}$ . $\\gamma\\in[0,1)$ is a discount factor and $T$ is the decision horizon. The target of the agent is to optimize its policy to maximize the expected discounted cumulative reward. ", "page_idx": 12}, {"type": "text", "text": "Frameskip. Frame-skipping may be viewed as an instance of (partial) open-loop control, under which a predetermined sequence of (possibly different) actions is executed without heed to intermediate states. Aiming to minimize sensing, Kalyanakrishnan et al. [2021] proposes a framework for incorporating variable-length open-loop action sequences in regular (closed-loop) control. The primary challenge in general open-loop control is that the number of action sequences of some given length $d$ is exponential in $d$ . Consequently, the main focus in the area is on policies to prune corresponding data structures [Braylan et al., 2015]. Since action repetition restricts itself to a set of actions with size linear in $d$ , it allows for $d$ itself to be set much higher in practice. With frame-skipping, the agent is only allowed to sense every $d$ state: that is, if the agent has sensed a state $s_{t}$ at time step $t>=0$ , it is oblivious to stat $^{3}\\!\\mathrm{S}\\!s_{t+1},s_{t+2},...,s_{t+d-1}$ , and next only observes $s_{t+d}$ . ", "page_idx": 12}, {"type": "text", "text": "Variational Auto-encoder. The variational auto-encoder (VAE) is a directed graphical model with certain types of latent variables, such as Gaussian latent variables. A generative process of the VAE is as follows: a set of latent variable $z$ is generated from the prior distribution $p_{\\theta}(z)$ and the data $\\mathbf{X}$ is generated by the generative distribution $p_{\\theta}(x|z)$ conditioned on $z:z\\sim p_{\\theta}(z),x\\sim$ $p_{\\theta}(x|z)$ . In general, parameter estimation of directed graphical models is often challenging due to intractable posterior inference. However, the parameters of the VAE can be estimated efficiently in the stochastic gradient variational Bayes (SGVB) framework, where the variational lower bound of the log-likelihood is used as a surrogate objective function. In this framework, a proposal distribution $q_{\\theta}(x|z)$ , which is also known as a \u201crecognition\u201d model, is introduced to approximate the true posterior $p_{\\theta}(x|z)$ . The multilayer perceptrons (MLPs) are used to model the recognition and the generation models. Assuming Gaussian latent variables, the first term of Equation A can be marginalized, while the second term is not. Instead, the second term can be approximated by drawing samples $z^{(l)}(l=1,...,L)$ by the recognition distribution $q_{\\theta}(x|z)$ , and the empirical objective of the VAE with Gaussian latent variables is written as follows: ", "page_idx": 12}, {"type": "equation", "text": "$$\nL_{V A E}(\\phi,\\psi)=\\frac{1}{L}\\sum_{\\theta}(x|z^{(l)})-K L\\big(q_{\\phi}(z|x)||N(0,I)\\big)\n$$", "text_format": "latex", "page_idx": 12}, {"type": "text", "text": "B Experimental Details ", "text_level": 1, "page_idx": 12}, {"type": "text", "text": "B.1 NETWORK STRUCTURE ", "text_level": 1, "page_idx": 12}, {"type": "table", "img_path": "eC5qdC4ZTQ/tmp/d592f245f5c2faf4e209e1a89c84e10310d23012638e47c9900f911fda39a5b4.jpg", "table_caption": [], "table_footnote": ["Table 2: Network Structures for DRL Methods "], "page_idx": 12}, {"type": "text", "text": "Our codes are implemented with Python 3.7.9 and Torch 1.7.1. All experiments were run on a single NVIDIA GeForce GTX 3090 GPU. Each single training trial ranges from 4 hours to 17 hours, depending on the algorithms and environments. We will open source code in the near future. ", "page_idx": 12}, {"type": "text", "text": "Our TD3 is implemented with reference to github.com/sfujim/TD3 (TD3 source-code). DDPG and PPO are implemented with reference to https://github.com/sweetice/ Deep-reinforcement-learning-with-pytorch. For a fair comparison, all the baseline methods have the same network structure (except for the specific components of each algorithm) as our MARS-TD3 implementation. As shown in Tab.2, we use a two-layer feed-forward neural network of ", "page_idx": 12}, {"type": "table", "img_path": "eC5qdC4ZTQ/tmp/3996f3587da304dd6ced3213fa57b9ff785cd6f42d24db3d4c2911c97e4aa219.jpg", "table_caption": [], "table_footnote": ["Table 3: Network structures for the Multi-step action representation (MARS). "], "page_idx": 13}, {"type": "text", "text": "256 and 256 hidden units with ReLU activation (except for the output layer) for the actor network for all algorithms. For DDPG the critic denotes the Q-network. For PPO, the critic denotes the V-network. All algorithms (TD3, DDPG, PPO) output two heads at the last layer of the actor network, one for latent action and another for dynamic transition potential. ", "page_idx": 13}, {"type": "text", "text": "The structure of MARS is shown in Tab.3. We use element-wise product operation [Mahmood et al., 2018] and cascaded head structure [Fuchs et al., 2021] to our model[Ma et al., 2024, 2022]. ", "page_idx": 13}, {"type": "text", "text": "B.2 Hyperparameter ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "For all experiments, we use the raw state and reward from the environment, and no normalization or scaling is used. No regularization is used for the actor and the critic in all algorithms. An exploration noise sampled from $\\Nu(0,0.1)$ [Dong et al., 2009] is added to all baseline methods when selecting an action. The discounted factor is 0.99 and we use Adam Optimizer [Li et al., 2016] for all algorithms. Tab.4 shows the common hyperparameters of algorithms used in all our experiments. ", "page_idx": 13}, {"type": "table", "img_path": "eC5qdC4ZTQ/tmp/fbcd56bcc3d660824cedd88d02330cfbb7acc09cd18df78b4f8e1866979c3727.jpg", "table_caption": [], "table_footnote": ["Table 4: A comparison of common hyperparameter choices of algorithms. We use \u2018None\u2019 to denote the \u2018not applicable\u2019 situation. "], "page_idx": 13}, {"type": "text", "text": "B.3 Additional Implementation Details ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "For PPO, the actor network and the critic network are updated every 2 and 10 episode respectively for all environments. The clip range of the PPO algorithm is set to 0.2 and we use GAE [Sutton and Barto, 2018] for a stable policy gradient. For DDPG, the actor network and the critic network is updated at every 1 environment step. For TD3, the critic network is updated every 1 environment step and the actor network is updated every 2 environment steps. ", "page_idx": 13}, {"type": "text", "text": "The default latent action dim is 8, we set the KL weight in representation loss $L_{M A R S}$ as 0.5.   \nEnvironment dynamic prediction loss weight $\\beta$ is 5 (default). ", "page_idx": 13}, {"type": "table", "img_path": "eC5qdC4ZTQ/tmp/78100b6dd3a8b569eb7b878dd78edbb04e393984b887e2b5a607ddbbb32fbc48.jpg", "table_caption": ["C.1 Performance of model-based reinforcement learning algorithms on Intermittent-MDP tasks. "], "table_footnote": ["Table 5: Comparison between MBRL and MFRL in intermittent control tasks, average of 3 runs. "], "page_idx": 14}, {"type": "text", "text": "The results in Table 5 show that the model-based reinforcement learning approach is significantly lower than our approach in all four scenarios, and even slightly worse than using TD3 for direct multi-step decision making. We analyze that this is because the errors caused by the mismatch (sub-optimal) of the dynamic model will accumulate due to multi-step decision-making, resulting in sub-optimal policy. Unfortunately, the training of dynamic models is data hungry (high cost), that is, a large amount of high-quality expert data is required to ensure the accuracy of the model shop, which is difficult to obtain, especially in real-world scenarios. ", "page_idx": 14}, {"type": "text", "text": "C.2 Validation of the combination of MARS and online methods ", "text_level": 1, "page_idx": 14}, {"type": "image", "img_path": "eC5qdC4ZTQ/tmp/d77134de89ea1687c6ab05f3672cf4be324902015aec9cc395a0ad535cff254d.jpg", "img_caption": ["Figure 7: The performance of the methods on four simulated tasks. The curve and shade denote the mean and a standard deviation over 5 runs. "], "img_footnote": [], "page_idx": 14}, {"type": "text", "text": "We use the mainstream online reinforcement learning algorithm TD3 in combination with MARS and compare it with the baseline mentioned in Sec.5.1 in four tasks. We set the interval to 10 time steps, requiring the policy to generate an effective action sequence $a_{t:t+9}$ based on the received state $s_{t}$ . ", "page_idx": 14}, {"type": "text", "text": "For all tasks, we set the dimension of $z_{t}$ to 12 and the scaling parameter $\\beta$ to 4. We set the warm-up (stage 1) step to 300000 and 100000 for the Mujoco tasks and the navigation task respectively. The results in Figure 7 show that MARS-TD3 outperforms the other baselines in all fixed IntermittentMDP tasks and achieve comparable performance with perfect-TD3 in most tasks. This further proves that MARS can effectively improve the effectiveness of Online DRL on fixed Intermi tasks. ", "page_idx": 14}, {"type": "text", "text": "C.3 Generalization of MARS ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "We test MARS with popular RL methods on three tasks: Hopper, Walker, and hardMaze. To make the experiment fair, we used the same parameters for all methods and implemented them based on public code. We use each RL algorithm to train on three tasks under the ideal setting and compare them with their corresponding improvement methods. To show the optimal score after the algorithm convergence, we train all the algorithm\u2019s 2000000 time steps. The results in Tab.6 show that all methods can learn effective policies with the help of MARS and perform similarly to their ideal settings. The differences in scores are mainly due to the variation in performance of the RL algorithms. In summary, MARS can be combined with different methods to provide a reliable action space for solving Intermittent-MDP as normal MDP with RL. ", "page_idx": 14}, {"type": "table", "img_path": "eC5qdC4ZTQ/tmp/e1c0097e1dab369a932fe337a366cb00881b373a272defb3aa9c8e2be7ee73fd.jpg", "table_caption": [], "table_footnote": [], "page_idx": 15}, {"type": "text", "text": "Table 6: The parameters of all methods are optimized by grid search. The results of applying MARS to popular RL algorithms on three random interaction interval tasks. The maximum interaction interval is set to 8. Each data in the table is in the following format: MARS-RL score | the score difference compared to the perfect dense interaction baseline. $\\downarrow$ denotes the score of MARS lower than the dense interaction baseline. $\\uparrow$ denotes the score of MARS is higher. All scores are averaged over 5 runs. ", "page_idx": 15}, {"type": "image", "img_path": "eC5qdC4ZTQ/tmp/b81f7dd1a3576bc0691e3550e1071ee51730e8ebf81a5d0e4e350ea84897b630.jpg", "img_caption": ["Figure 9: The curve and shade denote the mean and a standard deviation over 5 runs. "], "img_footnote": [], "page_idx": 15}, {"type": "text", "text": "We conducted two experiments to show how well the two mechanisms of MARS work together. Although the results of randomized Intermittent-MDP and fixed Intermittent-MDP are slightly different, the same conclusion can be derived: The green curves in Figure 8 demonstrate that the representation model ", "page_idx": 15}, {"type": "image", "img_path": "eC5qdC4ZTQ/tmp/0866e88555fdeeec36cc1f0a02d14bd5d542ec57e6bbddad95e73c602696f364.jpg", "img_caption": ["Figure 8: Details of ablation study. The curve and shade denote the mean and a standard deviation over 5 runs. "], "img_footnote": [], "page_idx": 15}, {"type": "text", "text": "with increased action transition scale is much better than the original VAE. This means that dynamic transition potential can create an latent action space by explicitly modeling the dependence between multi-step actions. The blue curves also show that VAE with state dynamic prediction is better than the original VAE because it can represent action sequences that have similar environmental effects at close locations. Finally, the red curves show that the two mechanisms work well together in MARS, and combining them improves representation ability. ", "page_idx": 15}, {"type": "text", "text": "C.5 Validity verification of multi-style interaction intervals ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "To further demonstrate the effectiveness of MARS in diverse intermittent control scenarios. For fixed interaction control tasks, we uniformly set the forbidden interaction duration and conducted four experiments on Hopper. The results in Figure 9(a) show that MARS can solve most tasks effectively and still guarantee good scores at long intervals, but the effectiveness of MARS decreases significantly when the interval is too long (which is not common in real-world scenarios). We believe that this is because VAE is unable to effectively characterize excessively long sequences, leading to the failure of multi-step action space modeling. ", "page_idx": 15}, {"type": "image", "img_path": "eC5qdC4ZTQ/tmp/15dd63e70beb337a4aae3409f3d933b846cf790c6e6569362eed3990f9b616c6.jpg", "img_caption": ["Figure 10: The curve and shade denote the mean and a standard deviation over 5 runs. "], "img_footnote": [], "page_idx": 16}, {"type": "text", "text": "In addition, to observe the sensitivity of MARS to interaction intervals on random Intermittent-MDP tasks, we uniformly set the forbidden interaction duration and conducted four experiments on Hopper. The results in Figure 9(b) show that in random Intermittent-MDP scenarios, MARS performs well in both short and medium-interval scenarios. However, convergence changes slowly in the very long interval scenario, and the score is only half that of the medium interval task. Because MARS\u2019s representational capabilities are not perfect for modeling long action sequences for extremely longspaced tasks (even if this setting rarely occurs in real-world scenarios). Therefore, in the future, we hope to find more suitable representation models to overcome this problem. ", "page_idx": 16}, {"type": "text", "text": "C.6 The influence of Latent action space dimension on algorithm effect ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "The representation space dimension of VAE is an important hyperparameter. If the latent space dimension is too low, a large amount of original data information will be lost, resulting in invalid representation space. On the contrary, when the latent space dimension is too large, the calculation amount of the model will be increased. To verify the sensitivity of MARS to latent space dimensions, we test it on two tasks with different original action dimensions. We set up four sets of latent space dimensions for fixed Intermittent-MDP Hopper (interaction interval time step: 8, original action dimension: 3, so the action sequence dimension to be modeled is 24). The learning curve in Figure 10(a) shows that for raw data of such high dimensions, when the latent space dimension is set too low, the latent space information will be lost, resulting in the convergence failure of reinforcement learning policies. On the contrary, too high a latent space dimension increases the complexity of reinforcement learning policy exploration. ", "page_idx": 16}, {"type": "text", "text": "In addition, we set up four comparison experiments on the 2dmaze task with a lower dimension of the original action sequence (interaction interval time step: 4, original action dimension: 2, so the action sequence dimension to be modeled is 8). The experimental results in Figure 10(b) show that the suboptimal policy can be learned when the latent space dimension is low, because the original data dimension is low. So the low-dimensional latent space loses less information. The score increases as the latent space dimension increases. However, when the latent space dimension is too high, the score will drop significantly, which is because of the exploration difficulties brought by high-dimensional latent space. ", "page_idx": 16}, {"type": "text", "text": "C.7 The influence of environment steps of warmup stage ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "In this section, we conduct some additional experimental results for a further study of MARS from different perspectives: We provide the exact number of samples used in the warm-up stage (i.e., stage 1 in Algorithm 1 in each environment in Tab.7. The number of warm-up environment steps is about $5\\%\\sim10\\%$ of the total environment steps in our original experiments. Moreover, we also conducted some experiments to further reduce the number of samples used in the warm-up stage (at most $80\\%$ off). See the colored results in Tab.7. MARS can achieve comparable performance with $<3\\%$ samples of the total environment steps. ", "page_idx": 16}, {"type": "text", "text": "", "page_idx": 17}, {"type": "table", "img_path": "eC5qdC4ZTQ/tmp/a4bc0adb2058654a34484d92f9346fd0ecf438055729aa050bebac55fcc37500.jpg", "table_caption": ["Conclusion: The number of warm-up environment steps is about $5\\%\\sim10\\%$ of the total environment steps in our original experiments. The number of warmup environment steps can be further reduced by at most $80\\bar{\\%}$ off (thus leading to $<3\\%$ of the total environment steps) while the comparable performance of our algorithm remains. "], "table_footnote": ["Table 7: The exact number of samples used in warm-up stage training in different environments. The column of \u2018original\u2019 denotes what is done in our experiments; the column of \u2018new\u2019 denotes additional experiments we conduct with fewer warm-up samples (and proportionally fewer warm-up training). For each entry $x(y|z)$ , $\\mathbf{X}$ is the number of samples (environment steps), y denotes the percentage number of number of total ewnavrirmon\u2212umpe netn vstireposn dmuernitn sgt tehpse training process, and z denotes the corresponding performance of MARS-TD3. "], "page_idx": 17}, {"type": "text", "text": "NeurIPS Paper Checklist ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "1. Claims ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Question: Do the main claims made in the abstract and introduction accurately reflect the paper\u2019s contributions and scope? ", "page_idx": 18}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 18}, {"type": "text", "text": "Justification: Please refer to abstract and introduction. ", "page_idx": 18}, {"type": "text", "text": "Guidelines: ", "page_idx": 18}, {"type": "text", "text": "\u2022 The answer NA means that the abstract and introduction do not include the claims made in the paper.   \n\u2022 The abstract and/or introduction should clearly state the claims made, including the contributions made in the paper and important assumptions and limitations. A No or NA answer to this question will not be perceived well by the reviewers.   \n\u2022 The claims made should match theoretical and experimental results, and reflect how much the results can be expected to generalize to other settings.   \n\u2022 It is fine to include aspirational goals as motivation as long as it is clear that these goals are not attained by the paper. ", "page_idx": 18}, {"type": "text", "text": "2. Limitations ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Question: Does the paper discuss the limitations of the work performed by the authors? ", "page_idx": 18}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Justification: The limitations can be seen in Sec.6 of main paper. ", "page_idx": 18}, {"type": "text", "text": "Guidelines: ", "page_idx": 18}, {"type": "text", "text": "\u2022 The answer NA means that the paper has no limitation while the answer No means that the paper has limitations, but those are not discussed in the paper.   \n\u2022 The authors are encouraged to create a separate \"Limitations\" section in their paper.   \n\u2022 The paper should point out any strong assumptions and how robust the results are to violations of these assumptions (e.g., independence assumptions, noiseless settings, model well-specification, asymptotic approximations only holding locally). The authors should reflect on how these assumptions might be violated in practice and what the implications would be.   \n\u2022 The authors should reflect on the scope of the claims made, e.g., if the approach was only tested on a few datasets or with a few runs. In general, empirical results often depend on implicit assumptions, which should be articulated.   \n\u2022 The authors should reflect on the factors that influence the performance of the approach. For example, a facial recognition algorithm may perform poorly when image resolution is low or images are taken in low lighting. Or a speech-to-text system might not be used reliably to provide closed captions for online lectures because it fails to handle technical jargon.   \n\u2022 The authors should discuss the computational efficiency of the proposed algorithms and how they scale with dataset size.   \n\u2022 If applicable, the authors should discuss possible limitations of their approach to address problems of privacy and fairness.   \n\u2022 While the authors might fear that complete honesty about limitations might be used by reviewers as grounds for rejection, a worse outcome might be that reviewers discover limitations that aren\u2019t acknowledged in the paper. The authors should use their best judgment and recognize that individual actions in favor of transparency play an important role in developing norms that preserve the integrity of the community. Reviewers will be specifically instructed to not penalize honesty concerning limitations. ", "page_idx": 18}, {"type": "text", "text": "3. Theory Assumptions and Proofs ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Question: For each theoretical result, does the paper provide the full set of assumptions and a complete (and correct) proof? ", "page_idx": 18}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 18}, {"type": "text", "text": "Justification: Please refer to Sec.3 of the main paper. Guidelines: ", "page_idx": 19}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include theoretical results.   \n\u2022 All the theorems, formulas, and proofs in the paper should be numbered and crossreferenced.   \n\u2022 All assumptions should be clearly stated or referenced in the statement of any theorems.   \n\u2022 The proofs can either appear in the main paper or the supplemental material, but if they appear in the supplemental material, the authors are encouraged to provide a short proof sketch to provide intuition.   \n\u2022 Inversely, any informal proof provided in the core of the paper should be complemented by formal proofs provided in appendix or supplemental material.   \n\u2022 Theorems and Lemmas that the proof relies upon should be properly referenced. ", "page_idx": 19}, {"type": "text", "text": "4. Experimental Result Reproducibility ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "Question: Does the paper fully disclose all the information needed to reproduce the main experimental results of the paper to the extent that it affects the main claims and/or conclusions of the paper (regardless of whether the code and data are provided or not)? ", "page_idx": 19}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "Justification: The code link can be found in abstrct, and the hyperparameter setting can be found in Appendix B. ", "page_idx": 19}, {"type": "text", "text": "Guidelines: ", "page_idx": 19}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 If the paper includes experiments, a No answer to this question will not be perceived well by the reviewers: Making the paper reproducible is important, regardless of whether the code and data are provided or not.   \n\u2022 If the contribution is a dataset and/or model, the authors should describe the steps taken to make their results reproducible or verifiable.   \n\u2022 Depending on the contribution, reproducibility can be accomplished in various ways. For example, if the contribution is a novel architecture, describing the architecture fully might suffice, or if the contribution is a specific model and empirical evaluation, it may be necessary to either make it possible for others to replicate the model with the same dataset, or provide access to the model. In general. releasing code and data is often one good way to accomplish this, but reproducibility can also be provided via detailed instructions for how to replicate the results, access to a hosted model (e.g., in the case of a large language model), releasing of a model checkpoint, or other means that are appropriate to the research performed.   \n\u2022 While NeurIPS does not require releasing code, the conference does require all submissions to provide some reasonable avenue for reproducibility, which may depend on the nature of the contribution. For example (a) If the contribution is primarily a new algorithm, the paper should make it clear how to reproduce that algorithm. (b) If the contribution is primarily a new model architecture, the paper should describe the architecture clearly and fully. (c) If the contribution is a new model (e.g., a large language model), then there should either be a way to access this model for reproducing the results or a way to reproduce the model (e.g., with an open-source dataset or instructions for how to construct the dataset). (d) We recognize that reproducibility may be tricky in some cases, in which case authors are welcome to describe the particular way they provide for reproducibility. In the case of closed-source models, it may be that access to the model is limited in some way (e.g., to registered users), but it should be possible for other researchers to have some path to reproducing or verifying the results. ", "page_idx": 19}, {"type": "text", "text": "5. Open access to data and code ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "Question: Does the paper provide open access to the data and code, with sufficient instructions to faithfully reproduce the main experimental results, as described in supplemental material? ", "page_idx": 19}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 20}, {"type": "text", "text": "Justification: The code link can be found in abstrct, and the hyperparameter setting can be found in Appendix B. ", "page_idx": 20}, {"type": "text", "text": "Guidelines: ", "page_idx": 20}, {"type": "text", "text": "\u2022 The answer NA means that paper does not include experiments requiring code.   \n\u2022 Please see the NeurIPS code and data submission guidelines (https://nips.cc/ public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 While we encourage the release of code and data, we understand that this might not be possible, so \u201cNo\u201d is an acceptable answer. Papers cannot be rejected simply for not including code, unless this is central to the contribution (e.g., for a new open-source benchmark).   \n\u2022 The instructions should contain the exact command and environment needed to run to reproduce the results. See the NeurIPS code and data submission guidelines (https: //nips.cc/public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 The authors should provide instructions on data access and preparation, including how to access the raw data, preprocessed data, intermediate data, and generated data, etc.   \n\u2022 The authors should provide scripts to reproduce all experimental results for the new proposed method and baselines. If only a subset of experiments are reproducible, they should state which ones are omitted from the script and why.   \n\u2022 At submission time, to preserve anonymity, the authors should release anonymized versions (if applicable).   \n\u2022 Providing as much information as possible in supplemental material (appended to the paper) is recommended, but including URLs to data and code is permitted. ", "page_idx": 20}, {"type": "text", "text": "6. Experimental Setting/Details ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Question: Does the paper specify all the training and test details (e.g., data splits, hyperparameters, how they were chosen, type of optimizer, etc.) necessary to understand the results? ", "page_idx": 20}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 20}, {"type": "text", "text": "Justification: The experimental detail can be found in Sec. 5.1 of the main paper and Appendix B.1. The hyperparameter setting can be found in Appendix B.2. ", "page_idx": 20}, {"type": "text", "text": "Guidelines: ", "page_idx": 20}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments. \u2022 The experimental setting should be presented in the core of the paper to a level of detail that is necessary to appreciate the results and make sense of them. \u2022 The full details can be provided either with the code, in appendix, or as supplemental material. ", "page_idx": 20}, {"type": "text", "text": "7. Experiment Statistical Significance ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Question: Does the paper report error bars suitably and correctly defined or other appropriate information about the statistical significance of the experiments? ", "page_idx": 20}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 20}, {"type": "text", "text": "Justification: The results are accompanied by error bars, confidence intervals. We detail the calculation of error bars, running steps and the number of seeds in the text description of each figure. ", "page_idx": 20}, {"type": "text", "text": "Guidelines: ", "page_idx": 20}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The authors should answer \"Yes\" if the results are accompanied by error bars, confidence intervals, or statistical significance tests, at least for the experiments that support the main claims of the paper.   \n\u2022 The factors of variability that the error bars are capturing should be clearly stated (for example, train/test split, initialization, random drawing of some parameter, or overall run with given experimental conditions).   \n\u2022 The method for calculating the error bars should be explained (closed form formula, call to a library function, bootstrap, etc.)   \n\u2022 The assumptions made should be given (e.g., Normally distributed errors).   \n\u2022 It should be clear whether the error bar is the standard deviation or the standard error of the mean.   \n\u2022 It is OK to report 1-sigma error bars, but one should state it. The authors should preferably report a 2-sigma error bar than state that they have a $96\\%$ CI, if the hypothesis of Normality of errors is not verified.   \n\u2022 For asymmetric distributions, the authors should be careful not to show in tables or figures symmetric error bars that would yield results that are out of range (e.g. negative error rates).   \n\u2022 If error bars are reported in tables or plots, The authors should explain in the text how they were calculated and reference the corresponding figures or tables in the text. ", "page_idx": 20}, {"type": "text", "text": "", "page_idx": 21}, {"type": "text", "text": "8. Experiments Compute Resources ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "Question: For each experiment, does the paper provide sufficient information on the computer resources (type of compute workers, memory, time of execution) needed to reproduce the experiments? ", "page_idx": 21}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 21}, {"type": "text", "text": "Justification: The Experiments Compute Resources can be found in Appendix B.1 ", "page_idx": 21}, {"type": "text", "text": "Guidelines: ", "page_idx": 21}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The paper should indicate the type of compute workers CPU or GPU, internal cluster, or cloud provider, including relevant memory and storage.   \n\u2022 The paper should provide the amount of compute required for each of the individual experimental runs as well as estimate the total compute.   \n\u2022 The paper should disclose whether the full research project required more compute than the experiments reported in the paper (e.g., preliminary or failed experiments that didn\u2019t make it into the paper). ", "page_idx": 21}, {"type": "text", "text": "9. Code Of Ethics ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "Question: Does the research conducted in the paper conform, in every respect, with the NeurIPS Code of Ethics https://neurips.cc/public/EthicsGuidelines? ", "page_idx": 21}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 21}, {"type": "text", "text": "Justification: We make sure to preserve anonymity. ", "page_idx": 21}, {"type": "text", "text": "Guidelines: ", "page_idx": 21}, {"type": "text", "text": "\u2022 The answer NA means that the authors have not reviewed the NeurIPS Code of Ethics.   \n\u2022 If the authors answer No, they should explain the special circumstances that require a deviation from the Code of Ethics.   \n\u2022 The authors should make sure to preserve anonymity (e.g., if there is a special consideration due to laws or regulations in their jurisdiction). ", "page_idx": 21}, {"type": "text", "text": "10. Broader Impacts ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "Question: Does the paper discuss both potential positive societal impacts and negative societal impacts of the work performed? ", "page_idx": 21}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 21}, {"type": "text", "text": "Justification: This paper is only about promoting technological innovation and does not have social impact ", "page_idx": 21}, {"type": "text", "text": "Guidelines: ", "page_idx": 21}, {"type": "text", "text": "\u2022 The answer NA means that there is no societal impact of the work performed. \u2022 If the authors answer NA or No, they should explain why their work has no societal impact or why the paper does not address societal impact. ", "page_idx": 21}, {"type": "text", "text": "\u2022 Examples of negative societal impacts include potential malicious or unintended uses (e.g., disinformation, generating fake profiles, surveillance), fairness considerations (e.g., deployment of technologies that could make decisions that unfairly impact specific groups), privacy considerations, and security considerations.   \n\u2022 The conference expects that many papers will be foundational research and not tied to particular applications, let alone deployments. However, if there is a direct path to any negative applications, the authors should point it out. For example, it is legitimate to point out that an improvement in the quality of generative models could be used to generate deepfakes for disinformation. On the other hand, it is not needed to point out that a generic algorithm for optimizing neural networks could enable people to train models that generate Deepfakes faster.   \n\u2022 The authors should consider possible harms that could arise when the technology is being used as intended and functioning correctly, harms that could arise when the technology is being used as intended but gives incorrect results, and harms following from (intentional or unintentional) misuse of the technology.   \n\u2022 If there are negative societal impacts, the authors could also discuss possible mitigation strategies (e.g., gated release of models, providing defenses in addition to attacks, mechanisms for monitoring misuse, mechanisms to monitor how a system learns from feedback over time, improving the efficiency and accessibility of ML). ", "page_idx": 22}, {"type": "text", "text": "11. Safeguards ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Question: Does the paper describe safeguards that have been put in place for responsible release of data or models that have a high risk for misuse (e.g., pretrained language models, image generators, or scraped datasets)? ", "page_idx": 22}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 22}, {"type": "text", "text": "Justification: Ours paper poses no such risks. ", "page_idx": 22}, {"type": "text", "text": "Guidelines: ", "page_idx": 22}, {"type": "text", "text": "\u2022 The answer NA means that the paper poses no such risks.   \n\u2022 Released models that have a high risk for misuse or dual-use should be released with necessary safeguards to allow for controlled use of the model, for example by requiring that users adhere to usage guidelines or restrictions to access the model or implementing safety filters.   \n\u2022 Datasets that have been scraped from the Internet could pose safety risks. The authors should describe how they avoided releasing unsafe images.   \n\u2022 We recognize that providing effective safeguards is challenging, and many papers do not require this, but we encourage authors to take this into account and make a best faith effort. ", "page_idx": 22}, {"type": "text", "text": "12. Licenses for existing assets ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Question: Are the creators or original owners of assets (e.g., code, data, models), used in the paper, properly credited and are the license and terms of use explicitly mentioned and properly respected? ", "page_idx": 22}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 22}, {"type": "text", "text": "Justification: We cite the original paper that produced the code package, and state which version of the asset is used (include a URL). ", "page_idx": 22}, {"type": "text", "text": "Guidelines: ", "page_idx": 22}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not use existing assets.   \n\u2022 The authors should cite the original paper that produced the code package or dataset.   \n\u2022 The authors should state which version of the asset is used and, if possible, include a URL.   \n\u2022 The name of the license (e.g., CC-BY 4.0) should be included for each asset.   \n\u2022 For scraped data from a particular source (e.g., website), the copyright and terms of service of that source should be provided.   \n\u2022 If assets are released, the license, copyright information, and terms of use in the package should be provided. For popular datasets, paperswithcode.com/datasets has curated licenses for some datasets. Their licensing guide can help determine the license of a dataset.   \n\u2022 For existing datasets that are re-packaged, both the original license and the license of the derived asset (if it has changed) should be provided.   \n\u2022 If this information is not available online, the authors are encouraged to reach out to the asset\u2019s creators. ", "page_idx": 22}, {"type": "text", "text": "", "page_idx": 23}, {"type": "text", "text": "13. New Assets ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: Are new assets introduced in the paper well documented and is the documentation provided alongside the assets? ", "page_idx": 23}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 23}, {"type": "text", "text": "Justification: This paper does not release new assets. ", "page_idx": 23}, {"type": "text", "text": "Guidelines: ", "page_idx": 23}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not release new assets.   \n\u2022 Researchers should communicate the details of the dataset/code/model as part of their submissions via structured templates. This includes details about training, license, limitations, etc.   \n\u2022 The paper should discuss whether and how consent was obtained from people whose asset is used.   \n\u2022 At submission time, remember to anonymize your assets (if applicable). You can either create an anonymized URL or include an anonymized zip file. ", "page_idx": 23}, {"type": "text", "text": "14. Crowdsourcing and Research with Human Subjects ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: For crowdsourcing experiments and research with human subjects, does the paper include the full text of instructions given to participants and screenshots, if applicable, as well as details about compensation (if any)? ", "page_idx": 23}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 23}, {"type": "text", "text": "Justification: Our paper does not involve crowdsourcing nor research with human subjects. Guidelines: ", "page_idx": 23}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Including this information in the supplemental material is fine, but if the main contribution of the paper involves human subjects, then as much detail as possible should be included in the main paper.   \n\u2022 According to the NeurIPS Code of Ethics, workers involved in data collection, curation, or other labor should be paid at least the minimum wage in the country of the data collector. ", "page_idx": 23}, {"type": "text", "text": "15. Institutional Review Board (IRB) Approvals or Equivalent for Research with Human Subjects ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: Does the paper describe potential risks incurred by study participants, whether such risks were disclosed to the subjects, and whether Institutional Review Board (IRB) approvals (or an equivalent approval/review based on the requirements of your country or institution) were obtained? ", "page_idx": 23}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 23}, {"type": "text", "text": "Justification: Our paper does not involve crowdsourcing nor research with human subjects. Guidelines: ", "page_idx": 23}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Depending on the country in which research is conducted, IRB approval (or equivalent) may be required for any human subjects research. If you obtained IRB approval, you should clearly state this in the paper.   \n\u2022 We recognize that the procedures for this may vary significantly between institutions and locations, and we expect authors to adhere to the NeurIPS Code of Ethics and the guidelines for their institution.   \n\u2022 For initial submissions, do not include any information that would break anonymity (if applicable), such as the institution conducting the review. ", "page_idx": 23}, {"type": "text", "text": "", "page_idx": 24}]