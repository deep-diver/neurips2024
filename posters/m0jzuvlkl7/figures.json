[{"figure_path": "m0jZUvlKl7/figures/figures_1_1.jpg", "caption": "Figure 1: Overview of the AR-Pro framework. We first identify an input's anomalous region and then use property-guided diffusion to repair it. This repair is the counterfactual anomaly explanation, where the following properties are defined with respect to a linearly decomposable anomaly detector (AD). (Overall Improvement) The repair has a lower anomaly score. (Similarity) The repair should resemble the original. (Localized Improvement) The score over the repaired region should improve. (Non-degradation) The score over the non-anomalous region should not significantly worsen.", "description": "This figure illustrates the AR-Pro framework for generating counterfactual explanations of anomalies.  It begins by using an anomaly detector to identify anomalous regions within an input (image or time series). Then, it uses property-guided diffusion to repair these regions, generating a counterfactual example of what a non-anomalous version should look like. The quality of this repair is evaluated based on four properties: Overall Improvement (lower anomaly score), Similarity (resemblance to the original), Localized Improvement (improved score in the repaired region), and Non-degradation (no significant worsening of the score in the non-anomalous regions).", "section": "1 Introduction"}, {"figure_path": "m0jZUvlKl7/figures/figures_2_1.jpg", "caption": "Figure 2: Reconstruction-based anomaly detection exemplifies linear decomposition. The anomalous input x \u2208 Rn is first reconstructed into x \u2208 Rn, and the feature-wise anomaly scores are given by ai(x) = |xi - xi|2 \u2208 Rn for i = 1,...,n. Then, the standard (l2) reconstruction-based anomaly score is a linear combination of the feature scores: s(x) = a1(x) + \u00b7\u00b7\u00b7 + an(x).", "description": "This figure illustrates a reconstruction-based anomaly detection method.  An anomalous input image (x) is fed into an encoder, which compresses it into a latent representation. This latent representation is then passed through a decoder to reconstruct the original image (x). The difference between the original and reconstructed images (x - x) represents the anomaly map, which highlights the anomalous regions. The anomaly score (s(x)) is calculated by summing up the squared differences between the original and reconstructed features.  This demonstrates the concept of linear decomposability, where the overall anomaly score is a sum of individual feature-wise anomaly scores.", "section": "2.1 Common Anomaly Detectors are Linearly Decomposable"}, {"figure_path": "m0jZUvlKl7/figures/figures_4_1.jpg", "caption": "Figure 3: We run property-guided diffusion with masked in-filling.", "description": "This figure illustrates the process of property-guided diffusion with masked in-filling used in the AR-Pro framework for anomaly repair.  The process starts with an initial noise image (Xfix,T) and iteratively refines it through denoising steps. Each step incorporates property-based guidance to ensure the repair satisfies the defined properties (Overall Improvement, Similarity, Localized Improvement, and Non-degradation) and masked in-filling to preserve the non-anomalous parts of the original image. The process continues until a final repaired image (Xfix,0) is obtained. The figure shows the intermediate stages of the process, highlighting the iterative refinement towards a high-quality repair.", "section": "3 Property-guided Generation of Counterfactual Explanations"}, {"figure_path": "m0jZUvlKl7/figures/figures_8_1.jpg", "caption": "Figure 4: The original input and ground truth anomaly mask are displayed in the first two columns. The baseline method fails to preserve close similarity to the input PCB boards, as highlighted in the third column. Guided vision repair examples in the fourth column address these deficiencies.", "description": "This figure shows a comparison of anomaly repair results between a baseline method and the proposed AR-Pro method on four PCB images. The first two columns display the original input images and their corresponding ground truth anomaly masks. The third column shows the results obtained using a baseline method, highlighting its failure to maintain similarity to the original input and properly repair the anomalies. The fourth column showcases the AR-Pro method's results, demonstrating its ability to generate high-quality repairs that closely resemble the original inputs while effectively correcting the anomalies.", "section": "Experiments"}, {"figure_path": "m0jZUvlKl7/figures/figures_8_2.jpg", "caption": "Figure 5: MVTec repairs with AR-Pro; better resemble the original compared to the baseline.", "description": "This figure shows visual comparisons of anomaly repairs generated by AR-Pro and a baseline method on the MVTec dataset.  It visually demonstrates AR-Pro's ability to produce repairs that maintain a greater similarity to the original input image compared to the baseline, highlighting the effectiveness of the property-guided diffusion approach in preserving semantic meaning.", "section": "Experiments"}, {"figure_path": "m0jZUvlKl7/figures/figures_9_1.jpg", "caption": "Figure 6: Original input is the blue line, property guided fix is the green line, and the baseline is the red line. The first image shows that the baseline generates a spurious signal when there is no anomaly. The second image shows that the baseline repairs the anomaly, but not as effectively as with guidance. The last two images show instances where the baseline fails to repair the anomaly.", "description": "This figure displays four time-series plots comparing the performance of AR-Pro (property-guided repair) against a baseline method in repairing anomalies.  Each plot shows an original time series (blue), a repaired time series using AR-Pro (green), and a repaired time series using the baseline method (red). The plots illustrate scenarios where: (a) both methods successfully repair the anomaly, (b) the baseline fails to repair the anomaly while AR-Pro does, and (c,d) the baseline method creates a spurious signal or fails to effectively repair the anomaly. The figure demonstrates the effectiveness of the AR-Pro method, highlighting its superior ability to generate accurate, semantically meaningful repairs.", "section": "Experiments"}, {"figure_path": "m0jZUvlKl7/figures/figures_9_2.jpg", "caption": "Figure 7: Varying the hyper-parameters does significantly change Ms, Ma, Mw, and Mw.", "description": "This figure displays ablation study results, specifically the effect of varying hyperparameters (\u03bb1, \u03bb2, \u03bb3, \u03bb4) on four different metrics (Ms, Md, Mw, Mw). Each subplot shows how changing one hyperparameter while keeping others constant influences the corresponding metric.  The x-axis represents the hyperparameter values, and the y-axis represents the metric values. This illustrates the sensitivity and robustness of the anomaly repair process with respect to hyperparameter tuning.", "section": "4.2 (RQ2) Ablation Study"}, {"figure_path": "m0jZUvlKl7/figures/figures_16_1.jpg", "caption": "Figure 8: More VisA examples. With AR-Pro, we have anomaly repairs resemble inputs better, compared with baseline.", "description": "This figure shows several examples from the VisA dataset to visually compare the anomaly repair results generated by AR-Pro against a baseline method.  Each example shows the original image, a mask highlighting the anomalous region, the repaired image from the baseline method, and the repaired image from AR-Pro. The comparison highlights AR-Pro's ability to generate repairs that closely resemble the original, non-anomalous version of the images, better than the baseline approach.", "section": "Experiments"}, {"figure_path": "m0jZUvlKl7/figures/figures_17_1.jpg", "caption": "Figure 5: MVTec repairs with AR-Pro; better resemble the original compared to the baseline.", "description": "This figure presents a comparison of anomaly repair results between the AR-Pro framework and a baseline method on the MVTec dataset.  It visually demonstrates that AR-Pro produces repairs that are more similar to the original, non-anomalous inputs compared to the baseline.  The differences are highlighted to illustrate the improvements in visual fidelity and semantic preservation achieved by AR-Pro.", "section": "Experiments"}, {"figure_path": "m0jZUvlKl7/figures/figures_18_1.jpg", "caption": "Figure 5: MVTec repairs with AR-Pro; better resemble the original compared to the baseline.", "description": "This figure showcases visual anomaly repair results on the MVTec dataset using AR-Pro.  It compares the repairs generated by AR-Pro to those of a baseline method, demonstrating AR-Pro's ability to generate repairs that are more visually similar to the original, non-anomalous images. The differences highlight how AR-Pro's property-guided approach leads to higher-quality repairs that maintain better visual fidelity.", "section": "Experiments"}, {"figure_path": "m0jZUvlKl7/figures/figures_18_2.jpg", "caption": "Figure 3: We run property-guided diffusion with masked in-filling.", "description": "This figure illustrates the process of property-guided diffusion with masked in-filling used in the AR-Pro framework. It shows how the model iteratively refines a noisy input (xfix,T) towards a high-quality repair (xfix).  Each step involves a denoising process guided by property-based losses, ensuring that the repair satisfies specific criteria (overall improvement, similarity, localized improvement, and non-degradation).  Masked in-filling helps preserve the non-anomalous regions during the repair process. The overall flow is from a noisy initial state to a refined repair that aligns with the desired properties.", "section": "3 Property-guided Generation of Counterfactual Explanations"}, {"figure_path": "m0jZUvlKl7/figures/figures_19_1.jpg", "caption": "Figure 3: We run property-guided diffusion with masked in-filling.", "description": "This figure shows the process of property-guided diffusion with masked in-filling used in the AR-Pro framework. It depicts a sequence of steps: first, denoising steps are performed on an anomalous input image;  then, property-based guidance is applied to nudge the iterations towards a high-quality repair; finally, masked in-filling ensures that non-anomalous regions are preserved during the process. The output is a repaired image (xfix) which serves as a counterfactual explanation for the anomaly.", "section": "3 Property-guided Generation of Counterfactual Explanations"}, {"figure_path": "m0jZUvlKl7/figures/figures_19_2.jpg", "caption": "Figure 1: Overview of the AR-Pro framework. We first identify an input's anomalous region and then use property-guided diffusion to repair it. This repair is the counterfactual anomaly explanation, where the following properties are defined with respect to a linearly decomposable anomaly detector (AD). (Overall Improvement) The repair has a lower anomaly score. (Similarity) The repair should resemble the original. (Localized Improvement) The score over the repaired region should improve. (Non-degradation) The score over the non-anomalous region should not significantly worsen.", "description": "This figure illustrates the AR-Pro framework, a method for generating counterfactual explanations for anomaly repair.  The process begins by identifying an input's anomalous region using an anomaly detector. Then, a property-guided diffusion model is used to repair the anomalous region, creating a counterfactual example of what a non-anomalous version should look like.  Four key properties guide the repair process: overall improvement (lower anomaly score), similarity to the original input, localized improvement (score in the repaired area improves), and non-degradation (score in the non-anomalous area does not worsen significantly).", "section": "1 Introduction"}, {"figure_path": "m0jZUvlKl7/figures/figures_19_3.jpg", "caption": "Figure 1: Overview of the AR-Pro framework. We first identify an input's anomalous region and then use property-guided diffusion to repair it. This repair is the counterfactual anomaly explanation, where the following properties are defined with respect to a linearly decomposable anomaly detector (AD). (Overall Improvement) The repair has a lower anomaly score. (Similarity) The repair should resemble the original. (Localized Improvement) The score over the repaired region should improve. (Non-degradation) The score over the non-anomalous region should not significantly worsen.", "description": "This figure provides a high-level overview of the AR-Pro framework, which uses a generative model to repair anomalies and offers counterfactual explanations. The process begins with the identification of anomalous regions in the input, followed by the use of property-guided diffusion to produce a repair. This repair acts as the counterfactual explanation for the anomaly. The effectiveness of the repair is evaluated based on four key properties that ensure its quality and relevance as an explanation: overall improvement, similarity, localized improvement, and non-degradation. These properties are defined with respect to a linearly decomposable anomaly detector, making the evaluation domain-independent.", "section": "1 Introduction"}]