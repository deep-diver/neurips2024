[{"figure_path": "nRRJsDahEg/figures/figures_2_1.jpg", "caption": "Figure 1: Schematic illustration of our Multi-task-Masking (MtM) approach: (A) We introduce four metrics for evaluating foundation models of neural population activity: neuron co-smoothing, causal prediction, inter-region prediction, and intra-region prediction. For each masking scheme, the colored area indicates what is masked and then reconstructed for evaluation. For intra-region prediction, the colored areas with hatched lines indicate areas which are masked, but not reconstructed for evaluation. Each metric can be associated with a specific masking scheme during training (T1, T2, etc.). (B) We alternate between different masking schemes during training along with a learnable \u201cprompt\u201d token which provides context to the model about the associated task [35]. During evaluation, we provide the associated prompt token for the downstream task to perform test-time adaptation of the model. Our MtM approach is architecture-agnostic as masking is performed on the input data (not the tokens). For a full discussion of MtM, see Section 3.", "description": "This figure schematically illustrates the multi-task masking (MtM) approach.  Panel A shows four metrics used to evaluate foundation models: co-smoothing, causal prediction, inter-region prediction, and intra-region prediction.  Different colored areas represent masked regions that are later reconstructed. Panel B details the MtM training process, highlighting the alternation between masking schemes and the use of a learnable \"prompt\" token to provide context to the model.  This token allows for seamless switching between masking objectives during training and test-time adaptation for downstream tasks.", "section": "Methods"}, {"figure_path": "nRRJsDahEg/figures/figures_6_1.jpg", "caption": "Figure 2: Comparison of the temporal masking baseline and our proposed MtM method on single-session data. (A) and (B) show trial-averaged raster maps of CA1 for ground-truth data, MtM, and the temporal baseline. (A) The predictions from MtM and the temporal baseline are after inter-region masking where neurons in CA1 are predicted from all other brain regions. We highlight two areas (1 and 2) where MtM shows qualitatively better predictions of activity. (B) The predictions from MtM and the temporal baseline are after intra-region masking where all neurons in CA1 are predicted from other neurons in the same brain region. We again highlight two areas (1 and 2) where MtM shows qualitatively better predictions of activity. (C) Activity reconstruction and behavior decoding across 39 sessions for MtM and temporal masking. Each point represents one session. For activity reconstruction, we report the average bps. For choice and whisker motion energy decoding, we report the average accuracy and R\u00b2, respectively, across all test trials. We use the NDT1 architecture for all comparisons.", "description": "This figure compares the performance of the proposed multi-task masking (MtM) method against a temporal masking baseline for single-session neural data.  Panels A and B show raster plots illustrating the superior performance of MtM in reconstructing neural activity in the CA1 region under both inter-region and intra-region masking schemes.  Panel C presents a comparison of the overall performance of MtM and the baseline across multiple performance metrics (activity reconstruction and behavioral decoding) and across 39 experimental sessions.", "section": "Results"}, {"figure_path": "nRRJsDahEg/figures/figures_7_1.jpg", "caption": "Figure 2: Comparison of the temporal masking baseline and our proposed MtM method on single-session data. (A) and (B) show trial-averaged raster maps of CA1 for ground-truth data, MtM, and the temporal baseline. (A) The predictions from MtM and the temporal baseline are after inter-region masking where neurons in CA1 are predicted from all other brain regions. We highlight two areas (1 and 2) where MtM shows qualitatively better predictions of activity. (B) The predictions from MtM and the temporal baseline are after intra-region masking where all neurons in CA1 are predicted from other neurons in the same brain region. We again highlight two areas (1 and 2) where MtM shows qualitatively better predictions of activity. (C) Activity reconstruction and behavior decoding across 39 sessions for MtM and temporal masking. Each point represents one session. For activity reconstruction, we report the average bps. For choice and whisker motion energy decoding, we report the average accuracy and R\u00b2, respectively, across all test trials. We use the NDT1 architecture for all comparisons.", "description": "This figure compares the performance of the proposed multi-task masking (MtM) method against a temporal masking baseline on single-session neural data. It shows trial-averaged raster maps for CA1, highlighting regions where MtM provides better predictions than the baseline for both inter-region and intra-region masking.  Additionally, it presents a comparison of activity reconstruction and behavioral decoding performance across multiple sessions, illustrating the superior performance of MtM.", "section": "Results"}, {"figure_path": "nRRJsDahEg/figures/figures_8_1.jpg", "caption": "Figure 2: Comparison of the temporal masking baseline and our proposed MtM method on single-session data. (A) and (B) show trial-averaged raster maps of CA1 for ground-truth data, MtM, and the temporal baseline. (A) The predictions from MtM and the temporal baseline are after inter-region masking where neurons in CA1 are predicted from all other brain regions. We highlight two areas (1 and 2) where MtM shows qualitatively better predictions of activity. (B) The predictions from MtM and the temporal baseline are after intra-region masking where all neurons in CA1 are predicted from other neurons in the same brain region. We again highlight two areas (1 and 2) where MtM shows qualitatively better predictions of activity. (C) Activity reconstruction and behavior decoding across 39 sessions for MtM and temporal masking. Each point represents one session. For activity reconstruction, we report the average bps. For choice and whisker motion energy decoding, we report the average accuracy and R\u00b2, respectively, across all test trials. We use the NDT1 architecture for all comparisons.", "description": "This figure compares the performance of the proposed multi-task masking (MtM) method against a temporal masking baseline on single-session neural data. It shows trial-averaged raster plots for CA1, highlighting regions where MtM provides better predictions compared to the baseline for both inter-region and intra-region masking schemes.  Additionally, it presents a comparison of the activity reconstruction and behavior decoding performance across 39 sessions using different metrics, indicating MtM's superior performance.", "section": "6 Results"}, {"figure_path": "nRRJsDahEg/figures/figures_8_2.jpg", "caption": "Figure 2: Comparison of the temporal masking baseline and our proposed MtM method on single-session data. (A) and (B) show trial-averaged raster maps of CA1 for ground-truth data, MtM, and the temporal baseline. (A) The predictions from MtM and the temporal baseline are after inter-region masking where neurons in CA1 are predicted from all other brain regions. We highlight two areas (1 and 2) where MtM shows qualitatively better predictions of activity. (B) The predictions from MtM and the temporal baseline are after intra-region masking where all neurons in CA1 are predicted from other neurons in the same brain region. We again highlight two areas (1 and 2) where MtM shows qualitatively better predictions of activity. (C) Activity reconstruction and behavior decoding across 39 sessions for MtM and temporal masking. Each point represents one session. For activity reconstruction, we report the average bps. For choice and whisker motion energy decoding, we report the average accuracy and R\u00b2, respectively, across all test trials. We use the NDT1 architecture for all comparisons.", "description": "This figure compares the performance of the proposed multi-task masking (MtM) approach against a temporal masking baseline for single-session neural data.  Panel A and B show raster plots illustrating improved activity prediction by MtM in CA1 for both inter-region and intra-region masking scenarios. Panel C summarizes the performance across all 39 sessions for both activity reconstruction and behavioral decoding tasks, indicating that MtM significantly outperforms the temporal masking baseline.", "section": "Results"}, {"figure_path": "nRRJsDahEg/figures/figures_13_1.jpg", "caption": "Figure 2: Comparison of the temporal masking baseline and our proposed MtM method on single-session data. (A) and (B) show trial-averaged raster maps of CA1 for ground-truth data, MtM, and the temporal baseline. (A) The predictions from MtM and the temporal baseline are after inter-region masking where neurons in CA1 are predicted from all other brain regions. We highlight two areas (1 and 2) where MtM shows qualitatively better predictions of activity. (B) The predictions from MtM and the temporal baseline are after intra-region masking where all neurons in CA1 are predicted from other neurons in the same brain region. We again highlight two areas (1 and 2) where MtM shows qualitatively better predictions of activity. (C) Activity reconstruction and behavior decoding across 39 sessions for MtM and temporal masking. Each point represents one session. For activity reconstruction, we report the average bps. For choice and whisker motion energy decoding, we report the average accuracy and R\u00b2, respectively, across all test trials. We use the NDT1 architecture for all comparisons.", "description": "This figure compares the performance of the proposed multi-task masking (MtM) method against a temporal masking baseline for single-session neural data.  Panel A and B show raster plots visualizing the model's ability to reconstruct neural activity after inter- and intra-region masking, respectively, highlighting MtM's superior performance. Panel C presents a comparison across multiple sessions, evaluating activity reconstruction (bps) and behavior decoding (accuracy and R-squared) for both methods.  The NDT1 architecture was used for all comparisons.", "section": "Results"}, {"figure_path": "nRRJsDahEg/figures/figures_14_1.jpg", "caption": "Figure 2: Comparison of the temporal masking baseline and our proposed MtM method on single-session data. (A) and (B) show trial-averaged raster maps of CA1 for ground-truth data, MtM, and the temporal baseline. (A) The predictions from MtM and the temporal baseline are after inter-region masking where neurons in CA1 are predicted from all other brain regions. We highlight two areas (1 and 2) where MtM shows qualitatively better predictions of activity. (B) The predictions from MtM and the temporal baseline are after intra-region masking where all neurons in CA1 are predicted from other neurons in the same brain region. We again highlight two areas (1 and 2) where MtM shows qualitatively better predictions of activity. (C) Activity reconstruction and behavior decoding across 39 sessions for MtM and temporal masking. Each point represents one session. For activity reconstruction, we report the average bps. For choice and whisker motion energy decoding, we report the average accuracy and R\u00b2, respectively, across all test trials. We use the NDT1 architecture for all comparisons.", "description": "This figure compares the performance of the multi-task masking (MtM) approach with a temporal masking baseline on single-session data.  Panel A and B show raster plots illustrating that MtM better reconstructs neural activity in CA1, both when using information from other brain regions (inter-region) and from within CA1 itself (intra-region).  Panel C summarizes the results across all 39 sessions, showing MtM's improved performance on activity reconstruction and behavior decoding.", "section": "Results"}, {"figure_path": "nRRJsDahEg/figures/figures_14_2.jpg", "caption": "Figure 2: Comparison of the temporal masking baseline and our proposed MtM method on single-session data. (A) and (B) show trial-averaged raster maps of CA1 for ground-truth data, MtM, and the temporal baseline. (A) The predictions from MtM and the temporal baseline are after inter-region masking where neurons in CA1 are predicted from all other brain regions. We highlight two areas (1 and 2) where MtM shows qualitatively better predictions of activity. (B) The predictions from MtM and the temporal baseline are after intra-region masking where all neurons in CA1 are predicted from other neurons in the same brain region. We again highlight two areas (1 and 2) where MtM shows qualitatively better predictions of activity. (C) Activity reconstruction and behavior decoding across 39 sessions for MtM and temporal masking. Each point represents one session. For activity reconstruction, we report the average bps. For choice and whisker motion energy decoding, we report the average accuracy and R\u00b2, respectively, across all test trials. We use the NDT1 architecture for all comparisons.", "description": "This figure compares the performance of the Multi-task Masking (MtM) approach against a temporal masking baseline on single-session data from 39 mice. It shows trial-averaged raster maps for two brain regions (CA1 and LP), highlighting areas where MtM produces qualitatively better predictions.  It also presents a comparison of activity reconstruction and behavior decoding across all sessions, using various metrics like bits per spike (bps), accuracy, and R-squared (R\u00b2).", "section": "Results"}, {"figure_path": "nRRJsDahEg/figures/figures_15_1.jpg", "caption": "Figure 2: Comparison of the temporal masking baseline and our proposed MtM method on single-session data. (A) and (B) show trial-averaged raster maps of CA1 for ground-truth data, MtM, and the temporal baseline. (A) The predictions from MtM and the temporal baseline are after inter-region masking where neurons in CA1 are predicted from all other brain regions. We highlight two areas (1 and 2) where MtM shows qualitatively better predictions of activity. (B) The predictions from MtM and the temporal baseline are after intra-region masking where all neurons in CA1 are predicted from other neurons in the same brain region. We again highlight two areas (1 and 2) where MtM shows qualitatively better predictions of activity. (C) Activity reconstruction and behavior decoding across 39 sessions for MtM and temporal masking. Each point represents one session. For activity reconstruction, we report the average bps. For choice and whisker motion energy decoding, we report the average accuracy and R\u00b2, respectively, across all test trials. We use the NDT1 architecture for all comparisons.", "description": "This figure compares the performance of the proposed multi-task masking (MtM) method against a temporal masking baseline on single-session neural data.  Panel A and B show raster plots illustrating the superior ability of MtM to predict neural activity in the CA1 region, both from other brain regions (inter-region) and from within the CA1 region itself (intra-region). Panel C provides a summary of the performance across 39 sessions for both methods, demonstrating that MtM outperforms the baseline in activity reconstruction and behavior decoding metrics.", "section": "Results"}, {"figure_path": "nRRJsDahEg/figures/figures_16_1.jpg", "caption": "Figure 1: Schematic illustration of our Multi-task-Masking (MtM) approach: (A) We introduce four metrics for evaluating foundation models of neural population activity: neuron co-smoothing, causal prediction, inter-region prediction, and intra-region prediction. For each masking scheme, the colored area indicates what is masked and then reconstructed for evaluation. For intra-region prediction, the colored areas with hatched lines indicate areas which are masked, but not reconstructed for evaluation. Each metric can be associated with a specific masking scheme during training (T1, T2, etc.). (B) We alternate between different masking schemes during training along with a learnable \"prompt\" token which provides context to the model about the associated task [35]. During evaluation, we provide the associated prompt token for the downstream task to perform test-time adaptation of the model. Our MtM approach is architecture-agnostic as masking is performed on the input data (not the tokens). For a full discussion of MtM, see Section 3.", "description": "This figure schematically illustrates the Multi-task-Masking (MtM) approach. Panel A shows four metrics for evaluating neural population activity models: co-smoothing, causal prediction, inter-region prediction, and intra-region prediction.  Different colored areas represent masked and reconstructed regions for each metric. Panel B depicts the training process, showing how the model alternates between masking schemes using a learnable \"prompt\" token to provide context.", "section": "Methods"}, {"figure_path": "nRRJsDahEg/figures/figures_17_1.jpg", "caption": "Figure 2: Comparison of the temporal masking baseline and our proposed MtM method on single-session data. (A) and (B) show trial-averaged raster maps of CA1 for ground-truth data, MtM, and the temporal baseline. (A) The predictions from MtM and the temporal baseline are after inter-region masking where neurons in CA1 are predicted from all other brain regions. We highlight two areas (1 and 2) where MtM shows qualitatively better predictions of activity. (B) The predictions from MtM and the temporal baseline are after intra-region masking where all neurons in CA1 are predicted from other neurons in the same brain region. We again highlight two areas (1 and 2) where MtM shows qualitatively better predictions of activity. (C) Activity reconstruction and behavior decoding across 39 sessions for MtM and temporal masking. Each point represents one session. For activity reconstruction, we report the average bps. For choice and whisker motion energy decoding, we report the average accuracy and R\u00b2, respectively, across all test trials. We use the NDT1 architecture for all comparisons.", "description": "This figure compares the performance of the proposed multi-task masking (MtM) method against a temporal masking baseline for single-session neural data.  Panels A and B show raster plots visualizing the activity predictions of MtM and the baseline for two different masking schemes (inter-region and intra-region).  Panel C provides a summary of activity reconstruction and behavioral decoding performance across 39 sessions, demonstrating the superior performance of MtM.", "section": "Results"}, {"figure_path": "nRRJsDahEg/figures/figures_17_2.jpg", "caption": "Figure 2: Comparison of the temporal masking baseline and our proposed MtM method on single-session data. (A) and (B) show trial-averaged raster maps of CA1 for ground-truth data, MtM, and the temporal baseline. (A) The predictions from MtM and the temporal baseline are after inter-region masking where neurons in CA1 are predicted from all other brain regions. We highlight two areas (1 and 2) where MtM shows qualitatively better predictions of activity. (B) The predictions from MtM and the temporal baseline are after intra-region masking where all neurons in CA1 are predicted from other neurons in the same brain region. We again highlight two areas (1 and 2) where MtM shows qualitatively better predictions of activity. (C) Activity reconstruction and behavior decoding across 39 sessions for MtM and temporal masking. Each point represents one session. For activity reconstruction, we report the average bps. For choice and whisker motion energy decoding, we report the average accuracy and R\u00b2, respectively, across all test trials. We use the NDT1 architecture for all comparisons.", "description": "This figure compares the performance of the proposed multi-task masking (MtM) method against a temporal masking baseline on single-session data from 39 mice.  Panels A and B show raster plots illustrating MtM's improved prediction accuracy for inter-region and intra-region activity, respectively.  Panel C provides a summary comparing the overall performance of MtM and the baseline across different tasks.", "section": "Results"}, {"figure_path": "nRRJsDahEg/figures/figures_18_1.jpg", "caption": "Figure 1: Schematic illustration of our Multi-task-Masking (MtM) approach: (A) We introduce four metrics for evaluating foundation models of neural population activity: neuron co-smoothing, causal prediction, inter-region prediction, and intra-region prediction. For each masking scheme, the colored area indicates what is masked and then reconstructed for evaluation. For intra-region prediction, the colored areas with hatched lines indicate areas which are masked, but not reconstructed for evaluation. Each metric can be associated with a specific masking scheme during training (T1, T2, etc.). (B) We alternate between different masking schemes during training along with a learnable \"prompt\" token which provides context to the model about the associated task [35]. During evaluation, we provide the associated prompt token for the downstream task to perform test-time adaptation of the model. Our MtM approach is architecture-agnostic as masking is performed on the input data (not the tokens). For a full discussion of MtM, see Section 3.", "description": "This figure schematically illustrates the Multi-task Masking (MtM) approach.  Panel A shows the four metrics used to evaluate the model: co-smoothing, causal prediction, inter-region prediction, and intra-region prediction.  The colored areas represent masked sections of the input data. Panel B demonstrates the training process, showing how the model alternates between different masking schemes guided by a learnable \"prompt\" token.  This token allows for seamless switching between tasks during both training and evaluation, making the approach flexible and adaptable.", "section": "Methods"}]