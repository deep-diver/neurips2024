A Best-of-both-worlds Algorithm for Bandits with Delayed Feedback with Robustness to Excessive Delays