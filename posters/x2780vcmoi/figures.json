[{"figure_path": "x2780VcMOI/figures/figures_1_1.jpg", "caption": "Figure 1: Dependency trees hypothesized in linguistics and in neural networks. A. According to the dependency grammar framework, the sentences can be described as linear sequences of words connected by an acyclic graph. B. More precisely, such acyclic graph is both labeled and directed, where each edge has a direction, representing the hierarchy of the syntactic relation, and a label, representing the type of syntactic relation. C. The Structural Probe (Hewitt and Manning, 2019) finds a a linear transform (gray plane) of the language model's activations (here simplified as a 3D space), such that the distance between word embeddings is predicted by their dependency tree. In the Structural Probe subspace, however, it is not possible to distinguish whether \"The cat chases the mouse\" or \"The mouse chases the cat.\" D. Our Polar Probe finds a linear transformation where the angle between syntactically-related word additionally represents the type and direction of these syntactic relations, and the distance codes its presence. The colored arrows indicate orthogonal directions in the Polar-Probe subspace.", "description": "This figure illustrates the difference between dependency trees as represented in linguistics and neural networks.  Panel A shows an unlabeled undirected graph. Panel B depicts labeled directed dependency trees. Panel C shows how the Structural Probe represents syntactic relations based on distance between word embeddings. Panel D illustrates the Polar Probe's novel approach to represent syntactic relations using both distance and direction in a polar coordinate system.", "section": "1 Introduction"}, {"figure_path": "x2780VcMOI/figures/figures_5_1.jpg", "caption": "Figure 2: The Polar Probe reliably identifies dependency types. A. PCA visualization of edges linearly read by the Polar Probe. The color of each edge corresponds to one of three different dependency types ('nsubj', 'obj', 'det'): the linear readouts point in systematic directions. B. AUC and Balanced Accuracy metrics obtained for dependency type classification. C. Pairwise cosine similarity (0=orthogonal, 1=collinear) matrices obtained without a probe (left) the Structural Probe (middle) and the Polar Probe (right).", "description": "This figure shows that the Polar Probe effectively identifies dependency types. Panel A presents a PCA visualization, where edges (syntactic relations between words) are colored according to their dependency type and exhibit systematic directional patterns in the Polar Probe's representation space. Panel B displays the AUC (Area Under the Curve) and balanced accuracy scores evaluating the probe's performance in classifying dependency types. Finally, Panel C depicts pairwise cosine similarity matrices demonstrating that the Polar Probe better distinguishes between dependency types compared to both the Structural Probe and a baseline with no probe.", "section": "2.7 Evaluation"}, {"figure_path": "x2780VcMOI/figures/figures_7_1.jpg", "caption": "Figure 3: The Polar Probe outperforms the Structural Probe at identifying labeled and directed dependencies. A. For dependency existence, the Polar Probe matches the UUAS performance of the Structural probe, peaking at layer 16. B. For dependency type, the Polar Probe outperforms in Label Accuracy the Structural (LAS) Probe by around 80% accross the different layers of Llama-2-7b-hf. C. For both dependency existence and type, the Polar Probe outperforms in LAS the Structural Probe by around 90% accross the different layers of Llama-2-7b-hf.", "description": "This figure shows a comparison of the performance of three different probes (Polar Probe, Polar Probe with a random language model, and Structural Probe) across different layers of a language model.  The three plots show the results for dependency existence (UUAS), dependency type accuracy, and a combined score (LAS).  The Polar Probe consistently outperforms the other methods, particularly in predicting the type of dependency relationships. The best performance for all probes is generally observed around layer 16.", "section": "Results"}, {"figure_path": "x2780VcMOI/figures/figures_7_2.jpg", "caption": "Figure 4: The optimal dimensionality for the Polar Probe is an order of magnitude small than model's layer size. Polar Probe performance as a function of dimensionality, measured by A. UUAS, B. Dependency Type Accuracy and C. LAS for Llama-2-7b-hf as a function of k\", the dimensionality of the probe's space. The optimal dimensionality for the Polar Probe is 128, achieving the highest LAS.", "description": "This figure displays the performance of the Polar Probe model in relation to its dimensionality (k\"). It shows three subplots: A) Dependency Existence Score (UUAS), B) Dependency Type Score (Accuracy), and C) Combined Existence and Type Score (LAS). Each subplot illustrates how the respective metric changes as the dimensionality (k\") of the Polar Probe increases.  The optimal dimensionality for the model appears to be around 128, beyond which performance improvement plateaus.", "section": "Dimensionality analysis"}, {"figure_path": "x2780VcMOI/figures/figures_8_1.jpg", "caption": "Figure 5: Visualization of the dependency tree uncovered by the Polar Probe on a set of sentences with increasingly complex hierarchical structures. A. We display a PCA visualization of the distributions of word embeddings (once linearly read out by the Polar Probe), for the different syntactic levels in the \"Controlled Dataset\". Each individual distribution corresponds to a specific role of the word in the sentence. The centroids are linked with black lines, displaying the syntactic tree of the corresponding sentence. B. Most frequent syntactic tree prediction by the Polar Probe for the different syntactic levels. The relations between words are color coded according to the type of syntactic dependency. The incorrectly predicted relations are represented with dashed arrows. That is, either a dependency relation existence (no arrow), or a dependency type (with arrow) was erroneously identified.", "description": "This figure visualizes how the Polar Probe represents dependency trees in sentences with varying complexity (short, relative clause, and long-nested structures).  Panel A shows PCA visualizations of word embeddings, grouped by their syntactic role within each sentence type, highlighting how similar roles cluster together. Panel B compares the true dependency trees against those predicted by the Polar Probe, color-coding relationships by type and using dashed lines to indicate incorrect predictions.", "section": "Controlled sentences"}, {"figure_path": "x2780VcMOI/figures/figures_14_1.jpg", "caption": "Figure 6: Polar Probe performance on the EN-EWT dataset for Language Models with different families and sizes", "description": "This figure displays a scatter plot showing the relationship between the performance of the Polar Probe (measured by the Structural and Label Score) and the number of parameters in various Language Models. Different colors represent different families of Language Models (GPT-2, Pythia, MLM, Llama, and Mistral). The plot shows that as the parameter count increases, the Structural and Label Score tends to increase.  The plot visually demonstrates that within families, larger language models perform better on average.  It helps to compare the performance across different Language Model architectures. ", "section": "3 Results"}, {"figure_path": "x2780VcMOI/figures/figures_14_2.jpg", "caption": "Figure 7: Comparative analysis of Polar Probe performance on the N-EWT dataset as a function of sentence length (left) and sentence depth (right). The scores are shown across various model sizes (ranked by model size), with darker lines indicating larger models.", "description": "This figure shows a comparative analysis of the Polar Probe's performance on the English Web Treebank (EWT) dataset. The left panel displays the relationship between sentence length and the Polar Probe's performance, while the right panel shows the relationship between sentence depth and the probe's performance. In both panels, the scores are shown across different model sizes, with larger models shown as darker lines. The results show that the Polar Probe's performance is affected by both sentence length and depth, with longer and deeper sentences resulting in lower scores. The performance also improves with larger model sizes.", "section": "Results"}, {"figure_path": "x2780VcMOI/figures/figures_14_3.jpg", "caption": "Figure 8: Polar Probe performance across different sentence structures and dependency types in a controlled dataset. The three categories (Short, Relative clause, and Long-nested) show the performance breakdown by Unlabeled Attachment Score (UUAS), Labeled Attachment Score (LAS), and specific dependency relations in the main phrase. Error bars represent the standard error across relations.", "description": "This figure displays the Polar Probe's performance on a controlled dataset with varying sentence complexity (short, relative clause, long-nested).  It shows the accuracy (with error bars) of predicting dependency tree structures (UUAS, LAS) and specific dependency types (nsubj, obj, nmod, det) for each sentence type.  The results highlight the probe's ability to handle increasingly complex syntactic structures.", "section": "Results"}]