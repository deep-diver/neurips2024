[{"type": "text", "text": "Shared Autonomy with IDA: Interventional Diffusion Assistance ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Brandon J. McMahan1, Zhenghao Peng1, Bolei Zhou1, Jonathan C. Kao1 1University of California, Los Angeles bmcmahan2025@g.ucla.edu pzh@cs.ucla.edu bolei@cs.ucla.edu kao@seas.ucla.edu ", "page_idx": 0}, {"type": "text", "text": "Abstract ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "The rapid development of artificial intelligence (AI) has unearthed the potential to assist humans in controlling advanced technologies. Shared autonomy (SA) facilitates control by combining inputs from a human pilot and an AI copilot. In prior SA studies, the copilot is constantly active in determining the action played at each time step. This limits human autonomy and may have deleterious effects on performance. In general, the amount of helpful copilot assistance can vary greatly depending on the task dynamics. We therefore hypothesize that human autonomy and SA performance improve through dynamic and selective copilot intervention. To address this, we develop a goal-agnostic intervention assistance (IA) that dynamically shares control by having the copilot intervene only when the expected value of the copilot\u2019s action exceeds that of the human\u2019s action across all possible goals. We implement IA with a diffusion copilot (termed IDA) trained on expert demonstrations with goal masking. We prove a lower bound on the performance of IA that depends on pilot and copilot performance. Experiments with simulated human pilots show that IDA achieves higher performance than pilot-only and traditional SA control in variants of the Reacher environment and Lunar Lander. We then demonstrate that IDA achieves better control in Lunar Lander with human-in-the-loop experiments. Human participants report greater autonomy with IDA and prefer IDA over pilot-only and traditional SA control. We attribute the success of IDA to preserving human autonomy while simultaneously offering assistance to prevent the human pilot from entering universally bad states. ", "page_idx": 0}, {"type": "text", "text": "1 Introduction ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "As technology advances, humans continuously seek to operate more sophisticated and complex devices (Cascio and Montealegre, 2016). However, more sophisticated technologies typically involve complicated operational dynamics and high-dimensional control systems that restrict their use to narrowly defined environments and highly specialized operators (Schulman et al., 2018). While fully autonomous AI agents can be trained to perform these tasks, this approach has three key limitations. First, the user\u2019s goal is internalized and not easily deducible in most real-world environments. Second, removing the user from the control loop reduces their autonomy, potentially leading to poor performance and decreased engagement (Wilson and Daugherty, 2018a,b). Third, as the capabilities of AI advance, it is important to consider how to create technologies that assist and empower humans instead of replacing them (Wilson and Daugherty, 2018a,b). ", "page_idx": 0}, {"type": "text", "text": "Shared autonomy (SA) addresses these limitations by blending human (pilot) actions with assistive agent (copilot) actions in a closed-loop setting. Prior studies demonstrate SA can increase human task performance in robotic arm control (Laghi et al., 2018), drone control (Reddy et al., 2018), and navigation (Peng et al., 2023). A critical component of prior work is an empirically tuned controlsharing hyperparameter that trades off copilot assistance with human user autonomy (Reddy et al., ", "page_idx": 0}, {"type": "image", "img_path": "nJvkQSu9Z5/tmp/a0c6e4d6c2a8c61a0c47f1d60d66abd112d9c34ec970e55bee1a708fcc5c6161.jpg", "img_caption": [], "img_footnote": [], "page_idx": 1}, {"type": "image", "img_path": "", "img_caption": ["Figure 1: Overview of Interventional Assist Framework for control sharing. (a) Prior works perform shared autonomy by passing human actions to a copilot (Javdani et al., 2015; Yoneda et al., 2023; Reddy et al., 2018; Jeon et al., 2020). The copilot then plays an action, e.g., by selecting a feasible action closest to the user suggestion (Reddy et al., 2018) or through diffusion (Yoneda et al., 2023). (b) In this work, we design an intervention function that plays either the human pilot\u2019s action, $a_{p}$ , or the copilot\u2019s action, $a_{c}$ , based on their goal-agnostic advantages. "], "img_footnote": [], "page_idx": 1}, {"type": "text", "text": "2018; Jeon et al., 2020; Yoneda et al., 2023). Excessive assistance can hinder goal achievement, while insufficient assistance can lead to poor control and performance. Prior work has established multiple methods of control sharing, but limitations remain, such as requiring control sharing hyperparameters be tuned empirically or limiting the copilot to general, non-goal-specific assistance (Schaff and Walter, 2020; Du et al., 2021; Tan et al., 2022). We will discuss them further in Section 2. ", "page_idx": 1}, {"type": "text", "text": "Imagine driving a car with an assistive copilot. The majority of the time, the human driver should remain in control. However, the copilot should intervene in certain scenarios to prevent collisions and ensure safe driving. By dynamically adjusting the level of assistance based on the situation and needs of the driver, the copilot simultaneously preserves driver autonomy and engagement while ensuring safety. This example reflects an important open problem: how do we construct an optimal behavior policy from the human and copilot\u2019s individual policies? This problem is conceptually similar to the one posed by the Teacher-Student Framework (TSF) (Zimmer et al., 2014), where a teacher agent helps the student learn a good policy by intervening to prevent the student from visiting deleterious states and providing online guidance (Kelly et al., 2019; Li et al., 2022; Peng et al., 2021). A recent work (Xue et al., 2023) has developed methods that improve the TSF framework by using a trajectory-based value estimate to decide when the teacher intervenes in student learning. We propose that a similar value estimate could be used to determine when the copilot should \u2018intervene\u2019 in the user\u2019s control, providing the user with assistance. Therefore, we develop an intervention function that estimates the expected value of the copilot and human action in a goal-agnostic fashion. Because our formulation is goal-agnostic, it can generalize to goals not seen during the training process, endowing the human pilot with improved flexibility and generalization. ", "page_idx": 1}, {"type": "text", "text": "Our main contribution is a shared control system that leverages a value-based intervention function that can interface with many different copilot architectures while simultaneously improving performance and preserving pilot autonomy. In this work, we build on an existing diffusion-based copilot architecture (Yoneda et al., 2023). These copilots are desirable because they can be trained using supervised methods which helps mitigate the sample complexity required to train effective copilots. While we proceed with the diffusion copilot of (Yoneda et al., 2023) we emphasize that our intervention function can be applied to any copilot capable of generating assistive, alternative, or corrective actions to aid the human in complex tasks. ", "page_idx": 1}, {"type": "text", "text": "2 Related Work ", "text_level": 1, "page_idx": 1}, {"type": "text", "text": "We have a brief discussion on three related works (Du et al., 2021; Yoneda et al., 2023; Tan et al., 2022). ", "page_idx": 1}, {"type": "text", "text": "Assistance via Empowerment (Du et al., 2021): It proposes a method that increases a human\u2019s ability to control the environment and mitigate the need to infer any goals. It defines an information theoretic quantity that captures the number of future states accessible to a human from the current state. An assistive agent is then trained to maximize this quantity while the human performs the task. While this allows agents to assist in a goal-agnostic fashion, it typically leads to lower performance than methods that infer the goal, since the assistive agent does not directly help the human achieve a goal. In contrast, other methods, including this work, leverage a copilot that implicitly infers the goal from human actions. While goal inference can lead to lower performance when the goal is incorrectly inferred, we mitigate this by restricting the copilot to only intervene when the human action is deleterious, i.e., worse than the copilot action across all possible goals. ", "page_idx": 1}, {"type": "text", "text": "", "page_idx": 2}, {"type": "text", "text": "To the Noise and Back: Diffusion for Shared Autonomy (Yoneda et al., 2023): It develops a copilot that uses diffusion to map a human action closer to an expert\u2019s action. They train a diffusion process to generate actions from a distribution of expert actions conditioned on goal-agnostic state observations. At inference, the human action is first pushed towards a Gaussian distribution by adding noise in the forward diffusion process. The reverse diffusion process is then run on this noised human action to transform it into a sample from the expert action distribution. This action is played in the environment, as illustrated in Figure 1a. The fraction of the forward diffusion process applied to the human action is the diffusion ratio $\\gamma\\in[0,1]$ and trades off action conformity (how similar the action is to expert actions) and human autonomy. This copilot therefore requires an experimentally tuned hyperparameter to influence how much control the human has on the eventual action. Because the amount of assistance needed may vary greatly depending on task dynamics, using a fixed amount of assistance throughout the task may limit performance and autonomy. Our intervention function presented in Section 3 addresses this limitation by allowing the copilot to dynamically intervene based on the human\u2019s actions. ", "page_idx": 2}, {"type": "text", "text": "On Optimizing Interventions in Shared Autonomy (Tan et al., 2022): It proposes a method where a copilot is trained with a penalty for intervention. This encourages the copilot to limit its intervention and preserve human autonomy. However, intervention is not inherently bad and need not be sparse. Instead of uniformly penalizing all intervention, only unnecessary intervention should be penalized. Additionally, this method is not inherently hyperparameter free as it does require setting a penalty hyperparameter to determine how the copilot should trade off assistance and autonomy, although they demonstrate this hyperparameter can be solved via optimization. Another limitation is this method assumes access to the human policy during training so that the copilot can learn when best to intervene for a particular human (e.g., an expert at the task would likely have less copilot intervention than a novice). In contrast, we define a general-purpose intervention function based on how good actions are in the environment (irrespective of the specific human pilot playing the actions), enabling one-time training of the intervention function. In our intervention function, an expert would still experience less intervention than a novice because the expert generally plays better actions in the environment. Empirically we find that with our approach the same intervention function can boost the performance of eight different human participants in the Lunar lander environment. ", "page_idx": 2}, {"type": "text", "text": "3 Method ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "Our goal is to introduce a general-purpose intervention function that increases the performance and human autonomy of an SA system. The inputs to the intervention function are: (1) the goal-agnostic environment state, s\u02dc, (2) a pilot action, $a_{p}$ , and (3) a copilot action, $a_{c}$ , illustrated in Figure 1b. The intervention function then plays either the pilot action $\\mathrm{^{\\!}}a_{I}=a_{p}\\mathrm{^{\\!}}$ ) or copilot action $\\mathrm{\\Delta}a_{I}={a_{c}})$ ) in the environment. We define this intervention function and describe its implementation. We also prove a lower bound on the expected return associated with the policy using the intervention function proportional to the pilot and copilot performance. ", "page_idx": 2}, {"type": "text", "text": "We develop an intervention assistance called Interventional Diffusion Assistance (IDA). First, an expert policy is trained to maximize returns in the environment (Section 3.2). Second, the expert is used to perform policy rollouts and generate demonstrations. Goal information is removed from the demonstration data. We then train a diffusion copilot from these demonstrations (Section 3.3). Third, we define a trajectory-based intervention function that decides whether to play the human or copilot action (Section 3.4). All training was performed on a workstation with a single 3080Ti and took approximately 48 hours to complete all three steps for our tasks. ", "page_idx": 2}, {"type": "text", "text": "3.1 Notation and Problem Formulation. ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "We assume the environment can be modeled as an infinite-horizon Markov Decision Process (MDP) defined by the tuple $M=\\langle S,A,R,\\gamma,P,d_{0}\\rangle$ . $S$ is the space of all possible environment states, and $A$ is the space of all possible actions. $R:S\\!\\times\\!A\\to[R_{\\operatorname*{min}},R_{\\operatorname*{max}}]$ is a scalar reward received for playing an action $a\\in A$ in state $s\\in S$ $\\cdot P:S\\times A\\times S\\to[0,1]$ are the transition dynamics for the environment, $\\gamma$ is the discount factor, and $d_{0}$ is the distribution of initial states. We define the state-action value function induced by policy $\\pi$ to be $\\begin{array}{r}{Q^{\\pi}(s,a)=\\mathbb{E}_{s_{0}=s,a_{0}=a,a_{t}\\sim\\pi(\\cdot|s_{t}),s_{t+1}\\sim p(\\cdot|s_{t},a_{t})}\\left[\\sum_{t=0}^{\\infty}\\gamma^{t}r\\left(s_{t},a_{t}\\right)\\right]\\!.}\\end{array}$ where $\\pi:S\\times A\\rightarrow[0,1]$ is the action distribution conditioned on the state. ", "page_idx": 3}, {"type": "text", "text": "We additionally introduce the notion of a goal that encodes the task objective or intention of the human. We can decompose any state $s=\\langle\\tilde{s}|\\hat{g}\\rangle$ into a partial goal-agnostic state observation $\\tilde{s}$ , which does not contain any goal specific information, and a goal $\\hat{g}\\,\\in\\,G^{*}$ , where $G^{*}$ is the space of all possible goals. Then $Q^{\\pi}(s,a)\\,=\\,Q^{\\pi}(\\langle\\tilde{s}\\mid\\hat{g}\\rangle,a)\\,=\\,Q^{\\pi}(\\tilde{s},a|\\hat{g})$ is the state-action value function under the goal-agnostic state $\\tilde{s}$ and goal $\\hat{g}$ . ", "page_idx": 3}, {"type": "text", "text": "We model the human behavior by a human pilot policy, $\\pi_{p}$ , which generates human action $a_{p}\\,\\sim$ $\\pi_{p}(\\cdot|s)$ according to the full state observation. The human observes and therefore has access to the goal, ${\\hat{g}}\\in G^{*}$ . However, the goal is not assumed to be accessible to the copilot. In this paper, we assume the availability of an expert policy $\\pi_{e}(a_{e}|s)$ , that observes the full state and solves the environment. We also assume that we can query the state-action value of the expert policy $Q^{\\pi_{e}}(s,a)$ with which we use to evaluate the quality of an action $a$ . We will train a copilot policy $\\pi_{c}$ that generates actions based on the pilot action and the goal-agnostic state $a_{c}\\sim\\pi_{c}(\\cdot|a_{p},\\tilde{s})$ . The ultimate goal of this paper is to derive a goal-agnostic intervention function $\\mathbf{T}(\\tilde{s},a_{c},a_{p})\\in\\{0,1\\}$ from the expert policy so that the SA system can achieve better performance than the pilot alone. The behavior policy that shares autonomy between the pilot and the copilot can be represented as $\\pi_{I}=\\mathbf{T}\\pi_{c}+(1-\\mathbf{\\bar{T}})\\pi_{p}^{\\phantom{\\dagger}}$ ", "page_idx": 3}, {"type": "text", "text": "3.2 Training an Expert Policy ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "We train a soft actor-critic (SAC) expert to solve the environment (Haarnoja et al., 2018) because it allows us to (1) later query $Q^{\\pi_{e}}(s,a)$ for intervention and (2) generate demonstrations in the environment that can be used to train the copilot. In general, other methods of obtaining a $Q$ -value estimator and for training a copilot are compatible with IA. We choose SAC for computational convenience. We parameterize our SAC model with a four-layer MLP with 256 units in each layer and the ReLU non-linearity. We use a learning rate of $3\\times10^{-4}$ and a replay buffer size of $10^{6}$ . The expert fully observes the environment including the goal, and is trained for 3 million time steps or until the environment is solved. We found that training with exploring starts (randomized initial state) produced a more robust $Q$ function with better generalization abilities. Without exploring starts, the $Q$ function performed poorly on unseen states, limiting the effectiveness of IDA. ", "page_idx": 3}, {"type": "text", "text": "3.3 Training a Diffusion Copilot ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "Following Yoneda et al. (2023), we trained a diffusion copilot $\\pi_{c}(\\boldsymbol{a}_{c}|\\boldsymbol{a}_{p},\\tilde{\\boldsymbol{s}})$ using a denoising diffusion probabilistic model (DDPM) (Ho et al., 2020). For each environment, we collected 10 million stateaction pairs from episodes using the SAC expert. All goal information was removed from this demonstration data. The copilot learned to denoise expert actions perturbed with Gaussian noise, conditioned on the goal-agnostic state $\\tilde{s}$ and the pilot\u2019s action $a_{p}$ . ", "page_idx": 3}, {"type": "text", "text": "Formally, the forward diffusion process is a Markov chain that iteratively adds noise $\\epsilon\\sim\\mathcal{N}(0,I)$ according to a noise schedule $\\{\\bar{\\alpha_{0}},\\bar{\\alpha_{1}},...,\\alpha_{T}\\}$ to an expert action $a_{0}$ , via ", "page_idx": 3}, {"type": "equation", "text": "$$\na_{t}=\\sqrt{a_{t}}a_{t-1}+\\sqrt{1-\\alpha_{t-1}}\\epsilon.\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "Following the forward diffusion process, the diffusion copilot is then trained to predict the noise added by the forward process by minimizing the following loss (Ho et al., 2020): ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\mathcal{L}_{\\mathrm{DDPM}}=\\mathbb{E}_{t,\\tilde{s}\\sim\\tau,\\epsilon\\sim\\mathcal{N}(0,I)}\\left[\\left\\lvert|\\epsilon-\\epsilon_{\\theta}(a_{t},\\tilde{s},t)\\right\\rvert\\right\\rvert^{2}\\right],\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "where $\\epsilon_{\\theta}$ is a neural network parameterized by $\\theta$ that approximates the noise $\\epsilon$ conditioned on the noisy action $a_{t}$ , the goal-agnostic state $\\tilde{s}$ , and the diffusion timestep $t,\\,\\tau$ is the distribution of states in the demonstration data. The reverse diffusion process is modeled by a four-layer MLP to iteratively refine $a_{t}$ toward $a_{0}$ . ", "page_idx": 3}, {"type": "text", "text": "1: Initialize environment   \n2: for each timestep in episode do   \n3: Sample state $s$ and goal-masked state $\\tilde{s}$ from environment.   \n4: Sample human action $a_{p}\\sim\\pi_{p}(\\cdot\\mid s)$ .   \n5: Sample diffusion copilot action $\\begin{array}{r}{a_{c}\\sim\\pi_{c}(\\cdot|a_{p},\\tilde{s})}\\end{array}$ .   \n6: Compute the copilot advantage score $A(\\tilde{s},a_{c},a_{p})$   \n7: if $A(\\tilde{s},a_{c},a_{p})=1$ then   \n8: Play copilot action in environment, $a_{I}=a_{c}$ .   \n9: else   \n10: Play pilot action in environment $a_{I}=a_{p}$ .   \n11: end if   \n12: end for   \n13: environment reset ", "page_idx": 4}, {"type": "text", "text": "3.4 Trajectory-based Goal-agnostic Value Intervention ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "IDA allows the copilot to intervene in pilot control when they take actions that are consistently bad for all possible goals. We therefore play the copilot\u2019s action $a_{c}$ instead of the pilot\u2019s action $a_{p}$ when the copilot\u2019s action has a higher expected return under the expert $Q$ -value, that is, ", "page_idx": 4}, {"type": "equation", "text": "$$\nQ^{\\pi_{e}}(s,a_{c})\\geq Q^{\\pi_{e}}(s,a_{p}).\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "However, we can not directly assess Equation 3, since in a SA system the goal is internal to the pilot. Instead, we only have access to the goal agnostic state $\\tilde{s}$ , such that, Equation 3 becomes, ", "page_idx": 4}, {"type": "equation", "text": "$$\nQ^{\\pi_{e}}(\\tilde{s},a_{c})\\geq Q^{\\pi_{e}}(\\tilde{s},a_{p}).\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "We can define an intervention score $\\mathbf{I}(\\tilde{s}_{t},\\tilde{a}_{t}|\\hat{g})$ which considers the value of $(\\tilde{s}_{t},\\tilde{a_{t}})$ under the assumption that ${\\hat{g}}\\in G^{*}$ is the goal, where $G^{*}$ is the space of all possible goals, ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\mathbf{I}(\\tilde{s}_{t},\\tilde{a}_{t}|\\hat{g})=Q^{\\pi_{e}}(\\tilde{s}_{t},\\tilde{a}_{t}|\\hat{g}).\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "By marginalizing the difference in the intervention scores between the copilot and pilot over the entire goal space we can define a copilot advantage $A(\\tilde{s},a_{c},a_{p})$ ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\mathbf{A}(\\tilde{s},a_{c},a_{p})=\\frac{1}{G}\\int_{\\hat{g}\\in G^{*}}F\\biggl(\\mathbf{I}(\\tilde{s},a_{c}|\\hat{g})-\\mathbf{I}(\\tilde{s},a_{p}|\\hat{g})\\biggr)d\\hat{g},\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "where $F$ is a function that maps the difference in intervention scores to $\\{-1,+1\\}$ to ensure all possible goals are weighted equally. Here we choose $F(\\cdot)=\\mathrm{sign}(\\cdot)$ . $G$ is a normalization constant for the integral, ", "page_idx": 4}, {"type": "equation", "text": "$$\nG=\\int_{\\hat{g}\\in G^{*}}\\operatorname*{max}_{\\tilde{s},a_{c},a_{p}}F\\biggl(\\mathbf{I}(\\tilde{s},a_{c}|\\hat{g})-\\mathbf{I}(\\tilde{s},a_{p}|\\hat{g})\\biggr)d\\hat{g}.\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "When $F(\\cdot)=\\mathrm{sign}(\\cdot)$ , then $A(\\tilde{s},a_{c},a_{p})\\in[-1,+1]$ is proportional to the fraction of the goal space over which the copilot action is superior to the pilot action. Also, when $F$ is the sign function, the normalization constant reduces to $\\textstyle G=\\int_{{\\hat{g}}\\in G^{*}}{\\bar{d}}{\\hat{g}}$ and if the goal space is discrete then $G=|G^{*}|$ is the number of goals. ", "page_idx": 4}, {"type": "text", "text": "We adapt the value based intervention function proposed by Xue et al. (2023) to use for shared autonomy by allowing intervention to occur when $A(\\tilde{s},a_{c},a_{p})=1$ . The copilot therefore intervenes when its action has a higher expected return compared to the pilot action for all possible goals. Formally, we let ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\mathbf{T}({\\tilde{s}},a_{c},a_{p})={\\binom{1}{0}}\\begin{array}{l l}{\\mathrm{~if~}A({\\tilde{s}},a_{c},a_{p})=1}\\\\ {\\mathrm{~otherwise}}\\end{array},\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "with intervention policy, $\\pi_{I}=\\mathbf{T}\\pi_{c}+(1-\\mathbf{T})\\pi_{p}$ . The process for performing Shared Autonomy (SA) with IA is highlighted in Algorithm 1. The copilot advantage is computed at every timestep. The behavioral (IA) policy is then determined by Equation 8. ", "page_idx": 4}, {"type": "text", "text": "We prove that the return associated with IA is guaranteed to have the following safety and performance guarantees. ", "page_idx": 5}, {"type": "text", "text": "Theorem 1. Let $\\begin{array}{r}{\\boldsymbol{J}(\\pi)\\,=\\,\\mathbf{E}_{s_{0}\\sim d_{0},a_{t}\\sim\\pi(\\cdot|s_{t}),s_{t+1}\\sim P(\\cdot|s_{t},a_{t})}\\bigl[\\sum_{t=0}^{\\infty}\\gamma^{t}\\boldsymbol{r}\\bigl(s_{t},a_{t}\\bigr)\\bigr]}\\end{array}$ be the expected discounted return of following a policy $\\pi$ . Then, the performance following the Interventional Assistance policy (or behavior policy) $\\pi_{I}$ has the following guarantees: ", "page_idx": 5}, {"type": "equation", "text": "$$\nJ(\\pi_{I})\\geq J(\\pi_{p}).\n$$", "text_format": "latex", "page_idx": 5}, {"type": "equation", "text": "$$\nJ(\\pi_{I})\\geq J(\\pi_{c}).\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "The proof of Theorem 1 is in Appendix A. Intuitively, the copilot will only intervene when the pilot attempts to play actions from the current state that have expected future returns less than that of the copilot\u2019s action across all possible goals. The IA policy therefore does not degrade performance of a high-performing pilot, and when the pilot is poor, guarantees performance no worse than the copilot. ", "page_idx": 5}, {"type": "text", "text": "4 Results ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "4.1 Experimental Setup ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "Baselines. In the experiments that follow, we compared three different control methods. The first method is pilot-only control. The second method is copilot control, where the behavior policy is equal to the copilot policy $\\pi_{c}(\\boldsymbol{a}_{c}|\\boldsymbol{a}_{p},\\tilde{\\boldsymbol{s}})$ . Copilot control is the standard practice in SA (Reddy et al., 2018; Yoneda et al., 2023; Schaff and Walter, 2020; Jeon et al., 2020) as it allows a copilot to improve the human action before it is played in the environment. For copilot control, the action played is the action generated by the diffusion copilot using a forward diffusion ratio of $\\gamma=0.2$ , the setting that obtained the best control in (Yoneda et al., 2023). Our third method is IDA, which involves dynamically setting the behavior policy based on Equation 8. ", "page_idx": 5}, {"type": "text", "text": "Environments. The first environment we use is Reacher, a 2D simulation environment that models a two-jointed robotic arm with inertial physics. In this environment, torques are applied to the two joints of the robotic arm to position the arm\u2019s fingertip at a randomly spawned goal position within the arm\u2019s plane of motion. The state of the environment is an 11 dimensional observation containing information about the position and velocities of the joints and goal location. Rewards are given for making smooth trajectories that move the fingertip close to the goal. In each episode, the arm\u2019s position is reset to a starting location and a new goal is sampled uniformly across the range of the arm\u2019s reach. Following previous works ((Reddy et al., 2018; Schaff and Walter, 2020; Yoneda et al., 2023; Tan et al., 2022)), we also use Lunar Lander, a 2D continuous control environment in which a rocket ship must be controlled with three thrusters to land at a desired goal location on the ground. We modify the environment as described in (Yoneda et al., 2023) to make the landing location spawn randomly at different locations along the ground. On each episode the landing zone is indicated by two flags. The states are 9 dimensional observations of the environment containing information about the rocket ship\u2019s position, angular velocity, and goal landing zone. We define the success rate as the fraction of episodes that ended with a successful landing between the landing zone flags. We define the crash rate as the fraction of episodes that terminated due to a crash or flying out of bounds. ", "page_idx": 5}, {"type": "text", "text": "Pilots. We use simulated surrogate pilots (Reacher, Lunar Lander) and eight human pilots (Lunar Lander) to benchmark the performance of pilot-only, copilot, and IDA control (see Appendix D for details about human participants). All human experiments were approved by the IRB and participants were compensated with a gift card. Surrogate control policies are designed to reflect some suboptimalities in human control policies. We consider noisy and laggy surrogate control policies. Surrogate policies are constructed by drawing actions from either an expert policy or a corrupted policy. We use a switch that controls if actions are drawn from the expert or corrupt policies. Actions are initially sampled from the expert policy. At every time step there is a probability of corruption being turned on. Once corruption is turned on, actions are sampled from the corrupt control policy. At every time step while corruption is on, there is a probability of turning corruption off. Once corruption is turned off, actions are sampled again from the expert control policy. The noisy surrogate policy is constructed by sampling actions uniformly randomly with a $30\\%$ corruption probability. The laggy surrogate policy actions are drawn by repeating the action at the previous time step with an $85\\%$ corruption probability. ", "page_idx": 5}, {"type": "table", "img_path": "nJvkQSu9Z5/tmp/02577c5e3eaae68806af02828767dabdc3c16971b814236b1f72c8c865cbafae.jpg", "table_caption": [], "table_footnote": ["Table 1: Target hit rate (per minute) of surrogate pilots in Reacher environment. \u201cContinuous\u201c uses the default environment goal space where targets spawn anywhere in the arm\u2019s plane of motion. \u201cLinear\u201d uses goals that are restricted to a line $100c\\mathrm{m}$ in front of the arm. \u201cQuadrant\u201d uses goals that are restricted to the top right quadrant of the workspace. \u201cCopilot\u201d is the pilot with a diffusion copilot (Yoneda et al., 2023) with $\\gamma=0.2$ . \u201cIDA\u201d is the pilot with interventional diffusion assistance. IDA (FG) is inferenced with faux goals obtained via monte Carlo sampling and IDA (DS) is inferenced with an expert $Q$ function trained on a different goal distribution of five discrete goals. "], "page_idx": 6}, {"type": "text", "text": "", "page_idx": 6}, {"type": "text", "text": "4.2 Reacher Experiments ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "We compared the performance of IDA to pilot-only and the copilot SA method of (Yoneda et al., 2023) in the Reacher environment with targets that could randomly appear anywhere (\u201cContinuous\u201d in Table 1). We introduce two additional goal spaces to probe the generalization abilities of IDA: \u201cLinear\u201d and \u201cQuadrant.\u201d In the linear goal space, goals spawned uniformly random along a horizontal line located $100c\\mathrm{m}$ in front of the arm. In the quadrant goal space, goals spawned uniformly random in the upper right quadrant of the workspace. To use IDA without making the goal space known to the advantage computation (Equation 6) we constructed a \u201cfaux goal\u201d space (FG) by assuming a uniform distribution over potential next positions as goals. We then estimated the copilot advantage through Monte-Carlo sampling. Furthermore, we examined IDA\u2019s performance when the goal space is unknown during $Q$ function training by using a domain shift (DS) environment where goals appear randomly at one of five locations during training. In lieu of using humans, we employed laggy and noisy surrogate control policies to emulate imperfect pilots in the Reacher environment across these goal spaces. ", "page_idx": 6}, {"type": "text", "text": "We evaluated performance by quantifying hit rate, the number of targets acquired per minute. In the continuous goal space we found that IDA always achieved performance greater than or equal to pilot-only control and outperformed the copilot (Table 1). The expert control policy was optimal, and IDA therefore rarely intervened with a copilot action, leading to similar performance. We also found the laggy pilot performed relatively well because laggy actions do not significantly impair target reaches, although it may delay target acquisition. When the policy was noisy, IDA improved hit rate from 1.6 to 3.3 targets per minute, approximately doubling performance. In contrast, we found the copilot was unable to acquire any targets. This may be because the copilot is unable to infer the precise goal location from surrogate pilot actions. Together, these results demonstrate that IDA is simultaneously capable of preserving optimal control for high performing pilots while improving hit rate for sub-optimal surrogate control policies, consistent with Theorem 1. ", "page_idx": 6}, {"type": "image", "img_path": "nJvkQSu9Z5/tmp/e8406806087edcd53a7f81cc12f9059f308429d4ab19b1764e6890dd6633d237.jpg", "img_caption": ["Figure 2: Reacher experiments. (a) Continuous Reacher environment. (b) Laggy pilot experiments as the number of possible goals varies. IDA performance slightly decreases as the number of possible goals increase, but it never significantly underperforms the pilot. The copilot is significantly worse than both the laggy pilot and IDA. (c) Noisy pilot experiments. IDA outperforms the pilot and copilot. "], "img_footnote": [], "page_idx": 6}, {"type": "text", "text": "", "page_idx": 7}, {"type": "text", "text": "Additionally, we found that even without knowing the goal space during inference (IDA (FG)) or training (IDA (DS)), IDA still increased or maintained the hit rate of the noisy and laggy pilots in the continuous, linear, and quadrant goal spaces (Table 1). We also investigated how the performance of IDA varies with goal space size when goals can appear anywhere (Figure 2a). For each evaluation, we randomly sampled a specified number of candidate goal positions (ranging from 1 to 10, as well as 100 and 1000) from the continuous goal space and then evaluated IDA with goals restricted to these sampled positions. IDA consistently outperformed copilot and the noisy pilot while maintining the performance of the laggy pilot for all goal space sizes (Figure 2b, c). Collectively, these results demonstrate that IDA performance is robust even when the true goal space is unknown. ", "page_idx": 7}, {"type": "text", "text": "4.3 Lunar Lander ", "text_level": 1, "page_idx": 7}, {"type": "text", "text": "We next evaluated the performance of IDA in Lunar Lander with the noisy and laggy surrogate control policies. Consistent with Yoneda et al. (2023), we modified Lunar Lander so that the landing zone appears randomly in one of nine different locations. IDA always achieved performance greater than or equal to the performance of the pilot-only control policy (Table 2). Under the expert policy, which achieves $100\\%$ success rate and $0\\%$ crash rate, IDA does not degrade its performance, although copilot does. We observed that both copilot and IDA improved the performance of noisy and laggy surrogate control policies, with IDA consistently outperforming copilot in successful landings. Copilots and IDA also reduced crash rates for surrogate pilots. Additionally, we compared the performance of IDA to the penalty-based intervention approach proposed by Tan et al. (2022). Because the penalty-based intervention in Tan et al. (2022) used an MLP, we compare it to both IDA and IA with an MLP based copilot. We found that IA consistently achieved a higher rate of successful landings for both the noisy and laggy surrogate pilots than penalty based intervention for both copilot architectures. We further found that IA (MLP and IDA) yielded a lower crash rate than penalty-based intervention. ", "page_idx": 7}, {"type": "text", "text": "Next we examined when and why copilot intervention occurred for surrogate pilots. Because these control policies were constructed by corrupting an expert\u2019s control policy, we were able to characterize intervention during periods of expert control versus corruption. We examined the distribution of copilot-human advantage scores, which measures the fraction of the goal space over which the copilot\u2019s action has a higher expected return than the pilot\u2019s action. For both the noisy and laggy pilots, we found the distribution of copilot advantage scores were different during expert actions vs corrupted actions (Figure 3a,b). When corrupted actions were played, there were a greater number of states where the copilot advantage was equal to 1, indicating the copilot\u2019s action had a greater expected return over the entire goal space. Consistent with this, we see that intervention was more common during periods of corruption. ", "page_idx": 7}, {"type": "table", "img_path": "nJvkQSu9Z5/tmp/8e7138d5444c4a19d4ef943836ebfe10e40c4fb54e5ea2c0f222f86fb24f3a4e.jpg", "table_caption": [], "table_footnote": [], "page_idx": 7}, {"type": "text", "text": "Table 2: Performance of surrogate pilots in the Lunar Lander environment. IDA is interventional assist with a diffusion copilot. IA (MLP) is interventional assist with an MLP copilot. Intervention-Penalty (MLP) refers to the intervention penalty approach proposed by Tan et al. (2022) ", "page_idx": 7}, {"type": "image", "img_path": "nJvkQSu9Z5/tmp/70ed42e18a254c1a32318e4c1144316590989b4cc202e614064adc9396fbce7c.jpg", "img_caption": ["Figure 3: Analysis of copilot advantages during intervened states. (a) Characterization of intervention during the noisy pilot control. The left plot shows the copilot advantage, which is generally higher for corrupted (random) actions compared to pilot actions. When quantifying the number of intervened states, we see IDA intervenes more when the corrupted actions are taken. (b) Same as (a) but for the laggy pilot. (c) Example intervened states. In the top panel, the copilot prevents flipping. In the bottom panel, the copilot action helps to make a graceful landing. "], "img_footnote": [], "page_idx": 8}, {"type": "text", "text": "We also visualized example states of copilot intervention for both the noisy and laggy pilots (Figure 3c). In two representative examples, we see that intervention generally occurs to stabilize and prevent the rocket ship from crashing or flipping over. In Figure 3c (top), we observe that during intervention, the copilot applies lateral thrust to the rocket to prevent it from rotating sideways despite the pilot operator attempting to fire the main rocket, which would result in a destabilizing rotation of the rocket ship. In Figure 3c (bottom), we observe that intervention occurred during landing where the copilot increased the amount of thrust on the main thruster to soften the touch down while simultaneously applying thrust on the right rocket to level the rocket ship for landing. In both instances, the copilot action prevented the rocket ship from entering a universally low-value state. ", "page_idx": 8}, {"type": "text", "text": "4.4 Lunar Lander with Human-in-the-loop Control ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "Given IDA improved the performance of surrogate pilots in Lunar Lander, we performed experiments with eight human participants. Participants played Lunar Lander using pilot-only, copilot, or IDA. Participants used a Logitech game controller with two joysticks to control the rocket ship. The left joystick controlled the lateral thrusters and the right joystick controlled the main thruster. Each participant performed three sequences of 3 experimental blocks (pilot, copilot, IDA) for a total of 9 blocks (see Appendix D for experiment block details). Each block consisted of 30 trials (episodes). Participants were blind to what block they were playing. The game was rendered at 50 fps. ", "page_idx": 8}, {"type": "text", "text": "Human pilots experienced considerable difficulty playing Lunar Lander, successfully landing at the goal locations only $14\\%$ of the time (Table 3). Copilot control allowed humans participants to successfully land the rocket ship at the goal locations $\\bar{6}8.2\\%$ of the time. However, the copilot also frequently prevented any landing, resulting in a timeout in $13.8\\%$ of trials $[0\\%$ in pilot only and $0.1\\bar{\\%}$ in IDA). While this led to a lower crash rate $(3.6\\%)$ , it also reduced user autonomy and overall lowered the success rate. In contrast, IDA achieved the highest performance, enabling participants to successfully land at the goal location $91.7\\%$ of the time which was significantly higher than pilot $(p<0.01$ , Wilcoxon signed-rank) and copilot $p<0.01$ , Wilcoxon signed-rank) control. IDA also resulted in a significant reduction of crash rate when compared to human pilot control $p<0.01$ , Wilcoxon signed-rank). ", "page_idx": 8}, {"type": "table", "img_path": "nJvkQSu9Z5/tmp/b999ea9fd8519665c37f8e6e7f182135c5d2717d257b485c1b1b7005fcddbcd2.jpg", "table_caption": [], "table_footnote": ["Table 3: Results of human pilots playing Lunar Lander. Mean and (standard error of the mean) presented for each metric. "], "page_idx": 8}, {"type": "text", "text": "", "page_idx": 9}, {"type": "text", "text": "To quantify the level of ease, control, and autonomy human participants felt in each block (pilot only, copilot, IDA), we asked participants to provide a subjective rating in response to multiple questions. We asked participants to rate which blocks felt easiest, most controllable, and most autonomous. To assess ease of control, we asked: \u201cHow easy was the task of landing the rocket ship at the goal location?\u201d To assess how much control the participants had, we asked: \u201cHow in control did you feel when performing this task?\u201d However, participants may not have felt much control even in pilot-only mode, so to assess autonomy, we asked: \u201cHow much do you believe your inputs affected the trajectory of the rocketship?\u201d All questions were answered on a scale of 1 to 5 with 5 indicating the easiest, most in control, or most autonomy, respectively. We found that humans subjectively prefer IDA to baseline copilot assistance in terms of ease of use, controllability, and preserving autonomy $p<0.01$ , Wilcoxon signed-rank). ", "page_idx": 9}, {"type": "text", "text": "5 Conclusion and Discussion ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "Our primary contribution is Interventional Assistance (IA): a hyperparameter-free and modular framework that plays a copilot action when it is better than the pilot action across all possible goals. We find that IA outperforms previous methods for intervention based shared autonomy proposed by Tan et al. (2022) as well as traditional copilot-only based methods for control sharing (Yoneda et al., 2023; Reddy et al., 2018). Furthermore, we empirically demonstrated IDA (IA with a Diffusion copilot) improves both objective task performance and subjective satisfaction with real human pilots in Lunar Lander (Figure 4). While prior SA systems may degrade pilot performance, particularly when copilots incorrectly infer the pilot\u2019s goal (Tan et al., 2022; Du et al., 2021), IA does not degrade human performance (Theorem 1) and often improves it. ", "page_idx": 9}, {"type": "text", "text": "One limitation of our approach is that we must train an autonomous agent in a simulated environment to obtain an expert $Q$ function. However, this is not a fundamental requirement to learn an intervention function. A straightforward extension of the current work may use an offilne dataset of expert demonstrations to train an ensemble of $Q$ -networks (Chen et al., 2021). In general, while IA requires access to an expert $Q$ function it makes no assumptions about how that $Q$ function is obtained and we leave various methods of obtaining a $Q$ function as directions for future work. ", "page_idx": 9}, {"type": "image", "img_path": "nJvkQSu9Z5/tmp/a4daf8dbefe15cd02a9e3de5dbb5b4ebe38cd9d1c93e767ac1080f387201d6da.jpg", "img_caption": ["Figure 4: Participants rated IDA as the easiest and most controllable condition. Participants subjectively rated IDA as achieving a similar level of autonomy to pilot only control but significantly better than copilot control. "], "img_footnote": [], "page_idx": 9}, {"type": "text", "text": "", "page_idx": 9}, {"type": "text", "text": "Additionaly, IDA demonstrated resilience across changes in goal space and can be easily adapted to real world settings where the goal space is unknown by construction of these faux goal spaces. Of course, in many settings task structure can be leveraged to further constrain the goal space and improve the assistance IA is able to provide. In these settings, another direction for future work is an implementation of IA that leverages a belief system to differentially weight candidate goals. Future work could potentially improve IA by removing unlikely goals from the advantage computation. ", "page_idx": 9}, {"type": "text", "text": "Acknowledgments This project was supported by NSF RI-2339769 (BZ), NSF CPS-2344955 (BZ), the Amazon UCLA Science Hub (JCK), and NIH DP2NS122037 (JCK). ZP is supported by the Amazon Fellowship via UCLA Science Hub. ", "page_idx": 9}, {"type": "text", "text": "References ", "text_level": 1, "page_idx": 10}, {"type": "text", "text": "Wayne F Cascio and Ramiro Montealegre. How technology is changing work and organizations. Annual review of organizational psychology and organizational behavior, 3(1):349\u2013375, 2016.   \nXinyue Chen, Che Wang, Zijian Zhou, and Keith Ross. Randomized ensembled double q-learning: Learning fast without a model, 2021.   \nYuqing Du, Stas Tiomkin, Emre Kiciman, Daniel Polani, Pieter Abbeel, and Anca Dragan. Ave: Assistance via empowerment, 2021.   \nTuomas Haarnoja, Aurick Zhou, Kristian Hartikainen, George Tucker, Sehoon Ha, Jie Tan, Vikash Kumar, Henry Zhu, Abhishek Gupta, Pieter Abbeel, et al. Soft actor-critic algorithms and applications. arXiv preprint arXiv:1812.05905, 2018.   \nJonathan Ho, Ajay Jain, and Pieter Abbeel. Denoising diffusion probabilistic models. Advances in neural information processing systems, 33:6840\u20136851, 2020.   \nShervin Javdani, Siddhartha S Srinivasa, and J Andrew Bagnell. Shared autonomy via hindsight optimization. Robotics science and systems: online proceedings, 2015, 2015.   \nHong Jun Jeon, Dylan P Losey, and Dorsa Sadigh. Shared autonomy with learned latent actions. arXiv preprint arXiv:2005.03210, 2020.   \nMichael Kelly, Chelsea Sidrane, Katherine Driggs-Campbell, and Mykel J Kochenderfer. Hg-dagger: Interactive imitation learning with human experts. In 2019 International Conference on Robotics and Automation (ICRA), pages 8077\u20138083. IEEE, 2019.   \nMarco Laghi, Michele Maimeri, Mathieu Marchand, Clara Leparoux, Manuel Catalano, Arash Ajoudani, and Antonio Bicchi. Shared-autonomy control for intuitive bimanual tele-manipulation. In 2018 IEEE-RAS 18th International Conference on Humanoid Robots (Humanoids), pages 1\u20139. IEEE, 2018.   \nQuanyi Li, Zhenghao Peng, and Bolei Zhou. Efficient learning of safe driving policy via human-ai copilot optimization. In International Conference on Learning Representations, 2022.   \nZhenghao Peng, Quanyi Li, Chunxiao Liu, and Bolei Zhou. Safe driving via expert guided policy optimization. In 5th Annual Conference on Robot Learning, 2021.   \nZhenghao Peng, Wenjie Mo, Chenda Duan, Quanyi Li, and Bolei Zhou. Learning from active human involvement through proxy value propagation. Advances in Neural Information Processing Systems, 2023.   \nSiddharth Reddy, Anca D. Dragan, and Sergey Levine. Shared autonomy via deep reinforcement learning, 2018.   \nCharles Schaff and Matthew R. Walter. Residual policy learning for shared autonomy, 2020.   \nJohn Schulman, Sergey Levine, Pieter Abbeel, Michael I. Jordan, and Philipp Moritz. Trust region policy optimization. In ICML, pages 1889\u20131897. JMLR.org, 2015.   \nJohn Schulman, Philipp Moritz, Sergey Levine, Michael Jordan, and Pieter Abbeel. High-dimensional continuous control using generalized advantage estimation, 2018.   \nWeihao Tan, David Koleczek, Siddhant Pradhan, Nicholas Perello, Vivek Chettiar, Vishal Rohra, Aaslesha Rajaram, Soundararajan Srinivasan, H M Sajjad Hossain, and Yash Chandak. On optimizing interventions in shared autonomy, 2022.   \nH. J. Wilson and P. R. Daugherty. Collaborative intelligence: Humans and ai are joining forces. Harvard Business Review, 2018a.   \nH. J. Wilson and P. R. Daugherty. Human Machine: Reimagining Work in the Age of AI. Harvard Business Review Press, 2018b.   \nZhenghai Xue, Zhenghao Peng, Quanyi Li, Zhihan Liu, and Bolei Zhou. Guarded policy optimization with imperfect online demonstrations, 2023.   \nTakuma Yoneda, Luzhe Sun, , Ge Yang, Bradly Stadie, and Matthew Walter. To the noise and back: Diffusion for shared autonomy, 2023.   \nMatthieu Zimmer, Paolo Viappiani, and Paul Weng. Teacher-student framework: a reinforcement learning approach. 2014. ", "page_idx": 10}, {"type": "text", "text": "A Proof of Theorem 1 ", "text_level": 1, "page_idx": 11}, {"type": "text", "text": "In this section, we will prove the theoretical guarantees on the performance of the interventional assistance (IA) in Theorem 1. We first introduce several useful lemmas. ", "page_idx": 11}, {"type": "text", "text": "First, we introduce a lemma for later use by following the Theorem 3.2 in (Xue et al., 2023). ", "page_idx": 11}, {"type": "text", "text": "Lemma 1. For any behavior policy $\\pi_{I}$ deduced by a copilot policy $\\pi_{c}$ , a pilot policy $\\pi_{p}$ , and an intervention function $\\mathbf{T}(s,a_{p},a_{c})$ , the state distribution discrepancy between $\\pi_{I}$ and $\\pi_{c}$ is bounded by the policy discrepancy and intervention rate: ", "page_idx": 11}, {"type": "equation", "text": "$$\n\\left\\|\\tau_{\\pi_{I}}-\\tau_{\\pi_{c}}\\right\\|_{1}\\leq\\frac{(1-\\beta)\\gamma}{1-\\gamma}\\mathbb{E}_{s\\sim\\tau_{\\pi_{I}}}\\left\\|\\pi_{c}(\\cdot|s)-\\pi_{p}(\\cdot|s)\\right\\|_{1},\n$$", "text_format": "latex", "page_idx": 11}, {"type": "text", "text": "where $\\begin{array}{r}{\\beta=\\frac{\\mathbb{E}_{s\\sim\\tau_{\\pi_{I}},a_{c}\\sim\\pi_{c},a_{p}\\sim\\pi_{p}}{\\|\\mathbf{T}(s,a_{p},a_{c})[\\pi_{c}(a_{c}|s)-\\pi_{p}(a_{p}|s)]\\|_{1}}}{\\mathbb{E}_{s\\sim\\tau_{\\pi_{I}},a_{c}\\sim\\pi_{c},a_{p}\\sim\\pi_{p}}{\\|\\pi_{c}(a_{c}|s)-\\pi_{p}(a_{p}|s)\\|_{1}}}}\\end{array}$ 1 is the weighted expected intervention rate. $\\tau_{\\pi_{I}}$ and $\\tau_{\\pi_{c}}$ are the corresponding state visitation distributions following $\\pi_{I}$ and $\\pi_{c}$ , respectively. ", "page_idx": 11}, {"type": "text", "text": "Proof. We begin with the result of Theorem 3.2 in (Xue et al., 2023), ", "page_idx": 11}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\|\\tau_{\\pi_{I}}-\\tau_{\\pi_{c}}\\|_{1}\\leq\\displaystyle\\frac{\\gamma}{1-\\gamma}\\mathbb{E}_{s\\sim\\tau_{\\pi_{I}}}\\|\\pi_{I}(\\cdot|s)-\\pi_{c}(\\cdot|s)\\|_{1}}\\\\ &{\\phantom{\\quad\\quad\\quad}=\\displaystyle\\frac{\\gamma}{1-\\gamma}\\mathbb{E}_{s\\sim\\tau_{\\pi_{I}},a_{c}\\sim\\pi_{c},a_{p}\\sim\\pi_{p}}\\left\\|\\mathbf{T}\\pi_{c}(a_{c}|s)+(1-\\mathbf{T})\\pi_{p}(a_{p}|s)-\\pi_{c}(a_{c}|s)\\right\\|_{1}}\\\\ &{\\phantom{\\quad\\quad\\quad}=\\displaystyle\\frac{\\gamma}{1-\\gamma}\\mathbb{E}_{s\\sim\\tau_{\\pi_{I}},a_{c}\\sim\\pi_{c}(\\cdot|s),a_{p}\\sim\\pi_{p}(\\cdot|s)}\\left\\|(1-\\mathbf{T}(s,a_{p},a_{c}))\\left[\\pi_{p}(\\cdot|s)-\\pi_{c}(\\cdot|s)\\right]\\right\\|_{1}}\\\\ &{\\phantom{\\quad\\quad\\quad=\\displaystyle\\frac{\\gamma}{1-\\gamma}\\mathbb{E}_{s\\sim\\tau_{\\pi_{I}}}\\left\\|\\pi_{c}(\\cdot|s)-\\pi_{p}(\\cdot|s)\\right\\|_{1}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 11}, {"type": "text", "text": "To prove the theorem, the key lemma we use is the policy difference lemma in (Schulman et al., 2015) introduced below. It introduces one policy\u2019s advantage function computed on states and actions sampled from another policy\u2019s generated trajectory. Here, the advantage function is defined as $A^{\\pi^{\\prime}}\\bar{(s,a)}=Q^{\\pi^{\\prime}}(s,a)\\stackrel{\\cdot}{-}V^{\\bar{\\pi^{\\prime}}}(s)$ and $V^{\\pi^{\\prime}}(s)\\stackrel{\\cdot}{=}\\mathbb{E}_{a\\sim\\pi^{\\prime}}Q(s,a)$ is the state value function. $J(\\pi)=$ $\\begin{array}{r l}{\\mathbb{E}_{s_{0}\\sim d_{0},a_{t}\\sim\\pi(\\cdot|s_{t}),s_{t+1}\\sim P(\\cdot|s_{t},a_{t})}[\\sum_{t=0}^{\\infty}\\gamma^{t}r(s_{t},a_{t})]}&{{}}\\end{array}$ is the expected return following policy $\\pi$ . ", "page_idx": 11}, {"type": "text", "text": "Lemma 2 (Policy difference lemma). Let $\\pi$ and $\\pi^{\\prime}$ be two policies. The difference in expected returns can be represented as follows: ", "page_idx": 11}, {"type": "equation", "text": "$$\nJ(\\pi)-J(\\pi^{\\prime})=\\mathbb{E}_{s_{t},a_{t}\\sim\\tau_{\\pi}}\\left[\\sum_{t=0}^{\\infty}\\gamma^{t}A^{\\pi^{\\prime}}\\left(s_{t},a_{t}\\right)\\right]\n$$", "text_format": "latex", "page_idx": 11}, {"type": "text", "text": "We introduce two lemmas that exploits the intervention function we proposed in Section 3.4. ", "page_idx": 11}, {"type": "text", "text": "Lemma 3. The $Q$ value of the behavior action under the expert\u2019s $Q$ estimate is greater or equal to the $Q$ value of the pilot action. ", "page_idx": 11}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\mathbb{E}_{a\\sim\\pi_{I}(\\cdot|s)}Q^{\\pi_{e}}(s,a)\\ge\\mathbb{E}_{a_{p}\\sim\\pi_{p}(\\cdot|s)}Q^{\\pi_{e}}(s,a_{p})}\\end{array}\n$$", "text_format": "latex", "page_idx": 11}, {"type": "text", "text": "Proof. According to the intervention function $\\mathbf{T}$ in Equation 8, intervention happens when the copilot advantage function $A(\\tilde{s},a_{c},a_{p})=1$ . If we consider $F$ to be the sign function, then according to Equation 6, $A(\\tilde{s},a_{c},a_{p})=1$ means for all goals we will always have $\\mathbf{I}(\\widetilde{s},a_{c}|\\widehat{g})>\\mathbf{I}(\\widetilde{s},a_{p}|\\widehat{g}),\\forall\\widehat{g}$ Recall $\\mathbf{I}(\\tilde{s}_{t},\\tilde{a}_{t}|\\hat{g})=\\bar{Q^{\\pi_{e}}}(\\tilde{s}_{t},\\tilde{a}_{t}|\\hat{g})$ , when intervention happens, we will have: ", "page_idx": 11}, {"type": "equation", "text": "$$\nQ^{\\pi_{e}}(\\tilde{s}_{t},a_{c}|\\hat{g})>Q^{\\pi_{e}}(\\tilde{s}_{t},a_{p}|\\hat{g}),\\forall\\hat{g}\n$$", "text_format": "latex", "page_idx": 11}, {"type": "text", "text": "Therefore, ", "page_idx": 11}, {"type": "equation", "text": "$$\n\\mathbf{T}(s,a_{c},a_{p})Q^{\\pi_{e}}(\\tilde{s}_{t},a_{c}|\\hat{g})\\geq\\mathbf{T}(s,a_{c},a_{p})Q^{\\pi_{e}}(\\tilde{s}_{t},a_{p}|\\hat{g}),\\forall\\hat{g},\n$$", "text_format": "latex", "page_idx": 11}, {"type": "text", "text": "where the equality holds when intervention does not happen and $\\mathbf{T}=0$ . ", "page_idx": 11}, {"type": "text", "text": "Now we introduce the expectation over the behavior policy. ", "page_idx": 11}, {"type": "equation", "text": "$$\n\\begin{array}{r l r}{\\mathbb{E}_{a\\sim\\pi_{I}(\\cdot\\vert s)}Q^{\\pi_{e}}(\\tilde{s}_{t},a\\vert\\hat{g})}&{=}&{\\mathbb{E}_{a_{p}\\sim\\pi_{p}}\\mathbb{E}_{a_{c}\\sim\\pi_{c}}\\mathbf{T}Q^{\\pi_{e}}(\\tilde{s}_{t},a_{c}\\vert\\hat{g})+(1-\\mathbf{T})Q^{\\pi_{e}}(\\tilde{s}_{t},a_{p}\\vert\\hat{g})}\\\\ &{\\ge}&{\\mathbb{E}_{a_{p}\\sim\\pi_{p}}Q^{\\pi_{e}}(\\tilde{s}_{t},a_{p}\\vert\\hat{g}),\\forall\\hat{g}\\ ~~~~~~~~~~~~~}\\end{array}\n$$", "text_format": "latex", "page_idx": 11}, {"type": "text", "text": "The above equation holds for arbitrary $\\hat{g}$ . Therefore $\\mathbb{E}_{a\\sim\\pi_{I}(\\cdot|s)}Q^{\\pi_{e}}(s,a)\\ge\\mathbb{E}_{a_{p}\\sim\\pi_{p}}Q^{\\pi_{e}}(s,a_{p})$ . ", "page_idx": 11}, {"type": "text", "text": "Similar to Lemma 3, we have: ", "page_idx": 12}, {"type": "text", "text": "Lemma 4. The $Q$ value of the behavior action under the expert\u2019s $Q$ estimate is greater or equal to the $Q$ value of the copilot action. ", "page_idx": 12}, {"type": "equation", "text": "$$\n\\mathbb{E}_{a\\sim\\pi_{I}(\\cdot|s)}Q^{\\pi_{e}}(s,a)\\ge\\mathbb{E}_{a_{c}\\sim\\pi_{c}}Q^{\\pi_{e}}(s,a_{c})\n$$", "text_format": "latex", "page_idx": 12}, {"type": "text", "text": "Proof. According to the intervention function $\\mathbf{T}$ in Equation 8, intervention happens when the copilot advantage function $A(\\tilde{s},a_{c},a_{p})=1$ . If we consider $F$ to be the sign function, then according to Equation 6, $A(\\tilde{s},a_{c},a_{p})=1$ means for all goals we will always have $\\mathbf{I}(\\widetilde{s},a_{c}|\\widehat{g})>\\mathbf{I}(\\widetilde{s},a_{p}|\\widehat{g}),\\forall\\widehat{g}$ Recall $\\mathbf{I}(\\tilde{s}_{t},\\tilde{a}_{t}|\\hat{g})=\\bar{Q^{\\pi_{e}}}(\\tilde{s}_{t},\\tilde{a}_{t}|\\hat{g})$ , when the intervention does not happen, we will have: ", "page_idx": 12}, {"type": "equation", "text": "$$\nQ^{\\pi_{e}}(\\tilde{s}_{t},a_{c}|\\hat{g})\\leq Q^{\\pi_{e}}(\\tilde{s}_{t},a_{p}|\\hat{g}),\\forall\\hat{g}\n$$", "text_format": "latex", "page_idx": 12}, {"type": "text", "text": "Therefore, ", "page_idx": 12}, {"type": "equation", "text": "$$\n(1-\\mathbf{T}(s,a_{c},a_{p}))Q^{\\pi_{e}}(\\tilde{s}_{t},a_{p}|\\hat{g})\\geq(1-\\mathbf{T}(s,a_{c},a_{p}))Q^{\\pi_{e}}(\\tilde{s}_{t},a_{c}|\\hat{g}),\\forall\\hat{g},\n$$", "text_format": "latex", "page_idx": 12}, {"type": "text", "text": "Now we introduce the expectation over the behavior policy. ", "page_idx": 12}, {"type": "equation", "text": "$$\n\\begin{array}{r l r}{\\mathbb{E}_{a\\sim\\pi_{I}(\\cdot\\vert s)}Q^{\\pi_{e}}(\\tilde{s}_{t},a\\vert\\hat{g})}&{=}&{\\mathbb{E}_{a_{p}\\sim\\pi_{p}}\\mathbb{E}_{a_{c}\\sim\\pi_{c}}\\mathbf{T}Q^{\\pi_{e}}(\\tilde{s}_{t},a_{c}\\vert\\hat{g})+(1-\\mathbf{T})Q^{\\pi_{e}}(\\tilde{s}_{t},a_{p}\\vert\\hat{g})}\\\\ &{\\ge}&{\\mathbb{E}_{a_{c}\\sim\\pi_{c}}Q^{\\pi_{e}}(\\tilde{s}_{t},a_{c}\\vert\\hat{g}),\\forall\\hat{g}\\ }\\end{array}\n$$", "text_format": "latex", "page_idx": 12}, {"type": "text", "text": "The above equation holds for arbitrary $\\hat{g}$ . Therefore $\\mathbb{E}_{a\\sim\\pi_{I}(\\cdot|s)}Q^{\\pi_{e}}(s,a)\\ge\\mathbb{E}_{a_{c}\\sim\\pi_{c}}Q^{\\pi_{e}}(s,a_{c})$ . ", "page_idx": 12}, {"type": "text", "text": "We introduce another useful lemma. ", "page_idx": 12}, {"type": "text", "text": "Lemma 5 (State Distribution Difference Bound). Let $\\pi$ and $\\pi^{\\prime}$ be two policies, and let $\\tau_{\\pi}:S\\rightarrow[0,1]$ and $\\tau_{\\pi^{\\prime}}:S\\to[0,1]$ be the corresponding state visitation distributions. For any state-dependent function $f(s)$ that is bounded by $M$ (i.e., $\\|f(s)\\|_{1}\\leq M$ for all $s$ ), the difference in expectations of $f(s)$ under these two distributions is bounded as follows: ", "page_idx": 12}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\left|\\mathbb{E}_{s\\sim\\tau_{\\pi}}[f(s)]-\\mathbb{E}_{s\\sim\\tau_{\\pi^{\\prime}}}[f(s)]\\right|\\le M\\|\\tau_{\\pi}-\\tau_{\\pi^{\\prime}}\\|_{1},}\\end{array}\n$$", "text_format": "latex", "page_idx": 12}, {"type": "text", "text": "where ", "page_idx": 12}, {"type": "equation", "text": "$$\n\\|\\tau_{\\pi}-\\tau_{\\pi^{\\prime}}\\|_{1}=\\sum_{s}|\\tau_{\\pi}(s)-\\tau_{\\pi^{\\prime}}(s)|\\,.\n$$", "text_format": "latex", "page_idx": 12}, {"type": "text", "text": "is the total variation distance between two distributions $\\tau_{\\pi}$ and $\\tau_{\\pi^{\\prime}}$ ", "page_idx": 12}, {"type": "text", "text": "Proof. The expectation of $f(s)$ under the state distribution $\\tau_{\\pi}$ can be written as: ", "page_idx": 12}, {"type": "equation", "text": "$$\n\\mathbb{E}_{s\\sim\\tau_{\\pi}}[f(s)]=\\sum_{s}\\tau_{\\pi}(s)f(s).\n$$", "text_format": "latex", "page_idx": 12}, {"type": "text", "text": "Similarly, for policy $\\pi^{\\prime}$ : ", "page_idx": 12}, {"type": "equation", "text": "$$\n\\mathbb{E}_{s\\sim\\tau_{\\pi^{\\prime}}}[f(s)]=\\sum_{s}\\tau_{\\pi^{\\prime}}(s)f(s).\n$$", "text_format": "latex", "page_idx": 12}, {"type": "text", "text": "The difference in these expectations is: ", "page_idx": 12}, {"type": "equation", "text": "$$\n\\left|\\mathbb{E}_{s\\sim\\tau_{\\pi}}[f(s)]-\\mathbb{E}_{s\\sim\\tau_{\\pi^{\\prime}}}[f(s)]\\right|=\\left|\\sum_{s}(\\tau_{\\pi}(s)-\\tau_{\\pi^{\\prime}}(s))f(s)\\right|\\le\\sum_{s}\\left|\\tau_{\\pi}(s)-\\tau_{\\pi^{\\prime}}(s)\\right|\\left|f(s)\\right|.\n$$", "text_format": "latex", "page_idx": 12}, {"type": "text", "text": "Given that $\\|f(s)\\|_{1}\\leq M$ , we have: ", "page_idx": 12}, {"type": "equation", "text": "$$\n\\sum_{s}|\\tau_{\\pi}(s)-\\tau_{\\pi^{\\prime}}(s)|\\,|f(s)|\\leq M\\sum_{s}|\\tau_{\\pi}(s)-\\tau_{\\pi^{\\prime}}(s)|=M\\|\\tau_{\\pi}-\\tau_{\\pi^{\\prime}}\\|_{1}.\n$$", "text_format": "latex", "page_idx": 12}, {"type": "text", "text": "Thus, combining these bounds, we have: ", "page_idx": 12}, {"type": "equation", "text": "$$\n\\begin{array}{r}{|\\mathbb{E}_{s\\sim\\tau_{\\pi}}[f(s)]-\\mathbb{E}_{s\\sim\\tau_{\\pi^{\\prime}}}[f(s)]|\\le M\\|\\tau_{\\pi}-\\tau_{\\pi^{\\prime}}\\|_{1}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 12}, {"type": "text", "text": "This completes the proof. ", "page_idx": 12}, {"type": "text", "text": "A.1 The relationship between the behavior policy and the pilot policy ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "In this section, we will lower bound the performance of the IDA policy $J(\\pi_{I})$ by the performance of the pilot policy $J(\\pi_{p})$ under certain conditions. ", "page_idx": 13}, {"type": "text", "text": "Theorem 2. Let $\\begin{array}{r}{\\boldsymbol{J}(\\pi)\\,=\\,\\mathbb{E}_{s_{0}\\sim d_{0},a_{t}\\sim\\pi(\\cdot|s_{t}),s_{t+1}\\sim P(\\cdot|s_{t},a_{t})}\\bigl[\\sum_{t=0}^{\\infty}\\gamma^{t}\\boldsymbol{r}\\bigl(s_{t},a_{t}\\bigr)\\bigr]}\\end{array}$ be the expected discounted return of following a policy $\\pi$ . Then for any behavior policy $\\pi_{I}$ deduced by a copilot policy $\\pi_{c}$ , a pilot policy $\\pi_{p}$ , and an intervention function $\\mathbf{T}(s,a_{p},a_{c})$ , ", "page_idx": 13}, {"type": "equation", "text": "$$\nJ(\\pi_{I})\\geq J(\\pi_{p})-\\beta R\\left[\\frac{\\gamma}{1-\\gamma}\\right]^{2}\\mathbb{E}_{s\\sim d_{\\pi_{I}}}\\left\\|\\pi_{c}(\\cdot\\mid s)-\\pi_{p}(\\cdot\\mid s)\\right\\|_{1},\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "wherein $R\\;=\\;R_{m a x}\\,-\\,R_{m i n}$ is the range of the reward, $\\begin{array}{r}{\\beta\\ =\\ \\frac{\\mathbb{E}_{s\\sim\\tau_{\\pi_{I}}}\\|\\mathbf{T}\\left(\\pi_{c}\\left(\\cdot|s\\right)-\\pi_{p}\\left(\\cdot|s\\right)\\right)\\|_{1}}{\\mathbb{E}_{s\\sim\\tau_{\\pi_{I}}}\\|\\pi_{c}\\left(\\cdot|s\\right)-\\pi_{p}\\left(\\cdot|s\\right)\\|_{1}}}\\end{array}$ 1 is the weighted expected intervention rate, and the $L_{1}$ -norm of output difference $\\lVert\\pi_{c}(\\cdot|s)-\\pi_{p}(\\cdot|s)\\rVert_{1}=$ $\\begin{array}{r}{\\int_{A}\\bar{|}\\pi_{c}(a|s)\\bar{-}\\pi_{p}(a|s)|\\,\\mathrm{d}a}\\end{array}$ is the discrepancy between $\\pi_{c}$ and $\\pi_{p}$ on state $s$ . ", "page_idx": 13}, {"type": "text", "text": "Proof. By following Lemma 2, we have ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\displaystyle J(\\pi_{I})-J(\\pi_{e})}\\\\ {=}&{\\mathbb{E}_{s,a\\sim\\tau_{\\pi_{I}}}\\left[\\displaystyle\\sum_{t=0}^{\\infty}\\gamma^{t}A^{\\pi_{e}}(s,a)\\right]}\\\\ {=}&{\\mathbb{E}_{s,a\\sim\\tau_{\\pi_{I}}}\\left[\\displaystyle\\sum_{t=0}^{\\infty}\\gamma^{t}\\left(Q^{\\pi_{e}}(s,a)-V^{\\pi_{e}}(s)\\right)\\right]}\\\\ {=}&{\\mathbb{E}_{s\\sim\\tau_{\\pi_{I}}}\\left[\\displaystyle\\sum_{t=0}^{\\infty}\\gamma^{t}\\left(\\mathbb{E}_{a\\sim\\pi_{I}(\\cdot\\vert s)}Q^{\\pi_{e}}(s,a)-V^{\\pi_{e}}(s)\\right)\\right]}\\end{array}\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "By following Lemma 3, we continue to have: ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{E}_{s\\sim\\tau_{\\pi_{I}}}\\left[\\displaystyle\\sum_{t=0}^{\\infty}\\gamma^{t}\\left(\\mathbb{E}_{a\\sim\\pi_{I}(\\cdot\\vert s)}Q^{\\pi_{e}}(s,a)-V^{\\pi_{e}}(s)\\right)\\right]}\\\\ {\\geq}&{\\mathbb{E}_{s\\sim\\tau_{\\pi_{I}}}\\left[\\displaystyle\\sum_{t=0}^{\\infty}\\gamma^{t}\\left(\\mathbb{E}_{a_{p}\\sim\\pi_{p}(\\cdot\\vert s)}Q^{\\pi_{e}}(s,a_{p})-V^{\\pi_{e}}(s)\\right)\\right]}\\\\ {=}&{\\mathbb{E}_{s\\sim\\tau_{\\pi_{I}}}\\left[\\displaystyle\\sum_{t=0}^{\\infty}\\gamma^{t}\\left(\\mathbb{E}_{a_{p}\\sim\\pi_{p}(\\cdot\\vert s)}A^{\\pi_{e}}(s,a_{p})\\right)\\right]}\\end{array}\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "At the same time, we have ", "page_idx": 13}, {"type": "equation", "text": "$$\nJ(\\pi_{p})-J(\\pi_{e})=\\mathbb{E}_{s\\sim\\tau_{\\pi_{p}}}\\left[\\sum_{t=0}^{\\infty}\\gamma^{t}\\left(\\mathbb{E}_{a_{p}\\sim\\pi_{p}(\\cdot|s)}A^{\\pi_{e}}(s,a_{p})\\right)\\right]\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "We want to relate Equation 35 with Equation 36, which has the expectation over state distribution $\\tau_{\\pi_{p}}$ , instead of $\\tau_{\\pi_{I}}$ . ", "page_idx": 13}, {"type": "text", "text": "To solve the mismatch, we apply Lemma 5. Here, we let ", "page_idx": 13}, {"type": "equation", "text": "$$\nf(s)=\\sum_{t=0}^{\\infty}\\gamma^{t}\\mathbb{E}_{a_{p}\\sim\\pi_{p}(\\cdot|s)}A^{\\pi_{e}}(s,a_{p}).\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "We have \u2225f(s)\u2225\u22641 \u03b3 \u2212\u03b3 R = M, where R = Rmax \u2212Rmin is the range of the reward. Lemma 5 bounds the difference in expectations of $f(s)$ under the state distributions $\\tau_{\\pi_{p}}$ and $\\tau_{\\pi_{I}}$ as follows: ", "page_idx": 13}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\left|\\mathbb{E}_{s\\sim\\tau_{\\pi_{p}}}[f(s)]-\\mathbb{E}_{s\\sim\\tau_{\\pi_{I}}}[f(s)]\\right|\\le M\\|\\tau_{\\pi_{p}}-\\tau_{\\pi_{I}}\\|_{1}}\\end{array}\n$$", "text_format": "latex", "page_idx": 13}, {"type": "text", "text": "Substituting $f(s)$ into this inequality, we get: ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\left|\\mathbb{E}_{s\\sim\\tau_{\\pi_{p}}}\\left[\\sum_{t=0}^{\\infty}\\gamma^{t}\\mathbb{E}_{a_{p}\\sim\\pi_{p}(\\cdot\\vert s)}A^{\\pi_{e}}(s,a_{p})\\right]-\\mathbb{E}_{s\\sim\\tau_{\\pi_{I}}}\\left[\\sum_{t=0}^{\\infty}\\gamma^{t}\\mathbb{E}_{a_{p}\\sim\\pi_{p}(\\cdot\\vert s)}A^{\\pi_{e}}(s,a_{p})\\right]\\right|\\le\\epsilon,\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "where $\\boldsymbol{\\epsilon}=M\\|\\boldsymbol{\\tau}_{\\pi_{p}}-\\tau_{\\pi_{I}}\\|_{1}$ . ", "page_idx": 14}, {"type": "text", "text": "Thus, we can write: ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\mathbb{E}_{s\\sim\\tau_{\\pi_{I}}}\\left[\\sum_{t=0}^{\\infty}\\gamma^{t}\\mathbb{E}_{a_{p}\\sim\\pi_{p}(\\cdot\\vert s)}A^{\\pi_{e}}(s,a_{p})\\right]\\geq\\mathbb{E}_{s\\sim\\tau_{\\pi_{p}}}\\left[\\sum_{t=0}^{\\infty}\\gamma^{t}\\mathbb{E}_{a_{p}\\sim\\pi_{p}(\\cdot\\vert s)}A^{\\pi_{e}}(s,a_{p})\\right]-\\epsilon,\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "From the deduction above, we have $\\begin{array}{r}{J(\\pi_{I})-J(\\pi_{e})\\geq\\mathbb{E}_{s\\sim\\tau_{\\pi_{I}}}\\left[\\sum_{t=0}^{\\infty}\\gamma^{t}\\mathbb{E}_{a_{p}\\sim\\pi_{p}(\\cdot|s)}A^{\\pi_{e}}(s,a_{p})\\right]}\\end{array}$ and the right hand side except $\\epsilon_{c}$ is $J(\\pi_{c})-J(\\pi_{e})$ . ", "page_idx": 14}, {"type": "text", "text": "Therefore, ", "page_idx": 14}, {"type": "equation", "text": "$$\nJ(\\pi_{I})-J(\\pi_{e})\\geq J(\\pi_{p})-J(\\pi_{e})-\\epsilon.\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "According to the Theorem 3.2 in (Xue et al., 2023) (Lemma 1), we have ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\|\\tau_{\\pi_{p}}-\\tau_{\\pi_{I}}\\|_{1}\\leq\\frac{\\beta\\gamma}{1-\\gamma}\\mathbb{E}_{s\\sim d_{\\pi_{I}}}\\left\\|\\pi_{c}(\\cdot\\mid s)-\\pi_{p}(\\cdot\\mid s)\\right\\|_{1},\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "where EsE\u223cs\u03c4\u223c\u03c0\u03c4I \u2225T\u2225(\u03c0\u03c0cc(\u00b7(|\u00b7s|s))\u2212\u2212\u03c0\u03c0pp(\u00b7(|\u00b7s|s))\u2225)\u22251 is the weighted expected intervention rate. Therefore, the \u03f5 can be upper bounded by: ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\epsilon=M\\|\\tau_{\\pi_{p}}-\\tau_{\\pi_{I}}\\|_{1}\\leq\\beta R\\left[\\frac{\\gamma}{1-\\gamma}\\right]^{2}\\mathbb{E}_{s\\sim d_{\\pi_{I}}}\\left\\|\\pi_{c}(\\cdot\\mid s)-\\pi_{p}(\\cdot\\mid s)\\right\\|_{1}.\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "Therefore, we have: ", "page_idx": 14}, {"type": "equation", "text": "$$\nJ(\\pi_{I})\\geq J(\\pi_{p})-\\beta R\\left[\\frac{\\gamma}{1-\\gamma}\\right]^{2}\\mathbb{E}_{s\\sim d_{\\pi_{I}}}\\left\\|\\pi_{c}(\\cdot\\mid s)-\\pi_{p}(\\cdot\\mid s)\\right\\|_{1}.\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "This is the lower limit for IDA in terms of the pilot. ", "page_idx": 14}, {"type": "text", "text": "A.2 The relationship between the behavior policy and the copilot policy ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "In this section, we will lower-bound the performance of the IDA policy $J(\\pi_{I})$ by the performance of the copilot policy $J(\\pi_{c})$ . ", "page_idx": 14}, {"type": "text", "text": "Theorem 3. Let $\\begin{array}{r}{\\boldsymbol{J}(\\pi)\\,=\\,\\mathbb{E}_{s_{0}\\sim d_{0},a_{t}\\sim\\pi(\\cdot|s_{t}),s_{t+1}\\sim P(\\cdot|s_{t},a_{t})}\\bigl[\\sum_{t=0}^{\\infty}\\gamma^{t}\\boldsymbol{r}\\bigl(s_{t},a_{t}\\bigr)\\bigr]}\\end{array}$ be the expected discounted return of following a policy $\\pi$ . Then for any behavior policy $\\pi_{I}$ deduced by a copilot policy $\\pi_{c}$ , a pilot policy $\\pi_{p}$ , and an intervention function $\\mathbf{T}(s,a_{p},a_{c})$ , ", "page_idx": 14}, {"type": "equation", "text": "$$\nJ(\\pi_{I})\\geq J(\\pi_{c})-(1-\\beta)R\\left[\\frac{\\gamma}{1-\\gamma}\\right]^{2}\\mathbb{E}_{s\\sim d_{\\pi_{I}}}\\left\\|\\pi_{c}(\\cdot\\mid s)-\\pi_{p}(\\cdot\\mid s)\\right\\|_{1}.\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "Proof. According to Lemma 4, ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\quad J(\\pi_{I})-J(\\pi_{e})}\\\\ &{=\\mathbb{E}_{s,a\\sim\\pi_{I}}\\left[\\displaystyle\\sum_{t=0}^{\\infty}\\gamma^{t}A^{\\pi_{e}}(s,a)\\right]}\\\\ &{=\\mathbb{E}_{s,a\\sim\\pi_{I}}\\left[\\displaystyle\\sum_{t=0}^{\\infty}\\gamma^{t}Q^{\\pi_{e}}(s,a)-V^{\\pi_{e}}(s)\\right]}\\\\ &{\\geq\\mathbb{E}_{s\\sim\\pi_{I}}\\left[\\mathbb{E}_{a_{c}\\sim\\pi_{c}(\\cdot\\vert s)}\\displaystyle\\sum_{t=0}^{\\infty}\\gamma^{t}\\big[Q^{\\pi_{e}}(s,a_{c})-V^{\\pi_{e}}(s)\\big]\\right]}\\end{array}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "With Lemma 2, we have ", "page_idx": 15}, {"type": "equation", "text": "$$\nJ(\\pi_{c})-J(\\pi_{e})=\\mathbb{E}_{s\\sim\\tau_{\\pi_{c}}}\\left[\\sum_{t=0}^{\\infty}\\gamma^{t}\\left(\\mathbb{E}_{a_{c}\\sim\\pi_{c}(\\cdot|s)}A^{\\pi_{e}}(s,a_{c})\\right)\\right]\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "Now we will use Lemma 5, letting ", "page_idx": 15}, {"type": "equation", "text": "$$\nf_{c}(s)=\\sum_{t=0}^{\\infty}\\gamma^{t}\\mathbb{E}_{a_{c}\\sim\\pi_{c}(\\cdot|s)}A^{\\pi_{e}}(s,a_{c}).\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "We will have \u2225fc(s)\u2225\u22641 \u2212\u03b3 , where $R=R_{\\mathrm{max}}-R_{\\mathrm{min}}$ is the range of the reward. Lemma 5 bounds the difference in expectations of $f(s)$ under the state distributions $\\tau_{\\pi_{c}}$ and $\\tau_{\\pi_{I}}$ as follows: ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\left|{\\mathbb{E}}_{s\\sim\\tau_{\\pi_{c}}}[f_{c}(s)]-{\\mathbb{E}}_{s\\sim\\tau_{\\pi_{I}}}[f_{c}(s)]\\right|\\le M\\|\\tau_{\\pi_{c}}-\\tau_{\\pi_{I}}\\|_{1}\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "Substituting $f(s)$ into this inequality, we get: ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\left|\\mathbb{E}_{s\\sim\\tau_{\\pi_{c}}}\\left[\\sum_{t=0}^{\\infty}\\gamma^{t}\\mathbb{E}_{a_{c}\\sim\\pi_{c}(\\cdot|s)}A^{\\pi_{c}}(s,a_{c})\\right]-\\mathbb{E}_{s\\sim\\tau_{\\pi_{I}}}\\left[\\sum_{t=0}^{\\infty}\\gamma^{t}\\mathbb{E}_{a_{c}\\sim\\pi_{c}(\\cdot|s)}A^{\\pi_{c}}(s,a_{c})\\right]\\right|\\le\\epsilon_{c},\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "where $\\epsilon_{c}=M\\|\\tau_{\\pi_{c}}-\\tau_{\\pi_{I}}\\|_{1}$ . ", "page_idx": 15}, {"type": "text", "text": "Thus, we can write: ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\mathbb{E}_{s\\sim\\tau_{\\pi_{I}}}\\left[\\sum_{t=0}^{\\infty}\\gamma^{t}\\mathbb{E}_{a_{c}\\sim\\pi_{c}(\\cdot|s)}A^{\\pi_{c}}(s,a_{c})\\right]\\geq\\mathbb{E}_{s\\sim\\tau_{\\pi_{c}}}\\left[\\sum_{t=0}^{\\infty}\\gamma^{t}\\mathbb{E}_{a_{c}\\sim\\pi_{c}(\\cdot|s)}A^{\\pi_{e}}(s,a_{c})\\right]-\\epsilon_{c}.\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "By substituting Equation 49 and Equation 50 into Equation 54, we have: ", "page_idx": 15}, {"type": "equation", "text": "$$\nJ(\\pi_{I})-J(\\pi_{e})\\ge J(\\pi_{c})-J(\\pi_{e})-\\epsilon_{c}.\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "By using Lemma 1, we have $\\epsilon_{c}=M\\|\\tau_{\\pi_{c}}-\\tau_{\\pi_{I}}\\|_{1}$ upper-bounded by: ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\epsilon_{c}\\leq(1-\\beta)R\\left[\\frac{\\gamma}{1-\\gamma}\\right]^{2}\\mathbb{E}_{s\\sim d_{\\pi_{I}}}\\left\\|\\pi_{c}(\\cdot\\mid s)-\\pi_{p}(\\cdot\\mid s)\\right\\|_{1}.\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "Therefore, we have: ", "page_idx": 15}, {"type": "equation", "text": "$$\nJ(\\pi_{I})\\geq J(\\pi_{c})-(1-\\beta)R\\left[\\frac{\\gamma}{1-\\gamma}\\right]^{2}\\mathbb{E}_{s\\sim d_{\\pi_{I}}}\\left\\|\\pi_{c}(\\cdot\\mid s)-\\pi_{p}(\\cdot\\mid s)\\right\\|_{1}.\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "This is the lower bound of IA in terms of the copilot. ", "page_idx": 15}, {"type": "text", "text": "A.3 Safety and Performance Guarantees of IA ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "We now prove our main theorem on the performance guarantees of following the IA policy, restated below: ", "page_idx": 15}, {"type": "text", "text": "Theorem 1. Let $\\begin{array}{r}{\\boldsymbol{J}(\\pi)\\,=\\,\\mathbf{E}_{s_{0}\\sim d_{0},a_{t}\\sim\\pi(\\cdot|s_{t}),s_{t+1}\\sim P(\\cdot|s_{t},a_{t})}\\bigl[\\sum_{t=0}^{\\infty}\\gamma^{t}\\boldsymbol{r}\\bigl(s_{t},a_{t}\\bigr)\\bigr]}\\end{array}$ be the expected discounted return of following a policy $\\pi$ . Then, the performance following the Interventional Assistance policy (or behavior policy) $\\pi_{I}$ has the following guarantees: ", "page_idx": 15}, {"type": "text", "text": "1. For a near-optimal pilot, $(Q^{\\pi_{e}}(s,a_{p})\\approx\\operatorname*{max}_{a^{*}}Q^{\\pi_{e}}(s,a^{*}))$ , $\\pi_{I}$ is lower bounded by $\\pi_{p}$ : ", "page_idx": 15}, {"type": "equation", "text": "$$\nJ(\\pi_{I})\\geq J(\\pi_{p}).\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "2. For a low performing pilot, $\\begin{array}{r}{\\left(Q^{\\pi_{e}}(s,a_{p})\\approx\\operatorname*{min}_{a}Q^{\\pi_{e}}(s,a)\\right)}\\end{array}$ , $\\pi_{I}$ is low bounded by $\\pi_{c}$ : ", "page_idx": 15}, {"type": "equation", "text": "$$\nJ(\\pi_{I})\\ge J(\\pi_{c})\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "Proof. From equation 44 and equation 57 we have obtained the following lower bounds on the performance of IA, ", "page_idx": 16}, {"type": "equation", "text": "$$\nJ(\\pi_{I})\\geq J(\\pi_{c})-(1-\\beta)R\\left[\\frac{\\gamma}{1-\\gamma}\\right]^{2}\\mathbb{E}_{s\\sim d_{\\pi_{I}}}\\left\\|\\pi_{c}(\\cdot\\mid s)-\\pi_{p}(\\cdot\\mid s)\\right\\|_{1}\n$$", "text_format": "latex", "page_idx": 16}, {"type": "equation", "text": "$$\nJ(\\pi_{I})\\geq J(\\pi_{p})-\\beta R\\left[\\frac{\\gamma}{1-\\gamma}\\right]^{2}\\mathbb{E}_{s\\sim d_{\\pi_{I}}}\\left\\Vert\\pi_{c}(\\cdot\\mid s)-\\pi_{p}(\\cdot\\mid s)\\right\\Vert_{1}\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "For a near optimal pilot, ", "page_idx": 16}, {"type": "equation", "text": "$$\nQ(s,a_{p})\\approx\\operatorname*{max}_{a}Q^{\\pi_{e}}(s,a)\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "and therefore, ", "page_idx": 16}, {"type": "equation", "text": "$$\nQ(s,a_{p})\\geq Q(s,a_{c}).\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "This means that $T(s,a_{p},a_{c})\\approx0$ and therefore $\\beta\\approx0$ . When we take the limit of the pilot lower bound as $\\beta\\rightarrow0$ , we have: ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\operatorname*{lim}_{\\beta\\to0}\\left[J(\\pi_{I})\\geq J(\\pi_{p})-\\beta R\\left[\\frac{\\gamma}{1-\\gamma}\\right]^{2}\\mathbb{E}_{s\\sim d_{\\pi_{I}}}\\left\\|\\pi_{c}(\\cdot\\mid s)-\\pi_{p}(\\cdot\\mid s)\\right\\|_{1}\\right]\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "which simplifies to ", "page_idx": 16}, {"type": "equation", "text": "$$\nJ(\\pi_{I})\\geq J(\\pi_{p}).\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "Similarly for a pilot that is far from optimal, ", "page_idx": 16}, {"type": "equation", "text": "$$\nQ(s,a_{p})\\approx\\operatorname*{min}_{a}Q^{\\pi_{e}}(s,a)\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "and therefore ", "page_idx": 16}, {"type": "equation", "text": "$$\nQ(s,a_{p})\\leq Q(s,a_{c}).\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "This means that $T(s,a_{p},a_{c})\\approx1$ and therefore $\\beta\\approx1$ . When we take the limit of the copilot lower bound as $\\beta\\rightarrow1$ , we have: ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\operatorname*{lim}_{\\beta\\to1}\\left[J(\\pi_{I})\\geq J(\\pi_{c})-(1-\\beta)R\\left[\\frac{\\gamma}{1-\\gamma}\\right]^{2}\\mathbb{E}_{s\\sim d_{\\pi_{I}}}\\left\\|\\pi_{c}(\\cdot\\mid s)-\\pi_{p}(\\cdot\\mid s)\\right\\|_{1}\\right]\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "which simplifies to ", "page_idx": 16}, {"type": "equation", "text": "$$\nJ(\\pi_{I})\\geq J(\\pi_{c}).\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "We have therefore shown that for a near optimal pilot, IA is guaranteed to not degrade performance, and for a very poor pilot, IA is guaranteed to do at least as good as the copilot. \u53e3 ", "page_idx": 16}, {"type": "text", "text": "B Computational Cost of IDA ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "We found that the computation time for IDA inference only slightly increase as the size of the goal space increases (Table B.1). In all our experiments, we approximate continuous goal spaces by sampling 1,000 candidate goals which costs about $3\\:\\mathrm{ms}$ . This is sufficiently fast for most real-time control applications. Performance could further be improved by using Monte-Carlo estimates as done in the Faux-Goal experiments. ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\frac{\\mathrm{Time}\\quad1\\quad2\\quad3\\quad4\\quad5\\quad10\\quad100\\quad1000\\quad10000\\quad100000}{\\mathrm{(ms)}\\quad2.0\\quad2.1\\quad2.2\\quad2.3\\quad2.3\\quad2.0\\quad2.1\\quad3.1\\quad2.5\\quad\\quad11.7}\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "Table B.1: Computation time of Advantage Function v. Number of Goals on a single RTX 3080Ti ", "page_idx": 16}, {"type": "text", "text": "C Examples of Real Human Intervention ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "We found that, for human experiments in Lunar Lander, interventions by IDA are most common at the start of episodes and when touching down (Figure C.1). Each episode starts with a random disruptive force applied to the rocket so it makes sense that intervention should occur initially to ensure the human maintains a stable filght. Additionally, the rocket ship is very sensitive to the speed and orientation when touching down. Interventions near touch down likely serve to prevent collisions with the ground. ", "page_idx": 17}, {"type": "image", "img_path": "nJvkQSu9Z5/tmp/2081bcb3d9d68fda1d4e50b3dbb64a4d1d13030736a6916ba81ae6dffb41664d.jpg", "img_caption": ["Figure C.1: Intervention tends to occur near the start of trajectories to stabalize the rocket and then again near the end of trajectories to assist the touch down. "], "img_footnote": [], "page_idx": 17}, {"type": "text", "text": "D Human-in-the-Loop Lunar Lander Experimental Design ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "Eight (2 female, 6 male) participants with no prior experience performed 3 sequences of Lunar Lander experiments. All participants were compensated with a gift card for their time and involvement in the study. Each sequence consisted of 3 experimental blocks (30 episodes per block) of pilot-only, copilot, and IDA control (Figure D.1). An episode of lunar lander timed out after 30 seconds. In total, each participant played 270 episodes of Lunar Lander, 90 for each condition of pilot-only, copilot, and IDA. ", "page_idx": 17}, {"type": "image", "img_path": "nJvkQSu9Z5/tmp/22368bb9fa0c854fe2a25cdefcb8161ac297c529917ce1c1001aa365ffbe3328.jpg", "img_caption": ["Figure D.1: All participants completed 3 sequences of three blocks. Each sequence was composed of a pilot-only, copilot, and IDA control block. Each block consisted of 30 episodes. "], "img_footnote": [], "page_idx": 17}, {"type": "text", "text": "NeurIPS Paper Checklist ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "1. Claims ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Question: Do the main claims made in the abstract and introduction accurately reflect the paper\u2019s contributions and scope? ", "page_idx": 18}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Justification: We rigorously develop the IDA SA framework as described in the introduction in sections 3.1-3.6. We further empirically demonstrate the utility of our framework in Section 4. ", "page_idx": 18}, {"type": "text", "text": "Guidelines: ", "page_idx": 18}, {"type": "text", "text": "\u2022 The answer NA means that the abstract and introduction do not include the claims made in the paper.   \n\u2022 The abstract and/or introduction should clearly state the claims made, including the contributions made in the paper and important assumptions and limitations. A No or NA answer to this question will not be perceived well by the reviewers.   \n\u2022 The claims made should match theoretical and experimental results, and reflect how much the results can be expected to generalize to other settings.   \n\u2022 It is fine to include aspirational goals as motivation as long as it is clear that these goals are not attained by the paper. ", "page_idx": 18}, {"type": "text", "text": "2. Limitations ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Question: Does the paper discuss the limitations of the work performed by the authors? ", "page_idx": 18}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Justification: We discuss the limitations of our approach in the discussion. In particular, we discuss the limitations of training a fully autonomous agent to perform the task and the assumptions that space of possible goals is known. ", "page_idx": 18}, {"type": "text", "text": "Guidelines: ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "\u2022 The answer NA means that the paper has no limitation while the answer No means that the paper has limitations, but those are not discussed in the paper.   \n\u2022 The authors are encouraged to create a separate \"Limitations\" section in their paper.   \n\u2022 The paper should point out any strong assumptions and how robust the results are to violations of these assumptions (e.g., independence assumptions, noiseless settings, model well-specification, asymptotic approximations only holding locally). The authors should reflect on how these assumptions might be violated in practice and what the implications would be.   \n\u2022 The authors should reflect on the scope of the claims made, e.g., if the approach was only tested on a few datasets or with a few runs. In general, empirical results often depend on implicit assumptions, which should be articulated.   \n\u2022 The authors should reflect on the factors that influence the performance of the approach. For example, a facial recognition algorithm may perform poorly when image resolution is low or images are taken in low lighting. Or a speech-to-text system might not be used reliably to provide closed captions for online lectures because it fails to handle technical jargon.   \n\u2022 The authors should discuss the computational efficiency of the proposed algorithms and how they scale with dataset size.   \n\u2022 If applicable, the authors should discuss possible limitations of their approach to address problems of privacy and fairness.   \n\u2022 While the authors might fear that complete honesty about limitations might be used by reviewers as grounds for rejection, a worse outcome might be that reviewers discover limitations that aren\u2019t acknowledged in the paper. The authors should use their best judgment and recognize that individual actions in favor of transparency play an important role in developing norms that preserve the integrity of the community. Reviewers will be specifically instructed to not penalize honesty concerning limitations. ", "page_idx": 18}, {"type": "text", "text": "3. Theory Assumptions and Proofs ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Question: For each theoretical result, does the paper provide the full set of assumptions and a complete (and correct) proof? ", "page_idx": 19}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "Justification: We provide a proof of theorem 1 in appendix A. All the preliminaries for Theorem 1 are defined in sections 3.1-3.4 ", "page_idx": 19}, {"type": "text", "text": "Guidelines: ", "page_idx": 19}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include theoretical results.   \n\u2022 All the theorems, formulas, and proofs in the paper should be numbered and crossreferenced.   \n\u2022 All assumptions should be clearly stated or referenced in the statement of any theorems.   \n\u2022 The proofs can either appear in the main paper or the supplemental material, but if they appear in the supplemental material, the authors are encouraged to provide a short proof sketch to provide intuition.   \n\u2022 Inversely, any informal proof provided in the core of the paper should be complemented by formal proofs provided in appendix or supplemental material.   \n\u2022 Theorems and Lemmas that the proof relies upon should be properly referenced. ", "page_idx": 19}, {"type": "text", "text": "4. Experimental Result Reproducibility ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "Question: Does the paper fully disclose all the information needed to reproduce the main experimental results of the paper to the extent that it affects the main claims and/or conclusions of the paper (regardless of whether the code and data are provided or not)? ", "page_idx": 19}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 19}, {"type": "text", "text": "Justification: We provide a description of our methods in section 3.1-3.5 as well as provided references for methods we adopted. We also provide descriptions of the gymnasium environments that we use which are all publically available. ", "page_idx": 19}, {"type": "text", "text": "Guidelines: ", "page_idx": 19}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 If the paper includes experiments, a No answer to this question will not be perceived well by the reviewers: Making the paper reproducible is important, regardless of whether the code and data are provided or not.   \n\u2022 If the contribution is a dataset and/or model, the authors should describe the steps taken to make their results reproducible or verifiable.   \n\u2022 Depending on the contribution, reproducibility can be accomplished in various ways. For example, if the contribution is a novel architecture, describing the architecture fully might suffice, or if the contribution is a specific model and empirical evaluation, it may be necessary to either make it possible for others to replicate the model with the same dataset, or provide access to the model. In general. releasing code and data is often one good way to accomplish this, but reproducibility can also be provided via detailed instructions for how to replicate the results, access to a hosted model (e.g., in the case of a large language model), releasing of a model checkpoint, or other means that are appropriate to the research performed.   \n\u2022 While NeurIPS does not require releasing code, the conference does require all submissions to provide some reasonable avenue for reproducibility, which may depend on the nature of the contribution. For example (a) If the contribution is primarily a new algorithm, the paper should make it clear how to reproduce that algorithm. (b) If the contribution is primarily a new model architecture, the paper should describe the architecture clearly and fully. (c) If the contribution is a new model (e.g., a large language model), then there should either be a way to access this model for reproducing the results or a way to reproduce the model (e.g., with an open-source dataset or instructions for how to construct the dataset). (d) We recognize that reproducibility may be tricky in some cases, in which case authors are welcome to describe the particular way they provide for reproducibility. In the case of closed-source models, it may be that access to the model is limited in ", "page_idx": 19}, {"type": "text", "text": "some way (e.g., to registered users), but it should be possible for other researchers to have some path to reproducing or verifying the results. ", "page_idx": 20}, {"type": "text", "text": "5. Open access to data and code ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Question: Does the paper provide open access to the data and code, with sufficient instructions to faithfully reproduce the main experimental results, as described in supplemental material? ", "page_idx": 20}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 20}, {"type": "text", "text": "Justification: We provide code as a supplementary zip file. Polished code will be released with the paper along with set up and installation instructs to allow others to reproduce results as well as build future work. ", "page_idx": 20}, {"type": "text", "text": "Guidelines: ", "page_idx": 20}, {"type": "text", "text": "\u2022 The answer NA means that paper does not include experiments requiring code.   \n\u2022 Please see the NeurIPS code and data submission guidelines (https://nips.cc/ public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 While we encourage the release of code and data, we understand that this might not be possible, so \u201cNo\u201d is an acceptable answer. Papers cannot be rejected simply for not including code, unless this is central to the contribution (e.g., for a new open-source benchmark).   \n\u2022 The instructions should contain the exact command and environment needed to run to reproduce the results. See the NeurIPS code and data submission guidelines (https: //nips.cc/public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 The authors should provide instructions on data access and preparation, including how to access the raw data, preprocessed data, intermediate data, and generated data, etc.   \n\u2022 The authors should provide scripts to reproduce all experimental results for the new proposed method and baselines. If only a subset of experiments are reproducible, they should state which ones are omitted from the script and why.   \n\u2022 At submission time, to preserve anonymity, the authors should release anonymized versions (if applicable).   \n\u2022 Providing as much information as possible in supplemental material (appended to the paper) is recommended, but including URLs to data and code is permitted. ", "page_idx": 20}, {"type": "text", "text": "6. Experimental Setting/Details ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Question: Does the paper specify all the training and test details (e.g., data splits, hyperparameters, how they were chosen, type of optimizer, etc.) necessary to understand the results? ", "page_idx": 20}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 20}, {"type": "text", "text": "Justification: Parameters for training are provided in sections 3 and 4.1. We specify the agents and environments that we use to perform training. ", "page_idx": 20}, {"type": "text", "text": "Guidelines: ", "page_idx": 20}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments. \u2022 The experimental setting should be presented in the core of the paper to a level of detail that is necessary to appreciate the results and make sense of them. \u2022 The full details can be provided either with the code, in appendix, or as supplemental material. ", "page_idx": 20}, {"type": "text", "text": "7. Experiment Statistical Significance ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Question: Does the paper report error bars suitably and correctly defined or other appropriate information about the statistical significance of the experiments? ", "page_idx": 20}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 20}, {"type": "text", "text": "Justification: Error bars corresponding to standard error of the mean are included on plots in figures 2, 3, and 4. ", "page_idx": 20}, {"type": "text", "text": "Guidelines: \u2022 The answer NA means that the paper does not include experiments. ", "page_idx": 20}, {"type": "text", "text": "\u2022 The authors should answer \"Yes\" if the results are accompanied by error bars, confidence intervals, or statistical significance tests, at least for the experiments that support the main claims of the paper.   \n\u2022 The factors of variability that the error bars are capturing should be clearly stated (for example, train/test split, initialization, random drawing of some parameter, or overall run with given experimental conditions).   \n\u2022 The method for calculating the error bars should be explained (closed form formula, call to a library function, bootstrap, etc.)   \n\u2022 The assumptions made should be given (e.g., Normally distributed errors).   \n\u2022 It should be clear whether the error bar is the standard deviation or the standard error of the mean.   \n\u2022 It is OK to report 1-sigma error bars, but one should state it. The authors should preferably report a 2-sigma error bar than state that they have a $96\\%$ CI, if the hypothesis of Normality of errors is not verified.   \n\u2022 For asymmetric distributions, the authors should be careful not to show in tables or figures symmetric error bars that would yield results that are out of range (e.g. negative error rates).   \n\u2022 If error bars are reported in tables or plots, The authors should explain in the text how they were calculated and reference the corresponding figures or tables in the text. ", "page_idx": 21}, {"type": "text", "text": "8. Experiments Compute Resources ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "Question: For each experiment, does the paper provide sufficient information on the computer resources (type of compute workers, memory, time of execution) needed to reproduce the experiments? ", "page_idx": 21}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 21}, {"type": "text", "text": "Justification: Training hardware and time is described in Section 3. Guidelines: ", "page_idx": 21}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The paper should indicate the type of compute workers CPU or GPU, internal cluster, or cloud provider, including relevant memory and storage.   \n\u2022 The paper should provide the amount of compute required for each of the individual experimental runs as well as estimate the total compute.   \n\u2022 The paper should disclose whether the full research project required more compute than the experiments reported in the paper (e.g., preliminary or failed experiments that didn\u2019t make it into the paper). ", "page_idx": 21}, {"type": "text", "text": "9. Code Of Ethics ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "Question: Does the research conducted in the paper conform, in every respect, with the NeurIPS Code of Ethics https://neurips.cc/public/EthicsGuidelines? ", "page_idx": 21}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "Justification: We have reviewed the Code of Ethics to ensure our paper complies with them. Guidelines: ", "page_idx": 21}, {"type": "text", "text": "\u2022 The answer NA means that the authors have not reviewed the NeurIPS Code of Ethics.   \n\u2022 If the authors answer No, they should explain the special circumstances that require a deviation from the Code of Ethics.   \n\u2022 The authors should make sure to preserve anonymity (e.g., if there is a special consideration due to laws or regulations in their jurisdiction). ", "page_idx": 21}, {"type": "text", "text": "10. Broader Impacts ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "Question: Does the paper discuss both potential positive societal impacts and negative societal impacts of the work performed? ", "page_idx": 21}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 21}, {"type": "text", "text": "Justification: We discuss in the introduction the broader impacts of developing shared autonomy systems and the overall need to develop AI that assists humans and does not repalce humans. ", "page_idx": 21}, {"type": "text", "text": "Guidelines: ", "page_idx": 22}, {"type": "text", "text": "\u2022 The answer NA means that there is no societal impact of the work performed.   \n\u2022 If the authors answer NA or No, they should explain why their work has no societal impact or why the paper does not address societal impact.   \n\u2022 Examples of negative societal impacts include potential malicious or unintended uses (e.g., disinformation, generating fake profiles, surveillance), fairness considerations (e.g., deployment of technologies that could make decisions that unfairly impact specific groups), privacy considerations, and security considerations.   \n\u2022 The conference expects that many papers will be foundational research and not tied to particular applications, let alone deployments. However, if there is a direct path to any negative applications, the authors should point it out. For example, it is legitimate to point out that an improvement in the quality of generative models could be used to generate deepfakes for disinformation. On the other hand, it is not needed to point out that a generic algorithm for optimizing neural networks could enable people to train models that generate Deepfakes faster.   \n\u2022 The authors should consider possible harms that could arise when the technology is being used as intended and functioning correctly, harms that could arise when the technology is being used as intended but gives incorrect results, and harms following from (intentional or unintentional) misuse of the technology.   \n\u2022 If there are negative societal impacts, the authors could also discuss possible mitigation strategies (e.g., gated release of models, providing defenses in addition to attacks, mechanisms for monitoring misuse, mechanisms to monitor how a system learns from feedback over time, improving the efficiency and accessibility of ML). ", "page_idx": 22}, {"type": "text", "text": "11. Safeguards ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Question: Does the paper describe safeguards that have been put in place for responsible release of data or models that have a high risk for misuse (e.g., pretrained language models, image generators, or scraped datasets)? ", "page_idx": 22}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 22}, {"type": "text", "text": "Justification: Or paper leverages publically available models and datasets and builds a model for performing shared human-AI control. No new foundation models or datasets are released with our research. ", "page_idx": 22}, {"type": "text", "text": "Guidelines: ", "page_idx": 22}, {"type": "text", "text": "\u2022 The answer NA means that the paper poses no such risks.   \n\u2022 Released models that have a high risk for misuse or dual-use should be released with necessary safeguards to allow for controlled use of the model, for example by requiring that users adhere to usage guidelines or restrictions to access the model or implementing safety filters.   \n\u2022 Datasets that have been scraped from the Internet could pose safety risks. The authors should describe how they avoided releasing unsafe images.   \n\u2022 We recognize that providing effective safeguards is challenging, and many papers do not require this, but we encourage authors to take this into account and make a best faith effort. ", "page_idx": 22}, {"type": "text", "text": "12. Licenses for existing assets ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Question: Are the creators or original owners of assets (e.g., code, data, models), used in the paper, properly credited and are the license and terms of use explicitly mentioned and properly respected? ", "page_idx": 22}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 22}, {"type": "text", "text": "Justification: All the methods we adapt for training various parts of IDA are cited in section 3. ", "page_idx": 22}, {"type": "text", "text": "Guidelines: ", "page_idx": 22}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not use existing assets.   \n\u2022 The authors should cite the original paper that produced the code package or dataset.   \n\u2022 The authors should state which version of the asset is used and, if possible, include a URL.   \n\u2022 The name of the license (e.g., CC-BY 4.0) should be included for each asset.   \n\u2022 For scraped data from a particular source (e.g., website), the copyright and terms of service of that source should be provided.   \n\u2022 If assets are released, the license, copyright information, and terms of use in the package should be provided. For popular datasets, paperswithcode.com/datasets has curated licenses for some datasets. Their licensing guide can help determine the license of a dataset.   \n\u2022 For existing datasets that are re-packaged, both the original license and the license of the derived asset (if it has changed) should be provided.   \n\u2022 If this information is not available online, the authors are encouraged to reach out to the asset\u2019s creators. ", "page_idx": 22}, {"type": "text", "text": "", "page_idx": 23}, {"type": "text", "text": "13. New Assets ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: Are new assets introduced in the paper well documented and is the documentation provided alongside the assets? ", "page_idx": 23}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 23}, {"type": "text", "text": "Justification: We do not introduce new assets in this paper. ", "page_idx": 23}, {"type": "text", "text": "Guidelines: ", "page_idx": 23}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not release new assets.   \n\u2022 Researchers should communicate the details of the dataset/code/model as part of their submissions via structured templates. This includes details about training, license, limitations, etc.   \n\u2022 The paper should discuss whether and how consent was obtained from people whose asset is used.   \n\u2022 At submission time, remember to anonymize your assets (if applicable). You can either create an anonymized URL or include an anonymized zip file. ", "page_idx": 23}, {"type": "text", "text": "14. Crowdsourcing and Research with Human Subjects ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: For crowdsourcing experiments and research with human subjects, does the paper include the full text of instructions given to participants and screenshots, if applicable, as well as details about compensation (if any)? ", "page_idx": 23}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Justification: Experimental set-up for human experiments is described in section 4.4. Compensation is also reported in section 4.1 ", "page_idx": 23}, {"type": "text", "text": "Guidelines: ", "page_idx": 23}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Including this information in the supplemental material is fine, but if the main contribution of the paper involves human subjects, then as much detail as possible should be included in the main paper.   \n\u2022 According to the NeurIPS Code of Ethics, workers involved in data collection, curation, or other labor should be paid at least the minimum wage in the country of the data collector. ", "page_idx": 23}, {"type": "text", "text": "15. Institutional Review Board (IRB) Approvals or Equivalent for Research with Human Subjects ", "page_idx": 23}, {"type": "text", "text": "Question: Does the paper describe potential risks incurred by study participants, whether such risks were disclosed to the subjects, and whether Institutional Review Board (IRB) approvals (or an equivalent approval/review based on the requirements of your country or institution) were obtained? ", "page_idx": 23}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 23}, {"type": "text", "text": "Justification: We obtained consent from all subjects and all experiments were IRB approved. Guidelines: ", "page_idx": 23}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Depending on the country in which research is conducted, IRB approval (or equivalent) may be required for any human subjects research. If you obtained IRB approval, you should clearly state this in the paper.   \n\u2022 We recognize that the procedures for this may vary significantly between institutions and locations, and we expect authors to adhere to the NeurIPS Code of Ethics and the guidelines for their institution.   \n\u2022 For initial submissions, do not include any information that would break anonymity (if applicable), such as the institution conducting the review. ", "page_idx": 24}]