[{"figure_path": "eQ6VjBhevn/figures/figures_4_1.jpg", "caption": "Figure 1: Motivating findings. (a) Comparison between the expected error of CLIP-ViT-B-16, denoted as e(y), and the error of the marginal probability distribution obtained by marginalizing over examples with the same label, P\u0177\u2260y(p); (b) Reliability diagrams of CLIP-ViT-B-16 on the ImageNet validation set (left), and its augmented version (right), showing that augmentations largely un-calibrate CLIP exclusively due to overconfidence while leading to slightly better overall accuracy.", "description": "This figure presents two key findings. The first is a comparison of the expected error of the CLIP-ViT-B-16 model with the error of its marginal probability distribution, demonstrating that the latter provides a lower bound to the former. The second part shows reliability diagrams for both the original and augmented versions of the ImageNet dataset, illustrating that while augmentations may improve overall accuracy, they also tend to lead to overconfidence and reduced calibration.", "section": "2 Understanding Marginal Entropy Minimization"}, {"figure_path": "eQ6VjBhevn/figures/figures_4_2.jpg", "caption": "Figure 1: Motivating findings. (a) Comparison between the expected error of CLIP-ViT-B-16, denoted as e(y), and the error of the marginal probability distribution obtained by marginalizing over examples with the same label, P\u0177\u2260y(p); (b) Reliability diagrams of CLIP-ViT-B-16 on the ImageNet validation set (left), and its augmented version (right), showing that augmentations largely un-calibrate CLIP exclusively due to overconfidence while leading to slightly better overall accuracy.", "description": "Figure 1(a) compares the expected error rate of a standard CLIP model (e(y)) against the error rate of a model that uses the marginal probability distribution (p) obtained from multiple augmented views of the input image. The results show that the error rate of p lower-bounds e(y), indicating that using the marginal probability improves performance. Figure 1(b) illustrates the reliability diagrams, comparing the confidence levels of the model predictions against their actual accuracy. The original model shows good calibration, but when augmentations are used, overconfidence significantly increases despite minimal improvement in overall accuracy.", "section": "Motivating findings"}, {"figure_path": "eQ6VjBhevn/figures/figures_15_1.jpg", "caption": "Figure 2: Entropy of the pre-TTA marginal probability distribution vs the invariance ratio.", "description": "This figure shows the relationship between the entropy of the pre-Test-Time Adaptation (TTA) marginal probability distribution and the invariance ratio. The invariance ratio measures how often the arg max of the pre-TTA marginal probability distribution remains unchanged after applying Marginal Entropy Minimization (MEM). The figure demonstrates a trend where as the entropy decreases (less uncertainty), the invariance ratio increases (the arg max is more likely to remain unchanged after MEM). Even within the top 10% of most uncertain samples, invariance holds more than 82% of the time.", "section": "A Marginal Entropy Minimization does not influence arg max p"}, {"figure_path": "eQ6VjBhevn/figures/figures_18_1.jpg", "caption": "Figure 1: Motivating findings. (a) Comparison between the expected error of CLIP-ViT-B-16, denoted as e(y), and the error of the marginal probability distribution obtained by marginalizing over examples with the same label, P\u0177\u2260y(p); (b) Reliability diagrams of CLIP-ViT-B-16 on the ImageNet validation set (left), and its augmented version (right), showing that augmentations largely un-calibrate CLIP exclusively due to overconfidence while leading to slightly better overall accuracy.", "description": "Figure 1(a) shows that the error of the marginal probability distribution p is always lower than the expected error of the model, even in practical use cases where the label space is large. Figure 1(b) shows that augmentations largely un-calibrate the model due to overconfidence.", "section": "2 Understanding Marginal Entropy Minimization"}, {"figure_path": "eQ6VjBhevn/figures/figures_19_1.jpg", "caption": "Figure 4: Reliability diagrams (20 bins) for CLIP-ViT-B-16 on the 4 datasets for Natural Distribution Shifts. In each row, left is the ECE on the source dataset, right on the augmented and filtered version. Row 1: ImageNet-A [13]; Row 2: ImageNet-v2 [32]; Row 3: ImageNet-R [12]; Row 4: ImageNet-Sketch [46].", "description": "This figure displays reliability diagrams for CLIP-ViT-B-16 on four datasets known for their distribution shifts from ImageNet.  Each row shows two diagrams: one for the original dataset and one for an augmented and filtered version. The diagrams visualize the model's calibration by plotting accuracy against confidence for various confidence intervals. The Expected Calibration Error (ECE) is also indicated for both versions in each dataset.  It illustrates the impact of augmentations on model calibration, specifically showing a significant increase in overconfidence after augmentation.", "section": "3.1 Augmentations undermine the reliability of p"}, {"figure_path": "eQ6VjBhevn/figures/figures_20_1.jpg", "caption": "Figure 1: Motivating findings. (a) Comparison between the expected error of CLIP-ViT-B-16, denoted as e(y), and the error of the marginal probability distribution obtained by marginalizing over examples with the same label, P\u0177\u2260y(p); (b) Reliability diagrams of CLIP-ViT-B-16 on the ImageNet validation set (left), and its augmented version (right), showing that augmentations largely un-calibrate CLIP exclusively due to overconfidence while leading to slightly better overall accuracy.", "description": "Figure 1(a) compares the error rate of standard inference with the error rate of using the marginal probability distribution (p). It shows that the error rate of p is lower than standard inference's error rate. Figure 1(b) uses reliability diagrams to illustrate how augmentations affect the model.  It highlights that while augmentations improve overall accuracy, they make the model's confidence scores unreliable (overconfident).", "section": "2 Understanding Marginal Entropy Minimization"}, {"figure_path": "eQ6VjBhevn/figures/figures_21_1.jpg", "caption": "Figure 4: Reliability diagrams (20 bins) for CLIP-ViT-B-16 on the 4 datasets for Natural Distribution Shifts. In each row, left is the ECE on the source dataset, right on the augmented and filtered version. Row 1: ImageNet-A [13]; Row 2: ImageNet-v2 [32]; Row 3: ImageNet-R [12]; Row 4: ImageNet-Sketch [46].", "description": "This figure shows the reliability diagrams of CLIP-ViT-B-16 on four datasets for natural distribution shifts (ImageNet-A, ImageNet-V2, ImageNet-R, and ImageNet-Sketch).  Each row displays the Expected Calibration Error (ECE) and accuracy for both the original dataset (left) and an augmented and filtered version of the dataset (right).  The diagrams visually represent the model's calibration, showing how well the model's predicted confidence aligns with its actual accuracy.  The comparison highlights the impact of augmentations on the model's calibration.", "section": "3.1 Augmentations undermine the reliability of p"}, {"figure_path": "eQ6VjBhevn/figures/figures_24_1.jpg", "caption": "Figure 7: Examples of satellite imagery taken from EuroSAT [11], along with augmentations leading to high confident predictions. Column (a) reports source images with their label. Columns (b-d) report views sorted by entropy (lowest to highest), paired with the prediction and the confidence of CLIP-ViT-B-16 [31].", "description": "This figure shows examples of satellite images and their augmentations used in the experiment. The augmentations are simple random resized crops and horizontal flips. The figure displays three examples of satellite images with their ground truth labels. For each image, three augmented views are presented, sorted by the confidence of CLIP-ViT-B-16's prediction. The goal is to illustrate how these augmentations impact the model's predictions and confidence.", "section": "F A failure mode for TTA: satellite imagery"}]