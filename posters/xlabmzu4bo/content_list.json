[{"type": "text", "text": "MEGALODON: Efficient LLM Pretraining and Inference with Unlimited Context Length ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Xuezhe Ma\u03c0\u2217 Xiaomeng Yang\u00b5\u2217 Wenhan Xiong\u00b5 Beidi Chen\u03ba Lili Yu\u00b5 ", "page_idx": 0}, {"type": "text", "text": "Hao Zhang\u03b4 Jonathan May\u03c0 Luke Zettlemoyer\u00b5 Omer Levy\u00b5 Chunting Zhou\u00b5\u2217 ", "page_idx": 0}, {"type": "text", "text": "\u00b5AI at Meta \u03c0University of Southern California \u03baCarnegie Mellon University \u03b4University of California San Diego ", "page_idx": 0}, {"type": "text", "text": "Abstract ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "The quadratic complexity and weak length extrapolation of Transformers limits their ability to scale to long sequences, and while sub-quadratic solutions like linear attention and state space models exist, they empirically underperform Transformers in pretraining efficiency and downstream task accuracy. We introduce MEGALODON, an neural architecture for efficient sequence modeling with unlimited context length. MEGALODON inherits the architecture of MEGA (exponential moving average with gated attention), and further introduces multiple technical components to improve its capability and stability, including complex exponential moving average (CEMA), timestep normalization layer, normalized attention mechanism and pre-norm with two-hop residual configuration. In a controlled head-to-head comparison with LLAMA2, MEGALODON achieves better efficiency than Transformer in the scale of 7 billion parameters and 2 trillion training tokens. MEGALODON reaches a training loss of 1.70, landing mid-way between LLAMA2- 7B (1.75) and 13B (1.67). The improvements of MEGALODON over Transformers are robust throughout a range of benchmarks across different tasks and modalities. ", "page_idx": 0}, {"type": "text", "text": "Code: https://github.com/XuezheMax/megalodon ", "page_idx": 0}, {"type": "text", "text": "1 Introduction ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "In many real-world applications, such as multi-turn conversation, long-document comprehension, and video generation, large language models (LLMs) must efficiently process long sequential data, understand internal long-range dynamics, and generate coherent output. The Transformer architecture (Vaswani et al., 2017), despite its remarkable capabilities, faces challenges with quadratic computational complexity and limited inductive bias for length generalization, making it inefficient for long sequence modeling (Wang et al., 2024; Zhou et al., 2024). Even with recently proposed distributed attention solutions (Li et al., 2023b; Liu et al., 2024), computing a single training step of a 7B parameter model over a 1M-token sequence is more than 100 times slower than performing the equivalent computation using 256 separate sequences of 4K tokens each. ", "page_idx": 0}, {"type": "text", "text": "Techniques like efficient attention mechanisms (Tay et al., 2020; Ma et al., 2021) and structured state space models (Gu et al., 2022a; Poli et al., 2023; Gu and Dao, 2023) have been introduced to overcome these limitations, aiming to enhance scalability and performance. However, the practical application of these methods still falls short of Transformers (Tay et al., 2022; Gu and Dao, 2023). This work introduces an unlimited context model that outperforms the canonical Transformer architecture on real-world language modeling. ", "page_idx": 0}, {"type": "image", "img_path": "XlAbMZu4Bo/tmp/1c1c5de7da02a5722747b91042b9ff3f635bb3ba05c07508f43cb9b8c9e1c7ba.jpg", "img_caption": ["Figure 1: Negative log-likelihood for MEGALODON-7B, LLAMA2-7B and LLAMA2-13B. "], "img_footnote": [], "page_idx": 1}, {"type": "table", "img_path": "XlAbMZu4Bo/tmp/f973975a7fbc7a9da7e5253037c27d786a9aff1ce161106ea8405ffdbfbb9af6.jpg", "table_caption": ["Table 1: Performance on standard academic benchmarks, compared to open-source base models. We reported model size, context length and total data tokens during model pretraining. \u2013 indicates that the number was not reported in the original paper. "], "table_footnote": [], "page_idx": 1}, {"type": "text", "text": "We introduce MEGALODON, an improved MEGA architecture (Ma et al., 2023), which harnesses the gated attention mechanism with the classical exponential moving average (EMA) (Hunter, 1986) approach (\u00a72). To further improve the capability and efficiency of MEGALODON on large-scale longcontext pretraining, we propose multiple novel technical components. First, MEGALODON introduces the complex exponential moving average (CEMA) component, which extends the multi-dimensional damped EMA in MEGA to the complex domain (\u00a73.1). Then, MEGALODON proposes the timestep normalization layer, which generalizes the group normalization layer (Wu and He, 2018) to autoregressive sequence modeling tasks to allow normalization along the sequential dimension (\u00a73.2). To improve large-scale pretraining stability, MEGALODON further proposes normalized attention (\u00a73.3), together with pre-norm with two-hop residual configuration by modifying the widely-adopted preand post-normalization methods (\u00a73.4). By simply chunking input sequences into fixed blocks, as is done in MEGA-chunk (Ma et al., 2023), MEGALODON achieves linear computational and memory complexity in both model training and inference. ", "page_idx": 1}, {"type": "text", "text": "Empirically, we demonstrate the potential of MEGALODON as a general architecture for modeling long sequences, by evaluating its performance across multiple scales of language modeling, as well as downstream domain-specific tasks. Through a direct comparison with LLAMA2, while controlling for data and compute, MEGALODON-7B significantly outperforms the state-of-the-art variant of Transformer used to train LLAMA2-7B (Touvron et al., 2023) on both training perplexity (Figure 1) and across downstream benchmarks (Table 1). Evaluation on long-context modeling, including perplexity in various context lengths up to 2M and long-context QA tasks in Scrolls (Parisotto et al., 2020) prove MEGALODON\u2019s ability to model sequences of unlimited length. Additional experimental results on small/medium-scale benchmarks, including LRA (Tay et al., 2021), ImageNet (Deng et al., 2009), Speech Commands (Warden, 2018), WikiText-103 (Merity et al., 2017) and PG19 (Rae et al., 2019), demonstrate the robust improvements of MEGALODON across scales and modalities. ", "page_idx": 1}, {"type": "text", "text": "2 Background: Moving Average Equipped Gated Attention (MEGA) ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "In this section, we setup notations, briefly review the key components in the MEGA architecture (Ma et al., 2023), and discuss the existing problems in MEGA. ", "page_idx": 2}, {"type": "text", "text": "Following the notations in MEGA, we use $X\\ =\\ \\left\\{\\mathbf{x}_{1},\\mathbf{x}_{2},\\ldots,\\mathbf{x}_{n}\\right\\}\\ \\in\\ \\ \\mathbb{R}^{n\\times d}$ and $\\textbf{\\textit{Y}}=$ $\\left\\{\\mathbf{y}_{1},\\mathbf{y}_{2},\\dotsc...,\\mathbf{y}_{n}\\right\\}\\ \\in\\ \\mathbb{R}^{n\\times d}$ to denote the input and output sequences with length $n$ , and assume the representations of the input and output sequences have the same dimension $d$ . ", "page_idx": 2}, {"type": "text", "text": "2.1 Multi-dimensional Damped EMA ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "MEGA embeds an EMA component into the calculation of the attention matrix to incorporate inductive biases across the timestep dimension. Concretely, the multi-dimensional damped EMA first expands each dimension of the input sequence $\\mathbf{\\deltaX}$ individually into $h$ dimensions via an expansion matrix $\\beta\\in\\mathbb{R}^{d\\times h}$ , then applies damped EMA to the $h$ -dimensional hidden space. Formally, for each dimension $j\\in\\{1,2,\\ldots,d\\}$ : ", "page_idx": 2}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbf{u}_{t}^{(j)}=\\beta_{j}\\mathbf{x}_{t,j}}\\\\ &{\\mathbf{h}_{t}^{(j)}=\\alpha_{j}\\odot\\mathbf{u}_{t}^{(j)}+\\left(1-\\pmb{\\alpha}_{j}\\odot\\delta_{j}\\right)\\odot\\mathbf{h}_{t-1}^{(j)}}\\\\ &{\\mathbf{y}_{t,j}=\\pmb{\\eta}_{j}^{T}\\mathbf{h}_{t}^{(j)}}\\end{array}\n$$", "text_format": "latex", "page_idx": 2}, {"type": "text", "text": "where ut $\\mathbf{u}_{t}^{(j)}\\in\\mathbb{R}^{h}$ is the expanded $h$ -dimensional vector for the $j$ -th dimension at timestep $t$ . $\\alpha\\in$ $(0,1)^{d\\times h}$ , $\\pmb{\\delta}\\in(0,1)^{d\\times h}$ are the decaying and damping factors, respectively. $\\mathbf{h}_{t}^{(j)}\\in\\mathbb{R}^{h}$ is the EMA hidden state for the $j$ -th dimension at timestep $t$ . $\\eta\\in\\mathbb{R}^{d\\times h}$ is the projection matrix to map the $h$ -dimensional hidden state back to 1-dimensional output $\\mathbf{y}_{t,j}\\in\\mathbb{R}$ . ", "page_idx": 2}, {"type": "text", "text": "2.2 Moving Average Equipped Gated Attention ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "In the gated attention mechanism in MEGA, the output from EMA (1) is used to compute the shared representation (Hua et al., 2022), because it encodes contextual information through EMA. Subsequently, MEGA introduces the reset gate, the update gate , and computes the candidate activation with the update gate and the residual connection. The technical details are provided in Appendix A. ", "page_idx": 2}, {"type": "text", "text": "2.3 Existing Problems in MEGA ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "To reduce the quadratic complexity in the full attention mechanism, MEGA simply split the sequences of queries, keys and values in (14-16) into chunks of length $c$ . The attention in (17) is individually applied to each chunk, yielding linear complexity $O(k c^{2})\\,{\\stackrel{.}{=}}\\,O(n c)$ . Technically, the EMA sub-layer in MEGA helps capture local contextual information near each token, mitigating the problem of losing contextual information beyond chunk boundaries in the chunk-wise attention. ", "page_idx": 2}, {"type": "text", "text": "Despite the impressive successes of MEGA, it still suffers its own problems: i) the performance of MEGA with chunk-wise attention still fails behind the one with full attention, due to the limited expressiveness of the EMA sub-layer in MEGA. ii) for different tasks and/or data types, there are architectural divergences in the final MEGA architectures. For example, different normalization layers, normalization patterns (pre-norm vs. post-norm) and attention functions $(f(\\cdot)$ in (17)) are applied to different data types (see Ma et al. (2023) for details). iii) There are no empirical evidences showing that MEGA is scalable for large-scale pretraining. ", "page_idx": 2}, {"type": "text", "text": "3 MEGALODON ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "To address the aforementioned problems of MEGA, in this section we describe the novel technical advancements of MEGALODON. ", "page_idx": 2}, {"type": "text", "text": "3.1 CEMA: Extending Multi-dimensional Damped EMA to Complex Domain ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "As discussed in Ma et al. (2023), the EMA component can be regarded as a simplified state space model with diagonal state matrix. Directly inspired from Gu et al. (2022b), as almost all matrices ", "page_idx": 2}, {"type": "image", "img_path": "XlAbMZu4Bo/tmp/6a33d45eea8827f248b34e41da6c98a0fe14441ea42ae6f121ae23c631e43ba3.jpg", "img_caption": ["Figure 2: Normalization methods. The elements in blue or pink are the regions to compute means and variances. We omit the batch dimension for simplicity. "], "img_footnote": [], "page_idx": 3}, {"type": "text", "text": "diagonalize over the complex plane, a straight-forward idea to improve EMA capability is to extend to work over the complex number system $\\mathbb{C}$ . We propose the complex exponential moving average (CEMA), which re-writes Eq. (1): ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbf{h}_{t}^{(j)}=\\alpha_{j}(\\cos\\theta_{j}+i\\sin\\theta_{j})\\odot\\mathbf{u}_{t}^{(j)}+(1-\\alpha_{j}\\odot\\delta_{j})(\\cos\\theta_{j}+i\\sin\\theta_{j})\\odot\\mathbf{h}_{t-1}^{(j)}}\\\\ &{\\mathbf{y}_{t,j}=\\mathrm{Re}(\\eta_{j}^{T}\\mathbf{h}_{t}^{(j)})}\\end{array}\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "where $\\alpha,\\delta\\in\\mathbb{R}^{d\\times h}$ are the real number parameters same as in EMA. Different from EMA, $\\eta\\in\\mathbb{C}^{d\\times h}$ in CEMA are complex numbers. $\\theta_{j}\\in\\bar{\\mathbb{R}}^{h}$ , $j\\in\\{1,2,\\ldots,d\\}$ are the $h$ arguments. To uniformly space the $h$ arguments over the period $2\\pi$ , we parameterize $\\theta_{j}$ as: ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\theta_{j,k}=\\frac{2\\pi k}{h}\\omega_{j},\\quad\\forall k\\in\\{1,2,\\ldots,h\\}\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "where the learnable parameter $\\omega\\in\\mathbb{R}^{d}$ depicts the $d$ base angles. By decaying the absolute value of each $h_{t}$ , CEMA preserves the decaying structure in kernel weights, which is a key principle to the success of convolutional models on long sequence modeling (Li et al., 2023c). ", "page_idx": 3}, {"type": "text", "text": "3.2 Timestep Normalization ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "Despite the impressive performance of Layer Normalization combined with Transformer, it is obvious that layer normalization cannot directly reduce the internal covariate shift along the spatial dimension (a.k.a timestep or sequential dimension) (Ioffe and Szegedy, 2015). Group Normalization (Wu and He, 2018) normalizes hidden representations both along the timestep dimension and a subset of the feature dimension, which has obtained improvements over Layer Normalization on a range of computer vision tasks. However, it cannot be directly applied to Transformer on auto-regressive sequence modeling, due to the leakage of future information via the mean and variance across the timestep dimension. ", "page_idx": 3}, {"type": "text", "text": "In MEGALODON, we extend Group Normalization to the auto-regressive case by computing the cumulative mean and variance. Formally, suppose an input sequence $\\mathbf{\\bar{\\calX}}=\\{\\mathbf{x}_{1},\\mathbf{x}_{2},\\therefore...,\\mathbf{x}_{n}\\}\\in\\bar{\\mathbb{R}}^{n\\times d}$ , and $k$ groups along the feature dimension with $d_{g}=\\bar{d}/k$ elements per group. Then, the mean and variance of the first group at timestep $t\\in\\{1,2,\\bar{\\ldots},n\\}$ are: ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\mu_{t}=\\frac{1}{t\\ast d_{g}}\\sum_{i=1}^{t}\\sum_{j=1}^{d_{g}}x_{i,j},\\qquad\\sigma_{t}^{2}=\\frac{1}{t\\ast d_{g}}\\sum_{i=1}^{t}\\sum_{j=1}^{d_{g}}(x_{i,j}-\\mu_{t})^{2}\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "Figure 2 illustrates Layer Normalization and Timestep Normalization. To efficiently and precisely calculate the cumulative mean and variance in each timestep, we provide hardware-friendly implementation on modern hardware (GPU) (see Appendix B.1). ", "page_idx": 3}, {"type": "text", "text": "3.3 Normalized Attention in MEGALODON ", "text_level": 1, "page_idx": 3}, {"type": "text", "text": "Previous studies have investigated the saturation and instability issues in the original scaled dotproduct attention (17). A number of novel techniques have emerged to modify the scaled dot-product attention, among which normalized attention mechanisms, such as (scaled-) cosine attention (Luo et al., 2018; Liu et al., 2022) and QK-normalization (Henry et al., 2020), have stood out for the simplicity and effectiveness. ", "page_idx": 3}, {"type": "image", "img_path": "XlAbMZu4Bo/tmp/1f3181cc2b8ea2c4317875c932ff26ed9282dde2d46c9f6ed7df5f07e5a90e7f.jpg", "img_caption": ["Figure 3: Illustration of the MEGALODON architecture. Figure (a) shows a sketch of one MEGALODON layer. Figure (b) and (c) display the configurations of pre-norm and pre-norm with two-hop residual, respectively. "], "img_footnote": [], "page_idx": 4}, {"type": "text", "text": "Directly inspired from these normalized attention mechanisms, we propose the normalized attention mechanism specifically defined for MEGA to improve its stability. Formally, ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\begin{array}{l}{\\displaystyle{\\boldsymbol X}^{\\prime}=\\mathrm{CEMA}(\\boldsymbol X)}\\\\ {\\displaystyle~~\\boldsymbol Z=\\boldsymbol X^{\\prime}\\boldsymbol W_{z}+b_{z},~~~\\boldsymbol Z^{\\prime}=\\frac{\\boldsymbol Z}{\\|\\boldsymbol Z\\|}}\\\\ {\\displaystyle~~\\boldsymbol Q=\\kappa_{q}\\odot\\boldsymbol Z^{\\prime}+\\mu_{q}}\\\\ {\\displaystyle~~\\boldsymbol K=\\kappa_{k}\\odot\\boldsymbol Z^{\\prime}+\\mu_{k}}\\end{array}\n$$", "text_format": "latex", "page_idx": 4}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\in\\mathbb R^{n\\times d}}\\\\ &{\\in\\mathbb R^{n\\times z}}\\\\ &{\\in\\mathbb R^{n\\times z}}\\\\ &{\\in\\mathbb R^{n\\times z}}\\\\ &{\\in\\mathbb R^{n\\times z}}\\end{array}\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "where $Q$ and $\\kappa$ are computed by using the normalized shared representation $Z^{\\prime}$ instead of $Z$ . Note that we remove the SiLU (Ramachandran et al., 2017) activation function $\\phi_{\\mathrm{silu}}$ in (13), because the normalization on $Z$ has incorporated non-linearity into $Z^{\\prime}$ . Then the attention operation in (17) has been changed to: ", "page_idx": 4}, {"type": "equation", "text": "$$\nO=f_{\\mathrm{softmax}}\\left(Q K^{T}\\right)V\n$$", "text_format": "latex", "page_idx": 4}, {"type": "equation", "text": "$$\n\\in\\mathbb{R}^{n\\times v}\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "As we use learnable $\\kappa_{q},\\,\\kappa_{k}$ in (7) and (8), we can remove the scaled term $\\tau(X)$ . In addition, we found that with the normalized attention, the softmax function $f_{\\mathrm{softmax}}$ obtains the best or at least comparable performance on different tasks and data modalities (see Appendix C). Hence, throughout this paper we use softmax as the default attention function. ", "page_idx": 4}, {"type": "text", "text": "3.4 Pre-Norm with Two-hop Residual ", "text_level": 1, "page_idx": 4}, {"type": "text", "text": "Normalization configurations are crucial in stably training deep architectures, and prenormalization (Xiong et al., 2020) has become the default normalization configuration because of its better convergence properties than post-normalization in the original Transformer architecture (Vaswani et al., 2017). However, extensive studies have investigated the instability issue of pre-normalization when scaling up model size (Davis et al., 2021; Liu et al., 2022). Formally, a Transformer-based block in pre-noromalization can be formulated as (shown in Figure 3 (b)): ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\hat{\\pmb Y}=\\mathrm{Attention}(\\mathrm{Norm}(\\pmb X))+\\pmb X}\\\\ &{\\pmb Y=\\mathrm{FFN}(\\mathrm{Norm}(\\hat{\\pmb Y}))+\\hat{\\pmb Y}}\\\\ &{\\quad=\\mathrm{FFN}(\\mathrm{Norm}(\\hat{\\pmb Y}))+\\mathrm{Attention}(\\mathrm{Norm}(\\pmb X))+\\pmb X}\\end{array}\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "where the output $\\mathbf{\\deltaY}$ is the sum of the input $\\mathbf{\\deltaX}$ and the output of each component in one block. Hence, the range and/or variance of $\\mathbf{\\deltaY}$ keeps increasing for deeper blocks, causing the instability issue. In ", "page_idx": 4}, {"type": "text", "text": "the original MEGA architecture, the update gate $\\varphi$ (19) is used for a gated residual connection (21) to mitigate this problem (Parisotto et al., 2020; Xu et al., 2020). However, the update gate $\\varphi$ introduces more model parameters and the instability issue still exists when scaling up model size to 7 billion. ", "page_idx": 5}, {"type": "text", "text": "MEGALODON introduces a new configuration named pre-norm with two-hop residual, which simply re-arranges the residual connections in each block (shown in Figure 3 (c): ", "page_idx": 5}, {"type": "equation", "text": "$$\n\\begin{array}{l}{\\hat{Y}=\\mathrm{Attention}(\\mathrm{Norm}(X))+X}\\\\ {Y=\\mathrm{FFN}(\\mathrm{Norm}(\\hat{Y}))+X}\\end{array}\n$$", "text_format": "latex", "page_idx": 5}, {"type": "text", "text": "where the input $\\mathbf{\\deltaX}$ is reused as the residual connection of the FFN layer. Since $\\hat{Y}$ is directly followed by a normalization layer, we remove the update gate $\\varphi$ and use standard residual connection. The graphical architecture of a MEGALODON sub-layer is visualized in Figure 3 (a). Note that the Timestep Normalization is only applied before the attention layer. Before the FFN layer, we still use Layer Normalization. The reasons are two-fold: i) Layer Normalization is faster than Timestep Normalization; ii) the output vector of each token from the attention layer is a mixture of vectors from contextual tokens via attention weights. Hence, normalizing the attention output along the feature dimension is similar to indirectly normalize along the timestep dimension. ", "page_idx": 5}, {"type": "text", "text": "3.5 4-Dimensional Parallelism in Distributed LLM Pretraining ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "Efficient distributed training algorithm is essential to train a large-scale language model, and several parallelization mechanisms have been introduced. The three most commonly used parallelism strategies are data, tensor (Shoeybi et al., 2019) and pipeline parallelism (Huang et al., 2019). However, the 3-dimensional parallelism is still insufficient to scale up the context length of LLMs (Li et al., 2023b; Liu et al., 2024). ", "page_idx": 5}, {"type": "text", "text": "Beneftiing from the chunk-wise attention in MEGALODON, we can efficiently parallelize it along the new timestep/sequence dimension, which is orthogonal to all the aforementioned three parallelism dimensions. In MEGALODON, the only communications between devices in one chunk-parallel group are the last hidden state of CEMA and the cumulative mean and variance of Timestep Normalization in each block. Using asynchronous communication, we can minimize the overhead of chunk parallelization by hiding the communication costs in the computation of other components inside the same block and/or other blocks. ", "page_idx": 5}, {"type": "text", "text": "4 Experiments ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "To evaluate the scalability and efficiency of MEGALODON on long-context sequence modeling, we scale up MEGALODON to 7-billion model size and apply it to large-scale language model pretraining on 2 trillion tokens. We also conduct experiments on small/medium-scale sequence modeling benchmarks, including Long Range Arena (LRA) (Tay et al., 2021), raw speech classification on Speech Commands (Warden, 2018), image classification on ImageNet-1K (Deng et al., 2009), and language-modeling on WikiText-103 (Merity et al., 2017) and PG19 (Rae et al., 2019). 2 Empirically, MEGALODON significantly outperforms all the state-of-the-art baseline models on these tasks across various data modalities. ", "page_idx": 5}, {"type": "text", "text": "4.1 LLM Pretraining ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "Architectural Details In our MEGALODON-7B model, we adopt most of architectural hyperparameters from LLAMA2-7B to ensure fair comparison: MEGALODON-7B consists of 32 blocks, with feature dimension $d=4096$ . Following LLAMA2, we use the SwiGLU activation function (Shazeer, 2020) in the feed-forward layer, and rotary positional embedding (RoPE, Su et al. (2021)). We set the attention chunk size $c=4096$ , which is the same as the pretraining context length in LLAMA2. Beneftiing from the attention gate $\\because$ in (18)), we use a much smaller number of attention heads $h=4$ in MEGALODON-7B, comparing to $h=32$ in LLAMA2-7B. In addition, we apply pre-norm with two-hop residual (\u00a73.4), using Timestep Normalization (\u00a73.2) and Layer Normalization (Ba et al., 2016), while LLAMA2 models apply pre-normalization with RMSNorm (Zhang and Sennrich, 2019). ", "page_idx": 5}, {"type": "text", "text": "Data and Pretraining Details We use the same mix of publicly available data from LLAMA2, ensuring that the model are trained on exactly the same 2-trillion tokens. We also use the same tokenizer as LLAMA2, whose vocabulary size is 32K. ", "page_idx": 6}, {"type": "text", "text": "We trained MEGALODON-7B using the AdamW optimizer (Loshchilov and Hutter, 2019), with $\\beta_{1}=0.9$ , $\\beta_{2}=0.95$ , $\\epsilon=1e-8$ . The learning rate is $3.5e-4$ and cosine learning rate schedule is applied with warmup of 2500 steps. We use a weight decay of 0.1 and gradient clipping of 1.0, and no dropout is applied during training. The context length in pretraining is 32K (4 attention chunks). The global batch size is 4M tokens, and is distributed on 256 NVIDIA A100 GPUs (16K tokens per A100). We set data parallel size to 128, chunk parallel size to 2 and tensor parallel size to 1. ", "page_idx": 6}, {"type": "text", "text": "Data and Computation Efficiency We evaluate the efficiency of MEGALODON w.r.t both the data and computation perspectives. For data efficiency, we display the negative log-likelihood (NLL) for MEGALODON-7B, LLAMA2-7B and LLAMA2-13B w.r.t processed tokens during training in Figure 1. MEGALODON-7B obtains significantly better (lower) NLL than LLAMA2-7B under the same amount of training tokens, demonstrating better data efficiency. Moreover, MEGALODON suffers less training spikes than the Transformer-based architecture in LLAMA2. Note that at the first 1/4 of the pretraining process $\\mathrm{\\left<\\,500B\\right>}$ tokens), the NLL of MEGALODON-7B is slightly worse than LLAMA2-7B. We found that the main reason is that we increased the base $\\theta$ of RoPE from 10, 000 in LLAMA2 to 100, 000 in MEGALODON, which slows down model convergence at the beginning of the pretraining process. At the end, MEGALODON reaches a training loss of 1.70, landing mid-way between LLAMA2-7B (1.75) and LLAMA2-13B (1.67). ", "page_idx": 6}, {"type": "text", "text": "For computation efficiency, we conduct experiments of running LLAMA2-7B and MEGALODON-7B using the same amount of computational resources and comparing their training speed under various context lengths. Specifically, we execute each experiment to train a model with global batch size 4M tokens distributed on 256 NVIDIA A100 GPUs (16K tokens per A100) and calculate the word/token per second (WPS) to measure the training speed. Figure 4 illustrates the average WPS per device of LLAMA2-7B and MEGALODON-7B using 4K and 32K context lengths, respectively. For LLAMA2 models, we accelerate the computation of full attention with Flash-Attention V2 (Dao, ", "page_idx": 6}, {"type": "image", "img_path": "XlAbMZu4Bo/tmp/1aa0c2c99276c604ad19de20832ab2c2d780d30f523d33e74aa8db9d32dbbe75.jpg", "img_caption": ["Figure 4: Average WPS per device. "], "img_footnote": [], "page_idx": 6}, {"type": "text", "text": "2024). Under 4K context length, MEGALODON-7B is slightly slower (about $6\\%$ ) than LLAMA2-7B, due to the introduction of CEMA and Timestep Normalization. When we scale up context length to 32K, MEGALODON-7B is significantly faster (about $32\\%$ ) than LLAMA2-7B, demonstrating the computation efficiency of MEGALODON for long-context pretraining. In addition, MEGALODON-7B-32K, which utilizes chunk parallelism (\u00a73.5), achieves about $94\\%$ utilization of MEGALODON-7B-4K. ", "page_idx": 6}, {"type": "text", "text": "4.2 Short-Context Evaluation on Academic Benchmarks ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "We compare MEGALODON-7B to LLAMA2 models on standard academic benchmarks with short contexts $\\langle<4\\mathsf{K}$ tokens), closely following the settings in LLAMA2 (Touvron et al., 2023). The benchmarks are grouped into the categories listed below: ", "page_idx": 6}, {"type": "text", "text": "\u2022 Commonsense Reasoning (0-shot): HellaSwag (Zellers et al., 2019), PIQA (Bisk et al., 2020), SIQA (Sap et al., 2019), WinoGrande (Sakaguchi et al., 2021), ARC-e and -c (Clark et al., 2018). ", "page_idx": 6}, {"type": "text", "text": "\u2022 World Knowledge (5-shot): NaturalQuestions (NQ, Kwiatkowski et al. (2019)) and TriviaQA (TQA, Joshi et al. (2017)).   \n\u2022 Reading Comprehension (0-shot): BoolQ (Clark et al., 2019).   \n\u2022 Popular aggregated results (5-shot): MMLU (Hendrycks et al., 2020). ", "page_idx": 6}, {"type": "text", "text": "", "page_idx": 6}, {"type": "text", "text": "Table 1 summarizes the results of MEGALODON and LLAMA2 on these academic benchmarks, together with other open-source base models, including MPT (MosaicML, 2023), RWKV (Peng et al., 2023), Mamba (Gu and Dao, 2023), Mistral (Jiang et al., 2023) and Gemma (Mesnard et al., 2024). Pretrained on the same 2T tokens, MEGALODON-7B surpasses LLAMA2-7B across all the benchmarks. On some tasks, MEGALODON-7B achieves comparable or even better performance with LLAMA2-13B. Note that Mistral-7B and Gemma-8B were pretrained on much larger datasets than MEGALODON-7B, hence the results are not directly comparable. ", "page_idx": 6}, {"type": "image", "img_path": "XlAbMZu4Bo/tmp/2dfbf93cc67a8815003ea84590ed1ed5d2f53ae2b1e80d1b6434fd7a5d7cb12c.jpg", "img_caption": ["Figure 5: PPL in various context lengths. "], "img_footnote": [], "page_idx": 7}, {"type": "image", "img_path": "XlAbMZu4Bo/tmp/4c4172828517b2972ba6065d69700e54c7de5fa2dd449a81f4bd86b65e59b083.jpg", "img_caption": ["Table 2: Results on Scrolls. \u2217LLAMA2-L (Xiong et al., 2023) continually trains LLAMA2 on 500B tokens for length extension. "], "img_footnote": [], "page_idx": 7}, {"type": "text", "text": "", "page_idx": 7}, {"type": "text", "text": "4.3 Long-Context Evaluation ", "text_level": 1, "page_idx": 7}, {"type": "text", "text": "Perplexity over Long Sequences To demonstrate the capability of MEGALODON to make use of very long contexts to improve next-token prediction, we start by conducting the evaluation of valid perplexity on different context lengths. Concretely, we construct a validation dataset which consists of 1,920 selected books. Each of these books contains sequences with at least 2M tokens. The validation dataset is constructed by first randomly shuffling all the files and then concatenating them. Figure 5 shows the perplexity (PPL) of the validation dataset in various context lengths ranging from 4K to 2M. We observe that the PPL decreases monotonically with context length, validating the effectivenss and robustness of MEGALODON on modeling extremely long sequences. ", "page_idx": 7}, {"type": "text", "text": "Long-Context QA tasks in Scrolls Next, we evaluate MEGALODON on long-context open-book question answering (QA) tasks in the Scrolls dataset (Shaham et al., 2022), including NarrativeQA (Ko\u02c7cisk\u00b4y et al., 2018), Qasper (Dasigi et al., 2021) and QMSum (Zhong et al., 2021). Following Xiong et al. (2023), we use a simple prompt $\\{{\\mathrm{CONTEXT}}\\}$ Q: {QUESTION} A: for all the tasks, and evaluate 0-shot F1-score on NarrativeQA, 2-shot F1-score on Qasper and 1-shot geometric-ROUGE3 on QMSum. Table 2 lists the results of MEGALODON-7B, together with other open-source long-context models in the scale of 7B, namely Xgen-7B-8K (Nijkamp et al., 2023), MPT-7B-8K (MosaicML, 2023), YaRN-7B-128k (Peng et al., 2024), LLAMA2-7B-4K (Touvron et al., 2023) and LLAMA2-7B-32K (LLAMA2-L, Xiong et al. (2023)). MEGALODON-7B obtains the best F1 on NarrativeQA, and competitive results with LLAMA2-7B Long. It should be noticed that LLAMA2-7B Long extends the context length of LLAMA2-7B from 4K to 32K by continually pretraining it on additional 500B tokens from long-context data. ", "page_idx": 7}, {"type": "text", "text": "4.4 Instruction Finetuning ", "text_level": 1, "page_idx": 7}, {"type": "text", "text": "To evaluation the generalization capability of MEGALODON on instruction following and alignment, We finetune the base model of MEGALODON-7B on a proprietary instruction-alignment data under a controlled setting. We did not apply any RLHF techniques to further finetune it. Table 3 summarizes the performance of chat models in 7B scale on MT-Bench4. MEGALODON exhibits superior performance on MT-Bench compared to Vicuna (Chiang et al., 2023), and comparable performance to ", "page_idx": 7}, {"type": "table", "img_path": "XlAbMZu4Bo/tmp/2f0da5f11b4001ea33a7d3d44921675d29149260309bb26f03c0901b903ef961.jpg", "table_caption": ["Table 3: MT Bench. Comparison of Chat models. \u2217LLAMA2-Chat utilizes RLHF. "], "table_footnote": [], "page_idx": 7}, {"type": "text", "text": "LLAMA2-Chat, which utilizes RLHF for further alignment finetuning. We present some outputs from instruction finetuned MEGALODON in Appendix D. ", "page_idx": 7}, {"type": "table", "img_path": "XlAbMZu4Bo/tmp/552bdbcb69609691a4776e300380ea2de245dfbac633274863b6f26ea1d663fb.jpg", "table_caption": ["Table 4: (ImageNet-1K) Top-1 accuracy. "], "table_footnote": [], "page_idx": 8}, {"type": "table", "img_path": "XlAbMZu4Bo/tmp/a305cafc1f68b0fb8158c965dd69c60dbe4f85b201cb2a78c15ee2f776189620.jpg", "table_caption": ["Table 5: (PG-19) Word-level perplexity. "], "table_footnote": [], "page_idx": 8}, {"type": "text", "text": "4.5 Evaluation on Medium-Scale Benchmarks ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "ImageNet Classification To evaluate MEGALODON on image classification task, we conduct experiments on the Imagenet-1K (Deng et al., 2009) dataset, which consists of 1.28M training images and 50K validation images from 1000 classes. We mostly follow DeiT\u2019s approach of applying several data augmentation and regularization methods that facilitate the training process, and adopt most the hyperparameters from Ma et al. (2023). For classification task, we replace the timestep normalization with the standard group normalization method. Top-1 accuracy on the validation set is reported in Table 4 to assess various models. MEGALODON obtains about $1.3\\%$ accuracy improvement over DeiT-B (Touvron et al., 2021), and $0.8\\%$ . improvement over MEGA (Ma et al., 2023). ", "page_idx": 8}, {"type": "text", "text": "Auto-regressive Language Modeling on PG-19 We also evaluate MEGALODON on auto-regressive language modeling on the medium-scale PG19 (Rae et al., 2019) datasets. We use the same vocabulary from Block-Recurrent Transformer (Hutchins et al., 2022) and adopt most of its hyper-parameters to train a MEGALODON model with 1.3B parameters. Table 5 illustrate the word-level perplexity (PPL) of MEGALODON on PG-19, together with previous state-of-the-art models, including Compressive Transformer (Rae et al., 2020), Perceiver AR (Hawthorne et al., 2022), Block-Recurrent Transformer (Hutchins et al., 2022) and MEGABYTE (Yu et al., 2024). MEGALODON significantly outperforms all the baselines. ", "page_idx": 8}, {"type": "text", "text": "5 Conclusion ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "We have introduced MEGALODON, an improved MEGA architecture with multiple novel technical components, including complex exponential moving average (CEMA), the timestep normalization layer, normalized attention and pre-norm with two-hop residual configuration, to improve its capability, efficiency and scalability. Through a direct comparison with LLAMA2, MEGALODON achieves impressive improvements on both training perplexity and across downstream benchmarks. Importantly, experimental results on long-context modeling demonstrate MEGALODON\u2019s ability to model sequences of unlimited length. Additional experiments on small/medium-scale benchmarks across different data modalities illustrate the robust improvements of MEGALODON, which lead to a potential direction of future work to apply MEGALODON for large-scale multi-modality pretraining. ", "page_idx": 8}, {"type": "text", "text": "Acknowledgments ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "We thank Sadhika Malladi, Zihao Ye, Dacheng Li and Rulin Shao for their helpful feedback and discussion during this work. ", "page_idx": 8}, {"type": "text", "text": "References ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "Jimmy Lei Ba, Jamie Ryan Kiros, and Geoffrey E Hinton. Layer normalization. arXiv preprint arXiv:1607.06450, 2016. ", "page_idx": 8}, {"type": "text", "text": "Alexei Baevski and Michael Auli. Adaptive input representations for neural language modeling. In International Conference on Learning Representations, 2018. ", "page_idx": 8}, {"type": "text", "text": "Yonatan Bisk, Rowan Zellers, Jianfeng Gao, Yejin Choi, et al. Piqa: Reasoning about physical commonsense in natural language. In Proceedings of the AAAI conference on artificial intelligence, pages 7432\u20137439, 2020. ", "page_idx": 8}, {"type": "text", "text": "Wei-Lin Chiang, Zhuohan Li, Zi Lin, Ying Sheng, Zhanghao Wu, Hao Zhang, Lianmin Zheng, Siyuan Zhuang, Yonghao Zhuang, Joseph E. Gonzalez, Ion Stoica, and Eric P. Xing. Vicuna: An open-source chatbot impressing gpt-4 with $90\\%^{*}$ chatgpt quality, March 2023. URL https: //lmsys.org/blog/2023-03-30-vicuna/.   \nChristopher Clark, Kenton Lee, Ming-Wei Chang, Tom Kwiatkowski, Michael Collins, and Kristina Toutanova. Boolq: Exploring the surprising difficulty of natural yes/no questions. arXiv preprint arXiv:1905.10044, 2019.   \nPeter Clark, Isaac Cowhey, Oren Etzioni, Tushar Khot, Ashish Sabharwal, Carissa Schoenick, and Oyvind Tafjord. Think you have solved question answering? try arc, the ai2 reasoning challenge. arXiv preprint arXiv:1803.05457, 2018.   \nJames W Cooley and John W Tukey. An algorithm for the machine calculation of complex fourier series. Mathematics of computation, 19(90):297\u2013301, 1965.   \nZihang Dai, Zhilin Yang, Yiming Yang, Jaime G Carbonell, Quoc Le, and Ruslan Salakhutdinov. Transformer-xl: Attentive language models beyond a fixed-length context. In Proceedings of the 57th Annual Meeting of the Association for Computational Linguistics, pages 2978\u20132988, 2019.   \nTri Dao. Flashattention-2: Faster attention with better parallelism and work partitioning. In International Conference on Learning Representations (ICLR-2024), 2024.   \nPradeep Dasigi, Kyle Lo, Iz Beltagy, Arman Cohan, Noah A. Smith, and Matt Gardner. A dataset of information-seeking questions and answers anchored in research papers. In Proceedings of the 2021 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies (NAACL-2021), pages 4599\u20134610, Online, June 2021. Association for Computational Linguistics.   \nJared Q Davis, Albert Gu, Krzysztof Choromanski, Tri Dao, Christopher Re, Chelsea Finn, and Percy Liang. Catformer: Designing stable transformers via sensitivity analysis. In International Conference on Machine Learning, pages 2489\u20132499. PMLR, 2021.   \nJia Deng, Wei Dong, Richard Socher, Li-Jia Li, Kai Li, and Li Fei-Fei. Imagenet: A large-scale hierarchical image database. In 2009 IEEE conference on computer vision and pattern recognition, pages 248\u2013255. Ieee, 2009.   \nDaniel Y Fu, Tri Dao, Khaled Kamal Saab, Armin W Thomas, Atri Rudra, and Christopher Re. Hungry hungry hippos: Towards language modeling with state space models. In The Eleventh International Conference on Learning Representations (ICLR-2023), 2023.   \nAlbert Gu and Tri Dao. Mamba: Linear-time sequence modeling with selective state spaces, 2023.   \nAlbert Gu, Karan Goel, and Christopher R\u00b4e. Efficiently modeling long sequences with structured state spaces. In International Conference on Learning Representations (ICLR-2022), 2022a.   \nAlbert Gu, Ankit Gupta, Karan Goel, and Christopher Re\u00b4. On the parameterization and initialization of diagonal state space models. arXiv preprint arXiv:2206.11893, 2022b.   \nStephen Hanson and Lorien Pratt. Comparing biases for minimal network construction with backpropagation. Advances in neural information processing systems, 1, 1988.   \nCurtis Hawthorne, Andrew Jaegle, C\u02d8at\u02d8alina Cangea, Sebastian Borgeaud, Charlie Nash, Mateusz Malinowski, Sander Dieleman, Oriol Vinyals, Matthew Botvinick, Ian Simon, et al. Generalpurpose, long-context autoregressive modeling with perceiver ar. In International Conference on Machine Learning, pages 8535\u20138558. PMLR, 2022.   \nDan Hendrycks, Collin Burns, Steven Basart, Andy Zou, Mantas Mazeika, Dawn Song, and Jacob Steinhardt. Measuring massive multitask language understanding. arXiv preprint arXiv:2009.03300, 2020.   \nAlex Henry, Prudhvi Raj Dachapally, Shubham Shantaram Pawar, and Yuxuan Chen. Query-key normalization for transformers. In Findings of the Association for Computational Linguistics: EMNLP 2020, pages 4246\u20134253, 2020. ", "page_idx": 9}, {"type": "text", "text": "Weizhe Hua, Zihang Dai, Hanxiao Liu, and Quoc Le. Transformer quality in linear time. In International Conference on Machine Learning (ICML-2022), pages 9099\u20139117. PMLR, 2022. ", "page_idx": 10}, {"type": "text", "text": "Yanping Huang, Youlong Cheng, Ankur Bapna, Orhan Firat, Dehao Chen, Mia Chen, HyoukJoong Lee, Jiquan Ngiam, Quoc V Le, Yonghui Wu, and zhifeng Chen. Gpipe: Efficient training of giant neural networks using pipeline parallelism. In Advances in Neural Information Processing Systems, volume 32. Curran Associates, Inc., 2019.   \nJ Stuart Hunter. The exponentially weighted moving average. Journal of quality technology, 18(4): 203\u2013210, 1986.   \nDeLesley Hutchins, Imanol Schlag, Yuhuai Wu, Ethan Dyer, and Behnam Neyshabur. Block-recurrent transformers. Advances in neural information processing systems, 35:33248\u201333261, 2022.   \nSergey Ioffe and Christian Szegedy. Batch normalization: Accelerating deep network training by reducing internal covariate shift. In International conference on machine learning (ICML-2015), pages 448\u2013456. pmlr, 2015.   \nAlbert Q Jiang, Alexandre Sablayrolles, Arthur Mensch, Chris Bamford, Devendra Singh Chaplot, Diego de las Casas, Florian Bressand, Gianna Lengyel, Guillaume Lample, Lucile Saulnier, et al. Mistral 7b. arXiv preprint arXiv:2310.06825, 2023.   \nMandar Joshi, Eunsol Choi, Daniel Weld, and Luke Zettlemoyer. Triviaqa: A large scale distantly supervised challenge dataset for reading comprehension. In Proceedings of the 55th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers). Association for Computational Linguistics, 2017.   \nWilliam Kahan. Pracniques: further remarks on reducing truncation errors. Communications of the ACM, 8(1):40, 1965.   \nTom\u00b4a\u02c7s Ko\u02c7cisk\u00b4y, Jonathan Schwarz, Phil Blunsom, Chris Dyer, Karl Moritz Hermann, G\u00b4abor Melis, and Edward Grefenstette. The NarrativeQA reading comprehension challenge. Transactions of the Association for Computational Linguistics, 6:317\u2013328, 2018.   \nAlex Krizhevsky et al. Learning multiple layers of features from tiny images. Technical Report. University of Toronto, 2009.   \nTom Kwiatkowski, Jennimaria Palomaki, Olivia Redfield, Michael Collins, Ankur Parikh, Chris Alberti, Danielle Epstein, Illia Polosukhin, Jacob Devlin, Kenton Lee, et al. Natural questions: a benchmark for question answering research. Transactions of the Association for Computational Linguistics, 7:453\u2013466, 2019.   \nBonan Li, Yinhan Hu, Xuecheng Nie, Congying Han, Xiangjian Jiang, Tiande Guo, and Luoqi Liu. Dropkey for vision transformer. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR), pages 22700\u201322709, June 2023a.   \nDacheng Li, Rulin Shao, Anze Xie, Eric P Xing, Joseph E Gonzalez, Ion Stoica, Xuezhe Ma, and Hao Zhang. Lightseq:: Sequence level parallelism for distributed training of long context transformers. In Workshop on Advancing Neural Network Training: Computational Efficiency, Scalability, and Resource Optimization (WANT@ NeurIPS 2023), 2023b.   \nYuhong Li, Tianle Cai, Yi Zhang, Deming Chen, and Debadeepta Dey. What makes convolutional models great on long sequence modeling? In International Conference on Learning Representations (ICLR-2023), 2023c.   \nDrew Linsley, Junkyung Kim, Vijay Veerabadran, Charles Windolf, and Thomas Serre. Learning long-range spatial dependencies with horizontal gated recurrent units. In S. Bengio, H. Wallach, H. Larochelle, K. Grauman, N. Cesa-Bianchi, and R. Garnett, editors, Advances in Neural Information Processing Systems, volume 31. Curran Associates, Inc., 2018.   \nHao Liu, Matei Zaharia, and Pieter Abbeel. Ring attention with blockwise transformers for nearinfinite context. In International Conference on Learning Representations (ICLR-2024), 2024. ", "page_idx": 10}, {"type": "text", "text": "Ze Liu, Han Hu, Yutong Lin, Zhuliang Yao, Zhenda Xie, Yixuan Wei, Jia Ning, Yue Cao, Zheng Zhang, Li Dong, et al. Swin transformer v2: Scaling up capacity and resolution. In Proceedings of the IEEE/CVF conference on computer vision and pattern recognition, pages 12009\u201312019, 2022. ", "page_idx": 11}, {"type": "text", "text": "Ilya Loshchilov and Frank Hutter. Decoupled weight decay regularization. In International Conference on Learning Representations, 2019.   \nChunjie Luo, Jianfeng Zhan, Xiaohe Xue, Lei Wang, Rui Ren, and Qiang Yang. Cosine normalization: Using cosine similarity instead of dot product in neural networks. In 27th International Conference on Artificial Neural Networks (ICANN-2018), pages 382\u2013391. Springer, 2018.   \nXuezhe Ma, Xiang Kong, Sinong Wang, Chunting Zhou, Jonathan May, Hao Ma, and Luke Zettlemoyer. Luna: Linear unified nested attention. Advances in Neural Information Processing Systems, 34:2441\u20132453, 2021.   \nXuezhe Ma, Chunting Zhou, Xiang Kong, Junxian He, Liangke Gui, Graham Neubig, Jonathan May, and Luke Zettlemoyer. Mega: Moving average equipped gated attention. In The Eleventh International Conference on Learning Representations, 2023.   \nAndrew Maas, Raymond E Daly, Peter T Pham, Dan Huang, Andrew $\\mathbf{Y}~\\mathbf{Ng}.$ , and Christopher Potts. Learning word vectors for sentiment analysis. In Proceedings of the 49th annual meeting of the association for computational linguistics: Human language technologies, pages 142\u2013150, 2011. ", "page_idx": 11}, {"type": "text", "text": "Stephen Merity, Caiming Xiong, James Bradbury, and Richard Socher. Pointer sentinel mixture models. In International Conference on Learning Representations (ICLR-2017), 2017. ", "page_idx": 11}, {"type": "text", "text": "Thomas Mesnard, Cassidy Hardin, Robert Dadashi, Surya Bhupatiraju, Shreya Pathak, Laurent Sifre, Morgane Rivi\\`ere, Mihir Sanjay Kale, Juliette Love, Pouya Tafti, L\u00b4eonard Hussenot, Aakanksha Chowdhery, Adam Roberts, Aditya Barua, Alex Botev, Alex Castro-Ros, Ambrose Slone, Ame\u00b4lie H\u00b4eliou, Andrea Tacchetti, Anna Bulanova, Antonia Paterson, Beth Tsai, Bobak Shahriari, Charline Le Lan, Christopher A. Choquette-Choo, Cle\u00b4ment Crepy, Daniel Cer, Daphne Ippolito, David Reid, Elena Buchatskaya, Eric Ni, Eric Noland, Geng Yan, George Tucker, George-Christian Muraru, Grigory Rozhdestvenskiy, Henryk Michalewski, Ian Tenney, Ivan Grishchenko, Jacob Austin, James Keeling, Jane Labanowski, Jean-Baptiste Lespiau, Jeff Stanway, Jenny Brennan, Jeremy Chen, Johan Ferret, Justin Chiu, Justin Mao-Jones, Katherine Lee, Kathy Yu, Katie Millican, Lars Lowe Sjoesund, Lisa Lee, Lucas Dixon, Machel Reid, Maciej Miku\u0142a, Mateo Wirth, Michael Sharman, Nikolai Chinaev, Nithum Thain, Olivier Bachem, Oscar Chang, Oscar Wahltinez, Paige Bailey, Paul Michel, Petko Yotov, Pier Giuseppe Sessa, Rahma Chaabouni, Ramona Comanescu, Reena Jana, Rohan Anil, Ross McIlroy, Ruibo Liu, Ryan Mullins, Samuel L Smith, Sebastian Borgeaud, Sertan Girgin, Sholto Douglas, Shree Pandya, Siamak Shakeri, Soham De, Ted Klimenko, Tom Hennigan, Vlad Feinberg, Wojciech Stokowiec, Yu hui Chen, Zafarali Ahmed, Zhitao Gong, Tris Warkentin, Ludovic Peran, Minh Giang, Cl\u00b4ement Farabet, Oriol Vinyals, Jeff Dean, Koray Kavukcuoglu, Demis Hassabis, Zoubin Ghahramani, Douglas Eck, Joelle Barral, Fernando Pereira, Eli Collins, Armand Joulin, Noah Fiedel, Evan Senter, Alek Andreev, and Kathleen Kenealy. Gemma: Open models based on gemini research and technology, 2024. ", "page_idx": 11}, {"type": "text", "text": "MosaicML. Introducing mpt-7b: A new standard for open-source, commercially usable llms, 2023. ", "page_idx": 11}, {"type": "text", "text": "Nikita Nangia and Samuel Bowman. Listops: A diagnostic dataset for latent tree learning. In Proceedings of the 2018 Conference of the North American Chapter of the Association for Computational Linguistics: Student Research Workshop, pages 92\u201399, 2018.   \nErik Nijkamp, Tian Xie, Hiroaki Hayashi, Bo Pang, Congying Xia, Chen Xing, Jesse Vig, Semih Yavuz, Philippe Laban, Ben Krause, Senthil Purushwalkam, Tong Niu, Wojciech Krys\u00b4cin\u00b4ski, Lidiya Murakhovs\u2019ka, Prafulla Kumar Choubey, Alex Fabbri, Ye Liu, Rui Meng, Lifu Tu, Meghana Bhat, Chien-Sheng Wu, Silvio Savarese, Yingbo Zhou, Shafiq Joty, and Caiming Xiong. Xgen-7b technical report, 2023.   \nEmilio Parisotto, Francis Song, Jack Rae, Razvan Pascanu, Caglar Gulcehre, Siddhant Jayakumar, Max Jaderberg, Raphael Lopez Kaufman, Aidan Clark, Seb Noury, et al. Stabilizing transformers for reinforcement learning. In International conference on machine learning, pages 7487\u20137498. PMLR, 2020.   \nAdam Paszke, Sam Gross, Francisco Massa, Adam Lerer, James Bradbury, Gregory Chanan, Trevor Killeen, Zeming Lin, Natalia Gimelshein, Luca Antiga, et al. Pytorch: An imperative style, high-performance deep learning library. Advances in neural information processing systems, 32, 2019.   \nBo Peng, Eric Alcaide, Quentin Anthony, Alon Albalak, Samuel Arcadinho, Huanqi Cao, Xin Cheng, Michael Chung, Matteo Grella, Kranthi Kiran GV, et al. Rwkv: Reinventing rnns for the transformer era. arXiv preprint arXiv:2305.13048, 2023.   \nBowen Peng, Jeffrey Quesnelle, Honglu Fan, and Enrico Shippole. YaRN: Efficient context window extension of large language models. In International Conference on Learning Representations (ICLR-2024), 2024.   \nMichael Poli, Stefano Massaroli, Eric Nguyen, Daniel Y Fu, Tri Dao, Stephen Baccus, Yoshua Bengio, Stefano Ermon, and Christopher R\u00b4e. Hyena hierarchy: Towards larger convolutional language models. In International conference on machine learning (ICML-2023). PMLR, 2023.   \nDragomir R Radev, Pradeep Muthukrishnan, Vahed Qazvinian, and Amjad Abu-Jbara. The acl anthology network corpus. Language Resources and Evaluation, 47(4):919\u2013944, 2013.   \nJack W Rae, Anna Potapenko, Siddhant M Jayakumar, Chloe Hillier, and Timothy P Lillicrap. Compressive transformers for long-range sequence modelling. arXiv preprint, 2019. URL https://arxiv.org/abs/1911.05507.   \nJack W Rae, Anna Potapenko, Siddhant M Jayakumar, Chloe Hillier, and Timothy P Lillicrap. Compressive transformers for long-range sequence modeling. In International Conference on Learning Representations (ICLR-2020), 2020.   \nPrajit Ramachandran, Barret Zoph, and Quoc V Le. Swish: a self-gated activation function. arXiv preprint arXiv:1710.05941, 7(1):5, 2017.   \nKeisuke Sakaguchi, Ronan Le Bras, Chandra Bhagavatula, and Yejin Choi. Winogrande: An adversarial winograd schema challenge at scale. Communications of the ACM, 64(9):99\u2013106, 2021.   \nMaarten Sap, Hannah Rashkin, Derek Chen, Ronan LeBras, and Yejin Choi. Socialiqa: Commonsense reasoning about social interactions. arXiv preprint arXiv:1904.09728, 2019.   \nUri Shaham, Elad Segal, Maor Ivgi, Avia Efrat, Ori Yoran, Adi Haviv, Ankit Gupta, Wenhan Xiong, Mor Geva, Jonathan Berant, and Omer Levy. SCROLLS: Standardized CompaRison over long language sequences. In Yoav Goldberg, Zornitsa Kozareva, and Yue Zhang, editors, Proceedings of the 2022 Conference on Empirical Methods in Natural Language Processing (EMNLP-2022), pages 12007\u201312021, Abu Dhabi, United Arab Emirates, December 2022. Association for Computational Linguistics.   \nNoam Shazeer. Glu variants improve transformer. arXiv preprint arXiv:2002.05202, 2020.   \nMohammad Shoeybi, Mostofa Patwary, Raul Puri, Patrick LeGresley, Jared Casper, and Bryan Catanzaro. Megatron-lm: Training multi-billion parameter language models using model parallelism. arXiv preprint arXiv:1909.08053, 2019.   \nJianlin Su, Yu Lu, Shengfeng Pan, Bo Wen, and Yunfeng Liu. Roformer: Enhanced transformer with rotary position embedding. arXiv preprint arXiv:2104.09864, 2021.   \nYi Tay, Mostafa Dehghani, Dara Bahri, and Donald Metzler. Efficient transformers: A survey. arXiv preprint arXiv:2009.06732, 2020.   \nYi Tay, Mostafa Dehghani, Samira Abnar, Yikang Shen, Dara Bahri, Philip Pham, Jinfeng Rao, Liu Yang, Sebastian Ruder, and Donald Metzler. Long range arena : A benchmark for efficient transformers. In International Conference on Learning Representations, 2021. URL https: //openreview.net/forum?id=qVyeW-grC2k.   \nYi Tay, Mostafa Dehghani, Samira Abnar, Hyung Won Chung, William Fedus, Jinfeng Rao, Sharan Narang, Vinh Q. Tran, Dani Yogatama, and Donald Metzler. Scaling laws vs model architectures: How does inductive bias influence scaling?, 2022.   \nHugo Touvron, Matthieu Cord, Matthijs Douze, Francisco Massa, Alexandre Sablayrolles, and Herve\u00b4 Je\u00b4gou. Training data-efficient image transformers & distillation through attention. In International Conference on Machine Learning, pages 10347\u201310357. PMLR, 2021.   \nHugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale, et al. Llama 2: Open foundation and fine-tuned chat models. arXiv preprint arXiv:2307.09288, 2023.   \nAshish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N Gomez, \u0141 ukasz Kaiser, and Illia Polosukhin. Attention is all you need. In Advances in Neural Information Processing Systems, volume 30. Curran Associates, Inc., 2017.   \nXindi Wang, Mahsa Salmani, Parsa Omidi, Xiangyu Ren, Mehdi Rezagholizadeh, and Armaghan Eshaghi. Beyond the limits: A survey of techniques to extend the context length in large language models, 2024.   \nPete Warden. Speech commands: A dataset for limited-vocabulary speech recognition. arXiv preprint arXiv:1804.03209, 2018.   \nB. P. Welford. Note on a method for calculating corrected sums of squares and products. Technometrics, 4(3):419\u2013420, 1962.   \nYuxin Wu and Kaiming He. Group normalization. In Proceedings of the European conference on computer vision (ECCV-2018), pages 3\u201319, 2018.   \nRuibin Xiong, Yunchang Yang, Di He, Kai Zheng, Shuxin Zheng, Chen Xing, Huishuai Zhang, Yanyan Lan, Liwei Wang, and Tieyan Liu. On layer normalization in the transformer architecture. In International Conference on Machine Learning, pages 10524\u201310533. PMLR, 2020.   \nWenhan Xiong, Jingyu Liu, Igor Molybog, Hejia Zhang, Prajjwal Bhargava, Rui Hou, Louis Martin, Rashi Rungta, Karthik Abinav Sankararaman, Barlas Oguz, et al. Effective long-context scaling of foundation models. arXiv preprint arXiv:2309.16039, 2023.   \nHongfei Xu, Qiuhui Liu, Deyi Xiong, and Josef van Genabith. Transformer with depth-wise lstm. arXiv preprint arXiv:2007.06257, 2020.   \nLili Yu, D\u00b4aniel Simig, Colin Flaherty, Armen Aghajanyan, Luke Zettlemoyer, and Mike Lewis. Megabyte: Predicting million-byte sequences with multiscale transformers. Advances in Neural Information Processing Systems, 36, 2024.   \nRowan Zellers, Ari Holtzman, Yonatan Bisk, Ali Farhadi, and Yejin Choi. Hellaswag: Can a machine really finish your sentence? In Proceedings of the 57th Annual Meeting of the Association for Computational Linguistics (ACL-2019). Association for Computational Linguistics, 2019.   \nBiao Zhang and Rico Sennrich. Root mean square layer normalization. Advances in Neural Information Processing Systems, 32, 2019.   \nMing Zhong, Da Yin, Tao Yu, Ahmad Zaidi, Mutethia Mutuma, Rahul Jha, Ahmed Hassan Awadallah, Asli Celikyilmaz, Yang Liu, Xipeng Qiu, and Dragomir Radev. QMSum: A new benchmark for query-based multi-domain meeting summarization. In Proceedings of the 2021 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies (NAACL-2021), pages 5905\u20135921, Online, June 2021. Association for Computational Linguistics.   \nYongchao Zhou, Uri Alon, Xinyun Chen, Xuezhi Wang, Rishabh Agarwal, and Denny Zhou. Transformers can achieve length generalization but not robustly, 2024. ", "page_idx": 11}, {"type": "text", "text": "", "page_idx": 12}, {"type": "text", "text": "", "page_idx": 13}, {"type": "text", "text": "Appendix: MEGALODON: Efficient Long-Context LLM Pretraining and Inference with Unlimited Context Length ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "A Background: Moving Average Equipped Gated Attention ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "In the gated attention mechanism in MEGA, the output from EMA (1) is used to compute the shared representation (Hua et al., 2022) $Z$ : ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\begin{array}{l}{{\\displaystyle{\\cal X}^{\\prime}=\\mathrm{EMA}({\\cal X})}}\\\\ {{\\displaystyle{\\cal Z}=\\phi_{\\mathrm{silu}}({\\cal X}^{\\prime}W_{z}+b_{z})}}\\end{array}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "equation", "text": "$$\n\\begin{array}{l}{\\in\\mathbb{R}^{n\\times d}}\\\\ {\\in\\mathbb{R}^{n\\times z}}\\end{array}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "where $X^{\\prime}$ can be regarded as the updated or contextual input, because it encodes contextual information through EMA. Then, the query and key sequences are computed by applying per-dimension scalars and offsets to $_{z}$ , and the value sequence is from the original $\\mathbf{\\deltaX}$ : ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{Q=\\kappa_{q}\\odot Z+\\mu_{q}}\\\\ &{K=\\kappa_{k}\\odot Z+\\mu_{k}}\\\\ &{V=\\phi_{\\mathrm{silu}}(X W_{v}+b_{v})}\\end{array}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\in\\mathbb{R}^{n\\times z}}\\\\ &{\\in\\mathbb{R}^{n\\times z}}\\\\ &{\\in\\mathbb{R}^{n\\times v}}\\end{array}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "where $\\kappa_{q},\\mu_{q},\\kappa_{k},\\mu_{k}\\in\\mathbb{R}^{z}$ are the learnable scalars and offsets of queries and keys, respectively. $v$ is the expanded intermediate dimension for the value sequence. The output of attention is computed as follows: ", "page_idx": 14}, {"type": "equation", "text": "$$\nO=f\\left(\\frac{Q K^{T}}{\\tau(X)}\\right)V\n$$", "text_format": "latex", "page_idx": 14}, {"type": "equation", "text": "$$\n\\in\\mathbb{R}^{n\\times v}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "Subsequently, MEGA introduces the reset gate $\\gamma$ , the update gate $\\varphi$ , and computes the candidate activation $\\hat{H}$ and final output $\\mathbf{Y}$ : ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\gamma=\\phi_{\\mathrm{silu}}(X^{\\prime}W_{\\gamma}+b_{\\gamma})}\\\\ &{\\varphi=\\phi_{\\mathrm{sigmoid}}(X^{\\prime}W_{\\varphi}+b_{\\varphi})}\\\\ &{\\hat{H}=\\phi_{\\mathrm{silu}}(X^{\\prime}W_{h}+(\\gamma\\odot O)U_{h}+b_{h})}\\\\ &{Y=\\varphi\\odot\\hat{H}+(1-\\varphi)\\odot X}\\end{array}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\in\\mathbb{R}^{n\\times v}}\\\\ &{\\in\\mathbb{R}^{n\\times d}}\\\\ &{\\in\\mathbb{R}^{n\\times d}}\\\\ &{\\in\\mathbb{R}^{n\\times d}}\\end{array}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "with the update gate $\\varphi$ and the residual connection $\\mathbf{\\deltaX}$ ", "page_idx": 14}, {"type": "text", "text": "B Implementation Details ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "B.1 Efficient Fused CUDA Operators Implementation ", "text_level": 1, "page_idx": 14}, {"type": "text", "text": "Fused Attention We implemented a fused attention operator to improve the efficiency, mainly by fusing the causal mask, softmax function and dropout operation (if necessary). The fused implementation reduces the IO costs from global memory for the attention weight. For attention dropout, we adopt the dropout-before-softmax scheme in DropKey (Li et al., 2023a), which applies the dropout mask on the input attention matrix of the softmax function. Concretely, we flil the values of the attention matrix at dropout mask positions to $-\\infty$ before feeding it into the softmax function. One important advantage of this dropout-before-softmax scheme comparing to the standard attention dropout is that the computation of the gradients in back-propagation is independent with the applied dropout mask. ", "page_idx": 14}, {"type": "text", "text": "Efficient FFTConv We also provide an efficient fused implementation of the FFTConv operator. Similar with the FlashConv in H3 (Fu et al., 2023), we fused the real number FFT (RFFT), its inverse (IRFFT) and implemented the Cooley-Tukey FFT algorithm (Cooley and Tukey, 1965) in the CUDA shared memory. Similar with the FlashConv in H3 (Fu et al., 2023), we fused the real number FFT (RFFT), its inverse (IRFFT) and the element-wise multiplication, and implemented the Cooley-Tukey FFT algorithm (Cooley and Tukey, 1965) in CUDA\u2019s shared memory. Our implementation is able to accommodate up to 16K tokens in the limited shared memory of an A100 GPU. ", "page_idx": 14}, {"type": "table", "img_path": "XlAbMZu4Bo/tmp/76cff43219eaccc28bb028b7faa778bbcfd3b9812f20acfe5ad702c7f3f6be78.jpg", "table_caption": ["Table 6: (Long Range Arena) Accuracy on the full suite of long range arena (LRA) tasks. Results of previous models are reported in Ma et al. (2023). "], "table_footnote": [], "page_idx": 15}, {"type": "text", "text": "Timestep Normalization For the TimestepNorm operator, we have an efficient implementation to improve both its speed and numerical stability. To compute the cumulative mean and variance for each of the timesteps, our implementation distributed the threads in each CUDA block in both the timestep/sequence dimension and the feature dimension to balance the parallelism of the algorithm and the performance of the global memory access. To improve numerical stability, we used the Welford algorithm (Welford, 1962) to compute the cumulative mean and variance and the Kahan Summation (Kahan, 1965) to reduce the numerical error from summation. ", "page_idx": 15}, {"type": "text", "text": "B.2 Plus 1 Reparameterization in Normalization Layers ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "In the normalization methods, two learnable parameters $\\gamma$ and $\\beta$ are introduced to scale and shift the normalized value: ", "page_idx": 15}, {"type": "equation", "text": "$$\ny=\\gamma{\\frac{x-\\mu}{\\sigma}}+\\beta\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "where $\\mu$ and $\\sigma^{2}$ are the mean and variance of the input $x$ across the pre-defined dimensions. Initialization of $\\gamma$ and $\\beta$ is crucial for model performance and stability. The standard implementation of normalization layers, such as PyTorch (Paszke et al., 2019), initializes $\\gamma$ and $\\beta$ to vectors of ones and zeros, respectively, to preserve the mean and variance of the normalized inputs at the beginning of training. ", "page_idx": 15}, {"type": "text", "text": "This standard implementation, however, suffers a problem when weight decay regularization is applied to prevent overftiting (Hanson and Pratt, 1988). Technically, the weight decay regularization pushes the values of model parameters towards smaller magnitudes. In the context of normalization methods, weight decay pushes the values in $\\gamma$ towards zero, which diverges from its initialization of one. This may prevent the model from learning the true scale of the data distribution, and may cause numerical stability issues as well. ", "page_idx": 15}, {"type": "text", "text": "To address this problem, we used the plus $^{\\,I}$ reparameterization5 of the scale parameter $\\gamma$ : ", "page_idx": 15}, {"type": "equation", "text": "$$\ny=(\\gamma+1)\\frac{x-\\mu}{\\sigma}+\\beta\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "where $\\gamma$ is initialized to zero. Under weight decay, $\\gamma$ remains centered around zero, resulting in a desirable scale of $\\gamma+1$ around one. ", "page_idx": 15}, {"type": "text", "text": "C Experiments on Small-Scale Benchmarks ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "We conducted small-scale experiments on five benchmarks across various data modalities, including text, audio and image. To demonstrate the robustness of the MEGALODON architecture on different tasks and data types, we used a single unified architecture with minimal architectural divergence in all the experiments: softmax attention function, rotary postional embedding, pre-norm with two-hop residual, and timestep Normalization (Group Normalization for classification). We adopt (almost) all the architectural and training hyperparameters from the corresponding experiments of the original MEGA (Ma et al., 2023). ", "page_idx": 15}, {"type": "table", "img_path": "XlAbMZu4Bo/tmp/6649818dc0b4b8d384cd87ea0ab4e6b04df3efe848fcb25c20c51ddc776c3339.jpg", "table_caption": ["Table 7: (SC-Raw) Accuracy. "], "table_footnote": [], "page_idx": 16}, {"type": "table", "img_path": "XlAbMZu4Bo/tmp/36723781bf3de6b814927a5da93d511ffa52b15dc01d960d6181e929c1798210.jpg", "table_caption": ["Table 8: (WikiText-103) Word-level PPL "], "table_footnote": [], "page_idx": 16}, {"type": "text", "text": "", "page_idx": 16}, {"type": "text", "text": "C.1 Long Range Arena (LRA) ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "Long Range Arena (LRA) benchmark (Tay et al., 2021) is designed for evaluating sequence models under the long-context scenario. They collect six tasks in this benchmark which are ListOps (Nangia and Bowman, 2018), byte-level text classification (Text; Maas et al. (2011)), byte-level document retrieval (Retrieval; Radev et al. (2013)), image classification on sequences of pixels (Image; Krizhevsky et al. (2009)), Pathfinder (Linsley et al., 2018) and its extreme long version (Path-X; Tay et al. (2021)). These tasks consist of input sequences ranging from 1K to 16K tokens and span across a variety of data types and modalities. ", "page_idx": 16}, {"type": "text", "text": "Table 6 compares MEGALODON against several baselines, including Transformer and its efficient variants, the state space model S4 (Gu et al., 2022a), and the original MEGA model. Following Ma et al. (2023), we also evaluate MEGALODON-chunk on each task, by setting the chunk size $c=128$ for all the tasks, except Path-X where $c=4096$ . With chunk-wise attention, MEGALODON-chunk substantially outperforms MEGA-chunk on all the six tasks. In addition, MEGALODON significantly narrows the gap between chunk-wise attention and full attention. ", "page_idx": 16}, {"type": "text", "text": "C.2 Raw Speech Classification ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "To evaluate the capability of MEGALODON on the long-range modeling of speech signals, we apply MEGALODON to classify raw speech (with length 16000), rather than using traditional preprocessing (e.g. convert to MFCC features). Following Ma et al. (2023), we perform speech classification on the SC10 subset of the Speech Commands dataset (Warden, 2018), and set attention chunk size $c=1000$ . As shown in Table 7, our MEGALODON model with 300K parameters achieves an accuracy of 98.14, which is significantly better than 97.50 from S4 and 96.92 from MEGA with similar model size. ", "page_idx": 16}, {"type": "text", "text": "C.3 Auto-regressive Language Modeling ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "We also evaluate MEGALODON on auto-regressive language modeling on the small-scale WikiText103 (Merity et al., 2017) datasets. Following Baevski and Auli (2018), we adopt adaptive softmax and input embeddings and use a vocabulary of 260K tokens for WikiText-103 and train a MEGALODON model with about 250M parameters with attention chunk size $c=2048$ . Table 8 illustrate the wordlevel perplexity (PPL) of MEGALODON on WikiText-103, together with previous state-of-the-art models, including Transformer (Baevski and Auli, 2018), Transformer-XL (Dai et al., 2019), S4 (Gu et al., 2022a) and MEGA (Ma et al., 2023). MEGALODON significantly outperforms all the baselines on both the two datasets. ", "page_idx": 16}, {"type": "text", "text": "D Model Outputs from Instruction-finetuned MEGALODON ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "What is the central dogma of molecular biology? What processes are involved? Who named this? ", "page_idx": 17}, {"type": "text", "text": "The central dogma of molecular biology describes the flow of genetic information from DNA to RNA to proteins. The three processes involved in the central dogma are transcription, translation, and translocation.   \nThe central dogma was first proposed by Francis Crick, James Watson, and Maurice Wilkins in the 1950s, and was later formalized by Crick in a 1958 paper titled \u201dOn the Central Dogma of Molecular Biology\u201d. The term \u201dcentral dogma\u201d was coined by Crick to describe the flow of genetic information from DNA to RNA to proteins. ", "page_idx": 17}, {"type": "text", "text": "Identify and fix one incorrect fact in your previous response. ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "The correct name of the person who proposed the central dogma of molecular biology is James Watson, not Maurice Wilkins. James Watson, along with Francis Crick, first proposed the central dogma in the 1950s, and Maurice Wilkins was a co-recipient of the Nobel Prize in Physiology or Medicine in 1962 for his contributions to the discovery of the double helix structure of DNA. ", "page_idx": 17}, {"type": "text", "text": "Act as a math teacher. I will provide some mathematical equations or concepts, and it will be your job to explain them in easy-to-understand terms. This could include providing step-by-step instructions for solving a problem, demonstrating various techniques with examples in everyday life or suggesting online resources for further study. My first request is \u201dI need help understanding how probability works.\u201d ", "page_idx": 17}, {"type": "text", "text": "Probability is a branch of mathematics that deals with the likelihood of an event occurring. It is often expressed as a number between 0 and 1, where 0 represents an impossible event and 1 represents a certain event. ", "page_idx": 17}, {"type": "text", "text": "For example, if you were to roll a fair six-sided die, the probability of rolling a 1 would be 1/6, or about $17\\%$ . This is because there is only one way for the die to land on a 1 out of the six possible outcomes.   \nTo calculate probability, you can use the formula:   \nProbability $=$ Number of ways the event can occur / Total number of possible outcomes   \nFor example, if you were to ask \u201dWhat is the probability of filpping heads on a fair coin toss?\u201d, the answer would be $1/2$ , or $50\\%$ . This is because there is only one way for the coin to land heads-up out of the two possible outcomes (heads or tails).   \nThere are many different ways to interpret probability, and it can be used in a variety of real-world applications such as gambling, insurance, and statistics.   \nI hope this helps to give you a basic understanding of probability. Let me know if you have any questions or need further clarification. ", "page_idx": 17}, {"type": "text", "text": "What are the differences between Riemannian geometry and euclidean geometry? ", "page_idx": 17}, {"type": "text", "text": "Riemannian geometry and Euclidean geometry are both branches of mathematics that study the properties of space, but they differ in their assumptions and methods.   \nEuclidean geometry is based on the assumption that the space is flat and flat Euclidean space is the simplest non-empty connected flat metric space. It studies the properties of space using concepts such as distance, angle, and parallelism. It is named after the Greek mathematician Euclid, who developed the foundations of the field in his book \u201dElements\u201d. ", "page_idx": 17}, {"type": "text", "text": "Riemannian geometry, on the other hand, is based on the assumption that the space is curved. It studies the properties of space using concepts such as distance, angle, and parallelism, but in a more general setting, and it is named after the German mathematician Bernhard Riemann. ", "page_idx": 17}, {"type": "text", "text": "In Riemannian geometry, the concept of a metric is used to measure the distance between two points in a curved space. A metric is a mathematical function that assigns a distance to each segment in a space. The most common metric in Riemannian geometry is the distance function induced by a Riemannian metric, which is a mathematical function that assigns a distance to each segment in a space. In summary, Euclidean geometry is a special case of Riemannian geometry, where the metric is the flat Euclidean metric. Riemannian geometry is a more general field that studies the properties of curved spaces, and it is used in many areas of mathematics, physics and other sciences. ", "page_idx": 17}, {"type": "text", "text": "I hope this helps to give you a basic understanding of the differences between Riemannian geometry and Euclidean geometry. Let me know if you have any questions or need further clarification. ", "page_idx": 17}, {"type": "text", "text": "Evaluate the following movie reviews on a scale of 1 to 5, with 1 being very negative, 3 being neutral, and 5 being very positive: 1. This movie released on Nov. 18, 2019, was phenomenal. The cinematography, the acting, the plot - everything was top-notch. 2. Never before have I been so disappointed with a movie. The plot was predictable and the characters were one-dimensional. In my opinion, this movie is the worst one to have been released in 2022. 3. The movie was okay. There were some parts I enjoyed, but there were also parts that felt lackluster. This is a movie that was released in Feb 2018 and seems to be quite ordinary. Return the answer as a JSON array of integers. ", "page_idx": 17}, {"type": "text", "text": "Update your previous reply by including the release date as part of the JSON content. ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "{\"release_date\": \"Nov 18, 2019\", \"rating\": 5}, {\"release_date\": \"2022\", \"rating\": 1}, {\"release_date\": \"Feb 2018\", \"rating\": 3} ] ", "page_idx": 17}, {"type": "text", "text": "NeurIPS Paper Checklist ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "1. Claims ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Question: Do the main claims made in the abstract and introduction accurately reflect the paper\u2019s contributions and scope? ", "page_idx": 18}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 18}, {"type": "text", "text": "Justification: see the abstract ", "page_idx": 18}, {"type": "text", "text": "Guidelines: ", "page_idx": 18}, {"type": "text", "text": "\u2022 The answer NA means that the abstract and introduction do not include the claims made in the paper.   \n\u2022 The abstract and/or introduction should clearly state the claims made, including the contributions made in the paper and important assumptions and limitations. A No or NA answer to this question will not be perceived well by the reviewers.   \n\u2022 The claims made should match theoretical and experimental results, and reflect how much the results can be expected to generalize to other settings.   \n\u2022 It is fine to include aspirational goals as motivation as long as it is clear that these goals are not attained by the paper. ", "page_idx": 18}, {"type": "text", "text": "2. Limitations ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Question: Does the paper discuss the limitations of the work performed by the authors? ", "page_idx": 18}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Guidelines: ", "page_idx": 18}, {"type": "text", "text": "\u2022 The answer NA means that the paper has no limitation while the answer No means that the paper has limitations, but those are not discussed in the paper.   \n\u2022 The authors are encouraged to create a separate \u201dLimitations\u201d section in their paper.   \n\u2022 The paper should point out any strong assumptions and how robust the results are to violations of these assumptions (e.g., independence assumptions, noiseless settings, model well-specification, asymptotic approximations only holding locally). The authors should reflect on how these assumptions might be violated in practice and what the implications would be.   \n\u2022 The authors should reflect on the scope of the claims made, e.g., if the approach was only tested on a few datasets or with a few runs. In general, empirical results often depend on implicit assumptions, which should be articulated.   \n\u2022 The authors should reflect on the factors that influence the performance of the approach. For example, a facial recognition algorithm may perform poorly when image resolution is low or images are taken in low lighting. Or a speech-to-text system might not be used reliably to provide closed captions for online lectures because it fails to handle technical jargon.   \n\u2022 The authors should discuss the computational efficiency of the proposed algorithms and how they scale with dataset size.   \n\u2022 If applicable, the authors should discuss possible limitations of their approach to address problems of privacy and fairness.   \n\u2022 While the authors might fear that complete honesty about limitations might be used by reviewers as grounds for rejection, a worse outcome might be that reviewers discover limitations that aren\u2019t acknowledged in the paper. The authors should use their best judgment and recognize that individual actions in favor of transparency play an important role in developing norms that preserve the integrity of the community. Reviewers will be specifically instructed to not penalize honesty concerning limitations. ", "page_idx": 18}, {"type": "text", "text": "3. Theory Assumptions and Proofs ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Question: For each theoretical result, does the paper provide the full set of assumptions and a complete (and correct) proof? ", "page_idx": 18}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 18}, {"type": "text", "text": "Justification: No theoretical results involved. ", "page_idx": 18}, {"type": "text", "text": "Guidelines: ", "page_idx": 19}, {"type": "text", "text": "\u2022 The answer NA means that the paper has no limitation while the answer No means that the paper has limitations, but those are not discussed in the paper.   \n\u2022 The authors are encouraged to create a separate \u201dLimitations\u201d section in their paper.   \n\u2022 The paper should point out any strong assumptions and how robust the results are to violations of these assumptions (e.g., independence assumptions, noiseless settings, model well-specification, asymptotic approximations only holding locally). The authors should reflect on how these assumptions might be violated in practice and what the implications would be.   \n\u2022 The authors should reflect on the scope of the claims made, e.g., if the approach was only tested on a few datasets or with a few runs. In general, empirical results often depend on implicit assumptions, which should be articulated.   \n\u2022 The authors should reflect on the factors that influence the performance of the approach. For example, a facial recognition algorithm may perform poorly when image resolution is low or images are taken in low lighting. Or a speech-to-text system might not be used reliably to provide closed captions for online lectures because it fails to handle technical jargon.   \n\u2022 The authors should discuss the computational efficiency of the proposed algorithms and how they scale with dataset size.   \n\u2022 If applicable, the authors should discuss possible limitations of their approach to address problems of privacy and fairness.   \n\u2022 While the authors might fear that complete honesty about limitations might be used by reviewers as grounds for rejection, a worse outcome might be that reviewers discover limitations that aren\u2019t acknowledged in the paper. The authors should use their best judgment and recognize that individual actions in favor of transparency play an important role in developing norms that preserve the integrity of the community. Reviewers will be specifically instructed to not penalize honesty concerning limitations. ", "page_idx": 19}, {"type": "text", "text": "4. Experimental Result Reproducibility ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "Question: Does the paper fully disclose all the information needed to reproduce the main experimental results of the paper to the extent that it affects the main claims and/or conclusions of the paper (regardless of whether the code and data are provided or not)? ", "page_idx": 19}, {"type": "text", "text": "Answer: [Yes] ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "Justification: see appendix Guidelines: ", "page_idx": 19}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include theoretical results.   \n\u2022 All the theorems, formulas, and proofs in the paper should be numbered and crossreferenced.   \n\u2022 All assumptions should be clearly stated or referenced in the statement of any theorems.   \n\u2022 The proofs can either appear in the main paper or the supplemental material, but if they appear in the supplemental material, the authors are encouraged to provide a short proof sketch to provide intuition.   \n\u2022 Inversely, any informal proof provided in the core of the paper should be complemented by formal proofs provided in appendix or supplemental material.   \n\u2022 Theorems and Lemmas that the proof relies upon should be properly referenced. ", "page_idx": 19}, {"type": "text", "text": "5. Open access to data and code ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "Question: Does the paper provide open access to the data and code, with sufficient instructions to faithfully reproduce the main experimental results, as described in supplemental material? ", "page_idx": 19}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 19}, {"type": "text", "text": "Justification: see appendix   \nGuidelines: \u2022 The answer NA means that paper does not include experiments requiring code.   \n\u2022 Please see the NeurIPS code and data submission guidelines (https://nips.cc/ public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 While we encourage the release of code and data, we understand that this might not be possible, so \u201cNo\u201d is an acceptable answer. Papers cannot be rejected simply for not including code, unless this is central to the contribution (e.g., for a new open-source benchmark).   \n\u2022 The instructions should contain the exact command and environment needed to run to reproduce the results. See the NeurIPS code and data submission guidelines (https: //nips.cc/public/guides/CodeSubmissionPolicy) for more details.   \n\u2022 The authors should provide instructions on data access and preparation, including how to access the raw data, preprocessed data, intermediate data, and generated data, etc.   \n\u2022 The authors should provide scripts to reproduce all experimental results for the new proposed method and baselines. If only a subset of experiments are reproducible, they should state which ones are omitted from the script and why.   \n\u2022 At submission time, to preserve anonymity, the authors should release anonymized versions (if applicable).   \n\u2022 Providing as much information as possible in supplemental material (appended to the paper) is recommended, but including URLs to data and code is permitted. ", "page_idx": 19}, {"type": "text", "text": "", "page_idx": 20}, {"type": "text", "text": "6. Experimental Setting/Details ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Question: Does the paper specify all the training and test details (e.g., data splits, hyperparameters, how they were chosen, type of optimizer, etc.) necessary to understand the results? ", "page_idx": 20}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 20}, {"type": "text", "text": "Justification: see appendix ", "page_idx": 20}, {"type": "text", "text": "Guidelines: ", "page_idx": 20}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments. \u2022 The experimental setting should be presented in the core of the paper to a level of detail that is necessary to appreciate the results and make sense of them. \u2022 The full details can be provided either with the code, in appendix, or as supplemental material. ", "page_idx": 20}, {"type": "text", "text": "7. Experiment Statistical Significance ", "text_level": 1, "page_idx": 20}, {"type": "text", "text": "Question: Does the paper report error bars suitably and correctly defined or other appropriate information about the statistical significance of the experiments? ", "page_idx": 20}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 20}, {"type": "text", "text": "Guidelines: ", "page_idx": 20}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The authors should answer \u201dYes\u201d if the results are accompanied by error bars, confidence intervals, or statistical significance tests, at least for the experiments that support the main claims of the paper.   \n\u2022 The factors of variability that the error bars are capturing should be clearly stated (for example, train/test split, initialization, random drawing of some parameter, or overall run with given experimental conditions).   \n\u2022 The method for calculating the error bars should be explained (closed form formula, call to a library function, bootstrap, etc.)   \n\u2022 The assumptions made should be given (e.g., Normally distributed errors).   \n\u2022 It should be clear whether the error bar is the standard deviation or the standard error of the mean.   \n\u2022 It is OK to report 1-sigma error bars, but one should state it. The authors should preferably report a 2-sigma error bar than state that they have a $96\\%$ CI, if the hypothesis of Normality of errors is not verified.   \n\u2022 For asymmetric distributions, the authors should be careful not to show in tables or figures symmetric error bars that would yield results that are out of range (e.g. negative error rates). ", "page_idx": 20}, {"type": "text", "text": "\u2022 If error bars are reported in tables or plots, The authors should explain in the text how they were calculated and reference the corresponding figures or tables in the text. ", "page_idx": 21}, {"type": "text", "text": "8. Experiments Compute Resources ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "Question: For each experiment, does the paper provide sufficient information on the computer resources (type of compute workers, memory, time of execution) needed to reproduce the experiments? ", "page_idx": 21}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 21}, {"type": "text", "text": "Justification: see experiments and appendix ", "page_idx": 21}, {"type": "text", "text": "Guidelines: ", "page_idx": 21}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not include experiments.   \n\u2022 The paper should indicate the type of compute workers CPU or GPU, internal cluster, or cloud provider, including relevant memory and storage.   \n\u2022 The paper should provide the amount of compute required for each of the individual experimental runs as well as estimate the total compute.   \n\u2022 The paper should disclose whether the full research project required more compute than the experiments reported in the paper (e.g., preliminary or failed experiments that didn\u2019t make it into the paper). ", "page_idx": 21}, {"type": "text", "text": "9. Code Of Ethics ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "Question: Does the research conducted in the paper conform, in every respect, with the NeurIPS Code of Ethics https://neurips.cc/public/EthicsGuidelines? ", "page_idx": 21}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 21}, {"type": "text", "text": "Guidelines: ", "page_idx": 21}, {"type": "text", "text": "\u2022 The answer NA means that the authors have not reviewed the NeurIPS Code of Ethics.   \n\u2022 If the authors answer No, they should explain the special circumstances that require a deviation from the Code of Ethics.   \n\u2022 The authors should make sure to preserve anonymity (e.g., if there is a special consideration due to laws or regulations in their jurisdiction). ", "page_idx": 21}, {"type": "text", "text": "10. Broader Impacts ", "text_level": 1, "page_idx": 21}, {"type": "text", "text": "Question: Does the paper discuss both potential positive societal impacts and negative societal impacts of the work performed? ", "page_idx": 21}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 21}, {"type": "text", "text": "Guidelines: ", "page_idx": 21}, {"type": "text", "text": "\u2022 The answer NA means that there is no societal impact of the work performed.   \n\u2022 If the authors answer NA or No, they should explain why their work has no societal impact or why the paper does not address societal impact.   \n\u2022 Examples of negative societal impacts include potential malicious or unintended uses (e.g., disinformation, generating fake profiles, surveillance), fairness considerations (e.g., deployment of technologies that could make decisions that unfairly impact specific groups), privacy considerations, and security considerations.   \n\u2022 The conference expects that many papers will be foundational research and not tied to particular applications, let alone deployments. However, if there is a direct path to any negative applications, the authors should point it out. For example, it is legitimate to point out that an improvement in the quality of generative models could be used to generate deepfakes for disinformation. On the other hand, it is not needed to point out that a generic algorithm for optimizing neural networks could enable people to train models that generate Deepfakes faster.   \n\u2022 The authors should consider possible harms that could arise when the technology is being used as intended and functioning correctly, harms that could arise when the technology is being used as intended but gives incorrect results, and harms following from (intentional or unintentional) misuse of the technology. ", "page_idx": 21}, {"type": "text", "text": "\u2022 If there are negative societal impacts, the authors could also discuss possible mitigation strategies (e.g., gated release of models, providing defenses in addition to attacks, mechanisms for monitoring misuse, mechanisms to monitor how a system learns from feedback over time, improving the efficiency and accessibility of ML). ", "page_idx": 22}, {"type": "text", "text": "11. Safeguards ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Question: Does the paper describe safeguards that have been put in place for responsible release of data or models that have a high risk for misuse (e.g., pretrained language models, image generators, or scraped datasets)? ", "page_idx": 22}, {"type": "text", "text": "Answer: [Yes] Guidelines: ", "page_idx": 22}, {"type": "text", "text": "\u2022 The answer NA means that the paper poses no such risks.   \n\u2022 Released models that have a high risk for misuse or dual-use should be released with necessary safeguards to allow for controlled use of the model, for example by requiring that users adhere to usage guidelines or restrictions to access the model or implementing safety filters.   \n\u2022 Datasets that have been scraped from the Internet could pose safety risks. The authors should describe how they avoided releasing unsafe images.   \n\u2022 We recognize that providing effective safeguards is challenging, and many papers do not require this, but we encourage authors to take this into account and make a best faith effort. ", "page_idx": 22}, {"type": "text", "text": "12. Licenses for existing assets ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Question: Are the creators or original owners of assets (e.g., code, data, models), used in the paper, properly credited and are the license and terms of use explicitly mentioned and properly respected? ", "page_idx": 22}, {"type": "text", "text": "Answer: [Yes] Guidelines: ", "page_idx": 22}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not use existing assets.   \n\u2022 The authors should cite the original paper that produced the code package or dataset.   \n\u2022 The authors should state which version of the asset is used and, if possible, include a URL.   \n\u2022 The name of the license (e.g., CC-BY 4.0) should be included for each asset.   \n\u2022 For scraped data from a particular source (e.g., website), the copyright and terms of service of that source should be provided.   \n\u2022 If assets are released, the license, copyright information, and terms of use in the package should be provided. For popular datasets, paperswithcode.com/datasets has curated licenses for some datasets. Their licensing guide can help determine the license of a dataset.   \n\u2022 For existing datasets that are re-packaged, both the original license and the license of the derived asset (if it has changed) should be provided.   \n\u2022 If this information is not available online, the authors are encouraged to reach out to the asset\u2019s creators. ", "page_idx": 22}, {"type": "text", "text": "13. New Assets ", "text_level": 1, "page_idx": 22}, {"type": "text", "text": "Question: Are new assets introduced in the paper well documented and is the documentation provided alongside the assets? ", "page_idx": 22}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 22}, {"type": "text", "text": "Guidelines: ", "page_idx": 22}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not release new assets.   \n\u2022 Researchers should communicate the details of the dataset/code/model as part of their submissions via structured templates. This includes details about training, license, limitations, etc.   \n\u2022 The paper should discuss whether and how consent was obtained from people whose asset is used. ", "page_idx": 22}, {"type": "text", "text": "\u2022 At submission time, remember to anonymize your assets (if applicable). You can either create an anonymized URL or include an anonymized zip file. ", "page_idx": 23}, {"type": "text", "text": "14. Crowdsourcing and Research with Human Subjects ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: For crowdsourcing experiments and research with human subjects, does the paper include the full text of instructions given to participants and screenshots, if applicable, as well as details about compensation (if any)? ", "page_idx": 23}, {"type": "text", "text": "Answer: [NA] Guidelines: ", "page_idx": 23}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Including this information in the supplemental material is fine, but if the main contribution of the paper involves human subjects, then as much detail as possible should be included in the main paper.   \n\u2022 According to the NeurIPS Code of Ethics, workers involved in data collection, curation, or other labor should be paid at least the minimum wage in the country of the data collector. ", "page_idx": 23}, {"type": "text", "text": "15. Institutional Review Board (IRB) Approvals or Equivalent for Research with Human Subjects ", "text_level": 1, "page_idx": 23}, {"type": "text", "text": "Question: Does the paper describe potential risks incurred by study participants, whether such risks were disclosed to the subjects, and whether Institutional Review Board (IRB) approvals (or an equivalent approval/review based on the requirements of your country or institution) were obtained? ", "page_idx": 23}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 23}, {"type": "text", "text": "Guidelines: ", "page_idx": 23}, {"type": "text", "text": "\u2022 The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.   \n\u2022 Depending on the country in which research is conducted, IRB approval (or equivalent) may be required for any human subjects research. If you obtained IRB approval, you should clearly state this in the paper.   \n\u2022 We recognize that the procedures for this may vary significantly between institutions and locations, and we expect authors to adhere to the NeurIPS Code of Ethics and the guidelines for their institution.   \n\u2022 For initial submissions, do not include any information that would break anonymity (if applicable), such as the institution conducting the review. ", "page_idx": 23}]