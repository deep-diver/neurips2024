[{"type": "text", "text": "Measuring Goal-Directedness ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "Matt MacDermott James Fox Francesco Belardinelli Imperial College London University of Oxford Imperial College London London Initiative for Safe AI ", "page_idx": 0}, {"type": "text", "text": "Tom Everitt Google DeepMind ", "page_idx": 0}, {"type": "text", "text": "Abstract ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "We define maximum entropy goal-directedness (MEG), a formal measure of goaldirectedness in causal models and Markov decision processes, and give algorithms for computing it. Measuring goal-directedness is important, as it is a critical element of many concerns about harm from AI. It is also of philosophical interest, as goal-directedness is a key aspect of agency. MEG is based on an adaptation of the maximum causal entropy framework used in inverse reinforcement learning. It can measure goal-directedness with respect to a known utility function, a hypothesis class of utility functions, or a set of random variables. We prove that MEG satisfies several desiderata and demonstrate our algorithms with small-scale experiments 1. ", "page_idx": 0}, {"type": "text", "text": "1 Introduction ", "text_level": 1, "page_idx": 0}, {"type": "text", "text": "In order to build more useful AI systems, a natural inclination is to try to make them more agentic. But while agents built from language models are touted as the next big advance [Wang et al., 2024], agentic systems have been identified as a potential source of individual [Dennett, 2023], systemic [Chan et al., 2023, Gabriel et al., 2024], and catastrophic [Ngo et al., 2022] risks. Agency is thus a key focus of behavioural evaluations [Shevlane et al., 2023, Phuong et al., 2024] and governance [Shavit et al., 2023]. Some prominent researchers have even called for a shift towards designing explicitly non-agentic systems [Dennett, 2017, Bengio, 2023]. ", "page_idx": 0}, {"type": "text", "text": "A critical aspect of agency is the ability to pursue goals. Indeed, the standard theory of agency defines agency as the capacity for intentional action \u2013 action that can be explained in terms of mental states such as goals [Schlosser, 2019]. But when are we justified in ascribing such mental states? According to Daniel Dennett\u2019s instrumentalist philosophy of mind [1989], we are justified when doing so is useful for predicting a system\u2019s behaviour. ", "page_idx": 0}, {"type": "text", "text": "This paper\u2019s key contribution is a method for formally measuring goal-directedness based on Dennett\u2019s idea. Since pursuing goals is about having a particular causal effect on the environment2, defining our measure in a causal model is natural. Causal models are general enough to encompass most frameworks popular among ML practitioners, such as single-decision prediction, classification, and regression tasks, as well as multi-decision (partially observable) Markov decision processes. They also offer enough structure to usefully model many ethics and safety problems [Everitt et al., 2021a, Ward et al., 2024a, Richens et al., 2022, Richens and Everitt, 2024, Everitt et al., 2021b, Ward et al., 2024b, Halpern and Kleiman-Weiner, 2018, Wachter et al., 2017, Kusner et al., 2017, Kenton et al., 2023, Fox et al., 2023, Richens and Everitt, 2024, MacDermott et al., 2023]. ", "page_idx": 0}, {"type": "image", "img_path": "o4coDIby7e/tmp/b1fc84cca007d33bbec35ed99758cc8acccaaafacd1fb234d8c889c8856f58b6.jpg", "img_caption": ["Figure 1: Computing maximum entropy goal-directedness (MEG). "], "img_footnote": [], "page_idx": 1}, {"type": "text", "text": "Maximum entropy goal-directedness (MEG) operationalises goal-directedness as follows, illustrated by the subsequent running example. ", "page_idx": 1}, {"type": "text", "text": "A variable $D$ in a causal model is goal-directed with respect to a utility function $\\boldsymbol{\\mathcal{U}}$ to the extent that the conditional probability distribution of $D$ is well-predicted by the hypothesis that $D$ is optimising $\\boldsymbol{\\mathcal{U}}$ . ", "page_idx": 1}, {"type": "text", "text": "Example 1. A mouse begins at the centre of a gridworld (Figure 1a). It observes that a block of cheese is located either to the right or left $(S)$ with equal probability, proceeds either away from it or towards it $(D)$ , and thus either obtains the cheese or does not $(T)$ . ", "page_idx": 1}, {"type": "text", "text": "Suppose that the mouse moves left when the cheese is to the left and right when it is to the right, thus consistently obtaining the cheese. Intuitively, this behaviour seems goal-directed, but can we quantify how much? Figure 1 gives an overview of our procedure. We first model the system of interest as a causal Bayesian network (Figure 1b) with variables $S$ for the cheese\u2019s position, $D$ for the mouse\u2019s movement, and $T$ for whether or not the mouse obtains the cheese. Then, we identify a candidate decision variable $D$ and target variable $T$ , hypothesising that the mouse optimises a utility function that depends on $T$ (Figure 1c). Finally, we form a model of what behaviour we should expect from $D$ if it is indeed optimising $U$ and then measure how well this model predicts $D$ \u2019s observed behaviour (Figure 1d). ", "page_idx": 1}, {"type": "text", "text": "Ziebart [2010]\u2019s maximum causal entropy (MCE) framework suggests a promising way to construct a model for expected behaviour under a given utility function. However, there are several obstacles to applying it to our problem: it cannot measure the predictive usefulness of known utility functions, and it only finds the most predictive linear utility function. In practice, arbitrary known utility functions can be plugged in, but the results are not scale-invariant. We overcome these difficulties by returning to first principles and deriving an updated version of the MCE framework. ", "page_idx": 1}, {"type": "text", "text": "In summary, our contributions are four-fold. We (i) adapt the MCE framework to derive maximum entropy goal-directedness (MEG), a philosophically-motivated measure of goal-directedness with respect to known utility functions, and show that it satisfies several key desiderata (Section 3); (ii) we extend MEG to measure goal-directedness in cases without a known utility function (Section 4); (iii) we provide algorithms for measuring MEG in MDPs (Section 5); and (iv) we demonstrate the algorithms empirically (Section 6). ", "page_idx": 1}, {"type": "text", "text": "Related Work. Inverse reinforcement learning (IRL) $[\\mathrm{Ng}$ and Russell, 2000] focuses on the question of which goal a system is optimising, whilst we are interested in to what extent the system can be seen as optimising a goal. We are not the first to ask this question. Some works take a Bayesian approach inspired by Dennett\u2019s intentional stance.3 Most closely related to our work is Orseau et al. [2018], which applies Bayesian IRL in POMDPs using a Solomonoff prior over utility functions and an $\\varepsilon$ -greedy model of behaviour. This lets them infer a posterior probability distribution over whether an observed system is a (goal-directed) \"agent\" or \"just a device\". Our approach distinguishes itself from these by considering arbitrary variables in a causal model and deriving our behaviour model from the principle of maximum entropy. Moreover, since our algorithms can take advantage of differentiable classes of utility functions, our approach may be amenable to scaling up using deep neural networks. Oesterheld [2016] combines the intentional stance with Bayes\u2019 theorem in cellular automata, but does not consider specific models of behaviour. Like us, Kenton et al. [2023] consider goal-directedness in a causal graph. However, they require variables to be manually labelled as mechanisms or object-level, and only provide a binary distinction between agentic and non-agentic systems (see Appendix A for a detailed comparison). Biehl and Virgo [2022], Virgo et al. [2021] propose a definition of agency in Moore machines based on whether a system\u2019s internal state can be interpreted as beliefs about the hidden states of a POMDP. ", "page_idx": 1}, {"type": "text", "text": "", "page_idx": 2}, {"type": "text", "text": "2 Background ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "We use capital letters for random variables $V$ , write $\\operatorname{dom}(V)$ for their domain (assumed finite), and use lowercase for outcomes $v\\in\\mathrm{dom}(V)$ . Boldface denotes sets of variables $V=\\{V_{1},\\ldots,V_{n}\\}$ , and their outcomes $\\pmb{v}\\in\\mathrm{dom}(\\pmb{V})=\\times_{i}\\,\\mathrm{dom}(\\pmb{V_{i}})$ . Parents and descendants of $V$ in a graph are denoted by $\\mathbf{Pa}_{V}$ and $\\mathbf{Desc}_{V}$ , respectively (where $\\mathbf{pa}_{V}$ and $\\mathbf{desc}_{V}$ are their instantiations). ", "page_idx": 2}, {"type": "text", "text": "Causal Bayesian networks (CBNs) are a class of probabilistic graphical models used to represent causal relationships between random variables [Pearl, 2009]. ", "page_idx": 2}, {"type": "text", "text": "Definition 2.1 (Causal Bayesian network). A Bayesian network $M=(G,P)$ over a set of variables $V=\\{V_{1},\\ldots,V_{n}\\}$ consists of a joint probability distribution $P$ which factors according to a directed acyclic graph (DAG) $G$ , i.e., $\\begin{array}{r}{P(\\bar{V}_{1},\\bar{\\dots},\\bar{V}_{n})=\\prod_{i=1}^{n}P(V_{i}\\mid{\\bf P}{\\bf a}_{V_{i}})}\\end{array}$ , where $\\mathbf{Pa}_{V_{i}}$ are the parents of $V_{i}$ in $G$ . A Bayesian network is causal if its edg es represent direct causal relationships, or formally if the result of an intervention $\\operatorname{lo}(X=x)$ for any $X\\subseteq V$ can be computed using the truncated factorisation formula: $P(v\\mid\\operatorname{do}(X\\,=\\,x))\\,=\\,\\Pi_{i:v_{i}\\not\\in{\\pmb x}}P(v_{i}\\mid\\mathbf{pa}_{v_{i}})$ if $\\pmb{v}$ is consistent with $\\textbf{\\em x}$ or $P(\\pmb{v}\\mid\\operatorname{do}(\\pmb{X}=\\boldsymbol{x}))=0$ otherwise. ", "page_idx": 2}, {"type": "text", "text": "Figure 1b depicts Example 1 as a CBN, showing the causal relationships between the location of the cheese $(S)$ , the mouse\u2019s behavioural response $(D)$ , and whether the mouse obtains the cheese $(T)$ . ", "page_idx": 2}, {"type": "text", "text": "We are interested in to what extent a set of random variables in a CBN can be seen as goal-directed. That is, to what extent can we interpret them as decisions optimising a utility function? In other words, we are interested in moving from a CBN to a causal influence diagram (CID), a type of probabilistic graphical model that explicitly identifies decision and utility variables. ", "page_idx": 2}, {"type": "text", "text": "Definition 2.2 (Causal Influence Diagram [Everitt et al., 2021a]). A causal influence diagram (CID) $M\\,=\\,(G,P)$ is a CBN where the variables $V$ are partitioned into decision $_{D}$ , chance $\\mathbf{\\deltaX}$ , and utility variables $U$ . Instead of a full joint distribution over $V$ , $P$ consists of conditional probability distributions (CPDs) for each non-decision variable $V\\in V\\setminus D$ . ", "page_idx": 2}, {"type": "text", "text": "A CID can be combined with a policy $\\pi$ , which specifies a $\\mathrm{CPD}\\,\\pi_{D}$ for each decision variable $D$ , in order to obtain a full joint distribution. We call the sum of the utility variables the utility function and denote it $\\begin{array}{r}{\\mathcal{U}=\\sum_{U\\in U}U}\\end{array}$ . Policies are evaluated by their total expected utility $\\mathbb{E}_{\\pi}[\\mathcal{U}]$ . We write $\\pi^{\\mathrm{unif}}$ for the unifor mly random policy. ", "page_idx": 2}, {"type": "text", "text": "CIDs can model a broad class of decision problems, including Markov decision processes (MDPs) and partially observable Markov decision processes (POMDPs) [Everitt et al., 2021b]. ", "page_idx": 2}, {"type": "text", "text": "Example 2 (POMDP). A mouse begins at the centre of the grid, with a block of cheese located either at the far left or the far right (Figure 2). The mouse does not know its position or the position of the cheese $(S_{1})$ but can smell which direction the cheese is in $(O_{1})$ and decide which way to move $(D_{1})$ . Next step, the mouse again smells the direction of the cheese $(O_{2})$ and again chooses which way to proceed $(D_{2})$ . ", "page_idx": 2}, {"type": "text", "text": "3 Measuring goal-directedness with respect to a known utility function ", "text_level": 1, "page_idx": 2}, {"type": "text", "text": "Maximum Entropy Goal-directednes. Dennett\u2019s instrumentalist approach to agency says that we can ascribe mental states (such as utilities) to a system to the extent that doing so is useful for predicting its behaviour [Dennett, 1989]. To operationalise this, we need a model of what behaviour is predicted by a utility function. According to the principle of maximum entropy [Jaynes, 1957], we should choose a probability distribution with the highest entropy distribution satisfying our requirements, thus minimising unnecessary assumptions (following Occam\u2019s razor). We can measure the entropy of a policy by the expected entropy of its decision variables conditional on their parents $H_{\\pi}(D\\ ||\\ {\\bf P a}_{D})^{\\phantom{\\dagger}}=-\\sum_{D\\in D}\\mathbb{E}_{d,{\\bf P a}_{D}\\sim P_{\\pi}}\\log\\pi_{D}(d\\ |\\ {\\bf P a}_{D})$ . This is Ziebart et al. [2010]\u2019s causal entropy, which we usually refer to as just the entropy of $\\pi$ . ", "page_idx": 2}, {"type": "image", "img_path": "o4coDIby7e/tmp/09c2b982626a1880ec852d7a8de829e2a76e3d4fb6a7e3f3c3e96e816d14ae4d.jpg", "img_caption": ["Figure 2: Sequential multi-decision mouse example. "], "img_footnote": [], "page_idx": 3}, {"type": "text", "text": "In our setting, the relevant constraint is expected utility. To avoid assuming that only optimal agents are goal-directed, we construct a set of models of behaviour which covers all levels of competence an agent optimising utility $\\boldsymbol{\\mathcal{U}}$ could have. We define the set of attainable expected utilities in a CID as $\\mathrm{a}\\bar{\\mathrm{t}}{(\\mathcal{U})}\\stackrel{\\cdot}{=}\\{u\\in\\bar{\\mathbb{R}}\\mid\\exists\\bar{\\pi}\\in\\Pi\\left(\\mathbb{E}_{\\pi}\\left[\\mathcal{U}\\right]=u\\right)\\}$ . ", "page_idx": 3}, {"type": "text", "text": "Definition 3.1 (Maximum entropy policy set, known utility function). Let $M=(G,P)$ be a CID with decision variables $_{D}$ and utility function $\\boldsymbol{\\mathcal{U}}$ . The maximum entropy policy set for $u\\in\\mathrm{att}(U)$ ims $\\Pi_{\\mathcal{U},u}^{\\mathrm{maxent}}:=\\operatorname*{argmax}_{\\pi\\mid\\mathbb{E}_{\\pi}\\lbrack\\mathcal{U}]=u}H_{\\pi}(\\boldsymbol{D}\\mid\\mid\\mathbf{Pa}_{\\boldsymbol{D}})$ .x pTehcet emd auxtiilmituy $\\boldsymbol{\\mathcal{U}}$ tt.he set of $\\Pi_{\\mathcal{U}}^{\\mathrm{maxent}}:=\\bigcup_{u\\in\\mathrm{att}(\\mathcal{U})}\\Pi_{\\mathcal{U},u}^{\\mathrm{maxen}}$ ", "page_idx": 3}, {"type": "text", "text": "FMorD ePas,c thh iastt apionliacbyl ei se xupnieqcutee , $\\Pi_{\\mathcal{U}}^{\\mathrm{maxent}}$ bceo nftoauinnsd  twhiet hh ibgahcekstw earndtrs oipnyd upcotliiocny  (wsehei cShe cattitaoinn s5 )i.t. In ", "page_idx": 3}, {"type": "text", "text": "We measure predictive accuracy using cross-entropy, as is common in ML. We subtract the predictive accuracy of the uniform distribution, so that we measure predictive accuracy relative to random chance. This makes MEG always non-negative. ", "page_idx": 3}, {"type": "text", "text": "Definition 3.2 (Maximum entropy goal-directedness, known utility function). Let $M:=(G,P)$ be a CID with decision variables $_{D}$ and utility function $\\boldsymbol{\\mathcal{U}}$ . The maximum entropy goal-directedness (MEG) of a policy $\\pi$ with respect to $\\boldsymbol{\\mathcal{U}}$ is ", "page_idx": 3}, {"type": "equation", "text": "$$\n\\mathrm{MEG}_{\\mathcal{U}}(\\pi):=\\operatorname*{max}_{\\pi^{\\mathrm{maxent}}\\in\\Pi_{\\mathcal{U}}^{\\mathrm{maxent}}}\\mathbb{E}_{\\pi}\\left[\\sum_{D\\in D}\\left(\\log\\pi^{\\mathrm{maxent}}(D\\mid{\\bf P}_{\\mathbf{a}D})-\\log\\frac{1}{\\left|\\mathrm{dom}(D)\\right|}\\right)\\right].\n$$", "text_format": "latex", "page_idx": 3}, {"type": "text", "text": "As we will see, in a Markov Decision Process, this is equivalent to maximising predictive accuracy by varying the rationality parameter $\\beta$ in the \u2018soft-optimal\u2019 policy $\\pi_{\\beta}^{\\mathrm{soft}}$ used in maximum entropy reinforcement learning [Haarnoja et al., 2017].4 ", "page_idx": 3}, {"type": "text", "text": "If instead of having access to a policy $\\pi$ , we have access to a set of full trajectories $\\{(\\mathbf{pa}_{D_{1}}^{i},D_{1}^{i},\\ldots,\\mathbf{pa}_{D_{n}^{i}}^{\\phantom{i}},D_{n}^{i})\\}_{i}$ , the expectation $\\mathbb{E}_{\\pi}$ in Equation (1) can be replaced with an average over the trajectory set. This is an unbiased and consistent estimate of $\\mathrm{MEG}_{\\mathcal{U}}(\\pi)$ for the policy $\\pi$ generating the trajectories. ", "page_idx": 3}, {"type": "text", "text": "Example. Consider a policy $\\pi$ in Example 1 that proceeds towards the cheese with probability 0.8. How goal-directed is this policy with respect to the utility function $\\boldsymbol{\\mathcal{U}}$ that gives $+1$ for obtaining the cheese and $-1$ otherwise? ", "page_idx": 3}, {"type": "text", "text": "To compute $\\mathrm{MEG}_{\\mathcal{U}}(\\pi)$ , we first find the maximum entropy policy set $\\Pi_{\\mathcal{U}}^{\\mathrm{maxent}}$ , and then take the maximum predictive accuracy with respect to $\\pi$ . In a single-decision setting, for each attainable expected utility u there is a unique \u03c0Um,auxe which has the form of a Boltzmann policy $\\pi_{\\mathcal{U},u}^{\\mathrm{maxent}}(d\\mid$ $\\begin{array}{r}{s)=\\frac{\\exp(\\beta\\cdot\\mathbb{E}[U|d,s])}{\\sum_{d^{\\prime}}\\exp(\\beta\\cdot\\mathbb{E}[U|d^{\\prime},s])}}\\end{array}$ (cf. Theorem 5.1). The rationality parameter $\\beta=\\beta(u)$ can be varied to get the correct expected utility. Predictive accuracy with respect to $\\pi$ is maximised by $\\pi_{\\mathcal{U},0.8}^{\\mathrm{maxent}}$ , which has a rationality parameter of $\\beta\\,=\\,\\log2$ . The expected logprob of a prediction of this policy is $\\mathbb{E}_{\\pi}\\left[\\log\\pi_{\\mathcal{U},0.8}^{\\mathrm{maxent}}(D\\mid\\mathbf{P}\\mathbf{a}_{D})\\right]=-0.50$ , while the expected logprob of a uniform prediction is $\\log({\\frac{1}{2}})=$ $-0.69$ . So we get that $\\mathrm{M}\\bar{\\mathrm{EG}}_{\\mathcal{U}}(\\pi)=-0.50-(-0.69)=0.19.$ . For comparison, predictive accuracy for the optimal policy $\\pi^{*}$ is maximised when $\\beta=\\infty$ , and has $\\mathrm{MEG}_{\\mathcal{U}}(\\pi^{*})=0-(-0.69)=0.69$ . ", "page_idx": 3}, {"type": "text", "text": "", "page_idx": 4}, {"type": "text", "text": "Properties. We now show that MEG satisfies three important desiderata. First, since utility functions are usually only defined up to translation and rescaling, a measure of goal-directedness with respect to a utility function should be translation and scale invariant. MEG satisfies this property: ", "page_idx": 4}, {"type": "text", "text": "Proposition 3.1 (Translation and scale invariance). Let $M_{1}$ be a CID with utility function $\\mathcal{U}_{1}$ , and let $M_{2}$ be an identical CID but with utility function $\\mathcal{U}_{2}=a\\cdot\\mathcal{U}_{1}+b,$ , for some $a,b\\in\\mathbb{R},$ , with $a\\ne0$ . Then for any policy $\\pi$ , $\\mathrm{MEG}_{\\mathcal{U}_{1}}(\\pi)=\\mathrm{MEG}_{\\mathcal{U}_{2}}(\\pi)$ . ", "page_idx": 4}, {"type": "text", "text": "Second, goal-directedness should be minimal when actions are chosen completely at random and maximal when uniquely optimal actions are chosen. ", "page_idx": 4}, {"type": "text", "text": "Proposition 3.2 (Bounds). Let $M$ be a CID with utility function U. Then for any policy $\\pi$ we have $\\begin{array}{r}{0\\leq\\mathrm{MEG}_{\\mathcal{U}}(\\pi)\\leq\\sum_{D\\in\\mathcal{D}}\\log(|\\operatorname{dom}(D)|)}\\end{array}$ , with equality in the lower bound if $\\pi$ is the uniform policy, and equality in the upper bound if $\\pi$ is the unique optimal (or anti-optimal) policy with respect to $\\boldsymbol{\\mathcal{U}}$ . ", "page_idx": 4}, {"type": "text", "text": "Note that MEG has a natural interpretation as the amount of evidence provided for a goal-directed policy over a purely random policy. The larger a decision problem, the more opportunity there is to see this evidence, so the higher MEG can be. ", "page_idx": 4}, {"type": "text", "text": "Third, a system can never be goal-directed towards a utility function it cannot affect. ", "page_idx": 4}, {"type": "text", "text": "Proposition 3.3 (No goal-directedness without causal influence). Let $M=(G,P)$ be a CID with utility function U and decision variables $_{D}$ such that, $D e s c(D)\\cap P\\pmb{a}_{U}=\\emptyset$ . Then $\\mathrm{MEG}_{\\mathcal{U}}(D)=0$ . ", "page_idx": 4}, {"type": "text", "text": "Comparison to MCE IRL Our method is closely related to MCE IRL [Ziebart et al., 2010] (see Gleave and Toyer [2022] for a useful primer). In this subsection, we discuss the key similarities and differences. ", "page_idx": 4}, {"type": "text", "text": "The MCE IRL method seeks to find a utility function that explains the policy $\\pi$ . It starts by identifying a set of $n$ linear features $f_{i}$ and seeks a model policy that imitates $\\pi$ as far as these features are concerned but otherwise is as random as possible. It thus applies the principle of maximum entropy with $n$ linear constraints. The form of the model policy involves a weighted sum of these features. In a single-decision example, it takes the form ", "page_idx": 4}, {"type": "equation", "text": "$$\n\\pi^{\\mathrm{MCE}}(d\\mid s)={\\frac{\\exp{(\\mathbb{E}\\left[\\sum_{i}w_{i}f_{i}\\mid d,s\\right])}}{\\sum_{d^{\\prime}}\\exp{(\\mathbb{E}\\left[w_{i}f_{i}\\mid d^{\\prime},s\\right])}}}.\n$$", "text_format": "latex", "page_idx": 4}, {"type": "text", "text": "The weights $w_{i}$ are interpreted as a utility function over the features $f_{i}$ . MCE IRL can, therefore, only return a linear utility function. ", "page_idx": 4}, {"type": "text", "text": "In contrast, our method seeks to measure the goal-directedness of $\\pi$ with respect to an arbitrary utility function $\\boldsymbol{\\mathcal{U}}$ , linear or otherwise. Rather than constructing a single maximum entropy policy with $n$ linear constraints, we construct a class of maximum entropy policies, each with a different single constraint on the expected utility. ", "page_idx": 4}, {"type": "text", "text": "A naive alternative to defining the goal-directedness of $\\pi$ with respect to $\\boldsymbol{\\mathcal{U}}$ as the maximum predictive accuracy across $\\boldsymbol{\\mathcal{U}}$ \u2019s maximum policy set, we could simply plug in our utility function $\\boldsymbol{\\mathcal{U}}$ to $\\pi^{\\mathrm{MCE}}$ from Equation (2), and use that to measure predictive accuracy. If $\\boldsymbol{\\mathcal{U}}$ is linear in the features $f_{i}$ , we could substitute in the appropriate weights, but even if not, we could still replace $\\sum_{i}w_{i}f_{i}$ with $\\boldsymbol{\\mathcal{U}}$ . Indeed, this is often done with nonlinear utility functions in deep MCE IRL [Wulfm eier et al., 2015]. ", "page_idx": 4}, {"type": "text", "text": "However, this would not have a formal justification, and we would run into a problem: scale noninvariance. Plugging in $2\\cdot\\mathcal{U}$ would result in a more sharply peaked $\\pi^{\\mathrm{MCE}}$ than $\\boldsymbol{\\mathcal{U}}$ ; in Example 1, we would get that the mouse is more goal-directed towards $2\\cdot\\mathcal{U}$ than $\\boldsymbol{\\mathcal{U}}$ , with a predictive accuracy (measured by negative cross-entropy) of -0.018 vs -0.13. In contrast, constructing separate maximum entropy policies for each expected utility automatically handles this issue. The policy in $\\Pi_{2\\cdot\\mathcal{U}}^{\\mathrm{maxent}}$ t which maximises predictive accuracy for $\\pi$ has an inversely scaled rationality parameter $\\begin{array}{r}{\\beta^{\\prime}=\\frac{\\beta}{2}}\\end{array}$ compared to the maximally predictive policy in $\\Pi_{2\\cdot\\mathcal{U}}^{\\mathrm{maxent}}$ . In other words, they are the same policy, and we get that $\\mathrm{MEG}_{\\mathcal{U}}(\\pi)=\\mathrm{\\bar{MEG}_{2:\\mathcal{U}}(\\pi)}=0.19$ (cf. Proposition 3.1). ", "page_idx": 4}, {"type": "text", "text": "4 Measuring goal-directedness without a known utility function ", "text_level": 1, "page_idx": 5}, {"type": "text", "text": "In many cases where we want to apply MEG, we may not know exactly what utility function the system could be optimising. For example, we might suspect that a content recommender is trying to influence a user\u2019s preferences, but may not have a clear hypothesis as to in what way. Therefore, in this section, we extend our definitions for measuring goal-directedness to the case where the utility function is unknown. ", "page_idx": 5}, {"type": "text", "text": "We first extend CIDs to include multiple possible utility functions. ", "page_idx": 5}, {"type": "text", "text": "Definition 4.1. A parametric-utility CID (CID) $M^{\\Theta}$ is a set of CIDs $\\{M^{\\theta}\\ |\\ \\theta\\in\\Theta\\}$ which differ only in the CPDs of their utility variables. ", "page_idx": 5}, {"type": "text", "text": "In effect, a parametric CID is a CID with a parametric class of utility functions $\\mathcal{U}^{\\Theta}$ ", "page_idx": 5}, {"type": "text", "text": "The maximum entropy policy set from Definition 3.1 is extended accordingly to include maximum entropy policies for each utility function and each attainable expected utility with respect to it. ", "page_idx": 5}, {"type": "text", "text": "Definition 4.2 (Maximum entropy policy set, unknown utility function). Let $M^{\\Theta}=(G,P)$ be a parametric-utility CID with decision variables $_{D}$ and utility function $\\mathcal{U}^{\\Theta}$ . The maximum entropy policy set for $\\mathcal{U}^{\\breve{\\Theta}}$ is the set of maximum entropy policies for any attainable expected utility for any utility function in the class: \u03a0Uma\u0398xent:=  \u03b8\u2208\u0398,u\u2208att(U\u03b8) \u03a0Uma\u03b8x,eun t. ", "page_idx": 5}, {"type": "text", "text": "Definition 4.3 (MEG, unknown utility function). Let $M^{\\Theta}\\mathrm{~=~}(G,P)$ be a parametric-utility CID with decision variables $_{D}$ and utility function $\\bar{\\mathcal{U}}^{\\Theta}$ . The maximum entropy goal-directedness of a policy $\\pi$ with respect to $\\mathcal{U}^{\\Theta}$ is $\\mathrm{MEG}_{\\mathcal{U}^{\\Theta}}(\\pi)=\\operatorname*{max}_{\\mathcal{U}\\in\\mathcal{U}^{\\Theta}}\\mathrm{MEG}_{\\mathcal{U}}(\\pi).$ . ", "page_idx": 5}, {"type": "text", "text": "Definition 4.4 (MEG, target variables). Let $M=(G,P)$ be a CBN with variables $V$ . Let $D\\subseteq V$ be a hypothesised set of decision variables and $T\\subseteq V$ be a hypothesised set of target variables. The maximum entropy goal-directedness of $_{D}$ with respect to $\\textbf{\\emph{T}}$ , $\\mathrm{iUEG}_{T}(D)$ , is the goal-directedness of ${\\boldsymbol{\\pi}}=P(D\\mid\\mathbf{P}\\mathbf{a}_{D})$ in the parametric CID with decisions $_{D}$ and utility functions $\\mathcal{U}:\\mathrm{dom}(\\mathbf{\\cal{T}})\\rightarrow\\mathbb{R}$ (i.e., the set of all utility functions over $T$ ). ", "page_idx": 5}, {"type": "text", "text": "For example, if we only suspected that the mouse in Example 1 was optimising some function of the cheese $T$ , but didn\u2019t know which one, we could apply Definition 4.4 to consider the goal-directedness towards $T$ under any utility function defined on $T$ . Thanks to translation and scale invariance (Proposition 3.1), there are effectively only three utility functions to consider: those that provide higher utility to cheese than not cheese, those that do the opposite, and those that are indifferent. ", "page_idx": 5}, {"type": "text", "text": "Note that $\\textbf{\\emph{T}}$ has to include some descendants of $_{D}$ , in order to enable positive MEG (Proposition 3.3). However, it is not necessary that $_T$ consists of only descendants of $_{D}$ (i.e., $\\textbf{\\emph{T}}$ need not be a subset of $\\mathbf{Desc}(D))$ . For example, goal-conditional agents take an instruction as part of their input $\\mathbf{Pa}_{D}$ . The goal-directedness of such agents can only be fully appreciated by including the instruction in $_T$ . ", "page_idx": 5}, {"type": "text", "text": "", "page_idx": 5}, {"type": "text", "text": "Pseudo-terminal goals. Definition 4.4 enable us to state a result about a special kind of instrumental goal. It is well known that an agent that optimises some variable has an instrumental incentive to control any variables which mediate between the two [Everitt et al., 2021a]. However, since the agent might want the mediators to take different values in different circumstances, it need not appear goal-directed with respect to the mediators. Theorem 4.1 shows that in the special case where the mediators $d\\cdot$ -separate the decision from the downstream variable, the decision appears at least as goal-directed with respect to the mediators as with respect to the target. ", "page_idx": 5}, {"type": "text", "text": "Theorem 4.1 (Pseudo-terminal goals). Let $M=((V,E),P)$ be a CBN. Let $D,T,S\\subseteq V$ such that ${\\cal D}\\perp{\\cal T}\\mid{\\cal S}$ . Then $\\mathrm{MEG}_{T}(\\bar{D})\\leq\\mathrm{MEG}_{S}(D)$ . ", "page_idx": 5}, {"type": "text", "text": "For example, in Figure 2, the agent must be at least as goal-directed towards $S_{3}$ as it is towards $U_{3}$ , since $S_{3}$ blocks all paths (i.e. d-separates) from $\\{D_{1},\\bar{D_{2}}\\}$ to $U_{3}$ . ", "page_idx": 5}, {"type": "text", "text": "Intuitively, this comes about because, in such cases, a rational agent wants the mediators to take the same values regardless of circumstances, making the instrumental control incentive indistinguishable from a terminal goal. This means we do not have to look arbitrarily far into the future to find evidence of goal-directedness. An agent that is goal-directed with respect to next week must also be goal-directed with respect to tomorrow. ", "page_idx": 5}, {"type": "text", "text": "5 Computing MEG in Markov Decision Processes ", "text_level": 1, "page_idx": 6}, {"type": "text", "text": "In this section, we give algorithms for computing MEG in MDPs. First, we define what an MDP looks like as a CID. We then establish that soft value iteration can be used to construct our maximum entropy policies, and give algorithms for computing MEG when the utility function is known or unknown. ", "page_idx": 6}, {"type": "text", "text": "Note that in order to run these algorithms, we do not need an explicit causal model, and so we do not have to worry about hidden confounders. We do, however, need black-box access to the environment dynamics, i.e., the ability to run different policies in the environment and measure whatever variables we are considering utility functions over. ", "page_idx": 6}, {"type": "text", "text": "Definition 5.1. A Markov Decision Process (MDP) is a CID with variables $\\{S_{t},D_{t},U_{t}\\}_{t=1}^{n}$ , decisions $D=\\{D_{t}\\}_{t=1}^{n}$ and utilities $\\pmb{U}=\\{U_{t}\\}_{t=1}^{n}$ , such that for $t$ between 1 and $n$ , $\\mathbf{Pa}_{D_{t}}=\\{S_{t}\\}$ , $\\mathbf{Pa}_{U_{t}}=$ $\\left\\{S_{t}\\right\\}$ , while $\\mathbf{Pa}_{S_{t}}=\\{S_{t-1},D_{t-1}\\}$ for $t>1$ , and $\\mathbf{Pa}_{S_{1}}=\\emptyset$ . ", "page_idx": 6}, {"type": "text", "text": "Constructing Maximum Entropy Policies In MDPs, Ziebart\u2019s soft value iteration algorithm can be used to construct maximum entropy policies satisfying a set of linear constraints. We apply it to construct maximum entropy policies satisfying expected utility constraints. ", "page_idx": 6}, {"type": "text", "text": "Definition 5.2 (Soft Q-Function). Let $M=(G,P)$ be an MDP. Let $\\beta\\in\\mathbb{R}\\setminus\\{0\\}$ . For each $D_{t}\\in D$ we define the soft $Q$ -function $Q_{\\beta,n}^{\\mathrm{soft}}:\\mathrm{dom}(D_{t})\\times\\mathrm{dom}(\\mathbf{P}\\mathbf{a}_{D_{t}})\\rightarrow\\mathbb{R}$ via the recursion: ", "page_idx": 6}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{Q_{\\beta,t}^{\\mathrm{soft}}(d_{t}\\mid\\mathbf{pa}_{t})=\\mathbb{E}\\left[U_{t}+\\frac{1}{\\beta}\\log\\mathrm{sumexp}(\\beta\\cdot Q_{\\beta,t+1}^{\\mathrm{soft}}(\\cdot\\mid\\mathbf{Pa}_{D_{t+1}}))\\Bigg|d_{t},\\mathbf{pa}_{t+1}\\right]\\quad\\mathrm{~for~}t<n,}\\\\ &{Q_{\\beta,n}^{\\mathrm{soft}}(d_{n}\\mid\\mathbf{pa}_{n})=\\mathbb{E}\\left[U_{n}\\mid d_{n},\\mathbf{pa}_{n}\\right],}\\\\ &{\\mathrm{ere~logsumexp}\\;\\beta(Q_{\\beta,t+1}^{\\mathrm{soft}}(\\cdot\\mid\\mathbf{Pa}_{D_{t+1}}))=\\log\\sum_{d_{t+1}\\in\\mathrm{dom}(D_{t+1})}\\exp(\\beta Q_{\\beta,t+1}^{\\mathrm{soft}}(d_{t+1}\\mid\\mathbf{Pa}_{D_{t+1}})).}\\end{array}\n$$", "text_format": "latex", "page_idx": 6}, {"type": "text", "text": "Using the soft Q-function, we show that there is a unique $\\pi\\in\\Pi_{\\mathcal{U},u}^{\\mathrm{maxent}}$ for each $\\boldsymbol{\\mathcal{U}}$ and $u$ in MDPs. ", "page_idx": 6}, {"type": "text", "text": "Theorem 5.1 (Maximum entropy policy in MDPs). Let $M=(G,P)$ be an MDP with utility function $\\boldsymbol{\\mathcal{U}}$ , and let $u\\in\\mathrm{att}(\\mathcal{U})$ be an attainable expected utility. Then there exists $a$ unique maximum entropy policy $\\pi_{u}^{\\mathrm{maxent}}\\in\\Pi_{\\mathcal{U},u}^{\\mathrm{maxent}}$ \u03a0Um,axuent, and it has the form ", "page_idx": 6}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\pi_{u,t}^{\\mathrm{maxent}}(d_{t}\\mid p\\pmb{a}_{t})=\\pi_{\\beta,t}^{\\mathrm{soft}}(d_{t}\\mid p\\pmb{a}_{t}):=\\Bigg\\{\\frac{\\exp(\\beta\\cdot Q_{\\beta,t}^{\\mathrm{soft}}(d_{t}\\mid p\\pmb{a}_{t}))}{\\sum_{d^{\\prime}\\in\\mathrm{dom}(D_{t})}\\exp(\\beta\\cdot Q_{\\beta,t}^{\\mathrm{soft}}(d_{t}^{\\prime}\\mid p\\pmb{a}_{t}))},\\quad i f\\beta\\neq0}\\\\ &{\\}\\\\ &{3=\\mathrm{argmax}_{\\beta^{\\prime}\\in\\mathbb R\\cup\\{\\infty,-\\infty\\}}\\sum_{t}\\mathbb{E}_{\\pi}\\,\\Big[\\mathrm{log}(\\pi_{\\beta^{\\prime},t}^{\\mathrm{soft}}(d_{t}\\mid p\\pmb{a}_{t}))\\Big].}\\end{array}\n$$", "text_format": "latex", "page_idx": 6}, {"type": "text", "text": "We refer to a policy of the form of $\\pi_{\\beta}$ as a soft-optimal policy with a rationality parameter of $\\beta$ . ", "page_idx": 6}, {"type": "text", "text": "Known Utility Function To apply Definition 3.1 to measure the goal-directedness of a policy $\\pi$ in a CID $M$ with respect to a utility function $\\boldsymbol{\\mathcal{U}}$ , we need to find the maximum entropy policy in $\\Pi_{\\mathcal{U}}^{\\mathrm{maxent}}$ which best predicts $\\pi$ . We can use Theorem 5.1 to derive an algorithm that finds $\\pi_{u}^{\\mathrm{maxent}}$ for any $u\\in\\mathrm{att}(\\mathcal{U})$ . ", "page_idx": 6}, {"type": "text", "text": ",a taenldy,  ownley  dtoh en roet anl-eveadl uteo dc roantisoidnearl iteya cpha rpaomliectye ri $\\Pi_{\\mathcal{U},u}^{\\mathrm{maxent}}$ dienpdeinviddinuga lloyn. W.e know the form of $\\pi_{u}^{\\mathrm{maxent}}$ $\\beta$ $u$ ", "page_idx": 6}, {"type": "text", "text": "The gradient of the predictive accuracy with respect to $\\beta$ is ", "page_idx": 6}, {"type": "equation", "text": "$$\n\\nabla_{\\beta}\\mathbb{E}_{\\boldsymbol\\pi}\\left[\\sum_{D\\in D}\\left(\\log\\pi_{\\beta}^{\\mathrm{soft}}(D\\mid P a_{D})-\\log\\frac{1}{\\mid\\mathrm{dom}(D)\\mid}\\right)\\right]=\\mathbb{E}_{\\boldsymbol\\pi}\\left[\\mathcal{U}\\right]-\\mathbb{E}_{\\boldsymbol\\pi_{\\beta}^{\\mathrm{sot}}}\\left[\\mathcal{U}\\right].\n$$", "text_format": "latex", "page_idx": 6}, {"type": "text", "text": "The predictive accuracy is a concave function of $\\beta$ , so we can apply gradient ascent to find the global maximum in $\\beta$ , which is the same as finding the maximum in $u$ . ", "page_idx": 6}, {"type": "text", "text": "$\\mathrm{MEG}_{\\mathcal{U}}(\\pi)$ can therefore be found by alternating between applying the soft value iteration of Definition 5.2 to find $\\pi_{\\beta}^{\\mathrm{maxent}}$ , computing $\\mathbb{E}_{\\pi}\\left[\\mathcal{U}\\right]-\\mathbb{E}_{\\pi_{\\beta}^{\\operatorname*{maxent}}}\\left[\\mathcal{U}\\right]$ , and taking a gradient step. See Algorithm 1. ", "page_idx": 6}, {"type": "text", "text": "If the $\\beta$ that maximises predictive accuracy is $\\infty$ or $-\\infty$ , which can happen if $\\pi$ is optimal or anti-optimal with respect to $\\boldsymbol{\\mathcal{U}}$ , then the algorithm can never reach the (nonetheless finite) value of $\\mathrm{MEG}\\bar{u}(\\pi)$ , but will still converge in the limit. ", "page_idx": 6}, {"type": "text", "text": "Algorithm 1 Known-utility MEG in MDPs ", "page_idx": 7}, {"type": "text", "text": "Input: MDP $M$ , policy $\\pi$   \nOutput: $\\mathrm{MEG}_{\\mathcal{U}}(\\pi)$   \n1: initialise rationality parameter $\\beta$ , set learning rate $\\alpha$ .   \n2: repeat   \n3: Apply soft value iteration to find $Q_{\\beta}^{\\mathrm{soft}}$ \u25b7Definition 5.2   \n4: $\\begin{array}{r l}&{\\pi_{\\beta}^{\\mathrm{soft}}\\leftarrow\\mathrm{softmax}(\\beta\\cdot Q_{\\beta}^{\\mathrm{soft}})}\\\\ &{g\\leftarrow\\Big(\\mathbb{E}_{\\pi}\\left[\\mathcal{U}\\right]-\\mathbb{E}_{\\pi_{\\beta}^{\\mathrm{soft}}}\\left[\\mathcal{U}\\right]\\Big)}\\\\ &{\\beta\\leftarrow\\beta+\\alpha\\cdot g}\\end{array}$   \n5:   \n6:   \n7: until Convergence   \n8: return E\u03c0  D\u2208D $\\begin{array}{r}{\\left[\\breve{\\sum}_{D\\in D}\\left(\\log\\pi_{\\beta}^{\\mathrm{soft}}(D\\mid{\\bf P}{\\bf a}_{D})-\\log\\frac{1}{|\\mathrm{dom}(D)|}\\right)\\right]}\\end{array}$ ", "page_idx": 7}, {"type": "text", "text": "Unknown-utility algorithm To find unknown-utility MEG, we consider soft-optimal policies for various utility functions $\\boldsymbol{\\mathcal{U}}$ and maximise predictive accuracy with respect to $\\boldsymbol{\\mathcal{U}}$ as well as $\\beta$ . Let $\\mathcal{U}^{\\Theta}$ be a differentiable class of functions, such as a neural network, and write $\\pi_{\\theta,\\beta}^{\\mathrm{soft}}$ for a soft-optimal policy with respect to $\\mathcal{U}\\in\\mathcal{U}^{\\Theta}$ , and $Q_{\\theta,\\beta}^{\\mathrm{soft}}$ for the corresponding soft Q-function. We can take the derivative of the predictive accuracy with respect to $\\theta$ and get $\\mathbb{E}_{\\boldsymbol\\pi}\\left[\\nabla_{\\boldsymbol\\theta}\\mathcal{U}\\right]-\\mathbb{E}_{\\boldsymbol\\pi_{\\beta}^{\\mathrm{maxent}}}\\left[\\nabla_{\\boldsymbol\\theta}\\mathcal{U}\\right]$ . Algorithm 2 extends Algorithm 1 to this case. ", "page_idx": 7}, {"type": "text", "text": "Algorithm 2 Unknown-utility MEG in MDPs ", "text_level": 1, "page_idx": 7}, {"type": "text", "text": "Input: Parametric MDP $M_{\\Theta}$ over differentiable class of utility functions, policy $\\pi$   \nOutput: $\\mathrm{MEG}_{\\mathcal{U}_{\\Theta}}(\\pi)$   \n1: Initialise utility parameter $\\theta$ , rationality parameter $\\beta$ , set learning rate $\\alpha$ .   \n2: repeat   \n3: Apply soft value iteration to find $Q_{\\theta,\\beta}^{\\mathrm{soft}}$ \u25b7Definition 5.2   \n4: $\\begin{array}{r l}&{\\pi_{\\theta,\\beta}^{\\mathrm{soft}}\\leftarrow\\mathrm{softmax}(\\beta\\cdot Q_{\\theta,\\beta}^{\\mathrm{soft}})}\\\\ &{g_{\\beta}\\leftarrow\\Big(\\mathbb{E}_{\\pi}\\left[\\mathcal{U}^{\\theta}\\right]-\\mathbb{E}_{\\pi_{\\beta}^{\\mathrm{soft}}}\\left[\\mathcal{U}^{\\theta}\\right]\\Big)}\\\\ &{g_{\\theta}\\leftarrow\\Big(\\mathbb{E}_{\\pi}\\left[\\nabla_{\\theta}\\mathcal{U}^{\\theta}\\right]-\\mathbb{E}_{\\pi_{\\beta}^{\\mathrm{soft}}}\\left[\\nabla_{\\theta}\\mathcal{U}^{\\theta}\\right]\\Big)}\\\\ &{\\beta\\leftarrow\\beta+\\alpha\\cdot g_{\\beta}}\\\\ &{\\theta\\leftarrow\\beta+\\alpha\\cdot g_{\\theta}}\\end{array}$   \n5:   \n6:   \n7:   \n8:   \n9: until Stopping condition   \n10: return E\u03c0  D\u2208D $\\begin{array}{r}{\\Big[\\breve{\\sum_{D\\in D}}\\left(\\log\\pi_{\\theta,\\beta}^{\\mathrm{soft}}(D\\mid{\\bf P}{\\bf a}_{D})-\\log\\frac{1}{|\\mathrm{dom}(D)|}\\right)\\Big]}\\end{array}$ ", "page_idx": 7}, {"type": "text", "text": "An important caveat is that if ${\\mathcal{U}}^{\\theta}$ is a non-convex function of $\\theta$ (e.g. a neural network), Algorithm 2 need not converge to a global maximum. In general, the algorithm provides a lower bound for $\\mathrm{MEG}_{\\mathcal{U}_{\\theta}}(\\pi)$ , and hence for $\\operatorname{MEG}_{T}(\\pi)$ where ${\\cal T}={\\bf P}{\\bf a}_{\\mathcal{U}^{\\Theta}}$ . In practice, we may want to estimate the soft Q-function and expected utilities with Monte Carlo or variational methods, in which case the algorithm provides an approximate lower bound on goal-directedness. ", "page_idx": 7}, {"type": "text", "text": "6 Experimental Evaluation ", "text_level": 1, "page_idx": 7}, {"type": "text", "text": "We carried out two experiments5 to measure known-utility MEG with respect to the environment reward function and unknown-utility MEG with respect to a hypothesis class of utility functions. We used an MLP with a single hidden layer of size 256 to define a utility function over states. ", "page_idx": 7}, {"type": "text", "text": "Our experiments measured MEG for various policies in the CliffWorld environment from the seals suite [Gleave et al., 2020]. Cliffworld (Figure 3a) is a 4x10 gridworld MDP in which the agent starts in the top left corner and aims to reach the top right while avoiding the cliff along the top row. With probability 0.3, wind causes the agent to move upwards by one more square than intended. The environment reward function gives $+10$ when the agent is in the (yellow) goal square, $-10$ for the (dark blue) cliff squares, and $-1$ elsewhere. The dotted yellow line indicates a length 3 goal region. ", "page_idx": 7}, {"type": "image", "img_path": "o4coDIby7e/tmp/ce398bad95cccf2fb366b9eb94dc6fb654f74ce10ac414f5d43a34a8883ab834.jpg", "img_caption": ["Figure 3: (a) The CliffWorld environment. (b) MEG of $\\varepsilon$ -greedy policies for varying $\\varepsilon$ . MEG decreases as the policy gets less optimal. (c) MEG for optimal policies for various reward functions. Known-utility MEG decreases as the goal gets easier to satisfy, but unknown-utility MEG stays higher because the optimal policies also do well with respect to a narrower goal. "], "img_footnote": [], "page_idx": 8}, {"type": "text", "text": "", "page_idx": 8}, {"type": "text", "text": "MEG vs Optimality of policy In our first experiment, we measured the goal-directedness of policies of varying degrees of optimality by considering $\\varepsilon$ -greedy policies for $\\varepsilon$ in the range 0.1 to 0.9. Figure 3b shows known- and unknown utility MEG for each policy.6 Predictably, the goaldirectedness with respect to the environment reward decreased toward 0 as the policy became less optimal. So did unknown-utility MEG \u2013 since, as $\\varepsilon$ increases, the policy becomes increasingly uniform, it does not appear goal-directed with respect to any utility function over states. ", "page_idx": 8}, {"type": "text", "text": "MEG vs Task difficulty In our second experiment, we measured the goal-directedness of optimal policies for reward functions of varying difficulty. We extended the goal region of Cliffworld to run for either 1, 2, 3 or 4 squares along the top row and back column and considered optimal policies for each reward function. Figure 3c shows Cliffworld with a goal region of length 3. Figure 3b shows the results. Goal-directedness with respect to the true reward function decreased as the task became easier to complete. A way to interpret this is that as the number of policies which do well on a reward function increases, doing well on that reward function provides less and less evidence for deliberate optimisation. In contrast, unknown-utility MEG stays high even as the environment reward becomes easier to satisfy. This is because the optimal policy proceeds towards the nearest goal-squares and, hence, it appears strongly goal-directed with respect to a utility function which gives high reward to only those squares. Since this narrower utility function is more difficult to do well on than the environment reward function, doing well on it provides more evidence for goal-directedness. In Appendix D.3, we visualise the policies in question to make this more explicit. We also give tables of results for both experiments. ", "page_idx": 8}, {"type": "text", "text": "7 Limitations ", "text_level": 1, "page_idx": 8}, {"type": "text", "text": "Environment Access Although computing MEG does not require an explicit causal model (cf. Section 5), it does require the ability to run various policies in the environment of interest \u2013 we cannot compute MEG purely from observational data. ", "page_idx": 8}, {"type": "text", "text": "Intractability While MEG can be computed with gradient descent, doing so may well be computationally intractable in high dimensional settings. In this paper, we conduct only preliminary experiments \u2013 larger experiments based on real-world data may explore how serious these limitations are in practice. ", "page_idx": 8}, {"type": "text", "text": "Choice of variables MEG is highly dependent on which variables we choose to measure goaldirectedness with respect to. At one extreme, all (deterministic) policies have maximal goaldirectedness with respect to their own actions (given an expressive enough class of utility functions). This means that, for example, it would not be very insightful to compute the goal-directedness of a language model with respect to the text it outputs 7. At the other extreme, if a policy is highly goal-directed towards some variable $T$ that we do not think to measure, MEG may be misleadingly low. Relatedly, MEG may also be affected by whether we use a binary variable for $T$ (or the decisions $D$ ) rather than a fine-grained one with many possible outcomes. We should, therefore, think of MEG as measuring what evidence a set of variables provides about a policy\u2019s goal-directedness. A lack of evidence does not necessarily mean a lack of goal-directedness. ", "page_idx": 8}, {"type": "text", "text": "", "page_idx": 9}, {"type": "text", "text": "Distributional shifts MEG measures how predictive a utility function is of a system\u2019s behaviour on distribution, and distributional shifts can lead to changes in MEG. A consequence of this is that two almost identical policies can be given arbitrarily different goal-directedness scores, for example, if they take different actions in the start state of an MDP and thus spend time in different regions of the state space. It may be that by considering changes to a system\u2019s behaviour under interventions, as Kenton et al. [2023] do, we can distinguish \u201ctrue\u201d goals from spurious goals, where the former predict behaviour well across distributional shifts, while the latter happen to predict behaviour well on a particular distribution (perhaps because they correlate with true goals) [Di Langosco et al., 2022]. We leave this to future work. ", "page_idx": 9}, {"type": "text", "text": "Behavioural vs mechanistic approaches The latter two points suggest that mechanistic approaches to understanding a system\u2019s goal-directedness could have advantages over behavioural approaches like MEG. For example, suppose we could reverse engineer the algorithms learned by a neural network. In that case, it may be possible to infer which variables the system is goal-directed with respect to and do so in a way which is robust to distributional shifts. However, mechanistic interpretability of neural networks [Elhage et al., 2021] is an ambitious research agenda that is still in its infancy, and for now, behavioural approaches appear more tractable. ", "page_idx": 9}, {"type": "text", "text": "Societal implications An empirical measure of goal-directedness could enable researchers and companies to keep better track of how goal-directed LLMs and other systems are. This is important for dangerous capability evaluations [Shevlane et al., 2023, Phuong et al., 2024] and governance [Shavit et al., 2023]. A potential downside is that it could enable bad actors to create more dangerous systems by optimising for goal-directedness. We judge that this does not contribute much additional risk, given that bad actors can already optimise a system to pursue actively harmful goals. ", "page_idx": 9}, {"type": "text", "text": "8 Conclusion ", "text_level": 1, "page_idx": 9}, {"type": "text", "text": "We proposed maximum entropy goal-directedness (MEG), a formal measure of goal-directedness in CIDs and CBNs, grounded in the philosophical literature and the maximum causal entropy principle. Developing such measures is important because many risks associated with advanced artificial intelligence come from goal-directed behaviour. We proved that MEG satisfies several key desiderata, including scale invariance and being zero with respect to variables that can\u2019t be influenced, and that it gives insights about instrumental goals. On the practical side, we adapted algorithms from the maximum causal entropy framework for inverse reinforcement learning to measure goal-directedness with respect to nonlinear utility functions in MDPs. The algorithms handle both a single utility function and a differentiable class of utility functions. The algorithms were used in some small-scale experiments measuring the goal-directedness of various policies in MDPs. In future work, we plan to develop MEG\u2019s practical applications further. In particular, we hope to apply MEG to neural network interpretability by measuring the goal-directedness of a neural network agent with respect to a hypothesis class of utility functions taking the network\u2019s hidden states as input, thus taking more than just the system\u2019s behaviour into account. ", "page_idx": 9}, {"type": "text", "text": "9 Acknowledgements ", "text_level": 1, "page_idx": 10}, {"type": "text", "text": "The authors would like to thank Ryan Carey, David Hyland, Laurent Orseau, Francis Rhys Ward, and several anonymous reviewers for useful feedback. This research is supported by the UKRI Centre for Doctoral Training in Safe and Trusted AI (EP/S023356/1), and by the EPSRC grant \"An Abstraction-based Technique for Safe Reinforcement Learning\" (EP/X015823/1). Fox acknowledges the support of the EPSRC Centre for Doctoral Training in Autonomous Intelligent Machines and Systems (EP/S024050/1). ", "page_idx": 10}, {"type": "text", "text": "References ", "text_level": 1, "page_idx": 10}, {"type": "text", "text": "Yoshua Bengio. AI Scientists: Safe and Useful AI? https://yoshuabengio.org/2023/05/07/ ai-scientists-safe-and-useful-ai/, 2023. ", "page_idx": 10}, {"type": "text", "text": "Martin Biehl and Nathaniel Virgo. Interpreting systems as solving pomdps: a step towards a formal understanding of agency. In International Workshop on Active Inference, pages 16\u201331. Springer, 2022. ", "page_idx": 10}, {"type": "text", "text": "Alan Chan, Rebecca Salganik, Alva Markelius, Chris Pang, Nitarshan Rajkumar, Dmitrii Krasheninnikov, Lauro Langosco, Zhonghao He, Yawen Duan, Micah Carroll, et al. Harms from increasingly agentic algorithmic systems. In Proceedings of the 2023 ACM Conference on Fairness, Accountability, and Transparency, pages 651\u2013666, 2023. ", "page_idx": 10}, {"type": "text", "text": "Daniel C Dennett. The intentional stance. MIT press, 1989. ", "page_idx": 10}, {"type": "text", "text": "Daniel C Dennett. From bacteria to Bach and back: The evolution of minds. WW Norton & Company, 2017. ", "page_idx": 10}, {"type": "text", "text": "Daniel C Dennett. The problem with counterfeit people. The Atlantic, 16, 2023. ", "page_idx": 10}, {"type": "text", "text": "Lauro Langosco Di Langosco, Jack Koch, Lee D Sharkey, Jacob Pfau, and David Krueger. Goal misgeneralization in deep reinforcement learning. In International Conference on Machine Learning, pages 12004\u201312019. PMLR, 2022.   \nNelson Elhage, Neel Nanda, Catherine Olsson, Tom Henighan, Nicholas Joseph, Ben Mann, Amanda Askell, Yuntao Bai, Anna Chen, Tom Conerly, et al. A mathematical framework for transformer circuits. Transformer Circuits Thread, 1(1):12, 2021.   \nTom Everitt, Ryan Carey, Eric D Langlois, Pedro A Ortega, and Shane Legg. Agent incentives: A causal perspective. In Proceedings of the AAAI Conference on Artificial Intelligence, volume 35, pages 11487\u201311495, 2021a.   \nTom Everitt, Marcus Hutter, Ramana Kumar, and Victoria Krakovna. Reward tampering problems and solutions in reinforcement learning: A causal influence diagram perspective. Synthese, 198 (Suppl 27):6435\u20136467, 2021b.   \nJames Fox, Matt MacDermott, Lewis Hammond, Paul Harrenstein, Alessandro Abate, and Michael Wooldridge. On imperfect recall in multi-agent influence diagrams. In Proceedings Nineteenth conference on Theoretical Aspects of Rationality and Knowledge,, volume 379 of Electronic Proceedings in Theoretical Computer Science, pages 201\u2013220, 2023.   \nIason Gabriel, Arianna Manzini, Geoff Keeling, Lisa Anne Hendricks, Verena Rieser, Hasan Iqbal, Nenad Toma\u0161ev, Ira Ktena, Zachary Kenton, Mikel Rodriguez, et al. The ethics of advanced AI assistants. arXiv preprint arXiv:2404.16244, 2024.   \nAdam Gleave and Sam Toyer. A primer on maximum causal entropy inverse reinforcement learning. 2022.   \nAdam Gleave, Pedro Freire, Steven Wang, and Sam Toyer. seals: Suite of environments for algorithms that learn specifications. https://github.com/HumanCompatibleAI/seals, 2020.   \nTuomas Haarnoja, Haoran Tang, Pieter Abbeel, and Sergey Levine. Reinforcement learning with deep energy-based policies. In International conference on machine learning, pages 1352\u20131361. PMLR, 2017.   \nJoseph Halpern and Max Kleiman-Weiner. Towards formal definitions of blameworthiness, intention, and moral responsibility. In Proceedings of the AAAI conference on artificial intelligence, volume 32, 2018.   \nEdwin T Jaynes. Information theory and statistical mechanics. Physical review, 106(4):620, 1957.   \nZachary Kenton, Ramana Kumar, Sebastian Farquhar, Jonathan Richens, Matt MacDermott, and Tom Everitt. Discovering agents. Artificial Intelligence, page 103963, 2023.   \nMatt J Kusner, Joshua Loftus, Chris Russell, and Ricardo Silva. Counterfactual fairness. Advances in neural information processing systems, 30, 2017.   \nMatt MacDermott, Tom Everitt, and Francesco Belardinelli. Characterising decision theories with mechanised causal graphs. arXiv preprint arXiv:2307.10987, 2023.   \nAndrew Y Ng and Stuart Russell. Algorithms for inverse reinforcement learning. Proc. of 17th International Conference on Machine Learning, 2000, pages 663\u2013670, 2000.   \nRichard Ngo, Lawrence Chan, and S\u00f6ren Mindermann. The alignment problem from a deep learning perspective. The Twelfth International Conference on Learning Representations, 2022.   \nCaspar Oesterheld. Formalizing preference utilitarianism in physical world models. Synthese, 193(9): 2747\u20132759, 2016.   \nLaurent Orseau, Simon McGregor McGill, and Shane Legg. Agents and devices: A relative definition of agency. arXiv preprint arXiv:1805.12387, 2018.   \nJudea Pearl. Causality. Cambridge university press, 2009.   \nMary Phuong, Matthew Aitchison, Elliot Catt, Sarah Cogan, Alexandre Kaskasoli, Victoria Krakovna, David Lindner, Matthew Rahtz, Yannis Assael, Sarah Hodkinson, et al. Evaluating frontier models for dangerous capabilities. arXiv preprint arXiv:2403.13793, 2024.   \nJonathan Richens and Tom Everitt. Robust agents learn causal world models. The Twelfth International Conference on Learning Representations, 2024.   \nJonathan Richens, Rory Beard, and Daniel H Thompson. Counterfactual harm. Advances in Neural Information Processing Systems, 35:36350\u201336365, 2022.   \nMarkus Schlosser. Agency. In Edward N. Zalta, editor, The Stanford Encyclopedia of Philosophy. Metaphysics Research Lab, Stanford University, Winter 2019 edition, 2019.   \nYonadav Shavit, Sandhini Agarwal, Miles Brundage, Steven Adler, Cullen O\u2019Keefe, Rosie Campbell, Teddy Lee, Pamela Mishkin, Tyna Eloundou, Alan Hickey, et al. Practices for governing agentic AI systems. Research Paper, OpenAI, December, 2023.   \nToby Shevlane, Sebastian Farquhar, Ben Garfinkel, Mary Phuong, Jess Whittlestone, Jade Leung, Daniel Kokotajlo, Nahema Marchal, Markus Anderljung, Noam Kolt, et al. Model evaluation for extreme risks. arXiv preprint arXiv:2305.15324, 2023.   \nNathaniel Virgo, Martin Biehl, and Simon McGregor. Interpreting dynamical systems as bayesian reasoners. In Joint European conference on machine learning and knowledge discovery in databases, pages 726\u2013762. Springer, 2021.   \nSandra Wachter, Brent Mittelstadt, and Chris Russell. Counterfactual explanations without opening the black box: Automated decisions and the GDPR. Harv. JL & Tech., 31:841, 2017.   \nLei Wang, Chen Ma, Xueyang Feng, Zeyu Zhang, Hao Yang, Jingsen Zhang, Zhiyuan Chen, Jiakai Tang, Xu Chen, Yankai Lin, et al. A survey on large language model based autonomous agents. Frontiers of Computer Science, 18(6):1\u201326, 2024.   \nFrancis Ward, Francesca Toni, Francesco Belardinelli, and Tom Everitt. Honesty is the best policy: defining and mitigating AI deception. Advances in Neural Information Processing Systems, 36, 2024a.   \nFrancis Rhys Ward, Matt MacDermott, Francesco Belardinelli, Francesca Toni, and Tom Everitt. The reasons that agents act: Intention and instrumental goals. In Proceedings of the 23rd International Conference on Autonomous Agents and Multiagent Systems, pages 1901\u20131909, 2024b.   \nPaul Weirich. Causal Decision Theory. In Edward N. Zalta, editor, The Stanford Encyclopedia of Philosophy. Metaphysics Research Lab, Stanford University, Winter 2020 edition, 2020.   \nMarkus Wulfmeier, Peter Ondruska, and Ingmar Posner. Maximum entropy deep inverse reinforcement learning. arXiv preprint arXiv:1507.04888, 2015.   \nDylan Xu and Juan-Pablo Rivera. Towards measuring goal-directedness in AI systems. arXiv preprint arXiv:2410.04683, 2024.   \nBrian D Ziebart. Modeling purposeful adaptive behavior with the principle of maximum causal entropy. Carnegie Mellon University, 2010.   \nBrian D Ziebart, J Andrew Bagnell, and Anind K Dey. Modeling interaction via the principle of maximum causal entropy. In Proceedings of the 27th International Conference on International Conference on Machine Learning, pages 1255\u20131262, 2010. ", "page_idx": 10}, {"type": "text", "text": "", "page_idx": 11}, {"type": "text", "text": "", "page_idx": 12}, {"type": "image", "img_path": "o4coDIby7e/tmp/1844d0fc4e39dec689152a09efcc0cc23e5edb345e3508006d701b14144b27d3.jpg", "img_caption": ["Figure 4: Example 1 can be equally well represented with a CBN (a) or mechanised CBN (b), but Kenton et al. [2023]\u2019s algorithm only identifies an agent in (b). (c) shows the resulting mechanised CID. In contrast, MEG is unchanged between (b) and (c). Note also that the causal discovery algorithm identifies $T$ as a utility variable, where where MEG adds a new utility child to $T$ . "], "img_footnote": [], "page_idx": 13}, {"type": "text", "text": "A Comparison to Discovering Agents ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "This paper is inspired by Kenton et al. [2023], who proposed a causal discovery algorithm for identifying agents in causal models, inspired by Daniel Dennett\u2019s view of agents as systems \"moved by reasons\" [Dennett, 1989]. Our approach has several advantages over theirs, which we enumerate below. ", "page_idx": 13}, {"type": "text", "text": "Mechanism variables. Kenton et al. [2023] assume access to a mechanised structural causal model, which augments an ordinary causal model with mechanism variables which parameterise distributions of ordinary object-level variables. An agent is defined as a system that adapts to changes in the mechanism of its environment. However, the question of what makes a variable a mechanism is left undefined, and indeed, the same causal model can be expressed either with or without mechanism variables, leading their algorithm to give a different answer. For example, Example 1 has identical causal structure to the mouse example in Kenton et al. [2023], but without any variables designated as mechanisms. Their algorithm says the version with mechanism variables contains an agent while the version without does not, despite them being essentially the same causal model. Figure 4 shows our example depicted as a mechanised structural causal model. We fix this arbitrariness by making our definition in ordinary causal Bayesian networks. ", "page_idx": 13}, {"type": "text", "text": "Utility variables. Their algorithm assumes that some variables in the model represent agents\u2019 utilities. We bring this more in line with the philosophical motivation by treating utilities as hypothesised mental states with which we augment our model. ", "page_idx": 13}, {"type": "text", "text": "Predictive accuracy. Kenton et al. [2023]\u2019s approach formalises Dennett\u2019s idea of agents as systems \u201cmoved by reasons\u201d. We build on this idea but bring it more in line with Dennett\u2019s notion of what it means for a system to be moved by a reason \u2013 that the reason is useful for predicting its behaviour. ", "page_idx": 13}, {"type": "text", "text": "Gradualist vs Essentialist. The predictive error viewpoint gives us a continuous measure of goaldirectedness rather than a binary notion of agency, which is more befitting of the gradualist view of agents which inspired it. ", "page_idx": 13}, {"type": "text", "text": "Practicality. Their algorithm is theoretical rather than something that can be applied in practice. Instead, ours is straightforward to implement, as we demonstrate in Section 6. This opens up a range of potential applications, including behavioural evaluations and interpretability of ML models. ", "page_idx": 13}, {"type": "text", "text": "Interventional distributions. The primary drawback of MEG is that it doesn\u2019t necessarily generalise outside of the distribution. Running MEG on interventional distributions may fix this. We leave an extension of MEG to interventional distributions for future work. ", "page_idx": 13}, {"type": "text", "text": "B Proofs of MEG Properties ", "text_level": 1, "page_idx": 13}, {"type": "text", "text": "Proposition 3.1 (Translation and scale invariance). Let $M_{1}$ be a CID with utility function $\\mathcal{U}_{1}$ , and let $M_{2}$ be an identical CID but with utility function $\\mathcal{U}_{2}=a\\cdot\\mathcal{U}_{1}+b,$ , for some $a,b\\in\\mathbb{R},$ , with $a\\ne0$ . Then for any policy $\\pi$ , $\\mathrm{MEG}_{\\mathcal{U}_{1}}(\\pi)=\\mathrm{ME}\\dot{\\mathrm{G}}_{\\mathcal{U}_{2}}(\\pi)$ . ", "page_idx": 13}, {"type": "text", "text": "Proof. Since MEG is defined by maximising over a maximum entropy policy set, showing that two utility functions have the same maximum entropy policy set is enough to show that they result in the same MEG for every policy. ", "page_idx": 13}, {"type": "text", "text": "If $\\pi\\in\\Pi_{\\mathcal{U}_{1}}^{\\mathrm{maxent}}$ , then $\\pi\\in\\Pi_{\\mathcal{U}_{1},u_{1}}^{\\mathrm{maxent}}$ for some $u_{1}\\in\\mathrm{att}(\\mathcal{U}_{1})$ , i.e. $\\pi$ is a maximum entropy policy satisfying the constraint that $\\mathbb{E}_{\\pi}\\left[\\mathcal{U}_{1}\\right]=u_{1}$ . $\\pi$ thus also satisfies the constraint that $\\mathbb{E}_{\\pi}\\left[\\mathcal{U}_{2}\\right]=u_{2}:=a\\cdot u_{1}+b$ . Note that any policy satisfying $\\mathbb{E}_{\\pi}\\left[\\mathcal{U}_{2}\\right]=u_{2}$ also satisfies $\\mathbb{E}_{\\pi}\\left[\\mathcal{U}_{1}\\right]=u_{1}$ because the map $x\\mapsto a\\!\\cdot\\!x\\!+\\!b$ is injective (since $a\\neq0$ ). Thus $\\pi$ must also be a maximum entropy policy satisfying $\\mathbb{E}_{\\pi}\\left[\\mathcal{U}_{2}\\right]=u_{2}$ , and so $\\pi\\in\\Pi_{\\mathcal{U}_{2,}u_{2}}^{\\mathrm{maxent}}$ and thus $\\pi\\in\\Pi_{\\mathcal{U}_{2}}^{\\mathrm{maxent}}$ . ", "page_idx": 14}, {"type": "text", "text": "The converse is similar. ", "page_idx": 14}, {"type": "text", "text": "Proposition 3.2 (Bounds). Let $M$ be a CID with utility function U. Then for any policy $\\pi$ we have $\\begin{array}{r}{0\\leq\\mathrm{MEG}_{\\mathcal{U}}(\\pi)\\leq\\sum_{D\\in\\mathcal{D}}\\log(|\\operatorname{dom}(D)|)}\\end{array}$ , with equality in the lower bound $i f\\,\\pi$ is the uniform policy, and equality in the upper bound if \u03c0 is the unique optimal (or anti-optimal) policy with respect to $\\boldsymbol{\\mathcal{U}}$ . ", "page_idx": 14}, {"type": "text", "text": "Proof. Recall that ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\mathrm{MEG}_{\\mathcal{U}}(\\pi)=\\operatorname*{max}_{\\pi^{\\mathrm{maxent}}\\in\\Pi_{\\mathcal{U}}^{\\mathrm{maxent}}}\\mathbb{E}_{\\pi}\\left[\\sum_{D\\in D}\\left(\\log\\pi^{\\mathrm{maxent}}(D\\mid\\mathbf{Pa}_{D})-\\log\\frac{1}{\\mid\\mathrm{dom}(D)\\mid}\\right)\\right].\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "For the lower bound, first note that the uniform policy $\\pi^{\\mathrm{unif}}$ is always an element of $\\Pi_{\\mathcal{U}}^{\\mathrm{maxent}}$ , since it is the maximum entropy way to attain a utility of $\\mathbb{E}_{\\pi^{\\mathrm{unif}}}\\left[\\mathcal{U}\\right]$ . It follows that ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{{\\mathrm{MEG}}_{\\mathcal{U}}(\\pi)\\geq\\!\\mathbb{E}_{\\pi}\\left[\\displaystyle\\sum_{D\\in D}\\left(\\log\\pi^{\\mathrm{unif}}(D\\mid\\mathbf{P}\\mathbf{a}_{D})-\\log\\frac{1}{\\mid\\operatorname{dom}(D)\\mid}\\right)\\right]}\\\\ &{\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\! \n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "which shows both the lower bound and the fact that we attain it when $\\pi=\\pi^{\\mathrm{unif}}$ . ", "page_idx": 14}, {"type": "text", "text": "For the upper bound, note that the $\\log\\pi^{\\mathrm{maxent}}(D\\mid\\mathbf{Pa}_{D})$ term is at most $0$ , so ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\begin{array}{r l}{\\lefteqn{\\mathrm{MEG}_{\\mathcal{U}}(\\pi)\\le\\mathbb{E}_{\\pi}\\left[\\sum_{D\\in D}\\left(0-\\log\\frac{1}{|\\mathrm{\\normalfont~dom}(D)|}\\right)\\right]}\\quad}&{}\\\\ &{=\\displaystyle\\sum_{D\\in D}\\log(|\\,\\mathrm{dom}(D)|)}\\end{array}\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "To see that $\\pi$ being a unique optimal (or anti-optimal) policy is a sufficient condition for attaining the upper bound, note that there always exists a deterministic optimal and anti-optimal policy in a CID, so a unique such policy must be deterministic. Further, $\\pi$ must be in $\\Pi_{\\mathcal{U}}^{\\mathrm{maxent}}$ , since there is no higher entropy way to get the same expected utility. Then since $\\mathbb{E}_{\\pi}\\left[\\log\\pi^{\\mathrm{maxient}}(D\\mid\\mathbf{Pa}_{D})\\right]=0$ , choosing $\\pi^{\\mathrm{maxent}}=\\pi$ obtains the upper bound. ", "page_idx": 14}, {"type": "text", "text": "Proposition 3.3 (No goal-directedness without causal influence). Let $M=(G,P)$ be a CID with utility function $\\boldsymbol{\\mathcal{U}}$ and decision variables $_{D}$ such that, $D e s c(D)\\cap P\\pmb{a}_{U}=\\emptyset$ . Then $\\mathrm{MEG}_{\\mathcal{U}}(D)=0$ . ", "page_idx": 14}, {"type": "text", "text": "Proof. Since $\\boldsymbol{\\mathcal{U}}$ is not a descendant of $_{D}$ , it follows from the Markov property of causal Bayesian networks that $\\mathcal{U}\\perp D\\mid\\mathbf{Pa}_{D}$ . That means all policies achieve the same expected utility $u$ . So, the maximum entropy policy set $\\Pi_{\\mathcal{U}}^{\\mathrm{maxent}}$ contains only the uniform policy. We get that ", "page_idx": 14}, {"type": "equation", "text": "$$\n\\mathrm{MEG}_{\\mathcal{U}}(\\pi)=-\\mathbb{E}\\left[\\sum_{D\\in D}\\log\\frac{1}{\\mid\\mathrm{dom}(D)\\mid}-\\log\\frac{1}{\\mid\\mathrm{dom}(D)\\mid}\\right]=0.\\quad\\sqcup\\quad D\\in\\mathcal{U}.\n$$", "text_format": "latex", "page_idx": 14}, {"type": "text", "text": "Theorem 4.1 (Pseudo-terminal goals). Let $M=((V,E),P)$ be a CBN. Let $D,T,S\\subseteq V$ such that ${\\cal D}\\perp{\\cal T}\\mid{\\cal S}$ . Then $\\mathrm{MEG}_{T}(\\bar{D})\\leq\\mathrm{MEG}_{S}(D)$ . ", "page_idx": 15}, {"type": "text", "text": "Proof. We will show that the maximum entropy policy set $\\Pi_{\\mathcal{U}^{T}}^{\\mathrm{maxent}}$ (where $u^{T}$ is the set of all utility functions over $_T$ ) is a subset of $\\Pi_{\\mathcal{U}^{S}}^{\\mathrm{maxent}}$ , so the maximum predictive accuracy taken over the latter upper bounds the maximum predictive accuracy taken over the former. ", "page_idx": 15}, {"type": "text", "text": "Let $\\pi\\in\\Pi_{\\mathcal{U}^{T}}^{\\mathrm{maxent}}$ , so $\\mathbf{\\sigma},\\pi=\\pi_{\\mathcal{U},u}^{\\mathrm{maxent}}$ for some $\\mathcal{U}^{T}\\in\\mathcal{U}^{T}$ . If we can find a utility function $\\boldsymbol{\\mathcal{U}}^{S}\\in\\boldsymbol{\\mathcal{U}}^{s}$ such that for all $\\pi$ $\\mathrm{~\\boldmath~\\Omega~},\\mathbb{E}_{\\pi}\\left[\\mathcal{U}^{S}\\right]=\\mathbb{E}_{\\pi}\\left[\\mathcal{U}^{T}\\right]$ , then a maximum entropy policy with $\\mathbb{E}_{\\pi}\\left[\\mathcal{U}^{T}\\right]=u$ must also be a maximum entropy policy with $\\mathbb{E}_{\\pi}\\left[\\mathcal{U}^{S}\\right]\\,=\\,u$ . It would follow that $\\pi\\,\\in\\,\\Pi_{\\mathcal{U}^{T}}^{\\mathrm{maxent}}$ and so $\\Pi_{\\mathcal{U}^{S}}^{\\mathrm{maxent}}\\subseteq\\Pi_{\\mathcal{U}^{T}}^{\\mathrm{maxent}}$ . ", "page_idx": 15}, {"type": "text", "text": "To construct such a utility function, let $\\begin{array}{r}{\\mathcal{U}^{\\cal S}({\\pmb s})\\,=\\,\\sum_{t}P({\\cal T}=t\\,\\mid\\,{\\pmb S}={\\pmb s})\\mathcal{U}^{\\cal T}(t)}\\end{array}$ . Note that since $D\\perp T\\mid S,P(T=t\\mid\\dot{S}=s)$ is not a function o f $\\pi$ . Then for any $\\pi$ , ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\mathbb{E}_{\\boldsymbol\\pi}\\left[\\boldsymbol{\\mathcal{U}}^{T}\\right]=\\displaystyle\\sum_{t}{P}_{\\boldsymbol\\pi}(t)\\boldsymbol{\\mathcal{U}}^{T}(t)}\\\\ &{\\qquad\\qquad=\\displaystyle\\sum_{s}{P}_{\\boldsymbol\\pi}(s)\\sum_{t}{P}_{\\boldsymbol\\pi}(t\\mid s)\\boldsymbol{\\mathcal{U}}^{T}(t)}\\\\ &{\\qquad=\\displaystyle\\sum_{s}{P}_{\\boldsymbol\\pi}(s)\\sum_{t}{P}(t\\mid s)\\boldsymbol{\\mathcal{U}}^{T}(t)\\quad\\mathrm{(since~}D\\perp T\\mid S)}\\\\ &{\\qquad=\\displaystyle\\sum_{s}{P}_{\\boldsymbol\\pi}(s)\\boldsymbol{\\mathcal{U}}^{S}(s)}\\\\ &{\\qquad=\\mathbb{E}_{\\boldsymbol\\pi}\\left[\\boldsymbol{\\mathcal{U}}^{S}\\right].}\\end{array}\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "C Proof of Theorem 5.1 ", "text_level": 1, "page_idx": 15}, {"type": "text", "text": "Lemma C.1. Let $\\pi_{\\beta,\\mathcal{U}}$ denote a soft-optimal with respect to utility function $\\boldsymbol{\\mathcal{U}}$ , defined as in Theorem 5.1, with rationality parameter $\\beta$ . Then for any $\\alpha\\in\\mathbb{R},$ , we have that $\\pi_{\\alpha\\cdot\\beta,\\mathscr{U}}=\\pi_{\\beta,\\alpha\\cdot\\mathscr{U}}$ . ", "page_idx": 15}, {"type": "text", "text": ".f oIfr  etihteh esr $\\alpha$ -oQr $\\beta$ uanrcet ieoqnu aflo tr , wbiotthh  rpaotiliocniaelsi tayr ep uarnaifmoertme ra d.  wWee  afrire std osnheo. wO tthhaetr $Q_{\\beta,\\mathcal{U}}^{\\mathrm{soft}}$ $\\boldsymbol{\\mathcal{U}}$ $\\beta$ ${\\cal Q}_{\\beta,\\alpha\\cdot\\mathscr{U}}^{\\mathrm{soft}}\\;=$ $\\alpha\\cdot Q_{\\alpha\\cdot\\beta,\\mathcal{U}}^{\\mathrm{soft}}$ by backwards induction. ", "page_idx": 15}, {"type": "equation", "text": "$$\nQ_{\\beta,\\alpha\\cdot\\mathcal{U},n}^{\\mathrm{soft}}=\\mathbb{E}\\left[\\alpha\\cdot U_{n}\\ |\\ d_{n},\\mathbf{pa}_{n}\\right]=\\alpha\\mathbb{E}\\left[U_{n}\\ |\\ d_{n},\\mathbf{pa}_{n}\\right]=\\alpha\\cdot Q_{\\alpha\\cdot\\beta,\\mathcal{U},n}^{\\mathrm{soft}}.\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "And for $t<n$ , assuming the inductive hypothesis holds for $t+1$ , ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{Q_{\\beta,\\alpha;u,t}^{\\mathrm{soft}}(d_{t}\\mid\\mathbf{pa}_{t})=\\mathbb{E}\\left[\\alpha\\cdot U_{t}+\\frac{1}{\\beta}\\log\\mathrm{sumexp}(\\beta\\cdot Q_{\\beta,\\alpha;u,t+1}^{\\mathrm{soft}}(\\cdot\\mid\\mathbf{Pa}_{D_{t+1}}))\\Bigg|d_{t},\\mathbf{pa}_{t+1}\\right]}\\\\ &{\\qquad\\qquad\\qquad=\\alpha\\cdot\\mathbb{E}\\left[U_{t}+\\frac{1}{\\alpha\\cdot\\beta}\\log\\mathrm{sumexp}(\\beta\\cdot\\alpha\\cdot Q_{\\alpha;\\beta,\\mathcal{U},t+1}^{\\mathrm{soft}}(\\cdot\\mid\\mathbf{Pa}_{D_{t+1}}))\\Bigg|d_{t},\\mathbf{pa}_{t+1}\\right]}\\\\ &{\\qquad\\qquad\\qquad=\\alpha\\cdot\\mathbb{E}\\left[U_{t}+\\frac{1}{\\alpha\\cdot\\beta}\\log\\mathrm{sumexp}(\\alpha\\cdot\\beta\\cdot Q_{\\alpha;\\beta,\\mathcal{U},t+1}^{\\mathrm{soft}}(\\cdot\\mid\\mathbf{Pa}_{D_{t+1}}))\\Bigg|d_{t},\\mathbf{pa}_{t+1}\\right]}\\\\ &{\\qquad\\qquad\\qquad=\\alpha\\cdot Q_{\\alpha;\\beta,\\mathcal{U},t}^{\\mathrm{soft}}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 15}, {"type": "text", "text": "Then, substituting this into the definition of $\\pi_{\\alpha\\cdot\\beta,\\mathcal{U}}$ we get ", "page_idx": 15}, {"type": "equation", "text": "$$\n\\begin{array}{r l}&{\\pi_{\\beta,\\alpha\\cdot\\mathcal{U}}=\\mathrm{softmax}\\left(\\beta\\cdot Q_{\\beta,\\alpha\\cdot\\mathcal{U}}^{\\mathrm{soft}}\\right)}\\\\ &{\\qquad\\qquad=\\mathrm{softmax}\\left(\\beta\\cdot\\alpha\\cdot Q_{\\alpha\\cdot\\beta,\\mathcal{U}}^{\\mathrm{soft}}\\right)}\\\\ &{\\qquad\\qquad=\\mathrm{softmax}\\left(\\alpha\\cdot\\beta\\cdot Q_{\\alpha\\cdot\\beta,\\mathcal{U}}^{\\mathrm{soft}}\\right)}\\\\ &{\\qquad\\qquad=\\pi_{\\alpha\\cdot\\beta,\\mathcal{U}}.}\\end{array}\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "Theorem 5.1 (Maximum entropy policy in MDPs). Let $M=(G,P)$ be an MDP with utility function $\\boldsymbol{\\mathcal{U}}$ , and let $u\\in\\mathrm{att}(\\mathcal{U})$ be an attainable expected utility. Then there exists $a$ unique maximum entropy policy $\\pi_{u}^{\\mathrm{maxent}}\\in\\Pi_{\\mathcal{U},u}^{\\mathrm{maxent}}$ , and it has the form ", "page_idx": 16}, {"type": "equation", "text": "$$\n\\begin{array}{r}{\\pi_{u,t}^{\\mathrm{maxent}}(d_{t}\\mid p\\boldsymbol{a}_{t})=\\pi_{\\beta,t}^{\\mathrm{soft}}(d_{t}\\mid p\\boldsymbol{a}_{t}):=\\left\\{\\begin{array}{l l}{\\frac{\\exp(\\beta\\cdot Q_{\\beta,t}^{\\mathrm{soft}}(d_{t}\\mid p\\boldsymbol{a}_{t}))}{\\sum_{d^{\\prime}\\in\\mathrm{dom}(D_{t})}\\exp(\\beta\\cdot Q_{\\beta,t}^{\\mathrm{sof}}(d_{t}^{\\prime}\\mid p\\boldsymbol{a}_{t}))},}&{i f\\beta\\neq0}\\\\ {\\pi^{\\mathrm{unif}}(d_{t}\\mid p\\boldsymbol{a}_{t}),}&{i f\\beta=0.}\\end{array}\\right.}\\end{array}\n$$", "text_format": "latex", "page_idx": 16}, {"type": "text", "text": "where $\\begin{array}{r}{\\beta=\\operatorname*{argmax}_{\\beta^{\\prime}\\in\\mathbb{R}\\cup\\{\\infty,-\\infty\\}}\\sum_{t}\\mathbb{E}_{\\pi}\\,\\Big[\\log\\bigr(\\pi_{\\beta^{\\prime},t}^{\\mathrm{soft}}(d_{t}\\mid\\pmb{p}\\pmb{a}_{t})\\bigr)\\Big].}\\end{array}$ ", "page_idx": 16}, {"type": "text", "text": "Proof. In an MDP, the expected utility is a linear function of the policy, so the attainable utility set is a closed interval $\\mathrm{att}(\\mathcal{U})=[u_{\\mathrm{min}},u_{\\mathrm{max}}]$ . We first consider the case where $u\\in(u_{\\operatorname*{min}},u_{\\operatorname*{max}})$ . ", "page_idx": 16}, {"type": "text", "text": "In this case, we are seeking the maximum entropy policy in an MDP with a linear constraint satisfiable by a full support policy (since $u$ is an interior point), so we can invoke Ziebart\u2019s result on the form of such policies [Ziebart, 2010, Ziebart et al., 2010, Gleave and Toyer, 2022]. In particular, our feature is the utility $\\boldsymbol{\\mathcal{U}}$ . We get that the maximum entropy policy is a soft-Q policy for a utility function $\\beta\\cdot\\mathcal{U}$ with a rationality parameter of 1, where $\\begin{array}{r}{\\beta=\\operatorname*{argmax}_{\\beta^{\\prime}\\in\\mathbb{R}}\\sum_{t}\\mathbb{E}_{\\pi}\\left[\\log(\\pi_{\\beta^{\\prime}}^{\\mathrm{soft}}(d_{t}\\mid\\mathbf{pa}_{t}))\\right]}\\end{array}$ . By Lemma C.1 this can be restated as a soft-Q policy for $\\boldsymbol{\\mathcal{U}}$ with a rationality parameter of $\\beta$ . It follows from Ziebart that $\\beta=\\mathrm{argmax}_{\\beta^{\\prime}\\in\\mathbb{R}}\\,\\pi_{\\beta^{\\prime}}^{\\mathrm{soft}}$ , and allowing $\\beta=\\infty$ or $-\\infty$ does not change the argmax. ", "page_idx": 16}, {"type": "text", "text": "In the case where $u\\in\\{u_{\\mathrm{min}},u_{\\mathrm{max}}\\}$ , it\u2019s easy to show that the maximum entropy policy which attains $u$ randomises uniformly between maximal value actions (for $u_{\\mathrm{max}}$ ) or minimal value actions (for $u_{\\mathrm{min}},$ ). These policies can be expressed as $\\scriptstyle\\operatorname*{lim}_{\\beta\\to\\infty}\\pi_{\\beta}^{\\mathrm{soft}}$ and lim\u03b2\u2192\u2212\u221e\u03c0s\u03b2o respectively. \u53e3 ", "page_idx": 16}, {"type": "text", "text": "D Experimental Details ", "text_level": 1, "page_idx": 16}, {"type": "text", "text": "D.1 Tables of results ", "page_idx": 16}, {"type": "table", "img_path": "o4coDIby7e/tmp/bc149c8d73c303cf6a706071a99f9ed93900b87116db0db2755b8e256029ca69.jpg", "table_caption": [], "table_footnote": [], "page_idx": 16}, {"type": "table", "img_path": "o4coDIby7e/tmp/9f3fdb69e3efccfffe09be339ada0ab74a71ad3da5c40f3b62fd4bbe5bbc180e.jpg", "table_caption": [], "table_footnote": [], "page_idx": 16}, {"type": "image", "img_path": "o4coDIby7e/tmp/c4a2a217fd8ea46fd29e9ab4b2d37c255019a9cecad93b6b7c46984ca17c566c.jpg", "img_caption": ["(a) Occupancy measures of optimal policy when $k=1$ . ", "Figure 5: Occupancy measures ", "(b) Occupancy measures of optimal policy when $k=4$ . "], "img_footnote": [], "page_idx": 17}, {"type": "text", "text": "D.2 Visualising optimal policies for different lengths of goal region. ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "Figure 5a and Figure 5b show the occupancy measures for an optimal policy for $\\scriptstyle{\\mathrm{k}}=1$ and $_{\\mathrm{k=4}}$ respectively, where $k$ is the length of the goal region in squares. Although the goal region is larger in the latter case, the optimal policy consistently aims for the same sub-region. This explains why unknown-utility MEG is higher than MEG with respect to the environment reward. The policy does just as well on a utility function whose goal-region is limited to the nearer goal squares as it does on the environment reward, but fewer policies do well on this utility function, so doing well on it constitutes more evidence for goal-directedness. ", "page_idx": 17}, {"type": "text", "text": "D.3 Further details ", "text_level": 1, "page_idx": 17}, {"type": "text", "text": "The experiments were carried out on a personal laptop with the following specs: ", "page_idx": 17}, {"type": "text", "text": "\u2022 Hardware model: LENOVO20N2000RUK   \n\u2022 Processor: Intel(R) Core(TM) i7-8665U CPU $@$ 1.90GHz, 2112 Mhz, 4 Core(s), 8 Logical Processor(s)   \n\u2022 Memory: 24.0 GB ", "page_idx": 17}, {"type": "text", "text": "", "page_idx": 17}, {"type": "text", "text": "We used an environment from the SEALS library8, and adapted an algorithm from the imitation library9. Both are released under the MIT license. ", "page_idx": 17}, {"type": "text", "text": "For information on hyperparameters, see the code. ", "page_idx": 17}, {"type": "text", "text": "NeurIPS Paper Checklist ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "1. Claims ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Question: Do the main claims made in the abstract and introduction accurately reflect the paper\u2019s contributions and scope? ", "page_idx": 18}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 18}, {"type": "text", "text": "Justification: The contributions of the paper are listed at the end of the introduction, with references to the relevant sections of the paper. ", "page_idx": 18}, {"type": "text", "text": "2. Limitations ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Question: Does the paper discuss the limitations of the work performed by the authors? Answer: [Yes] ", "page_idx": 18}, {"type": "text", "text": "Justification: Section 7 contains a section dedicated to limitations. ", "page_idx": 18}, {"type": "text", "text": "3. Theory Assumptions and Proofs ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Question: For each theoretical result, does the paper provide the full set of assumptions and a complete (and correct) proof? ", "page_idx": 18}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 18}, {"type": "text", "text": "Justification: Proofs of all theoretical results are given in the supplementary material. ", "page_idx": 18}, {"type": "text", "text": "4. Experimental Result Reproducibility ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Question: Does the paper fully disclose all the information needed to reproduce the main experimental results of the paper to the extent that it affects the main claims and/or conclusions of the paper (regardless of whether the code and data are provided or not)? ", "page_idx": 18}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 18}, {"type": "text", "text": "Justification: Details of the experiments are describe in Section 6. Code is included in the supplementary material. ", "page_idx": 18}, {"type": "text", "text": "5. Open access to data and code ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Question: Does the paper provide open access to the data and code, with sufficient instructions to faithfully reproduce the main experimental results, as described in supplemental material? ", "page_idx": 18}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 18}, {"type": "text", "text": "Justification: Code is included in the supplementary material. ", "page_idx": 18}, {"type": "text", "text": "6. Experimental Setting/Details ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Question: Does the paper specify all the training and test details (e.g., data splits, hyperparameters, how they were chosen, type of optimizer, etc.) necessary to understand the results? ", "page_idx": 18}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 18}, {"type": "text", "text": "Justification: Full details are provided via the code. ", "page_idx": 18}, {"type": "text", "text": "7. Experiment Statistical Significance ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Question: Does the paper report error bars suitably and correctly defined or other appropriate information about the statistical significance of the experiments? ", "page_idx": 18}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 18}, {"type": "text", "text": "Justification: We report two sigma error bars for unknown-utility MEG experiments. Knownutility MEG experiments are deterministic, so we do not report error bars. ", "page_idx": 18}, {"type": "text", "text": "8. Experiments Compute Resources ", "text_level": 1, "page_idx": 18}, {"type": "text", "text": "Question: For each experiment, does the paper provide sufficient information on the computer resources (type of compute workers, memory, time of execution) needed to reproduce the experiments? ", "page_idx": 18}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 18}, {"type": "text", "text": "Justification: Information on compute resources is given in Appendix D.3. ", "page_idx": 18}, {"type": "text", "text": "9. Code Of Ethics ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "Question: Does the research conducted in the paper conform, in every respect, with the NeurIPS Code of Ethics https://neurips.cc/public/EthicsGuidelines? ", "page_idx": 19}, {"type": "text", "text": "Answer: [Yes] Justification: The research conducted conforms to the code of ethics. ", "page_idx": 19}, {"type": "text", "text": "10. Broader Impacts ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "Question: Does the paper discuss both potential positive societal impacts and negative societal impacts of the work performed? ", "page_idx": 19}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 19}, {"type": "text", "text": "Justification: Section 7 contains a section discussing societal impacts. ", "page_idx": 19}, {"type": "text", "text": "11. Safeguards ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "Question: Does the paper describe safeguards that have been put in place for responsible release of data or models that have a high risk for misuse (e.g., pretrained language models, image generators, or scraped datasets)? ", "page_idx": 19}, {"type": "text", "text": "Answer: [NA] Justification: The paper does not release such data or models. ", "page_idx": 19}, {"type": "text", "text": "12. Licenses for existing assets ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "Question: Are the creators or original owners of assets (e.g., code, data, models), used in the paper, properly credited and are the license and terms of use explicitly mentioned and properly respected? ", "page_idx": 19}, {"type": "text", "text": "Answer: [Yes] ", "page_idx": 19}, {"type": "text", "text": "Justification: The creators of the libraries we used are credited, the licenses are respected, and explicitly mentioned in Appendix D.3. ", "page_idx": 19}, {"type": "text", "text": "13. New Assets ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "Question: Are new assets introduced in the paper well documented and is the documentation provided alongside the assets? ", "page_idx": 19}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 19}, {"type": "text", "text": "Justification: The paper does not release new assets. ", "page_idx": 19}, {"type": "text", "text": "14. Crowdsourcing and Research with Human Subjects ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "Question: For crowdsourcing experiments and research with human subjects, does the paper include the full text of instructions given to participants and screenshots, if applicable, as well as details about compensation (if any)? ", "page_idx": 19}, {"type": "text", "text": "Answer: [NA] ", "page_idx": 19}, {"type": "text", "text": "Justification: The paper does not involve crowdsourcing nor research with human subjects. ", "page_idx": 19}, {"type": "text", "text": "15. Institutional Review Board (IRB) Approvals or Equivalent for Research with Human Subjects ", "text_level": 1, "page_idx": 19}, {"type": "text", "text": "Question: Does the paper describe potential risks incurred by study participants, whether such risks were disclosed to the subjects, and whether Institutional Review Board (IRB) approvals (or an equivalent approval/review based on the requirements of your country or institution) were obtained? ", "page_idx": 19}, {"type": "text", "text": "Answer: [NA] Justification: The paper does not involve crowdsourcing nor research with human subjects. ", "page_idx": 19}]